"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}angular.module("contiv.graph",[]),angular.module("contiv.directives",[]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();angular.module("contiv.graph").factory("DataSource",["Node","Link",function(e,t){var o=function(){function o(e,t){_classCallCheck(this,o),this.nodes=e,this.links=t}return _createClass(o,[{key:"updateNodes",value:function(e){this.nodes=e}},{key:"updateLinks",value:function(e){this.links=e}},{key:"nodeIdToName",value:function(e){for(var t=this.nodes,o=0;o<t.length;o++)if(t[o].id==e)return t[o].name}},{key:"processNodeData",value:function(t){var o=[];return _.forEach(t,function(t){var n=new e.Node(null,null,t.id,t.text,null);o.push(n)}),o}},{key:"processLinkData",value:function(e,o){function n(e,t){for(var o=0;o<t.length;o++)if(e==t[o].id)return t[o]}for(var i=[],r=0;r<e.length;r++)if(e[r].source!=e[r].target){var a=n(e[r].source,o),l=n(e[r].target,o);if(null==a||null==l)continue;var s=new t.Link(a,l);i.push(s)}return i}}]),o}();return{DataSource:o}}]),angular.module("contiv.models",[]);var ContivGlobals=function(){return{NETWORKS_ENDPOINT:"/netmaster/api/v1/networks/",NETWORKS_INSPECT_ENDPOINT:"/netmaster/api/v1/inspect/networks/",SERVICELBS_INSPECT_ENDPOINT:"/netmaster/api/v1/inspect/serviceLBs/",POLICIES_ENDPOINT:"/netmaster/api/v1/policys/",RULES_ENDPOINT:"/netmaster/api/v1/rules/",APPLICATIONGROUPS_ENDPOINT:"/netmaster/api/v1/endpointGroups/",SERVICELBS_ENDPOINT:"/netmaster/api/v1/serviceLBs/",ORGANIZATIONS_ENDPOINT:"/netmaster/api/v1/tenants/",NETWORK_SETTINGS_ENDPOINT:"/netmaster/api/v1/globals/",NETPROFILES_ENDPOINT:"/netmaster/api/v1/netprofiles/",BGPS_ENDPOINT:"/netmaster/api/v1/Bgps/",BGPS_INSPECT_ENDPOINT:"/netmaster/api/v1/inspect/Bgps/",VISUALIZATION_ENDPOINT:"/visualization/",VOLUMES_ENDPOINT:"/volmaster/volumes/",VOLUMES_CREATE_ENDPOINT:"/volmaster/volumes/create/",VOLUMES_DELETE_ENDPOINT:"/volmaster/volumes/remove/",VOLUMES_COPYSNAPSHOTS_ENDPOINT:"/volmaster/volumes/copy",VOLUMES_USES_ENDPOINT:"/volmaster/uses/mounts/",VOLUMES_SNAPSHOTS_ENDPOINT:"/volmaster/snapshots/",STORAGEPOLICIES_ENDPOINT:"/volmaster/policies/",VOLUMES_GLOBAL_ENDPOINT:"/volmaster/global/",NODES_LIST_ENDPOINT:"/info/nodes",NODES_DISCOVER_ENDPOINT:"/discover/nodes",NODES_COMMISSION_ENDPOINT:"/commission/nodes",NODES_DECOMMISSION_ENDPOINT:"/decommission/nodes",NODES_MAINTENANCE_ENDPOINT:"/maintenance/nodes",NODES_LAST_JOB_ENDPOINT:"/info/job/last",NODES_ACTIVE_JOB_ENDPOINT:"/info/job/active",NODES_SETTINGS_SET_ENDPOINT:"/globals",NODES_SETTINGS_GET_ENDPOINT:"/info/globals",REFRESH_INTERVAL:5e3,CIDR_REGEX:"^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]).){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(/([0-9]|[1-2][0-9]|3[0-2]))$",VLAN_REGEX:"^([0-9]{1,4}?-[0-9]{1,4}?)$",VXLAN_REGEX:"^([0-9]{1,8}?-[0-9]{1,8}?)$",NUMBER_REGEX:"^[0-9]*$"}}();angular.module("contiv.utils",[]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();angular.module("contiv.graph").factory("VisualizerDataSource",["DataSource","VisualizerNode","VisualizerLink",function(e,t,o){var n=function(e){function n(e,t,o,i,r,a){_classCallCheck(this,n);var l=_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,t));return l.children_struct=o,l.ancestors_struct=i,l.labels=r,l.selectors=a,l}return _inherits(n,e),_createClass(n,[{key:"hasChild",value:function(e){return null!=this.children_struct[e]}},{key:"setAncestors",value:function(){var e=this,t=!1;_.forEach(e.nodes,function(o){o.ancestors=e.ancestors_struct[o.id]||[],_.isEmpty(o.ancestors)===!1?o.parent=o.ancestors[0]:0==_.includes(e.children_struct.topLevel,o.id)&&(o.ancestors.push("client"),e.ancestors_struct[o.id]=["client"],t===!1&&(t=!0,e.children_struct.topLevel.push("client"),e.children_struct.client=[]),e.children_struct.client.push(o.id))})}},{key:"getTopLevelFlow",value:function(){return this.getFlowBetweenSet(this.children_struct.topLevel)}},{key:"getFlowBetweenSet",value:function(e){for(var t=this.nodes,o={},n=0;n<t.length;n++){var i=t[n];if(null===i.ancestors)o[i.id]=i.name;else for(var r=0;r<e.length;r++)if(i.ancestors.indexOf(e[r])>-1){o[i.id]=e[r];break}}for(var a=this.links,l=[],n=0;n<a.length;n++){var s=[];s.source=o[a[n].source]||a[n].source,s.target=o[a[n].target]||a[n].target,s.weight=a[n].weight,l.push(s)}for(var c=[],n=0;n<e.length;n++){var u=[];u.id=e[n],u.text=this.nodeIdToName(e[n])||e[n],u.ancestors=this.ancestors_struct[e[n]]||this.ancestors_struct[u.text]||[],_.isEmpty(u.ancestors)===!1?u.parent=u.ancestors[0]:u.parent=null,c.push(u)}return{nodeData:c,linkData:l}}},{key:"processNodeData",value:function(e){var o=[];return _.forEach(e,function(e){var n=new t.Node(null,null,e.id,e.text,null,e.parent,e.ancestors,null,null);o.push(n)}),o}},{key:"processLinkData",value:function(e,t){function n(e,t){for(var o=0;o<t.length;o++)if(e==t[o].id)return t[o]}for(var i=[],r={},a=0;a<e.length;a++)if(e[a].source!=e[a].target){var l=n(e[a].source,t),s=n(e[a].target,t),c=e[a].weight;if(null==l||null==s)continue;if(void 0===r[l.id+"-"+s.id]){var u=new o.Link(l,s,c);r[l.id+"-"+s.id]=u,i.push(u)}else{var d=r[l.id+"-"+s.id];d.setWeight(d.getRawWeight()+c),d.increaseCount()}}return i}}]),n}(e.DataSource);return{DataSource:n}}]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();angular.module("contiv.graph").factory("Graph",["PolicyService",function(e){var t=function(){function t(o,n,i){_classCallCheck(this,t);var r=this;r.nodes=n||[],r.links=i||[],r.defaultNodePolicies=[],r.defaultPathPolicies=[],r.svgPolicy=new e.Policy,r.state={canZoom:!0,canPan:!0,initForce:!1,disableUpdate:!1},r.consts={circleGClass:"conceptG",graphClass:"graph",pathClass:"path",nodeClass:"circle",nodeText:"nodeText",startRadius:50,maxRadius:60,padding:5,displayOffset:60},o.on("mouseover",function(e){r.svgPolicy.mouseover.call(this,e)}).on("dblclick",function(e){r.svgPolicy.dblclick.call(this,e)}).on("contextmenu",function(e){r.svgPolicy.contextmenu.call(this,e)}).on("mouseout",function(e){r.svgPolicy.mouseout.call(this,e)}).on("mousedown",function(e){r.svgPolicy.mousedown.call(this,e)}).on("mouseup",function(e){r.svgPolicy.mouseup.call(this,e)});var a=o.append("svg:defs");a.append("svg:marker").attr("id","end-arrow").attr("viewBox","0 -5 10 10").attr("refX",20).attr("refY",-1).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5"),a.append("svg:marker").attr("id","mark-end-arrow").attr("viewBox","0 -5 10 10").attr("refX",7).attr("markerWidth",3.5).attr("markerHeight",3.5).attr("orient","auto").append("svg:path").attr("d","M0,-5L10,0L0,5"),r.svg=o,r.svgG=o.append("g").classed(r.consts.graphClass,!0);var l=r.svgG;r.paths=l.append("g").selectAll("g"),r.circles=l.append("g").selectAll("g"),r.initNodes(),r.initLinks(),r.setPositions();var s=function(){r.onWindowResize(o)};r.bindings={resize:s},$(window).resize(s)}return _createClass(t,[{key:"destroy",value:function(){var e=this;_(e.defaultNodePolicies).forEach(function(e){e.destroy()}),_(e.defaultPathPolicies).forEach(function(e){e.destroy()}),e.svgPolicy.destroy();for(var t in e.bindings)$(window).off(t,e.bindings[t])}},{key:"initNodes",value:function(){var e=this;_.forEach(e.nodes,function(t){t.initialize(e)})}},{key:"initLinks",value:function(){var e=this;_.forEach(e.links,function(t){t.initialize(e)})}},{key:"findNodeById",value:function(e){for(var t=this,o=0;o<t.nodes.length;o++)if(e===t.nodes[o].id)return t.nodes[o]}},{key:"findD3Node",value:function(e){var t,o=this;return o.circles.each(function(o){o.id===e&&(t=d3.select(this))}),t}},{key:"installDragPolicy",value:function(e){this.drag=e}},{key:"installSvgPolicy",value:function(e){this.svgPolicy=e}},{key:"installDefaultNodePolicy",value:function(e){var t=this;t.defaultNodePolicies.push(e),e.initialize(t)}},{key:"uninstallDefaultNodePolicy",value:function(e){var t;t="string"==typeof e?e:e.policyName,_(thisGraph.defaultNodePolicies).forEach(function(e,o){e.policyName===t&&(e.destroy(),thisGraph.defaultNodePolicies.splice(o,1))})}},{key:"getNodePolicy",value:function(e){var t=this;_(t.defaultNodePolicies).forEach(function(t,o){return t.policyName===e?t:void 0})}},{key:"installDefaultPathPolicy",value:function(e){var t=this;t.defaultPathPolicies.push(e),e.initialize(t)}},{key:"uninstallDefaultPathPolicy",value:function(e){var t,o=this;t="string"==typeof e?e:e.policyName,_(o.defaultPathPolicies).forEach(function(e,n){e.policyName===t&&(e.destroy(),o.defaultPathPolicies.splice(n,1))})}},{key:"pathPolicyEvent",value:function(e,t,o){var n=this;_(n.defaultPathPolicies).forEach(function(n){n[e](t,o)})}},{key:"nodePolicyEvent",value:function(e,t,o){var n=this;_.forEach(n.defaultNodePolicies,function(n){n[e](t,o)})}},{key:"installZoomPolicy",value:function(e){this.dragSvg=e,this.svg.call(this.dragSvg)}},{key:"onWindowResize",value:function(e){}},{key:"insertTitleLinebreaks",value:function(e,t){for(var o=this,n=t.split(/\s+/g),i=n.length,r=e.append("text").attr("class",o.consts.nodeText).attr("text-anchor","middle").attr("dy","-"+7.5*(i-1)),a=0;a<n.length;a++){var l=r.append("tspan").text(n[a]);a>0&&l.attr("x",0).attr("dy","15")}}},{key:"spliceLinksForNode",value:function(e){var t=this,o=t.links.filter(function(t){return t.source===e||t.target===e});o.map(function(e){t.links.splice(t.links.indexOf(e),1)})}},{key:"addNode",value:function(e){var t=this;t.nodes.push(e),e.initialize(t),t.updateGraph()}},{key:"removeNode",value:function(e){var t=this;t.nodes.splice(t.nodes.indexOf(e),1),t.spliceLinksForNode(e),t.updateGraph()}},{key:"addLink",value:function(e){var t=this;t.links.push(e),e.initialize(t),t.updateGraph()}},{key:"removeLink",value:function(e){var t=this;t.links.splice(t.links.indexOf(e),1),e.initialize(t),t.updateGraph()}},{key:"updateExistingPaths",value:function(e){e.each(function(e){e.updateAttr(d3.select(this),e)})}},{key:"updateNewPaths",value:function(e){var t=this;t.initLinks(),e.each(function(e){e.newPathAttr(d3.select(this),e)}),e.on("mouseover",function(e){e.hasPolicy?e.pathPolicyEvent("mouseover",d3.select(this),e):t.pathPolicyEvent("mouseover",d3.select(this),e)}).on("dblclick",function(e){e.hasPolicy?e.pathPolicyEvent("dblclick",d3.select(this),e):t.pathPolicyEvent("dblclick",d3.select(this),e)}).on("contextmenu",function(e){e.hasPolicy?e.pathPolicyEvent("contextmenu",d3.select(this),e):t.pathPolicyEvent("contextmenu",d3.select(this),e)}).on("mouseout",function(e){e.hasPolicy?e.pathPolicyEvent("mouseout",d3.select(this),e):t.pathPolicyEvent("mouseout",d3.select(this),e)}).on("mousedown",function(e){e.hasPolicy?e.pathPolicyEvent("mousedown",d3.select(this),e):t.pathPolicyEvent("mousedown",d3.select(this),e)}).on("mouseup",function(e){e.hasPolicy?e.pathPolicyEvent("mouseup",d3.select(this),e):t.pathPolicyEvent("mouseup",d3.select(this),e)}).call(t.drag)}},{key:"updateExistingNodes",value:function(){var e=this;e.circles=this.circles.data(e.nodes,function(e){return e.id}).each(function(e){e.updateAttr(d3.select(this),e)})}},{key:"updateNewNodes",value:function(e){var t=this;e.each(function(e){null==e.graph&&e.initialize(t),e.newNodeAttr(d3.select(this),e)}),e.on("mouseover",function(e){e.hasPolicy?e.nodePolicyEvent("mouseover",d3.select(this),e):t.nodePolicyEvent("mouseover",d3.select(this),e)}).on("dblclick",function(e){e.hasPolicy?e.nodePolicyEvent("dblclick",d3.select(this),e):t.nodePolicyEvent("dblclick",d3.select(this),e)}).on("contextmenu",function(e){e.hasPolicy?e.nodePolicyEvent("contextmenu",d3.select(this),e):t.nodePolicyEvent("contextmenu",d3.select(this),e)}).on("mouseout",function(e){e.hasPolicy?e.nodePolicyEvent("mouseout",d3.select(this),e):t.nodePolicyEvent("mouseout",d3.select(this),e)}).on("mousedown",function(e){e.hasPolicy?e.nodePolicyEvent("mousedown",d3.select(this),e):t.nodePolicyEvent("mousedown",d3.select(this),e)}).on("mouseup",function(e){e.hasPolicy?e.nodePolicyEvent("mouseup",d3.select(this),e):t.nodePolicyEvent("mouseup",d3.select(this),e)}).call(t.drag),e.append("circle").attr("r",function(e){return String(e.radius)}),e.each(function(e){t.insertTitleLinebreaks(d3.select(this),e.text)})}},{key:"d3ForceCollide",value:function(e){var t=this,o=t.consts,n=t.nodes,i=d3.geom.quadtree(n);return function(t){var n=t.radius+o.maxRadius+o.padding,r=t.x-n,a=t.x+n,l=t.y-n,s=t.y+n;i.visit(function(n,i,c,u,d){if(n.point&&n.point!==t){var p=t.x-n.point.x,f=t.y-n.point.y,v=Math.sqrt(p*p+f*f),h=t.radius+n.point.radius+o.padding;h>v&&(v=(v-h)/v*e,t.x-=p*=v,t.y-=f*=v,n.point.x+=p,n.point.y+=f)}return i>a||r>u||c>s||l>d})}}},{key:"d3ForceTick",value:function(e,t,o){for(var n=this,i=n.consts,r=i.displayOffset,a=n.nodes,l=d3.geom.quadtree(n.nodes),s=0,c=a.length;++s<c;)l.visit(this.d3ForceCollide(a[s]));n.circles.each(this.d3ForceCollide(.5)).attr("cx",function(e){return e.x=Math.max(e.radius+r,Math.min(t-r-e.radius,e.x))}).attr("cy",function(e){return e.y=Math.max(e.radius+r,Math.min(o-r-e.radius,e.y))}),n.paths.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y})}},{key:"d3ForceStart",value:function(){var e=this;e.paths.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y})}},{key:"d3ForceEnd",value:function(){var e=this;e.circles.attr("cx",function(e){return e.x}).attr("cy",function(e){return e.y}),e.paths.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y})}},{key:"d3ForceBounds",value:function(){var e=$("#visualization-graph").width(),t=$("#visualization-graph").height(),o=e,n=t;return{width:o,height:n}}},{key:"setForce",value:function(e){var t=this,o=t.nodes,n=t.links;if(!_.isEmpty(o)){var i=t.d3ForceBounds(),r=d3.layout.force().size([i.width,i.height]).nodes(o).charge(function(e){return-6e3}).links(n);r.linkDistance(i.width/3),r.linkStrength(.2),r.gravity(.2),r.on("tick",function(e){t.d3ForceTick.call(t,e,i.width,i.height)}),r.on("start",function(){t.d3ForceStart.call(t)}),r.on("end",function(){t.d3ForceEnd.call(t)}),r.start();for(var a=0;r.alpha()>.01&&150>a;)r.tick(),a+=1;r.stop(),null!=e&&e()}}},{key:"setPositions",value:function(){for(var e=this,t=e.consts.displayOffset,o=$("#visualization-graph").width(),n=$("#visualization-graph").height(),i=o-2*t,r=n-2*t,a=e.nodes,l=0;l<a.length;l++)a[l].radius=a[l].radius||e.consts.startRadius,null!=a[l].x&&null!=a[l].y||(a[l].x=i/2+a[l].radius+t,a[l].y=r/2+a[l].radius+t)}},{key:"updateGraph",value:function(e){var t=this,o=t.consts,n=t.state;if(!t.state.disableUpdate){this.updateExistingNodes();var i=t.circles.enter().append("g");i.classed(o.circleGClass,!0),t.circles.exit().remove(),0==n.initForce?(t.setForce(function(){t.updateNewNodes.call(t,i)}),n.initForce=!0):this.updateNewNodes(i),t.paths=t.paths.data(t.links,function(e){return String(e.source.id)+"+"+String(e.target.id)});var r=t.paths;this.updateExistingPaths(r);var a=r.enter().append("path").style("marker-end","url(#end-arrow)").classed("link",!0);this.updateNewPaths(a),r.exit().remove(),null!=e&&e()}}}]),t}();return{Graph:t}}]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();angular.module("contiv.graph").factory("VisualizerGraph",["Graph",function(e){var t=function(e){function t(e,o,n,i){_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o,n)),a=r;a.state.transition=[],a.consts.edge_buffer=200,a.consts.radiusDecay=1,a.consts.containerClass="container",a.dataSource=i;var l=d3.behavior.drag().origin(function(e){return{x:e.x,y:e.y}}).on("dragstart",function(){}).on("drag",function(e){d3.select(this).attr("transform",function(e,t){return e.x+=d3.event.dx,e.y+=d3.event.dy,"translate("+[e.x,e.y]+")"}),a.updateGraph()}).on("dragend",function(){});a.drag=l;var s=d3.behavior.zoom().on("zoom",function(){return null!=d3.event.sourceEvent&&d3.event.sourceEvent.ctrlKey?!1:(a.zoomed.call(a),!0)}).on("zoomstart",function(e,t){});return a.dragSvg=s,a.svg.call(s).on("dblclick.zoom",null),r}return _inherits(t,e),_createClass(t,[{key:"zoomed",value:function(e,t){var o=this;if(1!=o.state.rightClick){if(this.state.justScaleTransGraph=!0,null!=e&&null!=t){var n=o.dragSvg;n.scale(t),n.translate(e);var i=function(){n.scale(t),n.translate(e)},r="zoom"+e;return void d3.select("."+this.consts.graphClass).transition(r).delay(100).duration(750).attr("transform","translate("+n.translate()+") scale("+n.scale()+")").each("end",i)}o.state.canZoom&&d3.select("."+this.consts.graphClass).attr("transform","translate("+o.dragSvg.translate()+") scale("+o.dragSvg.scale()+")")}}},{key:"onWindowResize",value:function(e){var t=document.getElementsByTagName("body")[0],o=$("#visualization-graph").offset(),n=$("#visualization-graph").width(),i=t.clientHeight;e.attr("width",n).attr("height",i-o.top-20)}},{key:"updateLinkData",value:function(){for(var e=this,t=[],o=0;o<e.nodes.length;o++)t.push(e.nodes[o].id);var n=e.dataSource.getFlowBetweenSet(t),i=n.linkData;e.links=e.dataSource.processLinkData(i,e.nodes),this.initNodes(),this.initLinks(),e.updateGraph()}}]),t}(e.Graph);return{Graph:t}}]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();angular.module("contiv.graph").factory("Link",[function(){var e=function(){function e(t,o){_classCallCheck(this,e),this.source=t,this.target=o,this.hasPolicy=!1,this.pathPolicies=[],this.graph=null,this.initialized=!1}return _createClass(e,[{key:"initialize",value:function(e){0==this.initialized&&(this.initialized=!0,this.graph=e)}},{key:"updateAttr",value:function(e,t){e.style("marker-end","url(#end-arrow)").attr("d",arrowPath)}},{key:"newPathAttr",value:function(e,t){e.attr("d",arrowPath)}},{key:"arrowPath",value:function(){var e=this,t=e.target.x-e.source.x,o=e.target.y-e.source.y,n=Math.sqrt(t*t+o*o);return"M"+e.source.x+","+e.source.y+"A"+n+","+n+" 0 0,1 "+e.target.x+","+e.target.y}},{key:"installPathPolicy",value:function(e){this.hasPolicy=!0,this.pathPolicies.push(e),e.initialize(this.graph)}},{key:"uninstallPathPolicy",value:function(e){var t,o=this;t="string"==typeof e?e:e.policyName,_(o.pathPolicies).forEach(function(e,n){e.policyName===t&&(e.destroy(),o.pathPolicies.splice(n,1))}),0===o.pathPolicies.length&&(o.hasPolicy=!1)}},{key:"pathPolicyEvent",value:function(e,t,o){_(o.pathPolicies).forEach(function(n){n[e](t,o)})}}]),e}();return{Link:e}}]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),_get=function e(t,o,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,o);if(void 0===i){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,o,n)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(n)};angular.module("contiv.graph").factory("VisualizerLink",["Link",function(e){var t=function(e){function t(e,o,n){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o));return i.weight=n,i.count=1,i}return _inherits(t,e),_createClass(t,[{key:"increaseCount",value:function(){this.count+=1}},{key:"qtipHelper",value:function(){var e,t=this,o=(t.target.x-t.source.x)/2,n=(t.target.y-t.source.y)/2;return e=t.source.x<t.target.x?{my:"top center",at:"center center",target:[o,n],adjust:{y:10}}:{my:"bottom center",at:"center center",target:[o,n],adjust:{y:-10}}}},{key:"initialize",value:function(e){if(0==this.initialized){_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e);var o=e.state.VisualizerLink;null==o&&(o=e.state.VisualizerLink={},o.maxWeight=null,o.useAvgWeight=!0),this.updateMaxWeight()}}},{key:"setUseAvgWeight",value:function(e){this.graph.state.VisualizerLink.useAvgWeight=!!e}},{key:"setWeight",value:function(e){this.weight=e}},{key:"getRawWeight",value:function(){return this.weight}},{key:"getWeight",value:function(){var e=this.graph,t=e.state.VisualizerLink;if(t.useAvgWeight){var o=this.weight/this.count;return o}return this.weight}},{key:"updateMaxWeight",value:function(){var e=this.graph,t=e.state.VisualizerLink,o=_.maxBy(e.links,function(e){return null!=e.graph?e.getWeight():0});t.maxWeight=o.getWeight()}},{key:"updateAttr",value:function(e,t){var o=this.graph,n=o.state.VisualizerLink;this.updateMaxWeight();var i=d3.scale.linear().domain([0,n.maxWeight]).range(["#ffb366","#F92606"]);n.colorScale=i,e.style("marker-end","url(#end-arrow)").classed(o.consts.selectedClass,function(e){return e===n.selectedEdge}).attr("d",this.arrowPath.call(t)).transition("existingPathTransition").duration(750).attr("stroke",function(e){var t=i(e.getWeight());return t})}},{key:"newPathAttr",value:function(e,t){var o=this.graph,n=o.state.VisualizerLink;this.updateMaxWeight();var i=d3.scale.linear().domain([0,n.maxWeight]).range(["#ffb366","#F92606"]);e.transition("newPathTransition").duration(750).attrTween("opacity",function(e){return d3.interpolateString(0,1)}).attr("stroke",function(e){var t=i(e.getWeight());return t}).attr("d",this.arrowPath.call(t))}}]),t}(e.Link);return{Link:t}}]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();angular.module("contiv.graph").factory("Node",[function(){var e=function(){function e(t,o,n,i,r){_classCallCheck(this,e),this.x=t,this.y=o,this.radius=r,this.id=n,this.text=i,this.radius=r,this.hasPolicy=!1,this.policy=null,this.nodePolicies=[],this.graph=null,this.initialized=!1}return _createClass(e,[{key:"initialize",value:function(e){0==this.initialized&&(this.initialized=!0,this.graph=e)}},{key:"updateAttr",value:function(e,t){e.attr("transform",function(e){return"translate("+e.x+","+e.y+")"})}},{key:"newNodeAttr",value:function(e,t){}},{key:"setRadius",value:function(e){this.radius=e}},{key:"installNodePolicy",value:function(e){this.hasPolicy=!0,this.nodePolicies.push(e),e.initialize(this.graph)}},{key:"uninstallNodePolicy",value:function(e){var t,o=this;t="string"==typeof e?e:e.policyName,_(o.nodePolicies).forEach(function(e,n){e.policyName===t&&(e.destroy(),o.nodePolicies.splice(n,1))}),0===o.nodePolicies.length&&(o.hasPolicy=!1)}},{key:"nodePolicyEvent",value:function(e,t,o){_.forEach(this.nodePolicies,function(n){n[e](t,o)})}}]),e}();return{Node:e}}]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();angular.module("contiv.graph").factory("VisualizerNode",["Node",function(e){var t=function(e){function t(e,o,n,i,r,a,l,s,c){_classCallCheck(this,t);var u=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o,n,i,r));return u.parent=a,u.ancestors=l,null==s?u.xStart=e:u.xStart=s,null==c?u.yStart=o:u.yStart=c,u}return _inherits(t,e),_createClass(t,[{key:"newNodeAttr",value:function(e,t){var o=this.graph;null!=o.consts.containerClass&&null==o.dataSource.children_struct[t.id]&&e.classed(o.consts.containerClass,!0),e.transition("nodePositionTransition").duration(750).attrTween("transform",function(e){if(null!=e.xStart&&null!=e.yStart){var t=e.xStart,o=e.yStart;return e.xStart=e.x,e.yStart=e.y,d3.interpolateString("translate("+t+","+o+")","translate("+e.x+","+e.y+")")}return d3.interpolateString("translate("+e.x+","+e.y+")","translate("+e.x+","+e.y+")")})}}]),t}(e.Node);return{Node:t}}]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),_get=function t(e,o,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,o);if(void 0===i){var r=Object.getPrototypeOf(e);return null===r?void 0:t(r,o,n)}if("value"in i)return i.value;
var a=i.get;if(void 0!==a)return a.call(n)};angular.module("contiv.graph").factory("NodeSelectionPolicy",["Policy",function(e){var t=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"NodeSelectionPolicy"))}return _inherits(t,e),_createClass(t,[{key:"initialize",value:function(e){if(!this.initialized){_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e);var o=e.state.NodeSelectionPolicy={};o.selectedNodes=[];var n=e.consts.NodeSelectionPolicy={};n.selectedClass="selected";var i=e.drag;i.on("drag",function(t){var o=e;if(null!=o.consts.NodeSelectionPolicy){var n=o.consts.NodeSelectionPolicy.selectedClass,i=d3.selectAll("."+n);-1==i[0].indexOf(this)&&(i.classed(n,!1),i=d3.select(this),i.classed(n,!0)),i.attr("transform",function(e,t){return e.x+=d3.event.dx,e.y+=d3.event.dy,"translate("+[e.x,e.y]+")"}),o.updateGraph()}})}}},{key:"addSelectNode",value:function(e,t){var o=this.graph,n=o.state.NodeSelectionPolicy,i=o.consts.NodeSelectionPolicy;e.classed(i.selectedClass,!0),n.selectedNodes.push(t)}},{key:"removeSelectFromNode",value:function(e,t){var o=this.graph,n=o.state.NodeSelectionPolicy,i=o.consts.NodeSelectionPolicy;o.circles.filter(function(e){return e.id===t.id}).classed(i.selectedClass,!1);var r=n.selectedNodes.indexOf(t);n.selectedNodes.splice(r,1)}},{key:"removeAllSelectedNodes",value:function(){var e=this.graph,t=e.state.NodeSelectionPolicy,o=e.consts.NodeSelectionPolicy;e.circles.classed(o.selectedClass,!1),t.selectedNodes=[]}},{key:"mousedown",value:function(e,t){var o=this.graph,n=o.state.NodeSelectionPolicy;d3.event.stopPropagation(),d3.event.ctrlKey?n.selectedNodes.indexOf(t)>-1?this.removeSelectFromNode(e,t):this.addSelectNode(e,t):-1==n.selectedNodes.indexOf(t)&&this.removeAllSelectedNodes()}},{key:"mouseup",value:function(e,t){var o=this.graph,n=o.state.NodeSelectionPolicy;d3.event.ctrlKey||n.selectedNodes.length<=1&&this.removeSelectFromNode(e,t)}}]),t}(e.Policy);return{Policy:t}}]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();angular.module("contiv.graph").factory("PathChangeViewPolicy",["Policy",function(e){var t=function(e){function t(e){_classCallCheck(this,t);var o=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"PathChangeViewPolicy"));return o.$state=e,o}return _inherits(t,e),_createClass(t,[{key:"generateList",value:function(e){var t=this,o=[],n=function i(e,o){for(var n=t.graph.dataSource.children_struct[e],r=0;r<n.length;r++){var a=n[r];if(t.graph.dataSource.hasChild(a)===!0){var l=i(a,o);o.concat(l)}else o.push(a)}};return n(e,o),o}},{key:"viewEdge",value:function(e){var t=[],o=[],n=e.source.id,i=e.target.id;t=this.graph.dataSource.hasChild(n)===!0?this.generateList(n):[n],o=this.graph.dataSource.hasChild(i)===!0?this.generateList(i):[i],this.$state.go("contiv.menu.visualization.edge",{sourceName:n,targetName:i,sourceList:t,targetList:o})}},{key:"mousedown",value:function(e,t){this.viewEdge(t)}}]),t}(e.Policy);return{Policy:t}}]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();angular.module("contiv.graph").factory("Policy",[function(){var e=function(){function e(t){_classCallCheck(this,e),this.policyName=t,this.graph=null,this.initialized=!1}return _createClass(e,[{key:"initialize",value:function(e){this.initialized||(this.initialized=!0,this.graph=e)}},{key:"mouseover",value:function(e,t){}},{key:"dblclick",value:function(e,t){}},{key:"contextmenu",value:function(e,t){}},{key:"mouseout",value:function(e,t){}},{key:"mousedown",value:function(e,t){}},{key:"mouseup",value:function(e,t){}},{key:"destroy",value:function(){}}]),e}();return{Policy:e}}]),angular.module("contiv.applicationgroups",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.applicationgroups",{url:"/applicationgroups","abstract":!0,template:'<div ui-view class="ui container"/>'})}]),angular.module("contiv.graph").factory("PolicyService",["Policy","QTipPolicy","PathChangeViewPolicy","NodeSelectionPolicy","SplitJoinNodePolicy","SplitJoinViewPolicy","SaveStatePolicy",function(e,t,o,n,i,r,a){return{Policy:e.Policy,QTipPolicy:t.Policy,PathChangeViewPolicy:o.Policy,NodeSelectionPolicy:n.Policy,SplitJoinNodePolicy:i.Policy,SplitJoinViewPolicy:r.Policy,SaveStatePolicy:a.Policy}}]),angular.module("contiv.dashboard",["contiv.models"]).config(["$stateProvider",function(e){e.state("contiv.menu.dashboard",{url:"/dashboard",component:"dashboard"})}]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),_get=function o(e,t,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(void 0===i){var r=Object.getPrototypeOf(e);return null===r?void 0:o(r,t,n)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(n)};angular.module("contiv.graph").factory("QTipPolicy",["Policy",function(e){var t=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"QTipPolicy"))}return _inherits(t,e),_createClass(t,[{key:"initialize",value:function(e){if(!this.initialized){_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e);var o=this,n=e.state.QTipPolicy={};n.mousedown=!1,e.consts.QTipPolicy={},$("#visualization-graph").mouseup(function(e){n.mouseup=!1});var i=e.updateNewNodes;e.updateNewNodes=function(t){i.call(e,t),o.updateNewNodes(t)};var r=e.updateNewPaths;e.updateNewPaths=function(t){r.call(e,t),o.updateNewPaths(t)}}}},{key:"destroy",value:function(){$('[id^="qtip"]').remove()}},{key:"mousedown",value:function(e,t){var o=this.graph,n=o.state.QTipPolicy;n.mousedown=!0}},{key:"mouseup",value:function(e,t){var o=this.graph,n=o.state.QTipPolicy;n.mousedown=!1}},{key:"whenQTipAvailable",value:function(e){var t=this,o=500;window.setTimeout(function(){null!=$(document).qtip?e():window.setTimeout(t.whenQTipAvailable(e),o)},o)}},{key:"updateNewNodes",value:function(e){function t(){e.each(function(e){var t,i=this;if(null!=o.dataSource.children_struct[e.id]){t="<b><u>Selectors:</b></u> ";var r=o.dataSource.selectors[e.id],a=!1;for(var l in r)a=!0,t+=l+" : <i>"+r[l]+"</i>,\n ";a===!1&&(t="No Selectors, ")}else{t="<b><u>Labels:</b></u> ";var s=o.dataSource.labels[e.id],a=!1;for(var l in s)a=!0,t+=l+" : <i>"+s[l]+"</i>,\n ";a===!1&&(t="No labels, ")}t=t.slice(0,-2),$(i).qtip({content:{title:e.id,text:t},events:{show:function(){var t=$(i).qtip("api"),r=$("#graphContainer").offset(),a=[r.left+(e.x*o.dragSvg.scale()+o.dragSvg.translate()[0]),r.top+(e.y+e.radius)*o.dragSvg.scale()+o.dragSvg.translate()[1]];return t.set("position.target",a),!n.mousedown}},show:{delay:0,solo:$("#visualization-graph")},style:{classes:"qtip-blue qtip-shadow"},position:{my:"top center",at:"bottom center"},hide:{event:"mousedown mouseleave"}})})}var o=this.graph,n=o.state.QTipPolicy;void 0!=$(document).qtip?t():this.whenQTipAvailable(t)}},{key:"updateNewPaths",value:function(e){var t=this.graph,o=t.state.QTipPolicy;void 0!=$(document).qtip&&e.each(function(e){var t=this,n=d3.select(this).node(),i=(n.getPointAtLength(n.getTotalLength()/2),e.qtipHelper()),r="Bytes: "+e.getWeight();$(t).qtip({content:{text:r},events:{show:function(){return!o.mousedown}},show:{delay:0,solo:$("#graphContainer")},style:{classes:"qtip-blue qtip-shadow"},position:{my:i.my,at:"center center",target:"mouse",adjust:i.adjust},hide:{event:"mousedown mouseleave"}})})}}]),t}(e.Policy);return{Policy:t}}]),angular.module("contiv.login",["contiv.utils"]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();angular.module("contiv.graph").factory("SaveStatePolicy",["Policy",function(e){var t=function(e){function t(e){_classCallCheck(this,t);var o=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"SaveStatePolicy"));return o.savedState=e,o}return _inherits(t,e),_createClass(t,[{key:"initialize",value:function(e){this.graph=e;var t=this;e.destroy=function(){t.graphDestroy.call(e,t.savedState)},e.load=function(o){t.graphLoad.call(e,o)}}},{key:"graphDestroy",value:function(e){var t=this;_(t.defaultNodePolicies).forEach(function(t){t.destroy(e)}),_(t.defaultPathPolicies).forEach(function(t){t.destroy(e)});for(var o in t.bindings)$(window).off(o,t.bindings[o])}},{key:"graphLoad",value:function(e){var t=this;_(t.defaultNodePolicies).forEach(function(t){null!=t.load&&t.load(e)}),_(t.defaultPathPolicies).forEach(function(t){null!=t.load&&t.load(e)})}}]),t}(e.Policy);return{Policy:t}}]),angular.module("contiv.menu",[]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),_get=function n(e,t,o){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(void 0===i){var r=Object.getPrototypeOf(e);return null===r?void 0:n(r,t,o)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(o)};angular.module("contiv.graph").factory("SplitJoinNodePolicy",["NodeSelectionPolicy","VisualizerNode",function(e,t){var o=function(e){function o(){_classCallCheck(this,o);var e=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return e.policyName="SplitJoinNodePolicy",e}return _inherits(o,e),_createClass(o,[{key:"initialize",value:function(e){if(!this.initialized){_get(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"initialize",this).call(this,e);var t=e.state.SplitJoinNodePolicy={};t.splitNodes=[]}}},{key:"dblclick",value:function(e,t){var o=this.graph,n=o.state.SplitJoinNodePolicy;d3.event.ctrlKey||(n.selectedNodes.indexOf(t)>-1?this.splitMultipleNodes(n.selectedNodes):(this.removeAllSelectedNodes(),this.splitNode(t)))}},{key:"contextmenu",value:function(e,t){var o=this.graph,n=o.state.NodeSelectionPolicy;if(d3.event.preventDefault(),!d3.event.ctrlKey){var i=n.selectedNodes;if(i.indexOf(t)>-1)for(var r=0;r<i.length;r++)this.joinNode(i[r]);else this.removeAllSelectedNodes(),this.joinNode(t)}}},{key:"__splitNode",value:function(e){var o=this.graph,n=o.state.SplitJoinNodePolicy,i=e.id,r=o.dataSource.children_struct;if(void 0!==r[i]&&!_.isEmpty(r[i])){o.nodes=_.filter(o.nodes,function(t){return t!=e}),o.spliceLinksForNode(e);for(var a=[],l=0;l<o.nodes.length;l++)a.push(o.nodes[l].id);for(var s=[],l=0;l<r[i].length;l++)a.push(r[i][l]),s.push(r[i][l]);var c=o.dataSource.getFlowBetweenSet(a),u=e.x,d=e.y,p=e.ancestors.slice();p.splice(0,0,e.id);for(var f=e.id,v=[],h=e.radius*o.consts.radiusDecay,g=c.nodeData,l=0;l<g.length;l++)if(s.indexOf(g[l].id)>-1){var m=g[l].id,y=g[l].text,w=new t.Node(null,null,m,y,h,f,p,u,d);w.initialize(o),o.nodes.push(w),v.push(w)}return o.links=o.dataSource.processLinkData(c.linkData,o.nodes),o.initNodes(),o.initLinks(),n.splitNodes.push(e.id),v}}},{key:"splitNode",value:function(e){var t=this.__splitNode(e);null!=t&&this.splitNodeEvent(t)}},{key:"splitMultipleNodes",value:function(e){for(var t=(this.graph,[]),o=0;o<e.length;o++){var n=this.__splitNode(e[o]);t=t.concat(n)}this.splitMultipleNodesEvent(n)}},{key:"splitNodeEvent",value:function(e){var t=this.graph;t.setPositions(),t.updateGraph()}},{key:"splitMultipleNodesEvent",value:function(e){var t=this.graph;t.setPositions(),t.updateGraph()}},{key:"__joinNode",value:function(e){var o=this.graph,n=o.state.SplitJoinNodePolicy;if(-1!=o.nodes.indexOf(e)){var i=o.dataSource.children_struct,r=e.id;if(!(i.topLevel.indexOf(r)>-1)){for(var a=[],l=[],s=0;s<o.nodes.length;s++)-1==o.nodes[s].ancestors.indexOf(e.parent)?l.push(o.nodes[s].id):a.push(o.nodes[s]);var c=e.parent;l.push(e.parent);var u=e.radius/o.consts.radiusDecay,d=e.x,p=e.y,f=e.ancestors[1],v=e.ancestors.slice(1),h=new t.Node(d,p,c,c,u,f,v);o.nodes.push(h);for(var g=o.dataSource.getFlowBetweenSet(l),s=0;s<a.length;s++){var m=a[s];o.nodes.splice(o.nodes.indexOf(m),1),o.spliceLinksForNode(m)}return o.links=o.dataSource.processLinkData(g.linkData,o.nodes),o.initNodes(),o.initLinks(),n.splitNodes.splice(n.splitNodes.indexOf(h.id),1),h}}}},{key:"joinNode",value:function(e){var t=this.__joinNode(e);null!=t&&this.joinNodeEvent(t)}},{key:"joinMultipleNode",value:function(e){for(var t=[],o=0;o<e.length;o++){var n=this.__joinNode(e[o]);t.push(n)}this.joinMultipleNodesEvent(t)}},{key:"joinNodeEvent",value:function(e){var t=this.graph;t.updateGraph()}},{key:"joinMultipleNodesEvent",value:function(e){var t=this.graph;t.updateGraph()}}]),o}(e.Policy);return{Policy:o}}]),angular.module("contiv.networkpolicies",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies",{url:"/networkpolicies","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.networkpolicies.isolation",{url:"/isolation","abstract":!0,template:"<ui-view/>"}).state("contiv.menu.networkpolicies.isolation.create",{url:"/create",component:"isolationpolicycreate"}).state("contiv.menu.networkpolicies.bandwidth",{url:"/bandwidth","abstract":!0,template:"<ui-view/>"}).state("contiv.menu.networkpolicies.bandwidth.create",{url:"/create",component:"bandwidthpolicycreate"}).state("contiv.menu.networkpolicies.redirection",{url:"/redirection","abstract":!0,template:"<ui-view/>"})}]),angular.module("contiv.networks",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.networks",{url:"/networks","abstract":!0,template:'<div ui-view class="ui container"/>'})}]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),_get=function i(e,t,o){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var r=Object.getPrototypeOf(e);return null===r?void 0:i(r,t,o)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(o)};angular.module("contiv.graph").factory("SplitJoinViewPolicy",["SplitJoinNodePolicy","VisualizerNode",function(e,t){var o=function(e){function o(){_classCallCheck(this,o);var e=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return e.policyName="SplitJoinViewPolicy",e}return _inherits(o,e),_createClass(o,[{key:"initialize",value:function(e){if(!this.initialized){_get(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"initialize",this).call(this,e);var t=e.state.SplitJoinViewPolicy={};t.savedStates=[],t.eventHistory=[],t.focusGroups=[],t.foci=[],t.zooms={},t.layout={},t.layoutDefault=null,t.zoomDefault=null,t.nodeIdsToReshow=null,t.backButtonElem=null,t.titleElem=null;var n=e.consts.SplitJoinViewPolicy={};n.boundary=.8,e.d3ForceBounds=this.d3ForceBounds,e.d3ForceTick=this.d3ForceTick,e.d3ForceStart=this.d3ForceStart,e.d3ForceEnd=this.d3ForceEnd}}},{key:"installBackButton",value:function(e){var t=this.graph,o=this,n=t.state.SplitJoinViewPolicy;n.backButtonElem=e,n.backButton=function(){n.eventHistory.length>0&&o.undoLastEvent.call(o)}}},{key:"installTitle",value:function(e){var t=this.graph,o=t.state.SplitJoinViewPolicy;o.titleElem=e}},{key:"destroy",value:function(e){null!=e&&this.save(e)}},{key:"save",value:function(e){var t=this.graph,o=t.state.SplitJoinViewPolicy,n=t.nodes,i=t.links,r=null;null!=o.titleElem&&(r=o.titleElem.text());var a=o.focusGroups,l=o.eventHistory,s=o.zooms,c=o.layout,u=o.layoutDefault,d=o.zoomDefault,p={nodes:n,links:i,states:o.savedStates,currTitle:r,focusGroups:a,eventHistory:l,zooms:s,layout:c,layoutDefault:u,zoomDefault:d};e.SplitJoinViewPolicy=p}},{key:"load",value:function(e){var t=this,o=this.graph,n=o.state.SplitJoinViewPolicy;e=e.SplitJoinViewPolicy,n.savedStates=e.states,o.links=e.links,o.nodes=e.nodes;var i=e.currTitle;null!=n.titleElem&&n.titleElem.text(i),n.eventHistory=e.eventHistory,n.focusGroups=e.focusGroups,n.zooms=e.zooms,n.layout=e.layout,n.layoutDefault=e.layoutDefault,n.zoomDefault=e.zoomDefault,null!=n.backButtonElem&&n.eventHistory.length>0&&n.backButtonElem.fadeTo("slow",1);var r=o.dataSource.children_struct;_.forEach(o.nodes,function(e){e.SplitJoinViewPolicy={},_.includes(r[n.focusGroups[0]],e.id)?e.SplitJoinViewPolicy.type="focus":e.SplitJoinViewPolicy.type="connected"});var a;if(0===n.focusGroups.length){a=n.layoutDefault;var l=n.zoomDefault;o.zoomed(l[0],l[1])}else{var l=n.zooms[n.focusGroups];null!=l&&o.zoomed(l[0],l[1]),a=n.layout[n.focusGroups]}_.forEach(o.nodes,function(e){var t=a[e.id];null==t&&console.log(a,e),e.x=t.x,e.y=t.y}),o.state.initForce=!0,o.updateGraph.call(o,function(){t.updateGraphCallback.call(t)})}},{key:"dblclick",value:function(e,t){var n=this.graph,i=n.state.SplitJoinViewPolicy,r=t.id,a=n.dataSource.children_struct;if(void 0!==a[r]&&!_.isEmpty(a[r])){if(i.focusGroups.slice(),0===i.focusGroups.length?i.focusGroups.push(t.id):_.includes(a[i.focusGroups[0]],t.id)?i.focusGroups[0]=t.id:1===i.focusGroups.length?i.focusGroups.push(t.id):_.includes(a[i.focusGroups[1]],t.id)&&(i.focusGroups[1]=t.id),2===i.focusGroups.length&&i.focusGroups[1]===t.id){var l=[t],s=[],c=a[i.focusGroups[0]];_.forEach(n.nodes,function(e){_.includes(c,e.id)&&(s.push(e.id),l.push(e))})}else{var l=[t],s=[];_.forEach(n.links,function(e){e.source===t&&-1==s.indexOf(e.target.id)?(e.target.SplitJoinViewPolicy={},e.target.SplitJoinViewPolicy.type="connected",s.push(e.target.id),l.push(e.target)):e.target===t&&-1==s.indexOf(e.source.id)&&(e.source.SplitJoinViewPolicy={},e.source.SplitJoinViewPolicy.type="connected",s.push(e.source.id),l.push(e.source))})}n.circles.each(function(e){e.id!==t.id&&n.spliceLinksForNode(e)}),n.updateGraph(),n.state.disableUpdate=!0,n.circles.each(function(e){e.id!==t.id?d3.select(this).transition().delay(200).duration(400).style("opacity",0):null!=$(this).qtip&&$(this).qtip("disable",!0)});var u=n.dragSvg.translate(),d=n.dragSvg.scale(),p=parseFloat(n.svg.style("width"))/d/2+u[0],f=parseFloat(n.svg.style("height"))/d/2+u[1];t.xStart=t.x,t.yStart=t.y,t.x=p,t.y=f,e.transition("nodePositionTransition").duration(750).attrTween("transform",function(e){var t=e.xStart,o=e.yStart;return e.xStart=e.x,e.yStart=e.y,d3.interpolateString("translate("+t+","+o+")","translate("+e.x+","+e.y+")")});var v=_get(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"splitNode",this);i.nodeIdsToReshow=s;var h=this;setTimeout(function(){n.nodes=l,v.call(h,t)},750)}}},{key:"updateGraphCallback",value:function(){var e=this.graph,t=e.state.SplitJoinViewPolicy;e.circles.each(function(e){d3.select(this).transition().duration(400).style("opacity",1),d3.select(this).classed("focus",!1),d3.select(this).classed("connected",!1),null!=e.SplitJoinViewPolicy&&("focus"===e.SplitJoinViewPolicy.type?d3.select(this).classed("focus",!0):"connected"===e.SplitJoinViewPolicy.type&&d3.select(this).classed("connected",!0))}),t.nodeIdsToReshow=null,e.updateGraph()}},{key:"setPositions",value:function(){function e(e,t){return Math.floor(Math.random()*(t-e+1))+e}var t=this.graph,o=this,n=t.consts,i=n.displayOffset,r=t.nodes,a=o.d3ForceBounds.call(t);_.forEach(r,function(t){if(null==t.x||null==t.y){var o=e(t.radius+i,a.width-t.radius-i),n=e(t.radius+i,a.height-t.radius-i);t.x=o,t.y=n}})}},{key:"d3ForceStart",value:function(){var e=this;e.circles.attr("cx",function(t){return null!=t.xStart&&(t.xStart=t.xStart*e.dragSvg.scale()+e.dragSvg.translate()[0]),t.x}).attr("cy",function(t){return null!=t.yStart&&(t.yStart=t.yStart*e.dragSvg.scale()+e.dragSvg.translate()[1]),t.y}),e.paths.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y})}},{key:"d3ForceEnd",value:function(){var e=this,t=e.state,o=t.SplitJoinViewPolicy;if(null==o.layoutDefault){var n={};_.forEach(e.nodes,function(e){n[e.id]={x:e.x,y:e.y}}),o.layoutDefault=n;var i=e.dragSvg.scale(),r=e.dragSvg.translate();o.zoomDefault=[r,i]}e.circles.attr("cx",function(e){return e.x}).attr("cy",function(e){return e.y}),e.paths.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y})}},{key:"d3ForceTick",value:function(e,t,o){function n(e){return function(n){2===u.length?("focus"===n.SplitJoinViewPolicy.type?n.y+=(u[0]-n.y)*e:n.y+=(u[1]-n.y)*e,n.x+=(t/2-n.x)*e):(n.y+=(o/2-n.y)*e,n.x+=(t/2-n.x)*e)}}var i=this,r=i.state,a=i.consts,l=r.SplitJoinViewPolicy,s=a.displayOffset,c=i.dragSvg.scale(),u=l.foci;i.circles.each(this.d3ForceCollide(.5)).each(n(.2*e.alpha)).attr("cx",function(e){return e.x=Math.max((e.radius+s)/c,Math.min(t+(-s-e.radius)/c,e.x))}).attr("cy",function(e){return null==e.SplitJoinViewPolicy||null==e.SplitJoinViewPolicy?(e.y=Math.max((e.radius+s)/c,Math.min(o+(-s-e.radius)/c,e.y)),e.y):"focus"===e.SplitJoinViewPolicy.type?(e.y=Math.max(e.radius+s,Math.min((o+(-s-e.radius)/c)*a.SplitJoinViewPolicy.boundary,e.y)),e.y):"connected"===e.SplitJoinViewPolicy.type?(e.y=Math.max((o+(s-e.radius)/c)*a.SplitJoinViewPolicy.boundary,Math.min(o+(-s-e.radius)/c,e.y)),e.y):void 0}),i.paths.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y})}},{key:"d3ForceBounds",value:function(){function e(e,o){var n=e*o,i=t.consts.startRadius,r=3.5*i,a=n/(r*r);return a}var t=this,o=t.state,n=t.consts,i=n.SplitJoinViewPolicy,r=o.SplitJoinViewPolicy,a=t.nodes,l=n.displayOffset,s=parseFloat(t.svg.style("width")),c=parseFloat(t.svg.style("height")),u=s,d=c,p=e(u-2*l,d-2*l),f=1;a.length>p?(f=p/a.length,t.zoomed(t.dragSvg.translate(),f),u/=f,d/=f):t.zoomed(t.dragSvg.translate(),f);var v,h=r.focusGroups;if(0===h.length)v=[d/2];else{var g=t.dataSource.children_struct[h[0]];i.boundary=g.length/a.length;var m=d*i.boundary,y=d-m;m<2*t.consts.maxRadius&&(i.boundary=2.5*t.consts.maxRadius/d,m=d*i.boundary,y=d-m),y<2*t.consts.maxRadius&&(i.boundary=1-2.5*t.consts.maxRadius/d,m=d*i.boundary,y=d-m),v=[m/2,m+y/2]}return r.foci=v,{width:u,height:d}}},{key:"splitNodeEvent",value:function(e){var t=this,o=this.graph,n=o.state.SplitJoinViewPolicy,i=o.dataSource.children_struct;_.forEach(e,function(e){e.SplitJoinViewPolicy={},_.includes(i[n.focusGroups[0]],e.id)?e.SplitJoinViewPolicy.type="focus":e.SplitJoinViewPolicy.type="connected"});var r=e[0].parent;if(0!==n.eventHistory.length&&n.eventHistory[n.eventHistory.length-1].id===r?n.eventHistory.pop():n.eventHistory.push({id:r,event:"split"}),null!=n.backButtonElem&&0!==n.eventHistory.length&&n.backButtonElem.fadeTo("slow",1),null!=n.titleElem){var a="";n.focusGroups.length>0&&(a+=n.focusGroups[0]),2===n.focusGroups.length&&(a+=" & "+n.focusGroups[1]),n.titleElem.text(a)}o.state.disableUpdate=!1,t.setLayout()}},{key:"setLayout",value:function(){var e,t=this,o=this.graph,n=o.state.SplitJoinViewPolicy;if(0===n.focusGroups.length){e=n.layoutDefault;var i=n.zoomDefault;o.zoomed(i[0],i[1])}else{var i=n.zooms[n.focusGroups];null!=i&&o.zoomed(i[0],i[1]),e=n.layout[n.focusGroups]}if(null!=e)_.forEach(o.nodes,function(t){var o=e[t.id];null==o&&console.log(e,t),t.x=o.x,t.y=o.y}),o.updateGraph.call(o,function(){t.updateGraphCallback.call(t)});else{o.state.initForce=!1,o.updateGraph(function(){t.updateGraphCallback.call(t)}),n.zooms[n.focusGroups]=[o.dragSvg.translate(),o.dragSvg.scale()];var e={};_.forEach(o.nodes,function(t){e[t.id]={x:t.x,y:t.y}}),n.layout[n.focusGroups]=e}}},{key:"__joinNode",value:function(e){var o=this.graph,n=o.state.SplitJoinNodePolicy,i=o.state.SplitJoinViewPolicy;if(-1!=o.nodes.indexOf(e)){var r=o.dataSource.children_struct,a=e.id;if(!(r.topLevel.indexOf(a)>-1)){for(var l=e.parent,s=[],c=[],u=0;u<o.nodes.length;u++)-1==o.nodes[u].ancestors.indexOf(e.parent)?c.push(o.nodes[u].id):s.push(o.nodes[u]);var d=e.parent;c.push(e.parent);var p=o.dataSource.ancestors_struct,r=o.dataSource.children_struct,f=i.focusGroups.indexOf(l);null!=p[l]?i.focusGroups[f]=p[l]:i.focusGroups.splice(f,1);var v=[];if(1===i.focusGroups.length){var h=p[e.id];h.push(i.focusGroups[0]),h=h.concat(p[i.focusGroups[0]]||[]),_.forEach(r.topLevel,function(e){-1===h.indexOf(e)&&-1==c.indexOf(e)&&v.push(e)}),c=c.concat(v)}else 0===i.focusGroups.length&&(_.forEach(r.topLevel,function(e){-1==c.indexOf(e)&&v.push(e)}),c=c.concat(v));var g=e.radius/o.consts.radiusDecay,m=e.x,y=e.y,l=e.ancestors[1],h=e.ancestors.slice(1),w=new t.Node(m,y,d,d,g,l,h);o.nodes.push(w);for(var u=0;u<s.length;u++){var b=s[u];o.nodes.splice(o.nodes.indexOf(b),1),o.spliceLinksForNode(b)}for(var P=o.dataSource.getFlowBetweenSet(c),S=[],k=P.nodeData,u=0;u<k.length;u++)-1!==v.indexOf(k[u].id)&&S.push(k[u]);var E=o.dataSource.processNodeData(S);_.forEach(E,function(e){e.radius=e.radius||o.consts.startRadius}),o.nodes=o.nodes.concat(E),o.links=o.dataSource.processLinkData(P.linkData,o.nodes),1===i.focusGroups.length?_.forEach(o.links,function(e){-1!==v.indexOf(e.source.id)?i.focusGroups[0]===e.target.parent&&v.splice(v.indexOf(e.source.id),1):-1!==v.indexOf(e.target.id)&&i.focusGroups[0]===e.source.parent&&v.splice(v.indexOf(e.target.id),1)}):v=[];var N=[];if(0!==v.length)for(var u=0;u<o.nodes.length&&(-1===v.indexOf(o.nodes[u].id)||(v.splice(v.indexOf(o.nodes[u].id),1),o.spliceLinksForNode(o.nodes[u]),N.push(o.nodes[u]),0!==v.length));u++);return _.forEach(N,function(e){o.nodes.splice(o.nodes.indexOf(e),1)}),o.initNodes(),o.initLinks(),n.splitNodes.splice(n.splitNodes.indexOf(w.id),1),w}}}},{key:"joinNodeEvent",value:function(e){var t=this.graph,o=this,n=t.state.SplitJoinViewPolicy;0!==n.eventHistory.length&&n.eventHistory[n.eventHistory.length-1].id===e.id?n.eventHistory.pop():n.eventHistory.push({id:e.id,event:"join"});var i=t.dataSource.children_struct;if(_.forEach(t.nodes,function(e){e.SplitJoinViewPolicy={},_.includes(i[n.focusGroups[0]],e.id)?e.SplitJoinViewPolicy.type="focus":e.SplitJoinViewPolicy.type="connected"}),null!=n.backButtonElem&&0===n.eventHistory.length&&n.backButtonElem.fadeTo("slow",0),null!=n.titleElem){var r="";n.focusGroups.length>0&&(r+=n.focusGroups[0]),2===n.focusGroups.length&&(r+=" & "+n.focusGroups[1]),n.titleElem.text(r)}o.setLayout()}},{key:"undoLastEvent",value:function(){var e,t=this.graph,n=this,i=t.state.SplitJoinViewPolicy,r=i.eventHistory[i.eventHistory.length-1],a=r.id;if("join"===r.event){e=t.findNodeById(a);var l=t.findD3Node(a);n.dblclick(l,e)}else{var s=t.dataSource.children_struct[a][0];e=t.findNodeById(s),_get(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"joinNode",this).call(n,e)}}}]),o}(e.Policy);return{Policy:o}}]),angular.module("contiv.nodes",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.nodes",{url:"/nodes","abstract":!0,template:'<div ui-view class="ui container"/>'})}]),angular.module("contiv.organizations",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.organizations",{url:"/organizations","abstract":!0,template:'<div ui-view class="ui container"/>'})}]),angular.module("contiv.servicelbs",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.servicelbs",{url:"/servicelbs","abstract":!0,template:'<div ui-view class="ui container"/>'})}]),angular.module("contiv.settings",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.settings",{url:"/global","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.settings.details",{url:"/settings",templateUrl:"settings/settingsmenu.html"}).state("contiv.menu.settings.details.logs",{url:"/logs",controller:"",templateUrl:""}).state("contiv.menu.settings.details.auth",{url:"/auth",controller:"",templateUrl:""}).state("contiv.menu.settings.details.license",{url:"/license",controller:"",templateUrl:""}).state("contiv.menu.settings.details.policies",{url:"/policies",controller:"",templateUrl:""})}]),angular.module("contiv.storagepolicies",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.storagepolicies",{url:"/storagepolicies","abstract":!0,template:'<div ui-view class="ui container"/>'})}]),angular.module("contiv.visualization",["contiv.models","contiv.directives","contiv.utils","contiv.graph"]).config(["$stateProvider",function(e){e.state("contiv.menu.visualization",{url:"/visualization","abstract":!0,template:'<div ui-view class="ui container"/>'})}]),angular.module("contiv.volumes",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.volumes",{url:"/volumes","abstract":!0,template:'<div ui-view class="ui container"/>'})}]),angular.module("contivApp",["ui.router","contiv.login","contiv.menu","contiv.dashboard","contiv.applicationgroups","contiv.networks","contiv.networkpolicies","contiv.storagepolicies","contiv.servicelbs","contiv.volumes","contiv.nodes","contiv.organizations","contiv.settings","contiv.visualization"]).config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("contiv",{url:"","abstract":!0,template:'<div ui-view class="ui fluid container"/>'}),t.otherwise("/")}]),angular.module("contiv.applicationgroups").config(["$stateProvider",function(e){e.state("contiv.menu.applicationgroups.create",{url:"/create",controller:"ApplicationGroupCreateCtrl as applicationGroupCreateCtrl",templateUrl:"applicationgroups/applicationgroupcreate.html"})}]).controller("ApplicationGroupCreateCtrl",["$state","$stateParams","ApplicationGroupsModel","NetworksModel","CRUDHelperService",function(e,t,o,n,i){function r(){e.go("contiv.menu.applicationgroups.list")}function a(){r()}function l(){n.get().then(function(e){u.networks=_.filter(e,{tenantName:"default"})})}function s(){u.form.$valid&&(i.hideServerError(u),i.startLoader(u),u.applicationGroup.networkName=u.selectedNetwork.networkName,u.applicationGroup.key=o.generateKey(u.applicationGroup),o.create(u.applicationGroup).then(function(e){i.stopLoader(u),r()},function(e){i.stopLoader(u),i.showServerError(u,e)}))}function c(){i.stopLoader(u),i.hideServerError(u),u.applicationGroup={groupName:"",networkName:"",policies:[],netProfile:"",tenantName:"default"}}var u=this;u.networks=[],u.applicationGroup={},u.selectedNetwork={},u.mode="edit",l(),u.createApplicationGroup=s,u.cancelCreating=a,c()}]),angular.module("contiv.applicationgroups").config(["$stateProvider",function(e){e.state("contiv.menu.applicationgroups.details",{url:"/details/:key",controller:"ApplicationGroupDetailsCtrl as applicationGroupDetailsCtrl",templateUrl:"applicationgroups/applicationgroupdetails.html"}).state("contiv.menu.applicationgroups.edit",{url:"/edit/:key",controller:"ApplicationGroupDetailsCtrl as applicationGroupDetailsCtrl",templateUrl:"applicationgroups/applicationgroupdetails.html"})}]).controller("ApplicationGroupDetailsCtrl",["$state","$stateParams","ApplicationGroupsModel","CRUDHelperService",function(e,t,o,n){function i(){e.is("contiv.menu.applicationgroups.edit")?u.mode="edit":u.mode="details";
}function r(){e.go("contiv.menu.applicationgroups.list")}function a(){e.go("contiv.menu.applicationgroups.details",{key:u.applicationGroup.key})}function l(){a()}function s(){n.hideServerError(u),n.startLoader(u),o["delete"](u.applicationGroup).then(function(e){n.stopLoader(u),r()},function(e){n.stopLoader(u),n.showServerError(u,e)})}function c(){n.hideServerError(u),n.startLoader(u),o.save(u.applicationGroup).then(function(e){n.stopLoader(u),a()},function(e){n.stopLoader(u),n.showServerError(u,e)})}var u=this;u.applicationGroup={},u.selectedNetwork={},n.stopLoader(u),n.hideServerError(u),o.getModelByKey(t.key).then(function(e){u.applicationGroup=e}),u.saveApplicationGroup=c,u.cancelEditing=l,u.deleteApplicationGroup=s,i()}]),angular.module("contiv.applicationgroups").config(["$stateProvider",function(e){e.state("contiv.menu.applicationgroups.list",{url:"/list",controller:"ApplicationGroupListCtrl as applicationGroupListCtrl",templateUrl:"applicationgroups/applicationgrouplist.html"})}]).controller("ApplicationGroupListCtrl",["$scope","$interval","$filter","ApplicationGroupsModel","CRUDHelperService",function(e,t,o,n,i){function r(e){n.get(e).then(function(e){i.stopLoader(a),a.groups=e},function(e){i.stopLoader(a)})}var a=this;r(!1);var l;angular.isDefined(l)||(l=t(function(){r(!0)},5e3)),e.$on("$destroy",function(){t.cancel(l)})}]),angular.module("contiv.applicationgroups").directive("ctvBandwidthpolicy",function(){return{restrict:"E",scope:{mode:"=",applicationgroup:"="},controller:["$scope","NetprofilesModel",function(e,t){function o(){t.get().then(function(t){e.netProfiles=_.filter(t,{tenantName:"default"}),""!==e.applicationgroup.netProfile&&(e.selectedNetprofile.policy=_.find(e.netProfiles,function(t){return t.profileName===e.applicationgroup.netProfile}))})}e.netProfiles=[],e.selectedNetprofile={policy:{}},e.updateApplicationgroup=function(){null===e.selectedNetprofile.policy?e.applicationgroup.netProfile="":e.applicationgroup.netProfile=e.selectedNetprofile.policy.profileName},o()}],templateUrl:"applicationgroups/bandwidthpolicy.html"}}),angular.module("contiv.applicationgroups").directive("ctvIsolationpolicy",function(){return{restrict:"E",scope:{mode:"=",applicationgroup:"="},controller:["$scope","$stateParams","ApplicationGroupsModel","PoliciesModel","RulesModel",function(e,t,o,n,i){function r(){e.applicationgroup.policies.forEach(function(t){i.getIncomingRules(t,"default").then(function(t){Array.prototype.push.apply(e.incomingRules,t)}),i.getOutgoingRules(t,"default").then(function(t){Array.prototype.push.apply(e.outgoingRules,t)})})}function a(){n.get().then(function(t){e.isolationPolicies=_.filter(t,{tenantName:"default"})})}e.incomingRules=[],e.outgoingRules=[],e.selectedPolicy={policy:{}},e.selectedPolicies=[],e.isolationPolicies=[],e.addIsolationPolicy=function(){var t=e.selectedPolicy.policy.policyName;void 0!==t&&0==_.includes(e.selectedPolicies,t)&&(e.selectedPolicies.push(t),i.getIncomingRules(t,"default").then(function(t){Array.prototype.push.apply(e.incomingRules,t)}),i.getOutgoingRules(t,"default").then(function(t){Array.prototype.push.apply(e.outgoingRules,t)}),e.applicationgroup.policies.push(t))},e.removeIsolationPolicy=function(t){_.remove(e.selectedPolicies,function(e){return e===t}),_.remove(e.applicationgroup.policies,function(e){return e===t}),_.remove(e.incomingRules,function(e){return e.policyName===t}),_.remove(e.outgoingRules,function(e){return e.policyName===t})},("details"==e.mode||"edit"==e.mode&&""!=e.applicationgroup.groupName)&&(void 0===e.applicationgroup.policies&&(e.applicationgroup.policies=[]),r()),a()}],templateUrl:"applicationgroups/isolationpolicy.html"}}),angular.module("contiv.login").config(["$stateProvider",function(e){e.state("contiv.login",{url:"/",templateUrl:"login/login.html",controller:"LoginCtrl as loginCtrl"})}]).controller("LoginCtrl",["$state","CRUDHelperService",function(e,t){function o(){e.go("contiv.menu.dashboard",{username:i.username})}function n(){o()}var i=this;t.stopLoader(i),t.hideServerError(i),i.login=n}]),angular.module("contiv.menu").config(["$stateProvider",function(e){e.state("contiv.menu",{url:"/m",templateUrl:"menu/menu.html",controller:"MenuCtrl as menuCtrl",params:{username:null}})}]).controller("MenuCtrl",["$state","$stateParams",function(e,t){function o(){e.go("contiv.login")}var n=this;n.username=t.username,n.logout=o}]),angular.module("contiv.networkpolicies").directive("ctvBandwidth",function(){return{restrict:"E",scope:{bandwidthPolicy:"=",mode:"@"},link:function(e){if(""!=e.bandwidthPolicy.bandwidth){var t=e.bandwidthPolicy.bandwidth.split(" ");e.bandwidthPolicy.bandwidthNumber=Number(t[0]),e.bandwidthPolicy.bandwidthUnit=t[1]}},templateUrl:"network_policies/bandwidth.html"}}),angular.module("contiv.networkpolicies").config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies.bandwidth.details",{url:"/details/:key",controller:"BandwidthPolicyDetailsCtrl as bandwidthPolicyDetailsCtrl",templateUrl:"network_policies/bandwidthpolicydetails.html"})}]).config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies.bandwidth.edit",{url:"/edit/:key",controller:"BandwidthPolicyDetailsCtrl as bandwidthPolicyDetailsCtrl",templateUrl:"network_policies/bandwidthpolicydetails.html"})}]).controller("BandwidthPolicyDetailsCtrl",["$state","$stateParams","NetprofilesModel","CRUDHelperService",function(e,t,o,n){function i(){e.is("contiv.menu.networkpolicies.bandwidth.edit")?u.mode="edit":u.mode="details"}function r(){n.hideServerError(u),n.startLoader(u),o.deleteUsingKey(u.policy.key,"name").then(function(e){n.stopLoader(u),a()},function(e){n.stopLoader(u),n.showServerError(u,e)})}function a(){e.go("contiv.menu.networkpolicies.list.bandwidth")}function l(){e.go("contiv.menu.networkpolicies.bandwidth.details",{key:u.policy.key})}function s(){l()}function c(){u.form.$valid&&(n.hideServerError(u),n.startLoader(u),u.policy.bandwidth=u.policy.bandwidthNumber+" "+u.policy.bandwidthUnit,o.save(u.policy).then(function(e){n.stopLoader(u),l()},function(e){n.stopLoader(u),n.showServerError(u,e)}))}var u=this;u.bandwidthProfiles=[],o.getModelByKey(t.key).then(function(e){u.policy=e}),n.stopLoader(u),n.hideServerError(u),i(),u.deletePolicy=r,u.savePolicy=c,u.cancelEditing=s}]),angular.module("contiv.networkpolicies").config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies.list.bandwidth",{url:"/bandwidth",controller:"BandwidthPolicyListCtrl as bandwidthPolicyListCtrl",templateUrl:"network_policies/bandwidthpolicylist.html"})}]).controller("BandwidthPolicyListCtrl",["$scope","$interval","$filter","NetprofilesModel","CRUDHelperService",function(e,t,o,n,i){function r(e){n.get(e).then(function(e){i.stopLoader(a),a.policies=o("orderBy")(e,"profileName")},function(e){i.stopLoader(a)})}var a=this;r(!0);var l;angular.isDefined(l)||(l=t(function(){r(!0)},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(l)})}]),angular.module("contiv.networkpolicies").config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies.isolation.details",{url:"/details/:key",controller:"IsolationPolicyDetailsCtrl as isolationPolicyDetailsCtrl",templateUrl:"network_policies/isolationpolicydetails.html"})}]).config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies.isolation.edit",{url:"/edit/:key",controller:"IsolationPolicyDetailsCtrl as isolationPolicyDetailsCtrl",templateUrl:"network_policies/isolationpolicydetails.html"})}]).controller("IsolationPolicyDetailsCtrl",["$state","$stateParams","PoliciesModel","RulesModel","NetworksModel","ApplicationGroupsModel","CRUDHelperService",function(e,t,o,n,i,r,a){function l(){e.go("contiv.menu.networkpolicies.list.isolation")}function s(){e.go("contiv.menu.networkpolicies.isolation.details",{key:D.policy.key})}function c(){s()}function u(){s()}function d(){a.hideServerError(D),a.startLoader(D),o["delete"](D.policy).then(function(e){a.stopLoader(D),l()},function(e){a.stopLoader(D),a.showServerError(D,e)})}function p(){e.is("contiv.menu.networkpolicies.isolation.edit")?D.mode="edit":D.mode="details"}function f(){D.newIncomingRule={ruleId:"",priority:1,action:"allow",fromEndpointGroup:"",fromNetwork:"",fromIpAddress:"",protocol:"tcp",port:0,direction:"in",tenantName:"default",policyName:D.policy.policyName},D.newIncomingSelectedApplicationGroup="",D.newIncomingSelectedNetwork="",D.disableIncomingNetworkSelection=!1,D.disableIncomingApplicationGroupSelection=!1,D.disableIncomingIPAddressSelection=!1,D.incorrectCIDR=!1,D.validateCIDRFlag=!1}function v(){D.newOutgoingRule={ruleId:"",priority:1,action:"allow",toEndpointGroup:"",toNetwork:"",toIpAddress:"",protocol:"tcp",port:0,direction:"out",tenantName:"default",policyName:D.policy.policyName},D.newOutgoingSelectedApplicationGroup="",D.newOutgoingSelectedNetwork="",D.disableOutgoingNetworkSelection=!1,D.disableOutgoingApplicationGroupSelection=!1,D.disableOutgoingIPAddressSelection=!1,D.incorrectCIDR=!1,D.validateCIDRFlag=!1}function h(){i.get().then(function(e){D.networks=_.filter(e,{tenantName:"default"})})}function g(){r.get().then(function(e){D.applicationGroups=_.filter(e,{tenantName:"default"})})}function m(){null!=D.newOutgoingSelectedApplicationGroup?(D.newOutgoingRule.toEndpointGroup=D.newOutgoingSelectedApplicationGroup.groupName,D.newOutgoingRule.toNetwork="",D.disableOutgoingNetworkSelection=!0):(D.newOutgoingRule.toEndpointGroup="",D.disableOutgoingNetworkSelection=!1)}function y(){null!=D.newIncomingSelectedApplicationGroup?(D.newIncomingRule.fromEndpointGroup=D.newIncomingSelectedApplicationGroup.groupName,D.newIncomingRule.fromNetwork="",D.disableIncomingNetworkSelection=!0):(D.newIncomingRule.fromEndpointGroup="",D.disableOutgoingApplicationGroupSelection=!1,D.disableIncomingNetworkSelection=!1)}function w(){null!=D.newOutgoingSelectedNetwork?(D.newOutgoingRule.toNetwork=D.newOutgoingSelectedNetwork,D.newOutgoingRule.ToEndpointGroup="",D.disableOutgoingApplicationGroupSelection=!0,D.disableOutgoingIPAddressSelection=!0):(D.newOutgoingRule.toIpAddress="",D.disableOutgoingApplicationGroupSelection=!1,D.disableOutgoingIPAddressSelection=!1)}function b(){null!=D.newIncomingSelectedNetwork?(D.newIncomingRule.fromNetwork=D.newIncomingSelectedNetwork,D.newIncomingRule.fromEndpointGroup="",D.disableIncomingApplicationGroupSelection=!0,D.disableIncomingIPAddressSelection=!0):(D.newIncomingRule.fromNetwork="",D.disableIncomingApplicationGroupSelection=!1,D.disableIncomingIPAddressSelection=!1)}function P(e){e.ruleId=(D.incomingRules.length+D.outgoingRules.length+1).toString()+"-"+Date.now().toString()}function S(){N(D.newIncomingRule.fromIpAddress)&&(a.hideServerError(D),a.startLoader(D),P(D.newIncomingRule),D.newIncomingRule.key=n.generateKey(D.newIncomingRule),n.create(D.newIncomingRule).then(function(e){a.stopLoader(D),D.incomingRules.push(e),f()},function(e){a.stopLoader(D),a.showServerError(D,e)}))}function k(){""==D.newIncomingRule.fromIpAddress?(D.incorrectCIDR=!1,D.disableIncomingNetworkSelection=!1):D.disableIncomingNetworkSelection=!0,D.validateCIDRFlag&&D.incorrectCIDR&&N(D.newIncomingRule.fromIpAddress)}function E(){""==D.newOutgoingRule.toIpAddress?(D.incorrectCIDR=!1,D.disableOutgoingNetworkSelection=!1):D.disableOutgoingNetworkSelection=!0,D.validateCIDRFlag&&D.incorrectCIDR&&N(D.newOutgoingRule.toIpAddress)}function N(e){var t=new RegExp(ContivGlobals.CIDR_REGEX);return""==e?!0:t.test(e)?(D.incorrectCIDR=!1,!0):(D.incorrectCIDR=!0,D.validateCIDRFlag=!0,!1)}function C(){N(D.newOutgoingRule.toIpAddress)&&(a.hideServerError(D),a.startLoader(D),P(D.newOutgoingRule),D.newOutgoingRule.key=n.generateKey(D.newOutgoingRule),n.create(D.newOutgoingRule).then(function(e){a.stopLoader(D),D.outgoingRules.push(e),v()},function(e){a.stopLoader(D),a.showServerError(D,e)}))}function O(e){a.hideServerError(D),a.startLoader(D),n.deleteUsingKey(e).then(function(t){a.stopLoader(D),_.remove(D.incomingRules,function(t){return t.key==e})},function(e){a.stopLoader(D),a.showServerError(D,e)})}function L(e){a.hideServerError(D),a.startLoader(D),n.deleteUsingKey(e).then(function(t){a.stopLoader(D),_.remove(D.outgoingRules,function(t){return t.key==e})},function(e){a.stopLoader(D),a.showServerError(D,e)})}var D=this;D.networks=[],D.applicationGroups=[],D.disableOutgoingNetworkSelection=!1,D.disableIncomingNetworkSelection=!1,D.disableOutgoingApplicationGroupSelection=!1,D.disableIncomingApplicationGroupSelection=!1,D.disableIncomingIPAddressSelection=!1,D.disableOutgoingIPAddressSelection=!1,D.newIncomingSelectedApplicationGroup="",D.newOutgoingSelectedApplicationGroup="",D.newIncomingSelectedNetwork="",D.newOutgoingSelectedNetwork="",D.incorrectCIDR=!1,D.validateCIDRFlag=!1,a.stopLoader(D),a.hideServerError(D),o.getModelByKey(t.key).then(function(e){D.policy=e,n.getIncomingRules(e.policyName,"default").then(function(e){D.incomingRules=e,f()}),n.getOutgoingRules(e.policyName,"default").then(function(e){D.outgoingRules=e,v()})}),h(),g(),D.deletePolicy=d,D.deleteIncomingRule=O,D.deleteOutgoingRule=L,D.addIncomingRule=S,D.addOutgoingRule=C,D.doneEditing=u,D.cancelEditing=c,D.onChangeOutgoingApplicationGroupSelection=m,D.onChangeIncomingApplicationGroupSelection=y,D.onChangeOutgoingNetworkSelection=w,D.onChangeIncomingNetworkSelection=b,D.onChangeIncomingIPAddress=k,D.onChangeOutgoingIPAddress=E,p()}]),angular.module("contiv.networkpolicies").config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies.list.isolation",{url:"/isolation",controller:"IsolationPolicyListCtrl as isolationPolicyListCtrl",templateUrl:"network_policies/isolationpolicylist.html"})}]).controller("IsolationPolicyListCtrl",["$scope","$interval","$filter","PoliciesModel","CRUDHelperService",function(e,t,o,n,i){function r(e){n.get(e).then(function(e){i.stopLoader(a),a.policies=o("orderBy")(e,"policyName")},function(e){i.stopLoader(a)})}var a=this;r(!1);var l;angular.isDefined(l)||(l=t(function(){r(!0)},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(l)})}]),angular.module("contiv.networkpolicies").config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies.list",{url:"/list","abstract":!0,controller:"NetworkPoliciesTabsCtrl as networkPoliciesTabsCtrl",templateUrl:"network_policies/networkpoliciestabs.html"}).state("contiv.menu.networkpolicies.list.redirection",{url:"/redirection",template:""})}]).controller("NetworkPoliciesTabsCtrl",["$state",function(e){function t(){e.$current.includes["contiv.menu.networkpolicies.list.isolation"]&&e.go("contiv.menu.networkpolicies.isolation.create"),e.$current.includes["contiv.menu.networkpolicies.list.bandwidth"]&&e.go("contiv.menu.networkpolicies.bandwidth.create")}var o=this;o.createNetworkPolicy=t}]),angular.module("contiv.networks").config(["$stateProvider",function(e){e.state("contiv.menu.networks.create",{url:"/create",templateUrl:"networks/networkcreate.html",controller:"NetworkCreateCtrl as networkCreateCtrl"})}]).controller("NetworkCreateCtrl",["$state","$stateParams","NetworksModel","CRUDHelperService",function(e,t,o,n){function i(){e.go("contiv.menu.networks.list")}function r(){i()}function a(){s.form.$valid&&(n.hideServerError(s),n.startLoader(s),s.newNetwork.key=s.newNetwork.tenantName+":"+s.newNetwork.networkName,o.create(s.newNetwork).then(function(e){n.stopLoader(s),i()},function(e){n.stopLoader(s),n.showServerError(s,e)}))}function l(){n.stopLoader(s),n.hideServerError(s),s.newNetwork={networkName:"",encap:"vxlan",subnet:"",gateway:"",tenantName:"default"}}var s=this;s.cidrPattern=ContivGlobals.CIDR_REGEX,s.createNetwork=a,s.cancelCreating=r,l()}]),angular.module("contiv.networks").config(["$stateProvider",function(e){e.state("contiv.menu.networks.details",{url:"/details/:key",controller:"NetworkDetailsCtrl as networkDetailsCtrl",templateUrl:"networks/networkdetails.html"}).state("contiv.menu.networks.details.info",{url:"/info",templateUrl:"networks/networkinfo.html"})}]).controller("NetworkDetailsCtrl",["$state","$stateParams","$scope","$interval","$filter","NetworksModel","ApplicationGroupsModel","CRUDHelperService",function(e,t,o,n,i,r,a,l){function s(){e.go("contiv.menu.networks.list")}function c(){l.hideServerError(d),l.startLoader(d),r["delete"](d.network).then(function(e){l.stopLoader(d),s()},function(e){l.stopLoader(d),l.showServerError(d,e)})}function u(e){a.get(e).then(function(e){d.applicationGroups=i("orderBy")(_.filter(e,{networkName:d.network.networkName}),"groupName")})}var d=this;l.stopLoader(d),l.hideServerError(d),r.getModelByKey(t.key).then(function(e){d.network=e,u(!1)}),d.deleteNetwork=c;var p;angular.isDefined(p)||(p=n(function(){u(!0)},ContivGlobals.REFRESH_INTERVAL)),o.$on("$destroy",function(){n.cancel(p)})}]);var NetworksListCtrl=function(){function e(e,t,o,n){function i(e){o.get(e).then(function(e){n.stopLoader(r),r.networks=e},function(e){n.stopLoader(r)})}var r=this;i(!1);var a;angular.isDefined(a)||(a=t(function(){i(!0)},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(a)})}return e.$inject=["$scope","$interval","NetworksModel","CRUDHelperService"],e}();angular.module("contiv.networks").config(["$stateProvider",function(e){e.state("contiv.menu.networks.list",{url:"/list",component:"networkList"})}]).component("networkList",{templateUrl:"networks/networklist.html",controller:NetworksListCtrl,controllerAs:"networksListCtrl"}),angular.module("contiv.networks").config(["$stateProvider",function(e){e.state("contiv.menu.networks.details.stats",{url:"/stats",controller:"NetworkStatsCtrl as networkStatsCtrl",templateUrl:"networks/networkstats.html"})}]).controller("NetworkStatsCtrl",["$state","$stateParams","$scope","$interval","$filter","NetworksModel","InspectService",function(e,t,o,n,i,r,a){function l(e){r.getInspectByKey(t.key,ContivGlobals.NETWORKS_INSPECT_ENDPOINT,e).then(function(e){if(s.networkInspectStats=e.Oper,s.config=e.Config,void 0!=e.Oper.endpoints){var t=a.buildEndPoints(e.Oper.endpoints);a.checkContainerChanged(s.containerDetails,t)&&(s.endpoints=e.Oper.endpoints,s.containerDetails=t)}else s.endpoints=[],s.containerDetails={}})}var s=this;l(!1);var c;angular.isDefined(c)||(c=n(function(){l(!0)},ContivGlobals.REFRESH_INTERVAL)),o.$on("$destroy",function(){n.cancel(c)})}]),angular.module("contiv.nodes").factory("BgpService",["$http","$q",function(e,t){function o(o){var n=t.defer(),i=ContivGlobals.BGPS_ENDPOINT+o.key+"/";return e.get(i).then(function(e){n.resolve(e.data),o.neighbor=e.data,o.neighbors.push({name:o.neighbor.neighbor,value:o.neighbor["neighbor-as"]})},function(e){n.reject(e.data)}),n.promise}function n(t){var o=ContivGlobals.BGPS_ENDPOINT+t.key+"/";return e.post(o,t.neighbor)}function i(o){var n=t.defer(),i=ContivGlobals.BGPS_INSPECT_ENDPOINT+o+"/";return e.get(i).then(function(e){n.resolve(e.data)},function(e){n.reject(e.data)}),n.promise}return{getBgp:o,updateBgp:n,getBgpInspect:i}}]),angular.module("contiv.nodes").directive("ctvLogs",function(){return{restrict:"E",templateUrl:"nodes/logs.html",scope:{log:"=",title:"@"}}}),angular.module("contiv.nodes").factory("LogService",["$http","$q",function(e,t){function o(){var o=t.defer(),n=ContivGlobals.NODES_ACTIVE_JOB_ENDPOINT;return e.get(n).then(function(e){o.resolve(e.data)},function(e){o.reject(e.data)}),o.promise}function n(){var o=t.defer(),n=ContivGlobals.NODES_LAST_JOB_ENDPOINT;return e.get(n).then(function(e){o.resolve(e.data)},function(e){o.reject(e.data)}),o.promise}return{getActiveLogs:o,getLastLogs:n}}]),angular.module("contiv.nodes").config(["$stateProvider",function(e){e.state("contiv.menu.nodes.activelog",{url:"/activelog",controller:"NodeActiveJobLogsCtrl as nodeActiveJobLogsCtrl",template:'<ctv-logs title="Active Job" log="nodeActiveJobLogsCtrl.activeLogs"></ctv-logs>'})}]).controller("NodeActiveJobLogsCtrl",["$scope","$interval","LogService",function(e,t,o){function n(){o.getActiveLogs().then(function(e){i.activeLogs=e},function(e){i.activeLogs={desc:"There is currently no active job. Check Last Job for a job that recently finished."}})}var i=this;n();var r;angular.isDefined(r)||(r=t(function(){n()},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(r)})}]),angular.module("contiv.nodes").config(["$stateProvider",function(e){e.state("contiv.menu.nodes.commission",{url:"/commission/:key",controller:"NodeCommissionCtrl as nodeCommissionCtrl",templateUrl:"nodes/nodecommission.html"})}]).controller("NodeCommissionCtrl",["$state","$stateParams","NodesModel","CRUDHelperService","NodesService",function(e,t,o,n,i){function r(){e.go("contiv.menu.nodes.details.info",{key:t.key})}function a(){r()}function l(){s.form.$valid&&(n.hideServerError(s),n.startLoader(s),s.nodeOpsObj.nodes=[t.key],i.cleanupExtraVars(s),i.createExtraVars(s),o.commission(s.nodeOpsObj).then(function(e){n.stopLoader(s),r()},function(e){n.stopLoader(s),n.showServerError(s,e)}))}var s=this;s.nodeOpsObj={},s.extra_vars={},s.ansibleVariables=[],s.envVariables=[],i.getSettings(s),s.cancelCommissioningNode=a,s.commission=l,n.stopLoader(s),n.hideServerError(s)}]),angular.module("contiv.nodes").config(["$stateProvider",function(e){e.state("contiv.menu.nodes.details",{url:"/details/:key",controller:"NodeDetailsCtrl as nodeDetailsCtrl",templateUrl:"nodes/nodedetails.html"}).state("contiv.menu.nodes.details.info",{url:"/info",controller:"NodeDetailsCtrl as nodeDetailsCtrl",templateUrl:"nodes/nodeinfo.html"}).state("contiv.menu.nodes.details.stats",{url:"/stats",controller:"NodeDetailsCtrl as nodeDetailsCtrl",templateUrl:"nodes/nodestats.html"}).state("contiv.menu.nodes.details.logs",{url:"/logs",controller:"NodeDetailsCtrl as nodeDetailsCtrl",templateUrl:"nodes/nodelogs.html"}).state("contiv.menu.nodes.details.edit",{url:"/edit",controller:"NodeDetailsCtrl as nodeDetailsCtrl",templateUrl:"nodes/nodeinfo.html"})}]).controller("NodeDetailsCtrl",["$state","$stateParams","$scope","$interval","NodesModel","BgpService",function(e,t,o,n,i,r){function a(){var e={nodes:[t.key]};i.decommission(e).then(function(e){h.showCommissionButton=!1,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1})}function l(){var e={nodes:[t.key]};i.upgrade(e).then(function(e){h.showCommissionButton=!1,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1})}function s(){switch(h.node.inventory_state.status){case"Unallocated":h.showCommissionButton=!0,h.commissionButtonEnabled=!0,h.upgradeButtonEnabled=!1;break;case"Decommissioned":h.showCommissionButton=!0,h.commissionButtonEnabled=!0,h.upgradeButtonEnabled=!1;break;case"Provisioning":h.showCommissionButton=!0,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1;break;case"Allocated":h.showCommissionButton=!1,h.commissionButtonEnabled=!0,h.upgradeButtonEnabled=!0;break;case"Cancelled":h.showCommissionButton=!1,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1;break;case"Maintenance":h.showCommissionButton=!0,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1;break;default:h.showCommissionButton=!0,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1}}function c(e){i.getModelByKey(t.key,e).then(function(e){h.node=e,s()})}function u(){e.is("contiv.menu.nodes.details.edit")?h.mode="edit":h.mode="details"}function d(){e.go("contiv.menu.nodes.details.info")}function p(){h.form.$valid&&(h.neighbor.key=t.key,h.neighbors.forEach(function(e){h.neighbor.neighbor=e.name,h.neighbor["neighbor-as"]=e.value}),r.updateBgp(h).then(function(e){h.neighbor=e.config.data,d()},function(e){}))}function f(){r.getBgp(h).then(function(e){h.neighbor=e},function(e){})}function v(){r.getBgpInspect(t.key).then(function(e){h.inspect=e,h.routes=e.Oper.routes,h.filteredroutes=e.Oper.routes},function(e){})}var h=this;h.numberpattern=ContivGlobals.NUMBER_REGEX,h.decommission=a,h.upgrade=l,h.setMode=u,h.updateBgpInfo=p,h.returnToInfo=d,h.neighbors=[],h.neighbor={},h.key=t.key,f(),v(),u(),c(!1);var g;angular.isDefined(g)||(g=n(function(){c(!0)},5e3)),o.$on("$destroy",function(){n.cancel(g)})}]),angular.module("contiv.nodes").directive("ctvNodestatus",function(){return{restrict:"E",scope:{node:"="},templateUrl:"nodes/nodestatus.html"}}).directive("ctvNodestate",function(){return{restrict:"E",scope:{node:"="},templateUrl:"nodes/nodestate.html"}}),angular.module("contiv.nodes").config(["$stateProvider",function(e){e.state("contiv.menu.nodes.discover",{url:"/discover",controller:"NodeDiscoverCtrl as nodeDiscoverCtrl",templateUrl:"nodes/nodediscover.html"})}]).controller("NodeDiscoverCtrl",["$state","$stateParams","NodesModel","CRUDHelperService","NodesService",function(e,t,o,n,i){function r(){e.go("contiv.menu.nodes.list")}function a(){r()}function l(){c.form.$valid&&(n.hideServerError(c),n.startLoader(c),s(),i.createExtraVars(c),o.discover(c.nodeOpsObj).then(function(e){n.stopLoader(c),r()},function(e){n.stopLoader(c),n.showServerError(c,e)}))}function s(){c.nodeOpsObj.addrs=_.words(c.nodeIPAddr,/[^, ]+/g)}var c=this;c.nodeOpsObj={},c.extra_vars={},c.ansibleVariables=[],c.envVariables=[],c.nodeIPAddr="",i.getSettings(c),c.discover=l,c.cancelDiscoveringNode=a,n.stopLoader(c),n.hideServerError(c)}]),angular.module("contiv.nodes").config(["$stateProvider",function(e){e.state("contiv.menu.nodes.lastlog",{url:"/lastlog",controller:"NodeLastJobLogsCtrl as nodeLastJobLogsCtrl",template:'<ctv-logs title="Last Job" log="nodeLastJobLogsCtrl.lastLogs"></ctv-logs>'})}]).controller("NodeLastJobLogsCtrl",["$scope","$interval","LogService",function(e,t,o){function n(){o.getLastLogs().then(function(e){i.lastLogs=e},function(e){})}var i=this;n();var r;angular.isDefined(r)||(r=t(function(){n()},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(r)})}]),angular.module("contiv.nodes").config(["$stateProvider",function(e){e.state("contiv.menu.nodes.list",{url:"/list",controller:"NodeListCtrl as nodeListCtrl",templateUrl:"nodes/nodelist.html"})}]).controller("NodeListCtrl",["$scope","$interval","$filter","NodesModel","CRUDHelperService",function(e,t,o,n,i){function r(e){n.get(e).then(function(e){i.stopLoader(a),a.nodes=e},function(e){i.stopLoader(a)})}var a=this;r(!1);var l;angular.isDefined(l)||(l=t(function(){r(!0)},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(l)})}]),angular.module("contiv.organizations").config(["$stateProvider",function(e){e.state("contiv.menu.organizations.create",{url:"/create",templateUrl:"organizations/organizationcreate.html",controller:"OrganizationCreateCtrl as organizationCreateCtrl"})}]).controller("OrganizationCreateCtrl",["$state","OrganizationsModel","CRUDHelperService",function(e,t,o){function n(){e.go("contiv.menu.organizations.list")}function i(){n()}function r(){l.form.$valid&&(o.hideServerError(l),o.startLoader(l),l.newOrganization.key=l.newOrganization.tenantName,t.create(l.newOrganization).then(function(e){o.stopLoader(l),n()},function(e){o.stopLoader(l),o.showServerError(l,e)}))}function a(){o.stopLoader(l),o.hideServerError(l),l.newOrganization={tenantName:""}}var l=this;l.createOrganization=r,l.cancelCreating=i,a()}]),angular.module("contiv.organizations").config(["$stateProvider",function(e){e.state("contiv.menu.organizations.details",{url:"/details/:key",controller:"OrganizationDetailsCtrl as organizationDetailsCtrl",templateUrl:"organizations/organizationdetails.html"})}]).controller("OrganizationDetailsCtrl",["$state","$stateParams","OrganizationsModel","CRUDHelperService",function(e,t,o,n){function i(){e.go("contiv.menu.organizations.list")}function r(){n.hideServerError(a),n.startLoader(a),o["delete"](a.organization).then(function(e){n.stopLoader(a),i()},function(e){n.stopLoader(a),n.showServerError(a,e)})}var a=this;n.stopLoader(a),n.hideServerError(a),o.getModelByKey(t.key).then(function(e){a.organization=e}),a.deleteOrganization=r}]),angular.module("contiv.organizations").config(["$stateProvider",function(e){e.state("contiv.menu.organizations.list",{url:"/list",controller:"OrganizationsListCtrl as organizationsListCtrl",templateUrl:"organizations/organizationlist.html"})}]).controller("OrganizationsListCtrl",["$scope","$interval","$filter","OrganizationsModel","CRUDHelperService",function(e,t,o,n,i){function r(e){n.get(e).then(function(e){i.stopLoader(a),a.organizations=e},function(e){i.stopLoader(a)})}var a=this;r(!1);var l;angular.isDefined(l)||(l=t(function(){r(!0)},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(l)})}]),angular.module("contiv.servicelbs").config(["$stateProvider",function(e){e.state("contiv.menu.servicelbs.create",{url:"/create",templateUrl:"service_lbs/servicelbcreate.html",controller:"ServicelbCreateCtrl as servicelbCreateCtrl"})}]).controller("ServicelbCreateCtrl",["$state","$stateParams","ServicelbsModel","NetworksModel","CRUDHelperService",function(e,t,o,n,i){function r(){e.go("contiv.menu.servicelbs.list")}function a(){r()}function l(){n.get().then(function(e){d.networks=_.filter(e,{tenantName:"default"})})}function s(){d.servicelb.selectors=[],angular.forEach(d.labelSelectors,function(e){var t=e.name+"="+e.value;d.servicelb.selectors.push(t)})}function c(){s(),d.form.$valid&&(i.hideServerError(d),i.startLoader(d),d.servicelb.key=d.servicelb.tenantName+":"+d.servicelb.serviceName,o.create(d.servicelb).then(function(e){i.stopLoader(d),r()},function(e){i.stopLoader(d),i.showServerError(d,e)}))}function u(){i.stopLoader(d),i.hideServerError(d),d.servicelb={serviceName:"",networkName:"",ipAddress:"",selectors:[],ports:[],tenantName:"default"}}var d=this;d.labelSelectors=[],d.networks=[],d.createServicelb=c,d.cancelCreating=a,l(),u()}]),angular.module("contiv.servicelbs").config(["$stateProvider",function(e){e.state("contiv.menu.servicelbs.details",{url:"/details/:key",params:{state:null},controller:"ServicelbDetailsCtrl as servicelbDetailsCtrl",templateUrl:"service_lbs/servicelbdetails.html"}).state("contiv.menu.servicelbs.details.info",{url:"/info",controller:"ServicelbDetailsCtrl as servicelbDetailsCtrl",templateUrl:"service_lbs/servicelbinfo.html"}).state("contiv.menu.servicelbs.details.edit",{url:"/edit/:key",controller:"ServicelbDetailsCtrl as servicelbDetailsCtrl",templateUrl:"service_lbs/servicelbinfo.html"})}]).controller("ServicelbDetailsCtrl",["$state","$stateParams","ServicelbsModel","CRUDHelperService",function(e,t,o,n){function i(){e.is("contiv.menu.servicelbs.details.edit")?p.mode="edit":p.mode="details"}function r(){e.go("contiv.menu.servicelbs.list")}function a(){e.go("contiv.menu.servicelbs.details.info",{key:p.servicelb.key,state:"details"})}function l(){a()}function s(){n.hideServerError(p),n.startLoader(p),o["delete"](p.servicelb).then(function(e){n.stopLoader(p),r()},function(e){n.stopLoader(p),n.showServerError(p,e)})}function c(){n.hideServerError(p),n.startLoader(p);var e=p.servicelb.selectors;d(),o.save(p.servicelb).then(function(e){n.stopLoader(p),a()},function(t){p.servicelb.selectors=e,u(),n.stopLoader(p),n.showServerError(p,t)})}function u(){angular.forEach(p.servicelb.selectors,function(e){var t={name:e.split("=")[0],value:e.split("=")[1]};p.labelSelectors.push(t)})}function d(){p.servicelb.selectors=[],angular.forEach(p.labelSelectors,function(e){var t=e.name+"="+e.value;p.servicelb.selectors.push(t)})}var p=this;p.labelSelectors=[],n.stopLoader(p),n.hideServerError(p),o.getModelByKey(t.key).then(function(e){p.servicelb=e,u()}),p.saveServicelb=c,p.cancelEditing=l,p.deleteServicelb=s,i()}]),angular.module("contiv.servicelbs").config(["$stateProvider",function(e){e.state("contiv.menu.servicelbs.list",{url:"/list",controller:"ServicelbListCtrl as servicelbListCtrl",templateUrl:"service_lbs/servicelblist.html"})}]).controller("ServicelbListCtrl",["$scope","$interval","$filter","ServicelbsModel","CRUDHelperService",function(e,t,o,n,i){function r(e){n.get(e).then(function(e){i.stopLoader(a),a.servicelbs=e},function(e){i.stopLoader(a)})}var a=this;r(!1);var l;angular.isDefined(l)||(l=t(function(){r(!0)},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(l)})}]),angular.module("contiv.servicelbs").directive("ctvServicelbports",function(){return{restrict:"E",scope:{
items:"="},link:function(e){function t(e,t){return e===t}function o(){e.newItem={servicePort:"",providerPort:"",protocol:""}}function n(e){return""===e.servicePort&&""===e.providerPort&&""===e.protocol}e.add=function(){if(!n(e.newItem)){void 0===e.items&&(e.items=[]);var i=e.newItem.servicePort+":"+e.newItem.providerPort+":"+e.newItem.protocol;_.pullAllWith(e.items,[i],t),e.items.push(i),o()}},e.remove=function(o){_.remove(e.items,function(e){return t(e,o)})},o()},templateUrl:"service_lbs/servicelbports.html"}}),angular.module("contiv.servicelbs").config(["$stateProvider",function(e){e.state("contiv.menu.servicelbs.details.stats",{url:"/stats",controller:"ServicelbStatsCtrl as servicelbStatsCtrl",templateUrl:"service_lbs/servicelbstats.html"})}]).controller("ServicelbStatsCtrl",["$state","$stateParams","$scope","$interval","$filter","ServicelbsModel","InspectService",function(e,t,o,n,i,r,a){function l(e){r.getInspectByKey(t.key,ContivGlobals.SERVICELBS_INSPECT_ENDPOINT,e).then(function(e){if(s.servicelbInspectStats=e.Oper,s.config=e.Config,void 0!=e.Oper.providers){var t=a.buildEndPoints(e.Oper.providers);a.checkContainerChanged(s.providerDetails,t)&&(s.providers=e.Oper.providers,s.providerDetails=t)}else s.providers=[],s.providerDetails={}})}var s=this;l(!1);var c;angular.isDefined(c)||(c=n(function(){l(!0)},ContivGlobals.REFRESH_INTERVAL)),o.$on("$destroy",function(){n.cancel(c)})}]),angular.module("contiv.settings").config(["$stateProvider",function(e){e.state("contiv.menu.settings.details.cluster",{url:"/cluster",controller:"ClusterSettingCtrl as clusterSettingCtrl",templateUrl:"settings/clustersettings.html"})}]).controller("ClusterSettingCtrl",["$stateParams","CRUDHelperService","NodesService",function(e,t,o){function n(){i.form.$valid&&(t.hideServerError(i),t.startLoader(i),i.nodeOpsObj.nodes=[e.key],o.cleanupExtraVars(i),o.createExtraVars(i),o.updateSettings(i.nodeOpsObj).then(function(e){t.stopLoader(i)},function(e){t.stopLoader(i),t.showServerError(i,e)}))}var i=this;i.nodeOpsObj={},i.extra_vars={},i.ansibleVariables=[],i.envVariables=[],o.getSettings(i),i.updateClusterSettings=n,t.stopLoader(i),t.hideServerError(i)}]),angular.module("contiv.settings").config(["$stateProvider",function(e){e.state("contiv.menu.settings.details.networks",{url:"/networks",controller:"NetworkSettingCtrl as networkSettingCtrl",templateUrl:"settings/networksettings.html"})}]).controller("NetworkSettingCtrl",["CRUDHelperService","NetworkService",function(e,t){function o(){i.form.$valid&&(e.hideServerError(i),e.startLoader(i),t.updateSettings(i.setting).then(function(t){e.stopLoader(i)},function(t){e.stopLoader(i),e.showServerError(i,t.data)}))}function n(){t.getSettings().then(function(e){i.setting=e},function(e){})}var i=this;i.vlanPattern=ContivGlobals.VLAN_REGEX,i.vxlanPattern=ContivGlobals.VXLAN_REGEX,n(),i.updateNetworkSettings=o,e.stopLoader(i),e.hideServerError(i)}]),angular.module("contiv.settings").config(["$stateProvider",function(e){e.state("contiv.menu.settings.details.volumes",{url:"/volumes",controller:"VolumeSettingCtrl as volumeSettingCtrl",templateUrl:"settings/volumesettings.html"})}]).controller("VolumeSettingCtrl",["CRUDHelperService","VolumeSettingService",function(e,t){function o(){i.form.$valid&&(e.hideServerError(i),e.startLoader(i),t.updateSettings(i.setting).then(function(t){e.stopLoader(i)},function(t){e.stopLoader(i),e.showServerError(i,t)}))}function n(){t.getSettings().then(function(e){i.setting=e},function(e){})}var i=this;n(),i.updateVolumeSettings=o,e.stopLoader(i),e.hideServerError(i)}]),angular.module("contiv.storagepolicies").config(["$stateProvider",function(e){e.state("contiv.menu.storagepolicies.create",{url:"/create",templateUrl:"storage_policies/storagepolicycreate.html",controller:"StoragePolicyCreateCtrl as storagePolicyCreateCtrl"})}]).controller("StoragePolicyCreateCtrl",["$state","$stateParams","StoragePoliciesModel","CRUDHelperService",function(e,t,o,n){function i(){e.go("contiv.menu.storagepolicies.list")}function r(){i()}function a(){c.filesystemcmds.forEach(function(e){c.newStoragePolicy.filesystems[e.name]=e.value})}function l(){c.form.$valid&&(n.hideServerError(c),n.startLoader(c),a(),o.create(c.newStoragePolicy).then(function(e){n.stopLoader(c),i()},function(e){n.stopLoader(c),n.showServerError(c,e)}))}function s(){n.stopLoader(c),n.hideServerError(c),c.newStoragePolicy={name:"",backends:{crud:"ceph",mount:"ceph",snapshot:"ceph"},unlocked:!1,driver:{pool:"rbd"},create:{size:"0",filesystem:""},runtime:{snapshots:!0,snapshot:{frequency:"30m",keep:20},"rate-limit":{"write-iops":0,"read-iops":0,"write-bps":0,"read-bps":0}},filesystems:{}}}var c=this;c.createPolicy=l,c.cancelCreating=r,c.filesystemcmds=[],s()}]),angular.module("contiv.storagepolicies").config(["$stateProvider",function(e){e.state("contiv.menu.storagepolicies.details",{url:"/details/:key",controller:"StoragePolicyDetailsCtrl as storagePolicyDetailsCtrl",templateUrl:"storage_policies/storagepolicydetails.html"}).state("contiv.menu.storagepolicies.edit",{url:"/details/:key",controller:"StoragePolicyDetailsCtrl as storagePolicyDetailsCtrl",templateUrl:"storage_policies/storagepolicydetails.html"})}]).controller("StoragePolicyDetailsCtrl",["$state","$stateParams","$scope","$interval","$filter","StoragePoliciesModel","VolumesModel","CRUDHelperService",function(e,t,o,n,i,r,a,l){function s(){e.is("contiv.menu.storagepolicies.edit")?m.mode="edit":m.mode="details"}function c(){e.go("contiv.menu.storagepolicies.list")}function u(){e.go("contiv.menu.storagepolicies.details",{key:m.policy.name})}function d(){u()}function p(){l.hideServerError(m),l.startLoader(m),r.deleteUsingKey(m.policy.name,"name").then(function(e){l.stopLoader(m),c()},function(e){l.stopLoader(m),l.showServerError(m,e)})}function f(e){a.get(e).then(function(e){m.volumes=i("orderBy")(_.filter(e,{policy:m.policy.name}),"name")})}function v(){angular.forEach(m.policy.filesystems,function(e,t){this.push({name:t,value:e})},m.filesystemcmds)}function h(){m.filesystemcmds.forEach(function(e){m.policy.filesystems[e.name]=e.value})}function g(){m.form.$valid&&(l.hideServerError(m),l.startLoader(m),h(),r.save(m.policy).then(function(e){l.stopLoader(m),u()},function(e){l.stopLoader(m),l.showServerError(m,e)}))}var m=this;m.filesystemcmds=[],l.stopLoader(m),l.hideServerError(m),r.getModelByKey(t.key,!1,"name").then(function(e){m.policy=e,v(),f(!1)}),m.deletePolicy=p,m.savePolicy=g,m.cancelEditing=d,s();var y;angular.isDefined(y)||(y=n(function(){f(!0)},ContivGlobals.REFRESH_INTERVAL)),o.$on("$destroy",function(){n.cancel(y)})}]),angular.module("contiv.storagepolicies").directive("ctvStoragepolicybasicsettings",function(){return{}}).directive("ctvStoragepolicyfilesystemsettings",function(){return{restrict:"E",scope:{policy:"=",filesystemcmds:"="},link:function(e){e.filesystems=["ext4","btrfs"]},templateUrl:"storage_policies/filesystemsettings.html"}}).directive("ctvStoragepolicysnapshotsettings",function(){return{restrict:"E",scope:{policy:"="},templateUrl:"storage_policies/snapshotsettings.html"}}).directive("ctvStoragepolicyrwopssettings",function(){return{restrict:"E",scope:{policy:"="},templateUrl:"storage_policies/rwopssettings.html"}}).directive("ctvStoragepolicybackenddrivers",function(){return{restrict:"E",scope:{policy:"="},templateUrl:"storage_policies/backenddrivers.html"}}),angular.module("contiv.storagepolicies").config(["$stateProvider",function(e){e.state("contiv.menu.storagepolicies.list",{url:"/list",controller:"StoragePolicyListCtrl as storagePolicyListCtrl",templateUrl:"storage_policies/storagepolicylist.html"})}]).controller("StoragePolicyListCtrl",["$scope","$interval","$filter","StoragePoliciesModel","CRUDHelperService",function(e,t,o,n,i){function r(e){n.get(e).then(function(e){i.stopLoader(a),a.policies=e},function(e){i.stopLoader(a)})}var a=this;r(!1);var l;angular.isDefined(l)||(l=t(function(){r(!0)},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(l)})}]),angular.module("contiv.visualization").config(["$stateProvider",function(e){e.state("contiv.menu.visualization.edge",{url:"/edge/{sourceName, targetName, sourceList, targetList}",params:{sourceName:null,targetName:null,sourceList:null,targetList:null},controller:"VisualizationEdgeCtrl as visualizationedgeCtrl",templateUrl:"visualization/visualizationedge.html"})}]).controller("VisualizationEdgeCtrl",["$scope","$http","$state","$stateParams","VisualizationService","$interval",function(e,t,o,n,i,r){var a=n.sourceName,l=n.targetName,s=n.sourceList,c=n.targetList;if(null==s||null==c)return void o.go("contiv.menu.visualization.list");var u=new Date,d=u.getSeconds();e.edgeDataInterval=r(function(){i.getEdgeData(s,c,d.toString()).then(function(t){var o=t.results,n=0;_.forEach(o,function(e){_.isEmpty(e)===!1&&(n+=e.series[0].values[0][1])}),e.sourceName=a,e.targetName=l,e.edgeData=n,e.edgeDataTime=d},function(e){})},3e3),e.$on("$destroy",function(){r.cancel(e.edgeDataInterval)}),i.getOldEdgeData(s,c).then(function(t){var o=t.results,n=[];_.forEach(o,function(e){if(_.isEmpty(e)===!1){var t=e.series[0].values;_.isEmpty(n)?_.forEach(t,function(e){n.push(e[1])}):_.forEach(t,function(e,t){n[t]+=e[1]})}}),e.sourceName=a,e.targetName=l,e.sourceList=s,e.targetList=c,e.oldEdgeData=n},function(e){})}]),angular.module("contiv.visualization").directive("visualizationEdge",["$window",function(e){function t(e,t){function o(){s=new Date;for(var t in c){var n=c[t];n.data.push(e.edgeData||0),n.path.attr("d",p)}u.domain([s-(a-2)*l,s-l]),g.transition().duration(l).ease("linear").call(u.axis),v.transition().duration(l).ease("linear").call(d.axis),m.attr("transform",null).transition().duration(l).ease("linear").attr("transform","translate("+u(s-(a-1)*l)+")").each("end",function(){o()});for(var t in c){var n=c[t];n.data.shift()}}var n=document.getElementsByTagName("body")[0],i=n.clientWidth-400,r=n.clientHeight-400,a=59,l=750,s=new Date(Date.now()-l),c={current:{value:0,color:"orange",data:t.range(a).map(function(t){return e.oldEdgeData[Math.floor(t/10)]||0})}},u=t.time.scale().domain([s-(a-2),s-l]).range([0,i]),d=t.scale.linear().domain([0,t.max(c.current.data,function(e){return e+10})]).range([r,0]),p=t.svg.line().interpolate("basis").x(function(e,t){return u(s-(a-1-t)*l)}).y(function(e){return d(e)}),f=t.select(".graph").append("svg").attr("width",25).style("overflow","visible").style("position","fixed"),v=f.append("g").attr("class","y axis").call(d.axis=t.svg.axis().scale(d).orient("left")),h=t.select(".graph").append("svg").attr("class","chart").attr("width",i-50).attr("height",r+50),g=h.append("g").attr("class","x axis").attr("transform","translate(0,"+r+")").call(u.axis=t.svg.axis().scale(u).orient("bottom")),m=h.append("g");for(var y in c){var w=c[y];w.path=m.append("path").data([w.data]).attr("class",y+" group").style("stroke",w.color)}o()}return{restrict:"EA",replace:!1,templateUrl:"visualization/visualizationedgetemplate.html",link:function(o){o.$watchGroup(["edgeData","oldEdgeData"],function(){if(null!=o.edgeData&&null!=o.oldEdgeData&&!o.initialize){o.initialize=!0;var n=e.d3;t(o,n)}})}}}]),angular.module("contiv.visualization").service("StateSave",function(){this.savedStates={}}).directive("visualizationGraph",["$window","$state","VisualizerGraph","PolicyService","VisualizerDataSource","StateSave",function(e,t,o,n,i,r){function a(e,o,n,i,r,a){if(void 0!==e.nodes&&void 0!==e.links&&void 0!==e.children_struct&&void 0!==e.ancestors_struct){var l=new r.DataSource(e.nodes,e.links,e.children_struct,e.ancestors_struct,e.labels,e.serviceSelectors);l.setAncestors();var s,c,u=l.getTopLevelFlow();s=l.processNodeData(u.nodeData),c=l.processLinkData(u.linkData,s);var d=document.getElementsByTagName("body")[0],p=(d.clientWidth,d.clientHeight),f=o.find("svg"),v=$(f.parent()).offset(),h=$(f.parent()).width(),g=d3.select(f[0]).attr("width",h).attr("height",p-v.top-20);e.visualizationGraph=new n.Graph(g,s,c,l,e.children_struct,e.ancestors_struct),e.visualizationGraph.installDefaultPathPolicy(new i.SaveStatePolicy(a.savedStates)),e.visualizationGraph.installDefaultPathPolicy(new i.PathChangeViewPolicy(t));var m=new i.QTipPolicy;e.visualizationGraph.installDefaultNodePolicy(m),e.visualizationGraph.installDefaultPathPolicy(m);var y=new i.SplitJoinViewPolicy;if(e.visualizationGraph.installDefaultNodePolicy(y),y.installBackButton($("#backButton")),y.installTitle($("#graph-title")),0==_.isEmpty(a.savedStates)){var w=e.visualizationGraph;w.load(a.savedStates)}else e.visualizationGraph.updateGraph()}}return{restrict:"EA",replace:!1,templateUrl:"visualization/visualizationtemplate.html",link:function(e,t){e.$on("$destroy",function(){$("#visualization-graph").unbind(),e.visualizationGraph.destroy()}),e.$watchGroup(["nodes","links","children_struct","ancestors_struct"],function(){null!=e.nodes&&null!=e.links&&null!=e.children_struct&&null!=e.ancestors_struct&&(e.initialized?(e.visualizationGraph.dataSource.links=e.links,e.visualizationGraph.updateLinkData()):(e.initialized=!0,a(e,t,o,n,i,r)))})}}}]),angular.module("contiv.visualization").config(["$stateProvider",function(e){e.state("contiv.menu.visualization.list",{url:"/list",controller:"VisualizationListCtrl as visualizationListCtrl",templateUrl:"visualization/visualizationlist.html"})}]).controller("VisualizationListCtrl",["$scope","$http","VisualizationService","$interval",function(e,t,o,n){var i=function(t){var o=[],n=[],i=[];_.forEach(t.results[0].series,function(e){var t,r=e.tags.EndpointIP,a=e.tags.ProviderIP;0==_.includes(i,r)&&(t={name:r,id:r,parent:null,ancestors:null},o.push(t),i.push(r)),0==_.includes(i,a)&&(t={name:a,id:a,parent:null,ancestors:null},o.push(t),i.push(a));var l={source:r,target:a,weight:e.values[0][2]};n.push(l);var s={source:a,target:r,weight:e.values[0][1]};n.push(s)}),e.nodes=o,e.links=n};o.getGraphData().then(i,function(e){}),e.$on("$destroy",function(){n.cancel(e.graphDataInterval)}),o.getStructureData().then(function(t){e.ancestors_struct=t.ancestors_struct,e.children_struct=t.children_struct,e.labels=t.labels,e.serviceSelectors=t.serviceSelectors},function(e){})}]),angular.module("contiv.visualization").factory("VisualizationService",["$http","$q",function(e,t){function o(o,n){var i=t.defer();return e.get(o,n).then(function(e){i.resolve(e.data)},function(e){i.reject(e.data)}),i.promise}function n(o,n){var i=function(e){var t,o,n,r,a,l,s,c="";for(t in e)if(o=e[t],o instanceof Array)for(s=0;s<o.length;++s)a=o[s],n=t+"["+s+"]",l={},l[n]=a,c+=i(l)+"&";else if(o instanceof Object)for(r in o)a=o[r],n=t+"["+r+"]",l={},l[n]=a,c+=i(l)+"&";else void 0!==o&&null!==o&&(c+=encodeURIComponent(t)+"="+encodeURIComponent(o)+"&");return c.length?c.substr(0,c.length-1):c},r=t.defer();return e({url:o,method:"POST",data:n,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(e){return angular.isObject(e)&&"[object File]"!==String(e)?i(e):e}]}).then(function(e){r.resolve(e.data)},function(e){r.reject(e.data)}),r.promise}function i(){var e=ContivGlobals.VISUALIZATION_ENDPOINT;e+="influx/query";var t={params:{db:"telegraf",q:"SELECT BytesIn, BytesOut, EndpointIP, ProviderIP FROM httpjson_svcstats WHERE time > now() - 1m GROUP BY * LIMIT 1"}};return o(e,t)}function r(){var e=ContivGlobals.VISUALIZATION_ENDPOINT;return e+="services",o(e)}function a(e,t){var o="(";o+=t+"=",o+="'"+e[0]+"' ";for(var n=1;n<e.length;n++)o+="OR ",o+=t+"=",o+="'"+e[n]+"' ";return o+=")"}function l(e,t,o){var i=ContivGlobals.VISUALIZATION_ENDPOINT;i+="influx/query";var r={db:"telegraf",q:"SELECT sum(BytesOut) from httpjson_svcstats WHERE time > now() - 15s AND "+a(e,"EndpointIP")+" AND "+a(t,"ProviderIP")+"GROUP BY time(20s) LIMIT 1; SELECT sum(BytesIn) from httpjson_svcstats WHERE time > now() - 15s AND "+a(e,"ProviderIP")+" AND "+a(t,"EndpointIP")+"GROUP BY time(20s) fill(0) LIMIT 1"};return n(i,r)}function s(e,t){var o=ContivGlobals.VISUALIZATION_ENDPOINT;o+="influx/query";var i={db:"telegraf",q:"SELECT sum(BytesOut) FROM httpjson_svcstats WHERE time > now() - 1m AND "+a(e,"EndpointIP")+" AND "+a(t,"ProviderIP")+" GROUP BY time(10s) fill(0) LIMIT 6; SELECT sum(BytesIn) FROM httpjson_svcstats WHERE time > now() - 1m AND "+a(e,"ProviderIP")+" AND "+a(t,"EndpointIP")+" GROUP BY time(10s) fill(0) LIMIT 6"};return n(o,i)}return{getGraphData:i,getStructureData:r,getEdgeData:l,getOldEdgeData:s}}]),angular.module("contiv.volumes").config(["$stateProvider",function(e){e.state("contiv.menu.volumes.create",{url:"/create",templateUrl:"volumes/volumecreate.html",controller:"VolumeCreateCtrl as volumeCreateCtrl"})}]).controller("VolumeCreateCtrl",["$state","$stateParams","VolumesModel","StoragePoliciesModel","CRUDHelperService",function(e,t,o,n,i){function r(){e.go("contiv.menu.volumes.list")}function a(){r()}function l(){n.get().then(function(e){d.policies=e})}function s(){d.newVolume.policy=d.selectedPolicy.name,d.newVolume.backends=d.selectedPolicy.backends,d.newVolume.driver=d.selectedPolicy.driver,d.newVolume.create=d.selectedPolicy.create,d.newVolume.runtime=d.selectedPolicy.runtime}function c(){d.form.$valid&&(i.hideServerError(d),i.startLoader(d),s(),o.create(d.newVolume).then(function(e){i.stopLoader(d),r()},function(e){i.stopLoader(d),i.showServerError(d,e)}))}function u(){i.stopLoader(d),i.hideServerError(d),d.newVolume={name:"",backends:{},driver:{},create:{},runtime:{}}}var d=this;d.filesystems=["ext4","btrfs"],d.createVolume=c,d.cancelCreating=a,l(),u()}]),angular.module("contiv.volumes").config(["$stateProvider",function(e){e.state("contiv.menu.volumes.details",{url:"/details/:key",controller:"VolumeDetailsCtrl as volumeDetailsCtrl",templateUrl:"volumes/volumedetails.html"})}]).controller("VolumeDetailsCtrl",["$state","$stateParams","$scope","$interval","$http","VolumesModel","VolumeService","CRUDHelperService",function(e,t,o,n,i,r,a,l){function s(){e.go("contiv.menu.volumes.list")}function c(){l.hideServerError(v),l.startLoader(v),r["delete"](v.volume).then(function(e){l.stopLoader(v),s()})}function u(e){var o=t.key.split("/"),n={};n.policy=o[0],n.name=o[1],r.getModel(n,e).then(function(e){v.volume=e,d(),p()})}function d(){a.getVolumeUseInfo(v.volume).then(function(e){v.volumeUse=e},function(e){})}function p(){a.getVolumeSnapshots(v.volume).then(function(e){v.snapshots=e},function(e){})}function f(){v.snapshotSuccess=!1,l.hideServerError(v),l.startLoader(v),a.triggerSnapshot(v.volume).then(function(e){l.stopLoader(v),v.snapshotSuccess=!0},function(e){l.stopLoader(v),l.showServerError(v,e)})}var v=this;v.deleteVolume=c,v.triggerVolumeSnapshot=f,u(!1);var h;angular.isDefined(h)||(h=n(function(){u(!0)},ContivGlobals.REFRESH_INTERVAL)),o.$on("$destroy",function(){n.cancel(h)})}]),angular.module("contiv.volumes").config(["$stateProvider",function(e){e.state("contiv.menu.volumes.list",{url:"/list",controller:"VolumeListCtrl as volumeListCtrl",templateUrl:"volumes/volumelist.html"})}]).controller("VolumeListCtrl",["$scope","$interval","$filter","VolumesModel","CRUDHelperService",function(e,t,o,n,i){function r(e){n.get(e).then(function(e){i.stopLoader(a),a.volumes=e},function(e){i.stopLoader(a)})}var a=this;r(!1);var l;angular.isDefined(l)||(l=t(function(){r(!0)},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(l)})}]),angular.module("contiv.volumes").factory("VolumeService",["$http","$q",function(e,t){function o(o){var n=t.defer(),i=ContivGlobals.VOLUMES_USES_ENDPOINT+o.policy+"/"+o.name;return e.get(i).then(function(e){n.resolve(e.data)},function(e){n.reject(e.data)}),n.promise}function n(o){var n=t.defer(),i=ContivGlobals.VOLUMES_SNAPSHOTS_ENDPOINT+o.policy+"/"+o.name;return e.get(i).then(function(e){n.resolve(e.data)},function(e){n.reject(e.data)}),n.promise}function i(o){var n=t.defer(),i=ContivGlobals.VOLUMES_SNAPSHOTS_ENDPOINT+"take/"+o.policy+"/"+o.name;return e.post(i).then(function(e){n.resolve(e.data)},function(e){n.reject(e.data)}),n.promise}return{getVolumeUseInfo:o,getVolumeSnapshots:n,triggerSnapshot:i}}]),angular.module("contiv.volumes").config(["$stateProvider",function(e){e.state("contiv.menu.volumes.copy",{url:"/copy/",params:{snapshot:null,policy:null,volume:null},controller:"VolumeSnapshotCopyCtrl as volumeSnapshotCopyCtrl",templateUrl:"volumes/volumesnapshotcopy.html"})}]).controller("VolumeSnapshotCopyCtrl",["$state","$stateParams","$scope","$interval","$http","VolumesModel","CRUDHelperService",function(e,t,o,n,i,r,a){function l(){e.go("contiv.menu.volumes.details",{key:t.policy+"/"+t.volume})}function s(){e.go("contiv.menu.volumes.details",{key:t.policy+"/"+u.newvolume})}function c(){if(u.form.$valid){a.hideServerError(u),a.startLoader(u);var e={};e.policy=t.policy,e.name=t.volume,r.copy(e,t.snapshot,u.newvolume).then(function(e){a.stopLoader(u),s()},function(e){a.stopLoader(u),a.showServerError(u,e)})}}var u=this;u.policy=t.policy,u.volume=t.volume,u.snapshot=t.snapshot,u.copySnapshot=c,u.cancelCopy=l}]),angular.module("contiv.directives").directive("ctvAccordion",function(){return{restrict:"E",transclude:!0,scope:{items:"="},link:function(e,t){"function"==typeof t.find(".ui.accordion").accordion&&t.find(".ui.accordion").accordion()},templateUrl:"components/directives/accordion.html"}}),angular.module("contiv.directives").directive("ctvCollapsible",function(){return{restrict:"E",scope:{title:"@",collapsed:"@"},transclude:!0,link:function(e){void 0===e.collapsed&&(e.collapsed=!0)},templateUrl:"components/directives/collapsible.html"}}),angular.module("contiv.directives").directive("ctvNamevalue",function(){return{restrict:"E",scope:{items:"=",nameheader:"@",valueheader:"@",type:"@",options:"="},link:function(e){function t(e,t){return e.name==t.name}function o(){e.newItem={name:"",value:""}}function n(e){return""===e.name&&""===e.value}e.add=function(){n(e.newItem)||(void 0===e.item&&(e.item=[]),_.pullAllWith(e.items,[e.newItem],t),e.items.push(e.newItem),o())},e.remove=function(t){_.remove(e.items,function(e){return e.name==t.name})},o(),void 0===e.nameheader&&(e.nameheader="Name"),void 0===e.valueheader&&(e.valueheader="Value"),void 0===e.type&&(e.type="text")},templateUrl:"components/directives/namevalue.html"}}),angular.module("contiv.directives").directive("ctvTable",["filterFilter","limitToFilter",function(e,t){return{restrict:"E",transclude:!0,scope:{items:"=",filtereditems:"=",size:"@",defaultsortcolumn:"@"},controller:["$scope","$element","$attrs","$filter",function(o,n,i,r){function a(n,i){if(p.searchText=i,(void 0===n||0>n)&&(n=0),p.pageNo=n,void 0!==o.items){var a=e(o.items,p.searchText);a=r("orderBy")(a,p.sortObj.field,p.sortObj.reverse);var l=Math.ceil(a.length/p.size);0==l&&(l=1),p.chunks=[];for(var s=0;l>s;s++)p.chunks.push({selected:!1,pageNo:s});if(n>=p.chunks.length&&(p.pageNo=0),p.chunks[p.pageNo].selected=!0,p.chunks.length>5){var c,u;c=p.pageNo-2,u=p.pageNo+3,0>c&&(u-=c,c=0),u>p.chunks.length&&(c-=u-p.chunks.length,u=p.chunks.length),o.paginationMenu.chunks=p.chunks.slice(c,u)}else o.paginationMenu.chunks=p.chunks;p.filteredItems=t(a,p.size,p.pageNo*p.size),o.filtereditems=p.filteredItems}return!1}function l(){var e;return e=p.pageNo<=0?0:p.pageNo-1,a(e)}function s(){var e;return e=p.pageNo+1,e>p.chunks.length-1&&(e=p.chunks.length-1),a(e)}function c(e){o.paginationMenu=e}function u(e){return{field:e,reverse:!1,iconDirection:{"angle down icon":!0,"angle up icon":!1}}}function d(e){e==p.sortObj.field?(p.sortObj.field=e,p.sortObj.reverse=!p.sortObj.reverse,p.sortObj.iconDirection={"angle down icon":!p.sortObj.reverse,"angle up icon":p.sortObj.reverse}):p.sortObj=u(e),p.showChunk(p.pageNo,p.searchText),o.$apply()}var p=this;p.chunks=[],p.pageNo=0,p.sortObj=u(o.defaultsortcolumn),p.size=parseInt(o.size,10),isNaN(p.size)&&(p.size=12),p.showChunk=a,p.showNextChunk=s,p.showPrevChunk=l,p.addPaginationMenu=c,p.sort=d}],link:function(e,t,o,n){e.$parent.$watch(o.items,function(){n.showChunk(n.pageNo,n.searchText)})},templateUrl:"components/directives/table.html"}}]).directive("ctvThead",function(){return{restrict:"E",transclude:!0,replace:!0,template:"<thead ng-transclude></thead>"}}).directive("ctvTh",function(){return{restrict:"E",transclude:!0,replace:!0,require:"^^ctvTable",scope:{"class":"@",sortfield:"="},link:function(e,t,o,n){e.tablectrl=n,void 0!=e.sortfield&&null!=e.sortfield&&t.bind("click",function(){n.sort(e.sortfield)})},templateUrl:"components/directives/tableheader.html"}}).directive("ctvTbody",function(){return{restrict:"E",scope:{},transclude:!0,replace:!0,template:"<tbody ng-transclude></tbody>"}}).directive("ctvTfoot",function(){return{restrict:"E",scope:{},transclude:!0,replace:!0,template:"<tfoot ng-transclude></tfoot>"}}).directive("ctvTsearch",function(){return{restrict:"E",require:"^^ctvTable",scope:{placeholder:"@",size:"@"},link:function(e,t,o,n){e.showChunk=function(){n.showChunk(n.pageNo,e.searchText)}},templateUrl:"components/directives/searchinput.html"}}).directive("ctvTr",function(){return{restrict:"E",transclude:"true",replace:!0,scope:{},template:"<tr ng-transclude></tr>"}}).directive("ctvTd",function(){return{restrict:"E",transclude:!0,replace:!0,scope:!0,template:"<td ng-transclude></td>"}}).directive("ctvTpagination",function(){return{restrict:"E",require:"^^ctvTable",scope:{colspan:"@"},replace:!0,link:function(e,t,o,n){n.addPaginationMenu(e),n.showChunk(n.pageNo,n.searchText),e.showChunk=function(e){n.showChunk(e,n.searchText)},e.showPrevChunk=n.showPrevChunk,e.showNextChunk=n.showNextChunk},templateUrl:"components/directives/paginationmenu.html"}}),angular.module("contiv.directives").directive("ctvAcivalid",function(){return{restrict:"E",templateUrl:"components/directives/nodes/acivalid.html",scope:{form:"="}}}),angular.module("contiv.directives").directive("ctvControlinterface",function(){return{restrict:"E",templateUrl:"components/directives/nodes/controlinterface.html",scope:{extravars:"="}}}),angular.module("contiv.directives").directive("ctvNetworkmode",function(){return{restrict:"E",templateUrl:"components/directives/nodes/networkmode.html",scope:{extravars:"="}}}),angular.module("contiv.directives").directive("ctvScheduler",function(){return{restrict:"E",templateUrl:"components/directives/nodes/scheduler.html",scope:{extravars:"="}}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9idW5kbGUuanMiLCJtb2R1bGUuanMiLCJkaXJlY3RpdmVzL21vZHVsZS5qcyIsImRhdGFzb3VyY2UvZGF0YXNvdXJjZS5qcyIsIm1vZGVscy9tb2R1bGUuanMiLCJ1dGlscy9tb2R1bGUuanMiLCJkYXRhc291cmNlL3Zpc3VhbGl6ZXJkYXRhc291cmNlLmpzIiwiZ3JhcGgvZ3JhcGguanMiLCJncmFwaC92aXN1YWxpemVyZ3JhcGguanMiLCJsaW5rL2xpbmsuanMiLCJsaW5rL3Zpc3VhbGl6ZXJsaW5rLmpzIiwibm9kZS9ub2RlLmpzIiwibm9kZS92aXN1YWxpemVybm9kZS5qcyIsInBvbGljeS9ub2Rlc2VsZWN0aW9ucG9saWN5LmpzIiwicG9saWN5L3BhdGhjaGFuZ2V2aWV3cG9saWN5LmpzIiwicG9saWN5L3BvbGljeS5qcyIsImFwcGxpY2F0aW9uZ3JvdXBzL21vZHVsZS5qcyIsInBvbGljeS9wb2xpY3lzZXJ2aWNlLmpzIiwiZGFzaGJvYXJkL21vZHVsZS5qcyIsInBvbGljeS9xdGlwcG9saWN5LmpzIiwibG9naW4vbW9kdWxlLmpzIiwicG9saWN5L3NhdmVzdGF0ZXBvbGljeS5qcyIsIm1lbnUvbW9kdWxlLmpzIiwicG9saWN5L3NwbGl0am9pbm5vZGVwb2xpY3kuanMiLCJuZXR3b3JrX3BvbGljaWVzL21vZHVsZS5qcyIsIm5ldHdvcmtzL21vZHVsZS5qcyIsInBvbGljeS9zcGxpdGpvaW52aWV3cG9saWN5LmpzIiwibm9kZXMvbW9kdWxlLmpzIiwib3JnYW5pemF0aW9ucy9tb2R1bGUuanMiLCJzZXJ2aWNlX2xicy9tb2R1bGUuanMiLCJzZXR0aW5ncy9tb2R1bGUuanMiLCJzdG9yYWdlX3BvbGljaWVzL21vZHVsZS5qcyIsInZpc3VhbGl6YXRpb24vbW9kdWxlLmpzIiwidm9sdW1lcy9tb2R1bGUuanMiLCJhcHAuanMiLCJhcHBsaWNhdGlvbmdyb3Vwcy9hcHBsaWNhdGlvbmdyb3VwY3JlYXRlY3RybC5qcyIsImFwcGxpY2F0aW9uZ3JvdXBzL2FwcGxpY2F0aW9uZ3JvdXBkZXRhaWxzY3RybC5qcyIsImFwcGxpY2F0aW9uZ3JvdXBzL2FwcGxpY2F0aW9uZ3JvdXBsaXN0Y3RybC5qcyIsImFwcGxpY2F0aW9uZ3JvdXBzL2JhbmR3aWR0aHBvbGljeWRpcmVjdGl2ZS5qcyIsImFwcGxpY2F0aW9uZ3JvdXBzL2lzb2xhdGlvbnBvbGljeWRpcmVjdGl2ZS5qcyIsImxvZ2luL2xvZ2luY3RybC5qcyIsIm1lbnUvbWVudUN0cmwuanMiLCJuZXR3b3JrX3BvbGljaWVzL2JhbmR3aWR0aGRpcmVjdGl2ZS5qcyIsIm5ldHdvcmtfcG9saWNpZXMvYmFuZHdpZHRocG9saWN5ZGV0YWlsc2N0cmwuanMiLCJuZXR3b3JrX3BvbGljaWVzL2JhbmR3aWR0aHBvbGljeWxpc3RjdHJsLmpzIiwibmV0d29ya19wb2xpY2llcy9pc29sYXRpb25wb2xpY3lkZXRhaWxzY3RybC5qcyIsIm5ldHdvcmtfcG9saWNpZXMvaXNvbGF0aW9ucG9saWN5bGlzdGN0cmwuanMiLCJuZXR3b3JrX3BvbGljaWVzL25ldHdvcmtwb2xpY2llc3RhYnNjdHJsLmpzIiwibmV0d29ya3MvbmV0d29ya2NyZWF0ZWN0cmwuanMiLCJuZXR3b3Jrcy9uZXR3b3JrZGV0YWlsc2N0cmwuanMiLCJuZXR3b3Jrcy9uZXR3b3JrbGlzdGN0cmwuanMiLCJuZXR3b3Jrcy9uZXR3b3Jrc3RhdHNjdHJsLmpzIiwibm9kZXMvYmdwc2VydmljZS5qcyIsIm5vZGVzL2xvZ3NkaXJlY3RpdmUuanMiLCJub2Rlcy9sb2dzZXJ2aWNlLmpzIiwibm9kZXMvbm9kZWFjdGl2ZWpvYmxvZ3NjdHJsLmpzIiwibm9kZXMvbm9kZWNvbW1pc3Npb25jdHJsLmpzIiwibm9kZXMvbm9kZWRldGFpbHNjdHJsLmpzIiwibm9kZXMvbm9kZWRpcmVjdGl2ZS5qcyIsIm5vZGVzL25vZGVkaXNjb3ZlcmN0cmwuanMiLCJub2Rlcy9ub2RlbGFzdGpvYmxvZ3NjdHJsLmpzIiwibm9kZXMvbm9kZWxpc3RjdHJsLmpzIiwib3JnYW5pemF0aW9ucy9vcmdhbml6YXRpb25jcmVhdGVjdHJsLmpzIiwib3JnYW5pemF0aW9ucy9vcmdhbml6YXRpb25kZXRhaWxzY3RybC5qcyIsIm9yZ2FuaXphdGlvbnMvb3JnYW5pemF0aW9ubGlzdGN0cmwuanMiLCJzZXJ2aWNlX2xicy9zZXJ2aWNlbGJjcmVhdGVjdHJsLmpzIiwic2VydmljZV9sYnMvc2VydmljZWxiZGV0YWlsc2N0cmwuanMiLCJzZXJ2aWNlX2xicy9zZXJ2aWNlbGJsaXN0Y3RybC5qcyIsInNlcnZpY2VfbGJzL3NlcnZpY2VsYnBvcnRzZGlyZWN0aXZlLmpzIiwic2VydmljZV9sYnMvc2VydmljZWxic3RhdHNjdHJsLmpzIiwic2V0dGluZ3MvY2x1c3RlcnNldHRpbmdjdHJsLmpzIiwic2V0dGluZ3MvbmV0d29ya3NldHRpbmdjdHJsLmpzIiwic2V0dGluZ3Mvdm9sdW1lc2V0dGluZ2N0cmwuanMiLCJzdG9yYWdlX3BvbGljaWVzL3N0b3JhZ2Vwb2xpY3ljcmVhdGVjdHJsLmpzIiwic3RvcmFnZV9wb2xpY2llcy9zdG9yYWdlcG9saWN5ZGV0YWlsc2N0cmwuanMiLCJzdG9yYWdlX3BvbGljaWVzL3N0b3JhZ2Vwb2xpY3lkaXJlY3RpdmUuanMiLCJzdG9yYWdlX3BvbGljaWVzL3N0b3JhZ2Vwb2xpY3lsaXN0Y3RybC5qcyIsInZpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbmVkZ2VjdHJsLmpzIiwidmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9uZWRnZWRpcmVjdGl2ZS5qcyIsInZpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbmdyYXBoZGlyZWN0aXZlLmpzIiwidmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9ubGlzdGN0cmwuanMiLCJ2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb25zZXJ2aWNlLmpzIiwidm9sdW1lcy92b2x1bWVjcmVhdGVjdHJsLmpzIiwidm9sdW1lcy92b2x1bWVkZXRhaWxzY3RybC5qcyIsInZvbHVtZXMvdm9sdW1lbGlzdGN0cmwuanMiLCJ2b2x1bWVzL3ZvbHVtZXNlcnZpY2UuanMiLCJ2b2x1bWVzL3ZvbHVtZXNuYXBzaG90Y29weWN0cmwuanMiLCJjb21wb25lbnRzL2RpcmVjdGl2ZXMvYWNjb3JkaW9uZGlyZWN0aXZlLmpzIiwiY29tcG9uZW50cy9kaXJlY3RpdmVzL2NvbGxhcHNpYmxlZGlyZWN0aXZlLmpzIiwiY29tcG9uZW50cy9kaXJlY3RpdmVzL25hbWV2YWx1ZWRpcmVjdGl2ZS5qcyIsImNvbXBvbmVudHMvZGlyZWN0aXZlcy90YWJsZWRpcmVjdGl2ZS5qcyIsImNvbXBvbmVudHMvZGlyZWN0aXZlcy9ub2Rlcy9hY2l2YWxpZGRpcmVjdGl2ZS5qcyIsImNvbXBvbmVudHMvZGlyZWN0aXZlcy9ub2Rlcy9jb250cm9saW50ZXJmYWNlZGlyZWN0aXZlLmpzIiwiY29tcG9uZW50cy9kaXJlY3RpdmVzL25vZGVzL25ldHdvcmttb2RlZGlyZWN0aXZlLmpzIiwiY29tcG9uZW50cy9kaXJlY3RpdmVzL25vZGVzL3NjaGVkdWxlcmRpcmVjdGl2ZS5qcyJdLCJuYW1lcyI6WyJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iLCJzZWxmIiwiY2FsbCIsIlJlZmVyZW5jZUVycm9yIiwiX2luaGVyaXRzIiwic3ViQ2xhc3MiLCJzdXBlckNsYXNzIiwicHJvdG90eXBlIiwiT2JqZWN0IiwiY3JlYXRlIiwiY29uc3RydWN0b3IiLCJ2YWx1ZSIsImVudW1lcmFibGUiLCJ3cml0YWJsZSIsImNvbmZpZ3VyYWJsZSIsInNldFByb3RvdHlwZU9mIiwiX19wcm90b19fIiwiYW5ndWxhciIsIm1vZHVsZSIsIl9jcmVhdGVDbGFzcyIsImRlZmluZVByb3BlcnRpZXMiLCJ0YXJnZXQiLCJwcm9wcyIsImkiLCJsZW5ndGgiLCJkZXNjcmlwdG9yIiwiZGVmaW5lUHJvcGVydHkiLCJrZXkiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJmYWN0b3J5IiwiTm9kZSIsIkxpbmsiLCJEYXRhU291cmNlIiwibm9kZXMiLCJsaW5rcyIsInRoaXMiLCJpZCIsIm5hbWUiLCJub2RlRGF0YSIsIl8iLCJmb3JFYWNoIiwiZGF0YSIsIm5ld05vZGUiLCJ0ZXh0IiwicHVzaCIsImxpbmtEYXRhIiwiZmluZE5vZGVCeUlkIiwic291cmNlIiwibGluayIsIkNvbnRpdkdsb2JhbHMiLCJORVRXT1JLU19FTkRQT0lOVCIsIk5FVFdPUktTX0lOU1BFQ1RfRU5EUE9JTlQiLCJTRVJWSUNFTEJTX0lOU1BFQ1RfRU5EUE9JTlQiLCJQT0xJQ0lFU19FTkRQT0lOVCIsIlJVTEVTX0VORFBPSU5UIiwiQVBQTElDQVRJT05HUk9VUFNfRU5EUE9JTlQiLCJTRVJWSUNFTEJTX0VORFBPSU5UIiwiT1JHQU5JWkFUSU9OU19FTkRQT0lOVCIsIk5FVFdPUktfU0VUVElOR1NfRU5EUE9JTlQiLCJORVRQUk9GSUxFU19FTkRQT0lOVCIsIkJHUFNfRU5EUE9JTlQiLCJCR1BTX0lOU1BFQ1RfRU5EUE9JTlQiLCJWSVNVQUxJWkFUSU9OX0VORFBPSU5UIiwiVk9MVU1FU19FTkRQT0lOVCIsIlZPTFVNRVNfQ1JFQVRFX0VORFBPSU5UIiwiVk9MVU1FU19ERUxFVEVfRU5EUE9JTlQiLCJWT0xVTUVTX0NPUFlTTkFQU0hPVFNfRU5EUE9JTlQiLCJWT0xVTUVTX1VTRVNfRU5EUE9JTlQiLCJWT0xVTUVTX1NOQVBTSE9UU19FTkRQT0lOVCIsIlNUT1JBR0VQT0xJQ0lFU19FTkRQT0lOVCIsIlZPTFVNRVNfR0xPQkFMX0VORFBPSU5UIiwiTk9ERVNfTElTVF9FTkRQT0lOVCIsIk5PREVTX0RJU0NPVkVSX0VORFBPSU5UIiwiTk9ERVNfQ09NTUlTU0lPTl9FTkRQT0lOVCIsIk5PREVTX0RFQ09NTUlTU0lPTl9FTkRQT0lOVCIsIk5PREVTX01BSU5URU5BTkNFX0VORFBPSU5UIiwiTk9ERVNfTEFTVF9KT0JfRU5EUE9JTlQiLCJOT0RFU19BQ1RJVkVfSk9CX0VORFBPSU5UIiwiTk9ERVNfU0VUVElOR1NfU0VUX0VORFBPSU5UIiwiTk9ERVNfU0VUVElOR1NfR0VUX0VORFBPSU5UIiwiUkVGUkVTSF9JTlRFUlZBTCIsIkNJRFJfUkVHRVgiLCJWTEFOX1JFR0VYIiwiVlhMQU5fUkVHRVgiLCJOVU1CRVJfUkVHRVgiLCJWaXN1YWxpemVyTm9kZSIsIlZpc3VhbGl6ZXJMaW5rIiwiVmlzdWFsaXplckRhdGFTb3VyY2UiLCJfRGF0YVNvdXJjZSREYXRhU291cmMiLCJjaGlsZHJlbl9zdHJ1Y3QiLCJhbmNlc3RvcnNfc3RydWN0IiwibGFiZWxzIiwic2VsZWN0b3JzIiwiX3RoaXMiLCJnZXRQcm90b3R5cGVPZiIsInRoaXNEYXRhU291cmNlIiwiYWRkZWRDbGllbnQiLCJub2RlIiwiYW5jZXN0b3JzIiwiaXNFbXB0eSIsInBhcmVudCIsImluY2x1ZGVzIiwidG9wTGV2ZWwiLCJnZXRGbG93QmV0d2VlblNldCIsIm5vZGVfbmFtZXMiLCJsb2NhbF9ub2RlcyIsImlkTWFwcGluZyIsImoiLCJpbmRleE9mIiwid2VpZ2h0Iiwibm9kZV90b19hZGQiLCJub2RlSWRUb05hbWUiLCJhZGRlZF9saW5rcyIsInVuZGVmaW5lZCIsImV4aXN0aW5nX2xpbmsiLCJzZXRXZWlnaHQiLCJnZXRSYXdXZWlnaHQiLCJpbmNyZWFzZUNvdW50IiwiUG9saWN5U2VydmljZSIsIkdyYXBoIiwic3ZnIiwidGhpc0dyYXBoIiwiZGVmYXVsdE5vZGVQb2xpY2llcyIsImRlZmF1bHRQYXRoUG9saWNpZXMiLCJzdmdQb2xpY3kiLCJQb2xpY3kiLCJzdGF0ZSIsImNhblpvb20iLCJjYW5QYW4iLCJpbml0Rm9yY2UiLCJkaXNhYmxlVXBkYXRlIiwiY29uc3RzIiwiY2lyY2xlR0NsYXNzIiwiZ3JhcGhDbGFzcyIsInBhdGhDbGFzcyIsIm5vZGVDbGFzcyIsIm5vZGVUZXh0Iiwic3RhcnRSYWRpdXMiLCJtYXhSYWRpdXMiLCJwYWRkaW5nIiwiZGlzcGxheU9mZnNldCIsIm9uIiwiZCIsImRlZnMiLCJhcHBlbmQiLCJhdHRyIiwic3ZnRyIsImNsYXNzZWQiLCJwYXRocyIsInNlbGVjdEFsbCIsImNpcmNsZXMiLCJpbml0Tm9kZXMiLCJpbml0TGlua3MiLCJzZXRQb3NpdGlvbnMiLCJyZXNpemVGdW5jIiwib25XaW5kb3dSZXNpemUiLCJiaW5kaW5ncyIsInJlc2l6ZSIsIiQiLCJ3aW5kb3ciLCJwb2xpY3kiLCJkZXN0cm95Iiwib2ZmIiwiaW5pdGlhbGl6ZSIsImQzTm9kZSIsImVhY2giLCJkMyIsInNlbGVjdCIsImQzZHJhZyIsImRyYWciLCJwb2xpY3lSZW1vdmUiLCJwb2xpY3lSZW1vdmVOYW1lIiwicG9saWN5TmFtZSIsImluZGV4Iiwic3BsaWNlIiwiZXZlbnQiLCJkM3BhdGgiLCJkM25vZGUiLCJkM3pvb20iLCJkcmFnU3ZnIiwiZ0VsIiwidGl0bGUiLCJ3b3JkcyIsInNwbGl0IiwibndvcmRzIiwiZWwiLCJ0c3BhbiIsInRvU3BsaWNlIiwiZmlsdGVyIiwibCIsIm1hcCIsInVwZGF0ZUdyYXBoIiwic3BsaWNlTGlua3NGb3JOb2RlIiwidXBkYXRlQXR0ciIsIm5ld1BhdGhzIiwibmV3UGF0aEF0dHIiLCJoYXNQb2xpY3kiLCJwYXRoUG9saWN5RXZlbnQiLCJuZXdOb2RlcyIsImdyYXBoIiwibmV3Tm9kZUF0dHIiLCJub2RlUG9saWN5RXZlbnQiLCJTdHJpbmciLCJyYWRpdXMiLCJpbnNlcnRUaXRsZUxpbmVicmVha3MiLCJhbHBoYSIsInF1YWR0cmVlIiwiZ2VvbSIsInIiLCJueDEiLCJ4IiwibngyIiwibnkxIiwieSIsIm55MiIsInZpc2l0IiwicXVhZCIsIngxIiwieTEiLCJ4MiIsInkyIiwicG9pbnQiLCJNYXRoIiwic3FydCIsImUiLCJ3aWR0aCIsImhlaWdodCIsIm9mZnNldCIsInEiLCJuIiwiZDNGb3JjZUNvbGxpZGUiLCJtYXgiLCJtaW4iLCJzdmdXaWR0aCIsInN2Z0hlaWdodCIsImNhbGxiYWNrIiwiYm91bmRzIiwiZDNGb3JjZUJvdW5kcyIsImZvcmNlIiwibGF5b3V0Iiwic2l6ZSIsImNoYXJnZSIsImxpbmtEaXN0YW5jZSIsImxpbmtTdHJlbmd0aCIsImdyYXZpdHkiLCJkM0ZvcmNlVGljayIsImQzRm9yY2VTdGFydCIsImQzRm9yY2VFbmQiLCJzdGFydCIsImsiLCJ0aWNrIiwic3RvcCIsInVwZGF0ZUV4aXN0aW5nTm9kZXMiLCJuZXdHcyIsImVudGVyIiwiZXhpdCIsInJlbW92ZSIsInNldEZvcmNlIiwidXBkYXRlTmV3Tm9kZXMiLCJ1cGRhdGVFeGlzdGluZ1BhdGhzIiwibmV3cGF0aHMiLCJzdHlsZSIsInVwZGF0ZU5ld1BhdGhzIiwiVmlzdWFsaXplckdyYXBoIiwiX0dyYXBoJEdyYXBoIiwiZGF0YVNvdXJjZSIsInRyYW5zaXRpb24iLCJlZGdlX2J1ZmZlciIsInJhZGl1c0RlY2F5IiwiY29udGFpbmVyQ2xhc3MiLCJiZWhhdmlvciIsIm9yaWdpbiIsImFyZ3MiLCJkeCIsImR5Iiwiem9vbSIsInNvdXJjZUV2ZW50IiwiY3RybEtleSIsInpvb21lZCIsInRyYW5zbGF0ZSIsInNjYWxlIiwicmlnaHRDbGljayIsImp1c3RTY2FsZVRyYW5zR3JhcGgiLCJ6b29tU2V0Q2FsbGJhY2siLCJ0cmFuc2xhdGVfbmFtZSIsImRlbGF5IiwiZHVyYXRpb24iLCJib2R5RWwiLCJkb2N1bWVudCIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwiZGl2V2lkdGgiLCJjbGllbnRIZWlnaHQiLCJ0b3AiLCJub2RlX25hbWVzX3NldCIsInJldERhdGEiLCJwcm9jZXNzTGlua0RhdGEiLCJzb3VyY2VOb2RlIiwidGFyZ2V0Tm9kZSIsInBhdGhQb2xpY2llcyIsImluaXRpYWxpemVkIiwiYXJyb3dQYXRoIiwiZHIiLCJ0aGlzUGF0aCIsIl9nZXQiLCJnZXQiLCJvYmplY3QiLCJwcm9wZXJ0eSIsInJlY2VpdmVyIiwiRnVuY3Rpb24iLCJkZXNjIiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwiZ2V0dGVyIiwiX0xpbmskTGluayIsImNvdW50IiwicmV0IiwibXkiLCJhdCIsImFkanVzdCIsIm1heFdlaWdodCIsInVzZUF2Z1dlaWdodCIsInVwZGF0ZU1heFdlaWdodCIsInZhbCIsIm1heExpbmsiLCJtYXhCeSIsImdldFdlaWdodCIsImNvbG9yU2NhbGUiLCJsaW5lYXIiLCJkb21haW4iLCJyYW5nZSIsInNlbGVjdGVkQ2xhc3MiLCJzZWxlY3RlZEVkZ2UiLCJjIiwiYXR0clR3ZWVuIiwiaW50ZXJwb2xhdGVTdHJpbmciLCJub2RlUG9saWNpZXMiLCJ0aGlzTm9kZSIsIl9Ob2RlJE5vZGUiLCJ4U3RhcnQiLCJ5U3RhcnQiLCJOb2RlU2VsZWN0aW9uUG9saWN5IiwiX1BvbGljeSRQb2xpY3kiLCJzZWxlY3RlZE5vZGVzIiwic2VsZWN0aW9uIiwiY2QiLCJzdG9wUHJvcGFnYXRpb24iLCJyZW1vdmVTZWxlY3RGcm9tTm9kZSIsImFkZFNlbGVjdE5vZGUiLCJyZW1vdmVBbGxTZWxlY3RlZE5vZGVzIiwiUGF0aENoYW5nZVZpZXdQb2xpY3kiLCIkc3RhdGUiLCJ0aGlzUG9saWN5IiwicmV0TGlzdCIsImdlbmVyYXRlTGlzdEhlbHBlciIsIm5vZGVJZHMiLCJjaGlsZElkIiwiaGFzQ2hpbGQiLCJzdWJSZXRMaXN0IiwiY29uY2F0IiwiZWRnZSIsInNvdXJjZUxpc3QiLCJ0YXJnZXRMaXN0Iiwic291cmNlSWQiLCJ0YXJnZXRJZCIsImdlbmVyYXRlTGlzdCIsImdvIiwic291cmNlTmFtZSIsInRhcmdldE5hbWUiLCJ2aWV3RWRnZSIsImQzb2JqIiwiY29uZmlnIiwiJHN0YXRlUHJvdmlkZXIiLCJ1cmwiLCJhYnN0cmFjdCIsInRlbXBsYXRlIiwiUVRpcFBvbGljeSIsIlNwbGl0Sm9pbk5vZGVQb2xpY3kiLCJTcGxpdEpvaW5WaWV3UG9saWN5IiwiU2F2ZVN0YXRlUG9saWN5IiwiY29tcG9uZW50IiwibW91c2Vkb3duIiwibW91c2V1cCIsImdyYXBoVXBkYXRlTmV3Tm9kZXMiLCJncmFwaFVwZGF0ZU5ld1BhdGhzIiwiaW50ZXJ2YWwiLCJzZXRUaW1lb3V0IiwicXRpcCIsIndoZW5RVGlwQXZhaWxhYmxlIiwiYXR0YWNoUVRpcCIsInNlbGVjdG9yTWFwIiwiaGFzS2V5cyIsImxhYmVsc01hcCIsInNsaWNlIiwiY29udGVudCIsImV2ZW50cyIsInNob3ciLCJhcGkiLCJwb3NpdGlvbiIsImxlZnQiLCJzZXQiLCJzb2xvIiwiY2xhc3NlcyIsImhpZGUiLCJwYXRoRWwiLCJ0YXJnZXRSZXQiLCJnZXRQb2ludEF0TGVuZ3RoIiwiZ2V0VG90YWxMZW5ndGgiLCJxdGlwSGVscGVyIiwic2F2ZWRTdGF0ZSIsImdyYXBoRGVzdHJveSIsImxvYWQiLCJncmFwaExvYWQiLCJfTm9kZVNlbGVjdGlvblBvbGljeSQiLCJzcGxpdE5vZGVzIiwic3VwZXJTdGF0ZSIsInNwbGl0TXVsdGlwbGVOb2RlcyIsInNwbGl0Tm9kZSIsInByZXZlbnREZWZhdWx0Iiwiam9pbk5vZGUiLCJncmFwaE5vZGVzIiwibmV3X25vZGVzIiwieExvYyIsInlMb2MiLCJuZXdfbm9kZV9vYmpzIiwibmV3X25vZGUiLCJyZXMiLCJfX3NwbGl0Tm9kZSIsInNwbGl0Tm9kZUV2ZW50IiwicmVzTm9kZXMiLCJzcGxpdE11bHRpcGxlTm9kZXNFdmVudCIsInRvX2JlX2RlbGV0ZWQiLCJuZXdfbm9kZV9pZCIsIm5vZGVfdG9fZGVsZXRlIiwiX19qb2luTm9kZSIsImpvaW5Ob2RlRXZlbnQiLCJqb2luTXVsdGlwbGVOb2Rlc0V2ZW50IiwiX1NwbGl0Sm9pbk5vZGVQb2xpY3kkIiwic2F2ZWRTdGF0ZXMiLCJldmVudEhpc3RvcnkiLCJmb2N1c0dyb3VwcyIsImZvY2kiLCJ6b29tcyIsImxheW91dERlZmF1bHQiLCJ6b29tRGVmYXVsdCIsIm5vZGVJZHNUb1Jlc2hvdyIsImJhY2tCdXR0b25FbGVtIiwidGl0bGVFbGVtIiwiYm91bmRhcnkiLCJlbGVtIiwiYmFja0J1dHRvbiIsInVuZG9MYXN0RXZlbnQiLCJzYXZlIiwiY3VyclRpdGxlIiwic3RhdGVzIiwibG9hZFN0YXRlIiwiZmFkZVRvIiwidHlwZSIsInBvcyIsImNvbnNvbGUiLCJsb2ciLCJ1cGRhdGVHcmFwaENhbGxiYWNrIiwibm9kZXNUb0tlZXAiLCJncm91cE9uZU5vZGVzIiwicGFyc2VGbG9hdCIsInNwbGl0Tm9kZUZ1bmMiLCJnZXRSYW5kb21JbnQiLCJmbG9vciIsInJhbmRvbSIsImdyYXBoQ29uc3RzIiwic3RhdGVQb2xpY3kiLCJkZWZhdWx0TGF5b3V0IiwiY2FsY01heE5vZGVzIiwiYXJlYSIsImFtb3VudCIsImNvbnN0c1BvbGljeSIsImZvY3VzTm9kZXMiLCJib3QiLCJwb3AiLCJzZXRMYXlvdXQiLCJzdGF0ZVN1cGVyIiwibm9kZU5hbWVTZXQiLCJuYW1lVG9BZGQiLCJub2Rlc1RvUHJvY2VzcyIsInByb2Nlc3NOb2RlRGF0YSIsIm5vZGVUb1JlbW92ZSIsImxhc3QiLCJmaW5kRDNOb2RlIiwiZGJsY2xpY2siLCJub2RlSWQiLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJvdGhlcndpc2UiLCIkc3RhdGVQYXJhbXMiLCJBcHBsaWNhdGlvbkdyb3Vwc01vZGVsIiwiTmV0d29ya3NNb2RlbCIsIkNSVURIZWxwZXJTZXJ2aWNlIiwicmV0dXJuVG9BcHBsaWNhdGlvbkdyb3VwIiwiY2FuY2VsQ3JlYXRpbmciLCJnZXROZXR3b3JrcyIsInRoZW4iLCJyZXN1bHQiLCJhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCIsIm5ldHdvcmtzIiwidGVuYW50TmFtZSIsImNyZWF0ZUFwcGxpY2F0aW9uR3JvdXAiLCJmb3JtIiwiJHZhbGlkIiwiaGlkZVNlcnZlckVycm9yIiwic3RhcnRMb2FkZXIiLCJhcHBsaWNhdGlvbkdyb3VwIiwibmV0d29ya05hbWUiLCJzZWxlY3RlZE5ldHdvcmsiLCJnZW5lcmF0ZUtleSIsInN0b3BMb2FkZXIiLCJzaG93U2VydmVyRXJyb3IiLCJyZXNldEZvcm0iLCJncm91cE5hbWUiLCJwb2xpY2llcyIsIm5ldFByb2ZpbGUiLCJtb2RlIiwic2V0TW9kZSIsImlzIiwiYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsIiwicmV0dXJuVG9BcHBsaWNhdGlvbkdyb3VwRGV0YWlscyIsImNhbmNlbEVkaXRpbmciLCJkZWxldGVBcHBsaWNhdGlvbkdyb3VwIiwic2F2ZUFwcGxpY2F0aW9uR3JvdXAiLCJnZXRNb2RlbEJ5S2V5IiwiZ3JvdXAiLCIkc2NvcGUiLCIkaW50ZXJ2YWwiLCIkZmlsdGVyIiwiZ2V0QXBwbGljYXRpb25Hcm91cHMiLCJyZWxvYWQiLCJhcHBsaWNhdGlvbkdyb3VwTGlzdEN0cmwiLCJncm91cHMiLCJwcm9taXNlIiwiaXNEZWZpbmVkIiwiJG9uIiwiY2FuY2VsIiwiZGlyZWN0aXZlIiwicmVzdHJpY3QiLCJzY29wZSIsImFwcGxpY2F0aW9uZ3JvdXAiLCJOZXRwcm9maWxlc01vZGVsIiwiZ2V0TmV0cHJvZmlsZXMiLCJuZXRQcm9maWxlcyIsInNlbGVjdGVkTmV0cHJvZmlsZSIsImZpbmQiLCJwcm9maWxlTmFtZSIsInVwZGF0ZUFwcGxpY2F0aW9uZ3JvdXAiLCJQb2xpY2llc01vZGVsIiwiUnVsZXNNb2RlbCIsImdldFJ1bGVzIiwiZ2V0SW5jb21pbmdSdWxlcyIsInJ1bGVzIiwiQXJyYXkiLCJhcHBseSIsImluY29taW5nUnVsZXMiLCJnZXRPdXRnb2luZ1J1bGVzIiwib3V0Z29pbmdSdWxlcyIsImdldElzb2xhdGlvblBvbGljaWVzIiwiaXNvbGF0aW9uUG9saWNpZXMiLCJzZWxlY3RlZFBvbGljeSIsInNlbGVjdGVkUG9saWNpZXMiLCJhZGRJc29sYXRpb25Qb2xpY3kiLCJjdXJyZW50UG9saWN5TmFtZSIsInJlbW92ZUlzb2xhdGlvblBvbGljeSIsInJ1bGUiLCJyZXR1cm5Ub0Rhc2hib2FyZCIsInVzZXJuYW1lIiwibG9naW5DdHJsIiwibG9naW4iLCJwYXJhbXMiLCJsb2dvdXQiLCJtZW51Q3RybCIsImJhbmR3aWR0aFBvbGljeSIsImJhbmR3aWR0aCIsImJhbmR3aWR0aEFycmF5IiwiYmFuZHdpZHRoTnVtYmVyIiwiTnVtYmVyIiwiYmFuZHdpZHRoVW5pdCIsImJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsIiwiZGVsZXRlUG9saWN5IiwiZGVsZXRlVXNpbmdLZXkiLCJyZXR1cm5Ub1BvbGljaWVzIiwicmV0dXJuVG9Qb2xpY3lEZXRhaWxzIiwic2F2ZVBvbGljeSIsImJhbmR3aWR0aFByb2ZpbGVzIiwiZ2V0UG9saWNpZXMiLCJwb2xpY2llc0xpc3RDdHJsIiwiaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwiLCJkb25lRWRpdGluZyIsInJlc2V0TmV3SW5jb21pbmdSdWxlIiwibmV3SW5jb21pbmdSdWxlIiwicnVsZUlkIiwicHJpb3JpdHkiLCJhY3Rpb24iLCJmcm9tRW5kcG9pbnRHcm91cCIsImZyb21OZXR3b3JrIiwiZnJvbUlwQWRkcmVzcyIsInByb3RvY29sIiwicG9ydCIsImRpcmVjdGlvbiIsIm5ld0luY29taW5nU2VsZWN0ZWRBcHBsaWNhdGlvbkdyb3VwIiwibmV3SW5jb21pbmdTZWxlY3RlZE5ldHdvcmsiLCJkaXNhYmxlSW5jb21pbmdOZXR3b3JrU2VsZWN0aW9uIiwiZGlzYWJsZUluY29taW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiIsImRpc2FibGVJbmNvbWluZ0lQQWRkcmVzc1NlbGVjdGlvbiIsImluY29ycmVjdENJRFIiLCJ2YWxpZGF0ZUNJRFJGbGFnIiwicmVzZXROZXdPdXRnb2luZ1J1bGUiLCJuZXdPdXRnb2luZ1J1bGUiLCJ0b0VuZHBvaW50R3JvdXAiLCJ0b05ldHdvcmsiLCJ0b0lwQWRkcmVzcyIsIm5ld091dGdvaW5nU2VsZWN0ZWRBcHBsaWNhdGlvbkdyb3VwIiwibmV3T3V0Z29pbmdTZWxlY3RlZE5ldHdvcmsiLCJkaXNhYmxlT3V0Z29pbmdOZXR3b3JrU2VsZWN0aW9uIiwiZGlzYWJsZU91dGdvaW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiIsImRpc2FibGVPdXRnb2luZ0lQQWRkcmVzc1NlbGVjdGlvbiIsImFwcGxpY2F0aW9uR3JvdXBzIiwib25DaGFuZ2VPdXRnb2luZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24iLCJvbkNoYW5nZUluY29taW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiIsIm9uQ2hhbmdlT3V0Z29pbmdOZXR3b3JrU2VsZWN0aW9uIiwiVG9FbmRwb2ludEdyb3VwIiwib25DaGFuZ2VJbmNvbWluZ05ldHdvcmtTZWxlY3Rpb24iLCJnZW5lcmF0ZVJ1bGVJZCIsInRvU3RyaW5nIiwiRGF0ZSIsIm5vdyIsImFkZEluY29taW5nUnVsZSIsInZhbGlkYXRlQ0lEUiIsIm9uQ2hhbmdlSW5jb21pbmdJUEFkZHJlc3MiLCJvbkNoYW5nZU91dGdvaW5nSVBBZGRyZXNzIiwiaXBhZGRyZXNzIiwiY2lkclBhdHRlcm4iLCJSZWdFeHAiLCJ0ZXN0IiwiYWRkT3V0Z29pbmdSdWxlIiwiZGVsZXRlSW5jb21pbmdSdWxlIiwiZGVsZXRlT3V0Z29pbmdSdWxlIiwiY3JlYXRlTmV0d29ya1BvbGljeSIsIiRjdXJyZW50IiwibmV0d29ya1BvbGljaWVzVGFic0N0cmwiLCJyZXR1cm5Ub05ldHdvcmtzIiwiY3JlYXRlTmV0d29yayIsIm5ldHdvcmtDcmVhdGVDdHJsIiwibmV3TmV0d29yayIsImVuY2FwIiwic3VibmV0IiwiZ2F0ZXdheSIsImRlbGV0ZU5ldHdvcmsiLCJuZXR3b3JrRGV0YWlsc0N0cmwiLCJuZXR3b3JrIiwiTmV0d29ya3NMaXN0Q3RybCIsIm5ldHdvcmtzTGlzdEN0cmwiLCIkaW5qZWN0IiwiY29udHJvbGxlckFzIiwiSW5zcGVjdFNlcnZpY2UiLCJnZXROZXR3b3JrSW5zcGVjdCIsInJlZnJlc2giLCJnZXRJbnNwZWN0QnlLZXkiLCJuZXR3b3JrU3RhdHNDdHJsIiwibmV0d29ya0luc3BlY3RTdGF0cyIsIk9wZXIiLCJDb25maWciLCJlbmRwb2ludHMiLCJjb250YWluZXJEZXRhaWxzIiwiYnVpbGRFbmRQb2ludHMiLCJjaGVja0NvbnRhaW5lckNoYW5nZWQiLCIkaHR0cCIsIiRxIiwiZ2V0QmdwIiwiY3RybCIsImRlZmVycmVkIiwiZGVmZXIiLCJyZXNvbHZlIiwibmVpZ2hib3IiLCJuZWlnaGJvcnMiLCJyZWplY3QiLCJ1cGRhdGVCZ3AiLCJwb3N0IiwiZ2V0QmdwSW5zcGVjdCIsImdldEFjdGl2ZUxvZ3MiLCJnZXRMYXN0TG9ncyIsIkxvZ1NlcnZpY2UiLCJub2RlQWN0aXZlSm9iTG9nc0N0cmwiLCJhY3RpdmVMb2dzIiwiTm9kZXNNb2RlbCIsIk5vZGVzU2VydmljZSIsInJldHVyblRvTm9kZURldGFpbHMiLCJjYW5jZWxDb21taXNzaW9uaW5nTm9kZSIsImNvbW1pc3Npb24iLCJub2RlQ29tbWlzc2lvbkN0cmwiLCJub2RlT3BzT2JqIiwiY2xlYW51cEV4dHJhVmFycyIsImNyZWF0ZUV4dHJhVmFycyIsImV4dHJhX3ZhcnMiLCJhbnNpYmxlVmFyaWFibGVzIiwiZW52VmFyaWFibGVzIiwiZ2V0U2V0dGluZ3MiLCJCZ3BTZXJ2aWNlIiwiZGVjb21taXNzaW9uIiwibm9kZURldGFpbHNDdHJsIiwic2hvd0NvbW1pc3Npb25CdXR0b24iLCJjb21taXNzaW9uQnV0dG9uRW5hYmxlZCIsInVwZ3JhZGVCdXR0b25FbmFibGVkIiwidXBncmFkZSIsInNldEJ1dHRvbkRpc3BsYXkiLCJzdGF0dXMiLCJnZXROb2RlSW5mbyIsInJldHVyblRvSW5mbyIsInVwZGF0ZUJncEluZm8iLCJpdGVtIiwiZ2V0QmdwSW5mbyIsImluc3BlY3QiLCJyb3V0ZXMiLCJmaWx0ZXJlZHJvdXRlcyIsIm51bWJlcnBhdHRlcm4iLCJyZXR1cm5Ub05vZGVzIiwiY2FuY2VsRGlzY292ZXJpbmdOb2RlIiwiZGlzY292ZXIiLCJub2RlRGlzY292ZXJDdHJsIiwiY3JlYXRlSVBBZGRyQXJyYXkiLCJhZGRycyIsIm5vZGVJUEFkZHIiLCJub2RlTGFzdEpvYkxvZ3NDdHJsIiwibGFzdExvZ3MiLCJnZXROb2RlcyIsIm5vZGVMaXN0Q3RybCIsIk9yZ2FuaXphdGlvbnNNb2RlbCIsInJldHVyblRvT3JnYW5pemF0aW9ucyIsImNyZWF0ZU9yZ2FuaXphdGlvbiIsIm9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwiLCJuZXdPcmdhbml6YXRpb24iLCJkZWxldGVPcmdhbml6YXRpb24iLCJvcmdhbml6YXRpb25EZXRhaWxzQ3RybCIsIm9yZ2FuaXphdGlvbiIsImdldE9yZ2FuaXphdGlvbnMiLCJvcmdhbml6YXRpb25zTGlzdEN0cmwiLCJvcmdhbml6YXRpb25zIiwiU2VydmljZWxic01vZGVsIiwicmV0dXJuVG9TZXJ2aWNlbGJzIiwic2VydmljZWxiQ3JlYXRlQ3RybCIsImNyZWF0ZUxhYmVsU2VsZWN0b3JTdHJpbmdzIiwic2VydmljZWxiIiwibGFiZWxTZWxlY3RvcnMiLCJsYWJlbFNlbGVjdG9yIiwic2VsZWN0b3JTdHJpbmciLCJjcmVhdGVTZXJ2aWNlbGIiLCJzZXJ2aWNlTmFtZSIsImlwQWRkcmVzcyIsInBvcnRzIiwic2VydmljZWxiRGV0YWlsc0N0cmwiLCJyZXR1cm5Ub1NlcnZpY2VsYkRldGFpbHMiLCJkZWxldGVTZXJ2aWNlbGIiLCJzYXZlU2VydmljZWxiIiwiZXhpc3RpbmdMYWJlbHMiLCJjcmVhdGVMYWJlbFNlbGVjdG9ycyIsInNlbGVjdG9yU3RyIiwic2VsZWN0b3IiLCJnZXRTZXJ2aWNlbGJzIiwic2VydmljZWxiTGlzdEN0cmwiLCJzZXJ2aWNlbGJzIiwiaXRlbXMiLCJjb21wYXJlIiwidmFsMSIsInZhbDIiLCJyZXNldE5ld0l0ZW0iLCJuZXdJdGVtIiwic2VydmljZVBvcnQiLCJwcm92aWRlclBvcnQiLCJpc0VtcHR5SXRlbSIsImFkZCIsIm5ld0l0ZW1TdHIiLCJwdWxsQWxsV2l0aCIsInBhc3NlZEl0ZW0iLCJnZXRTZXJ2aWNlbGJJbnNwZWN0Iiwic2VydmljZWxiU3RhdHNDdHJsIiwic2VydmljZWxiSW5zcGVjdFN0YXRzIiwicHJvdmlkZXJzIiwicHJvdmlkZXJEZXRhaWxzIiwidXBkYXRlQ2x1c3RlclNldHRpbmdzIiwiY2x1c3RlclNldHRpbmdDdHJsIiwidXBkYXRlU2V0dGluZ3MiLCJOZXR3b3JrU2VydmljZSIsInVwZGF0ZU5ldHdvcmtTZXR0aW5ncyIsIm5ldHdvcmtTZXR0aW5nQ3RybCIsInNldHRpbmciLCJnZXROZXR3b3JrU2V0dGluZ3MiLCJ2bGFuUGF0dGVybiIsInZ4bGFuUGF0dGVybiIsIlZvbHVtZVNldHRpbmdTZXJ2aWNlIiwidXBkYXRlVm9sdW1lU2V0dGluZ3MiLCJ2b2x1bWVTZXR0aW5nQ3RybCIsImdldFZvbHVtZVNldHRpbmdzIiwiU3RvcmFnZVBvbGljaWVzTW9kZWwiLCJyZXR1cm5Ub1N0b3JhZ2VQb2xpY2llcyIsImNyZWF0ZUZpbGVzeXN0ZW1DbWRzIiwic3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwiLCJmaWxlc3lzdGVtY21kcyIsIm5ld1N0b3JhZ2VQb2xpY3kiLCJmaWxlc3lzdGVtcyIsImNyZWF0ZVBvbGljeSIsImJhY2tlbmRzIiwiY3J1ZCIsIm1vdW50Iiwic25hcHNob3QiLCJ1bmxvY2tlZCIsImRyaXZlciIsInBvb2wiLCJmaWxlc3lzdGVtIiwicnVudGltZSIsInNuYXBzaG90cyIsImZyZXF1ZW5jeSIsImtlZXAiLCJyYXRlLWxpbWl0Iiwid3JpdGUtaW9wcyIsInJlYWQtaW9wcyIsIndyaXRlLWJwcyIsInJlYWQtYnBzIiwiVm9sdW1lc01vZGVsIiwic3RvcmFnZVBvbGljeURldGFpbHNDdHJsIiwiZ2V0Vm9sdW1lcyIsInZvbHVtZXMiLCJpbml0aWFsaXplRmlsZXN5c3RlbUNtZHNBcnJheSIsInN0b3JhZ2VQb2xpY3lMaXN0Q3RybCIsIlZpc3VhbGl6YXRpb25TZXJ2aWNlIiwidCIsImdldFNlY29uZHMiLCJlZGdlRGF0YUludGVydmFsIiwiZ2V0RWRnZURhdGEiLCJyZXN1bHRzIiwic2VyaWVzIiwidmFsdWVzIiwiZWRnZURhdGEiLCJlZGdlRGF0YVRpbWUiLCJnZXRPbGRFZGdlRGF0YSIsIm9sZEVkZ2VEYXRhIiwiJHdpbmRvdyIsInZpc3VhbGl6YXRpb25FZGdlRDMiLCJwYXRoIiwibGluZSIsImxpbWl0IiwiYXhpcyIsImVhc2UiLCJ5QXhpcyIsInNoaWZ0IiwiY2xpZW50V2lkdGgiLCJjdXJyZW50IiwiY29sb3IiLCJ0aW1lIiwiaW50ZXJwb2xhdGUiLCJ4U3ZnIiwib3JpZW50IiwicmVwbGFjZSIsIiR3YXRjaEdyb3VwIiwic2VydmljZSIsIlN0YXRlU2F2ZSIsInZpc3VhbGl6YXRpb25saXN0ZDMiLCJzZXJ2aWNlU2VsZWN0b3JzIiwic2V0QW5jZXN0b3JzIiwidG9wRGF0YSIsImdldFRvcExldmVsRmxvdyIsInJhd1N2ZyIsInZpc3VhbGl6YXRpb25HcmFwaCIsImluc3RhbGxEZWZhdWx0UGF0aFBvbGljeSIsInFUaXBQb2xpY3kiLCJpbnN0YWxsRGVmYXVsdE5vZGVQb2xpY3kiLCJzcGxpdEpvaW5WaWV3UG9saWN5IiwiaW5zdGFsbEJhY2tCdXR0b24iLCJpbnN0YWxsVGl0bGUiLCJ1bmJpbmQiLCJ1cGRhdGVMaW5rRGF0YSIsInN1Y2Nlc3NHcmFwaERhdGFDYWxsYmFjayIsImVuZHBvaW50IiwidGFncyIsIkVuZHBvaW50SVAiLCJwcm92aWRlciIsIlByb3ZpZGVySVAiLCJsaW5rT3V0IiwibGlua0luIiwiZ2V0R3JhcGhEYXRhIiwiZ3JhcGhEYXRhSW50ZXJ2YWwiLCJnZXRTdHJ1Y3R1cmVEYXRhIiwibWFrZUdldCIsIm1ha2VQb3N0IiwicGFyYW0iLCJvYmoiLCJmdWxsU3ViTmFtZSIsInN1Yk5hbWUiLCJzdWJWYWx1ZSIsImlubmVyT2JqIiwicXVlcnkiLCJlbmNvZGVVUklDb21wb25lbnQiLCJzdWJzdHIiLCJtZXRob2QiLCJoZWFkZXJzIiwiQ29udGVudC1UeXBlIiwidHJhbnNmb3JtUmVxdWVzdCIsImlzT2JqZWN0IiwiZGIiLCJidWlsZFdoZXJlUXVlcnkiLCJwb2ludHMiLCJyZXR1cm5Ub1ZvbHVtZXNNb2RlbCIsImdldFN0b3JhZ2VQb2xpY2llcyIsInZvbHVtZUNyZWF0ZUN0cmwiLCJhcHBseVBvbGljeVNldHRpbmdzIiwibmV3Vm9sdW1lIiwiY3JlYXRlVm9sdW1lIiwiVm9sdW1lU2VydmljZSIsInJldHVyblRvVm9sdW1lcyIsImRlbGV0ZVZvbHVtZSIsInZvbHVtZURldGFpbHNDdHJsIiwidm9sdW1lIiwiZ2V0Vm9sdW1lSW5mbyIsInRva2VucyIsIm1vZGVsIiwiZ2V0TW9kZWwiLCJnZXRWb2x1bWVVc2VJbmZvIiwiZ2V0Vm9sdW1lU25hcHNob3RzIiwidm9sdW1lVXNlIiwidHJpZ2dlclZvbHVtZVNuYXBzaG90Iiwic25hcHNob3RTdWNjZXNzIiwidHJpZ2dlclNuYXBzaG90Iiwidm9sdW1lTGlzdEN0cmwiLCJjYW5jZWxDb3B5IiwiZ29Ub05ld1ZvbHVtZSIsInZvbHVtZVNuYXBzaG90Q29weUN0cmwiLCJuZXd2b2x1bWUiLCJjb3B5U25hcHNob3QiLCJjb3B5IiwidHJhbnNjbHVkZSIsImVsZW1lbnQiLCJhY2NvcmRpb24iLCJjb2xsYXBzZWQiLCJuYW1laGVhZGVyIiwidmFsdWVoZWFkZXIiLCJvcHRpb25zIiwiZmlsdGVyRmlsdGVyIiwibGltaXRUb0ZpbHRlciIsImZpbHRlcmVkaXRlbXMiLCJkZWZhdWx0c29ydGNvbHVtbiIsIiRlbGVtZW50IiwiJGF0dHJzIiwic2hvd0NodW5rIiwicGFnZU5vIiwic2VhcmNoVGV4dCIsInRhYmxlQ3RybCIsInNlYXJjaFRleHRGaWx0ZXJlZEl0ZW1zIiwic29ydE9iaiIsImZpZWxkIiwicmV2ZXJzZSIsIm5vT2ZDaHVua3MiLCJjZWlsIiwiY2h1bmtzIiwic2VsZWN0ZWQiLCJzbGljZVN0YXJ0Iiwic2xpY2VFbmQiLCJwYWdpbmF0aW9uTWVudSIsImZpbHRlcmVkSXRlbXMiLCJzaG93UHJldkNodW5rIiwicHJldkNodW5rIiwic2hvd05leHRDaHVuayIsIm5leHRDaHVuayIsImFkZFBhZ2luYXRpb25NZW51IiwibWVudSIsImluaXRpYWxpemVTb3J0Iiwic29ydGZpZWxkIiwiaWNvbkRpcmVjdGlvbiIsImFuZ2xlIGRvd24gaWNvbiIsImFuZ2xlIHVwIGljb24iLCJzb3J0IiwiJGFwcGx5IiwicGFyc2VJbnQiLCJpc05hTiIsImF0dHJzIiwiJHBhcmVudCIsIiR3YXRjaCIsInJlcXVpcmUiLCJjbGFzcyIsInRhYmxlY3RybCIsImJpbmQiLCJwbGFjZWhvbGRlciIsImNvbHNwYW4iLCJleHRyYXZhcnMiXSwibWFwcGluZ3MiOiJBQUFBLFlBYUEsU0FBU0EsaUJBQWdCQyxFQUFVQyxHQUFlLEtBQU1ELFlBQW9C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QUFBcnhCLEVBQUFveUIsR0FDQUEsRUFBQWlCLGtCQUFBeGEsR0FFQXVaLEVBQUFILFVBQUFHLEVBQUFGLE9BQUFFLEVBQUFELFlBQ0F0WixFQUFBb1osVUFBQSxTQUFBQyxHQUNBRSxFQUFBSCxVQUFBQyxFQUFBRSxFQUFBRCxhQUVBdFosRUFBQW9hLGNBQUFiLEVBQUFhLGNBQ0FwYSxFQUFBc2EsY0FBQWYsRUFBQWUsZUFFQTVkLFlBQUEsK0NDeFFBeGQsUUFBQUMsT0FBQSxxQkFDQTJnQixVQUFBLGNBQUEsV0FDQSxPQUNBQyxTQUFBLElBQ0FyRCxZQUFBLDRDQUNBc0QsT0FDQXJDLEtBQUEsUUNOQXplLFFBQUFDLE9BQUEscUJBQ0EyZ0IsVUFBQSxzQkFBQSxXQUNBLE9BQ0FDLFNBQUEsSUFDQXJELFlBQUEsb0RBQ0FzRCxPQUNBNGIsVUFBQSxRQ05BMThCLFFBQUFDLE9BQUEscUJBQ0EyZ0IsVUFBQSxpQkFBQSxXQUNBLE9BQ0FDLFNBQUEsSUFDQXJELFlBQUEsK0NBQ0FzRCxPQUNBNGIsVUFBQSxRQ05BMThCLFFBQUFDLE9BQUEscUJBQ0EyZ0IsVUFBQSxlQUFBLFdBQ0EsT0FDQUMsU0FBQSxJQUNBckQsWUFBQSw2Q0FDQXNELE9BQ0E0YixVQUFBIiwiZmlsZSI6ImFwcC9idW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbi8qKlxuICogRGVmaW5pbmcgdGhlIEdyYXBoIE1vZHVsZS5cbiAqIFNlZSBERVNJR04ubWQgZm9yIGluZm8gb24gR3JhcGggT2JqZWN0cy5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcsIFtdKTtcbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIiwgW10pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcFxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4vKipcbiAqIFRoZSBiYXNlIGNsYXNzIHRoZSBEYXRhU291cmNlIG9iamVjdC5cbiAqIFxuICogVGhlIERhdGFTb3VyY2Ugb2JqZWN0IHRha2VzIGluIG5vZGUgYW5kIGxpbmsgZGF0YSBmcm9tIHRoZSBzZXJ2ZXIsIFxuICogYW5kIHByb3ZpZGVzIG1ldGhvZHMgZm9yIGNvbnZlcnRpbmcgYW5kIG1hbmlwdWxhdGluZyB0aGUgZGF0YSBmb3JcbiAqIHRoZSBncmFwaCBvYmplY3QuXG4gKiBcbiAqIFRvIHdyaXRlIHlvdXIgb3duIERhdGFTb3VyY2Ugb2JqZWN0LCBjcmVhdGUgYSBuZXcgZmFjdG9yeSB0aGF0IHVzZXMgdGhlIFxuICogRGF0YVNvdXJjZSB5b3Ugd2FudCB0byBpbmhlcml0IGFzIGEgZGVwZW5kZW5jeSwgYW5kIGV4dGVuZCBcbiAqIGl0cyBEYXRhU291cmNlIGNsYXNzLiBcbiAqIFJldHVybiB0aGUgY2xhc3Mgb2JqZWN0IHdpdGggRGF0YVNvdXJjZSBhcyBrZXkuXG4gKiBcbiAqIE5vZGUgZGF0YSBpcyBleHBlY3RlZCB0byBiZSBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDpcbiAqIHtpZDpub2RlX2lkLCB0ZXh0Om5vZGVfdGV4dH1cbiAqIFxuICogTGluayBkYXRhIGlzIGV4cGVjdGVkIHRvIGJlIGluIHRoZSBmb2xsb3dpbmcgZm9ybWF0OlxuICoge3NvdXJjZTogc291cmNlTm9kZUlkLCB0YXJnZXQ6IHRhcmdldE5vZGVJZH1cbiAqIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnRGF0YVNvdXJjZScsIFsnTm9kZScsICdMaW5rJywgZnVuY3Rpb24gKE5vZGUsIExpbmspIHtcblx0dmFyIERhdGFTb3VyY2UgPSBmdW5jdGlvbiAoKSB7XG5cdFx0LyoqXG4gICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICpcbiAgICogQHBhcmFtICAgICAge0FycmF5fSAgIG5vZGVzICAgICAgICAgICAgICBUaGUgbm9kZSBkYXRhIFxuICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgbGlua3MgICAgICAgICAgICAgIFRoZSBsaW5rIGRhdGFcbiAgICovXG5cdFx0ZnVuY3Rpb24gRGF0YVNvdXJjZShub2RlcywgbGlua3MpIHtcblx0XHRcdF9jbGFzc0NhbGxDaGVjayh0aGlzLCBEYXRhU291cmNlKTtcblxuXHRcdFx0dGhpcy5ub2RlcyA9IG5vZGVzO1xuXHRcdFx0dGhpcy5saW5rcyA9IGxpbmtzO1xuXHRcdH1cblxuXHRcdC8qKlxuICAgKiBSZXBsYWNlcyB0aGUgbm9kZSBkYXRhXG4gICAqXG4gICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZXMgICBUaGUgbm9kZXNcbiAgICovXG5cblxuXHRcdF9jcmVhdGVDbGFzcyhEYXRhU291cmNlLCBbe1xuXHRcdFx0a2V5OiAndXBkYXRlTm9kZXMnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZU5vZGVzKG5vZGVzKSB7XG5cdFx0XHRcdHRoaXMubm9kZXMgPSBub2Rlcztcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBSZXBsYWNlcyB0aGUgbGluayBkYXRhXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge0xpbmt9ICBsaW5rcyAgIFRoZSBsaW5rc1xuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICd1cGRhdGVMaW5rcycsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gdXBkYXRlTGlua3MobGlua3MpIHtcblx0XHRcdFx0dGhpcy5saW5rcyA9IGxpbmtzO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIFJldHVybnMgdGhlIE5hbWUgYXR0cmlidXRlIG9mIHRoZSBOb2RlIHdpdGggdGhlIFxuICAgICogbWF0Y2hpbmcgaWRcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgaWQgICAgICBUaGUgaWRlbnRpZmllclxuICAgICogQHJldHVybiAgICAge3N0cmluZ30gIG5hbWUgb2YgdGhlIG1hdGNoaW5nIG5vZGVcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnbm9kZUlkVG9OYW1lJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBub2RlSWRUb05hbWUoaWQpIHtcblx0XHRcdFx0dmFyIG5vZGVzID0gdGhpcy5ub2Rlcztcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdGlmIChub2Rlc1tpXS5pZCA9PSBpZCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIG5vZGVzW2ldLm5hbWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogcHJvY2VzcyB0aGUgbm9kZURhdGEgdG8gY3JlYXRlIE5vZGUgb2JqZWN0c1xuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVEYXRhICBOb2RlRGF0YSB0byBjb252ZXJ0IFxuICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIG5vZGUgb2JqZWN0c1xuICAgICogQHJldHVybiAgICAge0FycmF5fSAgTm9kZSBvYmplY3RzXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3Byb2Nlc3NOb2RlRGF0YScsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gcHJvY2Vzc05vZGVEYXRhKG5vZGVEYXRhKSB7XG5cdFx0XHRcdHZhciBub2RlcyA9IFtdO1xuXHRcdFx0XHRfLmZvckVhY2gobm9kZURhdGEsIGZ1bmN0aW9uIChkYXRhKSB7XG5cdFx0XHRcdFx0dmFyIG5ld05vZGUgPSBuZXcgTm9kZS5Ob2RlKG51bGwsIG51bGwsIGRhdGEuaWQsIGRhdGEudGV4dCwgbnVsbCk7XG5cdFx0XHRcdFx0bm9kZXMucHVzaChuZXdOb2RlKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdHJldHVybiBub2Rlcztcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBwcm9jZXNzIHRoZSBsaW5rRGF0YVxuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIGxpbmtEYXRhICBUaGUgbGluayBkYXRhXG4gICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlcyAgICAgVGhlIG5vZGVzIGZyb20gcHJvY2Vzc05vZGVEYXRhXG4gICAgKiBAcmV0dXJuICAgICB7QXJyYXl9ICBMaW5rIG9iamVjdHNcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAncHJvY2Vzc0xpbmtEYXRhJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBwcm9jZXNzTGlua0RhdGEobGlua0RhdGEsIG5vZGVzKSB7XG5cdFx0XHRcdC8qKlxuICAgICAqIFJldHVybnMgdGhlIG5vZGUgdGhhdCBtYXRjaGVzIHRoZSBpZFxuICAgICAqXG4gICAgICogQHBhcmFtICAgICAge3N0cmluZ30gaWQgICAgICBUaGUgaWRlbnRpZmllclxuICAgICAqIEByZXR1cm4gICAgIHtOb2RlfSAgIFRoZSBub2RlIHdpdGggdGhlIG1hdGNoaW5nIGlkXG4gICAgICovXG5cdFx0XHRcdGZ1bmN0aW9uIGZpbmROb2RlQnlJZChpZCwgbm9kZXMpIHtcblx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRpZiAoaWQgPT0gbm9kZXNbaV0uaWQpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIG5vZGVzW2ldO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdHZhciBsaW5rcyA9IFtdO1xuXHRcdFx0XHQvL3RyYW5zZm9ybWluZyBsaW5rIGRhdGFcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBsaW5rRGF0YS5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdGlmIChsaW5rRGF0YVtpXS5zb3VyY2UgIT0gbGlua0RhdGFbaV0udGFyZ2V0KSB7XG5cdFx0XHRcdFx0XHR2YXIgc291cmNlID0gZmluZE5vZGVCeUlkKGxpbmtEYXRhW2ldLnNvdXJjZSwgbm9kZXMpO1xuXHRcdFx0XHRcdFx0dmFyIHRhcmdldCA9IGZpbmROb2RlQnlJZChsaW5rRGF0YVtpXS50YXJnZXQsIG5vZGVzKTtcblx0XHRcdFx0XHRcdGlmIChzb3VyY2UgPT0gbnVsbCB8fCB0YXJnZXQgPT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdHZhciBsaW5rID0gbmV3IExpbmsuTGluayhzb3VyY2UsIHRhcmdldCk7XG5cdFx0XHRcdFx0XHRsaW5rcy5wdXNoKGxpbmspO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gbGlua3M7XG5cdFx0XHR9XG5cdFx0fV0pO1xuXG5cdFx0cmV0dXJuIERhdGFTb3VyY2U7XG5cdH0oKTtcblxuXHRyZXR1cm4ge1xuXHRcdERhdGFTb3VyY2U6IERhdGFTb3VyY2Vcblx0fTtcbn1dKTtcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8xNC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5tb2RlbHMnLCBbXSk7XG52YXIgQ29udGl2R2xvYmFscyA9IChmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgLy9SRVNUIGVuZHBvaW50cyBmb3IgTkVUTUFTVEVSXG4gICAgICAgICdORVRXT1JLU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9uZXR3b3Jrcy8nLFxuICAgICAgICAnTkVUV09SS1NfSU5TUEVDVF9FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9pbnNwZWN0L25ldHdvcmtzLycsXG4gICAgICAgICdTRVJWSUNFTEJTX0lOU1BFQ1RfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvaW5zcGVjdC9zZXJ2aWNlTEJzLycsXG4gICAgICAgICdQT0xJQ0lFU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9wb2xpY3lzLycsXG4gICAgICAgICdSVUxFU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9ydWxlcy8nLFxuICAgICAgICAnQVBQTElDQVRJT05HUk9VUFNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvZW5kcG9pbnRHcm91cHMvJyxcbiAgICAgICAgJ1NFUlZJQ0VMQlNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvc2VydmljZUxCcy8nLFxuICAgICAgICAnT1JHQU5JWkFUSU9OU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS90ZW5hbnRzLycsXG4gICAgICAgICdORVRXT1JLX1NFVFRJTkdTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL2dsb2JhbHMvJyxcbiAgICAgICAgJ05FVFBST0ZJTEVTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL25ldHByb2ZpbGVzLycsXG4gICAgICAgICdCR1BTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL0JncHMvJyxcbiAgICAgICAgJ0JHUFNfSU5TUEVDVF9FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9pbnNwZWN0L0JncHMvJyxcbiAgICAgICAgJ1ZJU1VBTElaQVRJT05fRU5EUE9JTlQnOiAnL3Zpc3VhbGl6YXRpb24vJyxcbiAgICAgICAgLy9SRVNUIGVuZHBvaW50cyBmb3IgVk9MTUFTVEVSXG4gICAgICAgICdWT0xVTUVTX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvdm9sdW1lcy8nLFxuICAgICAgICAnVk9MVU1FU19DUkVBVEVfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci92b2x1bWVzL2NyZWF0ZS8nLFxuICAgICAgICAnVk9MVU1FU19ERUxFVEVfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci92b2x1bWVzL3JlbW92ZS8nLFxuICAgICAgICAnVk9MVU1FU19DT1BZU05BUFNIT1RTX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvdm9sdW1lcy9jb3B5JyxcbiAgICAgICAgJ1ZPTFVNRVNfVVNFU19FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3VzZXMvbW91bnRzLycsXG4gICAgICAgICdWT0xVTUVTX1NOQVBTSE9UU19FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3NuYXBzaG90cy8nLFxuICAgICAgICAnU1RPUkFHRVBPTElDSUVTX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvcG9saWNpZXMvJyxcbiAgICAgICAgJ1ZPTFVNRVNfR0xPQkFMX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvZ2xvYmFsLycsXG4gICAgICAgIC8vUkVTVCBlbmRwb2ludHMgZm9yIENMVVNURVJcbiAgICAgICAgJ05PREVTX0xJU1RfRU5EUE9JTlQnOiAnL2luZm8vbm9kZXMnLFxuICAgICAgICAnTk9ERVNfRElTQ09WRVJfRU5EUE9JTlQnOiAnL2Rpc2NvdmVyL25vZGVzJyxcbiAgICAgICAgJ05PREVTX0NPTU1JU1NJT05fRU5EUE9JTlQnOiAnL2NvbW1pc3Npb24vbm9kZXMnLFxuICAgICAgICAnTk9ERVNfREVDT01NSVNTSU9OX0VORFBPSU5UJzogJy9kZWNvbW1pc3Npb24vbm9kZXMnLFxuICAgICAgICAnTk9ERVNfTUFJTlRFTkFOQ0VfRU5EUE9JTlQnOiAnL21haW50ZW5hbmNlL25vZGVzJyxcbiAgICAgICAgJ05PREVTX0xBU1RfSk9CX0VORFBPSU5UJzogJy9pbmZvL2pvYi9sYXN0JyxcbiAgICAgICAgJ05PREVTX0FDVElWRV9KT0JfRU5EUE9JTlQnOiAnL2luZm8vam9iL2FjdGl2ZScsXG4gICAgICAgICdOT0RFU19TRVRUSU5HU19TRVRfRU5EUE9JTlQnOiAnL2dsb2JhbHMnLFxuICAgICAgICAnTk9ERVNfU0VUVElOR1NfR0VUX0VORFBPSU5UJzogJy9pbmZvL2dsb2JhbHMnLFxuICAgICAgICAvL1JlZnJlc2ggaW50ZXJ2YWwgaW4gbWlsbGlzZWNvbmRzXG4gICAgICAgICdSRUZSRVNIX0lOVEVSVkFMJzogNTAwMCxcbiAgICAgICAgLy9SZWdFeCBmb3IgdmFsaWRhdGlvblxuICAgICAgICAnQ0lEUl9SRUdFWCc6ICdeKChbMC05XXxbMS05XVswLTldfDFbMC05XXsyfXwyWzAtNF1bMC05XXwyNVswLTVdKVxcLil7M30oWzAtOV18WzEtOV1bMC05XXwxWzAtOV17Mn18MlswLTRdWzAtOV18MjVbMC01XSkoXFwvKFswLTldfFsxLTJdWzAtOV18M1swLTJdKSkkJyxcbiAgICAgICAgJ1ZMQU5fUkVHRVgnOiAnXihbMC05XXsxLDR9Py1bMC05XXsxLDR9PykkJyxcbiAgICAgICAgJ1ZYTEFOX1JFR0VYJzogJ14oWzAtOV17MSw4fT8tWzAtOV17MSw4fT8pJCcsXG4gICAgICAgICdOVU1CRVJfUkVHRVgnOiAnXlswLTldKiQnXG4gICAgfTtcbn0pKCk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudXRpbHMnLCBbXSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuLyoqXG4gKiBUaGUgRGF0YVNvdXJjZSB1c2VkIGZvciB0aGUgdmlzdWFsaXphdGlvbiB0YWIuXG4gKiBcbiAqIE5vZGUgRGF0YSBmcm9tIHRoZSBzZXJ2ZXIgaXMgZXhwZWN0ZWQgdG8gYmUgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6XG4gKiB7aWQ6IG5vZGVfaWQsIHRleHQ6IG5vZGVfdGV4dH1cbiAqIFBhcmVudCBhbmQgQW5jZXN0b3IgYXR0cmlidXRlcyBjYW4gYmUgc2V0IGJ5IGNhbGxpbmcgc2V0QW5jZXN0b3JzXG4gKiBcbiAqIExpbmsgRGF0YSBmcm9tIHRoZSBzZXJ2ZXIgaXMgZXhwZWN0ZWQgdG8gYmUgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6XG4gKiB7c291cmNlOiBzb3VyY2VOb2RlSWQsIHRhcmdldDogdGFyZ2V0Tm9kZUlkLCB3ZWlnaHQ6IGxpbmtXZWlnaHR9XG4gKiBcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ1Zpc3VhbGl6ZXJEYXRhU291cmNlJywgWydEYXRhU291cmNlJywgJ1Zpc3VhbGl6ZXJOb2RlJywgJ1Zpc3VhbGl6ZXJMaW5rJywgZnVuY3Rpb24gKERhdGFTb3VyY2UsIFZpc3VhbGl6ZXJOb2RlLCBWaXN1YWxpemVyTGluaykge1xuXHR2YXIgVmlzdWFsaXplckRhdGFTb3VyY2UgPSBmdW5jdGlvbiAoX0RhdGFTb3VyY2UkRGF0YVNvdXJjKSB7XG5cdFx0X2luaGVyaXRzKFZpc3VhbGl6ZXJEYXRhU291cmNlLCBfRGF0YVNvdXJjZSREYXRhU291cmMpO1xuXG5cdFx0LyoqXG4gICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICogXG4gICAqIENoaWxkcmVuIFN0cnVjdCBhbmQgYW5jZXN0b3JzX3N0cnVjdCBhcmUgSlNPTiBvYmplY3RzLFxuICAgKiBtYXBwaW5nIGEgbm9kZSBJZCB0byBhIGxpc3Qgb2YgaXQncyBjaGlsZHJlbiBvciBhbmNlc3RvcnMuXG4gICAqIENoaWxkcmVuIFN0cnVjdCBpcyBhbHNvIGV4cGVjdGVkIHRvIGhhdmUgYSBmaWVsZCBjYWxsZWRcbiAgICogdG9wTGV2ZWwsIHRoYXQgbWFwcyB0byBhIGxpc3Qgb2YgYWxsIHRoZSBub2RlcyB0aGF0IGRvbid0XG4gICAqIGhhdmUgYW55IHBhcmVudHMuXG4gICAqXG4gICAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBub2RlcyAgICAgICAgICAgICAgVGhlIG5vZGUgZGF0YSBcbiAgICogQHBhcmFtICAgICAge0FycmF5fSAgIGxpbmtzICAgICAgICAgICAgICBUaGUgbGluayBkYXRhXG4gICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBjaGlsZHJlbl9zdHJ1Y3QgICAgVGhlIGNoaWxkcmVuIHN0cnVjdHVyZVxuICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgYW5jZXN0b3JzX3N0cnVjdCAgIFRoZSBhbmNlc3RvcnMgc3RydWN0dXJlXG4gICAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBsYWJlbHMgICAgICAgICAgICAgVGhlIGxhYmVsc1xuICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgc2VsZWN0b3JzICAgICAgICAgIFRoZSBzZWxlY3RvcnNcbiAgICovXG5cdFx0ZnVuY3Rpb24gVmlzdWFsaXplckRhdGFTb3VyY2Uobm9kZXMsIGxpbmtzLCBjaGlsZHJlbl9zdHJ1Y3QsIGFuY2VzdG9yc19zdHJ1Y3QsIGxhYmVscywgc2VsZWN0b3JzKSB7XG5cdFx0XHRfY2xhc3NDYWxsQ2hlY2sodGhpcywgVmlzdWFsaXplckRhdGFTb3VyY2UpO1xuXG5cdFx0XHR2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoVmlzdWFsaXplckRhdGFTb3VyY2UuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihWaXN1YWxpemVyRGF0YVNvdXJjZSkpLmNhbGwodGhpcywgbm9kZXMsIGxpbmtzKSk7XG5cblx0XHRcdF90aGlzLmNoaWxkcmVuX3N0cnVjdCA9IGNoaWxkcmVuX3N0cnVjdDtcblx0XHRcdF90aGlzLmFuY2VzdG9yc19zdHJ1Y3QgPSBhbmNlc3RvcnNfc3RydWN0O1xuXHRcdFx0X3RoaXMubGFiZWxzID0gbGFiZWxzO1xuXHRcdFx0X3RoaXMuc2VsZWN0b3JzID0gc2VsZWN0b3JzO1xuXHRcdFx0cmV0dXJuIF90aGlzO1xuXHRcdH1cblxuXHRcdC8qKlxuICAgKiBEZXRlcm1pbmVzIGlmIGl0IGhhcyBjaGlsZC5cbiAgICpcbiAgICogQHBhcmFtICAgICAge3N0cmluZ30gICBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG4gICAqIEByZXR1cm4gICAgIHtib29sZWFufSAgVHJ1ZSBpZiBoYXMgY2hpbGQsIEZhbHNlIG90aGVyd2lzZS5cbiAgICovXG5cblxuXHRcdF9jcmVhdGVDbGFzcyhWaXN1YWxpemVyRGF0YVNvdXJjZSwgW3tcblx0XHRcdGtleTogJ2hhc0NoaWxkJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBoYXNDaGlsZChpZCkge1xuXHRcdFx0XHRpZiAodGhpcy5jaGlsZHJlbl9zdHJ1Y3RbaWRdID09IG51bGwpIHtcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogU2V0cyB0aGUgcGFyZW50IGFuZCBhbmNlc3RvcnMgYXR0cmlidXRlIHVzaW5nIFxuICAgICogYW5jZXN0b3JzX3N0cnVjdCBmb3IgYWxsIHRoZSBub2Rlc1xuICAgICogQWxzbyBhZGRzIGFueSBub2RlcyB3aXRob3V0IGFuY2VzdG9ycywgdGhhdCBhcmVuJ3QgXG4gICAgKiB0b3BsZXZlbCB0byB0aGUgY2xpZW50IHNlcnZpY2UuXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3NldEFuY2VzdG9ycycsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gc2V0QW5jZXN0b3JzKCkge1xuXHRcdFx0XHR2YXIgdGhpc0RhdGFTb3VyY2UgPSB0aGlzO1xuXHRcdFx0XHR2YXIgYWRkZWRDbGllbnQgPSBmYWxzZTtcblx0XHRcdFx0Xy5mb3JFYWNoKHRoaXNEYXRhU291cmNlLm5vZGVzLCBmdW5jdGlvbiAobm9kZSkge1xuXHRcdFx0XHRcdG5vZGUuYW5jZXN0b3JzID0gdGhpc0RhdGFTb3VyY2UuYW5jZXN0b3JzX3N0cnVjdFtub2RlLmlkXSB8fCBbXTtcblx0XHRcdFx0XHRpZiAoXy5pc0VtcHR5KG5vZGUuYW5jZXN0b3JzKSA9PT0gZmFsc2UpIHtcblx0XHRcdFx0XHRcdG5vZGUucGFyZW50ID0gbm9kZS5hbmNlc3RvcnNbMF07XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGlmIChfLmluY2x1ZGVzKHRoaXNEYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbCwgbm9kZS5pZCkgPT0gZmFsc2UpIHtcblx0XHRcdFx0XHRcdFx0Ly9jb250YWluZXIgaGFzIG5vIHBhcmVudFxuXHRcdFx0XHRcdFx0XHQvL2FkZGluZyB0byBjbGllbnRcblx0XHRcdFx0XHRcdFx0bm9kZS5hbmNlc3RvcnMucHVzaChcImNsaWVudFwiKTtcblx0XHRcdFx0XHRcdFx0dGhpc0RhdGFTb3VyY2UuYW5jZXN0b3JzX3N0cnVjdFtub2RlLmlkXSA9IFtcImNsaWVudFwiXTtcblx0XHRcdFx0XHRcdFx0aWYgKGFkZGVkQ2xpZW50ID09PSBmYWxzZSkge1xuXHRcdFx0XHRcdFx0XHRcdGFkZGVkQ2xpZW50ID0gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0XHR0aGlzRGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwucHVzaChcImNsaWVudFwiKTtcblx0XHRcdFx0XHRcdFx0XHR0aGlzRGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbJ2NsaWVudCddID0gW107XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0dGhpc0RhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0WydjbGllbnQnXS5wdXNoKG5vZGUuaWQpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogUmV0dXJucyB0aGUgZmxvdyBiZXR3ZWVuIHRoZSBoaWdoZXN0IGxldmVsIGdyb3VwaW5nXG4gICAgKlxuICAgICogQHJldHVybiAgICAge09iamVjdH0gIFRoZSB0b3AgbGV2ZWwgZmxvdy5cbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnZ2V0VG9wTGV2ZWxGbG93Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBnZXRUb3BMZXZlbEZsb3coKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLmdldEZsb3dCZXR3ZWVuU2V0KHRoaXMuY2hpbGRyZW5fc3RydWN0LnRvcExldmVsKTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBHZXRzIHRoZSBmbG93IGJldHdlZW4gYW55IHNldCBvZiBub2RlIGxldmVsc1xuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVfbmFtZXMgIFRoZSBub2RlIG5hbWVzIGluIHRoZSBzZXRcbiAgICAqIEByZXR1cm4gICAgIHtPYmplY3R9ICBUaGUgZmxvdyBiZXR3ZWVuIHNldC5cbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnZ2V0Rmxvd0JldHdlZW5TZXQnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGdldEZsb3dCZXR3ZWVuU2V0KG5vZGVfbmFtZXMpIHtcblx0XHRcdFx0dmFyIGxvY2FsX25vZGVzID0gdGhpcy5ub2Rlcztcblx0XHRcdFx0dmFyIGlkTWFwcGluZyA9IHt9O1xuXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGxvY2FsX25vZGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0dmFyIG5vZGUgPSBsb2NhbF9ub2Rlc1tpXTtcblxuXHRcdFx0XHRcdC8vaWYgbm9kZSBpcyBhbHJlYWR5IGF0IGl0cyBoaWdoZXN0IGxldmVsXG5cdFx0XHRcdFx0aWYgKG5vZGUuYW5jZXN0b3JzID09PSBudWxsKSB7XG5cdFx0XHRcdFx0XHRpZE1hcHBpbmdbbm9kZS5pZF0gPSBub2RlLm5hbWU7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdC8vY2hlY2sgdG8gc2VlIHdoaWNoIHRhZ3MgYXJlIHByZXNlbnQgaW4gdGhlIGFuY2VzdG9yIGxpc3Rcblx0XHRcdFx0XHRcdGZvciAodmFyIGogPSAwOyBqIDwgbm9kZV9uYW1lcy5sZW5ndGg7IGorKykge1xuXHRcdFx0XHRcdFx0XHRpZiAobm9kZS5hbmNlc3RvcnMuaW5kZXhPZihub2RlX25hbWVzW2pdKSA+IC0xKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWRNYXBwaW5nW25vZGUuaWRdID0gbm9kZV9uYW1lc1tqXTtcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHQvL21vZGlmeSBsaW5rc1xuXHRcdFx0XHR2YXIgbGlua3MgPSB0aGlzLmxpbmtzO1xuXHRcdFx0XHR2YXIgbGlua0RhdGEgPSBbXTtcblxuXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGxpbmtzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0dmFyIGxpbmsgPSBbXTtcblx0XHRcdFx0XHRsaW5rLnNvdXJjZSA9IGlkTWFwcGluZ1tsaW5rc1tpXS5zb3VyY2VdIHx8IGxpbmtzW2ldLnNvdXJjZTtcblx0XHRcdFx0XHRsaW5rLnRhcmdldCA9IGlkTWFwcGluZ1tsaW5rc1tpXS50YXJnZXRdIHx8IGxpbmtzW2ldLnRhcmdldDtcblx0XHRcdFx0XHRsaW5rLndlaWdodCA9IGxpbmtzW2ldLndlaWdodDtcblx0XHRcdFx0XHRsaW5rRGF0YS5wdXNoKGxpbmspO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly9jcmVhdGluZyB0aGUgbm9kZURhdGFcblx0XHRcdFx0dmFyIG5vZGVEYXRhID0gW107XG5cdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZV9uYW1lcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdHZhciBub2RlX3RvX2FkZCA9IFtdO1xuXHRcdFx0XHRcdG5vZGVfdG9fYWRkLmlkID0gbm9kZV9uYW1lc1tpXTtcblx0XHRcdFx0XHRub2RlX3RvX2FkZC50ZXh0ID0gdGhpcy5ub2RlSWRUb05hbWUobm9kZV9uYW1lc1tpXSkgfHwgbm9kZV9uYW1lc1tpXTtcblxuXHRcdFx0XHRcdG5vZGVfdG9fYWRkLmFuY2VzdG9ycyA9IHRoaXMuYW5jZXN0b3JzX3N0cnVjdFtub2RlX25hbWVzW2ldXSB8fCB0aGlzLmFuY2VzdG9yc19zdHJ1Y3Rbbm9kZV90b19hZGQudGV4dF0gfHwgW107XG5cdFx0XHRcdFx0aWYgKF8uaXNFbXB0eShub2RlX3RvX2FkZC5hbmNlc3RvcnMpID09PSBmYWxzZSkge1xuXHRcdFx0XHRcdFx0bm9kZV90b19hZGQucGFyZW50ID0gbm9kZV90b19hZGQuYW5jZXN0b3JzWzBdO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRub2RlX3RvX2FkZC5wYXJlbnQgPSBudWxsO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRub2RlRGF0YS5wdXNoKG5vZGVfdG9fYWRkKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHVybiB7IG5vZGVEYXRhOiBub2RlRGF0YSwgbGlua0RhdGE6IGxpbmtEYXRhIH07XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogcHJvY2VzcyB0aGUgbm9kZURhdGEgb3V0cHV0IG9mIGdldEZsb3dCZXR3ZWVuU2V0XG4gICAgKlxuICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZURhdGEgIE5vZGVEYXRhIHRvIGNvbnZlcnQgXG4gICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gbm9kZSBvYmplY3RzXG4gICAgKiBAcmV0dXJuICAgICB7QXJyYXl9ICBOb2RlIG9iamVjdHNcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAncHJvY2Vzc05vZGVEYXRhJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBwcm9jZXNzTm9kZURhdGEobm9kZURhdGEpIHtcblx0XHRcdFx0dmFyIG5vZGVzID0gW107XG5cdFx0XHRcdF8uZm9yRWFjaChub2RlRGF0YSwgZnVuY3Rpb24gKGRhdGEpIHtcblx0XHRcdFx0XHR2YXIgbmV3Tm9kZSA9IG5ldyBWaXN1YWxpemVyTm9kZS5Ob2RlKG51bGwsIG51bGwsIGRhdGEuaWQsIGRhdGEudGV4dCwgbnVsbCwgZGF0YS5wYXJlbnQsIGRhdGEuYW5jZXN0b3JzLCBudWxsLCBudWxsKTtcblx0XHRcdFx0XHRub2Rlcy5wdXNoKG5ld05vZGUpO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0cmV0dXJuIG5vZGVzO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIHByb2Nlc3MgdGhlIGxpbmtEYXRhIG91dHB1dCBvZiBnZXRGbG93QmV0d2VlblNldFxuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIGxpbmtEYXRhICBUaGUgbGluayBkYXRhXG4gICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlcyAgICAgVGhlIG5vZGVzXG4gICAgKiBAcmV0dXJuICAgICB7QXJyYXl9ICBMaW5rIG9iamVjdHNcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAncHJvY2Vzc0xpbmtEYXRhJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBwcm9jZXNzTGlua0RhdGEobGlua0RhdGEsIG5vZGVzKSB7XG5cdFx0XHRcdC8qKlxuICAgICAqIFJldHVybnMgdGhlIG5vZGUgdGhhdCBtYXRjaGVzIHRoZSBpZFxuICAgICAqXG4gICAgICogQHBhcmFtICAgICAge3N0cmluZ30gaWQgICAgICBUaGUgaWRlbnRpZmllclxuICAgICAqIEByZXR1cm4gICAgIHtOb2RlfSAgIFRoZSBub2RlIHdpdGggdGhlIG1hdGNoaW5nIGlkXG4gICAgICovXG5cdFx0XHRcdGZ1bmN0aW9uIGZpbmROb2RlQnlJZChpZCwgbm9kZXMpIHtcblx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRpZiAoaWQgPT0gbm9kZXNbaV0uaWQpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIG5vZGVzW2ldO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdHZhciBsaW5rcyA9IFtdO1xuXHRcdFx0XHQvL2EgbWFwcGluZyBmcm9tIHNvdXJjZS5pZC10YXJnZXQuaWQgdG8gdGhlIGxpbmsgYWRkZWRcblx0XHRcdFx0dmFyIGFkZGVkX2xpbmtzID0ge307XG5cdFx0XHRcdC8vdHJhbnNmb3JtaW5nIGxpbmsgZGF0YVxuXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGxpbmtEYXRhLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0aWYgKGxpbmtEYXRhW2ldLnNvdXJjZSAhPSBsaW5rRGF0YVtpXS50YXJnZXQpIHtcblx0XHRcdFx0XHRcdHZhciBzb3VyY2UgPSBmaW5kTm9kZUJ5SWQobGlua0RhdGFbaV0uc291cmNlLCBub2Rlcyk7XG5cdFx0XHRcdFx0XHR2YXIgdGFyZ2V0ID0gZmluZE5vZGVCeUlkKGxpbmtEYXRhW2ldLnRhcmdldCwgbm9kZXMpO1xuXHRcdFx0XHRcdFx0dmFyIHdlaWdodCA9IGxpbmtEYXRhW2ldLndlaWdodDtcblx0XHRcdFx0XHRcdC8vaW4gb3JkZXIgdG8gc3VtIGFsbCB0aGUgd2VpZ2h0cyBvZiB0aGUgbGlua3Mgb2YgdGhlIHN1Yi1ub2Rlcyxcblx0XHRcdFx0XHRcdC8vd2UgdXNlIGFkZGVkX2xpbmtzIHRvIGtlZXAgdHJhY2sgaWYgYW4gbGluayB3YXMgYWRkZWRcblx0XHRcdFx0XHRcdC8vaWYgaXQgaXMsIHdlIG1vZGlmeSBpdHMgd2VpZ2h0XG5cdFx0XHRcdFx0XHRpZiAoc291cmNlID09IG51bGwgfHwgdGFyZ2V0ID09IG51bGwpIHtcblx0XHRcdFx0XHRcdFx0Y29udGludWU7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRpZiAoYWRkZWRfbGlua3Nbc291cmNlLmlkICsgJy0nICsgdGFyZ2V0LmlkXSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBsaW5rID0gbmV3IFZpc3VhbGl6ZXJMaW5rLkxpbmsoc291cmNlLCB0YXJnZXQsIHdlaWdodCk7XG5cdFx0XHRcdFx0XHRcdGFkZGVkX2xpbmtzW3NvdXJjZS5pZCArICctJyArIHRhcmdldC5pZF0gPSBsaW5rO1xuXHRcdFx0XHRcdFx0XHRsaW5rcy5wdXNoKGxpbmspO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0dmFyIGV4aXN0aW5nX2xpbmsgPSBhZGRlZF9saW5rc1tzb3VyY2UuaWQgKyAnLScgKyB0YXJnZXQuaWRdO1xuXHRcdFx0XHRcdFx0XHRleGlzdGluZ19saW5rLnNldFdlaWdodChleGlzdGluZ19saW5rLmdldFJhd1dlaWdodCgpICsgd2VpZ2h0KTtcblx0XHRcdFx0XHRcdFx0ZXhpc3RpbmdfbGluay5pbmNyZWFzZUNvdW50KCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBsaW5rcztcblx0XHRcdH1cblx0XHR9XSk7XG5cblx0XHRyZXR1cm4gVmlzdWFsaXplckRhdGFTb3VyY2U7XG5cdH0oRGF0YVNvdXJjZS5EYXRhU291cmNlKTtcblxuXHRyZXR1cm4ge1xuXHRcdERhdGFTb3VyY2U6IFZpc3VhbGl6ZXJEYXRhU291cmNlXG5cdH07XG59XSk7XG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbi8qKlxuICogVGhlIGJhc2UgY2xhc3MgdGhlIGdyYXBoIG9iamVjdC4gQW55IG5vZGVzIG9yIGxpbmtzIHRoYXQgYXJlIGNvbnRhaW5lZCBpblxuICogaXRzIG5vZGVzIG9yIGxpbmtzIHByb3BlcnR5IHdpbGwgYmUgZHJhd24gb24gdXBkYXRlR3JhcGguXG4gKiBTdXBwb3J0cyBwb2xpY2llcy5cbiAqIFxuICogVG8gd3JpdGUgeW91ciBvd24gZ3JhcGggb2JqZWN0LCBjcmVhdGUgYSBuZXcgZmFjdG9yeSB0aGF0IHVzZXMgdGhlIGdyYXBoXG4gKiB5b3Ugd2FudCB0byBpbmhlcml0IGFzIGEgZGVwZW5kZW5jeSwgYW5kIGV4dGVuZCBpdHMgZ3JhcGggY2xhc3MuIFxuICogUmV0dXJuIHRoZSBjbGFzcyBvYmplY3Qgd2l0aCBHcmFwaCBhcyBrZXkuXG4gKiBcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ0dyYXBoJywgWydQb2xpY3lTZXJ2aWNlJywgZnVuY3Rpb24gKFBvbGljeVNlcnZpY2UpIHtcbiAgICB2YXIgR3JhcGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBjb25zdHJ1Y3RvciBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtIVE1MIFNWR30gIHN2ZyAgICAgVGhlIHN2ZyB0aGF0IHdpbGwgXG4gICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9sZCB0aGUgZ3JhcGhcbiAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZXMgICAgICBMaXN0IG9mIG5vZGVzIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbGlua3MgICAgICBMaXN0IG9mIGxpbmtzIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIEdyYXBoKHN2Zywgbm9kZXMsIGxpbmtzKSB7XG4gICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgR3JhcGgpO1xuXG4gICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzID0gbm9kZXMgfHwgW107XG4gICAgICAgICAgICB0aGlzR3JhcGgubGlua3MgPSBsaW5rcyB8fCBbXTtcblxuICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMgPSBbXTtcbiAgICAgICAgICAgIHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzID0gW107XG5cbiAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3kgPSBuZXcgUG9saWN5U2VydmljZS5Qb2xpY3koKTtcblxuICAgICAgICAgICAgdGhpc0dyYXBoLnN0YXRlID0ge1xuICAgICAgICAgICAgICAgIGNhblpvb206IHRydWUsXG4gICAgICAgICAgICAgICAgY2FuUGFuOiB0cnVlLFxuICAgICAgICAgICAgICAgIGluaXRGb3JjZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgZGlzYWJsZVVwZGF0ZTogZmFsc2VcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHRoaXNHcmFwaC5jb25zdHMgPSB7XG4gICAgICAgICAgICAgICAgY2lyY2xlR0NsYXNzOiBcImNvbmNlcHRHXCIsXG4gICAgICAgICAgICAgICAgZ3JhcGhDbGFzczogXCJncmFwaFwiLFxuICAgICAgICAgICAgICAgIHBhdGhDbGFzczogXCJwYXRoXCIsXG4gICAgICAgICAgICAgICAgbm9kZUNsYXNzOiBcImNpcmNsZVwiLFxuICAgICAgICAgICAgICAgIG5vZGVUZXh0OiBcIm5vZGVUZXh0XCIsXG4gICAgICAgICAgICAgICAgc3RhcnRSYWRpdXM6IDUwLFxuICAgICAgICAgICAgICAgIG1heFJhZGl1czogNjAsXG4gICAgICAgICAgICAgICAgcGFkZGluZzogNSxcbiAgICAgICAgICAgICAgICBkaXNwbGF5T2Zmc2V0OiA2MFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgc3ZnLm9uKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcIm1vdXNlb3ZlclwiXS5jYWxsKHRoaXMsIGQpO1xuICAgICAgICAgICAgfSkub24oXCJkYmxjbGlja1wiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3lbXCJkYmxjbGlja1wiXS5jYWxsKHRoaXMsIGQpO1xuICAgICAgICAgICAgfSkub24oXCJjb250ZXh0bWVudVwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3lbXCJjb250ZXh0bWVudVwiXS5jYWxsKHRoaXMsIGQpO1xuICAgICAgICAgICAgfSkub24oXCJtb3VzZW91dFwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3lbXCJtb3VzZW91dFwiXS5jYWxsKHRoaXMsIGQpO1xuICAgICAgICAgICAgfSkub24oXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wibW91c2Vkb3duXCJdLmNhbGwodGhpcywgZCk7XG4gICAgICAgICAgICB9KS5vbihcIm1vdXNldXBcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wibW91c2V1cFwiXS5jYWxsKHRoaXMsIGQpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIGRlZmluZSBhcnJvdyBtYXJrZXJzIGZvciBncmFwaCBsaW5rc1xuICAgICAgICAgICAgdmFyIGRlZnMgPSBzdmcuYXBwZW5kKCdzdmc6ZGVmcycpO1xuICAgICAgICAgICAgZGVmcy5hcHBlbmQoJ3N2ZzptYXJrZXInKS5hdHRyKCdpZCcsICdlbmQtYXJyb3cnKS5hdHRyKFwidmlld0JveFwiLCBcIjAgLTUgMTAgMTBcIikuYXR0cihcInJlZlhcIiwgMjApLmF0dHIoXCJyZWZZXCIsIC0xKS5hdHRyKFwibWFya2VyV2lkdGhcIiwgNikuYXR0cihcIm1hcmtlckhlaWdodFwiLCA2KS5hdHRyKFwib3JpZW50XCIsIFwiYXV0b1wiKS5hcHBlbmQoXCJwYXRoXCIpLmF0dHIoXCJkXCIsIFwiTTAsLTVMMTAsMEwwLDVcIik7XG5cbiAgICAgICAgICAgIC8vIGRlZmluZSBhcnJvdyBtYXJrZXJzIGZvciBsZWFkaW5nIGFycm93XG4gICAgICAgICAgICBkZWZzLmFwcGVuZCgnc3ZnOm1hcmtlcicpLmF0dHIoJ2lkJywgJ21hcmstZW5kLWFycm93JykuYXR0cigndmlld0JveCcsICcwIC01IDEwIDEwJykuYXR0cigncmVmWCcsIDcpLmF0dHIoJ21hcmtlcldpZHRoJywgMy41KS5hdHRyKCdtYXJrZXJIZWlnaHQnLCAzLjUpLmF0dHIoJ29yaWVudCcsICdhdXRvJykuYXBwZW5kKCdzdmc6cGF0aCcpLmF0dHIoJ2QnLCAnTTAsLTVMMTAsMEwwLDUnKTtcblxuICAgICAgICAgICAgdGhpc0dyYXBoLnN2ZyA9IHN2ZztcbiAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdHID0gc3ZnLmFwcGVuZChcImdcIikuY2xhc3NlZCh0aGlzR3JhcGguY29uc3RzLmdyYXBoQ2xhc3MsIHRydWUpO1xuICAgICAgICAgICAgdmFyIHN2Z0cgPSB0aGlzR3JhcGguc3ZnRztcblxuICAgICAgICAgICAgLy8gc3ZnIG5vZGVzIGFuZCBsaW5rcyBcbiAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocyA9IHN2Z0cuYXBwZW5kKFwiZ1wiKS5zZWxlY3RBbGwoXCJnXCIpO1xuICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMgPSBzdmdHLmFwcGVuZChcImdcIikuc2VsZWN0QWxsKFwiZ1wiKTtcbiAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0Tm9kZXMoKTtcbiAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0TGlua3MoKTtcblxuICAgICAgICAgICAgdGhpc0dyYXBoLnNldFBvc2l0aW9ucygpO1xuICAgICAgICAgICAgdmFyIHJlc2l6ZUZ1bmMgPSBmdW5jdGlvbiByZXNpemVGdW5jKCkge1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5vbldpbmRvd1Jlc2l6ZShzdmcpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdGhpc0dyYXBoLmJpbmRpbmdzID0ge1xuICAgICAgICAgICAgICAgIHJlc2l6ZTogcmVzaXplRnVuY1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICQod2luZG93KS5yZXNpemUocmVzaXplRnVuYyk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogY2FsbHMgdGhlIGRlc3Ryb3kgbWV0aG9kIGZvciBhbGwgcG9saWNpZXNcbiAgICAgICAgICovXG5cblxuICAgICAgICBfY3JlYXRlQ2xhc3MoR3JhcGgsIFt7XG4gICAgICAgICAgICBrZXk6ICdkZXN0cm95JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3kuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3kuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3kuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzR3JhcGguYmluZGluZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgJCh3aW5kb3cpLm9mZihrZXksIHRoaXNHcmFwaC5iaW5kaW5nc1trZXldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUnVucyB0aGUgaW5pdCBmdW5jdGlvbiBmb3IgYWxsIHRoZSBub2Rlc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnaW5pdE5vZGVzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0Tm9kZXMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUnVucyB0aGUgaW5pdCBmdW5jdGlvbiBmb3IgYWxsIHRoZSBsaW5rc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnaW5pdExpbmtzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0TGlua3MoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5saW5rcywgZnVuY3Rpb24gKGxpbmspIHtcbiAgICAgICAgICAgICAgICAgICAgbGluay5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogcmV0dXJucyB0aGUgbm9kZSBtYXRjaGluZyB0aGUgaWQsIFxuICAgICAgICAgICAgICogb3IgdW5kZWZpbmVkIGlmIHRoZXJlIGlzIG5vbmVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgaWQgICAgICBUaGUgaWRlbnRpZmllclxuICAgICAgICAgICAgICogQHJldHVybiAgICAge05vZGV9ICB7IG1hdGNoaW5nIG5vZGUgfVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZmluZE5vZGVCeUlkJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBmaW5kTm9kZUJ5SWQoaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXNHcmFwaC5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaWQgPT09IHRoaXNHcmFwaC5ub2Rlc1tpXS5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNHcmFwaC5ub2Rlc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZmluZEQzTm9kZScsXG5cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZXR1cm5zIHRoZSBkM05vZGUgb2JqZWN0IHRoYXQgbWF0Y2hlcyB0aGUgaWQsXG4gICAgICAgICAgICAgKiBvciB1bmRlZmluZWQgaWYgdGhlcmUgaXMgbm9uZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7RDNOb2RlfSBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZmluZEQzTm9kZShpZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBkM05vZGU7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZWFjaChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5pZCA9PT0gaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQzTm9kZSA9IGQzLnNlbGVjdCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkM05vZGU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byBpbnN0YWxsIGEgZHJhZyBwb2xpY3kgdGhhdCB3aWxsIGJlIGNhbGxlZFxuICAgICAgICAgICAgICogd2hlbiBub2RlcyBhcmUgZHJhZ2dlZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkMy5iZWhhdmlvci5kcmFnfSAgZDNkcmFnICBEMyBkcmFnIG9iamVjdFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnaW5zdGFsbERyYWdQb2xpY3knLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluc3RhbGxEcmFnUG9saWN5KGQzZHJhZykge1xuICAgICAgICAgICAgICAgIHRoaXMuZHJhZyA9IGQzZHJhZztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIGluc3RhbGwgYSBwb2xpY3kgdGhhdCB3aWxsIGJlIGNhbGxlZCBcbiAgICAgICAgICAgICAqIHdoZW4gdGhlcmUgaXMgbW91c2UgaW50ZXJhY3Rpb25zIHdpdGggdGhlIGdyYXBoJ3Mgc3ZnXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeSAgVGhlIHBvbGljeSB0byBpbnN0YWxsXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdpbnN0YWxsU3ZnUG9saWN5JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbnN0YWxsU3ZnUG9saWN5KHBvbGljeSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3ZnUG9saWN5ID0gcG9saWN5O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVzZWQgdG8gaW5zdGFsbCBwb2xpY2llcyB0aGF0IGFyZSBjYWxsZWQgd2hlbiB0aGVyZSBpc1xuICAgICAgICAgICAgICogbW91c2UgaW50ZXJhY3Rpb24gd2l0aCBhIG5vZGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UG9saWN5fSAgcG9saWN5ICBUaGUgcG9saWN5IHRvIGluc3RhbGxcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2luc3RhbGxEZWZhdWx0Tm9kZVBvbGljeScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5zdGFsbERlZmF1bHROb2RlUG9saWN5KHBvbGljeSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzLnB1c2gocG9saWN5KTtcbiAgICAgICAgICAgICAgICBwb2xpY3kuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVzZWQgdG8gcmVtb3ZlIGFuIGluc3RhbGxlZCBwb2xpY3kgZm9yIG5vZGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBwb2xpY3lSZW1vdmUgIFRoZSBwb2xpY3kgdG8gcmVtb3ZlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd1bmluc3RhbGxEZWZhdWx0Tm9kZVBvbGljeScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdW5pbnN0YWxsRGVmYXVsdE5vZGVQb2xpY3kocG9saWN5UmVtb3ZlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBvbGljeVJlbW92ZU5hbWU7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBwb2xpY3lSZW1vdmUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZS5wb2xpY3lOYW1lO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3ksIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb2xpY3kucG9saWN5TmFtZSA9PT0gcG9saWN5UmVtb3ZlTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9saWN5LmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZXR1cm5zIHRoZSBub2RlIHBvbGljeSBvYmplY3Qgd2l0aCB0aGUgZ2l2ZW4gbmFtZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBwb2xpY3lOYW1lICBUaGUgcG9saWN5IG5hbWVcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtQb2xpY3l9ICBwb2xpY3kgICAgICBUaGUgbWF0Y2hpbmcgcG9saWN5XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdnZXROb2RlUG9saWN5JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXROb2RlUG9saWN5KHBvbGljeU5hbWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24gKHBvbGljeSwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvbGljeS5wb2xpY3lOYW1lID09PSBwb2xpY3lOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcG9saWN5O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byBpbnN0YWxsIHBvbGljaWVzIHRoYXQgYXJlIGNhbGxlZCB3aGVuIHRoZXJlIGlzIGFcbiAgICAgICAgICAgICAqIG1vdXNlIGludGVyYWN0aW9uIHdpdGggYSBwYXRoXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeSAgVGhlIHBvbGljeSB0byBpbnN0YWxsXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdpbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3knLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluc3RhbGxEZWZhdWx0UGF0aFBvbGljeShwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcy5wdXNoKHBvbGljeSk7XG4gICAgICAgICAgICAgICAgcG9saWN5LmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIHJlbW92ZSBhbiBpbnN0YWxsZWQgcG9saWN5IGZvciBsaW5rc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3lSZW1vdmUgIFRoZSBwb2xpY3kgdG8gcmVtb3ZlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd1bmluc3RhbGxEZWZhdWx0UGF0aFBvbGljeScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdW5pbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3kocG9saWN5UmVtb3ZlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBvbGljeVJlbW92ZU5hbWU7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBwb2xpY3lSZW1vdmUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZS5wb2xpY3lOYW1lO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3ksIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb2xpY3kucG9saWN5TmFtZSA9PT0gcG9saWN5UmVtb3ZlTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9saWN5LmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGVyZSBpcyBhIG1vdXNlIGludGVyYWN0aW9uIHdpdGggYSBwYXRoXG4gICAgICAgICAgICAgKiBQcm9wb2dhdGVzIHRoZSBldmVudCB0byBhbGwgaW5zdGFsbGVkIHBhdGggcG9saWNpZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgZXZlbnQgICBUaGUgZXZlbnQgdHlwZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2Qzb2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BhdGh9ICBkICAgICAgIFRoZSBtYXRjaGluZyBMaW5rIG9iamVjdFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAncGF0aFBvbGljeUV2ZW50JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwYXRoUG9saWN5RXZlbnQoZXZlbnQsIGQzcGF0aCwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lbZXZlbnRdKGQzcGF0aCwgZCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlcmUgaXMgYSBtb3VzZSBpbnRlcmFjdGlvbiB3aXRoIGEgbm9kZVxuICAgICAgICAgICAgICogUHJvcG9nYXRlcyB0aGUgZXZlbnQgdG8gYWxsIGluc3RhbGxlZCBub2RlIHBvbGljaWVzXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBldmVudCAgIFRoZSBldmVudCB0eXBlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7ZDNvYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UGF0aH0gIGQgICAgICAgVGhlIG1hdGNoaW5nIE5vZGUgb2JqZWN0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdub2RlUG9saWN5RXZlbnQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG5vZGVQb2xpY3lFdmVudChldmVudCwgZDNub2RlLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzLCBmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVtldmVudF0oZDNub2RlLCBkKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTZXRzIHBhbiBhbmQgem9vbSBydWxlcyBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzLmJlaGF2aW9yLnpvb219ICBkM3pvb20gIEQzIHpvb20gb2JqXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdpbnN0YWxsWm9vbVBvbGljeScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5zdGFsbFpvb21Qb2xpY3koZDN6b29tKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kcmFnU3ZnID0gZDN6b29tO1xuICAgICAgICAgICAgICAgIHRoaXMuc3ZnLmNhbGwodGhpcy5kcmFnU3ZnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgd2luZG93IGlzIHJlc2l6ZWRcbiAgICAgICAgICAgICAqIEhvb2sgZm9yIG92ZXJyaWRpbmcgaW4gc3ViY2xhc3Nlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtIVE1MIFNWR30gIHN2ZyAgICAgVGhlIHN2ZyB0aGF0IHRoZSBoYW5kbGVyXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzIGF0dGFjaGVkIHRvXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdvbldpbmRvd1Jlc2l6ZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb25XaW5kb3dSZXNpemUoc3ZnKSB7fVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEluc2VydHMgbGluZSBicmVha3MgaW4gbm9kZSB0ZXh0XG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0hUTUwgRWxlbX0gIGdFbCAgICBUaGUgZWxlbSB0byBhZGQgdGV4dCB0b1xuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHRpdGxlICAgVGhlIHRpdGxlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdpbnNlcnRUaXRsZUxpbmVicmVha3MnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluc2VydFRpdGxlTGluZWJyZWFrcyhnRWwsIHRpdGxlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHdvcmRzID0gdGl0bGUuc3BsaXQoL1xccysvZyksXG4gICAgICAgICAgICAgICAgICAgIG53b3JkcyA9IHdvcmRzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB2YXIgZWwgPSBnRWwuYXBwZW5kKFwidGV4dFwiKS5hdHRyKCdjbGFzcycsIHRoaXNHcmFwaC5jb25zdHMubm9kZVRleHQpLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcIm1pZGRsZVwiKS5hdHRyKFwiZHlcIiwgXCItXCIgKyAobndvcmRzIC0gMSkgKiA3LjUpO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB3b3Jkcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdHNwYW4gPSBlbC5hcHBlbmQoJ3RzcGFuJykudGV4dCh3b3Jkc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpID4gMCkgdHNwYW4uYXR0cigneCcsIDApLmF0dHIoJ2R5JywgJzE1Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJlbW92ZXMgYWxsIGxpbmtzIGZyb20gdGhlIGdpdmVuIG5vZGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3NwbGljZUxpbmtzRm9yTm9kZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3BsaWNlTGlua3NGb3JOb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgdG9TcGxpY2UgPSB0aGlzR3JhcGgubGlua3MuZmlsdGVyKGZ1bmN0aW9uIChsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBsLnNvdXJjZSA9PT0gbm9kZSB8fCBsLnRhcmdldCA9PT0gbm9kZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0b1NwbGljZS5tYXAoZnVuY3Rpb24gKGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzLnNwbGljZSh0aGlzR3JhcGgubGlua3MuaW5kZXhPZihsKSwgMSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQWRkcyB0aGUgbm9kZSB0byB0aGUgZ3JhcGggYW5kIHVwZGF0ZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2FkZE5vZGUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZE5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgIG5vZGUuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdyZW1vdmVOb2RlJyxcblxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJlbW92ZXMgdGhlIG5vZGUgdG8gdGhlIGdyYXBoIGFuZCB1cGRhdGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBub2RlICAgIFRoZSBub2RlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVOb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMuc3BsaWNlKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG5vZGUpLCAxKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3BsaWNlTGlua3NGb3JOb2RlKG5vZGUpO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2FkZExpbmsnLFxuXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQWRkcyB0aGUgbGluayB0byB0aGUgZ3JhcGggYW5kIHVwZGF0ZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bGlua30gIGxpbmsgICAgVGhlIGxpbmtcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZExpbmsobGluaykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcy5wdXNoKGxpbmspO1xuICAgICAgICAgICAgICAgIGxpbmsuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdyZW1vdmVMaW5rJyxcblxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJlbW92ZXMgdGhlIGxpbmsgdG8gdGhlIGdyYXBoIGFuZCB1cGRhdGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2xpbmt9ICBsaW5rICAgIFRoZSBsaW5rXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVMaW5rKGxpbmspIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3Muc3BsaWNlKHRoaXNHcmFwaC5saW5rcy5pbmRleE9mKGxpbmspLCAxKTtcbiAgICAgICAgICAgICAgICBsaW5rLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgdXBkYXRpbmcgZXhpc3RpbmcgcGF0aHNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UGF0aH0gIHBhdGhzICAgTGlzdCBvZiBwYXRoc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAndXBkYXRlRXhpc3RpbmdQYXRocycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlRXhpc3RpbmdQYXRocyhwYXRocykge1xuICAgICAgICAgICAgICAgIHBhdGhzLmVhY2goZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC51cGRhdGVBdHRyKGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIGFkZGluZyBuZXcgcGF0aHNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UGF0aH0gIG5ld1BhdGhzICBMaXN0IG9mIG5ldyBwYXRoc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAndXBkYXRlTmV3UGF0aHMnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZU5ld1BhdGhzKG5ld1BhdGhzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdExpbmtzKCk7XG5cbiAgICAgICAgICAgICAgICBuZXdQYXRocy5lYWNoKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGQubmV3UGF0aEF0dHIoZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vaWYgbm9kZSBkb2Vzbid0IGhhdmUgaXRzIG93biBwb2xpY3ksIHVzZSBkZWZhdWx0IGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAgICBuZXdQYXRocy5vbihcIm1vdXNlb3ZlclwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQucGF0aFBvbGljeUV2ZW50KFwibW91c2VvdmVyXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aFBvbGljeUV2ZW50KFwibW91c2VvdmVyXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5vbihcImRibGNsaWNrXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJkYmxjbGlja1wiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcImRibGNsaWNrXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5vbihcImNvbnRleHRtZW51XCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJjb250ZXh0bWVudVwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcImNvbnRleHRtZW51XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5vbihcIm1vdXNlb3V0XCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZW91dFwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlb3V0XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5vbihcIm1vdXNlZG93blwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQucGF0aFBvbGljeUV2ZW50KFwibW91c2Vkb3duXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aFBvbGljeUV2ZW50KFwibW91c2Vkb3duXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5vbihcIm1vdXNldXBcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLnBhdGhQb2xpY3lFdmVudChcIm1vdXNldXBcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZXVwXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXNHcmFwaC5kcmFnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgdXBkYXRpbmcgZXhpc3Rpbmcgbm9kZXNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3VwZGF0ZUV4aXN0aW5nTm9kZXMnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUV4aXN0aW5nTm9kZXMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMgPSB0aGlzLmNpcmNsZXMuZGF0YSh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLmlkO1xuICAgICAgICAgICAgICAgIH0pLmVhY2goZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC51cGRhdGVBdHRyKGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIGFkZGluZyBuZXcgbm9kZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5ld05vZGVzICBMaXN0IG9mIG5ldyBub2Rlc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAndXBkYXRlTmV3Tm9kZXMnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZU5ld05vZGVzKG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICBuZXdOb2Rlcy5lYWNoKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmdyYXBoID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGQubmV3Tm9kZUF0dHIoZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vaWYgbm9kZSBkb2Vzbid0IGhhdmUgaXRzIG93biBwb2xpY3ksIHVzZSBkZWZhdWx0IGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAgICBuZXdOb2Rlcy5vbihcIm1vdXNlb3ZlclwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQubm9kZVBvbGljeUV2ZW50KFwibW91c2VvdmVyXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwibW91c2VvdmVyXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5vbihcImRibGNsaWNrXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5ub2RlUG9saWN5RXZlbnQoXCJkYmxjbGlja1wiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcImRibGNsaWNrXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5vbihcImNvbnRleHRtZW51XCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5ub2RlUG9saWN5RXZlbnQoXCJjb250ZXh0bWVudVwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcImNvbnRleHRtZW51XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5vbihcIm1vdXNlb3V0XCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5ub2RlUG9saWN5RXZlbnQoXCJtb3VzZW91dFwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlb3V0XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5vbihcIm1vdXNlZG93blwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQubm9kZVBvbGljeUV2ZW50KFwibW91c2Vkb3duXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwibW91c2Vkb3duXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5vbihcIm1vdXNldXBcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcIm1vdXNldXBcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlUG9saWN5RXZlbnQoXCJtb3VzZXVwXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXNHcmFwaC5kcmFnKTtcblxuICAgICAgICAgICAgICAgIG5ld05vZGVzLmFwcGVuZChcImNpcmNsZVwiKS5hdHRyKFwiclwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gU3RyaW5nKGQucmFkaXVzKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIG5ld05vZGVzLmVhY2goZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluc2VydFRpdGxlTGluZWJyZWFrcyhkMy5zZWxlY3QodGhpcyksIGQudGV4dCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUHJldmVudHMgbm9kZXMgZnJvbSBjb2xsaWRpbmdcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgYWxwaGEgICBBZmZlY3RzIGhvdyBtdWNoIGNoYW5nZVxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlIGNvbGxpc2lvbiBjYXVzZXNcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtib29sZWFufSAge1doZXRoZXIgbm9kZXMgYXJlIGNvbGxpZGVkfVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZDNGb3JjZUNvbGxpZGUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGQzRm9yY2VDb2xsaWRlKGFscGhhKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHM7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgICAgIHZhciBxdWFkdHJlZSA9IGQzLmdlb20ucXVhZHRyZWUobm9kZXMpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgciA9IGQucmFkaXVzICsgY29uc3RzLm1heFJhZGl1cyArIGNvbnN0cy5wYWRkaW5nLFxuICAgICAgICAgICAgICAgICAgICAgICAgbngxID0gZC54IC0gcixcbiAgICAgICAgICAgICAgICAgICAgICAgIG54MiA9IGQueCArIHIsXG4gICAgICAgICAgICAgICAgICAgICAgICBueTEgPSBkLnkgLSByLFxuICAgICAgICAgICAgICAgICAgICAgICAgbnkyID0gZC55ICsgcjtcbiAgICAgICAgICAgICAgICAgICAgcXVhZHRyZWUudmlzaXQoZnVuY3Rpb24gKHF1YWQsIHgxLCB5MSwgeDIsIHkyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocXVhZC5wb2ludCAmJiBxdWFkLnBvaW50ICE9PSBkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHggPSBkLnggLSBxdWFkLnBvaW50LngsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHkgPSBkLnkgLSBxdWFkLnBvaW50LnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwgPSBNYXRoLnNxcnQoeCAqIHggKyB5ICogeSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIgPSBkLnJhZGl1cyArIHF1YWQucG9pbnQucmFkaXVzICsgY29uc3RzLnBhZGRpbmc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGwgPCByKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwgPSAobCAtIHIpIC8gbCAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnggLT0geCAqPSBsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgLT0geSAqPSBsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWFkLnBvaW50LnggKz0geDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVhZC5wb2ludC55ICs9IHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHgxID4gbngyIHx8IHgyIDwgbngxIHx8IHkxID4gbnkyIHx8IHkyIDwgbnkxO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRpY2sgb2YgdGhlIGQzIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDN0aWNrIGV2ZW50fSAgZSAgICBEM3RpY2sgZXZlbnRcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB3aWR0aCAgVGhlIHdpZHRoIG9mIHRoZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgaGVpZ2h0IFRoZSBoZWlnaHQgb2YgdGhlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2QzRm9yY2VUaWNrJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkM0ZvcmNlVGljayhlLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHM7XG5cbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gY29uc3RzLmRpc3BsYXlPZmZzZXQ7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgICAgIHZhciBxID0gZDMuZ2VvbS5xdWFkdHJlZSh0aGlzR3JhcGgubm9kZXMpLFxuICAgICAgICAgICAgICAgICAgICBpID0gMCxcbiAgICAgICAgICAgICAgICAgICAgbiA9IG5vZGVzLmxlbmd0aDtcblxuICAgICAgICAgICAgICAgIHdoaWxlICgrK2kgPCBuKSB7XG4gICAgICAgICAgICAgICAgICAgIHEudmlzaXQodGhpcy5kM0ZvcmNlQ29sbGlkZShub2Rlc1tpXSkpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2godGhpcy5kM0ZvcmNlQ29sbGlkZSguNSkpLmF0dHIoXCJjeFwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC54ID0gTWF0aC5tYXgoZC5yYWRpdXMgKyBvZmZzZXQsIE1hdGgubWluKHdpZHRoIC0gb2Zmc2V0IC0gZC5yYWRpdXMsIGQueCkpO1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoXCJjeVwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55ID0gTWF0aC5tYXgoZC5yYWRpdXMgKyBvZmZzZXQsIE1hdGgubWluKGhlaWdodCAtIG9mZnNldCAtIGQucmFkaXVzLCBkLnkpKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocy5hdHRyKCd4MScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnNvdXJjZS54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3kxJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuc291cmNlLnk7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneDInLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC50YXJnZXQueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd5MicsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnRhcmdldC55O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFN0YXJ0cyBvbiBzdGFydCBvZiB0aGUgZm9yY2Ugc2ltdWxhdGlvblxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZDNGb3JjZVN0YXJ0JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkM0ZvcmNlU3RhcnQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzLmF0dHIoJ3gxJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuc291cmNlLng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneTEnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5zb3VyY2UueTtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd4MicsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnRhcmdldC54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3kyJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQudGFyZ2V0Lnk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIG9uIHRoZSBlbmQgb2YgdGhlIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2QzRm9yY2VFbmQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGQzRm9yY2VFbmQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuYXR0cignY3gnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ2N5JywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocy5hdHRyKCd4MScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnNvdXJjZS54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3kxJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuc291cmNlLnk7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneDInLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC50YXJnZXQueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd5MicsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnRhcmdldC55O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGN1bGF0ZXMgdGhlIHdpZHRoIGFuZCBoZWlnaHQgYm91bmRzIGZvciB0aGUgXG4gICAgICAgICAgICAgKiBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHJldHVybiAgICAge09iamVjdH0gIHdpZHRoIGFuZCBoZWlnaHQgYXMgcHJvcGVydGllcyBcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2QzRm9yY2VCb3VuZHMnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGQzRm9yY2VCb3VuZHMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z1dpZHRoID0gJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS53aWR0aCgpO1xuICAgICAgICAgICAgICAgIHZhciBzdmdIZWlnaHQgPSAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLmhlaWdodCgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gc3ZnV2lkdGg7XG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IHN2Z0hlaWdodDtcbiAgICAgICAgICAgICAgICByZXR1cm4geyB3aWR0aDogd2lkdGgsIGhlaWdodDogaGVpZ2h0IH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogRG9lcyBhIGQzIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RnVuY3Rpb259ICBjYWxsYmFjayAgVGhlIGNhbGxiYWNrXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdzZXRGb3JjZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0Rm9yY2UoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXNHcmFwaC5ub2RlcztcbiAgICAgICAgICAgICAgICB2YXIgbGlua3MgPSB0aGlzR3JhcGgubGlua3M7XG4gICAgICAgICAgICAgICAgaWYgKF8uaXNFbXB0eShub2RlcykpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBib3VuZHMgPSB0aGlzR3JhcGguZDNGb3JjZUJvdW5kcygpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGZvcmNlID0gZDMubGF5b3V0LmZvcmNlKCkuc2l6ZShbYm91bmRzLndpZHRoLCBib3VuZHMuaGVpZ2h0XSkubm9kZXMobm9kZXMpLmNoYXJnZShmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTYwMDA7XG4gICAgICAgICAgICAgICAgfSkubGlua3MobGlua3MpO1xuXG4gICAgICAgICAgICAgICAgZm9yY2UubGlua0Rpc3RhbmNlKGJvdW5kcy53aWR0aCAvIDMpO1xuICAgICAgICAgICAgICAgIGZvcmNlLmxpbmtTdHJlbmd0aCguMik7XG4gICAgICAgICAgICAgICAgZm9yY2UuZ3Jhdml0eSguMik7XG5cbiAgICAgICAgICAgICAgICBmb3JjZS5vbigndGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kM0ZvcmNlVGljay5jYWxsKHRoaXNHcmFwaCwgZSwgYm91bmRzLndpZHRoLCBib3VuZHMuaGVpZ2h0KTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGZvcmNlLm9uKCdzdGFydCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLmQzRm9yY2VTdGFydC5jYWxsKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBmb3JjZS5vbignZW5kJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguZDNGb3JjZUVuZC5jYWxsKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBmb3JjZS5zdGFydCgpO1xuICAgICAgICAgICAgICAgIHZhciBrID0gMDtcbiAgICAgICAgICAgICAgICB3aGlsZSAoZm9yY2UuYWxwaGEoKSA+IDFlLTIgJiYgayA8IDE1MCkge1xuICAgICAgICAgICAgICAgICAgICBmb3JjZS50aWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIGsgPSBrICsgMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yY2Uuc3RvcCgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU2V0cyB0aGUgcG9zaXRpb25zIHRvIGJlIHRoZSBjZW50ZXIgb2YgdGhlIHNjcmVlbiBpZiBcbiAgICAgICAgICAgICAqIG5vdCBwcm92aWRlZFxuICAgICAgICAgICAgICogYWxzbyBzZXRzIHRoZSByYWRpdXMgb2YgdGhlIG5vZGVzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdzZXRQb3NpdGlvbnMnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldFBvc2l0aW9ucygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSB0aGlzR3JhcGguY29uc3RzLmRpc3BsYXlPZmZzZXQ7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z1dpZHRoID0gJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS53aWR0aCgpO1xuICAgICAgICAgICAgICAgIHZhciBzdmdIZWlnaHQgPSAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLmhlaWdodCgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gc3ZnV2lkdGggLSAyICogb2Zmc2V0O1xuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBzdmdIZWlnaHQgLSAyICogb2Zmc2V0O1xuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBub2Rlc1tpXS5yYWRpdXMgPSBub2Rlc1tpXS5yYWRpdXMgfHwgdGhpc0dyYXBoLmNvbnN0cy5zdGFydFJhZGl1cztcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGVzW2ldLnggPT0gbnVsbCB8fCBub2Rlc1tpXS55ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5vZGVzW2ldLnhTdGFydCA9IHdpZHRoLzIgICsgbm9kZXNbaV0ucmFkaXVzICsgb2Zmc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1tpXS54ID0gd2lkdGggLyAyICsgbm9kZXNbaV0ucmFkaXVzICsgb2Zmc2V0O1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm9kZXNbaV0ueVN0YXJ0ID0gaGVpZ2h0LzIgKyBub2Rlc1tpXS5yYWRpdXMgKyBvZmZzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzW2ldLnkgPSBoZWlnaHQgLyAyICsgbm9kZXNbaV0ucmFkaXVzICsgb2Zmc2V0O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB0byB1cGRhdGUgdGhlIHZpZXcgb2YgdGhlIGdyYXBoIHdoZW5cbiAgICAgICAgICAgICAqIGRhdGEgY2hhbmdlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtGdW5jdGlvbn0gIGNhbGxiYWNrICBUaGUgY2FsbGJhY2tcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3VwZGF0ZUdyYXBoJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVHcmFwaChjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGguc3RhdGUuZGlzYWJsZVVwZGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVFeGlzdGluZ05vZGVzKCk7XG4gICAgICAgICAgICAgICAgdmFyIG5ld0dzID0gdGhpc0dyYXBoLmNpcmNsZXMuZW50ZXIoKS5hcHBlbmQoXCJnXCIpO1xuXG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ3VwZGF0ZScsIG5ld0dzKTtcbiAgICAgICAgICAgICAgICBuZXdHcy5jbGFzc2VkKGNvbnN0cy5jaXJjbGVHQ2xhc3MsIHRydWUpO1xuXG4gICAgICAgICAgICAgICAgLy8gdGhpcy51cGRhdGVOZXdOb2RlcyhuZXdHcyk7XG5cbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgb2xkIG5vZGVzXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZXhpdCgpLnJlbW92ZSgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmluaXRGb3JjZSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc2V0Rm9yY2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZU5ld05vZGVzLmNhbGwodGhpc0dyYXBoLCBuZXdHcyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5pbml0Rm9yY2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlTmV3Tm9kZXMobmV3R3MpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocyA9IHRoaXNHcmFwaC5wYXRocy5kYXRhKHRoaXNHcmFwaC5saW5rcywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFN0cmluZyhkLnNvdXJjZS5pZCkgKyBcIitcIiArIFN0cmluZyhkLnRhcmdldC5pZCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdmFyIHBhdGhzID0gdGhpc0dyYXBoLnBhdGhzO1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRXhpc3RpbmdQYXRocyhwYXRocyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbmV3cGF0aHMgPSBwYXRocy5lbnRlcigpLmFwcGVuZChcInBhdGhcIikuc3R5bGUoJ21hcmtlci1lbmQnLCAndXJsKCNlbmQtYXJyb3cpJykuY2xhc3NlZChcImxpbmtcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVOZXdQYXRocyhuZXdwYXRocyk7XG5cbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgb2xkIGxpbmtzXG4gICAgICAgICAgICAgICAgcGF0aHMuZXhpdCgpLnJlbW92ZSgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1dKTtcblxuICAgICAgICByZXR1cm4gR3JhcGg7XG4gICAgfSgpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgR3JhcGg6IEdyYXBoXG4gICAgfTtcbn1dKTtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG4vKipcbiAqIFRoZSBncmFwaCB0aGF0IGlzIHVzZWQgc3BlY2lmaWNhbGx5IGZvciB0aGUgdmlzdWFsaXphdGlvbiB0YWIuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdWaXN1YWxpemVyR3JhcGgnLCBbJ0dyYXBoJywgZnVuY3Rpb24gKEdyYXBoKSB7XG4gICAgdmFyIFZpc3VhbGl6ZXJHcmFwaCA9IGZ1bmN0aW9uIChfR3JhcGgkR3JhcGgpIHtcbiAgICAgICAgX2luaGVyaXRzKFZpc3VhbGl6ZXJHcmFwaCwgX0dyYXBoJEdyYXBoKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gICB7SFRNTCBTVkd9ICBzdmcgICAgICAgICAgICAgVGhlIHN2ZyB0aGF0IHdpbGwgXG4gICAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob2xkIHRoZSBncmFwaFxuICAgICAgICAgICAgICAgKiBAcGFyYW0gICB7QXJyYXl9ICBub2RlcyAgIFx0XHQgICAgTGlzdCBvZiBub2Rlc1xuICAgICAgICAgICAgICAgKiBAcGFyYW0gICB7QXJyYXl9ICBsaW5rcyAgIFx0XHQgICAgTGlzdCBvZiBsaW5rc1xuICAgICAgICAgKiBAcGFyYW0gICB7RGF0YVNvdXJjZX0gIGRhdGFTb3VyY2UgICAgVGhlIGRhdGEgc291cmNlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBWaXN1YWxpemVyR3JhcGgoc3ZnLCBub2RlcywgbGlua3MsIGRhdGFTb3VyY2UpIHtcbiAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBWaXN1YWxpemVyR3JhcGgpO1xuXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoVmlzdWFsaXplckdyYXBoLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoVmlzdWFsaXplckdyYXBoKSkuY2FsbCh0aGlzLCBzdmcsIG5vZGVzLCBsaW5rcykpO1xuXG4gICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gX3RoaXM7XG5cbiAgICAgICAgICAgIC8vaG9sZHMgY3VycmVudCB0cmFuc2l0aW9ucyB0aGF0IGFyZSBvY2N1cmluZ1xuICAgICAgICAgICAgdGhpc0dyYXBoLnN0YXRlLnRyYW5zaXRpb24gPSBbXTtcbiAgICAgICAgICAgIC8vTWluIGRpc3RhbmNlIGJldHdlZW4gbm9kZXMgd2hlbiBzcGF3bmluZyByYW5kb21seVxuICAgICAgICAgICAgdGhpc0dyYXBoLmNvbnN0cy5lZGdlX2J1ZmZlciA9IDIwMDtcbiAgICAgICAgICAgIC8vU2l6ZSByZWR1Y3Rpb24gYXMgeW91IGdvIHRocm91Z2ggbGV2ZWxzIGluIG5vZGVzXG4gICAgICAgICAgICB0aGlzR3JhcGguY29uc3RzLnJhZGl1c0RlY2F5ID0gMTtcbiAgICAgICAgICAgIC8vQ3NzIGNsYXNzIGZvciBub2RlcyB0aGF0IGFyZSBjb250YWluZXJzXG4gICAgICAgICAgICB0aGlzR3JhcGguY29uc3RzLmNvbnRhaW5lckNsYXNzID0gJ2NvbnRhaW5lcic7XG5cbiAgICAgICAgICAgIC8vZGF0YVNvdXJjZSBob2xkcyB0aGUgc2VydmVyIGRhdGEgYW5kIG1ldGhvZHMgZm9yXG4gICAgICAgICAgICAvL2NvbnZlcnRpbmcgaXQgdG8gZGF0YSBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICB0aGlzR3JhcGguZGF0YVNvdXJjZSA9IGRhdGFTb3VyY2U7XG5cbiAgICAgICAgICAgIC8vRHJhZyBiZWhhdmlvciBmb3Igbm9kZXNcbiAgICAgICAgICAgIHZhciBkcmFnID0gZDMuYmVoYXZpb3IuZHJhZygpLm9yaWdpbihmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHg6IGQueCwgeTogZC55IH07XG4gICAgICAgICAgICB9KS5vbihcImRyYWdzdGFydFwiLCBmdW5jdGlvbiAoKSB7fSkub24oXCJkcmFnXCIsIGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZnVuY3Rpb24gKGQsIGkpIHtcbiAgICAgICAgICAgICAgICAgICAgZC54ICs9IGQzLmV2ZW50LmR4O1xuICAgICAgICAgICAgICAgICAgICBkLnkgKz0gZDMuZXZlbnQuZHk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcInRyYW5zbGF0ZShcIiArIFtkLngsIGQueV0gKyBcIilcIjtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH0pLm9uKFwiZHJhZ2VuZFwiLCBmdW5jdGlvbiAoKSB7fSk7XG5cbiAgICAgICAgICAgIHRoaXNHcmFwaC5kcmFnID0gZHJhZztcblxuICAgICAgICAgICAgLy9QYW4gYW5kIFpvb20gYmVoYXZpb3IgZm9yIHRoZSBncmFwaFxuICAgICAgICAgICAgdmFyIHpvb20gPSBkMy5iZWhhdmlvci56b29tKCkub24oXCJ6b29tXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoZDMuZXZlbnQuc291cmNlRXZlbnQgIT0gbnVsbCAmJiBkMy5ldmVudC5zb3VyY2VFdmVudC5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguem9vbWVkLmNhbGwodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9KS5vbihcInpvb21zdGFydFwiLCBmdW5jdGlvbiAoZCwgaSkge30pO1xuICAgICAgICAgICAgdGhpc0dyYXBoLmRyYWdTdmcgPSB6b29tO1xuICAgICAgICAgICAgdGhpc0dyYXBoLnN2Zy5jYWxsKHpvb20pLm9uKFwiZGJsY2xpY2suem9vbVwiLCBudWxsKTtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYWxsZWQgd2l0aCBubyBhcmdzIHdoZW4gdGhlIGdyYXBoIGhhcyBhIHpvb20gYWN0aW9uXG4gICAgICAgICAqIENhbiBhbHNvIGJlIGNhbGxlZCB3aXRoIGFyZ3MgdG8gZm9yY2UgYSB6b29tIG9yIHBhbiBcbiAgICAgICAgICogZXZlbnQgZm9yIHRoZSBncmFwaC5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgIHRyYW5zbGF0ZSAgVGhlIGFtb3VudCB0byB0cmFuc2xhdGVcbiAgICAgICAgICogQHBhcmFtICAgICAge251bWJlcn0gIHNjYWxlICAgICAgVGhlIGFtb3VudCB0byBzY2FsZVxuICAgICAgICAgKi9cblxuXG4gICAgICAgIF9jcmVhdGVDbGFzcyhWaXN1YWxpemVyR3JhcGgsIFt7XG4gICAgICAgICAgICBrZXk6ICd6b29tZWQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHpvb21lZCh0cmFuc2xhdGUsIHNjYWxlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5zdGF0ZS5yaWdodENsaWNrID09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmp1c3RTY2FsZVRyYW5zR3JhcGggPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmICh0cmFuc2xhdGUgIT0gbnVsbCAmJiBzY2FsZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB6b29tID0gdGhpc0dyYXBoLmRyYWdTdmc7XG4gICAgICAgICAgICAgICAgICAgIHpvb20uc2NhbGUoc2NhbGUpO1xuICAgICAgICAgICAgICAgICAgICB6b29tLnRyYW5zbGF0ZSh0cmFuc2xhdGUpO1xuICAgICAgICAgICAgICAgICAgICAvL2NyZWF0aW5nIG5hbWVzIHRvIHByZXZlbnQgdHJhbnNpdGlvbiBjb25mbGljdHNcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb21TZXRDYWxsYmFjayA9IGZ1bmN0aW9uIHpvb21TZXRDYWxsYmFjaygpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHpvb20uc2NhbGUoc2NhbGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgem9vbS50cmFuc2xhdGUodHJhbnNsYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zbGF0ZV9uYW1lID0gXCJ6b29tXCIgKyB0cmFuc2xhdGU7XG4gICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdChcIi5cIiArIHRoaXMuY29uc3RzLmdyYXBoQ2xhc3MpLnRyYW5zaXRpb24odHJhbnNsYXRlX25hbWUpLmRlbGF5KDEwMCkuZHVyYXRpb24oNzUwKS5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKCcgKyB6b29tLnRyYW5zbGF0ZSgpICsgJykgc2NhbGUoJyArIHpvb20uc2NhbGUoKSArICcpJykuZWFjaChcImVuZFwiLCB6b29tU2V0Q2FsbGJhY2spO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGguc3RhdGUuY2FuWm9vbSkge1xuICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QoXCIuXCIgKyB0aGlzLmNvbnN0cy5ncmFwaENsYXNzKS5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKCkgKyBcIikgc2NhbGUoXCIgKyB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpICsgXCIpXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnb25XaW5kb3dSZXNpemUnLFxuXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIHdpbmRvdyByZXNpemVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0hUTUwgU1ZHfSAgc3ZnICAgIFRoZSBzdmcgdG8gcmVzaXplXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvbldpbmRvd1Jlc2l6ZShzdmcpIHtcbiAgICAgICAgICAgICAgICB2YXIgYm9keUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXTtcbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS5vZmZzZXQoKTtcbiAgICAgICAgICAgICAgICB2YXIgZGl2V2lkdGggPSAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLndpZHRoKCk7XG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IGJvZHlFbC5jbGllbnRIZWlnaHQ7XG4gICAgICAgICAgICAgICAgc3ZnLmF0dHIoXCJ3aWR0aFwiLCBkaXZXaWR0aCkuYXR0cihcImhlaWdodFwiLCBoZWlnaHQgLSBvZmZzZXQudG9wIC0gMjApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd1cGRhdGVMaW5rRGF0YScsXG5cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgc2VydmVyIHNlbmRzIHVwZGF0ZWQgZGF0YSBmb3IgdGhlIGxpbmtzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVMaW5rRGF0YSgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgbm9kZV9uYW1lc19zZXQgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXNHcmFwaC5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBub2RlX25hbWVzX3NldC5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXS5pZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciByZXREYXRhID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuZ2V0Rmxvd0JldHdlZW5TZXQobm9kZV9uYW1lc19zZXQpO1xuICAgICAgICAgICAgICAgIHZhciBsaW5rRGF0YSA9IHJldERhdGEubGlua0RhdGE7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UucHJvY2Vzc0xpbmtEYXRhKGxpbmtEYXRhLCB0aGlzR3JhcGgubm9kZXMpO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5pdE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5pbml0TGlua3MoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfV0pO1xuXG4gICAgICAgIHJldHVybiBWaXN1YWxpemVyR3JhcGg7XG4gICAgfShHcmFwaC5HcmFwaCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBHcmFwaDogVmlzdWFsaXplckdyYXBoXG4gICAgfTtcbn1dKTtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLyoqXG4gKiBUaGUgYmFzZSBjbGFzcyBmb3IgbGluayBvYmplY3RzIGZvciB0aGUgZ3JhcGguXG4gKiBTdXBwb3J0cyBwb2xpY2llcy5cbiAqIFxuICogVG8gd3JpdGUgeW91ciBvd24gbGluayBvYmplY3QsIGNyZWF0ZSBhIG5ldyBmYWN0b3J5IHRoYXQgdXNlcyB0aGUgbGlua1xuICogeW91IHdhbnQgdG8gaW5oZXJpdCBhcyBhIGRlcGVuZGVuY3ksIGFuZCBleHRlbmQgaXRzIGxpbmsgY2xhc3MuIFxuICogUmV0dXJuIHRoZSBjbGFzcyBvYmplY3Qgd2l0aCBMaW5rIGFzIGtleVxuICogXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdMaW5rJywgW2Z1bmN0aW9uICgpIHtcblx0dmFyIExpbmsgPSBmdW5jdGlvbiAoKSB7XG5cdFx0LyoqXG4gICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICpcbiAgICogQHBhcmFtICAgICAge05vZGV9ICBzb3VyY2VOb2RlICBUaGUgc291cmNlIG5vZGVcbiAgICogQHBhcmFtICAgICAge05vZGV9ICB0YXJnZXROb2RlICBUaGUgdGFyZ2V0IG5vZGVcbiAgICovXG5cdFx0ZnVuY3Rpb24gTGluayhzb3VyY2VOb2RlLCB0YXJnZXROb2RlKSB7XG5cdFx0XHRfY2xhc3NDYWxsQ2hlY2sodGhpcywgTGluayk7XG5cblx0XHRcdHRoaXMuc291cmNlID0gc291cmNlTm9kZTtcblx0XHRcdHRoaXMudGFyZ2V0ID0gdGFyZ2V0Tm9kZTtcblx0XHRcdHRoaXMuaGFzUG9saWN5ID0gZmFsc2U7XG5cdFx0XHR0aGlzLnBhdGhQb2xpY2llcyA9IFtdO1xuXHRcdFx0dGhpcy5ncmFwaCA9IG51bGw7XG5cdFx0XHR0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqIENhbGxlZCB3aGVuIGEgbGluayBpcyBhZGRlZCB0byB0aGUgZ3JhcGhcbiAgICpcbiAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgYWRkZWQgdG9cbiAgICovXG5cblxuXHRcdF9jcmVhdGVDbGFzcyhMaW5rLCBbe1xuXHRcdFx0a2V5OiAnaW5pdGlhbGl6ZScsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gaW5pdGlhbGl6ZShncmFwaCkge1xuXHRcdFx0XHRpZiAodGhpcy5pbml0aWFsaXplZCA9PSBmYWxzZSkge1xuXHRcdFx0XHRcdHRoaXMuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuXHRcdFx0XHRcdHRoaXMuZ3JhcGggPSBncmFwaDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIENhbGxlZCBkdXJpbmcgdGhlIHVwZGF0ZSBncmFwaCBmb3IgZXhpc3RpbmcgbGlua3NcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM3BhdGggIFRoZSBkMyBwYXRoXG4gICAgKiBAcGFyYW0gICAgICB7TGlua30gIFx0ICAgZCAgICAgICBNYXRjaGluZyBMaW5rIE9iamVjdCAgICAgICBcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAndXBkYXRlQXR0cicsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gdXBkYXRlQXR0cihkM3BhdGgsIGQpIHtcblx0XHRcdFx0ZDNwYXRoLnN0eWxlKCdtYXJrZXItZW5kJywgJ3VybCgjZW5kLWFycm93KScpLmF0dHIoXCJkXCIsIGFycm93UGF0aCk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogQ2FsbGVkIGR1cmluZyB0aGUgZmlyc3QgdXBkYXRlIGdyYXBoIGZvciBhIGxpbmtcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM3BhdGggIFRoZSBkMyBwYXRoXG4gICAgKiBAcGFyYW0gICAgICB7TGlua30gIFx0ICAgZCAgICAgICBNYXRjaGluZyBMaW5rIE9iamVjdCAgICAgICBcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnbmV3UGF0aEF0dHInLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIG5ld1BhdGhBdHRyKGQzcGF0aCwgZCkge1xuXHRcdFx0XHRkM3BhdGguYXR0cignZCcsIGFycm93UGF0aCk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogQ2FsY3VsYXRlcyB0aGUgYXJyb3cgcGF0aFxuICAgICpcbiAgICAqIEByZXR1cm4gICAgIHtzdHJpbmd9ICBUaGUgcGF0aCB0byBkcmF3XG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ2Fycm93UGF0aCcsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gYXJyb3dQYXRoKCkge1xuXHRcdFx0XHR2YXIgZCA9IHRoaXM7XG5cdFx0XHRcdHZhciBkeCA9IGQudGFyZ2V0LnggLSBkLnNvdXJjZS54LFxuXHRcdFx0XHQgICAgZHkgPSBkLnRhcmdldC55IC0gZC5zb3VyY2UueSxcblx0XHRcdFx0ICAgIGRyID0gTWF0aC5zcXJ0KGR4ICogZHggKyBkeSAqIGR5KTtcblx0XHRcdFx0cmV0dXJuIFwiTVwiICsgZC5zb3VyY2UueCArIFwiLFwiICsgZC5zb3VyY2UueSArIFwiQVwiICsgZHIgKyBcIixcIiArIGRyICsgXCIgMCAwLDEgXCIgKyBkLnRhcmdldC54ICsgXCIsXCIgKyBkLnRhcmdldC55O1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIFVzZWQgdG8gaW5zdGFsbCBwb2xpY2llcyB0aGF0IGFyZSBjYWxsZWQgd2hlbiB0aGlzXG4gICAgKiBsaW5rIGhhcyBhIG1vdXNlIGV2ZW50XG4gICAgKlxuICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeSAgVGhlIHBvbGljeSB0byBpbnN0YWxsXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ2luc3RhbGxQYXRoUG9saWN5Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBpbnN0YWxsUGF0aFBvbGljeShwb2xpY3kpIHtcblx0XHRcdFx0dGhpcy5oYXNQb2xpY3kgPSB0cnVlO1xuXHRcdFx0XHR0aGlzLnBhdGhQb2xpY2llcy5wdXNoKHBvbGljeSk7XG5cdFx0XHRcdHBvbGljeS5pbml0aWFsaXplKHRoaXMuZ3JhcGgpO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIFVzZWQgdG8gdW5pbnN0YWxsIHBvbGljeSBmb3IgdGhpcyBsaW5rXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeVJlbW92ZSAgVGhlIHBvbGljeSB0byByZW1vdmVcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAndW5pbnN0YWxsUGF0aFBvbGljeScsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gdW5pbnN0YWxsUGF0aFBvbGljeShwb2xpY3lSZW1vdmUpIHtcblx0XHRcdFx0dmFyIHBvbGljeVJlbW92ZU5hbWU7XG5cdFx0XHRcdHZhciB0aGlzUGF0aCA9IHRoaXM7XG5cdFx0XHRcdGlmICh0eXBlb2YgcG9saWN5UmVtb3ZlID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRcdHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmU7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZS5wb2xpY3lOYW1lO1xuXHRcdFx0XHR9XG5cdFx0XHRcdF8odGhpc1BhdGgucGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3ksIGluZGV4KSB7XG5cdFx0XHRcdFx0aWYgKHBvbGljeS5wb2xpY3lOYW1lID09PSBwb2xpY3lSZW1vdmVOYW1lKSB7XG5cdFx0XHRcdFx0XHRwb2xpY3kuZGVzdHJveSgpO1xuXHRcdFx0XHRcdFx0dGhpc1BhdGgucGF0aFBvbGljaWVzLnNwbGljZShpbmRleCwgMSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdFx0aWYgKHRoaXNQYXRoLnBhdGhQb2xpY2llcy5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0XHR0aGlzUGF0aC5oYXNQb2xpY3kgPSBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIENhbGxlZCB3aGVuIHRoZXJlIGlzIGEgbW91c2UgZXZlbnQgZm9yIHRoaXMgcGF0aFxuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBldmVudCAgICAgVGhlIG1vdXNlIGV2ZW50XG4gICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM3BhdGggIFRoZSBkMyBwYXRoXG4gICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgZCAgICAgICAgIFRoZSBtYXRjaGluZyBsaW5rIG9iamVjdFxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdwYXRoUG9saWN5RXZlbnQnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHBhdGhQb2xpY3lFdmVudChldmVudCwgZDNwYXRoLCBkKSB7XG5cdFx0XHRcdF8oZC5wYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24gKHBvbGljeSkge1xuXHRcdFx0XHRcdHBvbGljeVtldmVudF0oZDNwYXRoLCBkKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fV0pO1xuXG5cdFx0cmV0dXJuIExpbms7XG5cdH0oKTtcblxuXHRyZXR1cm4ge1xuXHRcdExpbms6IExpbmtcblx0fTtcbn1dKTtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxudmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQob2JqZWN0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IHJldHVybiBnZXQocGFyZW50LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpOyB9IH0gZWxzZSBpZiAoXCJ2YWx1ZVwiIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9O1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbi8qKlxuICogVGhlIGxpbmsgdGhhdCBpcyB1c2VkIHNwZWNpZmljYWxseSBmb3IgdGhlIHZpc3VhbGl6YXRpb24gdGFiLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnVmlzdWFsaXplckxpbmsnLCBbJ0xpbmsnLCBmdW5jdGlvbiAoTGluaykge1xuXHR2YXIgVmlzdWFsaXplckxpbmsgPSBmdW5jdGlvbiAoX0xpbmskTGluaykge1xuXHRcdF9pbmhlcml0cyhWaXN1YWxpemVyTGluaywgX0xpbmskTGluayk7XG5cblx0XHQvKipcbiAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgKlxuICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHNvdXJjZU5vZGUgIFRoZSBzb3VyY2Ugbm9kZVxuICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHRhcmdldE5vZGUgIFRoZSB0YXJnZXQgbm9kZVxuICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgd2VpZ2h0ICAgIFRoZSB3ZWlnaHQgb2YgdGhlIGxpbmtcbiAgICovXG5cdFx0ZnVuY3Rpb24gVmlzdWFsaXplckxpbmsoc291cmNlTm9kZSwgdGFyZ2V0Tm9kZSwgd2VpZ2h0KSB7XG5cdFx0XHRfY2xhc3NDYWxsQ2hlY2sodGhpcywgVmlzdWFsaXplckxpbmspO1xuXG5cdFx0XHR2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoVmlzdWFsaXplckxpbmsuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihWaXN1YWxpemVyTGluaykpLmNhbGwodGhpcywgc291cmNlTm9kZSwgdGFyZ2V0Tm9kZSkpO1xuXG5cdFx0XHRfdGhpcy53ZWlnaHQgPSB3ZWlnaHQ7XG5cdFx0XHQvL0NvdW50IGlzIHVzZWQgdG8ga2VlcCB0cmFjayBvZiBob3cgbWFueVxuXHRcdFx0Ly9wYXRocyB0byBpdHMgc3Vibm9kZXMgdGhlcmUgYXJlXG5cdFx0XHQvL2luIG9yZGVyIHRvIGNhbGN1bGF0ZSBhdmVyYWdlIHRyYWZmaWNcblx0XHRcdF90aGlzLmNvdW50ID0gMTtcblx0XHRcdHJldHVybiBfdGhpcztcblx0XHR9XG5cblx0XHQvKipcbiAgICogSW5jcmVhc2VzIHRoZSBjb3VudCBvZiB0aGUgbGlua1xuICAgKiBVU2VkIHRvIGtlZXAgdHJhY2sgb2YgaG93IG1hbnkgcGF0aHMgdG8gaXRzIHN1Ym5vZGVzXG4gICAqIHRoZXJlIGFyZSBpbiBvcmRlciB0byBjYWxjdWxhdGUgYXZlcmFnZSB0cmFmZmljXG4gICAqL1xuXG5cblx0XHRfY3JlYXRlQ2xhc3MoVmlzdWFsaXplckxpbmssIFt7XG5cdFx0XHRrZXk6ICdpbmNyZWFzZUNvdW50Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBpbmNyZWFzZUNvdW50KCkge1xuXHRcdFx0XHR0aGlzLmNvdW50ICs9IDE7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogQ2FsY3VsYXRlcyB3aGVyZSB0byBwbGFjZSBxdGlwIGZvclxuICAgICpcbiAgICAqIEByZXR1cm4gICAgIHtPYmplY3R9ICBPYmplY3Qgd2l0aCBxVGlwIHNldHRpbmdzXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3F0aXBIZWxwZXInLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHF0aXBIZWxwZXIoKSB7XG5cdFx0XHRcdHZhciByZXQ7XG5cdFx0XHRcdHZhciBkID0gdGhpcztcblx0XHRcdFx0dmFyIGR4ID0gKGQudGFyZ2V0LnggLSBkLnNvdXJjZS54KSAvIDIsXG5cdFx0XHRcdCAgICBkeSA9IChkLnRhcmdldC55IC0gZC5zb3VyY2UueSkgLyAyO1xuXHRcdFx0XHRpZiAoZC5zb3VyY2UueCA8IGQudGFyZ2V0LngpIHtcblx0XHRcdFx0XHRyZXQgPSB7XG5cdFx0XHRcdFx0XHRteTogJ3RvcCBjZW50ZXInLFxuXHRcdFx0XHRcdFx0YXQ6ICdjZW50ZXIgY2VudGVyJywgLy8gYXQgdGhlIGJvdHRvbSByaWdodCBvZi4uLlxuXHRcdFx0XHRcdFx0dGFyZ2V0OiBbZHgsIGR5XSxcblx0XHRcdFx0XHRcdGFkanVzdDoge1xuXHRcdFx0XHRcdFx0XHR5OiAxMFxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cmV0ID0ge1xuXHRcdFx0XHRcdFx0bXk6ICdib3R0b20gY2VudGVyJyxcblx0XHRcdFx0XHRcdGF0OiAnY2VudGVyIGNlbnRlcicsIC8vIGF0IHRoZSBib3R0b20gcmlnaHQgb2YuLi5cblx0XHRcdFx0XHRcdHRhcmdldDogW2R4LCBkeV0sXG5cdFx0XHRcdFx0XHRhZGp1c3Q6IHtcblx0XHRcdFx0XHRcdFx0eTogLTEwXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gcmV0O1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICogQ2FsbGVkIHdoZW4gYSBsaW5rIGlzIGFkZGVkIHRvIHRoZSBncmFwaFxuICAgKlxuICAgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaCBpdCBpcyBhZGRlZCB0b1xuICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ2luaXRpYWxpemUnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemUoZ3JhcGgpIHtcblx0XHRcdFx0aWYgKHRoaXMuaW5pdGlhbGl6ZWQgPT0gZmFsc2UpIHtcblx0XHRcdFx0XHRfZ2V0KFZpc3VhbGl6ZXJMaW5rLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFZpc3VhbGl6ZXJMaW5rLnByb3RvdHlwZSksICdpbml0aWFsaXplJywgdGhpcykuY2FsbCh0aGlzLCBncmFwaCk7XG5cdFx0XHRcdFx0dmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuVmlzdWFsaXplckxpbms7XG5cdFx0XHRcdFx0aWYgKHN0YXRlID09IG51bGwpIHtcblx0XHRcdFx0XHRcdHN0YXRlID0gZ3JhcGguc3RhdGUuVmlzdWFsaXplckxpbmsgPSB7fTtcblx0XHRcdFx0XHRcdHN0YXRlLm1heFdlaWdodCA9IG51bGw7XG5cdFx0XHRcdFx0XHRzdGF0ZS51c2VBdmdXZWlnaHQgPSB0cnVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHR0aGlzLnVwZGF0ZU1heFdlaWdodCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogU2V0cyB3aGV0aGVyIHRoZSBncmFwaCBzaG91bGQgdXNlIGF2ZyB3ZWlnaHRcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7Ym9vbGVhbn0gIHZhbCAgICAgVGhlIHZhbHVlIHRvIHNldCB0b1xuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdzZXRVc2VBdmdXZWlnaHQnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHNldFVzZUF2Z1dlaWdodCh2YWwpIHtcblx0XHRcdFx0dGhpcy5ncmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluay51c2VBdmdXZWlnaHQgPSAhIXZhbDtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBTZXRzIHRoZSB3ZWlnaHQgb2YgdGhpcyBsaW5rXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge251bWJlcn0gIHdlaWdodCAgVGhlIHdlaWdodCB0byBzZXQgdG9cbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnc2V0V2VpZ2h0Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBzZXRXZWlnaHQod2VpZ2h0KSB7XG5cdFx0XHRcdHRoaXMud2VpZ2h0ID0gd2VpZ2h0O1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIEdldHMgdGhlIHJhdyB3ZWlnaHQuXG4gICAgKlxuICAgICogQHJldHVybiAgICAge251bWJlcn0gIFRoZSByYXcgd2VpZ2h0LlxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdnZXRSYXdXZWlnaHQnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGdldFJhd1dlaWdodCgpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMud2VpZ2h0O1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIEdldHMgdGhlIHdlaWdodCB2YWx1ZSBvZiB0aGUgbGluaywgZGVwZW5kaW5nIG9uIHRoZVxuICAgICogdXNlQXZnV2VpZ3RoIHNldHRpbmdcbiAgICAqXG4gICAgKiBAcmV0dXJuICAgICB7bnVtYmVyfSAgVGhlIHdlaWdodC5cbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnZ2V0V2VpZ2h0Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBnZXRXZWlnaHQoKSB7XG5cdFx0XHRcdHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuXHRcdFx0XHQgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuVmlzdWFsaXplckxpbms7XG5cblx0XHRcdFx0aWYgKHN0YXRlLnVzZUF2Z1dlaWdodCkge1xuXHRcdFx0XHRcdHZhciB3ZWlnaHQgPSB0aGlzLndlaWdodCAvIHRoaXMuY291bnQ7XG5cdFx0XHRcdFx0cmV0dXJuIHdlaWdodDtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdGhpcy53ZWlnaHQ7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogVXBkYXRlcyB0aGUgbWF4IHdlaWdodCBvZiB0aGUgZ3JhcGhcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAndXBkYXRlTWF4V2VpZ2h0Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVNYXhXZWlnaHQoKSB7XG5cdFx0XHRcdHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuXHRcdFx0XHQgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuVmlzdWFsaXplckxpbms7XG5cblx0XHRcdFx0dmFyIG1heExpbmsgPSBfLm1heEJ5KHRoaXNHcmFwaC5saW5rcywgZnVuY3Rpb24gKGwpIHtcblx0XHRcdFx0XHRpZiAobC5ncmFwaCAhPSBudWxsKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gbC5nZXRXZWlnaHQoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIDA7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRzdGF0ZS5tYXhXZWlnaHQgPSBtYXhMaW5rLmdldFdlaWdodCgpO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIENhbGxlZCBkdXJpbmcgdGhlIHVwZGF0ZSBncmFwaCBmb3IgZXhpc3RpbmcgbGlua3NcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM3BhdGggIFRoZSBkMyBwYXRoXG4gICAgKiBAcGFyYW0gICAgICB7TGlua30gIFx0ICAgZCAgICAgICBNYXRjaGluZyBMaW5rIE9iamVjdCAgICAgICBcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAndXBkYXRlQXR0cicsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gdXBkYXRlQXR0cihkM3BhdGgsIGQpIHtcblx0XHRcdFx0dmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG5cdFx0XHRcdCAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluaztcblx0XHRcdFx0dGhpcy51cGRhdGVNYXhXZWlnaHQoKTtcblx0XHRcdFx0dmFyIGNvbG9yU2NhbGUgPSBkMy5zY2FsZS5saW5lYXIoKS5kb21haW4oWzAsIHN0YXRlLm1heFdlaWdodF0pLnJhbmdlKFtcIiNmZmIzNjZcIiwgXCIjRjkyNjA2XCJdKTtcblx0XHRcdFx0c3RhdGUuY29sb3JTY2FsZSA9IGNvbG9yU2NhbGU7XG5cdFx0XHRcdGQzcGF0aC5zdHlsZSgnbWFya2VyLWVuZCcsICd1cmwoI2VuZC1hcnJvdyknKS5jbGFzc2VkKHRoaXNHcmFwaC5jb25zdHMuc2VsZWN0ZWRDbGFzcywgZnVuY3Rpb24gKGQpIHtcblx0XHRcdFx0XHRyZXR1cm4gZCA9PT0gc3RhdGUuc2VsZWN0ZWRFZGdlO1xuXHRcdFx0XHR9KS5hdHRyKFwiZFwiLCB0aGlzLmFycm93UGF0aC5jYWxsKGQpKS50cmFuc2l0aW9uKFwiZXhpc3RpbmdQYXRoVHJhbnNpdGlvblwiKS5kdXJhdGlvbig3NTApLmF0dHIoXCJzdHJva2VcIiwgZnVuY3Rpb24gKGQpIHtcblx0XHRcdFx0XHR2YXIgYyA9IGNvbG9yU2NhbGUoZC5nZXRXZWlnaHQoKSk7XG5cdFx0XHRcdFx0cmV0dXJuIGM7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIENhbGxlZCBkdXJpbmcgdGhlIGZpcnN0IHVwZGF0ZSBncmFwaCBmb3IgdGhpcyBsaW5rXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuICAgICogQHBhcmFtICAgICAge0xpbmt9ICBcdCAgIGQgICAgICAgTWF0Y2hpbmcgTGluayBPYmplY3RcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnbmV3UGF0aEF0dHInLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIG5ld1BhdGhBdHRyKGQzcGF0aCwgZCkge1xuXHRcdFx0XHR2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcblx0XHRcdFx0ICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXHRcdFx0XHR0aGlzLnVwZGF0ZU1heFdlaWdodCgpO1xuXHRcdFx0XHR2YXIgY29sb3JTY2FsZSA9IGQzLnNjYWxlLmxpbmVhcigpLmRvbWFpbihbMCwgc3RhdGUubWF4V2VpZ2h0XSkucmFuZ2UoW1wiI2ZmYjM2NlwiLCBcIiNGOTI2MDZcIl0pO1xuXG5cdFx0XHRcdGQzcGF0aC50cmFuc2l0aW9uKFwibmV3UGF0aFRyYW5zaXRpb25cIikuZHVyYXRpb24oNzUwKS5hdHRyVHdlZW4oXCJvcGFjaXR5XCIsIGZ1bmN0aW9uIChkKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGQzLmludGVycG9sYXRlU3RyaW5nKDAsIDEpO1xuXHRcdFx0XHR9KS5hdHRyKFwic3Ryb2tlXCIsIGZ1bmN0aW9uIChkKSB7XG5cdFx0XHRcdFx0dmFyIGMgPSBjb2xvclNjYWxlKGQuZ2V0V2VpZ2h0KCkpO1xuXHRcdFx0XHRcdHJldHVybiBjO1xuXHRcdFx0XHR9KS5hdHRyKCdkJywgdGhpcy5hcnJvd1BhdGguY2FsbChkKSk7XG5cdFx0XHR9XG5cdFx0fV0pO1xuXG5cdFx0cmV0dXJuIFZpc3VhbGl6ZXJMaW5rO1xuXHR9KExpbmsuTGluayk7XG5cblx0cmV0dXJuIHtcblx0XHRMaW5rOiBWaXN1YWxpemVyTGlua1xuXHR9O1xufV0pO1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4vKipcbiAqIFRoZSBiYXNlIGNsYXNzIGZvciBub2RlIG9iamVjdHMgZm9yIHRoZSBncmFwaC5cbiAqIFN1cHBvcnRzIHBvbGljaWVzLlxuICogXG4gKiBUbyB3cml0ZSB5b3VyIG93biBOb2RlIG9iamVjdCwgY3JlYXRlIGEgbmV3IGZhY3RvcnkgdGhhdCB1c2VzIHRoZSBub2RlXG4gKiB5b3Ugd2FudCB0byBpbmhlcml0IGFzIGEgZGVwZW5kZW5jeSwgYW5kIGV4dGVuZCBpdHMgbm9kZSBjbGFzcy4gXG4gKiBSZXR1cm4gdGhlIGNsYXNzIG9iamVjdCB3aXRoIE5vZGUgYXMga2V5XG4gKiBcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ05vZGUnLCBbZnVuY3Rpb24gKCkge1xuXHR2YXIgTm9kZSA9IGZ1bmN0aW9uICgpIHtcblx0XHQvKipcbiAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgKlxuICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeCAgICAgICB4IGxvY2F0aW9uXG4gICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB5ICAgICAgIHkgbG9jYXRpb25cbiAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGlkICAgICAgVGhlIGlkZW50aWZpZXJcbiAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHRleHQgICAgVGhlIHRleHQgdG8gZGlzcGxheVxuICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgcmFkaXVzICBUaGUgcmFkaXVzIG9mIHRoZSBub2RlXG4gICAqL1xuXHRcdGZ1bmN0aW9uIE5vZGUoeCwgeSwgaWQsIHRleHQsIHJhZGl1cykge1xuXHRcdFx0X2NsYXNzQ2FsbENoZWNrKHRoaXMsIE5vZGUpO1xuXG5cdFx0XHR0aGlzLnggPSB4O1xuXHRcdFx0dGhpcy55ID0geTtcblx0XHRcdHRoaXMucmFkaXVzID0gcmFkaXVzO1xuXHRcdFx0dGhpcy5pZCA9IGlkO1xuXHRcdFx0dGhpcy50ZXh0ID0gdGV4dDtcblx0XHRcdHRoaXMucmFkaXVzID0gcmFkaXVzO1xuXHRcdFx0dGhpcy5oYXNQb2xpY3kgPSBmYWxzZTtcblx0XHRcdHRoaXMucG9saWN5ID0gbnVsbDtcblx0XHRcdHRoaXMubm9kZVBvbGljaWVzID0gW107XG5cdFx0XHR0aGlzLmdyYXBoID0gbnVsbDtcblx0XHRcdHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcblx0XHR9XG5cblx0XHQvKipcbiAgICogQ2FsbGVkIHdoZW4gYSBub2RlIGlzIGFkZGVkIHRvIHRoZSBncmFwaFxuICAgKlxuICAgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaCBpdCBpcyBhZGRlZCB0b1xuICAgKi9cblxuXG5cdFx0X2NyZWF0ZUNsYXNzKE5vZGUsIFt7XG5cdFx0XHRrZXk6ICdpbml0aWFsaXplJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBpbml0aWFsaXplKGdyYXBoKSB7XG5cdFx0XHRcdGlmICh0aGlzLmluaXRpYWxpemVkID09IGZhbHNlKSB7XG5cdFx0XHRcdFx0dGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG5cdFx0XHRcdFx0dGhpcy5ncmFwaCA9IGdyYXBoO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogQ2FsbGVkIGR1cmluZyB0aGUgdXBkYXRlIGdyYXBoIGZvciBleGlzdGluZyBsaW5rc1xuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAndXBkYXRlQXR0cicsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gdXBkYXRlQXR0cihkM25vZGUsIGQpIHtcblx0XHRcdFx0ZDNub2RlLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZnVuY3Rpb24gKGQpIHtcblx0XHRcdFx0XHRyZXR1cm4gXCJ0cmFuc2xhdGUoXCIgKyBkLnggKyBcIixcIiArIGQueSArIFwiKVwiO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBDYWxsZWQgZHVyaW5nIHRoZSBmaXJzdCB1cGRhdGUgZ3JhcGggZm9yIGEgbm9kZVxuICAgICogSG9vayBmb3Igc3ViIGNsYXNzZXNcbiAgICAqIFxuICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgZCAgICAgICBNYXRjaGluZyBOb2RlIE9iamVjdFxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICduZXdOb2RlQXR0cicsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gbmV3Tm9kZUF0dHIoZDNub2RlLCBkKSB7fVxuXG5cdFx0XHQvKipcbiAgICAqIFNldHMgdGhlIHJhZGl1cyBvZiB0aGUgbm9kZS5cbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgcmFkaXVzICBUaGUgcmFkaXVzXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3NldFJhZGl1cycsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gc2V0UmFkaXVzKHJhZGl1cykge1xuXHRcdFx0XHR0aGlzLnJhZGl1cyA9IHJhZGl1cztcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBVc2VkIHRvIGluc3RhbGwgcG9saWNpZXMgdGhhdCBhcmUgY2FsbGVkIHdoZW4gdGhpc1xuICAgICogbm9kZSBoYXMgYSBtb3VzZSBldmVudFxuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3kgIFRoZSBwb2xpY3kgdG8gaW5zdGFsbFxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdpbnN0YWxsTm9kZVBvbGljeScsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gaW5zdGFsbE5vZGVQb2xpY3kocG9saWN5KSB7XG5cdFx0XHRcdHRoaXMuaGFzUG9saWN5ID0gdHJ1ZTtcblx0XHRcdFx0dGhpcy5ub2RlUG9saWNpZXMucHVzaChwb2xpY3kpO1xuXHRcdFx0XHRwb2xpY3kuaW5pdGlhbGl6ZSh0aGlzLmdyYXBoKTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBVc2VkIHRvIHVuaW5zdGFsbCBwb2xpY3kgZm9yIHRoaXMgbm9kZVxuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l8c3RyaW5nfSAgcG9saWN5UmVtb3ZlICBUaGUgcG9saWN5IHRvIHJlbW92ZVxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICd1bmluc3RhbGxOb2RlUG9saWN5Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiB1bmluc3RhbGxOb2RlUG9saWN5KHBvbGljeVJlbW92ZSkge1xuXHRcdFx0XHR2YXIgcG9saWN5UmVtb3ZlTmFtZTtcblx0XHRcdFx0dmFyIHRoaXNOb2RlID0gdGhpcztcblx0XHRcdFx0aWYgKHR5cGVvZiBwb2xpY3lSZW1vdmUgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0cG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlLnBvbGljeU5hbWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0Xyh0aGlzTm9kZS5ub2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24gKHBvbGljeSwgaW5kZXgpIHtcblx0XHRcdFx0XHRpZiAocG9saWN5LnBvbGljeU5hbWUgPT09IHBvbGljeVJlbW92ZU5hbWUpIHtcblx0XHRcdFx0XHRcdHBvbGljeS5kZXN0cm95KCk7XG5cdFx0XHRcdFx0XHR0aGlzTm9kZS5ub2RlUG9saWNpZXMuc3BsaWNlKGluZGV4LCAxKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRpZiAodGhpc05vZGUubm9kZVBvbGljaWVzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0XHRcdHRoaXNOb2RlLmhhc1BvbGljeSA9IGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogQ2FsbGVkIHdoZW4gdGhlcmUgaXMgYSBtb3VzZSBldmVudCBmb3IgdGhpcyBub2RlXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGV2ZW50ICAgICBUaGUgbW91c2UgZXZlbnRcbiAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBkICAgICAgICAgVGhlIG1hdGNoaW5nIG5vZGUgb2JqZWN0XG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ25vZGVQb2xpY3lFdmVudCcsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gbm9kZVBvbGljeUV2ZW50KGV2ZW50LCBkM25vZGUsIGQpIHtcblx0XHRcdFx0Xy5mb3JFYWNoKHRoaXMubm9kZVBvbGljaWVzLCBmdW5jdGlvbiAocG9saWN5KSB7XG5cdFx0XHRcdFx0cG9saWN5W2V2ZW50XShkM25vZGUsIGQpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XSk7XG5cblx0XHRyZXR1cm4gTm9kZTtcblx0fSgpO1xuXG5cdHJldHVybiB7XG5cdFx0Tm9kZTogTm9kZVxuXHR9O1xufV0pO1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbi8qKlxuICogVGhlIG5vZGUgdGhhdCBpcyB1c2VkIHNwZWNpZmljYWxseSBmb3IgdGhlIHZpc3VhbGl6YXRpb24gdGFiLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnVmlzdWFsaXplck5vZGUnLCBbJ05vZGUnLCBmdW5jdGlvbiAoTm9kZSkge1xuXHR2YXIgVmlzdWFsaXplck5vZGUgPSBmdW5jdGlvbiAoX05vZGUkTm9kZSkge1xuXHRcdF9pbmhlcml0cyhWaXN1YWxpemVyTm9kZSwgX05vZGUkTm9kZSk7XG5cblx0XHQvKipcbiAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgKlxuICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeCAgICAgICBcdHggbG9jYXRpb25cbiAgICogQHBhcmFtICAgICAge251bWJlcn0gIHkgICAgICAgXHR5IGxvY2F0aW9uXG4gICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBpZCAgICAgIFx0VGhlIGlkZW50aWZpZXJcbiAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHRleHQgICAgXHRUaGUgdGV4dCB0byBkaXNwbGF5XG4gICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICByYWRpdXMgIFx0VGhlIHJhZGl1cyBvZiB0aGUgbm9kZVxuICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgcGFyZW50ICAgICBUaGUgcGFyZW50IGlkXG4gICAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBhbmNlc3RvcnMgIEFycmF5IG9mIGFuY2VzdG9ycyBJZFxuICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeFN0YXJ0ICAgICB4IGxvYyB0byBzdGFydCBhbmltYXRpb25cbiAgICogQHBhcmFtICAgICAge251bWJlcn0gIHlTdGFydCAgICAgeSBsb2MgdG8gc3RhcnQgYW5pbWF0aW9uXG4gICAqL1xuXHRcdGZ1bmN0aW9uIFZpc3VhbGl6ZXJOb2RlKHgsIHksIGlkLCB0ZXh0LCByYWRpdXMsIHBhcmVudCwgYW5jZXN0b3JzLCB4U3RhcnQsIHlTdGFydCkge1xuXHRcdFx0X2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZpc3VhbGl6ZXJOb2RlKTtcblxuXHRcdFx0dmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKFZpc3VhbGl6ZXJOb2RlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoVmlzdWFsaXplck5vZGUpKS5jYWxsKHRoaXMsIHgsIHksIGlkLCB0ZXh0LCByYWRpdXMpKTtcblxuXHRcdFx0X3RoaXMucGFyZW50ID0gcGFyZW50O1xuXHRcdFx0X3RoaXMuYW5jZXN0b3JzID0gYW5jZXN0b3JzO1xuXHRcdFx0aWYgKHhTdGFydCA9PSBudWxsKSB7XG5cdFx0XHRcdF90aGlzLnhTdGFydCA9IHg7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRfdGhpcy54U3RhcnQgPSB4U3RhcnQ7XG5cdFx0XHR9XG5cdFx0XHRpZiAoeVN0YXJ0ID09IG51bGwpIHtcblx0XHRcdFx0X3RoaXMueVN0YXJ0ID0geTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdF90aGlzLnlTdGFydCA9IHlTdGFydDtcblx0XHRcdH1cblx0XHRcdHJldHVybiBfdGhpcztcblx0XHR9XG5cblx0XHQvKipcbiAgICogQ2FsbGVkIGR1cmluZyB0aGUgZmlyc3QgdXBkYXRlIGdyYXBoIGZvciBhIG5vZGVcbiAgICpcbiAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gICAgZCAgICAgICAgIFRoZSBtYXRjaGluZyBOb2RlXG4gICAqL1xuXG5cblx0XHRfY3JlYXRlQ2xhc3MoVmlzdWFsaXplck5vZGUsIFt7XG5cdFx0XHRrZXk6ICduZXdOb2RlQXR0cicsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gbmV3Tm9kZUF0dHIoZDNub2RlLCBkKSB7XG5cdFx0XHRcdHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoO1xuXHRcdFx0XHRpZiAodGhpc0dyYXBoLmNvbnN0cy5jb250YWluZXJDbGFzcyAhPSBudWxsICYmIHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFtkLmlkXSA9PSBudWxsKSB7XG5cdFx0XHRcdFx0ZDNub2RlLmNsYXNzZWQodGhpc0dyYXBoLmNvbnN0cy5jb250YWluZXJDbGFzcywgdHJ1ZSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0ZDNub2RlLnRyYW5zaXRpb24oXCJub2RlUG9zaXRpb25UcmFuc2l0aW9uXCIpLmR1cmF0aW9uKDc1MCkuYXR0clR3ZWVuKFwidHJhbnNmb3JtXCIsIGZ1bmN0aW9uIChkKSB7XG5cdFx0XHRcdFx0aWYgKGQueFN0YXJ0ICE9IG51bGwgJiYgZC55U3RhcnQgIT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0dmFyIHhTdGFydCA9IGQueFN0YXJ0O1xuXHRcdFx0XHRcdFx0dmFyIHlTdGFydCA9IGQueVN0YXJ0O1xuXHRcdFx0XHRcdFx0ZC54U3RhcnQgPSBkLng7XG5cdFx0XHRcdFx0XHRkLnlTdGFydCA9IGQueTtcblx0XHRcdFx0XHRcdHJldHVybiBkMy5pbnRlcnBvbGF0ZVN0cmluZyhcInRyYW5zbGF0ZShcIiArIHhTdGFydCArIFwiLFwiICsgeVN0YXJ0ICsgXCIpXCIsIFwidHJhbnNsYXRlKFwiICsgZC54ICsgXCIsXCIgKyBkLnkgKyBcIilcIik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiBkMy5pbnRlcnBvbGF0ZVN0cmluZyhcInRyYW5zbGF0ZShcIiArIGQueCArIFwiLFwiICsgZC55ICsgXCIpXCIsIFwidHJhbnNsYXRlKFwiICsgZC54ICsgXCIsXCIgKyBkLnkgKyBcIilcIik7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1dKTtcblxuXHRcdHJldHVybiBWaXN1YWxpemVyTm9kZTtcblx0fShOb2RlLk5vZGUpO1xuXG5cdHJldHVybiB7XG5cdFx0Tm9kZTogVmlzdWFsaXplck5vZGVcblx0fTtcbn1dKTtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxudmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQob2JqZWN0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IHJldHVybiBnZXQocGFyZW50LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpOyB9IH0gZWxzZSBpZiAoXCJ2YWx1ZVwiIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9O1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbi8qKlxuICogVGhpcyBwb2xpY3kgaXMgdXNlZCB0byBhZGQgYSBzZWxlY3Qgbm9kZSBmZWF0dXJlLlxuICogU3VwcG9ydHMgc2VsZWN0aW5nIG11bHRpcGxlIG5vZGVzIGJ5IHVzaW5nIHRoZSBjdHJsIGtleS5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ05vZGVTZWxlY3Rpb25Qb2xpY3knLCBbJ1BvbGljeScsIGZ1bmN0aW9uIChQb2xpY3kpIHtcbiAgICB2YXIgTm9kZVNlbGVjdGlvblBvbGljeSA9IGZ1bmN0aW9uIChfUG9saWN5JFBvbGljeSkge1xuICAgICAgICBfaW5oZXJpdHMoTm9kZVNlbGVjdGlvblBvbGljeSwgX1BvbGljeSRQb2xpY3kpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBOb2RlU2VsZWN0aW9uUG9saWN5KCkge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE5vZGVTZWxlY3Rpb25Qb2xpY3kpO1xuXG4gICAgICAgICAgICByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKE5vZGVTZWxlY3Rpb25Qb2xpY3kuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihOb2RlU2VsZWN0aW9uUG9saWN5KSkuY2FsbCh0aGlzLCBcIk5vZGVTZWxlY3Rpb25Qb2xpY3lcIikpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENhbGxlZCB3aGVuIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICogT3ZlcndyaXRlcyB0aGUgb24gZHJhZyBldmVudCBvZiB0aGUgZ3JhcGhcbiAgICAgICAgICogXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoIGl0IGlzIFxuICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFsbGVkIG9uXG4gICAgICAgICovXG5cblxuICAgICAgICBfY3JlYXRlQ2xhc3MoTm9kZVNlbGVjdGlvblBvbGljeSwgW3tcbiAgICAgICAgICAgIGtleTogJ2luaXRpYWxpemUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemUoZ3JhcGgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF9nZXQoTm9kZVNlbGVjdGlvblBvbGljeS5wcm90b3R5cGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihOb2RlU2VsZWN0aW9uUG9saWN5LnByb3RvdHlwZSksICdpbml0aWFsaXplJywgdGhpcykuY2FsbCh0aGlzLCBncmFwaCk7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLnNlbGVjdGVkTm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgY29uc3RzID0gZ3JhcGguY29uc3RzLk5vZGVTZWxlY3Rpb25Qb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICBjb25zdHMuc2VsZWN0ZWRDbGFzcyA9IFwic2VsZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAvL292ZXJ3cml0dGluZyBncmFwaCdzIG5vZGUgb24gZHJhZyBldmVudCB0byBzdXBwb3J0XG4gICAgICAgICAgICAgICAgLy9tb3ZpbmcgbXVsdGlwbGUgbm9kZXMgYXQgb25jZVxuICAgICAgICAgICAgICAgIHZhciBkcmFnID0gZ3JhcGguZHJhZztcbiAgICAgICAgICAgICAgICBkcmFnLm9uKCdkcmFnJywgZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IGdyYXBoO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZWxlY3RlZENsYXNzID0gdGhpc0dyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5LnNlbGVjdGVkQ2xhc3M7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0aW9uID0gZDMuc2VsZWN0QWxsKCcuJyArIHNlbGVjdGVkQ2xhc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0aW9uWzBdLmluZGV4T2YodGhpcykgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb24uY2xhc3NlZChzZWxlY3RlZENsYXNzLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uID0gZDMuc2VsZWN0KHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGlvbi5jbGFzc2VkKHNlbGVjdGVkQ2xhc3MsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb24uYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbiAoZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCArPSBkMy5ldmVudC5keDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gZDMuZXZlbnQuZHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwidHJhbnNsYXRlKFwiICsgW2QueCwgZC55XSArIFwiKVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEFkZHMgdGhlIGdpdmVuIG5vZGUgdG8gdGhlIGFycmF5IG9mIHNlbGVjdGVkIG5vZGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNOb2RlICAgIFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gICAgICBub2RlRGF0YSAgTWF0Y2hpbmcgTm9kZSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2FkZFNlbGVjdE5vZGUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZFNlbGVjdE5vZGUoZDNOb2RlLCBub2RlRGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzLk5vZGVTZWxlY3Rpb25Qb2xpY3k7XG5cbiAgICAgICAgICAgICAgICBkM05vZGUuY2xhc3NlZChjb25zdHMuc2VsZWN0ZWRDbGFzcywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgc3RhdGUuc2VsZWN0ZWROb2Rlcy5wdXNoKG5vZGVEYXRhKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmVzIHRoZSBnaXZlbiBub2RlIGZyb20gdGhlIGFycmF5IG9mIHNlbGVjdGVkIG5vZGVzLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzTm9kZSAgICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgbm9kZURhdGEgIE1hdGNoaW5nIG5vZGUgb2JqZWN0IFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAncmVtb3ZlU2VsZWN0RnJvbU5vZGUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZVNlbGVjdEZyb21Ob2RlKGQzTm9kZSwgbm9kZURhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZmlsdGVyKGZ1bmN0aW9uIChjZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2QuaWQgPT09IG5vZGVEYXRhLmlkO1xuICAgICAgICAgICAgICAgIH0pLmNsYXNzZWQoY29uc3RzLnNlbGVjdGVkQ2xhc3MsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBzdGF0ZS5zZWxlY3RlZE5vZGVzLmluZGV4T2Yobm9kZURhdGEpO1xuICAgICAgICAgICAgICAgIHN0YXRlLnNlbGVjdGVkTm9kZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmVzIGFsbCBzZWxlY3RlZCBub2Rlcy5cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3JlbW92ZUFsbFNlbGVjdGVkTm9kZXMnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZUFsbFNlbGVjdGVkTm9kZXMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmNsYXNzZWQoY29uc3RzLnNlbGVjdGVkQ2xhc3MsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zZWxlY3RlZE5vZGVzID0gW107XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogT24gTW91c2Vkb3duLCBkZXRlcm1pbmVzIHdoZXRoZXIgdG8gY2hhbmdlIHRoZVxuICAgICAgICAgICAgICogc2VsZWN0ZWQgc3RhdHVzIG9mIHRoZSBjbGlja2VkIG5vZGUuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgZCAgICAgICBNYXRjaGluZyBOb2RlIE9iamVjdCAgICAgICBcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ21vdXNlZG93bicsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbW91c2Vkb3duKGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuICAgICAgICAgICAgICAgIGQzLmV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIGlmIChkMy5ldmVudC5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5zZWxlY3RlZE5vZGVzLmluZGV4T2YoZCkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVTZWxlY3RGcm9tTm9kZShkM25vZGUsIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRTZWxlY3ROb2RlKGQzbm9kZSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHN0YXRlLnNlbGVjdGVkTm9kZXMuaW5kZXhPZihkKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIG5vIGNvbnRyb2wga2V5LCBhbmQgY2xpY2tlZCBub3Qgc2VsZWN0ZWQgbm9kZSxcbiAgICAgICAgICAgICAgICAgICAgLy9yZW1vdmUgYWxsIG9mIGN1cnJlbnQgc2VsZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQWxsU2VsZWN0ZWROb2RlcygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBPbiBNb3VzZXVwLCBkZXRlcm1pbmVzIHdoZXRoZXIgdG8gY2hhbmdlIHRoZVxuICAgICAgICAgICAgICogc2VsZWN0ZWQgc3RhdHVzIG9mIHRoZSBjbGlja2VkIG5vZGUuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgZCAgICAgICBNYXRjaGluZyBOb2RlIE9iamVjdFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnbW91c2V1cCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbW91c2V1cChkM25vZGUsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeTtcbiAgICAgICAgICAgICAgICBpZiAoIWQzLmV2ZW50LmN0cmxLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9pZiBsZW5ndGggaXMgZ3JlYXRlciB0aGFuIDEsIHRoZW4gd2UgYXJlIG1vdmluZyBtdWx0aXBsZSBub2Rlc1xuICAgICAgICAgICAgICAgICAgICAvL2xlYXZlIHRoZW0gYWxsIGhpZ2hsaWdodGVkXG4gICAgICAgICAgICAgICAgICAgIC8vb3RoZXJ3aXNlIHdlIGFyZSBqdXN0IG1vdmluZyBvbmUgbm9kZSwgc28gdW5oaWdobGlnaHRcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLnNlbGVjdGVkTm9kZXMubGVuZ3RoIDw9IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlU2VsZWN0RnJvbU5vZGUoZDNub2RlLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfV0pO1xuXG4gICAgICAgIHJldHVybiBOb2RlU2VsZWN0aW9uUG9saWN5O1xuICAgIH0oUG9saWN5LlBvbGljeSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBQb2xpY3k6IE5vZGVTZWxlY3Rpb25Qb2xpY3lcbiAgICB9O1xufV0pO1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbi8qKlxuICogVGhpcyBwb2xpY3kgY2hhbmdlcyB0aGUgdmlldyB0byB0aGUgdGltZWdyYXBoIG9mIGxpbmsgZGF0YSBvbiBjbGljay5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ1BhdGhDaGFuZ2VWaWV3UG9saWN5JywgWydQb2xpY3knLCBmdW5jdGlvbiAoUG9saWN5KSB7XG4gICAgdmFyIFBhdGhDaGFuZ2VWaWV3UG9saWN5ID0gZnVuY3Rpb24gKF9Qb2xpY3kkUG9saWN5KSB7XG4gICAgICAgIF9pbmhlcml0cyhQYXRoQ2hhbmdlVmlld1BvbGljeSwgX1BvbGljeSRQb2xpY3kpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYWxsZWQgdG8gYnVpbGQgcG9saWN5XG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgIHtBbmd1bGFyIFN0YXRlfSAgICAkc3RhdGUgICAgVXNlZCB0byBjaGFuZ2Ugdmlld1xuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gUGF0aENoYW5nZVZpZXdQb2xpY3koJHN0YXRlKSB7XG4gICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUGF0aENoYW5nZVZpZXdQb2xpY3kpO1xuXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoUGF0aENoYW5nZVZpZXdQb2xpY3kuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihQYXRoQ2hhbmdlVmlld1BvbGljeSkpLmNhbGwodGhpcywgJ1BhdGhDaGFuZ2VWaWV3UG9saWN5JykpO1xuXG4gICAgICAgICAgICBfdGhpcy4kc3RhdGUgPSAkc3RhdGU7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogR2VuZXJhdGVzIGEgbGlzdCBvZiBhbGwgY2hpbGQgY29udGFpbmVycyBvZiB0aGUgc2VydmljZVxuICAgICAgICAgKiBDYW4gaGFuZGxlIG5lc3RlZCBzZXJ2aWNlcy5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGlkICAgICAgTm9kZSBJRFxuICAgICAgICAgKi9cblxuXG4gICAgICAgIF9jcmVhdGVDbGFzcyhQYXRoQ2hhbmdlVmlld1BvbGljeSwgW3tcbiAgICAgICAgICAgIGtleTogJ2dlbmVyYXRlTGlzdCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2VuZXJhdGVMaXN0KGlkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciByZXRMaXN0ID0gW107XG4gICAgICAgICAgICAgICAgdmFyIGdlbmVyYXRlTGlzdEhlbHBlciA9IGZ1bmN0aW9uIGdlbmVyYXRlTGlzdEhlbHBlcihpZCwgcmV0TGlzdCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZUlkcyA9IHRoaXNQb2xpY3kuZ3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbaWRdO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVJZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZElkID0gbm9kZUlkc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzUG9saWN5LmdyYXBoLmRhdGFTb3VyY2UuaGFzQ2hpbGQoY2hpbGRJZCkgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUmV0TGlzdCA9IGdlbmVyYXRlTGlzdEhlbHBlcihjaGlsZElkLCByZXRMaXN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXRMaXN0LmNvbmNhdChzdWJSZXRMaXN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0TGlzdC5wdXNoKGNoaWxkSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBnZW5lcmF0ZUxpc3RIZWxwZXIoaWQsIHJldExpc3QpO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXRMaXN0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVzZWQgdG8gcmVyb3V0ZSBhbiBlZGdlIHdoZW4gY2xpY2tlZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtMaW5rfSAgZWRnZSAgICBUaGUgY2xpY2tlZCBlZGdlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd2aWV3RWRnZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmlld0VkZ2UoZWRnZSkge1xuICAgICAgICAgICAgICAgIHZhciBzb3VyY2VMaXN0ID0gW107XG4gICAgICAgICAgICAgICAgdmFyIHRhcmdldExpc3QgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgc291cmNlSWQgPSBlZGdlLnNvdXJjZS5pZDtcbiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0SWQgPSBlZGdlLnRhcmdldC5pZDtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmdyYXBoLmRhdGFTb3VyY2UuaGFzQ2hpbGQoc291cmNlSWQpID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vTm90IGEgY29udGFpbmVyIG5vZGUsIG5lZWQgdG8gYWdncmVnYXRlXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZUxpc3QgPSB0aGlzLmdlbmVyYXRlTGlzdChzb3VyY2VJZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlTGlzdCA9IFtzb3VyY2VJZF07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZ3JhcGguZGF0YVNvdXJjZS5oYXNDaGlsZCh0YXJnZXRJZCkgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9Ob3QgYSBjb250YWluZXIgbm9kZSwgbmVlZCB0byBhZ2dyZWdhdGVcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TGlzdCA9IHRoaXMuZ2VuZXJhdGVMaXN0KHRhcmdldElkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRMaXN0ID0gW3RhcmdldElkXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy4kc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZpc3VhbGl6YXRpb24uZWRnZScsIHsgc291cmNlTmFtZTogc291cmNlSWQsIHRhcmdldE5hbWU6IHRhcmdldElkLFxuICAgICAgICAgICAgICAgICAgICBzb3VyY2VMaXN0OiBzb3VyY2VMaXN0LCB0YXJnZXRMaXN0OiB0YXJnZXRMaXN0IH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdtb3VzZWRvd24nLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdXNlZG93bihkM3BhdGgsIGQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdFZGdlKGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIFBhdGhDaGFuZ2VWaWV3UG9saWN5O1xuICAgIH0oUG9saWN5LlBvbGljeSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBQb2xpY3k6IFBhdGhDaGFuZ2VWaWV3UG9saWN5XG4gICAgfTtcbn1dKTtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLyoqXG4gKiBCYXNlIHBvbGljeSBjbGFzcyBmb3IgdGhlIGdyYXBoIG9iamVjdFxuICogXG4gKiBQb2xpY2llcyBhcmUgdXNlZCB0byBpc29sYXRlIGZlYXR1cmVzIGZvciBhIGdyYXBoLlxuICogUG9saWNpZXMgY2FuIGJlIGluc3RhbGxlZCBvbiBub2RlcywgbGlua3MsIG9yIHRoZSBncmFwaC5cbiAqIEVhY2ggcG9saWN5IGhhcyBpbnRlcmFjdGlvbiBoYW5kbGVycyB0aGF0IHdpbGwgYmUgY2FsbGVkIGJ5IHRoZSBncmFwaFxuICogaWYgaW5zdGFsbGVkLiBQb2xpY2llcyBjYW4gYWxzbyBtb2RpZnkgZ3JhcGggZnVuY3Rpb25zIChzZWUgUVRpcFBvbGljeSkuXG4gKiBNdWx0aXBsZSBwb2xpY2llcyBjYW4gYmUgaW5zdGFsbGVkIGZvciBhIG5vZGUgb3IgbGluay4gXG4gKiBcbiAqIFRvIHdyaXRlIHlvdXIgb3duIHBvbGljeSwgY3JlYXRlIGEgbmV3IGZhY3RvcnkgdGhhdCB1c2VzIHRoZSBwb2xpY3lcbiAqIHlvdSB3YW50IHRvIGluaGVyaXQgYXMgYSBkZXBlbmRlbmN5LCBhbmQgZXh0ZW5kIGl0cyBwb2xpY3kuIFxuICogUmV0dXJuIHRoZSBjbGFzcyBvYmplY3Qgd2l0aCBQb2xpY3kgYXMga2V5LCBhbmQgXG4gKiBhZGQgdGhlIHBvbGljeSB0byB0aGUgUG9saWN5U2VydmljZSBmYWN0b3J5LlxuICogXG4gKiBGb3Igc2F2aW5nIHN0YXRlIG9yIGNvbnN0cyBmb3IgdGhlIHBvbGljeSwgY3JlYXRlIGEgbmFtZXNwYWNlXG4gKiBpbiBncmFwaC5zdGF0ZSBhbmQgZ3JhcGguY29uc3RzLlxuICogRXguIFxuICogICAgICBncmFwaC5zdGF0ZS5teVBvbGljeSA9IHt9O1xuICogICAgICBncmFwaC5jb25zdHMubXlQb2xpY3kgPSB7fTtcbiAqICAgICAgXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdQb2xpY3knLCBbZnVuY3Rpb24gKCkge1xuICB2YXIgUG9saWN5ID0gZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBwb2xpY3lOYW1lICBUaGUgcG9saWN5IG5hbWVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBQb2xpY3kocG9saWN5TmFtZSkge1xuICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFBvbGljeSk7XG5cbiAgICAgIHRoaXMucG9saWN5TmFtZSA9IHBvbGljeU5hbWU7XG4gICAgICB0aGlzLmdyYXBoID0gbnVsbDtcbiAgICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgd2hlbiB0aGUgcG9saWN5IGlzIGluc3RhbGxlZC5cbiAgICAgKiBcbiAgICAgKiBAcGFyYW0gIHtHcmFwaH0gIGdyYXBoICAgVGhlIEdyYXBoIHRoYXQgdGhlIHBvbGljeSBpc1xuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICBiZWluZyBpbnN0YWxsZWQgb25cbiAgICAgKi9cblxuXG4gICAgX2NyZWF0ZUNsYXNzKFBvbGljeSwgW3tcbiAgICAgIGtleTogJ2luaXRpYWxpemUnLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemUoZ3JhcGgpIHtcbiAgICAgICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgIHRoaXMuZ3JhcGggPSBncmFwaDtcbiAgICAgIH1cblxuICAgICAgLyoqXG4gICAgICAgKiBIYW5kbGVyLCBtZWFudCB0byBiZSBvdmVycmlkZGVuIGluIHN1YmNsYXNzZXNcbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0gIHtkMyBvYmplY3R9ICAgIGQzb2JqICAgIFRoZSBkM29iamVjdFxuICAgICAgICogQHBhcmFtICB7Tm9kZS9MaW5rL0dyYXBofSAgZCAgIFRoZSBvYmplY3QgaXQgd2FzXG4gICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFsbGVkIGZvci4gICAgXG4gICAgICAgKi9cblxuICAgIH0sIHtcbiAgICAgIGtleTogJ21vdXNlb3ZlcicsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gbW91c2VvdmVyKGQzb2JqLCBkKSB7fVxuICAgIH0sIHtcbiAgICAgIGtleTogJ2RibGNsaWNrJyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBkYmxjbGljayhkM29iaiwgZCkge31cbiAgICB9LCB7XG4gICAgICBrZXk6ICdjb250ZXh0bWVudScsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gY29udGV4dG1lbnUoZDNvYmosIGQpIHt9XG4gICAgfSwge1xuICAgICAga2V5OiAnbW91c2VvdXQnLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdXNlb3V0KGQzb2JqLCBkKSB7fVxuICAgIH0sIHtcbiAgICAgIGtleTogJ21vdXNlZG93bicsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gbW91c2Vkb3duKGQzb2JqLCBkKSB7fVxuICAgIH0sIHtcbiAgICAgIGtleTogJ21vdXNldXAnLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdXNldXAoZDNvYmosIGQpIHt9XG5cbiAgICAgIC8qKlxuICAgICAgICogV2lsbCBiZSBjYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgYmVpbmcgZGVzdHJveWVkLlxuICAgICAgICogVXNlZCB0byByZW1vdmUgYW55IGVsZW1lbnRzIG9yIGJpbmRpbmdzIHRoZSBwb2xpY3lcbiAgICAgICAqIGhhcyBhZGRlZC5cbiAgICAgICAqL1xuXG4gICAgfSwge1xuICAgICAga2V5OiAnZGVzdHJveScsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHt9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIFBvbGljeTtcbiAgfSgpO1xuXG4gIHJldHVybiB7XG4gICAgUG9saWN5OiBQb2xpY3lcbiAgfTtcbn1dKTtcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5hcHBsaWNhdGlvbmdyb3VwcycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvYXBwbGljYXRpb25ncm91cHMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXBcbid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBDb250YWlucyBhbGwgdGhlIHBvbGljaWVzLlxuICogU2VlIHBvbGljeS5qcyBmb3IgaW5mbyBvbiBob3cgcG9saWNpZXMgd29yay5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ1BvbGljeVNlcnZpY2UnLCBbJ1BvbGljeScsICdRVGlwUG9saWN5JywgJ1BhdGhDaGFuZ2VWaWV3UG9saWN5JywgJ05vZGVTZWxlY3Rpb25Qb2xpY3knLCAnU3BsaXRKb2luTm9kZVBvbGljeScsICdTcGxpdEpvaW5WaWV3UG9saWN5JywgJ1NhdmVTdGF0ZVBvbGljeScsIGZ1bmN0aW9uIChQb2xpY3ksIFFUaXBQb2xpY3ksIFBhdGhDaGFuZ2VWaWV3UG9saWN5LCBOb2RlU2VsZWN0aW9uUG9saWN5LCBTcGxpdEpvaW5Ob2RlUG9saWN5LCBTcGxpdEpvaW5WaWV3UG9saWN5LCBTYXZlU3RhdGVQb2xpY3kpIHtcblxuICAgIHJldHVybiB7XG4gICAgICAgIFBvbGljeTogUG9saWN5LlBvbGljeSxcbiAgICAgICAgUVRpcFBvbGljeTogUVRpcFBvbGljeS5Qb2xpY3ksXG4gICAgICAgIFBhdGhDaGFuZ2VWaWV3UG9saWN5OiBQYXRoQ2hhbmdlVmlld1BvbGljeS5Qb2xpY3ksXG4gICAgICAgIE5vZGVTZWxlY3Rpb25Qb2xpY3k6IE5vZGVTZWxlY3Rpb25Qb2xpY3kuUG9saWN5LFxuICAgICAgICBTcGxpdEpvaW5Ob2RlUG9saWN5OiBTcGxpdEpvaW5Ob2RlUG9saWN5LlBvbGljeSxcbiAgICAgICAgU3BsaXRKb2luVmlld1BvbGljeTogU3BsaXRKb2luVmlld1BvbGljeS5Qb2xpY3ksXG4gICAgICAgIFNhdmVTdGF0ZVBvbGljeTogU2F2ZVN0YXRlUG9saWN5LlBvbGljeVxuICAgIH07XG59XSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZGFzaGJvYXJkJywgWydjb250aXYubW9kZWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmRhc2hib2FyZCcsIHtcbiAgICAgICAgICAgIHVybDogJy9kYXNoYm9hcmQnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnZGFzaGJvYXJkJ1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KG9iamVjdCwgcHJvcGVydHksIHJlY2VpdmVyKSB7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyByZXR1cm4gZ2V0KHBhcmVudCwgcHJvcGVydHksIHJlY2VpdmVyKTsgfSB9IGVsc2UgaWYgKFwidmFsdWVcIiBpbiBkZXNjKSB7IHJldHVybiBkZXNjLnZhbHVlOyB9IGVsc2UgeyB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7IGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7IH0gfTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG4vKipcbiAqIFRoaXMgcG9saWN5IGFkZHMgdG9vbHRpcCBmdW5jdGlvbmFsaXR5IHRvIG5vZGVzIGFuZCBsaW5rcy5cbiAqIFdoZW4gaW5zdGFsbGluZywgaW5zdGFsbCBvbiBib3RoIGxpbmtzIGFuZCBub2Rlcy5cbiAqIFxuICogVXNlcyB0aGUgcVRpcCBqUXVlcnkgcGx1Z2luXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdRVGlwUG9saWN5JywgWydQb2xpY3knLCBmdW5jdGlvbiAoUG9saWN5KSB7XG4gICAgdmFyIFFUaXBQb2xpY3kgPSBmdW5jdGlvbiAoX1BvbGljeSRQb2xpY3kpIHtcbiAgICAgICAgX2luaGVyaXRzKFFUaXBQb2xpY3ksIF9Qb2xpY3kkUG9saWN5KTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gUVRpcFBvbGljeSgpIHtcbiAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBRVGlwUG9saWN5KTtcblxuICAgICAgICAgICAgcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChRVGlwUG9saWN5Ll9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoUVRpcFBvbGljeSkpLmNhbGwodGhpcywgXCJRVGlwUG9saWN5XCIpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgcG9saWN5IGlzIGluc3RhbGxlZFxuICAgICAgICAgKiBNb2RpZmllcyB0aGUgdXBkYXRlTmV3Tm9kZXMgYW5kIFxuICAgICAgICAgKiB1cGRhdGVOZXdQYXRocyBtZXRob2Qgb2YgdGhlIGdyYXBoIHRvIGluc3RhbGwgcXRpcFxuICAgICAgICAgKiBvbnRvIGVhY2ggbm9kZSBhbmQgcGF0aC5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgXG4gICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFsbGVkIG9uXG4gICAgICAgICAqL1xuXG5cbiAgICAgICAgX2NyZWF0ZUNsYXNzKFFUaXBQb2xpY3ksIFt7XG4gICAgICAgICAgICBrZXk6ICdpbml0aWFsaXplJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0aWFsaXplKGdyYXBoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfZ2V0KFFUaXBQb2xpY3kucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoUVRpcFBvbGljeS5wcm90b3R5cGUpLCAnaW5pdGlhbGl6ZScsIHRoaXMpLmNhbGwodGhpcywgZ3JhcGgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBzdGF0ZSA9IGdyYXBoLnN0YXRlLlFUaXBQb2xpY3kgPSB7fTtcblxuICAgICAgICAgICAgICAgIHN0YXRlLm1vdXNlZG93biA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgZ3JhcGguY29uc3RzLlFUaXBQb2xpY3kgPSB7fTtcblxuICAgICAgICAgICAgICAgIC8vVHJhY2tpbmcgbW91c2UgY2xpY2sgc3RhdGUgdG8gbWFrZSB0b29sdGlwXG4gICAgICAgICAgICAgICAgLy9kaXNhcHBlYXIgaWYgdGhlIG5vZGUgaXMgYmVpbmcgZHJhZ2dlZC5cbiAgICAgICAgICAgICAgICAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLm1vdXNldXAoZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUubW91c2V1cCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy9vdmVycmlkZSB1cGRhdGVOZXdOb2RlcyBhbmQgdXBkYXRlTmV3UGF0aHNcbiAgICAgICAgICAgICAgICAvL3RvIGluc3RhbGwgcXRpcFxuICAgICAgICAgICAgICAgIHZhciBncmFwaFVwZGF0ZU5ld05vZGVzID0gZ3JhcGgudXBkYXRlTmV3Tm9kZXM7XG4gICAgICAgICAgICAgICAgZ3JhcGgudXBkYXRlTmV3Tm9kZXMgPSBmdW5jdGlvbiAobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGhVcGRhdGVOZXdOb2Rlcy5jYWxsKGdyYXBoLCBuZXdOb2Rlcyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kudXBkYXRlTmV3Tm9kZXMobmV3Tm9kZXMpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB2YXIgZ3JhcGhVcGRhdGVOZXdQYXRocyA9IGdyYXBoLnVwZGF0ZU5ld1BhdGhzO1xuICAgICAgICAgICAgICAgIGdyYXBoLnVwZGF0ZU5ld1BhdGhzID0gZnVuY3Rpb24gKG5ld1BhdGhzKSB7XG4gICAgICAgICAgICAgICAgICAgIGdyYXBoVXBkYXRlTmV3UGF0aHMuY2FsbChncmFwaCwgbmV3UGF0aHMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnVwZGF0ZU5ld1BhdGhzKG5ld1BhdGhzKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJlbW92ZXMgYWxsIHFUaXBzIGZyb20gdGhlIERPTS5cbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBwb2xpY3kgaXMgdW5pbnN0YWxsZWQgb3JcbiAgICAgICAgICAgICAqIHRoZSBncmFwaCBpcyBkZXN0cm95ZWQuXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkZXN0cm95JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICAgICAgICAgIC8vcmVtb3ZpbmcgYWxsIHF0aXAgZnJvbSBET01cbiAgICAgICAgICAgICAgICAkKCdbaWRePVwicXRpcFwiXScpLnJlbW92ZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEtlZXBpbmcgdHJhY2sgb2YgbW91c2Vkb3duIHN0YXRlXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzT2JqZWN0fSAgZDNvYmogIFRoZSBkMyBwYmplY3RcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlL0xpbmt9ICBkICAgICBUaGUgbWF0Y2hpbmcgZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ21vdXNlZG93bicsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbW91c2Vkb3duKGQzb2JqLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlFUaXBQb2xpY3k7XG4gICAgICAgICAgICAgICAgc3RhdGUubW91c2Vkb3duID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBLZWVwaW5nIHRyYWNrIG9mIG1vdXNlZG93biBzdGF0ZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM09iamVjdH0gIGQzb2JqICBUaGUgZDMgcGJqZWN0XG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZS9MaW5rfSAgZCAgICAgVGhlIG1hdGNoaW5nIGRhdGEgb2JqZWN0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdtb3VzZXVwJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtb3VzZXVwKGQzb2JqLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlFUaXBQb2xpY3k7XG4gICAgICAgICAgICAgICAgc3RhdGUubW91c2Vkb3duID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3doZW5RVGlwQXZhaWxhYmxlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB3aGVuUVRpcEF2YWlsYWJsZShjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgaW50ZXJ2YWwgPSA1MDA7IC8vIG1zXG4gICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJChkb2N1bWVudCkucXRpcCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQodGhpc1BvbGljeS53aGVuUVRpcEF2YWlsYWJsZShjYWxsYmFjayksIGludGVydmFsKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIGludGVydmFsKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiBOZXcgTm9kZXMgYXJlIGFkZGVkIGR1cmluZyB0aGVcbiAgICAgICAgICAgICAqIHVwZGF0ZSBncmFwaCBmdW5jdGlvblxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM05vZGV9ICBuZXdOb2RlcyAgVGhlIG5ldyBub2RlcyB0aGF0IGFyZVxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZWluZyBhZGRlZCB0byB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3VwZGF0ZU5ld05vZGVzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVOZXdOb2RlcyhuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5RVGlwUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gYXR0YWNoUVRpcCgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9hdHRhY2hpbmcgcXRpcFxuICAgICAgICAgICAgICAgICAgICBuZXdOb2Rlcy5lYWNoKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGhpc05vZGUgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy9JZiBub2RlIGhhcyBjaGlsZHJlbiwgdGhlbiBpdCBpcyBhIHNlcnZpY2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbZC5pZF0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSBcIjxiPjx1PlNlbGVjdG9yczo8L2I+PC91PiBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0b3JNYXAgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5zZWxlY3RvcnNbZC5pZF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhhc0tleXMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gc2VsZWN0b3JNYXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzS2V5cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0ga2V5ICsgXCIgOiA8aT5cIiArIHNlbGVjdG9yTWFwW2tleV0gKyBcIjwvaT4sXFxuIFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFzS2V5cyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb21tYSB3aWxsIGJlIHJlbW92ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IFwiTm8gU2VsZWN0b3JzLCBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSBcIjxiPjx1PkxhYmVsczo8L2I+PC91PiBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGFiZWxzTWFwID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UubGFiZWxzW2QuaWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoYXNLZXlzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGxhYmVsc01hcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNLZXlzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSBrZXkgKyBcIiA6IDxpPlwiICsgbGFiZWxzTWFwW2tleV0gKyBcIjwvaT4sXFxuIFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFzS2V5cyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb21tYSB3aWxsIGJlIHJlbW92ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IFwiTm8gbGFiZWxzLCBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3JlbW92ZSBsYXN0IGNvbW1hXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gdGV4dC5zbGljZSgwLCAtMik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpc05vZGUpLnF0aXAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGQuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRleHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93OiBmdW5jdGlvbiBzaG93KCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFwaSA9ICQodGhpc05vZGUpLnF0aXAoJ2FwaScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9ICQoJyNncmFwaENvbnRhaW5lcicpLm9mZnNldCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvc2l0aW9uID0gW29mZnNldC5sZWZ0ICsgKGQueCAqIHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCkgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKVswXSksIG9mZnNldC50b3AgKyAoZC55ICsgZC5yYWRpdXMpICogdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKSArIHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpWzFdXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwaS5zZXQoJ3Bvc2l0aW9uLnRhcmdldCcsIHBvc2l0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhc3RhdGUubW91c2Vkb3duO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGF5OiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb2xvOiAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc2VzOiAncXRpcC1ibHVlIHF0aXAtc2hhZG93J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXk6ICd0b3AgY2VudGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXQ6ICdib3R0b20gY2VudGVyJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0YXJnZXQ6IHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaWRlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50OiAnbW91c2Vkb3duIG1vdXNlbGVhdmUnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL2luY2FzZSBsaWJyYXJ5IGhhc24ndCBsb2FkZWQgeWV0XG4gICAgICAgICAgICAgICAgaWYgKCQoZG9jdW1lbnQpLnF0aXAgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGF0dGFjaFFUaXAoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLndoZW5RVGlwQXZhaWxhYmxlKGF0dGFjaFFUaXApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiBuZXcgcGF0aHMgYXJlIGFkZGVkIGR1cmluZyB0aGVcbiAgICAgICAgICAgICAqIHVwZGF0ZSBncmFwaCBmdW5jdGlvblxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM1BhdGh9ICBuZXdQYXRocyAgVGhlIG5ldyBwYXRocyB0aGF0IGFyZVxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZWluZyBhZGRlZCB0byB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3VwZGF0ZU5ld1BhdGhzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVOZXdQYXRocyhuZXdQYXRocykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5RVGlwUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgLy9pbmNhc2UgbGlicmFyeSBoYXNuJ3QgbG9hZGVkIHlldFxuICAgICAgICAgICAgICAgIGlmICgkKGRvY3VtZW50KS5xdGlwICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvL2FkZGluZyBxdGlwXG4gICAgICAgICAgICAgICAgICAgIG5ld1BhdGhzLmVhY2goZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aGlzUGF0aCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2dldHRpbmcgbWlkcG9pbnQgb2YgcGF0aFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhdGhFbCA9IGQzLnNlbGVjdCh0aGlzKS5ub2RlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWlkcG9pbnQgPSBwYXRoRWwuZ2V0UG9pbnRBdExlbmd0aChwYXRoRWwuZ2V0VG90YWxMZW5ndGgoKSAvIDIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldFJldCA9IGQucXRpcEhlbHBlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSBcIkJ5dGVzOiBcIiArIGQuZ2V0V2VpZ2h0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXNQYXRoKS5xdGlwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRleHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93OiBmdW5jdGlvbiBzaG93KCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9pZiBtb3VzZSBpcyBkb3duLCBkb24ndCBsZXQgcXRpcCBzaG93XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIXN0YXRlLm1vdXNlZG93bjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxheTogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc29sbzogJCgnI2dyYXBoQ29udGFpbmVyJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzZXM6ICdxdGlwLWJsdWUgcXRpcC1zaGFkb3cnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBteTogdGFyZ2V0UmV0Lm15LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdDogJ2NlbnRlciBjZW50ZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6ICdtb3VzZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkanVzdDogdGFyZ2V0UmV0LmFkanVzdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudDogJ21vdXNlZG93biBtb3VzZWxlYXZlJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfV0pO1xuXG4gICAgICAgIHJldHVybiBRVGlwUG9saWN5O1xuICAgIH0oUG9saWN5LlBvbGljeSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBQb2xpY3k6IFFUaXBQb2xpY3lcbiAgICB9O1xufV0pO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE5LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmxvZ2luJywgWydjb250aXYudXRpbHMnXSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuLyoqXG4gKiBUaGlzIHBvbGljeSBwcm92aWRlcyBhIHdheSBmb3IgcHJvcGVydGllcyB0byBiZSBzYXZlZCBcbiAqIGJldHdlZW4gdmlldyBjaGFuZ2VzXG4gKiBcbiAqIEl0IG1vZGlmaWVzIHRoZSBkZXN0cm95IGZ1bmN0aW9uIHRvIGFsc28gcGFzcyBpbiBhbiBvYmplY3QgdGhhdFxuICogd2lsbCBoYXZlIGFsbCBpdHMgcHJvcGVydGllcyBzYXZlZCBhbmQgd2lsbCBiZSBhdmFpbGFibGUgXG4gKiBvbiBncmFwaCBsb2FkLiBXaGVuIHNhdmluZyB2YXJpYWJsZXMgdG8gdGhlIG9iamVjdCwgbmFtZXNwYWNlIHdpdGhcbiAqIHRoZSBwb2xpY3kgbmFtZS5cbiAqIFxuICogVGhpcyBwb2xpY3kgbXVzdCBiZSBsb2FkZWQgZmlyc3QgaW4gb3JkZXIgZm9yIGl0IHNhdmVkIHZhcmlhYmxlcyBcbiAqIHRvIGJlIGxvYWRlZCB3aGVuIHRoZSB2aWV3IGNvbWVzIGJhY2sgdG8gdGhlIGdyYXBoXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdTYXZlU3RhdGVQb2xpY3knLCBbJ1BvbGljeScsIGZ1bmN0aW9uIChQb2xpY3kpIHtcbiAgICB2YXIgU2F2ZVN0YXRlUG9saWN5ID0gZnVuY3Rpb24gKF9Qb2xpY3kkUG9saWN5KSB7XG4gICAgICAgIF9pbmhlcml0cyhTYXZlU3RhdGVQb2xpY3ksIF9Qb2xpY3kkUG9saWN5KTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGFrZXMgaW4gdGhlIGFuZ3VsYXIgc2VydmljZSB0byB3aGljaCBpdCB3aWxsXG4gICAgICAgICAqIHNhdmUgaXQncyBwcm9wZXJ0aWVzIHRvLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgc2F2ZWRTdGF0ZSAgT2JqZWN0IHRvIHNhdmUgXG4gICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzIHRvXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBTYXZlU3RhdGVQb2xpY3koc2F2ZWRTdGF0ZSkge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNhdmVTdGF0ZVBvbGljeSk7XG5cbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChTYXZlU3RhdGVQb2xpY3kuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihTYXZlU3RhdGVQb2xpY3kpKS5jYWxsKHRoaXMsICdTYXZlU3RhdGVQb2xpY3knKSk7XG5cbiAgICAgICAgICAgIF90aGlzLnNhdmVkU3RhdGUgPSBzYXZlZFN0YXRlO1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAqIE1vZGlmaWVzIHRoZSBkZXN0cm95IG1ldGhvZCBcbiAgICAgICAgICogYW5kIGFkZHMgYSBsb2FkIG1ldGhvZCB0byB0aGUgZ3JhcGhcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgXG4gICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFsbGVkIG9uXG4gICAgICAgICAqL1xuXG5cbiAgICAgICAgX2NyZWF0ZUNsYXNzKFNhdmVTdGF0ZVBvbGljeSwgW3tcbiAgICAgICAgICAgIGtleTogJ2luaXRpYWxpemUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemUoZ3JhcGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmdyYXBoID0gZ3JhcGg7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgICAgICAgICAgICAgIGdyYXBoLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kuZ3JhcGhEZXN0cm95LmNhbGwoZ3JhcGgsIHRoaXNQb2xpY3kuc2F2ZWRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGdyYXBoLmxvYWQgPSBmdW5jdGlvbiAoc2F2ZWRTdGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LmdyYXBoTG9hZC5jYWxsKGdyYXBoLCBzYXZlZFN0YXRlKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgb3ZlcnJpZGUgdGhlIGdyYXBoJ3MgZGVmYXVsdCBkZXN0cm95LCB3aXRoIFxuICAgICAgICAgICAgICogdGhpcyBwb2xpY3kncyBzYXZlZFN0YXRlIHBhc3NlZCBpbi5cbiAgICAgICAgICAgICAqIENhbGxlZCB3aXRoIHRoaXMgYXMgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIHNhdmVkU3RhdGUgIFRoZSBzYXZlZCBzdGF0ZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZ3JhcGhEZXN0cm95JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBncmFwaERlc3Ryb3koc2F2ZWRTdGF0ZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3kuZGVzdHJveShzYXZlZFN0YXRlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5LmRlc3Ryb3koc2F2ZWRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHRoaXNHcmFwaC5iaW5kaW5ncykge1xuICAgICAgICAgICAgICAgICAgICAkKHdpbmRvdykub2ZmKGtleSwgdGhpc0dyYXBoLmJpbmRpbmdzW2tleV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBXaWxsIGJlIGNhbGxlZCB3aXRoIHRoZSBncmFwaCBhcyB0aGlzXG4gICAgICAgICAgICAgKiBVc2VkIHRvIGhhdmUgYWxsIG90aGVyIHBvbGljaWVzIHVzZSB0aGUgbG9hZCBzdGF0ZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBzYXZlZFN0YXRlICBUaGUgc2F2ZWQgc3RhdGVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2dyYXBoTG9hZCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ3JhcGhMb2FkKHNhdmVkU3RhdGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvbGljeS5sb2FkICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljeS5sb2FkKHNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb2xpY3kubG9hZCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2xpY3kubG9hZChzYXZlZFN0YXRlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIFNhdmVTdGF0ZVBvbGljeTtcbiAgICB9KFBvbGljeS5Qb2xpY3kpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgUG9saWN5OiBTYXZlU3RhdGVQb2xpY3lcbiAgICB9O1xufV0pO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE5LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm1lbnUnLCBbXSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KG9iamVjdCwgcHJvcGVydHksIHJlY2VpdmVyKSB7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyByZXR1cm4gZ2V0KHBhcmVudCwgcHJvcGVydHksIHJlY2VpdmVyKTsgfSB9IGVsc2UgaWYgKFwidmFsdWVcIiBpbiBkZXNjKSB7IHJldHVybiBkZXNjLnZhbHVlOyB9IGVsc2UgeyB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7IGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7IH0gfTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG4vKipcbiAqIFRoaXMgcG9saWN5IGlzIHVzZWQgZm9yIHNwbGl0dGluZyBhIG5vZGUgaW50byBpdHMgY2hpbGRyZW4sXG4gKiBhbmQgam9pbmluZyB0aGVtIGJhY2sgdG8gdGhlaXIgcGFyZW50LlxuICogU3BsaXRzIG9uIGRvdWJsZSBjbGljaywgYW5kIGpvaW5zIG9uIHJpZ2h0IGNsaWNrLlxuICogSWYgbXVsdGlwbGUgbm9kZXMgYXJlIHNlbGVjdGVkIGF0IHRoZSB0aW1lIG9mIGEgc3BsaXQgb3Igam9pbiBldmVudCxcbiAqIGl0IHdpbGwgc3BsaXQgb3Igam9pbiBhbGwgb2YgdGhlbS5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ1NwbGl0Sm9pbk5vZGVQb2xpY3knLCBbJ05vZGVTZWxlY3Rpb25Qb2xpY3knLCAnVmlzdWFsaXplck5vZGUnLCBmdW5jdGlvbiAoTm9kZVNlbGVjdGlvblBvbGljeSwgVmlzdWFsaXplck5vZGUpIHtcbiAgICB2YXIgU3BsaXRKb2luTm9kZVBvbGljeSA9IGZ1bmN0aW9uIChfTm9kZVNlbGVjdGlvblBvbGljeSQpIHtcbiAgICAgICAgX2luaGVyaXRzKFNwbGl0Sm9pbk5vZGVQb2xpY3ksIF9Ob2RlU2VsZWN0aW9uUG9saWN5JCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIFNwbGl0Sm9pbk5vZGVQb2xpY3koKSB7XG4gICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU3BsaXRKb2luTm9kZVBvbGljeSk7XG5cbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChTcGxpdEpvaW5Ob2RlUG9saWN5Ll9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoU3BsaXRKb2luTm9kZVBvbGljeSkpLmNhbGwodGhpcykpO1xuXG4gICAgICAgICAgICBfdGhpcy5wb2xpY3lOYW1lID0gXCJTcGxpdEpvaW5Ob2RlUG9saWN5XCI7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2FsbGVkIHdoZW4gcG9saWN5IGlzIGluc3RhbGxlZFxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaFxuICAgICAgICAgKi9cblxuXG4gICAgICAgIF9jcmVhdGVDbGFzcyhTcGxpdEpvaW5Ob2RlUG9saWN5LCBbe1xuICAgICAgICAgICAga2V5OiAnaW5pdGlhbGl6ZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdGlhbGl6ZShncmFwaCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgX2dldChTcGxpdEpvaW5Ob2RlUG9saWN5LnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFNwbGl0Sm9pbk5vZGVQb2xpY3kucHJvdG90eXBlKSwgJ2luaXRpYWxpemUnLCB0aGlzKS5jYWxsKHRoaXMsIGdyYXBoKTtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBncmFwaC5zdGF0ZS5TcGxpdEpvaW5Ob2RlUG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgc3RhdGUuc3BsaXROb2RlcyA9IFtdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRyaWdnZXJpbmcgc3BsaXQgb24gZG91YmxlIGNsaWNrXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGQgICAgICBUaGUgbWF0Y2hpbmcgZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2RibGNsaWNrJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkYmxjbGljayhkM25vZGUsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3VwZXJTdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5Ob2RlUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgaWYgKCFkMy5ldmVudC5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdXBlclN0YXRlLnNlbGVjdGVkTm9kZXMuaW5kZXhPZihkKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNwbGl0TXVsdGlwbGVOb2RlcyhzdXBlclN0YXRlLnNlbGVjdGVkTm9kZXMpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVBbGxTZWxlY3RlZE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNwbGl0Tm9kZShkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUcmlnZ2VyaW5nIGpvaW4gb24gcmlnaHQgY2xpY2tcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmp9ICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgZCAgICAgIFRoZSBtYXRjaGluZyBkYXRhIG9iamVjdFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnY29udGV4dG1lbnUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNvbnRleHRtZW51KGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdXBlclN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3k7XG4gICAgICAgICAgICAgICAgZDMuZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICBpZiAoIWQzLmV2ZW50LmN0cmxLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9pZiB0cnkgdG8gam9pbiBhIGhpZ2hsaWdodGVkIG5vZGUgd2hpbGUgbXVsdGlwbGUgbm9kZXMgYXJlIHNlbGVjdGVkLFxuICAgICAgICAgICAgICAgICAgICAvL3dlIGpvaW4gYWxsIGhpZ2hsaWdodGVkIG5vZGVzXG4gICAgICAgICAgICAgICAgICAgIHZhciBzZWxlY3RlZE5vZGVzID0gc3VwZXJTdGF0ZS5zZWxlY3RlZE5vZGVzO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWROb2Rlcy5pbmRleE9mKGQpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZWN0ZWROb2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuam9pbk5vZGUoc2VsZWN0ZWROb2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2lmIHdlIHRyeSB0byBqb2luIGEgbm9kZSB0aGF0IGlzbid0IHBhcnQgb2YgYSBoaWdobGlnaHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAvL3dlIHJlbW92ZSBhbGwgaGlnaGxpZ2h0cyBhbmQgdGhlbiBqb2luIHRoZSBjbGlja2VkIG5vZGVcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQWxsU2VsZWN0ZWROb2RlcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5qb2luTm9kZShkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTcGxpdHMgYSBub2RlLlxuICAgICAgICAgICAgICogdXNlZCB0byBzaGFyZSBjb2RlIGJldHdlZW4gc3BsaXROb2RlIGFuZCBzcGxpdE11bHRpcGxlTm9kZXNcbiAgICAgICAgICAgICAqIHdoaWxlIHByZXZlbnRpbmcgdGhlIGhhbmRsZXJzIGZvciB0aGVtIGJvdGggZmlyaW5nXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZSBiZWluZyBzcGxpdFxuICAgICAgICAgICAgICogQHJldHVybiAgICAge0FycmF5fSAgVGhlIG5ldyBub2RlcyBjcmVhdGVkIGJ5IHRoZSBzcGxpdFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnX19zcGxpdE5vZGUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9fc3BsaXROb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luTm9kZVBvbGljeTtcbiAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IG5vZGUuaWQ7XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICAvL2lmIGl0IGhhcyBubyBjaGlsZHJlbiB0byBzcGxpdCBpbnRvXG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkcmVuX3N0cnVjdFtuYW1lXSA9PT0gdW5kZWZpbmVkIHx8IF8uaXNFbXB0eShjaGlsZHJlbl9zdHJ1Y3RbbmFtZV0pKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3JlbW92aW5nIHRoZSBub2RlIGZyb20gdGhlIGxpc3Qgb2Ygbm9kZXNcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMgPSBfLmZpbHRlcih0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uIChncmFwaE5vZGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBncmFwaE5vZGVzICE9IG5vZGU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2codGhpc0dyYXBoLm5vZGVzKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3BsaWNlTGlua3NGb3JOb2RlKG5vZGUpO1xuXG4gICAgICAgICAgICAgICAgLy9nZXR0aW5nIGFsbCB0aGUgbm9kZSBpZCdzIGZvciBmaW5kaW5nIGZsb3dcbiAgICAgICAgICAgICAgICB2YXIgbm9kZV9uYW1lc19zZXQgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXNHcmFwaC5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBub2RlX25hbWVzX3NldC5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXS5pZCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9zZXQgb2Ygbm9kZXMgYWZ0ZXIgdGhlIHNwbGl0XG4gICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hpbGRyZW5fc3RydWN0W25hbWVdLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVfbmFtZXNfc2V0LnB1c2goY2hpbGRyZW5fc3RydWN0W25hbWVdW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3X25vZGVzLnB1c2goY2hpbGRyZW5fc3RydWN0W25hbWVdW2ldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHJldERhdGEgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5nZXRGbG93QmV0d2VlblNldChub2RlX25hbWVzX3NldCk7XG5cbiAgICAgICAgICAgICAgICAvL2Zvcm1hdHRpbmcgZGF0YSBmb3IgbmV3IG5vZGVzXG4gICAgICAgICAgICAgICAgdmFyIHhMb2MgPSBub2RlLng7XG4gICAgICAgICAgICAgICAgdmFyIHlMb2MgPSBub2RlLnk7XG4gICAgICAgICAgICAgICAgdmFyIGFuY2VzdG9ycyA9IG5vZGUuYW5jZXN0b3JzLnNsaWNlKCk7XG4gICAgICAgICAgICAgICAgLy9rZWVwaW5nIG9yZGVyaW5nIHRoYXQgZmlyc3QgaW4gYW5jZXN0b3IgbGlzdCBpcyBjbG9zZXN0IGluIHJlbGF0aW9uc2hpcFxuICAgICAgICAgICAgICAgIGFuY2VzdG9ycy5zcGxpY2UoMCwgMCwgbm9kZS5pZCk7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IG5vZGUuaWQ7XG4gICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlX29ianMgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgcmFkaXVzID0gbm9kZS5yYWRpdXMgKiB0aGlzR3JhcGguY29uc3RzLnJhZGl1c0RlY2F5O1xuICAgICAgICAgICAgICAgIHZhciBub2RlRGF0YSA9IHJldERhdGEubm9kZURhdGE7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2RlRGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAvL2NhbGN1bGF0aW5nIHdoaWNoIG9mIHRoZSBub2RlcyBpbiByZXREYXRhWzBdIGFyZSBuZXdcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld19ub2Rlcy5pbmRleE9mKG5vZGVEYXRhW2ldLmlkKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWQgPSBub2RlRGF0YVtpXS5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gbm9kZURhdGFbaV0udGV4dDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZSA9IG5ldyBWaXN1YWxpemVyTm9kZS5Ob2RlKG51bGwsIG51bGwsIGlkLCB0ZXh0LCByYWRpdXMsIHBhcmVudCwgYW5jZXN0b3JzLCB4TG9jLCB5TG9jKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld19ub2RlLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5wdXNoKG5ld19ub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld19ub2RlX29ianMucHVzaChuZXdfbm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UucHJvY2Vzc0xpbmtEYXRhKHJldERhdGEubGlua0RhdGEsIHRoaXNHcmFwaC5ub2Rlcyk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXROb2RlcygpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0TGlua3MoKTtcblxuICAgICAgICAgICAgICAgIHN0YXRlLnNwbGl0Tm9kZXMucHVzaChub2RlLmlkKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3X25vZGVfb2JqcztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTcGxpdHMgdGhlIGdpdmUgbm9kZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZSBiZWluZyBzcGxpdFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnc3BsaXROb2RlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzcGxpdE5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciByZXMgPSB0aGlzLl9fc3BsaXROb2RlKG5vZGUpO1xuICAgICAgICAgICAgICAgIGlmIChyZXMgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc3BsaXROb2RlRXZlbnQocmVzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTcGxpdHMgYWxsIHRoZSBub2RlcyBwYXNzZWQgaW5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlcyAgIEFycmF5IG9mIG5vZGVzIHRvIGJlIHNwbGl0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdzcGxpdE11bHRpcGxlTm9kZXMnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNwbGl0TXVsdGlwbGVOb2Rlcyhub2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoO1xuICAgICAgICAgICAgICAgIHZhciByZXNOb2RlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IHRoaXMuX19zcGxpdE5vZGUobm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICByZXNOb2RlcyA9IHJlc05vZGVzLmNvbmNhdChyZXMpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuc3BsaXRNdWx0aXBsZU5vZGVzRXZlbnQocmVzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgYWZ0ZXIgYSBzaW5nbGUgbm9kZSBpcyBzcGxpdFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5ld05vZGVzICBUaGUgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdzcGxpdE5vZGVFdmVudCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3BsaXROb2RlRXZlbnQobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaDtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc2V0UG9zaXRpb25zKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIGFmdGVyIG11bHRpcGxlIG5vZGVzIGFyZSBzcGxpdCBhdCBvbmNlXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbmV3Tm9kZXMgIFRoZSBuZXcgbm9kZXNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3NwbGl0TXVsdGlwbGVOb2Rlc0V2ZW50JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzcGxpdE11bHRpcGxlTm9kZXNFdmVudChuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zZXRQb3NpdGlvbnMoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiB1c2VkIHRvIHNoYXJlIGNvZGUgYmV0d2VlbiBqb2luTm9kZSBhbmQgam9pbk11bHRpcGxlTm9kZVxuICAgICAgICAgICAgICogd2hpbGUgcHJldmVudGluZyBib3RoIGhhbmRsZXJzIGZpcmluZ1xuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gICAgICAgICAgbm9kZSAgICBUaGUgbm9kZSB0byBqb2luXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7Tm9kZX0gIFRoZSBuZXcgbm9kZSBhZnRlciB0aGUgam9pblxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnX19qb2luTm9kZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX19qb2luTm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pbk5vZGVQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICAvL2NoZWNrIHRoYXQgbm9kZSBzdGlsbCBleGlzdHNcbiAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLm5vZGVzLmluZGV4T2Yobm9kZSkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBub2RlLmlkO1xuICAgICAgICAgICAgICAgIC8vaWYgaXQgaGFzIG5vIGFuY2VzdG9yLCBub3RoaW5nIHRvIGpvaW5cbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRyZW5fc3RydWN0LnRvcExldmVsLmluZGV4T2YobmFtZSkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHRvX2JlX2RlbGV0ZWQgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZV9uYW1lc19zZXQgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXNHcmFwaC5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIG5vZGUgd29uJ3QgYmUgY29sbGFwc2VkXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGgubm9kZXNbaV0uYW5jZXN0b3JzLmluZGV4T2Yobm9kZS5wYXJlbnQpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlX25hbWVzX3NldC5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXS5pZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b19iZV9kZWxldGVkLnB1c2godGhpc0dyYXBoLm5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGVfaWQgPSBub2RlLnBhcmVudDtcbiAgICAgICAgICAgICAgICBub2RlX25hbWVzX3NldC5wdXNoKG5vZGUucGFyZW50KTtcblxuICAgICAgICAgICAgICAgIC8vZm9ybWF0dGluZyBkYXRhXG4gICAgICAgICAgICAgICAgdmFyIHJhZGl1cyA9IG5vZGUucmFkaXVzIC8gdGhpc0dyYXBoLmNvbnN0cy5yYWRpdXNEZWNheTtcbiAgICAgICAgICAgICAgICB2YXIgeExvYyA9IG5vZGUueDtcbiAgICAgICAgICAgICAgICB2YXIgeUxvYyA9IG5vZGUueTtcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gbm9kZS5hbmNlc3RvcnNbMV07XG4gICAgICAgICAgICAgICAgdmFyIGFuY2VzdG9ycyA9IG5vZGUuYW5jZXN0b3JzLnNsaWNlKDEpO1xuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZSA9IG5ldyBWaXN1YWxpemVyTm9kZS5Ob2RlKHhMb2MsIHlMb2MsIG5ld19ub2RlX2lkLCBuZXdfbm9kZV9pZCwgcmFkaXVzLCBwYXJlbnQsIGFuY2VzdG9ycyk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnB1c2gobmV3X25vZGUpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHJldERhdGEgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5nZXRGbG93QmV0d2VlblNldChub2RlX25hbWVzX3NldCk7XG4gICAgICAgICAgICAgICAgLy9yZW1vdmUgYWxsIG5vZGVzIHRoYXQgd2lsbCBiZSBqb2luZWRcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRvX2JlX2RlbGV0ZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVfdG9fZGVsZXRlID0gdG9fYmVfZGVsZXRlZFtpXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnNwbGljZSh0aGlzR3JhcGgubm9kZXMuaW5kZXhPZihub2RlX3RvX2RlbGV0ZSksIDEpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3BsaWNlTGlua3NGb3JOb2RlKG5vZGVfdG9fZGVsZXRlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UucHJvY2Vzc0xpbmtEYXRhKHJldERhdGEubGlua0RhdGEsIHRoaXNHcmFwaC5ub2Rlcyk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXROb2RlcygpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0TGlua3MoKTtcblxuICAgICAgICAgICAgICAgIHN0YXRlLnNwbGl0Tm9kZXMuc3BsaWNlKHN0YXRlLnNwbGl0Tm9kZXMuaW5kZXhPZihuZXdfbm9kZS5pZCksIDEpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ld19ub2RlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEpvaW5zIHRoZSBnaXZlbiBub2RlXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBub2RlICAgIFRoZSBub2RlIHRvIGpvaW5cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2pvaW5Ob2RlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBqb2luTm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5ld05vZGUgPSB0aGlzLl9fam9pbk5vZGUobm9kZSk7XG4gICAgICAgICAgICAgICAgaWYgKG5ld05vZGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmpvaW5Ob2RlRXZlbnQobmV3Tm9kZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEpvaW5zIGFsbCB0aGUgZ2l2ZW4gbm9kZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlcyAgIFRoZSBub2RlcyB0byBqb2luXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdqb2luTXVsdGlwbGVOb2RlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBqb2luTXVsdGlwbGVOb2RlKG5vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IHRoaXMuX19qb2luTm9kZShub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIG5ld19ub2Rlcy5wdXNoKHJlcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuam9pbk11bHRpcGxlTm9kZXNFdmVudChuZXdfbm9kZXMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBhIHNpbmdsZSBub2RlIGlzIGpvaW5lZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbmV3Tm9kZSAgVGhlIG5ldyBub2RlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdqb2luTm9kZUV2ZW50JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBqb2luTm9kZUV2ZW50KG5ld05vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaDtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgYWZ0ZXIgbXVsdGlwbGUgbm9kZXMgYXJlIGpvaW5lZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5ld05vZGVzICBUaGUgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdqb2luTXVsdGlwbGVOb2Rlc0V2ZW50JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBqb2luTXVsdGlwbGVOb2Rlc0V2ZW50KG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1dKTtcblxuICAgICAgICByZXR1cm4gU3BsaXRKb2luTm9kZVBvbGljeTtcbiAgICB9KE5vZGVTZWxlY3Rpb25Qb2xpY3kuUG9saWN5KTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIFBvbGljeTogU3BsaXRKb2luTm9kZVBvbGljeVxuICAgIH07XG59XSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3BvbGljaWVzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbmV0d29ya3BvbGljaWVzJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuaXNvbGF0aW9uJywge1xuICAgICAgICAgICAgdXJsOiAnL2lzb2xhdGlvbicsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPHVpLXZpZXcvPidcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbi5jcmVhdGUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2lzb2xhdGlvbnBvbGljeWNyZWF0ZSdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmJhbmR3aWR0aCcsIHtcbiAgICAgICAgICAgIHVybDogJy9iYW5kd2lkdGgnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzx1aS12aWV3Lz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGguY3JlYXRlJywge1xuICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdiYW5kd2lkdGhwb2xpY3ljcmVhdGUnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5yZWRpcmVjdGlvbicsIHtcbiAgICAgICAgICAgIHVybDogJy9yZWRpcmVjdGlvbicsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPHVpLXZpZXcvPidcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3MnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbmV0d29ya3MnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXBcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxudmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQob2JqZWN0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IHJldHVybiBnZXQocGFyZW50LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpOyB9IH0gZWxzZSBpZiAoXCJ2YWx1ZVwiIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9O1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbi8qKlxuICogVGhpcyBwb2xpY3kgaXMgdXNlZCB0byBjaGFuZ2UgdGhlIHZpZXcgdG8gZm9jdXMgb24gc3BsaXR0aW5nIGFuZCBcbiAqIGpvaW5pbmcgZXZlbnRzLlxuICogT3ZlcnJpZGVzIHRoZSBjZXJ0YWluIGZvcmNlIGxheW91dCBmdW5jdGlvbnMgb2YgdGhlIGdyYXBoIHRvIHBhcnRpdGlvbiBhIHNwbGl0XG4gKiBpbnRvIHRoZSBmb2N1c2VkIG5vZGVzIGFuZCB0aGUgY29ubmVjdGVkIG5vZGVzLlxuICogXG4gKiBIYXMgc2F2ZS9sb2FkIG1ldGhvZHMgZm9yIHRoZSBzYXZlIHN0YXRlIHBvbGljeS5cbiAqIEhhcyBiYWNrIGJ1dHRvbiBzdXBwb3J0LlxuICogQ2FuIGF1dG8gY2hhbmdlIHRoZSB0aXRsZSBvZiB0aGUgZ3JhcGguXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdTcGxpdEpvaW5WaWV3UG9saWN5JywgWydTcGxpdEpvaW5Ob2RlUG9saWN5JywgJ1Zpc3VhbGl6ZXJOb2RlJywgZnVuY3Rpb24gKFNwbGl0Sm9pbk5vZGVQb2xpY3ksIFZpc3VhbGl6ZXJOb2RlKSB7XG4gICAgdmFyIFNwbGl0Sm9pblZpZXdQb2xpY3kgPSBmdW5jdGlvbiAoX1NwbGl0Sm9pbk5vZGVQb2xpY3kkKSB7XG4gICAgICAgIF9pbmhlcml0cyhTcGxpdEpvaW5WaWV3UG9saWN5LCBfU3BsaXRKb2luTm9kZVBvbGljeSQpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBTcGxpdEpvaW5WaWV3UG9saWN5KCkge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNwbGl0Sm9pblZpZXdQb2xpY3kpO1xuXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoU3BsaXRKb2luVmlld1BvbGljeS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFNwbGl0Sm9pblZpZXdQb2xpY3kpKS5jYWxsKHRoaXMpKTtcblxuICAgICAgICAgICAgX3RoaXMucG9saWN5TmFtZSA9IFwiU3BsaXRKb2luVmlld1BvbGljeVwiO1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENhbGxlZCB3aGVuIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGhcbiAgICAgICAgICovXG5cblxuICAgICAgICBfY3JlYXRlQ2xhc3MoU3BsaXRKb2luVmlld1BvbGljeSwgW3tcbiAgICAgICAgICAgIGtleTogJ2luaXRpYWxpemUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemUoZ3JhcGgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF9nZXQoU3BsaXRKb2luVmlld1BvbGljeS5wcm90b3R5cGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihTcGxpdEpvaW5WaWV3UG9saWN5LnByb3RvdHlwZSksICdpbml0aWFsaXplJywgdGhpcykuY2FsbCh0aGlzLCBncmFwaCk7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLnNhdmVkU3RhdGVzID0gW107XG4gICAgICAgICAgICAgICAgLy8gc3RhdGUuZm9jdXNHcm91cCA9IG51bGw7XG4gICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5ID0gW107XG4gICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMgPSBbXTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5mb2NpID0gW107XG4gICAgICAgICAgICAgICAgc3RhdGUuem9vbXMgPSB7fTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5sYXlvdXQgPSB7fTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5sYXlvdXREZWZhdWx0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS56b29tRGVmYXVsdCA9IG51bGw7XG4gICAgICAgICAgICAgICAgc3RhdGUubm9kZUlkc1RvUmVzaG93ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uRWxlbSA9IG51bGw7XG4gICAgICAgICAgICAgICAgc3RhdGUudGl0bGVFbGVtID0gbnVsbDtcblxuICAgICAgICAgICAgICAgIHZhciBjb25zdHMgPSBncmFwaC5jb25zdHMuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIGNvbnN0cy5ib3VuZGFyeSA9IDAuODtcblxuICAgICAgICAgICAgICAgIC8vb3ZlcnJpZGluZyBkM2ZvcmNlIG1ldGhvZHMgb2YgdGhlIGdyYXBoLlxuICAgICAgICAgICAgICAgIGdyYXBoLmQzRm9yY2VCb3VuZHMgPSB0aGlzLmQzRm9yY2VCb3VuZHM7XG4gICAgICAgICAgICAgICAgZ3JhcGguZDNGb3JjZVRpY2sgPSB0aGlzLmQzRm9yY2VUaWNrO1xuICAgICAgICAgICAgICAgIGdyYXBoLmQzRm9yY2VTdGFydCA9IHRoaXMuZDNGb3JjZVN0YXJ0O1xuICAgICAgICAgICAgICAgIGdyYXBoLmQzRm9yY2VFbmQgPSB0aGlzLmQzRm9yY2VFbmQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogTGlua3MgdGhlIHByb3ZpZGVkIGVsZW1lbnQgYSBiYWNrIGJ1dHRvbiBmZWF0dXJlXG4gICAgICAgICAgICAgKiBEb2Vzbid0IHRyaWdnZXIgdGhlIG9uLWNsaWNrIGV2ZW50XG4gICAgICAgICAgICAgKiBUaGF0IHNob3VsZCBiZSBkb25lIHRocm91Z2ggYW5ndWxhciBuZy1jbGljay5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7alF1ZXJ5fSAgZWxlbSAgICBUaGUganF1ZXJ5IHNlbGVjdGVkIGVsZW1lbnRcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2luc3RhbGxCYWNrQnV0dG9uJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbnN0YWxsQmFja0J1dHRvbihlbGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kgPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgc3RhdGUuYmFja0J1dHRvbkVsZW0gPSBlbGVtO1xuICAgICAgICAgICAgICAgIHN0YXRlLmJhY2tCdXR0b24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51bmRvTGFzdEV2ZW50LmNhbGwodGhpc1BvbGljeSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgYWxsb3cgdGhpcyBwb2xpY3kgdG8gY2hhbmdlIHRoZSB0aXRsZSBvZiB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqIGFzIHNwbGl0IGFuZCBqb2luIGV2ZW50cyBvY2N1ci5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7alF1ZXJ5fSAgZWxlbSAgICBUaGUganF1ZXJ5IHNlbGVjdGVkIGVsZW1lbnRcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2luc3RhbGxUaXRsZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5zdGFsbFRpdGxlKGVsZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIHN0YXRlLnRpdGxlRWxlbSA9IGVsZW07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIGJlaW5nIGRlc3Ryb3llZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBzYXZlZFN0YXRlICBBbnkgcHJvcGVydHkgb24gdGhpc1xuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdCB3aWxsIGJlIGFjY2Vzc2libGVcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGVuIHRoZSB2aWV3IHJlbG9hZHNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koc2F2ZWRTdGF0ZSkge1xuICAgICAgICAgICAgICAgIC8vT25seSBpZiB0aGUgc2F2ZSBzdGF0ZSBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAgICAgICAgaWYgKHNhdmVkU3RhdGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNhdmUoc2F2ZWRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgc2F2ZSB0aGUgY3VycmVudCBzdGF0ZSwgYW5kIGFsbCBoaXN0b3J5LlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBzYXZlZFN0YXRlICBBbnkgcHJvcGVydHkgb24gdGhpc1xuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdCB3aWxsIGJlIGFjY2Vzc2libGVcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGVuIHRoZSB2aWV3IHJlbG9hZHNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3NhdmUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNhdmUoc2F2ZWRTdGF0ZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgICAgIHZhciBsaW5rcyA9IHRoaXNHcmFwaC5saW5rcztcbiAgICAgICAgICAgICAgICB2YXIgY3VyclRpdGxlID0gbnVsbDtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUudGl0bGVFbGVtICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgY3VyclRpdGxlID0gc3RhdGUudGl0bGVFbGVtLnRleHQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGZvY3VzR3JvdXBzID0gc3RhdGUuZm9jdXNHcm91cHM7XG4gICAgICAgICAgICAgICAgdmFyIGV2ZW50SGlzdG9yeSA9IHN0YXRlLmV2ZW50SGlzdG9yeTtcbiAgICAgICAgICAgICAgICB2YXIgem9vbXMgPSBzdGF0ZS56b29tcztcbiAgICAgICAgICAgICAgICB2YXIgbGF5b3V0ID0gc3RhdGUubGF5b3V0O1xuXG4gICAgICAgICAgICAgICAgdmFyIGxheW91dERlZmF1bHQgPSBzdGF0ZS5sYXlvdXREZWZhdWx0O1xuICAgICAgICAgICAgICAgIHZhciB6b29tRGVmYXVsdCA9IHN0YXRlLnpvb21EZWZhdWx0O1xuICAgICAgICAgICAgICAgIHZhciByZXQgPSB7IG5vZGVzOiBub2RlcywgbGlua3M6IGxpbmtzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZXM6IHN0YXRlLnNhdmVkU3RhdGVzLCBjdXJyVGl0bGU6IGN1cnJUaXRsZSxcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNHcm91cHM6IGZvY3VzR3JvdXBzLFxuICAgICAgICAgICAgICAgICAgICBldmVudEhpc3Rvcnk6IGV2ZW50SGlzdG9yeSwgem9vbXM6IHpvb21zLFxuICAgICAgICAgICAgICAgICAgICBsYXlvdXQ6IGxheW91dCwgbGF5b3V0RGVmYXVsdDogbGF5b3V0RGVmYXVsdCxcbiAgICAgICAgICAgICAgICAgICAgem9vbURlZmF1bHQ6IHpvb21EZWZhdWx0IH07XG4gICAgICAgICAgICAgICAgc2F2ZWRTdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5ID0gcmV0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgYmUgY2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIHJlbG9hZGVkLCBhc3N1bWluZ1xuICAgICAgICAgICAgICogc2F2ZSBzdGF0ZSBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGxvYWRTdGF0ZSAgQ29udGFpbnMgYWxsIHRoZSBzYXZlZFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFibGVzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdsb2FkJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBsb2FkKGxvYWRTdGF0ZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIGxvYWRTdGF0ZSA9IGxvYWRTdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuICAgICAgICAgICAgICAgIHN0YXRlLnNhdmVkU3RhdGVzID0gbG9hZFN0YXRlLnN0YXRlcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MgPSBsb2FkU3RhdGUubGlua3M7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzID0gbG9hZFN0YXRlLm5vZGVzO1xuXG4gICAgICAgICAgICAgICAgdmFyIGN1cnJUaXRsZSA9IGxvYWRTdGF0ZS5jdXJyVGl0bGU7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLnRpdGxlRWxlbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLnRpdGxlRWxlbS50ZXh0KGN1cnJUaXRsZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeSA9IGxvYWRTdGF0ZS5ldmVudEhpc3Rvcnk7XG4gICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMgPSBsb2FkU3RhdGUuZm9jdXNHcm91cHM7XG4gICAgICAgICAgICAgICAgc3RhdGUuem9vbXMgPSBsb2FkU3RhdGUuem9vbXM7XG4gICAgICAgICAgICAgICAgc3RhdGUubGF5b3V0ID0gbG9hZFN0YXRlLmxheW91dDtcbiAgICAgICAgICAgICAgICBzdGF0ZS5sYXlvdXREZWZhdWx0ID0gbG9hZFN0YXRlLmxheW91dERlZmF1bHQ7XG4gICAgICAgICAgICAgICAgc3RhdGUuem9vbURlZmF1bHQgPSBsb2FkU3RhdGUuem9vbURlZmF1bHQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuYmFja0J1dHRvbkVsZW0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLmJhY2tCdXR0b25FbGVtLmZhZGVUbygnc2xvdycsIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcblxuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoXy5pbmNsdWRlcyhjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dLCBkLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImZvY3VzXCI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiY29ubmVjdGVkXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vbG9hZGluZyBhIHByZXZpb3VzIGxheW91dFxuICAgICAgICAgICAgICAgIHZhciBsYXlvdXQ7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBsYXlvdXQgPSBzdGF0ZS5sYXlvdXREZWZhdWx0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbSA9IHN0YXRlLnpvb21EZWZhdWx0O1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguem9vbWVkKHpvb21bMF0sIHpvb21bMV0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB6b29tID0gc3RhdGUuem9vbXNbc3RhdGUuZm9jdXNHcm91cHNdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoem9vbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguem9vbWVkKHpvb21bMF0sIHpvb21bMV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGxheW91dCA9IHN0YXRlLmxheW91dFtzdGF0ZS5mb2N1c0dyb3Vwc107XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9sYXlvdXQgY2FuJ3QgYmUgbnVsbFxuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwb3MgPSBsYXlvdXRbbi5pZF07XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb3MgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cobGF5b3V0LCBuKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBuLnggPSBwb3MueDtcbiAgICAgICAgICAgICAgICAgICAgbi55ID0gcG9zLnk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN0YXRlLmluaXRGb3JjZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoLmNhbGwodGhpc0dyYXBoLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kudXBkYXRlR3JhcGhDYWxsYmFjay5jYWxsKHRoaXNQb2xpY3kpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRyaWdnZXJpbmcgc3BsaXQgb24gZG91YmxlIGNsaWNrXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEZvY3VzIGdyb3VwIHN0b3JlcyB0aGUgbm9kZSB0aGF0IGlzIGFib3V0IHRvIGJlIHNwbGl0LlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBXaGVuIGZvY3VzIGdyb3VwIGhhcyBsZW5ndGggMCwgdGhlIGZpcnN0IHNwbGl0IFxuICAgICAgICAgICAgICogd2lsbCBqdXN0IGJlIHB1c2hlZCBvbi5cbiAgICAgICAgICAgICAqIFRoZSBub2RlIHdpbGwgYmUgc3BsaXQgYW5kIHB1c2hlZCB0byB0aGUgdG9wIGhhbGYgXG4gICAgICAgICAgICAgKiBvZiB0aGUgc2NyZWVuLCBhbmQgdGhlIGJvdHRvbSBoYWxmIHdpbGwgY29udGFpbiBhbnlcbiAgICAgICAgICAgICAqIG5vZGVzIGl0IGhhcyBjb25uZWN0aW9ucyB0by5cbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogV2hlbiBhIGZvY3VzIGdyb3VwIGxlbmd0aCBpcyA+PSAxLCBpZiB0aGUgbm9kZSB0byBiZVxuICAgICAgICAgICAgICogc3BsaXQgaXMgYSBmb2N1cyBub2RlLCBpdCB3aWxsIHJlcGxhY2UgZm9jdXNHcm91cHNbMF0gYW5kXG4gICAgICAgICAgICAgKiB0aGUgdG9wIGhhbGYgd2lsbCBiZSBpdHMgY2hpbGRyZW4sIGFuZCBib3R0b20gaGFsZiB3aWxsXG4gICAgICAgICAgICAgKiBiZSB0aGUgbm9kZXMgaXQgaGFzIGNvbm5lY3Rpb25zIHRvLlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBJZiB0aGUgc3BsaXQgaXMgaW4gdGhlIGJvdHRvbSBoYWxmLCB0aGVuIHRoZSBib3R0b20gaGFsZlxuICAgICAgICAgICAgICogd2lsbCBkaXNwbGF5IGl0J3MgY2hpbGRyZW4gYW5kIHdpbGwgb25seSBzaG93IGNvbm5lY3Rpb25zIGJldHdlZW5cbiAgICAgICAgICAgICAqIHRoZSB0d28gZ3JvdXBzLCBhbmQgd2lsbCByZXBsYWNlIGZvY3VzR3JvdXBzWzFdLlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmp9ICAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGQgICAgICAgVGhlIG1hdGNoaW5nIGRhdGEgb2JqZWN0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkYmxjbGljaycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGJsY2xpY2soZDNub2RlLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICAvL2NoZWNrIGlmIGNhbiBzcGxpdFxuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gZC5pZDtcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIGlmIChjaGlsZHJlbl9zdHJ1Y3RbbmFtZV0gPT09IHVuZGVmaW5lZCB8fCBfLmlzRW1wdHkoY2hpbGRyZW5fc3RydWN0W25hbWVdKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMuc2xpY2UoKTtcblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy90b3BsZXZlbCBzcGxpdFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwcy5wdXNoKGQuaWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXy5pbmNsdWRlcyhjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dLCBkLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICAvL3NwbGl0dGluZyBhIGZvY3VzIG5vZGVcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHNbMF0gPSBkLmlkO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vc3BsaXR0aW5nIGFcbiAgICAgICAgICAgICAgICAgICAgLy9jb25uZWN0ZWQgbm9kZVxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwcy5wdXNoKGQuaWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXy5pbmNsdWRlcyhjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMV1dLCBkLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICAvL3NwbGl0dGluZyBhXG4gICAgICAgICAgICAgICAgICAgIC8vY29ubmVjdGVkIG5vZGVcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHNbMV0gPSBkLmlkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDIgJiYgc3RhdGUuZm9jdXNHcm91cHNbMV0gPT09IGQuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9TcGxpdHRpbmcgYSBjb25uZWN0ZWQgbm9kZSwga2VlcCBhbGwgZm9jdXMgbm9kZXNcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVzVG9LZWVwID0gW2RdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZUlkc1RvUmVzaG93ID0gW107XG4gICAgICAgICAgICAgICAgICAgIHZhciBncm91cE9uZU5vZGVzID0gY2hpbGRyZW5fc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzBdXTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKGdyb3VwT25lTm9kZXMsIG5vZGUuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlkc1RvUmVzaG93LnB1c2gobm9kZS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNUb0tlZXAucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy9NYWtlIHNwbGl0IG5vZGVzIHRoZSBmb2N1cyBhbmQga2VlcCBub2RlcyB0aGF0IGFyZSBjb25uZWN0ZWRcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVzVG9LZWVwID0gW2RdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZUlkc1RvUmVzaG93ID0gW107XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubGlua3MsIGZ1bmN0aW9uIChsaW5rKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobGluay5zb3VyY2UgPT09IGQgJiYgbm9kZUlkc1RvUmVzaG93LmluZGV4T2YobGluay50YXJnZXQuaWQpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluay50YXJnZXQuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsudGFyZ2V0LlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiY29ubmVjdGVkXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlkc1RvUmVzaG93LnB1c2gobGluay50YXJnZXQuaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzVG9LZWVwLnB1c2gobGluay50YXJnZXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChsaW5rLnRhcmdldCA9PT0gZCAmJiBub2RlSWRzVG9SZXNob3cuaW5kZXhPZihsaW5rLnNvdXJjZS5pZCkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rLnNvdXJjZS5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluay5zb3VyY2UuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzVG9SZXNob3cucHVzaChsaW5rLnNvdXJjZS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNUb0tlZXAucHVzaChsaW5rLnNvdXJjZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vUmVtb3ZpbmcgbGlua3MgZnJvbSB0aGUgbm9kZSB0byBiZSBzcGxpdFxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2goZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuaWQgIT09IGQuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zcGxpY2VMaW5rc0Zvck5vZGUobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcblxuICAgICAgICAgICAgICAgIC8vZGlzYWJsaW5nIHVwZGF0ZSBncmFwaCB0byBwcmV2ZW50IG5ldyBkYXRhIGZyb21cbiAgICAgICAgICAgICAgICAvL3JlZHJhd2luZyBsaW5rcyB3aGlsZSB0aGVyZSBhcmUgYW5pbWF0aW9ucyBnb2luZyBvblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZS5kaXNhYmxlVXBkYXRlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5lYWNoKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLmlkICE9PSBkLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykudHJhbnNpdGlvbigpLmRlbGF5KDIwMCkuZHVyYXRpb24oNDAwKS5zdHlsZShcIm9wYWNpdHlcIiwgMCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2Rpc2FibGluZyBxdGlwIGlmIGluc3RhbGxlZFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQodGhpcykucXRpcCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5xdGlwKCdkaXNhYmxlJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHZhciB0cmFuc2xhdGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKTtcbiAgICAgICAgICAgICAgICB2YXIgc2NhbGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpO1xuICAgICAgICAgICAgICAgIHZhciB4TG9jID0gcGFyc2VGbG9hdCh0aGlzR3JhcGguc3ZnLnN0eWxlKFwid2lkdGhcIikpIC8gc2NhbGUgLyAyICsgdHJhbnNsYXRlWzBdO1xuICAgICAgICAgICAgICAgIHZhciB5TG9jID0gcGFyc2VGbG9hdCh0aGlzR3JhcGguc3ZnLnN0eWxlKFwiaGVpZ2h0XCIpKSAvIHNjYWxlIC8gMiArIHRyYW5zbGF0ZVsxXTtcbiAgICAgICAgICAgICAgICBkLnhTdGFydCA9IGQueDtcbiAgICAgICAgICAgICAgICBkLnlTdGFydCA9IGQueTtcbiAgICAgICAgICAgICAgICBkLnggPSB4TG9jO1xuICAgICAgICAgICAgICAgIGQueSA9IHlMb2M7XG4gICAgICAgICAgICAgICAgZDNub2RlLnRyYW5zaXRpb24oXCJub2RlUG9zaXRpb25UcmFuc2l0aW9uXCIpLmR1cmF0aW9uKDc1MCkuYXR0clR3ZWVuKFwidHJhbnNmb3JtXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB4U3RhcnQgPSBkLnhTdGFydDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHlTdGFydCA9IGQueVN0YXJ0O1xuICAgICAgICAgICAgICAgICAgICBkLnhTdGFydCA9IGQueDtcbiAgICAgICAgICAgICAgICAgICAgZC55U3RhcnQgPSBkLnk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkMy5pbnRlcnBvbGF0ZVN0cmluZyhcInRyYW5zbGF0ZShcIiArIHhTdGFydCArIFwiLFwiICsgeVN0YXJ0ICsgXCIpXCIsIFwidHJhbnNsYXRlKFwiICsgZC54ICsgXCIsXCIgKyBkLnkgKyBcIilcIik7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3BsaXROb2RlRnVuYyA9IF9nZXQoU3BsaXRKb2luVmlld1BvbGljeS5wcm90b3R5cGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihTcGxpdEpvaW5WaWV3UG9saWN5LnByb3RvdHlwZSksICdzcGxpdE5vZGUnLCB0aGlzKTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5ub2RlSWRzVG9SZXNob3cgPSBub2RlSWRzVG9SZXNob3c7XG4gICAgICAgICAgICAgICAgLy93YWl0aW5nIGZvciBub2RlIHRyYW5zaXRpb25cbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlcyA9IG5vZGVzVG9LZWVwO1xuICAgICAgICAgICAgICAgICAgICBzcGxpdE5vZGVGdW5jLmNhbGwodGhpc1BvbGljeSwgZCk7XG4gICAgICAgICAgICAgICAgfSwgNzUwKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUbyBiZSBjYWxsZWQgYWZ0ZXIgdGhlIGdyYXBoIGlzIHNwbGl0LlxuICAgICAgICAgICAgICogQnJpbmdzIGFsbCBub2RlcyBiYWNrIGludG8gdmlldyBhbmQgc2V0cyB0aGVpciBhdHRyaWJ1dGVzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd1cGRhdGVHcmFwaENhbGxiYWNrJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVHcmFwaENhbGxiYWNrKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZWFjaChmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykudHJhbnNpdGlvbigpLmR1cmF0aW9uKDQwMCkuc3R5bGUoXCJvcGFjaXR5XCIsIDEpO1xuICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykuY2xhc3NlZChcImZvY3VzXCIsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLmNsYXNzZWQoXCJjb25uZWN0ZWRcIiwgZmFsc2UpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLlNwbGl0Sm9pblZpZXdQb2xpY3kgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID09PSBcImZvY3VzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykuY2xhc3NlZChcImZvY3VzXCIsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChub2RlLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9PT0gXCJjb25uZWN0ZWRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5jbGFzc2VkKFwiY29ubmVjdGVkXCIsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS5ub2RlSWRzVG9SZXNob3cgPSBudWxsO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmFuZG9tbHkgc2V0cyB0aGUgcG9zaXRpb25zIG9mIGFueSB1bnNldCBub2RlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdzZXRQb3NpdGlvbnMnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldFBvc2l0aW9ucygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeSA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIGdyYXBoQ29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cztcblxuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSBncmFwaENvbnN0cy5kaXNwbGF5T2Zmc2V0O1xuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXNHcmFwaC5ub2RlcztcbiAgICAgICAgICAgICAgICB2YXIgcmV0ID0gdGhpc1BvbGljeS5kM0ZvcmNlQm91bmRzLmNhbGwodGhpc0dyYXBoKTtcblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdldFJhbmRvbUludChtaW4sIG1heCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbiArIDEpKSArIG1pbjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfLmZvckVhY2gobm9kZXMsIGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLnggPT0gbnVsbCB8fCBub2RlLnkgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHggPSBnZXRSYW5kb21JbnQobm9kZS5yYWRpdXMgKyBvZmZzZXQsIHJldC53aWR0aCAtIG5vZGUucmFkaXVzIC0gb2Zmc2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB5ID0gZ2V0UmFuZG9tSW50KG5vZGUucmFkaXVzICsgb2Zmc2V0LCByZXQuaGVpZ2h0IC0gbm9kZS5yYWRpdXMgLSBvZmZzZXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS54ID0geDtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUueSA9IHk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgb24gdGhlIHN0YXJ0IG9mIHRoZSBkMyBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKiBXaWxsIG92ZXJyaWRlIHRoZSBtZXRob2Qgb2YgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKiBcInRoaXNcIiBwb2ludHMgdG8gdGhlIGdyYXBoXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkM0ZvcmNlU3RhcnQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGQzRm9yY2VTdGFydCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5hdHRyKCdjeCcsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLnhTdGFydCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLnhTdGFydCA9IGQueFN0YXJ0ICogdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKSArIHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpWzBdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cignY3knLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC55U3RhcnQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC55U3RhcnQgPSBkLnlTdGFydCAqIHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCkgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKVsxXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55O1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzLmF0dHIoJ3gxJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuc291cmNlLng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneTEnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5zb3VyY2UueTtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd4MicsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnRhcmdldC54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3kyJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQudGFyZ2V0Lnk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIG9uIHRoZSBzdGFydCBvZiB0aGUgZDMgZm9yY2Ugc2ltdWxhdGlvblxuICAgICAgICAgICAgICogV2lsbCBvdmVycmlkZSB0aGUgbWV0aG9kIG9mIHRoZSBncmFwaFxuICAgICAgICAgICAgICogXCJ0aGlzXCIgcG9pbnRzIHRvIHRoZSBncmFwaFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZDNGb3JjZUVuZCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZDNGb3JjZUVuZCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5ID0gc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGVQb2xpY3kubGF5b3V0RGVmYXVsdCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWZhdWx0TGF5b3V0ID0ge307XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0TGF5b3V0W24uaWRdID0geyB4OiBuLngsIHk6IG4ueSB9O1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kubGF5b3V0RGVmYXVsdCA9IGRlZmF1bHRMYXlvdXQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzY2FsZSA9IHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0cmFuc2xhdGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kuem9vbURlZmF1bHQgPSBbdHJhbnNsYXRlLCBzY2FsZV07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuYXR0cignY3gnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ2N5JywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocy5hdHRyKCd4MScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnNvdXJjZS54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3kxJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuc291cmNlLnk7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneDInLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC50YXJnZXQueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd5MicsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnRhcmdldC55O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgYmUgY2FsbGVkIGR1cmluZyBEMyBmb3JjZSBzaW11bGF0aW9uc1xuICAgICAgICAgICAgICogYnkgdGhlIGdyYXBoLCBzbyBcInRoaXNcIiB3aWxsIHBvaW50IHRvIHRoZSBncmFwaCBvYmplY3RcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgd2lkdGggICBEMyBMYXlvdXQgV2lkdGhcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICBoZWlnaHQgIEQzIExheW91dCBIZWlnaHRcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2QzRm9yY2VUaWNrJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkM0ZvcmNlVGljayhlLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZVBvbGljeSA9IHN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gY29uc3RzLmRpc3BsYXlPZmZzZXQ7XG4gICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKTtcblxuICAgICAgICAgICAgICAgIC8vIE1vdmUgbm9kZXMgdG93YXJkIGNsdXN0ZXIgZm9jdXMuXG4gICAgICAgICAgICAgICAgdmFyIGZvY2kgPSBzdGF0ZVBvbGljeS5mb2NpO1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdyYXZpdHkoYWxwaGEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm9jaS5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPT09IFwiZm9jdXNcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gKGZvY2lbMF0gLSBkLnkpICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55ICs9IChmb2NpWzFdIC0gZC55KSAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnggKz0gKHdpZHRoIC8gMiAtIGQueCkgKiBhbHBoYTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55ICs9IChoZWlnaHQgLyAyIC0gZC55KSAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCArPSAod2lkdGggLyAyIC0gZC54KSAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIE1ha2Ugc3VyZSBub2RlcyBhcmUgd2l0aGluIGJvdW5kc1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2godGhpcy5kM0ZvcmNlQ29sbGlkZSguNSkpLmVhY2goZ3Jhdml0eSguMiAqIGUuYWxwaGEpKS5hdHRyKFwiY3hcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueCA9IE1hdGgubWF4KChkLnJhZGl1cyArIG9mZnNldCkgLyBzY2FsZSwgTWF0aC5taW4od2lkdGggKyAoLW9mZnNldCAtIGQucmFkaXVzKSAvIHNjYWxlLCBkLngpKTtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKFwiY3lcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuU3BsaXRKb2luVmlld1BvbGljeSA9PSBudWxsIHx8IGQuU3BsaXRKb2luVmlld1BvbGljeSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLnkgPSBNYXRoLm1heCgoZC5yYWRpdXMgKyBvZmZzZXQpIC8gc2NhbGUsIE1hdGgubWluKGhlaWdodCArICgtb2Zmc2V0IC0gZC5yYWRpdXMpIC8gc2NhbGUsIGQueSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9PT0gXCJmb2N1c1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLnkgPSBNYXRoLm1heChkLnJhZGl1cyArIG9mZnNldCwgTWF0aC5taW4oKGhlaWdodCArICgtb2Zmc2V0IC0gZC5yYWRpdXMpIC8gc2NhbGUpICogY29uc3RzLlNwbGl0Sm9pblZpZXdQb2xpY3kuYm91bmRhcnksIGQueSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9PT0gXCJjb25uZWN0ZWRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC55ID0gTWF0aC5tYXgoKGhlaWdodCArIChvZmZzZXQgLSBkLnJhZGl1cykgLyBzY2FsZSkgKiBjb25zdHMuU3BsaXRKb2luVmlld1BvbGljeS5ib3VuZGFyeSwgTWF0aC5taW4oaGVpZ2h0ICsgKC1vZmZzZXQgLSBkLnJhZGl1cykgLyBzY2FsZSwgZC55KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHMuYXR0cigneDEnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5zb3VyY2UueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd5MScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnNvdXJjZS55O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3gyJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQudGFyZ2V0Lng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneTInLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC50YXJnZXQueTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxjdWxhdGVzIHRoZSBib3VuZGFyaWVzIG9mIHRoZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIFdpbGwgYmUgY2FsbGVkIGR1cmluZyBEMyBmb3JjZSBzaW11bGF0aW9uc1xuICAgICAgICAgICAgICogYnkgdGhlIGdyYXBoLCBzbyBcInRoaXNcIiB3aWxsIHBvaW50IHRvIHRoZSBncmFwaCBvYmplY3RcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHJldHVybiAgICAge09iamVjdH0gICAgICAgICAgUmV0dXJucyBhbiBvYmplY3RcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQgaGFzIHRoZSB3aWR0aFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5kIGhlaWdodCBhcyBcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXMgXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkM0ZvcmNlQm91bmRzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkM0ZvcmNlQm91bmRzKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cyxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzUG9saWN5ID0gY29uc3RzLlNwbGl0Sm9pblZpZXdQb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5ID0gc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gY2FsY01heE5vZGVzKHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZWEgPSB3aWR0aCAqIGhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJhZGl1cyA9IHRoaXNHcmFwaC5jb25zdHMuc3RhcnRSYWRpdXM7XG4gICAgICAgICAgICAgICAgICAgIC8vdHJlYXRpbmcgdGhlbSBhcyBhIHNxdWFyZSBmb3IgYXBwcm94XG4gICAgICAgICAgICAgICAgICAgIHZhciBsZW5ndGggPSByYWRpdXMgKiAzLjU7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhbW91bnQgPSBhcmVhIC8gKGxlbmd0aCAqIGxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhbW91bnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vVGhlIG9mZnNldCBpcyB0aGUgYnVmZmVyIGZyb20gdGhlIGVkZ2VzXG4gICAgICAgICAgICAgICAgLy9PcmlnaW5hbCBXaWR0aCBhbmQgSGVpZ2h0IGFyZSBnaXZlbiB0byB0aGUgZm9yY2UgbGF5b3V0XG4gICAgICAgICAgICAgICAgLy9zbyB0aGF0IGl0IGlzIGNlbnRlcmVkLCBidXQgbm9kZXMgd2lsbCBiZSBmb3JjZWQgdG8gYmVcbiAgICAgICAgICAgICAgICAvL3dpdGhpbiB0aGUgb2Zmc2V0IGJvdW5kc1xuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSBjb25zdHMuZGlzcGxheU9mZnNldDtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnV2lkdGggPSBwYXJzZUZsb2F0KHRoaXNHcmFwaC5zdmcuc3R5bGUoXCJ3aWR0aFwiKSk7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z0hlaWdodCA9IHBhcnNlRmxvYXQodGhpc0dyYXBoLnN2Zy5zdHlsZShcImhlaWdodFwiKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBzdmdXaWR0aDtcbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gc3ZnSGVpZ2h0O1xuXG4gICAgICAgICAgICAgICAgdmFyIGFtb3VudCA9IGNhbGNNYXhOb2Rlcyh3aWR0aCAtIDIgKiBvZmZzZXQsIGhlaWdodCAtIDIgKiBvZmZzZXQpO1xuICAgICAgICAgICAgICAgIHZhciBzY2FsZSA9IDE7XG4gICAgICAgICAgICAgICAgaWYgKG5vZGVzLmxlbmd0aCA+IGFtb3VudCkge1xuICAgICAgICAgICAgICAgICAgICBzY2FsZSA9IGFtb3VudCAvIG5vZGVzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKSwgc2NhbGUpO1xuICAgICAgICAgICAgICAgICAgICB3aWR0aCAvPSBzY2FsZTtcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0IC89IHNjYWxlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQodGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKCksIHNjYWxlKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL2NhbGN1bGF0aW5nIGZvY2kgZm9yIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAgICB2YXIgZm9jdXNHcm91cHMgPSBzdGF0ZVBvbGljeS5mb2N1c0dyb3VwcztcbiAgICAgICAgICAgICAgICB2YXIgZm9jaTtcbiAgICAgICAgICAgICAgICBpZiAoZm9jdXNHcm91cHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvY2kgPSBbaGVpZ2h0IC8gMl07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy9zZXR0aW5nIGZvY2kgaGVpZ2h0IHBvc2l0aW9uIGJhc2VkIG9uIHBlcmNlbnRhZ2VcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZvY3VzTm9kZXMgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbZm9jdXNHcm91cHNbMF1dO1xuICAgICAgICAgICAgICAgICAgICBjb25zdHNQb2xpY3kuYm91bmRhcnkgPSBmb2N1c05vZGVzLmxlbmd0aCAvIG5vZGVzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRvcCA9IGhlaWdodCAqIGNvbnN0c1BvbGljeS5ib3VuZGFyeTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJvdCA9IGhlaWdodCAtIHRvcDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRvcCA8IDIgKiB0aGlzR3JhcGguY29uc3RzLm1heFJhZGl1cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3RzUG9saWN5LmJvdW5kYXJ5ID0gMi41ICogdGhpc0dyYXBoLmNvbnN0cy5tYXhSYWRpdXMgLyBoZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3AgPSBoZWlnaHQgKiBjb25zdHNQb2xpY3kuYm91bmRhcnk7XG4gICAgICAgICAgICAgICAgICAgICAgICBib3QgPSBoZWlnaHQgLSB0b3A7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGJvdCA8IDIgKiB0aGlzR3JhcGguY29uc3RzLm1heFJhZGl1cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3RzUG9saWN5LmJvdW5kYXJ5ID0gMSAtIDIuNSAqIHRoaXNHcmFwaC5jb25zdHMubWF4UmFkaXVzIC8gaGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9wID0gaGVpZ2h0ICogY29uc3RzUG9saWN5LmJvdW5kYXJ5O1xuICAgICAgICAgICAgICAgICAgICAgICAgYm90ID0gaGVpZ2h0IC0gdG9wO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZvY2kgPSBbdG9wIC8gMiwgdG9wICsgYm90IC8gMl07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5LmZvY2kgPSBmb2NpO1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHdpZHRoOiB3aWR0aCwgaGVpZ2h0OiBoZWlnaHQgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgYWZ0ZXIgYSBzaW5nbGUgbm9kZSBpcyBzcGxpdFxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBuZXdOb2RlcyAgVGhlIG5ldyBub2Rlc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnc3BsaXROb2RlRXZlbnQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNwbGl0Tm9kZUV2ZW50KG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICBfLmZvckVhY2gobmV3Tm9kZXMsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoXy5pbmNsdWRlcyhjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dLCBkLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImZvY3VzXCI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiY29ubmVjdGVkXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHZhciB0aXRsZSA9IG5ld05vZGVzWzBdLnBhcmVudDtcbiAgICAgICAgICAgICAgICAvLyBzdGF0ZS5mb2N1c0dyb3VwID0gdGl0bGU7XG5cbiAgICAgICAgICAgICAgICAvL2lmIHRoZSBsYXN0IGV2ZW50IGhhcyB0aGUgc2FtZSBpZCwgaXQgbXVzdCBiZSB0aGVcbiAgICAgICAgICAgICAgICAvL29wcHBvc2l0ZSBvZiB0aGlzIGV2ZW50LCBzbyB3ZSByZW1vdmUgdGhhdCBldmVudCBmcm9tXG4gICAgICAgICAgICAgICAgLy90aGUgZXZlbnQgc3RhY2suXG4gICAgICAgICAgICAgICAgLy9PdGhlcndpc2UsIHdlIGFkZCB0aGUgZXZlbnQgb3QgdGhlIHN0YWNrXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggIT09IDAgJiYgc3RhdGUuZXZlbnRIaXN0b3J5W3N0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggLSAxXS5pZCA9PT0gdGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5LnBvcCgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeS5wdXNoKHsgaWQ6IHRpdGxlLCBldmVudDogJ3NwbGl0JyB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuYmFja0J1dHRvbkVsZW0gIT0gbnVsbCAmJiBzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmJhY2tCdXR0b25FbGVtLmZhZGVUbygnc2xvdycsIDEpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS50aXRsZUVsZW0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ICs9IHN0YXRlLmZvY3VzR3JvdXBzWzBdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0gJyAmICcgKyBzdGF0ZS5mb2N1c0dyb3Vwc1sxXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS50aXRsZUVsZW0udGV4dCh0ZXh0KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3JlLWVuYWJsZSBncmFwaCB1cGRhdGVcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3RhdGUuZGlzYWJsZVVwZGF0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kuc2V0TGF5b3V0KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU2V0cyB0aGUgbGF5b3V0IG9mIHRoZSBub2Rlcy4gXG4gICAgICAgICAgICAgKiBJZiB0aGVyZSBpcyBhIHByZXZpb3VzIGxheW91dCwgaXQgd2lsbCBiZSBsb2FkZWQuXG4gICAgICAgICAgICAgKiBFbHNlLCBpdCB3aWxsIHJ1biBhIEQzIEZvcmNlIHNpbXVsYXRpb24gYW5kIGNyZWF0ZSBvbmUuXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdzZXRMYXlvdXQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldExheW91dCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG4gICAgICAgICAgICAgICAgdmFyIGxheW91dDtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGxheW91dCA9IHN0YXRlLmxheW91dERlZmF1bHQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciB6b29tID0gc3RhdGUuem9vbURlZmF1bHQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQoem9vbVswXSwgem9vbVsxXSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSBzdGF0ZS56b29tc1tzdGF0ZS5mb2N1c0dyb3Vwc107XG4gICAgICAgICAgICAgICAgICAgIGlmICh6b29tICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQoem9vbVswXSwgem9vbVsxXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ID0gc3RhdGUubGF5b3V0W3N0YXRlLmZvY3VzR3JvdXBzXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAobGF5b3V0ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb3MgPSBsYXlvdXRbbi5pZF07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocG9zID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhsYXlvdXQsIG4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgbi54ID0gcG9zLng7XG4gICAgICAgICAgICAgICAgICAgICAgICBuLnkgPSBwb3MueTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaC5jYWxsKHRoaXNHcmFwaCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51cGRhdGVHcmFwaENhbGxiYWNrLmNhbGwodGhpc1BvbGljeSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vTmVlZCB0byBydW4gYSBmb3JjZSBzaW11bGF0aW9uIGFzIHRoaXMgbGF5b3V0XG4gICAgICAgICAgICAgICAgICAgIC8vaGFzbid0IGJlZW4gZG9uZSBiZWZvcmVcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN0YXRlLmluaXRGb3JjZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAvLyB0aGlzUG9saWN5LnNldFBvc2l0aW9ucygpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51cGRhdGVHcmFwaENhbGxiYWNrLmNhbGwodGhpc1BvbGljeSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS56b29tc1tzdGF0ZS5mb2N1c0dyb3Vwc10gPSBbdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKCksIHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCldO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGF5b3V0ID0ge307XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYXlvdXRbbi5pZF0gPSB7IHg6IG4ueCwgeTogbi55IH07XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5sYXlvdXRbc3RhdGUuZm9jdXNHcm91cHNdID0gbGF5b3V0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBPdmVycmlkaW5nIGZyb20gc3VwZXIgY2xhc3Mgc28gdGhhdCB3ZSBjYW4gaGF2ZVxuICAgICAgICAgICAgICogdG9wIGxldmVsIG5vZGVzIHJlYXBwZWFyIHdoZW4gdGhleSBhcmUgaGlkZGVuXG4gICAgICAgICAgICAgKiBkdWUgdG8gdGhlcmUgYmVpbmcgdHdvIGZvY3VzIGdyb3Vwcy5cbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgICAgIG5vZGUgICAgVGhlIG5vZGUgdG8gam9pblxuICAgICAgICAgICAgICogQHJldHVybiAgICAge05vZGV9ICBUaGUgbmV3IG5vZGUgYWZ0ZXIgdGhlIGpvaW5cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ19fam9pbk5vZGUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9fam9pbk5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZVN1cGVyID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pbk5vZGVQb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICAvL2NoZWNrIHRoYXQgbm9kZSBzdGlsbCBleGlzdHNcbiAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLm5vZGVzLmluZGV4T2Yobm9kZSkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBub2RlLmlkO1xuICAgICAgICAgICAgICAgIC8vaWYgaXQgaGFzIG5vIGFuY2VzdG9yLCBub3RoaW5nIHRvIGpvaW5cbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRyZW5fc3RydWN0LnRvcExldmVsLmluZGV4T2YobmFtZSkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IG5vZGUucGFyZW50O1xuICAgICAgICAgICAgICAgIHZhciB0b19iZV9kZWxldGVkID0gW107XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVOYW1lU2V0ID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgLy9pZiBub2RlIHdvbid0IGJlIGNvbGxhcHNlZFxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLm5vZGVzW2ldLmFuY2VzdG9ycy5pbmRleE9mKG5vZGUucGFyZW50KSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZU5hbWVTZXQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0uaWQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9fYmVfZGVsZXRlZC5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlX2lkID0gbm9kZS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgbm9kZU5hbWVTZXQucHVzaChub2RlLnBhcmVudCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgYW5jZXN0b3JzX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmFuY2VzdG9yc19zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICAvLyAtIHNldHRpbmcgZm9jdXNHcm91cHMgLVxuICAgICAgICAgICAgICAgIC8vZWl0aGVyIHJlcGxhY2luZyBvbmUgb2YgdGhlIGdyb3VwcyxcbiAgICAgICAgICAgICAgICAvL29yIGpvaW5pbmcgYmFjayBpbnRvIGEgdG9wIGxldmVsLCBzbyB0aGVyZSBpcyBvbmx5XG4gICAgICAgICAgICAgICAgLy9vbmUgZm9jdXNcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBzdGF0ZS5mb2N1c0dyb3Vwcy5pbmRleE9mKHBhcmVudCk7XG4gICAgICAgICAgICAgICAgaWYgKGFuY2VzdG9yc19zdHJ1Y3RbcGFyZW50XSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzW2luZGV4XSA9IGFuY2VzdG9yc19zdHJ1Y3RbcGFyZW50XTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vbmFtZVRvQWRkIGFyZSB0b3AgbGV2ZWwgbm9kZXMgdGhhdCBhcmUgdG8gYmUgYWRkZWRcbiAgICAgICAgICAgICAgICAvL3RvIHRoZSBncmFwaC5cbiAgICAgICAgICAgICAgICB2YXIgbmFtZVRvQWRkID0gW107XG4gICAgICAgICAgICAgICAgLy93aWxsIG9ubHkgbmVlZCB0byBhZGQgYSB0b3AgbGV2ZWwgbm9kZSBpZiB0aGVyZSBpc1xuICAgICAgICAgICAgICAgIC8vb25seSBvbmUgZm9jdXNcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vQWRkIG9ubHkgdGhvc3QgdGhhdCBhcmVuJ3QgYW4gYW5jZXN0b3Igb2YgdGhlIG5vZGVcbiAgICAgICAgICAgICAgICAgICAgLy90byBqb2luLCB0aGUgZm9jdXMgZ3JvdXAgb3IgYW4gYW5jZXN0b3Igb2YgaXQsXG4gICAgICAgICAgICAgICAgICAgIC8vYW5kIGFyZW4ndCBhbHJlYWR5IGluIG5vZGVOYW1lU2V0LlxuICAgICAgICAgICAgICAgICAgICAvL2dldCBmbG93IGJldHdlZW4gdG9wIGxldmVsIGFzIGxvbmcgYXNcbiAgICAgICAgICAgICAgICAgICAgLy90aGUgdG9wIGxldmVsIGlzbid0IGFuIGFuY2VzdG9yIG9mIHRoZVxuICAgICAgICAgICAgICAgICAgICAvL2ZvY3VzIGdyb3VwLCBhbmQgaXNuJ3QgYWxyZWFkeSBwYXJ0IG9mIHRoZVxuICAgICAgICAgICAgICAgICAgICAvL25vZGUgc2V0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgYW5jZXN0b3JzID0gYW5jZXN0b3JzX3N0cnVjdFtub2RlLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3JzLnB1c2goc3RhdGUuZm9jdXNHcm91cHNbMF0pO1xuICAgICAgICAgICAgICAgICAgICAvL3RoZSBvciBlbXB0eSBhcnJheSBpcyB0byBwcmV2ZW50IGNvbmNhdGVuYXRpbmcgYSBudWxsXG4gICAgICAgICAgICAgICAgICAgIC8vb3IgdW5kZWZpbmVkIHZhbHVlXG4gICAgICAgICAgICAgICAgICAgIGFuY2VzdG9ycyA9IGFuY2VzdG9ycy5jb25jYXQoYW5jZXN0b3JzX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV0gfHwgW10pO1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goY2hpbGRyZW5fc3RydWN0LnRvcExldmVsLCBmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFuY2VzdG9ycy5pbmRleE9mKG4pID09PSAtMSAmJiBub2RlTmFtZVNldC5pbmRleE9mKG4pID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkLnB1c2gobik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBub2RlTmFtZVNldCA9IG5vZGVOYW1lU2V0LmNvbmNhdChuYW1lVG9BZGQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vbm8gZm9jdXMgZ3JvdXBzIG1lYW5zIHdlIGFyZSBhdCB0b3AgbGV2ZWxcbiAgICAgICAgICAgICAgICAgICAgLy9TaG91bGQgYWRkIGFueSB0b3AgbGV2ZWwgbm9kZXMgdGhhdCBhcmVuJ3RcbiAgICAgICAgICAgICAgICAgICAgLy9hbHJlYWR5IHRoZXJlXG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChjaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZU5hbWVTZXQuaW5kZXhPZihuKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVUb0FkZC5wdXNoKG4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZU5hbWVTZXQgPSBub2RlTmFtZVNldC5jb25jYXQobmFtZVRvQWRkKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL2Zvcm1hdHRpbmcgZGF0YVxuICAgICAgICAgICAgICAgIHZhciByYWRpdXMgPSBub2RlLnJhZGl1cyAvIHRoaXNHcmFwaC5jb25zdHMucmFkaXVzRGVjYXk7XG4gICAgICAgICAgICAgICAgdmFyIHhMb2MgPSBub2RlLng7XG4gICAgICAgICAgICAgICAgdmFyIHlMb2MgPSBub2RlLnk7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IG5vZGUuYW5jZXN0b3JzWzFdO1xuICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnMgPSBub2RlLmFuY2VzdG9ycy5zbGljZSgxKTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3Tm9kZSA9IG5ldyBWaXN1YWxpemVyTm9kZS5Ob2RlKHhMb2MsIHlMb2MsIG5ld19ub2RlX2lkLCBuZXdfbm9kZV9pZCwgcmFkaXVzLCBwYXJlbnQsIGFuY2VzdG9ycyk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnB1c2gobmV3Tm9kZSk7XG5cbiAgICAgICAgICAgICAgICAvL3JlbW92ZSBhbGwgbm9kZXMgdGhhdCB3aWxsIGJlIGpvaW5lZFxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdG9fYmVfZGVsZXRlZC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZV90b19kZWxldGUgPSB0b19iZV9kZWxldGVkW2ldO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMuc3BsaWNlKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG5vZGVfdG9fZGVsZXRlKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zcGxpY2VMaW5rc0Zvck5vZGUobm9kZV90b19kZWxldGUpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciByZXREYXRhID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuZ2V0Rmxvd0JldHdlZW5TZXQobm9kZU5hbWVTZXQpO1xuICAgICAgICAgICAgICAgIC8vaG9sZHMgdGhlIG5vZGVEYXRhIHdoaWNoIHdpbGwgYmUgcHJvY2Vzc2VkXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzVG9Qcm9jZXNzID0gW107XG4gICAgICAgICAgICAgICAgLy9maW5kaW5nIHRoZSBub2RlIGRhdGEgdGhhdCBjb3JyZXNwb25kcyB0byB0aGUgdG9wIGxldmVsXG4gICAgICAgICAgICAgICAgLy9ub2RlcyB0byBhZGQgLSBuYW1lVG9BZGQuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVEYXRhID0gcmV0RGF0YS5ub2RlRGF0YTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVEYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuYW1lVG9BZGQuaW5kZXhPZihub2RlRGF0YVtpXS5pZCkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1RvUHJvY2Vzcy5wdXNoKG5vZGVEYXRhW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vVGhlIHRvcCBsZXZlbCBub2RlcyB0aGF0IGFyZSBhZGRlZFxuICAgICAgICAgICAgICAgIHZhciBuZXdOb2RlcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NOb2RlRGF0YShub2Rlc1RvUHJvY2Vzcyk7XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKG5ld05vZGVzLCBmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgICAgICAgICBuLnJhZGl1cyA9IG4ucmFkaXVzIHx8IHRoaXNHcmFwaC5jb25zdHMuc3RhcnRSYWRpdXM7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzID0gdGhpc0dyYXBoLm5vZGVzLmNvbmNhdChuZXdOb2Rlcyk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5wcm9jZXNzTGlua0RhdGEocmV0RGF0YS5saW5rRGF0YSwgdGhpc0dyYXBoLm5vZGVzKTtcbiAgICAgICAgICAgICAgICAvL09ubHkga2VlcCB0b3AgbGV2ZWwgbm9kZXMgdGhhdCBoYXZlIGNvbm5lY3Rpb25zIHRvXG4gICAgICAgICAgICAgICAgLy90aGUgY3VycmVudCBmb2N1cyBncm91cFxuICAgICAgICAgICAgICAgIC8vd2UgcmVtb3ZlIHRoZSBub2RlIG5hbWUgZnJvbSBuYW1lVG9BZGQgaWYgd2UgYXJlXG4gICAgICAgICAgICAgICAgLy9rZWVwaW5nIGl0XG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLmxpbmtzLCBmdW5jdGlvbiAobCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9jaGVja2luZyBpZiB0aGVyZSBleGlzdHMgYSBsaW5rIHRvdWNoaW5nIGVhY2ggb2YgbmFtZVRvQWRkXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmFtZVRvQWRkLmluZGV4T2YobC5zb3VyY2UuaWQpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwc1swXSA9PT0gbC50YXJnZXQucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVUb0FkZC5zcGxpY2UobmFtZVRvQWRkLmluZGV4T2YobC5zb3VyY2UuaWQpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5hbWVUb0FkZC5pbmRleE9mKGwudGFyZ2V0LmlkKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHNbMF0gPT09IGwuc291cmNlLnBhcmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lVG9BZGQuc3BsaWNlKG5hbWVUb0FkZC5pbmRleE9mKGwudGFyZ2V0LmlkKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL1dlIHdhbnQgdG8ga2VlcCB0aGVtIGFsbFxuICAgICAgICAgICAgICAgICAgICAvL3NpbmNlIGFueSBsZWZ0IGluIG5hbWVUb0FkZCB3aWxsIGJlIHJlbW92ZWQsXG4gICAgICAgICAgICAgICAgICAgIC8vd2UgcmVzZXQgbmFtZVRvQWRkIGhlcmUuXG4gICAgICAgICAgICAgICAgICAgIG5hbWVUb0FkZCA9IFtdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vd2hhdGV2ZXIgaXMgcmVtYWluaW5nIGluIG5hbWVUb0FkZCBpc24ndCBjb25uZWN0ZWRcbiAgICAgICAgICAgICAgICAvL3RvIHRoZSBmb2N1cyBncm91cCwgc28gd2Ugc2hvdWxkIHJlbW92ZSBpdC5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZVRvUmVtb3ZlID0gW107XG4gICAgICAgICAgICAgICAgaWYgKG5hbWVUb0FkZC5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuYW1lVG9BZGQuaW5kZXhPZih0aGlzR3JhcGgubm9kZXNbaV0uaWQpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVUb0FkZC5zcGxpY2UobmFtZVRvQWRkLmluZGV4T2YodGhpc0dyYXBoLm5vZGVzW2ldLmlkKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZSh0aGlzR3JhcGgubm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVUb1JlbW92ZS5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWVUb0FkZC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF8uZm9yRWFjaChub2RlVG9SZW1vdmUsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5zcGxpY2UodGhpc0dyYXBoLm5vZGVzLmluZGV4T2YobiksIDEpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXROb2RlcygpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0TGlua3MoKTtcblxuICAgICAgICAgICAgICAgIHN0YXRlU3VwZXIuc3BsaXROb2Rlcy5zcGxpY2Uoc3RhdGVTdXBlci5zcGxpdE5vZGVzLmluZGV4T2YobmV3Tm9kZS5pZCksIDEpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ld05vZGU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIGFmdGVyIGEgc2luZ2xlIG5vZGUgaXMgam9pbmVkXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIElmIHRoZSBmb2N1cyBncm91cCBoYXMgYmVlbiBzZWVuIGJlZm9yZSwgaXQgd2lsbFxuICAgICAgICAgICAgICogbG9hZCB0aGF0IGxheW91dC4gT3RoZXJ3aXNlLCBpdCB3aWxsIHJ1biBhIGQzIGZvcmNlXG4gICAgICAgICAgICAgKiBzaW11bGF0aW9uIHRvIGdlbmVyYXRlIG9uZS5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5ld05vZGUgIFRoZSBuZXcgbm9kZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnam9pbk5vZGVFdmVudCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gam9pbk5vZGVFdmVudChuZXdOb2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kgPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgLy9pZiB0aGUgbGFzdCBldmVudCBoYXMgdGhlIHNhbWUgaWQsIGl0IG11c3QgYmUgdGhlXG4gICAgICAgICAgICAgICAgLy9vcHBwb3NpdGUgb2YgdGhpcyBldmVudCwgc28gd2UgcmVtb3ZlIHRoYXQgZXZlbnQgZnJvbVxuICAgICAgICAgICAgICAgIC8vdGhlIGV2ZW50IHN0YWNrLlxuICAgICAgICAgICAgICAgIC8vT3RoZXJ3aXNlLCB3ZSBhZGQgdGhlIGV2ZW50IHRvIHRoZSBzdGFja1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoICE9PSAwICYmIHN0YXRlLmV2ZW50SGlzdG9yeVtzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoIC0gMV0uaWQgPT09IG5ld05vZGUuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5LnBvcCgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeS5wdXNoKHsgaWQ6IG5ld05vZGUuaWQsIGV2ZW50OiAnam9pbicgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcblxuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoXy5pbmNsdWRlcyhjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dLCBkLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImZvY3VzXCI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiY29ubmVjdGVkXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vc2V0dGluZyBiYWNrIGJ1dHRvblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5iYWNrQnV0dG9uRWxlbSAhPSBudWxsICYmIHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuYmFja0J1dHRvbkVsZW0uZmFkZVRvKCdzbG93JywgMCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9zZXR0aW5nIHRpdGxlXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLnRpdGxlRWxlbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0gc3RhdGUuZm9jdXNHcm91cHNbMF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSAnICYgJyArIHN0YXRlLmZvY3VzR3JvdXBzWzFdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLnRpdGxlRWxlbS50ZXh0KHRleHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnNldExheW91dCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVuZG9lcyB0aGUgbGFzdCBzcGxpdCBvciBqb2luIGV2ZW50LlxuICAgICAgICAgICAgICogTWVhbnQgdG8gYmUgY2FsbGVkIGJ5IHRoZSBiYWNrIGJ1dHRvbi5cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3VuZG9MYXN0RXZlbnQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVuZG9MYXN0RXZlbnQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kgPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdmFyIGxhc3QgPSBzdGF0ZS5ldmVudEhpc3Rvcnlbc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgIHZhciBpZCA9IGxhc3QuaWQ7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGU7XG4gICAgICAgICAgICAgICAgaWYgKGxhc3QuZXZlbnQgPT09ICdqb2luJykge1xuICAgICAgICAgICAgICAgICAgICBub2RlID0gdGhpc0dyYXBoLmZpbmROb2RlQnlJZChpZCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkM25vZGUgPSB0aGlzR3JhcGguZmluZEQzTm9kZShpZCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kuZGJsY2xpY2soZDNub2RlLCBub2RlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZUlkID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0W2lkXVswXTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZSA9IHRoaXNHcmFwaC5maW5kTm9kZUJ5SWQobm9kZUlkKTtcbiAgICAgICAgICAgICAgICAgICAgX2dldChTcGxpdEpvaW5WaWV3UG9saWN5LnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFNwbGl0Sm9pblZpZXdQb2xpY3kucHJvdG90eXBlKSwgJ2pvaW5Ob2RlJywgdGhpcykuY2FsbCh0aGlzUG9saWN5LCBub2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1dKTtcblxuICAgICAgICByZXR1cm4gU3BsaXRKb2luVmlld1BvbGljeTtcbiAgICB9KFNwbGl0Sm9pbk5vZGVQb2xpY3kuUG9saWN5KTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIFBvbGljeTogU3BsaXRKb2luVmlld1BvbGljeVxuICAgIH07XG59XSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzJywge1xuICAgICAgICAgICAgdXJsOiAnL25vZGVzJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm9yZ2FuaXphdGlvbnMnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdjb250aXYubWVudS5vcmdhbml6YXRpb25zJywge1xuICAgICAgICAgICAgdXJsOiAnL29yZ2FuaXphdGlvbnMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zZXJ2aWNlbGJzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzJywge1xuICAgICAgICAgICAgdXJsOiAnL3NlcnZpY2VsYnMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXBcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc2V0dGluZ3MnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzJywge1xuICAgICAgICAgICAgdXJsOiAnL2dsb2JhbCcsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9zZXR0aW5ncycsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NldHRpbmdzL3NldHRpbmdzbWVudS5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLmxvZ3MnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbG9ncycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLmF1dGgnLCB7XG4gICAgICAgICAgICB1cmw6ICcvYXV0aCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLmxpY2Vuc2UnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGljZW5zZScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLnBvbGljaWVzJywge1xuICAgICAgICAgICAgdXJsOiAnL3BvbGljaWVzJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICcnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcnXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zdG9yYWdlcG9saWNpZXMnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcycsIHtcbiAgICAgICAgICAgIHVybDogJy9zdG9yYWdlcG9saWNpZXMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXBcblxuXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJywgXG5cdCdjb250aXYuZ3JhcGgnXSlcbiAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2NvbnRpdi5tZW51LnZpc3VhbGl6YXRpb24nLCB7XG4gICAgICAgICAgICB1cmw6ICcvdmlzdWFsaXphdGlvbicsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSlcbiAgICB9XSk7XG5cbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52b2x1bWVzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52b2x1bWVzJywge1xuICAgICAgICAgICAgdXJsOiAnL3ZvbHVtZXMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXBcbid1c2Ugc3RyaWN0Jztcbi8vIERlY2xhcmUgYXBwIGxldmVsIG1vZHVsZSB3aGljaCBkZXBlbmRzIG9uIHZpZXdzLCBhbmQgY29tcG9uZW50c1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdkFwcCcsIFtcbiAgICAndWkucm91dGVyJyxcbiAgICAnY29udGl2LmxvZ2luJyxcbiAgICAnY29udGl2Lm1lbnUnLFxuICAgICdjb250aXYuZGFzaGJvYXJkJyxcbiAgICAnY29udGl2LmFwcGxpY2F0aW9uZ3JvdXBzJyxcbiAgICAnY29udGl2Lm5ldHdvcmtzJyxcbiAgICAnY29udGl2Lm5ldHdvcmtwb2xpY2llcycsXG4gICAgJ2NvbnRpdi5zdG9yYWdlcG9saWNpZXMnLFxuICAgICdjb250aXYuc2VydmljZWxicycsXG4gICAgJ2NvbnRpdi52b2x1bWVzJyxcbiAgICAnY29udGl2Lm5vZGVzJyxcbiAgICAnY29udGl2Lm9yZ2FuaXphdGlvbnMnLFxuICAgICdjb250aXYuc2V0dGluZ3MnLFxuICAgICdjb250aXYudmlzdWFsaXphdGlvbidcbl0pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgJyR1cmxSb3V0ZXJQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdicsIHtcbiAgICAgICAgICAgIHVybDogJycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgZmx1aWQgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSk7XG4gICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMTEvMTYuXG4gKi9cbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8xMC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5hcHBsaWNhdGlvbmdyb3VwcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0FwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsIGFzIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwbGljYXRpb25ncm91cHMvYXBwbGljYXRpb25ncm91cGNyZWF0ZS5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignQXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwnLCBbXG4gICAgJyRzdGF0ZScsXG4gICAgJyRzdGF0ZVBhcmFtcycsXG4gICAgJ0FwcGxpY2F0aW9uR3JvdXBzTW9kZWwnLFxuICAgICdOZXR3b3Jrc01vZGVsJyxcbiAgICAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgQXBwbGljYXRpb25Hcm91cHNNb2RlbCwgTmV0d29ya3NNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsID0gdGhpcztcbiAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwubmV0d29ya3MgPSBbXTtcbiAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwuYXBwbGljYXRpb25Hcm91cCA9IHt9O1xuICAgICAgICBhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybC5zZWxlY3RlZE5ldHdvcmsgPSB7fTtcbiAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwubW9kZSA9IFwiZWRpdFwiO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub0FwcGxpY2F0aW9uR3JvdXAoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxDcmVhdGluZygpIHtcbiAgICAgICAgICAgIHJldHVyblRvQXBwbGljYXRpb25Hcm91cCgpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZXQgbmV0d29ya3MgZm9yIHRoZSBnaXZlbiB0ZW5hbnQuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBnZXROZXR3b3JrcygpIHtcbiAgICAgICAgICAgIE5ldHdvcmtzTW9kZWwuZ2V0KCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwubmV0d29ya3MgPSBfLmZpbHRlcihyZXN1bHQsIHtcbiAgICAgICAgICAgICAgICAgICAgJ3RlbmFudE5hbWUnOiAnZGVmYXVsdCcgLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUFwcGxpY2F0aW9uR3JvdXAoKSB7XG4gICAgICAgICAgICAvL2Zvcm0gY29udHJvbGxlciBpcyBpbmplY3RlZCBieSB0aGUgaHRtbCB0ZW1wbGF0ZVxuICAgICAgICAgICAgLy9jaGVja2luZyBpZiBhbGwgdmFsaWRhdGlvbnMgaGF2ZSBwYXNzZWRcbiAgICAgICAgICAgIGlmIChhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLmFwcGxpY2F0aW9uR3JvdXAubmV0d29ya05hbWUgPVxuICAgICAgICAgICAgICAgICAgICBhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybC5zZWxlY3RlZE5ldHdvcmsubmV0d29ya05hbWU7XG4gICAgICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwuYXBwbGljYXRpb25Hcm91cC5rZXkgPVxuICAgICAgICAgICAgICAgICAgICBBcHBsaWNhdGlvbkdyb3Vwc01vZGVsLmdlbmVyYXRlS2V5KGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLmFwcGxpY2F0aW9uR3JvdXApO1xuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIGFwcGxpY2F0aW9uR3JvdXAgY29uc2lzdCBvZiBHcm91cCBOYW1lLCBOZXR3b3JrIE5hbWUsIElzb2xhdGlvbiBQb2xpY2llcywgQmFuZHdpZHRoIFBvbGljeVxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwuY3JlYXRlKGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLmFwcGxpY2F0aW9uR3JvdXApLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9BcHBsaWNhdGlvbkdyb3VwKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXNldEZvcm0oKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybC5hcHBsaWNhdGlvbkdyb3VwID0ge1xuICAgICAgICAgICAgICAgIGdyb3VwTmFtZTogJycsXG4gICAgICAgICAgICAgICAgbmV0d29ya05hbWU6ICcnLFxuICAgICAgICAgICAgICAgIHBvbGljaWVzOiBbXSxcbiAgICAgICAgICAgICAgICBuZXRQcm9maWxlOiAnJyxcbiAgICAgICAgICAgICAgICB0ZW5hbnROYW1lOiAnZGVmYXVsdCcgLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgZ2V0TmV0d29ya3MoKTtcbiAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwuY3JlYXRlQXBwbGljYXRpb25Hcm91cCA9IGNyZWF0ZUFwcGxpY2F0aW9uR3JvdXA7XG4gICAgICAgIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLmNhbmNlbENyZWF0aW5nID0gY2FuY2VsQ3JlYXRpbmc7XG4gICAgICAgIHJlc2V0Rm9ybSgpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcGxpY2F0aW9uZ3JvdXBjcmVhdGVjdHJsLmpzLm1hcFxuLyoqXG4qIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMTUvMTYuXG4qL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5hcHBsaWNhdGlvbmdyb3VwcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwgYXMgYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwbGljYXRpb25ncm91cHMvYXBwbGljYXRpb25ncm91cGRldGFpbHMuaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMuZWRpdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9lZGl0LzprZXknLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0FwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCBhcyBhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHBsaWNhdGlvbmdyb3Vwcy9hcHBsaWNhdGlvbmdyb3VwZGV0YWlscy5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignQXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsJywgW1xuICAgICckc3RhdGUnLFxuICAgICckc3RhdGVQYXJhbXMnLFxuICAgICdBcHBsaWNhdGlvbkdyb3Vwc01vZGVsJyxcbiAgICAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgQXBwbGljYXRpb25Hcm91cHNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCA9IHRoaXM7XG4gICAgICAgIGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybC5hcHBsaWNhdGlvbkdyb3VwID0ge307XG4gICAgICAgIGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybC5zZWxlY3RlZE5ldHdvcmsgPSB7fTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRvIHNob3cgZWRpdCBvciBkZXRhaWxzIHNjcmVlbiBiYXNlZCBvbiB0aGUgcm91dGVcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHNldE1vZGUoKSB7XG4gICAgICAgICAgICBpZiAoJHN0YXRlLmlzKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3Vwcy5lZGl0JykpIHtcbiAgICAgICAgICAgICAgICBhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwubW9kZSA9ICdlZGl0JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybC5tb2RlID0gJ2RldGFpbHMnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvQXBwbGljYXRpb25Hcm91cCgpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMubGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvQXBwbGljYXRpb25Hcm91cERldGFpbHMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmRldGFpbHMnLCB7ICdrZXknOiBhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwuYXBwbGljYXRpb25Hcm91cC5rZXkgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsRWRpdGluZygpIHtcbiAgICAgICAgICAgIHJldHVyblRvQXBwbGljYXRpb25Hcm91cERldGFpbHMoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBkZWxldGVBcHBsaWNhdGlvbkdyb3VwKCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgQXBwbGljYXRpb25Hcm91cHNNb2RlbC5kZWxldGUoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLmFwcGxpY2F0aW9uR3JvdXApLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICByZXR1cm5Ub0FwcGxpY2F0aW9uR3JvdXAoKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBzYXZlQXBwbGljYXRpb25Hcm91cCgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwuc2F2ZShhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwuYXBwbGljYXRpb25Hcm91cCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIHJldHVyblRvQXBwbGljYXRpb25Hcm91cERldGFpbHMoKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwpO1xuICAgICAgICBBcHBsaWNhdGlvbkdyb3Vwc01vZGVsLmdldE1vZGVsQnlLZXkoJHN0YXRlUGFyYW1zLmtleSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChncm91cCkge1xuICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLmFwcGxpY2F0aW9uR3JvdXAgPSBncm91cDtcbiAgICAgICAgfSk7XG4gICAgICAgIGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybC5zYXZlQXBwbGljYXRpb25Hcm91cCA9IHNhdmVBcHBsaWNhdGlvbkdyb3VwO1xuICAgICAgICBhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwuY2FuY2VsRWRpdGluZyA9IGNhbmNlbEVkaXRpbmc7XG4gICAgICAgIGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybC5kZWxldGVBcHBsaWNhdGlvbkdyb3VwID0gZGVsZXRlQXBwbGljYXRpb25Hcm91cDtcbiAgICAgICAgc2V0TW9kZSgpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcGxpY2F0aW9uZ3JvdXBkZXRhaWxzY3RybC5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8xMS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5hcHBsaWNhdGlvbmdyb3VwcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQXBwbGljYXRpb25Hcm91cExpc3RDdHJsIGFzIGFwcGxpY2F0aW9uR3JvdXBMaXN0Q3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcGxpY2F0aW9uZ3JvdXBzL2FwcGxpY2F0aW9uZ3JvdXBsaXN0Lmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdBcHBsaWNhdGlvbkdyb3VwTGlzdEN0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdBcHBsaWNhdGlvbkdyb3Vwc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBhcHBsaWNhdGlvbkdyb3VwTGlzdEN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBnZXRBcHBsaWNhdGlvbkdyb3VwcyhyZWxvYWQpIHtcbiAgICAgICAgICAgIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihhcHBsaWNhdGlvbkdyb3VwTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBMaXN0Q3RybC5ncm91cHMgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYXBwbGljYXRpb25Hcm91cExpc3RDdHJsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vTG9hZCBmcm9tIGNhY2hlIGZvciBxdWljayBkaXNwbGF5IGluaXRpYWxseVxuICAgICAgICBnZXRBcHBsaWNhdGlvbkdyb3VwcyhmYWxzZSk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IHN0YXJ0IGF1dG8tcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXRBcHBsaWNhdGlvbkdyb3Vwcyh0cnVlKTtcbiAgICAgICAgICAgIH0sIDUwMDApO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHBsaWNhdGlvbmdyb3VwbGlzdGN0cmwuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgaGFyZGlrIGdhbmRoaSBvbiA2LzI4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5hcHBsaWNhdGlvbmdyb3Vwc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZCYW5kd2lkdGhwb2xpY3lcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBtb2RlOiBcIj1cIixcbiAgICAgICAgICAgIGFwcGxpY2F0aW9uZ3JvdXA6ICc9J1xuICAgICAgICB9LFxuICAgICAgICBjb250cm9sbGVyOiBbXG4gICAgICAgICAgICAnJHNjb3BlJyxcbiAgICAgICAgICAgICdOZXRwcm9maWxlc01vZGVsJyxcbiAgICAgICAgICAgIGZ1bmN0aW9uICgkc2NvcGUsIE5ldHByb2ZpbGVzTW9kZWwpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUubmV0UHJvZmlsZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWROZXRwcm9maWxlID0ge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3k6IHt9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBHZXQgcHJvZmlsZXMgZm9yIHRoZSBnaXZlbiB0ZW5hbnQuXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0TmV0cHJvZmlsZXMoKSB7XG4gICAgICAgICAgICAgICAgICAgIE5ldHByb2ZpbGVzTW9kZWwuZ2V0KCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubmV0UHJvZmlsZXMgPSBfLmZpbHRlcihyZXN1bHQsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndGVuYW50TmFtZSc6ICdkZWZhdWx0JyAvL1RPRE86IFJlbW92ZSBoYXJkY29kZWQgdGVuYW50LlxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmFwcGxpY2F0aW9uZ3JvdXAubmV0UHJvZmlsZSAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWROZXRwcm9maWxlLnBvbGljeSA9IF8uZmluZCgkc2NvcGUubmV0UHJvZmlsZXMsIGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBvbGljeS5wcm9maWxlTmFtZSA9PT0gJHNjb3BlLmFwcGxpY2F0aW9uZ3JvdXAubmV0UHJvZmlsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIEFzc2lnbiBwcm9maWxlTmFtZSB0byBhcHBsaWNhdGlvbmdyb3VwIHdoaWNoZXZlciB1c2VyIGhhcyBnaXZlblxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICRzY29wZS51cGRhdGVBcHBsaWNhdGlvbmdyb3VwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnNlbGVjdGVkTmV0cHJvZmlsZS5wb2xpY3kgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hcHBsaWNhdGlvbmdyb3VwLm5ldFByb2ZpbGUgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hcHBsaWNhdGlvbmdyb3VwLm5ldFByb2ZpbGUgPSAkc2NvcGUuc2VsZWN0ZWROZXRwcm9maWxlLnBvbGljeS5wcm9maWxlTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgZ2V0TmV0cHJvZmlsZXMoKTtcbiAgICAgICAgICAgIH1dLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcGxpY2F0aW9uZ3JvdXBzL2JhbmR3aWR0aHBvbGljeS5odG1sJ1xuICAgIH07XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJhbmR3aWR0aHBvbGljeWRpcmVjdGl2ZS5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSBoYXJkaWsgZ2FuZGhpIG9uIDcvOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoXCJjb250aXYuYXBwbGljYXRpb25ncm91cHNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2SXNvbGF0aW9ucG9saWN5XCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgbW9kZTogJz0nLFxuICAgICAgICAgICAgYXBwbGljYXRpb25ncm91cDogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIGNvbnRyb2xsZXI6IFtcbiAgICAgICAgICAgICckc2NvcGUnLFxuICAgICAgICAgICAgJyRzdGF0ZVBhcmFtcycsXG4gICAgICAgICAgICAnQXBwbGljYXRpb25Hcm91cHNNb2RlbCcsXG4gICAgICAgICAgICAnUG9saWNpZXNNb2RlbCcsXG4gICAgICAgICAgICAnUnVsZXNNb2RlbCcsXG4gICAgICAgICAgICBmdW5jdGlvbiAoJHNjb3BlLCAkc3RhdGVQYXJhbXMsIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwsIFBvbGljaWVzTW9kZWwsIFJ1bGVzTW9kZWwpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuaW5jb21pbmdSdWxlcyA9IFtdO1xuICAgICAgICAgICAgICAgICRzY29wZS5vdXRnb2luZ1J1bGVzID0gW107XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkUG9saWN5ID0ge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3k6IHt9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWRQb2xpY2llcyA9IFtdOyAvLyBUbyBTdG9yZSBwb2xpY2llcyBzZWxlY3RlZCBieSB1c2VyIHRvIGRpc3BsYXlcbiAgICAgICAgICAgICAgICAkc2NvcGUuaXNvbGF0aW9uUG9saWNpZXMgPSBbXTsgLy8gVG8gR2V0IGFsbCBpc29sYXRpb24gcG9saWNpZXMgb2YgdGVuYW50XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogR2V0IGluY29taW5nIGFuZCBvdXRnb2luZyBydWxlcyBmb3IgZWFjaCBwb2xpY3kgcHJlc2VudCBpbiBhcHBsaWNhdGlvbmdyb3VwXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0UnVsZXMoKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5hcHBsaWNhdGlvbmdyb3VwLnBvbGljaWVzLmZvckVhY2goZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9UbyBkaXNwbGF5IHJ1bGVzIG9mIHNlbGVjdGVkIHBvbGljaWVzXG4gICAgICAgICAgICAgICAgICAgICAgICBSdWxlc01vZGVsLmdldEluY29taW5nUnVsZXMocG9saWN5LCAnZGVmYXVsdCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJ1bGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoJHNjb3BlLmluY29taW5nUnVsZXMsIHJ1bGVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgUnVsZXNNb2RlbC5nZXRPdXRnb2luZ1J1bGVzKHBvbGljeSwgJ2RlZmF1bHQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChydWxlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KCRzY29wZS5vdXRnb2luZ1J1bGVzLCBydWxlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIEdldCBwb2xpY2llcyBmb3IgdGhlIGdpdmVuIHRlbmFudC5cbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZXRJc29sYXRpb25Qb2xpY2llcygpIHtcbiAgICAgICAgICAgICAgICAgICAgUG9saWNpZXNNb2RlbC5nZXQoKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5pc29sYXRpb25Qb2xpY2llcyA9IF8uZmlsdGVyKHJlc3VsdCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0ZW5hbnROYW1lJzogJ2RlZmF1bHQnIC8vVE9ETzogUmVtb3ZlIGhhcmRjb2RlZCB0ZW5hbnQuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIEFkZCBwb2xpY3kgdG8gYXBwbGljYXRpb24gZ3JvdXBcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAkc2NvcGUuYWRkSXNvbGF0aW9uUG9saWN5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudFBvbGljeU5hbWUgPSAkc2NvcGUuc2VsZWN0ZWRQb2xpY3kucG9saWN5LnBvbGljeU5hbWU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50UG9saWN5TmFtZSAhPT0gdW5kZWZpbmVkICYmIF8uaW5jbHVkZXMoJHNjb3BlLnNlbGVjdGVkUG9saWNpZXMsIGN1cnJlbnRQb2xpY3lOYW1lKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9UbyBkaXNwbGF5IHNlbGVjdGVkIHBvbGljaWVzXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWRQb2xpY2llcy5wdXNoKGN1cnJlbnRQb2xpY3lOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vVG8gZGlzcGxheSBydWxlcyBvZiBzZWxlY3RlZCBwb2xpY2llc1xuICAgICAgICAgICAgICAgICAgICAgICAgUnVsZXNNb2RlbC5nZXRJbmNvbWluZ1J1bGVzKGN1cnJlbnRQb2xpY3lOYW1lLCAnZGVmYXVsdCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJ1bGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoJHNjb3BlLmluY29taW5nUnVsZXMsIHJ1bGVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgUnVsZXNNb2RlbC5nZXRPdXRnb2luZ1J1bGVzKGN1cnJlbnRQb2xpY3lOYW1lLCAnZGVmYXVsdCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJ1bGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoJHNjb3BlLm91dGdvaW5nUnVsZXMsIHJ1bGVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9UbyBiZSBhZGRlZCB0byBhcHBsaWNhdGlvbiBncm91cCBhbmQgc2F2ZWQgdG8gdGhlIHNlcnZlclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFwcGxpY2F0aW9uZ3JvdXAucG9saWNpZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucHVzaChjdXJyZW50UG9saWN5TmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIFJlbW92ZSBwb2xpY3kgZnJvbSBhcHBsaWNhdGlvbiBncm91cFxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICRzY29wZS5yZW1vdmVJc29sYXRpb25Qb2xpY3kgPSBmdW5jdGlvbiAocG9saWN5TmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBfLnJlbW92ZSgkc2NvcGUuc2VsZWN0ZWRQb2xpY2llcywgZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBvbGljeSA9PT0gcG9saWN5TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIF8ucmVtb3ZlKCRzY29wZS5hcHBsaWNhdGlvbmdyb3VwLnBvbGljaWVzLCBmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcG9saWN5ID09PSBwb2xpY3lOYW1lO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgXy5yZW1vdmUoJHNjb3BlLmluY29taW5nUnVsZXMsIGZ1bmN0aW9uIChydWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcnVsZS5wb2xpY3lOYW1lID09PSBwb2xpY3lOYW1lO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgXy5yZW1vdmUoJHNjb3BlLm91dGdvaW5nUnVsZXMsIGZ1bmN0aW9uIChydWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcnVsZS5wb2xpY3lOYW1lID09PSBwb2xpY3lOYW1lO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqICBUbyBjaGVjayAnZGV0YWlscycgb3IgJ2VkaXQnIG1vZGUgKG5vdCBjcmVhdGUgbW9kZSlcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLm1vZGUgPT0gJ2RldGFpbHMnIHx8ICgkc2NvcGUubW9kZSA9PSAnZWRpdCcgJiYgJHNjb3BlLmFwcGxpY2F0aW9uZ3JvdXAuZ3JvdXBOYW1lICE9IFwiXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vQXBwbGljYXRpb24gR3JvdXBzIG1pZ2h0IG5vdCBoYXZlIGFueSBwb2xpY2llcyBhc3NvY2lhdGVkIHdpdGggdGhlbSBzbyBkZWZpbmUgYW4gZW1wdHkgYXJyYXlcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5hcHBsaWNhdGlvbmdyb3VwLnBvbGljaWVzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hcHBsaWNhdGlvbmdyb3VwLnBvbGljaWVzID0gW107XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZ2V0UnVsZXMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZ2V0SXNvbGF0aW9uUG9saWNpZXMoKTtcbiAgICAgICAgICAgIH1dLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcGxpY2F0aW9uZ3JvdXBzL2lzb2xhdGlvbnBvbGljeS5odG1sJ1xuICAgIH07XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWlzb2xhdGlvbnBvbGljeWRpcmVjdGl2ZS5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5sb2dpbicpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5sb2dpbicsIHtcbiAgICAgICAgICAgIHVybDogJy8nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdsb2dpbi9sb2dpbi5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdMb2dpbkN0cmwgYXMgbG9naW5DdHJsJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTG9naW5DdHJsJywgWyckc3RhdGUnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBsb2dpbkN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub0Rhc2hib2FyZCgpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuZGFzaGJvYXJkJywgeyB1c2VybmFtZTogbG9naW5DdHJsLnVzZXJuYW1lIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGxvZ2luKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9EYXNoYm9hcmQoKTtcbiAgICAgICAgfVxuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGxvZ2luQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihsb2dpbkN0cmwpO1xuICAgICAgICBsb2dpbkN0cmwubG9naW4gPSBsb2dpbjtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1sb2dpbmN0cmwuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubWVudScpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Jywge1xuICAgICAgICAgICAgdXJsOiAnL20nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdtZW51L21lbnUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTWVudUN0cmwgYXMgbWVudUN0cmwnLFxuICAgICAgICAgICAgcGFyYW1zOiB7IHVzZXJuYW1lOiBudWxsIH1cbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ01lbnVDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zKSB7XG4gICAgICAgIHZhciBtZW51Q3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGxvZ291dCgpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2LmxvZ2luJyk7XG4gICAgICAgIH1cbiAgICAgICAgbWVudUN0cmwudXNlcm5hbWUgPSAkc3RhdGVQYXJhbXMudXNlcm5hbWU7XG4gICAgICAgIG1lbnVDdHJsLmxvZ291dCA9IGxvZ291dDtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tZW51Q3RybC5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSBoYXJkaWsgZ2FuZGhpIG9uIDYvMjQvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2Lm5ldHdvcmtwb2xpY2llc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZCYW5kd2lkdGhcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBiYW5kd2lkdGhQb2xpY3k6ICc9JyxcbiAgICAgICAgICAgIG1vZGU6IFwiQFwiXG4gICAgICAgIH0sXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSkge1xuICAgICAgICAgICAgaWYgKHNjb3BlLmJhbmR3aWR0aFBvbGljeS5iYW5kd2lkdGggIT0gJycpIHtcbiAgICAgICAgICAgICAgICB2YXIgYmFuZHdpZHRoQXJyYXkgPSBzY29wZS5iYW5kd2lkdGhQb2xpY3kuYmFuZHdpZHRoLnNwbGl0KCcgJyk7XG4gICAgICAgICAgICAgICAgc2NvcGUuYmFuZHdpZHRoUG9saWN5LmJhbmR3aWR0aE51bWJlciA9IE51bWJlcihiYW5kd2lkdGhBcnJheVswXSk7XG4gICAgICAgICAgICAgICAgc2NvcGUuYmFuZHdpZHRoUG9saWN5LmJhbmR3aWR0aFVuaXQgPSBiYW5kd2lkdGhBcnJheVsxXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3JrX3BvbGljaWVzL2JhbmR3aWR0aC5odG1sJ1xuICAgIH07XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJhbmR3aWR0aGRpcmVjdGl2ZS5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSBoYXJkaWsgZ2FuZGhpIG9uIDYvMTYvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3BvbGljaWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmJhbmR3aWR0aC5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwgYXMgYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3JrX3BvbGljaWVzL2JhbmR3aWR0aHBvbGljeWRldGFpbHMuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGguZWRpdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9lZGl0LzprZXknLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0JhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsIGFzIGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmV0d29ya19wb2xpY2llcy9iYW5kd2lkdGhwb2xpY3lkZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdCYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCcsIFtcbiAgICAnJHN0YXRlJyxcbiAgICAnJHN0YXRlUGFyYW1zJyxcbiAgICAnTmV0cHJvZmlsZXNNb2RlbCcsXG4gICAgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIE5ldHByb2ZpbGVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCA9IHRoaXM7XG4gICAgICAgIGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLmJhbmR3aWR0aFByb2ZpbGVzID0gW107XG4gICAgICAgIC8qIEdldCBwYXJ0aWN1bGFyIFByb2ZpbGUgZm9yIGJhc2VkIG9uIGtleSovXG4gICAgICAgIE5ldHByb2ZpbGVzTW9kZWwuZ2V0TW9kZWxCeUtleSgkc3RhdGVQYXJhbXMua2V5KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwucG9saWN5ID0gcG9saWN5O1xuICAgICAgICB9KTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRvIHNob3cgZWRpdCBvciBkZXRhaWxzIHNjcmVlbiBiYXNlZCBvbiB0aGUgcm91dGVcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHNldE1vZGUoKSB7XG4gICAgICAgICAgICBpZiAoJHN0YXRlLmlzKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuYmFuZHdpZHRoLmVkaXQnKSkge1xuICAgICAgICAgICAgICAgIGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLm1vZGUgPSAnZWRpdCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybC5tb2RlID0gJ2RldGFpbHMnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGRlbGV0ZVBvbGljeSgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBOZXRwcm9maWxlc01vZGVsLmRlbGV0ZVVzaW5nS2V5KGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLnBvbGljeS5rZXksICduYW1lJykudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9Qb2xpY2llcygpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1BvbGljaWVzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMubGlzdC5iYW5kd2lkdGgnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1BvbGljeURldGFpbHMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGguZGV0YWlscycsIHsgJ2tleSc6IGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLnBvbGljeS5rZXkgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsRWRpdGluZygpIHtcbiAgICAgICAgICAgIHJldHVyblRvUG9saWN5RGV0YWlscygpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHNhdmVQb2xpY3koKSB7XG4gICAgICAgICAgICAvL2Zvcm0gY29udHJvbGxlciBpcyBpbmplY3RlZCBieSB0aGUgaHRtbCB0ZW1wbGF0ZVxuICAgICAgICAgICAgLy9jaGVja2luZyBpZiBhbGwgdmFsaWRhdGlvbnMgaGF2ZSBwYXNzZWRcbiAgICAgICAgICAgIGlmIChiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLnBvbGljeS5iYW5kd2lkdGggPSBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kuYmFuZHdpZHRoTnVtYmVyICsgXCIgXCIgKyBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kuYmFuZHdpZHRoVW5pdDtcbiAgICAgICAgICAgICAgICBOZXRwcm9maWxlc01vZGVsLnNhdmUoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwucG9saWN5KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvUG9saWN5RGV0YWlscygpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgIHNldE1vZGUoKTtcbiAgICAgICAgYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwuZGVsZXRlUG9saWN5ID0gZGVsZXRlUG9saWN5O1xuICAgICAgICBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybC5zYXZlUG9saWN5ID0gc2F2ZVBvbGljeTtcbiAgICAgICAgYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwuY2FuY2VsRWRpdGluZyA9IGNhbmNlbEVkaXRpbmc7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YmFuZHdpZHRocG9saWN5ZGV0YWlsc2N0cmwuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgaGFyZGlrIGdhbmRoaSBvbiA2LzE0LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtwb2xpY2llcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5saXN0LmJhbmR3aWR0aCcsIHtcbiAgICAgICAgICAgIHVybDogJy9iYW5kd2lkdGgnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0JhbmR3aWR0aFBvbGljeUxpc3RDdHJsIGFzIGJhbmR3aWR0aFBvbGljeUxpc3RDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmV0d29ya19wb2xpY2llcy9iYW5kd2lkdGhwb2xpY3lsaXN0Lmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdCYW5kd2lkdGhQb2xpY3lMaXN0Q3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ05ldHByb2ZpbGVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgTmV0cHJvZmlsZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHBvbGljaWVzTGlzdEN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBnZXRQb2xpY2llcyhyZWxvYWQpIHtcbiAgICAgICAgICAgIE5ldHByb2ZpbGVzTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihwb2xpY2llc0xpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICBwb2xpY2llc0xpc3RDdHJsLnBvbGljaWVzID0gJGZpbHRlcignb3JkZXJCeScpKHJlc3VsdCwgJ3Byb2ZpbGVOYW1lJyk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIocG9saWNpZXNMaXN0Q3RybCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgZ2V0UG9saWNpZXModHJ1ZSk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IHN0YXJ0IGF1dG8tcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXRQb2xpY2llcyh0cnVlKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJhbmR3aWR0aHBvbGljeWxpc3RjdHJsLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3BvbGljaWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbi5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnSXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwgYXMgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3JrX3BvbGljaWVzL2lzb2xhdGlvbnBvbGljeWRldGFpbHMuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5pc29sYXRpb24uZWRpdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9lZGl0LzprZXknLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0lzb2xhdGlvblBvbGljeURldGFpbHNDdHJsIGFzIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmV0d29ya19wb2xpY2llcy9pc29sYXRpb25wb2xpY3lkZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdJc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCcsIFtcbiAgICAnJHN0YXRlJyxcbiAgICAnJHN0YXRlUGFyYW1zJyxcbiAgICAnUG9saWNpZXNNb2RlbCcsXG4gICAgJ1J1bGVzTW9kZWwnLFxuICAgICdOZXR3b3Jrc01vZGVsJyxcbiAgICAnQXBwbGljYXRpb25Hcm91cHNNb2RlbCcsXG4gICAgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIFBvbGljaWVzTW9kZWwsIFJ1bGVzTW9kZWwsIE5ldHdvcmtzTW9kZWwsIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCA9IHRoaXM7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ldHdvcmtzID0gW107XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmFwcGxpY2F0aW9uR3JvdXBzID0gW107XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ05ldHdvcmtTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nTmV0d29ya1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlT3V0Z29pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVJbmNvbWluZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nSVBBZGRyZXNzU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ0lQQWRkcmVzc1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1NlbGVjdGVkQXBwbGljYXRpb25Hcm91cCA9ICcnO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1NlbGVjdGVkQXBwbGljYXRpb25Hcm91cCA9ICcnO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1NlbGVjdGVkTmV0d29yayA9ICcnO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1NlbGVjdGVkTmV0d29yayA9ICcnO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvcnJlY3RDSURSID0gZmFsc2U7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLnZhbGlkYXRlQ0lEUkZsYWcgPSBmYWxzZTtcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Qb2xpY2llcygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmxpc3QuaXNvbGF0aW9uJyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Qb2xpY3lEZXRhaWxzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuaXNvbGF0aW9uLmRldGFpbHMnLCB7IGtleTogaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwucG9saWN5LmtleSB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxFZGl0aW5nKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9Qb2xpY3lEZXRhaWxzKCk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdvIGJhY2sgdG8gcG9saWN5IGRldGFpbHMgYWZ0ZXIgZG9uZSBlZGl0aW5nXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBkb25lRWRpdGluZygpIHtcbiAgICAgICAgICAgIHJldHVyblRvUG9saWN5RGV0YWlscygpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGRlbGV0ZVBvbGljeSgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBQb2xpY2llc01vZGVsLmRlbGV0ZShpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIHJldHVyblRvUG9saWNpZXMoKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRvIHNob3cgZWRpdCBvciBkZXRhaWxzIHNjcmVlbiBiYXNlZCBvbiB0aGUgcm91dGVcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHNldE1vZGUoKSB7XG4gICAgICAgICAgICBpZiAoJHN0YXRlLmlzKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuaXNvbGF0aW9uLmVkaXQnKSkge1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm1vZGUgPSAnZWRpdCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5tb2RlID0gJ2RldGFpbHMnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJlc2V0TmV3SW5jb21pbmdSdWxlKCkge1xuICAgICAgICAgICAgLy9SdWxlIG9iamVjdCB0byBiZSBjcmVhdGVkIG9uIHNlcnZlclxuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlID0ge1xuICAgICAgICAgICAgICAgIHJ1bGVJZDogJycsXG4gICAgICAgICAgICAgICAgcHJpb3JpdHk6IDEsXG4gICAgICAgICAgICAgICAgYWN0aW9uOiAnYWxsb3cnLFxuICAgICAgICAgICAgICAgIGZyb21FbmRwb2ludEdyb3VwOiAnJyxcbiAgICAgICAgICAgICAgICBmcm9tTmV0d29yazogJycsXG4gICAgICAgICAgICAgICAgZnJvbUlwQWRkcmVzczogJycsXG4gICAgICAgICAgICAgICAgcHJvdG9jb2w6ICd0Y3AnLFxuICAgICAgICAgICAgICAgIHBvcnQ6IDAsXG4gICAgICAgICAgICAgICAgZGlyZWN0aW9uOiAnaW4nLFxuICAgICAgICAgICAgICAgIHRlbmFudE5hbWU6ICdkZWZhdWx0JyxcbiAgICAgICAgICAgICAgICBwb2xpY3lOYW1lOiBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kucG9saWN5TmFtZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nU2VsZWN0ZWRBcHBsaWNhdGlvbkdyb3VwID0gJyc7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1NlbGVjdGVkTmV0d29yayA9ICcnO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nTmV0d29ya1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nSVBBZGRyZXNzU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvcnJlY3RDSURSID0gZmFsc2U7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC52YWxpZGF0ZUNJRFJGbGFnID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmVzZXROZXdPdXRnb2luZ1J1bGUoKSB7XG4gICAgICAgICAgICAvL1J1bGUgb2JqZWN0IHRvIGJlIGNyZWF0ZWQgb24gc2VydmVyXG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1J1bGUgPSB7XG4gICAgICAgICAgICAgICAgcnVsZUlkOiAnJyxcbiAgICAgICAgICAgICAgICBwcmlvcml0eTogMSxcbiAgICAgICAgICAgICAgICBhY3Rpb246ICdhbGxvdycsXG4gICAgICAgICAgICAgICAgdG9FbmRwb2ludEdyb3VwOiAnJyxcbiAgICAgICAgICAgICAgICB0b05ldHdvcms6ICcnLFxuICAgICAgICAgICAgICAgIHRvSXBBZGRyZXNzOiAnJyxcbiAgICAgICAgICAgICAgICBwcm90b2NvbDogJ3RjcCcsXG4gICAgICAgICAgICAgICAgcG9ydDogMCxcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb246ICdvdXQnLFxuICAgICAgICAgICAgICAgIHRlbmFudE5hbWU6ICdkZWZhdWx0JyxcbiAgICAgICAgICAgICAgICBwb2xpY3lOYW1lOiBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kucG9saWN5TmFtZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nU2VsZWN0ZWRBcHBsaWNhdGlvbkdyb3VwID0gJyc7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1NlbGVjdGVkTmV0d29yayA9ICcnO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nTmV0d29ya1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nSVBBZGRyZXNzU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvcnJlY3RDSURSID0gZmFsc2U7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC52YWxpZGF0ZUNJRFJGbGFnID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdldCBuZXR3b3JrIG5hbWVzIGZvciB0aGUgZ2l2ZW4gdGVuYW50LlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gZ2V0TmV0d29ya3MoKSB7XG4gICAgICAgICAgICBOZXR3b3Jrc01vZGVsLmdldCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vXy5maWx0ZXIoKSByZXR1cm5zIGEgbmV3IGFycmF5XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV0d29ya3MgPSBfLmZpbHRlcihyZXN1bHQsIHtcbiAgICAgICAgICAgICAgICAgICAgJ3RlbmFudE5hbWUnOiAnZGVmYXVsdCcgLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZXQgYXBwbGljYXRpb24gZ3JvdXAgbmFtZXMgZm9yIHRoZSBnaXZlbiB0ZW5hbnQuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBnZXRBcHBsaWNhdGlvbkdyb3VwcygpIHtcbiAgICAgICAgICAgIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwuZ2V0KClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy9fLmZpbHRlcigpIHJldHVybnMgYSBuZXcgYXJyYXlcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5hcHBsaWNhdGlvbkdyb3VwcyA9IF8uZmlsdGVyKHJlc3VsdCwge1xuICAgICAgICAgICAgICAgICAgICAndGVuYW50TmFtZSc6ICdkZWZhdWx0JyAvL1RPRE86IFJlbW92ZSBoYXJkY29kZWQgdGVuYW50LlxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEV2ZW50IGhhbmRsZXIgdG8gZGlzYWJsZSBuZXR3b3JrIHNlbGVjdGlvbiBib3ggb25jZSBhcHBsaWNhdGlvbiBncm91cCBpcyBzZWxlY3RlZCB3aGlsZSBjcmVhdGluZyBhIG5ld1xuICAgICAgICAgKiBydWxlLlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gb25DaGFuZ2VPdXRnb2luZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdTZWxlY3RlZEFwcGxpY2F0aW9uR3JvdXAgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIC8vSWYgYXBwbGljYXRpb24gZ3JvdXAgaGFzIGJlZW4gc2VsZWN0ZWRcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1J1bGUudG9FbmRwb2ludEdyb3VwID1cbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdTZWxlY3RlZEFwcGxpY2F0aW9uR3JvdXAuZ3JvdXBOYW1lO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZS50b05ldHdvcmsgPSAnJztcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlT3V0Z29pbmdOZXR3b3JrU2VsZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vV2hlbiAnbm9uZScgaXMgc2VsZWN0ZWRcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1J1bGUudG9FbmRwb2ludEdyb3VwID0gJyc7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nTmV0d29ya1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBFdmVudCBoYW5kbGVyIHRvIGRpc2FibGUgbmV0d29yayBzZWxlY3Rpb24gYm94IG9uY2UgYXBwbGljYXRpb24gZ3JvdXAgaXMgc2VsZWN0ZWQgd2hpbGUgY3JlYXRpbmcgYSBuZXdcbiAgICAgICAgICogcnVsZS5cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIG9uQ2hhbmdlSW5jb21pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nU2VsZWN0ZWRBcHBsaWNhdGlvbkdyb3VwICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAvL0lmIGFwcGxpY2F0aW9uIGdyb3VwIGhhcyBiZWVuIHNlbGVjdGVkXG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlLmZyb21FbmRwb2ludEdyb3VwID1cbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdTZWxlY3RlZEFwcGxpY2F0aW9uR3JvdXAuZ3JvdXBOYW1lO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nUnVsZS5mcm9tTmV0d29yayA9ICcnO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVJbmNvbWluZ05ldHdvcmtTZWxlY3Rpb24gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy9XaGVuICdub25lJyBpcyBzZWxlY3RlZFxuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nUnVsZS5mcm9tRW5kcG9pbnRHcm91cCA9ICcnO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdOZXR3b3JrU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEV2ZW50IGhhbmRsZXIgdG8gZGlzYWJsZSBhcHBsaWNhdGlvbiBncm91cCBzZWxlY3Rpb24gYm94IG9uY2UgbmV0d29yayBpcyBzZWxlY3RlZCB3aGlsZSBjcmVhdGluZyBhIG5ld1xuICAgICAgICAgKiBydWxlLlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gb25DaGFuZ2VPdXRnb2luZ05ldHdvcmtTZWxlY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdTZWxlY3RlZE5ldHdvcmsgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIC8vSWYgbmV0d29yayBoYXMgYmVlbiBzZWxlY3RlZFxuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZS50b05ldHdvcmsgPVxuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1NlbGVjdGVkTmV0d29yaztcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1J1bGUuVG9FbmRwb2ludEdyb3VwID0gJyc7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nSVBBZGRyZXNzU2VsZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZS50b0lwQWRkcmVzcyA9ICcnO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlT3V0Z29pbmdJUEFkZHJlc3NTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogRXZlbnQgaGFuZGxlciB0byBkaXNhYmxlIGFwcGxpY2F0aW9uIGdyb3VwIHNlbGVjdGlvbiBib3ggb25jZSBuZXR3b3JrIGlzIHNlbGVjdGVkIHdoaWxlIGNyZWF0aW5nIGEgbmV3XG4gICAgICAgICAqIHJ1bGUuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBvbkNoYW5nZUluY29taW5nTmV0d29ya1NlbGVjdGlvbigpIHtcbiAgICAgICAgICAgIGlmIChpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1NlbGVjdGVkTmV0d29yayAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgLy9JZiBuZXR3b3JrIGhhcyBiZWVuIHNlbGVjdGVkXG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlLmZyb21OZXR3b3JrID1cbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdTZWxlY3RlZE5ldHdvcms7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlLmZyb21FbmRwb2ludEdyb3VwID0gJyc7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nSVBBZGRyZXNzU2VsZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nUnVsZS5mcm9tTmV0d29yayA9ICcnO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVJbmNvbWluZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdJUEFkZHJlc3NTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogR2VuZXJhdGVzIHJ1bGUgaWRcbiAgICAgICAgICogVE9ETyBNYWtlIGl0IGNyeXB0b2dyYXBoaWNhbGx5IHN0cm9uZ2VyIG9uY2Ugd2UgaGF2ZSBtdWx0aXBsZSB1c2VycyB1cGRhdGluZyBzYW1lIHBvbGljeVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gZ2VuZXJhdGVSdWxlSWQocnVsZSkge1xuICAgICAgICAgICAgcnVsZS5ydWxlSWQgPVxuICAgICAgICAgICAgICAgIChpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvbWluZ1J1bGVzLmxlbmd0aCArIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm91dGdvaW5nUnVsZXMubGVuZ3RoICsgMSkudG9TdHJpbmcoKSArICctJyArXG4gICAgICAgICAgICAgICAgICAgIERhdGUubm93KCkudG9TdHJpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogUnVsZSBpcyBzYXZlZCB0byBzZXJ2ZXJcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGFkZEluY29taW5nUnVsZSgpIHtcbiAgICAgICAgICAgIGlmICh2YWxpZGF0ZUNJRFIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlLmZyb21JcEFkZHJlc3MpKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgZ2VuZXJhdGVSdWxlSWQoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlKTtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUua2V5ID0gUnVsZXNNb2RlbC5nZW5lcmF0ZUtleShpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUpO1xuICAgICAgICAgICAgICAgIFJ1bGVzTW9kZWwuY3JlYXRlKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nUnVsZSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvbWluZ1J1bGVzLnB1c2gocmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgcmVzZXROZXdJbmNvbWluZ1J1bGUoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIG9uQ2hhbmdlSW5jb21pbmdJUEFkZHJlc3MoKSB7XG4gICAgICAgICAgICBpZiAoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlLmZyb21JcEFkZHJlc3MgPT0gJycpIHtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvcnJlY3RDSURSID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nTmV0d29ya1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nTmV0d29ya1NlbGVjdGlvbiA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwudmFsaWRhdGVDSURSRmxhZyAmJlxuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29ycmVjdENJRFIpIHtcbiAgICAgICAgICAgICAgICB2YWxpZGF0ZUNJRFIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlLmZyb21JcEFkZHJlc3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIG9uQ2hhbmdlT3V0Z29pbmdJUEFkZHJlc3MoKSB7XG4gICAgICAgICAgICBpZiAoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlLnRvSXBBZGRyZXNzID09ICcnKSB7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuaW5jb3JyZWN0Q0lEUiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ05ldHdvcmtTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ05ldHdvcmtTZWxlY3Rpb24gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLnZhbGlkYXRlQ0lEUkZsYWcgJiZcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvcnJlY3RDSURSKSB7XG4gICAgICAgICAgICAgICAgdmFsaWRhdGVDSURSKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZS50b0lwQWRkcmVzcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gdmFsaWRhdGVDSURSKGlwYWRkcmVzcykge1xuICAgICAgICAgICAgdmFyIGNpZHJQYXR0ZXJuID0gbmV3IFJlZ0V4cChDb250aXZHbG9iYWxzLkNJRFJfUkVHRVgpO1xuICAgICAgICAgICAgaWYgKGlwYWRkcmVzcyA9PSAnJykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNpZHJQYXR0ZXJuLnRlc3QoaXBhZGRyZXNzKSkge1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29ycmVjdENJRFIgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29ycmVjdENJRFIgPSB0cnVlO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwudmFsaWRhdGVDSURSRmxhZyA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJ1bGUgaXMgc2F2ZWQgdG8gc2VydmVyXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBhZGRPdXRnb2luZ1J1bGUoKSB7XG4gICAgICAgICAgICBpZiAodmFsaWRhdGVDSURSKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZS50b0lwQWRkcmVzcykpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBnZW5lcmF0ZVJ1bGVJZChpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1J1bGUpO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZS5rZXkgPSBSdWxlc01vZGVsLmdlbmVyYXRlS2V5KGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZSk7XG4gICAgICAgICAgICAgICAgUnVsZXNNb2RlbC5jcmVhdGUoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm91dGdvaW5nUnVsZXMucHVzaChyZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICByZXNldE5ld091dGdvaW5nUnVsZSgpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERlbGV0ZSBpbmNvbWluZyBydWxlIGZyb20gc2VydmVyXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBkZWxldGVJbmNvbWluZ1J1bGUoa2V5KSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgUnVsZXNNb2RlbC5kZWxldGVVc2luZ0tleShrZXkpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIF8ucmVtb3ZlKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29taW5nUnVsZXMsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuLmtleSA9PSBrZXk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEZWxldGUgb3V0Z29pbmcgcnVsZSBmcm9tIHNlcnZlclxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gZGVsZXRlT3V0Z29pbmdSdWxlKGtleSkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIFJ1bGVzTW9kZWwuZGVsZXRlVXNpbmdLZXkoa2V5KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBfLnJlbW92ZShpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5vdXRnb2luZ1J1bGVzLCBmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbi5rZXkgPT0ga2V5O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgUG9saWNpZXNNb2RlbC5nZXRNb2RlbEJ5S2V5KCRzdGF0ZVBhcmFtcy5rZXkpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kgPSBwb2xpY3k7XG4gICAgICAgICAgICBSdWxlc01vZGVsLmdldEluY29taW5nUnVsZXMocG9saWN5LnBvbGljeU5hbWUsICdkZWZhdWx0JykudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuaW5jb21pbmdSdWxlcyA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICByZXNldE5ld0luY29taW5nUnVsZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBSdWxlc01vZGVsLmdldE91dGdvaW5nUnVsZXMocG9saWN5LnBvbGljeU5hbWUsICdkZWZhdWx0JykudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwub3V0Z29pbmdSdWxlcyA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICByZXNldE5ld091dGdvaW5nUnVsZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBnZXROZXR3b3JrcygpO1xuICAgICAgICBnZXRBcHBsaWNhdGlvbkdyb3VwcygpO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kZWxldGVQb2xpY3kgPSBkZWxldGVQb2xpY3k7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRlbGV0ZUluY29taW5nUnVsZSA9IGRlbGV0ZUluY29taW5nUnVsZTtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGVsZXRlT3V0Z29pbmdSdWxlID0gZGVsZXRlT3V0Z29pbmdSdWxlO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5hZGRJbmNvbWluZ1J1bGUgPSBhZGRJbmNvbWluZ1J1bGU7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmFkZE91dGdvaW5nUnVsZSA9IGFkZE91dGdvaW5nUnVsZTtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZG9uZUVkaXRpbmcgPSBkb25lRWRpdGluZztcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuY2FuY2VsRWRpdGluZyA9IGNhbmNlbEVkaXRpbmc7XG4gICAgICAgIC8vRXZlbnQgSGFuZGxlcnNcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwub25DaGFuZ2VPdXRnb2luZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24gPSBvbkNoYW5nZU91dGdvaW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbjtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwub25DaGFuZ2VJbmNvbWluZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24gPSBvbkNoYW5nZUluY29taW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbjtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwub25DaGFuZ2VPdXRnb2luZ05ldHdvcmtTZWxlY3Rpb24gPSBvbkNoYW5nZU91dGdvaW5nTmV0d29ya1NlbGVjdGlvbjtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwub25DaGFuZ2VJbmNvbWluZ05ldHdvcmtTZWxlY3Rpb24gPSBvbkNoYW5nZUluY29taW5nTmV0d29ya1NlbGVjdGlvbjtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwub25DaGFuZ2VJbmNvbWluZ0lQQWRkcmVzcyA9IG9uQ2hhbmdlSW5jb21pbmdJUEFkZHJlc3M7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm9uQ2hhbmdlT3V0Z29pbmdJUEFkZHJlc3MgPSBvbkNoYW5nZU91dGdvaW5nSVBBZGRyZXNzO1xuICAgICAgICBzZXRNb2RlKCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aXNvbGF0aW9ucG9saWN5ZGV0YWlsc2N0cmwuanMubWFwXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtwb2xpY2llcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5saXN0Lmlzb2xhdGlvbicsIHtcbiAgICAgICAgICAgIHVybDogJy9pc29sYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0lzb2xhdGlvblBvbGljeUxpc3RDdHJsIGFzIGlzb2xhdGlvblBvbGljeUxpc3RDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmV0d29ya19wb2xpY2llcy9pc29sYXRpb25wb2xpY3lsaXN0Lmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdJc29sYXRpb25Qb2xpY3lMaXN0Q3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ1BvbGljaWVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgUG9saWNpZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHBvbGljaWVzTGlzdEN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBnZXRQb2xpY2llcyhyZWxvYWQpIHtcbiAgICAgICAgICAgIFBvbGljaWVzTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihwb2xpY2llc0xpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICBwb2xpY2llc0xpc3RDdHJsLnBvbGljaWVzID0gJGZpbHRlcignb3JkZXJCeScpKHJlc3VsdCwgJ3BvbGljeU5hbWUnKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihwb2xpY2llc0xpc3RDdHJsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vTG9hZCBmcm9tIGNhY2hlIGZvciBxdWljayBkaXNwbGF5IGluaXRpYWxseVxuICAgICAgICBnZXRQb2xpY2llcyhmYWxzZSk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IHN0YXJ0IGF1dG8tcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXRQb2xpY2llcyh0cnVlKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWlzb2xhdGlvbnBvbGljeWxpc3RjdHJsLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3BvbGljaWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOZXR3b3JrUG9saWNpZXNUYWJzQ3RybCBhcyBuZXR3b3JrUG9saWNpZXNUYWJzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtfcG9saWNpZXMvbmV0d29ya3BvbGljaWVzdGFicy5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMubGlzdC5yZWRpcmVjdGlvbicsIHtcbiAgICAgICAgICAgIHVybDogJy9yZWRpcmVjdGlvbicsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJydcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05ldHdvcmtQb2xpY2llc1RhYnNDdHJsJywgWyckc3RhdGUnLCBmdW5jdGlvbiAoJHN0YXRlKSB7XG4gICAgICAgIHZhciBuZXR3b3JrUG9saWNpZXNUYWJzQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZU5ldHdvcmtQb2xpY3koKSB7XG4gICAgICAgICAgICBpZiAoJHN0YXRlLiRjdXJyZW50LmluY2x1ZGVzWydjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMubGlzdC5pc29sYXRpb24nXSkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbi5jcmVhdGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgkc3RhdGUuJGN1cnJlbnQuaW5jbHVkZXNbJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5saXN0LmJhbmR3aWR0aCddKSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuYmFuZHdpZHRoLmNyZWF0ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIG5ldHdvcmtQb2xpY2llc1RhYnNDdHJsLmNyZWF0ZU5ldHdvcmtQb2xpY3kgPSBjcmVhdGVOZXR3b3JrUG9saWN5O1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5ldHdvcmtwb2xpY2llc3RhYnNjdHJsLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAyLzE5LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3MuY3JlYXRlJywge1xuICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtzL25ldHdvcmtjcmVhdGUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTmV0d29ya0NyZWF0ZUN0cmwgYXMgbmV0d29ya0NyZWF0ZUN0cmwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOZXR3b3JrQ3JlYXRlQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdOZXR3b3Jrc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIE5ldHdvcmtzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBuZXR3b3JrQ3JlYXRlQ3RybCA9IHRoaXM7XG4gICAgICAgIG5ldHdvcmtDcmVhdGVDdHJsLmNpZHJQYXR0ZXJuID0gQ29udGl2R2xvYmFscy5DSURSX1JFR0VYO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub05ldHdvcmtzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5uZXR3b3Jrcy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub05ldHdvcmtzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlTmV0d29yaygpIHtcbiAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgaWYgKG5ldHdvcmtDcmVhdGVDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG5ldHdvcmtDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihuZXR3b3JrQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgbmV0d29ya0NyZWF0ZUN0cmwubmV3TmV0d29yay5rZXkgPVxuICAgICAgICAgICAgICAgICAgICBuZXR3b3JrQ3JlYXRlQ3RybC5uZXdOZXR3b3JrLnRlbmFudE5hbWUgKyAnOicgKyBuZXR3b3JrQ3JlYXRlQ3RybC5uZXdOZXR3b3JrLm5ldHdvcmtOYW1lO1xuICAgICAgICAgICAgICAgIE5ldHdvcmtzTW9kZWwuY3JlYXRlKG5ldHdvcmtDcmVhdGVDdHJsLm5ld05ldHdvcmspLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9OZXR3b3JrcygpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobmV0d29ya0NyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IobmV0d29ya0NyZWF0ZUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmVzZXRGb3JtKCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3JrQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IobmV0d29ya0NyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgbmV0d29ya0NyZWF0ZUN0cmwubmV3TmV0d29yayA9IHtcbiAgICAgICAgICAgICAgICBuZXR3b3JrTmFtZTogJycsXG4gICAgICAgICAgICAgICAgZW5jYXA6ICd2eGxhbicsXG4gICAgICAgICAgICAgICAgc3VibmV0OiAnJyxcbiAgICAgICAgICAgICAgICBnYXRld2F5OiAnJyxcbiAgICAgICAgICAgICAgICB0ZW5hbnROYW1lOiAnZGVmYXVsdCcgLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgbmV0d29ya0NyZWF0ZUN0cmwuY3JlYXRlTmV0d29yayA9IGNyZWF0ZU5ldHdvcms7XG4gICAgICAgIG5ldHdvcmtDcmVhdGVDdHJsLmNhbmNlbENyZWF0aW5nID0gY2FuY2VsQ3JlYXRpbmc7XG4gICAgICAgIHJlc2V0Rm9ybSgpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5ldHdvcmtjcmVhdGVjdHJsLmpzLm1hcFxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOZXR3b3JrRGV0YWlsc0N0cmwgYXMgbmV0d29ya0RldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmV0d29ya3MvbmV0d29ya2RldGFpbHMuaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3MuZGV0YWlscy5pbmZvJywge1xuICAgICAgICAgICAgdXJsOiAnL2luZm8nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3Jrcy9uZXR3b3JraW5mby5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTmV0d29ya0RldGFpbHNDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdOZXR3b3Jrc01vZGVsJywgJ0FwcGxpY2F0aW9uR3JvdXBzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIE5ldHdvcmtzTW9kZWwsIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBuZXR3b3JrRGV0YWlsc0N0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub05ldHdvcmtzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5uZXR3b3Jrcy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZGVsZXRlTmV0d29yaygpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihuZXR3b3JrRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIobmV0d29ya0RldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIE5ldHdvcmtzTW9kZWwuZGVsZXRlKG5ldHdvcmtEZXRhaWxzQ3RybC5uZXR3b3JrKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9OZXR3b3JrcygpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKG5ldHdvcmtEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZXQgYXBwbGljYXRpb24gZ3JvdXBzIGJlbG9uZ2luZyB0byBhIG5ldHdvcmtcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGdldEFwcGxpY2F0aW9uR3JvdXBzKHJlbG9hZCkge1xuICAgICAgICAgICAgQXBwbGljYXRpb25Hcm91cHNNb2RlbC5nZXQocmVsb2FkKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBuZXR3b3JrRGV0YWlsc0N0cmwuYXBwbGljYXRpb25Hcm91cHMgPSAkZmlsdGVyKCdvcmRlckJ5JykoXy5maWx0ZXIocmVzdWx0LCB7XG4gICAgICAgICAgICAgICAgICAgICduZXR3b3JrTmFtZSc6IG5ldHdvcmtEZXRhaWxzQ3RybC5uZXR3b3JrLm5ldHdvcmtOYW1lXG4gICAgICAgICAgICAgICAgfSksICdncm91cE5hbWUnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobmV0d29ya0RldGFpbHNDdHJsKTtcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG5ldHdvcmtEZXRhaWxzQ3RybCk7XG4gICAgICAgIE5ldHdvcmtzTW9kZWwuZ2V0TW9kZWxCeUtleSgkc3RhdGVQYXJhbXMua2V5KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKG5ldHdvcmspIHtcbiAgICAgICAgICAgIG5ldHdvcmtEZXRhaWxzQ3RybC5uZXR3b3JrID0gbmV0d29yaztcbiAgICAgICAgICAgIGdldEFwcGxpY2F0aW9uR3JvdXBzKGZhbHNlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIG5ldHdvcmtEZXRhaWxzQ3RybC5kZWxldGVOZXR3b3JrID0gZGVsZXRlTmV0d29yaztcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0b3JlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0QXBwbGljYXRpb25Hcm91cHModHJ1ZSk7XG4gICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1uZXR3b3JrZGV0YWlsc2N0cmwuanMubWFwXG52YXIgTmV0d29ya3NMaXN0Q3RybCA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTmV0d29ya3NMaXN0Q3RybCgkc2NvcGUsICRpbnRlcnZhbCwgTmV0d29ya3NNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIG5ldHdvcmtzTGlzdEN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBnZXROZXR3b3JrcyhyZWxvYWQpIHtcbiAgICAgICAgICAgIE5ldHdvcmtzTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3Jrc0xpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICBuZXR3b3Jrc0xpc3RDdHJsLm5ldHdvcmtzID0gcmVzdWx0O1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtzTGlzdEN0cmwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgIGdldE5ldHdvcmtzKGZhbHNlKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0b3JlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0TmV0d29ya3ModHJ1ZSk7XG4gICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgTmV0d29ya3NMaXN0Q3RybC4kaW5qZWN0ID0gWyckc2NvcGUnLCAnJGludGVydmFsJywgJ05ldHdvcmtzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnXTtcbiAgICByZXR1cm4gTmV0d29ya3NMaXN0Q3RybDtcbn0oKSk7XG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3MubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ25ldHdvcmtMaXN0J1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29tcG9uZW50KCduZXR3b3JrTGlzdCcsIHtcbiAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtzL25ldHdvcmtsaXN0Lmh0bWwnLFxuICAgIGNvbnRyb2xsZXI6IE5ldHdvcmtzTGlzdEN0cmwsXG4gICAgY29udHJvbGxlckFzOiAnbmV0d29ya3NMaXN0Q3RybCdcbn0pO1xuLypcbiAgICAuY29udHJvbGxlcignTmV0d29ya3NMaXN0Q3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ05ldHdvcmtzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgICAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIE5ldHdvcmtzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgICAgICB2YXIgbmV0d29ya3NMaXN0Q3RybCA9IHRoaXM7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldE5ldHdvcmtzKHJlbG9hZCkge1xuICAgICAgICAgICAgICAgIE5ldHdvcmtzTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobmV0d29ya3NMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV0d29ya3NMaXN0Q3RybC5uZXR3b3JrcyA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobmV0d29ya3NMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgICAgICBnZXROZXR3b3JrcyhmYWxzZSk7XG5cbiAgICAgICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAgICAgLy9Eb24ndCBkbyBhdXRvcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBnZXROZXR3b3Jrcyh0cnVlKTtcbiAgICAgICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1dKTtcbiovIFxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bmV0d29ya2xpc3RjdHJsLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IGNzaGFtcHVyIG9uIDYvMjMvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3MnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3Jrcy5kZXRhaWxzLnN0YXRzJywge1xuICAgICAgICAgICAgdXJsOiAnL3N0YXRzJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOZXR3b3JrU3RhdHNDdHJsIGFzIG5ldHdvcmtTdGF0c0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3Jrcy9uZXR3b3Jrc3RhdHMuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05ldHdvcmtTdGF0c0N0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ05ldHdvcmtzTW9kZWwnLCAnSW5zcGVjdFNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIE5ldHdvcmtzTW9kZWwsIEluc3BlY3RTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBuZXR3b3JrU3RhdHNDdHJsID0gdGhpcztcbiAgICAgICAgLyogR2V0cyB0aGUgTmV0d29yayBPcGVyYXRpb25hbCBzdGF0ZSBmcm9tIHRoZSBzZXJ2ZXIgKi9cbiAgICAgICAgZnVuY3Rpb24gZ2V0TmV0d29ya0luc3BlY3QocmVmcmVzaCkge1xuICAgICAgICAgICAgTmV0d29ya3NNb2RlbC5nZXRJbnNwZWN0QnlLZXkoJHN0YXRlUGFyYW1zLmtleSwgQ29udGl2R2xvYmFscy5ORVRXT1JLU19JTlNQRUNUX0VORFBPSU5ULCByZWZyZXNoKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBuZXR3b3JrU3RhdHNDdHJsLm5ldHdvcmtJbnNwZWN0U3RhdHMgPSByZXN1bHQuT3BlcjtcbiAgICAgICAgICAgICAgICBuZXR3b3JrU3RhdHNDdHJsLmNvbmZpZyA9IHJlc3VsdC5Db25maWc7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5PcGVyLmVuZHBvaW50cyAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRhaW5lckRldGFpbHMgPSBJbnNwZWN0U2VydmljZS5idWlsZEVuZFBvaW50cyhyZXN1bHQuT3Blci5lbmRwb2ludHMpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoSW5zcGVjdFNlcnZpY2UuY2hlY2tDb250YWluZXJDaGFuZ2VkKG5ldHdvcmtTdGF0c0N0cmwuY29udGFpbmVyRGV0YWlscywgY29udGFpbmVyRGV0YWlscykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldHdvcmtTdGF0c0N0cmwuZW5kcG9pbnRzID0gcmVzdWx0Lk9wZXIuZW5kcG9pbnRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV0d29ya1N0YXRzQ3RybC5jb250YWluZXJEZXRhaWxzID0gY29udGFpbmVyRGV0YWlscztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbmV0d29ya1N0YXRzQ3RybC5lbmRwb2ludHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgbmV0d29ya1N0YXRzQ3RybC5jb250YWluZXJEZXRhaWxzID0ge307XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZ2V0TmV0d29ya0luc3BlY3QoZmFsc2UpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXROZXR3b3JrSW5zcGVjdCh0cnVlKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5ldHdvcmtzdGF0c2N0cmwuanMubWFwXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJylcbiAgICAuZmFjdG9yeSgnQmdwU2VydmljZScsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbiAoJGh0dHAsICRxKSB7XG4gICAgICAgIGZ1bmN0aW9uIGdldEJncChjdHJsKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuQkdQU19FTkRQT0lOVCArIGN0cmwua2V5ICsgJy8nO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgY3RybC5uZWlnaGJvciA9IHJlc3VsdC5kYXRhO1xuICAgICAgICAgICAgICAgIGN0cmwubmVpZ2hib3JzLnB1c2goeyAnbmFtZSc6IGN0cmwubmVpZ2hib3JbJ25laWdoYm9yJ10sICd2YWx1ZSc6IGN0cmwubmVpZ2hib3JbJ25laWdoYm9yLWFzJ10gfSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUJncChjdHJsKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5CR1BTX0VORFBPSU5UICsgY3RybC5rZXkgKyAnLyc7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCh1cmwsIGN0cmwubmVpZ2hib3IpO1xuICAgICAgICB9XG4gICAgICAgIDtcbiAgICAgICAgZnVuY3Rpb24gZ2V0QmdwSW5zcGVjdChrZXkpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5CR1BTX0lOU1BFQ1RfRU5EUE9JTlQgKyBrZXkgKyAnLyc7XG4gICAgICAgICAgICAkaHR0cC5nZXQodXJsKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldEJncDogZ2V0QmdwLFxuICAgICAgICAgICAgdXBkYXRlQmdwOiB1cGRhdGVCZ3AsXG4gICAgICAgICAgICBnZXRCZ3BJbnNwZWN0OiBnZXRCZ3BJbnNwZWN0XG4gICAgICAgIH07XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Ymdwc2VydmljZS5qcy5tYXBcbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2Lm5vZGVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dkxvZ3NcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbG9ncy5odG1sJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIGxvZzogXCI9XCIsXG4gICAgICAgICAgICB0aXRsZTogXCJAXCJcbiAgICAgICAgfVxuICAgIH07XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxvZ3NkaXJlY3RpdmUuanMubWFwXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJylcbiAgICAuZmFjdG9yeSgnTG9nU2VydmljZScsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbiAoJGh0dHAsICRxKSB7XG4gICAgICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUxvZ3MoKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuTk9ERVNfQUNUSVZFX0pPQl9FTkRQT0lOVDtcbiAgICAgICAgICAgICRodHRwLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnZXRMYXN0TG9ncygpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5OT0RFU19MQVNUX0pPQl9FTkRQT0lOVDtcbiAgICAgICAgICAgICRodHRwLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0QWN0aXZlTG9nczogZ2V0QWN0aXZlTG9ncyxcbiAgICAgICAgICAgIGdldExhc3RMb2dzOiBnZXRMYXN0TG9nc1xuICAgICAgICB9O1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxvZ3NlcnZpY2UuanMubWFwXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMuYWN0aXZlbG9nJywge1xuICAgICAgICAgICAgdXJsOiAnL2FjdGl2ZWxvZycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZUFjdGl2ZUpvYkxvZ3NDdHJsIGFzIG5vZGVBY3RpdmVKb2JMb2dzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxjdHYtbG9ncyB0aXRsZT1cIkFjdGl2ZSBKb2JcIiBsb2c9XCJub2RlQWN0aXZlSm9iTG9nc0N0cmwuYWN0aXZlTG9nc1wiPjwvY3R2LWxvZ3M+J1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTm9kZUFjdGl2ZUpvYkxvZ3NDdHJsJywgWyckc2NvcGUnLCAnJGludGVydmFsJywgJ0xvZ1NlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc2NvcGUsICRpbnRlcnZhbCwgTG9nU2VydmljZSkge1xuICAgICAgICB2YXIgbm9kZUFjdGl2ZUpvYkxvZ3NDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gZ2V0QWN0aXZlTG9ncygpIHtcbiAgICAgICAgICAgIExvZ1NlcnZpY2UuZ2V0QWN0aXZlTG9ncygpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIG5vZGVBY3RpdmVKb2JMb2dzQ3RybC5hY3RpdmVMb2dzID0gcmVzdWx0O1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAvL09uY2UgdGhlIGpvYiBmaW5pc2hlcywgZW5kcG9pbnQgcmV0dXJucyA1MDAgZXJyb3IuIFNvIHJlc2V0IHRoZSBhY3RpdmVMb2dzXG4gICAgICAgICAgICAgICAgbm9kZUFjdGl2ZUpvYkxvZ3NDdHJsLmFjdGl2ZUxvZ3MgPSB7XG4gICAgICAgICAgICAgICAgICAgIGRlc2M6ICdUaGVyZSBpcyBjdXJyZW50bHkgbm8gYWN0aXZlIGpvYi4gQ2hlY2sgTGFzdCBKb2IgZm9yIGEgam9iIHRoYXQgcmVjZW50bHkgZmluaXNoZWQuJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBnZXRBY3RpdmVMb2dzKCk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG8tcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXRBY3RpdmVMb2dzKCk7XG4gICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1ub2RlYWN0aXZlam9ibG9nc2N0cmwuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMjUvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5jb21taXNzaW9uJywge1xuICAgICAgICAgICAgdXJsOiAnL2NvbW1pc3Npb24vOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZUNvbW1pc3Npb25DdHJsIGFzIG5vZGVDb21taXNzaW9uQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVjb21taXNzaW9uLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOb2RlQ29tbWlzc2lvbkN0cmwnLCBbXG4gICAgJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnTm9kZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsICdOb2Rlc1NlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgTm9kZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UsIE5vZGVzU2VydmljZSkge1xuICAgICAgICB2YXIgbm9kZUNvbW1pc3Npb25DdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Ob2RlRGV0YWlscygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubm9kZXMuZGV0YWlscy5pbmZvJywgeyAna2V5JzogJHN0YXRlUGFyYW1zLmtleSB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxDb21taXNzaW9uaW5nTm9kZSgpIHtcbiAgICAgICAgICAgIHJldHVyblRvTm9kZURldGFpbHMoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjb21taXNzaW9uKCkge1xuICAgICAgICAgICAgaWYgKG5vZGVDb21taXNzaW9uQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLm5vZGVPcHNPYmoubm9kZXMgPSBbJHN0YXRlUGFyYW1zLmtleV07XG4gICAgICAgICAgICAgICAgTm9kZXNTZXJ2aWNlLmNsZWFudXBFeHRyYVZhcnMobm9kZUNvbW1pc3Npb25DdHJsKTtcbiAgICAgICAgICAgICAgICBOb2Rlc1NlcnZpY2UuY3JlYXRlRXh0cmFWYXJzKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgTm9kZXNNb2RlbC5jb21taXNzaW9uKG5vZGVDb21taXNzaW9uQ3RybC5ub2RlT3BzT2JqKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub05vZGVEZXRhaWxzKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Iobm9kZUNvbW1pc3Npb25DdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIG5vZGVDb21taXNzaW9uQ3RybC5ub2RlT3BzT2JqID0ge307XG4gICAgICAgIG5vZGVDb21taXNzaW9uQ3RybC5leHRyYV92YXJzID0ge307IC8vVE9ETyBJbnRpYWxpemUgZnJvbSBnbG9iYWwgc2V0dGluZ3NcbiAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLmFuc2libGVWYXJpYWJsZXMgPSBbXTtcbiAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLmVudlZhcmlhYmxlcyA9IFtdO1xuICAgICAgICBOb2Rlc1NlcnZpY2UuZ2V0U2V0dGluZ3Mobm9kZUNvbW1pc3Npb25DdHJsKTtcbiAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLmNhbmNlbENvbW1pc3Npb25pbmdOb2RlID0gY2FuY2VsQ29tbWlzc2lvbmluZ05vZGU7XG4gICAgICAgIG5vZGVDb21taXNzaW9uQ3RybC5jb21taXNzaW9uID0gY29tbWlzc2lvbjtcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iobm9kZUNvbW1pc3Npb25DdHJsKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1ub2RlY29tbWlzc2lvbmN0cmwuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMjUvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZURldGFpbHNDdHJsIGFzIG5vZGVEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVkZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMuaW5mbycsIHtcbiAgICAgICAgICAgIHVybDogJy9pbmZvJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGV0YWlsc0N0cmwgYXMgbm9kZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWluZm8uaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMuZGV0YWlscy5zdGF0cycsIHtcbiAgICAgICAgICAgIHVybDogJy9zdGF0cycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZURldGFpbHNDdHJsIGFzIG5vZGVEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVzdGF0cy5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLmxvZ3MnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbG9ncycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZURldGFpbHNDdHJsIGFzIG5vZGVEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVsb2dzLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMuZWRpdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9lZGl0JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGV0YWlsc0N0cmwgYXMgbm9kZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWluZm8uaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVEZXRhaWxzQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICckc2NvcGUnLCAnJGludGVydmFsJywgJ05vZGVzTW9kZWwnLCAnQmdwU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCAkc2NvcGUsICRpbnRlcnZhbCwgTm9kZXNNb2RlbCwgQmdwU2VydmljZSkge1xuICAgICAgICB2YXIgbm9kZURldGFpbHNDdHJsID0gdGhpcztcbiAgICAgICAgbm9kZURldGFpbHNDdHJsLm51bWJlcnBhdHRlcm4gPSBDb250aXZHbG9iYWxzLk5VTUJFUl9SRUdFWDtcbiAgICAgICAgZnVuY3Rpb24gZGVjb21taXNzaW9uKCkge1xuICAgICAgICAgICAgdmFyIG5vZGVPcHNPYmogPSB7XG4gICAgICAgICAgICAgICAgbm9kZXM6IFskc3RhdGVQYXJhbXMua2V5XVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIE5vZGVzTW9kZWwuZGVjb21taXNzaW9uKG5vZGVPcHNPYmopLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vRGlzYWJsZSBhbGwgYnV0dG9ucyBpbml0aWFsbHkuIFBvbGwgd2lsbCBhc3NpZ24gdmFsdWVzIGFwcHJvcHJpYXRlbHkuXG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiB1cGdyYWRlKCkge1xuICAgICAgICAgICAgdmFyIG5vZGVPcHNPYmogPSB7XG4gICAgICAgICAgICAgICAgbm9kZXM6IFskc3RhdGVQYXJhbXMua2V5XVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIE5vZGVzTW9kZWwudXBncmFkZShub2RlT3BzT2JqKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAvL0Rpc2FibGUgYWxsIGJ1dHRvbnMgaW5pdGlhbGx5LiBQb2xsIHdpbGwgYXNzaWduIHZhbHVlcyBhcHByb3ByaWF0ZWx5LlxuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERpc3BsYXkgYnV0dG9ucyBiYXNlZCBvbiBzdGF0dXMgb2Ygbm9kZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gc2V0QnV0dG9uRGlzcGxheSgpIHtcbiAgICAgICAgICAgIHN3aXRjaCAobm9kZURldGFpbHNDdHJsLm5vZGVbJ2ludmVudG9yeV9zdGF0ZSddLnN0YXR1cykge1xuICAgICAgICAgICAgICAgIGNhc2UgJ1VuYWxsb2NhdGVkJzpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0RlY29tbWlzc2lvbmVkJzpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ1Byb3Zpc2lvbmluZyc6XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnQWxsb2NhdGVkJzpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0NhbmNlbGxlZCc6XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ01haW50ZW5hbmNlJzpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdldE5vZGVJbmZvKHJlbG9hZCkge1xuICAgICAgICAgICAgTm9kZXNNb2RlbC5nZXRNb2RlbEJ5S2V5KCRzdGF0ZVBhcmFtcy5rZXksIHJlbG9hZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5ub2RlID0gbm9kZTtcbiAgICAgICAgICAgICAgICBzZXRCdXR0b25EaXNwbGF5KCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBzZXRNb2RlKCkge1xuICAgICAgICAgICAgaWYgKCRzdGF0ZS5pcygnY29udGl2Lm1lbnUubm9kZXMuZGV0YWlscy5lZGl0JykpIHtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubW9kZSA9ICdlZGl0JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5tb2RlID0gJ2RldGFpbHMnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvSW5mbygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubm9kZXMuZGV0YWlscy5pbmZvJyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlQmdwSW5mbygpIHtcbiAgICAgICAgICAgIGlmIChub2RlRGV0YWlsc0N0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3Iua2V5ID0gJHN0YXRlUGFyYW1zLmtleTtcbiAgICAgICAgICAgICAgICAvLyBiYWNrZW5kIG9ubHkgc3VwcG9ydHMgYWRkaW5nIG9uZSBuZWlnaGJvciBjdXJyZW50bHlcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3JzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm5laWdoYm9yWyduZWlnaGJvciddID0gaXRlbS5uYW1lO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3JbJ25laWdoYm9yLWFzJ10gPSBpdGVtLnZhbHVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIEJncFNlcnZpY2UudXBkYXRlQmdwKG5vZGVEZXRhaWxzQ3RybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvciA9IHJlc3VsdC5jb25maWcuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9JbmZvKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnZXRCZ3BJbmZvKCkge1xuICAgICAgICAgICAgQmdwU2VydmljZS5nZXRCZ3Aobm9kZURldGFpbHNDdHJsKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3IgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0QmdwSW5zcGVjdCgpIHtcbiAgICAgICAgICAgIEJncFNlcnZpY2UuZ2V0QmdwSW5zcGVjdCgkc3RhdGVQYXJhbXMua2V5KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuaW5zcGVjdCA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwucm91dGVzID0gcmVzdWx0Lk9wZXIucm91dGVzO1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5maWx0ZXJlZHJvdXRlcyA9IHJlc3VsdC5PcGVyLnJvdXRlcztcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBub2RlRGV0YWlsc0N0cmwuZGVjb21taXNzaW9uID0gZGVjb21taXNzaW9uO1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZSA9IHVwZ3JhZGU7XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zZXRNb2RlID0gc2V0TW9kZTtcbiAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZGF0ZUJncEluZm8gPSB1cGRhdGVCZ3BJbmZvO1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwucmV0dXJuVG9JbmZvID0gcmV0dXJuVG9JbmZvO1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3JzID0gW107XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvciA9IHt9O1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwua2V5ID0gJHN0YXRlUGFyYW1zLmtleTtcbiAgICAgICAgZ2V0QmdwSW5mbygpO1xuICAgICAgICBnZXRCZ3BJbnNwZWN0KCk7XG4gICAgICAgIHNldE1vZGUoKTtcbiAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgIGdldE5vZGVJbmZvKGZhbHNlKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldE5vZGVJbmZvKHRydWUpO1xuICAgICAgICAgICAgfSwgNTAwMCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVkZXRhaWxzY3RybC5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNi8xNC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoXCJjb250aXYubm9kZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2Tm9kZXN0YXR1c1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIG5vZGU6ICc9J1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVzdGF0dXMuaHRtbCdcbiAgICB9O1xufSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2Tm9kZXN0YXRlXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgbm9kZTogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZXN0YXRlLmh0bWwnXG4gICAgfTtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bm9kZWRpcmVjdGl2ZS5qcy5tYXBcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5kaXNjb3ZlcicsIHtcbiAgICAgICAgICAgIHVybDogJy9kaXNjb3ZlcicsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZURpc2NvdmVyQ3RybCBhcyBub2RlRGlzY292ZXJDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWRpc2NvdmVyLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOb2RlRGlzY292ZXJDdHJsJywgW1xuICAgICckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ05vZGVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLCAnTm9kZXNTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIE5vZGVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlLCBOb2Rlc1NlcnZpY2UpIHtcbiAgICAgICAgdmFyIG5vZGVEaXNjb3ZlckN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub05vZGVzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5ub2Rlcy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsRGlzY292ZXJpbmdOb2RlKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9Ob2RlcygpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGRpc2NvdmVyKCkge1xuICAgICAgICAgICAgaWYgKG5vZGVEaXNjb3ZlckN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgICAgICAgICAgICAgY3JlYXRlSVBBZGRyQXJyYXkoKTtcbiAgICAgICAgICAgICAgICBOb2Rlc1NlcnZpY2UuY3JlYXRlRXh0cmFWYXJzKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICAgICAgICAgIE5vZGVzTW9kZWwuZGlzY292ZXIobm9kZURpc2NvdmVyQ3RybC5ub2RlT3BzT2JqKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihub2RlRGlzY292ZXJDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9Ob2RlcygpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihub2RlRGlzY292ZXJDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUlQQWRkckFycmF5KCkge1xuICAgICAgICAgICAgbm9kZURpc2NvdmVyQ3RybC5ub2RlT3BzT2JqLmFkZHJzID0gXy53b3Jkcyhub2RlRGlzY292ZXJDdHJsLm5vZGVJUEFkZHIsIC9bXiwgXSsvZyk7XG4gICAgICAgIH1cbiAgICAgICAgbm9kZURpc2NvdmVyQ3RybC5ub2RlT3BzT2JqID0ge307XG4gICAgICAgIG5vZGVEaXNjb3ZlckN0cmwuZXh0cmFfdmFycyA9IHt9OyAvL1RPRE8gSW50aWFsaXplIGZyb20gZ2xvYmFsIHNldHRpbmdzXG4gICAgICAgIG5vZGVEaXNjb3ZlckN0cmwuYW5zaWJsZVZhcmlhYmxlcyA9IFtdO1xuICAgICAgICBub2RlRGlzY292ZXJDdHJsLmVudlZhcmlhYmxlcyA9IFtdO1xuICAgICAgICBub2RlRGlzY292ZXJDdHJsLm5vZGVJUEFkZHIgPSAnJzsgLy9JUCBhZGRyZXNzIG9mIG5vZGVzIHRvIGRpc2NvdmVyXG4gICAgICAgIE5vZGVzU2VydmljZS5nZXRTZXR0aW5ncyhub2RlRGlzY292ZXJDdHJsKTtcbiAgICAgICAgbm9kZURpc2NvdmVyQ3RybC5kaXNjb3ZlciA9IGRpc2NvdmVyO1xuICAgICAgICBub2RlRGlzY292ZXJDdHJsLmNhbmNlbERpc2NvdmVyaW5nTm9kZSA9IGNhbmNlbERpc2NvdmVyaW5nTm9kZTtcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihub2RlRGlzY292ZXJDdHJsKTtcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVkaXNjb3ZlcmN0cmwuanMubWFwXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMubGFzdGxvZycsIHtcbiAgICAgICAgICAgIHVybDogJy9sYXN0bG9nJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlTGFzdEpvYkxvZ3NDdHJsIGFzIG5vZGVMYXN0Sm9iTG9nc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8Y3R2LWxvZ3MgdGl0bGU9XCJMYXN0IEpvYlwiIGxvZz1cIm5vZGVMYXN0Sm9iTG9nc0N0cmwubGFzdExvZ3NcIj48L2N0di1sb2dzPidcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVMYXN0Sm9iTG9nc0N0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnTG9nU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzY29wZSwgJGludGVydmFsLCBMb2dTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBub2RlTGFzdEpvYkxvZ3NDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gZ2V0TGFzdExvZ3MoKSB7XG4gICAgICAgICAgICBMb2dTZXJ2aWNlLmdldExhc3RMb2dzKCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgbm9kZUxhc3RKb2JMb2dzQ3RybC5sYXN0TG9ncyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBnZXRMYXN0TG9ncygpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0TGFzdExvZ3MoKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVsYXN0am9ibG9nc2N0cmwuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMjIvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5saXN0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVMaXN0Q3RybCBhcyBub2RlTGlzdEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2RlbGlzdC5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTm9kZUxpc3RDdHJsJywgWyckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnTm9kZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBOb2Rlc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgbm9kZUxpc3RDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gZ2V0Tm9kZXMocmVsb2FkKSB7XG4gICAgICAgICAgICBOb2Rlc01vZGVsLmdldChyZWxvYWQpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobm9kZUxpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICBub2RlTGlzdEN0cmwubm9kZXMgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobm9kZUxpc3RDdHJsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vTG9hZCBmcm9tIGNhY2hlIGZvciBxdWljayBkaXNwbGF5IGluaXRpYWxseVxuICAgICAgICBnZXROb2RlcyhmYWxzZSk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG8tcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXROb2Rlcyh0cnVlKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVsaXN0Y3RybC5qcy5tYXBcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYub3JnYW5pemF0aW9ucycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMuY3JlYXRlJywge1xuICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ29yZ2FuaXphdGlvbnMvb3JnYW5pemF0aW9uY3JlYXRlLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ09yZ2FuaXphdGlvbkNyZWF0ZUN0cmwgYXMgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ09yZ2FuaXphdGlvbkNyZWF0ZUN0cmwnLCBbJyRzdGF0ZScsICdPcmdhbml6YXRpb25zTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsIE9yZ2FuaXphdGlvbnNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub09yZ2FuaXphdGlvbnMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMubGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbENyZWF0aW5nKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9Pcmdhbml6YXRpb25zKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlT3JnYW5pemF0aW9uKCkge1xuICAgICAgICAgICAgLy9mb3JtIGNvbnRyb2xsZXIgaXMgaW5qZWN0ZWQgYnkgdGhlIGh0bWwgdGVtcGxhdGVcbiAgICAgICAgICAgIC8vY2hlY2tpbmcgaWYgYWxsIHZhbGlkYXRpb25zIGhhdmUgcGFzc2VkXG4gICAgICAgICAgICBpZiAob3JnYW5pemF0aW9uQ3JlYXRlQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25DcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihvcmdhbml6YXRpb25DcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBvcmdhbml6YXRpb25DcmVhdGVDdHJsLm5ld09yZ2FuaXphdGlvbi5rZXkgPSBvcmdhbml6YXRpb25DcmVhdGVDdHJsLm5ld09yZ2FuaXphdGlvbi50ZW5hbnROYW1lO1xuICAgICAgICAgICAgICAgIE9yZ2FuaXphdGlvbnNNb2RlbC5jcmVhdGUob3JnYW5pemF0aW9uQ3JlYXRlQ3RybC5uZXdPcmdhbml6YXRpb24pLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub09yZ2FuaXphdGlvbnMoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Iob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXNldEZvcm0oKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybC5uZXdPcmdhbml6YXRpb24gPSB7XG4gICAgICAgICAgICAgICAgdGVuYW50TmFtZTogJydcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybC5jcmVhdGVPcmdhbml6YXRpb24gPSBjcmVhdGVPcmdhbml6YXRpb247XG4gICAgICAgIG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwuY2FuY2VsQ3JlYXRpbmcgPSBjYW5jZWxDcmVhdGluZztcbiAgICAgICAgcmVzZXRGb3JtKCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9b3JnYW5pemF0aW9uY3JlYXRlY3RybC5qcy5tYXBcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYub3JnYW5pemF0aW9ucycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ09yZ2FuaXphdGlvbkRldGFpbHNDdHJsIGFzIG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnb3JnYW5pemF0aW9ucy9vcmdhbml6YXRpb25kZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdPcmdhbml6YXRpb25EZXRhaWxzQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdPcmdhbml6YXRpb25zTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgT3JnYW5pemF0aW9uc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgb3JnYW5pemF0aW9uRGV0YWlsc0N0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub09yZ2FuaXphdGlvbnMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMubGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGRlbGV0ZU9yZ2FuaXphdGlvbigpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBPcmdhbml6YXRpb25zTW9kZWwuZGVsZXRlKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsLm9yZ2FuaXphdGlvbikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9Pcmdhbml6YXRpb25zKCk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICBPcmdhbml6YXRpb25zTW9kZWwuZ2V0TW9kZWxCeUtleSgkc3RhdGVQYXJhbXMua2V5KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKG9yZ2FuaXphdGlvbikge1xuICAgICAgICAgICAgb3JnYW5pemF0aW9uRGV0YWlsc0N0cmwub3JnYW5pemF0aW9uID0gb3JnYW5pemF0aW9uO1xuICAgICAgICB9KTtcbiAgICAgICAgb3JnYW5pemF0aW9uRGV0YWlsc0N0cmwuZGVsZXRlT3JnYW5pemF0aW9uID0gZGVsZXRlT3JnYW5pemF0aW9uO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW9yZ2FuaXphdGlvbmRldGFpbHNjdHJsLmpzLm1hcFxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5vcmdhbml6YXRpb25zJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5saXN0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ09yZ2FuaXphdGlvbnNMaXN0Q3RybCBhcyBvcmdhbml6YXRpb25zTGlzdEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdvcmdhbml6YXRpb25zL29yZ2FuaXphdGlvbmxpc3QuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ09yZ2FuaXphdGlvbnNMaXN0Q3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ09yZ2FuaXphdGlvbnNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBPcmdhbml6YXRpb25zTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBvcmdhbml6YXRpb25zTGlzdEN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBnZXRPcmdhbml6YXRpb25zKHJlbG9hZCkge1xuICAgICAgICAgICAgT3JnYW5pemF0aW9uc01vZGVsLmdldChyZWxvYWQpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uc0xpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICBvcmdhbml6YXRpb25zTGlzdEN0cmwub3JnYW5pemF0aW9ucyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25zTGlzdEN0cmwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgIGdldE9yZ2FuaXphdGlvbnMoZmFsc2UpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXRPcmdhbml6YXRpb25zKHRydWUpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9b3JnYW5pemF0aW9ubGlzdGN0cmwuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTIvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc2VydmljZWxicycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMuY3JlYXRlJywge1xuICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NlcnZpY2VfbGJzL3NlcnZpY2VsYmNyZWF0ZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTZXJ2aWNlbGJDcmVhdGVDdHJsIGFzIHNlcnZpY2VsYkNyZWF0ZUN0cmwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdTZXJ2aWNlbGJDcmVhdGVDdHJsJywgW1xuICAgICckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ1NlcnZpY2VsYnNNb2RlbCcsICdOZXR3b3Jrc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIFNlcnZpY2VsYnNNb2RlbCwgTmV0d29ya3NNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHNlcnZpY2VsYkNyZWF0ZUN0cmwgPSB0aGlzO1xuICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLmxhYmVsU2VsZWN0b3JzID0gW107XG4gICAgICAgIHNlcnZpY2VsYkNyZWF0ZUN0cmwubmV0d29ya3MgPSBbXTtcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9TZXJ2aWNlbGJzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxDcmVhdGluZygpIHtcbiAgICAgICAgICAgIHJldHVyblRvU2VydmljZWxicygpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZXQgbmV0d29ya3MgZm9yIHRoZSBnaXZlbiB0ZW5hbnQuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBnZXROZXR3b3JrcygpIHtcbiAgICAgICAgICAgIE5ldHdvcmtzTW9kZWwuZ2V0KCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5uZXR3b3JrcyA9IF8uZmlsdGVyKHJlc3VsdCwge1xuICAgICAgICAgICAgICAgICAgICAndGVuYW50TmFtZSc6ICdkZWZhdWx0JyAvL1RPRE86IFJlbW92ZSBoYXJkY29kZWQgdGVuYW50LlxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlTGFiZWxTZWxlY3RvclN0cmluZ3MoKSB7XG4gICAgICAgICAgICAvL0VtcHR5IG91dCB0aGUgc2VsZWN0b3JzLiBJbiBjYXNlIG9mIHNlcnZlciBlcnJvcnMgdGhpcyBuZWVkcyB0byBiZSByZXNldC5cbiAgICAgICAgICAgIHNlcnZpY2VsYkNyZWF0ZUN0cmwuc2VydmljZWxiLnNlbGVjdG9ycyA9IFtdO1xuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHNlcnZpY2VsYkNyZWF0ZUN0cmwubGFiZWxTZWxlY3RvcnMsIGZ1bmN0aW9uIChsYWJlbFNlbGVjdG9yKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGVjdG9yU3RyaW5nID0gbGFiZWxTZWxlY3Rvci5uYW1lICsgJz0nICsgbGFiZWxTZWxlY3Rvci52YWx1ZTtcbiAgICAgICAgICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLnNlcnZpY2VsYi5zZWxlY3RvcnMucHVzaChzZWxlY3RvclN0cmluZyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVTZXJ2aWNlbGIoKSB7XG4gICAgICAgICAgICBjcmVhdGVMYWJlbFNlbGVjdG9yU3RyaW5ncygpO1xuICAgICAgICAgICAgLy9mb3JtIGNvbnRyb2xsZXIgaXMgaW5qZWN0ZWQgYnkgdGhlIGh0bWwgdGVtcGxhdGVcbiAgICAgICAgICAgIC8vY2hlY2tpbmcgaWYgYWxsIHZhbGlkYXRpb25zIGhhdmUgcGFzc2VkXG4gICAgICAgICAgICBpZiAoc2VydmljZWxiQ3JlYXRlQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzZXJ2aWNlbGJDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihzZXJ2aWNlbGJDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLnNlcnZpY2VsYi5rZXkgPVxuICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLnNlcnZpY2VsYi50ZW5hbnROYW1lICsgJzonICsgc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIuc2VydmljZU5hbWU7XG4gICAgICAgICAgICAgICAgU2VydmljZWxic01vZGVsLmNyZWF0ZShzZXJ2aWNlbGJDcmVhdGVDdHJsLnNlcnZpY2VsYikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc2VydmljZWxiQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvU2VydmljZWxicygpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc2VydmljZWxiQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihzZXJ2aWNlbGJDcmVhdGVDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJlc2V0Rm9ybSgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc2VydmljZWxiQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc2VydmljZWxiQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLnNlcnZpY2VsYiA9IHtcbiAgICAgICAgICAgICAgICBzZXJ2aWNlTmFtZTogJycsXG4gICAgICAgICAgICAgICAgbmV0d29ya05hbWU6ICcnLFxuICAgICAgICAgICAgICAgIGlwQWRkcmVzczogJycsXG4gICAgICAgICAgICAgICAgc2VsZWN0b3JzOiBbXSxcbiAgICAgICAgICAgICAgICBwb3J0czogW10sXG4gICAgICAgICAgICAgICAgdGVuYW50TmFtZTogJ2RlZmF1bHQnIC8vVE9ETzogUmVtb3ZlIGhhcmRjb2RlZCB0ZW5hbnQuXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHNlcnZpY2VsYkNyZWF0ZUN0cmwuY3JlYXRlU2VydmljZWxiID0gY3JlYXRlU2VydmljZWxiO1xuICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLmNhbmNlbENyZWF0aW5nID0gY2FuY2VsQ3JlYXRpbmc7XG4gICAgICAgIGdldE5ldHdvcmtzKCk7XG4gICAgICAgIHJlc2V0Rm9ybSgpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNlcnZpY2VsYmNyZWF0ZWN0cmwuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTEvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc2VydmljZWxicycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgcGFyYW1zOiB7IHN0YXRlOiBudWxsIH0sXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU2VydmljZWxiRGV0YWlsc0N0cmwgYXMgc2VydmljZWxiRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXJ2aWNlX2xicy9zZXJ2aWNlbGJkZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMuZGV0YWlscy5pbmZvJywge1xuICAgICAgICAgICAgdXJsOiAnL2luZm8nLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1NlcnZpY2VsYkRldGFpbHNDdHJsIGFzIHNlcnZpY2VsYkRldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2VydmljZV9sYnMvc2VydmljZWxiaW5mby5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmRldGFpbHMuZWRpdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9lZGl0LzprZXknLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1NlcnZpY2VsYkRldGFpbHNDdHJsIGFzIHNlcnZpY2VsYkRldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2VydmljZV9sYnMvc2VydmljZWxiaW5mby5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignU2VydmljZWxiRGV0YWlsc0N0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnU2VydmljZWxic01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIFNlcnZpY2VsYnNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHNlcnZpY2VsYkRldGFpbHNDdHJsID0gdGhpcztcbiAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwubGFiZWxTZWxlY3RvcnMgPSBbXTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRvIHNob3cgZWRpdCBvciBkZXRhaWxzIHNjcmVlbiBiYXNlZCBvbiB0aGUgcm91dGVcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHNldE1vZGUoKSB7XG4gICAgICAgICAgICBpZiAoJHN0YXRlLmlzKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmRldGFpbHMuZWRpdCcpKSB7XG4gICAgICAgICAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwubW9kZSA9ICdlZGl0JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHNlcnZpY2VsYkRldGFpbHNDdHJsLm1vZGUgPSAnZGV0YWlscyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9TZXJ2aWNlbGJzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1NlcnZpY2VsYkRldGFpbHMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMuZGV0YWlscy5pbmZvJywgeyAna2V5Jzogc2VydmljZWxiRGV0YWlsc0N0cmwuc2VydmljZWxiLmtleSwgJ3N0YXRlJzogJ2RldGFpbHMnIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbEVkaXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub1NlcnZpY2VsYkRldGFpbHMoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBkZWxldGVTZXJ2aWNlbGIoKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgU2VydmljZWxic01vZGVsLmRlbGV0ZShzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIHJldHVyblRvU2VydmljZWxicygpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Ioc2VydmljZWxiRGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBzYXZlU2VydmljZWxiKCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHNlcnZpY2VsYkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKHNlcnZpY2VsYkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIHZhciBleGlzdGluZ0xhYmVscyA9IHNlcnZpY2VsYkRldGFpbHNDdHJsLnNlcnZpY2VsYi5zZWxlY3RvcnM7XG4gICAgICAgICAgICBjcmVhdGVMYWJlbFNlbGVjdG9yU3RyaW5ncygpO1xuICAgICAgICAgICAgU2VydmljZWxic01vZGVsLnNhdmUoc2VydmljZWxiRGV0YWlsc0N0cmwuc2VydmljZWxiKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICByZXR1cm5Ub1NlcnZpY2VsYkRldGFpbHMoKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwuc2VydmljZWxiLnNlbGVjdG9ycyA9IGV4aXN0aW5nTGFiZWxzO1xuICAgICAgICAgICAgICAgIGNyZWF0ZUxhYmVsU2VsZWN0b3JzKCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHNlcnZpY2VsYkRldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlTGFiZWxTZWxlY3RvcnMoKSB7XG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goc2VydmljZWxiRGV0YWlsc0N0cmwuc2VydmljZWxiLnNlbGVjdG9ycywgZnVuY3Rpb24gKHNlbGVjdG9yU3RyKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGVjdG9yID0ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBzZWxlY3RvclN0ci5zcGxpdCgnPScpWzBdLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogc2VsZWN0b3JTdHIuc3BsaXQoJz0nKVsxXVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwubGFiZWxTZWxlY3RvcnMucHVzaChzZWxlY3Rvcik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVMYWJlbFNlbGVjdG9yU3RyaW5ncygpIHtcbiAgICAgICAgICAgIHNlcnZpY2VsYkRldGFpbHNDdHJsLnNlcnZpY2VsYi5zZWxlY3RvcnMgPSBbXTtcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChzZXJ2aWNlbGJEZXRhaWxzQ3RybC5sYWJlbFNlbGVjdG9ycywgZnVuY3Rpb24gKGxhYmVsU2VsZWN0b3IpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2VsZWN0b3JTdHJpbmcgPSBsYWJlbFNlbGVjdG9yLm5hbWUgKyAnPScgKyBsYWJlbFNlbGVjdG9yLnZhbHVlO1xuICAgICAgICAgICAgICAgIHNlcnZpY2VsYkRldGFpbHNDdHJsLnNlcnZpY2VsYi5zZWxlY3RvcnMucHVzaChzZWxlY3RvclN0cmluZyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkRldGFpbHNDdHJsKTtcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHNlcnZpY2VsYkRldGFpbHNDdHJsKTtcbiAgICAgICAgU2VydmljZWxic01vZGVsLmdldE1vZGVsQnlLZXkoJHN0YXRlUGFyYW1zLmtleSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhzZXJ2aWNlbGIpIHtcbiAgICAgICAgICAgIHNlcnZpY2VsYkRldGFpbHNDdHJsLnNlcnZpY2VsYiA9IHNlcnZpY2VsYjtcbiAgICAgICAgICAgIGNyZWF0ZUxhYmVsU2VsZWN0b3JzKCk7XG4gICAgICAgIH0pO1xuICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zYXZlU2VydmljZWxiID0gc2F2ZVNlcnZpY2VsYjtcbiAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwuY2FuY2VsRWRpdGluZyA9IGNhbmNlbEVkaXRpbmc7XG4gICAgICAgIHNlcnZpY2VsYkRldGFpbHNDdHJsLmRlbGV0ZVNlcnZpY2VsYiA9IGRlbGV0ZVNlcnZpY2VsYjtcbiAgICAgICAgc2V0TW9kZSgpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNlcnZpY2VsYmRldGFpbHNjdHJsLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzExLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnNlcnZpY2VsYnMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU2VydmljZWxiTGlzdEN0cmwgYXMgc2VydmljZWxiTGlzdEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXJ2aWNlX2xicy9zZXJ2aWNlbGJsaXN0Lmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdTZXJ2aWNlbGJMaXN0Q3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ1NlcnZpY2VsYnNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBTZXJ2aWNlbGJzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlbGJMaXN0Q3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGdldFNlcnZpY2VsYnMocmVsb2FkKSB7XG4gICAgICAgICAgICBTZXJ2aWNlbGJzTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzZXJ2aWNlbGJMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgc2VydmljZWxiTGlzdEN0cmwuc2VydmljZWxicyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzZXJ2aWNlbGJMaXN0Q3RybCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgZ2V0U2VydmljZWxicyhmYWxzZSk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG9yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldFNlcnZpY2VsYnModHJ1ZSk7XG4gICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zZXJ2aWNlbGJsaXN0Y3RybC5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xMy8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoXCJjb250aXYuc2VydmljZWxic1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZTZXJ2aWNlbGJwb3J0c1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIGl0ZW1zOiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlKSB7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENvbXBhcmUgaWYgdHdvIGl0ZW1zIGhhdmUgc2FtZSBwb3J0cyBhbmQgcHJvdG9jb2xzXG4gICAgICAgICAgICAgKiBAcGFyYW0gdmFsMVxuICAgICAgICAgICAgICogQHBhcmFtIHZhbDJcbiAgICAgICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmdW5jdGlvbiBjb21wYXJlKHZhbDEsIHZhbDIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKHZhbDEgPT09IHZhbDIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZnVuY3Rpb24gcmVzZXROZXdJdGVtKCkge1xuICAgICAgICAgICAgICAgIHNjb3BlLm5ld0l0ZW0gPSB7XG4gICAgICAgICAgICAgICAgICAgIHNlcnZpY2VQb3J0OiAnJyxcbiAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXJQb3J0OiAnJyxcbiAgICAgICAgICAgICAgICAgICAgcHJvdG9jb2w6ICcnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZ1bmN0aW9uIGlzRW1wdHlJdGVtKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKGl0ZW0uc2VydmljZVBvcnQgPT09ICcnICYmIGl0ZW0ucHJvdmlkZXJQb3J0ID09PSAnJyAmJiBpdGVtLnByb3RvY29sID09PSAnJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzY29wZS5hZGQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzRW1wdHlJdGVtKHNjb3BlLm5ld0l0ZW0pKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgaWYgKHNjb3BlLml0ZW1zID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuaXRlbXMgPSBbXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG5ld0l0ZW1TdHIgPSBzY29wZS5uZXdJdGVtLnNlcnZpY2VQb3J0ICsgJzonXG4gICAgICAgICAgICAgICAgICAgICsgc2NvcGUubmV3SXRlbS5wcm92aWRlclBvcnQgKyAnOidcbiAgICAgICAgICAgICAgICAgICAgKyBzY29wZS5uZXdJdGVtLnByb3RvY29sO1xuICAgICAgICAgICAgICAgIC8vUmVtb3ZlcyBleGlzdGluZyBpdGVtIHdpdGggdGhlIHNhbWUgdmFsdWUgZmlyc3QgaWYgaXQgZXhpc3RzLlxuICAgICAgICAgICAgICAgIF8ucHVsbEFsbFdpdGgoc2NvcGUuaXRlbXMsIFtuZXdJdGVtU3RyXSwgY29tcGFyZSk7XG4gICAgICAgICAgICAgICAgc2NvcGUuaXRlbXMucHVzaChuZXdJdGVtU3RyKTtcbiAgICAgICAgICAgICAgICByZXNldE5ld0l0ZW0oKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBzY29wZS5yZW1vdmUgPSBmdW5jdGlvbiAocGFzc2VkSXRlbSkge1xuICAgICAgICAgICAgICAgIF8ucmVtb3ZlKHNjb3BlLml0ZW1zLCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcGFyZShpdGVtLCBwYXNzZWRJdGVtKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXNldE5ld0l0ZW0oKTtcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXJ2aWNlX2xicy9zZXJ2aWNlbGJwb3J0cy5odG1sJ1xuICAgIH07XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNlcnZpY2VsYnBvcnRzZGlyZWN0aXZlLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IGNzaGFtcHVyIG9uIDcvMTcvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc2VydmljZWxicycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMuZGV0YWlscy5zdGF0cycsIHtcbiAgICAgICAgICAgIHVybDogJy9zdGF0cycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU2VydmljZWxiU3RhdHNDdHJsIGFzIHNlcnZpY2VsYlN0YXRzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NlcnZpY2VfbGJzL3NlcnZpY2VsYnN0YXRzLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdTZXJ2aWNlbGJTdGF0c0N0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ1NlcnZpY2VsYnNNb2RlbCcsICdJbnNwZWN0U2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCAkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgU2VydmljZWxic01vZGVsLCBJbnNwZWN0U2VydmljZSkge1xuICAgICAgICB2YXIgc2VydmljZWxiU3RhdHNDdHJsID0gdGhpcztcbiAgICAgICAgLyogR2V0cyB0aGUgTmV0d29yayBPcGVyYXRpb25hbCBzdGF0ZSBmcm9tIHRoZSBzZXJ2ZXIgKi9cbiAgICAgICAgZnVuY3Rpb24gZ2V0U2VydmljZWxiSW5zcGVjdChyZWZyZXNoKSB7XG4gICAgICAgICAgICBTZXJ2aWNlbGJzTW9kZWwuZ2V0SW5zcGVjdEJ5S2V5KCRzdGF0ZVBhcmFtcy5rZXksIENvbnRpdkdsb2JhbHMuU0VSVklDRUxCU19JTlNQRUNUX0VORFBPSU5ULCByZWZyZXNoKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBzZXJ2aWNlbGJTdGF0c0N0cmwuc2VydmljZWxiSW5zcGVjdFN0YXRzID0gcmVzdWx0Lk9wZXI7XG4gICAgICAgICAgICAgICAgc2VydmljZWxiU3RhdHNDdHJsLmNvbmZpZyA9IHJlc3VsdC5Db25maWc7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5PcGVyLnByb3ZpZGVycyAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb3ZpZGVyRGV0YWlscyA9IEluc3BlY3RTZXJ2aWNlLmJ1aWxkRW5kUG9pbnRzKHJlc3VsdC5PcGVyLnByb3ZpZGVycyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChJbnNwZWN0U2VydmljZS5jaGVja0NvbnRhaW5lckNoYW5nZWQoc2VydmljZWxiU3RhdHNDdHJsLnByb3ZpZGVyRGV0YWlscywgcHJvdmlkZXJEZXRhaWxzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZWxiU3RhdHNDdHJsLnByb3ZpZGVycyA9IHJlc3VsdC5PcGVyLnByb3ZpZGVycztcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2VsYlN0YXRzQ3RybC5wcm92aWRlckRldGFpbHMgPSBwcm92aWRlckRldGFpbHM7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNlcnZpY2VsYlN0YXRzQ3RybC5wcm92aWRlcnMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgc2VydmljZWxiU3RhdHNDdHJsLnByb3ZpZGVyRGV0YWlscyA9IHt9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGdldFNlcnZpY2VsYkluc3BlY3QoZmFsc2UpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXRTZXJ2aWNlbGJJbnNwZWN0KHRydWUpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c2VydmljZWxic3RhdHNjdHJsLmpzLm1hcFxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zZXR0aW5ncycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMuY2x1c3RlcicsIHtcbiAgICAgICAgICAgIHVybDogJy9jbHVzdGVyJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdDbHVzdGVyU2V0dGluZ0N0cmwgYXMgY2x1c3RlclNldHRpbmdDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2V0dGluZ3MvY2x1c3RlcnNldHRpbmdzLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdDbHVzdGVyU2V0dGluZ0N0cmwnLCBbJyRzdGF0ZVBhcmFtcycsICdDUlVESGVscGVyU2VydmljZScsICdOb2Rlc1NlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGVQYXJhbXMsIENSVURIZWxwZXJTZXJ2aWNlLCBOb2Rlc1NlcnZpY2UpIHtcbiAgICAgICAgdmFyIGNsdXN0ZXJTZXR0aW5nQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUNsdXN0ZXJTZXR0aW5ncygpIHtcbiAgICAgICAgICAgIGlmIChjbHVzdGVyU2V0dGluZ0N0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoY2x1c3RlclNldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgIGNsdXN0ZXJTZXR0aW5nQ3RybC5ub2RlT3BzT2JqLm5vZGVzID0gWyRzdGF0ZVBhcmFtcy5rZXldO1xuICAgICAgICAgICAgICAgIE5vZGVzU2VydmljZS5jbGVhbnVwRXh0cmFWYXJzKGNsdXN0ZXJTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgTm9kZXNTZXJ2aWNlLmNyZWF0ZUV4dHJhVmFycyhjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgIE5vZGVzU2VydmljZS51cGRhdGVTZXR0aW5ncyhjbHVzdGVyU2V0dGluZ0N0cmwubm9kZU9wc09iaikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoY2x1c3RlclNldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGNsdXN0ZXJTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihjbHVzdGVyU2V0dGluZ0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2x1c3RlclNldHRpbmdDdHJsLm5vZGVPcHNPYmogPSB7fTtcbiAgICAgICAgY2x1c3RlclNldHRpbmdDdHJsLmV4dHJhX3ZhcnMgPSB7fTsgLy9UT0RPIEludGlhbGl6ZSBmcm9tIGdsb2JhbCBzZXR0aW5nc1xuICAgICAgICBjbHVzdGVyU2V0dGluZ0N0cmwuYW5zaWJsZVZhcmlhYmxlcyA9IFtdO1xuICAgICAgICBjbHVzdGVyU2V0dGluZ0N0cmwuZW52VmFyaWFibGVzID0gW107XG4gICAgICAgIE5vZGVzU2VydmljZS5nZXRTZXR0aW5ncyhjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgICAgICBjbHVzdGVyU2V0dGluZ0N0cmwudXBkYXRlQ2x1c3RlclNldHRpbmdzID0gdXBkYXRlQ2x1c3RlclNldHRpbmdzO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGNsdXN0ZXJTZXR0aW5nQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNsdXN0ZXJzZXR0aW5nY3RybC5qcy5tYXBcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc2V0dGluZ3MnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLm5ldHdvcmtzJywge1xuICAgICAgICAgICAgdXJsOiAnL25ldHdvcmtzJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOZXR3b3JrU2V0dGluZ0N0cmwgYXMgbmV0d29ya1NldHRpbmdDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2V0dGluZ3MvbmV0d29ya3NldHRpbmdzLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOZXR3b3JrU2V0dGluZ0N0cmwnLCBbJ0NSVURIZWxwZXJTZXJ2aWNlJywgJ05ldHdvcmtTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoQ1JVREhlbHBlclNlcnZpY2UsIE5ldHdvcmtTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBuZXR3b3JrU2V0dGluZ0N0cmwgPSB0aGlzO1xuICAgICAgICBuZXR3b3JrU2V0dGluZ0N0cmwudmxhblBhdHRlcm4gPSBDb250aXZHbG9iYWxzLlZMQU5fUkVHRVg7XG4gICAgICAgIG5ldHdvcmtTZXR0aW5nQ3RybC52eGxhblBhdHRlcm4gPSBDb250aXZHbG9iYWxzLlZYTEFOX1JFR0VYO1xuICAgICAgICBmdW5jdGlvbiB1cGRhdGVOZXR3b3JrU2V0dGluZ3MoKSB7XG4gICAgICAgICAgICBpZiAobmV0d29ya1NldHRpbmdDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG5ldHdvcmtTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIobmV0d29ya1NldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICBOZXR3b3JrU2VydmljZS51cGRhdGVTZXR0aW5ncyhuZXR3b3JrU2V0dGluZ0N0cmwuc2V0dGluZykudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobmV0d29ya1NldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihuZXR3b3JrU2V0dGluZ0N0cmwsIHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnZXROZXR3b3JrU2V0dGluZ3MoKSB7XG4gICAgICAgICAgICBOZXR3b3JrU2VydmljZS5nZXRTZXR0aW5ncygpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIG5ldHdvcmtTZXR0aW5nQ3RybC5zZXR0aW5nID0gcmVzdWx0O1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGdldE5ldHdvcmtTZXR0aW5ncygpO1xuICAgICAgICBuZXR3b3JrU2V0dGluZ0N0cmwudXBkYXRlTmV0d29ya1NldHRpbmdzID0gdXBkYXRlTmV0d29ya1NldHRpbmdzO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtTZXR0aW5nQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihuZXR3b3JrU2V0dGluZ0N0cmwpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5ldHdvcmtzZXR0aW5nY3RybC5qcy5tYXBcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc2V0dGluZ3MnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLnZvbHVtZXMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvdm9sdW1lcycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVm9sdW1lU2V0dGluZ0N0cmwgYXMgdm9sdW1lU2V0dGluZ0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXR0aW5ncy92b2x1bWVzZXR0aW5ncy5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignVm9sdW1lU2V0dGluZ0N0cmwnLCBbJ0NSVURIZWxwZXJTZXJ2aWNlJywgJ1ZvbHVtZVNldHRpbmdTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoQ1JVREhlbHBlclNlcnZpY2UsIFZvbHVtZVNldHRpbmdTZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2b2x1bWVTZXR0aW5nQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZVZvbHVtZVNldHRpbmdzKCkge1xuICAgICAgICAgICAgaWYgKHZvbHVtZVNldHRpbmdDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHZvbHVtZVNldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcih2b2x1bWVTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgVm9sdW1lU2V0dGluZ1NlcnZpY2UudXBkYXRlU2V0dGluZ3Modm9sdW1lU2V0dGluZ0N0cmwuc2V0dGluZykudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Iodm9sdW1lU2V0dGluZ0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0Vm9sdW1lU2V0dGluZ3MoKSB7XG4gICAgICAgICAgICBWb2x1bWVTZXR0aW5nU2VydmljZS5nZXRTZXR0aW5ncygpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHZvbHVtZVNldHRpbmdDdHJsLnNldHRpbmcgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZ2V0Vm9sdW1lU2V0dGluZ3MoKTtcbiAgICAgICAgdm9sdW1lU2V0dGluZ0N0cmwudXBkYXRlVm9sdW1lU2V0dGluZ3MgPSB1cGRhdGVWb2x1bWVTZXR0aW5ncztcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVTZXR0aW5nQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcih2b2x1bWVTZXR0aW5nQ3RybCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dm9sdW1lc2V0dGluZ2N0cmwuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDYvMS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zdG9yYWdlcG9saWNpZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMuY3JlYXRlJywge1xuICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvc3RvcmFnZXBvbGljeWNyZWF0ZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCBhcyBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1N0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ1N0b3JhZ2VQb2xpY2llc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIFN0b3JhZ2VQb2xpY2llc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1N0b3JhZ2VQb2xpY2llcygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxDcmVhdGluZygpIHtcbiAgICAgICAgICAgIHJldHVyblRvU3RvcmFnZVBvbGljaWVzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlRmlsZXN5c3RlbUNtZHMoKSB7XG4gICAgICAgICAgICBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5maWxlc3lzdGVtY21kcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwubmV3U3RvcmFnZVBvbGljeS5maWxlc3lzdGVtc1tpdGVtLm5hbWVdID0gaXRlbS52YWx1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZVBvbGljeSgpIHtcbiAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgaWYgKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgY3JlYXRlRmlsZXN5c3RlbUNtZHMoKTtcbiAgICAgICAgICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbC5jcmVhdGUoc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwubmV3U3RvcmFnZVBvbGljeSlcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9TdG9yYWdlUG9saWNpZXMoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJlc2V0Rm9ybSgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLm5ld1N0b3JhZ2VQb2xpY3kgPSB7XG4gICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgXCJiYWNrZW5kc1wiOiB7XG4gICAgICAgICAgICAgICAgICAgIFwiY3J1ZFwiOiBcImNlcGhcIixcbiAgICAgICAgICAgICAgICAgICAgXCJtb3VudFwiOiBcImNlcGhcIixcbiAgICAgICAgICAgICAgICAgICAgXCJzbmFwc2hvdFwiOiBcImNlcGhcIlxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXCJ1bmxvY2tlZFwiOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBcImRyaXZlclwiOiB7XG4gICAgICAgICAgICAgICAgICAgIFwicG9vbFwiOiBcInJiZFwiXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBcImNyZWF0ZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgIFwic2l6ZVwiOiBcIjBcIixcbiAgICAgICAgICAgICAgICAgICAgXCJmaWxlc3lzdGVtXCI6IFwiXCJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFwicnVudGltZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgIFwic25hcHNob3RzXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIFwic25hcHNob3RcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJmcmVxdWVuY3lcIjogXCIzMG1cIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwia2VlcFwiOiAyMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBcInJhdGUtbGltaXRcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJ3cml0ZS1pb3BzXCI6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJlYWQtaW9wc1wiOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ3cml0ZS1icHNcIjogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVhZC1icHNcIjogMFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBcImZpbGVzeXN0ZW1zXCI6IHt9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLmNyZWF0ZVBvbGljeSA9IGNyZWF0ZVBvbGljeTtcbiAgICAgICAgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwuY2FuY2VsQ3JlYXRpbmcgPSBjYW5jZWxDcmVhdGluZztcbiAgICAgICAgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwuZmlsZXN5c3RlbWNtZHMgPSBbXTtcbiAgICAgICAgcmVzZXRGb3JtKCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3RvcmFnZXBvbGljeWNyZWF0ZWN0cmwuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMjcvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc3RvcmFnZXBvbGljaWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwgYXMgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9zdG9yYWdlcG9saWN5ZGV0YWlscy5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMuZWRpdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1N0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCBhcyBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL3N0b3JhZ2Vwb2xpY3lkZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdTdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ1N0b3JhZ2VQb2xpY2llc01vZGVsJywgJ1ZvbHVtZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCAkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgU3RvcmFnZVBvbGljaWVzTW9kZWwsIFZvbHVtZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCA9IHRoaXM7XG4gICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5maWxlc3lzdGVtY21kcyA9IFtdO1xuICAgICAgICAvKipcbiAgICAgICAgICogVG8gc2hvdyBlZGl0IG9yIGRldGFpbHMgc2NyZWVuIGJhc2VkIG9uIHRoZSByb3V0ZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gc2V0TW9kZSgpIHtcbiAgICAgICAgICAgIGlmICgkc3RhdGUuaXMoJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5lZGl0JykpIHtcbiAgICAgICAgICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwubW9kZSA9ICdlZGl0JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5tb2RlID0gJ2RldGFpbHMnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvUG9saWNpZXMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Qb2xpY3lEZXRhaWxzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMuZGV0YWlscycsIHsgJ2tleSc6IHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kubmFtZSB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxFZGl0aW5nKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9Qb2xpY3lEZXRhaWxzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZGVsZXRlUG9saWN5KCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgU3RvcmFnZVBvbGljaWVzTW9kZWwuZGVsZXRlVXNpbmdLZXkoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnBvbGljeS5uYW1lLCAnbmFtZScpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICByZXR1cm5Ub1BvbGljaWVzKCk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdldCB2b2x1bWVzIGJlbG9uZ2luZyB0byBhIHBvbGljeVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gZ2V0Vm9sdW1lcyhyZWxvYWQpIHtcbiAgICAgICAgICAgIFZvbHVtZXNNb2RlbC5nZXQocmVsb2FkKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwudm9sdW1lcyA9ICRmaWx0ZXIoJ29yZGVyQnknKShfLmZpbHRlcihyZXN1bHQsIHtcbiAgICAgICAgICAgICAgICAgICAgJ3BvbGljeSc6IHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kubmFtZVxuICAgICAgICAgICAgICAgIH0pLCAnbmFtZScpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gaW5pdGlhbGl6ZUZpbGVzeXN0ZW1DbWRzQXJyYXkoKSB7XG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnBvbGljeS5maWxlc3lzdGVtcywgZnVuY3Rpb24gKHZhbHVlLCBrZXkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnB1c2goeyBuYW1lOiBrZXksIHZhbHVlOiB2YWx1ZSB9KTtcbiAgICAgICAgICAgIH0sIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5maWxlc3lzdGVtY21kcyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlRmlsZXN5c3RlbUNtZHMoKSB7XG4gICAgICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwuZmlsZXN5c3RlbWNtZHMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kuZmlsZXN5c3RlbXNbaXRlbS5uYW1lXSA9IGl0ZW0udmFsdWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBzYXZlUG9saWN5KCkge1xuICAgICAgICAgICAgLy9mb3JtIGNvbnRyb2xsZXIgaXMgaW5qZWN0ZWQgYnkgdGhlIGh0bWwgdGVtcGxhdGVcbiAgICAgICAgICAgIC8vY2hlY2tpbmcgaWYgYWxsIHZhbGlkYXRpb25zIGhhdmUgcGFzc2VkXG4gICAgICAgICAgICBpZiAoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBjcmVhdGVGaWxlc3lzdGVtQ21kcygpO1xuICAgICAgICAgICAgICAgIFN0b3JhZ2VQb2xpY2llc01vZGVsLnNhdmUoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnBvbGljeSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9Qb2xpY3lEZXRhaWxzKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgIFN0b3JhZ2VQb2xpY2llc01vZGVsLmdldE1vZGVsQnlLZXkoJHN0YXRlUGFyYW1zLmtleSwgZmFsc2UsICduYW1lJylcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kgPSBwb2xpY3k7XG4gICAgICAgICAgICBpbml0aWFsaXplRmlsZXN5c3RlbUNtZHNBcnJheSgpO1xuICAgICAgICAgICAgZ2V0Vm9sdW1lcyhmYWxzZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwuZGVsZXRlUG9saWN5ID0gZGVsZXRlUG9saWN5O1xuICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwuc2F2ZVBvbGljeSA9IHNhdmVQb2xpY3k7XG4gICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5jYW5jZWxFZGl0aW5nID0gY2FuY2VsRWRpdGluZztcbiAgICAgICAgc2V0TW9kZSgpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXRWb2x1bWVzKHRydWUpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3RvcmFnZXBvbGljeWRldGFpbHNjdHJsLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA2LzIvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LnN0b3JhZ2Vwb2xpY2llc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZTdG9yYWdlcG9saWN5YmFzaWNzZXR0aW5nc1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHt9O1xufSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2U3RvcmFnZXBvbGljeWZpbGVzeXN0ZW1zZXR0aW5nc1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIHBvbGljeTogJz0nLFxuICAgICAgICAgICAgZmlsZXN5c3RlbWNtZHM6ICc9J1xuICAgICAgICB9LFxuICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUpIHtcbiAgICAgICAgICAgIHNjb3BlLmZpbGVzeXN0ZW1zID0gWydleHQ0JywgJ2J0cmZzJ107XG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9maWxlc3lzdGVtc2V0dGluZ3MuaHRtbCdcbiAgICB9O1xufSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2U3RvcmFnZXBvbGljeXNuYXBzaG90c2V0dGluZ3NcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBwb2xpY3k6ICc9J1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvc25hcHNob3RzZXR0aW5ncy5odG1sJ1xuICAgIH07XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZTdG9yYWdlcG9saWN5cndvcHNzZXR0aW5nc1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIHBvbGljeTogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9yd29wc3NldHRpbmdzLmh0bWwnXG4gICAgfTtcbn0pXG4gICAgLmRpcmVjdGl2ZShcImN0dlN0b3JhZ2Vwb2xpY3liYWNrZW5kZHJpdmVyc1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIHBvbGljeTogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9iYWNrZW5kZHJpdmVycy5odG1sJ1xuICAgIH07XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXN0b3JhZ2Vwb2xpY3lkaXJlY3RpdmUuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDQvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc3RvcmFnZXBvbGljaWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU3RvcmFnZVBvbGljeUxpc3RDdHJsIGFzIHN0b3JhZ2VQb2xpY3lMaXN0Q3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvc3RvcmFnZXBvbGljeWxpc3QuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1N0b3JhZ2VQb2xpY3lMaXN0Q3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ1N0b3JhZ2VQb2xpY2llc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIFN0b3JhZ2VQb2xpY2llc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgc3RvcmFnZVBvbGljeUxpc3RDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gZ2V0UG9saWNpZXMocmVsb2FkKSB7XG4gICAgICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbC5nZXQocmVsb2FkKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeUxpc3RDdHJsLnBvbGljaWVzID0gcmVzdWx0O1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lMaXN0Q3RybCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgZ2V0UG9saWNpZXMoZmFsc2UpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0UG9saWNpZXModHJ1ZSk7XG4gICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdG9yYWdlcG9saWN5bGlzdGN0cmwuanMubWFwXG5cblxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52aXN1YWxpemF0aW9uJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUudmlzdWFsaXphdGlvbi5lZGdlJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9lZGdlL3tzb3VyY2VOYW1lLCB0YXJnZXROYW1lLCBzb3VyY2VMaXN0LCB0YXJnZXRMaXN0fScsXG4gICAgICAgICAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZU5hbWU6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldE5hbWU6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZUxpc3Q6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldExpc3Q6IG51bGxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWaXN1YWxpemF0aW9uRWRnZUN0cmwgYXMgdmlzdWFsaXphdGlvbmVkZ2VDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Zpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbmVkZ2UuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignVmlzdWFsaXphdGlvbkVkZ2VDdHJsJywgW1wiJHNjb3BlXCIsIFwiJGh0dHBcIiwgJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnVmlzdWFsaXphdGlvblNlcnZpY2UnLCAnJGludGVydmFsJyxcbiAgICAgICAgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJHN0YXRlLCAkc3RhdGVQYXJhbXMsIFZpc3VhbGl6YXRpb25TZXJ2aWNlLCAkaW50ZXJ2YWwpIHtcbiAgICAgICAgICAgIHZhciBzb3VyY2VOYW1lID0gJHN0YXRlUGFyYW1zLnNvdXJjZU5hbWU7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0TmFtZSA9ICRzdGF0ZVBhcmFtcy50YXJnZXROYW1lO1xuICAgICAgICAgICAgdmFyIHNvdXJjZUxpc3QgPSAkc3RhdGVQYXJhbXMuc291cmNlTGlzdDtcbiAgICAgICAgICAgIHZhciB0YXJnZXRMaXN0ID0gJHN0YXRlUGFyYW1zLnRhcmdldExpc3Q7XG5cbiAgICAgICAgICAgIC8vSWYgdGhlIHBhZ2UgaXMgcmVsb2FkZWQsIHRoZXNlIHN0YXRlIHBhcmFtcyBhcmUgYWxsIG51bGwsXG4gICAgICAgICAgICAvL3NvIGl0IHdpbGwgcm91dGUgdGhlbSBiYWNrIHRvIHRoZSB2aXN1YWxpemF0aW9uIHRhYiB0b3Agdmlld1xuICAgICAgICAgICAgaWYgKHNvdXJjZUxpc3QgPT0gbnVsbCB8fCB0YXJnZXRMaXN0ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZpc3VhbGl6YXRpb24ubGlzdCcpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgdmFyIHQgPSBkLmdldFNlY29uZHMoKTtcbiAgICAgICAgICAgICRzY29wZS5lZGdlRGF0YUludGVydmFsID0gXG4gICAgICAgICAgICAgICAgJGludGVydmFsKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBWaXN1YWxpemF0aW9uU2VydmljZS5nZXRFZGdlRGF0YShzb3VyY2VMaXN0LCB0YXJnZXRMaXN0LCB0LnRvU3RyaW5nKCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSByZXN1bHQucmVzdWx0cztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHJlc3VsdHMsIGZ1bmN0aW9uKHIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF8uaXNFbXB0eShyKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgKz0gci5zZXJpZXNbMF0udmFsdWVzWzBdWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNvdXJjZU5hbWUgPSBzb3VyY2VOYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS50YXJnZXROYW1lID0gdGFyZ2V0TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZWRnZURhdGEgPSBkYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5lZGdlRGF0YVRpbWUgPSB0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9LCAzMDAwKTtcblxuICAgICAgICAgICAgLy9EZXN0cm95aW5nIHRoZSBpbnRlcnZhbCBmdW5jdGlvbiBvbiByb3V0ZSBjaGFuZ2VcbiAgICAgICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkgeyAkaW50ZXJ2YWwuY2FuY2VsKCRzY29wZS5lZGdlRGF0YUludGVydmFsKTsgfSk7XG5cblxuICAgICAgICAgICAgVmlzdWFsaXphdGlvblNlcnZpY2UuZ2V0T2xkRWRnZURhdGEoc291cmNlTGlzdCwgdGFyZ2V0TGlzdClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHRzID0gcmVzdWx0LnJlc3VsdHM7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlZGdlRGF0YSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAvL3Jlc3VsdHMsIGlmIG5vdCBlbXB0eSwgYXJlIGV4cGVjdGVkIHRvIGhhdmVcbiAgICAgICAgICAgICAgICAgICAgLy82IGRhdGEgZW50cmllc1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2gocmVzdWx0cywgZnVuY3Rpb24ocikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF8uaXNFbXB0eShyKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHIuc2VyaWVzWzBdLnZhbHVlcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoXy5pc0VtcHR5KGVkZ2VEYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goZGF0YSwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRnZURhdGEucHVzaChkWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goZGF0YSwgZnVuY3Rpb24oZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRnZURhdGFbaV0gKz0gZFsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zb3VyY2VOYW1lID0gc291cmNlTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRhcmdldE5hbWUgPSB0YXJnZXROYW1lO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlTGlzdCA9IHNvdXJjZUxpc3Q7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50YXJnZXRMaXN0ID0gdGFyZ2V0TGlzdDtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm9sZEVkZ2VEYXRhID0gZWRnZURhdGE7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICB9XSk7XG5cblxuXG5cblxuXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicpXG4gICAgLmRpcmVjdGl2ZShcInZpc3VhbGl6YXRpb25FZGdlXCIsIFsnJHdpbmRvdycsXG4gICAgICAgIGZ1bmN0aW9uKCR3aW5kb3cpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIHZpc3VhbGl6YXRpb25FZGdlRDMoc2NvcGUsIGQzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJvZHlFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF07XG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IGJvZHlFbC5jbGllbnRXaWR0aCAtIDQwMCxcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gIGJvZHlFbC5jbGllbnRIZWlnaHQgLSA0MDA7XG5cblxuICAgICAgICAgICAgICAgIC8vdGFrZW4gZnJvbSBodHRwOi8vYmwub2Nrcy5vcmcvc2ltZW5icmVra2VuLzY2MzQwNzBcbiAgICAgICAgICAgICAgICAvLyAvKiogTUFJTiBTVkcgKiovXG4gICAgICAgICAgICAgICAgdmFyIGxpbWl0ID0gNTksXG4gICAgICAgICAgICAgICAgZHVyYXRpb24gPSA3NTAsXG4gICAgICAgICAgICAgICAgbm93ID0gbmV3IERhdGUoRGF0ZS5ub3coKSAtIGR1cmF0aW9uKTtcblxuICAgICAgICAgICAgICAgIHZhciBncm91cHMgPSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdvcmFuZ2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZDMucmFuZ2UobGltaXQpLm1hcChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNjb3BlLm9sZEVkZ2VEYXRhW01hdGguZmxvb3IoZC8xMCldIHx8IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgeCA9IGQzLnRpbWUuc2NhbGUoKVxuICAgICAgICAgICAgICAgICAgICAuZG9tYWluKFtub3cgLSAobGltaXQgLSAyKSwgbm93IC0gZHVyYXRpb25dKVxuICAgICAgICAgICAgICAgICAgICAucmFuZ2UoWzAsIHdpZHRoXSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgeSA9IGQzLnNjYWxlLmxpbmVhcigpXG4gICAgICAgICAgICAgICAgICAgIC5kb21haW4oWzAsIGQzLm1heChncm91cHMuY3VycmVudC5kYXRhLCBmdW5jdGlvbiAoZCkgeyByZXR1cm4gZCArIDEwOyB9KV0pXG4gICAgICAgICAgICAgICAgICAgIC5yYW5nZShbaGVpZ2h0LCAwXSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbGluZSA9IGQzLnN2Zy5saW5lKClcbiAgICAgICAgICAgICAgICAgICAgLmludGVycG9sYXRlKCdiYXNpcycpXG4gICAgICAgICAgICAgICAgICAgIC54KGZ1bmN0aW9uKGQsIGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB4KG5vdyAtIChsaW1pdCAtIDEgLSBpKSAqIGR1cmF0aW9uKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAueShmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geShkKVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHZhciB4U3ZnID0gZDMuc2VsZWN0KCcuZ3JhcGgnKS5hcHBlbmQoJ3N2ZycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd3aWR0aCcsIDI1KVxuICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ292ZXJmbG93JywgJ3Zpc2libGUnKVxuICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ3Bvc2l0aW9uJywgJ2ZpeGVkJyk7XG5cbiAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgIHZhciB5QXhpcyA9IHhTdmcuYXBwZW5kKCdnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ3kgYXhpcycpXG4gICAgICAgICAgICAgICAgICAgIC8vIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDAsJyArIHdpZHRoICsgJyknKVxuICAgICAgICAgICAgICAgICAgICAuY2FsbCh5LmF4aXMgPSBkMy5zdmcuYXhpcygpLnNjYWxlKHkpLm9yaWVudCgnbGVmdCcpKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgc3ZnPSBkMy5zZWxlY3QoJy5ncmFwaCcpLmFwcGVuZCgnc3ZnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2NoYXJ0JylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgd2lkdGggLSA1MClcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2hlaWdodCcsIGhlaWdodCArIDUwKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gLnN0eWxlKCdvdmVyZmxvdycsIFwidmlzaWJsZVwiKTtcblxuICAgICAgICAgICAgICAgIHZhciBheGlzID0gc3ZnLmFwcGVuZCgnZycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICd4IGF4aXMnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZSgwLCcgKyBoZWlnaHQgKyAnKScpXG4gICAgICAgICAgICAgICAgICAgIC5jYWxsKHguYXhpcyA9IGQzLnN2Zy5heGlzKCkuc2NhbGUoeCkub3JpZW50KCdib3R0b20nKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgcGF0aHMgPSBzdmcuYXBwZW5kKCdnJyk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBuYW1lIGluIGdyb3Vwcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ3JvdXAgPSBncm91cHNbbmFtZV07XG4gICAgICAgICAgICAgICAgICAgIGdyb3VwLnBhdGggPSBwYXRocy5hcHBlbmQoJ3BhdGgnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmRhdGEoW2dyb3VwLmRhdGFdKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgbmFtZSArICcgZ3JvdXAnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN0eWxlKCdzdHJva2UnLCBncm91cC5jb2xvcilcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiB0aWNrKCkge1xuICAgICAgICAgICAgICAgICAgICBub3cgPSBuZXcgRGF0ZSgpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCBuZXcgdmFsdWVzXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIG5hbWUgaW4gZ3JvdXBzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ3JvdXAgPSBncm91cHNbbmFtZV07XG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cC5kYXRhLnB1c2goc2NvcGUuZWRnZURhdGEgfHwgMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cC5wYXRoLmF0dHIoJ2QnLCBsaW5lKVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2hpZnQgZG9tYWluXG4gICAgICAgICAgICAgICAgICAgIHguZG9tYWluKFtub3cgLSAobGltaXQgLSAyKSAqIGR1cmF0aW9uLCBub3cgLSBkdXJhdGlvbl0pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFNsaWRlIHgtYXhpcyBsZWZ0XG4gICAgICAgICAgICAgICAgICAgIGF4aXMudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZHVyYXRpb24oZHVyYXRpb24pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZWFzZSgnbGluZWFyJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYWxsKHguYXhpcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgeUF4aXMudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZHVyYXRpb24oZHVyYXRpb24pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZWFzZSgnbGluZWFyJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYWxsKHkuYXhpcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2xpZGUgcGF0aHMgbGVmdFxuICAgICAgICAgICAgICAgICAgICBwYXRocy5hdHRyKCd0cmFuc2Zvcm0nLCBudWxsKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmR1cmF0aW9uKGR1cmF0aW9uKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVhc2UoJ2xpbmVhcicpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZSgnICsgeChub3cgLSAobGltaXQgLSAxKSAqIGR1cmF0aW9uKSArICcpJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lYWNoKCdlbmQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aWNrKClcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBvbGRlc3QgZGF0YSBwb2ludCBmcm9tIGVhY2ggZ3JvdXBcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBncm91cHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBncm91cCA9IGdyb3Vwc1tuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLmRhdGEuc2hpZnQoKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRpY2soKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm57XG4gICAgICAgICAgICAgICAgcmVzdHJpY3Q6J0VBJyxcbiAgICAgICAgICAgICAgICByZXBsYWNlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Zpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbmVkZ2V0ZW1wbGF0ZS5odG1sJyxcbiAgICAgICAgICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSl7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiR3YXRjaEdyb3VwKFsnZWRnZURhdGEnLCAnb2xkRWRnZURhdGEnXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzY29wZS5lZGdlRGF0YSAhPSBudWxsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5vbGRFZGdlRGF0YSAhPSBudWxsICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNjb3BlLmluaXRpYWxpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmluaXRpYWxpemUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQzID0gJHdpbmRvdy5kMzsgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzdWFsaXphdGlvbkVkZ2VEMyhzY29wZSwgZDMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgXVxuKTtcblxuXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nKVxuICAgIC5zZXJ2aWNlKCdTdGF0ZVNhdmUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2F2ZWRTdGF0ZXMgPSB7fTtcbiAgICB9KVxuICAgIC5kaXJlY3RpdmUoXCJ2aXN1YWxpemF0aW9uR3JhcGhcIiwgWyckd2luZG93JywgJyRzdGF0ZScsICdWaXN1YWxpemVyR3JhcGgnLCAnUG9saWN5U2VydmljZScsICdWaXN1YWxpemVyRGF0YVNvdXJjZScsICdTdGF0ZVNhdmUnLFxuICAgICAgICBmdW5jdGlvbigkd2luZG93LCAkc3RhdGUsIFZpc3VhbGl6ZXJHcmFwaCwgUG9saWN5U2VydmljZSwgVmlzdWFsaXplckRhdGFTb3VyY2UsIFN0YXRlU2F2ZSkge1xuICAgICAgICAgICAgZnVuY3Rpb24gdmlzdWFsaXphdGlvbmxpc3RkMyhzY29wZSwgZWxlbSwgVmlzdWFsaXplckdyYXBoLCBQb2xpY3lTZXJ2aWNlLCBWaXN1YWxpemVyRGF0YVNvdXJjZSwgU3RhdGVTYXZlKSB7XG4gICAgICAgICAgICAgICAgLy9kb24ndCBydW4gdW50aWwgYWxsIGluaXRpYWxpemF0aW9uIGNhbGxzIGhhdmUgcmV0dXJuZWRcbiAgICAgICAgICAgICAgICBpZiAoc2NvcGUubm9kZXMgPT09IHVuZGVmaW5lZCB8fCBzY29wZS5saW5rcyA9PT0gdW5kZWZpbmVkIHx8IHNjb3BlLmNoaWxkcmVuX3N0cnVjdCA9PT0gdW5kZWZpbmVkIHx8XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLmFuY2VzdG9yc19zdHJ1Y3QgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9jcmVhdGluZyBEYXRhU291cmNlXG4gICAgICAgICAgICAgICAgdmFyIGRhdGFTb3VyY2UgPSBuZXcgVmlzdWFsaXplckRhdGFTb3VyY2UuRGF0YVNvdXJjZShzY29wZS5ub2Rlcywgc2NvcGUubGlua3MsIHNjb3BlLmNoaWxkcmVuX3N0cnVjdCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5hbmNlc3RvcnNfc3RydWN0LCBzY29wZS5sYWJlbHMsIHNjb3BlLnNlcnZpY2VTZWxlY3RvcnMpO1xuICAgICAgICAgICAgICAgIGRhdGFTb3VyY2Uuc2V0QW5jZXN0b3JzKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMsIGxpbmtzO1xuXG4gICAgICAgICAgICAgICAgdmFyIHRvcERhdGEgPSBkYXRhU291cmNlLmdldFRvcExldmVsRmxvdygpO1xuICAgICAgICAgICAgICAgIG5vZGVzID0gZGF0YVNvdXJjZS5wcm9jZXNzTm9kZURhdGEodG9wRGF0YS5ub2RlRGF0YSk7XG4gICAgICAgICAgICAgICAgbGlua3MgPSBkYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YSh0b3BEYXRhLmxpbmtEYXRhLCBub2Rlcyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgYm9keUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gYm9keUVsLmNsaWVudFdpZHRoLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSAgYm9keUVsLmNsaWVudEhlaWdodDtcblxuICAgICAgICAgICAgICAgIC8qKiBNQUlOIFNWRyAqKi9cbiAgICAgICAgICAgICAgICB2YXIgcmF3U3ZnPWVsZW0uZmluZCgnc3ZnJyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gJChyYXdTdmcucGFyZW50KCkpLm9mZnNldCgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGRpdldpZHRoID0gJChyYXdTdmcucGFyZW50KCkpLndpZHRoKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3ZnID0gZDMuc2VsZWN0KHJhd1N2Z1swXSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCBkaXZXaWR0aClcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJoZWlnaHRcIiwgaGVpZ2h0IC0gb2Zmc2V0LnRvcCAtIDIwKTtcblxuICAgICAgICAgICAgICAgIC8vaW5zdGFsbGluZyBwb2xpY2llc1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaCA9IG5ldyBWaXN1YWxpemVyR3JhcGguR3JhcGgoc3ZnLCBub2RlcywgbGlua3MsIGRhdGFTb3VyY2UsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmNoaWxkcmVuX3N0cnVjdCwgc2NvcGUuYW5jZXN0b3JzX3N0cnVjdCk7XG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmluc3RhbGxEZWZhdWx0UGF0aFBvbGljeShuZXcgUG9saWN5U2VydmljZS5TYXZlU3RhdGVQb2xpY3koU3RhdGVTYXZlLnNhdmVkU3RhdGVzKSk7XG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmluc3RhbGxEZWZhdWx0UGF0aFBvbGljeShuZXcgUG9saWN5U2VydmljZS5QYXRoQ2hhbmdlVmlld1BvbGljeSgkc3RhdGUpKTtcbiAgICAgICAgICAgICAgICAvL1FUaXBQb2xpY3kgaXMgZm9yIGJvdGggTm9kZXMgYW5kIFBhdGhzLCBpbnN0YWxsIHNhbWUgb25lIG9uIGJvdGhcbiAgICAgICAgICAgICAgICB2YXIgcVRpcFBvbGljeSA9IG5ldyBQb2xpY3lTZXJ2aWNlLlFUaXBQb2xpY3koKTtcbiAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGguaW5zdGFsbERlZmF1bHROb2RlUG9saWN5KHFUaXBQb2xpY3kpO1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5pbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3kocVRpcFBvbGljeSk7XG4gICAgICAgICAgICAgICAgdmFyIHNwbGl0Sm9pblZpZXdQb2xpY3kgPSBuZXcgUG9saWN5U2VydmljZS5TcGxpdEpvaW5WaWV3UG9saWN5KCk7XG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmluc3RhbGxEZWZhdWx0Tm9kZVBvbGljeShzcGxpdEpvaW5WaWV3UG9saWN5KTtcbiAgICAgICAgICAgICAgICBzcGxpdEpvaW5WaWV3UG9saWN5Lmluc3RhbGxCYWNrQnV0dG9uKCQoJyNiYWNrQnV0dG9uJykpO1xuICAgICAgICAgICAgICAgIHNwbGl0Sm9pblZpZXdQb2xpY3kuaW5zdGFsbFRpdGxlKCQoJyNncmFwaC10aXRsZScpKTtcblxuICAgICAgICAgICAgICAgIC8vbG9hZCBvbGQgdmlldyBpZiBpdCBleGlzdHMuXG4gICAgICAgICAgICAgICAgaWYgKF8uaXNFbXB0eShTdGF0ZVNhdmUuc2F2ZWRTdGF0ZXMpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBncmFwaCA9IHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaDtcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGgubG9hZChTdGF0ZVNhdmUuc2F2ZWRTdGF0ZXMpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJue1xuICAgICAgICAgICAgICAgIHJlc3RyaWN0OidFQScsXG4gICAgICAgICAgICAgICAgcmVwbGFjZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb250ZW1wbGF0ZS5odG1sJyxcbiAgICAgICAgICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbSl7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS51bmJpbmQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5kZXN0cm95KCk7fSk7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiR3YXRjaEdyb3VwKFsnbm9kZXMnLCAnbGlua3MnLCAnY2hpbGRyZW5fc3RydWN0JywgJ2FuY2VzdG9yc19zdHJ1Y3QnXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzY29wZS5ub2RlcyAhPSBudWxsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmxpbmtzICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuY2hpbGRyZW5fc3RydWN0ICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuYW5jZXN0b3JzX3N0cnVjdCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzY29wZS5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5pbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc3VhbGl6YXRpb25saXN0ZDMoc2NvcGUsIGVsZW0sIFZpc3VhbGl6ZXJHcmFwaCwgUG9saWN5U2VydmljZSwgVmlzdWFsaXplckRhdGFTb3VyY2UsIFN0YXRlU2F2ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmRhdGFTb3VyY2UubGlua3MgPSBzY29wZS5saW5rcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLnVwZGF0ZUxpbmtEYXRhKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIF1cbik7XG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZpc3VhbGl6YXRpb24ubGlzdCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1Zpc3VhbGl6YXRpb25MaXN0Q3RybCBhcyB2aXN1YWxpemF0aW9uTGlzdEN0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9ubGlzdC5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdWaXN1YWxpemF0aW9uTGlzdEN0cmwnLCBbXCIkc2NvcGVcIiwgXCIkaHR0cFwiLCAnVmlzdWFsaXphdGlvblNlcnZpY2UnLCAnJGludGVydmFsJywgXG4gICAgICAgIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsIFZpc3VhbGl6YXRpb25TZXJ2aWNlLCAkaW50ZXJ2YWwpIHtcbiAgICAgICAgICAgIC8vdG8gc2VlIHRoZSBleHBlY3RlZCBmb3JtYXQgdG8gYmUgcmV0dXJuZWQgZnJvbSB0aGVzZSBjYWxscyxcbiAgICAgICAgICAgIC8vbG9vayBhdCBhcHAvY29tcG9uZW50cy9ncmFwaG9iamVjdHMvZGF0YXNvdXJjZS92aXN1YWxpemVyZGF0YXNvdXJjZS5qc1xuICAgICAgICAgICAgdmFyIHN1Y2Nlc3NHcmFwaERhdGFDYWxsYmFjayA9IGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBsaW5rcyA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBub2RlSWRzID0gW107XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHJlc3VsdC5yZXN1bHRzWzBdLnNlcmllcywgZnVuY3Rpb24oc2VyaWVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbmRwb2ludCA9IHNlcmllcy50YWdzLkVuZHBvaW50SVA7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwcm92aWRlciA9IHNlcmllcy50YWdzLlByb3ZpZGVySVA7XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlO1xuICAgICAgICAgICAgICAgICAgICAvL2NyZWF0aW5nIG5vZGVzXG4gICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKG5vZGVJZHMsIGVuZHBvaW50KSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBlbmRwb2ludCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogZW5kcG9pbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50OiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2VzdG9yczogbnVsbFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzLnB1c2gobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzLnB1c2goZW5kcG9pbnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKG5vZGVJZHMsIHByb3ZpZGVyKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBwcm92aWRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogcHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50OiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2VzdG9yczogbnVsbFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzLnB1c2gobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzLnB1c2gocHJvdmlkZXIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vY3JlYXRpbmcgbGlua3NcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxpbmtPdXQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6IGVuZHBvaW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiBwcm92aWRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIHdlaWdodDogc2VyaWVzLnZhbHVlc1swXVsyXVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBsaW5rcy5wdXNoKGxpbmtPdXQpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGlua0luID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiBwcm92aWRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogZW5kcG9pbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ6IHNlcmllcy52YWx1ZXNbMF1bMV1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgbGlua3MucHVzaChsaW5rSW4pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICRzY29wZS5ub2RlcyA9IG5vZGVzO1xuICAgICAgICAgICAgICAgICRzY29wZS5saW5rcyA9IGxpbmtzO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIC8vaW5pdGlhbCBjYWxsXG4gICAgICAgICAgICBWaXN1YWxpemF0aW9uU2VydmljZS5nZXRHcmFwaERhdGEoKS50aGVuKHN1Y2Nlc3NHcmFwaERhdGFDYWxsYmFjaywgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAvL3dpbGwgZmFpbCBzaWxlbnRseSwgZ3JhcGggd29uJ3QgYmUgZGlzcGxheWVkXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7ICRpbnRlcnZhbC5jYW5jZWwoJHNjb3BlLmdyYXBoRGF0YUludGVydmFsKTsgfSk7XG5cbiAgICAgICAgICAgIFZpc3VhbGl6YXRpb25TZXJ2aWNlLmdldFN0cnVjdHVyZURhdGEoKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAvL3RvIHNlZSB0aGUgZXhwZWN0ZWQgZm9ybSBvZiBhbmNlc3Rvcl9zdHJ1Y3QgYW5kIGNoaWxkcmVuX3N0cnVjdCwgXG4gICAgICAgICAgICAgICAgLy9sb29rIGF0IGFwcC9jb21wb25lbnRzL2dyYXBob2JqZWN0cy9kYXRhc291cmNlL3Zpc3VhbGl6ZXJkYXRhc291cmNlLmpzXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFuY2VzdG9yc19zdHJ1Y3QgPSByZXN1bHQuYW5jZXN0b3JzX3N0cnVjdDtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2hpbGRyZW5fc3RydWN0ID0gcmVzdWx0LmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICAkc2NvcGUubGFiZWxzID0gcmVzdWx0LmxhYmVscztcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VydmljZVNlbGVjdG9ycyA9IHJlc3VsdC5zZXJ2aWNlU2VsZWN0b3JzO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAvL3dpbGwgZmFpbCBzaWxlbnRseSwgZ3JhcGggd29uJ3QgYmUgZGlzcGxheWVkXG4gICAgICAgICAgICB9KTtcbiAgICB9XSk7XG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nKVxuICAgIC5mYWN0b3J5KCdWaXN1YWxpemF0aW9uU2VydmljZScsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbiAoJGh0dHAsICRxKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYWtlcyBhIGdldCByZXF1ZXN0IHdpdGggdGhlIHVybCBhbmQgY29uZmlnLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgdXJsICAgICBUaGUgdXJsXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBjb25maWcgIFRoZSBjb25maWd1cmF0aW9uc1xuICAgICAgICAgKiBAcmV0dXJuICAgICB7JEh0dHAgUHJvbWlzZX0gICBQcm9taXNlIG9mIHRoZSByZXF1ZXN0XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBtYWtlR2V0KHVybCwgY29uZmlnKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCwgY29uZmlnKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogTWFrZXMgYSBwb3N0IHJlcXVlc3Qgd2l0aCB0aGUgdXJsIGFuZCBkYXRhXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICB1cmwgICAgIFRoZSB1cmxcbiAgICAgICAgICogQHBhcmFtICAgICAge0pTT059ICAgIGRhdGEgICAgVGhlIGRhdGFcbiAgICAgICAgICogQHJldHVybiAgICAgeyRIdHRwIFByb21pc2V9ICAgUHJvbWlzZSBvZiB0aGUgcmVxdWVzdFxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gbWFrZVBvc3QodXJsLCBkYXRhKSB7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIGNvbnZlcnRzIHRoZSBkYXRhIGludG8geC13d3ctZnJvbS11cmxlbmNvZGVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0pTT059ICBvYmogICAgIEpTT04gZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtzdHJpbmd9ICB4LXd3dy1mb3JtLXVybGVuY29kZWQgc3RyaW5nXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHZhciBwYXJhbSA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgICAgICAgICAgIHZhciBxdWVyeSA9ICcnLCBuYW1lLCB2YWx1ZSwgZnVsbFN1Yk5hbWUsIHN1Yk5hbWUsIHN1YlZhbHVlLCBpbm5lck9iaiwgaTtcbiAgICAgICAgICAgICAgICBmb3IgKG5hbWUgaW4gb2JqKSB7XG4gICAgICAgICAgICAgICAgICB2YWx1ZSA9IG9ialtuYW1lXTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpPTA7IGk8dmFsdWUubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJWYWx1ZSA9IHZhbHVlW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bGxTdWJOYW1lID0gbmFtZSArICdbJyArIGkgKyAnXSc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5uZXJPYmogPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbm5lck9ialtmdWxsU3ViTmFtZV0gPSBzdWJWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeSArPSBwYXJhbShpbm5lck9iaikgKyAnJic7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBPYmplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoc3ViTmFtZSBpbiB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlZhbHVlID0gdmFsdWVbc3ViTmFtZV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVsbFN1Yk5hbWUgPSBuYW1lICsgJ1snICsgc3ViTmFtZSArICddJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbm5lck9iaiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlubmVyT2JqW2Z1bGxTdWJOYW1lXSA9IHN1YlZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ICs9IHBhcmFtKGlubmVyT2JqKSArICcmJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmKHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ICs9IGVuY29kZVVSSUNvbXBvbmVudChuYW1lKSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkgKyAnJic7XG4gICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBxdWVyeS5sZW5ndGggPyBxdWVyeS5zdWJzdHIoMCwgcXVlcnkubGVuZ3RoIC0gMSkgOiBxdWVyeTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgdXJsOnVybCxcbiAgICAgICAgICAgICAgICBtZXRob2Q6J1BPU1QnLFxuICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEsXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm1SZXF1ZXN0OiBbZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYW5ndWxhci5pc09iamVjdChkYXRhKSAmJiBTdHJpbmcoZGF0YSkgIT09ICdbb2JqZWN0IEZpbGVdJyA/IHBhcmFtKGRhdGEpIDogZGF0YTtcbiAgICAgICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldEdyYXBoRGF0YSgpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLlZJU1VBTElaQVRJT05fRU5EUE9JTlQ7XG4gICAgICAgICAgICB1cmwgKz0gJ2luZmx1eC9xdWVyeSc7XG4gICAgICAgICAgICB2YXIgY29uZmlnID0ge1xuICAgICAgICAgICAgICAgIHBhcmFtczoge1xuICAgICAgICAgICAgICAgICAgICBkYjpcInRlbGVncmFmXCIsXG4gICAgICAgICAgICAgICAgICAgIHE6XCJTRUxFQ1QgQnl0ZXNJbiwgQnl0ZXNPdXQsIEVuZHBvaW50SVAsIFByb3ZpZGVySVAgRlJPTSBodHRwanNvbl9zdmNzdGF0cyBXSEVSRSB0aW1lID4gbm93KCkgLSAxbSBHUk9VUCBCWSAqIExJTUlUIDFcIlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gbWFrZUdldCh1cmwsIGNvbmZpZyk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRTdHJ1Y3R1cmVEYXRhKCkge1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuVklTVUFMSVpBVElPTl9FTkRQT0lOVDtcbiAgICAgICAgICAgIHVybCArPSAnc2VydmljZXMnO1xuICAgICAgICAgICAgcmV0dXJuIG1ha2VHZXQodXJsKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGJ1aWxkV2hlcmVRdWVyeShwb2ludHMsIHR5cGUpIHtcbiAgICAgICAgICAgIHZhciBxdWVyeSA9IFwiKFwiO1xuICAgICAgICAgICAgcXVlcnkgKz0gdHlwZSArIFwiPVwiO1xuICAgICAgICAgICAgcXVlcnkgKz0gXCInXCIgKyBwb2ludHNbMF0gKyBcIicgXCI7XG4gICAgICAgICAgICAvL3N0YXJ0cyBhdCAxLCBzbyB3aWxsIG5vdCBydW4gaWYgbGVuZ3RoIGlzIDFcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgcG9pbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcXVlcnkgKz0gJ09SICc7XG4gICAgICAgICAgICAgICAgcXVlcnkgKz0gdHlwZSArIFwiPVwiO1xuICAgICAgICAgICAgICAgIHF1ZXJ5ICs9IFwiJ1wiICsgcG9pbnRzW2ldICsgXCInIFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcXVlcnkgKz0gXCIpXCI7XG4gICAgICAgICAgICByZXR1cm4gcXVlcnk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRFZGdlRGF0YShzb3VyY2VMaXN0LCB0YXJnZXRMaXN0LCB0aW1lKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WSVNVQUxJWkFUSU9OX0VORFBPSU5UO1xuICAgICAgICAgICAgdXJsICs9ICdpbmZsdXgvcXVlcnknO1xuXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICAgICAgZGIgOiBcInRlbGVncmFmXCIsXG4gICAgICAgICAgICAgICAgICAgIHE6IFwiU0VMRUNUIHN1bShcIiArICdCeXRlc091dCcgKyBcIikgZnJvbSBodHRwanNvbl9zdmNzdGF0cyBXSEVSRSB0aW1lID4gbm93KCkgLSAxNXMgQU5EIFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkoc291cmNlTGlzdCwgXCJFbmRwb2ludElQXCIpICtcIiBBTkQgXCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkodGFyZ2V0TGlzdCwgJ1Byb3ZpZGVySVAnKSBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIFwiR1JPVVAgQlkgdGltZSgyMHMpIExJTUlUIDE7IFNFTEVDVCBzdW0oXCIgKyAnQnl0ZXNJbicgKyBcIikgZnJvbSBodHRwanNvbl9zdmNzdGF0cyBXSEVSRSB0aW1lID4gbm93KCkgLSAxNXMgQU5EIFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkoc291cmNlTGlzdCwgJ1Byb3ZpZGVySVAnKSArXCIgQU5EIFwiIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHRhcmdldExpc3QsICdFbmRwb2ludElQJykgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBcIkdST1VQIEJZIHRpbWUoMjBzKSBmaWxsKDApIExJTUlUIDFcIlxuICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBtYWtlUG9zdCh1cmwsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgXG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0T2xkRWRnZURhdGEoc291cmNlTGlzdCwgdGFyZ2V0TGlzdCkge1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuVklTVUFMSVpBVElPTl9FTkRQT0lOVDtcbiAgICAgICAgICAgIHVybCArPSAnaW5mbHV4L3F1ZXJ5JztcbiAgICAgICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICBkYiA6IFwidGVsZWdyYWZcIixcbiAgICAgICAgICAgICAgICAgICAgcTogXCJTRUxFQ1Qgc3VtKFwiICsgJ0J5dGVzT3V0JyArIFwiKSBGUk9NIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDFtIEFORCBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHNvdXJjZUxpc3QsIFwiRW5kcG9pbnRJUFwiKSArXCIgQU5EIFwiIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHRhcmdldExpc3QsIFwiUHJvdmlkZXJJUFwiKSBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIFwiIEdST1VQIEJZIHRpbWUoMTBzKSBmaWxsKDApIExJTUlUIDY7IFNFTEVDVCBzdW0oXCIgKyAnQnl0ZXNJbicgKyBcIikgRlJPTSBodHRwanNvbl9zdmNzdGF0cyBXSEVSRSB0aW1lID4gbm93KCkgLSAxbSBBTkQgXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeShzb3VyY2VMaXN0LCBcIlByb3ZpZGVySVBcIikgK1wiIEFORCBcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeSh0YXJnZXRMaXN0LCBcIkVuZHBvaW50SVBcIikgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBcIiBHUk9VUCBCWSB0aW1lKDEwcykgZmlsbCgwKSBMSU1JVCA2XCJcbiAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gbWFrZVBvc3QodXJsLCBkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRHcmFwaERhdGE6IGdldEdyYXBoRGF0YSxcbiAgICAgICAgICAgIGdldFN0cnVjdHVyZURhdGE6IGdldFN0cnVjdHVyZURhdGEsXG4gICAgICAgICAgICBnZXRFZGdlRGF0YTogZ2V0RWRnZURhdGEsXG4gICAgICAgICAgICBnZXRPbGRFZGdlRGF0YTogZ2V0T2xkRWRnZURhdGFcbiAgICAgICAgfVxuICAgIH1dKTtcblxuXG5cblxuXG5cblxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA2LzMvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudm9sdW1lcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZvbHVtZXMuY3JlYXRlJywge1xuICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZvbHVtZXMvdm9sdW1lY3JlYXRlLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1ZvbHVtZUNyZWF0ZUN0cmwgYXMgdm9sdW1lQ3JlYXRlQ3RybCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1ZvbHVtZUNyZWF0ZUN0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnVm9sdW1lc01vZGVsJywgJ1N0b3JhZ2VQb2xpY2llc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIFZvbHVtZXNNb2RlbCwgU3RvcmFnZVBvbGljaWVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2b2x1bWVDcmVhdGVDdHJsID0gdGhpcztcbiAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5maWxlc3lzdGVtcyA9IFsnZXh0NCcsICdidHJmcyddO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1ZvbHVtZXNNb2RlbCgpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUudm9sdW1lcy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub1ZvbHVtZXNNb2RlbCgpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZXQgc3RvcmFnZSBwb2xpY2llcy5cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGdldFN0b3JhZ2VQb2xpY2llcygpIHtcbiAgICAgICAgICAgIFN0b3JhZ2VQb2xpY2llc01vZGVsLmdldCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwucG9saWNpZXMgPSByZXN1bHQ7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBhcHBseVBvbGljeVNldHRpbmdzKCkge1xuICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUucG9saWN5ID0gdm9sdW1lQ3JlYXRlQ3RybC5zZWxlY3RlZFBvbGljeS5uYW1lO1xuICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUuYmFja2VuZHMgPSB2b2x1bWVDcmVhdGVDdHJsLnNlbGVjdGVkUG9saWN5LmJhY2tlbmRzO1xuICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUuZHJpdmVyID0gdm9sdW1lQ3JlYXRlQ3RybC5zZWxlY3RlZFBvbGljeS5kcml2ZXI7XG4gICAgICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLm5ld1ZvbHVtZS5jcmVhdGUgPSB2b2x1bWVDcmVhdGVDdHJsLnNlbGVjdGVkUG9saWN5LmNyZWF0ZTtcbiAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwubmV3Vm9sdW1lLnJ1bnRpbWUgPSB2b2x1bWVDcmVhdGVDdHJsLnNlbGVjdGVkUG9saWN5LnJ1bnRpbWU7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlVm9sdW1lKCkge1xuICAgICAgICAgICAgLy9mb3JtIGNvbnRyb2xsZXIgaXMgaW5qZWN0ZWQgYnkgdGhlIGh0bWwgdGVtcGxhdGVcbiAgICAgICAgICAgIC8vY2hlY2tpbmcgaWYgYWxsIHZhbGlkYXRpb25zIGhhdmUgcGFzc2VkXG4gICAgICAgICAgICBpZiAodm9sdW1lQ3JlYXRlQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcih2b2x1bWVDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcih2b2x1bWVDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBhcHBseVBvbGljeVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgVm9sdW1lc01vZGVsLmNyZWF0ZSh2b2x1bWVDcmVhdGVDdHJsLm5ld1ZvbHVtZSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvVm9sdW1lc01vZGVsKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHZvbHVtZUNyZWF0ZUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmVzZXRGb3JtKCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcih2b2x1bWVDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwubmV3Vm9sdW1lID0ge1xuICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgIFwiYmFja2VuZHNcIjoge30sXG4gICAgICAgICAgICAgICAgXCJkcml2ZXJcIjoge30sXG4gICAgICAgICAgICAgICAgXCJjcmVhdGVcIjoge30sXG4gICAgICAgICAgICAgICAgXCJydW50aW1lXCI6IHt9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwuY3JlYXRlVm9sdW1lID0gY3JlYXRlVm9sdW1lO1xuICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLmNhbmNlbENyZWF0aW5nID0gY2FuY2VsQ3JlYXRpbmc7XG4gICAgICAgIGdldFN0b3JhZ2VQb2xpY2llcygpO1xuICAgICAgICByZXNldEZvcm0oKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD12b2x1bWVjcmVhdGVjdHJsLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA0LzE1LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZvbHVtZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52b2x1bWVzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWb2x1bWVEZXRhaWxzQ3RybCBhcyB2b2x1bWVEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZvbHVtZXMvdm9sdW1lZGV0YWlscy5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignVm9sdW1lRGV0YWlsc0N0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckaHR0cCcsICdWb2x1bWVzTW9kZWwnLCAnVm9sdW1lU2VydmljZScsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCAkc2NvcGUsICRpbnRlcnZhbCwgJGh0dHAsIFZvbHVtZXNNb2RlbCwgVm9sdW1lU2VydmljZSwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHZvbHVtZURldGFpbHNDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Wb2x1bWVzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS52b2x1bWVzLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBkZWxldGVWb2x1bWUoKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iodm9sdW1lRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIodm9sdW1lRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgVm9sdW1lc01vZGVsLmRlbGV0ZSh2b2x1bWVEZXRhaWxzQ3RybC52b2x1bWUpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIHJldHVyblRvVm9sdW1lcygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0Vm9sdW1lSW5mbyhyZWxvYWQpIHtcbiAgICAgICAgICAgIHZhciB0b2tlbnMgPSAkc3RhdGVQYXJhbXMua2V5LnNwbGl0KCcvJyk7XG4gICAgICAgICAgICB2YXIgbW9kZWwgPSB7fTtcbiAgICAgICAgICAgIG1vZGVsLnBvbGljeSA9IHRva2Vuc1swXTtcbiAgICAgICAgICAgIG1vZGVsLm5hbWUgPSB0b2tlbnNbMV07XG4gICAgICAgICAgICBWb2x1bWVzTW9kZWwuZ2V0TW9kZWwobW9kZWwsIHJlbG9hZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAodm9sdW1lKSB7XG4gICAgICAgICAgICAgICAgdm9sdW1lRGV0YWlsc0N0cmwudm9sdW1lID0gdm9sdW1lO1xuICAgICAgICAgICAgICAgIGdldFZvbHVtZVVzZUluZm8oKTtcbiAgICAgICAgICAgICAgICBnZXRWb2x1bWVTbmFwc2hvdHMoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdldFZvbHVtZVVzZUluZm8oKSB7XG4gICAgICAgICAgICBWb2x1bWVTZXJ2aWNlLmdldFZvbHVtZVVzZUluZm8odm9sdW1lRGV0YWlsc0N0cmwudm9sdW1lKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB2b2x1bWVEZXRhaWxzQ3RybC52b2x1bWVVc2UgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vUmV0dXJucyBlcnJvciBpZiB2b2x1bWUgaXMgbm90IG1vdW50ZWQgYnkgYW55IGNvbnRhaW5lclxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0Vm9sdW1lU25hcHNob3RzKCkge1xuICAgICAgICAgICAgVm9sdW1lU2VydmljZS5nZXRWb2x1bWVTbmFwc2hvdHModm9sdW1lRGV0YWlsc0N0cmwudm9sdW1lKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB2b2x1bWVEZXRhaWxzQ3RybC5zbmFwc2hvdHMgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gdHJpZ2dlclZvbHVtZVNuYXBzaG90KCkge1xuICAgICAgICAgICAgdm9sdW1lRGV0YWlsc0N0cmwuc25hcHNob3RTdWNjZXNzID0gZmFsc2U7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iodm9sdW1lRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIodm9sdW1lRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgVm9sdW1lU2VydmljZS50cmlnZ2VyU25hcHNob3Qodm9sdW1lRGV0YWlsc0N0cmwudm9sdW1lKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICB2b2x1bWVEZXRhaWxzQ3RybC5zbmFwc2hvdFN1Y2Nlc3MgPSB0cnVlO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Iodm9sdW1lRGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB2b2x1bWVEZXRhaWxzQ3RybC5kZWxldGVWb2x1bWUgPSBkZWxldGVWb2x1bWU7XG4gICAgICAgIHZvbHVtZURldGFpbHNDdHJsLnRyaWdnZXJWb2x1bWVTbmFwc2hvdCA9IHRyaWdnZXJWb2x1bWVTbmFwc2hvdDtcbiAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgIGdldFZvbHVtZUluZm8oZmFsc2UpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0Vm9sdW1lSW5mbyh0cnVlKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXZvbHVtZWRldGFpbHNjdHJsLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzIyLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZvbHVtZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52b2x1bWVzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVm9sdW1lTGlzdEN0cmwgYXMgdm9sdW1lTGlzdEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2b2x1bWVzL3ZvbHVtZWxpc3QuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1ZvbHVtZUxpc3RDdHJsJywgWyckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnVm9sdW1lc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIFZvbHVtZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHZvbHVtZUxpc3RDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gZ2V0Vm9sdW1lcyhyZWxvYWQpIHtcbiAgICAgICAgICAgIFZvbHVtZXNNb2RlbC5nZXQocmVsb2FkKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZUxpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICB2b2x1bWVMaXN0Q3RybC52b2x1bWVzID0gcmVzdWx0O1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZUxpc3RDdHJsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vTG9hZCBmcm9tIGNhY2hlIGZvciBxdWljayBkaXNwbGF5IGluaXRpYWxseVxuICAgICAgICBnZXRWb2x1bWVzKGZhbHNlKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldFZvbHVtZXModHJ1ZSk7XG4gICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD12b2x1bWVsaXN0Y3RybC5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNi81LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZvbHVtZXMnKVxuICAgIC5mYWN0b3J5KCdWb2x1bWVTZXJ2aWNlJywgWyckaHR0cCcsICckcScsIGZ1bmN0aW9uICgkaHR0cCwgJHEpIHtcbiAgICAgICAgZnVuY3Rpb24gZ2V0Vm9sdW1lVXNlSW5mbyh2b2x1bWUpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WT0xVTUVTX1VTRVNfRU5EUE9JTlRcbiAgICAgICAgICAgICAgICArIHZvbHVtZS5wb2xpY3lcbiAgICAgICAgICAgICAgICArICcvJyArIHZvbHVtZS5uYW1lO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vUmV0dXJucyBlcnJvciBpZiB2b2x1bWUgaXMgbm90IG1vdW50ZWQgYnkgYW55IGNvbnRhaW5lclxuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdldFZvbHVtZVNuYXBzaG90cyh2b2x1bWUpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WT0xVTUVTX1NOQVBTSE9UU19FTkRQT0lOVFxuICAgICAgICAgICAgICAgICsgdm9sdW1lLnBvbGljeVxuICAgICAgICAgICAgICAgICsgJy8nICsgdm9sdW1lLm5hbWU7XG4gICAgICAgICAgICAkaHR0cC5nZXQodXJsKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gdHJpZ2dlclNuYXBzaG90KHZvbHVtZSkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLlZPTFVNRVNfU05BUFNIT1RTX0VORFBPSU5UICsgXCJ0YWtlL1wiXG4gICAgICAgICAgICAgICAgKyB2b2x1bWUucG9saWN5XG4gICAgICAgICAgICAgICAgKyAnLycgKyB2b2x1bWUubmFtZTtcbiAgICAgICAgICAgICRodHRwLnBvc3QodXJsKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldFZvbHVtZVVzZUluZm86IGdldFZvbHVtZVVzZUluZm8sXG4gICAgICAgICAgICBnZXRWb2x1bWVTbmFwc2hvdHM6IGdldFZvbHVtZVNuYXBzaG90cyxcbiAgICAgICAgICAgIHRyaWdnZXJTbmFwc2hvdDogdHJpZ2dlclNuYXBzaG90XG4gICAgICAgIH07XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dm9sdW1lc2VydmljZS5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSBjc2hhbXB1ciBvbiA4LzkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudm9sdW1lcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZvbHVtZXMuY29weScsIHtcbiAgICAgICAgICAgIHVybDogJy9jb3B5LycsXG4gICAgICAgICAgICBwYXJhbXM6IHsgc25hcHNob3Q6IG51bGwsIHBvbGljeTogbnVsbCwgdm9sdW1lOiBudWxsIH0sXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVm9sdW1lU25hcHNob3RDb3B5Q3RybCBhcyB2b2x1bWVTbmFwc2hvdENvcHlDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndm9sdW1lcy92b2x1bWVzbmFwc2hvdGNvcHkuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1ZvbHVtZVNuYXBzaG90Q29weUN0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckaHR0cCcsICdWb2x1bWVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgJHNjb3BlLCAkaW50ZXJ2YWwsICRodHRwLCBWb2x1bWVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2b2x1bWVTbmFwc2hvdENvcHlDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ29weSgpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUudm9sdW1lcy5kZXRhaWxzJywgeyBrZXk6ICRzdGF0ZVBhcmFtcy5wb2xpY3kgKyAnLycgKyAkc3RhdGVQYXJhbXMudm9sdW1lIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdvVG9OZXdWb2x1bWUoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZvbHVtZXMuZGV0YWlscycsIHsga2V5OiAkc3RhdGVQYXJhbXMucG9saWN5ICsgJy8nICsgdm9sdW1lU25hcHNob3RDb3B5Q3RybC5uZXd2b2x1bWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY29weVNuYXBzaG90KCkge1xuICAgICAgICAgICAgaWYgKHZvbHVtZVNuYXBzaG90Q29weUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iodm9sdW1lU25hcHNob3RDb3B5Q3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIodm9sdW1lU25hcHNob3RDb3B5Q3RybCk7XG4gICAgICAgICAgICAgICAgdmFyIG1vZGVsID0ge307XG4gICAgICAgICAgICAgICAgbW9kZWwucG9saWN5ID0gJHN0YXRlUGFyYW1zLnBvbGljeTtcbiAgICAgICAgICAgICAgICBtb2RlbC5uYW1lID0gJHN0YXRlUGFyYW1zLnZvbHVtZTtcbiAgICAgICAgICAgICAgICBWb2x1bWVzTW9kZWwuY29weShtb2RlbCwgJHN0YXRlUGFyYW1zLnNuYXBzaG90LCB2b2x1bWVTbmFwc2hvdENvcHlDdHJsLm5ld3ZvbHVtZSlcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZVNuYXBzaG90Q29weUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBnb1RvTmV3Vm9sdW1lKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVTbmFwc2hvdENvcHlDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHZvbHVtZVNuYXBzaG90Q29weUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdm9sdW1lU25hcHNob3RDb3B5Q3RybC5wb2xpY3kgPSAkc3RhdGVQYXJhbXMucG9saWN5O1xuICAgICAgICB2b2x1bWVTbmFwc2hvdENvcHlDdHJsLnZvbHVtZSA9ICRzdGF0ZVBhcmFtcy52b2x1bWU7XG4gICAgICAgIHZvbHVtZVNuYXBzaG90Q29weUN0cmwuc25hcHNob3QgPSAkc3RhdGVQYXJhbXMuc25hcHNob3Q7XG4gICAgICAgIHZvbHVtZVNuYXBzaG90Q29weUN0cmwuY29weVNuYXBzaG90ID0gY29weVNuYXBzaG90O1xuICAgICAgICB2b2x1bWVTbmFwc2hvdENvcHlDdHJsLmNhbmNlbENvcHkgPSBjYW5jZWxDb3B5O1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXZvbHVtZXNuYXBzaG90Y29weWN0cmwuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgY3NoYW1wdXIgb24gNy8xLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5kaXJlY3RpdmVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dkFjY29yZGlvblwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIGl0ZW1zOiAnPScsXG4gICAgICAgIH0sXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBlbGVtZW50LmZpbmQoJy51aS5hY2NvcmRpb24nKS5hY2NvcmRpb24gPT0gJ2Z1bmN0aW9uJylcbiAgICAgICAgICAgICAgICBlbGVtZW50LmZpbmQoJy51aS5hY2NvcmRpb24nKS5hY2NvcmRpb24oKTtcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvYWNjb3JkaW9uLmh0bWwnXG4gICAgfTtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YWNjb3JkaW9uZGlyZWN0aXZlLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA2LzIvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2Q29sbGFwc2libGVcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICB0aXRsZTogJ0AnLFxuICAgICAgICAgICAgY29sbGFwc2VkOiAnQCdcbiAgICAgICAgfSxcbiAgICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlKSB7XG4gICAgICAgICAgICBpZiAoc2NvcGUuY29sbGFwc2VkID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgc2NvcGUuY29sbGFwc2VkID0gdHJ1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvY29sbGFwc2libGUuaHRtbCdcbiAgICB9O1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb2xsYXBzaWJsZWRpcmVjdGl2ZS5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xMS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZOYW1ldmFsdWVcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBpdGVtczogJz0nLFxuICAgICAgICAgICAgbmFtZWhlYWRlcjogJ0AnLFxuICAgICAgICAgICAgdmFsdWVoZWFkZXI6ICdAJyxcbiAgICAgICAgICAgIHR5cGU6ICdAJyxcbiAgICAgICAgICAgIG9wdGlvbnM6ICc9JyAvL1RvIGJlIHVzZWQgd2hlbiB0eXBlIGlzICdzZWxlY3QnXG4gICAgICAgIH0sXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSkge1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDb21wYXJlIGlmIHR3byBpdGVtcyBoYXZlIHNhbWUgbmFtZVxuICAgICAgICAgICAgICogQHBhcmFtIHZhbDFcbiAgICAgICAgICAgICAqIEBwYXJhbSB2YWwyXG4gICAgICAgICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gY29tcGFyZSh2YWwxLCB2YWwyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbDEubmFtZSA9PSB2YWwyLm5hbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmdW5jdGlvbiByZXNldE5ld0l0ZW0oKSB7XG4gICAgICAgICAgICAgICAgc2NvcGUubmV3SXRlbSA9IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJycsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiAnJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmdW5jdGlvbiBpc0VtcHR5SXRlbShpdGVtKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChpdGVtLm5hbWUgPT09ICcnICYmIGl0ZW0udmFsdWUgPT09ICcnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNjb3BlLmFkZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoaXNFbXB0eUl0ZW0oc2NvcGUubmV3SXRlbSkpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICBpZiAoc2NvcGUuaXRlbSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLml0ZW0gPSBbXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9SZW1vdmVzIGV4aXN0aW5nIGl0ZW0gd2l0aCB0aGUgc2FtZSBuYW1lIGZpcnN0IGlmIGl0IGV4aXN0cy5cbiAgICAgICAgICAgICAgICBfLnB1bGxBbGxXaXRoKHNjb3BlLml0ZW1zLCBbc2NvcGUubmV3SXRlbV0sIGNvbXBhcmUpO1xuICAgICAgICAgICAgICAgIHNjb3BlLml0ZW1zLnB1c2goc2NvcGUubmV3SXRlbSk7XG4gICAgICAgICAgICAgICAgcmVzZXROZXdJdGVtKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgc2NvcGUucmVtb3ZlID0gZnVuY3Rpb24gKHBhc3NlZEl0ZW0pIHtcbiAgICAgICAgICAgICAgICBfLnJlbW92ZShzY29wZS5pdGVtcywgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0ubmFtZSA9PSBwYXNzZWRJdGVtLm5hbWU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmVzZXROZXdJdGVtKCk7XG4gICAgICAgICAgICBpZiAoc2NvcGUubmFtZWhlYWRlciA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgIHNjb3BlLm5hbWVoZWFkZXIgPSAnTmFtZSc7XG4gICAgICAgICAgICBpZiAoc2NvcGUudmFsdWVoZWFkZXIgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICBzY29wZS52YWx1ZWhlYWRlciA9ICdWYWx1ZSc7XG4gICAgICAgICAgICBpZiAoc2NvcGUudHlwZSA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgIHNjb3BlLnR5cGUgPSAndGV4dCc7XG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9kaXJlY3RpdmVzL25hbWV2YWx1ZS5odG1sJ1xuICAgIH07XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5hbWV2YWx1ZWRpcmVjdGl2ZS5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS80LzE2LlxuICovXG4vKlxuRGlyZWN0aXZlIFVzYWdlIDpcblxuYSkgY3R2VGFibGUgLVxuICAgdXNhZ2UgOiA8Y3R2LXRhYmxlIGRlZmF1bHRzb3J0Y29sdW1uPSduYW1lJyBpdGVtcz0ndGFibGVJdGVtcycgZmlsdGVyZWRpdGVtcz0nZmlsdEl0ZW1zJyBzaXplPSdzaXplJz48L2N0di10YWJsZT5cbiAgIGF0dHJpYnV0ZSBkZXRhaWxzIDogIGRlZmF1bHRzb3J0Y29sdW1uIC0gVGhlIGRlZmF1bHQgY29sdW1uIG5hbWUoY29ycmVzcG9uZGluZyBrZXkgaW5zaWRlIHRoZSBvYmplY3Qgb2YgaXRlbXMgYXJyYXkpIG9uIHdoaWNoIHRoZSB0YWJsZSB3aWxsIGJlIHNvcnRlZCB3aGVuIGl0IGlzIGxvYWRlZC5cbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zIC0gQW4gYXJyYXkgb2Ygb2JqZWN0cyB3aGljaCB3aWxsIGJlIGRpc3BsYXllZCBieSB0aGUgY3R2LXRhYmxlIGRpcmVjdGl2ZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIHNpemUgLSBudW1iZXIgb2Ygcm93cyB0byBiZSBkaXNwbGF5ZWQgaW5zaWRlIHRoZSB0YWJsZS4gSWYgaXRlbXMubGVuZ3RoID4gc2l6ZSB0aGVuIHJlbWFpbmluZyBpdGVtc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbGwgYmUgZGlzcGxheWVkIGluIG5leHQgcGFnZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcmVkaXRlbXMgLSBUaGlzIGlzIGFuIG91dHB1dCBmaWVsZCB3aGljaCBwcm9kdWNlcyBhIGZpbHRlcmVkIHN1YnNldCBvZiBpdGVtcyBzcGVjZWZpZWQgYnlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGUgcHJldmlvdXMgYXR0cmlidXRlLCBJdGVtcyBhcmUgZmlsdGVyZWQgYmFzZWQgb24gc2VhcmNoIHRleHQgZGVmaW5lZCBpbnNpZGUgY3R2LXNlYXJjaCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmQgYnkgdGhlIHNpemUgbWVudGlvbmVkIGluIHRoZSBjdHYtdGFibGUgYXR0cmlidXRlXG5iKSBjdHZUSCAtXG4gICB1c2FnZSA6IDxjdHYtdGggc29ydGZpZWxkPSduYW1lJz5uYW1lPC9jdHYtdGg+XG4gICBhdHRyaWJ1dGUgZGV0YWlscyA6IHNvcnRmaWVsZCAtIFRoaXMgaXMgdGhlIGtleSBvZiB0aGUgb2JqZWN0IHByZXNlbnQgaW5zaWRlIGl0ZW1zIGFycmF5IHNwZWNlZmllZCBpbiBjdHZUYWJsZSwgZm9yIGVnIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdGhlIGFycmF5IG9iamVjdCBpcyA6IFt7aXA6IFwiMjAuMS4yLjNcIiwgaG9zdDogXCJjbHVzdGVyLTFcIn0se2lwOiBcIjIwLjEuMi40XCIsIGhvc3Q6IFwiY2x1c3Rlci0yXCJ9XVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGVuIGRpcmVjdGl2ZSB3aWxsIGJlIDxjdHYtdGggc29ydGZpZWxkPVwiJ2lwJ1wiPiBJcCBBZGRyZXNzIDwvY3R2LXRoPlxuICAgVGFibGUgY2FuIG9ubHkgYmUgc29ydGVkIG9uIGNvbHVtbnMgd2hpY2ggaGFzIHNvcnRmaWVsZCBhdHRyaWJ1dGUgc3BlY2VmaWVkLlxuXG5jKSBjdHZUc2VhcmNoIC1cbiAgIHVzYWdlIDogPGN0di10c2VhcmNoIHBsYWNlaG9sZGVyPSdTZWFyY2gnIHNpemU9JzMwJz48L2N0di10c2VhcmNoPlxuICAgYXR0cmlidXRlIGRldGFpbHMgOiBwbGFjZWhvbGRlciAtIHNwZWNpZnkgdGhlIHBsYWNlaG9sZGVyIGZvciB0aGUgaW5wdXQgdGV4dCBmaWVsZFxuICAgICAgICAgICAgICAgICAgICAgICBzaXplIC0gc3BlY2lmeSB0aGUgbWF4aW11bSBsZW5ndGggb2YgdGhlIHNlYXJjaCBzdHJpbmdcbiAgIE9ubHkgaXRlbXMgbWF0Y2hpbmcgdGhlIHNlYXJjaCBzdHJpbmcgYXJlIGRpc3BsYXllZCBpbnNpZGUgdGhlIHRhYmxlLlxuXG5kKSBjdHZUcGFnaW5hdGlvbiAtXG4gICB1c2FnZSA6IDxjdHYtdHBhZ2luYXRpb24+PC9jdHYtdHBhZ2luYXRpb24+XG4gICBQcm92aWRlcyBsaW5rIGZvciBtb3ZpbmcgYmFjayBhbmQgZm9ydGggb2YgdGhlIHJlc3VsdCBwYWdlLlxuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2VGFibGVcIiwgWydmaWx0ZXJGaWx0ZXInLCAnbGltaXRUb0ZpbHRlcicsIGZ1bmN0aW9uIChmaWx0ZXJGaWx0ZXIsIGxpbWl0VG9GaWx0ZXIpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBpdGVtczogJz0nLFxuICAgICAgICAgICAgICAgIGZpbHRlcmVkaXRlbXM6ICc9JyxcbiAgICAgICAgICAgICAgICBzaXplOiAnQCcsXG4gICAgICAgICAgICAgICAgZGVmYXVsdHNvcnRjb2x1bW46ICdAJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgJyRlbGVtZW50JywgJyRhdHRycycsICckZmlsdGVyJywgZnVuY3Rpb24gKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgJGZpbHRlcikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGFibGVDdHJsID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLmNodW5rcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwucGFnZU5vID0gMDtcbiAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNvcnRPYmogPSBpbml0aWFsaXplU29ydCgkc2NvcGUuZGVmYXVsdHNvcnRjb2x1bW4pO1xuICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc2l6ZSA9IHBhcnNlSW50KCRzY29wZS5zaXplLCAxMCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc05hTih0YWJsZUN0cmwuc2l6ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zaXplID0gMTI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAqIEFsd2F5cyBjYWxsIHNob3dDaHVuayB3aXRoIGJvdGggcGFyYW1ldGVycy5cbiAgICAgICAgICAgICAgICAgICAgICogQHBhcmFtIHBhZ2VOb1xuICAgICAgICAgICAgICAgICAgICAgKiBAcGFyYW0gc2VhcmNoVGV4dFxuICAgICAgICAgICAgICAgICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNob3dDaHVuayhwYWdlTm8sIHNlYXJjaFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zZWFyY2hUZXh0ID0gc2VhcmNoVGV4dDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYWdlTm8gPT09IHVuZGVmaW5lZCB8fCBwYWdlTm8gPCAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VObyA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwucGFnZU5vID0gcGFnZU5vO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5pdGVtcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlYXJjaFRleHRGaWx0ZXJlZEl0ZW1zID0gZmlsdGVyRmlsdGVyKCRzY29wZS5pdGVtcywgdGFibGVDdHJsLnNlYXJjaFRleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlYXJjaFRleHRGaWx0ZXJlZEl0ZW1zID0gJGZpbHRlcignb3JkZXJCeScpKHNlYXJjaFRleHRGaWx0ZXJlZEl0ZW1zLCB0YWJsZUN0cmwuc29ydE9iai5maWVsZCwgdGFibGVDdHJsLnNvcnRPYmoucmV2ZXJzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5vT2ZDaHVua3MgPSBNYXRoLmNlaWwoc2VhcmNoVGV4dEZpbHRlcmVkSXRlbXMubGVuZ3RoIC8gdGFibGVDdHJsLnNpemUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub09mQ2h1bmtzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9PZkNodW5rcyA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5jaHVua3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vT2ZDaHVua3M7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuY2h1bmtzLnB1c2goeyBzZWxlY3RlZDogZmFsc2UsIHBhZ2VObzogaSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9BZnRlciBmaWx0ZXJpbmcgbnVtYmVyIG9mIGNodW5rcyBjb3VsZCBjaGFuZ2Ugc28gcmVzZXQgcGFnZSBubyBpZiBpdCBpcyBncmVhdGVyIHRoYW4gbm8gb2YgY2h1bmtzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhZ2VObyA+PSB0YWJsZUN0cmwuY2h1bmtzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwucGFnZU5vID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLmNodW5rc1t0YWJsZUN0cmwucGFnZU5vXS5zZWxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9VcGRhdGUgbnVtYmVyIG9mIGNodW5rcyBmb3IgcGFnaW5hdGlvbiBtZW51XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhYmxlQ3RybC5jaHVua3MubGVuZ3RoID4gNSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2xpY2VTdGFydCwgc2xpY2VFbmQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsaWNlU3RhcnQgPSB0YWJsZUN0cmwucGFnZU5vIC0gMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xpY2VFbmQgPSB0YWJsZUN0cmwucGFnZU5vICsgMztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNsaWNlU3RhcnQgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbGljZUVuZCA9IHNsaWNlRW5kIC0gc2xpY2VTdGFydDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsaWNlU3RhcnQgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzbGljZUVuZCA+IHRhYmxlQ3RybC5jaHVua3MubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbGljZVN0YXJ0ID0gc2xpY2VTdGFydCAtIChzbGljZUVuZCAtIHRhYmxlQ3RybC5jaHVua3MubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsaWNlRW5kID0gdGFibGVDdHJsLmNodW5rcy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2luYXRpb25NZW51LmNodW5rcyA9IHRhYmxlQ3RybC5jaHVua3Muc2xpY2Uoc2xpY2VTdGFydCwgc2xpY2VFbmQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2luYXRpb25NZW51LmNodW5rcyA9IHRhYmxlQ3RybC5jaHVua3M7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5maWx0ZXJlZEl0ZW1zID0gbGltaXRUb0ZpbHRlcihzZWFyY2hUZXh0RmlsdGVyZWRJdGVtcywgdGFibGVDdHJsLnNpemUsIHRhYmxlQ3RybC5wYWdlTm8gKiB0YWJsZUN0cmwuc2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmZpbHRlcmVkaXRlbXMgPSB0YWJsZUN0cmwuZmlsdGVyZWRJdGVtcztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBzaG93UHJldkNodW5rKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByZXZDaHVuaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YWJsZUN0cmwucGFnZU5vIDw9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2Q2h1bmsgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldkNodW5rID0gdGFibGVDdHJsLnBhZ2VObyAtIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2hvd0NodW5rKHByZXZDaHVuayk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gc2hvd05leHRDaHVuaygpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXh0Q2h1bms7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0Q2h1bmsgPSB0YWJsZUN0cmwucGFnZU5vICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXh0Q2h1bmsgPiB0YWJsZUN0cmwuY2h1bmtzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0Q2h1bmsgPSB0YWJsZUN0cmwuY2h1bmtzLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2hvd0NodW5rKG5leHRDaHVuayk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAqIFNhdmUgcGFnaW5hdGlvbiBzY29wZSB0byBwcm92aWRlIGNodW5rIGluZm9ybWF0aW9uIHRvIHBhZ2luYXRpb24gbWVudS5cbiAgICAgICAgICAgICAgICAgICAgICogQHBhcmFtIG1lbnVcbiAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFkZFBhZ2luYXRpb25NZW51KG1lbnUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5wYWdpbmF0aW9uTWVudSA9IG1lbnU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gaW5pdGlhbGl6ZVNvcnQoc29ydGZpZWxkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkOiBzb3J0ZmllbGQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV2ZXJzZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbkRpcmVjdGlvbjogeyBcImFuZ2xlIGRvd24gaWNvblwiOiB0cnVlLCBcImFuZ2xlIHVwIGljb25cIjogZmFsc2UgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBzb3J0KHNvcnRmaWVsZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNvcnRmaWVsZCA9PSB0YWJsZUN0cmwuc29ydE9iai5maWVsZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zb3J0T2JqLmZpZWxkID0gc29ydGZpZWxkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zb3J0T2JqLnJldmVyc2UgPSAhdGFibGVDdHJsLnNvcnRPYmoucmV2ZXJzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc29ydE9iai5pY29uRGlyZWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFuZ2xlIGRvd24gaWNvblwiOiAhdGFibGVDdHJsLnNvcnRPYmoucmV2ZXJzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhbmdsZSB1cCBpY29uXCI6IHRhYmxlQ3RybC5zb3J0T2JqLnJldmVyc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNvcnRPYmogPSBpbml0aWFsaXplU29ydChzb3J0ZmllbGQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNob3dDaHVuayh0YWJsZUN0cmwucGFnZU5vLCB0YWJsZUN0cmwuc2VhcmNoVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNob3dDaHVuayA9IHNob3dDaHVuaztcbiAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNob3dOZXh0Q2h1bmsgPSBzaG93TmV4dENodW5rO1xuICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc2hvd1ByZXZDaHVuayA9IHNob3dQcmV2Q2h1bms7XG4gICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5hZGRQYWdpbmF0aW9uTWVudSA9IGFkZFBhZ2luYXRpb25NZW51O1xuICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc29ydCA9IHNvcnQ7XG4gICAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCB0YWJsZUN0cmwpIHtcbiAgICAgICAgICAgICAgICAvL1dhdGNoIGZvciBpdGVtcyBhcyB0aGV5IHdpbGwgYmUgYXV0byByZWZyZXNoZWRcbiAgICAgICAgICAgICAgICBzY29wZS4kcGFyZW50LiR3YXRjaChhdHRycy5pdGVtcywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc2hvd0NodW5rKHRhYmxlQ3RybC5wYWdlTm8sIHRhYmxlQ3RybC5zZWFyY2hUZXh0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy90YWJsZS5odG1sJ1xuICAgICAgICB9O1xuICAgIH1dKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZUaGVhZFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgdGVtcGxhdGU6ICc8dGhlYWQgbmctdHJhbnNjbHVkZT48L3RoZWFkPidcbiAgICB9O1xufSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2VGhcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXG4gICAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICAgIHJlcXVpcmU6ICdeXmN0dlRhYmxlJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIGNsYXNzOiAnQCcsXG4gICAgICAgICAgICBzb3J0ZmllbGQ6ICc9J1xuICAgICAgICB9LFxuICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCB0YWJsZUN0cmwpIHtcbiAgICAgICAgICAgIHNjb3BlLnRhYmxlY3RybCA9IHRhYmxlQ3RybDtcbiAgICAgICAgICAgIGlmIChzY29wZS5zb3J0ZmllbGQgIT0gdW5kZWZpbmVkICYmIHNjb3BlLnNvcnRmaWVsZCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5iaW5kKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNvcnQoc2NvcGUuc29ydGZpZWxkKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvdGFibGVoZWFkZXIuaHRtbCdcbiAgICB9O1xufSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2VGJvZHlcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7fSxcbiAgICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgdGVtcGxhdGU6ICc8dGJvZHkgbmctdHJhbnNjbHVkZT48L3Rib2R5PidcbiAgICB9O1xufSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2VGZvb3RcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7fSxcbiAgICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgdGVtcGxhdGU6ICc8dGZvb3QgbmctdHJhbnNjbHVkZT48L3Rmb290PidcbiAgICB9O1xufSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2VHNlYXJjaFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgcmVxdWlyZTogJ15eY3R2VGFibGUnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgcGxhY2Vob2xkZXI6ICdAJyxcbiAgICAgICAgICAgIHNpemU6ICdAJ1xuICAgICAgICB9LFxuICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIHRhYmxlQ3RybCkge1xuICAgICAgICAgICAgc2NvcGUuc2hvd0NodW5rID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zaG93Q2h1bmsodGFibGVDdHJsLnBhZ2VObywgc2NvcGUuc2VhcmNoVGV4dCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy9zZWFyY2hpbnB1dC5odG1sJ1xuICAgIH07XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZUclwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgdHJhbnNjbHVkZTogJ3RydWUnLFxuICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICBzY29wZToge30sXG4gICAgICAgIHRlbXBsYXRlOiAnPHRyIG5nLXRyYW5zY2x1ZGU+PC90cj4nXG4gICAgfTtcbn0pXG4gICAgLmRpcmVjdGl2ZShcImN0dlRkXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICBzY29wZTogdHJ1ZSxcbiAgICAgICAgdGVtcGxhdGU6ICc8dGQgbmctdHJhbnNjbHVkZT48L3RkPidcbiAgICB9O1xufSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2VHBhZ2luYXRpb25cIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHJlcXVpcmU6ICdeXmN0dlRhYmxlJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIGNvbHNwYW46ICdAJ1xuICAgICAgICB9LFxuICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIHRhYmxlQ3RybCkge1xuICAgICAgICAgICAgdGFibGVDdHJsLmFkZFBhZ2luYXRpb25NZW51KHNjb3BlKTtcbiAgICAgICAgICAgIC8vc2hvd0NodW5rKCkgd2lsbCBjYWxjdWxhdGUgYW5kIHNldCBjaHVua3MgaW4gc2NvcGVcbiAgICAgICAgICAgIHRhYmxlQ3RybC5zaG93Q2h1bmsodGFibGVDdHJsLnBhZ2VObywgdGFibGVDdHJsLnNlYXJjaFRleHQpO1xuICAgICAgICAgICAgc2NvcGUuc2hvd0NodW5rID0gZnVuY3Rpb24gKHBhZ2VObykge1xuICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zaG93Q2h1bmsocGFnZU5vLCB0YWJsZUN0cmwuc2VhcmNoVGV4dCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgc2NvcGUuc2hvd1ByZXZDaHVuayA9IHRhYmxlQ3RybC5zaG93UHJldkNodW5rO1xuICAgICAgICAgICAgc2NvcGUuc2hvd05leHRDaHVuayA9IHRhYmxlQ3RybC5zaG93TmV4dENodW5rO1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy9wYWdpbmF0aW9ubWVudS5odG1sJ1xuICAgIH07XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRhYmxlZGlyZWN0aXZlLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAxMC8xNC8xNi5cbiAqL1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kZWxzLm1vZHVsZS5qcy5tYXBcbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2QWNpdmFsaWRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9kaXJlY3RpdmVzL25vZGVzL2FjaXZhbGlkLmh0bWwnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBmb3JtOiBcIj1cIlxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pO1xuYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZDb250cm9saW50ZXJmYWNlXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy9ub2Rlcy9jb250cm9saW50ZXJmYWNlLmh0bWwnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBleHRyYXZhcnM6IFwiPVwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5kaXJlY3RpdmVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dk5ldHdvcmttb2RlXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy9ub2Rlcy9uZXR3b3JrbW9kZS5odG1sJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgZXh0cmF2YXJzOiBcIj1cIlxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pO1xuYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZTY2hlZHVsZXJcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9kaXJlY3RpdmVzL25vZGVzL3NjaGVkdWxlci5odG1sJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgZXh0cmF2YXJzOiBcIj1cIlxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pOyIsIi8qKlxuICogRGVmaW5pbmcgdGhlIEdyYXBoIE1vZHVsZS5cbiAqIFNlZSBERVNJR04ubWQgZm9yIGluZm8gb24gR3JhcGggT2JqZWN0cy5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcsIFtdKTtcblxuXG5cblxuIiwiYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiLCBbXSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwIiwiLyoqXG4gKiBUaGUgYmFzZSBjbGFzcyB0aGUgRGF0YVNvdXJjZSBvYmplY3QuXG4gKiBcbiAqIFRoZSBEYXRhU291cmNlIG9iamVjdCB0YWtlcyBpbiBub2RlIGFuZCBsaW5rIGRhdGEgZnJvbSB0aGUgc2VydmVyLCBcbiAqIGFuZCBwcm92aWRlcyBtZXRob2RzIGZvciBjb252ZXJ0aW5nIGFuZCBtYW5pcHVsYXRpbmcgdGhlIGRhdGEgZm9yXG4gKiB0aGUgZ3JhcGggb2JqZWN0LlxuICogXG4gKiBUbyB3cml0ZSB5b3VyIG93biBEYXRhU291cmNlIG9iamVjdCwgY3JlYXRlIGEgbmV3IGZhY3RvcnkgdGhhdCB1c2VzIHRoZSBcbiAqIERhdGFTb3VyY2UgeW91IHdhbnQgdG8gaW5oZXJpdCBhcyBhIGRlcGVuZGVuY3ksIGFuZCBleHRlbmQgXG4gKiBpdHMgRGF0YVNvdXJjZSBjbGFzcy4gXG4gKiBSZXR1cm4gdGhlIGNsYXNzIG9iamVjdCB3aXRoIERhdGFTb3VyY2UgYXMga2V5LlxuICogXG4gKiBOb2RlIGRhdGEgaXMgZXhwZWN0ZWQgdG8gYmUgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6XG4gKiB7aWQ6bm9kZV9pZCwgdGV4dDpub2RlX3RleHR9XG4gKiBcbiAqIExpbmsgZGF0YSBpcyBleHBlY3RlZCB0byBiZSBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDpcbiAqIHtzb3VyY2U6IHNvdXJjZU5vZGVJZCwgdGFyZ2V0OiB0YXJnZXROb2RlSWR9XG4gKiBcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ0RhdGFTb3VyY2UnLCBbJ05vZGUnLCAnTGluaycsIFxuICAgIFx0ZnVuY3Rpb24gKE5vZGUsIExpbmspIHtcblxuICAgIFx0Y2xhc3MgRGF0YVNvdXJjZSB7XG4gICAgXHRcdC8qKlxuICAgIFx0XHQgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgXHRcdCAqXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBub2RlcyAgICAgICAgICAgICAgVGhlIG5vZGUgZGF0YSBcbiAgICBcdFx0ICogQHBhcmFtICAgICAge0FycmF5fSAgIGxpbmtzICAgICAgICAgICAgICBUaGUgbGluayBkYXRhXG4gICAgXHRcdCAqL1xuXHRcdFx0Y29uc3RydWN0b3Iobm9kZXMsIGxpbmtzKSB7XG5cdFx0XHRcdHRoaXMubm9kZXMgPSBub2Rlcztcblx0XHRcdFx0dGhpcy5saW5rcyA9IGxpbmtzO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFJlcGxhY2VzIHRoZSBub2RlIGRhdGFcblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGVzICAgVGhlIG5vZGVzXG5cdFx0XHQgKi9cblx0XHRcdHVwZGF0ZU5vZGVzKG5vZGVzKSB7XG5cdFx0XHRcdHRoaXMubm9kZXMgPSBub2Rlcztcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBSZXBsYWNlcyB0aGUgbGluayBkYXRhXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0xpbmt9ICBsaW5rcyAgIFRoZSBsaW5rc1xuXHRcdFx0ICovXG5cdFx0XHR1cGRhdGVMaW5rcyhsaW5rcykge1xuXHRcdFx0XHR0aGlzLmxpbmtzID0gbGlua3M7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogUmV0dXJucyB0aGUgTmFtZSBhdHRyaWJ1dGUgb2YgdGhlIE5vZGUgd2l0aCB0aGUgXG5cdFx0XHQgKiBtYXRjaGluZyBpZFxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG5cdFx0XHQgKiBAcmV0dXJuICAgICB7c3RyaW5nfSAgbmFtZSBvZiB0aGUgbWF0Y2hpbmcgbm9kZVxuXHRcdFx0ICovXG5cdFx0XHRub2RlSWRUb05hbWUoaWQpIHtcblx0XHQgICAgICAgIHZhciBub2RlcyA9IHRoaXMubm9kZXM7XG5cdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0ICAgICAgICAgICAgaWYgKG5vZGVzW2ldLmlkID09IGlkKSB7XG5cdFx0ICAgICAgICAgICAgICAgIHJldHVybiBub2Rlc1tpXS5uYW1lO1xuXHRcdCAgICAgICAgICAgIH1cblx0XHQgICAgICAgIH1cblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBwcm9jZXNzIHRoZSBub2RlRGF0YSB0byBjcmVhdGUgTm9kZSBvYmplY3RzXG5cdFx0ICAgICAqXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVEYXRhICBOb2RlRGF0YSB0byBjb252ZXJ0IFxuXHRcdCAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gbm9kZSBvYmplY3RzXG5cdFx0ICAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIE5vZGUgb2JqZWN0c1xuXHRcdCAgICAgKi9cblx0XHQgICAgcHJvY2Vzc05vZGVEYXRhKG5vZGVEYXRhKSB7XG5cdFx0ICAgICAgICB2YXIgbm9kZXMgPSBbXTtcblx0XHQgICAgICAgIF8uZm9yRWFjaChub2RlRGF0YSwgZnVuY3Rpb24oZGF0YSkge1xuXHRcdCAgICAgICAgICAgIHZhciBuZXdOb2RlID0gbmV3IE5vZGUuTm9kZShudWxsLCBudWxsLCBkYXRhLmlkLCBkYXRhLnRleHQsIG51bGwpO1xuXHRcdCAgICAgICAgICAgIG5vZGVzLnB1c2gobmV3Tm9kZSk7XG5cdFx0ICAgICAgICB9KTtcblx0XHQgICAgICAgIHJldHVybiBub2Rlcztcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBwcm9jZXNzIHRoZSBsaW5rRGF0YVxuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBsaW5rRGF0YSAgVGhlIGxpbmsgZGF0YVxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlcyAgICAgVGhlIG5vZGVzIGZyb20gcHJvY2Vzc05vZGVEYXRhXG5cdFx0ICAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIExpbmsgb2JqZWN0c1xuXHRcdCAgICAgKi9cblx0XHQgICAgcHJvY2Vzc0xpbmtEYXRhKGxpbmtEYXRhLCBub2Rlcykge1xuXHRcdCAgICBcdC8qKlxuXHRcdFx0ICAgICAqIFJldHVybnMgdGhlIG5vZGUgdGhhdCBtYXRjaGVzIHRoZSBpZFxuXHRcdFx0ICAgICAqXG5cdFx0XHQgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gaWQgICAgICBUaGUgaWRlbnRpZmllclxuXHRcdFx0ICAgICAqIEByZXR1cm4gICAgIHtOb2RlfSAgIFRoZSBub2RlIHdpdGggdGhlIG1hdGNoaW5nIGlkXG5cdFx0XHQgICAgICovXG5cdFx0XHQgICAgZnVuY3Rpb24gZmluZE5vZGVCeUlkKGlkLCBub2Rlcykge1xuXHRcdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHQgICAgICAgICAgICBpZiAoaWQgPT0gbm9kZXNbaV0uaWQpIHtcblx0XHRcdCAgICAgICAgICAgICAgICByZXR1cm4gbm9kZXNbaV07XG5cdFx0XHQgICAgICAgICAgICB9XG5cdFx0XHQgICAgICAgIH1cblx0XHRcdCAgICB9XG5cblx0XHQgICAgICAgIHZhciBsaW5rcyA9IFtdO1xuXHRcdCAgICAgICAgLy90cmFuc2Zvcm1pbmcgbGluayBkYXRhXG5cdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpbmtEYXRhLmxlbmd0aDsgaSsrKSB7XG5cdFx0ICAgICAgICAgICAgaWYgKGxpbmtEYXRhW2ldLnNvdXJjZSAhPSBsaW5rRGF0YVtpXS50YXJnZXQpIHtcblx0XHQgICAgICAgICAgICAgICAgdmFyIHNvdXJjZSA9IGZpbmROb2RlQnlJZChsaW5rRGF0YVtpXS5zb3VyY2UsIG5vZGVzKTtcblx0XHQgICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IGZpbmROb2RlQnlJZChsaW5rRGF0YVtpXS50YXJnZXQsIG5vZGVzKTtcblx0XHQgICAgICAgICAgICAgICAgaWYgKHNvdXJjZSA9PSBudWxsIHx8IHRhcmdldCA9PSBudWxsKSB7XG5cdFx0ICAgICAgICAgICAgICAgIFx0Y29udGludWU7XG5cdFx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICB2YXIgbGluayA9IG5ldyBMaW5rLkxpbmsoc291cmNlLCB0YXJnZXQpO1xuXHQgICAgICAgICAgICAgICAgICAgIGxpbmtzLnB1c2gobGluayk7XG5cdFx0ICAgICAgICAgICAgfSAgXG5cdFx0ICAgICAgICB9XG5cdFx0ICAgICAgICByZXR1cm4gbGlua3M7XG5cdFx0ICAgIH1cblx0XHR9XG5cdFx0cmV0dXJuIHtcblx0XHRcdERhdGFTb3VyY2U6RGF0YVNvdXJjZVxuXHRcdH1cbn1dKTtcblxuXG5cblxuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8xNC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5tb2RlbHMnLCBbXSk7XG52YXIgQ29udGl2R2xvYmFscyA9IChmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgLy9SRVNUIGVuZHBvaW50cyBmb3IgTkVUTUFTVEVSXG4gICAgICAgICdORVRXT1JLU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9uZXR3b3Jrcy8nLFxuICAgICAgICAnTkVUV09SS1NfSU5TUEVDVF9FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9pbnNwZWN0L25ldHdvcmtzLycsXG4gICAgICAgICdTRVJWSUNFTEJTX0lOU1BFQ1RfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvaW5zcGVjdC9zZXJ2aWNlTEJzLycsXG4gICAgICAgICdQT0xJQ0lFU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9wb2xpY3lzLycsXG4gICAgICAgICdSVUxFU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9ydWxlcy8nLFxuICAgICAgICAnQVBQTElDQVRJT05HUk9VUFNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvZW5kcG9pbnRHcm91cHMvJyxcbiAgICAgICAgJ1NFUlZJQ0VMQlNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvc2VydmljZUxCcy8nLFxuICAgICAgICAnT1JHQU5JWkFUSU9OU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS90ZW5hbnRzLycsXG4gICAgICAgICdORVRXT1JLX1NFVFRJTkdTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL2dsb2JhbHMvJyxcbiAgICAgICAgJ05FVFBST0ZJTEVTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL25ldHByb2ZpbGVzLycsXG4gICAgICAgICdCR1BTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL0JncHMvJyxcbiAgICAgICAgJ0JHUFNfSU5TUEVDVF9FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9pbnNwZWN0L0JncHMvJyxcbiAgICAgICAgJ1ZJU1VBTElaQVRJT05fRU5EUE9JTlQnOiAnL3Zpc3VhbGl6YXRpb24vJyxcbiAgICAgICAgLy9SRVNUIGVuZHBvaW50cyBmb3IgVk9MTUFTVEVSXG4gICAgICAgICdWT0xVTUVTX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvdm9sdW1lcy8nLFxuICAgICAgICAnVk9MVU1FU19DUkVBVEVfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci92b2x1bWVzL2NyZWF0ZS8nLFxuICAgICAgICAnVk9MVU1FU19ERUxFVEVfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci92b2x1bWVzL3JlbW92ZS8nLFxuICAgICAgICAnVk9MVU1FU19DT1BZU05BUFNIT1RTX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvdm9sdW1lcy9jb3B5JyxcbiAgICAgICAgJ1ZPTFVNRVNfVVNFU19FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3VzZXMvbW91bnRzLycsXG4gICAgICAgICdWT0xVTUVTX1NOQVBTSE9UU19FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3NuYXBzaG90cy8nLFxuICAgICAgICAnU1RPUkFHRVBPTElDSUVTX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvcG9saWNpZXMvJyxcbiAgICAgICAgJ1ZPTFVNRVNfR0xPQkFMX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvZ2xvYmFsLycsXG4gICAgICAgIC8vUkVTVCBlbmRwb2ludHMgZm9yIENMVVNURVJcbiAgICAgICAgJ05PREVTX0xJU1RfRU5EUE9JTlQnOiAnL2luZm8vbm9kZXMnLFxuICAgICAgICAnTk9ERVNfRElTQ09WRVJfRU5EUE9JTlQnOiAnL2Rpc2NvdmVyL25vZGVzJyxcbiAgICAgICAgJ05PREVTX0NPTU1JU1NJT05fRU5EUE9JTlQnOiAnL2NvbW1pc3Npb24vbm9kZXMnLFxuICAgICAgICAnTk9ERVNfREVDT01NSVNTSU9OX0VORFBPSU5UJzogJy9kZWNvbW1pc3Npb24vbm9kZXMnLFxuICAgICAgICAnTk9ERVNfTUFJTlRFTkFOQ0VfRU5EUE9JTlQnOiAnL21haW50ZW5hbmNlL25vZGVzJyxcbiAgICAgICAgJ05PREVTX0xBU1RfSk9CX0VORFBPSU5UJzogJy9pbmZvL2pvYi9sYXN0JyxcbiAgICAgICAgJ05PREVTX0FDVElWRV9KT0JfRU5EUE9JTlQnOiAnL2luZm8vam9iL2FjdGl2ZScsXG4gICAgICAgICdOT0RFU19TRVRUSU5HU19TRVRfRU5EUE9JTlQnOiAnL2dsb2JhbHMnLFxuICAgICAgICAnTk9ERVNfU0VUVElOR1NfR0VUX0VORFBPSU5UJzogJy9pbmZvL2dsb2JhbHMnLFxuICAgICAgICAvL1JlZnJlc2ggaW50ZXJ2YWwgaW4gbWlsbGlzZWNvbmRzXG4gICAgICAgICdSRUZSRVNIX0lOVEVSVkFMJzogNTAwMCxcbiAgICAgICAgLy9SZWdFeCBmb3IgdmFsaWRhdGlvblxuICAgICAgICAnQ0lEUl9SRUdFWCc6ICdeKChbMC05XXxbMS05XVswLTldfDFbMC05XXsyfXwyWzAtNF1bMC05XXwyNVswLTVdKVxcLil7M30oWzAtOV18WzEtOV1bMC05XXwxWzAtOV17Mn18MlswLTRdWzAtOV18MjVbMC01XSkoXFwvKFswLTldfFsxLTJdWzAtOV18M1swLTJdKSkkJyxcbiAgICAgICAgJ1ZMQU5fUkVHRVgnOiAnXihbMC05XXsxLDR9Py1bMC05XXsxLDR9PykkJyxcbiAgICAgICAgJ1ZYTEFOX1JFR0VYJzogJ14oWzAtOV17MSw4fT8tWzAtOV17MSw4fT8pJCcsXG4gICAgICAgICdOVU1CRVJfUkVHRVgnOiAnXlswLTldKiQnXG4gICAgfTtcbn0pKCk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnV0aWxzJywgW10pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIi8qKlxuICogVGhlIERhdGFTb3VyY2UgdXNlZCBmb3IgdGhlIHZpc3VhbGl6YXRpb24gdGFiLlxuICogXG4gKiBOb2RlIERhdGEgZnJvbSB0aGUgc2VydmVyIGlzIGV4cGVjdGVkIHRvIGJlIGluIHRoZSBmb2xsb3dpbmcgZm9ybWF0OlxuICoge2lkOiBub2RlX2lkLCB0ZXh0OiBub2RlX3RleHR9XG4gKiBQYXJlbnQgYW5kIEFuY2VzdG9yIGF0dHJpYnV0ZXMgY2FuIGJlIHNldCBieSBjYWxsaW5nIHNldEFuY2VzdG9yc1xuICogXG4gKiBMaW5rIERhdGEgZnJvbSB0aGUgc2VydmVyIGlzIGV4cGVjdGVkIHRvIGJlIGluIHRoZSBmb2xsb3dpbmcgZm9ybWF0OlxuICoge3NvdXJjZTogc291cmNlTm9kZUlkLCB0YXJnZXQ6IHRhcmdldE5vZGVJZCwgd2VpZ2h0OiBsaW5rV2VpZ2h0fVxuICogXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdWaXN1YWxpemVyRGF0YVNvdXJjZScsIFsnRGF0YVNvdXJjZScsICdWaXN1YWxpemVyTm9kZScsICdWaXN1YWxpemVyTGluaycsIFxuICAgIFx0ZnVuY3Rpb24gKERhdGFTb3VyY2UsIFZpc3VhbGl6ZXJOb2RlLCBWaXN1YWxpemVyTGluaykge1xuXG4gICAgXHRjbGFzcyBWaXN1YWxpemVyRGF0YVNvdXJjZSBleHRlbmRzIERhdGFTb3VyY2UuRGF0YVNvdXJjZSB7XG4gICAgXHRcdC8qKlxuICAgIFx0XHQgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgXHRcdCAqIFxuICAgIFx0XHQgKiBDaGlsZHJlbiBTdHJ1Y3QgYW5kIGFuY2VzdG9yc19zdHJ1Y3QgYXJlIEpTT04gb2JqZWN0cyxcbiAgICBcdFx0ICogbWFwcGluZyBhIG5vZGUgSWQgdG8gYSBsaXN0IG9mIGl0J3MgY2hpbGRyZW4gb3IgYW5jZXN0b3JzLlxuICAgIFx0XHQgKiBDaGlsZHJlbiBTdHJ1Y3QgaXMgYWxzbyBleHBlY3RlZCB0byBoYXZlIGEgZmllbGQgY2FsbGVkXG4gICAgXHRcdCAqIHRvcExldmVsLCB0aGF0IG1hcHMgdG8gYSBsaXN0IG9mIGFsbCB0aGUgbm9kZXMgdGhhdCBkb24ndFxuICAgIFx0XHQgKiBoYXZlIGFueSBwYXJlbnRzLlxuICAgIFx0XHQgKlxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgbm9kZXMgICAgICAgICAgICAgIFRoZSBub2RlIGRhdGEgXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBsaW5rcyAgICAgICAgICAgICAgVGhlIGxpbmsgZGF0YVxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgY2hpbGRyZW5fc3RydWN0ICAgIFRoZSBjaGlsZHJlbiBzdHJ1Y3R1cmVcbiAgICBcdFx0ICogQHBhcmFtICAgICAge09iamVjdH0gIGFuY2VzdG9yc19zdHJ1Y3QgICBUaGUgYW5jZXN0b3JzIHN0cnVjdHVyZVxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgbGFiZWxzICAgICAgICAgICAgIFRoZSBsYWJlbHNcbiAgICBcdFx0ICogQHBhcmFtICAgICAge0FycmF5fSAgIHNlbGVjdG9ycyAgICAgICAgICBUaGUgc2VsZWN0b3JzXG4gICAgXHRcdCAqL1xuXHRcdFx0Y29uc3RydWN0b3Iobm9kZXMsIGxpbmtzLCBjaGlsZHJlbl9zdHJ1Y3QsIGFuY2VzdG9yc19zdHJ1Y3QsIFxuXHRcdFx0XHRcdGxhYmVscywgc2VsZWN0b3JzKSB7XG5cdFx0XHRcdHN1cGVyKG5vZGVzLGxpbmtzKTtcblx0XHRcdFx0dGhpcy5jaGlsZHJlbl9zdHJ1Y3QgPSBjaGlsZHJlbl9zdHJ1Y3Q7XG5cdFx0XHRcdHRoaXMuYW5jZXN0b3JzX3N0cnVjdCA9IGFuY2VzdG9yc19zdHJ1Y3Q7XG5cdFx0XHRcdHRoaXMubGFiZWxzID0gbGFiZWxzO1xuXHRcdFx0XHR0aGlzLnNlbGVjdG9ycyA9IHNlbGVjdG9ycztcblx0XHRcdH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogRGV0ZXJtaW5lcyBpZiBpdCBoYXMgY2hpbGQuXG5cdFx0ICAgICAqXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICAgaWQgICAgICBUaGUgaWRlbnRpZmllclxuXHRcdCAgICAgKiBAcmV0dXJuICAgICB7Ym9vbGVhbn0gIFRydWUgaWYgaGFzIGNoaWxkLCBGYWxzZSBvdGhlcndpc2UuXG5cdFx0ICAgICAqL1xuXHRcdCAgICBoYXNDaGlsZChpZCkge1xuXHRcdCAgICBcdGlmICh0aGlzLmNoaWxkcmVuX3N0cnVjdFtpZF0gPT0gbnVsbCkge1xuICAgICAgICAgICAgXHRcdHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIFx0fVxuICAgICAgICAgICAgXHRyZXR1cm4gdHJ1ZTtcdFxuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIFNldHMgdGhlIHBhcmVudCBhbmQgYW5jZXN0b3JzIGF0dHJpYnV0ZSB1c2luZyBcblx0XHQgICAgICogYW5jZXN0b3JzX3N0cnVjdCBmb3IgYWxsIHRoZSBub2Rlc1xuXHRcdCAgICAgKiBBbHNvIGFkZHMgYW55IG5vZGVzIHdpdGhvdXQgYW5jZXN0b3JzLCB0aGF0IGFyZW4ndCBcblx0XHQgICAgICogdG9wbGV2ZWwgdG8gdGhlIGNsaWVudCBzZXJ2aWNlLlxuXHRcdCAgICAgKi9cblx0XHQgICAgc2V0QW5jZXN0b3JzKCkge1xuXHRcdCAgICBcdHZhciB0aGlzRGF0YVNvdXJjZSA9IHRoaXM7XG5cdFx0ICAgIFx0dmFyIGFkZGVkQ2xpZW50ID0gZmFsc2U7XG5cdFx0ICAgIFx0Xy5mb3JFYWNoKHRoaXNEYXRhU291cmNlLm5vZGVzLCBmdW5jdGlvbihub2RlKSB7XG5cdFx0ICAgIFx0XHRub2RlLmFuY2VzdG9ycyA9IHRoaXNEYXRhU291cmNlLmFuY2VzdG9yc19zdHJ1Y3Rbbm9kZS5pZF0gfHwgW107XG5cdFx0ICAgIFx0XHRpZiAoXy5pc0VtcHR5KG5vZGUuYW5jZXN0b3JzKSA9PT0gZmFsc2UpIHtcblx0XHQgICAgXHRcdFx0bm9kZS5wYXJlbnQgPSBub2RlLmFuY2VzdG9yc1swXTtcblx0XHQgICAgXHRcdH0gZWxzZSB7XG5cdFx0ICAgIFx0XHRcdGlmIChfLmluY2x1ZGVzKHRoaXNEYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbCwgbm9kZS5pZCkgPT0gZmFsc2UpIHtcblx0XHQgICAgXHRcdFx0XHQvL2NvbnRhaW5lciBoYXMgbm8gcGFyZW50XG5cdFx0ICAgIFx0XHRcdFx0Ly9hZGRpbmcgdG8gY2xpZW50XG5cdFx0ICAgIFx0XHRcdFx0bm9kZS5hbmNlc3RvcnMucHVzaChcImNsaWVudFwiKTtcblx0XHQgICAgXHRcdFx0XHR0aGlzRGF0YVNvdXJjZS5hbmNlc3RvcnNfc3RydWN0W25vZGUuaWRdID0gW1wiY2xpZW50XCJdO1xuXHRcdCAgICBcdFx0XHRcdGlmIChhZGRlZENsaWVudCA9PT0gZmFsc2UpIHtcblx0XHQgICAgXHRcdFx0XHRcdGFkZGVkQ2xpZW50ID0gdHJ1ZTtcblx0XHRcdCAgICBcdFx0XHRcdHRoaXNEYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbC5wdXNoKFwiY2xpZW50XCIpO1xuXHRcdCAgICBcdFx0XHRcdFx0dGhpc0RhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0WydjbGllbnQnXSA9IFtdO1xuXHRcdCAgICBcdFx0XHRcdH1cblx0XHQgICAgXHRcdFx0XHR0aGlzRGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbJ2NsaWVudCddLnB1c2gobm9kZS5pZCk7XG5cdFx0XHQgICAgXHRcdH1cblx0XHQgICAgXHRcdH1cblx0XHQgICAgXHR9KVxuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIFJldHVybnMgdGhlIGZsb3cgYmV0d2VlbiB0aGUgaGlnaGVzdCBsZXZlbCBncm91cGluZ1xuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcmV0dXJuICAgICB7T2JqZWN0fSAgVGhlIHRvcCBsZXZlbCBmbG93LlxuXHRcdCAgICAgKi9cblx0XHQgICAgZ2V0VG9wTGV2ZWxGbG93KCkge1xuXHRcdCAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Rmxvd0JldHdlZW5TZXQodGhpcy5jaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwpO1xuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIEdldHMgdGhlIGZsb3cgYmV0d2VlbiBhbnkgc2V0IG9mIG5vZGUgbGV2ZWxzXG5cdFx0ICAgICAqXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVfbmFtZXMgIFRoZSBub2RlIG5hbWVzIGluIHRoZSBzZXRcblx0XHQgICAgICogQHJldHVybiAgICAge09iamVjdH0gIFRoZSBmbG93IGJldHdlZW4gc2V0LlxuXHRcdCAgICAgKi9cblx0XHQgICAgZ2V0Rmxvd0JldHdlZW5TZXQobm9kZV9uYW1lcykge1xuXHRcdCAgICAgICAgdmFyIGxvY2FsX25vZGVzID0gdGhpcy5ub2Rlcztcblx0XHQgICAgICAgIHZhciBpZE1hcHBpbmcgPSB7fTtcblx0XHQgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbG9jYWxfbm9kZXMubGVuZ3RoOyBpKyspIHtcblx0XHQgICAgICAgICAgICB2YXIgbm9kZSA9IGxvY2FsX25vZGVzW2ldO1xuXG5cdFx0ICAgICAgICAgICAgLy9pZiBub2RlIGlzIGFscmVhZHkgYXQgaXRzIGhpZ2hlc3QgbGV2ZWxcblx0XHQgICAgICAgICAgICBpZiAobm9kZS5hbmNlc3RvcnMgPT09IG51bGwpIHtcblx0XHQgICAgICAgICAgICAgICAgaWRNYXBwaW5nW25vZGUuaWRdID0gbm9kZS5uYW1lO1xuXHRcdCAgICAgICAgICAgIH0gZWxzZSB7XG5cdFx0ICAgICAgICAgICAgICAgIC8vY2hlY2sgdG8gc2VlIHdoaWNoIHRhZ3MgYXJlIHByZXNlbnQgaW4gdGhlIGFuY2VzdG9yIGxpc3Rcblx0XHQgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBub2RlX25hbWVzLmxlbmd0aDsgaisrKSB7XG5cdFx0ICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5hbmNlc3RvcnMuaW5kZXhPZihub2RlX25hbWVzW2pdKSA+IC0xKSB7XG5cdFx0ICAgICAgICAgICAgICAgICAgICAgICAgaWRNYXBwaW5nW25vZGUuaWRdID0gbm9kZV9uYW1lc1tqXTtcblx0XHQgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblx0XHQgICAgICAgICAgICAgICAgICAgIH1cblx0XHQgICAgICAgICAgICAgICAgfVxuXHRcdCAgICAgICAgICAgIH1cblx0XHQgICAgICAgIH0gICBcblx0XHQgICAgICAgIC8vbW9kaWZ5IGxpbmtzXG5cdFx0ICAgICAgICB2YXIgbGlua3MgPSB0aGlzLmxpbmtzO1xuXHRcdCAgICAgICAgdmFyIGxpbmtEYXRhID0gW107XG5cdFx0ICAgICAgICBcblx0XHQgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGlua3MubGVuZ3RoOyBpKyspIHtcblx0XHQgICAgICAgICAgICB2YXIgbGluayA9IFtdO1xuXHRcdCAgICAgICAgICAgIGxpbmsuc291cmNlID0gaWRNYXBwaW5nW2xpbmtzW2ldLnNvdXJjZV0gfHwgbGlua3NbaV0uc291cmNlO1xuXHRcdCAgICAgICAgICAgIGxpbmsudGFyZ2V0ID0gaWRNYXBwaW5nW2xpbmtzW2ldLnRhcmdldF0gfHwgbGlua3NbaV0udGFyZ2V0O1xuXHRcdCAgICAgICAgICAgIGxpbmsud2VpZ2h0ID0gbGlua3NbaV0ud2VpZ2h0O1xuXHRcdCAgICAgICAgICAgIGxpbmtEYXRhLnB1c2gobGluayk7XG5cdFx0ICAgICAgICB9XG5cblx0XHQgICAgICAgIC8vY3JlYXRpbmcgdGhlIG5vZGVEYXRhXG5cdFx0ICAgICAgICB2YXIgbm9kZURhdGEgPSBbXTtcblx0XHQgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZV9uYW1lcy5sZW5ndGg7IGkrKykge1xuXHRcdCAgICAgICAgICAgIHZhciBub2RlX3RvX2FkZCA9IFtdO1xuXHRcdCAgICAgICAgICAgIG5vZGVfdG9fYWRkLmlkID0gbm9kZV9uYW1lc1tpXTtcblx0XHQgICAgICAgICAgICBub2RlX3RvX2FkZC50ZXh0ID0gdGhpcy5ub2RlSWRUb05hbWUobm9kZV9uYW1lc1tpXSkgfHwgbm9kZV9uYW1lc1tpXTtcblxuXG5cdFx0ICAgICAgICAgICAgbm9kZV90b19hZGQuYW5jZXN0b3JzID0gdGhpcy5hbmNlc3RvcnNfc3RydWN0W25vZGVfbmFtZXNbaV1dIHx8IHRoaXMuYW5jZXN0b3JzX3N0cnVjdFtub2RlX3RvX2FkZC50ZXh0XSB8fCBbXTtcblx0XHQgICAgICAgICAgICBpZiAoXy5pc0VtcHR5KG5vZGVfdG9fYWRkLmFuY2VzdG9ycykgPT09IGZhbHNlKSB7XG5cdFx0ICAgICAgICAgICAgICAgIG5vZGVfdG9fYWRkLnBhcmVudCA9IG5vZGVfdG9fYWRkLmFuY2VzdG9yc1swXTtcblx0XHQgICAgICAgICAgICB9IGVsc2Uge1xuXHRcdCAgICAgICAgICAgICAgICBub2RlX3RvX2FkZC5wYXJlbnQgPSBudWxsO1xuXHRcdCAgICAgICAgICAgIH1cblx0XHQgICAgICAgICAgICBub2RlRGF0YS5wdXNoKG5vZGVfdG9fYWRkKTtcblx0XHQgICAgICAgIH1cblxuXHRcdCAgICAgICAgcmV0dXJuIHtub2RlRGF0YTpub2RlRGF0YSwgbGlua0RhdGE6bGlua0RhdGF9O1xuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIHByb2Nlc3MgdGhlIG5vZGVEYXRhIG91dHB1dCBvZiBnZXRGbG93QmV0d2VlblNldFxuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlRGF0YSAgTm9kZURhdGEgdG8gY29udmVydCBcblx0XHQgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIG5vZGUgb2JqZWN0c1xuXHRcdCAgICAgKiBAcmV0dXJuICAgICB7QXJyYXl9ICBOb2RlIG9iamVjdHNcblx0XHQgICAgICovXG5cdFx0ICAgIHByb2Nlc3NOb2RlRGF0YShub2RlRGF0YSkge1xuXHRcdCAgICAgICAgdmFyIG5vZGVzID0gW107XG5cdFx0ICAgICAgICBfLmZvckVhY2gobm9kZURhdGEsIGZ1bmN0aW9uKGRhdGEpIHtcblx0XHQgICAgICAgICAgICB2YXIgbmV3Tm9kZSA9IG5ldyBWaXN1YWxpemVyTm9kZS5Ob2RlKG51bGwsIG51bGwsIGRhdGEuaWQsIGRhdGEudGV4dCxcblx0XHQgICAgICAgICAgICAgICAgbnVsbCwgZGF0YS5wYXJlbnQsIGRhdGEuYW5jZXN0b3JzLCBudWxsLCBudWxsKTtcblx0XHQgICAgICAgICAgICBub2Rlcy5wdXNoKG5ld05vZGUpO1xuXHRcdCAgICAgICAgfSk7XG5cdFx0ICAgICAgICByZXR1cm4gbm9kZXM7XG5cdFx0ICAgIH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogcHJvY2VzcyB0aGUgbGlua0RhdGEgb3V0cHV0IG9mIGdldEZsb3dCZXR3ZWVuU2V0XG5cdFx0ICAgICAqXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIGxpbmtEYXRhICBUaGUgbGluayBkYXRhXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVzICAgICBUaGUgbm9kZXNcblx0XHQgICAgICogQHJldHVybiAgICAge0FycmF5fSAgTGluayBvYmplY3RzXG5cdFx0ICAgICAqL1xuXHRcdCAgICBwcm9jZXNzTGlua0RhdGEobGlua0RhdGEsIG5vZGVzKSB7XG5cdFx0ICAgIFx0LyoqXG5cdFx0XHQgICAgICogUmV0dXJucyB0aGUgbm9kZSB0aGF0IG1hdGNoZXMgdGhlIGlkXG5cdFx0XHQgICAgICpcblx0XHRcdCAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG5cdFx0XHQgICAgICogQHJldHVybiAgICAge05vZGV9ICAgVGhlIG5vZGUgd2l0aCB0aGUgbWF0Y2hpbmcgaWRcblx0XHRcdCAgICAgKi9cblx0XHRcdCAgICBmdW5jdGlvbiBmaW5kTm9kZUJ5SWQoaWQsIG5vZGVzKSB7XG5cdFx0XHQgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdCAgICAgICAgICAgIGlmIChpZCA9PSBub2Rlc1tpXS5pZCkge1xuXHRcdFx0ICAgICAgICAgICAgICAgIHJldHVybiBub2Rlc1tpXTtcblx0XHRcdCAgICAgICAgICAgIH1cblx0XHRcdCAgICAgICAgfVxuXHRcdFx0ICAgIH1cblxuXHRcdCAgICAgICAgdmFyIGxpbmtzID0gW107XG5cdFx0ICAgICAgICAvL2EgbWFwcGluZyBmcm9tIHNvdXJjZS5pZC10YXJnZXQuaWQgdG8gdGhlIGxpbmsgYWRkZWRcblx0XHQgICAgICAgIHZhciBhZGRlZF9saW5rcyA9IHt9O1xuXHRcdCAgICAgICAgLy90cmFuc2Zvcm1pbmcgbGluayBkYXRhXG5cdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpbmtEYXRhLmxlbmd0aDsgaSsrKSB7XG5cdFx0ICAgICAgICAgICAgaWYgKGxpbmtEYXRhW2ldLnNvdXJjZSAhPSBsaW5rRGF0YVtpXS50YXJnZXQpIHtcblx0XHQgICAgICAgICAgICAgICAgdmFyIHNvdXJjZSA9IGZpbmROb2RlQnlJZChsaW5rRGF0YVtpXS5zb3VyY2UsIG5vZGVzKTtcblx0XHQgICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IGZpbmROb2RlQnlJZChsaW5rRGF0YVtpXS50YXJnZXQsIG5vZGVzKTtcblx0XHQgICAgICAgICAgICAgICAgdmFyIHdlaWdodCA9IGxpbmtEYXRhW2ldLndlaWdodDtcblx0XHQgICAgICAgICAgICAgICAgLy9pbiBvcmRlciB0byBzdW0gYWxsIHRoZSB3ZWlnaHRzIG9mIHRoZSBsaW5rcyBvZiB0aGUgc3ViLW5vZGVzLFxuXHRcdCAgICAgICAgICAgICAgICAvL3dlIHVzZSBhZGRlZF9saW5rcyB0byBrZWVwIHRyYWNrIGlmIGFuIGxpbmsgd2FzIGFkZGVkXG5cdFx0ICAgICAgICAgICAgICAgIC8vaWYgaXQgaXMsIHdlIG1vZGlmeSBpdHMgd2VpZ2h0XG5cdFx0ICAgICAgICAgICAgICAgIGlmIChzb3VyY2UgPT0gbnVsbCB8fCB0YXJnZXQgPT0gbnVsbCkge1xuXHRcdCAgICAgICAgICAgICAgICBcdGNvbnRpbnVlO1xuXHRcdCAgICAgICAgICAgICAgICB9XG5cdFx0ICAgICAgICAgICAgICAgIGlmIChhZGRlZF9saW5rc1tzb3VyY2UuaWQgKyAnLScgKyB0YXJnZXQuaWRdID09PSB1bmRlZmluZWQpIHtcblx0XHQgICAgICAgICAgICAgICAgICAgIHZhciBsaW5rID0gbmV3IFZpc3VhbGl6ZXJMaW5rLkxpbmsoc291cmNlLCB0YXJnZXQsIHdlaWdodCk7XG5cdFx0ICAgICAgICAgICAgICAgICAgICBhZGRlZF9saW5rc1tzb3VyY2UuaWQgKyAnLScgKyB0YXJnZXQuaWRdID0gbGluaztcblx0XHQgICAgICAgICAgICAgICAgICAgIGxpbmtzLnB1c2gobGluayk7XG5cdFx0ICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdFx0ICAgICAgICAgICAgICAgICAgICB2YXIgZXhpc3RpbmdfbGluayA9IGFkZGVkX2xpbmtzW3NvdXJjZS5pZCArICctJyArIHRhcmdldC5pZF07XG5cdFx0ICAgICAgICAgICAgICAgICAgICBleGlzdGluZ19saW5rLnNldFdlaWdodChleGlzdGluZ19saW5rLmdldFJhd1dlaWdodCgpICsgd2VpZ2h0KTtcblx0XHQgICAgICAgICAgICAgICAgICAgIGV4aXN0aW5nX2xpbmsuaW5jcmVhc2VDb3VudCgpO1xuXHRcdCAgICAgICAgICAgICAgICB9XG5cdFx0ICAgICAgICAgICAgfSAgXG5cdFx0ICAgICAgICB9XG5cdFx0ICAgICAgICByZXR1cm4gbGlua3M7XG5cdFx0ICAgIH1cblx0XHR9XG5cdFx0cmV0dXJuIHtcblx0XHRcdERhdGFTb3VyY2U6IFZpc3VhbGl6ZXJEYXRhU291cmNlXG5cdFx0fVxufV0pO1xuXG5cblxuXG5cblxuIiwiLyoqXG4gKiBUaGUgYmFzZSBjbGFzcyB0aGUgZ3JhcGggb2JqZWN0LiBBbnkgbm9kZXMgb3IgbGlua3MgdGhhdCBhcmUgY29udGFpbmVkIGluXG4gKiBpdHMgbm9kZXMgb3IgbGlua3MgcHJvcGVydHkgd2lsbCBiZSBkcmF3biBvbiB1cGRhdGVHcmFwaC5cbiAqIFN1cHBvcnRzIHBvbGljaWVzLlxuICogXG4gKiBUbyB3cml0ZSB5b3VyIG93biBncmFwaCBvYmplY3QsIGNyZWF0ZSBhIG5ldyBmYWN0b3J5IHRoYXQgdXNlcyB0aGUgZ3JhcGhcbiAqIHlvdSB3YW50IHRvIGluaGVyaXQgYXMgYSBkZXBlbmRlbmN5LCBhbmQgZXh0ZW5kIGl0cyBncmFwaCBjbGFzcy4gXG4gKiBSZXR1cm4gdGhlIGNsYXNzIG9iamVjdCB3aXRoIEdyYXBoIGFzIGtleS5cbiAqIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnR3JhcGgnLCBbJ1BvbGljeVNlcnZpY2UnLCBmdW5jdGlvbiAoUG9saWN5U2VydmljZSkge1xuICAgICAgICBjbGFzcyBHcmFwaCB7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIGNvbnN0cnVjdG9yIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBTVkd9ICBzdmcgICAgIFRoZSBzdmcgdGhhdCB3aWxsIFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob2xkIHRoZSBncmFwaFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZXMgICAgICBMaXN0IG9mIG5vZGVzIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIGxpbmtzICAgICAgTGlzdCBvZiBsaW5rcyBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHN2Zywgbm9kZXMsIGxpbmtzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMgPSBub2RlcyB8fCBbXTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MgPSBsaW5rcyB8fCBbXTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzID0gW107XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMgPSBbXTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3kgPSBuZXcgUG9saWN5U2VydmljZS5Qb2xpY3koKTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgY2FuWm9vbTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgY2FuUGFuOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpbml0Rm9yY2U6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlVXBkYXRlOiBmYWxzZVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY29uc3RzID0ge1xuICAgICAgICAgICAgICAgICAgICBjaXJjbGVHQ2xhc3M6IFwiY29uY2VwdEdcIixcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGhDbGFzczogXCJncmFwaFwiLFxuICAgICAgICAgICAgICAgICAgICBwYXRoQ2xhc3M6IFwicGF0aFwiLFxuICAgICAgICAgICAgICAgICAgICBub2RlQ2xhc3M6IFwiY2lyY2xlXCIsXG4gICAgICAgICAgICAgICAgICAgIG5vZGVUZXh0OiBcIm5vZGVUZXh0XCIsXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0UmFkaXVzOiA1MCxcbiAgICAgICAgICAgICAgICAgICAgbWF4UmFkaXVzOiA2MCxcbiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogNSxcbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheU9mZnNldDogNjBcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgc3ZnLm9uKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcIm1vdXNlb3ZlclwiXS5jYWxsKHRoaXMsIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiZGJsY2xpY2tcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcImRibGNsaWNrXCJdLmNhbGwodGhpcywgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJjb250ZXh0bWVudVwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wiY29udGV4dG1lbnVcIl0uY2FsbCh0aGlzLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcIm1vdXNlb3V0XCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcIm1vdXNlb3V0XCJdLmNhbGwodGhpcywgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wibW91c2Vkb3duXCJdLmNhbGwodGhpcywgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZXVwXCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcIm1vdXNldXBcIl0uY2FsbCh0aGlzLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8gZGVmaW5lIGFycm93IG1hcmtlcnMgZm9yIGdyYXBoIGxpbmtzXG4gICAgICAgICAgICAgICAgdmFyIGRlZnMgPSBzdmcuYXBwZW5kKCdzdmc6ZGVmcycpO1xuICAgICAgICAgICAgICAgIGRlZnMuYXBwZW5kKCdzdmc6bWFya2VyJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2lkJywgJ2VuZC1hcnJvdycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwidmlld0JveFwiLCBcIjAgLTUgMTAgMTBcIilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJyZWZYXCIsIDIwKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcInJlZllcIiwgLTEpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwibWFya2VyV2lkdGhcIiwgNilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJtYXJrZXJIZWlnaHRcIiwgNilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJvcmllbnRcIiwgXCJhdXRvXCIpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJwYXRoXCIpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiZFwiLCBcIk0wLC01TDEwLDBMMCw1XCIpO1xuXG4gICAgICAgICAgICAgICAgLy8gZGVmaW5lIGFycm93IG1hcmtlcnMgZm9yIGxlYWRpbmcgYXJyb3dcbiAgICAgICAgICAgICAgICBkZWZzLmFwcGVuZCgnc3ZnOm1hcmtlcicpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdpZCcsICdtYXJrLWVuZC1hcnJvdycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd2aWV3Qm94JywgJzAgLTUgMTAgMTAnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigncmVmWCcsIDcpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdtYXJrZXJXaWR0aCcsIDMuNSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ21hcmtlckhlaWdodCcsIDMuNSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ29yaWVudCcsICdhdXRvJylcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgnc3ZnOnBhdGgnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignZCcsICdNMCwtNUwxMCwwTDAsNScpO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2ZyA9IHN2ZztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnRyA9IHN2Zy5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAgICAgICAgIC5jbGFzc2VkKHRoaXNHcmFwaC5jb25zdHMuZ3JhcGhDbGFzcywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z0cgPSB0aGlzR3JhcGguc3ZnRztcblxuICAgICAgICAgICAgICAgIC8vIHN2ZyBub2RlcyBhbmQgbGlua3MgXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzID0gc3ZnRy5hcHBlbmQoXCJnXCIpLnNlbGVjdEFsbChcImdcIik7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMgPSBzdmdHLmFwcGVuZChcImdcIikuc2VsZWN0QWxsKFwiZ1wiKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXRMaW5rcygpO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNldFBvc2l0aW9ucygpO1xuICAgICAgICAgICAgICAgIHZhciByZXNpemVGdW5jID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5vbldpbmRvd1Jlc2l6ZShzdmcpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguYmluZGluZ3MgPSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc2l6ZTpyZXNpemVGdW5jXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAkKHdpbmRvdykucmVzaXplKHJlc2l6ZUZ1bmMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIGNhbGxzIHRoZSBkZXN0cm95IG1ldGhvZCBmb3IgYWxsIHBvbGljaWVzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5LmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5LmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gdGhpc0dyYXBoLmJpbmRpbmdzKSB7XG4gICAgICAgICAgICAgICAgICAgICQod2luZG93KS5vZmYoa2V5LCB0aGlzR3JhcGguYmluZGluZ3Nba2V5XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJ1bnMgdGhlIGluaXQgZnVuY3Rpb24gZm9yIGFsbCB0aGUgbm9kZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5pdE5vZGVzKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUnVucyB0aGUgaW5pdCBmdW5jdGlvbiBmb3IgYWxsIHRoZSBsaW5rc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbml0TGlua3MoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5saW5rcywgZnVuY3Rpb24obGluaykge1xuICAgICAgICAgICAgICAgICAgICBsaW5rLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiByZXR1cm5zIHRoZSBub2RlIG1hdGNoaW5nIHRoZSBpZCwgXG4gICAgICAgICAgICAgKiBvciB1bmRlZmluZWQgaWYgdGhlcmUgaXMgbm9uZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7Tm9kZX0gIHsgbWF0Y2hpbmcgbm9kZSB9XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZpbmROb2RlQnlJZChpZCl7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSB0aGlzR3JhcGgubm9kZXNbaV0uaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzR3JhcGgubm9kZXNbaV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJldHVybnMgdGhlIGQzTm9kZSBvYmplY3QgdGhhdCBtYXRjaGVzIHRoZSBpZCxcbiAgICAgICAgICAgICAqIG9yIHVuZGVmaW5lZCBpZiB0aGVyZSBpcyBub25lXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGlkICAgICAgVGhlIGlkZW50aWZpZXJcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtEM05vZGV9IFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZpbmREM05vZGUoaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgZDNOb2RlO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2goZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5pZCA9PT0gaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQzTm9kZSA9IGQzLnNlbGVjdCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkM05vZGU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byBpbnN0YWxsIGEgZHJhZyBwb2xpY3kgdGhhdCB3aWxsIGJlIGNhbGxlZFxuICAgICAgICAgICAgICogd2hlbiBub2RlcyBhcmUgZHJhZ2dlZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkMy5iZWhhdmlvci5kcmFnfSAgZDNkcmFnICBEMyBkcmFnIG9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbnN0YWxsRHJhZ1BvbGljeShkM2RyYWcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRyYWcgPSBkM2RyYWc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byBpbnN0YWxsIGEgcG9saWN5IHRoYXQgd2lsbCBiZSBjYWxsZWQgXG4gICAgICAgICAgICAgKiB3aGVuIHRoZXJlIGlzIG1vdXNlIGludGVyYWN0aW9ucyB3aXRoIHRoZSBncmFwaCdzIHN2Z1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3kgIFRoZSBwb2xpY3kgdG8gaW5zdGFsbFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbnN0YWxsU3ZnUG9saWN5KHBvbGljeSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3ZnUG9saWN5ID0gcG9saWN5O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVzZWQgdG8gaW5zdGFsbCBwb2xpY2llcyB0aGF0IGFyZSBjYWxsZWQgd2hlbiB0aGVyZSBpc1xuICAgICAgICAgICAgICogbW91c2UgaW50ZXJhY3Rpb24gd2l0aCBhIG5vZGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UG9saWN5fSAgcG9saWN5ICBUaGUgcG9saWN5IHRvIGluc3RhbGxcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5zdGFsbERlZmF1bHROb2RlUG9saWN5KHBvbGljeSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzLnB1c2gocG9saWN5KTtcbiAgICAgICAgICAgICAgICBwb2xpY3kuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byByZW1vdmUgYW4gaW5zdGFsbGVkIHBvbGljeSBmb3Igbm9kZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHBvbGljeVJlbW92ZSAgVGhlIHBvbGljeSB0byByZW1vdmVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdW5pbnN0YWxsRGVmYXVsdE5vZGVQb2xpY3kocG9saWN5UmVtb3ZlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBvbGljeVJlbW92ZU5hbWU7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBwb2xpY3lSZW1vdmUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZS5wb2xpY3lOYW1lO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvbGljeS5wb2xpY3lOYW1lID09PSBwb2xpY3lSZW1vdmVOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2xpY3kuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJldHVybnMgdGhlIG5vZGUgcG9saWN5IG9iamVjdCB3aXRoIHRoZSBnaXZlbiBuYW1lXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHBvbGljeU5hbWUgIFRoZSBwb2xpY3kgbmFtZVxuICAgICAgICAgICAgICogQHJldHVybiAgICAge1BvbGljeX0gIHBvbGljeSAgICAgIFRoZSBtYXRjaGluZyBwb2xpY3lcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZ2V0Tm9kZVBvbGljeShwb2xpY3lOYW1lKSB7XG4gICAgICAgICAgICBcdHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3ksIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb2xpY3kucG9saWN5TmFtZSA9PT0gcG9saWN5TmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBvbGljeTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVzZWQgdG8gaW5zdGFsbCBwb2xpY2llcyB0aGF0IGFyZSBjYWxsZWQgd2hlbiB0aGVyZSBpcyBhXG4gICAgICAgICAgICAgKiBtb3VzZSBpbnRlcmFjdGlvbiB3aXRoIGEgcGF0aFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3kgIFRoZSBwb2xpY3kgdG8gaW5zdGFsbFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3kocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMucHVzaChwb2xpY3kpO1xuICAgICAgICAgICAgICAgIHBvbGljeS5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byByZW1vdmUgYW4gaW5zdGFsbGVkIHBvbGljeSBmb3IgbGlua3NcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UG9saWN5fSAgcG9saWN5UmVtb3ZlICBUaGUgcG9saWN5IHRvIHJlbW92ZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1bmluc3RhbGxEZWZhdWx0UGF0aFBvbGljeShwb2xpY3lSZW1vdmUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcG9saWN5UmVtb3ZlTmFtZTtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHBvbGljeVJlbW92ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlLnBvbGljeU5hbWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5LCBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9saWN5LnBvbGljeU5hbWUgPT09IHBvbGljeVJlbW92ZU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlcmUgaXMgYSBtb3VzZSBpbnRlcmFjdGlvbiB3aXRoIGEgcGF0aFxuICAgICAgICAgICAgICogUHJvcG9nYXRlcyB0aGUgZXZlbnQgdG8gYWxsIGluc3RhbGxlZCBwYXRoIHBvbGljaWVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGV2ZW50ICAgVGhlIGV2ZW50IHR5cGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM29iamVjdH0gIGQzcGF0aCAgVGhlIGQzIHBhdGhcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQYXRofSAgZCAgICAgICBUaGUgbWF0Y2hpbmcgTGluayBvYmplY3RcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgcGF0aFBvbGljeUV2ZW50KGV2ZW50LCBkM3BhdGgsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lbZXZlbnRdKGQzcGF0aCwgZCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGVyZSBpcyBhIG1vdXNlIGludGVyYWN0aW9uIHdpdGggYSBub2RlXG4gICAgICAgICAgICAgKiBQcm9wb2dhdGVzIHRoZSBldmVudCB0byBhbGwgaW5zdGFsbGVkIG5vZGUgcG9saWNpZXNcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGV2ZW50ICAgVGhlIGV2ZW50IHR5cGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM29iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQYXRofSAgZCAgICAgICBUaGUgbWF0Y2hpbmcgTm9kZSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgbm9kZVBvbGljeUV2ZW50KGV2ZW50LCBkM25vZGUsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMsIGZ1bmN0aW9uKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lbZXZlbnRdKGQzbm9kZSwgZCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTZXRzIHBhbiBhbmQgem9vbSBydWxlcyBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzLmJlaGF2aW9yLnpvb219ICBkM3pvb20gIEQzIHpvb20gb2JqXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluc3RhbGxab29tUG9saWN5KGQzem9vbSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZHJhZ1N2ZyA9IGQzem9vbTtcbiAgICAgICAgICAgICAgICB0aGlzLnN2Zy5jYWxsKHRoaXMuZHJhZ1N2Zyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIHdpbmRvdyBpcyByZXNpemVkXG4gICAgICAgICAgICAgKiBIb29rIGZvciBvdmVycmlkaW5nIGluIHN1YmNsYXNzZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBTVkd9ICBzdmcgICAgIFRoZSBzdmcgdGhhdCB0aGUgaGFuZGxlclxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpcyBhdHRhY2hlZCB0b1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBvbldpbmRvd1Jlc2l6ZShzdmcpIHt9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogSW5zZXJ0cyBsaW5lIGJyZWFrcyBpbiBub2RlIHRleHRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBFbGVtfSAgZ0VsICAgIFRoZSBlbGVtIHRvIGFkZCB0ZXh0IHRvXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgdGl0bGUgICBUaGUgdGl0bGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5zZXJ0VGl0bGVMaW5lYnJlYWtzIChnRWwsIHRpdGxlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHdvcmRzID0gdGl0bGUuc3BsaXQoL1xccysvZyksXG4gICAgICAgICAgICAgICAgICAgIG53b3JkcyA9IHdvcmRzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB2YXIgZWwgPSBnRWwuYXBwZW5kKFwidGV4dFwiKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCB0aGlzR3JhcGguY29uc3RzLm5vZGVUZXh0KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcInRleHQtYW5jaG9yXCIsXCJtaWRkbGVcIilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJkeVwiLCBcIi1cIiArIChud29yZHMtMSkqNy41KTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgd29yZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRzcGFuID0gZWwuYXBwZW5kKCd0c3BhbicpLnRleHQod29yZHNbaV0pO1xuICAgICAgICAgICAgICAgIGlmIChpID4gMClcbiAgICAgICAgICAgICAgICAgICAgdHNwYW4uYXR0cigneCcsIDApLmF0dHIoJ2R5JywgJzE1Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJlbW92ZXMgYWxsIGxpbmtzIGZyb20gdGhlIGdpdmVuIG5vZGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc3BsaWNlTGlua3NGb3JOb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgdG9TcGxpY2UgPSB0aGlzR3JhcGgubGlua3MuZmlsdGVyKGZ1bmN0aW9uKGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobC5zb3VyY2UgPT09IG5vZGUgfHwgbC50YXJnZXQgPT09IG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0b1NwbGljZS5tYXAoZnVuY3Rpb24obCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3Muc3BsaWNlKHRoaXNHcmFwaC5saW5rcy5pbmRleE9mKGwpLCAxKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBBZGRzIHRoZSBub2RlIHRvIHRoZSBncmFwaCBhbmQgdXBkYXRlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBhZGROb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICBub2RlLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyB0aGUgbm9kZSB0byB0aGUgZ3JhcGggYW5kIHVwZGF0ZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgcmVtb3ZlTm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnNwbGljZSh0aGlzR3JhcGgubm9kZXMuaW5kZXhPZihub2RlKSwgMSk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlKTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBBZGRzIHRoZSBsaW5rIHRvIHRoZSBncmFwaCBhbmQgdXBkYXRlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtsaW5rfSAgbGluayAgICBUaGUgbGlua1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBhZGRMaW5rKGxpbmspIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MucHVzaChsaW5rKTtcbiAgICAgICAgICAgICAgICBsaW5rLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyB0aGUgbGluayB0byB0aGUgZ3JhcGggYW5kIHVwZGF0ZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bGlua30gIGxpbmsgICAgVGhlIGxpbmtcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgcmVtb3ZlTGluayhsaW5rKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzLnNwbGljZSh0aGlzR3JhcGgubGlua3MuaW5kZXhPZihsaW5rKSwgMSk7XG4gICAgICAgICAgICAgICAgbGluay5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIHVwZGF0aW5nIGV4aXN0aW5nIHBhdGhzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BhdGh9ICBwYXRocyAgIExpc3Qgb2YgcGF0aHNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlRXhpc3RpbmdQYXRocyhwYXRocykge1xuICAgICAgICAgICAgICAgIHBhdGhzLmVhY2goZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICBkLnVwZGF0ZUF0dHIoZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgYWRkaW5nIG5ldyBwYXRoc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQYXRofSAgbmV3UGF0aHMgIExpc3Qgb2YgbmV3IHBhdGhzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHVwZGF0ZU5ld1BhdGhzKG5ld1BhdGhzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdExpbmtzKCk7XG5cbiAgICAgICAgICAgICAgICBuZXdQYXRocy5lYWNoKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5uZXdQYXRoQXR0cihkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy9pZiBub2RlIGRvZXNuJ3QgaGF2ZSBpdHMgb3duIHBvbGljeSwgdXNlIGRlZmF1bHQgZm9yIHRoZSBncmFwaFxuICAgICAgICAgICAgICAgIG5ld1BhdGhzLm9uKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZW92ZXJcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZW92ZXJcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcImRibGNsaWNrXCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQucGF0aFBvbGljeUV2ZW50KFwiZGJsY2xpY2tcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJkYmxjbGlja1wiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiY29udGV4dG1lbnVcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJjb250ZXh0bWVudVwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcImNvbnRleHRtZW51XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZW91dFwiLCBmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQucGF0aFBvbGljeUV2ZW50KFwibW91c2VvdXRcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZW91dFwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwibW91c2Vkb3duXCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZWRvd25cIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZWRvd25cIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcIm1vdXNldXBcIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnBhdGhQb2xpY3lFdmVudChcIm1vdXNldXBcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZXVwXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuY2FsbCh0aGlzR3JhcGguZHJhZyk7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgdXBkYXRpbmcgZXhpc3Rpbmcgbm9kZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlRXhpc3RpbmdOb2RlcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcyA9IHRoaXMuY2lyY2xlcy5kYXRhKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24oZCl7IHJldHVybiBkLmlkO30pXG4gICAgICAgICAgICAgICAgICAgIC5lYWNoKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQudXBkYXRlQXR0cihkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyBhZGRpbmcgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBuZXdOb2RlcyAgTGlzdCBvZiBuZXcgbm9kZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlTmV3Tm9kZXMobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgICAgIG5ld05vZGVzLmVhY2goZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5ncmFwaCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBkLm5ld05vZGVBdHRyKGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvL2lmIG5vZGUgZG9lc24ndCBoYXZlIGl0cyBvd24gcG9saWN5LCB1c2UgZGVmYXVsdCBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgICAgbmV3Tm9kZXMub24oXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlb3ZlclwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlb3ZlclwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiZGJsY2xpY2tcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5ub2RlUG9saWN5RXZlbnQoXCJkYmxjbGlja1wiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcImRibGNsaWNrXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJjb250ZXh0bWVudVwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcImNvbnRleHRtZW51XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwiY29udGV4dG1lbnVcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcIm1vdXNlb3V0XCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5ub2RlUG9saWN5RXZlbnQoXCJtb3VzZW91dFwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlb3V0XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlZG93blwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlZG93blwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwibW91c2V1cFwiLCBmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQubm9kZVBvbGljeUV2ZW50KFwibW91c2V1cFwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcIm1vdXNldXBcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5jYWxsKHRoaXNHcmFwaC5kcmFnKTtcblxuICAgICAgICAgICAgICAgIG5ld05vZGVzLmFwcGVuZChcImNpcmNsZVwiKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwiclwiLCBmdW5jdGlvbihkKSB7cmV0dXJuIFN0cmluZyhkLnJhZGl1cyl9KTtcblxuXG4gICAgICAgICAgICAgICAgbmV3Tm9kZXMuZWFjaChmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluc2VydFRpdGxlTGluZWJyZWFrcyhkMy5zZWxlY3QodGhpcyksIGQudGV4dCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUHJldmVudHMgbm9kZXMgZnJvbSBjb2xsaWRpbmdcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgYWxwaGEgICBBZmZlY3RzIGhvdyBtdWNoIGNoYW5nZVxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlIGNvbGxpc2lvbiBjYXVzZXNcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtib29sZWFufSAge1doZXRoZXIgbm9kZXMgYXJlIGNvbGxpZGVkfVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkM0ZvcmNlQ29sbGlkZShhbHBoYSkge1xuICAgICAgICAgICAgXHR2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgIFx0XHRjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzO1xuICAgICAgICAgICAgXHR2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICBcdHZhciBxdWFkdHJlZSA9IGQzLmdlb20ucXVhZHRyZWUobm9kZXMpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgciA9IGQucmFkaXVzICsgY29uc3RzLm1heFJhZGl1cyArIGNvbnN0cy5wYWRkaW5nLFxuICAgICAgICAgICAgICAgICAgICAgICAgbngxID0gZC54IC0gcixcbiAgICAgICAgICAgICAgICAgICAgICAgIG54MiA9IGQueCArIHIsXG4gICAgICAgICAgICAgICAgICAgICAgICBueTEgPSBkLnkgLSByLFxuICAgICAgICAgICAgICAgICAgICAgICAgbnkyID0gZC55ICsgcjtcbiAgICAgICAgICAgICAgICAgICAgcXVhZHRyZWUudmlzaXQoZnVuY3Rpb24ocXVhZCwgeDEsIHkxLCB4MiwgeTIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChxdWFkLnBvaW50ICYmIChxdWFkLnBvaW50ICE9PSBkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4ID0gZC54IC0gcXVhZC5wb2ludC54LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ID0gZC55IC0gcXVhZC5wb2ludC55LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsID0gTWF0aC5zcXJ0KHggKiB4ICsgeSAqIHkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByID0gZC5yYWRpdXMgKyBxdWFkLnBvaW50LnJhZGl1cyArIGNvbnN0cy5wYWRkaW5nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsIDwgcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbCA9IChsIC0gcikgLyBsICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnggLT0geCAqPSBsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55IC09IHkgKj0gbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1YWQucG9pbnQueCArPSB4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVhZC5wb2ludC55ICs9IHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB4MSA+IG54MiB8fCB4MiA8IG54MSB8fCB5MSA+IG55MiB8fCB5MiA8IG55MTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUaWNrIG9mIHRoZSBkMyBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzdGljayBldmVudH0gIGUgICAgRDN0aWNrIGV2ZW50XG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgd2lkdGggIFRoZSB3aWR0aCBvZiB0aGUgc2ltdWxhdGlvblxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge251bWJlcn0gIGhlaWdodCBUaGUgaGVpZ2h0IG9mIHRoZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGQzRm9yY2VUaWNrKGUsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgIFx0dmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICBcdFx0Y29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cztcblxuICAgICAgICAgICAgXHR2YXIgb2Zmc2V0ID0gY29uc3RzLmRpc3BsYXlPZmZzZXQ7XHRcbiAgICAgICAgICAgIFx0dmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgXHR2YXIgcSA9IGQzLmdlb20ucXVhZHRyZWUodGhpc0dyYXBoLm5vZGVzKSxcbiAgICAgICAgICAgICAgICAgICAgICBpID0gMCxcbiAgICAgICAgICAgICAgICAgICAgICBuID0gbm9kZXMubGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgICB3aGlsZSAoKytpIDwgbikge1xuICAgICAgICAgICAgICAgICAgICBxLnZpc2l0KHRoaXMuZDNGb3JjZUNvbGxpZGUobm9kZXNbaV0pKTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2godGhpcy5kM0ZvcmNlQ29sbGlkZSguNSkpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiY3hcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC54ID0gTWF0aC5tYXgoZC5yYWRpdXMgKyBvZmZzZXQsIE1hdGgubWluKHdpZHRoIC0gb2Zmc2V0IC0gZC5yYWRpdXMsIGQueCkpOyB9KVxuICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJjeVwiLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnkgPSBNYXRoLm1heChkLnJhZGl1cyArIG9mZnNldCwgTWF0aC5taW4oaGVpZ2h0IC0gb2Zmc2V0IC0gZC5yYWRpdXMsIGQueSkpOyB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoc1xuICAgICAgICAgICAgICAgICAgICAuYXR0cigneDEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS55OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneDInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC55OyB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTdGFydHMgb24gc3RhcnQgb2YgdGhlIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZVN0YXJ0KCkge1xuICAgICAgICAgICAgXHR2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHNcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueTsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueTsgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIG9uIHRoZSBlbmQgb2YgdGhlIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZUVuZCgpIHtcbiAgICAgICAgICAgIFx0dmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICBcdHRoaXNHcmFwaC5jaXJjbGVzXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjeCcsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2N5JywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC55OyB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocy5hdHRyKCd4MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLnk7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd4MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lnk7IH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGN1bGF0ZXMgdGhlIHdpZHRoIGFuZCBoZWlnaHQgYm91bmRzIGZvciB0aGUgXG4gICAgICAgICAgICAgKiBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHJldHVybiAgICAge09iamVjdH0gIHdpZHRoIGFuZCBoZWlnaHQgYXMgcHJvcGVydGllcyBcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZUJvdW5kcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnV2lkdGggPSAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLndpZHRoKCk7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z0hlaWdodCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykuaGVpZ2h0KCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBzdmdXaWR0aDtcbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gc3ZnSGVpZ2h0O1xuICAgICAgICAgICAgICAgIHJldHVybiB7d2lkdGg6d2lkdGgsIGhlaWdodDpoZWlnaHR9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIERvZXMgYSBkMyBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0Z1bmN0aW9ufSAgY2FsbGJhY2sgIFRoZSBjYWxsYmFja1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzZXRGb3JjZShjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgICAgIHZhciBsaW5rcyA9IHRoaXNHcmFwaC5saW5rcztcbiAgICAgICAgICAgICAgICBpZiAoXy5pc0VtcHR5KG5vZGVzKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGJvdW5kcyA9IHRoaXNHcmFwaC5kM0ZvcmNlQm91bmRzKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgZm9yY2UgPSBkMy5sYXlvdXQuZm9yY2UoKVxuICAgICAgICAgICAgICAgICAgICAuc2l6ZShbYm91bmRzLndpZHRoLCBib3VuZHMuaGVpZ2h0XSlcbiAgICAgICAgICAgICAgICAgICAgLm5vZGVzKG5vZGVzKVxuICAgICAgICAgICAgICAgICAgICAuY2hhcmdlKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtNjAwMDtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmxpbmtzKGxpbmtzKTtcblxuICAgICAgICAgICAgICAgIGZvcmNlLmxpbmtEaXN0YW5jZShib3VuZHMud2lkdGgvMyk7XG4gICAgICAgICAgICAgICAgZm9yY2UubGlua1N0cmVuZ3RoKC4yKTtcbiAgICAgICAgICAgICAgICBmb3JjZS5ncmF2aXR5KC4yKTtcblxuICAgICAgICAgICAgICAgIGZvcmNlLm9uKCd0aWNrJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgIFx0dGhpc0dyYXBoLmQzRm9yY2VUaWNrLmNhbGwodGhpc0dyYXBoLCBcbiAgICAgICAgICAgICAgICBcdFx0XHRlLCBib3VuZHMud2lkdGgsIGJvdW5kcy5oZWlnaHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZm9yY2Uub24oJ3N0YXJ0JywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgXHR0aGlzR3JhcGguZDNGb3JjZVN0YXJ0LmNhbGwodGhpc0dyYXBoKVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZm9yY2Uub24oJ2VuZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIFx0dGhpc0dyYXBoLmQzRm9yY2VFbmQuY2FsbCh0aGlzR3JhcGgpXG4gICAgICAgICAgICAgICAgfSk7IFxuXG5cbiAgICAgICAgICAgICAgICBmb3JjZS5zdGFydCgpO1xuICAgICAgICAgICAgICAgIHZhciBrID0gMDtcbiAgICAgICAgICAgICAgICB3aGlsZSAoKGZvcmNlLmFscGhhKCkgPiAxZS0yKSAmJiAoayA8IDE1MCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yY2UudGljaygpO1xuICAgICAgICAgICAgICAgICAgICBrID0gayArIDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvcmNlLnN0b3AoKTtcblxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjayAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgXHRjYWxsYmFjaygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTZXRzIHRoZSBwb3NpdGlvbnMgdG8gYmUgdGhlIGNlbnRlciBvZiB0aGUgc2NyZWVuIGlmIFxuICAgICAgICAgICAgICogbm90IHByb3ZpZGVkXG4gICAgICAgICAgICAgKiBhbHNvIHNldHMgdGhlIHJhZGl1cyBvZiB0aGUgbm9kZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc2V0UG9zaXRpb25zKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IHRoaXNHcmFwaC5jb25zdHMuZGlzcGxheU9mZnNldDtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnV2lkdGggPSAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLndpZHRoKCk7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z0hlaWdodCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykuaGVpZ2h0KCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBzdmdXaWR0aCAtICgyKm9mZnNldCk7XG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IHN2Z0hlaWdodCAtICgyKm9mZnNldCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVzW2ldLnJhZGl1cyA9IG5vZGVzW2ldLnJhZGl1cyB8fCB0aGlzR3JhcGguY29uc3RzLnN0YXJ0UmFkaXVzO1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZXNbaV0ueCA9PSBudWxsIHx8IG5vZGVzW2ldLnkgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm9kZXNbaV0ueFN0YXJ0ID0gd2lkdGgvMiAgKyBub2Rlc1tpXS5yYWRpdXMgKyBvZmZzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzW2ldLnggPSB3aWR0aC8yICArIG5vZGVzW2ldLnJhZGl1cyArIG9mZnNldDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5vZGVzW2ldLnlTdGFydCA9IGhlaWdodC8yICsgbm9kZXNbaV0ucmFkaXVzICsgb2Zmc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1tpXS55ID0gaGVpZ2h0LzIgKyBub2Rlc1tpXS5yYWRpdXMgKyBvZmZzZXRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgdG8gdXBkYXRlIHRoZSB2aWV3IG9mIHRoZSBncmFwaCB3aGVuXG4gICAgICAgICAgICAgKiBkYXRhIGNoYW5nZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RnVuY3Rpb259ICBjYWxsYmFjayAgVGhlIGNhbGxiYWNrXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHVwZGF0ZUdyYXBoKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlO1xuXG4gICAgICAgICAgICBcdGlmICh0aGlzR3JhcGguc3RhdGUuZGlzYWJsZVVwZGF0ZSkge1xuICAgICAgICAgICAgXHRcdHJldHVybjtcbiAgICAgICAgICAgIFx0fVxuXG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVFeGlzdGluZ05vZGVzKCk7XG4gICAgICAgICAgICAgICAgdmFyIG5ld0dzPSB0aGlzR3JhcGguY2lyY2xlcy5lbnRlcigpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJnXCIpO1xuXG4gICAgICAgICAgICBcdC8vIGNvbnNvbGUubG9nKCd1cGRhdGUnLCBuZXdHcyk7XG4gICAgICAgICAgICAgICAgbmV3R3MuY2xhc3NlZChjb25zdHMuY2lyY2xlR0NsYXNzLCB0cnVlKTtcbiAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIHRoaXMudXBkYXRlTmV3Tm9kZXMobmV3R3MpO1xuXG4gICAgICAgICAgICAgICAgLy8gcmVtb3ZlIG9sZCBub2Rlc1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmV4aXQoKS5yZW1vdmUoKTtcblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5pbml0Rm9yY2UgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNldEZvcmNlKGZ1bmN0aW9uKCkge1xuICAgIFx0ICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVOZXdOb2Rlcy5jYWxsKHRoaXNHcmFwaCwgbmV3R3MpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuaW5pdEZvcmNlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVOZXdOb2RlcyhuZXdHcyk7XG5cdCAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocyA9IHRoaXNHcmFwaC5wYXRocy5kYXRhKHRoaXNHcmFwaC5saW5rcywgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBTdHJpbmcoZC5zb3VyY2UuaWQpICsgXCIrXCIgKyBTdHJpbmcoZC50YXJnZXQuaWQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciBwYXRocyA9IHRoaXNHcmFwaC5wYXRocztcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUV4aXN0aW5nUGF0aHMocGF0aHMpO1xuXG4gICAgICAgICAgICAgICAgdmFyIG5ld3BhdGhzID0gcGF0aHMuZW50ZXIoKVxuICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJwYXRoXCIpXG4gICAgICAgICAgICAgICAgLnN0eWxlKCdtYXJrZXItZW5kJywndXJsKCNlbmQtYXJyb3cpJylcbiAgICAgICAgICAgICAgICAuY2xhc3NlZChcImxpbmtcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVOZXdQYXRocyhuZXdwYXRocyk7XG5cbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgb2xkIGxpbmtzXG4gICAgICAgICAgICAgICAgcGF0aHMuZXhpdCgpLnJlbW92ZSgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBcdGNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgR3JhcGg6IEdyYXBoXG4gICAgICAgIH1cbn1dKTtcblxuXG4iLCIvKipcbiAqIFRoZSBncmFwaCB0aGF0IGlzIHVzZWQgc3BlY2lmaWNhbGx5IGZvciB0aGUgdmlzdWFsaXphdGlvbiB0YWIuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdWaXN1YWxpemVyR3JhcGgnLCBbJ0dyYXBoJywgZnVuY3Rpb24gKEdyYXBoKSB7XG4gICAgXHRjbGFzcyBWaXN1YWxpemVyR3JhcGggZXh0ZW5kcyBHcmFwaC5HcmFwaCB7XG4gICAgXHRcdC8qKlxuICAgIFx0XHQgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgXHRcdCAqXG4gICAgXHRcdCAqIEBwYXJhbSAgIHtIVE1MIFNWR30gIHN2ZyAgICAgICAgICAgICBUaGUgc3ZnIHRoYXQgd2lsbCBcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob2xkIHRoZSBncmFwaFxuICAgICAgICAgICAgICogQHBhcmFtICAge0FycmF5fSAgbm9kZXMgICBcdFx0ICAgIExpc3Qgb2Ygbm9kZXNcbiAgICAgICAgICAgICAqIEBwYXJhbSAgIHtBcnJheX0gIGxpbmtzICAgXHRcdCAgICBMaXN0IG9mIGxpbmtzXG4gICAgXHRcdCAqIEBwYXJhbSAgIHtEYXRhU291cmNlfSAgZGF0YVNvdXJjZSAgICBUaGUgZGF0YSBzb3VyY2VcbiAgICBcdFx0ICovXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcihzdmcsIG5vZGVzLCBsaW5rcywgZGF0YVNvdXJjZSkge1xuICAgICAgICAgICAgICAgIHN1cGVyKHN2Zywgbm9kZXMsIGxpbmtzKTtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgICAgIC8vaG9sZHMgY3VycmVudCB0cmFuc2l0aW9ucyB0aGF0IGFyZSBvY2N1cmluZ1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZS50cmFuc2l0aW9uID0gW107XG4gICAgICAgICAgICAgICAgLy9NaW4gZGlzdGFuY2UgYmV0d2VlbiBub2RlcyB3aGVuIHNwYXduaW5nIHJhbmRvbWx5XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNvbnN0cy5lZGdlX2J1ZmZlciA9IDIwMDtcbiAgICAgICAgICAgICAgICAvL1NpemUgcmVkdWN0aW9uIGFzIHlvdSBnbyB0aHJvdWdoIGxldmVscyBpbiBub2Rlc1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jb25zdHMucmFkaXVzRGVjYXkgPSAxO1xuICAgICAgICAgICAgICAgIC8vQ3NzIGNsYXNzIGZvciBub2RlcyB0aGF0IGFyZSBjb250YWluZXJzXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNvbnN0cy5jb250YWluZXJDbGFzcyA9ICdjb250YWluZXInO1xuXG4gICAgICAgICAgICAgICAgLy9kYXRhU291cmNlIGhvbGRzIHRoZSBzZXJ2ZXIgZGF0YSBhbmQgbWV0aG9kcyBmb3JcbiAgICAgICAgICAgICAgICAvL2NvbnZlcnRpbmcgaXQgdG8gZGF0YSBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRhdGFTb3VyY2UgPSBkYXRhU291cmNlO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vRHJhZyBiZWhhdmlvciBmb3Igbm9kZXNcbiAgICAgICAgICAgICAgICB2YXIgZHJhZyA9IGQzLmJlaGF2aW9yLmRyYWcoKVxuICAgICAgICAgICAgICAgICAgICAub3JpZ2luKGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge3g6IGQueCwgeTogZC55fTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiZHJhZ3N0YXJ0XCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJkcmFnXCIsIGZ1bmN0aW9uKGFyZ3Mpe1xuICAgICAgICAgICAgICAgICAgICBcdGQzLnNlbGVjdCggdGhpcykuYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbiggZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCArPSBkMy5ldmVudC5keDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gZDMuZXZlbnQuZHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwidHJhbnNsYXRlKFwiICsgWyBkLngsZC55IF0gKyBcIilcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcdFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJkcmFnZW5kXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kcmFnID0gZHJhZztcblxuICAgICAgICAgICAgICAgIC8vUGFuIGFuZCBab29tIGJlaGF2aW9yIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAgICB2YXIgem9vbSA9IGQzLmJlaGF2aW9yLnpvb20oKVxuICAgICAgICAgICAgICAgICAgICAub24oXCJ6b29tXCIsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZDMuZXZlbnQuc291cmNlRXZlbnQgIT0gbnVsbCAmJiBkMy5ldmVudC5zb3VyY2VFdmVudC5jdHJsS2V5KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZC5jYWxsKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiem9vbXN0YXJ0XCIsIGZ1bmN0aW9uKGQsIGkpe1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguZHJhZ1N2ZyA9IHpvb207XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Zy5jYWxsKHpvb20pLm9uKFwiZGJsY2xpY2suem9vbVwiLCBudWxsKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2l0aCBubyBhcmdzIHdoZW4gdGhlIGdyYXBoIGhhcyBhIHpvb20gYWN0aW9uXG4gICAgICAgICAgICAgKiBDYW4gYWxzbyBiZSBjYWxsZWQgd2l0aCBhcmdzIHRvIGZvcmNlIGEgem9vbSBvciBwYW4gXG4gICAgICAgICAgICAgKiBldmVudCBmb3IgdGhlIGdyYXBoLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gICB0cmFuc2xhdGUgIFRoZSBhbW91bnQgdG8gdHJhbnNsYXRlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgc2NhbGUgICAgICBUaGUgYW1vdW50IHRvIHNjYWxlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHpvb21lZCh0cmFuc2xhdGUsIHNjYWxlKXtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLnN0YXRlLnJpZ2h0Q2xpY2sgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuanVzdFNjYWxlVHJhbnNHcmFwaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKHRyYW5zbGF0ZSAhPSBudWxsICYmIHNjYWxlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSB0aGlzR3JhcGguZHJhZ1N2ZztcbiAgICAgICAgICAgICAgICAgICAgem9vbS5zY2FsZShzY2FsZSk7XG4gICAgICAgICAgICAgICAgICAgIHpvb20udHJhbnNsYXRlKHRyYW5zbGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIC8vY3JlYXRpbmcgbmFtZXMgdG8gcHJldmVudCB0cmFuc2l0aW9uIGNvbmZsaWN0c1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbVNldENhbGxiYWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIFx0em9vbS5zY2FsZShzY2FsZSk7XG4gICAgICAgICAgICAgICAgICAgIFx0em9vbS50cmFuc2xhdGUodHJhbnNsYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zbGF0ZV9uYW1lID0gXCJ6b29tXCIgKyB0cmFuc2xhdGU7XG4gICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdChcIi5cIiArIHRoaXMuY29uc3RzLmdyYXBoQ2xhc3MpLnRyYW5zaXRpb24odHJhbnNsYXRlX25hbWUpLmRlbGF5KDEwMCkuZHVyYXRpb24oNzUwKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoJyArIHpvb20udHJhbnNsYXRlKCkgKyAnKSBzY2FsZSgnICsgem9vbS5zY2FsZSgpICsgJyknKS5lYWNoKFwiZW5kXCIsIHpvb21TZXRDYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGguc3RhdGUuY2FuWm9vbSkge1xuICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QoXCIuXCIgKyB0aGlzLmNvbnN0cy5ncmFwaENsYXNzKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKSArIFwiKSBzY2FsZShcIiArdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKSArIFwiKVwiKTsgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgd2luZG93IHJlc2l6ZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBTVkd9ICBzdmcgICAgVGhlIHN2ZyB0byByZXNpemVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgb25XaW5kb3dSZXNpemUoc3ZnKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJvZHlFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF07XG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykub2Zmc2V0KCk7XG4gICAgICAgICAgICAgICAgdmFyIGRpdldpZHRoID0gJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS53aWR0aCgpO1xuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBib2R5RWwuY2xpZW50SGVpZ2h0O1xuICAgICAgICAgICAgICAgIHN2Zy5hdHRyKFwid2lkdGhcIiwgZGl2V2lkdGgpLmF0dHIoXCJoZWlnaHRcIiwgaGVpZ2h0IC0gb2Zmc2V0LnRvcCAtIDIwKTtcblxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgc2VydmVyIHNlbmRzIHVwZGF0ZWQgZGF0YSBmb3IgdGhlIGxpbmtzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHVwZGF0ZUxpbmtEYXRhKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBub2RlX25hbWVzX3NldCA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpc0dyYXBoLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVfbmFtZXNfc2V0LnB1c2godGhpc0dyYXBoLm5vZGVzW2ldLmlkKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcmV0RGF0YSA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmdldEZsb3dCZXR3ZWVuU2V0KG5vZGVfbmFtZXNfc2V0KTtcbiAgICAgICAgICAgICAgICB2YXIgbGlua0RhdGEgPSByZXREYXRhLmxpbmtEYXRhO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YShsaW5rRGF0YSwgdGhpc0dyYXBoLm5vZGVzKTtcbiAgICAgICAgICAgICAgICB0aGlzLmluaXROb2RlcygpO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5pdExpbmtzKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIFxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIEdyYXBoOiBWaXN1YWxpemVyR3JhcGhcbiAgICAgICAgfVxufV0pO1xuXG5cblxuIiwiLyoqXG4gKiBUaGUgYmFzZSBjbGFzcyBmb3IgbGluayBvYmplY3RzIGZvciB0aGUgZ3JhcGguXG4gKiBTdXBwb3J0cyBwb2xpY2llcy5cbiAqIFxuICogVG8gd3JpdGUgeW91ciBvd24gbGluayBvYmplY3QsIGNyZWF0ZSBhIG5ldyBmYWN0b3J5IHRoYXQgdXNlcyB0aGUgbGlua1xuICogeW91IHdhbnQgdG8gaW5oZXJpdCBhcyBhIGRlcGVuZGVuY3ksIGFuZCBleHRlbmQgaXRzIGxpbmsgY2xhc3MuIFxuICogUmV0dXJuIHRoZSBjbGFzcyBvYmplY3Qgd2l0aCBMaW5rIGFzIGtleVxuICogXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdMaW5rJywgW2Z1bmN0aW9uICgpIHtcbiAgICBcdGNsYXNzIExpbmsge1xuICAgIFx0XHQvKipcbiAgICBcdFx0ICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgIFx0XHQgKlxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHNvdXJjZU5vZGUgIFRoZSBzb3VyY2Ugbm9kZVxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHRhcmdldE5vZGUgIFRoZSB0YXJnZXQgbm9kZVxuICAgIFx0XHQgKi9cblx0XHRcdGNvbnN0cnVjdG9yKHNvdXJjZU5vZGUsIHRhcmdldE5vZGUpIHtcblx0XHRcdFx0dGhpcy5zb3VyY2UgPSBzb3VyY2VOb2RlO1xuXHRcdFx0XHR0aGlzLnRhcmdldCA9IHRhcmdldE5vZGU7XG5cdFx0XHRcdHRoaXMuaGFzUG9saWN5ID0gZmFsc2U7XG5cdFx0XHRcdHRoaXMucGF0aFBvbGljaWVzID0gW107XG5cdFx0XHRcdHRoaXMuZ3JhcGggPSBudWxsO1xuXHRcdFx0XHR0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsbGVkIHdoZW4gYSBsaW5rIGlzIGFkZGVkIHRvIHRoZSBncmFwaFxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoIGl0IGlzIGFkZGVkIHRvXG5cdFx0XHQgKi9cblx0XHRcdGluaXRpYWxpemUoZ3JhcGgpIHtcblx0XHRcdFx0aWYgKHRoaXMuaW5pdGlhbGl6ZWQgPT0gZmFsc2UpIHtcblx0XHRcdFx0XHR0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcblx0XHRcdFx0XHR0aGlzLmdyYXBoID0gZ3JhcGg7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxsZWQgZHVyaW5nIHRoZSB1cGRhdGUgZ3JhcGggZm9yIGV4aXN0aW5nIGxpbmtzXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuXHRcdFx0ICogQHBhcmFtICAgICAge0xpbmt9ICBcdCAgIGQgICAgICAgTWF0Y2hpbmcgTGluayBPYmplY3QgICAgICAgXG5cdFx0XHQgKi9cblx0XHRcdHVwZGF0ZUF0dHIoZDNwYXRoLCBkKSB7XG5cdFx0XHRcdGQzcGF0aC5zdHlsZSgnbWFya2VyLWVuZCcsICd1cmwoI2VuZC1hcnJvdyknKVxuXHRcdCAgICAgICAgICAgIC5hdHRyKFwiZFwiLCBhcnJvd1BhdGgpO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCBkdXJpbmcgdGhlIGZpcnN0IHVwZGF0ZSBncmFwaCBmb3IgYSBsaW5rXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuXHRcdFx0ICogQHBhcmFtICAgICAge0xpbmt9ICBcdCAgIGQgICAgICAgTWF0Y2hpbmcgTGluayBPYmplY3QgICAgICAgXG5cdFx0XHQgKi9cblx0XHRcdG5ld1BhdGhBdHRyKGQzcGF0aCwgZCkge1xuXHRcdFx0XHRkM3BhdGguYXR0cignZCcsIGFycm93UGF0aCk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsY3VsYXRlcyB0aGUgYXJyb3cgcGF0aFxuXHRcdFx0ICpcblx0XHRcdCAqIEByZXR1cm4gICAgIHtzdHJpbmd9ICBUaGUgcGF0aCB0byBkcmF3XG5cdFx0XHQgKi9cblx0XHQgICAgYXJyb3dQYXRoKCkge1xuXHRcdCAgICBcdHZhciBkID0gdGhpcztcblx0XHQgICAgICAgIHZhciBkeCA9IGQudGFyZ2V0LnggLSBkLnNvdXJjZS54LFxuXHRcdCAgICAgICAgICAgIGR5ID0gZC50YXJnZXQueSAtIGQuc291cmNlLnksXG5cdFx0ICAgICAgICAgICAgZHIgPSBNYXRoLnNxcnQoZHggKiBkeCArIGR5ICogZHkpO1xuXHRcdCAgICAgICAgcmV0dXJuIFwiTVwiICsgZC5zb3VyY2UueCArIFwiLFwiICsgZC5zb3VyY2UueSArIFwiQVwiICsgZHIgKyBcIixcIiArIGRyICsgXCIgMCAwLDEgXCIgKyBkLnRhcmdldC54ICsgXCIsXCIgKyBkLnRhcmdldC55O1xuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIFVzZWQgdG8gaW5zdGFsbCBwb2xpY2llcyB0aGF0IGFyZSBjYWxsZWQgd2hlbiB0aGlzXG5cdFx0ICAgICAqIGxpbmsgaGFzIGEgbW91c2UgZXZlbnRcblx0XHQgICAgICpcblx0XHQgICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeSAgVGhlIHBvbGljeSB0byBpbnN0YWxsXG5cdFx0ICAgICAqL1xuXHRcdFx0aW5zdGFsbFBhdGhQb2xpY3kocG9saWN5KSB7XG5cdFx0XHRcdHRoaXMuaGFzUG9saWN5ID0gdHJ1ZTtcblx0XHRcdFx0dGhpcy5wYXRoUG9saWNpZXMucHVzaChwb2xpY3kpO1xuXHRcdFx0XHRwb2xpY3kuaW5pdGlhbGl6ZSh0aGlzLmdyYXBoKTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBVc2VkIHRvIHVuaW5zdGFsbCBwb2xpY3kgZm9yIHRoaXMgbGlua1xuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3lSZW1vdmUgIFRoZSBwb2xpY3kgdG8gcmVtb3ZlXG5cdFx0XHQgKi9cblx0XHRcdHVuaW5zdGFsbFBhdGhQb2xpY3kocG9saWN5UmVtb3ZlKSB7XG5cdFx0XHRcdHZhciBwb2xpY3lSZW1vdmVOYW1lO1xuXHRcdFx0XHR2YXIgdGhpc1BhdGggPSB0aGlzO1xuXHRcdFx0XHRpZiAodHlwZW9mIHBvbGljeVJlbW92ZSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHRwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmUucG9saWN5TmFtZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRfKHRoaXNQYXRoLnBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3ksIGluZGV4KSB7XG5cdFx0XHRcdFx0aWYgKHBvbGljeS5wb2xpY3lOYW1lID09PSBwb2xpY3lSZW1vdmVOYW1lKSB7XG5cdFx0XHRcdFx0XHRwb2xpY3kuZGVzdHJveSgpO1xuXHRcdFx0XHRcdFx0dGhpc1BhdGgucGF0aFBvbGljaWVzLnNwbGljZShpbmRleCwgMSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdFx0aWYgKHRoaXNQYXRoLnBhdGhQb2xpY2llcy5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0XHR0aGlzUGF0aC5oYXNQb2xpY3kgPSBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCB3aGVuIHRoZXJlIGlzIGEgbW91c2UgZXZlbnQgZm9yIHRoaXMgcGF0aFxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBldmVudCAgICAgVGhlIG1vdXNlIGV2ZW50XG5cdFx0XHQgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM3BhdGggIFRoZSBkMyBwYXRoXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgZCAgICAgICAgIFRoZSBtYXRjaGluZyBsaW5rIG9iamVjdFxuXHRcdFx0ICovXG5cdFx0XHRwYXRoUG9saWN5RXZlbnQoZXZlbnQsIGQzcGF0aCwgZCkge1xuXHRcdFx0XHRfKGQucGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSkge1xuXHRcdFx0XHRcdHBvbGljeVtldmVudF0oZDNwYXRoLCBkKTtcblx0XHRcdFx0fSlcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHtcblx0XHRcdExpbms6IExpbmtcblx0XHR9XG59XSk7XG5cblxuXG5cblxuXG4iLCIvKipcbiAqIFRoZSBsaW5rIHRoYXQgaXMgdXNlZCBzcGVjaWZpY2FsbHkgZm9yIHRoZSB2aXN1YWxpemF0aW9uIHRhYi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ1Zpc3VhbGl6ZXJMaW5rJywgWydMaW5rJywgZnVuY3Rpb24gKExpbmspIHtcblx0XHRjbGFzcyBWaXN1YWxpemVyTGluayBleHRlbmRzIExpbmsuTGluayB7XG5cdFx0XHQvKipcblx0XHRcdCAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHNvdXJjZU5vZGUgIFRoZSBzb3VyY2Ugbm9kZVxuXHRcdFx0ICogQHBhcmFtICAgICAge05vZGV9ICB0YXJnZXROb2RlICBUaGUgdGFyZ2V0IG5vZGVcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB3ZWlnaHQgICAgVGhlIHdlaWdodCBvZiB0aGUgbGlua1xuXHRcdFx0ICovXG5cdFx0ICAgIGNvbnN0cnVjdG9yKHNvdXJjZU5vZGUsIHRhcmdldE5vZGUsIHdlaWdodCkge1xuXHRcdCAgICAgICAgc3VwZXIoc291cmNlTm9kZSwgdGFyZ2V0Tm9kZSk7XG5cdFx0ICAgICAgICB0aGlzLndlaWdodCA9IHdlaWdodDtcblx0XHQgICAgICAgIC8vQ291bnQgaXMgdXNlZCB0byBrZWVwIHRyYWNrIG9mIGhvdyBtYW55XG5cdFx0ICAgICAgICAvL3BhdGhzIHRvIGl0cyBzdWJub2RlcyB0aGVyZSBhcmVcblx0XHQgICAgICAgIC8vaW4gb3JkZXIgdG8gY2FsY3VsYXRlIGF2ZXJhZ2UgdHJhZmZpY1xuXHRcdCAgICAgICAgdGhpcy5jb3VudCA9IDE7XG5cdFx0ICAgIH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogSW5jcmVhc2VzIHRoZSBjb3VudCBvZiB0aGUgbGlua1xuXHRcdCAgICAgKiBVU2VkIHRvIGtlZXAgdHJhY2sgb2YgaG93IG1hbnkgcGF0aHMgdG8gaXRzIHN1Ym5vZGVzXG5cdFx0ICAgICAqIHRoZXJlIGFyZSBpbiBvcmRlciB0byBjYWxjdWxhdGUgYXZlcmFnZSB0cmFmZmljXG5cdFx0ICAgICAqL1xuXHRcdCAgICBpbmNyZWFzZUNvdW50KCkge1xuXHRcdCAgICAgICAgdGhpcy5jb3VudCArPSAxO1xuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIENhbGN1bGF0ZXMgd2hlcmUgdG8gcGxhY2UgcXRpcCBmb3Jcblx0XHQgICAgICpcblx0XHQgICAgICogQHJldHVybiAgICAge09iamVjdH0gIE9iamVjdCB3aXRoIHFUaXAgc2V0dGluZ3Ncblx0XHQgICAgICovXG5cdFx0ICAgIHF0aXBIZWxwZXIoKSB7XG5cdFx0ICAgIFx0dmFyIHJldDtcblx0XHQgICAgXHR2YXIgZCA9IHRoaXM7XG5cdFx0ICAgIFx0dmFyIGR4ID0gKGQudGFyZ2V0LnggLSBkLnNvdXJjZS54KSAvIDIsXG5cdFx0ICAgICAgICAgICAgZHkgPSAoZC50YXJnZXQueSAtIGQuc291cmNlLnkpIC8gMjtcblx0XHQgICAgXHRpZiAoZC5zb3VyY2UueCA8IGQudGFyZ2V0LngpIHtcblx0ICAgIFx0XHRcdHJldCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG15OiAndG9wIGNlbnRlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICBhdDogJ2NlbnRlciBjZW50ZXInLCAvLyBhdCB0aGUgYm90dG9tIHJpZ2h0IG9mLi4uXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IFtkeCwgZHldLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWRqdXN0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcdHk6IDEwXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblx0XHQgICAgXHR9IGVsc2Uge1xuXHQgICAgXHRcdFx0cmV0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbXk6ICdib3R0b20gY2VudGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0OiAnY2VudGVyIGNlbnRlcicsIC8vIGF0IHRoZSBib3R0b20gcmlnaHQgb2YuLi5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogW2R4LCBkeV0sXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGp1c3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFx0eTogLTEwXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblx0XHQgICAgXHR9XG5cdFx0ICAgIFx0cmV0dXJuIHJldDtcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdFx0ICogQ2FsbGVkIHdoZW4gYSBsaW5rIGlzIGFkZGVkIHRvIHRoZSBncmFwaFxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoIGl0IGlzIGFkZGVkIHRvXG5cdFx0XHQgKi9cblx0XHRcdGluaXRpYWxpemUoZ3JhcGgpIHtcblx0XHRcdFx0aWYgKHRoaXMuaW5pdGlhbGl6ZWQgPT0gZmFsc2UpIHtcblx0XHRcdFx0XHRzdXBlci5pbml0aWFsaXplKGdyYXBoKTtcblx0XHRcdFx0XHR2YXIgc3RhdGUgPSBncmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluaztcblx0XHRcdFx0XHRpZiAoc3RhdGUgPT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0c3RhdGUgPSBncmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluayA9IHt9O1xuXHRcdFx0XHRcdFx0c3RhdGUubWF4V2VpZ2h0ID0gbnVsbDtcblx0XHRcdFx0XHRcdHN0YXRlLnVzZUF2Z1dlaWdodCA9IHRydWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHRoaXMudXBkYXRlTWF4V2VpZ2h0KCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBTZXRzIHdoZXRoZXIgdGhlIGdyYXBoIHNob3VsZCB1c2UgYXZnIHdlaWdodFxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtib29sZWFufSAgdmFsICAgICBUaGUgdmFsdWUgdG8gc2V0IHRvXG5cdFx0XHQgKi9cblx0XHRcdHNldFVzZUF2Z1dlaWdodCh2YWwpIHtcblx0XHQgICAgICAgIHRoaXMuZ3JhcGguc3RhdGUuVmlzdWFsaXplckxpbmsudXNlQXZnV2VpZ2h0ID0gISF2YWw7XG5cdFx0ICAgIH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogU2V0cyB0aGUgd2VpZ2h0IG9mIHRoaXMgbGlua1xuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgd2VpZ2h0ICBUaGUgd2VpZ2h0IHRvIHNldCB0b1xuXHRcdCAgICAgKi9cblx0XHQgICAgc2V0V2VpZ2h0KHdlaWdodCkge1xuXHRcdCAgICAgICAgdGhpcy53ZWlnaHQgPSB3ZWlnaHQ7XG5cdFx0ICAgIH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogR2V0cyB0aGUgcmF3IHdlaWdodC5cblx0XHQgICAgICpcblx0XHQgICAgICogQHJldHVybiAgICAge251bWJlcn0gIFRoZSByYXcgd2VpZ2h0LlxuXHRcdCAgICAgKi9cblx0XHQgICAgZ2V0UmF3V2VpZ2h0KCkge1xuXHRcdCAgICAgICAgcmV0dXJuIHRoaXMud2VpZ2h0OyBcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBHZXRzIHRoZSB3ZWlnaHQgdmFsdWUgb2YgdGhlIGxpbmssIGRlcGVuZGluZyBvbiB0aGVcblx0XHQgICAgICogdXNlQXZnV2VpZ3RoIHNldHRpbmdcblx0XHQgICAgICpcblx0XHQgICAgICogQHJldHVybiAgICAge251bWJlcn0gIFRoZSB3ZWlnaHQuXG5cdFx0ICAgICAqL1xuXHRcdCAgICBnZXRXZWlnaHQoKSB7XG5cdFx0ICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcblx0XHQgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluaztcblxuXHRcdCAgICAgICAgaWYgKHN0YXRlLnVzZUF2Z1dlaWdodCkge1xuXHRcdCAgICAgICAgICAgIHZhciB3ZWlnaHQgPSB0aGlzLndlaWdodCAvIHRoaXMuY291bnQ7XG5cdFx0ICAgICAgICAgICAgcmV0dXJuIHdlaWdodDtcblx0XHQgICAgICAgIH1cblx0XHQgICAgICAgIHJldHVybiB0aGlzLndlaWdodDtcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBVcGRhdGVzIHRoZSBtYXggd2VpZ2h0IG9mIHRoZSBncmFwaFxuXHRcdCAgICAgKi9cblx0XHQgICAgdXBkYXRlTWF4V2VpZ2h0ICgpIHtcblx0XHQgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuXHRcdCAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXG5cdFx0ICAgICAgICB2YXIgbWF4TGluayA9IF8ubWF4QnkodGhpc0dyYXBoLmxpbmtzLCBmdW5jdGlvbihsKSB7XG5cdFx0ICAgICAgICBcdGlmIChsLmdyYXBoICE9IG51bGwpIHtcblx0XHRcdFx0XHRcdHJldHVybiBsLmdldFdlaWdodCgpO1xuXHRcdCAgICAgICAgXHR9XG5cdFx0ICAgICAgICBcdHJldHVybiAwO1xuXHRcdCAgICAgICAgfSk7XG5cdFx0ICAgICAgICBzdGF0ZS5tYXhXZWlnaHQgPSBtYXhMaW5rLmdldFdlaWdodCgpO1xuXHRcdCAgICB9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsbGVkIGR1cmluZyB0aGUgdXBkYXRlIGdyYXBoIGZvciBleGlzdGluZyBsaW5rc1xuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzcGF0aCAgVGhlIGQzIHBhdGhcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtMaW5rfSAgXHQgICBkICAgICAgIE1hdGNoaW5nIExpbmsgT2JqZWN0ICAgICAgIFxuXHRcdFx0ICovXG5cdFx0XHR1cGRhdGVBdHRyKGQzcGF0aCwgZCkge1xuXHRcdCAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG5cdFx0ICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuVmlzdWFsaXplckxpbms7XG5cdFx0ICAgICAgICB0aGlzLnVwZGF0ZU1heFdlaWdodCgpO1xuXHQgICAgICAgICAgICB2YXIgY29sb3JTY2FsZSA9IGQzLnNjYWxlLmxpbmVhcigpXG5cdCAgICAgICAgICAgICAgICAuZG9tYWluKFswLCBzdGF0ZS5tYXhXZWlnaHRdKVxuXHQgICAgICAgICAgICAgICAgLnJhbmdlKFtcIiNmZmIzNjZcIiwgXCIjRjkyNjA2XCJdKTtcblx0ICAgICAgICAgICAgc3RhdGUuY29sb3JTY2FsZSA9IGNvbG9yU2NhbGU7XG5cdFx0XHRcdGQzcGF0aC5zdHlsZSgnbWFya2VyLWVuZCcsICd1cmwoI2VuZC1hcnJvdyknKVxuXHRcdCAgICAgICAgICAgIC5jbGFzc2VkKHRoaXNHcmFwaC5jb25zdHMuc2VsZWN0ZWRDbGFzcywgZnVuY3Rpb24oZCl7XG5cdFx0ICAgICAgICAgICAgICAgIHJldHVybiBkID09PSBzdGF0ZS5zZWxlY3RlZEVkZ2U7XG5cdFx0ICAgICAgICAgICAgfSlcblx0XHQgICAgICAgICAgICAuYXR0cihcImRcIiwgdGhpcy5hcnJvd1BhdGguY2FsbChkKSlcblx0XHQgICAgICAgICAgICAudHJhbnNpdGlvbihcImV4aXN0aW5nUGF0aFRyYW5zaXRpb25cIilcblx0XHQgICAgICAgICAgICAuZHVyYXRpb24oNzUwKVxuXHRcdCAgICAgICAgICAgIC5hdHRyKFwic3Ryb2tlXCIsIGZ1bmN0aW9uKGQpe1xuXHRcdCAgICAgICAgICAgICAgICB2YXIgYyA9IGNvbG9yU2NhbGUoZC5nZXRXZWlnaHQoKSk7XG5cdFx0ICAgICAgICAgICAgICAgIHJldHVybiBjO1xuXHRcdCAgICAgICAgICAgIH0pO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCBkdXJpbmcgdGhlIGZpcnN0IHVwZGF0ZSBncmFwaCBmb3IgdGhpcyBsaW5rXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuXHRcdFx0ICogQHBhcmFtICAgICAge0xpbmt9ICBcdCAgIGQgICAgICAgTWF0Y2hpbmcgTGluayBPYmplY3Rcblx0XHRcdCAqL1xuXHRcdFx0bmV3UGF0aEF0dHIoZDNwYXRoLCBkKSB7XG5cdFx0ICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcblx0XHQgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluaztcblx0ICAgICAgICAgICAgdGhpcy51cGRhdGVNYXhXZWlnaHQoKTtcblx0ICAgICAgICAgICAgdmFyIGNvbG9yU2NhbGUgPSBkMy5zY2FsZS5saW5lYXIoKVxuXHQgICAgICAgICAgICAgICAgLmRvbWFpbihbMCwgc3RhdGUubWF4V2VpZ2h0XSlcblx0ICAgICAgICAgICAgICAgIC5yYW5nZShbXCIjZmZiMzY2XCIsIFwiI0Y5MjYwNlwiXSk7XG5cdCAgICAgICAgICAgICAgICBcblx0XHRcdFx0ZDNwYXRoLnRyYW5zaXRpb24oXCJuZXdQYXRoVHJhbnNpdGlvblwiKVxuXHRcdCAgICAgICAgICAgIC5kdXJhdGlvbig3NTApXG5cdFx0ICAgICAgICAgICAgLmF0dHJUd2VlbihcIm9wYWNpdHlcIiwgZnVuY3Rpb24oZCkge1xuXHRcdCAgICAgICAgICAgICAgICByZXR1cm4gZDMuaW50ZXJwb2xhdGVTdHJpbmcoMCwxKTtcblx0XHQgICAgICAgICAgICB9KVxuXHRcdCAgICAgICAgICAgIC5hdHRyKFwic3Ryb2tlXCIsIGZ1bmN0aW9uKGQpe1xuXHRcdCAgICAgICAgICAgICAgICB2YXIgYyA9IGNvbG9yU2NhbGUoZC5nZXRXZWlnaHQoKSk7XG5cdFx0ICAgICAgICAgICAgICAgIHJldHVybiBjO1xuXHRcdCAgICAgICAgICAgIH0pXG5cdFx0ICAgICAgICAgICAgLmF0dHIoJ2QnLCB0aGlzLmFycm93UGF0aC5jYWxsKGQpKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0TGluayA6IFZpc3VhbGl6ZXJMaW5rXG5cdFx0fVxufV0pO1xuXG5cblxuXG5cbiIsIi8qKlxuICogVGhlIGJhc2UgY2xhc3MgZm9yIG5vZGUgb2JqZWN0cyBmb3IgdGhlIGdyYXBoLlxuICogU3VwcG9ydHMgcG9saWNpZXMuXG4gKiBcbiAqIFRvIHdyaXRlIHlvdXIgb3duIE5vZGUgb2JqZWN0LCBjcmVhdGUgYSBuZXcgZmFjdG9yeSB0aGF0IHVzZXMgdGhlIG5vZGVcbiAqIHlvdSB3YW50IHRvIGluaGVyaXQgYXMgYSBkZXBlbmRlbmN5LCBhbmQgZXh0ZW5kIGl0cyBub2RlIGNsYXNzLiBcbiAqIFJldHVybiB0aGUgY2xhc3Mgb2JqZWN0IHdpdGggTm9kZSBhcyBrZXlcbiAqIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnTm9kZScsIFtmdW5jdGlvbiAoKSB7XG5cdFx0Y2xhc3MgTm9kZSB7XG5cdFx0XHQvKipcblx0XHRcdCAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeCAgICAgICB4IGxvY2F0aW9uXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeSAgICAgICB5IGxvY2F0aW9uXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgaWQgICAgICBUaGUgaWRlbnRpZmllclxuXHRcdFx0ICogQHBhcmFtICAgICAge3N0cmluZ30gIHRleHQgICAgVGhlIHRleHQgdG8gZGlzcGxheVxuXHRcdFx0ICogQHBhcmFtICAgICAge251bWJlcn0gIHJhZGl1cyAgVGhlIHJhZGl1cyBvZiB0aGUgbm9kZVxuXHRcdFx0ICovXG5cdFx0XHRjb25zdHJ1Y3Rvcih4LCB5LCBpZCwgdGV4dCwgcmFkaXVzKSB7XG5cdFx0XHRcdHRoaXMueCA9IHg7XG5cdFx0XHRcdHRoaXMueSA9IHk7XG5cdFx0XHRcdHRoaXMucmFkaXVzID0gcmFkaXVzO1xuXHRcdFx0XHR0aGlzLmlkID0gaWQ7XG5cdFx0XHRcdHRoaXMudGV4dCA9IHRleHQ7XG5cdFx0XHRcdHRoaXMucmFkaXVzID0gcmFkaXVzO1xuXHRcdFx0XHR0aGlzLmhhc1BvbGljeSA9IGZhbHNlO1xuXHRcdFx0XHR0aGlzLnBvbGljeSA9IG51bGw7XG5cdFx0XHRcdHRoaXMubm9kZVBvbGljaWVzID0gW107XG5cdFx0XHRcdHRoaXMuZ3JhcGggPSBudWxsO1xuXHRcdFx0XHR0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsbGVkIHdoZW4gYSBub2RlIGlzIGFkZGVkIHRvIHRoZSBncmFwaFxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoIGl0IGlzIGFkZGVkIHRvXG5cdFx0XHQgKi9cblx0XHRcdGluaXRpYWxpemUoZ3JhcGgpIHtcblx0XHRcdFx0aWYgKHRoaXMuaW5pdGlhbGl6ZWQgPT0gZmFsc2UpIHtcblx0XHRcdFx0XHR0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcblx0XHRcdFx0XHR0aGlzLmdyYXBoID0gZ3JhcGg7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxsZWQgZHVyaW5nIHRoZSB1cGRhdGUgZ3JhcGggZm9yIGV4aXN0aW5nIGxpbmtzXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuXHRcdFx0ICovXG5cdFx0XHR1cGRhdGVBdHRyKGQzbm9kZSwgZCkge1xuXHRcdFx0XHRkM25vZGUuYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbihkKXtyZXR1cm4gXCJ0cmFuc2xhdGUoXCIgKyBkLnggKyBcIixcIiArIGQueSArIFwiKVwiO30pO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCBkdXJpbmcgdGhlIGZpcnN0IHVwZGF0ZSBncmFwaCBmb3IgYSBub2RlXG5cdFx0XHQgKiBIb29rIGZvciBzdWIgY2xhc3Nlc1xuXHRcdFx0ICogXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7Tm9kZX0gICAgICBkICAgICAgIE1hdGNoaW5nIE5vZGUgT2JqZWN0XG5cdFx0XHQgKi9cblx0XHRcdG5ld05vZGVBdHRyKGQzbm9kZSwgZCkge1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFNldHMgdGhlIHJhZGl1cyBvZiB0aGUgbm9kZS5cblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgcmFkaXVzICBUaGUgcmFkaXVzXG5cdFx0XHQgKi9cblx0XHRcdHNldFJhZGl1cyhyYWRpdXMpIHtcblx0XHRcdFx0dGhpcy5yYWRpdXMgPSByYWRpdXM7XG5cdFx0XHR9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIFVzZWQgdG8gaW5zdGFsbCBwb2xpY2llcyB0aGF0IGFyZSBjYWxsZWQgd2hlbiB0aGlzXG5cdFx0ICAgICAqIG5vZGUgaGFzIGEgbW91c2UgZXZlbnRcblx0XHQgICAgICpcblx0XHQgICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeSAgVGhlIHBvbGljeSB0byBpbnN0YWxsXG5cdFx0ICAgICAqL1xuXHRcdFx0aW5zdGFsbE5vZGVQb2xpY3kocG9saWN5KSB7XG5cdFx0XHRcdHRoaXMuaGFzUG9saWN5ID0gdHJ1ZTtcblx0XHRcdFx0dGhpcy5ub2RlUG9saWNpZXMucHVzaChwb2xpY3kpO1xuXHRcdFx0XHRwb2xpY3kuaW5pdGlhbGl6ZSh0aGlzLmdyYXBoKTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBVc2VkIHRvIHVuaW5zdGFsbCBwb2xpY3kgZm9yIHRoaXMgbm9kZVxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtQb2xpY3l8c3RyaW5nfSAgcG9saWN5UmVtb3ZlICBUaGUgcG9saWN5IHRvIHJlbW92ZVxuXHRcdFx0ICovXHRcdFx0XG5cdFx0XHR1bmluc3RhbGxOb2RlUG9saWN5KHBvbGljeVJlbW92ZSkge1xuXHRcdFx0XHR2YXIgcG9saWN5UmVtb3ZlTmFtZTtcblx0XHRcdFx0dmFyIHRoaXNOb2RlID0gdGhpcztcblx0XHRcdFx0aWYgKHR5cGVvZiBwb2xpY3lSZW1vdmUgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0cG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlLnBvbGljeU5hbWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0Xyh0aGlzTm9kZS5ub2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5LCBpbmRleCkge1xuXHRcdFx0XHRcdGlmIChwb2xpY3kucG9saWN5TmFtZSA9PT0gcG9saWN5UmVtb3ZlTmFtZSkge1xuXHRcdFx0XHRcdFx0cG9saWN5LmRlc3Ryb3koKTtcblx0XHRcdFx0XHRcdHRoaXNOb2RlLm5vZGVQb2xpY2llcy5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHRcdGlmICh0aGlzTm9kZS5ub2RlUG9saWNpZXMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdFx0dGhpc05vZGUuaGFzUG9saWN5ID0gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxsZWQgd2hlbiB0aGVyZSBpcyBhIG1vdXNlIGV2ZW50IGZvciB0aGlzIG5vZGVcblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgZXZlbnQgICAgIFRoZSBtb3VzZSBldmVudFxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuXHRcdFx0ICogQHBhcmFtICAgICAge09iamVjdH0gIGQgICAgICAgICBUaGUgbWF0Y2hpbmcgbm9kZSBvYmplY3Rcblx0XHRcdCAqL1xuXHRcdFx0bm9kZVBvbGljeUV2ZW50KGV2ZW50LCBkM25vZGUsIGQpIHtcblx0XHRcdFx0Xy5mb3JFYWNoKHRoaXMubm9kZVBvbGljaWVzLCBmdW5jdGlvbihwb2xpY3kpIHtcblx0XHRcdFx0XHRwb2xpY3lbZXZlbnRdKGQzbm9kZSwgZCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4ge1xuXHRcdFx0Tm9kZTogTm9kZVxuXHRcdH1cbn1dKTtcblxuXG5cblxuXG5cblxuIiwiLyoqXG4gKiBUaGUgbm9kZSB0aGF0IGlzIHVzZWQgc3BlY2lmaWNhbGx5IGZvciB0aGUgdmlzdWFsaXphdGlvbiB0YWIuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdWaXN1YWxpemVyTm9kZScsIFsnTm9kZScsIGZ1bmN0aW9uIChOb2RlKSB7XG5cdFx0Y2xhc3MgVmlzdWFsaXplck5vZGUgZXh0ZW5kcyBOb2RlLk5vZGUge1xuXHRcdFx0LyoqXG5cdFx0XHQgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge251bWJlcn0gIHggICAgICAgXHR4IGxvY2F0aW9uXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeSAgICAgICBcdHkgbG9jYXRpb25cblx0XHRcdCAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBpZCAgICAgIFx0VGhlIGlkZW50aWZpZXJcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICB0ZXh0ICAgIFx0VGhlIHRleHQgdG8gZGlzcGxheVxuXHRcdFx0ICogQHBhcmFtICAgICAge251bWJlcn0gIHJhZGl1cyAgXHRUaGUgcmFkaXVzIG9mIHRoZSBub2RlXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgcGFyZW50ICAgICBUaGUgcGFyZW50IGlkXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgYW5jZXN0b3JzICBBcnJheSBvZiBhbmNlc3RvcnMgSWRcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB4U3RhcnQgICAgIHggbG9jIHRvIHN0YXJ0IGFuaW1hdGlvblxuXHRcdFx0ICogQHBhcmFtICAgICAge251bWJlcn0gIHlTdGFydCAgICAgeSBsb2MgdG8gc3RhcnQgYW5pbWF0aW9uXG5cdFx0XHQgKi9cblx0XHQgICAgY29uc3RydWN0b3IoeCwgeSwgaWQsIHRleHQsIHJhZGl1cywgcGFyZW50LCBhbmNlc3RvcnMsIFxuXHRcdCAgICBcdHhTdGFydCwgeVN0YXJ0KSB7XG5cdFx0ICAgICAgICBzdXBlcih4LCB5LCBpZCwgdGV4dCwgcmFkaXVzKTtcblx0XHQgICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuXHRcdCAgICAgICAgdGhpcy5hbmNlc3RvcnMgPSBhbmNlc3RvcnM7XG5cdFx0ICAgICAgICBpZiAoeFN0YXJ0ID09IG51bGwpIHtcblx0XHQgICAgICAgIFx0dGhpcy54U3RhcnQgPSB4O1xuXHRcdCAgICAgICAgfSBlbHNlIHtcblx0XHQgICAgICAgIFx0dGhpcy54U3RhcnQgPSB4U3RhcnQ7XG5cdFx0ICAgICAgICB9XG5cdFx0ICAgICAgICBpZiAoeVN0YXJ0ID09IG51bGwpIHtcblx0XHQgICAgICAgIFx0dGhpcy55U3RhcnQgPSB5O1xuXHRcdCAgICAgICAgfSBlbHNlIHtcblx0XHQgICAgICAgIFx0dGhpcy55U3RhcnQgPSB5U3RhcnQ7XG5cdFx0ICAgICAgICB9XG5cdFx0ICAgIH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxsZWQgZHVyaW5nIHRoZSBmaXJzdCB1cGRhdGUgZ3JhcGggZm9yIGEgbm9kZVxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICBkICAgICAgICAgVGhlIG1hdGNoaW5nIE5vZGVcblx0XHRcdCAqL1xuXHRcdFx0bmV3Tm9kZUF0dHIoZDNub2RlLCBkKSB7XG5cdFx0XHRcdHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoO1xuXHRcdFx0XHRpZiAodGhpc0dyYXBoLmNvbnN0cy5jb250YWluZXJDbGFzcyAhPSBudWxsICYmXG5cdFx0XHRcdFx0XHR0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbZC5pZF0gPT0gbnVsbCkge1xuXHRcdFx0XHRcdGQzbm9kZS5jbGFzc2VkKHRoaXNHcmFwaC5jb25zdHMuY29udGFpbmVyQ2xhc3MsIHRydWUpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGQzbm9kZS50cmFuc2l0aW9uKFwibm9kZVBvc2l0aW9uVHJhbnNpdGlvblwiKVxuXHRcdCAgICAgICAgICAgICAgICAuZHVyYXRpb24oNzUwKVxuXHRcdCAgICAgICAgICAgICAgICAuYXR0clR3ZWVuKFwidHJhbnNmb3JtXCIsIGZ1bmN0aW9uKGQpIHtcblx0XHQgICAgICAgICAgICAgICAgICAgIGlmIChkLnhTdGFydCAhPSBudWxsICYmIGQueVN0YXJ0ICE9IG51bGwpIHtcblx0XHQgICAgICAgICAgICAgICAgICAgICAgICB2YXIgeFN0YXJ0ID0gZC54U3RhcnQ7XG5cdFx0ICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHlTdGFydCA9IGQueVN0YXJ0O1xuXHRcdCAgICAgICAgICAgICAgICAgICAgICAgIGQueFN0YXJ0ID0gZC54O1xuXHRcdCAgICAgICAgICAgICAgICAgICAgICAgIGQueVN0YXJ0ID0gZC55O1xuXHRcdCAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkMy5pbnRlcnBvbGF0ZVN0cmluZyhcInRyYW5zbGF0ZShcIiArIHhTdGFydCArIFwiLFwiICsgeVN0YXJ0ICsgXCIpXCIsIFwidHJhbnNsYXRlKFwiICsgZC54ICsgXCIsXCIgKyBkLnkgKyBcIilcIik7XG5cdFx0ICAgICAgICAgICAgICAgICAgICB9XG5cdFx0ICAgICAgICAgICAgICAgICAgICByZXR1cm4gZDMuaW50ZXJwb2xhdGVTdHJpbmcoXCJ0cmFuc2xhdGUoXCIgKyBkLnggKyBcIixcIiArIGQueSArIFwiKVwiLCBcInRyYW5zbGF0ZShcIiArIGQueCArIFwiLFwiICsgZC55ICsgXCIpXCIpO1xuXHRcdCAgICAgICAgICAgICAgICB9KTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0Tm9kZTogVmlzdWFsaXplck5vZGVcblx0XHR9XG5cbn1dKTtcblxuXG5cblxuXG5cblxuXG4iLCIvKipcbiAqIFRoaXMgcG9saWN5IGlzIHVzZWQgdG8gYWRkIGEgc2VsZWN0IG5vZGUgZmVhdHVyZS5cbiAqIFN1cHBvcnRzIHNlbGVjdGluZyBtdWx0aXBsZSBub2RlcyBieSB1c2luZyB0aGUgY3RybCBrZXkuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdOb2RlU2VsZWN0aW9uUG9saWN5JywgWydQb2xpY3knLCBmdW5jdGlvbiAoUG9saWN5KSB7XG5cbiAgICBcdGNsYXNzIE5vZGVTZWxlY3Rpb25Qb2xpY3kgZXh0ZW5kcyBQb2xpY3kuUG9saWN5IHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgICAgICBzdXBlcihcIk5vZGVTZWxlY3Rpb25Qb2xpY3lcIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gcG9saWN5IGlzIGluc3RhbGxlZFxuICAgICAgICAgICAgICogT3ZlcndyaXRlcyB0aGUgb24gZHJhZyBldmVudCBvZiB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgXG4gICAgXHRcdCAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFsbGVkIG9uXG4gICAgXHRcdCAqL1xuICAgICAgICAgICAgaW5pdGlhbGl6ZShncmFwaCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3VwZXIuaW5pdGlhbGl6ZShncmFwaCk7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLnNlbGVjdGVkTm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgY29uc3RzID0gZ3JhcGguY29uc3RzLk5vZGVTZWxlY3Rpb25Qb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICBjb25zdHMuc2VsZWN0ZWRDbGFzcyA9IFwic2VsZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAvL292ZXJ3cml0dGluZyBncmFwaCdzIG5vZGUgb24gZHJhZyBldmVudCB0byBzdXBwb3J0XG4gICAgICAgICAgICAgICAgLy9tb3ZpbmcgbXVsdGlwbGUgbm9kZXMgYXQgb25jZVxuICAgICAgICAgICAgICAgIHZhciBkcmFnID0gZ3JhcGguZHJhZztcbiAgICAgICAgICAgICAgICBkcmFnLm9uKCdkcmFnJywgZnVuY3Rpb24oYXJncykge1xuICAgICAgICAgICAgICAgIFx0dmFyIHRoaXNHcmFwaCA9IGdyYXBoO1xuICAgICAgICAgICAgICAgIFx0aWYgKHRoaXNHcmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgXHRcdHZhciBzZWxlY3RlZENsYXNzID0gdGhpc0dyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5LnNlbGVjdGVkQ2xhc3M7XG4gICAgICAgICAgICAgICAgXHRcdHZhciBzZWxlY3Rpb24gPSBkMy5zZWxlY3RBbGwoICcuJyArc2VsZWN0ZWRDbGFzcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBzZWxlY3Rpb25bMF0uaW5kZXhPZiggdGhpcyk9PS0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uLmNsYXNzZWQoc2VsZWN0ZWRDbGFzcywgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGlvbiA9IGQzLnNlbGVjdCggdGhpcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uLmNsYXNzZWQoc2VsZWN0ZWRDbGFzcywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IFxuXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb24uYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbiggZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCArPSBkMy5ldmVudC5keDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gZDMuZXZlbnQuZHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwidHJhbnNsYXRlKFwiICsgWyBkLngsZC55IF0gKyBcIilcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgICAgICBcdH1cblxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQWRkcyB0aGUgZ2l2ZW4gbm9kZSB0byB0aGUgYXJyYXkgb2Ygc2VsZWN0ZWQgbm9kZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM05vZGUgICAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgIG5vZGVEYXRhICBNYXRjaGluZyBOb2RlIG9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBhZGRTZWxlY3ROb2RlKGQzTm9kZSwgbm9kZURhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgZDNOb2RlLmNsYXNzZWQoY29uc3RzLnNlbGVjdGVkQ2xhc3MsIHRydWUpO1xuICAgICAgICAgICAgICAgIHN0YXRlLnNlbGVjdGVkTm9kZXMucHVzaChub2RlRGF0YSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyB0aGUgZ2l2ZW4gbm9kZSBmcm9tIHRoZSBhcnJheSBvZiBzZWxlY3RlZCBub2Rlcy5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM05vZGUgICAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgIG5vZGVEYXRhICBNYXRjaGluZyBub2RlIG9iamVjdCBcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgcmVtb3ZlU2VsZWN0RnJvbU5vZGUoZDNOb2RlLCBub2RlRGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzLk5vZGVTZWxlY3Rpb25Qb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5maWx0ZXIoZnVuY3Rpb24oY2QpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNkLmlkID09PSBub2RlRGF0YS5pZDtcbiAgICAgICAgICAgICAgICB9KS5jbGFzc2VkKGNvbnN0cy5zZWxlY3RlZENsYXNzLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gc3RhdGUuc2VsZWN0ZWROb2Rlcy5pbmRleE9mKG5vZGVEYXRhKTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zZWxlY3RlZE5vZGVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyBhbGwgc2VsZWN0ZWQgbm9kZXMuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHJlbW92ZUFsbFNlbGVjdGVkTm9kZXMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmNsYXNzZWQoY29uc3RzLnNlbGVjdGVkQ2xhc3MsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zZWxlY3RlZE5vZGVzID0gW107XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogT24gTW91c2Vkb3duLCBkZXRlcm1pbmVzIHdoZXRoZXIgdG8gY2hhbmdlIHRoZVxuICAgICAgICAgICAgICogc2VsZWN0ZWQgc3RhdHVzIG9mIHRoZSBjbGlja2VkIG5vZGUuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgZCAgICAgICBNYXRjaGluZyBOb2RlIE9iamVjdCAgICAgICBcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgbW91c2Vkb3duKGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuICAgICAgICAgICAgICAgIGQzLmV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIGlmIChkMy5ldmVudC5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5zZWxlY3RlZE5vZGVzLmluZGV4T2YoZCkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVTZWxlY3RGcm9tTm9kZShkM25vZGUsIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRTZWxlY3ROb2RlKGQzbm9kZSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHN0YXRlLnNlbGVjdGVkTm9kZXMuaW5kZXhPZihkKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIG5vIGNvbnRyb2wga2V5LCBhbmQgY2xpY2tlZCBub3Qgc2VsZWN0ZWQgbm9kZSxcbiAgICAgICAgICAgICAgICAgICAgLy9yZW1vdmUgYWxsIG9mIGN1cnJlbnQgc2VsZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQWxsU2VsZWN0ZWROb2RlcygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBPbiBNb3VzZXVwLCBkZXRlcm1pbmVzIHdoZXRoZXIgdG8gY2hhbmdlIHRoZVxuICAgICAgICAgICAgICogc2VsZWN0ZWQgc3RhdHVzIG9mIHRoZSBjbGlja2VkIG5vZGUuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgZCAgICAgICBNYXRjaGluZyBOb2RlIE9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBtb3VzZXVwKGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuICAgICAgICAgICAgICAgIGlmICghZDMuZXZlbnQuY3RybEtleSkge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIGxlbmd0aCBpcyBncmVhdGVyIHRoYW4gMSwgdGhlbiB3ZSBhcmUgbW92aW5nIG11bHRpcGxlIG5vZGVzXG4gICAgICAgICAgICAgICAgICAgIC8vbGVhdmUgdGhlbSBhbGwgaGlnaGxpZ2h0ZWRcbiAgICAgICAgICAgICAgICAgICAgLy9vdGhlcndpc2Ugd2UgYXJlIGp1c3QgbW92aW5nIG9uZSBub2RlLCBzbyB1bmhpZ2hsaWdodFxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuc2VsZWN0ZWROb2Rlcy5sZW5ndGggPD0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVTZWxlY3RGcm9tTm9kZShkM25vZGUsIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBQb2xpY3k6IE5vZGVTZWxlY3Rpb25Qb2xpY3lcbiAgICAgICAgfVxufV0pO1xuXG5cblxuXG5cblxuXG4iLCIvKipcbiAqIFRoaXMgcG9saWN5IGNoYW5nZXMgdGhlIHZpZXcgdG8gdGhlIHRpbWVncmFwaCBvZiBsaW5rIGRhdGEgb24gY2xpY2suXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdQYXRoQ2hhbmdlVmlld1BvbGljeScsIFsnUG9saWN5JywgZnVuY3Rpb24gKFBvbGljeSkge1xuICAgIFx0Y2xhc3MgUGF0aENoYW5nZVZpZXdQb2xpY3kgZXh0ZW5kcyBQb2xpY3kuUG9saWN5IHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHRvIGJ1aWxkIHBvbGljeVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgIHtBbmd1bGFyIFN0YXRlfSAgICAkc3RhdGUgICAgVXNlZCB0byBjaGFuZ2Ugdmlld1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcigkc3RhdGUpIHtcbiAgICAgICAgICAgICAgICBzdXBlcignUGF0aENoYW5nZVZpZXdQb2xpY3knKTtcbiAgICAgICAgICAgICAgICB0aGlzLiRzdGF0ZSA9ICRzdGF0ZTtcbiAgICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogR2VuZXJhdGVzIGEgbGlzdCBvZiBhbGwgY2hpbGQgY29udGFpbmVycyBvZiB0aGUgc2VydmljZVxuICAgICAgICAgICAgICogQ2FuIGhhbmRsZSBuZXN0ZWQgc2VydmljZXMuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGlkICAgICAgTm9kZSBJRFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBnZW5lcmF0ZUxpc3QoaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHJldExpc3QgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgZ2VuZXJhdGVMaXN0SGVscGVyID0gZnVuY3Rpb24oaWQsIHJldExpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVJZHMgPSB0aGlzUG9saWN5LmdyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0W2lkXTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2RlSWRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGRJZCA9IG5vZGVJZHNbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpc1BvbGljeS5ncmFwaC5kYXRhU291cmNlLmhhc0NoaWxkKGNoaWxkSWQpID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlJldExpc3QgPSBnZW5lcmF0ZUxpc3RIZWxwZXIoY2hpbGRJZCwgcmV0TGlzdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0TGlzdC5jb25jYXQoc3ViUmV0TGlzdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldExpc3QucHVzaChjaGlsZElkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBnZW5lcmF0ZUxpc3RIZWxwZXIoaWQsIHJldExpc3QpO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXRMaXN0XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byByZXJvdXRlIGFuIGVkZ2Ugd2hlbiBjbGlja2VkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0xpbmt9ICBlZGdlICAgIFRoZSBjbGlja2VkIGVkZ2VcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdmlld0VkZ2UoZWRnZSkge1xuICAgICAgICAgICAgICAgIHZhciBzb3VyY2VMaXN0ID0gW107XG4gICAgICAgICAgICAgICAgdmFyIHRhcmdldExpc3QgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgc291cmNlSWQgPSBlZGdlLnNvdXJjZS5pZDtcbiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0SWQgPSBlZGdlLnRhcmdldC5pZDtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmdyYXBoLmRhdGFTb3VyY2UuaGFzQ2hpbGQoc291cmNlSWQpID09PSB0cnVlKSB7Ly9Ob3QgYSBjb250YWluZXIgbm9kZSwgbmVlZCB0byBhZ2dyZWdhdGVcbiAgICAgICAgICAgICAgICAgICAgc291cmNlTGlzdCA9IHRoaXMuZ2VuZXJhdGVMaXN0KHNvdXJjZUlkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzb3VyY2VMaXN0ID0gW3NvdXJjZUlkXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ncmFwaC5kYXRhU291cmNlLmhhc0NoaWxkKHRhcmdldElkKSA9PT0gdHJ1ZSkgey8vTm90IGEgY29udGFpbmVyIG5vZGUsIG5lZWQgdG8gYWdncmVnYXRlXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldExpc3QgPSB0aGlzLmdlbmVyYXRlTGlzdCh0YXJnZXRJZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TGlzdCA9IFt0YXJnZXRJZF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuJHN0YXRlLmdvKCdjb250aXYubWVudS52aXN1YWxpemF0aW9uLmVkZ2UnLCBcbiAgICAgICAgICAgICAgICAgICAge3NvdXJjZU5hbWU6IHNvdXJjZUlkLCB0YXJnZXROYW1lOiB0YXJnZXRJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZUxpc3Q6IHNvdXJjZUxpc3QsIHRhcmdldExpc3Q6IHRhcmdldExpc3R9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbW91c2Vkb3duKGQzcGF0aCwgZCkge1xuICAgICAgICAgICAgICAgIHRoaXMudmlld0VkZ2UoZCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgUG9saWN5OiBQYXRoQ2hhbmdlVmlld1BvbGljeVxuICAgICAgICB9XG59XSk7XG5cblxuXG5cblxuXG5cblxuXG5cblxuIiwiLyoqXG4gKiBCYXNlIHBvbGljeSBjbGFzcyBmb3IgdGhlIGdyYXBoIG9iamVjdFxuICogXG4gKiBQb2xpY2llcyBhcmUgdXNlZCB0byBpc29sYXRlIGZlYXR1cmVzIGZvciBhIGdyYXBoLlxuICogUG9saWNpZXMgY2FuIGJlIGluc3RhbGxlZCBvbiBub2RlcywgbGlua3MsIG9yIHRoZSBncmFwaC5cbiAqIEVhY2ggcG9saWN5IGhhcyBpbnRlcmFjdGlvbiBoYW5kbGVycyB0aGF0IHdpbGwgYmUgY2FsbGVkIGJ5IHRoZSBncmFwaFxuICogaWYgaW5zdGFsbGVkLiBQb2xpY2llcyBjYW4gYWxzbyBtb2RpZnkgZ3JhcGggZnVuY3Rpb25zIChzZWUgUVRpcFBvbGljeSkuXG4gKiBNdWx0aXBsZSBwb2xpY2llcyBjYW4gYmUgaW5zdGFsbGVkIGZvciBhIG5vZGUgb3IgbGluay4gXG4gKiBcbiAqIFRvIHdyaXRlIHlvdXIgb3duIHBvbGljeSwgY3JlYXRlIGEgbmV3IGZhY3RvcnkgdGhhdCB1c2VzIHRoZSBwb2xpY3lcbiAqIHlvdSB3YW50IHRvIGluaGVyaXQgYXMgYSBkZXBlbmRlbmN5LCBhbmQgZXh0ZW5kIGl0cyBwb2xpY3kuIFxuICogUmV0dXJuIHRoZSBjbGFzcyBvYmplY3Qgd2l0aCBQb2xpY3kgYXMga2V5LCBhbmQgXG4gKiBhZGQgdGhlIHBvbGljeSB0byB0aGUgUG9saWN5U2VydmljZSBmYWN0b3J5LlxuICogXG4gKiBGb3Igc2F2aW5nIHN0YXRlIG9yIGNvbnN0cyBmb3IgdGhlIHBvbGljeSwgY3JlYXRlIGEgbmFtZXNwYWNlXG4gKiBpbiBncmFwaC5zdGF0ZSBhbmQgZ3JhcGguY29uc3RzLlxuICogRXguIFxuICogICAgICBncmFwaC5zdGF0ZS5teVBvbGljeSA9IHt9O1xuICogICAgICBncmFwaC5jb25zdHMubXlQb2xpY3kgPSB7fTtcbiAqICAgICAgXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdQb2xpY3knLCBbZnVuY3Rpb24gKCkge1xuICAgICAgICBjbGFzcyBQb2xpY3kge1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHBvbGljeU5hbWUgIFRoZSBwb2xpY3kgbmFtZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcihwb2xpY3lOYW1lKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wb2xpY3lOYW1lID0gcG9saWN5TmFtZTtcbiAgICAgICAgICAgICAgICB0aGlzLmdyYXBoID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIHBvbGljeSBpcyBpbnN0YWxsZWQuXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAge0dyYXBofSAgZ3JhcGggICBUaGUgR3JhcGggdGhhdCB0aGUgcG9saWN5IGlzXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgYmVpbmcgaW5zdGFsbGVkIG9uXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluaXRpYWxpemUoZ3JhcGgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47IFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLmdyYXBoID0gZ3JhcGg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogSGFuZGxlciwgbWVhbnQgdG8gYmUgb3ZlcnJpZGRlbiBpbiBzdWJjbGFzc2VzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICB7ZDMgb2JqZWN0fSAgICBkM29iaiAgICBUaGUgZDNvYmplY3RcbiAgICAgICAgICAgICAqIEBwYXJhbSAge05vZGUvTGluay9HcmFwaH0gIGQgICBUaGUgb2JqZWN0IGl0IHdhc1xuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbGxlZCBmb3IuICAgIFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBtb3VzZW92ZXIgKGQzb2JqLCBkKSB7fVxuICAgICAgICAgICAgZGJsY2xpY2soZDNvYmosIGQpIHt9XG4gICAgICAgICAgICBjb250ZXh0bWVudShkM29iaiwgZCkge31cbiAgICAgICAgICAgIG1vdXNlb3V0KGQzb2JqLCBkKSB7fVxuICAgICAgICAgICAgbW91c2Vkb3duKGQzb2JqLCBkKSB7fVxuICAgICAgICAgICAgbW91c2V1cChkM29iaiwgZCkge31cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBXaWxsIGJlIGNhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyBiZWluZyBkZXN0cm95ZWQuXG4gICAgICAgICAgICAgKiBVc2VkIHRvIHJlbW92ZSBhbnkgZWxlbWVudHMgb3IgYmluZGluZ3MgdGhlIHBvbGljeVxuICAgICAgICAgICAgICogaGFzIGFkZGVkLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkZXN0cm95KCkge31cbiAgICAgICAgfVxuICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIFBvbGljeTogUG9saWN5XG4gICAgICAgIH1cbn1dKTtcblxuXG5cblxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmFwcGxpY2F0aW9uZ3JvdXBzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3VwcycsIHtcbiAgICAgICAgICAgIHVybDogJy9hcHBsaWNhdGlvbmdyb3VwcycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIi8qKlxuICogQ29udGFpbnMgYWxsIHRoZSBwb2xpY2llcy5cbiAqIFNlZSBwb2xpY3kuanMgZm9yIGluZm8gb24gaG93IHBvbGljaWVzIHdvcmsuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdQb2xpY3lTZXJ2aWNlJywgWydQb2xpY3knLCdRVGlwUG9saWN5JywgJ1BhdGhDaGFuZ2VWaWV3UG9saWN5JywgXG4gICAgICAgICdOb2RlU2VsZWN0aW9uUG9saWN5JywgJ1NwbGl0Sm9pbk5vZGVQb2xpY3knLCAnU3BsaXRKb2luVmlld1BvbGljeScsXG4gICAgICAgICdTYXZlU3RhdGVQb2xpY3knLFxuICAgICAgICAgICAgZnVuY3Rpb24gKFBvbGljeSwgUVRpcFBvbGljeSwgUGF0aENoYW5nZVZpZXdQb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgICAgICBOb2RlU2VsZWN0aW9uUG9saWN5LCAgU3BsaXRKb2luTm9kZVBvbGljeSwgXG4gICAgICAgICAgICAgICAgICAgICAgICBTcGxpdEpvaW5WaWV3UG9saWN5LCBTYXZlU3RhdGVQb2xpY3kpIHtcblxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIFBvbGljeTogUG9saWN5LlBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgUVRpcFBvbGljeTogUVRpcFBvbGljeS5Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIFBhdGhDaGFuZ2VWaWV3UG9saWN5OiBQYXRoQ2hhbmdlVmlld1BvbGljeS5Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIE5vZGVTZWxlY3Rpb25Qb2xpY3k6IE5vZGVTZWxlY3Rpb25Qb2xpY3kuUG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBTcGxpdEpvaW5Ob2RlUG9saWN5OiBTcGxpdEpvaW5Ob2RlUG9saWN5LlBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgU3BsaXRKb2luVmlld1BvbGljeTogU3BsaXRKb2luVmlld1BvbGljeS5Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIFNhdmVTdGF0ZVBvbGljeTogU2F2ZVN0YXRlUG9saWN5LlBvbGljeVxuICAgICAgICAgICAgICAgIH1cbn1dKTsiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZGFzaGJvYXJkJywgWydjb250aXYubW9kZWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmRhc2hib2FyZCcsIHtcbiAgICAgICAgICAgIHVybDogJy9kYXNoYm9hcmQnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnZGFzaGJvYXJkJ1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwIiwiLyoqXG4gKiBUaGlzIHBvbGljeSBhZGRzIHRvb2x0aXAgZnVuY3Rpb25hbGl0eSB0byBub2RlcyBhbmQgbGlua3MuXG4gKiBXaGVuIGluc3RhbGxpbmcsIGluc3RhbGwgb24gYm90aCBsaW5rcyBhbmQgbm9kZXMuXG4gKiBcbiAqIFVzZXMgdGhlIHFUaXAgalF1ZXJ5IHBsdWdpblxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnUVRpcFBvbGljeScsIFsnUG9saWN5JywgZnVuY3Rpb24gKFBvbGljeSkge1xuICAgICAgICBjbGFzcyBRVGlwUG9saWN5IGV4dGVuZHMgUG9saWN5LlBvbGljeSB7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgICAgICAgICAgc3VwZXIoXCJRVGlwUG9saWN5XCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAgICAgKiBNb2RpZmllcyB0aGUgdXBkYXRlTmV3Tm9kZXMgYW5kIFxuICAgICAgICAgICAgICogdXBkYXRlTmV3UGF0aHMgbWV0aG9kIG9mIHRoZSBncmFwaCB0byBpbnN0YWxsIHF0aXBcbiAgICAgICAgICAgICAqIG9udG8gZWFjaCBub2RlIGFuZCBwYXRoLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoIGl0IGlzIFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YWxsZWQgb25cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5pdGlhbGl6ZShncmFwaCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3VwZXIuaW5pdGlhbGl6ZShncmFwaCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuUVRpcFBvbGljeSA9IHt9O1xuXG4gICAgICAgICAgICAgICAgc3RhdGUubW91c2Vkb3duID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICBncmFwaC5jb25zdHMuUVRpcFBvbGljeSA9IHt9O1xuXG4gICAgICAgICAgICAgICAgLy9UcmFja2luZyBtb3VzZSBjbGljayBzdGF0ZSB0byBtYWtlIHRvb2x0aXBcbiAgICAgICAgICAgICAgICAvL2Rpc2FwcGVhciBpZiB0aGUgbm9kZSBpcyBiZWluZyBkcmFnZ2VkLlxuICAgICAgICAgICAgICAgICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykubW91c2V1cChmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLm1vdXNldXAgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vb3ZlcnJpZGUgdXBkYXRlTmV3Tm9kZXMgYW5kIHVwZGF0ZU5ld1BhdGhzXG4gICAgICAgICAgICAgICAgLy90byBpbnN0YWxsIHF0aXBcbiAgICAgICAgICAgICAgICB2YXIgZ3JhcGhVcGRhdGVOZXdOb2RlcyA9IGdyYXBoLnVwZGF0ZU5ld05vZGVzO1xuICAgICAgICAgICAgICAgIGdyYXBoLnVwZGF0ZU5ld05vZGVzID0gZnVuY3Rpb24obmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGhVcGRhdGVOZXdOb2Rlcy5jYWxsKGdyYXBoLCBuZXdOb2Rlcyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kudXBkYXRlTmV3Tm9kZXMobmV3Tm9kZXMpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB2YXIgZ3JhcGhVcGRhdGVOZXdQYXRocyA9IGdyYXBoLnVwZGF0ZU5ld1BhdGhzO1xuICAgICAgICAgICAgICAgIGdyYXBoLnVwZGF0ZU5ld1BhdGhzID0gZnVuY3Rpb24obmV3UGF0aHMpIHtcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGhVcGRhdGVOZXdQYXRocy5jYWxsKGdyYXBoLCBuZXdQYXRocyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kudXBkYXRlTmV3UGF0aHMobmV3UGF0aHMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmVzIGFsbCBxVGlwcyBmcm9tIHRoZSBET00uXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgcG9saWN5IGlzIHVuaW5zdGFsbGVkIG9yXG4gICAgICAgICAgICAgKiB0aGUgZ3JhcGggaXMgZGVzdHJveWVkLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkZXN0cm95KCkge1xuICAgICAgICAgICAgICAgIC8vcmVtb3ZpbmcgYWxsIHF0aXAgZnJvbSBET01cbiAgICAgICAgICAgICAgICAkKCdbaWRePVwicXRpcFwiXScpLnJlbW92ZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEtlZXBpbmcgdHJhY2sgb2YgbW91c2Vkb3duIHN0YXRlXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzT2JqZWN0fSAgZDNvYmogIFRoZSBkMyBwYmplY3RcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlL0xpbmt9ICBkICAgICBUaGUgbWF0Y2hpbmcgZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgbW91c2Vkb3duKGQzb2JqLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlFUaXBQb2xpY3k7XG4gICAgICAgICAgICAgICAgc3RhdGUubW91c2Vkb3duID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBLZWVwaW5nIHRyYWNrIG9mIG1vdXNlZG93biBzdGF0ZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM09iamVjdH0gIGQzb2JqICBUaGUgZDMgcGJqZWN0XG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZS9MaW5rfSAgZCAgICAgVGhlIG1hdGNoaW5nIGRhdGEgb2JqZWN0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIG1vdXNldXAoZDNvYmosIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuUVRpcFBvbGljeTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5tb3VzZWRvd24gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgd2hlblFUaXBBdmFpbGFibGUoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIGludGVydmFsID0gNTAwOyAvLyBtc1xuICAgICAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJChkb2N1bWVudCkucXRpcCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQodGhpc1BvbGljeS53aGVuUVRpcEF2YWlsYWJsZShjYWxsYmFjayksIGludGVydmFsKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIGludGVydmFsKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiBOZXcgTm9kZXMgYXJlIGFkZGVkIGR1cmluZyB0aGVcbiAgICAgICAgICAgICAqIHVwZGF0ZSBncmFwaCBmdW5jdGlvblxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM05vZGV9ICBuZXdOb2RlcyAgVGhlIG5ldyBub2RlcyB0aGF0IGFyZVxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZWluZyBhZGRlZCB0byB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlTmV3Tm9kZXMobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuUVRpcFBvbGljeTtcblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGF0dGFjaFFUaXAoKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vYXR0YWNoaW5nIHF0aXBcbiAgICAgICAgICAgICAgICAgICAgbmV3Tm9kZXMuZWFjaChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGhpc05vZGUgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy9JZiBub2RlIGhhcyBjaGlsZHJlbiwgdGhlbiBpdCBpcyBhIHNlcnZpY2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbZC5pZF0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSBcIjxiPjx1PlNlbGVjdG9yczo8L2I+PC91PiBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0b3JNYXAgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5zZWxlY3RvcnNbZC5pZF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhhc0tleXMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gc2VsZWN0b3JNYXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzS2V5cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0ga2V5ICsgXCIgOiA8aT5cIisgc2VsZWN0b3JNYXBba2V5XSArIFwiPC9pPixcXG4gXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoYXNLZXlzID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbW1hIHdpbGwgYmUgcmVtb3ZlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gXCJObyBTZWxlY3RvcnMsIFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gXCI8Yj48dT5MYWJlbHM6PC9iPjwvdT4gXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxhYmVsc01hcCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmxhYmVsc1tkLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGFzS2V5cyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBsYWJlbHNNYXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzS2V5cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0ga2V5ICsgXCIgOiA8aT5cIisgbGFiZWxzTWFwW2tleV0gKyBcIjwvaT4sXFxuIFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFzS2V5cyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb21tYSB3aWxsIGJlIHJlbW92ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IFwiTm8gbGFiZWxzLCBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3JlbW92ZSBsYXN0IGNvbW1hXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gdGV4dC5zbGljZSgwLCAtMik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpc05vZGUpLnF0aXAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGQuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRleHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50czogeyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXBpID0gJCh0aGlzTm9kZSkucXRpcCgnYXBpJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gJCgnI2dyYXBoQ29udGFpbmVyJykub2Zmc2V0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9zaXRpb24gPSBbb2Zmc2V0LmxlZnQgKyAoKGQueCAqIHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCkpICsgdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKClbMF0pLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0LnRvcCArICgoZC55ICtkLnJhZGl1cykgKiB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpKSAgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKVsxXV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcGkuc2V0KCdwb3NpdGlvbi50YXJnZXQnLCBwb3NpdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIXN0YXRlLm1vdXNlZG93bjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxheTogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc29sbzogJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NlczogJ3F0aXAtYmx1ZSBxdGlwLXNoYWRvdydcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG15OiAndG9wIGNlbnRlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0OiAnYm90dG9tIGNlbnRlcidcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGFyZ2V0OiBwb3NpdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudDogJ21vdXNlZG93biBtb3VzZWxlYXZlJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL2luY2FzZSBsaWJyYXJ5IGhhc24ndCBsb2FkZWQgeWV0XG4gICAgICAgICAgICAgICAgaWYgKCQoZG9jdW1lbnQpLnF0aXAgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGF0dGFjaFFUaXAoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLndoZW5RVGlwQXZhaWxhYmxlKGF0dGFjaFFUaXApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiBuZXcgcGF0aHMgYXJlIGFkZGVkIGR1cmluZyB0aGVcbiAgICAgICAgICAgICAqIHVwZGF0ZSBncmFwaCBmdW5jdGlvblxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM1BhdGh9ICBuZXdQYXRocyAgVGhlIG5ldyBwYXRocyB0aGF0IGFyZVxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZWluZyBhZGRlZCB0byB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlTmV3UGF0aHMobmV3UGF0aHMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuUVRpcFBvbGljeTtcblxuICAgICAgICAgICAgICAgIC8vaW5jYXNlIGxpYnJhcnkgaGFzbid0IGxvYWRlZCB5ZXRcbiAgICAgICAgICAgICAgICBpZiAoJChkb2N1bWVudCkucXRpcCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9hZGRpbmcgcXRpcFxuICAgICAgICAgICAgICAgICAgICBuZXdQYXRocy5lYWNoKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aGlzUGF0aCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2dldHRpbmcgbWlkcG9pbnQgb2YgcGF0aFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhdGhFbCAgID0gZDMuc2VsZWN0KHRoaXMpLm5vZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtaWRwb2ludCA9IHBhdGhFbC5nZXRQb2ludEF0TGVuZ3RoKHBhdGhFbC5nZXRUb3RhbExlbmd0aCgpLzIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldFJldCA9IGQucXRpcEhlbHBlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSBcIkJ5dGVzOiBcIiArIGQuZ2V0V2VpZ2h0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXNQYXRoKS5xdGlwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRleHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vaWYgbW91c2UgaXMgZG93biwgZG9uJ3QgbGV0IHF0aXAgc2hvd1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICFzdGF0ZS5tb3VzZWRvd247XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3c6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsYXk6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvbG86ICQoJyNncmFwaENvbnRhaW5lcicpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc2VzOiAncXRpcC1ibHVlIHF0aXAtc2hhZG93J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXk6IHRhcmdldFJldC5teSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXQ6ICdjZW50ZXIgY2VudGVyJywgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogJ21vdXNlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRqdXN0OiB0YXJnZXRSZXQuYWRqdXN0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaWRlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50OiAnbW91c2Vkb3duIG1vdXNlbGVhdmUnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9ICAgXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgUG9saWN5OiBRVGlwUG9saWN5XG4gICAgICAgIH1cbn1dKTtcblxuXG5cblxuXG5cblxuXG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubG9naW4nLCBbJ2NvbnRpdi51dGlscyddKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIFRoaXMgcG9saWN5IHByb3ZpZGVzIGEgd2F5IGZvciBwcm9wZXJ0aWVzIHRvIGJlIHNhdmVkIFxuICogYmV0d2VlbiB2aWV3IGNoYW5nZXNcbiAqIFxuICogSXQgbW9kaWZpZXMgdGhlIGRlc3Ryb3kgZnVuY3Rpb24gdG8gYWxzbyBwYXNzIGluIGFuIG9iamVjdCB0aGF0XG4gKiB3aWxsIGhhdmUgYWxsIGl0cyBwcm9wZXJ0aWVzIHNhdmVkIGFuZCB3aWxsIGJlIGF2YWlsYWJsZSBcbiAqIG9uIGdyYXBoIGxvYWQuIFdoZW4gc2F2aW5nIHZhcmlhYmxlcyB0byB0aGUgb2JqZWN0LCBuYW1lc3BhY2Ugd2l0aFxuICogdGhlIHBvbGljeSBuYW1lLlxuICogXG4gKiBUaGlzIHBvbGljeSBtdXN0IGJlIGxvYWRlZCBmaXJzdCBpbiBvcmRlciBmb3IgaXQgc2F2ZWQgdmFyaWFibGVzIFxuICogdG8gYmUgbG9hZGVkIHdoZW4gdGhlIHZpZXcgY29tZXMgYmFjayB0byB0aGUgZ3JhcGhcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ1NhdmVTdGF0ZVBvbGljeScsIFsnUG9saWN5JywgZnVuY3Rpb24gKFBvbGljeSkge1xuICAgIFx0Y2xhc3MgU2F2ZVN0YXRlUG9saWN5IGV4dGVuZHMgUG9saWN5LlBvbGljeSB7XG4gICAgXHRcdFxuICAgIFx0XHQvKipcbiAgICBcdFx0ICogVGFrZXMgaW4gdGhlIGFuZ3VsYXIgc2VydmljZSB0byB3aGljaCBpdCB3aWxsXG4gICAgXHRcdCAqIHNhdmUgaXQncyBwcm9wZXJ0aWVzIHRvLlxuICAgIFx0XHQgKlxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgc2F2ZWRTdGF0ZSAgT2JqZWN0IHRvIHNhdmUgXG4gICAgXHRcdCAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzIHRvXG4gICAgXHRcdCAqL1xuICAgIFx0XHRjb25zdHJ1Y3RvcihzYXZlZFN0YXRlKSB7XG4gICAgXHRcdFx0c3VwZXIoJ1NhdmVTdGF0ZVBvbGljeScpO1xuICAgIFx0XHRcdHRoaXMuc2F2ZWRTdGF0ZSA9IHNhdmVkU3RhdGU7XG4gICAgXHRcdH1cblxuICAgIFx0XHQvKipcbiAgICBcdFx0ICogQ2FsbGVkIHdoZW4gdGhlIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICBcdFx0ICogTW9kaWZpZXMgdGhlIGRlc3Ryb3kgbWV0aG9kIFxuICAgIFx0XHQgKiBhbmQgYWRkcyBhIGxvYWQgbWV0aG9kIHRvIHRoZSBncmFwaFxuICAgIFx0XHQgKlxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaCBpdCBpcyBcbiAgICBcdFx0ICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YWxsZWQgb25cbiAgICBcdFx0ICovXG4gICAgXHRcdGluaXRpYWxpemUoZ3JhcGgpIHtcbiAgICBcdFx0XHR0aGlzLmdyYXBoID0gZ3JhcGg7XG4gICAgXHRcdFx0dmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgIFx0XHRcdGdyYXBoLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcbiAgICBcdFx0XHRcdHRoaXNQb2xpY3kuZ3JhcGhEZXN0cm95LmNhbGwoZ3JhcGgsIHRoaXNQb2xpY3kuc2F2ZWRTdGF0ZSk7XG4gICAgXHRcdFx0fTtcblxuICAgIFx0XHRcdGdyYXBoLmxvYWQgPSBmdW5jdGlvbihzYXZlZFN0YXRlKSB7XG4gICAgXHRcdFx0XHR0aGlzUG9saWN5LmdyYXBoTG9hZC5jYWxsKGdyYXBoLCBzYXZlZFN0YXRlKTtcbiAgICBcdFx0XHR9XG4gICAgXHRcdH1cblxuICAgIFx0XHQvKipcbiAgICBcdFx0ICogV2lsbCBvdmVycmlkZSB0aGUgZ3JhcGgncyBkZWZhdWx0IGRlc3Ryb3ksIHdpdGggXG4gICAgXHRcdCAqIHRoaXMgcG9saWN5J3Mgc2F2ZWRTdGF0ZSBwYXNzZWQgaW4uXG4gICAgXHRcdCAqIENhbGxlZCB3aXRoIHRoaXMgYXMgdGhlIGdyYXBoXG4gICAgXHRcdCAqXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBzYXZlZFN0YXRlICBUaGUgc2F2ZWQgc3RhdGVcbiAgICBcdFx0ICovXG4gICAgXHRcdGdyYXBoRGVzdHJveShzYXZlZFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KHNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KHNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzR3JhcGguYmluZGluZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgJCh3aW5kb3cpLm9mZihrZXksIHRoaXNHcmFwaC5iaW5kaW5nc1trZXldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2lsbCBiZSBjYWxsZWQgd2l0aCB0aGUgZ3JhcGggYXMgdGhpc1xuICAgICAgICAgICAgICogVXNlZCB0byBoYXZlIGFsbCBvdGhlciBwb2xpY2llcyB1c2UgdGhlIGxvYWQgc3RhdGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgc2F2ZWRTdGF0ZSAgVGhlIHNhdmVkIHN0YXRlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGdyYXBoTG9hZChzYXZlZFN0YXRlKSB7XG4gICAgICAgICAgICBcdHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICBcdGlmIChwb2xpY3kubG9hZCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIFx0cG9saWN5LmxvYWQoc2F2ZWRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgIFx0fVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgIFx0aWYgKHBvbGljeS5sb2FkICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgXHRwb2xpY3kubG9hZChzYXZlZFN0YXRlKTtcbiAgICAgICAgICAgICAgICAgXHR9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgXHR9XG4gICAgXHRyZXR1cm4ge1xuICAgIFx0XHRQb2xpY3k6IFNhdmVTdGF0ZVBvbGljeVxuICAgIFx0fVxufV0pO1xuXG5cblxuXG5cblxuXG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubWVudScsIFtdKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIFRoaXMgcG9saWN5IGlzIHVzZWQgZm9yIHNwbGl0dGluZyBhIG5vZGUgaW50byBpdHMgY2hpbGRyZW4sXG4gKiBhbmQgam9pbmluZyB0aGVtIGJhY2sgdG8gdGhlaXIgcGFyZW50LlxuICogU3BsaXRzIG9uIGRvdWJsZSBjbGljaywgYW5kIGpvaW5zIG9uIHJpZ2h0IGNsaWNrLlxuICogSWYgbXVsdGlwbGUgbm9kZXMgYXJlIHNlbGVjdGVkIGF0IHRoZSB0aW1lIG9mIGEgc3BsaXQgb3Igam9pbiBldmVudCxcbiAqIGl0IHdpbGwgc3BsaXQgb3Igam9pbiBhbGwgb2YgdGhlbS5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ1NwbGl0Sm9pbk5vZGVQb2xpY3knLCBbJ05vZGVTZWxlY3Rpb25Qb2xpY3knLCAnVmlzdWFsaXplck5vZGUnLCBcbiAgICBcdFx0ZnVuY3Rpb24gKE5vZGVTZWxlY3Rpb25Qb2xpY3ksIFZpc3VhbGl6ZXJOb2RlKSB7XG5cdFx0Y2xhc3MgU3BsaXRKb2luTm9kZVBvbGljeSBleHRlbmRzIE5vZGVTZWxlY3Rpb25Qb2xpY3kuUG9saWN5IHtcblx0XHRcdC8qKlxuXHRcdFx0ICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuXHRcdFx0ICovXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgICAgICBzdXBlcigpO1xuICAgICAgICAgICAgICAgIHRoaXMucG9saWN5TmFtZSA9IFwiU3BsaXRKb2luTm9kZVBvbGljeVwiO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbml0aWFsaXplKGdyYXBoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdXBlci5pbml0aWFsaXplKGdyYXBoKTtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBncmFwaC5zdGF0ZS5TcGxpdEpvaW5Ob2RlUG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgc3RhdGUuc3BsaXROb2RlcyA9IFtdOyBcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUcmlnZ2VyaW5nIHNwbGl0IG9uIGRvdWJsZSBjbGlja1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBkICAgICAgVGhlIG1hdGNoaW5nIGRhdGEgb2JqZWN0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGRibGNsaWNrKGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdXBlclN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pbk5vZGVQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWQzLmV2ZW50LmN0cmxLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN1cGVyU3RhdGUuc2VsZWN0ZWROb2Rlcy5pbmRleE9mKGQpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3BsaXRNdWx0aXBsZU5vZGVzKHN1cGVyU3RhdGUuc2VsZWN0ZWROb2Rlcyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUFsbFNlbGVjdGVkTm9kZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3BsaXROb2RlKGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRyaWdnZXJpbmcgam9pbiBvbiByaWdodCBjbGlja1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09ian0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBkICAgICAgVGhlIG1hdGNoaW5nIGRhdGEgb2JqZWN0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGNvbnRleHRtZW51KGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdXBlclN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3k7XG4gICAgICAgICAgICAgICAgZDMuZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICBpZiAoIWQzLmV2ZW50LmN0cmxLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9pZiB0cnkgdG8gam9pbiBhIGhpZ2hsaWdodGVkIG5vZGUgd2hpbGUgbXVsdGlwbGUgbm9kZXMgYXJlIHNlbGVjdGVkLFxuICAgICAgICAgICAgICAgICAgICAvL3dlIGpvaW4gYWxsIGhpZ2hsaWdodGVkIG5vZGVzXG4gICAgICAgICAgICAgICAgICAgIHZhciBzZWxlY3RlZE5vZGVzID0gc3VwZXJTdGF0ZS5zZWxlY3RlZE5vZGVzO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWROb2Rlcy5pbmRleE9mKGQpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZWN0ZWROb2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuam9pbk5vZGUoc2VsZWN0ZWROb2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2lmIHdlIHRyeSB0byBqb2luIGEgbm9kZSB0aGF0IGlzbid0IHBhcnQgb2YgYSBoaWdobGlnaHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAvL3dlIHJlbW92ZSBhbGwgaGlnaGxpZ2h0cyBhbmQgdGhlbiBqb2luIHRoZSBjbGlja2VkIG5vZGVcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQWxsU2VsZWN0ZWROb2RlcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5qb2luTm9kZShkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTcGxpdHMgYSBub2RlLlxuICAgICAgICAgICAgICogdXNlZCB0byBzaGFyZSBjb2RlIGJldHdlZW4gc3BsaXROb2RlIGFuZCBzcGxpdE11bHRpcGxlTm9kZXNcbiAgICAgICAgICAgICAqIHdoaWxlIHByZXZlbnRpbmcgdGhlIGhhbmRsZXJzIGZvciB0aGVtIGJvdGggZmlyaW5nXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZSBiZWluZyBzcGxpdFxuICAgICAgICAgICAgICogQHJldHVybiAgICAge0FycmF5fSAgVGhlIG5ldyBub2RlcyBjcmVhdGVkIGJ5IHRoZSBzcGxpdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBfX3NwbGl0Tm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pbk5vZGVQb2xpY3k7XG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBub2RlLmlkO1xuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgLy9pZiBpdCBoYXMgbm8gY2hpbGRyZW4gdG8gc3BsaXQgaW50b1xuICAgICAgICAgICAgICAgIGlmIChjaGlsZHJlbl9zdHJ1Y3RbbmFtZV0gPT09IHVuZGVmaW5lZCB8fCBfLmlzRW1wdHkoY2hpbGRyZW5fc3RydWN0W25hbWVdKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9yZW1vdmluZyB0aGUgbm9kZSBmcm9tIHRoZSBsaXN0IG9mIG5vZGVzXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzID0gXy5maWx0ZXIodGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbihncmFwaE5vZGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBncmFwaE5vZGVzICE9IG5vZGU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2codGhpc0dyYXBoLm5vZGVzKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3BsaWNlTGlua3NGb3JOb2RlKG5vZGUpO1xuXG4gICAgICAgICAgICAgICAgLy9nZXR0aW5nIGFsbCB0aGUgbm9kZSBpZCdzIGZvciBmaW5kaW5nIGZsb3dcbiAgICAgICAgICAgICAgICB2YXIgbm9kZV9uYW1lc19zZXQgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXNHcmFwaC5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBub2RlX25hbWVzX3NldC5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXS5pZCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9zZXQgb2Ygbm9kZXMgYWZ0ZXIgdGhlIHNwbGl0XG4gICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hpbGRyZW5fc3RydWN0W25hbWVdLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVfbmFtZXNfc2V0LnB1c2goY2hpbGRyZW5fc3RydWN0W25hbWVdW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3X25vZGVzLnB1c2goY2hpbGRyZW5fc3RydWN0W25hbWVdW2ldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHJldERhdGEgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5nZXRGbG93QmV0d2VlblNldChub2RlX25hbWVzX3NldCk7XG5cbiAgICAgICAgICAgICAgICAvL2Zvcm1hdHRpbmcgZGF0YSBmb3IgbmV3IG5vZGVzXG4gICAgICAgICAgICAgICAgdmFyIHhMb2MgPSBub2RlLng7XG4gICAgICAgICAgICAgICAgdmFyIHlMb2MgPSBub2RlLnk7XG4gICAgICAgICAgICAgICAgdmFyIGFuY2VzdG9ycyA9IG5vZGUuYW5jZXN0b3JzLnNsaWNlKCk7XG4gICAgICAgICAgICAgICAgLy9rZWVwaW5nIG9yZGVyaW5nIHRoYXQgZmlyc3QgaW4gYW5jZXN0b3IgbGlzdCBpcyBjbG9zZXN0IGluIHJlbGF0aW9uc2hpcFxuICAgICAgICAgICAgICAgIGFuY2VzdG9ycy5zcGxpY2UoMCwgMCwgbm9kZS5pZCk7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IG5vZGUuaWQ7XG4gICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlX29ianMgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgcmFkaXVzID0gbm9kZS5yYWRpdXMgKiB0aGlzR3JhcGguY29uc3RzLnJhZGl1c0RlY2F5O1xuICAgICAgICAgICAgICAgIHZhciBub2RlRGF0YSA9IHJldERhdGEubm9kZURhdGE7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2RlRGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAvL2NhbGN1bGF0aW5nIHdoaWNoIG9mIHRoZSBub2RlcyBpbiByZXREYXRhWzBdIGFyZSBuZXdcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld19ub2Rlcy5pbmRleE9mKG5vZGVEYXRhW2ldLmlkKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWQgPSBub2RlRGF0YVtpXS5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gbm9kZURhdGFbaV0udGV4dDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZSA9IG5ldyBWaXN1YWxpemVyTm9kZS5Ob2RlKG51bGwsIG51bGwsIGlkLCB0ZXh0LCByYWRpdXMsIHBhcmVudCwgYW5jZXN0b3JzLCB4TG9jLCB5TG9jKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld19ub2RlLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5wdXNoKG5ld19ub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld19ub2RlX29ianMucHVzaChuZXdfbm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UucHJvY2Vzc0xpbmtEYXRhKHJldERhdGEubGlua0RhdGEsIHRoaXNHcmFwaC5ub2Rlcyk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXROb2RlcygpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0TGlua3MoKTtcblxuICAgICAgICAgICAgICAgIHN0YXRlLnNwbGl0Tm9kZXMucHVzaChub2RlLmlkKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3X25vZGVfb2JqcztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTcGxpdHMgdGhlIGdpdmUgbm9kZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZSBiZWluZyBzcGxpdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzcGxpdE5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciByZXMgPSB0aGlzLl9fc3BsaXROb2RlKG5vZGUpO1xuICAgICAgICAgICAgICAgIGlmIChyZXMgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc3BsaXROb2RlRXZlbnQocmVzKTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNwbGl0cyBhbGwgdGhlIG5vZGVzIHBhc3NlZCBpblxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVzICAgQXJyYXkgb2Ygbm9kZXMgdG8gYmUgc3BsaXRcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc3BsaXRNdWx0aXBsZU5vZGVzKG5vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG4gICAgICAgICAgICAgICAgdmFyIHJlc05vZGVzID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0gdGhpcy5fX3NwbGl0Tm9kZShub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIHJlc05vZGVzID0gcmVzTm9kZXMuY29uY2F0KHJlcyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5zcGxpdE11bHRpcGxlTm9kZXNFdmVudChyZXMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBhIHNpbmdsZSBub2RlIGlzIHNwbGl0XG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbmV3Tm9kZXMgIFRoZSBuZXcgbm9kZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc3BsaXROb2RlRXZlbnQobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaDtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc2V0UG9zaXRpb25zKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIGFmdGVyIG11bHRpcGxlIG5vZGVzIGFyZSBzcGxpdCBhdCBvbmNlXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbmV3Tm9kZXMgIFRoZSBuZXcgbm9kZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc3BsaXRNdWx0aXBsZU5vZGVzRXZlbnQobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaDtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc2V0UG9zaXRpb25zKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogdXNlZCB0byBzaGFyZSBjb2RlIGJldHdlZW4gam9pbk5vZGUgYW5kIGpvaW5NdWx0aXBsZU5vZGVcbiAgICAgICAgICAgICAqIHdoaWxlIHByZXZlbnRpbmcgYm90aCBoYW5kbGVycyBmaXJpbmdcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgICAgIG5vZGUgICAgVGhlIG5vZGUgdG8gam9pblxuICAgICAgICAgICAgICogQHJldHVybiAgICAge05vZGV9ICBUaGUgbmV3IG5vZGUgYWZ0ZXIgdGhlIGpvaW5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgX19qb2luTm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pbk5vZGVQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICAvL2NoZWNrIHRoYXQgbm9kZSBzdGlsbCBleGlzdHNcbiAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLm5vZGVzLmluZGV4T2Yobm9kZSkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBub2RlLmlkO1xuICAgICAgICAgICAgICAgIC8vaWYgaXQgaGFzIG5vIGFuY2VzdG9yLCBub3RoaW5nIHRvIGpvaW5cbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRyZW5fc3RydWN0LnRvcExldmVsLmluZGV4T2YobmFtZSkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHRvX2JlX2RlbGV0ZWQgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZV9uYW1lc19zZXQgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXNHcmFwaC5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIG5vZGUgd29uJ3QgYmUgY29sbGFwc2VkXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGgubm9kZXNbaV0uYW5jZXN0b3JzLmluZGV4T2Yobm9kZS5wYXJlbnQpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlX25hbWVzX3NldC5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXS5pZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b19iZV9kZWxldGVkLnB1c2godGhpc0dyYXBoLm5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGVfaWQgPSBub2RlLnBhcmVudDtcbiAgICAgICAgICAgICAgICBub2RlX25hbWVzX3NldC5wdXNoKG5vZGUucGFyZW50KTtcblxuICAgICAgICAgICAgICAgIC8vZm9ybWF0dGluZyBkYXRhXG4gICAgICAgICAgICAgICAgdmFyIHJhZGl1cyA9IG5vZGUucmFkaXVzIC8gdGhpc0dyYXBoLmNvbnN0cy5yYWRpdXNEZWNheTsgXG4gICAgICAgICAgICAgICAgdmFyIHhMb2MgPSBub2RlLng7XG4gICAgICAgICAgICAgICAgdmFyIHlMb2MgPSBub2RlLnk7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IG5vZGUuYW5jZXN0b3JzWzFdO1xuICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnMgPSBub2RlLmFuY2VzdG9ycy5zbGljZSgxKTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGUgPSBuZXcgVmlzdWFsaXplck5vZGUuTm9kZSh4TG9jLCB5TG9jLCBuZXdfbm9kZV9pZCwgbmV3X25vZGVfaWQsIHJhZGl1cywgcGFyZW50LCBhbmNlc3RvcnMpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5wdXNoKG5ld19ub2RlKTtcblxuICAgICAgICAgICAgICAgIHZhciByZXREYXRhID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuZ2V0Rmxvd0JldHdlZW5TZXQobm9kZV9uYW1lc19zZXQpO1xuICAgICAgICAgICAgICAgIC8vcmVtb3ZlIGFsbCBub2RlcyB0aGF0IHdpbGwgYmUgam9pbmVkXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b19iZV9kZWxldGVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlX3RvX2RlbGV0ZSA9IHRvX2JlX2RlbGV0ZWRbaV07XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5zcGxpY2UodGhpc0dyYXBoLm5vZGVzLmluZGV4T2Yobm9kZV90b19kZWxldGUpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlX3RvX2RlbGV0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YShyZXREYXRhLmxpbmtEYXRhLCB0aGlzR3JhcGgubm9kZXMpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0Tm9kZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdExpbmtzKCk7XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS5zcGxpdE5vZGVzLnNwbGljZShzdGF0ZS5zcGxpdE5vZGVzLmluZGV4T2YobmV3X25vZGUuaWQpLCAxKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBuZXdfbm9kZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBKb2lucyB0aGUgZ2l2ZW4gbm9kZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZSB0byBqb2luXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGpvaW5Ob2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3Tm9kZSA9IHRoaXMuX19qb2luTm9kZShub2RlKTtcbiAgICAgICAgICAgICAgICBpZiAobmV3Tm9kZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgXHR0aGlzLmpvaW5Ob2RlRXZlbnQobmV3Tm9kZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEpvaW5zIGFsbCB0aGUgZ2l2ZW4gbm9kZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlcyAgIFRoZSBub2RlcyB0byBqb2luXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGpvaW5NdWx0aXBsZU5vZGUobm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGVzID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0gdGhpcy5fX2pvaW5Ob2RlKG5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3X25vZGVzLnB1c2gocmVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5qb2luTXVsdGlwbGVOb2Rlc0V2ZW50KG5ld19ub2Rlcyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIGFmdGVyIGEgc2luZ2xlIG5vZGUgaXMgam9pbmVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBuZXdOb2RlICBUaGUgbmV3IG5vZGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgam9pbk5vZGVFdmVudChuZXdOb2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIGFmdGVyIG11bHRpcGxlIG5vZGVzIGFyZSBqb2luZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBuZXdOb2RlcyAgVGhlIG5ldyBub2Rlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBqb2luTXVsdGlwbGVOb2Rlc0V2ZW50KG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgUG9saWN5OiBTcGxpdEpvaW5Ob2RlUG9saWN5XG4gICAgICAgIH1cbn1dKTtcblxuXG5cblxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtwb2xpY2llcycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzJywge1xuICAgICAgICAgICAgdXJsOiAnL25ldHdvcmtwb2xpY2llcycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbicsIHtcbiAgICAgICAgICAgIHVybDogJy9pc29sYXRpb24nLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzx1aS12aWV3Lz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5pc29sYXRpb24uY3JlYXRlJywge1xuICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdpc29sYXRpb25wb2xpY3ljcmVhdGUnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGgnLCB7XG4gICAgICAgICAgICB1cmw6ICcvYmFuZHdpZHRoJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8dWktdmlldy8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuYmFuZHdpZHRoLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnYmFuZHdpZHRocG9saWN5Y3JlYXRlJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMucmVkaXJlY3Rpb24nLCB7XG4gICAgICAgICAgICB1cmw6ICcvcmVkaXJlY3Rpb24nLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzx1aS12aWV3Lz4nXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3MnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcycsIHtcbiAgICAgICAgICAgIHVybDogJy9uZXR3b3JrcycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIi8qKlxuICogVGhpcyBwb2xpY3kgaXMgdXNlZCB0byBjaGFuZ2UgdGhlIHZpZXcgdG8gZm9jdXMgb24gc3BsaXR0aW5nIGFuZCBcbiAqIGpvaW5pbmcgZXZlbnRzLlxuICogT3ZlcnJpZGVzIHRoZSBjZXJ0YWluIGZvcmNlIGxheW91dCBmdW5jdGlvbnMgb2YgdGhlIGdyYXBoIHRvIHBhcnRpdGlvbiBhIHNwbGl0XG4gKiBpbnRvIHRoZSBmb2N1c2VkIG5vZGVzIGFuZCB0aGUgY29ubmVjdGVkIG5vZGVzLlxuICogXG4gKiBIYXMgc2F2ZS9sb2FkIG1ldGhvZHMgZm9yIHRoZSBzYXZlIHN0YXRlIHBvbGljeS5cbiAqIEhhcyBiYWNrIGJ1dHRvbiBzdXBwb3J0LlxuICogQ2FuIGF1dG8gY2hhbmdlIHRoZSB0aXRsZSBvZiB0aGUgZ3JhcGguXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdTcGxpdEpvaW5WaWV3UG9saWN5JywgWydTcGxpdEpvaW5Ob2RlUG9saWN5JywgJ1Zpc3VhbGl6ZXJOb2RlJywgZnVuY3Rpb24gKFNwbGl0Sm9pbk5vZGVQb2xpY3ksIFZpc3VhbGl6ZXJOb2RlKSB7IFxuICAgICAgICBjbGFzcyBTcGxpdEpvaW5WaWV3UG9saWN5IGV4dGVuZHMgU3BsaXRKb2luTm9kZVBvbGljeS5Qb2xpY3l7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgICAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBvbGljeU5hbWUgPSBcIlNwbGl0Sm9pblZpZXdQb2xpY3lcIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5pdGlhbGl6ZShncmFwaCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3VwZXIuaW5pdGlhbGl6ZShncmFwaCk7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLnNhdmVkU3RhdGVzID0gW107XG4gICAgICAgICAgICAgICAgLy8gc3RhdGUuZm9jdXNHcm91cCA9IG51bGw7XG4gICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5ID0gW107XG4gICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMgPSBbXTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5mb2NpID0gW107XG4gICAgICAgICAgICAgICAgc3RhdGUuem9vbXMgPSB7fTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5sYXlvdXQgPSB7fTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5sYXlvdXREZWZhdWx0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS56b29tRGVmYXVsdCA9IG51bGw7XG4gICAgICAgICAgICAgICAgc3RhdGUubm9kZUlkc1RvUmVzaG93ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uRWxlbSA9IG51bGw7XG4gICAgICAgICAgICAgICAgc3RhdGUudGl0bGVFbGVtID0gbnVsbDtcblxuICAgICAgICAgICAgICAgIHZhciBjb25zdHMgPSBncmFwaC5jb25zdHMuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIGNvbnN0cy5ib3VuZGFyeSA9IDAuODtcblxuICAgICAgICAgICAgICAgIC8vb3ZlcnJpZGluZyBkM2ZvcmNlIG1ldGhvZHMgb2YgdGhlIGdyYXBoLlxuICAgICAgICAgICAgICAgIGdyYXBoLmQzRm9yY2VCb3VuZHMgPSB0aGlzLmQzRm9yY2VCb3VuZHM7XG4gICAgICAgICAgICAgICAgZ3JhcGguZDNGb3JjZVRpY2sgPSB0aGlzLmQzRm9yY2VUaWNrO1xuICAgICAgICAgICAgICAgIGdyYXBoLmQzRm9yY2VTdGFydCA9IHRoaXMuZDNGb3JjZVN0YXJ0O1xuICAgICAgICAgICAgICAgIGdyYXBoLmQzRm9yY2VFbmQgPSB0aGlzLmQzRm9yY2VFbmQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogTGlua3MgdGhlIHByb3ZpZGVkIGVsZW1lbnQgYSBiYWNrIGJ1dHRvbiBmZWF0dXJlXG4gICAgICAgICAgICAgKiBEb2Vzbid0IHRyaWdnZXIgdGhlIG9uLWNsaWNrIGV2ZW50XG4gICAgICAgICAgICAgKiBUaGF0IHNob3VsZCBiZSBkb25lIHRocm91Z2ggYW5ndWxhciBuZy1jbGljay5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7alF1ZXJ5fSAgZWxlbSAgICBUaGUganF1ZXJ5IHNlbGVjdGVkIGVsZW1lbnRcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5zdGFsbEJhY2tCdXR0b24oZWxlbSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5ID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIHN0YXRlLmJhY2tCdXR0b25FbGVtID0gZWxlbTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51bmRvTGFzdEV2ZW50LmNhbGwodGhpc1BvbGljeSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2lsbCBhbGxvdyB0aGlzIHBvbGljeSB0byBjaGFuZ2UgdGhlIHRpdGxlIG9mIHRoZSBncmFwaFxuICAgICAgICAgICAgICogYXMgc3BsaXQgYW5kIGpvaW4gZXZlbnRzIG9jY3VyLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtqUXVlcnl9ICBlbGVtICAgIFRoZSBqcXVlcnkgc2VsZWN0ZWQgZWxlbWVudFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbnN0YWxsVGl0bGUoZWxlbSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgc3RhdGUudGl0bGVFbGVtID0gZWxlbTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgYmVpbmcgZGVzdHJveWVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIHNhdmVkU3RhdGUgIEFueSBwcm9wZXJ0eSBvbiB0aGlzXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0IHdpbGwgYmUgYWNjZXNzaWJsZVxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gdGhlIHZpZXcgcmVsb2Fkc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkZXN0cm95KHNhdmVkU3RhdGUpIHtcbiAgICAgICAgICAgICAgICAvL09ubHkgaWYgdGhlIHNhdmUgc3RhdGUgcG9saWN5IGlzIGluc3RhbGxlZFxuICAgICAgICAgICAgICAgIGlmIChzYXZlZFN0YXRlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zYXZlKHNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBXaWxsIHNhdmUgdGhlIGN1cnJlbnQgc3RhdGUsIGFuZCBhbGwgaGlzdG9yeS5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgc2F2ZWRTdGF0ZSAgQW55IHByb3BlcnR5IG9uIHRoaXNcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3Qgd2lsbCBiZSBhY2Nlc3NpYmxlXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiB0aGUgdmlldyByZWxvYWRzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNhdmUoc2F2ZWRTdGF0ZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgICAgIHZhciBsaW5rcyA9IHRoaXNHcmFwaC5saW5rcztcbiAgICAgICAgICAgICAgICB2YXIgY3VyclRpdGxlID0gbnVsbDtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUudGl0bGVFbGVtICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgY3VyclRpdGxlID0gc3RhdGUudGl0bGVFbGVtLnRleHQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGZvY3VzR3JvdXBzID0gc3RhdGUuZm9jdXNHcm91cHM7XG4gICAgICAgICAgICAgICAgdmFyIGV2ZW50SGlzdG9yeSA9IHN0YXRlLmV2ZW50SGlzdG9yeTtcbiAgICAgICAgICAgICAgICB2YXIgem9vbXMgPSBzdGF0ZS56b29tcztcbiAgICAgICAgICAgICAgICB2YXIgbGF5b3V0ID0gc3RhdGUubGF5b3V0O1xuXG4gICAgICAgICAgICAgICAgdmFyIGxheW91dERlZmF1bHQgPSBzdGF0ZS5sYXlvdXREZWZhdWx0O1xuICAgICAgICAgICAgICAgIHZhciB6b29tRGVmYXVsdCA9IHN0YXRlLnpvb21EZWZhdWx0O1xuICAgICAgICAgICAgICAgIHZhciByZXQgPSB7bm9kZXM6bm9kZXMsIGxpbmtzOmxpbmtzLCBcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVzOnN0YXRlLnNhdmVkU3RhdGVzLCBjdXJyVGl0bGU6Y3VyclRpdGxlLCBcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNHcm91cHM6IGZvY3VzR3JvdXBzLFxuICAgICAgICAgICAgICAgICAgICBldmVudEhpc3Rvcnk6ZXZlbnRIaXN0b3J5LCB6b29tczp6b29tcyxcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0OmxheW91dCwgbGF5b3V0RGVmYXVsdDpsYXlvdXREZWZhdWx0LFxuICAgICAgICAgICAgICAgICAgICB6b29tRGVmYXVsdDp6b29tRGVmYXVsdH07XG4gICAgICAgICAgICAgICAgc2F2ZWRTdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5ID0gcmV0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgYmUgY2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIHJlbG9hZGVkLCBhc3N1bWluZ1xuICAgICAgICAgICAgICogc2F2ZSBzdGF0ZSBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGxvYWRTdGF0ZSAgQ29udGFpbnMgYWxsIHRoZSBzYXZlZFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFibGVzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGxvYWQobG9hZFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgbG9hZFN0YXRlID0gbG9hZFN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG4gICAgICAgICAgICAgICAgc3RhdGUuc2F2ZWRTdGF0ZXMgPSBsb2FkU3RhdGUuc3RhdGVzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IGxvYWRTdGF0ZS5saW5rcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMgPSBsb2FkU3RhdGUubm9kZXM7XG5cbiAgICAgICAgICAgICAgICB2YXIgY3VyclRpdGxlID0gbG9hZFN0YXRlLmN1cnJUaXRsZTtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUudGl0bGVFbGVtICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUudGl0bGVFbGVtLnRleHQoY3VyclRpdGxlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5ID0gbG9hZFN0YXRlLmV2ZW50SGlzdG9yeTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3VwcyA9IGxvYWRTdGF0ZS5mb2N1c0dyb3VwcztcbiAgICAgICAgICAgICAgICBzdGF0ZS56b29tcyA9IGxvYWRTdGF0ZS56b29tcztcbiAgICAgICAgICAgICAgICBzdGF0ZS5sYXlvdXQgPSBsb2FkU3RhdGUubGF5b3V0O1xuICAgICAgICAgICAgICAgIHN0YXRlLmxheW91dERlZmF1bHQgPSBsb2FkU3RhdGUubGF5b3V0RGVmYXVsdDtcbiAgICAgICAgICAgICAgICBzdGF0ZS56b29tRGVmYXVsdCA9IGxvYWRTdGF0ZS56b29tRGVmYXVsdDtcblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5iYWNrQnV0dG9uRWxlbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuYmFja0J1dHRvbkVsZW0uZmFkZVRvKCdzbG93JywgMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuXG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF8uaW5jbHVkZXMoY2hpbGRyZW5fc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzBdXSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5pZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJmb2N1c1wiO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImNvbm5lY3RlZFwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvL2xvYWRpbmcgYSBwcmV2aW91cyBsYXlvdXRcbiAgICAgICAgICAgICAgICB2YXIgbGF5b3V0O1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ID0gc3RhdGUubGF5b3V0RGVmYXVsdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSBzdGF0ZS56b29tRGVmYXVsdDsgXG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQoem9vbVswXSwgem9vbVsxXSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSBzdGF0ZS56b29tc1tzdGF0ZS5mb2N1c0dyb3Vwc107XG4gICAgICAgICAgICAgICAgICAgIGlmICh6b29tICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQoem9vbVswXSwgem9vbVsxXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ID0gc3RhdGUubGF5b3V0W3N0YXRlLmZvY3VzR3JvdXBzXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL2xheW91dCBjYW4ndCBiZSBudWxsXG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24obikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcG9zID0gbGF5b3V0W24uaWRdO1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9zID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGxheW91dCwgbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbi54ID0gcG9zLng7XG4gICAgICAgICAgICAgICAgICAgIG4ueSA9IHBvcy55O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZS5pbml0Rm9yY2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaC5jYWxsKHRoaXNHcmFwaCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kudXBkYXRlR3JhcGhDYWxsYmFjay5jYWxsKHRoaXNQb2xpY3kpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRyaWdnZXJpbmcgc3BsaXQgb24gZG91YmxlIGNsaWNrXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEZvY3VzIGdyb3VwIHN0b3JlcyB0aGUgbm9kZSB0aGF0IGlzIGFib3V0IHRvIGJlIHNwbGl0LlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBXaGVuIGZvY3VzIGdyb3VwIGhhcyBsZW5ndGggMCwgdGhlIGZpcnN0IHNwbGl0IFxuICAgICAgICAgICAgICogd2lsbCBqdXN0IGJlIHB1c2hlZCBvbi5cbiAgICAgICAgICAgICAqIFRoZSBub2RlIHdpbGwgYmUgc3BsaXQgYW5kIHB1c2hlZCB0byB0aGUgdG9wIGhhbGYgXG4gICAgICAgICAgICAgKiBvZiB0aGUgc2NyZWVuLCBhbmQgdGhlIGJvdHRvbSBoYWxmIHdpbGwgY29udGFpbiBhbnlcbiAgICAgICAgICAgICAqIG5vZGVzIGl0IGhhcyBjb25uZWN0aW9ucyB0by5cbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogV2hlbiBhIGZvY3VzIGdyb3VwIGxlbmd0aCBpcyA+PSAxLCBpZiB0aGUgbm9kZSB0byBiZVxuICAgICAgICAgICAgICogc3BsaXQgaXMgYSBmb2N1cyBub2RlLCBpdCB3aWxsIHJlcGxhY2UgZm9jdXNHcm91cHNbMF0gYW5kXG4gICAgICAgICAgICAgKiB0aGUgdG9wIGhhbGYgd2lsbCBiZSBpdHMgY2hpbGRyZW4sIGFuZCBib3R0b20gaGFsZiB3aWxsXG4gICAgICAgICAgICAgKiBiZSB0aGUgbm9kZXMgaXQgaGFzIGNvbm5lY3Rpb25zIHRvLlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBJZiB0aGUgc3BsaXQgaXMgaW4gdGhlIGJvdHRvbSBoYWxmLCB0aGVuIHRoZSBib3R0b20gaGFsZlxuICAgICAgICAgICAgICogd2lsbCBkaXNwbGF5IGl0J3MgY2hpbGRyZW4gYW5kIHdpbGwgb25seSBzaG93IGNvbm5lY3Rpb25zIGJldHdlZW5cbiAgICAgICAgICAgICAqIHRoZSB0d28gZ3JvdXBzLCBhbmQgd2lsbCByZXBsYWNlIGZvY3VzR3JvdXBzWzFdLlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmp9ICAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGQgICAgICAgVGhlIG1hdGNoaW5nIGRhdGEgb2JqZWN0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGRibGNsaWNrKGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgLy9jaGVjayBpZiBjYW4gc3BsaXRcbiAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IGQuaWQ7XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRyZW5fc3RydWN0W25hbWVdID09PSB1bmRlZmluZWQgfHwgXy5pc0VtcHR5KGNoaWxkcmVuX3N0cnVjdFtuYW1lXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzLnNsaWNlKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAwKSB7IC8vdG9wbGV2ZWwgc3BsaXRcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMucHVzaChkLmlkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKF8uaW5jbHVkZXMoY2hpbGRyZW5fc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzBdXSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQuaWQpKSB7IC8vc3BsaXR0aW5nIGEgZm9jdXMgbm9kZVxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwc1swXSA9IGQuaWQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDEpIHsvL3NwbGl0dGluZyBhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2Nvbm5lY3RlZCBub2RlXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzLnB1c2goZC5pZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChfLmluY2x1ZGVzKGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1sxXV0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQuaWQpKSB7Ly9zcGxpdHRpbmcgYVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29ubmVjdGVkIG5vZGVcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHNbMV0gPSBkLmlkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMiAmJiBcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzWzFdID09PSBkLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vU3BsaXR0aW5nIGEgY29ubmVjdGVkIG5vZGUsIGtlZXAgYWxsIGZvY3VzIG5vZGVzXG4gICAgICAgICAgICAgICAgICAgIHZhciBub2Rlc1RvS2VlcCA9IFtkXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVJZHNUb1Jlc2hvdyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ3JvdXBPbmVOb2RlcyA9IGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV07XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKGdyb3VwT25lTm9kZXMsIG5vZGUuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlkc1RvUmVzaG93LnB1c2gobm9kZS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNUb0tlZXAucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy9NYWtlIHNwbGl0IG5vZGVzIHRoZSBmb2N1cyBhbmQga2VlcCBub2RlcyB0aGF0IGFyZSBjb25uZWN0ZWRcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVzVG9LZWVwID0gW2RdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZUlkc1RvUmVzaG93ID0gW107XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubGlua3MsIGZ1bmN0aW9uKGxpbmspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaW5rLnNvdXJjZSA9PT0gZCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzVG9SZXNob3cuaW5kZXhPZihsaW5rLnRhcmdldC5pZCkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rLnRhcmdldC5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluay50YXJnZXQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzVG9SZXNob3cucHVzaChsaW5rLnRhcmdldC5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNUb0tlZXAucHVzaChsaW5rLnRhcmdldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxpbmsudGFyZ2V0ID09PSBkICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzVG9SZXNob3cuaW5kZXhPZihsaW5rLnNvdXJjZS5pZCkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rLnNvdXJjZS5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluay5zb3VyY2UuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzVG9SZXNob3cucHVzaChsaW5rLnNvdXJjZS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNUb0tlZXAucHVzaChsaW5rLnNvdXJjZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vUmVtb3ZpbmcgbGlua3MgZnJvbSB0aGUgbm9kZSB0byBiZSBzcGxpdFxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2goZnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5pZCAhPT0gZC5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuXG4gICAgICAgICAgICAgICAgLy9kaXNhYmxpbmcgdXBkYXRlIGdyYXBoIHRvIHByZXZlbnQgbmV3IGRhdGEgZnJvbVxuICAgICAgICAgICAgICAgIC8vcmVkcmF3aW5nIGxpbmtzIHdoaWxlIHRoZXJlIGFyZSBhbmltYXRpb25zIGdvaW5nIG9uXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN0YXRlLmRpc2FibGVVcGRhdGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2goZnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5pZCAhPT0gZC5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLnRyYW5zaXRpb24oKS5kZWxheSgyMDApLmR1cmF0aW9uKDQwMCkuc3R5bGUoXCJvcGFjaXR5XCIsIDApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9kaXNhYmxpbmcgcXRpcCBpZiBpbnN0YWxsZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkKHRoaXMpLnF0aXAgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykucXRpcCgnZGlzYWJsZScsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgdHJhbnNsYXRlID0gdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKCk7XG4gICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKTtcbiAgICAgICAgICAgICAgICB2YXIgeExvYyA9IChwYXJzZUZsb2F0KHRoaXNHcmFwaC5zdmcuc3R5bGUoXCJ3aWR0aFwiKSkgLyBzY2FsZSkgLyAyICArIHRyYW5zbGF0ZVswXTtcbiAgICAgICAgICAgICAgICB2YXIgeUxvYyA9IChwYXJzZUZsb2F0KHRoaXNHcmFwaC5zdmcuc3R5bGUoXCJoZWlnaHRcIikpIC8gc2NhbGUpLyAyICArIHRyYW5zbGF0ZVsxXTtcbiAgICAgICAgICAgICAgICBkLnhTdGFydCA9IGQueDtcbiAgICAgICAgICAgICAgICBkLnlTdGFydCA9IGQueTtcbiAgICAgICAgICAgICAgICBkLnggPSB4TG9jO1xuICAgICAgICAgICAgICAgIGQueSA9IHlMb2M7XG4gICAgICAgICAgICAgICAgZDNub2RlLnRyYW5zaXRpb24oXCJub2RlUG9zaXRpb25UcmFuc2l0aW9uXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZHVyYXRpb24oNzUwKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHJUd2VlbihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHhTdGFydCA9IGQueFN0YXJ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB5U3RhcnQgPSBkLnlTdGFydDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnhTdGFydCA9IGQueDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnlTdGFydCA9IGQueTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZDMuaW50ZXJwb2xhdGVTdHJpbmcoXCJ0cmFuc2xhdGUoXCIgKyB4U3RhcnQgKyBcIixcIiArIHlTdGFydCArIFwiKVwiLCBcInRyYW5zbGF0ZShcIiArIGQueCArIFwiLFwiICsgZC55ICsgXCIpXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3BsaXROb2RlRnVuYyA9IHN1cGVyLnNwbGl0Tm9kZTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5ub2RlSWRzVG9SZXNob3cgPSBub2RlSWRzVG9SZXNob3c7XG4gICAgICAgICAgICAgICAgLy93YWl0aW5nIGZvciBub2RlIHRyYW5zaXRpb25cbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzID0gbm9kZXNUb0tlZXA7XG4gICAgICAgICAgICAgICAgICAgIHNwbGl0Tm9kZUZ1bmMuY2FsbCh0aGlzUG9saWN5LCBkKTtcbiAgICAgICAgICAgICAgICB9LCA3NTApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRvIGJlIGNhbGxlZCBhZnRlciB0aGUgZ3JhcGggaXMgc3BsaXQuXG4gICAgICAgICAgICAgKiBCcmluZ3MgYWxsIG5vZGVzIGJhY2sgaW50byB2aWV3IGFuZCBzZXRzIHRoZWlyIGF0dHJpYnV0ZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlR3JhcGhDYWxsYmFjaygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5lYWNoKGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS50cmFuc2l0aW9uKCkuZHVyYXRpb24oNDAwKS5zdHlsZShcIm9wYWNpdHlcIiwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykuY2xhc3NlZChcImZvY3VzXCIsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5jbGFzc2VkKFwiY29ubmVjdGVkXCIsIGZhbHNlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuU3BsaXRKb2luVmlld1BvbGljeSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID09PSBcImZvY3VzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLmNsYXNzZWQoXCJmb2N1c1wiLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vZGUuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID09PSBcImNvbm5lY3RlZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5jbGFzc2VkKFwiY29ubmVjdGVkXCIsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgc3RhdGUubm9kZUlkc1RvUmVzaG93ID0gbnVsbDtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSYW5kb21seSBzZXRzIHRoZSBwb3NpdGlvbnMgb2YgYW55IHVuc2V0IG5vZGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc2V0UG9zaXRpb25zKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5ID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGhDb25zdHMgPSB0aGlzR3JhcGguY29uc3RzO1xuXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IGdyYXBoQ29uc3RzLmRpc3BsYXlPZmZzZXQ7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgICAgIHZhciByZXQgPSB0aGlzUG9saWN5LmQzRm9yY2VCb3VuZHMuY2FsbCh0aGlzR3JhcGgpO1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0UmFuZG9tSW50KG1pbiwgbWF4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluICsgMSkpICsgbWluO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIF8uZm9yRWFjaChub2RlcywgZnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS54ID09IG51bGwgfHwgbm9kZS55ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4ID0gZ2V0UmFuZG9tSW50KG5vZGUucmFkaXVzICsgb2Zmc2V0LCByZXQud2lkdGggLSBub2RlLnJhZGl1cyAtIG9mZnNldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgeSA9IGdldFJhbmRvbUludChub2RlLnJhZGl1cyArIG9mZnNldCwgcmV0LmhlaWdodCAtIG5vZGUucmFkaXVzIC0gb2Zmc2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUueCA9IHg7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLnkgPSB5O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgb24gdGhlIHN0YXJ0IG9mIHRoZSBkMyBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKiBXaWxsIG92ZXJyaWRlIHRoZSBtZXRob2Qgb2YgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKiBcInRoaXNcIiBwb2ludHMgdG8gdGhlIGdyYXBoXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGQzRm9yY2VTdGFydCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlc1xuICAgICAgICAgICAgICAgICAgICAuYXR0cignY3gnLCBmdW5jdGlvbihkKSB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQueFN0YXJ0ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnhTdGFydCA9IChkLnhTdGFydCAqIHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCkpICsgdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKClbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC54O1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY3knLCBmdW5jdGlvbihkKSB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQueVN0YXJ0ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnlTdGFydCA9IChkLnlTdGFydCAqdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKSkgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKVsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd4MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLnk7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd4MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lnk7IH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBvbiB0aGUgc3RhcnQgb2YgdGhlIGQzIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqIFdpbGwgb3ZlcnJpZGUgdGhlIG1ldGhvZCBvZiB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqIFwidGhpc1wiIHBvaW50cyB0byB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZUVuZCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5ID0gc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGVQb2xpY3kubGF5b3V0RGVmYXVsdCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWZhdWx0TGF5b3V0ID0ge307XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRMYXlvdXRbbi5pZF0gPSB7eDpuLngsIHk6bi55fTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5LmxheW91dERlZmF1bHQgPSBkZWZhdWx0TGF5b3V0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2NhbGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdHJhbnNsYXRlID0gdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5Lnpvb21EZWZhdWx0ID0gW3RyYW5zbGF0ZSwgc2NhbGVdOyBcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlc1xuICAgICAgICAgICAgICAgICAgICAuYXR0cignY3gnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjeScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQueTsgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHMuYXR0cigneDEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS55OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneDInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC55OyB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBXaWxsIGJlIGNhbGxlZCBkdXJpbmcgRDMgZm9yY2Ugc2ltdWxhdGlvbnNcbiAgICAgICAgICAgICAqIGJ5IHRoZSBncmFwaCwgc28gXCJ0aGlzXCIgd2lsbCBwb2ludCB0byB0aGUgZ3JhcGggb2JqZWN0XG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge251bWJlcn0gIHdpZHRoICAgRDMgTGF5b3V0IFdpZHRoXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgaGVpZ2h0ICBEMyBMYXlvdXQgSGVpZ2h0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGQzRm9yY2VUaWNrKGUsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5ID0gc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSBjb25zdHMuZGlzcGxheU9mZnNldDtcbiAgICAgICAgICAgICAgICB2YXIgc2NhbGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpO1xuXG4gICAgICAgICAgICAgICAgLy8gTW92ZSBub2RlcyB0b3dhcmQgY2x1c3RlciBmb2N1cy5cbiAgICAgICAgICAgICAgICB2YXIgZm9jaSA9IHN0YXRlUG9saWN5LmZvY2k7XG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ3Jhdml0eShhbHBoYSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZvY2kubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID09PSBcImZvY3VzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55ICs9IChmb2NpWzBdIC0gZC55KSAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSArPSAoZm9jaVsxXSAtIGQueSkgKiBhbHBoYTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC54ICs9ICh3aWR0aC8yIC0gZC54KSAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gKGhlaWdodC8yIC0gZC55KSAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCArPSAod2lkdGgvMiAtIGQueCkgKiBhbHBoYTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBNYWtlIHN1cmUgbm9kZXMgYXJlIHdpdGhpbiBib3VuZHNcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlc1xuICAgICAgICAgICAgICAgICAgICAuZWFjaCh0aGlzLmQzRm9yY2VDb2xsaWRlKC41KSlcbiAgICAgICAgICAgICAgICAgICAgLmVhY2goZ3Jhdml0eSguMiAqIGUuYWxwaGEpKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcImN4XCIsIGZ1bmN0aW9uKGQpIHsgXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC54ID0gTWF0aC5tYXgoKGQucmFkaXVzICsgb2Zmc2V0KS9zY2FsZSwgTWF0aC5taW4od2lkdGggKyAoKC1vZmZzZXQtIGQucmFkaXVzKSAvIHNjYWxlKSwgZC54KSk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiY3lcIiwgZnVuY3Rpb24oZCkgeyBcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLlNwbGl0Sm9pblZpZXdQb2xpY3kgPT0gbnVsbCB8fCBkLlNwbGl0Sm9pblZpZXdQb2xpY3kgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSA9IE1hdGgubWF4KChkLnJhZGl1cyArIG9mZnNldCkvc2NhbGUsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5taW4oaGVpZ2h0ICsgKCgtb2Zmc2V0IC0gZC5yYWRpdXMpL3NjYWxlKSwgZC55KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPT09IFwiZm9jdXNcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSA9IE1hdGgubWF4KGQucmFkaXVzICsgb2Zmc2V0LCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgubWluKChoZWlnaHQgKyAoKC1vZmZzZXQgLSBkLnJhZGl1cykvc2NhbGUpKSpjb25zdHMuU3BsaXRKb2luVmlld1BvbGljeS5ib3VuZGFyeSwgZC55KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPT09IFwiY29ubmVjdGVkXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgPSBNYXRoLm1heCgoaGVpZ2h0ICsgKChvZmZzZXQgLSBkLnJhZGl1cykvc2NhbGUpKSAqY29uc3RzLlNwbGl0Sm9pblZpZXdQb2xpY3kuYm91bmRhcnksIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5taW4oaGVpZ2h0ICsgKCgtb2Zmc2V0IC0gZC5yYWRpdXMpL3NjYWxlKSwgZC55KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHNcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueTsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueTsgfSk7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxjdWxhdGVzIHRoZSBib3VuZGFyaWVzIG9mIHRoZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIFdpbGwgYmUgY2FsbGVkIGR1cmluZyBEMyBmb3JjZSBzaW11bGF0aW9uc1xuICAgICAgICAgICAgICogYnkgdGhlIGdyYXBoLCBzbyBcInRoaXNcIiB3aWxsIHBvaW50IHRvIHRoZSBncmFwaCBvYmplY3RcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHJldHVybiAgICAge09iamVjdH0gICAgICAgICAgUmV0dXJucyBhbiBvYmplY3RcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQgaGFzIHRoZSB3aWR0aFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5kIGhlaWdodCBhcyBcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXMgXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGQzRm9yY2VCb3VuZHMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzLFxuICAgICAgICAgICAgICAgICAgICBjb25zdHNQb2xpY3kgPSBjb25zdHMuU3BsaXRKb2luVmlld1BvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kgPSBzdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXNHcmFwaC5ub2RlcztcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjYWxjTWF4Tm9kZXMod2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYXJlYSA9IHdpZHRoICogaGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmFkaXVzID0gdGhpc0dyYXBoLmNvbnN0cy5zdGFydFJhZGl1cztcbiAgICAgICAgICAgICAgICAgICAgLy90cmVhdGluZyB0aGVtIGFzIGEgc3F1YXJlIGZvciBhcHByb3hcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxlbmd0aCA9IChyYWRpdXMgKjMuNSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhbW91bnQgPSBhcmVhIC8obGVuZ3RoICpsZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYW1vdW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL1RoZSBvZmZzZXQgaXMgdGhlIGJ1ZmZlciBmcm9tIHRoZSBlZGdlc1xuICAgICAgICAgICAgICAgIC8vT3JpZ2luYWwgV2lkdGggYW5kIEhlaWdodCBhcmUgZ2l2ZW4gdG8gdGhlIGZvcmNlIGxheW91dFxuICAgICAgICAgICAgICAgIC8vc28gdGhhdCBpdCBpcyBjZW50ZXJlZCwgYnV0IG5vZGVzIHdpbGwgYmUgZm9yY2VkIHRvIGJlXG4gICAgICAgICAgICAgICAgLy93aXRoaW4gdGhlIG9mZnNldCBib3VuZHNcbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gY29uc3RzLmRpc3BsYXlPZmZzZXQ7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z1dpZHRoID0gcGFyc2VGbG9hdCh0aGlzR3JhcGguc3ZnLnN0eWxlKFwid2lkdGhcIikpO1xuICAgICAgICAgICAgICAgIHZhciBzdmdIZWlnaHQgPSBwYXJzZUZsb2F0KHRoaXNHcmFwaC5zdmcuc3R5bGUoXCJoZWlnaHRcIikpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gc3ZnV2lkdGg7XG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IHN2Z0hlaWdodDtcblxuICAgICAgICAgICAgICAgIHZhciBhbW91bnQgPSBjYWxjTWF4Tm9kZXMod2lkdGggLSAoMipvZmZzZXQpLCBoZWlnaHQgLSAoMipvZmZzZXQpKTtcbiAgICAgICAgICAgICAgICB2YXIgc2NhbGUgPSAxO1xuICAgICAgICAgICAgICAgIGlmIChub2Rlcy5sZW5ndGggPiBhbW91bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NhbGUgPSBhbW91bnQgLyBub2Rlcy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQodGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKCksIHNjYWxlKTtcbiAgICAgICAgICAgICAgICAgICAgd2lkdGggLz0gc2NhbGU7XG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCAvPSBzY2FsZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguem9vbWVkKHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpLCBzY2FsZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9jYWxjdWxhdGluZyBmb2NpIGZvciBzaW11bGF0aW9uXG4gICAgICAgICAgICAgICAgdmFyIGZvY3VzR3JvdXBzID0gc3RhdGVQb2xpY3kuZm9jdXNHcm91cHM7XG4gICAgICAgICAgICAgICAgdmFyIGZvY2k7XG4gICAgICAgICAgICAgICAgaWYgKGZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBmb2NpID0gW2hlaWdodC8yXTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL3NldHRpbmcgZm9jaSBoZWlnaHQgcG9zaXRpb24gYmFzZWQgb24gcGVyY2VudGFnZVxuICAgICAgICAgICAgICAgICAgICB2YXIgZm9jdXNOb2RlcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFtmb2N1c0dyb3Vwc1swXV07XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0c1BvbGljeS5ib3VuZGFyeSA9IGZvY3VzTm9kZXMubGVuZ3RoIC8gbm9kZXMubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdG9wID0gaGVpZ2h0ICogY29uc3RzUG9saWN5LmJvdW5kYXJ5O1xuICAgICAgICAgICAgICAgICAgICB2YXIgYm90ID0gaGVpZ2h0IC0gdG9wO1xuICAgICAgICAgICAgICAgICAgICBpZiAodG9wIDwgMip0aGlzR3JhcGguY29uc3RzLm1heFJhZGl1cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3RzUG9saWN5LmJvdW5kYXJ5ID0gKDIuNSAqIHRoaXNHcmFwaC5jb25zdHMubWF4UmFkaXVzKSAvIGhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvcCA9IGhlaWdodCAqIGNvbnN0c1BvbGljeS5ib3VuZGFyeTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvdCA9IGhlaWdodCAtIHRvcDtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChib3QgPCAyKiB0aGlzR3JhcGguY29uc3RzLm1heFJhZGl1cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3RzUG9saWN5LmJvdW5kYXJ5ID0gMSAtICgoMi41ICogdGhpc0dyYXBoLmNvbnN0cy5tYXhSYWRpdXMpIC8gaGVpZ2h0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvcCA9IGhlaWdodCAqIGNvbnN0c1BvbGljeS5ib3VuZGFyeTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvdCA9IGhlaWdodCAtIHRvcDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmb2NpID0gW3RvcC8yLCB0b3AgKyBib3QgLyAyXTtcblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdGF0ZVBvbGljeS5mb2NpID0gZm9jaTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge3dpZHRoOndpZHRoLCBoZWlnaHQ6aGVpZ2h0fTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgYWZ0ZXIgYSBzaW5nbGUgbm9kZSBpcyBzcGxpdFxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBuZXdOb2RlcyAgVGhlIG5ldyBub2Rlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzcGxpdE5vZGVFdmVudChuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKG5ld05vZGVzLCBmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV0sIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiZm9jdXNcIjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIHRpdGxlID0gbmV3Tm9kZXNbMF0ucGFyZW50O1xuICAgICAgICAgICAgICAgIC8vIHN0YXRlLmZvY3VzR3JvdXAgPSB0aXRsZTtcblxuICAgICAgICAgICAgICAgIC8vaWYgdGhlIGxhc3QgZXZlbnQgaGFzIHRoZSBzYW1lIGlkLCBpdCBtdXN0IGJlIHRoZVxuICAgICAgICAgICAgICAgIC8vb3BwcG9zaXRlIG9mIHRoaXMgZXZlbnQsIHNvIHdlIHJlbW92ZSB0aGF0IGV2ZW50IGZyb21cbiAgICAgICAgICAgICAgICAvL3RoZSBldmVudCBzdGFjay5cbiAgICAgICAgICAgICAgICAvL090aGVyd2lzZSwgd2UgYWRkIHRoZSBldmVudCBvdCB0aGUgc3RhY2tcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCAhPT0gMCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5W3N0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggLSAxXS5pZCA9PT0gdGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5LnBvcCgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeS5wdXNoKHtpZDp0aXRsZSwgZXZlbnQ6J3NwbGl0J30pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5iYWNrQnV0dG9uRWxlbSAhPSBudWxsICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuYmFja0J1dHRvbkVsZW0uZmFkZVRvKCdzbG93JywgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS50aXRsZUVsZW0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ICs9IHN0YXRlLmZvY3VzR3JvdXBzWzBdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0gJyAmICcgKyBzdGF0ZS5mb2N1c0dyb3Vwc1sxXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS50aXRsZUVsZW0udGV4dCh0ZXh0KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3JlLWVuYWJsZSBncmFwaCB1cGRhdGVcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3RhdGUuZGlzYWJsZVVwZGF0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kuc2V0TGF5b3V0KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU2V0cyB0aGUgbGF5b3V0IG9mIHRoZSBub2Rlcy4gXG4gICAgICAgICAgICAgKiBJZiB0aGVyZSBpcyBhIHByZXZpb3VzIGxheW91dCwgaXQgd2lsbCBiZSBsb2FkZWQuXG4gICAgICAgICAgICAgKiBFbHNlLCBpdCB3aWxsIHJ1biBhIEQzIEZvcmNlIHNpbXVsYXRpb24gYW5kIGNyZWF0ZSBvbmUuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNldExheW91dCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG4gICAgICAgICAgICAgICAgdmFyIGxheW91dDtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGxheW91dCA9IHN0YXRlLmxheW91dERlZmF1bHQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciB6b29tID0gc3RhdGUuem9vbURlZmF1bHQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQoem9vbVswXSwgem9vbVsxXSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSBzdGF0ZS56b29tc1tzdGF0ZS5mb2N1c0dyb3Vwc107XG4gICAgICAgICAgICAgICAgICAgIGlmICh6b29tICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQoem9vbVswXSwgem9vbVsxXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ID0gc3RhdGUubGF5b3V0W3N0YXRlLmZvY3VzR3JvdXBzXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAobGF5b3V0ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24obikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvcyA9IGxheW91dFtuLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwb3MgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGxheW91dCwgbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBuLnggPSBwb3MueDtcbiAgICAgICAgICAgICAgICAgICAgICAgIG4ueSA9IHBvcy55O1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoLmNhbGwodGhpc0dyYXBoLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kudXBkYXRlR3JhcGhDYWxsYmFjay5jYWxsKHRoaXNQb2xpY3kpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL05lZWQgdG8gcnVuIGEgZm9yY2Ugc2ltdWxhdGlvbiBhcyB0aGlzIGxheW91dFxuICAgICAgICAgICAgICAgICAgICAvL2hhc24ndCBiZWVuIGRvbmUgYmVmb3JlXG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZS5pbml0Rm9yY2UgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhpc1BvbGljeS5zZXRQb3NpdGlvbnMoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51cGRhdGVHcmFwaENhbGxiYWNrLmNhbGwodGhpc1BvbGljeSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS56b29tc1tzdGF0ZS5mb2N1c0dyb3Vwc10gPSBbdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCldO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGF5b3V0ID0ge307XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dFtuLmlkXSA9IHt4Om4ueCwgeTpuLnl9O1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUubGF5b3V0W3N0YXRlLmZvY3VzR3JvdXBzXSA9IGxheW91dDtcbiAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIE92ZXJyaWRpbmcgZnJvbSBzdXBlciBjbGFzcyBzbyB0aGF0IHdlIGNhbiBoYXZlXG4gICAgICAgICAgICAgKiB0b3AgbGV2ZWwgbm9kZXMgcmVhcHBlYXIgd2hlbiB0aGV5IGFyZSBoaWRkZW5cbiAgICAgICAgICAgICAqIGR1ZSB0byB0aGVyZSBiZWluZyB0d28gZm9jdXMgZ3JvdXBzLlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gICAgICAgICAgbm9kZSAgICBUaGUgbm9kZSB0byBqb2luXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7Tm9kZX0gIFRoZSBuZXcgbm9kZSBhZnRlciB0aGUgam9pblxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBfX2pvaW5Ob2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVTdXBlciA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5Ob2RlUG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgLy9jaGVjayB0aGF0IG5vZGUgc3RpbGwgZXhpc3RzXG4gICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG5vZGUpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gbm9kZS5pZDtcbiAgICAgICAgICAgICAgICAvL2lmIGl0IGhhcyBubyBhbmNlc3Rvciwgbm90aGluZyB0byBqb2luXG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbC5pbmRleE9mKG5hbWUpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBub2RlLnBhcmVudDtcbiAgICAgICAgICAgICAgICB2YXIgdG9fYmVfZGVsZXRlZCA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBub2RlTmFtZVNldCA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpc0dyYXBoLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgbm9kZSB3b24ndCBiZSBjb2xsYXBzZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5ub2Rlc1tpXS5hbmNlc3RvcnMuaW5kZXhPZihub2RlLnBhcmVudCkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVOYW1lU2V0LnB1c2godGhpc0dyYXBoLm5vZGVzW2ldLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvX2JlX2RlbGV0ZWQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZV9pZCA9IG5vZGUucGFyZW50O1xuICAgICAgICAgICAgICAgIG5vZGVOYW1lU2V0LnB1c2gobm9kZS5wYXJlbnQpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFuY2VzdG9yc19zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5hbmNlc3RvcnNfc3RydWN0O1xuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgLy8gLSBzZXR0aW5nIGZvY3VzR3JvdXBzIC1cbiAgICAgICAgICAgICAgICAvL2VpdGhlciByZXBsYWNpbmcgb25lIG9mIHRoZSBncm91cHMsXG4gICAgICAgICAgICAgICAgLy9vciBqb2luaW5nIGJhY2sgaW50byBhIHRvcCBsZXZlbCwgc28gdGhlcmUgaXMgb25seVxuICAgICAgICAgICAgICAgIC8vb25lIGZvY3VzXG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gc3RhdGUuZm9jdXNHcm91cHMuaW5kZXhPZihwYXJlbnQpO1xuICAgICAgICAgICAgICAgIGlmIChhbmNlc3RvcnNfc3RydWN0W3BhcmVudF0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwc1tpbmRleF0gPSBhbmNlc3RvcnNfc3RydWN0W3BhcmVudF07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL25hbWVUb0FkZCBhcmUgdG9wIGxldmVsIG5vZGVzIHRoYXQgYXJlIHRvIGJlIGFkZGVkXG4gICAgICAgICAgICAgICAgLy90byB0aGUgZ3JhcGguXG4gICAgICAgICAgICAgICAgdmFyIG5hbWVUb0FkZCA9IFtdO1xuICAgICAgICAgICAgICAgIC8vd2lsbCBvbmx5IG5lZWQgdG8gYWRkIGEgdG9wIGxldmVsIG5vZGUgaWYgdGhlcmUgaXNcbiAgICAgICAgICAgICAgICAvL29ubHkgb25lIGZvY3VzXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAvL0FkZCBvbmx5IHRob3N0IHRoYXQgYXJlbid0IGFuIGFuY2VzdG9yIG9mIHRoZSBub2RlXG4gICAgICAgICAgICAgICAgICAgIC8vdG8gam9pbiwgdGhlIGZvY3VzIGdyb3VwIG9yIGFuIGFuY2VzdG9yIG9mIGl0LFxuICAgICAgICAgICAgICAgICAgICAvL2FuZCBhcmVuJ3QgYWxyZWFkeSBpbiBub2RlTmFtZVNldC5cbiAgICAgICAgICAgICAgICAgICAgLy9nZXQgZmxvdyBiZXR3ZWVuIHRvcCBsZXZlbCBhcyBsb25nIGFzXG4gICAgICAgICAgICAgICAgICAgIC8vdGhlIHRvcCBsZXZlbCBpc24ndCBhbiBhbmNlc3RvciBvZiB0aGVcbiAgICAgICAgICAgICAgICAgICAgLy9mb2N1cyBncm91cCwgYW5kIGlzbid0IGFscmVhZHkgcGFydCBvZiB0aGVcbiAgICAgICAgICAgICAgICAgICAgLy9ub2RlIHNldDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFuY2VzdG9ycyA9IGFuY2VzdG9yc19zdHJ1Y3Rbbm9kZS5pZF07XG4gICAgICAgICAgICAgICAgICAgIGFuY2VzdG9ycy5wdXNoKHN0YXRlLmZvY3VzR3JvdXBzWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgLy90aGUgb3IgZW1wdHkgYXJyYXkgaXMgdG8gcHJldmVudCBjb25jYXRlbmF0aW5nIGEgbnVsbFxuICAgICAgICAgICAgICAgICAgICAvL29yIHVuZGVmaW5lZCB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICBhbmNlc3RvcnMgPSBhbmNlc3RvcnMuY29uY2F0KGFuY2VzdG9yc19zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dIHx8IFtdKTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKGNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbCwgZnVuY3Rpb24obikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFuY2VzdG9ycy5pbmRleE9mKG4pID09PSAtMSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlTmFtZVNldC5pbmRleE9mKG4pID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkLnB1c2gobik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBub2RlTmFtZVNldCA9IG5vZGVOYW1lU2V0LmNvbmNhdChuYW1lVG9BZGQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vbm8gZm9jdXMgZ3JvdXBzIG1lYW5zIHdlIGFyZSBhdCB0b3AgbGV2ZWxcbiAgICAgICAgICAgICAgICAgICAgLy9TaG91bGQgYWRkIGFueSB0b3AgbGV2ZWwgbm9kZXMgdGhhdCBhcmVuJ3RcbiAgICAgICAgICAgICAgICAgICAgLy9hbHJlYWR5IHRoZXJlXG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChjaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwsIGZ1bmN0aW9uKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlTmFtZVNldC5pbmRleE9mKG4pID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkLnB1c2gobik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBub2RlTmFtZVNldCA9IG5vZGVOYW1lU2V0LmNvbmNhdChuYW1lVG9BZGQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vZm9ybWF0dGluZyBkYXRhXG4gICAgICAgICAgICAgICAgdmFyIHJhZGl1cyA9IG5vZGUucmFkaXVzIC8gdGhpc0dyYXBoLmNvbnN0cy5yYWRpdXNEZWNheTsgXG4gICAgICAgICAgICAgICAgdmFyIHhMb2MgPSBub2RlLng7XG4gICAgICAgICAgICAgICAgdmFyIHlMb2MgPSBub2RlLnk7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IG5vZGUuYW5jZXN0b3JzWzFdO1xuICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnMgPSBub2RlLmFuY2VzdG9ycy5zbGljZSgxKTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3Tm9kZSA9IG5ldyBWaXN1YWxpemVyTm9kZS5Ob2RlKHhMb2MsIHlMb2MsIG5ld19ub2RlX2lkLCBuZXdfbm9kZV9pZCwgcmFkaXVzLCBwYXJlbnQsIGFuY2VzdG9ycyk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnB1c2gobmV3Tm9kZSk7XG5cbiAgICAgICAgICAgICAgICAvL3JlbW92ZSBhbGwgbm9kZXMgdGhhdCB3aWxsIGJlIGpvaW5lZFxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdG9fYmVfZGVsZXRlZC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZV90b19kZWxldGUgPSB0b19iZV9kZWxldGVkW2ldO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMuc3BsaWNlKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG5vZGVfdG9fZGVsZXRlKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zcGxpY2VMaW5rc0Zvck5vZGUobm9kZV90b19kZWxldGUpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciByZXREYXRhID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuZ2V0Rmxvd0JldHdlZW5TZXQobm9kZU5hbWVTZXQpO1xuICAgICAgICAgICAgICAgIC8vaG9sZHMgdGhlIG5vZGVEYXRhIHdoaWNoIHdpbGwgYmUgcHJvY2Vzc2VkXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzVG9Qcm9jZXNzID0gW107XG4gICAgICAgICAgICAgICAgLy9maW5kaW5nIHRoZSBub2RlIGRhdGEgdGhhdCBjb3JyZXNwb25kcyB0byB0aGUgdG9wIGxldmVsXG4gICAgICAgICAgICAgICAgLy9ub2RlcyB0byBhZGQgLSBuYW1lVG9BZGQuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVEYXRhID0gcmV0RGF0YS5ub2RlRGF0YTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVEYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuYW1lVG9BZGQuaW5kZXhPZihub2RlRGF0YVtpXS5pZCkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1RvUHJvY2Vzcy5wdXNoKG5vZGVEYXRhW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vVGhlIHRvcCBsZXZlbCBub2RlcyB0aGF0IGFyZSBhZGRlZFxuICAgICAgICAgICAgICAgIHZhciBuZXdOb2RlcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NOb2RlRGF0YShub2Rlc1RvUHJvY2Vzcyk7XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKG5ld05vZGVzLCBmdW5jdGlvbihuKSB7XG4gICAgICAgICAgICAgICAgICAgIG4ucmFkaXVzID0gbi5yYWRpdXMgfHwgdGhpc0dyYXBoLmNvbnN0cy5zdGFydFJhZGl1cztcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMgPSB0aGlzR3JhcGgubm9kZXMuY29uY2F0KG5ld05vZGVzKTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YShyZXREYXRhLmxpbmtEYXRhLCB0aGlzR3JhcGgubm9kZXMpO1xuICAgICAgICAgICAgICAgIC8vT25seSBrZWVwIHRvcCBsZXZlbCBub2RlcyB0aGF0IGhhdmUgY29ubmVjdGlvbnMgdG9cbiAgICAgICAgICAgICAgICAvL3RoZSBjdXJyZW50IGZvY3VzIGdyb3VwXG4gICAgICAgICAgICAgICAgLy93ZSByZW1vdmUgdGhlIG5vZGUgbmFtZSBmcm9tIG5hbWVUb0FkZCBpZiB3ZSBhcmVcbiAgICAgICAgICAgICAgICAvL2tlZXBpbmcgaXRcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubGlua3MsIGZ1bmN0aW9uKGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vY2hlY2tpbmcgaWYgdGhlcmUgZXhpc3RzIGEgbGluayB0b3VjaGluZyBlYWNoIG9mIG5hbWVUb0FkZFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWVUb0FkZC5pbmRleE9mKGwuc291cmNlLmlkKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHNbMF0gPT09IGwudGFyZ2V0LnBhcmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lVG9BZGQuc3BsaWNlKG5hbWVUb0FkZC5pbmRleE9mKGwuc291cmNlLmlkKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChuYW1lVG9BZGQuaW5kZXhPZihsLnRhcmdldC5pZCkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzWzBdID09PSBsLnNvdXJjZS5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkLnNwbGljZShuYW1lVG9BZGQuaW5kZXhPZihsLnRhcmdldC5pZCksIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL1dlIHdhbnQgdG8ga2VlcCB0aGVtIGFsbFxuICAgICAgICAgICAgICAgICAgICAvL3NpbmNlIGFueSBsZWZ0IGluIG5hbWVUb0FkZCB3aWxsIGJlIHJlbW92ZWQsXG4gICAgICAgICAgICAgICAgICAgIC8vd2UgcmVzZXQgbmFtZVRvQWRkIGhlcmUuXG4gICAgICAgICAgICAgICAgICAgIG5hbWVUb0FkZCA9IFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvL3doYXRldmVyIGlzIHJlbWFpbmluZyBpbiBuYW1lVG9BZGQgaXNuJ3QgY29ubmVjdGVkXG4gICAgICAgICAgICAgICAgLy90byB0aGUgZm9jdXMgZ3JvdXAsIHNvIHdlIHNob3VsZCByZW1vdmUgaXQuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVUb1JlbW92ZSA9IFtdO1xuICAgICAgICAgICAgICAgIGlmIChuYW1lVG9BZGQubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpc0dyYXBoLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmFtZVRvQWRkLmluZGV4T2YodGhpc0dyYXBoLm5vZGVzW2ldLmlkKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lVG9BZGQuc3BsaWNlKG5hbWVUb0FkZC5pbmRleE9mKHRoaXNHcmFwaC5ub2Rlc1tpXS5pZCksIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zcGxpY2VMaW5rc0Zvck5vZGUodGhpc0dyYXBoLm5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlVG9SZW1vdmUucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuYW1lVG9BZGQubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfLmZvckVhY2gobm9kZVRvUmVtb3ZlLCBmdW5jdGlvbihuKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5zcGxpY2UodGhpc0dyYXBoLm5vZGVzLmluZGV4T2YobiksIDEpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXROb2RlcygpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0TGlua3MoKTtcblxuICAgICAgICAgICAgICAgIHN0YXRlU3VwZXIuc3BsaXROb2Rlcy5zcGxpY2Uoc3RhdGVTdXBlci5zcGxpdE5vZGVzLmluZGV4T2YobmV3Tm9kZS5pZCksIDEpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ld05vZGU7IFxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBhIHNpbmdsZSBub2RlIGlzIGpvaW5lZFxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBJZiB0aGUgZm9jdXMgZ3JvdXAgaGFzIGJlZW4gc2VlbiBiZWZvcmUsIGl0IHdpbGxcbiAgICAgICAgICAgICAqIGxvYWQgdGhhdCBsYXlvdXQuIE90aGVyd2lzZSwgaXQgd2lsbCBydW4gYSBkMyBmb3JjZVxuICAgICAgICAgICAgICogc2ltdWxhdGlvbiB0byBnZW5lcmF0ZSBvbmUuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBuZXdOb2RlICBUaGUgbmV3IG5vZGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgam9pbk5vZGVFdmVudChuZXdOb2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kgPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgLy9pZiB0aGUgbGFzdCBldmVudCBoYXMgdGhlIHNhbWUgaWQsIGl0IG11c3QgYmUgdGhlXG4gICAgICAgICAgICAgICAgLy9vcHBwb3NpdGUgb2YgdGhpcyBldmVudCwgc28gd2UgcmVtb3ZlIHRoYXQgZXZlbnQgZnJvbVxuICAgICAgICAgICAgICAgIC8vdGhlIGV2ZW50IHN0YWNrLlxuICAgICAgICAgICAgICAgIC8vT3RoZXJ3aXNlLCB3ZSBhZGQgdGhlIGV2ZW50IHRvIHRoZSBzdGFja1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoICE9PSAwICYmXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeVtzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoIC0gMV0uaWQgPT09IG5ld05vZGUuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5LnBvcCgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeS5wdXNoKHtpZDpuZXdOb2RlLmlkLCBldmVudDonam9pbid9KVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG5cbiAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoXy5pbmNsdWRlcyhjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImZvY3VzXCI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiY29ubmVjdGVkXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vc2V0dGluZyBiYWNrIGJ1dHRvblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5iYWNrQnV0dG9uRWxlbSAhPSBudWxsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uRWxlbS5mYWRlVG8oJ3Nsb3cnLCAwKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3NldHRpbmcgdGl0bGVcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUudGl0bGVFbGVtICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSBzdGF0ZS5mb2N1c0dyb3Vwc1swXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ICs9ICcgJiAnICsgc3RhdGUuZm9jdXNHcm91cHNbMV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc3RhdGUudGl0bGVFbGVtLnRleHQodGV4dCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kuc2V0TGF5b3V0KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVW5kb2VzIHRoZSBsYXN0IHNwbGl0IG9yIGpvaW4gZXZlbnQuXG4gICAgICAgICAgICAgKiBNZWFudCB0byBiZSBjYWxsZWQgYnkgdGhlIGJhY2sgYnV0dG9uLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1bmRvTGFzdEV2ZW50KCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5ID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIHZhciBsYXN0ID0gc3RhdGUuZXZlbnRIaXN0b3J5W3N0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgICB2YXIgaWQgPSBsYXN0LmlkO1xuICAgICAgICAgICAgICAgIHZhciBub2RlO1xuICAgICAgICAgICAgICAgIGlmIChsYXN0LmV2ZW50ID09PSAnam9pbicpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZSA9IHRoaXNHcmFwaC5maW5kTm9kZUJ5SWQoaWQpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZDNub2RlID0gdGhpc0dyYXBoLmZpbmREM05vZGUoaWQpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LmRibGNsaWNrKGQzbm9kZSwgbm9kZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVJZCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFtpZF1bMF07XG4gICAgICAgICAgICAgICAgICAgIG5vZGUgPSB0aGlzR3JhcGguZmluZE5vZGVCeUlkKG5vZGVJZCk7XG4gICAgICAgICAgICAgICAgICAgIHN1cGVyLmpvaW5Ob2RlLmNhbGwodGhpc1BvbGljeSwgbm9kZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIFBvbGljeTogU3BsaXRKb2luVmlld1BvbGljeVxuICAgICAgICB9XG59XSk7XG5cblxuXG5cblxuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbm9kZXMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2Lm9yZ2FuaXphdGlvbnMnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdjb250aXYubWVudS5vcmdhbml6YXRpb25zJywge1xuICAgICAgICAgICAgdXJsOiAnL29yZ2FuaXphdGlvbnMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc2VydmljZWxicycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2VydmljZWxicycsIHtcbiAgICAgICAgICAgIHVybDogJy9zZXJ2aWNlbGJzJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zZXR0aW5ncycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZ2xvYmFsJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL3NldHRpbmdzJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2V0dGluZ3Mvc2V0dGluZ3NtZW51Lmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMubG9ncycsIHtcbiAgICAgICAgICAgIHVybDogJy9sb2dzJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICcnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMuYXV0aCcsIHtcbiAgICAgICAgICAgIHVybDogJy9hdXRoJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICcnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMubGljZW5zZScsIHtcbiAgICAgICAgICAgIHVybDogJy9saWNlbnNlJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICcnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMucG9saWNpZXMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvcG9saWNpZXMnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJycsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJydcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zdG9yYWdlcG9saWNpZXMnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcycsIHtcbiAgICAgICAgICAgIHVybDogJy9zdG9yYWdlcG9saWNpZXMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCJcblxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52aXN1YWxpemF0aW9uJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscycsIFxuXHQnY29udGl2LmdyYXBoJ10pXG4gLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdjb250aXYubWVudS52aXN1YWxpemF0aW9uJywge1xuICAgICAgICAgICAgdXJsOiAnL3Zpc3VhbGl6YXRpb24nLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgfV0pO1xuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZvbHVtZXMnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZvbHVtZXMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvdm9sdW1lcycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIid1c2Ugc3RyaWN0Jztcbi8vIERlY2xhcmUgYXBwIGxldmVsIG1vZHVsZSB3aGljaCBkZXBlbmRzIG9uIHZpZXdzLCBhbmQgY29tcG9uZW50c1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdkFwcCcsIFtcbiAgICAndWkucm91dGVyJyxcbiAgICAnY29udGl2LmxvZ2luJyxcbiAgICAnY29udGl2Lm1lbnUnLFxuICAgICdjb250aXYuZGFzaGJvYXJkJyxcbiAgICAnY29udGl2LmFwcGxpY2F0aW9uZ3JvdXBzJyxcbiAgICAnY29udGl2Lm5ldHdvcmtzJyxcbiAgICAnY29udGl2Lm5ldHdvcmtwb2xpY2llcycsXG4gICAgJ2NvbnRpdi5zdG9yYWdlcG9saWNpZXMnLFxuICAgICdjb250aXYuc2VydmljZWxicycsXG4gICAgJ2NvbnRpdi52b2x1bWVzJyxcbiAgICAnY29udGl2Lm5vZGVzJyxcbiAgICAnY29udGl2Lm9yZ2FuaXphdGlvbnMnLFxuICAgICdjb250aXYuc2V0dGluZ3MnLFxuICAgICdjb250aXYudmlzdWFsaXphdGlvbidcbl0pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgJyR1cmxSb3V0ZXJQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdicsIHtcbiAgICAgICAgICAgIHVybDogJycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgZmx1aWQgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSk7XG4gICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzExLzE2LlxuICovXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMTAvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuYXBwbGljYXRpb25ncm91cHMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3Vwcy5jcmVhdGUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCBhcyBhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcGxpY2F0aW9uZ3JvdXBzL2FwcGxpY2F0aW9uZ3JvdXBjcmVhdGUuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ0FwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsJywgW1xuICAgICckc3RhdGUnLFxuICAgICckc3RhdGVQYXJhbXMnLFxuICAgICdBcHBsaWNhdGlvbkdyb3Vwc01vZGVsJyxcbiAgICAnTmV0d29ya3NNb2RlbCcsXG4gICAgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwsIE5ldHdvcmtzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCA9IHRoaXM7XG4gICAgICAgIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLm5ldHdvcmtzID0gW107XG4gICAgICAgIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLmFwcGxpY2F0aW9uR3JvdXAgPSB7fTtcbiAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwuc2VsZWN0ZWROZXR3b3JrID0ge307XG4gICAgICAgIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLm1vZGUgPSBcImVkaXRcIjtcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9BcHBsaWNhdGlvbkdyb3VwKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3Vwcy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub0FwcGxpY2F0aW9uR3JvdXAoKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IG5ldHdvcmtzIGZvciB0aGUgZ2l2ZW4gdGVuYW50LlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gZ2V0TmV0d29ya3MoKSB7XG4gICAgICAgICAgICBOZXR3b3Jrc01vZGVsLmdldCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLm5ldHdvcmtzID0gXy5maWx0ZXIocmVzdWx0LCB7XG4gICAgICAgICAgICAgICAgICAgICd0ZW5hbnROYW1lJzogJ2RlZmF1bHQnIC8vVE9ETzogUmVtb3ZlIGhhcmRjb2RlZCB0ZW5hbnQuXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVBcHBsaWNhdGlvbkdyb3VwKCkge1xuICAgICAgICAgICAgLy9mb3JtIGNvbnRyb2xsZXIgaXMgaW5qZWN0ZWQgYnkgdGhlIGh0bWwgdGVtcGxhdGVcbiAgICAgICAgICAgIC8vY2hlY2tpbmcgaWYgYWxsIHZhbGlkYXRpb25zIGhhdmUgcGFzc2VkXG4gICAgICAgICAgICBpZiAoYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybC5hcHBsaWNhdGlvbkdyb3VwLm5ldHdvcmtOYW1lID1cbiAgICAgICAgICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwuc2VsZWN0ZWROZXR3b3JrLm5ldHdvcmtOYW1lO1xuICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLmFwcGxpY2F0aW9uR3JvdXAua2V5ID1cbiAgICAgICAgICAgICAgICAgICAgQXBwbGljYXRpb25Hcm91cHNNb2RlbC5nZW5lcmF0ZUtleShhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybC5hcHBsaWNhdGlvbkdyb3VwKTtcbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBhcHBsaWNhdGlvbkdyb3VwIGNvbnNpc3Qgb2YgR3JvdXAgTmFtZSwgTmV0d29yayBOYW1lLCBJc29sYXRpb24gUG9saWNpZXMsIEJhbmR3aWR0aCBQb2xpY3lcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBBcHBsaWNhdGlvbkdyb3Vwc01vZGVsLmNyZWF0ZShhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybC5hcHBsaWNhdGlvbkdyb3VwKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvQXBwbGljYXRpb25Hcm91cCgpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmVzZXRGb3JtKCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwuYXBwbGljYXRpb25Hcm91cCA9IHtcbiAgICAgICAgICAgICAgICBncm91cE5hbWU6ICcnLFxuICAgICAgICAgICAgICAgIG5ldHdvcmtOYW1lOiAnJyxcbiAgICAgICAgICAgICAgICBwb2xpY2llczogW10sXG4gICAgICAgICAgICAgICAgbmV0UHJvZmlsZTogJycsXG4gICAgICAgICAgICAgICAgdGVuYW50TmFtZTogJ2RlZmF1bHQnIC8vVE9ETzogUmVtb3ZlIGhhcmRjb2RlZCB0ZW5hbnQuXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGdldE5ldHdvcmtzKCk7XG4gICAgICAgIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLmNyZWF0ZUFwcGxpY2F0aW9uR3JvdXAgPSBjcmVhdGVBcHBsaWNhdGlvbkdyb3VwO1xuICAgICAgICBhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybC5jYW5jZWxDcmVhdGluZyA9IGNhbmNlbENyZWF0aW5nO1xuICAgICAgICByZXNldEZvcm0oKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHBsaWNhdGlvbmdyb3VwY3JlYXRlY3RybC5qcy5tYXAiLCIvKipcbiogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8xNS8xNi5cbiovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmFwcGxpY2F0aW9uZ3JvdXBzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0FwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCBhcyBhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHBsaWNhdGlvbmdyb3Vwcy9hcHBsaWNhdGlvbmdyb3VwZGV0YWlscy5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3Vwcy5lZGl0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2VkaXQvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsIGFzIGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcGxpY2F0aW9uZ3JvdXBzL2FwcGxpY2F0aW9uZ3JvdXBkZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdBcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwnLCBbXG4gICAgJyRzdGF0ZScsXG4gICAgJyRzdGF0ZVBhcmFtcycsXG4gICAgJ0FwcGxpY2F0aW9uR3JvdXBzTW9kZWwnLFxuICAgICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBBcHBsaWNhdGlvbkdyb3Vwc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsID0gdGhpcztcbiAgICAgICAgYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLmFwcGxpY2F0aW9uR3JvdXAgPSB7fTtcbiAgICAgICAgYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLnNlbGVjdGVkTmV0d29yayA9IHt9O1xuICAgICAgICAvKipcbiAgICAgICAgICogVG8gc2hvdyBlZGl0IG9yIGRldGFpbHMgc2NyZWVuIGJhc2VkIG9uIHRoZSByb3V0ZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gc2V0TW9kZSgpIHtcbiAgICAgICAgICAgIGlmICgkc3RhdGUuaXMoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmVkaXQnKSkge1xuICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybC5tb2RlID0gJ2VkaXQnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLm1vZGUgPSAnZGV0YWlscyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9BcHBsaWNhdGlvbkdyb3VwKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3Vwcy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9BcHBsaWNhdGlvbkdyb3VwRGV0YWlscygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMuZGV0YWlscycsIHsgJ2tleSc6IGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybC5hcHBsaWNhdGlvbkdyb3VwLmtleSB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxFZGl0aW5nKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9BcHBsaWNhdGlvbkdyb3VwRGV0YWlscygpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGRlbGV0ZUFwcGxpY2F0aW9uR3JvdXAoKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBBcHBsaWNhdGlvbkdyb3Vwc01vZGVsLmRlbGV0ZShhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwuYXBwbGljYXRpb25Hcm91cCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIHJldHVyblRvQXBwbGljYXRpb25Hcm91cCgpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHNhdmVBcHBsaWNhdGlvbkdyb3VwKCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgQXBwbGljYXRpb25Hcm91cHNNb2RlbC5zYXZlKGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybC5hcHBsaWNhdGlvbkdyb3VwKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9BcHBsaWNhdGlvbkdyb3VwRGV0YWlscygpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsKTtcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCk7XG4gICAgICAgIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwuZ2V0TW9kZWxCeUtleSgkc3RhdGVQYXJhbXMua2V5KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGdyb3VwKSB7XG4gICAgICAgICAgICBhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwuYXBwbGljYXRpb25Hcm91cCA9IGdyb3VwO1xuICAgICAgICB9KTtcbiAgICAgICAgYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLnNhdmVBcHBsaWNhdGlvbkdyb3VwID0gc2F2ZUFwcGxpY2F0aW9uR3JvdXA7XG4gICAgICAgIGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybC5jYW5jZWxFZGl0aW5nID0gY2FuY2VsRWRpdGluZztcbiAgICAgICAgYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLmRlbGV0ZUFwcGxpY2F0aW9uR3JvdXAgPSBkZWxldGVBcHBsaWNhdGlvbkdyb3VwO1xuICAgICAgICBzZXRNb2RlKCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwbGljYXRpb25ncm91cGRldGFpbHNjdHJsLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8xMS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5hcHBsaWNhdGlvbmdyb3VwcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQXBwbGljYXRpb25Hcm91cExpc3RDdHJsIGFzIGFwcGxpY2F0aW9uR3JvdXBMaXN0Q3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcGxpY2F0aW9uZ3JvdXBzL2FwcGxpY2F0aW9uZ3JvdXBsaXN0Lmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdBcHBsaWNhdGlvbkdyb3VwTGlzdEN0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdBcHBsaWNhdGlvbkdyb3Vwc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBhcHBsaWNhdGlvbkdyb3VwTGlzdEN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBnZXRBcHBsaWNhdGlvbkdyb3VwcyhyZWxvYWQpIHtcbiAgICAgICAgICAgIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihhcHBsaWNhdGlvbkdyb3VwTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBMaXN0Q3RybC5ncm91cHMgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYXBwbGljYXRpb25Hcm91cExpc3RDdHJsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vTG9hZCBmcm9tIGNhY2hlIGZvciBxdWljayBkaXNwbGF5IGluaXRpYWxseVxuICAgICAgICBnZXRBcHBsaWNhdGlvbkdyb3VwcyhmYWxzZSk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IHN0YXJ0IGF1dG8tcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXRBcHBsaWNhdGlvbkdyb3Vwcyh0cnVlKTtcbiAgICAgICAgICAgIH0sIDUwMDApO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHBsaWNhdGlvbmdyb3VwbGlzdGN0cmwuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGhhcmRpayBnYW5kaGkgb24gNi8yOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoXCJjb250aXYuYXBwbGljYXRpb25ncm91cHNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2QmFuZHdpZHRocG9saWN5XCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgbW9kZTogXCI9XCIsXG4gICAgICAgICAgICBhcHBsaWNhdGlvbmdyb3VwOiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgY29udHJvbGxlcjogW1xuICAgICAgICAgICAgJyRzY29wZScsXG4gICAgICAgICAgICAnTmV0cHJvZmlsZXNNb2RlbCcsXG4gICAgICAgICAgICBmdW5jdGlvbiAoJHNjb3BlLCBOZXRwcm9maWxlc01vZGVsKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLm5ldFByb2ZpbGVzID0gW107XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkTmV0cHJvZmlsZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5OiB7fVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogR2V0IHByb2ZpbGVzIGZvciB0aGUgZ2l2ZW4gdGVuYW50LlxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdldE5ldHByb2ZpbGVzKCkge1xuICAgICAgICAgICAgICAgICAgICBOZXRwcm9maWxlc01vZGVsLmdldCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm5ldFByb2ZpbGVzID0gXy5maWx0ZXIocmVzdWx0LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RlbmFudE5hbWUnOiAnZGVmYXVsdCcgLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5hcHBsaWNhdGlvbmdyb3VwLm5ldFByb2ZpbGUgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkTmV0cHJvZmlsZS5wb2xpY3kgPSBfLmZpbmQoJHNjb3BlLm5ldFByb2ZpbGVzLCBmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwb2xpY3kucHJvZmlsZU5hbWUgPT09ICRzY29wZS5hcHBsaWNhdGlvbmdyb3VwLm5ldFByb2ZpbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBBc3NpZ24gcHJvZmlsZU5hbWUgdG8gYXBwbGljYXRpb25ncm91cCB3aGljaGV2ZXIgdXNlciBoYXMgZ2l2ZW5cbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAkc2NvcGUudXBkYXRlQXBwbGljYXRpb25ncm91cCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5zZWxlY3RlZE5ldHByb2ZpbGUucG9saWN5ID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXBwbGljYXRpb25ncm91cC5uZXRQcm9maWxlID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXBwbGljYXRpb25ncm91cC5uZXRQcm9maWxlID0gJHNjb3BlLnNlbGVjdGVkTmV0cHJvZmlsZS5wb2xpY3kucHJvZmlsZU5hbWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGdldE5ldHByb2ZpbGVzKCk7XG4gICAgICAgICAgICB9XSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHBsaWNhdGlvbmdyb3Vwcy9iYW5kd2lkdGhwb2xpY3kuaHRtbCdcbiAgICB9O1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1iYW5kd2lkdGhwb2xpY3lkaXJlY3RpdmUuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGhhcmRpayBnYW5kaGkgb24gNy84LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5hcHBsaWNhdGlvbmdyb3Vwc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZJc29sYXRpb25wb2xpY3lcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBtb2RlOiAnPScsXG4gICAgICAgICAgICBhcHBsaWNhdGlvbmdyb3VwOiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgY29udHJvbGxlcjogW1xuICAgICAgICAgICAgJyRzY29wZScsXG4gICAgICAgICAgICAnJHN0YXRlUGFyYW1zJyxcbiAgICAgICAgICAgICdBcHBsaWNhdGlvbkdyb3Vwc01vZGVsJyxcbiAgICAgICAgICAgICdQb2xpY2llc01vZGVsJyxcbiAgICAgICAgICAgICdSdWxlc01vZGVsJyxcbiAgICAgICAgICAgIGZ1bmN0aW9uICgkc2NvcGUsICRzdGF0ZVBhcmFtcywgQXBwbGljYXRpb25Hcm91cHNNb2RlbCwgUG9saWNpZXNNb2RlbCwgUnVsZXNNb2RlbCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5pbmNvbWluZ1J1bGVzID0gW107XG4gICAgICAgICAgICAgICAgJHNjb3BlLm91dGdvaW5nUnVsZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWRQb2xpY3kgPSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeToge31cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZFBvbGljaWVzID0gW107IC8vIFRvIFN0b3JlIHBvbGljaWVzIHNlbGVjdGVkIGJ5IHVzZXIgdG8gZGlzcGxheVxuICAgICAgICAgICAgICAgICRzY29wZS5pc29sYXRpb25Qb2xpY2llcyA9IFtdOyAvLyBUbyBHZXQgYWxsIGlzb2xhdGlvbiBwb2xpY2llcyBvZiB0ZW5hbnRcbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBHZXQgaW5jb21pbmcgYW5kIG91dGdvaW5nIHJ1bGVzIGZvciBlYWNoIHBvbGljeSBwcmVzZW50IGluIGFwcGxpY2F0aW9uZ3JvdXBcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZXRSdWxlcygpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFwcGxpY2F0aW9uZ3JvdXAucG9saWNpZXMuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1RvIGRpc3BsYXkgcnVsZXMgb2Ygc2VsZWN0ZWQgcG9saWNpZXNcbiAgICAgICAgICAgICAgICAgICAgICAgIFJ1bGVzTW9kZWwuZ2V0SW5jb21pbmdSdWxlcyhwb2xpY3ksICdkZWZhdWx0JylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocnVsZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseSgkc2NvcGUuaW5jb21pbmdSdWxlcywgcnVsZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBSdWxlc01vZGVsLmdldE91dGdvaW5nUnVsZXMocG9saWN5LCAnZGVmYXVsdCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJ1bGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoJHNjb3BlLm91dGdvaW5nUnVsZXMsIHJ1bGVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogR2V0IHBvbGljaWVzIGZvciB0aGUgZ2l2ZW4gdGVuYW50LlxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdldElzb2xhdGlvblBvbGljaWVzKCkge1xuICAgICAgICAgICAgICAgICAgICBQb2xpY2llc01vZGVsLmdldCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmlzb2xhdGlvblBvbGljaWVzID0gXy5maWx0ZXIocmVzdWx0LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RlbmFudE5hbWUnOiAnZGVmYXVsdCcgLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogQWRkIHBvbGljeSB0byBhcHBsaWNhdGlvbiBncm91cFxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICRzY29wZS5hZGRJc29sYXRpb25Qb2xpY3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50UG9saWN5TmFtZSA9ICRzY29wZS5zZWxlY3RlZFBvbGljeS5wb2xpY3kucG9saWN5TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRQb2xpY3lOYW1lICE9PSB1bmRlZmluZWQgJiYgXy5pbmNsdWRlcygkc2NvcGUuc2VsZWN0ZWRQb2xpY2llcywgY3VycmVudFBvbGljeU5hbWUpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1RvIGRpc3BsYXkgc2VsZWN0ZWQgcG9saWNpZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZFBvbGljaWVzLnB1c2goY3VycmVudFBvbGljeU5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9UbyBkaXNwbGF5IHJ1bGVzIG9mIHNlbGVjdGVkIHBvbGljaWVzXG4gICAgICAgICAgICAgICAgICAgICAgICBSdWxlc01vZGVsLmdldEluY29taW5nUnVsZXMoY3VycmVudFBvbGljeU5hbWUsICdkZWZhdWx0JylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocnVsZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseSgkc2NvcGUuaW5jb21pbmdSdWxlcywgcnVsZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBSdWxlc01vZGVsLmdldE91dGdvaW5nUnVsZXMoY3VycmVudFBvbGljeU5hbWUsICdkZWZhdWx0JylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocnVsZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseSgkc2NvcGUub3V0Z29pbmdSdWxlcywgcnVsZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1RvIGJlIGFkZGVkIHRvIGFwcGxpY2F0aW9uIGdyb3VwIGFuZCBzYXZlZCB0byB0aGUgc2VydmVyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXBwbGljYXRpb25ncm91cC5wb2xpY2llc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5wdXNoKGN1cnJlbnRQb2xpY3lOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogUmVtb3ZlIHBvbGljeSBmcm9tIGFwcGxpY2F0aW9uIGdyb3VwXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlbW92ZUlzb2xhdGlvblBvbGljeSA9IGZ1bmN0aW9uIChwb2xpY3lOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIF8ucmVtb3ZlKCRzY29wZS5zZWxlY3RlZFBvbGljaWVzLCBmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcG9saWN5ID09PSBwb2xpY3lOYW1lO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgXy5yZW1vdmUoJHNjb3BlLmFwcGxpY2F0aW9uZ3JvdXAucG9saWNpZXMsIGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwb2xpY3kgPT09IHBvbGljeU5hbWU7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBfLnJlbW92ZSgkc2NvcGUuaW5jb21pbmdSdWxlcywgZnVuY3Rpb24gKHJ1bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBydWxlLnBvbGljeU5hbWUgPT09IHBvbGljeU5hbWU7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBfLnJlbW92ZSgkc2NvcGUub3V0Z29pbmdSdWxlcywgZnVuY3Rpb24gKHJ1bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBydWxlLnBvbGljeU5hbWUgPT09IHBvbGljeU5hbWU7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogIFRvIGNoZWNrICdkZXRhaWxzJyBvciAnZWRpdCcgbW9kZSAobm90IGNyZWF0ZSBtb2RlKVxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUubW9kZSA9PSAnZGV0YWlscycgfHwgKCRzY29wZS5tb2RlID09ICdlZGl0JyAmJiAkc2NvcGUuYXBwbGljYXRpb25ncm91cC5ncm91cE5hbWUgIT0gXCJcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9BcHBsaWNhdGlvbiBHcm91cHMgbWlnaHQgbm90IGhhdmUgYW55IHBvbGljaWVzIGFzc29jaWF0ZWQgd2l0aCB0aGVtIHNvIGRlZmluZSBhbiBlbXB0eSBhcnJheVxuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmFwcGxpY2F0aW9uZ3JvdXAucG9saWNpZXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFwcGxpY2F0aW9uZ3JvdXAucG9saWNpZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBnZXRSdWxlcygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBnZXRJc29sYXRpb25Qb2xpY2llcygpO1xuICAgICAgICAgICAgfV0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwbGljYXRpb25ncm91cHMvaXNvbGF0aW9ucG9saWN5Lmh0bWwnXG4gICAgfTtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aXNvbGF0aW9ucG9saWN5ZGlyZWN0aXZlLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5sb2dpbicpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5sb2dpbicsIHtcbiAgICAgICAgICAgIHVybDogJy8nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdsb2dpbi9sb2dpbi5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdMb2dpbkN0cmwgYXMgbG9naW5DdHJsJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTG9naW5DdHJsJywgWyckc3RhdGUnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBsb2dpbkN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub0Rhc2hib2FyZCgpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuZGFzaGJvYXJkJywgeyB1c2VybmFtZTogbG9naW5DdHJsLnVzZXJuYW1lIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGxvZ2luKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9EYXNoYm9hcmQoKTtcbiAgICAgICAgfVxuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGxvZ2luQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihsb2dpbkN0cmwpO1xuICAgICAgICBsb2dpbkN0cmwubG9naW4gPSBsb2dpbjtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1sb2dpbmN0cmwuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE5LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm1lbnUnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudScsIHtcbiAgICAgICAgICAgIHVybDogJy9tJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbWVudS9tZW51Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ01lbnVDdHJsIGFzIG1lbnVDdHJsJyxcbiAgICAgICAgICAgIHBhcmFtczogeyB1c2VybmFtZTogbnVsbCB9XG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdNZW51Q3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcykge1xuICAgICAgICB2YXIgbWVudUN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBsb2dvdXQoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5sb2dpbicpO1xuICAgICAgICB9XG4gICAgICAgIG1lbnVDdHJsLnVzZXJuYW1lID0gJHN0YXRlUGFyYW1zLnVzZXJuYW1lO1xuICAgICAgICBtZW51Q3RybC5sb2dvdXQgPSBsb2dvdXQ7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bWVudUN0cmwuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGhhcmRpayBnYW5kaGkgb24gNi8yNC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoXCJjb250aXYubmV0d29ya3BvbGljaWVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dkJhbmR3aWR0aFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIGJhbmR3aWR0aFBvbGljeTogJz0nLFxuICAgICAgICAgICAgbW9kZTogXCJAXCJcbiAgICAgICAgfSxcbiAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlKSB7XG4gICAgICAgICAgICBpZiAoc2NvcGUuYmFuZHdpZHRoUG9saWN5LmJhbmR3aWR0aCAhPSAnJykge1xuICAgICAgICAgICAgICAgIHZhciBiYW5kd2lkdGhBcnJheSA9IHNjb3BlLmJhbmR3aWR0aFBvbGljeS5iYW5kd2lkdGguc3BsaXQoJyAnKTtcbiAgICAgICAgICAgICAgICBzY29wZS5iYW5kd2lkdGhQb2xpY3kuYmFuZHdpZHRoTnVtYmVyID0gTnVtYmVyKGJhbmR3aWR0aEFycmF5WzBdKTtcbiAgICAgICAgICAgICAgICBzY29wZS5iYW5kd2lkdGhQb2xpY3kuYmFuZHdpZHRoVW5pdCA9IGJhbmR3aWR0aEFycmF5WzFdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtfcG9saWNpZXMvYmFuZHdpZHRoLmh0bWwnXG4gICAgfTtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YmFuZHdpZHRoZGlyZWN0aXZlLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSBoYXJkaWsgZ2FuZGhpIG9uIDYvMTYvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3BvbGljaWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmJhbmR3aWR0aC5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwgYXMgYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3JrX3BvbGljaWVzL2JhbmR3aWR0aHBvbGljeWRldGFpbHMuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGguZWRpdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9lZGl0LzprZXknLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0JhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsIGFzIGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmV0d29ya19wb2xpY2llcy9iYW5kd2lkdGhwb2xpY3lkZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdCYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCcsIFtcbiAgICAnJHN0YXRlJyxcbiAgICAnJHN0YXRlUGFyYW1zJyxcbiAgICAnTmV0cHJvZmlsZXNNb2RlbCcsXG4gICAgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIE5ldHByb2ZpbGVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCA9IHRoaXM7XG4gICAgICAgIGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLmJhbmR3aWR0aFByb2ZpbGVzID0gW107XG4gICAgICAgIC8qIEdldCBwYXJ0aWN1bGFyIFByb2ZpbGUgZm9yIGJhc2VkIG9uIGtleSovXG4gICAgICAgIE5ldHByb2ZpbGVzTW9kZWwuZ2V0TW9kZWxCeUtleSgkc3RhdGVQYXJhbXMua2V5KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwucG9saWN5ID0gcG9saWN5O1xuICAgICAgICB9KTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRvIHNob3cgZWRpdCBvciBkZXRhaWxzIHNjcmVlbiBiYXNlZCBvbiB0aGUgcm91dGVcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHNldE1vZGUoKSB7XG4gICAgICAgICAgICBpZiAoJHN0YXRlLmlzKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuYmFuZHdpZHRoLmVkaXQnKSkge1xuICAgICAgICAgICAgICAgIGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLm1vZGUgPSAnZWRpdCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybC5tb2RlID0gJ2RldGFpbHMnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGRlbGV0ZVBvbGljeSgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBOZXRwcm9maWxlc01vZGVsLmRlbGV0ZVVzaW5nS2V5KGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLnBvbGljeS5rZXksICduYW1lJykudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9Qb2xpY2llcygpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1BvbGljaWVzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMubGlzdC5iYW5kd2lkdGgnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1BvbGljeURldGFpbHMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGguZGV0YWlscycsIHsgJ2tleSc6IGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLnBvbGljeS5rZXkgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsRWRpdGluZygpIHtcbiAgICAgICAgICAgIHJldHVyblRvUG9saWN5RGV0YWlscygpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHNhdmVQb2xpY3koKSB7XG4gICAgICAgICAgICAvL2Zvcm0gY29udHJvbGxlciBpcyBpbmplY3RlZCBieSB0aGUgaHRtbCB0ZW1wbGF0ZVxuICAgICAgICAgICAgLy9jaGVja2luZyBpZiBhbGwgdmFsaWRhdGlvbnMgaGF2ZSBwYXNzZWRcbiAgICAgICAgICAgIGlmIChiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLnBvbGljeS5iYW5kd2lkdGggPSBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kuYmFuZHdpZHRoTnVtYmVyICsgXCIgXCIgKyBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kuYmFuZHdpZHRoVW5pdDtcbiAgICAgICAgICAgICAgICBOZXRwcm9maWxlc01vZGVsLnNhdmUoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwucG9saWN5KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvUG9saWN5RGV0YWlscygpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgIHNldE1vZGUoKTtcbiAgICAgICAgYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwuZGVsZXRlUG9saWN5ID0gZGVsZXRlUG9saWN5O1xuICAgICAgICBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybC5zYXZlUG9saWN5ID0gc2F2ZVBvbGljeTtcbiAgICAgICAgYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwuY2FuY2VsRWRpdGluZyA9IGNhbmNlbEVkaXRpbmc7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YmFuZHdpZHRocG9saWN5ZGV0YWlsc2N0cmwuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGhhcmRpayBnYW5kaGkgb24gNi8xNC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcG9saWNpZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMubGlzdC5iYW5kd2lkdGgnLCB7XG4gICAgICAgICAgICB1cmw6ICcvYmFuZHdpZHRoJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdCYW5kd2lkdGhQb2xpY3lMaXN0Q3RybCBhcyBiYW5kd2lkdGhQb2xpY3lMaXN0Q3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtfcG9saWNpZXMvYmFuZHdpZHRocG9saWN5bGlzdC5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignQmFuZHdpZHRoUG9saWN5TGlzdEN0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdOZXRwcm9maWxlc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIE5ldHByb2ZpbGVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBwb2xpY2llc0xpc3RDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gZ2V0UG9saWNpZXMocmVsb2FkKSB7XG4gICAgICAgICAgICBOZXRwcm9maWxlc01vZGVsLmdldChyZWxvYWQpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIocG9saWNpZXNMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgcG9saWNpZXNMaXN0Q3RybC5wb2xpY2llcyA9ICRmaWx0ZXIoJ29yZGVyQnknKShyZXN1bHQsICdwcm9maWxlTmFtZScpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHBvbGljaWVzTGlzdEN0cmwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgIGdldFBvbGljaWVzKHRydWUpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBzdGFydCBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0UG9saWNpZXModHJ1ZSk7XG4gICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1iYW5kd2lkdGhwb2xpY3lsaXN0Y3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcG9saWNpZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuaXNvbGF0aW9uLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdJc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCBhcyBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtfcG9saWNpZXMvaXNvbGF0aW9ucG9saWN5ZGV0YWlscy5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbi5lZGl0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2VkaXQvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnSXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwgYXMgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3JrX3BvbGljaWVzL2lzb2xhdGlvbnBvbGljeWRldGFpbHMuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ0lzb2xhdGlvblBvbGljeURldGFpbHNDdHJsJywgW1xuICAgICckc3RhdGUnLFxuICAgICckc3RhdGVQYXJhbXMnLFxuICAgICdQb2xpY2llc01vZGVsJyxcbiAgICAnUnVsZXNNb2RlbCcsXG4gICAgJ05ldHdvcmtzTW9kZWwnLFxuICAgICdBcHBsaWNhdGlvbkdyb3Vwc01vZGVsJyxcbiAgICAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgUG9saWNpZXNNb2RlbCwgUnVsZXNNb2RlbCwgTmV0d29ya3NNb2RlbCwgQXBwbGljYXRpb25Hcm91cHNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsID0gdGhpcztcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV0d29ya3MgPSBbXTtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuYXBwbGljYXRpb25Hcm91cHMgPSBbXTtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nTmV0d29ya1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdOZXR3b3JrU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdJUEFkZHJlc3NTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nSVBBZGRyZXNzU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nU2VsZWN0ZWRBcHBsaWNhdGlvbkdyb3VwID0gJyc7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nU2VsZWN0ZWRBcHBsaWNhdGlvbkdyb3VwID0gJyc7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nU2VsZWN0ZWROZXR3b3JrID0gJyc7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nU2VsZWN0ZWROZXR3b3JrID0gJyc7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29ycmVjdENJRFIgPSBmYWxzZTtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwudmFsaWRhdGVDSURSRmxhZyA9IGZhbHNlO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1BvbGljaWVzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMubGlzdC5pc29sYXRpb24nKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1BvbGljeURldGFpbHMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5pc29sYXRpb24uZGV0YWlscycsIHsga2V5OiBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kua2V5IH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbEVkaXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub1BvbGljeURldGFpbHMoKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogR28gYmFjayB0byBwb2xpY3kgZGV0YWlscyBhZnRlciBkb25lIGVkaXRpbmdcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGRvbmVFZGl0aW5nKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9Qb2xpY3lEZXRhaWxzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZGVsZXRlUG9saWN5KCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIFBvbGljaWVzTW9kZWwuZGVsZXRlKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLnBvbGljeSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9Qb2xpY2llcygpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogVG8gc2hvdyBlZGl0IG9yIGRldGFpbHMgc2NyZWVuIGJhc2VkIG9uIHRoZSByb3V0ZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gc2V0TW9kZSgpIHtcbiAgICAgICAgICAgIGlmICgkc3RhdGUuaXMoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5pc29sYXRpb24uZWRpdCcpKSB7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubW9kZSA9ICdlZGl0JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm1vZGUgPSAnZGV0YWlscyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmVzZXROZXdJbmNvbWluZ1J1bGUoKSB7XG4gICAgICAgICAgICAvL1J1bGUgb2JqZWN0IHRvIGJlIGNyZWF0ZWQgb24gc2VydmVyXG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUgPSB7XG4gICAgICAgICAgICAgICAgcnVsZUlkOiAnJyxcbiAgICAgICAgICAgICAgICBwcmlvcml0eTogMSxcbiAgICAgICAgICAgICAgICBhY3Rpb246ICdhbGxvdycsXG4gICAgICAgICAgICAgICAgZnJvbUVuZHBvaW50R3JvdXA6ICcnLFxuICAgICAgICAgICAgICAgIGZyb21OZXR3b3JrOiAnJyxcbiAgICAgICAgICAgICAgICBmcm9tSXBBZGRyZXNzOiAnJyxcbiAgICAgICAgICAgICAgICBwcm90b2NvbDogJ3RjcCcsXG4gICAgICAgICAgICAgICAgcG9ydDogMCxcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb246ICdpbicsXG4gICAgICAgICAgICAgICAgdGVuYW50TmFtZTogJ2RlZmF1bHQnLFxuICAgICAgICAgICAgICAgIHBvbGljeU5hbWU6IGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLnBvbGljeS5wb2xpY3lOYW1lXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdTZWxlY3RlZEFwcGxpY2F0aW9uR3JvdXAgPSAnJztcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nU2VsZWN0ZWROZXR3b3JrID0gJyc7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdOZXR3b3JrU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdJUEFkZHJlc3NTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29ycmVjdENJRFIgPSBmYWxzZTtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLnZhbGlkYXRlQ0lEUkZsYWcgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXNldE5ld091dGdvaW5nUnVsZSgpIHtcbiAgICAgICAgICAgIC8vUnVsZSBvYmplY3QgdG8gYmUgY3JlYXRlZCBvbiBzZXJ2ZXJcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZSA9IHtcbiAgICAgICAgICAgICAgICBydWxlSWQ6ICcnLFxuICAgICAgICAgICAgICAgIHByaW9yaXR5OiAxLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogJ2FsbG93JyxcbiAgICAgICAgICAgICAgICB0b0VuZHBvaW50R3JvdXA6ICcnLFxuICAgICAgICAgICAgICAgIHRvTmV0d29yazogJycsXG4gICAgICAgICAgICAgICAgdG9JcEFkZHJlc3M6ICcnLFxuICAgICAgICAgICAgICAgIHByb3RvY29sOiAndGNwJyxcbiAgICAgICAgICAgICAgICBwb3J0OiAwLFxuICAgICAgICAgICAgICAgIGRpcmVjdGlvbjogJ291dCcsXG4gICAgICAgICAgICAgICAgdGVuYW50TmFtZTogJ2RlZmF1bHQnLFxuICAgICAgICAgICAgICAgIHBvbGljeU5hbWU6IGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLnBvbGljeS5wb2xpY3lOYW1lXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdTZWxlY3RlZEFwcGxpY2F0aW9uR3JvdXAgPSAnJztcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nU2VsZWN0ZWROZXR3b3JrID0gJyc7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlT3V0Z29pbmdOZXR3b3JrU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlT3V0Z29pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlT3V0Z29pbmdJUEFkZHJlc3NTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29ycmVjdENJRFIgPSBmYWxzZTtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLnZhbGlkYXRlQ0lEUkZsYWcgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IG5ldHdvcmsgbmFtZXMgZm9yIHRoZSBnaXZlbiB0ZW5hbnQuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBnZXROZXR3b3JrcygpIHtcbiAgICAgICAgICAgIE5ldHdvcmtzTW9kZWwuZ2V0KCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy9fLmZpbHRlcigpIHJldHVybnMgYSBuZXcgYXJyYXlcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXR3b3JrcyA9IF8uZmlsdGVyKHJlc3VsdCwge1xuICAgICAgICAgICAgICAgICAgICAndGVuYW50TmFtZSc6ICdkZWZhdWx0JyAvL1RPRE86IFJlbW92ZSBoYXJkY29kZWQgdGVuYW50LlxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdldCBhcHBsaWNhdGlvbiBncm91cCBuYW1lcyBmb3IgdGhlIGdpdmVuIHRlbmFudC5cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGdldEFwcGxpY2F0aW9uR3JvdXBzKCkge1xuICAgICAgICAgICAgQXBwbGljYXRpb25Hcm91cHNNb2RlbC5nZXQoKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAvL18uZmlsdGVyKCkgcmV0dXJucyBhIG5ldyBhcnJheVxuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmFwcGxpY2F0aW9uR3JvdXBzID0gXy5maWx0ZXIocmVzdWx0LCB7XG4gICAgICAgICAgICAgICAgICAgICd0ZW5hbnROYW1lJzogJ2RlZmF1bHQnIC8vVE9ETzogUmVtb3ZlIGhhcmRjb2RlZCB0ZW5hbnQuXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogRXZlbnQgaGFuZGxlciB0byBkaXNhYmxlIG5ldHdvcmsgc2VsZWN0aW9uIGJveCBvbmNlIGFwcGxpY2F0aW9uIGdyb3VwIGlzIHNlbGVjdGVkIHdoaWxlIGNyZWF0aW5nIGEgbmV3XG4gICAgICAgICAqIHJ1bGUuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBvbkNoYW5nZU91dGdvaW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbigpIHtcbiAgICAgICAgICAgIGlmIChpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1NlbGVjdGVkQXBwbGljYXRpb25Hcm91cCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgLy9JZiBhcHBsaWNhdGlvbiBncm91cCBoYXMgYmVlbiBzZWxlY3RlZFxuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZS50b0VuZHBvaW50R3JvdXAgPVxuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1NlbGVjdGVkQXBwbGljYXRpb25Hcm91cC5ncm91cE5hbWU7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlLnRvTmV0d29yayA9ICcnO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ05ldHdvcmtTZWxlY3Rpb24gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy9XaGVuICdub25lJyBpcyBzZWxlY3RlZFxuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZS50b0VuZHBvaW50R3JvdXAgPSAnJztcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlT3V0Z29pbmdOZXR3b3JrU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEV2ZW50IGhhbmRsZXIgdG8gZGlzYWJsZSBuZXR3b3JrIHNlbGVjdGlvbiBib3ggb25jZSBhcHBsaWNhdGlvbiBncm91cCBpcyBzZWxlY3RlZCB3aGlsZSBjcmVhdGluZyBhIG5ld1xuICAgICAgICAgKiBydWxlLlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gb25DaGFuZ2VJbmNvbWluZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdTZWxlY3RlZEFwcGxpY2F0aW9uR3JvdXAgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIC8vSWYgYXBwbGljYXRpb24gZ3JvdXAgaGFzIGJlZW4gc2VsZWN0ZWRcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUuZnJvbUVuZHBvaW50R3JvdXAgPVxuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1NlbGVjdGVkQXBwbGljYXRpb25Hcm91cC5ncm91cE5hbWU7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlLmZyb21OZXR3b3JrID0gJyc7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nTmV0d29ya1NlbGVjdGlvbiA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvL1doZW4gJ25vbmUnIGlzIHNlbGVjdGVkXG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlLmZyb21FbmRwb2ludEdyb3VwID0gJyc7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVJbmNvbWluZ05ldHdvcmtTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogRXZlbnQgaGFuZGxlciB0byBkaXNhYmxlIGFwcGxpY2F0aW9uIGdyb3VwIHNlbGVjdGlvbiBib3ggb25jZSBuZXR3b3JrIGlzIHNlbGVjdGVkIHdoaWxlIGNyZWF0aW5nIGEgbmV3XG4gICAgICAgICAqIHJ1bGUuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBvbkNoYW5nZU91dGdvaW5nTmV0d29ya1NlbGVjdGlvbigpIHtcbiAgICAgICAgICAgIGlmIChpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1NlbGVjdGVkTmV0d29yayAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgLy9JZiBuZXR3b3JrIGhhcyBiZWVuIHNlbGVjdGVkXG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlLnRvTmV0d29yayA9XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nU2VsZWN0ZWROZXR3b3JrO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZS5Ub0VuZHBvaW50R3JvdXAgPSAnJztcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlT3V0Z29pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlT3V0Z29pbmdJUEFkZHJlc3NTZWxlY3Rpb24gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlLnRvSXBBZGRyZXNzID0gJyc7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ0lQQWRkcmVzc1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBFdmVudCBoYW5kbGVyIHRvIGRpc2FibGUgYXBwbGljYXRpb24gZ3JvdXAgc2VsZWN0aW9uIGJveCBvbmNlIG5ldHdvcmsgaXMgc2VsZWN0ZWQgd2hpbGUgY3JlYXRpbmcgYSBuZXdcbiAgICAgICAgICogcnVsZS5cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIG9uQ2hhbmdlSW5jb21pbmdOZXR3b3JrU2VsZWN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nU2VsZWN0ZWROZXR3b3JrICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAvL0lmIG5ldHdvcmsgaGFzIGJlZW4gc2VsZWN0ZWRcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUuZnJvbU5ldHdvcmsgPVxuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1NlbGVjdGVkTmV0d29yaztcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUuZnJvbUVuZHBvaW50R3JvdXAgPSAnJztcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdJUEFkZHJlc3NTZWxlY3Rpb24gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlLmZyb21OZXR3b3JrID0gJyc7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVJbmNvbWluZ0lQQWRkcmVzc1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZW5lcmF0ZXMgcnVsZSBpZFxuICAgICAgICAgKiBUT0RPIE1ha2UgaXQgY3J5cHRvZ3JhcGhpY2FsbHkgc3Ryb25nZXIgb25jZSB3ZSBoYXZlIG11bHRpcGxlIHVzZXJzIHVwZGF0aW5nIHNhbWUgcG9saWN5XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBnZW5lcmF0ZVJ1bGVJZChydWxlKSB7XG4gICAgICAgICAgICBydWxlLnJ1bGVJZCA9XG4gICAgICAgICAgICAgICAgKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29taW5nUnVsZXMubGVuZ3RoICsgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwub3V0Z29pbmdSdWxlcy5sZW5ndGggKyAxKS50b1N0cmluZygpICsgJy0nICtcbiAgICAgICAgICAgICAgICAgICAgRGF0ZS5ub3coKS50b1N0cmluZygpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSdWxlIGlzIHNhdmVkIHRvIHNlcnZlclxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gYWRkSW5jb21pbmdSdWxlKCkge1xuICAgICAgICAgICAgaWYgKHZhbGlkYXRlQ0lEUihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUuZnJvbUlwQWRkcmVzcykpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBnZW5lcmF0ZVJ1bGVJZChpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUpO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nUnVsZS5rZXkgPSBSdWxlc01vZGVsLmdlbmVyYXRlS2V5KGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nUnVsZSk7XG4gICAgICAgICAgICAgICAgUnVsZXNNb2RlbC5jcmVhdGUoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29taW5nUnVsZXMucHVzaChyZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICByZXNldE5ld0luY29taW5nUnVsZSgpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gb25DaGFuZ2VJbmNvbWluZ0lQQWRkcmVzcygpIHtcbiAgICAgICAgICAgIGlmIChpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUuZnJvbUlwQWRkcmVzcyA9PSAnJykge1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29ycmVjdENJRFIgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdOZXR3b3JrU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdOZXR3b3JrU2VsZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC52YWxpZGF0ZUNJRFJGbGFnICYmXG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuaW5jb3JyZWN0Q0lEUikge1xuICAgICAgICAgICAgICAgIHZhbGlkYXRlQ0lEUihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUuZnJvbUlwQWRkcmVzcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gb25DaGFuZ2VPdXRnb2luZ0lQQWRkcmVzcygpIHtcbiAgICAgICAgICAgIGlmIChpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1J1bGUudG9JcEFkZHJlc3MgPT0gJycpIHtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvcnJlY3RDSURSID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nTmV0d29ya1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nTmV0d29ya1NlbGVjdGlvbiA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwudmFsaWRhdGVDSURSRmxhZyAmJlxuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29ycmVjdENJRFIpIHtcbiAgICAgICAgICAgICAgICB2YWxpZGF0ZUNJRFIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlLnRvSXBBZGRyZXNzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiB2YWxpZGF0ZUNJRFIoaXBhZGRyZXNzKSB7XG4gICAgICAgICAgICB2YXIgY2lkclBhdHRlcm4gPSBuZXcgUmVnRXhwKENvbnRpdkdsb2JhbHMuQ0lEUl9SRUdFWCk7XG4gICAgICAgICAgICBpZiAoaXBhZGRyZXNzID09ICcnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY2lkclBhdHRlcm4udGVzdChpcGFkZHJlc3MpKSB7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuaW5jb3JyZWN0Q0lEUiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuaW5jb3JyZWN0Q0lEUiA9IHRydWU7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC52YWxpZGF0ZUNJRFJGbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogUnVsZSBpcyBzYXZlZCB0byBzZXJ2ZXJcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGFkZE91dGdvaW5nUnVsZSgpIHtcbiAgICAgICAgICAgIGlmICh2YWxpZGF0ZUNJRFIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlLnRvSXBBZGRyZXNzKSkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIGdlbmVyYXRlUnVsZUlkKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZSk7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlLmtleSA9IFJ1bGVzTW9kZWwuZ2VuZXJhdGVLZXkoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlKTtcbiAgICAgICAgICAgICAgICBSdWxlc01vZGVsLmNyZWF0ZShpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1J1bGUpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwub3V0Z29pbmdSdWxlcy5wdXNoKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIHJlc2V0TmV3T3V0Z29pbmdSdWxlKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogRGVsZXRlIGluY29taW5nIHJ1bGUgZnJvbSBzZXJ2ZXJcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGRlbGV0ZUluY29taW5nUnVsZShrZXkpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBSdWxlc01vZGVsLmRlbGV0ZVVzaW5nS2V5KGtleSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgXy5yZW1vdmUoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuaW5jb21pbmdSdWxlcywgZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG4ua2V5ID09IGtleTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERlbGV0ZSBvdXRnb2luZyBydWxlIGZyb20gc2VydmVyXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBkZWxldGVPdXRnb2luZ1J1bGUoa2V5KSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgUnVsZXNNb2RlbC5kZWxldGVVc2luZ0tleShrZXkpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIF8ucmVtb3ZlKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm91dGdvaW5nUnVsZXMsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuLmtleSA9PSBrZXk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICBQb2xpY2llc01vZGVsLmdldE1vZGVsQnlLZXkoJHN0YXRlUGFyYW1zLmtleSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLnBvbGljeSA9IHBvbGljeTtcbiAgICAgICAgICAgIFJ1bGVzTW9kZWwuZ2V0SW5jb21pbmdSdWxlcyhwb2xpY3kucG9saWN5TmFtZSwgJ2RlZmF1bHQnKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvbWluZ1J1bGVzID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgIHJlc2V0TmV3SW5jb21pbmdSdWxlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFJ1bGVzTW9kZWwuZ2V0T3V0Z29pbmdSdWxlcyhwb2xpY3kucG9saWN5TmFtZSwgJ2RlZmF1bHQnKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5vdXRnb2luZ1J1bGVzID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgIHJlc2V0TmV3T3V0Z29pbmdSdWxlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGdldE5ldHdvcmtzKCk7XG4gICAgICAgIGdldEFwcGxpY2F0aW9uR3JvdXBzKCk7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRlbGV0ZVBvbGljeSA9IGRlbGV0ZVBvbGljeTtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGVsZXRlSW5jb21pbmdSdWxlID0gZGVsZXRlSW5jb21pbmdSdWxlO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kZWxldGVPdXRnb2luZ1J1bGUgPSBkZWxldGVPdXRnb2luZ1J1bGU7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmFkZEluY29taW5nUnVsZSA9IGFkZEluY29taW5nUnVsZTtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuYWRkT3V0Z29pbmdSdWxlID0gYWRkT3V0Z29pbmdSdWxlO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kb25lRWRpdGluZyA9IGRvbmVFZGl0aW5nO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5jYW5jZWxFZGl0aW5nID0gY2FuY2VsRWRpdGluZztcbiAgICAgICAgLy9FdmVudCBIYW5kbGVyc1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5vbkNoYW5nZU91dGdvaW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IG9uQ2hhbmdlT3V0Z29pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5vbkNoYW5nZUluY29taW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IG9uQ2hhbmdlSW5jb21pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5vbkNoYW5nZU91dGdvaW5nTmV0d29ya1NlbGVjdGlvbiA9IG9uQ2hhbmdlT3V0Z29pbmdOZXR3b3JrU2VsZWN0aW9uO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5vbkNoYW5nZUluY29taW5nTmV0d29ya1NlbGVjdGlvbiA9IG9uQ2hhbmdlSW5jb21pbmdOZXR3b3JrU2VsZWN0aW9uO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5vbkNoYW5nZUluY29taW5nSVBBZGRyZXNzID0gb25DaGFuZ2VJbmNvbWluZ0lQQWRkcmVzcztcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwub25DaGFuZ2VPdXRnb2luZ0lQQWRkcmVzcyA9IG9uQ2hhbmdlT3V0Z29pbmdJUEFkZHJlc3M7XG4gICAgICAgIHNldE1vZGUoKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pc29sYXRpb25wb2xpY3lkZXRhaWxzY3RybC5qcy5tYXAiLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtwb2xpY2llcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5saXN0Lmlzb2xhdGlvbicsIHtcbiAgICAgICAgICAgIHVybDogJy9pc29sYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0lzb2xhdGlvblBvbGljeUxpc3RDdHJsIGFzIGlzb2xhdGlvblBvbGljeUxpc3RDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmV0d29ya19wb2xpY2llcy9pc29sYXRpb25wb2xpY3lsaXN0Lmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdJc29sYXRpb25Qb2xpY3lMaXN0Q3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ1BvbGljaWVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgUG9saWNpZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHBvbGljaWVzTGlzdEN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBnZXRQb2xpY2llcyhyZWxvYWQpIHtcbiAgICAgICAgICAgIFBvbGljaWVzTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihwb2xpY2llc0xpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICBwb2xpY2llc0xpc3RDdHJsLnBvbGljaWVzID0gJGZpbHRlcignb3JkZXJCeScpKHJlc3VsdCwgJ3BvbGljeU5hbWUnKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihwb2xpY2llc0xpc3RDdHJsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vTG9hZCBmcm9tIGNhY2hlIGZvciBxdWljayBkaXNwbGF5IGluaXRpYWxseVxuICAgICAgICBnZXRQb2xpY2llcyhmYWxzZSk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IHN0YXJ0IGF1dG8tcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXRQb2xpY2llcyh0cnVlKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWlzb2xhdGlvbnBvbGljeWxpc3RjdHJsLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy85LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtwb2xpY2llcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5saXN0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTmV0d29ya1BvbGljaWVzVGFic0N0cmwgYXMgbmV0d29ya1BvbGljaWVzVGFic0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3JrX3BvbGljaWVzL25ldHdvcmtwb2xpY2llc3RhYnMuaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmxpc3QucmVkaXJlY3Rpb24nLCB7XG4gICAgICAgICAgICB1cmw6ICcvcmVkaXJlY3Rpb24nLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICcnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOZXR3b3JrUG9saWNpZXNUYWJzQ3RybCcsIFsnJHN0YXRlJywgZnVuY3Rpb24gKCRzdGF0ZSkge1xuICAgICAgICB2YXIgbmV0d29ya1BvbGljaWVzVGFic0N0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBjcmVhdGVOZXR3b3JrUG9saWN5KCkge1xuICAgICAgICAgICAgaWYgKCRzdGF0ZS4kY3VycmVudC5pbmNsdWRlc1snY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmxpc3QuaXNvbGF0aW9uJ10pIHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5pc29sYXRpb24uY3JlYXRlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoJHN0YXRlLiRjdXJyZW50LmluY2x1ZGVzWydjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMubGlzdC5iYW5kd2lkdGgnXSkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmJhbmR3aWR0aC5jcmVhdGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBuZXR3b3JrUG9saWNpZXNUYWJzQ3RybC5jcmVhdGVOZXR3b3JrUG9saWN5ID0gY3JlYXRlTmV0d29ya1BvbGljeTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1uZXR3b3JrcG9saWNpZXN0YWJzY3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDIvMTkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3MnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3Jrcy5jcmVhdGUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmV0d29ya3MvbmV0d29ya2NyZWF0ZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOZXR3b3JrQ3JlYXRlQ3RybCBhcyBuZXR3b3JrQ3JlYXRlQ3RybCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05ldHdvcmtDcmVhdGVDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ05ldHdvcmtzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgTmV0d29ya3NNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIG5ldHdvcmtDcmVhdGVDdHJsID0gdGhpcztcbiAgICAgICAgbmV0d29ya0NyZWF0ZUN0cmwuY2lkclBhdHRlcm4gPSBDb250aXZHbG9iYWxzLkNJRFJfUkVHRVg7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvTmV0d29ya3MoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5ldHdvcmtzLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxDcmVhdGluZygpIHtcbiAgICAgICAgICAgIHJldHVyblRvTmV0d29ya3MoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVOZXR3b3JrKCkge1xuICAgICAgICAgICAgLy9mb3JtIGNvbnRyb2xsZXIgaXMgaW5qZWN0ZWQgYnkgdGhlIGh0bWwgdGVtcGxhdGVcbiAgICAgICAgICAgIC8vY2hlY2tpbmcgaWYgYWxsIHZhbGlkYXRpb25zIGhhdmUgcGFzc2VkXG4gICAgICAgICAgICBpZiAobmV0d29ya0NyZWF0ZUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IobmV0d29ya0NyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKG5ldHdvcmtDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBuZXR3b3JrQ3JlYXRlQ3RybC5uZXdOZXR3b3JrLmtleSA9XG4gICAgICAgICAgICAgICAgICAgIG5ldHdvcmtDcmVhdGVDdHJsLm5ld05ldHdvcmsudGVuYW50TmFtZSArICc6JyArIG5ldHdvcmtDcmVhdGVDdHJsLm5ld05ldHdvcmsubmV0d29ya05hbWU7XG4gICAgICAgICAgICAgICAgTmV0d29ya3NNb2RlbC5jcmVhdGUobmV0d29ya0NyZWF0ZUN0cmwubmV3TmV0d29yaykudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobmV0d29ya0NyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub05ldHdvcmtzKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3JrQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihuZXR3b3JrQ3JlYXRlQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXNldEZvcm0oKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihuZXR3b3JrQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBuZXR3b3JrQ3JlYXRlQ3RybC5uZXdOZXR3b3JrID0ge1xuICAgICAgICAgICAgICAgIG5ldHdvcmtOYW1lOiAnJyxcbiAgICAgICAgICAgICAgICBlbmNhcDogJ3Z4bGFuJyxcbiAgICAgICAgICAgICAgICBzdWJuZXQ6ICcnLFxuICAgICAgICAgICAgICAgIGdhdGV3YXk6ICcnLFxuICAgICAgICAgICAgICAgIHRlbmFudE5hbWU6ICdkZWZhdWx0JyAvL1RPRE86IFJlbW92ZSBoYXJkY29kZWQgdGVuYW50LlxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBuZXR3b3JrQ3JlYXRlQ3RybC5jcmVhdGVOZXR3b3JrID0gY3JlYXRlTmV0d29yaztcbiAgICAgICAgbmV0d29ya0NyZWF0ZUN0cmwuY2FuY2VsQ3JlYXRpbmcgPSBjYW5jZWxDcmVhdGluZztcbiAgICAgICAgcmVzZXRGb3JtKCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bmV0d29ya2NyZWF0ZWN0cmwuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOZXR3b3JrRGV0YWlsc0N0cmwgYXMgbmV0d29ya0RldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmV0d29ya3MvbmV0d29ya2RldGFpbHMuaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3MuZGV0YWlscy5pbmZvJywge1xuICAgICAgICAgICAgdXJsOiAnL2luZm8nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3Jrcy9uZXR3b3JraW5mby5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTmV0d29ya0RldGFpbHNDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdOZXR3b3Jrc01vZGVsJywgJ0FwcGxpY2F0aW9uR3JvdXBzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIE5ldHdvcmtzTW9kZWwsIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBuZXR3b3JrRGV0YWlsc0N0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub05ldHdvcmtzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5uZXR3b3Jrcy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZGVsZXRlTmV0d29yaygpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihuZXR3b3JrRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIobmV0d29ya0RldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIE5ldHdvcmtzTW9kZWwuZGVsZXRlKG5ldHdvcmtEZXRhaWxzQ3RybC5uZXR3b3JrKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9OZXR3b3JrcygpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKG5ldHdvcmtEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZXQgYXBwbGljYXRpb24gZ3JvdXBzIGJlbG9uZ2luZyB0byBhIG5ldHdvcmtcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGdldEFwcGxpY2F0aW9uR3JvdXBzKHJlbG9hZCkge1xuICAgICAgICAgICAgQXBwbGljYXRpb25Hcm91cHNNb2RlbC5nZXQocmVsb2FkKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBuZXR3b3JrRGV0YWlsc0N0cmwuYXBwbGljYXRpb25Hcm91cHMgPSAkZmlsdGVyKCdvcmRlckJ5JykoXy5maWx0ZXIocmVzdWx0LCB7XG4gICAgICAgICAgICAgICAgICAgICduZXR3b3JrTmFtZSc6IG5ldHdvcmtEZXRhaWxzQ3RybC5uZXR3b3JrLm5ldHdvcmtOYW1lXG4gICAgICAgICAgICAgICAgfSksICdncm91cE5hbWUnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobmV0d29ya0RldGFpbHNDdHJsKTtcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG5ldHdvcmtEZXRhaWxzQ3RybCk7XG4gICAgICAgIE5ldHdvcmtzTW9kZWwuZ2V0TW9kZWxCeUtleSgkc3RhdGVQYXJhbXMua2V5KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKG5ldHdvcmspIHtcbiAgICAgICAgICAgIG5ldHdvcmtEZXRhaWxzQ3RybC5uZXR3b3JrID0gbmV0d29yaztcbiAgICAgICAgICAgIGdldEFwcGxpY2F0aW9uR3JvdXBzKGZhbHNlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIG5ldHdvcmtEZXRhaWxzQ3RybC5kZWxldGVOZXR3b3JrID0gZGVsZXRlTmV0d29yaztcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0b3JlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0QXBwbGljYXRpb25Hcm91cHModHJ1ZSk7XG4gICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1uZXR3b3JrZGV0YWlsc2N0cmwuanMubWFwIiwidmFyIE5ldHdvcmtzTGlzdEN0cmwgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE5ldHdvcmtzTGlzdEN0cmwoJHNjb3BlLCAkaW50ZXJ2YWwsIE5ldHdvcmtzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBuZXR3b3Jrc0xpc3RDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gZ2V0TmV0d29ya3MocmVsb2FkKSB7XG4gICAgICAgICAgICBOZXR3b3Jrc01vZGVsLmdldChyZWxvYWQpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobmV0d29ya3NMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgbmV0d29ya3NMaXN0Q3RybC5uZXR3b3JrcyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3Jrc0xpc3RDdHJsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vTG9hZCBmcm9tIGNhY2hlIGZvciBxdWljayBkaXNwbGF5IGluaXRpYWxseVxuICAgICAgICBnZXROZXR3b3JrcyhmYWxzZSk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG9yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldE5ldHdvcmtzKHRydWUpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIE5ldHdvcmtzTGlzdEN0cmwuJGluamVjdCA9IFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICdOZXR3b3Jrc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJ107XG4gICAgcmV0dXJuIE5ldHdvcmtzTGlzdEN0cmw7XG59KCkpO1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICduZXR3b3JrTGlzdCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbXBvbmVudCgnbmV0d29ya0xpc3QnLCB7XG4gICAgdGVtcGxhdGVVcmw6ICduZXR3b3Jrcy9uZXR3b3JrbGlzdC5odG1sJyxcbiAgICBjb250cm9sbGVyOiBOZXR3b3Jrc0xpc3RDdHJsLFxuICAgIGNvbnRyb2xsZXJBczogJ25ldHdvcmtzTGlzdEN0cmwnXG59KTtcbi8qXG4gICAgLmNvbnRyb2xsZXIoJ05ldHdvcmtzTGlzdEN0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdOZXR3b3Jrc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICAgICAgZnVuY3Rpb24gKCRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBOZXR3b3Jrc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICAgICAgdmFyIG5ldHdvcmtzTGlzdEN0cmwgPSB0aGlzO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXROZXR3b3JrcyhyZWxvYWQpIHtcbiAgICAgICAgICAgICAgICBOZXR3b3Jrc01vZGVsLmdldChyZWxvYWQpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtzTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldHdvcmtzTGlzdEN0cmwubmV0d29ya3MgPSByZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtzTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vTG9hZCBmcm9tIGNhY2hlIGZvciBxdWljayBkaXNwbGF5IGluaXRpYWxseVxuICAgICAgICAgICAgZ2V0TmV0d29ya3MoZmFsc2UpO1xuXG4gICAgICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgICAgIC8vRG9uJ3QgZG8gYXV0b3JlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2V0TmV0d29ya3ModHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XSk7XG4qLyBcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5ldHdvcmtsaXN0Y3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgY3NoYW1wdXIgb24gNi8yMy8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtzLmRldGFpbHMuc3RhdHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvc3RhdHMnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05ldHdvcmtTdGF0c0N0cmwgYXMgbmV0d29ya1N0YXRzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtzL25ldHdvcmtzdGF0cy5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTmV0d29ya1N0YXRzQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnTmV0d29ya3NNb2RlbCcsICdJbnNwZWN0U2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCAkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgTmV0d29ya3NNb2RlbCwgSW5zcGVjdFNlcnZpY2UpIHtcbiAgICAgICAgdmFyIG5ldHdvcmtTdGF0c0N0cmwgPSB0aGlzO1xuICAgICAgICAvKiBHZXRzIHRoZSBOZXR3b3JrIE9wZXJhdGlvbmFsIHN0YXRlIGZyb20gdGhlIHNlcnZlciAqL1xuICAgICAgICBmdW5jdGlvbiBnZXROZXR3b3JrSW5zcGVjdChyZWZyZXNoKSB7XG4gICAgICAgICAgICBOZXR3b3Jrc01vZGVsLmdldEluc3BlY3RCeUtleSgkc3RhdGVQYXJhbXMua2V5LCBDb250aXZHbG9iYWxzLk5FVFdPUktTX0lOU1BFQ1RfRU5EUE9JTlQsIHJlZnJlc2gpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIG5ldHdvcmtTdGF0c0N0cmwubmV0d29ya0luc3BlY3RTdGF0cyA9IHJlc3VsdC5PcGVyO1xuICAgICAgICAgICAgICAgIG5ldHdvcmtTdGF0c0N0cmwuY29uZmlnID0gcmVzdWx0LkNvbmZpZztcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0Lk9wZXIuZW5kcG9pbnRzICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29udGFpbmVyRGV0YWlscyA9IEluc3BlY3RTZXJ2aWNlLmJ1aWxkRW5kUG9pbnRzKHJlc3VsdC5PcGVyLmVuZHBvaW50cyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChJbnNwZWN0U2VydmljZS5jaGVja0NvbnRhaW5lckNoYW5nZWQobmV0d29ya1N0YXRzQ3RybC5jb250YWluZXJEZXRhaWxzLCBjb250YWluZXJEZXRhaWxzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV0d29ya1N0YXRzQ3RybC5lbmRwb2ludHMgPSByZXN1bHQuT3Blci5lbmRwb2ludHM7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXR3b3JrU3RhdHNDdHJsLmNvbnRhaW5lckRldGFpbHMgPSBjb250YWluZXJEZXRhaWxzO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBuZXR3b3JrU3RhdHNDdHJsLmVuZHBvaW50cyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBuZXR3b3JrU3RhdHNDdHJsLmNvbnRhaW5lckRldGFpbHMgPSB7fTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBnZXROZXR3b3JrSW5zcGVjdChmYWxzZSk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG9yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldE5ldHdvcmtJbnNwZWN0KHRydWUpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bmV0d29ya3N0YXRzY3RybC5qcy5tYXAiLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJylcbiAgICAuZmFjdG9yeSgnQmdwU2VydmljZScsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbiAoJGh0dHAsICRxKSB7XG4gICAgICAgIGZ1bmN0aW9uIGdldEJncChjdHJsKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuQkdQU19FTkRQT0lOVCArIGN0cmwua2V5ICsgJy8nO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgY3RybC5uZWlnaGJvciA9IHJlc3VsdC5kYXRhO1xuICAgICAgICAgICAgICAgIGN0cmwubmVpZ2hib3JzLnB1c2goeyAnbmFtZSc6IGN0cmwubmVpZ2hib3JbJ25laWdoYm9yJ10sICd2YWx1ZSc6IGN0cmwubmVpZ2hib3JbJ25laWdoYm9yLWFzJ10gfSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUJncChjdHJsKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5CR1BTX0VORFBPSU5UICsgY3RybC5rZXkgKyAnLyc7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCh1cmwsIGN0cmwubmVpZ2hib3IpO1xuICAgICAgICB9XG4gICAgICAgIDtcbiAgICAgICAgZnVuY3Rpb24gZ2V0QmdwSW5zcGVjdChrZXkpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5CR1BTX0lOU1BFQ1RfRU5EUE9JTlQgKyBrZXkgKyAnLyc7XG4gICAgICAgICAgICAkaHR0cC5nZXQodXJsKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldEJncDogZ2V0QmdwLFxuICAgICAgICAgICAgdXBkYXRlQmdwOiB1cGRhdGVCZ3AsXG4gICAgICAgICAgICBnZXRCZ3BJbnNwZWN0OiBnZXRCZ3BJbnNwZWN0XG4gICAgICAgIH07XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Ymdwc2VydmljZS5qcy5tYXAiLCJhbmd1bGFyLm1vZHVsZShcImNvbnRpdi5ub2Rlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZMb2dzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL2xvZ3MuaHRtbCcsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBsb2c6IFwiPVwiLFxuICAgICAgICAgICAgdGl0bGU6IFwiQFwiXG4gICAgICAgIH1cbiAgICB9O1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1sb2dzZGlyZWN0aXZlLmpzLm1hcCIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5mYWN0b3J5KCdMb2dTZXJ2aWNlJywgWyckaHR0cCcsICckcScsIGZ1bmN0aW9uICgkaHR0cCwgJHEpIHtcbiAgICAgICAgZnVuY3Rpb24gZ2V0QWN0aXZlTG9ncygpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5OT0RFU19BQ1RJVkVfSk9CX0VORFBPSU5UO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdldExhc3RMb2dzKCkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLk5PREVTX0xBU1RfSk9CX0VORFBPSU5UO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRBY3RpdmVMb2dzOiBnZXRBY3RpdmVMb2dzLFxuICAgICAgICAgICAgZ2V0TGFzdExvZ3M6IGdldExhc3RMb2dzXG4gICAgICAgIH07XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bG9nc2VydmljZS5qcy5tYXAiLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMuYWN0aXZlbG9nJywge1xuICAgICAgICAgICAgdXJsOiAnL2FjdGl2ZWxvZycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZUFjdGl2ZUpvYkxvZ3NDdHJsIGFzIG5vZGVBY3RpdmVKb2JMb2dzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxjdHYtbG9ncyB0aXRsZT1cIkFjdGl2ZSBKb2JcIiBsb2c9XCJub2RlQWN0aXZlSm9iTG9nc0N0cmwuYWN0aXZlTG9nc1wiPjwvY3R2LWxvZ3M+J1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTm9kZUFjdGl2ZUpvYkxvZ3NDdHJsJywgWyckc2NvcGUnLCAnJGludGVydmFsJywgJ0xvZ1NlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc2NvcGUsICRpbnRlcnZhbCwgTG9nU2VydmljZSkge1xuICAgICAgICB2YXIgbm9kZUFjdGl2ZUpvYkxvZ3NDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gZ2V0QWN0aXZlTG9ncygpIHtcbiAgICAgICAgICAgIExvZ1NlcnZpY2UuZ2V0QWN0aXZlTG9ncygpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIG5vZGVBY3RpdmVKb2JMb2dzQ3RybC5hY3RpdmVMb2dzID0gcmVzdWx0O1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAvL09uY2UgdGhlIGpvYiBmaW5pc2hlcywgZW5kcG9pbnQgcmV0dXJucyA1MDAgZXJyb3IuIFNvIHJlc2V0IHRoZSBhY3RpdmVMb2dzXG4gICAgICAgICAgICAgICAgbm9kZUFjdGl2ZUpvYkxvZ3NDdHJsLmFjdGl2ZUxvZ3MgPSB7XG4gICAgICAgICAgICAgICAgICAgIGRlc2M6ICdUaGVyZSBpcyBjdXJyZW50bHkgbm8gYWN0aXZlIGpvYi4gQ2hlY2sgTGFzdCBKb2IgZm9yIGEgam9iIHRoYXQgcmVjZW50bHkgZmluaXNoZWQuJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBnZXRBY3RpdmVMb2dzKCk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG8tcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXRBY3RpdmVMb2dzKCk7XG4gICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1ub2RlYWN0aXZlam9ibG9nc2N0cmwuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzI1LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMuY29tbWlzc2lvbicsIHtcbiAgICAgICAgICAgIHVybDogJy9jb21taXNzaW9uLzprZXknLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVDb21taXNzaW9uQ3RybCBhcyBub2RlQ29tbWlzc2lvbkN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2RlY29tbWlzc2lvbi5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTm9kZUNvbW1pc3Npb25DdHJsJywgW1xuICAgICckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ05vZGVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLCAnTm9kZXNTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIE5vZGVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlLCBOb2Rlc1NlcnZpY2UpIHtcbiAgICAgICAgdmFyIG5vZGVDb21taXNzaW9uQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvTm9kZURldGFpbHMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMuaW5mbycsIHsgJ2tleSc6ICRzdGF0ZVBhcmFtcy5rZXkgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ29tbWlzc2lvbmluZ05vZGUoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub05vZGVEZXRhaWxzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY29tbWlzc2lvbigpIHtcbiAgICAgICAgICAgIGlmIChub2RlQ29tbWlzc2lvbkN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iobm9kZUNvbW1pc3Npb25DdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgICAgICAgICAgICAgIG5vZGVDb21taXNzaW9uQ3RybC5ub2RlT3BzT2JqLm5vZGVzID0gWyRzdGF0ZVBhcmFtcy5rZXldO1xuICAgICAgICAgICAgICAgIE5vZGVzU2VydmljZS5jbGVhbnVwRXh0cmFWYXJzKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgTm9kZXNTZXJ2aWNlLmNyZWF0ZUV4dHJhVmFycyhub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgICAgICAgICAgICAgIE5vZGVzTW9kZWwuY29tbWlzc2lvbihub2RlQ29tbWlzc2lvbkN0cmwubm9kZU9wc09iaikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobm9kZUNvbW1pc3Npb25DdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9Ob2RlRGV0YWlscygpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobm9kZUNvbW1pc3Npb25DdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKG5vZGVDb21taXNzaW9uQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwubm9kZU9wc09iaiA9IHt9O1xuICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuZXh0cmFfdmFycyA9IHt9OyAvL1RPRE8gSW50aWFsaXplIGZyb20gZ2xvYmFsIHNldHRpbmdzXG4gICAgICAgIG5vZGVDb21taXNzaW9uQ3RybC5hbnNpYmxlVmFyaWFibGVzID0gW107XG4gICAgICAgIG5vZGVDb21taXNzaW9uQ3RybC5lbnZWYXJpYWJsZXMgPSBbXTtcbiAgICAgICAgTm9kZXNTZXJ2aWNlLmdldFNldHRpbmdzKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgIG5vZGVDb21taXNzaW9uQ3RybC5jYW5jZWxDb21taXNzaW9uaW5nTm9kZSA9IGNhbmNlbENvbW1pc3Npb25pbmdOb2RlO1xuICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuY29tbWlzc2lvbiA9IGNvbW1pc3Npb247XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobm9kZUNvbW1pc3Npb25DdHJsKTtcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bm9kZWNvbW1pc3Npb25jdHJsLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8yNS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGV0YWlsc0N0cmwgYXMgbm9kZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWRldGFpbHMuaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMuZGV0YWlscy5pbmZvJywge1xuICAgICAgICAgICAgdXJsOiAnL2luZm8nLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVEZXRhaWxzQ3RybCBhcyBub2RlRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2RlaW5mby5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLnN0YXRzJywge1xuICAgICAgICAgICAgdXJsOiAnL3N0YXRzJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGV0YWlsc0N0cmwgYXMgbm9kZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZXN0YXRzLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMubG9ncycsIHtcbiAgICAgICAgICAgIHVybDogJy9sb2dzJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGV0YWlsc0N0cmwgYXMgbm9kZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWxvZ3MuaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMuZGV0YWlscy5lZGl0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2VkaXQnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVEZXRhaWxzQ3RybCBhcyBub2RlRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2RlaW5mby5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTm9kZURldGFpbHNDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJyRzY29wZScsICckaW50ZXJ2YWwnLCAnTm9kZXNNb2RlbCcsICdCZ3BTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRzY29wZSwgJGludGVydmFsLCBOb2Rlc01vZGVsLCBCZ3BTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBub2RlRGV0YWlsc0N0cmwgPSB0aGlzO1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwubnVtYmVycGF0dGVybiA9IENvbnRpdkdsb2JhbHMuTlVNQkVSX1JFR0VYO1xuICAgICAgICBmdW5jdGlvbiBkZWNvbW1pc3Npb24oKSB7XG4gICAgICAgICAgICB2YXIgbm9kZU9wc09iaiA9IHtcbiAgICAgICAgICAgICAgICBub2RlczogWyRzdGF0ZVBhcmFtcy5rZXldXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgTm9kZXNNb2RlbC5kZWNvbW1pc3Npb24obm9kZU9wc09iaikudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy9EaXNhYmxlIGFsbCBidXR0b25zIGluaXRpYWxseS4gUG9sbCB3aWxsIGFzc2lnbiB2YWx1ZXMgYXBwcm9wcmlhdGVseS5cbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHVwZ3JhZGUoKSB7XG4gICAgICAgICAgICB2YXIgbm9kZU9wc09iaiA9IHtcbiAgICAgICAgICAgICAgICBub2RlczogWyRzdGF0ZVBhcmFtcy5rZXldXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgTm9kZXNNb2RlbC51cGdyYWRlKG5vZGVPcHNPYmopLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vRGlzYWJsZSBhbGwgYnV0dG9ucyBpbml0aWFsbHkuIFBvbGwgd2lsbCBhc3NpZ24gdmFsdWVzIGFwcHJvcHJpYXRlbHkuXG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogRGlzcGxheSBidXR0b25zIGJhc2VkIG9uIHN0YXR1cyBvZiBub2RlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBzZXRCdXR0b25EaXNwbGF5KCkge1xuICAgICAgICAgICAgc3dpdGNoIChub2RlRGV0YWlsc0N0cmwubm9kZVsnaW52ZW50b3J5X3N0YXRlJ10uc3RhdHVzKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnVW5hbGxvY2F0ZWQnOlxuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnRGVjb21taXNzaW9uZWQnOlxuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnUHJvdmlzaW9uaW5nJzpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdBbGxvY2F0ZWQnOlxuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnQ2FuY2VsbGVkJzpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnTWFpbnRlbmFuY2UnOlxuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0Tm9kZUluZm8ocmVsb2FkKSB7XG4gICAgICAgICAgICBOb2Rlc01vZGVsLmdldE1vZGVsQnlLZXkoJHN0YXRlUGFyYW1zLmtleSwgcmVsb2FkKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm5vZGUgPSBub2RlO1xuICAgICAgICAgICAgICAgIHNldEJ1dHRvbkRpc3BsYXkoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHNldE1vZGUoKSB7XG4gICAgICAgICAgICBpZiAoJHN0YXRlLmlzKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLmVkaXQnKSkge1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5tb2RlID0gJ2VkaXQnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm1vZGUgPSAnZGV0YWlscyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9JbmZvKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLmluZm8nKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVCZ3BJbmZvKCkge1xuICAgICAgICAgICAgaWYgKG5vZGVEZXRhaWxzQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvci5rZXkgPSAkc3RhdGVQYXJhbXMua2V5O1xuICAgICAgICAgICAgICAgIC8vIGJhY2tlbmQgb25seSBzdXBwb3J0cyBhZGRpbmcgb25lIG5laWdoYm9yIGN1cnJlbnRseVxuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvcnMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3JbJ25laWdoYm9yJ10gPSBpdGVtLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvclsnbmVpZ2hib3ItYXMnXSA9IGl0ZW0udmFsdWU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgQmdwU2VydmljZS51cGRhdGVCZ3Aobm9kZURldGFpbHNDdHJsKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm5laWdoYm9yID0gcmVzdWx0LmNvbmZpZy5kYXRhO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub0luZm8oKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdldEJncEluZm8oKSB7XG4gICAgICAgICAgICBCZ3BTZXJ2aWNlLmdldEJncChub2RlRGV0YWlsc0N0cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvciA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnZXRCZ3BJbnNwZWN0KCkge1xuICAgICAgICAgICAgQmdwU2VydmljZS5nZXRCZ3BJbnNwZWN0KCRzdGF0ZVBhcmFtcy5rZXkpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5pbnNwZWN0ID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5yb3V0ZXMgPSByZXN1bHQuT3Blci5yb3V0ZXM7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmZpbHRlcmVkcm91dGVzID0gcmVzdWx0Lk9wZXIucm91dGVzO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC5kZWNvbW1pc3Npb24gPSBkZWNvbW1pc3Npb247XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlID0gdXBncmFkZTtcbiAgICAgICAgbm9kZURldGFpbHNDdHJsLnNldE1vZGUgPSBzZXRNb2RlO1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBkYXRlQmdwSW5mbyA9IHVwZGF0ZUJncEluZm87XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC5yZXR1cm5Ub0luZm8gPSByZXR1cm5Ub0luZm87XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvcnMgPSBbXTtcbiAgICAgICAgbm9kZURldGFpbHNDdHJsLm5laWdoYm9yID0ge307XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC5rZXkgPSAkc3RhdGVQYXJhbXMua2V5O1xuICAgICAgICBnZXRCZ3BJbmZvKCk7XG4gICAgICAgIGdldEJncEluc3BlY3QoKTtcbiAgICAgICAgc2V0TW9kZSgpO1xuICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgZ2V0Tm9kZUluZm8oZmFsc2UpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0Tm9kZUluZm8odHJ1ZSk7XG4gICAgICAgICAgICB9LCA1MDAwKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bm9kZWRldGFpbHNjdHJsLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNi8xNC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoXCJjb250aXYubm9kZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2Tm9kZXN0YXR1c1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIG5vZGU6ICc9J1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVzdGF0dXMuaHRtbCdcbiAgICB9O1xufSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2Tm9kZXN0YXRlXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgbm9kZTogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZXN0YXRlLmh0bWwnXG4gICAgfTtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bm9kZWRpcmVjdGl2ZS5qcy5tYXAiLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMuZGlzY292ZXInLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGlzY292ZXInLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVEaXNjb3ZlckN0cmwgYXMgbm9kZURpc2NvdmVyQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVkaXNjb3Zlci5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTm9kZURpc2NvdmVyQ3RybCcsIFtcbiAgICAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdOb2Rlc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJywgJ05vZGVzU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBOb2Rlc01vZGVsLCBDUlVESGVscGVyU2VydmljZSwgTm9kZXNTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBub2RlRGlzY292ZXJDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Ob2RlcygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubm9kZXMubGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbERpc2NvdmVyaW5nTm9kZSgpIHtcbiAgICAgICAgICAgIHJldHVyblRvTm9kZXMoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBkaXNjb3ZlcigpIHtcbiAgICAgICAgICAgIGlmIChub2RlRGlzY292ZXJDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICAgICAgICAgIGNyZWF0ZUlQQWRkckFycmF5KCk7XG4gICAgICAgICAgICAgICAgTm9kZXNTZXJ2aWNlLmNyZWF0ZUV4dHJhVmFycyhub2RlRGlzY292ZXJDdHJsKTtcbiAgICAgICAgICAgICAgICBOb2Rlc01vZGVsLmRpc2NvdmVyKG5vZGVEaXNjb3ZlckN0cmwubm9kZU9wc09iaikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvTm9kZXMoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Iobm9kZURpc2NvdmVyQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVJUEFkZHJBcnJheSgpIHtcbiAgICAgICAgICAgIG5vZGVEaXNjb3ZlckN0cmwubm9kZU9wc09iai5hZGRycyA9IF8ud29yZHMobm9kZURpc2NvdmVyQ3RybC5ub2RlSVBBZGRyLCAvW14sIF0rL2cpO1xuICAgICAgICB9XG4gICAgICAgIG5vZGVEaXNjb3ZlckN0cmwubm9kZU9wc09iaiA9IHt9O1xuICAgICAgICBub2RlRGlzY292ZXJDdHJsLmV4dHJhX3ZhcnMgPSB7fTsgLy9UT0RPIEludGlhbGl6ZSBmcm9tIGdsb2JhbCBzZXR0aW5nc1xuICAgICAgICBub2RlRGlzY292ZXJDdHJsLmFuc2libGVWYXJpYWJsZXMgPSBbXTtcbiAgICAgICAgbm9kZURpc2NvdmVyQ3RybC5lbnZWYXJpYWJsZXMgPSBbXTtcbiAgICAgICAgbm9kZURpc2NvdmVyQ3RybC5ub2RlSVBBZGRyID0gJyc7IC8vSVAgYWRkcmVzcyBvZiBub2RlcyB0byBkaXNjb3ZlclxuICAgICAgICBOb2Rlc1NlcnZpY2UuZ2V0U2V0dGluZ3Mobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgICAgIG5vZGVEaXNjb3ZlckN0cmwuZGlzY292ZXIgPSBkaXNjb3ZlcjtcbiAgICAgICAgbm9kZURpc2NvdmVyQ3RybC5jYW5jZWxEaXNjb3ZlcmluZ05vZGUgPSBjYW5jZWxEaXNjb3ZlcmluZ05vZGU7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihub2RlRGlzY292ZXJDdHJsKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1ub2RlZGlzY292ZXJjdHJsLmpzLm1hcCIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5sYXN0bG9nJywge1xuICAgICAgICAgICAgdXJsOiAnL2xhc3Rsb2cnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVMYXN0Sm9iTG9nc0N0cmwgYXMgbm9kZUxhc3RKb2JMb2dzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxjdHYtbG9ncyB0aXRsZT1cIkxhc3QgSm9iXCIgbG9nPVwibm9kZUxhc3RKb2JMb2dzQ3RybC5sYXN0TG9nc1wiPjwvY3R2LWxvZ3M+J1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTm9kZUxhc3RKb2JMb2dzQ3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICdMb2dTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsIExvZ1NlcnZpY2UpIHtcbiAgICAgICAgdmFyIG5vZGVMYXN0Sm9iTG9nc0N0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBnZXRMYXN0TG9ncygpIHtcbiAgICAgICAgICAgIExvZ1NlcnZpY2UuZ2V0TGFzdExvZ3MoKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBub2RlTGFzdEpvYkxvZ3NDdHJsLmxhc3RMb2dzID0gcmVzdWx0O1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGdldExhc3RMb2dzKCk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG8tcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXRMYXN0TG9ncygpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bm9kZWxhc3Rqb2Jsb2dzY3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMjIvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5saXN0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVMaXN0Q3RybCBhcyBub2RlTGlzdEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2RlbGlzdC5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTm9kZUxpc3RDdHJsJywgWyckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnTm9kZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBOb2Rlc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgbm9kZUxpc3RDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gZ2V0Tm9kZXMocmVsb2FkKSB7XG4gICAgICAgICAgICBOb2Rlc01vZGVsLmdldChyZWxvYWQpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobm9kZUxpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICBub2RlTGlzdEN0cmwubm9kZXMgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobm9kZUxpc3RDdHJsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vTG9hZCBmcm9tIGNhY2hlIGZvciBxdWljayBkaXNwbGF5IGluaXRpYWxseVxuICAgICAgICBnZXROb2RlcyhmYWxzZSk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG8tcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXROb2Rlcyh0cnVlKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVsaXN0Y3RybC5qcy5tYXAiLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2Lm9yZ2FuaXphdGlvbnMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5vcmdhbml6YXRpb25zLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdvcmdhbml6YXRpb25zL29yZ2FuaXphdGlvbmNyZWF0ZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdPcmdhbml6YXRpb25DcmVhdGVDdHJsIGFzIG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdPcmdhbml6YXRpb25DcmVhdGVDdHJsJywgWyckc3RhdGUnLCAnT3JnYW5pemF0aW9uc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCBPcmdhbml6YXRpb25zTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBvcmdhbml6YXRpb25DcmVhdGVDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Pcmdhbml6YXRpb25zKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5vcmdhbml6YXRpb25zLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxDcmVhdGluZygpIHtcbiAgICAgICAgICAgIHJldHVyblRvT3JnYW5pemF0aW9ucygpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZU9yZ2FuaXphdGlvbigpIHtcbiAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgaWYgKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybC5uZXdPcmdhbml6YXRpb24ua2V5ID0gb3JnYW5pemF0aW9uQ3JlYXRlQ3RybC5uZXdPcmdhbml6YXRpb24udGVuYW50TmFtZTtcbiAgICAgICAgICAgICAgICBPcmdhbml6YXRpb25zTW9kZWwuY3JlYXRlKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwubmV3T3JnYW5pemF0aW9uKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25DcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9Pcmdhbml6YXRpb25zKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25DcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmVzZXRGb3JtKCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25DcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25DcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwubmV3T3JnYW5pemF0aW9uID0ge1xuICAgICAgICAgICAgICAgIHRlbmFudE5hbWU6ICcnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwuY3JlYXRlT3JnYW5pemF0aW9uID0gY3JlYXRlT3JnYW5pemF0aW9uO1xuICAgICAgICBvcmdhbml6YXRpb25DcmVhdGVDdHJsLmNhbmNlbENyZWF0aW5nID0gY2FuY2VsQ3JlYXRpbmc7XG4gICAgICAgIHJlc2V0Rm9ybSgpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW9yZ2FuaXphdGlvbmNyZWF0ZWN0cmwuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5vcmdhbml6YXRpb25zJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnT3JnYW5pemF0aW9uRGV0YWlsc0N0cmwgYXMgb3JnYW5pemF0aW9uRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdvcmdhbml6YXRpb25zL29yZ2FuaXphdGlvbmRldGFpbHMuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ09yZ2FuaXphdGlvbkRldGFpbHNDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ09yZ2FuaXphdGlvbnNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBPcmdhbml6YXRpb25zTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBvcmdhbml6YXRpb25EZXRhaWxzQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvT3JnYW5pemF0aW9ucygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZGVsZXRlT3JnYW5pemF0aW9uKCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIE9yZ2FuaXphdGlvbnNNb2RlbC5kZWxldGUob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwub3JnYW5pemF0aW9uKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICByZXR1cm5Ub09yZ2FuaXphdGlvbnMoKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgIE9yZ2FuaXphdGlvbnNNb2RlbC5nZXRNb2RlbEJ5S2V5KCRzdGF0ZVBhcmFtcy5rZXkpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAob3JnYW5pemF0aW9uKSB7XG4gICAgICAgICAgICBvcmdhbml6YXRpb25EZXRhaWxzQ3RybC5vcmdhbml6YXRpb24gPSBvcmdhbml6YXRpb247XG4gICAgICAgIH0pO1xuICAgICAgICBvcmdhbml6YXRpb25EZXRhaWxzQ3RybC5kZWxldGVPcmdhbml6YXRpb24gPSBkZWxldGVPcmdhbml6YXRpb247XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9b3JnYW5pemF0aW9uZGV0YWlsc2N0cmwuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5vcmdhbml6YXRpb25zJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5saXN0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ09yZ2FuaXphdGlvbnNMaXN0Q3RybCBhcyBvcmdhbml6YXRpb25zTGlzdEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdvcmdhbml6YXRpb25zL29yZ2FuaXphdGlvbmxpc3QuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ09yZ2FuaXphdGlvbnNMaXN0Q3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ09yZ2FuaXphdGlvbnNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBPcmdhbml6YXRpb25zTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBvcmdhbml6YXRpb25zTGlzdEN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBnZXRPcmdhbml6YXRpb25zKHJlbG9hZCkge1xuICAgICAgICAgICAgT3JnYW5pemF0aW9uc01vZGVsLmdldChyZWxvYWQpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uc0xpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICBvcmdhbml6YXRpb25zTGlzdEN0cmwub3JnYW5pemF0aW9ucyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25zTGlzdEN0cmwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgIGdldE9yZ2FuaXphdGlvbnMoZmFsc2UpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXRPcmdhbml6YXRpb25zKHRydWUpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9b3JnYW5pemF0aW9ubGlzdGN0cmwuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzEyLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnNlcnZpY2VsYnMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXJ2aWNlX2xicy9zZXJ2aWNlbGJjcmVhdGUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU2VydmljZWxiQ3JlYXRlQ3RybCBhcyBzZXJ2aWNlbGJDcmVhdGVDdHJsJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignU2VydmljZWxiQ3JlYXRlQ3RybCcsIFtcbiAgICAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdTZXJ2aWNlbGJzTW9kZWwnLCAnTmV0d29ya3NNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBTZXJ2aWNlbGJzTW9kZWwsIE5ldHdvcmtzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlbGJDcmVhdGVDdHJsID0gdGhpcztcbiAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5sYWJlbFNlbGVjdG9ycyA9IFtdO1xuICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLm5ldHdvcmtzID0gW107XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvU2VydmljZWxicygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuc2VydmljZWxicy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub1NlcnZpY2VsYnMoKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IG5ldHdvcmtzIGZvciB0aGUgZ2l2ZW4gdGVuYW50LlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gZ2V0TmV0d29ya3MoKSB7XG4gICAgICAgICAgICBOZXR3b3Jrc01vZGVsLmdldCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHNlcnZpY2VsYkNyZWF0ZUN0cmwubmV0d29ya3MgPSBfLmZpbHRlcihyZXN1bHQsIHtcbiAgICAgICAgICAgICAgICAgICAgJ3RlbmFudE5hbWUnOiAnZGVmYXVsdCcgLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUxhYmVsU2VsZWN0b3JTdHJpbmdzKCkge1xuICAgICAgICAgICAgLy9FbXB0eSBvdXQgdGhlIHNlbGVjdG9ycy4gSW4gY2FzZSBvZiBzZXJ2ZXIgZXJyb3JzIHRoaXMgbmVlZHMgdG8gYmUgcmVzZXQuXG4gICAgICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLnNlcnZpY2VsYi5zZWxlY3RvcnMgPSBbXTtcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChzZXJ2aWNlbGJDcmVhdGVDdHJsLmxhYmVsU2VsZWN0b3JzLCBmdW5jdGlvbiAobGFiZWxTZWxlY3Rvcikge1xuICAgICAgICAgICAgICAgIHZhciBzZWxlY3RvclN0cmluZyA9IGxhYmVsU2VsZWN0b3IubmFtZSArICc9JyArIGxhYmVsU2VsZWN0b3IudmFsdWU7XG4gICAgICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIuc2VsZWN0b3JzLnB1c2goc2VsZWN0b3JTdHJpbmcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlU2VydmljZWxiKCkge1xuICAgICAgICAgICAgY3JlYXRlTGFiZWxTZWxlY3RvclN0cmluZ3MoKTtcbiAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgaWYgKHNlcnZpY2VsYkNyZWF0ZUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc2VydmljZWxiQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoc2VydmljZWxiQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIua2V5ID1cbiAgICAgICAgICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIudGVuYW50TmFtZSArICc6JyArIHNlcnZpY2VsYkNyZWF0ZUN0cmwuc2VydmljZWxiLnNlcnZpY2VOYW1lO1xuICAgICAgICAgICAgICAgIFNlcnZpY2VsYnNNb2RlbC5jcmVhdGUoc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1NlcnZpY2VsYnMoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Ioc2VydmljZWxiQ3JlYXRlQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXNldEZvcm0oKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHNlcnZpY2VsYkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIgPSB7XG4gICAgICAgICAgICAgICAgc2VydmljZU5hbWU6ICcnLFxuICAgICAgICAgICAgICAgIG5ldHdvcmtOYW1lOiAnJyxcbiAgICAgICAgICAgICAgICBpcEFkZHJlc3M6ICcnLFxuICAgICAgICAgICAgICAgIHNlbGVjdG9yczogW10sXG4gICAgICAgICAgICAgICAgcG9ydHM6IFtdLFxuICAgICAgICAgICAgICAgIHRlbmFudE5hbWU6ICdkZWZhdWx0JyAvL1RPRE86IFJlbW92ZSBoYXJkY29kZWQgdGVuYW50LlxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLmNyZWF0ZVNlcnZpY2VsYiA9IGNyZWF0ZVNlcnZpY2VsYjtcbiAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5jYW5jZWxDcmVhdGluZyA9IGNhbmNlbENyZWF0aW5nO1xuICAgICAgICBnZXROZXR3b3JrcygpO1xuICAgICAgICByZXNldEZvcm0oKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zZXJ2aWNlbGJjcmVhdGVjdHJsLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xMS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zZXJ2aWNlbGJzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2VydmljZWxicy5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBwYXJhbXM6IHsgc3RhdGU6IG51bGwgfSxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTZXJ2aWNlbGJEZXRhaWxzQ3RybCBhcyBzZXJ2aWNlbGJEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NlcnZpY2VfbGJzL3NlcnZpY2VsYmRldGFpbHMuaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2VydmljZWxicy5kZXRhaWxzLmluZm8nLCB7XG4gICAgICAgICAgICB1cmw6ICcvaW5mbycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU2VydmljZWxiRGV0YWlsc0N0cmwgYXMgc2VydmljZWxiRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXJ2aWNlX2xicy9zZXJ2aWNlbGJpbmZvLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMuZGV0YWlscy5lZGl0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2VkaXQvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU2VydmljZWxiRGV0YWlsc0N0cmwgYXMgc2VydmljZWxiRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXJ2aWNlX2xicy9zZXJ2aWNlbGJpbmZvLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdTZXJ2aWNlbGJEZXRhaWxzQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdTZXJ2aWNlbGJzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgU2VydmljZWxic01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgc2VydmljZWxiRGV0YWlsc0N0cmwgPSB0aGlzO1xuICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5sYWJlbFNlbGVjdG9ycyA9IFtdO1xuICAgICAgICAvKipcbiAgICAgICAgICogVG8gc2hvdyBlZGl0IG9yIGRldGFpbHMgc2NyZWVuIGJhc2VkIG9uIHRoZSByb3V0ZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gc2V0TW9kZSgpIHtcbiAgICAgICAgICAgIGlmICgkc3RhdGUuaXMoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMuZGV0YWlscy5lZGl0JykpIHtcbiAgICAgICAgICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5tb2RlID0gJ2VkaXQnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwubW9kZSA9ICdkZXRhaWxzJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1NlcnZpY2VsYnMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMubGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvU2VydmljZWxiRGV0YWlscygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuc2VydmljZWxicy5kZXRhaWxzLmluZm8nLCB7ICdrZXknOiBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIua2V5LCAnc3RhdGUnOiAnZGV0YWlscycgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsRWRpdGluZygpIHtcbiAgICAgICAgICAgIHJldHVyblRvU2VydmljZWxiRGV0YWlscygpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGRlbGV0ZVNlcnZpY2VsYigpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBTZXJ2aWNlbGJzTW9kZWwuZGVsZXRlKHNlcnZpY2VsYkRldGFpbHNDdHJsLnNlcnZpY2VsYikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9TZXJ2aWNlbGJzKCk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHNhdmVTZXJ2aWNlbGIoKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgdmFyIGV4aXN0aW5nTGFiZWxzID0gc2VydmljZWxiRGV0YWlsc0N0cmwuc2VydmljZWxiLnNlbGVjdG9ycztcbiAgICAgICAgICAgIGNyZWF0ZUxhYmVsU2VsZWN0b3JTdHJpbmdzKCk7XG4gICAgICAgICAgICBTZXJ2aWNlbGJzTW9kZWwuc2F2ZShzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIHJldHVyblRvU2VydmljZWxiRGV0YWlscygpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIuc2VsZWN0b3JzID0gZXhpc3RpbmdMYWJlbHM7XG4gICAgICAgICAgICAgICAgY3JlYXRlTGFiZWxTZWxlY3RvcnMoKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Ioc2VydmljZWxiRGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVMYWJlbFNlbGVjdG9ycygpIHtcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIuc2VsZWN0b3JzLCBmdW5jdGlvbiAoc2VsZWN0b3JTdHIpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2VsZWN0b3IgPSB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHNlbGVjdG9yU3RyLnNwbGl0KCc9JylbMF0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBzZWxlY3RvclN0ci5zcGxpdCgnPScpWzFdXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5sYWJlbFNlbGVjdG9ycy5wdXNoKHNlbGVjdG9yKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUxhYmVsU2VsZWN0b3JTdHJpbmdzKCkge1xuICAgICAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwuc2VydmljZWxiLnNlbGVjdG9ycyA9IFtdO1xuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHNlcnZpY2VsYkRldGFpbHNDdHJsLmxhYmVsU2VsZWN0b3JzLCBmdW5jdGlvbiAobGFiZWxTZWxlY3Rvcikge1xuICAgICAgICAgICAgICAgIHZhciBzZWxlY3RvclN0cmluZyA9IGxhYmVsU2VsZWN0b3IubmFtZSArICc9JyArIGxhYmVsU2VsZWN0b3IudmFsdWU7XG4gICAgICAgICAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwuc2VydmljZWxiLnNlbGVjdG9ycy5wdXNoKHNlbGVjdG9yU3RyaW5nKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICBTZXJ2aWNlbGJzTW9kZWwuZ2V0TW9kZWxCeUtleSgkc3RhdGVQYXJhbXMua2V5KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHNlcnZpY2VsYikge1xuICAgICAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwuc2VydmljZWxiID0gc2VydmljZWxiO1xuICAgICAgICAgICAgY3JlYXRlTGFiZWxTZWxlY3RvcnMoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHNlcnZpY2VsYkRldGFpbHNDdHJsLnNhdmVTZXJ2aWNlbGIgPSBzYXZlU2VydmljZWxiO1xuICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5jYW5jZWxFZGl0aW5nID0gY2FuY2VsRWRpdGluZztcbiAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwuZGVsZXRlU2VydmljZWxiID0gZGVsZXRlU2VydmljZWxiO1xuICAgICAgICBzZXRNb2RlKCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c2VydmljZWxiZGV0YWlsc2N0cmwuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzExLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnNlcnZpY2VsYnMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU2VydmljZWxiTGlzdEN0cmwgYXMgc2VydmljZWxiTGlzdEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXJ2aWNlX2xicy9zZXJ2aWNlbGJsaXN0Lmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdTZXJ2aWNlbGJMaXN0Q3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ1NlcnZpY2VsYnNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBTZXJ2aWNlbGJzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlbGJMaXN0Q3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGdldFNlcnZpY2VsYnMocmVsb2FkKSB7XG4gICAgICAgICAgICBTZXJ2aWNlbGJzTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzZXJ2aWNlbGJMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgc2VydmljZWxiTGlzdEN0cmwuc2VydmljZWxicyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzZXJ2aWNlbGJMaXN0Q3RybCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgZ2V0U2VydmljZWxicyhmYWxzZSk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG9yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldFNlcnZpY2VsYnModHJ1ZSk7XG4gICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zZXJ2aWNlbGJsaXN0Y3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTMvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LnNlcnZpY2VsYnNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2U2VydmljZWxicG9ydHNcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBpdGVtczogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSkge1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDb21wYXJlIGlmIHR3byBpdGVtcyBoYXZlIHNhbWUgcG9ydHMgYW5kIHByb3RvY29sc1xuICAgICAgICAgICAgICogQHBhcmFtIHZhbDFcbiAgICAgICAgICAgICAqIEBwYXJhbSB2YWwyXG4gICAgICAgICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gY29tcGFyZSh2YWwxLCB2YWwyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICh2YWwxID09PSB2YWwyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlc2V0TmV3SXRlbSgpIHtcbiAgICAgICAgICAgICAgICBzY29wZS5uZXdJdGVtID0ge1xuICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlUG9ydDogJycsXG4gICAgICAgICAgICAgICAgICAgIHByb3ZpZGVyUG9ydDogJycsXG4gICAgICAgICAgICAgICAgICAgIHByb3RvY29sOiAnJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmdW5jdGlvbiBpc0VtcHR5SXRlbShpdGVtKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChpdGVtLnNlcnZpY2VQb3J0ID09PSAnJyAmJiBpdGVtLnByb3ZpZGVyUG9ydCA9PT0gJycgJiYgaXRlbS5wcm90b2NvbCA9PT0gJycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2NvcGUuYWRkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChpc0VtcHR5SXRlbShzY29wZS5uZXdJdGVtKSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGlmIChzY29wZS5pdGVtcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLml0ZW1zID0gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBuZXdJdGVtU3RyID0gc2NvcGUubmV3SXRlbS5zZXJ2aWNlUG9ydCArICc6J1xuICAgICAgICAgICAgICAgICAgICArIHNjb3BlLm5ld0l0ZW0ucHJvdmlkZXJQb3J0ICsgJzonXG4gICAgICAgICAgICAgICAgICAgICsgc2NvcGUubmV3SXRlbS5wcm90b2NvbDtcbiAgICAgICAgICAgICAgICAvL1JlbW92ZXMgZXhpc3RpbmcgaXRlbSB3aXRoIHRoZSBzYW1lIHZhbHVlIGZpcnN0IGlmIGl0IGV4aXN0cy5cbiAgICAgICAgICAgICAgICBfLnB1bGxBbGxXaXRoKHNjb3BlLml0ZW1zLCBbbmV3SXRlbVN0cl0sIGNvbXBhcmUpO1xuICAgICAgICAgICAgICAgIHNjb3BlLml0ZW1zLnB1c2gobmV3SXRlbVN0cik7XG4gICAgICAgICAgICAgICAgcmVzZXROZXdJdGVtKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgc2NvcGUucmVtb3ZlID0gZnVuY3Rpb24gKHBhc3NlZEl0ZW0pIHtcbiAgICAgICAgICAgICAgICBfLnJlbW92ZShzY29wZS5pdGVtcywgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBhcmUoaXRlbSwgcGFzc2VkSXRlbSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmVzZXROZXdJdGVtKCk7XG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnc2VydmljZV9sYnMvc2VydmljZWxicG9ydHMuaHRtbCdcbiAgICB9O1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zZXJ2aWNlbGJwb3J0c2RpcmVjdGl2ZS5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgY3NoYW1wdXIgb24gNy8xNy8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zZXJ2aWNlbGJzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2VydmljZWxicy5kZXRhaWxzLnN0YXRzJywge1xuICAgICAgICAgICAgdXJsOiAnL3N0YXRzJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTZXJ2aWNlbGJTdGF0c0N0cmwgYXMgc2VydmljZWxiU3RhdHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2VydmljZV9sYnMvc2VydmljZWxic3RhdHMuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1NlcnZpY2VsYlN0YXRzQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnU2VydmljZWxic01vZGVsJywgJ0luc3BlY3RTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBTZXJ2aWNlbGJzTW9kZWwsIEluc3BlY3RTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlbGJTdGF0c0N0cmwgPSB0aGlzO1xuICAgICAgICAvKiBHZXRzIHRoZSBOZXR3b3JrIE9wZXJhdGlvbmFsIHN0YXRlIGZyb20gdGhlIHNlcnZlciAqL1xuICAgICAgICBmdW5jdGlvbiBnZXRTZXJ2aWNlbGJJbnNwZWN0KHJlZnJlc2gpIHtcbiAgICAgICAgICAgIFNlcnZpY2VsYnNNb2RlbC5nZXRJbnNwZWN0QnlLZXkoJHN0YXRlUGFyYW1zLmtleSwgQ29udGl2R2xvYmFscy5TRVJWSUNFTEJTX0lOU1BFQ1RfRU5EUE9JTlQsIHJlZnJlc2gpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHNlcnZpY2VsYlN0YXRzQ3RybC5zZXJ2aWNlbGJJbnNwZWN0U3RhdHMgPSByZXN1bHQuT3BlcjtcbiAgICAgICAgICAgICAgICBzZXJ2aWNlbGJTdGF0c0N0cmwuY29uZmlnID0gcmVzdWx0LkNvbmZpZztcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0Lk9wZXIucHJvdmlkZXJzICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJvdmlkZXJEZXRhaWxzID0gSW5zcGVjdFNlcnZpY2UuYnVpbGRFbmRQb2ludHMocmVzdWx0Lk9wZXIucHJvdmlkZXJzKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKEluc3BlY3RTZXJ2aWNlLmNoZWNrQ29udGFpbmVyQ2hhbmdlZChzZXJ2aWNlbGJTdGF0c0N0cmwucHJvdmlkZXJEZXRhaWxzLCBwcm92aWRlckRldGFpbHMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlbGJTdGF0c0N0cmwucHJvdmlkZXJzID0gcmVzdWx0Lk9wZXIucHJvdmlkZXJzO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZWxiU3RhdHNDdHJsLnByb3ZpZGVyRGV0YWlscyA9IHByb3ZpZGVyRGV0YWlscztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc2VydmljZWxiU3RhdHNDdHJsLnByb3ZpZGVycyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlbGJTdGF0c0N0cmwucHJvdmlkZXJEZXRhaWxzID0ge307XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZ2V0U2VydmljZWxiSW5zcGVjdChmYWxzZSk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG9yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldFNlcnZpY2VsYkluc3BlY3QodHJ1ZSk7XG4gICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zZXJ2aWNlbGJzdGF0c2N0cmwuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zZXR0aW5ncycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMuY2x1c3RlcicsIHtcbiAgICAgICAgICAgIHVybDogJy9jbHVzdGVyJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdDbHVzdGVyU2V0dGluZ0N0cmwgYXMgY2x1c3RlclNldHRpbmdDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2V0dGluZ3MvY2x1c3RlcnNldHRpbmdzLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdDbHVzdGVyU2V0dGluZ0N0cmwnLCBbJyRzdGF0ZVBhcmFtcycsICdDUlVESGVscGVyU2VydmljZScsICdOb2Rlc1NlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGVQYXJhbXMsIENSVURIZWxwZXJTZXJ2aWNlLCBOb2Rlc1NlcnZpY2UpIHtcbiAgICAgICAgdmFyIGNsdXN0ZXJTZXR0aW5nQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUNsdXN0ZXJTZXR0aW5ncygpIHtcbiAgICAgICAgICAgIGlmIChjbHVzdGVyU2V0dGluZ0N0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoY2x1c3RlclNldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgIGNsdXN0ZXJTZXR0aW5nQ3RybC5ub2RlT3BzT2JqLm5vZGVzID0gWyRzdGF0ZVBhcmFtcy5rZXldO1xuICAgICAgICAgICAgICAgIE5vZGVzU2VydmljZS5jbGVhbnVwRXh0cmFWYXJzKGNsdXN0ZXJTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgTm9kZXNTZXJ2aWNlLmNyZWF0ZUV4dHJhVmFycyhjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgIE5vZGVzU2VydmljZS51cGRhdGVTZXR0aW5ncyhjbHVzdGVyU2V0dGluZ0N0cmwubm9kZU9wc09iaikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoY2x1c3RlclNldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGNsdXN0ZXJTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihjbHVzdGVyU2V0dGluZ0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2x1c3RlclNldHRpbmdDdHJsLm5vZGVPcHNPYmogPSB7fTtcbiAgICAgICAgY2x1c3RlclNldHRpbmdDdHJsLmV4dHJhX3ZhcnMgPSB7fTsgLy9UT0RPIEludGlhbGl6ZSBmcm9tIGdsb2JhbCBzZXR0aW5nc1xuICAgICAgICBjbHVzdGVyU2V0dGluZ0N0cmwuYW5zaWJsZVZhcmlhYmxlcyA9IFtdO1xuICAgICAgICBjbHVzdGVyU2V0dGluZ0N0cmwuZW52VmFyaWFibGVzID0gW107XG4gICAgICAgIE5vZGVzU2VydmljZS5nZXRTZXR0aW5ncyhjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgICAgICBjbHVzdGVyU2V0dGluZ0N0cmwudXBkYXRlQ2x1c3RlclNldHRpbmdzID0gdXBkYXRlQ2x1c3RlclNldHRpbmdzO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGNsdXN0ZXJTZXR0aW5nQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNsdXN0ZXJzZXR0aW5nY3RybC5qcy5tYXAiLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2LnNldHRpbmdzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5uZXR3b3JrcycsIHtcbiAgICAgICAgICAgIHVybDogJy9uZXR3b3JrcycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTmV0d29ya1NldHRpbmdDdHJsIGFzIG5ldHdvcmtTZXR0aW5nQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NldHRpbmdzL25ldHdvcmtzZXR0aW5ncy5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTmV0d29ya1NldHRpbmdDdHJsJywgWydDUlVESGVscGVyU2VydmljZScsICdOZXR3b3JrU2VydmljZScsXG4gICAgZnVuY3Rpb24gKENSVURIZWxwZXJTZXJ2aWNlLCBOZXR3b3JrU2VydmljZSkge1xuICAgICAgICB2YXIgbmV0d29ya1NldHRpbmdDdHJsID0gdGhpcztcbiAgICAgICAgbmV0d29ya1NldHRpbmdDdHJsLnZsYW5QYXR0ZXJuID0gQ29udGl2R2xvYmFscy5WTEFOX1JFR0VYO1xuICAgICAgICBuZXR3b3JrU2V0dGluZ0N0cmwudnhsYW5QYXR0ZXJuID0gQ29udGl2R2xvYmFscy5WWExBTl9SRUdFWDtcbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlTmV0d29ya1NldHRpbmdzKCkge1xuICAgICAgICAgICAgaWYgKG5ldHdvcmtTZXR0aW5nQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihuZXR3b3JrU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKG5ldHdvcmtTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgTmV0d29ya1NlcnZpY2UudXBkYXRlU2V0dGluZ3MobmV0d29ya1NldHRpbmdDdHJsLnNldHRpbmcpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3JrU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IobmV0d29ya1NldHRpbmdDdHJsLCByZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0TmV0d29ya1NldHRpbmdzKCkge1xuICAgICAgICAgICAgTmV0d29ya1NlcnZpY2UuZ2V0U2V0dGluZ3MoKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBuZXR3b3JrU2V0dGluZ0N0cmwuc2V0dGluZyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBnZXROZXR3b3JrU2V0dGluZ3MoKTtcbiAgICAgICAgbmV0d29ya1NldHRpbmdDdHJsLnVwZGF0ZU5ldHdvcmtTZXR0aW5ncyA9IHVwZGF0ZU5ldHdvcmtTZXR0aW5ncztcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3JrU2V0dGluZ0N0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IobmV0d29ya1NldHRpbmdDdHJsKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1uZXR3b3Jrc2V0dGluZ2N0cmwuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zZXR0aW5ncycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMudm9sdW1lcycsIHtcbiAgICAgICAgICAgIHVybDogJy92b2x1bWVzJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWb2x1bWVTZXR0aW5nQ3RybCBhcyB2b2x1bWVTZXR0aW5nQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NldHRpbmdzL3ZvbHVtZXNldHRpbmdzLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdWb2x1bWVTZXR0aW5nQ3RybCcsIFsnQ1JVREhlbHBlclNlcnZpY2UnLCAnVm9sdW1lU2V0dGluZ1NlcnZpY2UnLFxuICAgIGZ1bmN0aW9uIChDUlVESGVscGVyU2VydmljZSwgVm9sdW1lU2V0dGluZ1NlcnZpY2UpIHtcbiAgICAgICAgdmFyIHZvbHVtZVNldHRpbmdDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlVm9sdW1lU2V0dGluZ3MoKSB7XG4gICAgICAgICAgICBpZiAodm9sdW1lU2V0dGluZ0N0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iodm9sdW1lU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKHZvbHVtZVNldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICBWb2x1bWVTZXR0aW5nU2VydmljZS51cGRhdGVTZXR0aW5ncyh2b2x1bWVTZXR0aW5nQ3RybC5zZXR0aW5nKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcih2b2x1bWVTZXR0aW5nQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnZXRWb2x1bWVTZXR0aW5ncygpIHtcbiAgICAgICAgICAgIFZvbHVtZVNldHRpbmdTZXJ2aWNlLmdldFNldHRpbmdzKCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgdm9sdW1lU2V0dGluZ0N0cmwuc2V0dGluZyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBnZXRWb2x1bWVTZXR0aW5ncygpO1xuICAgICAgICB2b2x1bWVTZXR0aW5nQ3RybC51cGRhdGVWb2x1bWVTZXR0aW5ncyA9IHVwZGF0ZVZvbHVtZVNldHRpbmdzO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZVNldHRpbmdDdHJsKTtcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHZvbHVtZVNldHRpbmdDdHJsKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD12b2x1bWVzZXR0aW5nY3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDYvMS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zdG9yYWdlcG9saWNpZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMuY3JlYXRlJywge1xuICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvc3RvcmFnZXBvbGljeWNyZWF0ZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCBhcyBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1N0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ1N0b3JhZ2VQb2xpY2llc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIFN0b3JhZ2VQb2xpY2llc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1N0b3JhZ2VQb2xpY2llcygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxDcmVhdGluZygpIHtcbiAgICAgICAgICAgIHJldHVyblRvU3RvcmFnZVBvbGljaWVzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlRmlsZXN5c3RlbUNtZHMoKSB7XG4gICAgICAgICAgICBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5maWxlc3lzdGVtY21kcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwubmV3U3RvcmFnZVBvbGljeS5maWxlc3lzdGVtc1tpdGVtLm5hbWVdID0gaXRlbS52YWx1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZVBvbGljeSgpIHtcbiAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgaWYgKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgY3JlYXRlRmlsZXN5c3RlbUNtZHMoKTtcbiAgICAgICAgICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbC5jcmVhdGUoc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwubmV3U3RvcmFnZVBvbGljeSlcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9TdG9yYWdlUG9saWNpZXMoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJlc2V0Rm9ybSgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLm5ld1N0b3JhZ2VQb2xpY3kgPSB7XG4gICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgXCJiYWNrZW5kc1wiOiB7XG4gICAgICAgICAgICAgICAgICAgIFwiY3J1ZFwiOiBcImNlcGhcIixcbiAgICAgICAgICAgICAgICAgICAgXCJtb3VudFwiOiBcImNlcGhcIixcbiAgICAgICAgICAgICAgICAgICAgXCJzbmFwc2hvdFwiOiBcImNlcGhcIlxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXCJ1bmxvY2tlZFwiOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBcImRyaXZlclwiOiB7XG4gICAgICAgICAgICAgICAgICAgIFwicG9vbFwiOiBcInJiZFwiXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBcImNyZWF0ZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgIFwic2l6ZVwiOiBcIjBcIixcbiAgICAgICAgICAgICAgICAgICAgXCJmaWxlc3lzdGVtXCI6IFwiXCJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFwicnVudGltZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgIFwic25hcHNob3RzXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIFwic25hcHNob3RcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJmcmVxdWVuY3lcIjogXCIzMG1cIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwia2VlcFwiOiAyMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBcInJhdGUtbGltaXRcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJ3cml0ZS1pb3BzXCI6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJlYWQtaW9wc1wiOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ3cml0ZS1icHNcIjogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVhZC1icHNcIjogMFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBcImZpbGVzeXN0ZW1zXCI6IHt9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLmNyZWF0ZVBvbGljeSA9IGNyZWF0ZVBvbGljeTtcbiAgICAgICAgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwuY2FuY2VsQ3JlYXRpbmcgPSBjYW5jZWxDcmVhdGluZztcbiAgICAgICAgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwuZmlsZXN5c3RlbWNtZHMgPSBbXTtcbiAgICAgICAgcmVzZXRGb3JtKCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3RvcmFnZXBvbGljeWNyZWF0ZWN0cmwuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzI3LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnN0b3JhZ2Vwb2xpY2llcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU3RvcmFnZVBvbGljeURldGFpbHNDdHJsIGFzIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvc3RvcmFnZXBvbGljeWRldGFpbHMuaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmVkaXQnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwgYXMgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9zdG9yYWdlcG9saWN5ZGV0YWlscy5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignU3RvcmFnZVBvbGljeURldGFpbHNDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdTdG9yYWdlUG9saWNpZXNNb2RlbCcsICdWb2x1bWVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIFN0b3JhZ2VQb2xpY2llc01vZGVsLCBWb2x1bWVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwgPSB0aGlzO1xuICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwuZmlsZXN5c3RlbWNtZHMgPSBbXTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRvIHNob3cgZWRpdCBvciBkZXRhaWxzIHNjcmVlbiBiYXNlZCBvbiB0aGUgcm91dGVcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHNldE1vZGUoKSB7XG4gICAgICAgICAgICBpZiAoJHN0YXRlLmlzKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMuZWRpdCcpKSB7XG4gICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLm1vZGUgPSAnZWRpdCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwubW9kZSA9ICdkZXRhaWxzJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1BvbGljaWVzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMubGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvUG9saWN5RGV0YWlscygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmRldGFpbHMnLCB7ICdrZXknOiBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5Lm5hbWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsRWRpdGluZygpIHtcbiAgICAgICAgICAgIHJldHVyblRvUG9saWN5RGV0YWlscygpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGRlbGV0ZVBvbGljeSgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIFN0b3JhZ2VQb2xpY2llc01vZGVsLmRlbGV0ZVVzaW5nS2V5KHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kubmFtZSwgJ25hbWUnKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9Qb2xpY2llcygpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZXQgdm9sdW1lcyBiZWxvbmdpbmcgdG8gYSBwb2xpY3lcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGdldFZvbHVtZXMocmVsb2FkKSB7XG4gICAgICAgICAgICBWb2x1bWVzTW9kZWwuZ2V0KHJlbG9hZCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnZvbHVtZXMgPSAkZmlsdGVyKCdvcmRlckJ5JykoXy5maWx0ZXIocmVzdWx0LCB7XG4gICAgICAgICAgICAgICAgICAgICdwb2xpY3knOiBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5Lm5hbWVcbiAgICAgICAgICAgICAgICB9KSwgJ25hbWUnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGluaXRpYWxpemVGaWxlc3lzdGVtQ21kc0FycmF5KCkge1xuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kuZmlsZXN5c3RlbXMsIGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wdXNoKHsgbmFtZToga2V5LCB2YWx1ZTogdmFsdWUgfSk7XG4gICAgICAgICAgICB9LCBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwuZmlsZXN5c3RlbWNtZHMpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUZpbGVzeXN0ZW1DbWRzKCkge1xuICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmZpbGVzeXN0ZW1jbWRzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5LmZpbGVzeXN0ZW1zW2l0ZW0ubmFtZV0gPSBpdGVtLnZhbHVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gc2F2ZVBvbGljeSgpIHtcbiAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgaWYgKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgY3JlYXRlRmlsZXN5c3RlbUNtZHMoKTtcbiAgICAgICAgICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbC5zYXZlKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvUG9saWN5RGV0YWlscygpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbC5nZXRNb2RlbEJ5S2V5KCRzdGF0ZVBhcmFtcy5rZXksIGZhbHNlLCAnbmFtZScpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5ID0gcG9saWN5O1xuICAgICAgICAgICAgaW5pdGlhbGl6ZUZpbGVzeXN0ZW1DbWRzQXJyYXkoKTtcbiAgICAgICAgICAgIGdldFZvbHVtZXMoZmFsc2UpO1xuICAgICAgICB9KTtcbiAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmRlbGV0ZVBvbGljeSA9IGRlbGV0ZVBvbGljeTtcbiAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnNhdmVQb2xpY3kgPSBzYXZlUG9saWN5O1xuICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwuY2FuY2VsRWRpdGluZyA9IGNhbmNlbEVkaXRpbmc7XG4gICAgICAgIHNldE1vZGUoKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0b3JlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0Vm9sdW1lcyh0cnVlKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXN0b3JhZ2Vwb2xpY3lkZXRhaWxzY3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDYvMi8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoXCJjb250aXYuc3RvcmFnZXBvbGljaWVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dlN0b3JhZ2Vwb2xpY3liYXNpY3NldHRpbmdzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge307XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZTdG9yYWdlcG9saWN5ZmlsZXN5c3RlbXNldHRpbmdzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgcG9saWN5OiAnPScsXG4gICAgICAgICAgICBmaWxlc3lzdGVtY21kczogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSkge1xuICAgICAgICAgICAgc2NvcGUuZmlsZXN5c3RlbXMgPSBbJ2V4dDQnLCAnYnRyZnMnXTtcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL2ZpbGVzeXN0ZW1zZXR0aW5ncy5odG1sJ1xuICAgIH07XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZTdG9yYWdlcG9saWN5c25hcHNob3RzZXR0aW5nc1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIHBvbGljeTogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9zbmFwc2hvdHNldHRpbmdzLmh0bWwnXG4gICAgfTtcbn0pXG4gICAgLmRpcmVjdGl2ZShcImN0dlN0b3JhZ2Vwb2xpY3lyd29wc3NldHRpbmdzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgcG9saWN5OiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL3J3b3Bzc2V0dGluZ3MuaHRtbCdcbiAgICB9O1xufSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2U3RvcmFnZXBvbGljeWJhY2tlbmRkcml2ZXJzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgcG9saWN5OiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL2JhY2tlbmRkcml2ZXJzLmh0bWwnXG4gICAgfTtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3RvcmFnZXBvbGljeWRpcmVjdGl2ZS5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDQvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc3RvcmFnZXBvbGljaWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU3RvcmFnZVBvbGljeUxpc3RDdHJsIGFzIHN0b3JhZ2VQb2xpY3lMaXN0Q3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvc3RvcmFnZXBvbGljeWxpc3QuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1N0b3JhZ2VQb2xpY3lMaXN0Q3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ1N0b3JhZ2VQb2xpY2llc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIFN0b3JhZ2VQb2xpY2llc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgc3RvcmFnZVBvbGljeUxpc3RDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gZ2V0UG9saWNpZXMocmVsb2FkKSB7XG4gICAgICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbC5nZXQocmVsb2FkKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeUxpc3RDdHJsLnBvbGljaWVzID0gcmVzdWx0O1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lMaXN0Q3RybCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgZ2V0UG9saWNpZXMoZmFsc2UpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0UG9saWNpZXModHJ1ZSk7XG4gICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdG9yYWdlcG9saWN5bGlzdGN0cmwuanMubWFwIiwiXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZpc3VhbGl6YXRpb24uZWRnZScsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvZWRnZS97c291cmNlTmFtZSwgdGFyZ2V0TmFtZSwgc291cmNlTGlzdCwgdGFyZ2V0TGlzdH0nLFxuICAgICAgICAgICAgICAgIHBhcmFtczoge1xuICAgICAgICAgICAgICAgICAgICBzb3VyY2VOYW1lOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICB0YXJnZXROYW1lOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICBzb3VyY2VMaXN0OiBudWxsLFxuICAgICAgICAgICAgICAgICAgICB0YXJnZXRMaXN0OiBudWxsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnVmlzdWFsaXphdGlvbkVkZ2VDdHJsIGFzIHZpc3VhbGl6YXRpb25lZGdlQ3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb25lZGdlLmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICA7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1Zpc3VhbGl6YXRpb25FZGdlQ3RybCcsIFtcIiRzY29wZVwiLCBcIiRodHRwXCIsICckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ1Zpc3VhbGl6YXRpb25TZXJ2aWNlJywgJyRpbnRlcnZhbCcsXG4gICAgICAgIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBWaXN1YWxpemF0aW9uU2VydmljZSwgJGludGVydmFsKSB7XG4gICAgICAgICAgICB2YXIgc291cmNlTmFtZSA9ICRzdGF0ZVBhcmFtcy5zb3VyY2VOYW1lO1xuICAgICAgICAgICAgdmFyIHRhcmdldE5hbWUgPSAkc3RhdGVQYXJhbXMudGFyZ2V0TmFtZTtcbiAgICAgICAgICAgIHZhciBzb3VyY2VMaXN0ID0gJHN0YXRlUGFyYW1zLnNvdXJjZUxpc3Q7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0TGlzdCA9ICRzdGF0ZVBhcmFtcy50YXJnZXRMaXN0O1xuXG4gICAgICAgICAgICAvL0lmIHRoZSBwYWdlIGlzIHJlbG9hZGVkLCB0aGVzZSBzdGF0ZSBwYXJhbXMgYXJlIGFsbCBudWxsLFxuICAgICAgICAgICAgLy9zbyBpdCB3aWxsIHJvdXRlIHRoZW0gYmFjayB0byB0aGUgdmlzdWFsaXphdGlvbiB0YWIgdG9wIHZpZXdcbiAgICAgICAgICAgIGlmIChzb3VyY2VMaXN0ID09IG51bGwgfHwgdGFyZ2V0TGlzdCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS52aXN1YWxpemF0aW9uLmxpc3QnKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBkID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgIHZhciB0ID0gZC5nZXRTZWNvbmRzKCk7XG4gICAgICAgICAgICAkc2NvcGUuZWRnZURhdGFJbnRlcnZhbCA9IFxuICAgICAgICAgICAgICAgICRpbnRlcnZhbChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgVmlzdWFsaXphdGlvblNlcnZpY2UuZ2V0RWRnZURhdGEoc291cmNlTGlzdCwgdGFyZ2V0TGlzdCwgdC50b1N0cmluZygpKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHRzID0gcmVzdWx0LnJlc3VsdHM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChyZXN1bHRzLCBmdW5jdGlvbihyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfLmlzRW1wdHkocikgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhICs9IHIuc2VyaWVzWzBdLnZhbHVlc1swXVsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zb3VyY2VOYW1lID0gc291cmNlTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUudGFyZ2V0TmFtZSA9IHRhcmdldE5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVkZ2VEYXRhID0gZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZWRnZURhdGFUaW1lID0gdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSwgMzAwMCk7XG5cbiAgICAgICAgICAgIC8vRGVzdHJveWluZyB0aGUgaW50ZXJ2YWwgZnVuY3Rpb24gb24gcm91dGUgY2hhbmdlXG4gICAgICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHsgJGludGVydmFsLmNhbmNlbCgkc2NvcGUuZWRnZURhdGFJbnRlcnZhbCk7IH0pO1xuXG5cbiAgICAgICAgICAgIFZpc3VhbGl6YXRpb25TZXJ2aWNlLmdldE9sZEVkZ2VEYXRhKHNvdXJjZUxpc3QsIHRhcmdldExpc3QpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0cyA9IHJlc3VsdC5yZXN1bHRzO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZWRnZURhdGEgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgLy9yZXN1bHRzLCBpZiBub3QgZW1wdHksIGFyZSBleHBlY3RlZCB0byBoYXZlXG4gICAgICAgICAgICAgICAgICAgIC8vNiBkYXRhIGVudHJpZXNcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHJlc3VsdHMsIGZ1bmN0aW9uKHIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfLmlzRW1wdHkocikgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSByLnNlcmllc1swXS52YWx1ZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF8uaXNFbXB0eShlZGdlRGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKGRhdGEsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkZ2VEYXRhLnB1c2goZFsxXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKGRhdGEsIGZ1bmN0aW9uKGQsIGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkZ2VEYXRhW2ldICs9IGRbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlTmFtZSA9IHNvdXJjZU5hbWU7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50YXJnZXROYW1lID0gdGFyZ2V0TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNvdXJjZUxpc3QgPSBzb3VyY2VMaXN0O1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudGFyZ2V0TGlzdCA9IHRhcmdldExpc3Q7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5vbGRFZGdlRGF0YSA9IGVkZ2VEYXRhO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgfV0pO1xuXG5cblxuXG4iLCJcblxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52aXN1YWxpemF0aW9uJylcbiAgICAuZGlyZWN0aXZlKFwidmlzdWFsaXphdGlvbkVkZ2VcIiwgWyckd2luZG93JyxcbiAgICAgICAgZnVuY3Rpb24oJHdpbmRvdykge1xuICAgICAgICAgICAgZnVuY3Rpb24gdmlzdWFsaXphdGlvbkVkZ2VEMyhzY29wZSwgZDMpIHtcbiAgICAgICAgICAgICAgICB2YXIgYm9keUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gYm9keUVsLmNsaWVudFdpZHRoIC0gNDAwLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSAgYm9keUVsLmNsaWVudEhlaWdodCAtIDQwMDtcblxuXG4gICAgICAgICAgICAgICAgLy90YWtlbiBmcm9tIGh0dHA6Ly9ibC5vY2tzLm9yZy9zaW1lbmJyZWtrZW4vNjYzNDA3MFxuICAgICAgICAgICAgICAgIC8vIC8qKiBNQUlOIFNWRyAqKi9cbiAgICAgICAgICAgICAgICB2YXIgbGltaXQgPSA1OSxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbiA9IDc1MCxcbiAgICAgICAgICAgICAgICBub3cgPSBuZXcgRGF0ZShEYXRlLm5vdygpIC0gZHVyYXRpb24pO1xuXG4gICAgICAgICAgICAgICAgdmFyIGdyb3VwcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJ29yYW5nZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkMy5yYW5nZShsaW1pdCkubWFwKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2NvcGUub2xkRWRnZURhdGFbTWF0aC5mbG9vcihkLzEwKV0gfHwgMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciB4ID0gZDMudGltZS5zY2FsZSgpXG4gICAgICAgICAgICAgICAgICAgIC5kb21haW4oW25vdyAtIChsaW1pdCAtIDIpLCBub3cgLSBkdXJhdGlvbl0pXG4gICAgICAgICAgICAgICAgICAgIC5yYW5nZShbMCwgd2lkdGhdKTtcblxuICAgICAgICAgICAgICAgIHZhciB5ID0gZDMuc2NhbGUubGluZWFyKClcbiAgICAgICAgICAgICAgICAgICAgLmRvbWFpbihbMCwgZDMubWF4KGdyb3Vwcy5jdXJyZW50LmRhdGEsIGZ1bmN0aW9uIChkKSB7IHJldHVybiBkICsgMTA7IH0pXSlcbiAgICAgICAgICAgICAgICAgICAgLnJhbmdlKFtoZWlnaHQsIDBdKTtcblxuICAgICAgICAgICAgICAgIHZhciBsaW5lID0gZDMuc3ZnLmxpbmUoKVxuICAgICAgICAgICAgICAgICAgICAuaW50ZXJwb2xhdGUoJ2Jhc2lzJylcbiAgICAgICAgICAgICAgICAgICAgLngoZnVuY3Rpb24oZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHgobm93IC0gKGxpbWl0IC0gMSAtIGkpICogZHVyYXRpb24pXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC55KGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB5KGQpXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIHhTdmcgPSBkMy5zZWxlY3QoJy5ncmFwaCcpLmFwcGVuZCgnc3ZnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgMjUpXG4gICAgICAgICAgICAgICAgICAgIC5zdHlsZSgnb3ZlcmZsb3cnLCAndmlzaWJsZScpXG4gICAgICAgICAgICAgICAgICAgIC5zdHlsZSgncG9zaXRpb24nLCAnZml4ZWQnKTtcblxuICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgdmFyIHlBeGlzID0geFN2Zy5hcHBlbmQoJ2cnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAneSBheGlzJylcbiAgICAgICAgICAgICAgICAgICAgLy8gLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoMCwnICsgd2lkdGggKyAnKScpXG4gICAgICAgICAgICAgICAgICAgIC5jYWxsKHkuYXhpcyA9IGQzLnN2Zy5heGlzKCkuc2NhbGUoeSkub3JpZW50KCdsZWZ0JykpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciBzdmc9IGQzLnNlbGVjdCgnLmdyYXBoJykuYXBwZW5kKCdzdmcnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnY2hhcnQnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignd2lkdGgnLCB3aWR0aCAtIDUwKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignaGVpZ2h0JywgaGVpZ2h0ICsgNTApO1xuICAgICAgICAgICAgICAgICAgICAvLyAuc3R5bGUoJ292ZXJmbG93JywgXCJ2aXNpYmxlXCIpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGF4aXMgPSBzdmcuYXBwZW5kKCdnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ3ggYXhpcycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDAsJyArIGhlaWdodCArICcpJylcbiAgICAgICAgICAgICAgICAgICAgLmNhbGwoeC5heGlzID0gZDMuc3ZnLmF4aXMoKS5zY2FsZSh4KS5vcmllbnQoJ2JvdHRvbScpKTtcblxuICAgICAgICAgICAgICAgIHZhciBwYXRocyA9IHN2Zy5hcHBlbmQoJ2cnKTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIG5hbWUgaW4gZ3JvdXBzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBncm91cCA9IGdyb3Vwc1tuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXAucGF0aCA9IHBhdGhzLmFwcGVuZCgncGF0aCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZGF0YShbZ3JvdXAuZGF0YV0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCBuYW1lICsgJyBncm91cCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ3N0cm9rZScsIGdyb3VwLmNvbG9yKVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHRpY2soKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vdyA9IG5ldyBEYXRlKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQWRkIG5ldyB2YWx1ZXNcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBncm91cHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBncm91cCA9IGdyb3Vwc1tuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLmRhdGEucHVzaChzY29wZS5lZGdlRGF0YSB8fCAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLnBhdGguYXR0cignZCcsIGxpbmUpXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBTaGlmdCBkb21haW5cbiAgICAgICAgICAgICAgICAgICAgeC5kb21haW4oW25vdyAtIChsaW1pdCAtIDIpICogZHVyYXRpb24sIG5vdyAtIGR1cmF0aW9uXSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2xpZGUgeC1heGlzIGxlZnRcbiAgICAgICAgICAgICAgICAgICAgYXhpcy50cmFuc2l0aW9uKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kdXJhdGlvbihkdXJhdGlvbilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lYXNlKCdsaW5lYXInKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhbGwoeC5heGlzKTtcblxuICAgICAgICAgICAgICAgICAgICB5QXhpcy50cmFuc2l0aW9uKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kdXJhdGlvbihkdXJhdGlvbilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lYXNlKCdsaW5lYXInKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhbGwoeS5heGlzKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBTbGlkZSBwYXRocyBsZWZ0XG4gICAgICAgICAgICAgICAgICAgIHBhdGhzLmF0dHIoJ3RyYW5zZm9ybScsIG51bGwpXG4gICAgICAgICAgICAgICAgICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZHVyYXRpb24oZHVyYXRpb24pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZWFzZSgnbGluZWFyJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKCcgKyB4KG5vdyAtIChsaW1pdCAtIDEpICogZHVyYXRpb24pICsgJyknKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVhY2goJ2VuZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpY2soKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIG9sZGVzdCBkYXRhIHBvaW50IGZyb20gZWFjaCBncm91cFxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBuYW1lIGluIGdyb3Vwcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdyb3VwID0gZ3JvdXBzW25hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXAuZGF0YS5zaGlmdCgpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGljaygpXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybntcbiAgICAgICAgICAgICAgICByZXN0cmljdDonRUEnLFxuICAgICAgICAgICAgICAgIHJlcGxhY2U6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9uZWRnZXRlbXBsYXRlLmh0bWwnLFxuICAgICAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlKXtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJHdhdGNoR3JvdXAoWydlZGdlRGF0YScsICdvbGRFZGdlRGF0YSddLFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNjb3BlLmVkZ2VEYXRhICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLm9sZEVkZ2VEYXRhICE9IG51bGwgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2NvcGUuaW5pdGlhbGl6ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuaW5pdGlhbGl6ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZDMgPSAkd2luZG93LmQzOyAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXN1YWxpemF0aW9uRWRnZUQzKHNjb3BlLCBkMyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICB9XG4gICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICBdXG4pO1xuIiwiXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nKVxuICAgIC5zZXJ2aWNlKCdTdGF0ZVNhdmUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2F2ZWRTdGF0ZXMgPSB7fTtcbiAgICB9KVxuICAgIC5kaXJlY3RpdmUoXCJ2aXN1YWxpemF0aW9uR3JhcGhcIiwgWyckd2luZG93JywgJyRzdGF0ZScsICdWaXN1YWxpemVyR3JhcGgnLCAnUG9saWN5U2VydmljZScsICdWaXN1YWxpemVyRGF0YVNvdXJjZScsICdTdGF0ZVNhdmUnLFxuICAgICAgICBmdW5jdGlvbigkd2luZG93LCAkc3RhdGUsIFZpc3VhbGl6ZXJHcmFwaCwgUG9saWN5U2VydmljZSwgVmlzdWFsaXplckRhdGFTb3VyY2UsIFN0YXRlU2F2ZSkge1xuICAgICAgICAgICAgZnVuY3Rpb24gdmlzdWFsaXphdGlvbmxpc3RkMyhzY29wZSwgZWxlbSwgVmlzdWFsaXplckdyYXBoLCBQb2xpY3lTZXJ2aWNlLCBWaXN1YWxpemVyRGF0YVNvdXJjZSwgU3RhdGVTYXZlKSB7XG4gICAgICAgICAgICAgICAgLy9kb24ndCBydW4gdW50aWwgYWxsIGluaXRpYWxpemF0aW9uIGNhbGxzIGhhdmUgcmV0dXJuZWRcbiAgICAgICAgICAgICAgICBpZiAoc2NvcGUubm9kZXMgPT09IHVuZGVmaW5lZCB8fCBzY29wZS5saW5rcyA9PT0gdW5kZWZpbmVkIHx8IHNjb3BlLmNoaWxkcmVuX3N0cnVjdCA9PT0gdW5kZWZpbmVkIHx8XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLmFuY2VzdG9yc19zdHJ1Y3QgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9jcmVhdGluZyBEYXRhU291cmNlXG4gICAgICAgICAgICAgICAgdmFyIGRhdGFTb3VyY2UgPSBuZXcgVmlzdWFsaXplckRhdGFTb3VyY2UuRGF0YVNvdXJjZShzY29wZS5ub2Rlcywgc2NvcGUubGlua3MsIHNjb3BlLmNoaWxkcmVuX3N0cnVjdCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5hbmNlc3RvcnNfc3RydWN0LCBzY29wZS5sYWJlbHMsIHNjb3BlLnNlcnZpY2VTZWxlY3RvcnMpO1xuICAgICAgICAgICAgICAgIGRhdGFTb3VyY2Uuc2V0QW5jZXN0b3JzKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMsIGxpbmtzO1xuXG4gICAgICAgICAgICAgICAgdmFyIHRvcERhdGEgPSBkYXRhU291cmNlLmdldFRvcExldmVsRmxvdygpO1xuICAgICAgICAgICAgICAgIG5vZGVzID0gZGF0YVNvdXJjZS5wcm9jZXNzTm9kZURhdGEodG9wRGF0YS5ub2RlRGF0YSk7XG4gICAgICAgICAgICAgICAgbGlua3MgPSBkYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YSh0b3BEYXRhLmxpbmtEYXRhLCBub2Rlcyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgYm9keUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gYm9keUVsLmNsaWVudFdpZHRoLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSAgYm9keUVsLmNsaWVudEhlaWdodDtcblxuICAgICAgICAgICAgICAgIC8qKiBNQUlOIFNWRyAqKi9cbiAgICAgICAgICAgICAgICB2YXIgcmF3U3ZnPWVsZW0uZmluZCgnc3ZnJyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gJChyYXdTdmcucGFyZW50KCkpLm9mZnNldCgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGRpdldpZHRoID0gJChyYXdTdmcucGFyZW50KCkpLndpZHRoKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3ZnID0gZDMuc2VsZWN0KHJhd1N2Z1swXSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCBkaXZXaWR0aClcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJoZWlnaHRcIiwgaGVpZ2h0IC0gb2Zmc2V0LnRvcCAtIDIwKTtcblxuICAgICAgICAgICAgICAgIC8vaW5zdGFsbGluZyBwb2xpY2llc1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaCA9IG5ldyBWaXN1YWxpemVyR3JhcGguR3JhcGgoc3ZnLCBub2RlcywgbGlua3MsIGRhdGFTb3VyY2UsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmNoaWxkcmVuX3N0cnVjdCwgc2NvcGUuYW5jZXN0b3JzX3N0cnVjdCk7XG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmluc3RhbGxEZWZhdWx0UGF0aFBvbGljeShuZXcgUG9saWN5U2VydmljZS5TYXZlU3RhdGVQb2xpY3koU3RhdGVTYXZlLnNhdmVkU3RhdGVzKSk7XG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmluc3RhbGxEZWZhdWx0UGF0aFBvbGljeShuZXcgUG9saWN5U2VydmljZS5QYXRoQ2hhbmdlVmlld1BvbGljeSgkc3RhdGUpKTtcbiAgICAgICAgICAgICAgICAvL1FUaXBQb2xpY3kgaXMgZm9yIGJvdGggTm9kZXMgYW5kIFBhdGhzLCBpbnN0YWxsIHNhbWUgb25lIG9uIGJvdGhcbiAgICAgICAgICAgICAgICB2YXIgcVRpcFBvbGljeSA9IG5ldyBQb2xpY3lTZXJ2aWNlLlFUaXBQb2xpY3koKTtcbiAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGguaW5zdGFsbERlZmF1bHROb2RlUG9saWN5KHFUaXBQb2xpY3kpO1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5pbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3kocVRpcFBvbGljeSk7XG4gICAgICAgICAgICAgICAgdmFyIHNwbGl0Sm9pblZpZXdQb2xpY3kgPSBuZXcgUG9saWN5U2VydmljZS5TcGxpdEpvaW5WaWV3UG9saWN5KCk7XG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmluc3RhbGxEZWZhdWx0Tm9kZVBvbGljeShzcGxpdEpvaW5WaWV3UG9saWN5KTtcbiAgICAgICAgICAgICAgICBzcGxpdEpvaW5WaWV3UG9saWN5Lmluc3RhbGxCYWNrQnV0dG9uKCQoJyNiYWNrQnV0dG9uJykpO1xuICAgICAgICAgICAgICAgIHNwbGl0Sm9pblZpZXdQb2xpY3kuaW5zdGFsbFRpdGxlKCQoJyNncmFwaC10aXRsZScpKTtcblxuICAgICAgICAgICAgICAgIC8vbG9hZCBvbGQgdmlldyBpZiBpdCBleGlzdHMuXG4gICAgICAgICAgICAgICAgaWYgKF8uaXNFbXB0eShTdGF0ZVNhdmUuc2F2ZWRTdGF0ZXMpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBncmFwaCA9IHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaDtcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGgubG9hZChTdGF0ZVNhdmUuc2F2ZWRTdGF0ZXMpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJue1xuICAgICAgICAgICAgICAgIHJlc3RyaWN0OidFQScsXG4gICAgICAgICAgICAgICAgcmVwbGFjZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb250ZW1wbGF0ZS5odG1sJyxcbiAgICAgICAgICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbSl7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS51bmJpbmQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5kZXN0cm95KCk7fSk7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiR3YXRjaEdyb3VwKFsnbm9kZXMnLCAnbGlua3MnLCAnY2hpbGRyZW5fc3RydWN0JywgJ2FuY2VzdG9yc19zdHJ1Y3QnXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzY29wZS5ub2RlcyAhPSBudWxsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmxpbmtzICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuY2hpbGRyZW5fc3RydWN0ICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuYW5jZXN0b3JzX3N0cnVjdCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzY29wZS5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5pbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc3VhbGl6YXRpb25saXN0ZDMoc2NvcGUsIGVsZW0sIFZpc3VhbGl6ZXJHcmFwaCwgUG9saWN5U2VydmljZSwgVmlzdWFsaXplckRhdGFTb3VyY2UsIFN0YXRlU2F2ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmRhdGFTb3VyY2UubGlua3MgPSBzY29wZS5saW5rcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLnVwZGF0ZUxpbmtEYXRhKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIF1cbik7XG5cblxuXG5cblxuXG5cblxuXG5cblxuXG4iLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52aXN1YWxpemF0aW9uLmxpc3QnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWaXN1YWxpemF0aW9uTGlzdEN0cmwgYXMgdmlzdWFsaXphdGlvbkxpc3RDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Zpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbmxpc3QuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignVmlzdWFsaXphdGlvbkxpc3RDdHJsJywgW1wiJHNjb3BlXCIsIFwiJGh0dHBcIiwgJ1Zpc3VhbGl6YXRpb25TZXJ2aWNlJywgJyRpbnRlcnZhbCcsIFxuICAgICAgICBmdW5jdGlvbigkc2NvcGUsICRodHRwLCBWaXN1YWxpemF0aW9uU2VydmljZSwgJGludGVydmFsKSB7XG4gICAgICAgICAgICAvL3RvIHNlZSB0aGUgZXhwZWN0ZWQgZm9ybWF0IHRvIGJlIHJldHVybmVkIGZyb20gdGhlc2UgY2FsbHMsXG4gICAgICAgICAgICAvL2xvb2sgYXQgYXBwL2NvbXBvbmVudHMvZ3JhcGhvYmplY3RzL2RhdGFzb3VyY2UvdmlzdWFsaXplcmRhdGFzb3VyY2UuanNcbiAgICAgICAgICAgIHZhciBzdWNjZXNzR3JhcGhEYXRhQ2FsbGJhY2sgPSBmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgbGlua3MgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZUlkcyA9IFtdO1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaChyZXN1bHQucmVzdWx0c1swXS5zZXJpZXMsIGZ1bmN0aW9uKHNlcmllcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZW5kcG9pbnQgPSBzZXJpZXMudGFncy5FbmRwb2ludElQO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJvdmlkZXIgPSBzZXJpZXMudGFncy5Qcm92aWRlcklQO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZTtcbiAgICAgICAgICAgICAgICAgICAgLy9jcmVhdGluZyBub2Rlc1xuICAgICAgICAgICAgICAgICAgICBpZiAoXy5pbmNsdWRlcyhub2RlSWRzLCBlbmRwb2ludCkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogZW5kcG9pbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGVuZHBvaW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNlc3RvcnM6IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlkcy5wdXNoKGVuZHBvaW50KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoXy5pbmNsdWRlcyhub2RlSWRzLCBwcm92aWRlcikgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogcHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHByb3ZpZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNlc3RvcnM6IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlkcy5wdXNoKHByb3ZpZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvL2NyZWF0aW5nIGxpbmtzXG4gICAgICAgICAgICAgICAgICAgIHZhciBsaW5rT3V0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiBlbmRwb2ludCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogcHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ6IHNlcmllcy52YWx1ZXNbMF1bMl1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgbGlua3MucHVzaChsaW5rT3V0KTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxpbmtJbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogcHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IGVuZHBvaW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0OiBzZXJpZXMudmFsdWVzWzBdWzFdXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGxpbmtzLnB1c2gobGlua0luKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAkc2NvcGUubm9kZXMgPSBub2RlcztcbiAgICAgICAgICAgICAgICAkc2NvcGUubGlua3MgPSBsaW5rcztcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAvL2luaXRpYWwgY2FsbFxuICAgICAgICAgICAgVmlzdWFsaXphdGlvblNlcnZpY2UuZ2V0R3JhcGhEYXRhKCkudGhlbihzdWNjZXNzR3JhcGhEYXRhQ2FsbGJhY2ssIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy93aWxsIGZhaWwgc2lsZW50bHksIGdyYXBoIHdvbid0IGJlIGRpc3BsYXllZFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkgeyAkaW50ZXJ2YWwuY2FuY2VsKCRzY29wZS5ncmFwaERhdGFJbnRlcnZhbCk7IH0pO1xuXG4gICAgICAgICAgICBWaXN1YWxpemF0aW9uU2VydmljZS5nZXRTdHJ1Y3R1cmVEYXRhKCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy90byBzZWUgdGhlIGV4cGVjdGVkIGZvcm0gb2YgYW5jZXN0b3Jfc3RydWN0IGFuZCBjaGlsZHJlbl9zdHJ1Y3QsIFxuICAgICAgICAgICAgICAgIC8vbG9vayBhdCBhcHAvY29tcG9uZW50cy9ncmFwaG9iamVjdHMvZGF0YXNvdXJjZS92aXN1YWxpemVyZGF0YXNvdXJjZS5qc1xuICAgICAgICAgICAgICAgICRzY29wZS5hbmNlc3RvcnNfc3RydWN0ID0gcmVzdWx0LmFuY2VzdG9yc19zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoaWxkcmVuX3N0cnVjdCA9IHJlc3VsdC5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxhYmVscyA9IHJlc3VsdC5sYWJlbHM7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlcnZpY2VTZWxlY3RvcnMgPSByZXN1bHQuc2VydmljZVNlbGVjdG9ycztcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy93aWxsIGZhaWwgc2lsZW50bHksIGdyYXBoIHdvbid0IGJlIGRpc3BsYXllZFxuICAgICAgICAgICAgfSk7XG4gICAgfV0pO1xuXG5cblxuXG5cblxuXG5cblxuXG5cbiIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicpXG4gICAgLmZhY3RvcnkoJ1Zpc3VhbGl6YXRpb25TZXJ2aWNlJywgWyckaHR0cCcsICckcScsIGZ1bmN0aW9uICgkaHR0cCwgJHEpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1ha2VzIGEgZ2V0IHJlcXVlc3Qgd2l0aCB0aGUgdXJsIGFuZCBjb25maWcuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICB1cmwgICAgIFRoZSB1cmxcbiAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGNvbmZpZyAgVGhlIGNvbmZpZ3VyYXRpb25zXG4gICAgICAgICAqIEByZXR1cm4gICAgIHskSHR0cCBQcm9taXNlfSAgIFByb21pc2Ugb2YgdGhlIHJlcXVlc3RcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIG1ha2VHZXQodXJsLCBjb25maWcpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAkaHR0cC5nZXQodXJsLCBjb25maWcpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYWtlcyBhIHBvc3QgcmVxdWVzdCB3aXRoIHRoZSB1cmwgYW5kIGRhdGFcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHVybCAgICAgVGhlIHVybFxuICAgICAgICAgKiBAcGFyYW0gICAgICB7SlNPTn0gICAgZGF0YSAgICBUaGUgZGF0YVxuICAgICAgICAgKiBAcmV0dXJuICAgICB7JEh0dHAgUHJvbWlzZX0gICBQcm9taXNlIG9mIHRoZSByZXF1ZXN0XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBtYWtlUG9zdCh1cmwsIGRhdGEpIHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogY29udmVydHMgdGhlIGRhdGEgaW50byB4LXd3dy1mcm9tLXVybGVuY29kZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SlNPTn0gIG9iaiAgICAgSlNPTiBkYXRhIG9iamVjdFxuICAgICAgICAgICAgICogQHJldHVybiAgICAge3N0cmluZ30gIHgtd3d3LWZvcm0tdXJsZW5jb2RlZCBzdHJpbmdcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdmFyIHBhcmFtID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gJycsIG5hbWUsIHZhbHVlLCBmdWxsU3ViTmFtZSwgc3ViTmFtZSwgc3ViVmFsdWUsIGlubmVyT2JqLCBpO1xuICAgICAgICAgICAgICAgIGZvciAobmFtZSBpbiBvYmopIHtcbiAgICAgICAgICAgICAgICAgIHZhbHVlID0gb2JqW25hbWVdO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGk9MDsgaTx2YWx1ZS5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlZhbHVlID0gdmFsdWVbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVsbFN1Yk5hbWUgPSBuYW1lICsgJ1snICsgaSArICddJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbm5lck9iaiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlubmVyT2JqW2Z1bGxTdWJOYW1lXSA9IHN1YlZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ICs9IHBhcmFtKGlubmVyT2JqKSArICcmJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIE9iamVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChzdWJOYW1lIGluIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViVmFsdWUgPSB2YWx1ZVtzdWJOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdWxsU3ViTmFtZSA9IG5hbWUgKyAnWycgKyBzdWJOYW1lICsgJ10nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlubmVyT2JqID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5uZXJPYmpbZnVsbFN1Yk5hbWVdID0gc3ViVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkgKz0gcGFyYW0oaW5uZXJPYmopICsgJyYnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYodmFsdWUgIT09IHVuZGVmaW5lZCAmJiB2YWx1ZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkgKz0gZW5jb2RlVVJJQ29tcG9uZW50KG5hbWUpICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKSArICcmJztcbiAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHF1ZXJ5Lmxlbmd0aCA/IHF1ZXJ5LnN1YnN0cigwLCBxdWVyeS5sZW5ndGggLSAxKSA6IHF1ZXJ5O1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICB1cmw6dXJsLFxuICAgICAgICAgICAgICAgIG1ldGhvZDonUE9TVCcsXG4gICAgICAgICAgICAgICAgZGF0YTogZGF0YSxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCdcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHRyYW5zZm9ybVJlcXVlc3Q6IFtmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhbmd1bGFyLmlzT2JqZWN0KGRhdGEpICYmIFN0cmluZyhkYXRhKSAhPT0gJ1tvYmplY3QgRmlsZV0nID8gcGFyYW0oZGF0YSkgOiBkYXRhO1xuICAgICAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0R3JhcGhEYXRhKCkge1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuVklTVUFMSVpBVElPTl9FTkRQT0lOVDtcbiAgICAgICAgICAgIHVybCArPSAnaW5mbHV4L3F1ZXJ5JztcbiAgICAgICAgICAgIHZhciBjb25maWcgPSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgICAgICAgICAgIGRiOlwidGVsZWdyYWZcIixcbiAgICAgICAgICAgICAgICAgICAgcTpcIlNFTEVDVCBCeXRlc0luLCBCeXRlc091dCwgRW5kcG9pbnRJUCwgUHJvdmlkZXJJUCBGUk9NIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDFtIEdST1VQIEJZICogTElNSVQgMVwiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBtYWtlR2V0KHVybCwgY29uZmlnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldFN0cnVjdHVyZURhdGEoKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WSVNVQUxJWkFUSU9OX0VORFBPSU5UO1xuICAgICAgICAgICAgdXJsICs9ICdzZXJ2aWNlcyc7XG4gICAgICAgICAgICByZXR1cm4gbWFrZUdldCh1cmwpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gYnVpbGRXaGVyZVF1ZXJ5KHBvaW50cywgdHlwZSkge1xuICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gXCIoXCI7XG4gICAgICAgICAgICBxdWVyeSArPSB0eXBlICsgXCI9XCI7XG4gICAgICAgICAgICBxdWVyeSArPSBcIidcIiArIHBvaW50c1swXSArIFwiJyBcIjtcbiAgICAgICAgICAgIC8vc3RhcnRzIGF0IDEsIHNvIHdpbGwgbm90IHJ1biBpZiBsZW5ndGggaXMgMVxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBwb2ludHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBxdWVyeSArPSAnT1IgJztcbiAgICAgICAgICAgICAgICBxdWVyeSArPSB0eXBlICsgXCI9XCI7XG4gICAgICAgICAgICAgICAgcXVlcnkgKz0gXCInXCIgKyBwb2ludHNbaV0gKyBcIicgXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBxdWVyeSArPSBcIilcIjtcbiAgICAgICAgICAgIHJldHVybiBxdWVyeTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldEVkZ2VEYXRhKHNvdXJjZUxpc3QsIHRhcmdldExpc3QsIHRpbWUpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLlZJU1VBTElaQVRJT05fRU5EUE9JTlQ7XG4gICAgICAgICAgICB1cmwgKz0gJ2luZmx1eC9xdWVyeSc7XG5cbiAgICAgICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICBkYiA6IFwidGVsZWdyYWZcIixcbiAgICAgICAgICAgICAgICAgICAgcTogXCJTRUxFQ1Qgc3VtKFwiICsgJ0J5dGVzT3V0JyArIFwiKSBmcm9tIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDE1cyBBTkQgXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeShzb3VyY2VMaXN0LCBcIkVuZHBvaW50SVBcIikgK1wiIEFORCBcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeSh0YXJnZXRMaXN0LCAnUHJvdmlkZXJJUCcpIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgXCJHUk9VUCBCWSB0aW1lKDIwcykgTElNSVQgMTsgU0VMRUNUIHN1bShcIiArICdCeXRlc0luJyArIFwiKSBmcm9tIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDE1cyBBTkQgXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeShzb3VyY2VMaXN0LCAnUHJvdmlkZXJJUCcpICtcIiBBTkQgXCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkodGFyZ2V0TGlzdCwgJ0VuZHBvaW50SVAnKSBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIFwiR1JPVVAgQlkgdGltZSgyMHMpIGZpbGwoMCkgTElNSVQgMVwiXG4gICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIG1ha2VQb3N0KHVybCwgZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICBcblxuICAgICAgICBmdW5jdGlvbiBnZXRPbGRFZGdlRGF0YShzb3VyY2VMaXN0LCB0YXJnZXRMaXN0KSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WSVNVQUxJWkFUSU9OX0VORFBPSU5UO1xuICAgICAgICAgICAgdXJsICs9ICdpbmZsdXgvcXVlcnknO1xuICAgICAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgICAgIGRiIDogXCJ0ZWxlZ3JhZlwiLFxuICAgICAgICAgICAgICAgICAgICBxOiBcIlNFTEVDVCBzdW0oXCIgKyAnQnl0ZXNPdXQnICsgXCIpIEZST00gaHR0cGpzb25fc3Zjc3RhdHMgV0hFUkUgdGltZSA+IG5vdygpIC0gMW0gQU5EIFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkoc291cmNlTGlzdCwgXCJFbmRwb2ludElQXCIpICtcIiBBTkQgXCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkodGFyZ2V0TGlzdCwgXCJQcm92aWRlcklQXCIpIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgXCIgR1JPVVAgQlkgdGltZSgxMHMpIGZpbGwoMCkgTElNSVQgNjsgU0VMRUNUIHN1bShcIiArICdCeXRlc0luJyArIFwiKSBGUk9NIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDFtIEFORCBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHNvdXJjZUxpc3QsIFwiUHJvdmlkZXJJUFwiKSArXCIgQU5EIFwiIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHRhcmdldExpc3QsIFwiRW5kcG9pbnRJUFwiKSBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIFwiIEdST1VQIEJZIHRpbWUoMTBzKSBmaWxsKDApIExJTUlUIDZcIlxuICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBtYWtlUG9zdCh1cmwsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldEdyYXBoRGF0YTogZ2V0R3JhcGhEYXRhLFxuICAgICAgICAgICAgZ2V0U3RydWN0dXJlRGF0YTogZ2V0U3RydWN0dXJlRGF0YSxcbiAgICAgICAgICAgIGdldEVkZ2VEYXRhOiBnZXRFZGdlRGF0YSxcbiAgICAgICAgICAgIGdldE9sZEVkZ2VEYXRhOiBnZXRPbGRFZGdlRGF0YVxuICAgICAgICB9XG4gICAgfV0pO1xuXG5cblxuXG5cblxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA2LzMvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudm9sdW1lcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZvbHVtZXMuY3JlYXRlJywge1xuICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZvbHVtZXMvdm9sdW1lY3JlYXRlLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1ZvbHVtZUNyZWF0ZUN0cmwgYXMgdm9sdW1lQ3JlYXRlQ3RybCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1ZvbHVtZUNyZWF0ZUN0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnVm9sdW1lc01vZGVsJywgJ1N0b3JhZ2VQb2xpY2llc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIFZvbHVtZXNNb2RlbCwgU3RvcmFnZVBvbGljaWVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2b2x1bWVDcmVhdGVDdHJsID0gdGhpcztcbiAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5maWxlc3lzdGVtcyA9IFsnZXh0NCcsICdidHJmcyddO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1ZvbHVtZXNNb2RlbCgpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUudm9sdW1lcy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub1ZvbHVtZXNNb2RlbCgpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZXQgc3RvcmFnZSBwb2xpY2llcy5cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGdldFN0b3JhZ2VQb2xpY2llcygpIHtcbiAgICAgICAgICAgIFN0b3JhZ2VQb2xpY2llc01vZGVsLmdldCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwucG9saWNpZXMgPSByZXN1bHQ7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBhcHBseVBvbGljeVNldHRpbmdzKCkge1xuICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUucG9saWN5ID0gdm9sdW1lQ3JlYXRlQ3RybC5zZWxlY3RlZFBvbGljeS5uYW1lO1xuICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUuYmFja2VuZHMgPSB2b2x1bWVDcmVhdGVDdHJsLnNlbGVjdGVkUG9saWN5LmJhY2tlbmRzO1xuICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUuZHJpdmVyID0gdm9sdW1lQ3JlYXRlQ3RybC5zZWxlY3RlZFBvbGljeS5kcml2ZXI7XG4gICAgICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLm5ld1ZvbHVtZS5jcmVhdGUgPSB2b2x1bWVDcmVhdGVDdHJsLnNlbGVjdGVkUG9saWN5LmNyZWF0ZTtcbiAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwubmV3Vm9sdW1lLnJ1bnRpbWUgPSB2b2x1bWVDcmVhdGVDdHJsLnNlbGVjdGVkUG9saWN5LnJ1bnRpbWU7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlVm9sdW1lKCkge1xuICAgICAgICAgICAgLy9mb3JtIGNvbnRyb2xsZXIgaXMgaW5qZWN0ZWQgYnkgdGhlIGh0bWwgdGVtcGxhdGVcbiAgICAgICAgICAgIC8vY2hlY2tpbmcgaWYgYWxsIHZhbGlkYXRpb25zIGhhdmUgcGFzc2VkXG4gICAgICAgICAgICBpZiAodm9sdW1lQ3JlYXRlQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcih2b2x1bWVDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcih2b2x1bWVDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBhcHBseVBvbGljeVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgVm9sdW1lc01vZGVsLmNyZWF0ZSh2b2x1bWVDcmVhdGVDdHJsLm5ld1ZvbHVtZSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvVm9sdW1lc01vZGVsKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHZvbHVtZUNyZWF0ZUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmVzZXRGb3JtKCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcih2b2x1bWVDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwubmV3Vm9sdW1lID0ge1xuICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgIFwiYmFja2VuZHNcIjoge30sXG4gICAgICAgICAgICAgICAgXCJkcml2ZXJcIjoge30sXG4gICAgICAgICAgICAgICAgXCJjcmVhdGVcIjoge30sXG4gICAgICAgICAgICAgICAgXCJydW50aW1lXCI6IHt9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwuY3JlYXRlVm9sdW1lID0gY3JlYXRlVm9sdW1lO1xuICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLmNhbmNlbENyZWF0aW5nID0gY2FuY2VsQ3JlYXRpbmc7XG4gICAgICAgIGdldFN0b3JhZ2VQb2xpY2llcygpO1xuICAgICAgICByZXNldEZvcm0oKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD12b2x1bWVjcmVhdGVjdHJsLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNC8xNS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52b2x1bWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUudm9sdW1lcy5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVm9sdW1lRGV0YWlsc0N0cmwgYXMgdm9sdW1lRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2b2x1bWVzL3ZvbHVtZWRldGFpbHMuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1ZvbHVtZURldGFpbHNDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGh0dHAnLCAnVm9sdW1lc01vZGVsJywgJ1ZvbHVtZVNlcnZpY2UnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgJHNjb3BlLCAkaW50ZXJ2YWwsICRodHRwLCBWb2x1bWVzTW9kZWwsIFZvbHVtZVNlcnZpY2UsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2b2x1bWVEZXRhaWxzQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvVm9sdW1lcygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUudm9sdW1lcy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZGVsZXRlVm9sdW1lKCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHZvbHVtZURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKHZvbHVtZURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIFZvbHVtZXNNb2RlbC5kZWxldGUodm9sdW1lRGV0YWlsc0N0cmwudm9sdW1lKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICByZXR1cm5Ub1ZvbHVtZXMoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdldFZvbHVtZUluZm8ocmVsb2FkKSB7XG4gICAgICAgICAgICB2YXIgdG9rZW5zID0gJHN0YXRlUGFyYW1zLmtleS5zcGxpdCgnLycpO1xuICAgICAgICAgICAgdmFyIG1vZGVsID0ge307XG4gICAgICAgICAgICBtb2RlbC5wb2xpY3kgPSB0b2tlbnNbMF07XG4gICAgICAgICAgICBtb2RlbC5uYW1lID0gdG9rZW5zWzFdO1xuICAgICAgICAgICAgVm9sdW1lc01vZGVsLmdldE1vZGVsKG1vZGVsLCByZWxvYWQpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHZvbHVtZSkge1xuICAgICAgICAgICAgICAgIHZvbHVtZURldGFpbHNDdHJsLnZvbHVtZSA9IHZvbHVtZTtcbiAgICAgICAgICAgICAgICBnZXRWb2x1bWVVc2VJbmZvKCk7XG4gICAgICAgICAgICAgICAgZ2V0Vm9sdW1lU25hcHNob3RzKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnZXRWb2x1bWVVc2VJbmZvKCkge1xuICAgICAgICAgICAgVm9sdW1lU2VydmljZS5nZXRWb2x1bWVVc2VJbmZvKHZvbHVtZURldGFpbHNDdHJsLnZvbHVtZSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgdm9sdW1lRGV0YWlsc0N0cmwudm9sdW1lVXNlID0gcmVzdWx0O1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAvL1JldHVybnMgZXJyb3IgaWYgdm9sdW1lIGlzIG5vdCBtb3VudGVkIGJ5IGFueSBjb250YWluZXJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdldFZvbHVtZVNuYXBzaG90cygpIHtcbiAgICAgICAgICAgIFZvbHVtZVNlcnZpY2UuZ2V0Vm9sdW1lU25hcHNob3RzKHZvbHVtZURldGFpbHNDdHJsLnZvbHVtZSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgdm9sdW1lRGV0YWlsc0N0cmwuc25hcHNob3RzID0gcmVzdWx0O1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHRyaWdnZXJWb2x1bWVTbmFwc2hvdCgpIHtcbiAgICAgICAgICAgIHZvbHVtZURldGFpbHNDdHJsLnNuYXBzaG90U3VjY2VzcyA9IGZhbHNlO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHZvbHVtZURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKHZvbHVtZURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIFZvbHVtZVNlcnZpY2UudHJpZ2dlclNuYXBzaG90KHZvbHVtZURldGFpbHNDdHJsLnZvbHVtZSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgdm9sdW1lRGV0YWlsc0N0cmwuc25hcHNob3RTdWNjZXNzID0gdHJ1ZTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHZvbHVtZURldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdm9sdW1lRGV0YWlsc0N0cmwuZGVsZXRlVm9sdW1lID0gZGVsZXRlVm9sdW1lO1xuICAgICAgICB2b2x1bWVEZXRhaWxzQ3RybC50cmlnZ2VyVm9sdW1lU25hcHNob3QgPSB0cmlnZ2VyVm9sdW1lU25hcHNob3Q7XG4gICAgICAgIC8vTG9hZCBmcm9tIGNhY2hlIGZvciBxdWljayBkaXNwbGF5IGluaXRpYWxseVxuICAgICAgICBnZXRWb2x1bWVJbmZvKGZhbHNlKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldFZvbHVtZUluZm8odHJ1ZSk7XG4gICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD12b2x1bWVkZXRhaWxzY3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMjIvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudm9sdW1lcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZvbHVtZXMubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWb2x1bWVMaXN0Q3RybCBhcyB2b2x1bWVMaXN0Q3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZvbHVtZXMvdm9sdW1lbGlzdC5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignVm9sdW1lTGlzdEN0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdWb2x1bWVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgVm9sdW1lc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgdm9sdW1lTGlzdEN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBnZXRWb2x1bWVzKHJlbG9hZCkge1xuICAgICAgICAgICAgVm9sdW1lc01vZGVsLmdldChyZWxvYWQpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgIHZvbHVtZUxpc3RDdHJsLnZvbHVtZXMgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lTGlzdEN0cmwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgIGdldFZvbHVtZXMoZmFsc2UpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0Vm9sdW1lcyh0cnVlKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXZvbHVtZWxpc3RjdHJsLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNi81LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZvbHVtZXMnKVxuICAgIC5mYWN0b3J5KCdWb2x1bWVTZXJ2aWNlJywgWyckaHR0cCcsICckcScsIGZ1bmN0aW9uICgkaHR0cCwgJHEpIHtcbiAgICAgICAgZnVuY3Rpb24gZ2V0Vm9sdW1lVXNlSW5mbyh2b2x1bWUpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WT0xVTUVTX1VTRVNfRU5EUE9JTlRcbiAgICAgICAgICAgICAgICArIHZvbHVtZS5wb2xpY3lcbiAgICAgICAgICAgICAgICArICcvJyArIHZvbHVtZS5uYW1lO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vUmV0dXJucyBlcnJvciBpZiB2b2x1bWUgaXMgbm90IG1vdW50ZWQgYnkgYW55IGNvbnRhaW5lclxuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdldFZvbHVtZVNuYXBzaG90cyh2b2x1bWUpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WT0xVTUVTX1NOQVBTSE9UU19FTkRQT0lOVFxuICAgICAgICAgICAgICAgICsgdm9sdW1lLnBvbGljeVxuICAgICAgICAgICAgICAgICsgJy8nICsgdm9sdW1lLm5hbWU7XG4gICAgICAgICAgICAkaHR0cC5nZXQodXJsKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gdHJpZ2dlclNuYXBzaG90KHZvbHVtZSkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLlZPTFVNRVNfU05BUFNIT1RTX0VORFBPSU5UICsgXCJ0YWtlL1wiXG4gICAgICAgICAgICAgICAgKyB2b2x1bWUucG9saWN5XG4gICAgICAgICAgICAgICAgKyAnLycgKyB2b2x1bWUubmFtZTtcbiAgICAgICAgICAgICRodHRwLnBvc3QodXJsKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldFZvbHVtZVVzZUluZm86IGdldFZvbHVtZVVzZUluZm8sXG4gICAgICAgICAgICBnZXRWb2x1bWVTbmFwc2hvdHM6IGdldFZvbHVtZVNuYXBzaG90cyxcbiAgICAgICAgICAgIHRyaWdnZXJTbmFwc2hvdDogdHJpZ2dlclNuYXBzaG90XG4gICAgICAgIH07XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dm9sdW1lc2VydmljZS5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgY3NoYW1wdXIgb24gOC85LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZvbHVtZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52b2x1bWVzLmNvcHknLCB7XG4gICAgICAgICAgICB1cmw6ICcvY29weS8nLFxuICAgICAgICAgICAgcGFyYW1zOiB7IHNuYXBzaG90OiBudWxsLCBwb2xpY3k6IG51bGwsIHZvbHVtZTogbnVsbCB9LFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1ZvbHVtZVNuYXBzaG90Q29weUN0cmwgYXMgdm9sdW1lU25hcHNob3RDb3B5Q3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZvbHVtZXMvdm9sdW1lc25hcHNob3Rjb3B5Lmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdWb2x1bWVTbmFwc2hvdENvcHlDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGh0dHAnLCAnVm9sdW1lc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRzY29wZSwgJGludGVydmFsLCAkaHR0cCwgVm9sdW1lc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgdm9sdW1lU25hcHNob3RDb3B5Q3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbENvcHkoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZvbHVtZXMuZGV0YWlscycsIHsga2V5OiAkc3RhdGVQYXJhbXMucG9saWN5ICsgJy8nICsgJHN0YXRlUGFyYW1zLnZvbHVtZSB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnb1RvTmV3Vm9sdW1lKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS52b2x1bWVzLmRldGFpbHMnLCB7IGtleTogJHN0YXRlUGFyYW1zLnBvbGljeSArICcvJyArIHZvbHVtZVNuYXBzaG90Q29weUN0cmwubmV3dm9sdW1lIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNvcHlTbmFwc2hvdCgpIHtcbiAgICAgICAgICAgIGlmICh2b2x1bWVTbmFwc2hvdENvcHlDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHZvbHVtZVNuYXBzaG90Q29weUN0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKHZvbHVtZVNuYXBzaG90Q29weUN0cmwpO1xuICAgICAgICAgICAgICAgIHZhciBtb2RlbCA9IHt9O1xuICAgICAgICAgICAgICAgIG1vZGVsLnBvbGljeSA9ICRzdGF0ZVBhcmFtcy5wb2xpY3k7XG4gICAgICAgICAgICAgICAgbW9kZWwubmFtZSA9ICRzdGF0ZVBhcmFtcy52b2x1bWU7XG4gICAgICAgICAgICAgICAgVm9sdW1lc01vZGVsLmNvcHkobW9kZWwsICRzdGF0ZVBhcmFtcy5zbmFwc2hvdCwgdm9sdW1lU25hcHNob3RDb3B5Q3RybC5uZXd2b2x1bWUpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVTbmFwc2hvdENvcHlDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgZ29Ub05ld1ZvbHVtZSgpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lU25hcHNob3RDb3B5Q3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcih2b2x1bWVTbmFwc2hvdENvcHlDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZvbHVtZVNuYXBzaG90Q29weUN0cmwucG9saWN5ID0gJHN0YXRlUGFyYW1zLnBvbGljeTtcbiAgICAgICAgdm9sdW1lU25hcHNob3RDb3B5Q3RybC52b2x1bWUgPSAkc3RhdGVQYXJhbXMudm9sdW1lO1xuICAgICAgICB2b2x1bWVTbmFwc2hvdENvcHlDdHJsLnNuYXBzaG90ID0gJHN0YXRlUGFyYW1zLnNuYXBzaG90O1xuICAgICAgICB2b2x1bWVTbmFwc2hvdENvcHlDdHJsLmNvcHlTbmFwc2hvdCA9IGNvcHlTbmFwc2hvdDtcbiAgICAgICAgdm9sdW1lU25hcHNob3RDb3B5Q3RybC5jYW5jZWxDb3B5ID0gY2FuY2VsQ29weTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD12b2x1bWVzbmFwc2hvdGNvcHljdHJsLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSBjc2hhbXB1ciBvbiA3LzEvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2QWNjb3JkaW9uXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgaXRlbXM6ICc9JyxcbiAgICAgICAgfSxcbiAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50KSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGVsZW1lbnQuZmluZCgnLnVpLmFjY29yZGlvbicpLmFjY29yZGlvbiA9PSAnZnVuY3Rpb24nKVxuICAgICAgICAgICAgICAgIGVsZW1lbnQuZmluZCgnLnVpLmFjY29yZGlvbicpLmFjY29yZGlvbigpO1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy9hY2NvcmRpb24uaHRtbCdcbiAgICB9O1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hY2NvcmRpb25kaXJlY3RpdmUuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA2LzIvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2Q29sbGFwc2libGVcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICB0aXRsZTogJ0AnLFxuICAgICAgICAgICAgY29sbGFwc2VkOiAnQCdcbiAgICAgICAgfSxcbiAgICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlKSB7XG4gICAgICAgICAgICBpZiAoc2NvcGUuY29sbGFwc2VkID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgc2NvcGUuY29sbGFwc2VkID0gdHJ1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvY29sbGFwc2libGUuaHRtbCdcbiAgICB9O1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb2xsYXBzaWJsZWRpcmVjdGl2ZS5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTEvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2TmFtZXZhbHVlXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgaXRlbXM6ICc9JyxcbiAgICAgICAgICAgIG5hbWVoZWFkZXI6ICdAJyxcbiAgICAgICAgICAgIHZhbHVlaGVhZGVyOiAnQCcsXG4gICAgICAgICAgICB0eXBlOiAnQCcsXG4gICAgICAgICAgICBvcHRpb25zOiAnPScgLy9UbyBiZSB1c2VkIHdoZW4gdHlwZSBpcyAnc2VsZWN0J1xuICAgICAgICB9LFxuICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUpIHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ29tcGFyZSBpZiB0d28gaXRlbXMgaGF2ZSBzYW1lIG5hbWVcbiAgICAgICAgICAgICAqIEBwYXJhbSB2YWwxXG4gICAgICAgICAgICAgKiBAcGFyYW0gdmFsMlxuICAgICAgICAgICAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNvbXBhcmUodmFsMSwgdmFsMikge1xuICAgICAgICAgICAgICAgIHJldHVybiB2YWwxLm5hbWUgPT0gdmFsMi5uYW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZnVuY3Rpb24gcmVzZXROZXdJdGVtKCkge1xuICAgICAgICAgICAgICAgIHNjb3BlLm5ld0l0ZW0gPSB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICcnLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogJydcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZnVuY3Rpb24gaXNFbXB0eUl0ZW0oaXRlbSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAoaXRlbS5uYW1lID09PSAnJyAmJiBpdGVtLnZhbHVlID09PSAnJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzY29wZS5hZGQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzRW1wdHlJdGVtKHNjb3BlLm5ld0l0ZW0pKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgaWYgKHNjb3BlLml0ZW0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzY29wZS5pdGVtID0gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vUmVtb3ZlcyBleGlzdGluZyBpdGVtIHdpdGggdGhlIHNhbWUgbmFtZSBmaXJzdCBpZiBpdCBleGlzdHMuXG4gICAgICAgICAgICAgICAgXy5wdWxsQWxsV2l0aChzY29wZS5pdGVtcywgW3Njb3BlLm5ld0l0ZW1dLCBjb21wYXJlKTtcbiAgICAgICAgICAgICAgICBzY29wZS5pdGVtcy5wdXNoKHNjb3BlLm5ld0l0ZW0pO1xuICAgICAgICAgICAgICAgIHJlc2V0TmV3SXRlbSgpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHNjb3BlLnJlbW92ZSA9IGZ1bmN0aW9uIChwYXNzZWRJdGVtKSB7XG4gICAgICAgICAgICAgICAgXy5yZW1vdmUoc2NvcGUuaXRlbXMsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLm5hbWUgPT0gcGFzc2VkSXRlbS5uYW1lO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJlc2V0TmV3SXRlbSgpO1xuICAgICAgICAgICAgaWYgKHNjb3BlLm5hbWVoZWFkZXIgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICBzY29wZS5uYW1laGVhZGVyID0gJ05hbWUnO1xuICAgICAgICAgICAgaWYgKHNjb3BlLnZhbHVlaGVhZGVyID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgc2NvcGUudmFsdWVoZWFkZXIgPSAnVmFsdWUnO1xuICAgICAgICAgICAgaWYgKHNjb3BlLnR5cGUgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICBzY29wZS50eXBlID0gJ3RleHQnO1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy9uYW1ldmFsdWUuaHRtbCdcbiAgICB9O1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1uYW1ldmFsdWVkaXJlY3RpdmUuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzQvMTYuXG4gKi9cbi8qXG5EaXJlY3RpdmUgVXNhZ2UgOlxuXG5hKSBjdHZUYWJsZSAtXG4gICB1c2FnZSA6IDxjdHYtdGFibGUgZGVmYXVsdHNvcnRjb2x1bW49J25hbWUnIGl0ZW1zPSd0YWJsZUl0ZW1zJyBmaWx0ZXJlZGl0ZW1zPSdmaWx0SXRlbXMnIHNpemU9J3NpemUnPjwvY3R2LXRhYmxlPlxuICAgYXR0cmlidXRlIGRldGFpbHMgOiAgZGVmYXVsdHNvcnRjb2x1bW4gLSBUaGUgZGVmYXVsdCBjb2x1bW4gbmFtZShjb3JyZXNwb25kaW5nIGtleSBpbnNpZGUgdGhlIG9iamVjdCBvZiBpdGVtcyBhcnJheSkgb24gd2hpY2ggdGhlIHRhYmxlIHdpbGwgYmUgc29ydGVkIHdoZW4gaXQgaXMgbG9hZGVkLlxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXMgLSBBbiBhcnJheSBvZiBvYmplY3RzIHdoaWNoIHdpbGwgYmUgZGlzcGxheWVkIGJ5IHRoZSBjdHYtdGFibGUgZGlyZWN0aXZlLlxuICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZSAtIG51bWJlciBvZiByb3dzIHRvIGJlIGRpc3BsYXllZCBpbnNpZGUgdGhlIHRhYmxlLiBJZiBpdGVtcy5sZW5ndGggPiBzaXplIHRoZW4gcmVtYWluaW5nIGl0ZW1zXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lsbCBiZSBkaXNwbGF5ZWQgaW4gbmV4dCBwYWdlLlxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyZWRpdGVtcyAtIFRoaXMgaXMgYW4gb3V0cHV0IGZpZWxkIHdoaWNoIHByb2R1Y2VzIGEgZmlsdGVyZWQgc3Vic2V0IG9mIGl0ZW1zIHNwZWNlZmllZCBieVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZSBwcmV2aW91cyBhdHRyaWJ1dGUsIEl0ZW1zIGFyZSBmaWx0ZXJlZCBiYXNlZCBvbiBzZWFyY2ggdGV4dCBkZWZpbmVkIGluc2lkZSBjdHYtc2VhcmNoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZCBieSB0aGUgc2l6ZSBtZW50aW9uZWQgaW4gdGhlIGN0di10YWJsZSBhdHRyaWJ1dGVcbmIpIGN0dlRIIC1cbiAgIHVzYWdlIDogPGN0di10aCBzb3J0ZmllbGQ9J25hbWUnPm5hbWU8L2N0di10aD5cbiAgIGF0dHJpYnV0ZSBkZXRhaWxzIDogc29ydGZpZWxkIC0gVGhpcyBpcyB0aGUga2V5IG9mIHRoZSBvYmplY3QgcHJlc2VudCBpbnNpZGUgaXRlbXMgYXJyYXkgc3BlY2VmaWVkIGluIGN0dlRhYmxlLCBmb3IgZWcgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0aGUgYXJyYXkgb2JqZWN0IGlzIDogW3tpcDogXCIyMC4xLjIuM1wiLCBob3N0OiBcImNsdXN0ZXItMVwifSx7aXA6IFwiMjAuMS4yLjRcIiwgaG9zdDogXCJjbHVzdGVyLTJcIn1dXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZW4gZGlyZWN0aXZlIHdpbGwgYmUgPGN0di10aCBzb3J0ZmllbGQ9XCInaXAnXCI+IElwIEFkZHJlc3MgPC9jdHYtdGg+XG4gICBUYWJsZSBjYW4gb25seSBiZSBzb3J0ZWQgb24gY29sdW1ucyB3aGljaCBoYXMgc29ydGZpZWxkIGF0dHJpYnV0ZSBzcGVjZWZpZWQuXG5cbmMpIGN0dlRzZWFyY2ggLVxuICAgdXNhZ2UgOiA8Y3R2LXRzZWFyY2ggcGxhY2Vob2xkZXI9J1NlYXJjaCcgc2l6ZT0nMzAnPjwvY3R2LXRzZWFyY2g+XG4gICBhdHRyaWJ1dGUgZGV0YWlscyA6IHBsYWNlaG9sZGVyIC0gc3BlY2lmeSB0aGUgcGxhY2Vob2xkZXIgZm9yIHRoZSBpbnB1dCB0ZXh0IGZpZWxkXG4gICAgICAgICAgICAgICAgICAgICAgIHNpemUgLSBzcGVjaWZ5IHRoZSBtYXhpbXVtIGxlbmd0aCBvZiB0aGUgc2VhcmNoIHN0cmluZ1xuICAgT25seSBpdGVtcyBtYXRjaGluZyB0aGUgc2VhcmNoIHN0cmluZyBhcmUgZGlzcGxheWVkIGluc2lkZSB0aGUgdGFibGUuXG5cbmQpIGN0dlRwYWdpbmF0aW9uIC1cbiAgIHVzYWdlIDogPGN0di10cGFnaW5hdGlvbj48L2N0di10cGFnaW5hdGlvbj5cbiAgIFByb3ZpZGVzIGxpbmsgZm9yIG1vdmluZyBiYWNrIGFuZCBmb3J0aCBvZiB0aGUgcmVzdWx0IHBhZ2UuXG5cbiAqL1xuYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZUYWJsZVwiLCBbJ2ZpbHRlckZpbHRlcicsICdsaW1pdFRvRmlsdGVyJywgZnVuY3Rpb24gKGZpbHRlckZpbHRlciwgbGltaXRUb0ZpbHRlcikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIGl0ZW1zOiAnPScsXG4gICAgICAgICAgICAgICAgZmlsdGVyZWRpdGVtczogJz0nLFxuICAgICAgICAgICAgICAgIHNpemU6ICdAJyxcbiAgICAgICAgICAgICAgICBkZWZhdWx0c29ydGNvbHVtbjogJ0AnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY29udHJvbGxlcjogWyckc2NvcGUnLCAnJGVsZW1lbnQnLCAnJGF0dHJzJywgJyRmaWx0ZXInLCBmdW5jdGlvbiAoJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCAkZmlsdGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0YWJsZUN0cmwgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuY2h1bmtzID0gW107XG4gICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5wYWdlTm8gPSAwO1xuICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc29ydE9iaiA9IGluaXRpYWxpemVTb3J0KCRzY29wZS5kZWZhdWx0c29ydGNvbHVtbik7XG4gICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zaXplID0gcGFyc2VJbnQoJHNjb3BlLnNpemUsIDEwKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzTmFOKHRhYmxlQ3RybC5zaXplKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNpemUgPSAxMjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICogQWx3YXlzIGNhbGwgc2hvd0NodW5rIHdpdGggYm90aCBwYXJhbWV0ZXJzLlxuICAgICAgICAgICAgICAgICAgICAgKiBAcGFyYW0gcGFnZU5vXG4gICAgICAgICAgICAgICAgICAgICAqIEBwYXJhbSBzZWFyY2hUZXh0XG4gICAgICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gc2hvd0NodW5rKHBhZ2VObywgc2VhcmNoVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNlYXJjaFRleHQgPSBzZWFyY2hUZXh0O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhZ2VObyA9PT0gdW5kZWZpbmVkIHx8IHBhZ2VObyA8IDApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZU5vID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5wYWdlTm8gPSBwYWdlTm87XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLml0ZW1zICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VhcmNoVGV4dEZpbHRlcmVkSXRlbXMgPSBmaWx0ZXJGaWx0ZXIoJHNjb3BlLml0ZW1zLCB0YWJsZUN0cmwuc2VhcmNoVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoVGV4dEZpbHRlcmVkSXRlbXMgPSAkZmlsdGVyKCdvcmRlckJ5Jykoc2VhcmNoVGV4dEZpbHRlcmVkSXRlbXMsIHRhYmxlQ3RybC5zb3J0T2JqLmZpZWxkLCB0YWJsZUN0cmwuc29ydE9iai5yZXZlcnNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbm9PZkNodW5rcyA9IE1hdGguY2VpbChzZWFyY2hUZXh0RmlsdGVyZWRJdGVtcy5sZW5ndGggLyB0YWJsZUN0cmwuc2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vT2ZDaHVua3MgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub09mQ2h1bmtzID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLmNodW5rcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9PZkNodW5rczsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5jaHVua3MucHVzaCh7IHNlbGVjdGVkOiBmYWxzZSwgcGFnZU5vOiBpIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0FmdGVyIGZpbHRlcmluZyBudW1iZXIgb2YgY2h1bmtzIGNvdWxkIGNoYW5nZSBzbyByZXNldCBwYWdlIG5vIGlmIGl0IGlzIGdyZWF0ZXIgdGhhbiBubyBvZiBjaHVua3NcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFnZU5vID49IHRhYmxlQ3RybC5jaHVua3MubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5wYWdlTm8gPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuY2h1bmtzW3RhYmxlQ3RybC5wYWdlTm9dLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1VwZGF0ZSBudW1iZXIgb2YgY2h1bmtzIGZvciBwYWdpbmF0aW9uIG1lbnVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFibGVDdHJsLmNodW5rcy5sZW5ndGggPiA1KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzbGljZVN0YXJ0LCBzbGljZUVuZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xpY2VTdGFydCA9IHRhYmxlQ3RybC5wYWdlTm8gLSAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbGljZUVuZCA9IHRhYmxlQ3RybC5wYWdlTm8gKyAzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2xpY2VTdGFydCA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsaWNlRW5kID0gc2xpY2VFbmQgLSBzbGljZVN0YXJ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xpY2VTdGFydCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNsaWNlRW5kID4gdGFibGVDdHJsLmNodW5rcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsaWNlU3RhcnQgPSBzbGljZVN0YXJ0IC0gKHNsaWNlRW5kIC0gdGFibGVDdHJsLmNodW5rcy5sZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xpY2VFbmQgPSB0YWJsZUN0cmwuY2h1bmtzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGFnaW5hdGlvbk1lbnUuY2h1bmtzID0gdGFibGVDdHJsLmNodW5rcy5zbGljZShzbGljZVN0YXJ0LCBzbGljZUVuZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGFnaW5hdGlvbk1lbnUuY2h1bmtzID0gdGFibGVDdHJsLmNodW5rcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLmZpbHRlcmVkSXRlbXMgPSBsaW1pdFRvRmlsdGVyKHNlYXJjaFRleHRGaWx0ZXJlZEl0ZW1zLCB0YWJsZUN0cmwuc2l6ZSwgdGFibGVDdHJsLnBhZ2VObyAqIHRhYmxlQ3RybC5zaXplKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZmlsdGVyZWRpdGVtcyA9IHRhYmxlQ3RybC5maWx0ZXJlZEl0ZW1zO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNob3dQcmV2Q2h1bmsoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJldkNodW5rO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhYmxlQ3RybC5wYWdlTm8gPD0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZDaHVuayA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2Q2h1bmsgPSB0YWJsZUN0cmwucGFnZU5vIC0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzaG93Q2h1bmsocHJldkNodW5rKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBzaG93TmV4dENodW5rKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5leHRDaHVuaztcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHRDaHVuayA9IHRhYmxlQ3RybC5wYWdlTm8gKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRDaHVuayA+IHRhYmxlQ3RybC5jaHVua3MubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHRDaHVuayA9IHRhYmxlQ3RybC5jaHVua3MubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzaG93Q2h1bmsobmV4dENodW5rKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICogU2F2ZSBwYWdpbmF0aW9uIHNjb3BlIHRvIHByb3ZpZGUgY2h1bmsgaW5mb3JtYXRpb24gdG8gcGFnaW5hdGlvbiBtZW51LlxuICAgICAgICAgICAgICAgICAgICAgKiBAcGFyYW0gbWVudVxuICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYWRkUGFnaW5hdGlvbk1lbnUobWVudSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2luYXRpb25NZW51ID0gbWVudTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBpbml0aWFsaXplU29ydChzb3J0ZmllbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGQ6IHNvcnRmaWVsZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXZlcnNlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpY29uRGlyZWN0aW9uOiB7IFwiYW5nbGUgZG93biBpY29uXCI6IHRydWUsIFwiYW5nbGUgdXAgaWNvblwiOiBmYWxzZSB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNvcnQoc29ydGZpZWxkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc29ydGZpZWxkID09IHRhYmxlQ3RybC5zb3J0T2JqLmZpZWxkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNvcnRPYmouZmllbGQgPSBzb3J0ZmllbGQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNvcnRPYmoucmV2ZXJzZSA9ICF0YWJsZUN0cmwuc29ydE9iai5yZXZlcnNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zb3J0T2JqLmljb25EaXJlY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYW5nbGUgZG93biBpY29uXCI6ICF0YWJsZUN0cmwuc29ydE9iai5yZXZlcnNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFuZ2xlIHVwIGljb25cIjogdGFibGVDdHJsLnNvcnRPYmoucmV2ZXJzZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc29ydE9iaiA9IGluaXRpYWxpemVTb3J0KHNvcnRmaWVsZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc2hvd0NodW5rKHRhYmxlQ3RybC5wYWdlTm8sIHRhYmxlQ3RybC5zZWFyY2hUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc2hvd0NodW5rID0gc2hvd0NodW5rO1xuICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc2hvd05leHRDaHVuayA9IHNob3dOZXh0Q2h1bms7XG4gICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zaG93UHJldkNodW5rID0gc2hvd1ByZXZDaHVuaztcbiAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLmFkZFBhZ2luYXRpb25NZW51ID0gYWRkUGFnaW5hdGlvbk1lbnU7XG4gICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zb3J0ID0gc29ydDtcbiAgICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cnMsIHRhYmxlQ3RybCkge1xuICAgICAgICAgICAgICAgIC8vV2F0Y2ggZm9yIGl0ZW1zIGFzIHRoZXkgd2lsbCBiZSBhdXRvIHJlZnJlc2hlZFxuICAgICAgICAgICAgICAgIHNjb3BlLiRwYXJlbnQuJHdhdGNoKGF0dHJzLml0ZW1zLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zaG93Q2h1bmsodGFibGVDdHJsLnBhZ2VObywgdGFibGVDdHJsLnNlYXJjaFRleHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9kaXJlY3RpdmVzL3RhYmxlLmh0bWwnXG4gICAgICAgIH07XG4gICAgfV0pXG4gICAgLmRpcmVjdGl2ZShcImN0dlRoZWFkXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICB0ZW1wbGF0ZTogJzx0aGVhZCBuZy10cmFuc2NsdWRlPjwvdGhlYWQ+J1xuICAgIH07XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZUaFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgcmVxdWlyZTogJ15eY3R2VGFibGUnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgY2xhc3M6ICdAJyxcbiAgICAgICAgICAgIHNvcnRmaWVsZDogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cnMsIHRhYmxlQ3RybCkge1xuICAgICAgICAgICAgc2NvcGUudGFibGVjdHJsID0gdGFibGVDdHJsO1xuICAgICAgICAgICAgaWYgKHNjb3BlLnNvcnRmaWVsZCAhPSB1bmRlZmluZWQgJiYgc2NvcGUuc29ydGZpZWxkICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc29ydChzY29wZS5zb3J0ZmllbGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy90YWJsZWhlYWRlci5odG1sJ1xuICAgIH07XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZUYm9keVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHt9LFxuICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICB0ZW1wbGF0ZTogJzx0Ym9keSBuZy10cmFuc2NsdWRlPjwvdGJvZHk+J1xuICAgIH07XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZUZm9vdFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHt9LFxuICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICB0ZW1wbGF0ZTogJzx0Zm9vdCBuZy10cmFuc2NsdWRlPjwvdGZvb3Q+J1xuICAgIH07XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZUc2VhcmNoXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICByZXF1aXJlOiAnXl5jdHZUYWJsZScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBwbGFjZWhvbGRlcjogJ0AnLFxuICAgICAgICAgICAgc2l6ZTogJ0AnXG4gICAgICAgIH0sXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0ciwgdGFibGVDdHJsKSB7XG4gICAgICAgICAgICBzY29wZS5zaG93Q2h1bmsgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGFibGVDdHJsLnNob3dDaHVuayh0YWJsZUN0cmwucGFnZU5vLCBzY29wZS5zZWFyY2hUZXh0KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9kaXJlY3RpdmVzL3NlYXJjaGlucHV0Lmh0bWwnXG4gICAgfTtcbn0pXG4gICAgLmRpcmVjdGl2ZShcImN0dlRyXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICB0cmFuc2NsdWRlOiAndHJ1ZScsXG4gICAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICAgIHNjb3BlOiB7fSxcbiAgICAgICAgdGVtcGxhdGU6ICc8dHIgbmctdHJhbnNjbHVkZT48L3RyPidcbiAgICB9O1xufSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2VGRcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXG4gICAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICAgIHNjb3BlOiB0cnVlLFxuICAgICAgICB0ZW1wbGF0ZTogJzx0ZCBuZy10cmFuc2NsdWRlPjwvdGQ+J1xuICAgIH07XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZUcGFnaW5hdGlvblwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgcmVxdWlyZTogJ15eY3R2VGFibGUnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgY29sc3BhbjogJ0AnXG4gICAgICAgIH0sXG4gICAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0ciwgdGFibGVDdHJsKSB7XG4gICAgICAgICAgICB0YWJsZUN0cmwuYWRkUGFnaW5hdGlvbk1lbnUoc2NvcGUpO1xuICAgICAgICAgICAgLy9zaG93Q2h1bmsoKSB3aWxsIGNhbGN1bGF0ZSBhbmQgc2V0IGNodW5rcyBpbiBzY29wZVxuICAgICAgICAgICAgdGFibGVDdHJsLnNob3dDaHVuayh0YWJsZUN0cmwucGFnZU5vLCB0YWJsZUN0cmwuc2VhcmNoVGV4dCk7XG4gICAgICAgICAgICBzY29wZS5zaG93Q2h1bmsgPSBmdW5jdGlvbiAocGFnZU5vKSB7XG4gICAgICAgICAgICAgICAgdGFibGVDdHJsLnNob3dDaHVuayhwYWdlTm8sIHRhYmxlQ3RybC5zZWFyY2hUZXh0KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBzY29wZS5zaG93UHJldkNodW5rID0gdGFibGVDdHJsLnNob3dQcmV2Q2h1bms7XG4gICAgICAgICAgICBzY29wZS5zaG93TmV4dENodW5rID0gdGFibGVDdHJsLnNob3dOZXh0Q2h1bms7XG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9kaXJlY3RpdmVzL3BhZ2luYXRpb25tZW51Lmh0bWwnXG4gICAgfTtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGFibGVkaXJlY3RpdmUuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZBY2l2YWxpZFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvbm9kZXMvYWNpdmFsaWQuaHRtbCcsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIGZvcm06IFwiPVwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7IiwiYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZDb250cm9saW50ZXJmYWNlXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy9ub2Rlcy9jb250cm9saW50ZXJmYWNlLmh0bWwnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBleHRyYXZhcnM6IFwiPVwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7IiwiYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZOZXR3b3JrbW9kZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvbm9kZXMvbmV0d29ya21vZGUuaHRtbCcsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIGV4dHJhdmFyczogXCI9XCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTsiLCJhbmd1bGFyLm1vZHVsZShcImNvbnRpdi5kaXJlY3RpdmVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dlNjaGVkdWxlclwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvbm9kZXMvc2NoZWR1bGVyLmh0bWwnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBleHRyYXZhcnM6IFwiPVwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
