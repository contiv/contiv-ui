<<<<<<< Updated upstream
<<<<<<< HEAD
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}angular.module("contiv.graph",[]),angular.module("contiv.directives",[]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();angular.module("contiv.graph").factory("DataSource",["Node","Link",function(t,e){var n=function(){function n(t,e){_classCallCheck(this,n),this.nodes=t,this.links=e}return _createClass(n,[{key:"updateNodes",value:function(t){this.nodes=t}},{key:"updateLinks",value:function(t){this.links=t}},{key:"nodeIdToName",value:function(t){for(var e=this.nodes,n=0;n<e.length;n++)if(e[n].id==t)return e[n].name}},{key:"processNodeData",value:function(e){var n=[];return _.forEach(e,function(e){var i=new t.Node(null,null,e.id,e.text,null);n.push(i)}),n}},{key:"processLinkData",value:function(t,n){function i(t,e){for(var n=0;n<e.length;n++)if(t==e[n].id)return e[n]}for(var o=[],a=0;a<t.length;a++)if(t[a].source!=t[a].target){var r=i(t[a].source,n),s=i(t[a].target,n);if(null==r||null==s)continue;var l=new e.Link(r,s);o.push(l)}return o}}]),n}();return{DataSource:n}}]),angular.module("contiv.models",[]);var ContivGlobals=function(){return{NETWORKS_ENDPOINT:"/netmaster/api/v1/networks/",NETWORKS_INSPECT_ENDPOINT:"/netmaster/api/v1/inspect/networks/",SERVICELBS_INSPECT_ENDPOINT:"/netmaster/api/v1/inspect/serviceLBs/",POLICIES_ENDPOINT:"/netmaster/api/v1/policys/",RULES_ENDPOINT:"/netmaster/api/v1/rules/",APPLICATIONGROUPS_ENDPOINT:"/netmaster/api/v1/endpointGroups/",SERVICELBS_ENDPOINT:"/netmaster/api/v1/serviceLBs/",ORGANIZATIONS_ENDPOINT:"/netmaster/api/v1/tenants/",NETWORK_SETTINGS_ENDPOINT:"/netmaster/api/v1/globals/",NETPROFILES_ENDPOINT:"/netmaster/api/v1/netprofiles/",BGPS_ENDPOINT:"/netmaster/api/v1/Bgps/",BGPS_INSPECT_ENDPOINT:"/netmaster/api/v1/inspect/Bgps/",VISUALIZATION_ENDPOINT:"/visualization/",VOLUMES_ENDPOINT:"/volmaster/volumes/",VOLUMES_CREATE_ENDPOINT:"/volmaster/volumes/create/",VOLUMES_DELETE_ENDPOINT:"/volmaster/volumes/remove/",VOLUMES_COPYSNAPSHOTS_ENDPOINT:"/volmaster/volumes/copy",VOLUMES_USES_ENDPOINT:"/volmaster/uses/mounts/",VOLUMES_SNAPSHOTS_ENDPOINT:"/volmaster/snapshots/",STORAGEPOLICIES_ENDPOINT:"/volmaster/policies/",VOLUMES_GLOBAL_ENDPOINT:"/volmaster/global/",NODES_LIST_ENDPOINT:"/info/nodes",NODES_DISCOVER_ENDPOINT:"/discover/nodes",NODES_COMMISSION_ENDPOINT:"/commission/nodes",NODES_DECOMMISSION_ENDPOINT:"/decommission/nodes",NODES_MAINTENANCE_ENDPOINT:"/maintenance/nodes",NODES_LAST_JOB_ENDPOINT:"/info/job/last",NODES_ACTIVE_JOB_ENDPOINT:"/info/job/active",NODES_SETTINGS_SET_ENDPOINT:"/globals",NODES_SETTINGS_GET_ENDPOINT:"/info/globals",REFRESH_INTERVAL:5e3,CIDR_REGEX:"^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]).){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(/([0-9]|[1-2][0-9]|3[0-2]))$",VLAN_REGEX:"^([0-9]{1,4}?-[0-9]{1,4}?)$",VXLAN_REGEX:"^([0-9]{1,8}?-[0-9]{1,8}?)$",NUMBER_REGEX:"^[0-9]*$"}}();angular.module("contiv.utils",[]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();angular.module("contiv.graph").factory("VisualizerDataSource",["DataSource","VisualizerNode","VisualizerLink",function(t,e,n){var i=function(t){function i(t,e,n,o,a,r){_classCallCheck(this,i);var s=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t,e));return s.children_struct=n,s.ancestors_struct=o,s.labels=a,s.selectors=r,s}return _inherits(i,t),_createClass(i,[{key:"hasChild",value:function(t){return null!=this.children_struct[t]}},{key:"setAncestors",value:function(){var t=this,e=!1;_.forEach(t.nodes,function(n){n.ancestors=t.ancestors_struct[n.id]||[],_.isEmpty(n.ancestors)===!1?n.parent=n.ancestors[0]:0==_.includes(t.children_struct.topLevel,n.id)&&(n.ancestors.push("client"),t.ancestors_struct[n.id]=["client"],e===!1&&(e=!0,t.children_struct.topLevel.push("client"),t.children_struct.client=[]),t.children_struct.client.push(n.id))})}},{key:"getTopLevelFlow",value:function(){return this.getFlowBetweenSet(this.children_struct.topLevel)}},{key:"getFlowBetweenSet",value:function(t){for(var e=this.nodes,n={},i=0;i<e.length;i++){var o=e[i];if(null===o.ancestors)n[o.id]=o.name;else for(var a=0;a<t.length;a++)if(o.ancestors.indexOf(t[a])>-1){n[o.id]=t[a];break}}for(var r=this.links,s=[],i=0;i<r.length;i++){var l=[];l.source=n[r[i].source]||r[i].source,l.target=n[r[i].target]||r[i].target,l.weight=r[i].weight,s.push(l)}for(var c=[],i=0;i<t.length;i++){var u=[];u.id=t[i],u.text=this.nodeIdToName(t[i])||t[i],u.ancestors=this.ancestors_struct[t[i]]||this.ancestors_struct[u.text]||[],_.isEmpty(u.ancestors)===!1?u.parent=u.ancestors[0]:u.parent=null,c.push(u)}return{nodeData:c,linkData:s}}},{key:"processNodeData",value:function(t){var n=[];return _.forEach(t,function(t){var i=new e.Node(null,null,t.id,t.text,null,t.parent,t.ancestors,null,null);n.push(i)}),n}},{key:"processLinkData",value:function(t,e){function i(t,e){for(var n=0;n<e.length;n++)if(t==e[n].id)return e[n]}for(var o=[],a={},r=0;r<t.length;r++)if(t[r].source!=t[r].target){var s=i(t[r].source,e),l=i(t[r].target,e),c=t[r].weight;if(null==s||null==l)continue;if(void 0===a[s.id+"-"+l.id]){var u=new n.Link(s,l,c);a[s.id+"-"+l.id]=u,o.push(u)}else{var d=a[s.id+"-"+l.id];d.setWeight(d.getRawWeight()+c),d.increaseCount()}}return o}}]),i}(t.DataSource);return{DataSource:i}}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();angular.module("contiv.graph").factory("Graph",["PolicyService",function(t){var e=function(){function e(n,i,o){_classCallCheck(this,e);var a=this;a.nodes=i||[],a.links=o||[],a.defaultNodePolicies=[],a.defaultPathPolicies=[],a.svgPolicy=new t.Policy,a.state={canZoom:!0,canPan:!0,initForce:!1,disableUpdate:!1},a.consts={circleGClass:"conceptG",graphClass:"graph",pathClass:"path",nodeClass:"circle",nodeText:"nodeText",startRadius:50,maxRadius:60,padding:5,displayOffset:60},n.on("mouseover",function(t){a.svgPolicy.mouseover.call(this,t)}).on("dblclick",function(t){a.svgPolicy.dblclick.call(this,t)}).on("contextmenu",function(t){a.svgPolicy.contextmenu.call(this,t)}).on("mouseout",function(t){a.svgPolicy.mouseout.call(this,t)}).on("mousedown",function(t){a.svgPolicy.mousedown.call(this,t)}).on("mouseup",function(t){a.svgPolicy.mouseup.call(this,t)});var r=n.append("svg:defs");r.append("svg:marker").attr("id","end-arrow").attr("viewBox","0 -5 10 10").attr("refX",20).attr("refY",-1).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5"),r.append("svg:marker").attr("id","mark-end-arrow").attr("viewBox","0 -5 10 10").attr("refX",7).attr("markerWidth",3.5).attr("markerHeight",3.5).attr("orient","auto").append("svg:path").attr("d","M0,-5L10,0L0,5"),a.svg=n,a.svgG=n.append("g").classed(a.consts.graphClass,!0);var s=a.svgG;a.paths=s.append("g").selectAll("g"),a.circles=s.append("g").selectAll("g"),a.initNodes(),a.initLinks(),a.setPositions();var l=function(){a.onWindowResize(n)};a.bindings={resize:l},$(window).resize(l)}return _createClass(e,[{key:"destroy",value:function(){var t=this;_(t.defaultNodePolicies).forEach(function(t){t.destroy()}),_(t.defaultPathPolicies).forEach(function(t){t.destroy()}),t.svgPolicy.destroy();for(var e in t.bindings)$(window).off(e,t.bindings[e])}},{key:"initNodes",value:function(){var t=this;_.forEach(t.nodes,function(e){e.initialize(t)})}},{key:"initLinks",value:function(){var t=this;_.forEach(t.links,function(e){e.initialize(t)})}},{key:"findNodeById",value:function(t){for(var e=this,n=0;n<e.nodes.length;n++)if(t===e.nodes[n].id)return e.nodes[n]}},{key:"findD3Node",value:function(t){var e,n=this;return n.circles.each(function(n){n.id===t&&(e=d3.select(this))}),e}},{key:"installDragPolicy",value:function(t){this.drag=t}},{key:"installSvgPolicy",value:function(t){this.svgPolicy=t}},{key:"installDefaultNodePolicy",value:function(t){var e=this;e.defaultNodePolicies.push(t),t.initialize(e)}},{key:"uninstallDefaultNodePolicy",value:function(t){var e;e="string"==typeof t?t:t.policyName,_(thisGraph.defaultNodePolicies).forEach(function(t,n){t.policyName===e&&(t.destroy(),thisGraph.defaultNodePolicies.splice(n,1))})}},{key:"getNodePolicy",value:function(t){var e=this;_(e.defaultNodePolicies).forEach(function(e,n){return e.policyName===t?e:void 0})}},{key:"installDefaultPathPolicy",value:function(t){var e=this;e.defaultPathPolicies.push(t),t.initialize(e)}},{key:"uninstallDefaultPathPolicy",value:function(t){var e,n=this;e="string"==typeof t?t:t.policyName,_(n.defaultPathPolicies).forEach(function(t,i){t.policyName===e&&(t.destroy(),n.defaultPathPolicies.splice(i,1))})}},{key:"pathPolicyEvent",value:function(t,e,n){var i=this;_(i.defaultPathPolicies).forEach(function(i){i[t](e,n)})}},{key:"nodePolicyEvent",value:function(t,e,n){var i=this;_.forEach(i.defaultNodePolicies,function(i){i[t](e,n)})}},{key:"installZoomPolicy",value:function(t){this.dragSvg=t,this.svg.call(this.dragSvg)}},{key:"onWindowResize",value:function(t){}},{key:"insertTitleLinebreaks",value:function(t,e){for(var n=this,i=e.split(/\s+/g),o=i.length,a=t.append("text").attr("class",n.consts.nodeText).attr("text-anchor","middle").attr("dy","-"+7.5*(o-1)),r=0;r<i.length;r++){var s=a.append("tspan").text(i[r]);r>0&&s.attr("x",0).attr("dy","15")}}},{key:"spliceLinksForNode",value:function(t){var e=this,n=e.links.filter(function(e){return e.source===t||e.target===t});n.map(function(t){e.links.splice(e.links.indexOf(t),1)})}},{key:"addNode",value:function(t){var e=this;e.nodes.push(t),t.initialize(e),e.updateGraph()}},{key:"removeNode",value:function(t){var e=this;e.nodes.splice(e.nodes.indexOf(t),1),e.spliceLinksForNode(t),e.updateGraph()}},{key:"addLink",value:function(t){var e=this;e.links.push(t),t.initialize(e),e.updateGraph()}},{key:"removeLink",value:function(t){var e=this;e.links.splice(e.links.indexOf(t),1),t.initialize(e),e.updateGraph()}},{key:"updateExistingPaths",value:function(t){t.each(function(t){t.updateAttr(d3.select(this),t)})}},{key:"updateNewPaths",value:function(t){var e=this;e.initLinks(),t.each(function(t){t.newPathAttr(d3.select(this),t)}),t.on("mouseover",function(t){t.hasPolicy?t.pathPolicyEvent("mouseover",d3.select(this),t):e.pathPolicyEvent("mouseover",d3.select(this),t)}).on("dblclick",function(t){t.hasPolicy?t.pathPolicyEvent("dblclick",d3.select(this),t):e.pathPolicyEvent("dblclick",d3.select(this),t)}).on("contextmenu",function(t){t.hasPolicy?t.pathPolicyEvent("contextmenu",d3.select(this),t):e.pathPolicyEvent("contextmenu",d3.select(this),t)}).on("mouseout",function(t){t.hasPolicy?t.pathPolicyEvent("mouseout",d3.select(this),t):e.pathPolicyEvent("mouseout",d3.select(this),t)}).on("mousedown",function(t){t.hasPolicy?t.pathPolicyEvent("mousedown",d3.select(this),t):e.pathPolicyEvent("mousedown",d3.select(this),t)}).on("mouseup",function(t){t.hasPolicy?t.pathPolicyEvent("mouseup",d3.select(this),t):e.pathPolicyEvent("mouseup",d3.select(this),t)}).call(e.drag)}},{key:"updateExistingNodes",value:function(){var t=this;t.circles=this.circles.data(t.nodes,function(t){return t.id}).each(function(t){t.updateAttr(d3.select(this),t)})}},{key:"updateNewNodes",value:function(t){var e=this;t.each(function(t){null==t.graph&&t.initialize(e),t.newNodeAttr(d3.select(this),t)}),t.on("mouseover",function(t){t.hasPolicy?t.nodePolicyEvent("mouseover",d3.select(this),t):e.nodePolicyEvent("mouseover",d3.select(this),t)}).on("dblclick",function(t){t.hasPolicy?t.nodePolicyEvent("dblclick",d3.select(this),t):e.nodePolicyEvent("dblclick",d3.select(this),t)}).on("contextmenu",function(t){t.hasPolicy?t.nodePolicyEvent("contextmenu",d3.select(this),t):e.nodePolicyEvent("contextmenu",d3.select(this),t)}).on("mouseout",function(t){t.hasPolicy?t.nodePolicyEvent("mouseout",d3.select(this),t):e.nodePolicyEvent("mouseout",d3.select(this),t)}).on("mousedown",function(t){t.hasPolicy?t.nodePolicyEvent("mousedown",d3.select(this),t):e.nodePolicyEvent("mousedown",d3.select(this),t)}).on("mouseup",function(t){t.hasPolicy?t.nodePolicyEvent("mouseup",d3.select(this),t):e.nodePolicyEvent("mouseup",d3.select(this),t)}).call(e.drag),t.append("circle").attr("r",function(t){return String(t.radius)}),t.each(function(t){e.insertTitleLinebreaks(d3.select(this),t.text)})}},{key:"d3ForceCollide",value:function(t){var e=this,n=e.consts,i=e.nodes,o=d3.geom.quadtree(i);return function(e){var i=e.radius+n.maxRadius+n.padding,a=e.x-i,r=e.x+i,s=e.y-i,l=e.y+i;o.visit(function(i,o,c,u,d){if(i.point&&i.point!==e){var p=e.x-i.point.x,f=e.y-i.point.y,h=Math.sqrt(p*p+f*f),v=e.radius+i.point.radius+n.padding;v>h&&(h=(h-v)/h*t,e.x-=p*=h,e.y-=f*=h,i.point.x+=p,i.point.y+=f)}return o>r||a>u||c>l||s>d})}}},{key:"d3ForceTick",value:function(t,e,n){for(var i=this,o=i.consts,a=o.displayOffset,r=i.nodes,s=d3.geom.quadtree(i.nodes),l=0,c=r.length;++l<c;)s.visit(this.d3ForceCollide(r[l]));i.circles.each(this.d3ForceCollide(.5)).attr("cx",function(t){return t.x=Math.max(t.radius+a,Math.min(e-a-t.radius,t.x))}).attr("cy",function(t){return t.y=Math.max(t.radius+a,Math.min(n-a-t.radius,t.y))}),i.paths.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y})}},{key:"d3ForceStart",value:function(){var t=this;t.paths.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y})}},{key:"d3ForceEnd",value:function(){var t=this;t.circles.attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}),t.paths.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y})}},{key:"d3ForceBounds",value:function(){var t=$("#visualization-graph").width(),e=$("#visualization-graph").height(),n=t,i=e;return{width:n,height:i}}},{key:"setForce",value:function(t){var e=this,n=e.nodes,i=e.links;if(!_.isEmpty(n)){var o=e.d3ForceBounds(),a=d3.layout.force().size([o.width,o.height]).nodes(n).charge(function(t){return-6e3}).links(i);a.linkDistance(o.width/3),a.linkStrength(.2),a.gravity(.2),a.on("tick",function(t){e.d3ForceTick.call(e,t,o.width,o.height)}),a.on("start",function(){e.d3ForceStart.call(e)}),a.on("end",function(){e.d3ForceEnd.call(e)}),a.start();for(var r=0;a.alpha()>.01&&150>r;)a.tick(),r+=1;a.stop(),null!=t&&t()}}},{key:"setPositions",value:function(){for(var t=this,e=t.consts.displayOffset,n=$("#visualization-graph").width(),i=$("#visualization-graph").height(),o=n-2*e,a=i-2*e,r=t.nodes,s=0;s<r.length;s++)r[s].radius=r[s].radius||t.consts.startRadius,null!=r[s].x&&null!=r[s].y||(r[s].x=o/2+r[s].radius+e,r[s].y=a/2+r[s].radius+e)}},{key:"updateGraph",value:function(t){var e=this,n=e.consts,i=e.state;if(!e.state.disableUpdate){this.updateExistingNodes();var o=e.circles.enter().append("g");o.classed(n.circleGClass,!0),e.circles.exit().remove(),0==i.initForce?(e.setForce(function(){e.updateNewNodes.call(e,o)}),i.initForce=!0):this.updateNewNodes(o),e.paths=e.paths.data(e.links,function(t){return String(t.source.id)+"+"+String(t.target.id)});var a=e.paths;this.updateExistingPaths(a);var r=a.enter().append("path").style("marker-end","url(#end-arrow)").classed("link",!0);this.updateNewPaths(r),a.exit().remove(),null!=t&&t()}}}]),e}();return{Graph:e}}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();angular.module("contiv.graph").factory("VisualizerGraph",["Graph",function(t){var e=function(t){function e(t,n,i,o){_classCallCheck(this,e);var a=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,i)),r=a;r.state.transition=[],r.consts.edge_buffer=200,r.consts.radiusDecay=1,r.consts.containerClass="container",r.dataSource=o;var s=d3.behavior.drag().origin(function(t){return{x:t.x,y:t.y}}).on("dragstart",function(){}).on("drag",function(t){d3.select(this).attr("transform",function(t,e){return t.x+=d3.event.dx,t.y+=d3.event.dy,"translate("+[t.x,t.y]+")"}),r.updateGraph()}).on("dragend",function(){});r.drag=s;var l=d3.behavior.zoom().on("zoom",function(){return null!=d3.event.sourceEvent&&d3.event.sourceEvent.ctrlKey?!1:(r.zoomed.call(r),!0)}).on("zoomstart",function(t,e){});return r.dragSvg=l,r.svg.call(l).on("dblclick.zoom",null),a}return _inherits(e,t),_createClass(e,[{key:"zoomed",value:function(t,e){var n=this;if(1!=n.state.rightClick){if(this.state.justScaleTransGraph=!0,null!=t&&null!=e){var i=n.dragSvg;i.scale(e),i.translate(t);var o=function(){i.scale(e),i.translate(t)},a="zoom"+t;return void d3.select("."+this.consts.graphClass).transition(a).delay(100).duration(750).attr("transform","translate("+i.translate()+") scale("+i.scale()+")").each("end",o)}n.state.canZoom&&d3.select("."+this.consts.graphClass).attr("transform","translate("+n.dragSvg.translate()+") scale("+n.dragSvg.scale()+")")}}},{key:"onWindowResize",value:function(t){var e=document.getElementsByTagName("body")[0],n=$("#visualization-graph").offset(),i=$("#visualization-graph").width(),o=e.clientHeight;t.attr("width",i).attr("height",o-n.top-20)}},{key:"updateLinkData",value:function(){for(var t=this,e=[],n=0;n<t.nodes.length;n++)e.push(t.nodes[n].id);var i=t.dataSource.getFlowBetweenSet(e),o=i.linkData;t.links=t.dataSource.processLinkData(o,t.nodes),this.initNodes(),this.initLinks(),t.updateGraph()}}]),e}(t.Graph);return{Graph:e}}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();angular.module("contiv.graph").factory("Link",[function(){var t=function(){function t(e,n){_classCallCheck(this,t),this.source=e,this.target=n,this.hasPolicy=!1,this.pathPolicies=[],this.graph=null,this.initialized=!1}return _createClass(t,[{key:"initialize",value:function(t){0==this.initialized&&(this.initialized=!0,this.graph=t)}},{key:"updateAttr",value:function(t,e){t.style("marker-end","url(#end-arrow)").attr("d",arrowPath)}},{key:"newPathAttr",value:function(t,e){t.attr("d",arrowPath)}},{key:"arrowPath",value:function(){var t=this,e=t.target.x-t.source.x,n=t.target.y-t.source.y,i=Math.sqrt(e*e+n*n);return"M"+t.source.x+","+t.source.y+"A"+i+","+i+" 0 0,1 "+t.target.x+","+t.target.y}},{key:"installPathPolicy",value:function(t){this.hasPolicy=!0,this.pathPolicies.push(t),t.initialize(this.graph)}},{key:"uninstallPathPolicy",value:function(t){var e,n=this;e="string"==typeof t?t:t.policyName,_(n.pathPolicies).forEach(function(t,i){t.policyName===e&&(t.destroy(),n.pathPolicies.splice(i,1))}),0===n.pathPolicies.length&&(n.hasPolicy=!1)}},{key:"pathPolicyEvent",value:function(t,e,n){_(n.pathPolicies).forEach(function(i){i[t](e,n)})}}]),t}();return{Link:t}}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),_get=function t(e,n,i){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,n,i)}if("value"in o)return o.value;var r=o.get;if(void 0!==r)return r.call(i)};angular.module("contiv.graph").factory("VisualizerLink",["Link",function(t){var e=function(t){function e(t,n,i){_classCallCheck(this,e);var o=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return o.weight=i,o.count=1,o}return _inherits(e,t),_createClass(e,[{key:"increaseCount",value:function(){this.count+=1}},{key:"qtipHelper",value:function(){var t,e=this,n=(e.target.x-e.source.x)/2,i=(e.target.y-e.source.y)/2;return t=e.source.x<e.target.x?{my:"top center",at:"center center",target:[n,i],adjust:{y:10}}:{my:"bottom center",at:"center center",target:[n,i],adjust:{y:-10}}}},{key:"initialize",value:function(t){if(0==this.initialized){_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"initialize",this).call(this,t);var n=t.state.VisualizerLink;null==n&&(n=t.state.VisualizerLink={},n.maxWeight=null,n.useAvgWeight=!0),this.updateMaxWeight()}}},{key:"setUseAvgWeight",value:function(t){this.graph.state.VisualizerLink.useAvgWeight=!!t}},{key:"setWeight",value:function(t){this.weight=t}},{key:"getRawWeight",value:function(){return this.weight}},{key:"getWeight",value:function(){var t=this.graph,e=t.state.VisualizerLink;if(e.useAvgWeight){var n=this.weight/this.count;return n}return this.weight}},{key:"updateMaxWeight",value:function(){var t=this.graph,e=t.state.VisualizerLink,n=_.maxBy(t.links,function(t){return null!=t.graph?t.getWeight():0});e.maxWeight=n.getWeight()}},{key:"updateAttr",value:function(t,e){var n=this.graph,i=n.state.VisualizerLink;this.updateMaxWeight();var o=d3.scale.linear().domain([0,i.maxWeight]).range(["#ffb366","#F92606"]);i.colorScale=o,t.style("marker-end","url(#end-arrow)").classed(n.consts.selectedClass,function(t){return t===i.selectedEdge}).attr("d",this.arrowPath.call(e)).transition("existingPathTransition").duration(750).attr("stroke",function(t){var e=o(t.getWeight());return e})}},{key:"newPathAttr",value:function(t,e){var n=this.graph,i=n.state.VisualizerLink;this.updateMaxWeight();var o=d3.scale.linear().domain([0,i.maxWeight]).range(["#ffb366","#F92606"]);t.transition("newPathTransition").duration(750).attrTween("opacity",function(t){return d3.interpolateString(0,1)}).attr("stroke",function(t){var e=o(t.getWeight());return e}).attr("d",this.arrowPath.call(e))}}]),e}(t.Link);return{Link:e}}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();angular.module("contiv.graph").factory("Node",[function(){var t=function(){function t(e,n,i,o,a){_classCallCheck(this,t),this.x=e,this.y=n,this.radius=a,this.id=i,this.text=o,this.radius=a,this.hasPolicy=!1,this.policy=null,this.nodePolicies=[],this.graph=null,this.initialized=!1}return _createClass(t,[{key:"initialize",value:function(t){0==this.initialized&&(this.initialized=!0,this.graph=t)}},{key:"updateAttr",value:function(t,e){t.attr("transform",function(t){return"translate("+t.x+","+t.y+")"})}},{key:"newNodeAttr",value:function(t,e){}},{key:"setRadius",value:function(t){this.radius=t}},{key:"installNodePolicy",value:function(t){this.hasPolicy=!0,this.nodePolicies.push(t),t.initialize(this.graph)}},{key:"uninstallNodePolicy",value:function(t){var e,n=this;e="string"==typeof t?t:t.policyName,_(n.nodePolicies).forEach(function(t,i){t.policyName===e&&(t.destroy(),n.nodePolicies.splice(i,1))}),0===n.nodePolicies.length&&(n.hasPolicy=!1)}},{key:"nodePolicyEvent",value:function(t,e,n){_.forEach(this.nodePolicies,function(i){i[t](e,n)})}}]),t}();return{Node:t}}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();angular.module("contiv.graph").factory("VisualizerNode",["Node",function(t){var e=function(t){function e(t,n,i,o,a,r,s,l,c){_classCallCheck(this,e);var u=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,i,o,a));return u.parent=r,u.ancestors=s,null==l?u.xStart=t:u.xStart=l,null==c?u.yStart=n:u.yStart=c,u}return _inherits(e,t),_createClass(e,[{key:"newNodeAttr",value:function(t,e){var n=this.graph;null!=n.consts.containerClass&&null==n.dataSource.children_struct[e.id]&&t.classed(n.consts.containerClass,!0),t.transition("nodePositionTransition").duration(750).attrTween("transform",function(t){if(null!=t.xStart&&null!=t.yStart){var e=t.xStart,n=t.yStart;return t.xStart=t.x,t.yStart=t.y,d3.interpolateString("translate("+e+","+n+")","translate("+t.x+","+t.y+")")}return d3.interpolateString("translate("+t.x+","+t.y+")","translate("+t.x+","+t.y+")")})}}]),e}(t.Node);return{Node:e}}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),_get=function e(t,n,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,i)}if("value"in o)return o.value;
var r=o.get;if(void 0!==r)return r.call(i)};angular.module("contiv.graph").factory("NodeSelectionPolicy",["Policy",function(t){var e=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"NodeSelectionPolicy"))}return _inherits(e,t),_createClass(e,[{key:"initialize",value:function(t){if(!this.initialized){_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"initialize",this).call(this,t);var n=t.state.NodeSelectionPolicy={};n.selectedNodes=[];var i=t.consts.NodeSelectionPolicy={};i.selectedClass="selected";var o=t.drag;o.on("drag",function(e){var n=t;if(null!=n.consts.NodeSelectionPolicy){var i=n.consts.NodeSelectionPolicy.selectedClass,o=d3.selectAll("."+i);-1==o[0].indexOf(this)&&(o.classed(i,!1),o=d3.select(this),o.classed(i,!0)),o.attr("transform",function(t,e){return t.x+=d3.event.dx,t.y+=d3.event.dy,"translate("+[t.x,t.y]+")"}),n.updateGraph()}})}}},{key:"addSelectNode",value:function(t,e){var n=this.graph,i=n.state.NodeSelectionPolicy,o=n.consts.NodeSelectionPolicy;t.classed(o.selectedClass,!0),i.selectedNodes.push(e)}},{key:"removeSelectFromNode",value:function(t,e){var n=this.graph,i=n.state.NodeSelectionPolicy,o=n.consts.NodeSelectionPolicy;n.circles.filter(function(t){return t.id===e.id}).classed(o.selectedClass,!1);var a=i.selectedNodes.indexOf(e);i.selectedNodes.splice(a,1)}},{key:"removeAllSelectedNodes",value:function(){var t=this.graph,e=t.state.NodeSelectionPolicy,n=t.consts.NodeSelectionPolicy;t.circles.classed(n.selectedClass,!1),e.selectedNodes=[]}},{key:"mousedown",value:function(t,e){var n=this.graph,i=n.state.NodeSelectionPolicy;d3.event.stopPropagation(),d3.event.ctrlKey?i.selectedNodes.indexOf(e)>-1?this.removeSelectFromNode(t,e):this.addSelectNode(t,e):-1==i.selectedNodes.indexOf(e)&&this.removeAllSelectedNodes()}},{key:"mouseup",value:function(t,e){var n=this.graph,i=n.state.NodeSelectionPolicy;d3.event.ctrlKey||i.selectedNodes.length<=1&&this.removeSelectFromNode(t,e)}}]),e}(t.Policy);return{Policy:e}}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();angular.module("contiv.graph").factory("PathChangeViewPolicy",["Policy",function(t){var e=function(t){function e(t){_classCallCheck(this,e);var n=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"PathChangeViewPolicy"));return n.$state=t,n}return _inherits(e,t),_createClass(e,[{key:"generateList",value:function(t){var e=this,n=[],i=function o(t,n){for(var i=e.graph.dataSource.children_struct[t],a=0;a<i.length;a++){var r=i[a];if(e.graph.dataSource.hasChild(r)===!0){var s=o(r,n);n.concat(s)}else n.push(r)}};return i(t,n),n}},{key:"viewEdge",value:function(t){var e=[],n=[],i=t.source.id,o=t.target.id;e=this.graph.dataSource.hasChild(i)===!0?this.generateList(i):[i],n=this.graph.dataSource.hasChild(o)===!0?this.generateList(o):[o],this.$state.go("contiv.menu.visualization.edge",{sourceName:i,targetName:o,sourceList:e,targetList:n})}},{key:"mousedown",value:function(t,e){this.viewEdge(e)}}]),e}(t.Policy);return{Policy:e}}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();angular.module("contiv.graph").factory("Policy",[function(){var t=function(){function t(e){_classCallCheck(this,t),this.policyName=e,this.graph=null,this.initialized=!1}return _createClass(t,[{key:"initialize",value:function(t){this.initialized||(this.initialized=!0,this.graph=t)}},{key:"mouseover",value:function(t,e){}},{key:"dblclick",value:function(t,e){}},{key:"contextmenu",value:function(t,e){}},{key:"mouseout",value:function(t,e){}},{key:"mousedown",value:function(t,e){}},{key:"mouseup",value:function(t,e){}},{key:"destroy",value:function(){}}]),t}();return{Policy:t}}]),angular.module("contiv.applicationgroups",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(t){t.state("contiv.menu.applicationgroups",{url:"/applicationgroups","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.applicationgroups.create",{url:"/create",component:"applicationgroupcreate"}).state("contiv.menu.applicationgroups.details",{url:"/details/:key",component:"applicationgroupdetails"}).state("contiv.menu.applicationgroups.edit",{url:"/edit/:key",component:"applicationgroupdetails"}).state("contiv.menu.applicationgroups.list",{url:"/list",component:"applicationGrouplist"})}]),angular.module("contiv.graph").factory("PolicyService",["Policy","QTipPolicy","PathChangeViewPolicy","NodeSelectionPolicy","SplitJoinNodePolicy","SplitJoinViewPolicy","SaveStatePolicy",function(t,e,n,i,o,a,r){return{Policy:t.Policy,QTipPolicy:e.Policy,PathChangeViewPolicy:n.Policy,NodeSelectionPolicy:i.Policy,SplitJoinNodePolicy:o.Policy,SplitJoinViewPolicy:a.Policy,SaveStatePolicy:r.Policy}}]),angular.module("contiv.dashboard",["contiv.models"]).config(["$stateProvider",function(t){t.state("contiv.menu.dashboard",{url:"/dashboard",component:"dashboard"})}]),angular.module("contiv.login",["contiv.utils"]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),_get=function n(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(void 0===o){var a=Object.getPrototypeOf(t);return null===a?void 0:n(a,e,i)}if("value"in o)return o.value;var r=o.get;if(void 0!==r)return r.call(i)};angular.module("contiv.graph").factory("QTipPolicy",["Policy",function(t){var e=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"QTipPolicy"))}return _inherits(e,t),_createClass(e,[{key:"initialize",value:function(t){if(!this.initialized){_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"initialize",this).call(this,t);var n=this,i=t.state.QTipPolicy={};i.mousedown=!1,t.consts.QTipPolicy={},$("#visualization-graph").mouseup(function(t){i.mouseup=!1});var o=t.updateNewNodes;t.updateNewNodes=function(e){o.call(t,e),n.updateNewNodes(e)};var a=t.updateNewPaths;t.updateNewPaths=function(e){a.call(t,e),n.updateNewPaths(e)}}}},{key:"destroy",value:function(){$('[id^="qtip"]').remove()}},{key:"mousedown",value:function(t,e){var n=this.graph,i=n.state.QTipPolicy;i.mousedown=!0}},{key:"mouseup",value:function(t,e){var n=this.graph,i=n.state.QTipPolicy;i.mousedown=!1}},{key:"whenQTipAvailable",value:function(t){var e=this,n=500;window.setTimeout(function(){null!=$(document).qtip?t():window.setTimeout(e.whenQTipAvailable(t),n)},n)}},{key:"updateNewNodes",value:function(t){function e(){t.each(function(t){var e,o=this;if(null!=n.dataSource.children_struct[t.id]){e="<b><u>Selectors:</b></u> ";var a=n.dataSource.selectors[t.id],r=!1;for(var s in a)r=!0,e+=s+" : <i>"+a[s]+"</i>,\n ";r===!1&&(e="No Selectors, ")}else{e="<b><u>Labels:</b></u> ";var l=n.dataSource.labels[t.id],r=!1;for(var s in l)r=!0,e+=s+" : <i>"+l[s]+"</i>,\n ";r===!1&&(e="No labels, ")}e=e.slice(0,-2),$(o).qtip({content:{title:t.id,text:e},events:{show:function(){var e=$(o).qtip("api"),a=$("#graphContainer").offset(),r=[a.left+(t.x*n.dragSvg.scale()+n.dragSvg.translate()[0]),a.top+(t.y+t.radius)*n.dragSvg.scale()+n.dragSvg.translate()[1]];return e.set("position.target",r),!i.mousedown}},show:{delay:0,solo:$("#visualization-graph")},style:{classes:"qtip-blue qtip-shadow"},position:{my:"top center",at:"bottom center"},hide:{event:"mousedown mouseleave"}})})}var n=this.graph,i=n.state.QTipPolicy;void 0!=$(document).qtip?e():this.whenQTipAvailable(e)}},{key:"updateNewPaths",value:function(t){var e=this.graph,n=e.state.QTipPolicy;void 0!=$(document).qtip&&t.each(function(t){var e=this,i=d3.select(this).node(),o=(i.getPointAtLength(i.getTotalLength()/2),t.qtipHelper()),a="Bytes: "+t.getWeight();$(e).qtip({content:{text:a},events:{show:function(){return!n.mousedown}},show:{delay:0,solo:$("#graphContainer")},style:{classes:"qtip-blue qtip-shadow"},position:{my:o.my,at:"center center",target:"mouse",adjust:o.adjust},hide:{event:"mousedown mouseleave"}})})}}]),e}(t.Policy);return{Policy:e}}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();angular.module("contiv.graph").factory("SaveStatePolicy",["Policy",function(t){var e=function(t){function e(t){_classCallCheck(this,e);var n=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"SaveStatePolicy"));return n.savedState=t,n}return _inherits(e,t),_createClass(e,[{key:"initialize",value:function(t){this.graph=t;var e=this;t.destroy=function(){e.graphDestroy.call(t,e.savedState)},t.load=function(n){e.graphLoad.call(t,n)}}},{key:"graphDestroy",value:function(t){var e=this;_(e.defaultNodePolicies).forEach(function(e){e.destroy(t)}),_(e.defaultPathPolicies).forEach(function(e){e.destroy(t)});for(var n in e.bindings)$(window).off(n,e.bindings[n])}},{key:"graphLoad",value:function(t){var e=this;_(e.defaultNodePolicies).forEach(function(e){null!=e.load&&e.load(t)}),_(e.defaultPathPolicies).forEach(function(e){null!=e.load&&e.load(t)})}}]),e}(t.Policy);return{Policy:e}}]),angular.module("contiv.menu",[]),angular.module("contiv.networkpolicies",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(t){t.state("contiv.menu.networkpolicies",{url:"/networkpolicies","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.networkpolicies.isolation",{url:"/isolation","abstract":!0,template:"<ui-view/>"}).state("contiv.menu.networkpolicies.isolation.create",{url:"/create",component:"isolationpolicycreate"}).state("contiv.menu.networkpolicies.isolation.details",{url:"/details/:key",component:"isolationpolicydetails"}).state("contiv.menu.networkpolicies.isolation.edit",{url:"/edit/:key",component:"isolationpolicydetails"}).state("contiv.menu.networkpolicies.bandwidth",{url:"/bandwidth","abstract":!0,template:"<ui-view/>"}).state("contiv.menu.networkpolicies.bandwidth.create",{url:"/create",component:"bandwidthpolicycreate"}).state("contiv.menu.networkpolicies.bandwidth.details",{url:"/details/:key",component:"bandwidthpolicydetails"}).state("contiv.menu.networkpolicies.bandwidth.edit",{url:"/edit/:key",component:"bandwidthpolicydetails"}).state("contiv.menu.networkpolicies.redirection",{url:"/redirection","abstract":!0,template:"<ui-view/>"}).state("contiv.menu.networkpolicies.list",{url:"/list",params:{policyTab:null},component:"networkpoliciestabs"})}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),_get=function i(t,e,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(void 0===o){var a=Object.getPrototypeOf(t);return null===a?void 0:i(a,e,n)}if("value"in o)return o.value;var r=o.get;if(void 0!==r)return r.call(n)};angular.module("contiv.graph").factory("SplitJoinNodePolicy",["NodeSelectionPolicy","VisualizerNode",function(t,e){var n=function(t){function n(){_classCallCheck(this,n);var t=_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.policyName="SplitJoinNodePolicy",t}return _inherits(n,t),_createClass(n,[{key:"initialize",value:function(t){if(!this.initialized){_get(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"initialize",this).call(this,t);var e=t.state.SplitJoinNodePolicy={};e.splitNodes=[]}}},{key:"dblclick",value:function(t,e){var n=this.graph,i=n.state.SplitJoinNodePolicy;d3.event.ctrlKey||(i.selectedNodes.indexOf(e)>-1?this.splitMultipleNodes(i.selectedNodes):(this.removeAllSelectedNodes(),this.splitNode(e)))}},{key:"contextmenu",value:function(t,e){var n=this.graph,i=n.state.NodeSelectionPolicy;if(d3.event.preventDefault(),!d3.event.ctrlKey){var o=i.selectedNodes;if(o.indexOf(e)>-1)for(var a=0;a<o.length;a++)this.joinNode(o[a]);else this.removeAllSelectedNodes(),this.joinNode(e)}}},{key:"__splitNode",value:function(t){var n=this.graph,i=n.state.SplitJoinNodePolicy,o=t.id,a=n.dataSource.children_struct;if(void 0!==a[o]&&!_.isEmpty(a[o])){n.nodes=_.filter(n.nodes,function(e){return e!=t}),n.spliceLinksForNode(t);for(var r=[],s=0;s<n.nodes.length;s++)r.push(n.nodes[s].id);for(var l=[],s=0;s<a[o].length;s++)r.push(a[o][s]),l.push(a[o][s]);var c=n.dataSource.getFlowBetweenSet(r),u=t.x,d=t.y,p=t.ancestors.slice();p.splice(0,0,t.id);for(var f=t.id,h=[],v=t.radius*n.consts.radiusDecay,y=c.nodeData,s=0;s<y.length;s++)if(l.indexOf(y[s].id)>-1){var g=y[s].id,m=y[s].text,P=new e.Node(null,null,g,m,v,f,p,u,d);P.initialize(n),n.nodes.push(P),h.push(P)}return n.links=n.dataSource.processLinkData(c.linkData,n.nodes),n.initNodes(),n.initLinks(),i.splitNodes.push(t.id),h}}},{key:"splitNode",value:function(t){var e=this.__splitNode(t);null!=e&&this.splitNodeEvent(e)}},{key:"splitMultipleNodes",value:function(t){for(var e=(this.graph,[]),n=0;n<t.length;n++){var i=this.__splitNode(t[n]);e=e.concat(i)}this.splitMultipleNodesEvent(i)}},{key:"splitNodeEvent",value:function(t){var e=this.graph;e.setPositions(),e.updateGraph()}},{key:"splitMultipleNodesEvent",value:function(t){var e=this.graph;e.setPositions(),e.updateGraph()}},{key:"__joinNode",value:function(t){var n=this.graph,i=n.state.SplitJoinNodePolicy;if(-1!=n.nodes.indexOf(t)){var o=n.dataSource.children_struct,a=t.id;if(!(o.topLevel.indexOf(a)>-1)){for(var r=[],s=[],l=0;l<n.nodes.length;l++)-1==n.nodes[l].ancestors.indexOf(t.parent)?s.push(n.nodes[l].id):r.push(n.nodes[l]);var c=t.parent;s.push(t.parent);var u=t.radius/n.consts.radiusDecay,d=t.x,p=t.y,f=t.ancestors[1],h=t.ancestors.slice(1),v=new e.Node(d,p,c,c,u,f,h);n.nodes.push(v);for(var y=n.dataSource.getFlowBetweenSet(s),l=0;l<r.length;l++){var g=r[l];n.nodes.splice(n.nodes.indexOf(g),1),n.spliceLinksForNode(g)}return n.links=n.dataSource.processLinkData(y.linkData,n.nodes),n.initNodes(),n.initLinks(),i.splitNodes.splice(i.splitNodes.indexOf(v.id),1),v}}}},{key:"joinNode",value:function(t){var e=this.__joinNode(t);null!=e&&this.joinNodeEvent(e)}},{key:"joinMultipleNode",value:function(t){for(var e=[],n=0;n<t.length;n++){var i=this.__joinNode(t[n]);e.push(i)}this.joinMultipleNodesEvent(e)}},{key:"joinNodeEvent",value:function(t){var e=this.graph;e.updateGraph()}},{key:"joinMultipleNodesEvent",value:function(t){var e=this.graph;e.updateGraph()}}]),n}(t.Policy);return{Policy:n}}]),angular.module("contiv.networks",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(t){t.state("contiv.menu.networks",{url:"/networks","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.networks.list",{url:"/list",component:"networkList"}).state("contiv.menu.networks.details",{url:"/details/:key",component:"networkdetails"}).state("contiv.menu.networks.create",{url:"/create",component:"networkcreate"})}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),_get=function o(t,e,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,e);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:o(a,e,n)}if("value"in i)return i.value;var r=i.get;if(void 0!==r)return r.call(n)};angular.module("contiv.graph").factory("SplitJoinViewPolicy",["SplitJoinNodePolicy","VisualizerNode",function(t,e){var n=function(t){function n(){_classCallCheck(this,n);var t=_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.policyName="SplitJoinViewPolicy",t}return _inherits(n,t),_createClass(n,[{key:"initialize",value:function(t){if(!this.initialized){_get(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"initialize",this).call(this,t);var e=t.state.SplitJoinViewPolicy={};e.savedStates=[],e.eventHistory=[],e.focusGroups=[],e.foci=[],e.zooms={},e.layout={},e.layoutDefault=null,e.zoomDefault=null,e.nodeIdsToReshow=null,e.backButtonElem=null,e.titleElem=null;var i=t.consts.SplitJoinViewPolicy={};i.boundary=.8,t.d3ForceBounds=this.d3ForceBounds,t.d3ForceTick=this.d3ForceTick,t.d3ForceStart=this.d3ForceStart,t.d3ForceEnd=this.d3ForceEnd}}},{key:"installBackButton",value:function(t){var e=this.graph,n=this,i=e.state.SplitJoinViewPolicy;i.backButtonElem=t,i.backButton=function(){i.eventHistory.length>0&&n.undoLastEvent.call(n)}}},{key:"installTitle",value:function(t){var e=this.graph,n=e.state.SplitJoinViewPolicy;n.titleElem=t}},{key:"destroy",value:function(t){null!=t&&this.save(t)}},{key:"save",value:function(t){var e=this.graph,n=e.state.SplitJoinViewPolicy,i=e.nodes,o=e.links,a=null;null!=n.titleElem&&(a=n.titleElem.text());var r=n.focusGroups,s=n.eventHistory,l=n.zooms,c=n.layout,u=n.layoutDefault,d=n.zoomDefault,p={nodes:i,links:o,states:n.savedStates,currTitle:a,focusGroups:r,eventHistory:s,zooms:l,layout:c,layoutDefault:u,zoomDefault:d};t.SplitJoinViewPolicy=p}},{key:"load",value:function(t){var e=this,n=this.graph,i=n.state.SplitJoinViewPolicy;t=t.SplitJoinViewPolicy,i.savedStates=t.states,n.links=t.links,n.nodes=t.nodes;var o=t.currTitle;null!=i.titleElem&&i.titleElem.text(o),i.eventHistory=t.eventHistory,i.focusGroups=t.focusGroups,i.zooms=t.zooms,i.layout=t.layout,i.layoutDefault=t.layoutDefault,i.zoomDefault=t.zoomDefault,null!=i.backButtonElem&&i.eventHistory.length>0&&i.backButtonElem.fadeTo("slow",1);var a=n.dataSource.children_struct;_.forEach(n.nodes,function(t){t.SplitJoinViewPolicy={},_.includes(a[i.focusGroups[0]],t.id)?t.SplitJoinViewPolicy.type="focus":t.SplitJoinViewPolicy.type="connected"});var r;if(0===i.focusGroups.length){r=i.layoutDefault;var s=i.zoomDefault;n.zoomed(s[0],s[1])}else{var s=i.zooms[i.focusGroups];null!=s&&n.zoomed(s[0],s[1]),r=i.layout[i.focusGroups]}_.forEach(n.nodes,function(t){var e=r[t.id];null==e&&console.log(r,t),t.x=e.x,t.y=e.y}),n.state.initForce=!0,n.updateGraph.call(n,function(){e.updateGraphCallback.call(e)})}},{key:"dblclick",value:function(t,e){var i=this.graph,o=i.state.SplitJoinViewPolicy,a=e.id,r=i.dataSource.children_struct;if(void 0!==r[a]&&!_.isEmpty(r[a])){if(o.focusGroups.slice(),0===o.focusGroups.length?o.focusGroups.push(e.id):_.includes(r[o.focusGroups[0]],e.id)?o.focusGroups[0]=e.id:1===o.focusGroups.length?o.focusGroups.push(e.id):_.includes(r[o.focusGroups[1]],e.id)&&(o.focusGroups[1]=e.id),2===o.focusGroups.length&&o.focusGroups[1]===e.id){var s=[e],l=[],c=r[o.focusGroups[0]];_.forEach(i.nodes,function(t){_.includes(c,t.id)&&(l.push(t.id),s.push(t))})}else{var s=[e],l=[];_.forEach(i.links,function(t){t.source===e&&-1==l.indexOf(t.target.id)?(t.target.SplitJoinViewPolicy={},t.target.SplitJoinViewPolicy.type="connected",l.push(t.target.id),s.push(t.target)):t.target===e&&-1==l.indexOf(t.source.id)&&(t.source.SplitJoinViewPolicy={},t.source.SplitJoinViewPolicy.type="connected",l.push(t.source.id),s.push(t.source))})}i.circles.each(function(t){t.id!==e.id&&i.spliceLinksForNode(t)}),i.updateGraph(),i.state.disableUpdate=!0,i.circles.each(function(t){t.id!==e.id?d3.select(this).transition().delay(200).duration(400).style("opacity",0):null!=$(this).qtip&&$(this).qtip("disable",!0)});var u=i.dragSvg.translate(),d=i.dragSvg.scale(),p=parseFloat(i.svg.style("width"))/d/2+u[0],f=parseFloat(i.svg.style("height"))/d/2+u[1];e.xStart=e.x,e.yStart=e.y,e.x=p,e.y=f,t.transition("nodePositionTransition").duration(750).attrTween("transform",function(t){var e=t.xStart,n=t.yStart;return t.xStart=t.x,t.yStart=t.y,d3.interpolateString("translate("+e+","+n+")","translate("+t.x+","+t.y+")")});var h=_get(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"splitNode",this);o.nodeIdsToReshow=l;var v=this;setTimeout(function(){i.nodes=s,h.call(v,e)},750)}}},{key:"updateGraphCallback",value:function(){var t=this.graph,e=t.state.SplitJoinViewPolicy;t.circles.each(function(t){d3.select(this).transition().duration(400).style("opacity",1),d3.select(this).classed("focus",!1),d3.select(this).classed("connected",!1),null!=t.SplitJoinViewPolicy&&("focus"===t.SplitJoinViewPolicy.type?d3.select(this).classed("focus",!0):"connected"===t.SplitJoinViewPolicy.type&&d3.select(this).classed("connected",!0))}),e.nodeIdsToReshow=null,t.updateGraph()}},{key:"setPositions",value:function(){function t(t,e){return Math.floor(Math.random()*(e-t+1))+t}var e=this.graph,n=this,i=e.consts,o=i.displayOffset,a=e.nodes,r=n.d3ForceBounds.call(e);_.forEach(a,function(e){if(null==e.x||null==e.y){var n=t(e.radius+o,r.width-e.radius-o),i=t(e.radius+o,r.height-e.radius-o);e.x=n,e.y=i}})}},{key:"d3ForceStart",value:function(){var t=this;t.circles.attr("cx",function(e){return null!=e.xStart&&(e.xStart=e.xStart*t.dragSvg.scale()+t.dragSvg.translate()[0]),e.x}).attr("cy",function(e){return null!=e.yStart&&(e.yStart=e.yStart*t.dragSvg.scale()+t.dragSvg.translate()[1]),e.y}),t.paths.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y})}},{key:"d3ForceEnd",value:function(){var t=this,e=t.state,n=e.SplitJoinViewPolicy;if(null==n.layoutDefault){var i={};_.forEach(t.nodes,function(t){i[t.id]={x:t.x,y:t.y}}),n.layoutDefault=i;var o=t.dragSvg.scale(),a=t.dragSvg.translate();n.zoomDefault=[a,o]}t.circles.attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}),t.paths.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y})}},{key:"d3ForceTick",value:function(t,e,n){function i(t){return function(i){2===u.length?("focus"===i.SplitJoinViewPolicy.type?i.y+=(u[0]-i.y)*t:i.y+=(u[1]-i.y)*t,i.x+=(e/2-i.x)*t):(i.y+=(n/2-i.y)*t,i.x+=(e/2-i.x)*t)}}var o=this,a=o.state,r=o.consts,s=a.SplitJoinViewPolicy,l=r.displayOffset,c=o.dragSvg.scale(),u=s.foci;o.circles.each(this.d3ForceCollide(.5)).each(i(.2*t.alpha)).attr("cx",function(t){return t.x=Math.max((t.radius+l)/c,Math.min(e+(-l-t.radius)/c,t.x))}).attr("cy",function(t){return null==t.SplitJoinViewPolicy||null==t.SplitJoinViewPolicy?(t.y=Math.max((t.radius+l)/c,Math.min(n+(-l-t.radius)/c,t.y)),t.y):"focus"===t.SplitJoinViewPolicy.type?(t.y=Math.max(t.radius+l,Math.min((n+(-l-t.radius)/c)*r.SplitJoinViewPolicy.boundary,t.y)),t.y):"connected"===t.SplitJoinViewPolicy.type?(t.y=Math.max((n+(l-t.radius)/c)*r.SplitJoinViewPolicy.boundary,Math.min(n+(-l-t.radius)/c,t.y)),t.y):void 0}),o.paths.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y})}},{key:"d3ForceBounds",value:function(){function t(t,n){var i=t*n,o=e.consts.startRadius,a=3.5*o,r=i/(a*a);return r}var e=this,n=e.state,i=e.consts,o=i.SplitJoinViewPolicy,a=n.SplitJoinViewPolicy,r=e.nodes,s=i.displayOffset,l=parseFloat(e.svg.style("width")),c=parseFloat(e.svg.style("height")),u=l,d=c,p=t(u-2*s,d-2*s),f=1;r.length>p?(f=p/r.length,e.zoomed(e.dragSvg.translate(),f),u/=f,d/=f):e.zoomed(e.dragSvg.translate(),f);var h,v=a.focusGroups;if(0===v.length)h=[d/2];else{var y=e.dataSource.children_struct[v[0]];o.boundary=y.length/r.length;var g=d*o.boundary,m=d-g;g<2*e.consts.maxRadius&&(o.boundary=2.5*e.consts.maxRadius/d,g=d*o.boundary,m=d-g),m<2*e.consts.maxRadius&&(o.boundary=1-2.5*e.consts.maxRadius/d,g=d*o.boundary,m=d-g),h=[g/2,g+m/2]}return a.foci=h,{width:u,height:d}}},{key:"splitNodeEvent",value:function(t){var e=this,n=this.graph,i=n.state.SplitJoinViewPolicy,o=n.dataSource.children_struct;_.forEach(t,function(t){t.SplitJoinViewPolicy={},_.includes(o[i.focusGroups[0]],t.id)?t.SplitJoinViewPolicy.type="focus":t.SplitJoinViewPolicy.type="connected"});var a=t[0].parent;if(0!==i.eventHistory.length&&i.eventHistory[i.eventHistory.length-1].id===a?i.eventHistory.pop():i.eventHistory.push({id:a,event:"split"}),null!=i.backButtonElem&&0!==i.eventHistory.length&&i.backButtonElem.fadeTo("slow",1),null!=i.titleElem){var r="";i.focusGroups.length>0&&(r+=i.focusGroups[0]),2===i.focusGroups.length&&(r+=" & "+i.focusGroups[1]),i.titleElem.text(r)}n.state.disableUpdate=!1,e.setLayout()}},{key:"setLayout",value:function(){var t,e=this,n=this.graph,i=n.state.SplitJoinViewPolicy;if(0===i.focusGroups.length){t=i.layoutDefault;var o=i.zoomDefault;n.zoomed(o[0],o[1])}else{var o=i.zooms[i.focusGroups];null!=o&&n.zoomed(o[0],o[1]),t=i.layout[i.focusGroups]}if(null!=t)_.forEach(n.nodes,function(e){var n=t[e.id];null==n&&console.log(t,e),e.x=n.x,e.y=n.y}),n.updateGraph.call(n,function(){e.updateGraphCallback.call(e)});else{n.state.initForce=!1,n.updateGraph(function(){e.updateGraphCallback.call(e)}),i.zooms[i.focusGroups]=[n.dragSvg.translate(),n.dragSvg.scale()];var t={};_.forEach(n.nodes,function(e){t[e.id]={x:e.x,y:e.y}}),i.layout[i.focusGroups]=t}}},{key:"__joinNode",value:function(t){var n=this.graph,i=n.state.SplitJoinNodePolicy,o=n.state.SplitJoinViewPolicy;if(-1!=n.nodes.indexOf(t)){var a=n.dataSource.children_struct,r=t.id;if(!(a.topLevel.indexOf(r)>-1)){for(var s=t.parent,l=[],c=[],u=0;u<n.nodes.length;u++)-1==n.nodes[u].ancestors.indexOf(t.parent)?c.push(n.nodes[u].id):l.push(n.nodes[u]);var d=t.parent;c.push(t.parent);var p=n.dataSource.ancestors_struct,a=n.dataSource.children_struct,f=o.focusGroups.indexOf(s);null!=p[s]?o.focusGroups[f]=p[s]:o.focusGroups.splice(f,1);var h=[];if(1===o.focusGroups.length){var v=p[t.id];v.push(o.focusGroups[0]),v=v.concat(p[o.focusGroups[0]]||[]),_.forEach(a.topLevel,function(t){-1===v.indexOf(t)&&-1==c.indexOf(t)&&h.push(t)}),c=c.concat(h)}else 0===o.focusGroups.length&&(_.forEach(a.topLevel,function(t){-1==c.indexOf(t)&&h.push(t)}),c=c.concat(h));var y=t.radius/n.consts.radiusDecay,g=t.x,m=t.y,s=t.ancestors[1],v=t.ancestors.slice(1),P=new e.Node(g,m,d,d,y,s,v);n.nodes.push(P);for(var u=0;u<l.length;u++){var w=l[u];n.nodes.splice(n.nodes.indexOf(w),1),n.spliceLinksForNode(w)}for(var b=n.dataSource.getFlowBetweenSet(c),k=[],S=b.nodeData,u=0;u<S.length;u++)-1!==h.indexOf(S[u].id)&&k.push(S[u]);var N=n.dataSource.processNodeData(k);_.forEach(N,function(t){t.radius=t.radius||n.consts.startRadius}),n.nodes=n.nodes.concat(N),n.links=n.dataSource.processLinkData(b.linkData,n.nodes),1===o.focusGroups.length?_.forEach(n.links,function(t){-1!==h.indexOf(t.source.id)?o.focusGroups[0]===t.target.parent&&h.splice(h.indexOf(t.source.id),1):-1!==h.indexOf(t.target.id)&&o.focusGroups[0]===t.source.parent&&h.splice(h.indexOf(t.target.id),1)}):h=[];var E=[];if(0!==h.length)for(var u=0;u<n.nodes.length&&(-1===h.indexOf(n.nodes[u].id)||(h.splice(h.indexOf(n.nodes[u].id),1),n.spliceLinksForNode(n.nodes[u]),E.push(n.nodes[u]),0!==h.length));u++);return _.forEach(E,function(t){n.nodes.splice(n.nodes.indexOf(t),1)}),n.initNodes(),n.initLinks(),i.splitNodes.splice(i.splitNodes.indexOf(P.id),1),P}}}},{key:"joinNodeEvent",value:function(t){var e=this.graph,n=this,i=e.state.SplitJoinViewPolicy;0!==i.eventHistory.length&&i.eventHistory[i.eventHistory.length-1].id===t.id?i.eventHistory.pop():i.eventHistory.push({id:t.id,event:"join"});var o=e.dataSource.children_struct;if(_.forEach(e.nodes,function(t){t.SplitJoinViewPolicy={},_.includes(o[i.focusGroups[0]],t.id)?t.SplitJoinViewPolicy.type="focus":t.SplitJoinViewPolicy.type="connected"}),null!=i.backButtonElem&&0===i.eventHistory.length&&i.backButtonElem.fadeTo("slow",0),null!=i.titleElem){var a="";i.focusGroups.length>0&&(a+=i.focusGroups[0]),2===i.focusGroups.length&&(a+=" & "+i.focusGroups[1]),i.titleElem.text(a)}n.setLayout()}},{key:"undoLastEvent",value:function(){var t,e=this.graph,i=this,o=e.state.SplitJoinViewPolicy,a=o.eventHistory[o.eventHistory.length-1],r=a.id;if("join"===a.event){t=e.findNodeById(r);var s=e.findD3Node(r);i.dblclick(s,t)}else{var l=e.dataSource.children_struct[r][0];t=e.findNodeById(l),_get(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"joinNode",this).call(i,t)}}}]),n}(t.Policy);return{Policy:n}}]),angular.module("contiv.organizations",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(t){t.state("contiv.menu.organizations",{url:"/organizations","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.organizations.list",{url:"/list",component:"organizationlist"})}]),angular.module("contiv.servicelbs",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(t){t.state("contiv.menu.servicelbs",{url:"/servicelbs","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.servicelbs.list",{url:"/list",component:"servicelbList"}).state("contiv.menu.servicelbs.create",{url:"/create",component:"servicelbCreate"}).state("contiv.menu.servicelbs.details",{url:"/details/:key",component:"servicelbDetails"})}]),angular.module("contiv.settings",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(t){t.state("contiv.menu.settings",{url:"/global","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.settings.details",{url:"/settings",templateUrl:"settings/settingsmenu.html"}).state("contiv.menu.settings.details.logs",{url:"/logs",controller:"",templateUrl:""}).state("contiv.menu.settings.details.auth",{url:"/auth",controller:"",templateUrl:""}).state("contiv.menu.settings.details.license",{url:"/license",controller:"",templateUrl:""}).state("contiv.menu.settings.details.policies",{url:"/policies",controller:"",templateUrl:""}).state("contiv.menu.settings.details.networks",{url:"/networks",component:"networksetting"}).state("contiv.menu.settings.details.volumes",{url:"/volumes",component:"volumesetting"}).state("contiv.menu.settings.details.cluster",{url:"/cluster",component:"clustersettings"})}]),angular.module("contiv.visualization",["contiv.models","contiv.directives","contiv.utils","contiv.graph"]).config(["$stateProvider",function(t){t.state("contiv.menu.visualization",{url:"/visualization","abstract":!0,template:'<div ui-view class="ui container"/>'})}]),angular.module("contivApp",["ui.router","contiv.login","contiv.menu","contiv.dashboard","contiv.applicationgroups","contiv.networks","contiv.networkpolicies","contiv.servicelbs","contiv.organizations","contiv.settings","contiv.visualization"]).config(["$stateProvider","$urlRouterProvider",function(t,e){t.state("contiv",{url:"","abstract":!0,template:'<div ui-view class="ui fluid container"/>'}),e.otherwise("/")}]),angular.module("contiv.login").config(["$stateProvider",function(t){t.state("contiv.login",{url:"/",templateUrl:"login/login.html",controller:"LoginCtrl as loginCtrl"})}]).controller("LoginCtrl",["$state","CRUDHelperService",function(t,e){function n(){t.go("contiv.menu.dashboard",{username:o.username})}function i(){n()}var o=this;e.stopLoader(o),e.hideServerError(o),o.login=i}]),angular.module("contiv.menu").config(["$stateProvider",function(t){t.state("contiv.menu",{url:"/m",templateUrl:"menu/menu.html",controller:"MenuCtrl as menuCtrl",params:{username:null}})}]).controller("MenuCtrl",["$state","$stateParams",function(t,e){function n(){t.go("contiv.login")}var i=this;i.username=e.username,i.logout=n}]),angular.module("contiv.organizations").config(["$stateProvider",function(t){t.state("contiv.menu.organizations.create",{
url:"/create",templateUrl:"organizations/organizationcreate.html",controller:"OrganizationCreateCtrl as organizationCreateCtrl"})}]).controller("OrganizationCreateCtrl",["$state","OrganizationsModel","CRUDHelperService",function(t,e,n){function i(){t.go("contiv.menu.organizations.list")}function o(){i()}function a(){s.form.$valid&&(n.hideServerError(s),n.startLoader(s),s.newOrganization.key=s.newOrganization.tenantName,e.create(s.newOrganization).then(function(t){n.stopLoader(s),i()},function(t){n.stopLoader(s),n.showServerError(s,t)}))}function r(){n.stopLoader(s),n.hideServerError(s),s.newOrganization={tenantName:""}}var s=this;s.createOrganization=a,s.cancelCreating=o,r()}]),angular.module("contiv.organizations").config(["$stateProvider",function(t){t.state("contiv.menu.organizations.details",{url:"/details/:key",controller:"OrganizationDetailsCtrl as organizationDetailsCtrl",templateUrl:"organizations/organizationdetails.html"})}]).controller("OrganizationDetailsCtrl",["$state","$stateParams","OrganizationsModel","CRUDHelperService",function(t,e,n,i){function o(){t.go("contiv.menu.organizations.list")}function a(){i.hideServerError(r),i.startLoader(r),n["delete"](r.organization).then(function(t){i.stopLoader(r),o()},function(t){i.stopLoader(r),i.showServerError(r,t)})}var r=this;i.stopLoader(r),i.hideServerError(r),n.getModelByKey(e.key).then(function(t){r.organization=t}),r.deleteOrganization=a}]),angular.module("contiv.visualization").config(["$stateProvider",function(t){t.state("contiv.menu.visualization.edge",{url:"/edge/{sourceName, targetName, sourceList, targetList}",params:{sourceName:null,targetName:null,sourceList:null,targetList:null},controller:"VisualizationEdgeCtrl as visualizationedgeCtrl",templateUrl:"visualization/visualizationedge.html"})}]).controller("VisualizationEdgeCtrl",["$scope","$http","$state","$stateParams","VisualizationService","$interval",function(t,e,n,i,o,a){var r=i.sourceName,s=i.targetName,l=i.sourceList,c=i.targetList;if(null==l||null==c)return void n.go("contiv.menu.visualization.list");var u=new Date,d=u.getSeconds();t.edgeDataInterval=a(function(){o.getEdgeData(l,c,d.toString()).then(function(e){var n=e.results,i=0;_.forEach(n,function(t){_.isEmpty(t)===!1&&(i+=t.series[0].values[0][1])}),t.sourceName=r,t.targetName=s,t.edgeData=i,t.edgeDataTime=d},function(t){})},3e3),t.$on("$destroy",function(){a.cancel(t.edgeDataInterval)}),o.getOldEdgeData(l,c).then(function(e){var n=e.results,i=[];_.forEach(n,function(t){if(_.isEmpty(t)===!1){var e=t.series[0].values;_.isEmpty(i)?_.forEach(e,function(t){i.push(t[1])}):_.forEach(e,function(t,e){i[e]+=t[1]})}}),t.sourceName=r,t.targetName=s,t.sourceList=l,t.targetList=c,t.oldEdgeData=i},function(t){})}]),angular.module("contiv.visualization").directive("visualizationEdge",["$window",function(t){function e(t,e){function n(){l=new Date;for(var e in c){var i=c[e];i.data.push(t.edgeData||0),i.path.attr("d",p)}u.domain([l-(r-2)*s,l-s]),y.transition().duration(s).ease("linear").call(u.axis),h.transition().duration(s).ease("linear").call(d.axis),g.attr("transform",null).transition().duration(s).ease("linear").attr("transform","translate("+u(l-(r-1)*s)+")").each("end",function(){n()});for(var e in c){var i=c[e];i.data.shift()}}var i=document.getElementsByTagName("body")[0],o=i.clientWidth-400,a=i.clientHeight-400,r=59,s=750,l=new Date(Date.now()-s),c={current:{value:0,color:"orange",data:e.range(r).map(function(e){return t.oldEdgeData[Math.floor(e/10)]||0})}},u=e.time.scale().domain([l-(r-2),l-s]).range([0,o]),d=e.scale.linear().domain([0,e.max(c.current.data,function(t){return t+10})]).range([a,0]),p=e.svg.line().interpolate("basis").x(function(t,e){return u(l-(r-1-e)*s)}).y(function(t){return d(t)}),f=e.select(".graph").append("svg").attr("width",25).style("overflow","visible").style("position","fixed"),h=f.append("g").attr("class","y axis").call(d.axis=e.svg.axis().scale(d).orient("left")),v=e.select(".graph").append("svg").attr("class","chart").attr("width",o-50).attr("height",a+50),y=v.append("g").attr("class","x axis").attr("transform","translate(0,"+a+")").call(u.axis=e.svg.axis().scale(u).orient("bottom")),g=v.append("g");for(var m in c){var P=c[m];P.path=g.append("path").data([P.data]).attr("class",m+" group").style("stroke",P.color)}n()}return{restrict:"EA",replace:!1,templateUrl:"visualization/visualizationedgetemplate.html",link:function(n){n.$watchGroup(["edgeData","oldEdgeData"],function(){if(null!=n.edgeData&&null!=n.oldEdgeData&&!n.initialize){n.initialize=!0;var i=t.d3;e(n,i)}})}}}]),angular.module("contiv.visualization").service("StateSave",function(){this.savedStates={}}).directive("visualizationGraph",["$window","$state","VisualizerGraph","PolicyService","VisualizerDataSource","StateSave",function(t,e,n,i,o,a){function r(t,n,i,o,a,r){if(void 0!==t.nodes&&void 0!==t.links&&void 0!==t.children_struct&&void 0!==t.ancestors_struct){var s=new a.DataSource(t.nodes,t.links,t.children_struct,t.ancestors_struct,t.labels,t.serviceSelectors);s.setAncestors();var l,c,u=s.getTopLevelFlow();l=s.processNodeData(u.nodeData),c=s.processLinkData(u.linkData,l);var d=document.getElementsByTagName("body")[0],p=(d.clientWidth,d.clientHeight),f=n.find("svg"),h=$(f.parent()).offset(),v=$(f.parent()).width(),y=d3.select(f[0]).attr("width",v).attr("height",p-h.top-20);t.visualizationGraph=new i.Graph(y,l,c,s,t.children_struct,t.ancestors_struct),t.visualizationGraph.installDefaultPathPolicy(new o.SaveStatePolicy(r.savedStates)),t.visualizationGraph.installDefaultPathPolicy(new o.PathChangeViewPolicy(e));var g=new o.QTipPolicy;t.visualizationGraph.installDefaultNodePolicy(g),t.visualizationGraph.installDefaultPathPolicy(g);var m=new o.SplitJoinViewPolicy;if(t.visualizationGraph.installDefaultNodePolicy(m),m.installBackButton($("#backButton")),m.installTitle($("#graph-title")),0==_.isEmpty(r.savedStates)){var P=t.visualizationGraph;P.load(r.savedStates)}else t.visualizationGraph.updateGraph()}}return{restrict:"EA",replace:!1,templateUrl:"visualization/visualizationtemplate.html",link:function(t,e){t.$on("$destroy",function(){$("#visualization-graph").unbind(),t.visualizationGraph.destroy()}),t.$watchGroup(["nodes","links","children_struct","ancestors_struct"],function(){null!=t.nodes&&null!=t.links&&null!=t.children_struct&&null!=t.ancestors_struct&&(t.initialized?(t.visualizationGraph.dataSource.links=t.links,t.visualizationGraph.updateLinkData()):(t.initialized=!0,r(t,e,n,i,o,a)))})}}}]),angular.module("contiv.visualization").config(["$stateProvider",function(t){t.state("contiv.menu.visualization.list",{url:"/list",controller:"VisualizationListCtrl as visualizationListCtrl",templateUrl:"visualization/visualizationlist.html"})}]).controller("VisualizationListCtrl",["$scope","$http","VisualizationService","$interval",function(t,e,n,i){var o=function(e){var n=[],i=[],o=[];_.forEach(e.results[0].series,function(t){var e,a=t.tags.EndpointIP,r=t.tags.ProviderIP;0==_.includes(o,a)&&(e={name:a,id:a,parent:null,ancestors:null},n.push(e),o.push(a)),0==_.includes(o,r)&&(e={name:r,id:r,parent:null,ancestors:null},n.push(e),o.push(r));var s={source:a,target:r,weight:t.values[0][2]};i.push(s);var l={source:r,target:a,weight:t.values[0][1]};i.push(l)}),t.nodes=n,t.links=i};n.getGraphData().then(o,function(t){}),t.$on("$destroy",function(){i.cancel(t.graphDataInterval)}),n.getStructureData().then(function(e){t.ancestors_struct=e.ancestors_struct,t.children_struct=e.children_struct,t.labels=e.labels,t.serviceSelectors=e.serviceSelectors},function(t){})}]),angular.module("contiv.visualization").factory("VisualizationService",["$http","$q",function(t,e){function n(n,i){var o=e.defer();return t.get(n,i).then(function(t){o.resolve(t.data)},function(t){o.reject(t.data)}),o.promise}function i(n,i){var o=function(t){var e,n,i,a,r,s,l,c="";for(e in t)if(n=t[e],n instanceof Array)for(l=0;l<n.length;++l)r=n[l],i=e+"["+l+"]",s={},s[i]=r,c+=o(s)+"&";else if(n instanceof Object)for(a in n)r=n[a],i=e+"["+a+"]",s={},s[i]=r,c+=o(s)+"&";else void 0!==n&&null!==n&&(c+=encodeURIComponent(e)+"="+encodeURIComponent(n)+"&");return c.length?c.substr(0,c.length-1):c},a=e.defer();return t({url:n,method:"POST",data:i,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(t){return angular.isObject(t)&&"[object File]"!==String(t)?o(t):t}]}).then(function(t){a.resolve(t.data)},function(t){a.reject(t.data)}),a.promise}function o(){var t=ContivGlobals.VISUALIZATION_ENDPOINT;t+="influx/query";var e={params:{db:"telegraf",q:"SELECT BytesIn, BytesOut, EndpointIP, ProviderIP FROM httpjson_svcstats WHERE time > now() - 1m GROUP BY * LIMIT 1"}};return n(t,e)}function a(){var t=ContivGlobals.VISUALIZATION_ENDPOINT;return t+="services",n(t)}function r(t,e){var n="(";n+=e+"=",n+="'"+t[0]+"' ";for(var i=1;i<t.length;i++)n+="OR ",n+=e+"=",n+="'"+t[i]+"' ";return n+=")"}function s(t,e,n){var o=ContivGlobals.VISUALIZATION_ENDPOINT;o+="influx/query";var a={db:"telegraf",q:"SELECT sum(BytesOut) from httpjson_svcstats WHERE time > now() - 15s AND "+r(t,"EndpointIP")+" AND "+r(e,"ProviderIP")+"GROUP BY time(20s) LIMIT 1; SELECT sum(BytesIn) from httpjson_svcstats WHERE time > now() - 15s AND "+r(t,"ProviderIP")+" AND "+r(e,"EndpointIP")+"GROUP BY time(20s) fill(0) LIMIT 1"};return i(o,a)}function l(t,e){var n=ContivGlobals.VISUALIZATION_ENDPOINT;n+="influx/query";var o={db:"telegraf",q:"SELECT sum(BytesOut) FROM httpjson_svcstats WHERE time > now() - 1m AND "+r(t,"EndpointIP")+" AND "+r(e,"ProviderIP")+" GROUP BY time(10s) fill(0) LIMIT 6; SELECT sum(BytesIn) FROM httpjson_svcstats WHERE time > now() - 1m AND "+r(t,"ProviderIP")+" AND "+r(e,"EndpointIP")+" GROUP BY time(10s) fill(0) LIMIT 6"};return i(n,o)}return{getGraphData:o,getStructureData:a,getEdgeData:s,getOldEdgeData:l}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9idW5kbGUuanMiLCJtb2R1bGUuanMiLCJkaXJlY3RpdmVzL21vZHVsZS5qcyIsImRhdGFzb3VyY2UvZGF0YXNvdXJjZS5qcyIsIm1vZGVscy9tb2R1bGUuanMiLCJ1dGlscy9tb2R1bGUuanMiLCJkYXRhc291cmNlL3Zpc3VhbGl6ZXJkYXRhc291cmNlLmpzIiwiZ3JhcGgvZ3JhcGguanMiLCJncmFwaC92aXN1YWxpemVyZ3JhcGguanMiLCJsaW5rL2xpbmsuanMiLCJsaW5rL3Zpc3VhbGl6ZXJsaW5rLmpzIiwibm9kZS9ub2RlLmpzIiwibm9kZS92aXN1YWxpemVybm9kZS5qcyIsInBvbGljeS9ub2Rlc2VsZWN0aW9ucG9saWN5LmpzIiwicG9saWN5L3BhdGhjaGFuZ2V2aWV3cG9saWN5LmpzIiwicG9saWN5L3BvbGljeS5qcyIsImFwcGxpY2F0aW9uZ3JvdXBzL21vZHVsZS5qcyIsInBvbGljeS9wb2xpY3lzZXJ2aWNlLmpzIiwiZGFzaGJvYXJkL21vZHVsZS5qcyIsImxvZ2luL21vZHVsZS5qcyIsInBvbGljeS9xdGlwcG9saWN5LmpzIiwicG9saWN5L3NhdmVzdGF0ZXBvbGljeS5qcyIsIm1lbnUvbW9kdWxlLmpzIiwibmV0d29ya19wb2xpY2llcy9tb2R1bGUuanMiLCJwb2xpY3kvc3BsaXRqb2lubm9kZXBvbGljeS5qcyIsIm5ldHdvcmtzL21vZHVsZS5qcyIsInBvbGljeS9zcGxpdGpvaW52aWV3cG9saWN5LmpzIiwib3JnYW5pemF0aW9ucy9tb2R1bGUuanMiLCJzZXJ2aWNlX2xicy9tb2R1bGUuanMiLCJzZXR0aW5ncy9tb2R1bGUuanMiLCJ2aXN1YWxpemF0aW9uL21vZHVsZS5qcyIsImFwcC5qcyIsImxvZ2luL2xvZ2luY3RybC5qcyIsIm1lbnUvbWVudUN0cmwuanMiLCJvcmdhbml6YXRpb25zL29yZ2FuaXphdGlvbmNyZWF0ZWN0cmwuanMiLCJvcmdhbml6YXRpb25zL29yZ2FuaXphdGlvbmRldGFpbHNjdHJsLmpzIiwidmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9uZWRnZWN0cmwuanMiLCJ2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb25lZGdlZGlyZWN0aXZlLmpzIiwidmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9uZ3JhcGhkaXJlY3RpdmUuanMiLCJ2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb25saXN0Y3RybC5qcyIsInZpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbnNlcnZpY2UuanMiXSwibmFtZXMiOlsiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIlR5cGVFcnJvciIsIl9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIiwic2VsZiIsImNhbGwiLCJSZWZlcmVuY2VFcnJvciIsIl9pbmhlcml0cyIsInN1YkNsYXNzIiwic3VwZXJDbGFzcyIsInByb3RvdHlwZSIsIk9iamVjdCIsImNyZWF0ZSIsImNvbnN0cnVjdG9yIiwidmFsdWUiLCJlbnVtZXJhYmxlIiwid3JpdGFibGUiLCJjb25maWd1cmFibGUiLCJzZXRQcm90b3R5cGVPZiIsIl9fcHJvdG9fXyIsImFuZ3VsYXIiLCJtb2R1bGUiLCJfY3JlYXRlQ2xhc3MiLCJkZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJpIiwibGVuZ3RoIiwiZGVzY3JpcHRvciIsImRlZmluZVByb3BlcnR5Iiwia2V5IiwicHJvdG9Qcm9wcyIsInN0YXRpY1Byb3BzIiwiZmFjdG9yeSIsIk5vZGUiLCJMaW5rIiwiRGF0YVNvdXJjZSIsIm5vZGVzIiwibGlua3MiLCJ0aGlzIiwiaWQiLCJuYW1lIiwibm9kZURhdGEiLCJfIiwiZm9yRWFjaCIsImRhdGEiLCJuZXdOb2RlIiwidGV4dCIsInB1c2giLCJsaW5rRGF0YSIsImZpbmROb2RlQnlJZCIsInNvdXJjZSIsImxpbmsiLCJDb250aXZHbG9iYWxzIiwiTkVUV09SS1NfRU5EUE9JTlQiLCJORVRXT1JLU19JTlNQRUNUX0VORFBPSU5UIiwiU0VSVklDRUxCU19JTlNQRUNUX0VORFBPSU5UIiwiUE9MSUNJRVNfRU5EUE9JTlQiLCJSVUxFU19FTkRQT0lOVCIsIkFQUExJQ0FUSU9OR1JPVVBTX0VORFBPSU5UIiwiU0VSVklDRUxCU19FTkRQT0lOVCIsIk9SR0FOSVpBVElPTlNfRU5EUE9JTlQiLCJORVRXT1JLX1NFVFRJTkdTX0VORFBPSU5UIiwiTkVUUFJPRklMRVNfRU5EUE9JTlQiLCJCR1BTX0VORFBPSU5UIiwiQkdQU19JTlNQRUNUX0VORFBPSU5UIiwiVklTVUFMSVpBVElPTl9FTkRQT0lOVCIsIlZPTFVNRVNfRU5EUE9JTlQiLCJWT0xVTUVTX0NSRUFURV9FTkRQT0lOVCIsIlZPTFVNRVNfREVMRVRFX0VORFBPSU5UIiwiVk9MVU1FU19DT1BZU05BUFNIT1RTX0VORFBPSU5UIiwiVk9MVU1FU19VU0VTX0VORFBPSU5UIiwiVk9MVU1FU19TTkFQU0hPVFNfRU5EUE9JTlQiLCJTVE9SQUdFUE9MSUNJRVNfRU5EUE9JTlQiLCJWT0xVTUVTX0dMT0JBTF9FTkRQT0lOVCIsIk5PREVTX0xJU1RfRU5EUE9JTlQiLCJOT0RFU19ESVNDT1ZFUl9FTkRQT0lOVCIsIk5PREVTX0NPTU1JU1NJT05fRU5EUE9JTlQiLCJOT0RFU19ERUNPTU1JU1NJT05fRU5EUE9JTlQiLCJOT0RFU19NQUlOVEVOQU5DRV9FTkRQT0lOVCIsIk5PREVTX0xBU1RfSk9CX0VORFBPSU5UIiwiTk9ERVNfQUNUSVZFX0pPQl9FTkRQT0lOVCIsIk5PREVTX1NFVFRJTkdTX1NFVF9FTkRQT0lOVCIsIk5PREVTX1NFVFRJTkdTX0dFVF9FTkRQT0lOVCIsIlJFRlJFU0hfSU5URVJWQUwiLCJDSURSX1JFR0VYIiwiVkxBTl9SRUdFWCIsIlZYTEFOX1JFR0VYIiwiTlVNQkVSX1JFR0VYIiwiVmlzdWFsaXplck5vZGUiLCJWaXN1YWxpemVyTGluayIsIlZpc3VhbGl6ZXJEYXRhU291cmNlIiwiX0RhdGFTb3VyY2UkRGF0YVNvdXJjIiwiY2hpbGRyZW5fc3RydWN0IiwiYW5jZXN0b3JzX3N0cnVjdCIsImxhYmVscyIsInNlbGVjdG9ycyIsIl90aGlzIiwiZ2V0UHJvdG90eXBlT2YiLCJ0aGlzRGF0YVNvdXJjZSIsImFkZGVkQ2xpZW50Iiwibm9kZSIsImFuY2VzdG9ycyIsImlzRW1wdHkiLCJwYXJlbnQiLCJpbmNsdWRlcyIsInRvcExldmVsIiwiZ2V0Rmxvd0JldHdlZW5TZXQiLCJub2RlX25hbWVzIiwibG9jYWxfbm9kZXMiLCJpZE1hcHBpbmciLCJqIiwiaW5kZXhPZiIsIndlaWdodCIsIm5vZGVfdG9fYWRkIiwibm9kZUlkVG9OYW1lIiwiYWRkZWRfbGlua3MiLCJ1bmRlZmluZWQiLCJleGlzdGluZ19saW5rIiwic2V0V2VpZ2h0IiwiZ2V0UmF3V2VpZ2h0IiwiaW5jcmVhc2VDb3VudCIsIlBvbGljeVNlcnZpY2UiLCJHcmFwaCIsInN2ZyIsInRoaXNHcmFwaCIsImRlZmF1bHROb2RlUG9saWNpZXMiLCJkZWZhdWx0UGF0aFBvbGljaWVzIiwic3ZnUG9saWN5IiwiUG9saWN5Iiwic3RhdGUiLCJjYW5ab29tIiwiY2FuUGFuIiwiaW5pdEZvcmNlIiwiZGlzYWJsZVVwZGF0ZSIsImNvbnN0cyIsImNpcmNsZUdDbGFzcyIsImdyYXBoQ2xhc3MiLCJwYXRoQ2xhc3MiLCJub2RlQ2xhc3MiLCJub2RlVGV4dCIsInN0YXJ0UmFkaXVzIiwibWF4UmFkaXVzIiwicGFkZGluZyIsImRpc3BsYXlPZmZzZXQiLCJvbiIsImQiLCJkZWZzIiwiYXBwZW5kIiwiYXR0ciIsInN2Z0ciLCJjbGFzc2VkIiwicGF0aHMiLCJzZWxlY3RBbGwiLCJjaXJjbGVzIiwiaW5pdE5vZGVzIiwiaW5pdExpbmtzIiwic2V0UG9zaXRpb25zIiwicmVzaXplRnVuYyIsIm9uV2luZG93UmVzaXplIiwiYmluZGluZ3MiLCJyZXNpemUiLCIkIiwid2luZG93IiwicG9saWN5IiwiZGVzdHJveSIsIm9mZiIsImluaXRpYWxpemUiLCJkM05vZGUiLCJlYWNoIiwiZDMiLCJzZWxlY3QiLCJkM2RyYWciLCJkcmFnIiwicG9saWN5UmVtb3ZlIiwicG9saWN5UmVtb3ZlTmFtZSIsInBvbGljeU5hbWUiLCJpbmRleCIsInNwbGljZSIsImV2ZW50IiwiZDNwYXRoIiwiZDNub2RlIiwiZDN6b29tIiwiZHJhZ1N2ZyIsImdFbCIsInRpdGxlIiwid29yZHMiLCJzcGxpdCIsIm53b3JkcyIsImVsIiwidHNwYW4iLCJ0b1NwbGljZSIsImZpbHRlciIsImwiLCJtYXAiLCJ1cGRhdGVHcmFwaCIsInNwbGljZUxpbmtzRm9yTm9kZSIsInVwZGF0ZUF0dHIiLCJuZXdQYXRocyIsIm5ld1BhdGhBdHRyIiwiaGFzUG9saWN5IiwicGF0aFBvbGljeUV2ZW50IiwibmV3Tm9kZXMiLCJncmFwaCIsIm5ld05vZGVBdHRyIiwibm9kZVBvbGljeUV2ZW50IiwiU3RyaW5nIiwicmFkaXVzIiwiaW5zZXJ0VGl0bGVMaW5lYnJlYWtzIiwiYWxwaGEiLCJxdWFkdHJlZSIsImdlb20iLCJyIiwibngxIiwieCIsIm54MiIsIm55MSIsInkiLCJueTIiLCJ2aXNpdCIsInF1YWQiLCJ4MSIsInkxIiwieDIiLCJ5MiIsInBvaW50IiwiTWF0aCIsInNxcnQiLCJlIiwid2lkdGgiLCJoZWlnaHQiLCJvZmZzZXQiLCJxIiwibiIsImQzRm9yY2VDb2xsaWRlIiwibWF4IiwibWluIiwic3ZnV2lkdGgiLCJzdmdIZWlnaHQiLCJjYWxsYmFjayIsImJvdW5kcyIsImQzRm9yY2VCb3VuZHMiLCJmb3JjZSIsImxheW91dCIsInNpemUiLCJjaGFyZ2UiLCJsaW5rRGlzdGFuY2UiLCJsaW5rU3RyZW5ndGgiLCJncmF2aXR5IiwiZDNGb3JjZVRpY2siLCJkM0ZvcmNlU3RhcnQiLCJkM0ZvcmNlRW5kIiwic3RhcnQiLCJrIiwidGljayIsInN0b3AiLCJ1cGRhdGVFeGlzdGluZ05vZGVzIiwibmV3R3MiLCJlbnRlciIsImV4aXQiLCJyZW1vdmUiLCJzZXRGb3JjZSIsInVwZGF0ZU5ld05vZGVzIiwidXBkYXRlRXhpc3RpbmdQYXRocyIsIm5ld3BhdGhzIiwic3R5bGUiLCJ1cGRhdGVOZXdQYXRocyIsIlZpc3VhbGl6ZXJHcmFwaCIsIl9HcmFwaCRHcmFwaCIsImRhdGFTb3VyY2UiLCJ0cmFuc2l0aW9uIiwiZWRnZV9idWZmZXIiLCJyYWRpdXNEZWNheSIsImNvbnRhaW5lckNsYXNzIiwiYmVoYXZpb3IiLCJvcmlnaW4iLCJhcmdzIiwiZHgiLCJkeSIsInpvb20iLCJzb3VyY2VFdmVudCIsImN0cmxLZXkiLCJ6b29tZWQiLCJ0cmFuc2xhdGUiLCJzY2FsZSIsInJpZ2h0Q2xpY2siLCJqdXN0U2NhbGVUcmFuc0dyYXBoIiwiem9vbVNldENhbGxiYWNrIiwidHJhbnNsYXRlX25hbWUiLCJkZWxheSIsImR1cmF0aW9uIiwiYm9keUVsIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsImRpdldpZHRoIiwiY2xpZW50SGVpZ2h0IiwidG9wIiwibm9kZV9uYW1lc19zZXQiLCJyZXREYXRhIiwicHJvY2Vzc0xpbmtEYXRhIiwic291cmNlTm9kZSIsInRhcmdldE5vZGUiLCJwYXRoUG9saWNpZXMiLCJpbml0aWFsaXplZCIsImFycm93UGF0aCIsImRyIiwidGhpc1BhdGgiLCJfZ2V0IiwiZ2V0Iiwib2JqZWN0IiwicHJvcGVydHkiLCJyZWNlaXZlciIsIkZ1bmN0aW9uIiwiZGVzYyIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImdldHRlciIsIl9MaW5rJExpbmsiLCJjb3VudCIsInJldCIsIm15IiwiYXQiLCJhZGp1c3QiLCJtYXhXZWlnaHQiLCJ1c2VBdmdXZWlnaHQiLCJ1cGRhdGVNYXhXZWlnaHQiLCJ2YWwiLCJtYXhMaW5rIiwibWF4QnkiLCJnZXRXZWlnaHQiLCJjb2xvclNjYWxlIiwibGluZWFyIiwiZG9tYWluIiwicmFuZ2UiLCJzZWxlY3RlZENsYXNzIiwic2VsZWN0ZWRFZGdlIiwiYyIsImF0dHJUd2VlbiIsImludGVycG9sYXRlU3RyaW5nIiwibm9kZVBvbGljaWVzIiwidGhpc05vZGUiLCJfTm9kZSROb2RlIiwieFN0YXJ0IiwieVN0YXJ0IiwiTm9kZVNlbGVjdGlvblBvbGljeSIsIl9Qb2xpY3kkUG9saWN5Iiwic2VsZWN0ZWROb2RlcyIsInNlbGVjdGlvbiIsImNkIiwic3RvcFByb3BhZ2F0aW9uIiwicmVtb3ZlU2VsZWN0RnJvbU5vZGUiLCJhZGRTZWxlY3ROb2RlIiwicmVtb3ZlQWxsU2VsZWN0ZWROb2RlcyIsIlBhdGhDaGFuZ2VWaWV3UG9saWN5IiwiJHN0YXRlIiwidGhpc1BvbGljeSIsInJldExpc3QiLCJnZW5lcmF0ZUxpc3RIZWxwZXIiLCJub2RlSWRzIiwiY2hpbGRJZCIsImhhc0NoaWxkIiwic3ViUmV0TGlzdCIsImNvbmNhdCIsImVkZ2UiLCJzb3VyY2VMaXN0IiwidGFyZ2V0TGlzdCIsInNvdXJjZUlkIiwidGFyZ2V0SWQiLCJnZW5lcmF0ZUxpc3QiLCJnbyIsInNvdXJjZU5hbWUiLCJ0YXJnZXROYW1lIiwidmlld0VkZ2UiLCJkM29iaiIsImNvbmZpZyIsIiRzdGF0ZVByb3ZpZGVyIiwidXJsIiwiYWJzdHJhY3QiLCJ0ZW1wbGF0ZSIsImNvbXBvbmVudCIsIlFUaXBQb2xpY3kiLCJTcGxpdEpvaW5Ob2RlUG9saWN5IiwiU3BsaXRKb2luVmlld1BvbGljeSIsIlNhdmVTdGF0ZVBvbGljeSIsIm1vdXNlZG93biIsIm1vdXNldXAiLCJncmFwaFVwZGF0ZU5ld05vZGVzIiwiZ3JhcGhVcGRhdGVOZXdQYXRocyIsImludGVydmFsIiwic2V0VGltZW91dCIsInF0aXAiLCJ3aGVuUVRpcEF2YWlsYWJsZSIsImF0dGFjaFFUaXAiLCJzZWxlY3Rvck1hcCIsImhhc0tleXMiLCJsYWJlbHNNYXAiLCJzbGljZSIsImNvbnRlbnQiLCJldmVudHMiLCJzaG93IiwiYXBpIiwicG9zaXRpb24iLCJsZWZ0Iiwic2V0Iiwic29sbyIsImNsYXNzZXMiLCJoaWRlIiwicGF0aEVsIiwidGFyZ2V0UmV0IiwiZ2V0UG9pbnRBdExlbmd0aCIsImdldFRvdGFsTGVuZ3RoIiwicXRpcEhlbHBlciIsInNhdmVkU3RhdGUiLCJncmFwaERlc3Ryb3kiLCJsb2FkIiwiZ3JhcGhMb2FkIiwicGFyYW1zIiwicG9saWN5VGFiIiwiX05vZGVTZWxlY3Rpb25Qb2xpY3kkIiwic3BsaXROb2RlcyIsInN1cGVyU3RhdGUiLCJzcGxpdE11bHRpcGxlTm9kZXMiLCJzcGxpdE5vZGUiLCJwcmV2ZW50RGVmYXVsdCIsImpvaW5Ob2RlIiwiZ3JhcGhOb2RlcyIsIm5ld19ub2RlcyIsInhMb2MiLCJ5TG9jIiwibmV3X25vZGVfb2JqcyIsIm5ld19ub2RlIiwicmVzIiwiX19zcGxpdE5vZGUiLCJzcGxpdE5vZGVFdmVudCIsInJlc05vZGVzIiwic3BsaXRNdWx0aXBsZU5vZGVzRXZlbnQiLCJ0b19iZV9kZWxldGVkIiwibmV3X25vZGVfaWQiLCJub2RlX3RvX2RlbGV0ZSIsIl9fam9pbk5vZGUiLCJqb2luTm9kZUV2ZW50Iiwiam9pbk11bHRpcGxlTm9kZXNFdmVudCIsIl9TcGxpdEpvaW5Ob2RlUG9saWN5JCIsInNhdmVkU3RhdGVzIiwiZXZlbnRIaXN0b3J5IiwiZm9jdXNHcm91cHMiLCJmb2NpIiwiem9vbXMiLCJsYXlvdXREZWZhdWx0Iiwiem9vbURlZmF1bHQiLCJub2RlSWRzVG9SZXNob3ciLCJiYWNrQnV0dG9uRWxlbSIsInRpdGxlRWxlbSIsImJvdW5kYXJ5IiwiZWxlbSIsImJhY2tCdXR0b24iLCJ1bmRvTGFzdEV2ZW50Iiwic2F2ZSIsImN1cnJUaXRsZSIsInN0YXRlcyIsImxvYWRTdGF0ZSIsImZhZGVUbyIsInR5cGUiLCJwb3MiLCJjb25zb2xlIiwibG9nIiwidXBkYXRlR3JhcGhDYWxsYmFjayIsIm5vZGVzVG9LZWVwIiwiZ3JvdXBPbmVOb2RlcyIsInBhcnNlRmxvYXQiLCJzcGxpdE5vZGVGdW5jIiwiZ2V0UmFuZG9tSW50IiwiZmxvb3IiLCJyYW5kb20iLCJncmFwaENvbnN0cyIsInN0YXRlUG9saWN5IiwiZGVmYXVsdExheW91dCIsImNhbGNNYXhOb2RlcyIsImFyZWEiLCJhbW91bnQiLCJjb25zdHNQb2xpY3kiLCJmb2N1c05vZGVzIiwiYm90IiwicG9wIiwic2V0TGF5b3V0Iiwic3RhdGVTdXBlciIsIm5vZGVOYW1lU2V0IiwibmFtZVRvQWRkIiwibm9kZXNUb1Byb2Nlc3MiLCJwcm9jZXNzTm9kZURhdGEiLCJub2RlVG9SZW1vdmUiLCJsYXN0IiwiZmluZEQzTm9kZSIsImRibGNsaWNrIiwibm9kZUlkIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwib3RoZXJ3aXNlIiwiQ1JVREhlbHBlclNlcnZpY2UiLCJyZXR1cm5Ub0Rhc2hib2FyZCIsInVzZXJuYW1lIiwibG9naW5DdHJsIiwibG9naW4iLCJzdG9wTG9hZGVyIiwiaGlkZVNlcnZlckVycm9yIiwiJHN0YXRlUGFyYW1zIiwibG9nb3V0IiwibWVudUN0cmwiLCJPcmdhbml6YXRpb25zTW9kZWwiLCJyZXR1cm5Ub09yZ2FuaXphdGlvbnMiLCJjYW5jZWxDcmVhdGluZyIsImNyZWF0ZU9yZ2FuaXphdGlvbiIsIm9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwiLCJmb3JtIiwiJHZhbGlkIiwic3RhcnRMb2FkZXIiLCJuZXdPcmdhbml6YXRpb24iLCJ0ZW5hbnROYW1lIiwidGhlbiIsInJlc3VsdCIsInNob3dTZXJ2ZXJFcnJvciIsInJlc2V0Rm9ybSIsImRlbGV0ZU9yZ2FuaXphdGlvbiIsIm9yZ2FuaXphdGlvbkRldGFpbHNDdHJsIiwib3JnYW5pemF0aW9uIiwiZ2V0TW9kZWxCeUtleSIsIiRzY29wZSIsIiRodHRwIiwiVmlzdWFsaXphdGlvblNlcnZpY2UiLCIkaW50ZXJ2YWwiLCJEYXRlIiwidCIsImdldFNlY29uZHMiLCJlZGdlRGF0YUludGVydmFsIiwiZ2V0RWRnZURhdGEiLCJ0b1N0cmluZyIsInJlc3VsdHMiLCJzZXJpZXMiLCJ2YWx1ZXMiLCJlZGdlRGF0YSIsImVkZ2VEYXRhVGltZSIsIiRvbiIsImNhbmNlbCIsImdldE9sZEVkZ2VEYXRhIiwib2xkRWRnZURhdGEiLCJkaXJlY3RpdmUiLCIkd2luZG93IiwidmlzdWFsaXphdGlvbkVkZ2VEMyIsInNjb3BlIiwibm93IiwiZ3JvdXBzIiwiZ3JvdXAiLCJwYXRoIiwibGluZSIsImxpbWl0IiwiYXhpcyIsImVhc2UiLCJ5QXhpcyIsInNoaWZ0IiwiY2xpZW50V2lkdGgiLCJjdXJyZW50IiwiY29sb3IiLCJ0aW1lIiwiaW50ZXJwb2xhdGUiLCJ4U3ZnIiwib3JpZW50IiwicmVzdHJpY3QiLCJyZXBsYWNlIiwiJHdhdGNoR3JvdXAiLCJzZXJ2aWNlIiwiU3RhdGVTYXZlIiwidmlzdWFsaXphdGlvbmxpc3RkMyIsInNlcnZpY2VTZWxlY3RvcnMiLCJzZXRBbmNlc3RvcnMiLCJ0b3BEYXRhIiwiZ2V0VG9wTGV2ZWxGbG93IiwicmF3U3ZnIiwiZmluZCIsInZpc3VhbGl6YXRpb25HcmFwaCIsImluc3RhbGxEZWZhdWx0UGF0aFBvbGljeSIsInFUaXBQb2xpY3kiLCJpbnN0YWxsRGVmYXVsdE5vZGVQb2xpY3kiLCJzcGxpdEpvaW5WaWV3UG9saWN5IiwiaW5zdGFsbEJhY2tCdXR0b24iLCJpbnN0YWxsVGl0bGUiLCJ1bmJpbmQiLCJ1cGRhdGVMaW5rRGF0YSIsInN1Y2Nlc3NHcmFwaERhdGFDYWxsYmFjayIsImVuZHBvaW50IiwidGFncyIsIkVuZHBvaW50SVAiLCJwcm92aWRlciIsIlByb3ZpZGVySVAiLCJsaW5rT3V0IiwibGlua0luIiwiZ2V0R3JhcGhEYXRhIiwiZ3JhcGhEYXRhSW50ZXJ2YWwiLCJnZXRTdHJ1Y3R1cmVEYXRhIiwiJHEiLCJtYWtlR2V0IiwiZGVmZXJyZWQiLCJkZWZlciIsInJlc29sdmUiLCJyZWplY3QiLCJwcm9taXNlIiwibWFrZVBvc3QiLCJwYXJhbSIsIm9iaiIsImZ1bGxTdWJOYW1lIiwic3ViTmFtZSIsInN1YlZhbHVlIiwiaW5uZXJPYmoiLCJxdWVyeSIsIkFycmF5IiwiZW5jb2RlVVJJQ29tcG9uZW50Iiwic3Vic3RyIiwibWV0aG9kIiwiaGVhZGVycyIsIkNvbnRlbnQtVHlwZSIsInRyYW5zZm9ybVJlcXVlc3QiLCJpc09iamVjdCIsImRiIiwiYnVpbGRXaGVyZVF1ZXJ5IiwicG9pbnRzIl0sIm1hcHBpbmdzIjoiQUFBQSxZQWFBLFNBQVNBLGlCQUFnQkMs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LEVBQUFsUSxFQUFBLGNBQ0EsdUdBQ0FrUSxFQUFBblEsRUFBQSxjQUFBLFFBQ0FtUSxFQUFBbFEsRUFBQSxjQUNBLHFDQUVBLE9BQUFpUCxHQUFBdE8sRUFBQTFVLEdBS0EsUUFBQWtmLEdBQUFwTCxFQUFBQyxHQUNBLEdBQUFXLEdBQUFsVSxjQUFBYSxzQkFDQXFULElBQUEsY0FDQSxJQUFBMVUsSUFDQWdrQixHQUFBLFdBQ0FyWSxFQUFBLDJFQUNBc1ksRUFBQW5RLEVBQUEsY0FBQSxRQUNBbVEsRUFBQWxRLEVBQUEsY0FDQSwrR0FDQWtRLEVBQUFuUSxFQUFBLGNBQUEsUUFDQW1RLEVBQUFsUSxFQUFBLGNBQ0Esc0NBRUEsT0FBQWlQLEdBQUF0TyxFQUFBMVUsR0FHQSxPQUNBc2lCLGFBQUFBLEVBQ0FFLGlCQUFBQSxFQUNBL0QsWUFBQUEsRUFDQVMsZUFBQUEiLCJmaWxlIjoiYXBwL2J1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBEZWZpbmluZyB0aGUgR3JhcGggTW9kdWxlLlxuICogU2VlIERFU0lHTi5tZCBmb3IgaW5mbyBvbiBHcmFwaCBPYmplY3RzLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJywgW10pO1xuYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiLCBbXSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbi8qKlxuICogVGhlIGJhc2UgY2xhc3MgdGhlIERhdGFTb3VyY2Ugb2JqZWN0LlxuICogXG4gKiBUaGUgRGF0YVNvdXJjZSBvYmplY3QgdGFrZXMgaW4gbm9kZSBhbmQgbGluayBkYXRhIGZyb20gdGhlIHNlcnZlciwgXG4gKiBhbmQgcHJvdmlkZXMgbWV0aG9kcyBmb3IgY29udmVydGluZyBhbmQgbWFuaXB1bGF0aW5nIHRoZSBkYXRhIGZvclxuICogdGhlIGdyYXBoIG9iamVjdC5cbiAqIFxuICogVG8gd3JpdGUgeW91ciBvd24gRGF0YVNvdXJjZSBvYmplY3QsIGNyZWF0ZSBhIG5ldyBmYWN0b3J5IHRoYXQgdXNlcyB0aGUgXG4gKiBEYXRhU291cmNlIHlvdSB3YW50IHRvIGluaGVyaXQgYXMgYSBkZXBlbmRlbmN5LCBhbmQgZXh0ZW5kIFxuICogaXRzIERhdGFTb3VyY2UgY2xhc3MuIFxuICogUmV0dXJuIHRoZSBjbGFzcyBvYmplY3Qgd2l0aCBEYXRhU291cmNlIGFzIGtleS5cbiAqIFxuICogTm9kZSBkYXRhIGlzIGV4cGVjdGVkIHRvIGJlIGluIHRoZSBmb2xsb3dpbmcgZm9ybWF0OlxuICoge2lkOm5vZGVfaWQsIHRleHQ6bm9kZV90ZXh0fVxuICogXG4gKiBMaW5rIGRhdGEgaXMgZXhwZWN0ZWQgdG8gYmUgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6XG4gKiB7c291cmNlOiBzb3VyY2VOb2RlSWQsIHRhcmdldDogdGFyZ2V0Tm9kZUlkfVxuICogXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdEYXRhU291cmNlJywgWydOb2RlJywgJ0xpbmsnLCBmdW5jdGlvbiAoTm9kZSwgTGluaykge1xuXHR2YXIgRGF0YVNvdXJjZSA9IGZ1bmN0aW9uICgpIHtcblx0XHQvKipcbiAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgKlxuICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgbm9kZXMgICAgICAgICAgICAgIFRoZSBub2RlIGRhdGEgXG4gICAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBsaW5rcyAgICAgICAgICAgICAgVGhlIGxpbmsgZGF0YVxuICAgKi9cblx0XHRmdW5jdGlvbiBEYXRhU291cmNlKG5vZGVzLCBsaW5rcykge1xuXHRcdFx0X2NsYXNzQ2FsbENoZWNrKHRoaXMsIERhdGFTb3VyY2UpO1xuXG5cdFx0XHR0aGlzLm5vZGVzID0gbm9kZXM7XG5cdFx0XHR0aGlzLmxpbmtzID0gbGlua3M7XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqIFJlcGxhY2VzIHRoZSBub2RlIGRhdGFcbiAgICpcbiAgICogQHBhcmFtICAgICAge05vZGV9ICBub2RlcyAgIFRoZSBub2Rlc1xuICAgKi9cblxuXG5cdFx0X2NyZWF0ZUNsYXNzKERhdGFTb3VyY2UsIFt7XG5cdFx0XHRrZXk6ICd1cGRhdGVOb2RlcycsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gdXBkYXRlTm9kZXMobm9kZXMpIHtcblx0XHRcdFx0dGhpcy5ub2RlcyA9IG5vZGVzO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIFJlcGxhY2VzIHRoZSBsaW5rIGRhdGFcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7TGlua30gIGxpbmtzICAgVGhlIGxpbmtzXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3VwZGF0ZUxpbmtzJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVMaW5rcyhsaW5rcykge1xuXHRcdFx0XHR0aGlzLmxpbmtzID0gbGlua3M7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogUmV0dXJucyB0aGUgTmFtZSBhdHRyaWJ1dGUgb2YgdGhlIE5vZGUgd2l0aCB0aGUgXG4gICAgKiBtYXRjaGluZyBpZFxuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG4gICAgKiBAcmV0dXJuICAgICB7c3RyaW5nfSAgbmFtZSBvZiB0aGUgbWF0Y2hpbmcgbm9kZVxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdub2RlSWRUb05hbWUnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIG5vZGVJZFRvTmFtZShpZCkge1xuXHRcdFx0XHR2YXIgbm9kZXMgPSB0aGlzLm5vZGVzO1xuXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0aWYgKG5vZGVzW2ldLmlkID09IGlkKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gbm9kZXNbaV0ubmFtZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBwcm9jZXNzIHRoZSBub2RlRGF0YSB0byBjcmVhdGUgTm9kZSBvYmplY3RzXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZURhdGEgIE5vZGVEYXRhIHRvIGNvbnZlcnQgXG4gICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gbm9kZSBvYmplY3RzXG4gICAgKiBAcmV0dXJuICAgICB7QXJyYXl9ICBOb2RlIG9iamVjdHNcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAncHJvY2Vzc05vZGVEYXRhJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBwcm9jZXNzTm9kZURhdGEobm9kZURhdGEpIHtcblx0XHRcdFx0dmFyIG5vZGVzID0gW107XG5cdFx0XHRcdF8uZm9yRWFjaChub2RlRGF0YSwgZnVuY3Rpb24gKGRhdGEpIHtcblx0XHRcdFx0XHR2YXIgbmV3Tm9kZSA9IG5ldyBOb2RlLk5vZGUobnVsbCwgbnVsbCwgZGF0YS5pZCwgZGF0YS50ZXh0LCBudWxsKTtcblx0XHRcdFx0XHRub2Rlcy5wdXNoKG5ld05vZGUpO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0cmV0dXJuIG5vZGVzO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIHByb2Nlc3MgdGhlIGxpbmtEYXRhXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbGlua0RhdGEgIFRoZSBsaW5rIGRhdGFcbiAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVzICAgICBUaGUgbm9kZXMgZnJvbSBwcm9jZXNzTm9kZURhdGFcbiAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIExpbmsgb2JqZWN0c1xuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdwcm9jZXNzTGlua0RhdGEnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHByb2Nlc3NMaW5rRGF0YShsaW5rRGF0YSwgbm9kZXMpIHtcblx0XHRcdFx0LyoqXG4gICAgICogUmV0dXJucyB0aGUgbm9kZSB0aGF0IG1hdGNoZXMgdGhlIGlkXG4gICAgICpcbiAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG4gICAgICogQHJldHVybiAgICAge05vZGV9ICAgVGhlIG5vZGUgd2l0aCB0aGUgbWF0Y2hpbmcgaWRcbiAgICAgKi9cblx0XHRcdFx0ZnVuY3Rpb24gZmluZE5vZGVCeUlkKGlkLCBub2Rlcykge1xuXHRcdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdGlmIChpZCA9PSBub2Rlc1tpXS5pZCkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gbm9kZXNbaV07XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0dmFyIGxpbmtzID0gW107XG5cdFx0XHRcdC8vdHJhbnNmb3JtaW5nIGxpbmsgZGF0YVxuXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGxpbmtEYXRhLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0aWYgKGxpbmtEYXRhW2ldLnNvdXJjZSAhPSBsaW5rRGF0YVtpXS50YXJnZXQpIHtcblx0XHRcdFx0XHRcdHZhciBzb3VyY2UgPSBmaW5kTm9kZUJ5SWQobGlua0RhdGFbaV0uc291cmNlLCBub2Rlcyk7XG5cdFx0XHRcdFx0XHR2YXIgdGFyZ2V0ID0gZmluZE5vZGVCeUlkKGxpbmtEYXRhW2ldLnRhcmdldCwgbm9kZXMpO1xuXHRcdFx0XHRcdFx0aWYgKHNvdXJjZSA9PSBudWxsIHx8IHRhcmdldCA9PSBudWxsKSB7XG5cdFx0XHRcdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0dmFyIGxpbmsgPSBuZXcgTGluay5MaW5rKHNvdXJjZSwgdGFyZ2V0KTtcblx0XHRcdFx0XHRcdGxpbmtzLnB1c2gobGluayk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBsaW5rcztcblx0XHRcdH1cblx0XHR9XSk7XG5cblx0XHRyZXR1cm4gRGF0YVNvdXJjZTtcblx0fSgpO1xuXG5cdHJldHVybiB7XG5cdFx0RGF0YVNvdXJjZTogRGF0YVNvdXJjZVxuXHR9O1xufV0pO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzE0LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm1vZGVscycsIFtdKTtcbnZhciBDb250aXZHbG9iYWxzID0gKGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICAvL1JFU1QgZW5kcG9pbnRzIGZvciBORVRNQVNURVJcbiAgICAgICAgJ05FVFdPUktTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL25ldHdvcmtzLycsXG4gICAgICAgICdORVRXT1JLU19JTlNQRUNUX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL2luc3BlY3QvbmV0d29ya3MvJyxcbiAgICAgICAgJ1NFUlZJQ0VMQlNfSU5TUEVDVF9FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9pbnNwZWN0L3NlcnZpY2VMQnMvJyxcbiAgICAgICAgJ1BPTElDSUVTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL3BvbGljeXMvJyxcbiAgICAgICAgJ1JVTEVTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL3J1bGVzLycsXG4gICAgICAgICdBUFBMSUNBVElPTkdST1VQU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9lbmRwb2ludEdyb3Vwcy8nLFxuICAgICAgICAnU0VSVklDRUxCU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9zZXJ2aWNlTEJzLycsXG4gICAgICAgICdPUkdBTklaQVRJT05TX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL3RlbmFudHMvJyxcbiAgICAgICAgJ05FVFdPUktfU0VUVElOR1NfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvZ2xvYmFscy8nLFxuICAgICAgICAnTkVUUFJPRklMRVNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvbmV0cHJvZmlsZXMvJyxcbiAgICAgICAgJ0JHUFNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvQmdwcy8nLFxuICAgICAgICAnQkdQU19JTlNQRUNUX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL2luc3BlY3QvQmdwcy8nLFxuICAgICAgICAnVklTVUFMSVpBVElPTl9FTkRQT0lOVCc6ICcvdmlzdWFsaXphdGlvbi8nLFxuICAgICAgICAvL1JFU1QgZW5kcG9pbnRzIGZvciBWT0xNQVNURVJcbiAgICAgICAgJ1ZPTFVNRVNfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci92b2x1bWVzLycsXG4gICAgICAgICdWT0xVTUVTX0NSRUFURV9FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3ZvbHVtZXMvY3JlYXRlLycsXG4gICAgICAgICdWT0xVTUVTX0RFTEVURV9FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3ZvbHVtZXMvcmVtb3ZlLycsXG4gICAgICAgICdWT0xVTUVTX0NPUFlTTkFQU0hPVFNfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci92b2x1bWVzL2NvcHknLFxuICAgICAgICAnVk9MVU1FU19VU0VTX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvdXNlcy9tb3VudHMvJyxcbiAgICAgICAgJ1ZPTFVNRVNfU05BUFNIT1RTX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvc25hcHNob3RzLycsXG4gICAgICAgICdTVE9SQUdFUE9MSUNJRVNfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci9wb2xpY2llcy8nLFxuICAgICAgICAnVk9MVU1FU19HTE9CQUxfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci9nbG9iYWwvJyxcbiAgICAgICAgLy9SRVNUIGVuZHBvaW50cyBmb3IgQ0xVU1RFUlxuICAgICAgICAnTk9ERVNfTElTVF9FTkRQT0lOVCc6ICcvaW5mby9ub2RlcycsXG4gICAgICAgICdOT0RFU19ESVNDT1ZFUl9FTkRQT0lOVCc6ICcvZGlzY292ZXIvbm9kZXMnLFxuICAgICAgICAnTk9ERVNfQ09NTUlTU0lPTl9FTkRQT0lOVCc6ICcvY29tbWlzc2lvbi9ub2RlcycsXG4gICAgICAgICdOT0RFU19ERUNPTU1JU1NJT05fRU5EUE9JTlQnOiAnL2RlY29tbWlzc2lvbi9ub2RlcycsXG4gICAgICAgICdOT0RFU19NQUlOVEVOQU5DRV9FTkRQT0lOVCc6ICcvbWFpbnRlbmFuY2Uvbm9kZXMnLFxuICAgICAgICAnTk9ERVNfTEFTVF9KT0JfRU5EUE9JTlQnOiAnL2luZm8vam9iL2xhc3QnLFxuICAgICAgICAnTk9ERVNfQUNUSVZFX0pPQl9FTkRQT0lOVCc6ICcvaW5mby9qb2IvYWN0aXZlJyxcbiAgICAgICAgJ05PREVTX1NFVFRJTkdTX1NFVF9FTkRQT0lOVCc6ICcvZ2xvYmFscycsXG4gICAgICAgICdOT0RFU19TRVRUSU5HU19HRVRfRU5EUE9JTlQnOiAnL2luZm8vZ2xvYmFscycsXG4gICAgICAgIC8vUmVmcmVzaCBpbnRlcnZhbCBpbiBtaWxsaXNlY29uZHNcbiAgICAgICAgJ1JFRlJFU0hfSU5URVJWQUwnOiA1MDAwLFxuICAgICAgICAvL1JlZ0V4IGZvciB2YWxpZGF0aW9uXG4gICAgICAgICdDSURSX1JFR0VYJzogJ14oKFswLTldfFsxLTldWzAtOV18MVswLTldezJ9fDJbMC00XVswLTldfDI1WzAtNV0pXFwuKXszfShbMC05XXxbMS05XVswLTldfDFbMC05XXsyfXwyWzAtNF1bMC05XXwyNVswLTVdKShcXC8oWzAtOV18WzEtMl1bMC05XXwzWzAtMl0pKSQnLFxuICAgICAgICAnVkxBTl9SRUdFWCc6ICdeKFswLTldezEsNH0/LVswLTldezEsNH0/KSQnLFxuICAgICAgICAnVlhMQU5fUkVHRVgnOiAnXihbMC05XXsxLDh9Py1bMC05XXsxLDh9PykkJyxcbiAgICAgICAgJ05VTUJFUl9SRUdFWCc6ICdeWzAtOV0qJCdcbiAgICB9O1xufSkoKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi51dGlscycsIFtdKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXBcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG4vKipcbiAqIFRoZSBEYXRhU291cmNlIHVzZWQgZm9yIHRoZSB2aXN1YWxpemF0aW9uIHRhYi5cbiAqIFxuICogTm9kZSBEYXRhIGZyb20gdGhlIHNlcnZlciBpcyBleHBlY3RlZCB0byBiZSBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDpcbiAqIHtpZDogbm9kZV9pZCwgdGV4dDogbm9kZV90ZXh0fVxuICogUGFyZW50IGFuZCBBbmNlc3RvciBhdHRyaWJ1dGVzIGNhbiBiZSBzZXQgYnkgY2FsbGluZyBzZXRBbmNlc3RvcnNcbiAqIFxuICogTGluayBEYXRhIGZyb20gdGhlIHNlcnZlciBpcyBleHBlY3RlZCB0byBiZSBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDpcbiAqIHtzb3VyY2U6IHNvdXJjZU5vZGVJZCwgdGFyZ2V0OiB0YXJnZXROb2RlSWQsIHdlaWdodDogbGlua1dlaWdodH1cbiAqIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnVmlzdWFsaXplckRhdGFTb3VyY2UnLCBbJ0RhdGFTb3VyY2UnLCAnVmlzdWFsaXplck5vZGUnLCAnVmlzdWFsaXplckxpbmsnLCBmdW5jdGlvbiAoRGF0YVNvdXJjZSwgVmlzdWFsaXplck5vZGUsIFZpc3VhbGl6ZXJMaW5rKSB7XG5cdHZhciBWaXN1YWxpemVyRGF0YVNvdXJjZSA9IGZ1bmN0aW9uIChfRGF0YVNvdXJjZSREYXRhU291cmMpIHtcblx0XHRfaW5oZXJpdHMoVmlzdWFsaXplckRhdGFTb3VyY2UsIF9EYXRhU291cmNlJERhdGFTb3VyYyk7XG5cblx0XHQvKipcbiAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgKiBcbiAgICogQ2hpbGRyZW4gU3RydWN0IGFuZCBhbmNlc3RvcnNfc3RydWN0IGFyZSBKU09OIG9iamVjdHMsXG4gICAqIG1hcHBpbmcgYSBub2RlIElkIHRvIGEgbGlzdCBvZiBpdCdzIGNoaWxkcmVuIG9yIGFuY2VzdG9ycy5cbiAgICogQ2hpbGRyZW4gU3RydWN0IGlzIGFsc28gZXhwZWN0ZWQgdG8gaGF2ZSBhIGZpZWxkIGNhbGxlZFxuICAgKiB0b3BMZXZlbCwgdGhhdCBtYXBzIHRvIGEgbGlzdCBvZiBhbGwgdGhlIG5vZGVzIHRoYXQgZG9uJ3RcbiAgICogaGF2ZSBhbnkgcGFyZW50cy5cbiAgICpcbiAgICogQHBhcmFtICAgICAge0FycmF5fSAgIG5vZGVzICAgICAgICAgICAgICBUaGUgbm9kZSBkYXRhIFxuICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgbGlua3MgICAgICAgICAgICAgIFRoZSBsaW5rIGRhdGFcbiAgICogQHBhcmFtICAgICAge09iamVjdH0gIGNoaWxkcmVuX3N0cnVjdCAgICBUaGUgY2hpbGRyZW4gc3RydWN0dXJlXG4gICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBhbmNlc3RvcnNfc3RydWN0ICAgVGhlIGFuY2VzdG9ycyBzdHJ1Y3R1cmVcbiAgICogQHBhcmFtICAgICAge0FycmF5fSAgIGxhYmVscyAgICAgICAgICAgICBUaGUgbGFiZWxzXG4gICAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBzZWxlY3RvcnMgICAgICAgICAgVGhlIHNlbGVjdG9yc1xuICAgKi9cblx0XHRmdW5jdGlvbiBWaXN1YWxpemVyRGF0YVNvdXJjZShub2RlcywgbGlua3MsIGNoaWxkcmVuX3N0cnVjdCwgYW5jZXN0b3JzX3N0cnVjdCwgbGFiZWxzLCBzZWxlY3RvcnMpIHtcblx0XHRcdF9jbGFzc0NhbGxDaGVjayh0aGlzLCBWaXN1YWxpemVyRGF0YVNvdXJjZSk7XG5cblx0XHRcdHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChWaXN1YWxpemVyRGF0YVNvdXJjZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFZpc3VhbGl6ZXJEYXRhU291cmNlKSkuY2FsbCh0aGlzLCBub2RlcywgbGlua3MpKTtcblxuXHRcdFx0X3RoaXMuY2hpbGRyZW5fc3RydWN0ID0gY2hpbGRyZW5fc3RydWN0O1xuXHRcdFx0X3RoaXMuYW5jZXN0b3JzX3N0cnVjdCA9IGFuY2VzdG9yc19zdHJ1Y3Q7XG5cdFx0XHRfdGhpcy5sYWJlbHMgPSBsYWJlbHM7XG5cdFx0XHRfdGhpcy5zZWxlY3RvcnMgPSBzZWxlY3RvcnM7XG5cdFx0XHRyZXR1cm4gX3RoaXM7XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqIERldGVybWluZXMgaWYgaXQgaGFzIGNoaWxkLlxuICAgKlxuICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgIGlkICAgICAgVGhlIGlkZW50aWZpZXJcbiAgICogQHJldHVybiAgICAge2Jvb2xlYW59ICBUcnVlIGlmIGhhcyBjaGlsZCwgRmFsc2Ugb3RoZXJ3aXNlLlxuICAgKi9cblxuXG5cdFx0X2NyZWF0ZUNsYXNzKFZpc3VhbGl6ZXJEYXRhU291cmNlLCBbe1xuXHRcdFx0a2V5OiAnaGFzQ2hpbGQnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGhhc0NoaWxkKGlkKSB7XG5cdFx0XHRcdGlmICh0aGlzLmNoaWxkcmVuX3N0cnVjdFtpZF0gPT0gbnVsbCkge1xuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBTZXRzIHRoZSBwYXJlbnQgYW5kIGFuY2VzdG9ycyBhdHRyaWJ1dGUgdXNpbmcgXG4gICAgKiBhbmNlc3RvcnNfc3RydWN0IGZvciBhbGwgdGhlIG5vZGVzXG4gICAgKiBBbHNvIGFkZHMgYW55IG5vZGVzIHdpdGhvdXQgYW5jZXN0b3JzLCB0aGF0IGFyZW4ndCBcbiAgICAqIHRvcGxldmVsIHRvIHRoZSBjbGllbnQgc2VydmljZS5cbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnc2V0QW5jZXN0b3JzJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBzZXRBbmNlc3RvcnMoKSB7XG5cdFx0XHRcdHZhciB0aGlzRGF0YVNvdXJjZSA9IHRoaXM7XG5cdFx0XHRcdHZhciBhZGRlZENsaWVudCA9IGZhbHNlO1xuXHRcdFx0XHRfLmZvckVhY2godGhpc0RhdGFTb3VyY2Uubm9kZXMsIGZ1bmN0aW9uIChub2RlKSB7XG5cdFx0XHRcdFx0bm9kZS5hbmNlc3RvcnMgPSB0aGlzRGF0YVNvdXJjZS5hbmNlc3RvcnNfc3RydWN0W25vZGUuaWRdIHx8IFtdO1xuXHRcdFx0XHRcdGlmIChfLmlzRW1wdHkobm9kZS5hbmNlc3RvcnMpID09PSBmYWxzZSkge1xuXHRcdFx0XHRcdFx0bm9kZS5wYXJlbnQgPSBub2RlLmFuY2VzdG9yc1swXTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0aWYgKF8uaW5jbHVkZXModGhpc0RhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0LnRvcExldmVsLCBub2RlLmlkKSA9PSBmYWxzZSkge1xuXHRcdFx0XHRcdFx0XHQvL2NvbnRhaW5lciBoYXMgbm8gcGFyZW50XG5cdFx0XHRcdFx0XHRcdC8vYWRkaW5nIHRvIGNsaWVudFxuXHRcdFx0XHRcdFx0XHRub2RlLmFuY2VzdG9ycy5wdXNoKFwiY2xpZW50XCIpO1xuXHRcdFx0XHRcdFx0XHR0aGlzRGF0YVNvdXJjZS5hbmNlc3RvcnNfc3RydWN0W25vZGUuaWRdID0gW1wiY2xpZW50XCJdO1xuXHRcdFx0XHRcdFx0XHRpZiAoYWRkZWRDbGllbnQgPT09IGZhbHNlKSB7XG5cdFx0XHRcdFx0XHRcdFx0YWRkZWRDbGllbnQgPSB0cnVlO1xuXHRcdFx0XHRcdFx0XHRcdHRoaXNEYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbC5wdXNoKFwiY2xpZW50XCIpO1xuXHRcdFx0XHRcdFx0XHRcdHRoaXNEYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFsnY2xpZW50J10gPSBbXTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR0aGlzRGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbJ2NsaWVudCddLnB1c2gobm9kZS5pZCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBSZXR1cm5zIHRoZSBmbG93IGJldHdlZW4gdGhlIGhpZ2hlc3QgbGV2ZWwgZ3JvdXBpbmdcbiAgICAqXG4gICAgKiBAcmV0dXJuICAgICB7T2JqZWN0fSAgVGhlIHRvcCBsZXZlbCBmbG93LlxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdnZXRUb3BMZXZlbEZsb3cnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGdldFRvcExldmVsRmxvdygpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuZ2V0Rmxvd0JldHdlZW5TZXQodGhpcy5jaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwpO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIEdldHMgdGhlIGZsb3cgYmV0d2VlbiBhbnkgc2V0IG9mIG5vZGUgbGV2ZWxzXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZV9uYW1lcyAgVGhlIG5vZGUgbmFtZXMgaW4gdGhlIHNldFxuICAgICogQHJldHVybiAgICAge09iamVjdH0gIFRoZSBmbG93IGJldHdlZW4gc2V0LlxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdnZXRGbG93QmV0d2VlblNldCcsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gZ2V0Rmxvd0JldHdlZW5TZXQobm9kZV9uYW1lcykge1xuXHRcdFx0XHR2YXIgbG9jYWxfbm9kZXMgPSB0aGlzLm5vZGVzO1xuXHRcdFx0XHR2YXIgaWRNYXBwaW5nID0ge307XG5cdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbG9jYWxfbm9kZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHR2YXIgbm9kZSA9IGxvY2FsX25vZGVzW2ldO1xuXG5cdFx0XHRcdFx0Ly9pZiBub2RlIGlzIGFscmVhZHkgYXQgaXRzIGhpZ2hlc3QgbGV2ZWxcblx0XHRcdFx0XHRpZiAobm9kZS5hbmNlc3RvcnMgPT09IG51bGwpIHtcblx0XHRcdFx0XHRcdGlkTWFwcGluZ1tub2RlLmlkXSA9IG5vZGUubmFtZTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0Ly9jaGVjayB0byBzZWUgd2hpY2ggdGFncyBhcmUgcHJlc2VudCBpbiB0aGUgYW5jZXN0b3IgbGlzdFxuXHRcdFx0XHRcdFx0Zm9yICh2YXIgaiA9IDA7IGogPCBub2RlX25hbWVzLmxlbmd0aDsgaisrKSB7XG5cdFx0XHRcdFx0XHRcdGlmIChub2RlLmFuY2VzdG9ycy5pbmRleE9mKG5vZGVfbmFtZXNbal0pID4gLTEpIHtcblx0XHRcdFx0XHRcdFx0XHRpZE1hcHBpbmdbbm9kZS5pZF0gPSBub2RlX25hbWVzW2pdO1xuXHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdC8vbW9kaWZ5IGxpbmtzXG5cdFx0XHRcdHZhciBsaW5rcyA9IHRoaXMubGlua3M7XG5cdFx0XHRcdHZhciBsaW5rRGF0YSA9IFtdO1xuXG5cdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbGlua3MubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHR2YXIgbGluayA9IFtdO1xuXHRcdFx0XHRcdGxpbmsuc291cmNlID0gaWRNYXBwaW5nW2xpbmtzW2ldLnNvdXJjZV0gfHwgbGlua3NbaV0uc291cmNlO1xuXHRcdFx0XHRcdGxpbmsudGFyZ2V0ID0gaWRNYXBwaW5nW2xpbmtzW2ldLnRhcmdldF0gfHwgbGlua3NbaV0udGFyZ2V0O1xuXHRcdFx0XHRcdGxpbmsud2VpZ2h0ID0gbGlua3NbaV0ud2VpZ2h0O1xuXHRcdFx0XHRcdGxpbmtEYXRhLnB1c2gobGluayk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvL2NyZWF0aW5nIHRoZSBub2RlRGF0YVxuXHRcdFx0XHR2YXIgbm9kZURhdGEgPSBbXTtcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBub2RlX25hbWVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0dmFyIG5vZGVfdG9fYWRkID0gW107XG5cdFx0XHRcdFx0bm9kZV90b19hZGQuaWQgPSBub2RlX25hbWVzW2ldO1xuXHRcdFx0XHRcdG5vZGVfdG9fYWRkLnRleHQgPSB0aGlzLm5vZGVJZFRvTmFtZShub2RlX25hbWVzW2ldKSB8fCBub2RlX25hbWVzW2ldO1xuXG5cdFx0XHRcdFx0bm9kZV90b19hZGQuYW5jZXN0b3JzID0gdGhpcy5hbmNlc3RvcnNfc3RydWN0W25vZGVfbmFtZXNbaV1dIHx8IHRoaXMuYW5jZXN0b3JzX3N0cnVjdFtub2RlX3RvX2FkZC50ZXh0XSB8fCBbXTtcblx0XHRcdFx0XHRpZiAoXy5pc0VtcHR5KG5vZGVfdG9fYWRkLmFuY2VzdG9ycykgPT09IGZhbHNlKSB7XG5cdFx0XHRcdFx0XHRub2RlX3RvX2FkZC5wYXJlbnQgPSBub2RlX3RvX2FkZC5hbmNlc3RvcnNbMF07XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdG5vZGVfdG9fYWRkLnBhcmVudCA9IG51bGw7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdG5vZGVEYXRhLnB1c2gobm9kZV90b19hZGQpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuIHsgbm9kZURhdGE6IG5vZGVEYXRhLCBsaW5rRGF0YTogbGlua0RhdGEgfTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBwcm9jZXNzIHRoZSBub2RlRGF0YSBvdXRwdXQgb2YgZ2V0Rmxvd0JldHdlZW5TZXRcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlRGF0YSAgTm9kZURhdGEgdG8gY29udmVydCBcbiAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0byBub2RlIG9iamVjdHNcbiAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIE5vZGUgb2JqZWN0c1xuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdwcm9jZXNzTm9kZURhdGEnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHByb2Nlc3NOb2RlRGF0YShub2RlRGF0YSkge1xuXHRcdFx0XHR2YXIgbm9kZXMgPSBbXTtcblx0XHRcdFx0Xy5mb3JFYWNoKG5vZGVEYXRhLCBmdW5jdGlvbiAoZGF0YSkge1xuXHRcdFx0XHRcdHZhciBuZXdOb2RlID0gbmV3IFZpc3VhbGl6ZXJOb2RlLk5vZGUobnVsbCwgbnVsbCwgZGF0YS5pZCwgZGF0YS50ZXh0LCBudWxsLCBkYXRhLnBhcmVudCwgZGF0YS5hbmNlc3RvcnMsIG51bGwsIG51bGwpO1xuXHRcdFx0XHRcdG5vZGVzLnB1c2gobmV3Tm9kZSk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRyZXR1cm4gbm9kZXM7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogcHJvY2VzcyB0aGUgbGlua0RhdGEgb3V0cHV0IG9mIGdldEZsb3dCZXR3ZWVuU2V0XG4gICAgKlxuICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbGlua0RhdGEgIFRoZSBsaW5rIGRhdGFcbiAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVzICAgICBUaGUgbm9kZXNcbiAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIExpbmsgb2JqZWN0c1xuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdwcm9jZXNzTGlua0RhdGEnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHByb2Nlc3NMaW5rRGF0YShsaW5rRGF0YSwgbm9kZXMpIHtcblx0XHRcdFx0LyoqXG4gICAgICogUmV0dXJucyB0aGUgbm9kZSB0aGF0IG1hdGNoZXMgdGhlIGlkXG4gICAgICpcbiAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG4gICAgICogQHJldHVybiAgICAge05vZGV9ICAgVGhlIG5vZGUgd2l0aCB0aGUgbWF0Y2hpbmcgaWRcbiAgICAgKi9cblx0XHRcdFx0ZnVuY3Rpb24gZmluZE5vZGVCeUlkKGlkLCBub2Rlcykge1xuXHRcdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdGlmIChpZCA9PSBub2Rlc1tpXS5pZCkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gbm9kZXNbaV07XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0dmFyIGxpbmtzID0gW107XG5cdFx0XHRcdC8vYSBtYXBwaW5nIGZyb20gc291cmNlLmlkLXRhcmdldC5pZCB0byB0aGUgbGluayBhZGRlZFxuXHRcdFx0XHR2YXIgYWRkZWRfbGlua3MgPSB7fTtcblx0XHRcdFx0Ly90cmFuc2Zvcm1pbmcgbGluayBkYXRhXG5cdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbGlua0RhdGEubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRpZiAobGlua0RhdGFbaV0uc291cmNlICE9IGxpbmtEYXRhW2ldLnRhcmdldCkge1xuXHRcdFx0XHRcdFx0dmFyIHNvdXJjZSA9IGZpbmROb2RlQnlJZChsaW5rRGF0YVtpXS5zb3VyY2UsIG5vZGVzKTtcblx0XHRcdFx0XHRcdHZhciB0YXJnZXQgPSBmaW5kTm9kZUJ5SWQobGlua0RhdGFbaV0udGFyZ2V0LCBub2Rlcyk7XG5cdFx0XHRcdFx0XHR2YXIgd2VpZ2h0ID0gbGlua0RhdGFbaV0ud2VpZ2h0O1xuXHRcdFx0XHRcdFx0Ly9pbiBvcmRlciB0byBzdW0gYWxsIHRoZSB3ZWlnaHRzIG9mIHRoZSBsaW5rcyBvZiB0aGUgc3ViLW5vZGVzLFxuXHRcdFx0XHRcdFx0Ly93ZSB1c2UgYWRkZWRfbGlua3MgdG8ga2VlcCB0cmFjayBpZiBhbiBsaW5rIHdhcyBhZGRlZFxuXHRcdFx0XHRcdFx0Ly9pZiBpdCBpcywgd2UgbW9kaWZ5IGl0cyB3ZWlnaHRcblx0XHRcdFx0XHRcdGlmIChzb3VyY2UgPT0gbnVsbCB8fCB0YXJnZXQgPT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGlmIChhZGRlZF9saW5rc1tzb3VyY2UuaWQgKyAnLScgKyB0YXJnZXQuaWRdID09PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0XHRcdFx0dmFyIGxpbmsgPSBuZXcgVmlzdWFsaXplckxpbmsuTGluayhzb3VyY2UsIHRhcmdldCwgd2VpZ2h0KTtcblx0XHRcdFx0XHRcdFx0YWRkZWRfbGlua3Nbc291cmNlLmlkICsgJy0nICsgdGFyZ2V0LmlkXSA9IGxpbms7XG5cdFx0XHRcdFx0XHRcdGxpbmtzLnB1c2gobGluayk7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHR2YXIgZXhpc3RpbmdfbGluayA9IGFkZGVkX2xpbmtzW3NvdXJjZS5pZCArICctJyArIHRhcmdldC5pZF07XG5cdFx0XHRcdFx0XHRcdGV4aXN0aW5nX2xpbmsuc2V0V2VpZ2h0KGV4aXN0aW5nX2xpbmsuZ2V0UmF3V2VpZ2h0KCkgKyB3ZWlnaHQpO1xuXHRcdFx0XHRcdFx0XHRleGlzdGluZ19saW5rLmluY3JlYXNlQ291bnQoKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIGxpbmtzO1xuXHRcdFx0fVxuXHRcdH1dKTtcblxuXHRcdHJldHVybiBWaXN1YWxpemVyRGF0YVNvdXJjZTtcblx0fShEYXRhU291cmNlLkRhdGFTb3VyY2UpO1xuXG5cdHJldHVybiB7XG5cdFx0RGF0YVNvdXJjZTogVmlzdWFsaXplckRhdGFTb3VyY2Vcblx0fTtcbn1dKTtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLyoqXG4gKiBUaGUgYmFzZSBjbGFzcyB0aGUgZ3JhcGggb2JqZWN0LiBBbnkgbm9kZXMgb3IgbGlua3MgdGhhdCBhcmUgY29udGFpbmVkIGluXG4gKiBpdHMgbm9kZXMgb3IgbGlua3MgcHJvcGVydHkgd2lsbCBiZSBkcmF3biBvbiB1cGRhdGVHcmFwaC5cbiAqIFN1cHBvcnRzIHBvbGljaWVzLlxuICogXG4gKiBUbyB3cml0ZSB5b3VyIG93biBncmFwaCBvYmplY3QsIGNyZWF0ZSBhIG5ldyBmYWN0b3J5IHRoYXQgdXNlcyB0aGUgZ3JhcGhcbiAqIHlvdSB3YW50IHRvIGluaGVyaXQgYXMgYSBkZXBlbmRlbmN5LCBhbmQgZXh0ZW5kIGl0cyBncmFwaCBjbGFzcy4gXG4gKiBSZXR1cm4gdGhlIGNsYXNzIG9iamVjdCB3aXRoIEdyYXBoIGFzIGtleS5cbiAqIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnR3JhcGgnLCBbJ1BvbGljeVNlcnZpY2UnLCBmdW5jdGlvbiAoUG9saWN5U2VydmljZSkge1xuICAgIHZhciBHcmFwaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGNvbnN0cnVjdG9yIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAgICAge0hUTUwgU1ZHfSAgc3ZnICAgICBUaGUgc3ZnIHRoYXQgd2lsbCBcbiAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob2xkIHRoZSBncmFwaFxuICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlcyAgICAgIExpc3Qgb2Ygbm9kZXMgZm9yIHRoZSBncmFwaFxuICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBsaW5rcyAgICAgIExpc3Qgb2YgbGlua3MgZm9yIHRoZSBncmFwaFxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gR3JhcGgoc3ZnLCBub2RlcywgbGlua3MpIHtcbiAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBHcmFwaCk7XG5cbiAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMgPSBub2RlcyB8fCBbXTtcbiAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IGxpbmtzIHx8IFtdO1xuXG4gICAgICAgICAgICB0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcyA9IFtdO1xuICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMgPSBbXTtcblxuICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeSA9IG5ldyBQb2xpY3lTZXJ2aWNlLlBvbGljeSgpO1xuXG4gICAgICAgICAgICB0aGlzR3JhcGguc3RhdGUgPSB7XG4gICAgICAgICAgICAgICAgY2FuWm9vbTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjYW5QYW46IHRydWUsXG4gICAgICAgICAgICAgICAgaW5pdEZvcmNlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBkaXNhYmxlVXBkYXRlOiBmYWxzZVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdGhpc0dyYXBoLmNvbnN0cyA9IHtcbiAgICAgICAgICAgICAgICBjaXJjbGVHQ2xhc3M6IFwiY29uY2VwdEdcIixcbiAgICAgICAgICAgICAgICBncmFwaENsYXNzOiBcImdyYXBoXCIsXG4gICAgICAgICAgICAgICAgcGF0aENsYXNzOiBcInBhdGhcIixcbiAgICAgICAgICAgICAgICBub2RlQ2xhc3M6IFwiY2lyY2xlXCIsXG4gICAgICAgICAgICAgICAgbm9kZVRleHQ6IFwibm9kZVRleHRcIixcbiAgICAgICAgICAgICAgICBzdGFydFJhZGl1czogNTAsXG4gICAgICAgICAgICAgICAgbWF4UmFkaXVzOiA2MCxcbiAgICAgICAgICAgICAgICBwYWRkaW5nOiA1LFxuICAgICAgICAgICAgICAgIGRpc3BsYXlPZmZzZXQ6IDYwXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBzdmcub24oXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wibW91c2VvdmVyXCJdLmNhbGwodGhpcywgZCk7XG4gICAgICAgICAgICB9KS5vbihcImRibGNsaWNrXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcImRibGNsaWNrXCJdLmNhbGwodGhpcywgZCk7XG4gICAgICAgICAgICB9KS5vbihcImNvbnRleHRtZW51XCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcImNvbnRleHRtZW51XCJdLmNhbGwodGhpcywgZCk7XG4gICAgICAgICAgICB9KS5vbihcIm1vdXNlb3V0XCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcIm1vdXNlb3V0XCJdLmNhbGwodGhpcywgZCk7XG4gICAgICAgICAgICB9KS5vbihcIm1vdXNlZG93blwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3lbXCJtb3VzZWRvd25cIl0uY2FsbCh0aGlzLCBkKTtcbiAgICAgICAgICAgIH0pLm9uKFwibW91c2V1cFwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3lbXCJtb3VzZXVwXCJdLmNhbGwodGhpcywgZCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gZGVmaW5lIGFycm93IG1hcmtlcnMgZm9yIGdyYXBoIGxpbmtzXG4gICAgICAgICAgICB2YXIgZGVmcyA9IHN2Zy5hcHBlbmQoJ3N2ZzpkZWZzJyk7XG4gICAgICAgICAgICBkZWZzLmFwcGVuZCgnc3ZnOm1hcmtlcicpLmF0dHIoJ2lkJywgJ2VuZC1hcnJvdycpLmF0dHIoXCJ2aWV3Qm94XCIsIFwiMCAtNSAxMCAxMFwiKS5hdHRyKFwicmVmWFwiLCAyMCkuYXR0cihcInJlZllcIiwgLTEpLmF0dHIoXCJtYXJrZXJXaWR0aFwiLCA2KS5hdHRyKFwibWFya2VySGVpZ2h0XCIsIDYpLmF0dHIoXCJvcmllbnRcIiwgXCJhdXRvXCIpLmFwcGVuZChcInBhdGhcIikuYXR0cihcImRcIiwgXCJNMCwtNUwxMCwwTDAsNVwiKTtcblxuICAgICAgICAgICAgLy8gZGVmaW5lIGFycm93IG1hcmtlcnMgZm9yIGxlYWRpbmcgYXJyb3dcbiAgICAgICAgICAgIGRlZnMuYXBwZW5kKCdzdmc6bWFya2VyJykuYXR0cignaWQnLCAnbWFyay1lbmQtYXJyb3cnKS5hdHRyKCd2aWV3Qm94JywgJzAgLTUgMTAgMTAnKS5hdHRyKCdyZWZYJywgNykuYXR0cignbWFya2VyV2lkdGgnLCAzLjUpLmF0dHIoJ21hcmtlckhlaWdodCcsIDMuNSkuYXR0cignb3JpZW50JywgJ2F1dG8nKS5hcHBlbmQoJ3N2ZzpwYXRoJykuYXR0cignZCcsICdNMCwtNUwxMCwwTDAsNScpO1xuXG4gICAgICAgICAgICB0aGlzR3JhcGguc3ZnID0gc3ZnO1xuICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z0cgPSBzdmcuYXBwZW5kKFwiZ1wiKS5jbGFzc2VkKHRoaXNHcmFwaC5jb25zdHMuZ3JhcGhDbGFzcywgdHJ1ZSk7XG4gICAgICAgICAgICB2YXIgc3ZnRyA9IHRoaXNHcmFwaC5zdmdHO1xuXG4gICAgICAgICAgICAvLyBzdmcgbm9kZXMgYW5kIGxpbmtzIFxuICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzID0gc3ZnRy5hcHBlbmQoXCJnXCIpLnNlbGVjdEFsbChcImdcIik7XG4gICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcyA9IHN2Z0cuYXBwZW5kKFwiZ1wiKS5zZWxlY3RBbGwoXCJnXCIpO1xuICAgICAgICAgICAgdGhpc0dyYXBoLmluaXROb2RlcygpO1xuICAgICAgICAgICAgdGhpc0dyYXBoLmluaXRMaW5rcygpO1xuXG4gICAgICAgICAgICB0aGlzR3JhcGguc2V0UG9zaXRpb25zKCk7XG4gICAgICAgICAgICB2YXIgcmVzaXplRnVuYyA9IGZ1bmN0aW9uIHJlc2l6ZUZ1bmMoKSB7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm9uV2luZG93UmVzaXplKHN2Zyk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0aGlzR3JhcGguYmluZGluZ3MgPSB7XG4gICAgICAgICAgICAgICAgcmVzaXplOiByZXNpemVGdW5jXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgJCh3aW5kb3cpLnJlc2l6ZShyZXNpemVGdW5jKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBjYWxscyB0aGUgZGVzdHJveSBtZXRob2QgZm9yIGFsbCBwb2xpY2llc1xuICAgICAgICAgKi9cblxuXG4gICAgICAgIF9jcmVhdGVDbGFzcyhHcmFwaCwgW3tcbiAgICAgICAgICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeS5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHRoaXNHcmFwaC5iaW5kaW5ncykge1xuICAgICAgICAgICAgICAgICAgICAkKHdpbmRvdykub2ZmKGtleSwgdGhpc0dyYXBoLmJpbmRpbmdzW2tleV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSdW5zIHRoZSBpbml0IGZ1bmN0aW9uIGZvciBhbGwgdGhlIG5vZGVzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdpbml0Tm9kZXMnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXROb2RlcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBub2RlLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSdW5zIHRoZSBpbml0IGZ1bmN0aW9uIGZvciBhbGwgdGhlIGxpbmtzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdpbml0TGlua3MnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRMaW5rcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLmxpbmtzLCBmdW5jdGlvbiAobGluaykge1xuICAgICAgICAgICAgICAgICAgICBsaW5rLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiByZXR1cm5zIHRoZSBub2RlIG1hdGNoaW5nIHRoZSBpZCwgXG4gICAgICAgICAgICAgKiBvciB1bmRlZmluZWQgaWYgdGhlcmUgaXMgbm9uZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7Tm9kZX0gIHsgbWF0Y2hpbmcgbm9kZSB9XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdmaW5kTm9kZUJ5SWQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmROb2RlQnlJZChpZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpc0dyYXBoLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpZCA9PT0gdGhpc0dyYXBoLm5vZGVzW2ldLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpc0dyYXBoLm5vZGVzW2ldO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdmaW5kRDNOb2RlJyxcblxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJldHVybnMgdGhlIGQzTm9kZSBvYmplY3QgdGhhdCBtYXRjaGVzIHRoZSBpZCxcbiAgICAgICAgICAgICAqIG9yIHVuZGVmaW5lZCBpZiB0aGVyZSBpcyBub25lXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGlkICAgICAgVGhlIGlkZW50aWZpZXJcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtEM05vZGV9IFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBmaW5kRDNOb2RlKGlkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIGQzTm9kZTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5lYWNoKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmlkID09PSBpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZDNOb2RlID0gZDMuc2VsZWN0KHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGQzTm9kZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIGluc3RhbGwgYSBkcmFnIHBvbGljeSB0aGF0IHdpbGwgYmUgY2FsbGVkXG4gICAgICAgICAgICAgKiB3aGVuIG5vZGVzIGFyZSBkcmFnZ2VkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzLmJlaGF2aW9yLmRyYWd9ICBkM2RyYWcgIEQzIGRyYWcgb2JqZWN0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdpbnN0YWxsRHJhZ1BvbGljeScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5zdGFsbERyYWdQb2xpY3koZDNkcmFnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kcmFnID0gZDNkcmFnO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVzZWQgdG8gaW5zdGFsbCBhIHBvbGljeSB0aGF0IHdpbGwgYmUgY2FsbGVkIFxuICAgICAgICAgICAgICogd2hlbiB0aGVyZSBpcyBtb3VzZSBpbnRlcmFjdGlvbnMgd2l0aCB0aGUgZ3JhcGgncyBzdmdcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UG9saWN5fSAgcG9saWN5ICBUaGUgcG9saWN5IHRvIGluc3RhbGxcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2luc3RhbGxTdmdQb2xpY3knLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluc3RhbGxTdmdQb2xpY3kocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdmdQb2xpY3kgPSBwb2xpY3k7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byBpbnN0YWxsIHBvbGljaWVzIHRoYXQgYXJlIGNhbGxlZCB3aGVuIHRoZXJlIGlzXG4gICAgICAgICAgICAgKiBtb3VzZSBpbnRlcmFjdGlvbiB3aXRoIGEgbm9kZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3kgIFRoZSBwb2xpY3kgdG8gaW5zdGFsbFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnaW5zdGFsbERlZmF1bHROb2RlUG9saWN5JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbnN0YWxsRGVmYXVsdE5vZGVQb2xpY3kocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMucHVzaChwb2xpY3kpO1xuICAgICAgICAgICAgICAgIHBvbGljeS5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byByZW1vdmUgYW4gaW5zdGFsbGVkIHBvbGljeSBmb3Igbm9kZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHBvbGljeVJlbW92ZSAgVGhlIHBvbGljeSB0byByZW1vdmVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3VuaW5zdGFsbERlZmF1bHROb2RlUG9saWN5JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1bmluc3RhbGxEZWZhdWx0Tm9kZVBvbGljeShwb2xpY3lSZW1vdmUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcG9saWN5UmVtb3ZlTmFtZTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHBvbGljeVJlbW92ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlLnBvbGljeU5hbWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24gKHBvbGljeSwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvbGljeS5wb2xpY3lOYW1lID09PSBwb2xpY3lSZW1vdmVOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2xpY3kuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJldHVybnMgdGhlIG5vZGUgcG9saWN5IG9iamVjdCB3aXRoIHRoZSBnaXZlbiBuYW1lXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHBvbGljeU5hbWUgIFRoZSBwb2xpY3kgbmFtZVxuICAgICAgICAgICAgICogQHJldHVybiAgICAge1BvbGljeX0gIHBvbGljeSAgICAgIFRoZSBtYXRjaGluZyBwb2xpY3lcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2dldE5vZGVQb2xpY3knLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldE5vZGVQb2xpY3kocG9saWN5TmFtZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5LCBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9saWN5LnBvbGljeU5hbWUgPT09IHBvbGljeU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwb2xpY3k7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIGluc3RhbGwgcG9saWNpZXMgdGhhdCBhcmUgY2FsbGVkIHdoZW4gdGhlcmUgaXMgYVxuICAgICAgICAgICAgICogbW91c2UgaW50ZXJhY3Rpb24gd2l0aCBhIHBhdGhcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UG9saWN5fSAgcG9saWN5ICBUaGUgcG9saWN5IHRvIGluc3RhbGxcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2luc3RhbGxEZWZhdWx0UGF0aFBvbGljeScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5zdGFsbERlZmF1bHRQYXRoUG9saWN5KHBvbGljeSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzLnB1c2gocG9saWN5KTtcbiAgICAgICAgICAgICAgICBwb2xpY3kuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVzZWQgdG8gcmVtb3ZlIGFuIGluc3RhbGxlZCBwb2xpY3kgZm9yIGxpbmtzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeVJlbW92ZSAgVGhlIHBvbGljeSB0byByZW1vdmVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3VuaW5zdGFsbERlZmF1bHRQYXRoUG9saWN5JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1bmluc3RhbGxEZWZhdWx0UGF0aFBvbGljeShwb2xpY3lSZW1vdmUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcG9saWN5UmVtb3ZlTmFtZTtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHBvbGljeVJlbW92ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlLnBvbGljeU5hbWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24gKHBvbGljeSwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvbGljeS5wb2xpY3lOYW1lID09PSBwb2xpY3lSZW1vdmVOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2xpY3kuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZXJlIGlzIGEgbW91c2UgaW50ZXJhY3Rpb24gd2l0aCBhIHBhdGhcbiAgICAgICAgICAgICAqIFByb3BvZ2F0ZXMgdGhlIGV2ZW50IHRvIGFsbCBpbnN0YWxsZWQgcGF0aCBwb2xpY2llc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBldmVudCAgIFRoZSBldmVudCB0eXBlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7ZDNvYmplY3R9ICBkM3BhdGggIFRoZSBkMyBwYXRoXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UGF0aH0gIGQgICAgICAgVGhlIG1hdGNoaW5nIExpbmsgb2JqZWN0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdwYXRoUG9saWN5RXZlbnQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHBhdGhQb2xpY3lFdmVudChldmVudCwgZDNwYXRoLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVtldmVudF0oZDNwYXRoLCBkKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGVyZSBpcyBhIG1vdXNlIGludGVyYWN0aW9uIHdpdGggYSBub2RlXG4gICAgICAgICAgICAgKiBQcm9wb2dhdGVzIHRoZSBldmVudCB0byBhbGwgaW5zdGFsbGVkIG5vZGUgcG9saWNpZXNcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGV2ZW50ICAgVGhlIGV2ZW50IHR5cGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM29iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQYXRofSAgZCAgICAgICBUaGUgbWF0Y2hpbmcgTm9kZSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ25vZGVQb2xpY3lFdmVudCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbm9kZVBvbGljeUV2ZW50KGV2ZW50LCBkM25vZGUsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMsIGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5W2V2ZW50XShkM25vZGUsIGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNldHMgcGFuIGFuZCB6b29tIHJ1bGVzIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7ZDMuYmVoYXZpb3Iuem9vbX0gIGQzem9vbSAgRDMgem9vbSBvYmpcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2luc3RhbGxab29tUG9saWN5JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbnN0YWxsWm9vbVBvbGljeShkM3pvb20pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRyYWdTdmcgPSBkM3pvb207XG4gICAgICAgICAgICAgICAgdGhpcy5zdmcuY2FsbCh0aGlzLmRyYWdTdmcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSB3aW5kb3cgaXMgcmVzaXplZFxuICAgICAgICAgICAgICogSG9vayBmb3Igb3ZlcnJpZGluZyBpbiBzdWJjbGFzc2VzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0hUTUwgU1ZHfSAgc3ZnICAgICBUaGUgc3ZnIHRoYXQgdGhlIGhhbmRsZXJcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXMgYXR0YWNoZWQgdG9cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ29uV2luZG93UmVzaXplJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvbldpbmRvd1Jlc2l6ZShzdmcpIHt9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogSW5zZXJ0cyBsaW5lIGJyZWFrcyBpbiBub2RlIHRleHRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBFbGVtfSAgZ0VsICAgIFRoZSBlbGVtIHRvIGFkZCB0ZXh0IHRvXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgdGl0bGUgICBUaGUgdGl0bGVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2luc2VydFRpdGxlTGluZWJyZWFrcycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5zZXJ0VGl0bGVMaW5lYnJlYWtzKGdFbCwgdGl0bGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgd29yZHMgPSB0aXRsZS5zcGxpdCgvXFxzKy9nKSxcbiAgICAgICAgICAgICAgICAgICAgbndvcmRzID0gd29yZHMubGVuZ3RoO1xuICAgICAgICAgICAgICAgIHZhciBlbCA9IGdFbC5hcHBlbmQoXCJ0ZXh0XCIpLmF0dHIoJ2NsYXNzJywgdGhpc0dyYXBoLmNvbnN0cy5ub2RlVGV4dCkuYXR0cihcInRleHQtYW5jaG9yXCIsIFwibWlkZGxlXCIpLmF0dHIoXCJkeVwiLCBcIi1cIiArIChud29yZHMgLSAxKSAqIDcuNSk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHdvcmRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0c3BhbiA9IGVsLmFwcGVuZCgndHNwYW4nKS50ZXh0KHdvcmRzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgPiAwKSB0c3Bhbi5hdHRyKCd4JywgMCkuYXR0cignZHknLCAnMTUnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyBhbGwgbGlua3MgZnJvbSB0aGUgZ2l2ZW4gbm9kZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnc3BsaWNlTGlua3NGb3JOb2RlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzcGxpY2VMaW5rc0Zvck5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICB0b1NwbGljZSA9IHRoaXNHcmFwaC5saW5rcy5maWx0ZXIoZnVuY3Rpb24gKGwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGwuc291cmNlID09PSBub2RlIHx8IGwudGFyZ2V0ID09PSBub2RlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRvU3BsaWNlLm1hcChmdW5jdGlvbiAobCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3Muc3BsaWNlKHRoaXNHcmFwaC5saW5rcy5pbmRleE9mKGwpLCAxKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBBZGRzIHRoZSBub2RlIHRvIHRoZSBncmFwaCBhbmQgdXBkYXRlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnYWRkTm9kZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYWRkTm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnB1c2gobm9kZSk7XG4gICAgICAgICAgICAgICAgbm9kZS5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3JlbW92ZU5vZGUnLFxuXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyB0aGUgbm9kZSB0byB0aGUgZ3JhcGggYW5kIHVwZGF0ZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZU5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5zcGxpY2UodGhpc0dyYXBoLm5vZGVzLmluZGV4T2Yobm9kZSksIDEpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zcGxpY2VMaW5rc0Zvck5vZGUobm9kZSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnYWRkTGluaycsXG5cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBBZGRzIHRoZSBsaW5rIHRvIHRoZSBncmFwaCBhbmQgdXBkYXRlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtsaW5rfSAgbGluayAgICBUaGUgbGlua1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYWRkTGluayhsaW5rKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzLnB1c2gobGluayk7XG4gICAgICAgICAgICAgICAgbGluay5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3JlbW92ZUxpbmsnLFxuXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyB0aGUgbGluayB0byB0aGUgZ3JhcGggYW5kIHVwZGF0ZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bGlua30gIGxpbmsgICAgVGhlIGxpbmtcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZUxpbmsobGluaykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcy5zcGxpY2UodGhpc0dyYXBoLmxpbmtzLmluZGV4T2YobGluayksIDEpO1xuICAgICAgICAgICAgICAgIGxpbmsuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyB1cGRhdGluZyBleGlzdGluZyBwYXRoc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQYXRofSAgcGF0aHMgICBMaXN0IG9mIHBhdGhzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd1cGRhdGVFeGlzdGluZ1BhdGhzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVFeGlzdGluZ1BhdGhzKHBhdGhzKSB7XG4gICAgICAgICAgICAgICAgcGF0aHMuZWFjaChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBkLnVwZGF0ZUF0dHIoZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgYWRkaW5nIG5ldyBwYXRoc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQYXRofSAgbmV3UGF0aHMgIExpc3Qgb2YgbmV3IHBhdGhzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd1cGRhdGVOZXdQYXRocycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlTmV3UGF0aHMobmV3UGF0aHMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0TGlua3MoKTtcblxuICAgICAgICAgICAgICAgIG5ld1BhdGhzLmVhY2goZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5uZXdQYXRoQXR0cihkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy9pZiBub2RlIGRvZXNuJ3QgaGF2ZSBpdHMgb3duIHBvbGljeSwgdXNlIGRlZmF1bHQgZm9yIHRoZSBncmFwaFxuICAgICAgICAgICAgICAgIG5ld1BhdGhzLm9uKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZW92ZXJcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZW92ZXJcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLm9uKFwiZGJsY2xpY2tcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLnBhdGhQb2xpY3lFdmVudChcImRibGNsaWNrXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aFBvbGljeUV2ZW50KFwiZGJsY2xpY2tcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLm9uKFwiY29udGV4dG1lbnVcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLnBhdGhQb2xpY3lFdmVudChcImNvbnRleHRtZW51XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aFBvbGljeUV2ZW50KFwiY29udGV4dG1lbnVcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLm9uKFwibW91c2VvdXRcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlb3V0XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aFBvbGljeUV2ZW50KFwibW91c2VvdXRcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLm9uKFwibW91c2Vkb3duXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZWRvd25cIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZWRvd25cIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLm9uKFwibW91c2V1cFwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQucGF0aFBvbGljeUV2ZW50KFwibW91c2V1cFwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcIm1vdXNldXBcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpc0dyYXBoLmRyYWcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyB1cGRhdGluZyBleGlzdGluZyBub2Rlc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAndXBkYXRlRXhpc3RpbmdOb2RlcycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlRXhpc3RpbmdOb2RlcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcyA9IHRoaXMuY2lyY2xlcy5kYXRhKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuaWQ7XG4gICAgICAgICAgICAgICAgfSkuZWFjaChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBkLnVwZGF0ZUF0dHIoZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgYWRkaW5nIG5ldyBub2Rlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbmV3Tm9kZXMgIExpc3Qgb2YgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd1cGRhdGVOZXdOb2RlcycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlTmV3Tm9kZXMobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgICAgIG5ld05vZGVzLmVhY2goZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuZ3JhcGggPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZC5uZXdOb2RlQXR0cihkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy9pZiBub2RlIGRvZXNuJ3QgaGF2ZSBpdHMgb3duIHBvbGljeSwgdXNlIGRlZmF1bHQgZm9yIHRoZSBncmFwaFxuICAgICAgICAgICAgICAgIG5ld05vZGVzLm9uKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5ub2RlUG9saWN5RXZlbnQoXCJtb3VzZW92ZXJcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlUG9saWN5RXZlbnQoXCJtb3VzZW92ZXJcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLm9uKFwiZGJsY2xpY2tcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcImRibGNsaWNrXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwiZGJsY2xpY2tcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLm9uKFwiY29udGV4dG1lbnVcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcImNvbnRleHRtZW51XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwiY29udGV4dG1lbnVcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLm9uKFwibW91c2VvdXRcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlb3V0XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwibW91c2VvdXRcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLm9uKFwibW91c2Vkb3duXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5ub2RlUG9saWN5RXZlbnQoXCJtb3VzZWRvd25cIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlUG9saWN5RXZlbnQoXCJtb3VzZWRvd25cIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLm9uKFwibW91c2V1cFwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQubm9kZVBvbGljeUV2ZW50KFwibW91c2V1cFwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcIm1vdXNldXBcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpc0dyYXBoLmRyYWcpO1xuXG4gICAgICAgICAgICAgICAgbmV3Tm9kZXMuYXBwZW5kKFwiY2lyY2xlXCIpLmF0dHIoXCJyXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBTdHJpbmcoZC5yYWRpdXMpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgbmV3Tm9kZXMuZWFjaChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5zZXJ0VGl0bGVMaW5lYnJlYWtzKGQzLnNlbGVjdCh0aGlzKSwgZC50ZXh0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBQcmV2ZW50cyBub2RlcyBmcm9tIGNvbGxpZGluZ1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICBhbHBoYSAgIEFmZmVjdHMgaG93IG11Y2ggY2hhbmdlXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGUgY29sbGlzaW9uIGNhdXNlc1xuICAgICAgICAgICAgICogQHJldHVybiAgICAge2Jvb2xlYW59ICB7V2hldGhlciBub2RlcyBhcmUgY29sbGlkZWR9XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkM0ZvcmNlQ29sbGlkZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZDNGb3JjZUNvbGxpZGUoYWxwaGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cztcbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICAgICAgdmFyIHF1YWR0cmVlID0gZDMuZ2VvbS5xdWFkdHJlZShub2Rlcyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByID0gZC5yYWRpdXMgKyBjb25zdHMubWF4UmFkaXVzICsgY29uc3RzLnBhZGRpbmcsXG4gICAgICAgICAgICAgICAgICAgICAgICBueDEgPSBkLnggLSByLFxuICAgICAgICAgICAgICAgICAgICAgICAgbngyID0gZC54ICsgcixcbiAgICAgICAgICAgICAgICAgICAgICAgIG55MSA9IGQueSAtIHIsXG4gICAgICAgICAgICAgICAgICAgICAgICBueTIgPSBkLnkgKyByO1xuICAgICAgICAgICAgICAgICAgICBxdWFkdHJlZS52aXNpdChmdW5jdGlvbiAocXVhZCwgeDEsIHkxLCB4MiwgeTIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChxdWFkLnBvaW50ICYmIHF1YWQucG9pbnQgIT09IGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IGQueCAtIHF1YWQucG9pbnQueCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeSA9IGQueSAtIHF1YWQucG9pbnQueSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbCA9IE1hdGguc3FydCh4ICogeCArIHkgKiB5KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgciA9IGQucmFkaXVzICsgcXVhZC5wb2ludC5yYWRpdXMgKyBjb25zdHMucGFkZGluZztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobCA8IHIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbCA9IChsIC0gcikgLyBsICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCAtPSB4ICo9IGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSAtPSB5ICo9IGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1YWQucG9pbnQueCArPSB4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWFkLnBvaW50LnkgKz0geTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geDEgPiBueDIgfHwgeDIgPCBueDEgfHwgeTEgPiBueTIgfHwgeTIgPCBueTE7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVGljayBvZiB0aGUgZDMgZm9yY2Ugc2ltdWxhdGlvblxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM3RpY2sgZXZlbnR9ICBlICAgIEQzdGljayBldmVudFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge251bWJlcn0gIHdpZHRoICBUaGUgd2lkdGggb2YgdGhlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICBoZWlnaHQgVGhlIGhlaWdodCBvZiB0aGUgc2ltdWxhdGlvblxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZDNGb3JjZVRpY2snLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGQzRm9yY2VUaWNrKGUsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cztcblxuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSBjb25zdHMuZGlzcGxheU9mZnNldDtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICAgICAgdmFyIHEgPSBkMy5nZW9tLnF1YWR0cmVlKHRoaXNHcmFwaC5ub2RlcyksXG4gICAgICAgICAgICAgICAgICAgIGkgPSAwLFxuICAgICAgICAgICAgICAgICAgICBuID0gbm9kZXMubGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgd2hpbGUgKCsraSA8IG4pIHtcbiAgICAgICAgICAgICAgICAgICAgcS52aXNpdCh0aGlzLmQzRm9yY2VDb2xsaWRlKG5vZGVzW2ldKSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZWFjaCh0aGlzLmQzRm9yY2VDb2xsaWRlKC41KSkuYXR0cihcImN4XCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnggPSBNYXRoLm1heChkLnJhZGl1cyArIG9mZnNldCwgTWF0aC5taW4od2lkdGggLSBvZmZzZXQgLSBkLnJhZGl1cywgZC54KSk7XG4gICAgICAgICAgICAgICAgfSkuYXR0cihcImN5XCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnkgPSBNYXRoLm1heChkLnJhZGl1cyArIG9mZnNldCwgTWF0aC5taW4oaGVpZ2h0IC0gb2Zmc2V0IC0gZC5yYWRpdXMsIGQueSkpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzLmF0dHIoJ3gxJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuc291cmNlLng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneTEnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5zb3VyY2UueTtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd4MicsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnRhcmdldC54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3kyJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQudGFyZ2V0Lnk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU3RhcnRzIG9uIHN0YXJ0IG9mIHRoZSBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkM0ZvcmNlU3RhcnQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGQzRm9yY2VTdGFydCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHMuYXR0cigneDEnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5zb3VyY2UueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd5MScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnNvdXJjZS55O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3gyJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQudGFyZ2V0Lng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneTInLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC50YXJnZXQueTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgb24gdGhlIGVuZCBvZiB0aGUgZm9yY2Ugc2ltdWxhdGlvblxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZDNGb3JjZUVuZCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZDNGb3JjZUVuZCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5hdHRyKCdjeCcsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cignY3knLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55O1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzLmF0dHIoJ3gxJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuc291cmNlLng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneTEnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5zb3VyY2UueTtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd4MicsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnRhcmdldC54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3kyJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQudGFyZ2V0Lnk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsY3VsYXRlcyB0aGUgd2lkdGggYW5kIGhlaWdodCBib3VuZHMgZm9yIHRoZSBcbiAgICAgICAgICAgICAqIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7T2JqZWN0fSAgd2lkdGggYW5kIGhlaWdodCBhcyBwcm9wZXJ0aWVzIFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZDNGb3JjZUJvdW5kcycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZDNGb3JjZUJvdW5kcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnV2lkdGggPSAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLndpZHRoKCk7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z0hlaWdodCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykuaGVpZ2h0KCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBzdmdXaWR0aDtcbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gc3ZnSGVpZ2h0O1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHdpZHRoOiB3aWR0aCwgaGVpZ2h0OiBoZWlnaHQgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBEb2VzIGEgZDMgZm9yY2Ugc2ltdWxhdGlvblxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtGdW5jdGlvbn0gIGNhbGxiYWNrICBUaGUgY2FsbGJhY2tcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3NldEZvcmNlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRGb3JjZShjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgICAgIHZhciBsaW5rcyA9IHRoaXNHcmFwaC5saW5rcztcbiAgICAgICAgICAgICAgICBpZiAoXy5pc0VtcHR5KG5vZGVzKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGJvdW5kcyA9IHRoaXNHcmFwaC5kM0ZvcmNlQm91bmRzKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgZm9yY2UgPSBkMy5sYXlvdXQuZm9yY2UoKS5zaXplKFtib3VuZHMud2lkdGgsIGJvdW5kcy5oZWlnaHRdKS5ub2Rlcyhub2RlcykuY2hhcmdlKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtNjAwMDtcbiAgICAgICAgICAgICAgICB9KS5saW5rcyhsaW5rcyk7XG5cbiAgICAgICAgICAgICAgICBmb3JjZS5saW5rRGlzdGFuY2UoYm91bmRzLndpZHRoIC8gMyk7XG4gICAgICAgICAgICAgICAgZm9yY2UubGlua1N0cmVuZ3RoKC4yKTtcbiAgICAgICAgICAgICAgICBmb3JjZS5ncmF2aXR5KC4yKTtcblxuICAgICAgICAgICAgICAgIGZvcmNlLm9uKCd0aWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLmQzRm9yY2VUaWNrLmNhbGwodGhpc0dyYXBoLCBlLCBib3VuZHMud2lkdGgsIGJvdW5kcy5oZWlnaHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZm9yY2Uub24oJ3N0YXJ0JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguZDNGb3JjZVN0YXJ0LmNhbGwodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGZvcmNlLm9uKCdlbmQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kM0ZvcmNlRW5kLmNhbGwodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGZvcmNlLnN0YXJ0KCk7XG4gICAgICAgICAgICAgICAgdmFyIGsgPSAwO1xuICAgICAgICAgICAgICAgIHdoaWxlIChmb3JjZS5hbHBoYSgpID4gMWUtMiAmJiBrIDwgMTUwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvcmNlLnRpY2soKTtcbiAgICAgICAgICAgICAgICAgICAgayA9IGsgKyAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmb3JjZS5zdG9wKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTZXRzIHRoZSBwb3NpdGlvbnMgdG8gYmUgdGhlIGNlbnRlciBvZiB0aGUgc2NyZWVuIGlmIFxuICAgICAgICAgICAgICogbm90IHByb3ZpZGVkXG4gICAgICAgICAgICAgKiBhbHNvIHNldHMgdGhlIHJhZGl1cyBvZiB0aGUgbm9kZXNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3NldFBvc2l0aW9ucycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0UG9zaXRpb25zKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IHRoaXNHcmFwaC5jb25zdHMuZGlzcGxheU9mZnNldDtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnV2lkdGggPSAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLndpZHRoKCk7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z0hlaWdodCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykuaGVpZ2h0KCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBzdmdXaWR0aCAtIDIgKiBvZmZzZXQ7XG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IHN2Z0hlaWdodCAtIDIgKiBvZmZzZXQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVzW2ldLnJhZGl1cyA9IG5vZGVzW2ldLnJhZGl1cyB8fCB0aGlzR3JhcGguY29uc3RzLnN0YXJ0UmFkaXVzO1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZXNbaV0ueCA9PSBudWxsIHx8IG5vZGVzW2ldLnkgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm9kZXNbaV0ueFN0YXJ0ID0gd2lkdGgvMiAgKyBub2Rlc1tpXS5yYWRpdXMgKyBvZmZzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzW2ldLnggPSB3aWR0aCAvIDIgKyBub2Rlc1tpXS5yYWRpdXMgKyBvZmZzZXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBub2Rlc1tpXS55U3RhcnQgPSBoZWlnaHQvMiArIG5vZGVzW2ldLnJhZGl1cyArIG9mZnNldFxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNbaV0ueSA9IGhlaWdodCAvIDIgKyBub2Rlc1tpXS5yYWRpdXMgKyBvZmZzZXQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHRvIHVwZGF0ZSB0aGUgdmlldyBvZiB0aGUgZ3JhcGggd2hlblxuICAgICAgICAgICAgICogZGF0YSBjaGFuZ2VzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0Z1bmN0aW9ufSAgY2FsbGJhY2sgIFRoZSBjYWxsYmFja1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAndXBkYXRlR3JhcGgnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUdyYXBoKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5zdGF0ZS5kaXNhYmxlVXBkYXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUV4aXN0aW5nTm9kZXMoKTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3R3MgPSB0aGlzR3JhcGguY2lyY2xlcy5lbnRlcigpLmFwcGVuZChcImdcIik7XG5cbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygndXBkYXRlJywgbmV3R3MpO1xuICAgICAgICAgICAgICAgIG5ld0dzLmNsYXNzZWQoY29uc3RzLmNpcmNsZUdDbGFzcywgdHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICAvLyB0aGlzLnVwZGF0ZU5ld05vZGVzKG5ld0dzKTtcblxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBvbGQgbm9kZXNcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5leGl0KCkucmVtb3ZlKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuaW5pdEZvcmNlID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zZXRGb3JjZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlTmV3Tm9kZXMuY2FsbCh0aGlzR3JhcGgsIG5ld0dzKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmluaXRGb3JjZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVOZXdOb2RlcyhuZXdHcyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzID0gdGhpc0dyYXBoLnBhdGhzLmRhdGEodGhpc0dyYXBoLmxpbmtzLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gU3RyaW5nKGQuc291cmNlLmlkKSArIFwiK1wiICsgU3RyaW5nKGQudGFyZ2V0LmlkKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB2YXIgcGF0aHMgPSB0aGlzR3JhcGgucGF0aHM7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVFeGlzdGluZ1BhdGhzKHBhdGhzKTtcblxuICAgICAgICAgICAgICAgIHZhciBuZXdwYXRocyA9IHBhdGhzLmVudGVyKCkuYXBwZW5kKFwicGF0aFwiKS5zdHlsZSgnbWFya2VyLWVuZCcsICd1cmwoI2VuZC1hcnJvdyknKS5jbGFzc2VkKFwibGlua1wiLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZU5ld1BhdGhzKG5ld3BhdGhzKTtcblxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBvbGQgbGlua3NcbiAgICAgICAgICAgICAgICBwYXRocy5leGl0KCkucmVtb3ZlKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfV0pO1xuXG4gICAgICAgIHJldHVybiBHcmFwaDtcbiAgICB9KCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBHcmFwaDogR3JhcGhcbiAgICB9O1xufV0pO1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbi8qKlxuICogVGhlIGdyYXBoIHRoYXQgaXMgdXNlZCBzcGVjaWZpY2FsbHkgZm9yIHRoZSB2aXN1YWxpemF0aW9uIHRhYi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ1Zpc3VhbGl6ZXJHcmFwaCcsIFsnR3JhcGgnLCBmdW5jdGlvbiAoR3JhcGgpIHtcbiAgICB2YXIgVmlzdWFsaXplckdyYXBoID0gZnVuY3Rpb24gKF9HcmFwaCRHcmFwaCkge1xuICAgICAgICBfaW5oZXJpdHMoVmlzdWFsaXplckdyYXBoLCBfR3JhcGgkR3JhcGgpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgIHtIVE1MIFNWR30gIHN2ZyAgICAgICAgICAgICBUaGUgc3ZnIHRoYXQgd2lsbCBcbiAgICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvbGQgdGhlIGdyYXBoXG4gICAgICAgICAgICAgICAqIEBwYXJhbSAgIHtBcnJheX0gIG5vZGVzICAgXHRcdCAgICBMaXN0IG9mIG5vZGVzXG4gICAgICAgICAgICAgICAqIEBwYXJhbSAgIHtBcnJheX0gIGxpbmtzICAgXHRcdCAgICBMaXN0IG9mIGxpbmtzXG4gICAgICAgICAqIEBwYXJhbSAgIHtEYXRhU291cmNlfSAgZGF0YVNvdXJjZSAgICBUaGUgZGF0YSBzb3VyY2VcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIFZpc3VhbGl6ZXJHcmFwaChzdmcsIG5vZGVzLCBsaW5rcywgZGF0YVNvdXJjZSkge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZpc3VhbGl6ZXJHcmFwaCk7XG5cbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChWaXN1YWxpemVyR3JhcGguX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihWaXN1YWxpemVyR3JhcGgpKS5jYWxsKHRoaXMsIHN2Zywgbm9kZXMsIGxpbmtzKSk7XG5cbiAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSBfdGhpcztcblxuICAgICAgICAgICAgLy9ob2xkcyBjdXJyZW50IHRyYW5zaXRpb25zIHRoYXQgYXJlIG9jY3VyaW5nXG4gICAgICAgICAgICB0aGlzR3JhcGguc3RhdGUudHJhbnNpdGlvbiA9IFtdO1xuICAgICAgICAgICAgLy9NaW4gZGlzdGFuY2UgYmV0d2VlbiBub2RlcyB3aGVuIHNwYXduaW5nIHJhbmRvbWx5XG4gICAgICAgICAgICB0aGlzR3JhcGguY29uc3RzLmVkZ2VfYnVmZmVyID0gMjAwO1xuICAgICAgICAgICAgLy9TaXplIHJlZHVjdGlvbiBhcyB5b3UgZ28gdGhyb3VnaCBsZXZlbHMgaW4gbm9kZXNcbiAgICAgICAgICAgIHRoaXNHcmFwaC5jb25zdHMucmFkaXVzRGVjYXkgPSAxO1xuICAgICAgICAgICAgLy9Dc3MgY2xhc3MgZm9yIG5vZGVzIHRoYXQgYXJlIGNvbnRhaW5lcnNcbiAgICAgICAgICAgIHRoaXNHcmFwaC5jb25zdHMuY29udGFpbmVyQ2xhc3MgPSAnY29udGFpbmVyJztcblxuICAgICAgICAgICAgLy9kYXRhU291cmNlIGhvbGRzIHRoZSBzZXJ2ZXIgZGF0YSBhbmQgbWV0aG9kcyBmb3JcbiAgICAgICAgICAgIC8vY29udmVydGluZyBpdCB0byBkYXRhIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgIHRoaXNHcmFwaC5kYXRhU291cmNlID0gZGF0YVNvdXJjZTtcblxuICAgICAgICAgICAgLy9EcmFnIGJlaGF2aW9yIGZvciBub2Rlc1xuICAgICAgICAgICAgdmFyIGRyYWcgPSBkMy5iZWhhdmlvci5kcmFnKCkub3JpZ2luKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgeDogZC54LCB5OiBkLnkgfTtcbiAgICAgICAgICAgIH0pLm9uKFwiZHJhZ3N0YXJ0XCIsIGZ1bmN0aW9uICgpIHt9KS5vbihcImRyYWdcIiwgZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykuYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbiAoZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICBkLnggKz0gZDMuZXZlbnQuZHg7XG4gICAgICAgICAgICAgICAgICAgIGQueSArPSBkMy5ldmVudC5keTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwidHJhbnNsYXRlKFwiICsgW2QueCwgZC55XSArIFwiKVwiO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfSkub24oXCJkcmFnZW5kXCIsIGZ1bmN0aW9uICgpIHt9KTtcblxuICAgICAgICAgICAgdGhpc0dyYXBoLmRyYWcgPSBkcmFnO1xuXG4gICAgICAgICAgICAvL1BhbiBhbmQgWm9vbSBiZWhhdmlvciBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICB2YXIgem9vbSA9IGQzLmJlaGF2aW9yLnpvb20oKS5vbihcInpvb21cIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChkMy5ldmVudC5zb3VyY2VFdmVudCAhPSBudWxsICYmIGQzLmV2ZW50LnNvdXJjZUV2ZW50LmN0cmxLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQuY2FsbCh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0pLm9uKFwiem9vbXN0YXJ0XCIsIGZ1bmN0aW9uIChkLCBpKSB7fSk7XG4gICAgICAgICAgICB0aGlzR3JhcGguZHJhZ1N2ZyA9IHpvb207XG4gICAgICAgICAgICB0aGlzR3JhcGguc3ZnLmNhbGwoem9vbSkub24oXCJkYmxjbGljay56b29tXCIsIG51bGwpO1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENhbGxlZCB3aXRoIG5vIGFyZ3Mgd2hlbiB0aGUgZ3JhcGggaGFzIGEgem9vbSBhY3Rpb25cbiAgICAgICAgICogQ2FuIGFsc28gYmUgY2FsbGVkIHdpdGggYXJncyB0byBmb3JjZSBhIHpvb20gb3IgcGFuIFxuICAgICAgICAgKiBldmVudCBmb3IgdGhlIGdyYXBoLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgdHJhbnNsYXRlICBUaGUgYW1vdW50IHRvIHRyYW5zbGF0ZVxuICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgc2NhbGUgICAgICBUaGUgYW1vdW50IHRvIHNjYWxlXG4gICAgICAgICAqL1xuXG5cbiAgICAgICAgX2NyZWF0ZUNsYXNzKFZpc3VhbGl6ZXJHcmFwaCwgW3tcbiAgICAgICAgICAgIGtleTogJ3pvb21lZCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gem9vbWVkKHRyYW5zbGF0ZSwgc2NhbGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLnN0YXRlLnJpZ2h0Q2xpY2sgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuanVzdFNjYWxlVHJhbnNHcmFwaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKHRyYW5zbGF0ZSAhPSBudWxsICYmIHNjYWxlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSB0aGlzR3JhcGguZHJhZ1N2ZztcbiAgICAgICAgICAgICAgICAgICAgem9vbS5zY2FsZShzY2FsZSk7XG4gICAgICAgICAgICAgICAgICAgIHpvb20udHJhbnNsYXRlKHRyYW5zbGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIC8vY3JlYXRpbmcgbmFtZXMgdG8gcHJldmVudCB0cmFuc2l0aW9uIGNvbmZsaWN0c1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbVNldENhbGxiYWNrID0gZnVuY3Rpb24gem9vbVNldENhbGxiYWNrKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgem9vbS5zY2FsZShzY2FsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB6b29tLnRyYW5zbGF0ZSh0cmFuc2xhdGUpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB2YXIgdHJhbnNsYXRlX25hbWUgPSBcInpvb21cIiArIHRyYW5zbGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KFwiLlwiICsgdGhpcy5jb25zdHMuZ3JhcGhDbGFzcykudHJhbnNpdGlvbih0cmFuc2xhdGVfbmFtZSkuZGVsYXkoMTAwKS5kdXJhdGlvbig3NTApLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoJyArIHpvb20udHJhbnNsYXRlKCkgKyAnKSBzY2FsZSgnICsgem9vbS5zY2FsZSgpICsgJyknKS5lYWNoKFwiZW5kXCIsIHpvb21TZXRDYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5zdGF0ZS5jYW5ab29tKSB7XG4gICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdChcIi5cIiArIHRoaXMuY29uc3RzLmdyYXBoQ2xhc3MpLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKSArIFwiKSBzY2FsZShcIiArIHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCkgKyBcIilcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdvbldpbmRvd1Jlc2l6ZScsXG5cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgd2luZG93IHJlc2l6ZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBTVkd9ICBzdmcgICAgVGhlIHN2ZyB0byByZXNpemVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uV2luZG93UmVzaXplKHN2Zykge1xuICAgICAgICAgICAgICAgIHZhciBib2R5RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnYm9keScpWzBdO1xuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLm9mZnNldCgpO1xuICAgICAgICAgICAgICAgIHZhciBkaXZXaWR0aCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykud2lkdGgoKTtcbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gYm9keUVsLmNsaWVudEhlaWdodDtcbiAgICAgICAgICAgICAgICBzdmcuYXR0cihcIndpZHRoXCIsIGRpdldpZHRoKS5hdHRyKFwiaGVpZ2h0XCIsIGhlaWdodCAtIG9mZnNldC50b3AgLSAyMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3VwZGF0ZUxpbmtEYXRhJyxcblxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBzZXJ2ZXIgc2VuZHMgdXBkYXRlZCBkYXRhIGZvciB0aGUgbGlua3NcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUxpbmtEYXRhKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBub2RlX25hbWVzX3NldCA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpc0dyYXBoLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVfbmFtZXNfc2V0LnB1c2godGhpc0dyYXBoLm5vZGVzW2ldLmlkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHJldERhdGEgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5nZXRGbG93QmV0d2VlblNldChub2RlX25hbWVzX3NldCk7XG4gICAgICAgICAgICAgICAgdmFyIGxpbmtEYXRhID0gcmV0RGF0YS5saW5rRGF0YTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5wcm9jZXNzTGlua0RhdGEobGlua0RhdGEsIHRoaXNHcmFwaC5ub2Rlcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5pbml0Tm9kZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRMaW5rcygpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIFZpc3VhbGl6ZXJHcmFwaDtcbiAgICB9KEdyYXBoLkdyYXBoKTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIEdyYXBoOiBWaXN1YWxpemVyR3JhcGhcbiAgICB9O1xufV0pO1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4vKipcbiAqIFRoZSBiYXNlIGNsYXNzIGZvciBsaW5rIG9iamVjdHMgZm9yIHRoZSBncmFwaC5cbiAqIFN1cHBvcnRzIHBvbGljaWVzLlxuICogXG4gKiBUbyB3cml0ZSB5b3VyIG93biBsaW5rIG9iamVjdCwgY3JlYXRlIGEgbmV3IGZhY3RvcnkgdGhhdCB1c2VzIHRoZSBsaW5rXG4gKiB5b3Ugd2FudCB0byBpbmhlcml0IGFzIGEgZGVwZW5kZW5jeSwgYW5kIGV4dGVuZCBpdHMgbGluayBjbGFzcy4gXG4gKiBSZXR1cm4gdGhlIGNsYXNzIG9iamVjdCB3aXRoIExpbmsgYXMga2V5XG4gKiBcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ0xpbmsnLCBbZnVuY3Rpb24gKCkge1xuXHR2YXIgTGluayA9IGZ1bmN0aW9uICgpIHtcblx0XHQvKipcbiAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgKlxuICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHNvdXJjZU5vZGUgIFRoZSBzb3VyY2Ugbm9kZVxuICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHRhcmdldE5vZGUgIFRoZSB0YXJnZXQgbm9kZVxuICAgKi9cblx0XHRmdW5jdGlvbiBMaW5rKHNvdXJjZU5vZGUsIHRhcmdldE5vZGUpIHtcblx0XHRcdF9jbGFzc0NhbGxDaGVjayh0aGlzLCBMaW5rKTtcblxuXHRcdFx0dGhpcy5zb3VyY2UgPSBzb3VyY2VOb2RlO1xuXHRcdFx0dGhpcy50YXJnZXQgPSB0YXJnZXROb2RlO1xuXHRcdFx0dGhpcy5oYXNQb2xpY3kgPSBmYWxzZTtcblx0XHRcdHRoaXMucGF0aFBvbGljaWVzID0gW107XG5cdFx0XHR0aGlzLmdyYXBoID0gbnVsbDtcblx0XHRcdHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcblx0XHR9XG5cblx0XHQvKipcbiAgICogQ2FsbGVkIHdoZW4gYSBsaW5rIGlzIGFkZGVkIHRvIHRoZSBncmFwaFxuICAgKlxuICAgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaCBpdCBpcyBhZGRlZCB0b1xuICAgKi9cblxuXG5cdFx0X2NyZWF0ZUNsYXNzKExpbmssIFt7XG5cdFx0XHRrZXk6ICdpbml0aWFsaXplJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBpbml0aWFsaXplKGdyYXBoKSB7XG5cdFx0XHRcdGlmICh0aGlzLmluaXRpYWxpemVkID09IGZhbHNlKSB7XG5cdFx0XHRcdFx0dGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG5cdFx0XHRcdFx0dGhpcy5ncmFwaCA9IGdyYXBoO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogQ2FsbGVkIGR1cmluZyB0aGUgdXBkYXRlIGdyYXBoIGZvciBleGlzdGluZyBsaW5rc1xuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzcGF0aCAgVGhlIGQzIHBhdGhcbiAgICAqIEBwYXJhbSAgICAgIHtMaW5rfSAgXHQgICBkICAgICAgIE1hdGNoaW5nIExpbmsgT2JqZWN0ICAgICAgIFxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICd1cGRhdGVBdHRyJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVBdHRyKGQzcGF0aCwgZCkge1xuXHRcdFx0XHRkM3BhdGguc3R5bGUoJ21hcmtlci1lbmQnLCAndXJsKCNlbmQtYXJyb3cpJykuYXR0cihcImRcIiwgYXJyb3dQYXRoKTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBDYWxsZWQgZHVyaW5nIHRoZSBmaXJzdCB1cGRhdGUgZ3JhcGggZm9yIGEgbGlua1xuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzcGF0aCAgVGhlIGQzIHBhdGhcbiAgICAqIEBwYXJhbSAgICAgIHtMaW5rfSAgXHQgICBkICAgICAgIE1hdGNoaW5nIExpbmsgT2JqZWN0ICAgICAgIFxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICduZXdQYXRoQXR0cicsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gbmV3UGF0aEF0dHIoZDNwYXRoLCBkKSB7XG5cdFx0XHRcdGQzcGF0aC5hdHRyKCdkJywgYXJyb3dQYXRoKTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBDYWxjdWxhdGVzIHRoZSBhcnJvdyBwYXRoXG4gICAgKlxuICAgICogQHJldHVybiAgICAge3N0cmluZ30gIFRoZSBwYXRoIHRvIGRyYXdcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnYXJyb3dQYXRoJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBhcnJvd1BhdGgoKSB7XG5cdFx0XHRcdHZhciBkID0gdGhpcztcblx0XHRcdFx0dmFyIGR4ID0gZC50YXJnZXQueCAtIGQuc291cmNlLngsXG5cdFx0XHRcdCAgICBkeSA9IGQudGFyZ2V0LnkgLSBkLnNvdXJjZS55LFxuXHRcdFx0XHQgICAgZHIgPSBNYXRoLnNxcnQoZHggKiBkeCArIGR5ICogZHkpO1xuXHRcdFx0XHRyZXR1cm4gXCJNXCIgKyBkLnNvdXJjZS54ICsgXCIsXCIgKyBkLnNvdXJjZS55ICsgXCJBXCIgKyBkciArIFwiLFwiICsgZHIgKyBcIiAwIDAsMSBcIiArIGQudGFyZ2V0LnggKyBcIixcIiArIGQudGFyZ2V0Lnk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogVXNlZCB0byBpbnN0YWxsIHBvbGljaWVzIHRoYXQgYXJlIGNhbGxlZCB3aGVuIHRoaXNcbiAgICAqIGxpbmsgaGFzIGEgbW91c2UgZXZlbnRcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7UG9saWN5fSAgcG9saWN5ICBUaGUgcG9saWN5IHRvIGluc3RhbGxcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnaW5zdGFsbFBhdGhQb2xpY3knLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGluc3RhbGxQYXRoUG9saWN5KHBvbGljeSkge1xuXHRcdFx0XHR0aGlzLmhhc1BvbGljeSA9IHRydWU7XG5cdFx0XHRcdHRoaXMucGF0aFBvbGljaWVzLnB1c2gocG9saWN5KTtcblx0XHRcdFx0cG9saWN5LmluaXRpYWxpemUodGhpcy5ncmFwaCk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogVXNlZCB0byB1bmluc3RhbGwgcG9saWN5IGZvciB0aGlzIGxpbmtcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7UG9saWN5fSAgcG9saWN5UmVtb3ZlICBUaGUgcG9saWN5IHRvIHJlbW92ZVxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICd1bmluc3RhbGxQYXRoUG9saWN5Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiB1bmluc3RhbGxQYXRoUG9saWN5KHBvbGljeVJlbW92ZSkge1xuXHRcdFx0XHR2YXIgcG9saWN5UmVtb3ZlTmFtZTtcblx0XHRcdFx0dmFyIHRoaXNQYXRoID0gdGhpcztcblx0XHRcdFx0aWYgKHR5cGVvZiBwb2xpY3lSZW1vdmUgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0cG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlLnBvbGljeU5hbWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0Xyh0aGlzUGF0aC5wYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24gKHBvbGljeSwgaW5kZXgpIHtcblx0XHRcdFx0XHRpZiAocG9saWN5LnBvbGljeU5hbWUgPT09IHBvbGljeVJlbW92ZU5hbWUpIHtcblx0XHRcdFx0XHRcdHBvbGljeS5kZXN0cm95KCk7XG5cdFx0XHRcdFx0XHR0aGlzUGF0aC5wYXRoUG9saWNpZXMuc3BsaWNlKGluZGV4LCAxKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRpZiAodGhpc1BhdGgucGF0aFBvbGljaWVzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0XHRcdHRoaXNQYXRoLmhhc1BvbGljeSA9IGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogQ2FsbGVkIHdoZW4gdGhlcmUgaXMgYSBtb3VzZSBldmVudCBmb3IgdGhpcyBwYXRoXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGV2ZW50ICAgICBUaGUgbW91c2UgZXZlbnRcbiAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzcGF0aCAgVGhlIGQzIHBhdGhcbiAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBkICAgICAgICAgVGhlIG1hdGNoaW5nIGxpbmsgb2JqZWN0XG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3BhdGhQb2xpY3lFdmVudCcsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gcGF0aFBvbGljeUV2ZW50KGV2ZW50LCBkM3BhdGgsIGQpIHtcblx0XHRcdFx0XyhkLnBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5KSB7XG5cdFx0XHRcdFx0cG9saWN5W2V2ZW50XShkM3BhdGgsIGQpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XSk7XG5cblx0XHRyZXR1cm4gTGluaztcblx0fSgpO1xuXG5cdHJldHVybiB7XG5cdFx0TGluazogTGlua1xuXHR9O1xufV0pO1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG52YXIgX2dldCA9IGZ1bmN0aW9uIGdldChvYmplY3QsIHByb3BlcnR5LCByZWNlaXZlcikgeyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7IH0gfSBlbHNlIGlmIChcInZhbHVlXCIgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH07XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuLyoqXG4gKiBUaGUgbGluayB0aGF0IGlzIHVzZWQgc3BlY2lmaWNhbGx5IGZvciB0aGUgdmlzdWFsaXphdGlvbiB0YWIuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdWaXN1YWxpemVyTGluaycsIFsnTGluaycsIGZ1bmN0aW9uIChMaW5rKSB7XG5cdHZhciBWaXN1YWxpemVyTGluayA9IGZ1bmN0aW9uIChfTGluayRMaW5rKSB7XG5cdFx0X2luaGVyaXRzKFZpc3VhbGl6ZXJMaW5rLCBfTGluayRMaW5rKTtcblxuXHRcdC8qKlxuICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAqXG4gICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgc291cmNlTm9kZSAgVGhlIHNvdXJjZSBub2RlXG4gICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgdGFyZ2V0Tm9kZSAgVGhlIHRhcmdldCBub2RlXG4gICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB3ZWlnaHQgICAgVGhlIHdlaWdodCBvZiB0aGUgbGlua1xuICAgKi9cblx0XHRmdW5jdGlvbiBWaXN1YWxpemVyTGluayhzb3VyY2VOb2RlLCB0YXJnZXROb2RlLCB3ZWlnaHQpIHtcblx0XHRcdF9jbGFzc0NhbGxDaGVjayh0aGlzLCBWaXN1YWxpemVyTGluayk7XG5cblx0XHRcdHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChWaXN1YWxpemVyTGluay5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFZpc3VhbGl6ZXJMaW5rKSkuY2FsbCh0aGlzLCBzb3VyY2VOb2RlLCB0YXJnZXROb2RlKSk7XG5cblx0XHRcdF90aGlzLndlaWdodCA9IHdlaWdodDtcblx0XHRcdC8vQ291bnQgaXMgdXNlZCB0byBrZWVwIHRyYWNrIG9mIGhvdyBtYW55XG5cdFx0XHQvL3BhdGhzIHRvIGl0cyBzdWJub2RlcyB0aGVyZSBhcmVcblx0XHRcdC8vaW4gb3JkZXIgdG8gY2FsY3VsYXRlIGF2ZXJhZ2UgdHJhZmZpY1xuXHRcdFx0X3RoaXMuY291bnQgPSAxO1xuXHRcdFx0cmV0dXJuIF90aGlzO1xuXHRcdH1cblxuXHRcdC8qKlxuICAgKiBJbmNyZWFzZXMgdGhlIGNvdW50IG9mIHRoZSBsaW5rXG4gICAqIFVTZWQgdG8ga2VlcCB0cmFjayBvZiBob3cgbWFueSBwYXRocyB0byBpdHMgc3Vibm9kZXNcbiAgICogdGhlcmUgYXJlIGluIG9yZGVyIHRvIGNhbGN1bGF0ZSBhdmVyYWdlIHRyYWZmaWNcbiAgICovXG5cblxuXHRcdF9jcmVhdGVDbGFzcyhWaXN1YWxpemVyTGluaywgW3tcblx0XHRcdGtleTogJ2luY3JlYXNlQ291bnQnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGluY3JlYXNlQ291bnQoKSB7XG5cdFx0XHRcdHRoaXMuY291bnQgKz0gMTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBDYWxjdWxhdGVzIHdoZXJlIHRvIHBsYWNlIHF0aXAgZm9yXG4gICAgKlxuICAgICogQHJldHVybiAgICAge09iamVjdH0gIE9iamVjdCB3aXRoIHFUaXAgc2V0dGluZ3NcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAncXRpcEhlbHBlcicsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gcXRpcEhlbHBlcigpIHtcblx0XHRcdFx0dmFyIHJldDtcblx0XHRcdFx0dmFyIGQgPSB0aGlzO1xuXHRcdFx0XHR2YXIgZHggPSAoZC50YXJnZXQueCAtIGQuc291cmNlLngpIC8gMixcblx0XHRcdFx0ICAgIGR5ID0gKGQudGFyZ2V0LnkgLSBkLnNvdXJjZS55KSAvIDI7XG5cdFx0XHRcdGlmIChkLnNvdXJjZS54IDwgZC50YXJnZXQueCkge1xuXHRcdFx0XHRcdHJldCA9IHtcblx0XHRcdFx0XHRcdG15OiAndG9wIGNlbnRlcicsXG5cdFx0XHRcdFx0XHRhdDogJ2NlbnRlciBjZW50ZXInLCAvLyBhdCB0aGUgYm90dG9tIHJpZ2h0IG9mLi4uXG5cdFx0XHRcdFx0XHR0YXJnZXQ6IFtkeCwgZHldLFxuXHRcdFx0XHRcdFx0YWRqdXN0OiB7XG5cdFx0XHRcdFx0XHRcdHk6IDEwXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRyZXQgPSB7XG5cdFx0XHRcdFx0XHRteTogJ2JvdHRvbSBjZW50ZXInLFxuXHRcdFx0XHRcdFx0YXQ6ICdjZW50ZXIgY2VudGVyJywgLy8gYXQgdGhlIGJvdHRvbSByaWdodCBvZi4uLlxuXHRcdFx0XHRcdFx0dGFyZ2V0OiBbZHgsIGR5XSxcblx0XHRcdFx0XHRcdGFkanVzdDoge1xuXHRcdFx0XHRcdFx0XHR5OiAtMTBcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiByZXQ7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgKiBDYWxsZWQgd2hlbiBhIGxpbmsgaXMgYWRkZWQgdG8gdGhlIGdyYXBoXG4gICAqXG4gICAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoIGl0IGlzIGFkZGVkIHRvXG4gICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnaW5pdGlhbGl6ZScsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gaW5pdGlhbGl6ZShncmFwaCkge1xuXHRcdFx0XHRpZiAodGhpcy5pbml0aWFsaXplZCA9PSBmYWxzZSkge1xuXHRcdFx0XHRcdF9nZXQoVmlzdWFsaXplckxpbmsucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoVmlzdWFsaXplckxpbmsucHJvdG90eXBlKSwgJ2luaXRpYWxpemUnLCB0aGlzKS5jYWxsKHRoaXMsIGdyYXBoKTtcblx0XHRcdFx0XHR2YXIgc3RhdGUgPSBncmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluaztcblx0XHRcdFx0XHRpZiAoc3RhdGUgPT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0c3RhdGUgPSBncmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluayA9IHt9O1xuXHRcdFx0XHRcdFx0c3RhdGUubWF4V2VpZ2h0ID0gbnVsbDtcblx0XHRcdFx0XHRcdHN0YXRlLnVzZUF2Z1dlaWdodCA9IHRydWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHRoaXMudXBkYXRlTWF4V2VpZ2h0KCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBTZXRzIHdoZXRoZXIgdGhlIGdyYXBoIHNob3VsZCB1c2UgYXZnIHdlaWdodFxuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtib29sZWFufSAgdmFsICAgICBUaGUgdmFsdWUgdG8gc2V0IHRvXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3NldFVzZUF2Z1dlaWdodCcsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gc2V0VXNlQXZnV2VpZ2h0KHZhbCkge1xuXHRcdFx0XHR0aGlzLmdyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rLnVzZUF2Z1dlaWdodCA9ICEhdmFsO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIFNldHMgdGhlIHdlaWdodCBvZiB0aGlzIGxpbmtcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgd2VpZ2h0ICBUaGUgd2VpZ2h0IHRvIHNldCB0b1xuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdzZXRXZWlnaHQnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHNldFdlaWdodCh3ZWlnaHQpIHtcblx0XHRcdFx0dGhpcy53ZWlnaHQgPSB3ZWlnaHQ7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogR2V0cyB0aGUgcmF3IHdlaWdodC5cbiAgICAqXG4gICAgKiBAcmV0dXJuICAgICB7bnVtYmVyfSAgVGhlIHJhdyB3ZWlnaHQuXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ2dldFJhd1dlaWdodCcsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gZ2V0UmF3V2VpZ2h0KCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy53ZWlnaHQ7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogR2V0cyB0aGUgd2VpZ2h0IHZhbHVlIG9mIHRoZSBsaW5rLCBkZXBlbmRpbmcgb24gdGhlXG4gICAgKiB1c2VBdmdXZWlndGggc2V0dGluZ1xuICAgICpcbiAgICAqIEByZXR1cm4gICAgIHtudW1iZXJ9ICBUaGUgd2VpZ2h0LlxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdnZXRXZWlnaHQnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGdldFdlaWdodCgpIHtcblx0XHRcdFx0dmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG5cdFx0XHRcdCAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluaztcblxuXHRcdFx0XHRpZiAoc3RhdGUudXNlQXZnV2VpZ2h0KSB7XG5cdFx0XHRcdFx0dmFyIHdlaWdodCA9IHRoaXMud2VpZ2h0IC8gdGhpcy5jb3VudDtcblx0XHRcdFx0XHRyZXR1cm4gd2VpZ2h0O1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiB0aGlzLndlaWdodDtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBVcGRhdGVzIHRoZSBtYXggd2VpZ2h0IG9mIHRoZSBncmFwaFxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICd1cGRhdGVNYXhXZWlnaHQnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZU1heFdlaWdodCgpIHtcblx0XHRcdFx0dmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG5cdFx0XHRcdCAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluaztcblxuXHRcdFx0XHR2YXIgbWF4TGluayA9IF8ubWF4QnkodGhpc0dyYXBoLmxpbmtzLCBmdW5jdGlvbiAobCkge1xuXHRcdFx0XHRcdGlmIChsLmdyYXBoICE9IG51bGwpIHtcblx0XHRcdFx0XHRcdHJldHVybiBsLmdldFdlaWdodCgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm4gMDtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdHN0YXRlLm1heFdlaWdodCA9IG1heExpbmsuZ2V0V2VpZ2h0KCk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogQ2FsbGVkIGR1cmluZyB0aGUgdXBkYXRlIGdyYXBoIGZvciBleGlzdGluZyBsaW5rc1xuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzcGF0aCAgVGhlIGQzIHBhdGhcbiAgICAqIEBwYXJhbSAgICAgIHtMaW5rfSAgXHQgICBkICAgICAgIE1hdGNoaW5nIExpbmsgT2JqZWN0ICAgICAgIFxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICd1cGRhdGVBdHRyJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVBdHRyKGQzcGF0aCwgZCkge1xuXHRcdFx0XHR2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcblx0XHRcdFx0ICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXHRcdFx0XHR0aGlzLnVwZGF0ZU1heFdlaWdodCgpO1xuXHRcdFx0XHR2YXIgY29sb3JTY2FsZSA9IGQzLnNjYWxlLmxpbmVhcigpLmRvbWFpbihbMCwgc3RhdGUubWF4V2VpZ2h0XSkucmFuZ2UoW1wiI2ZmYjM2NlwiLCBcIiNGOTI2MDZcIl0pO1xuXHRcdFx0XHRzdGF0ZS5jb2xvclNjYWxlID0gY29sb3JTY2FsZTtcblx0XHRcdFx0ZDNwYXRoLnN0eWxlKCdtYXJrZXItZW5kJywgJ3VybCgjZW5kLWFycm93KScpLmNsYXNzZWQodGhpc0dyYXBoLmNvbnN0cy5zZWxlY3RlZENsYXNzLCBmdW5jdGlvbiAoZCkge1xuXHRcdFx0XHRcdHJldHVybiBkID09PSBzdGF0ZS5zZWxlY3RlZEVkZ2U7XG5cdFx0XHRcdH0pLmF0dHIoXCJkXCIsIHRoaXMuYXJyb3dQYXRoLmNhbGwoZCkpLnRyYW5zaXRpb24oXCJleGlzdGluZ1BhdGhUcmFuc2l0aW9uXCIpLmR1cmF0aW9uKDc1MCkuYXR0cihcInN0cm9rZVwiLCBmdW5jdGlvbiAoZCkge1xuXHRcdFx0XHRcdHZhciBjID0gY29sb3JTY2FsZShkLmdldFdlaWdodCgpKTtcblx0XHRcdFx0XHRyZXR1cm4gYztcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogQ2FsbGVkIGR1cmluZyB0aGUgZmlyc3QgdXBkYXRlIGdyYXBoIGZvciB0aGlzIGxpbmtcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM3BhdGggIFRoZSBkMyBwYXRoXG4gICAgKiBAcGFyYW0gICAgICB7TGlua30gIFx0ICAgZCAgICAgICBNYXRjaGluZyBMaW5rIE9iamVjdFxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICduZXdQYXRoQXR0cicsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gbmV3UGF0aEF0dHIoZDNwYXRoLCBkKSB7XG5cdFx0XHRcdHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuXHRcdFx0XHQgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuVmlzdWFsaXplckxpbms7XG5cdFx0XHRcdHRoaXMudXBkYXRlTWF4V2VpZ2h0KCk7XG5cdFx0XHRcdHZhciBjb2xvclNjYWxlID0gZDMuc2NhbGUubGluZWFyKCkuZG9tYWluKFswLCBzdGF0ZS5tYXhXZWlnaHRdKS5yYW5nZShbXCIjZmZiMzY2XCIsIFwiI0Y5MjYwNlwiXSk7XG5cblx0XHRcdFx0ZDNwYXRoLnRyYW5zaXRpb24oXCJuZXdQYXRoVHJhbnNpdGlvblwiKS5kdXJhdGlvbig3NTApLmF0dHJUd2VlbihcIm9wYWNpdHlcIiwgZnVuY3Rpb24gKGQpIHtcblx0XHRcdFx0XHRyZXR1cm4gZDMuaW50ZXJwb2xhdGVTdHJpbmcoMCwgMSk7XG5cdFx0XHRcdH0pLmF0dHIoXCJzdHJva2VcIiwgZnVuY3Rpb24gKGQpIHtcblx0XHRcdFx0XHR2YXIgYyA9IGNvbG9yU2NhbGUoZC5nZXRXZWlnaHQoKSk7XG5cdFx0XHRcdFx0cmV0dXJuIGM7XG5cdFx0XHRcdH0pLmF0dHIoJ2QnLCB0aGlzLmFycm93UGF0aC5jYWxsKGQpKTtcblx0XHRcdH1cblx0XHR9XSk7XG5cblx0XHRyZXR1cm4gVmlzdWFsaXplckxpbms7XG5cdH0oTGluay5MaW5rKTtcblxuXHRyZXR1cm4ge1xuXHRcdExpbms6IFZpc3VhbGl6ZXJMaW5rXG5cdH07XG59XSk7XG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbi8qKlxuICogVGhlIGJhc2UgY2xhc3MgZm9yIG5vZGUgb2JqZWN0cyBmb3IgdGhlIGdyYXBoLlxuICogU3VwcG9ydHMgcG9saWNpZXMuXG4gKiBcbiAqIFRvIHdyaXRlIHlvdXIgb3duIE5vZGUgb2JqZWN0LCBjcmVhdGUgYSBuZXcgZmFjdG9yeSB0aGF0IHVzZXMgdGhlIG5vZGVcbiAqIHlvdSB3YW50IHRvIGluaGVyaXQgYXMgYSBkZXBlbmRlbmN5LCBhbmQgZXh0ZW5kIGl0cyBub2RlIGNsYXNzLiBcbiAqIFJldHVybiB0aGUgY2xhc3Mgb2JqZWN0IHdpdGggTm9kZSBhcyBrZXlcbiAqIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnTm9kZScsIFtmdW5jdGlvbiAoKSB7XG5cdHZhciBOb2RlID0gZnVuY3Rpb24gKCkge1xuXHRcdC8qKlxuICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAqXG4gICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB4ICAgICAgIHggbG9jYXRpb25cbiAgICogQHBhcmFtICAgICAge251bWJlcn0gIHkgICAgICAgeSBsb2NhdGlvblxuICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgaWQgICAgICBUaGUgaWRlbnRpZmllclxuICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgdGV4dCAgICBUaGUgdGV4dCB0byBkaXNwbGF5XG4gICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICByYWRpdXMgIFRoZSByYWRpdXMgb2YgdGhlIG5vZGVcbiAgICovXG5cdFx0ZnVuY3Rpb24gTm9kZSh4LCB5LCBpZCwgdGV4dCwgcmFkaXVzKSB7XG5cdFx0XHRfY2xhc3NDYWxsQ2hlY2sodGhpcywgTm9kZSk7XG5cblx0XHRcdHRoaXMueCA9IHg7XG5cdFx0XHR0aGlzLnkgPSB5O1xuXHRcdFx0dGhpcy5yYWRpdXMgPSByYWRpdXM7XG5cdFx0XHR0aGlzLmlkID0gaWQ7XG5cdFx0XHR0aGlzLnRleHQgPSB0ZXh0O1xuXHRcdFx0dGhpcy5yYWRpdXMgPSByYWRpdXM7XG5cdFx0XHR0aGlzLmhhc1BvbGljeSA9IGZhbHNlO1xuXHRcdFx0dGhpcy5wb2xpY3kgPSBudWxsO1xuXHRcdFx0dGhpcy5ub2RlUG9saWNpZXMgPSBbXTtcblx0XHRcdHRoaXMuZ3JhcGggPSBudWxsO1xuXHRcdFx0dGhpcy5pbml0aWFsaXplZCA9IGZhbHNlO1xuXHRcdH1cblxuXHRcdC8qKlxuICAgKiBDYWxsZWQgd2hlbiBhIG5vZGUgaXMgYWRkZWQgdG8gdGhlIGdyYXBoXG4gICAqXG4gICAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoIGl0IGlzIGFkZGVkIHRvXG4gICAqL1xuXG5cblx0XHRfY3JlYXRlQ2xhc3MoTm9kZSwgW3tcblx0XHRcdGtleTogJ2luaXRpYWxpemUnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemUoZ3JhcGgpIHtcblx0XHRcdFx0aWYgKHRoaXMuaW5pdGlhbGl6ZWQgPT0gZmFsc2UpIHtcblx0XHRcdFx0XHR0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcblx0XHRcdFx0XHR0aGlzLmdyYXBoID0gZ3JhcGg7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBDYWxsZWQgZHVyaW5nIHRoZSB1cGRhdGUgZ3JhcGggZm9yIGV4aXN0aW5nIGxpbmtzXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICd1cGRhdGVBdHRyJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVBdHRyKGQzbm9kZSwgZCkge1xuXHRcdFx0XHRkM25vZGUuYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbiAoZCkge1xuXHRcdFx0XHRcdHJldHVybiBcInRyYW5zbGF0ZShcIiArIGQueCArIFwiLFwiICsgZC55ICsgXCIpXCI7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIENhbGxlZCBkdXJpbmcgdGhlIGZpcnN0IHVwZGF0ZSBncmFwaCBmb3IgYSBub2RlXG4gICAgKiBIb29rIGZvciBzdWIgY2xhc3Nlc1xuICAgICogXG4gICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gICAgICBkICAgICAgIE1hdGNoaW5nIE5vZGUgT2JqZWN0XG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ25ld05vZGVBdHRyJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBuZXdOb2RlQXR0cihkM25vZGUsIGQpIHt9XG5cblx0XHRcdC8qKlxuICAgICogU2V0cyB0aGUgcmFkaXVzIG9mIHRoZSBub2RlLlxuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICByYWRpdXMgIFRoZSByYWRpdXNcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnc2V0UmFkaXVzJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBzZXRSYWRpdXMocmFkaXVzKSB7XG5cdFx0XHRcdHRoaXMucmFkaXVzID0gcmFkaXVzO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIFVzZWQgdG8gaW5zdGFsbCBwb2xpY2llcyB0aGF0IGFyZSBjYWxsZWQgd2hlbiB0aGlzXG4gICAgKiBub2RlIGhhcyBhIG1vdXNlIGV2ZW50XG4gICAgKlxuICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeSAgVGhlIHBvbGljeSB0byBpbnN0YWxsXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ2luc3RhbGxOb2RlUG9saWN5Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBpbnN0YWxsTm9kZVBvbGljeShwb2xpY3kpIHtcblx0XHRcdFx0dGhpcy5oYXNQb2xpY3kgPSB0cnVlO1xuXHRcdFx0XHR0aGlzLm5vZGVQb2xpY2llcy5wdXNoKHBvbGljeSk7XG5cdFx0XHRcdHBvbGljeS5pbml0aWFsaXplKHRoaXMuZ3JhcGgpO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIFVzZWQgdG8gdW5pbnN0YWxsIHBvbGljeSBmb3IgdGhpcyBub2RlXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge1BvbGljeXxzdHJpbmd9ICBwb2xpY3lSZW1vdmUgIFRoZSBwb2xpY3kgdG8gcmVtb3ZlXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3VuaW5zdGFsbE5vZGVQb2xpY3knLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHVuaW5zdGFsbE5vZGVQb2xpY3kocG9saWN5UmVtb3ZlKSB7XG5cdFx0XHRcdHZhciBwb2xpY3lSZW1vdmVOYW1lO1xuXHRcdFx0XHR2YXIgdGhpc05vZGUgPSB0aGlzO1xuXHRcdFx0XHRpZiAodHlwZW9mIHBvbGljeVJlbW92ZSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHRwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmUucG9saWN5TmFtZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRfKHRoaXNOb2RlLm5vZGVQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5LCBpbmRleCkge1xuXHRcdFx0XHRcdGlmIChwb2xpY3kucG9saWN5TmFtZSA9PT0gcG9saWN5UmVtb3ZlTmFtZSkge1xuXHRcdFx0XHRcdFx0cG9saWN5LmRlc3Ryb3koKTtcblx0XHRcdFx0XHRcdHRoaXNOb2RlLm5vZGVQb2xpY2llcy5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHRcdGlmICh0aGlzTm9kZS5ub2RlUG9saWNpZXMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdFx0dGhpc05vZGUuaGFzUG9saWN5ID0gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBDYWxsZWQgd2hlbiB0aGVyZSBpcyBhIG1vdXNlIGV2ZW50IGZvciB0aGlzIG5vZGVcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgZXZlbnQgICAgIFRoZSBtb3VzZSBldmVudFxuICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGQgICAgICAgICBUaGUgbWF0Y2hpbmcgbm9kZSBvYmplY3RcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnbm9kZVBvbGljeUV2ZW50Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBub2RlUG9saWN5RXZlbnQoZXZlbnQsIGQzbm9kZSwgZCkge1xuXHRcdFx0XHRfLmZvckVhY2godGhpcy5ub2RlUG9saWNpZXMsIGZ1bmN0aW9uIChwb2xpY3kpIHtcblx0XHRcdFx0XHRwb2xpY3lbZXZlbnRdKGQzbm9kZSwgZCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1dKTtcblxuXHRcdHJldHVybiBOb2RlO1xuXHR9KCk7XG5cblx0cmV0dXJuIHtcblx0XHROb2RlOiBOb2RlXG5cdH07XG59XSk7XG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuLyoqXG4gKiBUaGUgbm9kZSB0aGF0IGlzIHVzZWQgc3BlY2lmaWNhbGx5IGZvciB0aGUgdmlzdWFsaXphdGlvbiB0YWIuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdWaXN1YWxpemVyTm9kZScsIFsnTm9kZScsIGZ1bmN0aW9uIChOb2RlKSB7XG5cdHZhciBWaXN1YWxpemVyTm9kZSA9IGZ1bmN0aW9uIChfTm9kZSROb2RlKSB7XG5cdFx0X2luaGVyaXRzKFZpc3VhbGl6ZXJOb2RlLCBfTm9kZSROb2RlKTtcblxuXHRcdC8qKlxuICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAqXG4gICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB4ICAgICAgIFx0eCBsb2NhdGlvblxuICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeSAgICAgICBcdHkgbG9jYXRpb25cbiAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGlkICAgICAgXHRUaGUgaWRlbnRpZmllclxuICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgdGV4dCAgICBcdFRoZSB0ZXh0IHRvIGRpc3BsYXlcbiAgICogQHBhcmFtICAgICAge251bWJlcn0gIHJhZGl1cyAgXHRUaGUgcmFkaXVzIG9mIHRoZSBub2RlXG4gICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBwYXJlbnQgICAgIFRoZSBwYXJlbnQgaWRcbiAgICogQHBhcmFtICAgICAge0FycmF5fSAgIGFuY2VzdG9ycyAgQXJyYXkgb2YgYW5jZXN0b3JzIElkXG4gICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB4U3RhcnQgICAgIHggbG9jIHRvIHN0YXJ0IGFuaW1hdGlvblxuICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeVN0YXJ0ICAgICB5IGxvYyB0byBzdGFydCBhbmltYXRpb25cbiAgICovXG5cdFx0ZnVuY3Rpb24gVmlzdWFsaXplck5vZGUoeCwgeSwgaWQsIHRleHQsIHJhZGl1cywgcGFyZW50LCBhbmNlc3RvcnMsIHhTdGFydCwgeVN0YXJ0KSB7XG5cdFx0XHRfY2xhc3NDYWxsQ2hlY2sodGhpcywgVmlzdWFsaXplck5vZGUpO1xuXG5cdFx0XHR2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoVmlzdWFsaXplck5vZGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihWaXN1YWxpemVyTm9kZSkpLmNhbGwodGhpcywgeCwgeSwgaWQsIHRleHQsIHJhZGl1cykpO1xuXG5cdFx0XHRfdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG5cdFx0XHRfdGhpcy5hbmNlc3RvcnMgPSBhbmNlc3RvcnM7XG5cdFx0XHRpZiAoeFN0YXJ0ID09IG51bGwpIHtcblx0XHRcdFx0X3RoaXMueFN0YXJ0ID0geDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdF90aGlzLnhTdGFydCA9IHhTdGFydDtcblx0XHRcdH1cblx0XHRcdGlmICh5U3RhcnQgPT0gbnVsbCkge1xuXHRcdFx0XHRfdGhpcy55U3RhcnQgPSB5O1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0X3RoaXMueVN0YXJ0ID0geVN0YXJ0O1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIF90aGlzO1xuXHRcdH1cblxuXHRcdC8qKlxuICAgKiBDYWxsZWQgZHVyaW5nIHRoZSBmaXJzdCB1cGRhdGUgZ3JhcGggZm9yIGEgbm9kZVxuICAgKlxuICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICBkICAgICAgICAgVGhlIG1hdGNoaW5nIE5vZGVcbiAgICovXG5cblxuXHRcdF9jcmVhdGVDbGFzcyhWaXN1YWxpemVyTm9kZSwgW3tcblx0XHRcdGtleTogJ25ld05vZGVBdHRyJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBuZXdOb2RlQXR0cihkM25vZGUsIGQpIHtcblx0XHRcdFx0dmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG5cdFx0XHRcdGlmICh0aGlzR3JhcGguY29uc3RzLmNvbnRhaW5lckNsYXNzICE9IG51bGwgJiYgdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0W2QuaWRdID09IG51bGwpIHtcblx0XHRcdFx0XHRkM25vZGUuY2xhc3NlZCh0aGlzR3JhcGguY29uc3RzLmNvbnRhaW5lckNsYXNzLCB0cnVlKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRkM25vZGUudHJhbnNpdGlvbihcIm5vZGVQb3NpdGlvblRyYW5zaXRpb25cIikuZHVyYXRpb24oNzUwKS5hdHRyVHdlZW4oXCJ0cmFuc2Zvcm1cIiwgZnVuY3Rpb24gKGQpIHtcblx0XHRcdFx0XHRpZiAoZC54U3RhcnQgIT0gbnVsbCAmJiBkLnlTdGFydCAhPSBudWxsKSB7XG5cdFx0XHRcdFx0XHR2YXIgeFN0YXJ0ID0gZC54U3RhcnQ7XG5cdFx0XHRcdFx0XHR2YXIgeVN0YXJ0ID0gZC55U3RhcnQ7XG5cdFx0XHRcdFx0XHRkLnhTdGFydCA9IGQueDtcblx0XHRcdFx0XHRcdGQueVN0YXJ0ID0gZC55O1xuXHRcdFx0XHRcdFx0cmV0dXJuIGQzLmludGVycG9sYXRlU3RyaW5nKFwidHJhbnNsYXRlKFwiICsgeFN0YXJ0ICsgXCIsXCIgKyB5U3RhcnQgKyBcIilcIiwgXCJ0cmFuc2xhdGUoXCIgKyBkLnggKyBcIixcIiArIGQueSArIFwiKVwiKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIGQzLmludGVycG9sYXRlU3RyaW5nKFwidHJhbnNsYXRlKFwiICsgZC54ICsgXCIsXCIgKyBkLnkgKyBcIilcIiwgXCJ0cmFuc2xhdGUoXCIgKyBkLnggKyBcIixcIiArIGQueSArIFwiKVwiKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fV0pO1xuXG5cdFx0cmV0dXJuIFZpc3VhbGl6ZXJOb2RlO1xuXHR9KE5vZGUuTm9kZSk7XG5cblx0cmV0dXJuIHtcblx0XHROb2RlOiBWaXN1YWxpemVyTm9kZVxuXHR9O1xufV0pO1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG52YXIgX2dldCA9IGZ1bmN0aW9uIGdldChvYmplY3QsIHByb3BlcnR5LCByZWNlaXZlcikgeyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7IH0gfSBlbHNlIGlmIChcInZhbHVlXCIgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH07XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuLyoqXG4gKiBUaGlzIHBvbGljeSBpcyB1c2VkIHRvIGFkZCBhIHNlbGVjdCBub2RlIGZlYXR1cmUuXG4gKiBTdXBwb3J0cyBzZWxlY3RpbmcgbXVsdGlwbGUgbm9kZXMgYnkgdXNpbmcgdGhlIGN0cmwga2V5LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnTm9kZVNlbGVjdGlvblBvbGljeScsIFsnUG9saWN5JywgZnVuY3Rpb24gKFBvbGljeSkge1xuICAgIHZhciBOb2RlU2VsZWN0aW9uUG9saWN5ID0gZnVuY3Rpb24gKF9Qb2xpY3kkUG9saWN5KSB7XG4gICAgICAgIF9pbmhlcml0cyhOb2RlU2VsZWN0aW9uUG9saWN5LCBfUG9saWN5JFBvbGljeSk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIE5vZGVTZWxlY3Rpb25Qb2xpY3koKSB7XG4gICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTm9kZVNlbGVjdGlvblBvbGljeSk7XG5cbiAgICAgICAgICAgIHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoTm9kZVNlbGVjdGlvblBvbGljeS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKE5vZGVTZWxlY3Rpb25Qb2xpY3kpKS5jYWxsKHRoaXMsIFwiTm9kZVNlbGVjdGlvblBvbGljeVwiKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2FsbGVkIHdoZW4gcG9saWN5IGlzIGluc3RhbGxlZFxuICAgICAgICAgKiBPdmVyd3JpdGVzIHRoZSBvbiBkcmFnIGV2ZW50IG9mIHRoZSBncmFwaFxuICAgICAgICAgKiBcbiAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgXG4gICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YWxsZWQgb25cbiAgICAgICAgKi9cblxuXG4gICAgICAgIF9jcmVhdGVDbGFzcyhOb2RlU2VsZWN0aW9uUG9saWN5LCBbe1xuICAgICAgICAgICAga2V5OiAnaW5pdGlhbGl6ZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdGlhbGl6ZShncmFwaCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgX2dldChOb2RlU2VsZWN0aW9uUG9saWN5LnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKE5vZGVTZWxlY3Rpb25Qb2xpY3kucHJvdG90eXBlKSwgJ2luaXRpYWxpemUnLCB0aGlzKS5jYWxsKHRoaXMsIGdyYXBoKTtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBncmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgc3RhdGUuc2VsZWN0ZWROb2RlcyA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBjb25zdHMgPSBncmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIGNvbnN0cy5zZWxlY3RlZENsYXNzID0gXCJzZWxlY3RlZFwiO1xuICAgICAgICAgICAgICAgIC8vb3ZlcndyaXR0aW5nIGdyYXBoJ3Mgbm9kZSBvbiBkcmFnIGV2ZW50IHRvIHN1cHBvcnRcbiAgICAgICAgICAgICAgICAvL21vdmluZyBtdWx0aXBsZSBub2RlcyBhdCBvbmNlXG4gICAgICAgICAgICAgICAgdmFyIGRyYWcgPSBncmFwaC5kcmFnO1xuICAgICAgICAgICAgICAgIGRyYWcub24oJ2RyYWcnLCBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gZ3JhcGg7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGguY29uc3RzLk5vZGVTZWxlY3Rpb25Qb2xpY3kgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGVjdGVkQ2xhc3MgPSB0aGlzR3JhcGguY29uc3RzLk5vZGVTZWxlY3Rpb25Qb2xpY3kuc2VsZWN0ZWRDbGFzcztcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZWxlY3Rpb24gPSBkMy5zZWxlY3RBbGwoJy4nICsgc2VsZWN0ZWRDbGFzcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3Rpb25bMF0uaW5kZXhPZih0aGlzKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGlvbi5jbGFzc2VkKHNlbGVjdGVkQ2xhc3MsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb24gPSBkMy5zZWxlY3QodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uLmNsYXNzZWQoc2VsZWN0ZWRDbGFzcywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGlvbi5hdHRyKFwidHJhbnNmb3JtXCIsIGZ1bmN0aW9uIChkLCBpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC54ICs9IGQzLmV2ZW50LmR4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSArPSBkMy5ldmVudC5keTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJ0cmFuc2xhdGUoXCIgKyBbZC54LCBkLnldICsgXCIpXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQWRkcyB0aGUgZ2l2ZW4gbm9kZSB0byB0aGUgYXJyYXkgb2Ygc2VsZWN0ZWQgbm9kZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM05vZGUgICAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgIG5vZGVEYXRhICBNYXRjaGluZyBOb2RlIG9iamVjdFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnYWRkU2VsZWN0Tm9kZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYWRkU2VsZWN0Tm9kZShkM05vZGUsIG5vZGVEYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeTtcblxuICAgICAgICAgICAgICAgIGQzTm9kZS5jbGFzc2VkKGNvbnN0cy5zZWxlY3RlZENsYXNzLCB0cnVlKTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zZWxlY3RlZE5vZGVzLnB1c2gobm9kZURhdGEpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJlbW92ZXMgdGhlIGdpdmVuIG5vZGUgZnJvbSB0aGUgYXJyYXkgb2Ygc2VsZWN0ZWQgbm9kZXMuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNOb2RlICAgIFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gICAgICBub2RlRGF0YSAgTWF0Y2hpbmcgbm9kZSBvYmplY3QgXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdyZW1vdmVTZWxlY3RGcm9tTm9kZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlU2VsZWN0RnJvbU5vZGUoZDNOb2RlLCBub2RlRGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzLk5vZGVTZWxlY3Rpb25Qb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5maWx0ZXIoZnVuY3Rpb24gKGNkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjZC5pZCA9PT0gbm9kZURhdGEuaWQ7XG4gICAgICAgICAgICAgICAgfSkuY2xhc3NlZChjb25zdHMuc2VsZWN0ZWRDbGFzcywgZmFsc2UpO1xuICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IHN0YXRlLnNlbGVjdGVkTm9kZXMuaW5kZXhPZihub2RlRGF0YSk7XG4gICAgICAgICAgICAgICAgc3RhdGUuc2VsZWN0ZWROb2Rlcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJlbW92ZXMgYWxsIHNlbGVjdGVkIG5vZGVzLlxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAncmVtb3ZlQWxsU2VsZWN0ZWROb2RlcycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlQWxsU2VsZWN0ZWROb2RlcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuY2xhc3NlZChjb25zdHMuc2VsZWN0ZWRDbGFzcywgZmFsc2UpO1xuICAgICAgICAgICAgICAgIHN0YXRlLnNlbGVjdGVkTm9kZXMgPSBbXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBPbiBNb3VzZWRvd24sIGRldGVybWluZXMgd2hldGhlciB0byBjaGFuZ2UgdGhlXG4gICAgICAgICAgICAgKiBzZWxlY3RlZCBzdGF0dXMgb2YgdGhlIGNsaWNrZWQgbm9kZS5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gICAgICBkICAgICAgIE1hdGNoaW5nIE5vZGUgT2JqZWN0ICAgICAgIFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnbW91c2Vkb3duJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtb3VzZWRvd24oZDNub2RlLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3k7XG4gICAgICAgICAgICAgICAgZDMuZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgaWYgKGQzLmV2ZW50LmN0cmxLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLnNlbGVjdGVkTm9kZXMuaW5kZXhPZihkKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVNlbGVjdEZyb21Ob2RlKGQzbm9kZSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZFNlbGVjdE5vZGUoZDNub2RlLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdGUuc2VsZWN0ZWROb2Rlcy5pbmRleE9mKGQpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgbm8gY29udHJvbCBrZXksIGFuZCBjbGlja2VkIG5vdCBzZWxlY3RlZCBub2RlLFxuICAgICAgICAgICAgICAgICAgICAvL3JlbW92ZSBhbGwgb2YgY3VycmVudCBzZWxlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVBbGxTZWxlY3RlZE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIE9uIE1vdXNldXAsIGRldGVybWluZXMgd2hldGhlciB0byBjaGFuZ2UgdGhlXG4gICAgICAgICAgICAgKiBzZWxlY3RlZCBzdGF0dXMgb2YgdGhlIGNsaWNrZWQgbm9kZS5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gICAgICBkICAgICAgIE1hdGNoaW5nIE5vZGUgT2JqZWN0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdtb3VzZXVwJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtb3VzZXVwKGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuICAgICAgICAgICAgICAgIGlmICghZDMuZXZlbnQuY3RybEtleSkge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIGxlbmd0aCBpcyBncmVhdGVyIHRoYW4gMSwgdGhlbiB3ZSBhcmUgbW92aW5nIG11bHRpcGxlIG5vZGVzXG4gICAgICAgICAgICAgICAgICAgIC8vbGVhdmUgdGhlbSBhbGwgaGlnaGxpZ2h0ZWRcbiAgICAgICAgICAgICAgICAgICAgLy9vdGhlcndpc2Ugd2UgYXJlIGp1c3QgbW92aW5nIG9uZSBub2RlLCBzbyB1bmhpZ2hsaWdodFxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuc2VsZWN0ZWROb2Rlcy5sZW5ndGggPD0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVTZWxlY3RGcm9tTm9kZShkM25vZGUsIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIE5vZGVTZWxlY3Rpb25Qb2xpY3k7XG4gICAgfShQb2xpY3kuUG9saWN5KTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIFBvbGljeTogTm9kZVNlbGVjdGlvblBvbGljeVxuICAgIH07XG59XSk7XG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuLyoqXG4gKiBUaGlzIHBvbGljeSBjaGFuZ2VzIHRoZSB2aWV3IHRvIHRoZSB0aW1lZ3JhcGggb2YgbGluayBkYXRhIG9uIGNsaWNrLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnUGF0aENoYW5nZVZpZXdQb2xpY3knLCBbJ1BvbGljeScsIGZ1bmN0aW9uIChQb2xpY3kpIHtcbiAgICB2YXIgUGF0aENoYW5nZVZpZXdQb2xpY3kgPSBmdW5jdGlvbiAoX1BvbGljeSRQb2xpY3kpIHtcbiAgICAgICAgX2luaGVyaXRzKFBhdGhDaGFuZ2VWaWV3UG9saWN5LCBfUG9saWN5JFBvbGljeSk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENhbGxlZCB0byBidWlsZCBwb2xpY3lcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAge0FuZ3VsYXIgU3RhdGV9ICAgICRzdGF0ZSAgICBVc2VkIHRvIGNoYW5nZSB2aWV3XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBQYXRoQ2hhbmdlVmlld1BvbGljeSgkc3RhdGUpIHtcbiAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQYXRoQ2hhbmdlVmlld1BvbGljeSk7XG5cbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChQYXRoQ2hhbmdlVmlld1BvbGljeS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFBhdGhDaGFuZ2VWaWV3UG9saWN5KSkuY2FsbCh0aGlzLCAnUGF0aENoYW5nZVZpZXdQb2xpY3knKSk7XG5cbiAgICAgICAgICAgIF90aGlzLiRzdGF0ZSA9ICRzdGF0ZTtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZW5lcmF0ZXMgYSBsaXN0IG9mIGFsbCBjaGlsZCBjb250YWluZXJzIG9mIHRoZSBzZXJ2aWNlXG4gICAgICAgICAqIENhbiBoYW5kbGUgbmVzdGVkIHNlcnZpY2VzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgaWQgICAgICBOb2RlIElEXG4gICAgICAgICAqL1xuXG5cbiAgICAgICAgX2NyZWF0ZUNsYXNzKFBhdGhDaGFuZ2VWaWV3UG9saWN5LCBbe1xuICAgICAgICAgICAga2V5OiAnZ2VuZXJhdGVMaXN0JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZW5lcmF0ZUxpc3QoaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHJldExpc3QgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgZ2VuZXJhdGVMaXN0SGVscGVyID0gZnVuY3Rpb24gZ2VuZXJhdGVMaXN0SGVscGVyKGlkLCByZXRMaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlSWRzID0gdGhpc1BvbGljeS5ncmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFtpZF07XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZUlkcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkSWQgPSBub2RlSWRzW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNQb2xpY3kuZ3JhcGguZGF0YVNvdXJjZS5oYXNDaGlsZChjaGlsZElkKSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJSZXRMaXN0ID0gZ2VuZXJhdGVMaXN0SGVscGVyKGNoaWxkSWQsIHJldExpc3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldExpc3QuY29uY2F0KHN1YlJldExpc3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXRMaXN0LnB1c2goY2hpbGRJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGdlbmVyYXRlTGlzdEhlbHBlcihpZCwgcmV0TGlzdCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJldExpc3Q7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byByZXJvdXRlIGFuIGVkZ2Ugd2hlbiBjbGlja2VkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0xpbmt9ICBlZGdlICAgIFRoZSBjbGlja2VkIGVkZ2VcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3ZpZXdFZGdlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2aWV3RWRnZShlZGdlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNvdXJjZUxpc3QgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0TGlzdCA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBzb3VyY2VJZCA9IGVkZ2Uuc291cmNlLmlkO1xuICAgICAgICAgICAgICAgIHZhciB0YXJnZXRJZCA9IGVkZ2UudGFyZ2V0LmlkO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZ3JhcGguZGF0YVNvdXJjZS5oYXNDaGlsZChzb3VyY2VJZCkgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9Ob3QgYSBjb250YWluZXIgbm9kZSwgbmVlZCB0byBhZ2dyZWdhdGVcbiAgICAgICAgICAgICAgICAgICAgc291cmNlTGlzdCA9IHRoaXMuZ2VuZXJhdGVMaXN0KHNvdXJjZUlkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzb3VyY2VMaXN0ID0gW3NvdXJjZUlkXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ncmFwaC5kYXRhU291cmNlLmhhc0NoaWxkKHRhcmdldElkKSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAvL05vdCBhIGNvbnRhaW5lciBub2RlLCBuZWVkIHRvIGFnZ3JlZ2F0ZVxuICAgICAgICAgICAgICAgICAgICB0YXJnZXRMaXN0ID0gdGhpcy5nZW5lcmF0ZUxpc3QodGFyZ2V0SWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldExpc3QgPSBbdGFyZ2V0SWRdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLiRzdGF0ZS5nbygnY29udGl2Lm1lbnUudmlzdWFsaXphdGlvbi5lZGdlJywgeyBzb3VyY2VOYW1lOiBzb3VyY2VJZCwgdGFyZ2V0TmFtZTogdGFyZ2V0SWQsXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZUxpc3Q6IHNvdXJjZUxpc3QsIHRhcmdldExpc3Q6IHRhcmdldExpc3QgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ21vdXNlZG93bicsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbW91c2Vkb3duKGQzcGF0aCwgZCkge1xuICAgICAgICAgICAgICAgIHRoaXMudmlld0VkZ2UoZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1dKTtcblxuICAgICAgICByZXR1cm4gUGF0aENoYW5nZVZpZXdQb2xpY3k7XG4gICAgfShQb2xpY3kuUG9saWN5KTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIFBvbGljeTogUGF0aENoYW5nZVZpZXdQb2xpY3lcbiAgICB9O1xufV0pO1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4vKipcbiAqIEJhc2UgcG9saWN5IGNsYXNzIGZvciB0aGUgZ3JhcGggb2JqZWN0XG4gKiBcbiAqIFBvbGljaWVzIGFyZSB1c2VkIHRvIGlzb2xhdGUgZmVhdHVyZXMgZm9yIGEgZ3JhcGguXG4gKiBQb2xpY2llcyBjYW4gYmUgaW5zdGFsbGVkIG9uIG5vZGVzLCBsaW5rcywgb3IgdGhlIGdyYXBoLlxuICogRWFjaCBwb2xpY3kgaGFzIGludGVyYWN0aW9uIGhhbmRsZXJzIHRoYXQgd2lsbCBiZSBjYWxsZWQgYnkgdGhlIGdyYXBoXG4gKiBpZiBpbnN0YWxsZWQuIFBvbGljaWVzIGNhbiBhbHNvIG1vZGlmeSBncmFwaCBmdW5jdGlvbnMgKHNlZSBRVGlwUG9saWN5KS5cbiAqIE11bHRpcGxlIHBvbGljaWVzIGNhbiBiZSBpbnN0YWxsZWQgZm9yIGEgbm9kZSBvciBsaW5rLiBcbiAqIFxuICogVG8gd3JpdGUgeW91ciBvd24gcG9saWN5LCBjcmVhdGUgYSBuZXcgZmFjdG9yeSB0aGF0IHVzZXMgdGhlIHBvbGljeVxuICogeW91IHdhbnQgdG8gaW5oZXJpdCBhcyBhIGRlcGVuZGVuY3ksIGFuZCBleHRlbmQgaXRzIHBvbGljeS4gXG4gKiBSZXR1cm4gdGhlIGNsYXNzIG9iamVjdCB3aXRoIFBvbGljeSBhcyBrZXksIGFuZCBcbiAqIGFkZCB0aGUgcG9saWN5IHRvIHRoZSBQb2xpY3lTZXJ2aWNlIGZhY3RvcnkuXG4gKiBcbiAqIEZvciBzYXZpbmcgc3RhdGUgb3IgY29uc3RzIGZvciB0aGUgcG9saWN5LCBjcmVhdGUgYSBuYW1lc3BhY2VcbiAqIGluIGdyYXBoLnN0YXRlIGFuZCBncmFwaC5jb25zdHMuXG4gKiBFeC4gXG4gKiAgICAgIGdyYXBoLnN0YXRlLm15UG9saWN5ID0ge307XG4gKiAgICAgIGdyYXBoLmNvbnN0cy5teVBvbGljeSA9IHt9O1xuICogICAgICBcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ1BvbGljeScsIFtmdW5jdGlvbiAoKSB7XG4gIHZhciBQb2xpY3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgICAqXG4gICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHBvbGljeU5hbWUgIFRoZSBwb2xpY3kgbmFtZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFBvbGljeShwb2xpY3lOYW1lKSB7XG4gICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUG9saWN5KTtcblxuICAgICAgdGhpcy5wb2xpY3lOYW1lID0gcG9saWN5TmFtZTtcbiAgICAgIHRoaXMuZ3JhcGggPSBudWxsO1xuICAgICAgdGhpcy5pbml0aWFsaXplZCA9IGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbGxlZCB3aGVuIHRoZSBwb2xpY3kgaXMgaW5zdGFsbGVkLlxuICAgICAqIFxuICAgICAqIEBwYXJhbSAge0dyYXBofSAgZ3JhcGggICBUaGUgR3JhcGggdGhhdCB0aGUgcG9saWN5IGlzXG4gICAgICogICAgICAgICAgICAgICAgICAgICAgICAgIGJlaW5nIGluc3RhbGxlZCBvblxuICAgICAqL1xuXG5cbiAgICBfY3JlYXRlQ2xhc3MoUG9saWN5LCBbe1xuICAgICAga2V5OiAnaW5pdGlhbGl6ZScsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdGlhbGl6ZShncmFwaCkge1xuICAgICAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5ncmFwaCA9IGdyYXBoO1xuICAgICAgfVxuXG4gICAgICAvKipcbiAgICAgICAqIEhhbmRsZXIsIG1lYW50IHRvIGJlIG92ZXJyaWRkZW4gaW4gc3ViY2xhc3Nlc1xuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSAge2QzIG9iamVjdH0gICAgZDNvYmogICAgVGhlIGQzb2JqZWN0XG4gICAgICAgKiBAcGFyYW0gIHtOb2RlL0xpbmsvR3JhcGh9ICBkICAgVGhlIG9iamVjdCBpdCB3YXNcbiAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YWxsZWQgZm9yLiAgICBcbiAgICAgICAqL1xuXG4gICAgfSwge1xuICAgICAga2V5OiAnbW91c2VvdmVyJyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBtb3VzZW92ZXIoZDNvYmosIGQpIHt9XG4gICAgfSwge1xuICAgICAga2V5OiAnZGJsY2xpY2snLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRibGNsaWNrKGQzb2JqLCBkKSB7fVxuICAgIH0sIHtcbiAgICAgIGtleTogJ2NvbnRleHRtZW51JyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb250ZXh0bWVudShkM29iaiwgZCkge31cbiAgICB9LCB7XG4gICAgICBrZXk6ICdtb3VzZW91dCcsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gbW91c2VvdXQoZDNvYmosIGQpIHt9XG4gICAgfSwge1xuICAgICAga2V5OiAnbW91c2Vkb3duJyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBtb3VzZWRvd24oZDNvYmosIGQpIHt9XG4gICAgfSwge1xuICAgICAga2V5OiAnbW91c2V1cCcsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gbW91c2V1cChkM29iaiwgZCkge31cblxuICAgICAgLyoqXG4gICAgICAgKiBXaWxsIGJlIGNhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyBiZWluZyBkZXN0cm95ZWQuXG4gICAgICAgKiBVc2VkIHRvIHJlbW92ZSBhbnkgZWxlbWVudHMgb3IgYmluZGluZ3MgdGhlIHBvbGljeVxuICAgICAgICogaGFzIGFkZGVkLlxuICAgICAgICovXG5cbiAgICB9LCB7XG4gICAgICBrZXk6ICdkZXN0cm95JyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkge31cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gUG9saWN5O1xuICB9KCk7XG5cbiAgcmV0dXJuIHtcbiAgICBQb2xpY3k6IFBvbGljeVxuICB9O1xufV0pO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmFwcGxpY2F0aW9uZ3JvdXBzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3VwcycsIHtcbiAgICAgICAgICAgIHVybDogJy9hcHBsaWNhdGlvbmdyb3VwcycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMuY3JlYXRlJywge1xuICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdhcHBsaWNhdGlvbmdyb3VwY3JlYXRlJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3Vwcy5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdhcHBsaWNhdGlvbmdyb3VwZGV0YWlscydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMuZWRpdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9lZGl0LzprZXknLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnYXBwbGljYXRpb25ncm91cGRldGFpbHMnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdhcHBsaWNhdGlvbkdyb3VwbGlzdCdcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcFxuJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIENvbnRhaW5zIGFsbCB0aGUgcG9saWNpZXMuXG4gKiBTZWUgcG9saWN5LmpzIGZvciBpbmZvIG9uIGhvdyBwb2xpY2llcyB3b3JrLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnUG9saWN5U2VydmljZScsIFsnUG9saWN5JywgJ1FUaXBQb2xpY3knLCAnUGF0aENoYW5nZVZpZXdQb2xpY3knLCAnTm9kZVNlbGVjdGlvblBvbGljeScsICdTcGxpdEpvaW5Ob2RlUG9saWN5JywgJ1NwbGl0Sm9pblZpZXdQb2xpY3knLCAnU2F2ZVN0YXRlUG9saWN5JywgZnVuY3Rpb24gKFBvbGljeSwgUVRpcFBvbGljeSwgUGF0aENoYW5nZVZpZXdQb2xpY3ksIE5vZGVTZWxlY3Rpb25Qb2xpY3ksIFNwbGl0Sm9pbk5vZGVQb2xpY3ksIFNwbGl0Sm9pblZpZXdQb2xpY3ksIFNhdmVTdGF0ZVBvbGljeSkge1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgUG9saWN5OiBQb2xpY3kuUG9saWN5LFxuICAgICAgICBRVGlwUG9saWN5OiBRVGlwUG9saWN5LlBvbGljeSxcbiAgICAgICAgUGF0aENoYW5nZVZpZXdQb2xpY3k6IFBhdGhDaGFuZ2VWaWV3UG9saWN5LlBvbGljeSxcbiAgICAgICAgTm9kZVNlbGVjdGlvblBvbGljeTogTm9kZVNlbGVjdGlvblBvbGljeS5Qb2xpY3ksXG4gICAgICAgIFNwbGl0Sm9pbk5vZGVQb2xpY3k6IFNwbGl0Sm9pbk5vZGVQb2xpY3kuUG9saWN5LFxuICAgICAgICBTcGxpdEpvaW5WaWV3UG9saWN5OiBTcGxpdEpvaW5WaWV3UG9saWN5LlBvbGljeSxcbiAgICAgICAgU2F2ZVN0YXRlUG9saWN5OiBTYXZlU3RhdGVQb2xpY3kuUG9saWN5XG4gICAgfTtcbn1dKTtcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5kYXNoYm9hcmQnLCBbJ2NvbnRpdi5tb2RlbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuZGFzaGJvYXJkJywge1xuICAgICAgICAgICAgdXJsOiAnL2Rhc2hib2FyZCcsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdkYXNoYm9hcmQnXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5sb2dpbicsIFsnY29udGl2LnV0aWxzJ10pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcFxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG52YXIgX2dldCA9IGZ1bmN0aW9uIGdldChvYmplY3QsIHByb3BlcnR5LCByZWNlaXZlcikgeyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7IH0gfSBlbHNlIGlmIChcInZhbHVlXCIgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH07XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuLyoqXG4gKiBUaGlzIHBvbGljeSBhZGRzIHRvb2x0aXAgZnVuY3Rpb25hbGl0eSB0byBub2RlcyBhbmQgbGlua3MuXG4gKiBXaGVuIGluc3RhbGxpbmcsIGluc3RhbGwgb24gYm90aCBsaW5rcyBhbmQgbm9kZXMuXG4gKiBcbiAqIFVzZXMgdGhlIHFUaXAgalF1ZXJ5IHBsdWdpblxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnUVRpcFBvbGljeScsIFsnUG9saWN5JywgZnVuY3Rpb24gKFBvbGljeSkge1xuICAgIHZhciBRVGlwUG9saWN5ID0gZnVuY3Rpb24gKF9Qb2xpY3kkUG9saWN5KSB7XG4gICAgICAgIF9pbmhlcml0cyhRVGlwUG9saWN5LCBfUG9saWN5JFBvbGljeSk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIFFUaXBQb2xpY3koKSB7XG4gICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUVRpcFBvbGljeSk7XG5cbiAgICAgICAgICAgIHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoUVRpcFBvbGljeS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFFUaXBQb2xpY3kpKS5jYWxsKHRoaXMsIFwiUVRpcFBvbGljeVwiKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICogTW9kaWZpZXMgdGhlIHVwZGF0ZU5ld05vZGVzIGFuZCBcbiAgICAgICAgICogdXBkYXRlTmV3UGF0aHMgbWV0aG9kIG9mIHRoZSBncmFwaCB0byBpbnN0YWxsIHF0aXBcbiAgICAgICAgICogb250byBlYWNoIG5vZGUgYW5kIHBhdGguXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoIGl0IGlzIFxuICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbGxlZCBvblxuICAgICAgICAgKi9cblxuXG4gICAgICAgIF9jcmVhdGVDbGFzcyhRVGlwUG9saWN5LCBbe1xuICAgICAgICAgICAga2V5OiAnaW5pdGlhbGl6ZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdGlhbGl6ZShncmFwaCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgX2dldChRVGlwUG9saWN5LnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFFUaXBQb2xpY3kucHJvdG90eXBlKSwgJ2luaXRpYWxpemUnLCB0aGlzKS5jYWxsKHRoaXMsIGdyYXBoKTtcblxuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBncmFwaC5zdGF0ZS5RVGlwUG9saWN5ID0ge307XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS5tb3VzZWRvd24gPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIGdyYXBoLmNvbnN0cy5RVGlwUG9saWN5ID0ge307XG5cbiAgICAgICAgICAgICAgICAvL1RyYWNraW5nIG1vdXNlIGNsaWNrIHN0YXRlIHRvIG1ha2UgdG9vbHRpcFxuICAgICAgICAgICAgICAgIC8vZGlzYXBwZWFyIGlmIHRoZSBub2RlIGlzIGJlaW5nIGRyYWdnZWQuXG4gICAgICAgICAgICAgICAgJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS5tb3VzZXVwKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLm1vdXNldXAgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vb3ZlcnJpZGUgdXBkYXRlTmV3Tm9kZXMgYW5kIHVwZGF0ZU5ld1BhdGhzXG4gICAgICAgICAgICAgICAgLy90byBpbnN0YWxsIHF0aXBcbiAgICAgICAgICAgICAgICB2YXIgZ3JhcGhVcGRhdGVOZXdOb2RlcyA9IGdyYXBoLnVwZGF0ZU5ld05vZGVzO1xuICAgICAgICAgICAgICAgIGdyYXBoLnVwZGF0ZU5ld05vZGVzID0gZnVuY3Rpb24gKG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGdyYXBoVXBkYXRlTmV3Tm9kZXMuY2FsbChncmFwaCwgbmV3Tm9kZXMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnVwZGF0ZU5ld05vZGVzKG5ld05vZGVzKTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdmFyIGdyYXBoVXBkYXRlTmV3UGF0aHMgPSBncmFwaC51cGRhdGVOZXdQYXRocztcbiAgICAgICAgICAgICAgICBncmFwaC51cGRhdGVOZXdQYXRocyA9IGZ1bmN0aW9uIChuZXdQYXRocykge1xuICAgICAgICAgICAgICAgICAgICBncmFwaFVwZGF0ZU5ld1BhdGhzLmNhbGwoZ3JhcGgsIG5ld1BhdGhzKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51cGRhdGVOZXdQYXRocyhuZXdQYXRocyk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmVzIGFsbCBxVGlwcyBmcm9tIHRoZSBET00uXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgcG9saWN5IGlzIHVuaW5zdGFsbGVkIG9yXG4gICAgICAgICAgICAgKiB0aGUgZ3JhcGggaXMgZGVzdHJveWVkLlxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZGVzdHJveScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgICAgICAgICAvL3JlbW92aW5nIGFsbCBxdGlwIGZyb20gRE9NXG4gICAgICAgICAgICAgICAgJCgnW2lkXj1cInF0aXBcIl0nKS5yZW1vdmUoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBLZWVwaW5nIHRyYWNrIG9mIG1vdXNlZG93biBzdGF0ZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM09iamVjdH0gIGQzb2JqICBUaGUgZDMgcGJqZWN0XG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZS9MaW5rfSAgZCAgICAgVGhlIG1hdGNoaW5nIGRhdGEgb2JqZWN0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdtb3VzZWRvd24nLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdXNlZG93bihkM29iaiwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5RVGlwUG9saWN5O1xuICAgICAgICAgICAgICAgIHN0YXRlLm1vdXNlZG93biA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogS2VlcGluZyB0cmFjayBvZiBtb3VzZWRvd24gc3RhdGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7ZDNPYmplY3R9ICBkM29iaiAgVGhlIGQzIHBiamVjdFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGUvTGlua30gIGQgICAgIFRoZSBtYXRjaGluZyBkYXRhIG9iamVjdFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnbW91c2V1cCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbW91c2V1cChkM29iaiwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5RVGlwUG9saWN5O1xuICAgICAgICAgICAgICAgIHN0YXRlLm1vdXNlZG93biA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd3aGVuUVRpcEF2YWlsYWJsZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gd2hlblFUaXBBdmFpbGFibGUoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIGludGVydmFsID0gNTAwOyAvLyBtc1xuICAgICAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCQoZG9jdW1lbnQpLnF0aXAgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KHRoaXNQb2xpY3kud2hlblFUaXBBdmFpbGFibGUoY2FsbGJhY2spLCBpbnRlcnZhbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCBpbnRlcnZhbCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gTmV3IE5vZGVzIGFyZSBhZGRlZCBkdXJpbmcgdGhlXG4gICAgICAgICAgICAgKiB1cGRhdGUgZ3JhcGggZnVuY3Rpb25cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7ZDNOb2RlfSAgbmV3Tm9kZXMgIFRoZSBuZXcgbm9kZXMgdGhhdCBhcmVcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmVpbmcgYWRkZWQgdG8gdGhlIGdyYXBoXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd1cGRhdGVOZXdOb2RlcycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlTmV3Tm9kZXMobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuUVRpcFBvbGljeTtcblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGF0dGFjaFFUaXAoKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vYXR0YWNoaW5nIHF0aXBcbiAgICAgICAgICAgICAgICAgICAgbmV3Tm9kZXMuZWFjaChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRoaXNOb2RlID0gdGhpcztcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vSWYgbm9kZSBoYXMgY2hpbGRyZW4sIHRoZW4gaXQgaXMgYSBzZXJ2aWNlXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0W2QuaWRdICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gXCI8Yj48dT5TZWxlY3RvcnM6PC9iPjwvdT4gXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGVjdG9yTWFwID0gdGhpc0dyYXBoLmRhdGFTb3VyY2Uuc2VsZWN0b3JzW2QuaWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoYXNLZXlzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHNlbGVjdG9yTWFwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc0tleXMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ICs9IGtleSArIFwiIDogPGk+XCIgKyBzZWxlY3Rvck1hcFtrZXldICsgXCI8L2k+LFxcbiBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhhc0tleXMgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29tbWEgd2lsbCBiZSByZW1vdmVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSBcIk5vIFNlbGVjdG9ycywgXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gXCI8Yj48dT5MYWJlbHM6PC9iPjwvdT4gXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxhYmVsc01hcCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmxhYmVsc1tkLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGFzS2V5cyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBsYWJlbHNNYXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzS2V5cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0ga2V5ICsgXCIgOiA8aT5cIiArIGxhYmVsc01hcFtrZXldICsgXCI8L2k+LFxcbiBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhhc0tleXMgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29tbWEgd2lsbCBiZSByZW1vdmVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSBcIk5vIGxhYmVscywgXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy9yZW1vdmUgbGFzdCBjb21tYVxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IHRleHQuc2xpY2UoMCwgLTIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXNOb2RlKS5xdGlwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBkLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0ZXh0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdzogZnVuY3Rpb24gc2hvdygpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcGkgPSAkKHRoaXNOb2RlKS5xdGlwKCdhcGknKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSAkKCcjZ3JhcGhDb250YWluZXInKS5vZmZzZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IFtvZmZzZXQubGVmdCArIChkLnggKiB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpICsgdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKClbMF0pLCBvZmZzZXQudG9wICsgKGQueSArIGQucmFkaXVzKSAqIHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCkgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKVsxXV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcGkuc2V0KCdwb3NpdGlvbi50YXJnZXQnLCBwb3NpdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIXN0YXRlLm1vdXNlZG93bjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxheTogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc29sbzogJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NlczogJ3F0aXAtYmx1ZSBxdGlwLXNoYWRvdydcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG15OiAndG9wIGNlbnRlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0OiAnYm90dG9tIGNlbnRlcidcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGFyZ2V0OiBwb3NpdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudDogJ21vdXNlZG93biBtb3VzZWxlYXZlJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9pbmNhc2UgbGlicmFyeSBoYXNuJ3QgbG9hZGVkIHlldFxuICAgICAgICAgICAgICAgIGlmICgkKGRvY3VtZW50KS5xdGlwICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBhdHRhY2hRVGlwKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy53aGVuUVRpcEF2YWlsYWJsZShhdHRhY2hRVGlwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gbmV3IHBhdGhzIGFyZSBhZGRlZCBkdXJpbmcgdGhlXG4gICAgICAgICAgICAgKiB1cGRhdGUgZ3JhcGggZnVuY3Rpb25cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7ZDNQYXRofSAgbmV3UGF0aHMgIFRoZSBuZXcgcGF0aHMgdGhhdCBhcmVcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmVpbmcgYWRkZWQgdG8gdGhlIGdyYXBoXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd1cGRhdGVOZXdQYXRocycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlTmV3UGF0aHMobmV3UGF0aHMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuUVRpcFBvbGljeTtcblxuICAgICAgICAgICAgICAgIC8vaW5jYXNlIGxpYnJhcnkgaGFzbid0IGxvYWRlZCB5ZXRcbiAgICAgICAgICAgICAgICBpZiAoJChkb2N1bWVudCkucXRpcCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9hZGRpbmcgcXRpcFxuICAgICAgICAgICAgICAgICAgICBuZXdQYXRocy5lYWNoKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGhpc1BhdGggPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9nZXR0aW5nIG1pZHBvaW50IG9mIHBhdGhcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXRoRWwgPSBkMy5zZWxlY3QodGhpcykubm9kZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1pZHBvaW50ID0gcGF0aEVsLmdldFBvaW50QXRMZW5ndGgocGF0aEVsLmdldFRvdGFsTGVuZ3RoKCkgLyAyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRSZXQgPSBkLnF0aXBIZWxwZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gXCJCeXRlczogXCIgKyBkLmdldFdlaWdodCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzUGF0aCkucXRpcCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0ZXh0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdzogZnVuY3Rpb24gc2hvdygpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vaWYgbW91c2UgaXMgZG93biwgZG9uJ3QgbGV0IHF0aXAgc2hvd1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICFzdGF0ZS5tb3VzZWRvd247XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3c6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsYXk6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvbG86ICQoJyNncmFwaENvbnRhaW5lcicpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc2VzOiAncXRpcC1ibHVlIHF0aXAtc2hhZG93J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXk6IHRhcmdldFJldC5teSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXQ6ICdjZW50ZXIgY2VudGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiAnbW91c2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGp1c3Q6IHRhcmdldFJldC5hZGp1c3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQ6ICdtb3VzZWRvd24gbW91c2VsZWF2ZSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1dKTtcblxuICAgICAgICByZXR1cm4gUVRpcFBvbGljeTtcbiAgICB9KFBvbGljeS5Qb2xpY3kpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgUG9saWN5OiBRVGlwUG9saWN5XG4gICAgfTtcbn1dKTtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG4vKipcbiAqIFRoaXMgcG9saWN5IHByb3ZpZGVzIGEgd2F5IGZvciBwcm9wZXJ0aWVzIHRvIGJlIHNhdmVkIFxuICogYmV0d2VlbiB2aWV3IGNoYW5nZXNcbiAqIFxuICogSXQgbW9kaWZpZXMgdGhlIGRlc3Ryb3kgZnVuY3Rpb24gdG8gYWxzbyBwYXNzIGluIGFuIG9iamVjdCB0aGF0XG4gKiB3aWxsIGhhdmUgYWxsIGl0cyBwcm9wZXJ0aWVzIHNhdmVkIGFuZCB3aWxsIGJlIGF2YWlsYWJsZSBcbiAqIG9uIGdyYXBoIGxvYWQuIFdoZW4gc2F2aW5nIHZhcmlhYmxlcyB0byB0aGUgb2JqZWN0LCBuYW1lc3BhY2Ugd2l0aFxuICogdGhlIHBvbGljeSBuYW1lLlxuICogXG4gKiBUaGlzIHBvbGljeSBtdXN0IGJlIGxvYWRlZCBmaXJzdCBpbiBvcmRlciBmb3IgaXQgc2F2ZWQgdmFyaWFibGVzIFxuICogdG8gYmUgbG9hZGVkIHdoZW4gdGhlIHZpZXcgY29tZXMgYmFjayB0byB0aGUgZ3JhcGhcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ1NhdmVTdGF0ZVBvbGljeScsIFsnUG9saWN5JywgZnVuY3Rpb24gKFBvbGljeSkge1xuICAgIHZhciBTYXZlU3RhdGVQb2xpY3kgPSBmdW5jdGlvbiAoX1BvbGljeSRQb2xpY3kpIHtcbiAgICAgICAgX2luaGVyaXRzKFNhdmVTdGF0ZVBvbGljeSwgX1BvbGljeSRQb2xpY3kpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUYWtlcyBpbiB0aGUgYW5ndWxhciBzZXJ2aWNlIHRvIHdoaWNoIGl0IHdpbGxcbiAgICAgICAgICogc2F2ZSBpdCdzIHByb3BlcnRpZXMgdG8uXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBzYXZlZFN0YXRlICBPYmplY3QgdG8gc2F2ZSBcbiAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXMgdG9cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIFNhdmVTdGF0ZVBvbGljeShzYXZlZFN0YXRlKSB7XG4gICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU2F2ZVN0YXRlUG9saWN5KTtcblxuICAgICAgICAgICAgdmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKFNhdmVTdGF0ZVBvbGljeS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFNhdmVTdGF0ZVBvbGljeSkpLmNhbGwodGhpcywgJ1NhdmVTdGF0ZVBvbGljeScpKTtcblxuICAgICAgICAgICAgX3RoaXMuc2F2ZWRTdGF0ZSA9IHNhdmVkU3RhdGU7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICogTW9kaWZpZXMgdGhlIGRlc3Ryb3kgbWV0aG9kIFxuICAgICAgICAgKiBhbmQgYWRkcyBhIGxvYWQgbWV0aG9kIHRvIHRoZSBncmFwaFxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaCBpdCBpcyBcbiAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YWxsZWQgb25cbiAgICAgICAgICovXG5cblxuICAgICAgICBfY3JlYXRlQ2xhc3MoU2F2ZVN0YXRlUG9saWN5LCBbe1xuICAgICAgICAgICAga2V5OiAnaW5pdGlhbGl6ZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdGlhbGl6ZShncmFwaCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZ3JhcGggPSBncmFwaDtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgZ3JhcGguZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS5ncmFwaERlc3Ryb3kuY2FsbChncmFwaCwgdGhpc1BvbGljeS5zYXZlZFN0YXRlKTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgZ3JhcGgubG9hZCA9IGZ1bmN0aW9uIChzYXZlZFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kuZ3JhcGhMb2FkLmNhbGwoZ3JhcGgsIHNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2lsbCBvdmVycmlkZSB0aGUgZ3JhcGgncyBkZWZhdWx0IGRlc3Ryb3ksIHdpdGggXG4gICAgICAgICAgICAgKiB0aGlzIHBvbGljeSdzIHNhdmVkU3RhdGUgcGFzc2VkIGluLlxuICAgICAgICAgICAgICogQ2FsbGVkIHdpdGggdGhpcyBhcyB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgc2F2ZWRTdGF0ZSAgVGhlIHNhdmVkIHN0YXRlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdncmFwaERlc3Ryb3knLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdyYXBoRGVzdHJveShzYXZlZFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KHNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3kuZGVzdHJveShzYXZlZFN0YXRlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gdGhpc0dyYXBoLmJpbmRpbmdzKSB7XG4gICAgICAgICAgICAgICAgICAgICQod2luZG93KS5vZmYoa2V5LCB0aGlzR3JhcGguYmluZGluZ3Nba2V5XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgYmUgY2FsbGVkIHdpdGggdGhlIGdyYXBoIGFzIHRoaXNcbiAgICAgICAgICAgICAqIFVzZWQgdG8gaGF2ZSBhbGwgb3RoZXIgcG9saWNpZXMgdXNlIHRoZSBsb2FkIHN0YXRlXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIHNhdmVkU3RhdGUgIFRoZSBzYXZlZCBzdGF0ZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZ3JhcGhMb2FkJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBncmFwaExvYWQoc2F2ZWRTdGF0ZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9saWN5LmxvYWQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9saWN5LmxvYWQoc2F2ZWRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvbGljeS5sb2FkICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljeS5sb2FkKHNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1dKTtcblxuICAgICAgICByZXR1cm4gU2F2ZVN0YXRlUG9saWN5O1xuICAgIH0oUG9saWN5LlBvbGljeSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBQb2xpY3k6IFNhdmVTdGF0ZVBvbGljeVxuICAgIH07XG59XSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubWVudScsIFtdKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcG9saWNpZXMnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcycsIHtcbiAgICAgICAgICAgIHVybDogJy9uZXR3b3JrcG9saWNpZXMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5pc29sYXRpb24nLCB7XG4gICAgICAgICAgICB1cmw6ICcvaXNvbGF0aW9uJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8dWktdmlldy8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuaXNvbGF0aW9uLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnaXNvbGF0aW9ucG9saWN5Y3JlYXRlJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuaXNvbGF0aW9uLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2lzb2xhdGlvbnBvbGljeWRldGFpbHMnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5pc29sYXRpb24uZWRpdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9lZGl0LzprZXknLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnaXNvbGF0aW9ucG9saWN5ZGV0YWlscydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmJhbmR3aWR0aCcsIHtcbiAgICAgICAgICAgIHVybDogJy9iYW5kd2lkdGgnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzx1aS12aWV3Lz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGguY3JlYXRlJywge1xuICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdiYW5kd2lkdGhwb2xpY3ljcmVhdGUnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGguZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnYmFuZHdpZHRocG9saWN5ZGV0YWlscydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmJhbmR3aWR0aC5lZGl0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2VkaXQvOmtleScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdiYW5kd2lkdGhwb2xpY3lkZXRhaWxzJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMucmVkaXJlY3Rpb24nLCB7XG4gICAgICAgICAgICB1cmw6ICcvcmVkaXJlY3Rpb24nLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzx1aS12aWV3Lz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5saXN0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgcGFyYW1zOiB7IHBvbGljeVRhYjogbnVsbCB9LFxuICAgICAgICAgICAgY29tcG9uZW50OiAnbmV0d29ya3BvbGljaWVzdGFicydcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcFxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG52YXIgX2dldCA9IGZ1bmN0aW9uIGdldChvYmplY3QsIHByb3BlcnR5LCByZWNlaXZlcikgeyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7IH0gfSBlbHNlIGlmIChcInZhbHVlXCIgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH07XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuLyoqXG4gKiBUaGlzIHBvbGljeSBpcyB1c2VkIGZvciBzcGxpdHRpbmcgYSBub2RlIGludG8gaXRzIGNoaWxkcmVuLFxuICogYW5kIGpvaW5pbmcgdGhlbSBiYWNrIHRvIHRoZWlyIHBhcmVudC5cbiAqIFNwbGl0cyBvbiBkb3VibGUgY2xpY2ssIGFuZCBqb2lucyBvbiByaWdodCBjbGljay5cbiAqIElmIG11bHRpcGxlIG5vZGVzIGFyZSBzZWxlY3RlZCBhdCB0aGUgdGltZSBvZiBhIHNwbGl0IG9yIGpvaW4gZXZlbnQsXG4gKiBpdCB3aWxsIHNwbGl0IG9yIGpvaW4gYWxsIG9mIHRoZW0uXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdTcGxpdEpvaW5Ob2RlUG9saWN5JywgWydOb2RlU2VsZWN0aW9uUG9saWN5JywgJ1Zpc3VhbGl6ZXJOb2RlJywgZnVuY3Rpb24gKE5vZGVTZWxlY3Rpb25Qb2xpY3ksIFZpc3VhbGl6ZXJOb2RlKSB7XG4gICAgdmFyIFNwbGl0Sm9pbk5vZGVQb2xpY3kgPSBmdW5jdGlvbiAoX05vZGVTZWxlY3Rpb25Qb2xpY3kkKSB7XG4gICAgICAgIF9pbmhlcml0cyhTcGxpdEpvaW5Ob2RlUG9saWN5LCBfTm9kZVNlbGVjdGlvblBvbGljeSQpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBTcGxpdEpvaW5Ob2RlUG9saWN5KCkge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNwbGl0Sm9pbk5vZGVQb2xpY3kpO1xuXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoU3BsaXRKb2luTm9kZVBvbGljeS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFNwbGl0Sm9pbk5vZGVQb2xpY3kpKS5jYWxsKHRoaXMpKTtcblxuICAgICAgICAgICAgX3RoaXMucG9saWN5TmFtZSA9IFwiU3BsaXRKb2luTm9kZVBvbGljeVwiO1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENhbGxlZCB3aGVuIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGhcbiAgICAgICAgICovXG5cblxuICAgICAgICBfY3JlYXRlQ2xhc3MoU3BsaXRKb2luTm9kZVBvbGljeSwgW3tcbiAgICAgICAgICAgIGtleTogJ2luaXRpYWxpemUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemUoZ3JhcGgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF9nZXQoU3BsaXRKb2luTm9kZVBvbGljeS5wcm90b3R5cGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihTcGxpdEpvaW5Ob2RlUG9saWN5LnByb3RvdHlwZSksICdpbml0aWFsaXplJywgdGhpcykuY2FsbCh0aGlzLCBncmFwaCk7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuU3BsaXRKb2luTm9kZVBvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLnNwbGl0Tm9kZXMgPSBbXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUcmlnZ2VyaW5nIHNwbGl0IG9uIGRvdWJsZSBjbGlja1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBkICAgICAgVGhlIG1hdGNoaW5nIGRhdGEgb2JqZWN0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkYmxjbGljaycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGJsY2xpY2soZDNub2RlLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN1cGVyU3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luTm9kZVBvbGljeTtcblxuICAgICAgICAgICAgICAgIGlmICghZDMuZXZlbnQuY3RybEtleSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3VwZXJTdGF0ZS5zZWxlY3RlZE5vZGVzLmluZGV4T2YoZCkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGxpdE11bHRpcGxlTm9kZXMoc3VwZXJTdGF0ZS5zZWxlY3RlZE5vZGVzKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQWxsU2VsZWN0ZWROb2RlcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGxpdE5vZGUoZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVHJpZ2dlcmluZyBqb2luIG9uIHJpZ2h0IGNsaWNrXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqfSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGQgICAgICBUaGUgbWF0Y2hpbmcgZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2NvbnRleHRtZW51JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb250ZXh0bWVudShkM25vZGUsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3VwZXJTdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuICAgICAgICAgICAgICAgIGQzLmV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgaWYgKCFkMy5ldmVudC5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgdHJ5IHRvIGpvaW4gYSBoaWdobGlnaHRlZCBub2RlIHdoaWxlIG11bHRpcGxlIG5vZGVzIGFyZSBzZWxlY3RlZCxcbiAgICAgICAgICAgICAgICAgICAgLy93ZSBqb2luIGFsbCBoaWdobGlnaHRlZCBub2Rlc1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWROb2RlcyA9IHN1cGVyU3RhdGUuc2VsZWN0ZWROb2RlcztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkTm9kZXMuaW5kZXhPZihkKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGVjdGVkTm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmpvaW5Ob2RlKHNlbGVjdGVkTm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9pZiB3ZSB0cnkgdG8gam9pbiBhIG5vZGUgdGhhdCBpc24ndCBwYXJ0IG9mIGEgaGlnaGxpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAgICAgLy93ZSByZW1vdmUgYWxsIGhpZ2hsaWdodHMgYW5kIHRoZW4gam9pbiB0aGUgY2xpY2tlZCBub2RlXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUFsbFNlbGVjdGVkTm9kZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuam9pbk5vZGUoZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU3BsaXRzIGEgbm9kZS5cbiAgICAgICAgICAgICAqIHVzZWQgdG8gc2hhcmUgY29kZSBiZXR3ZWVuIHNwbGl0Tm9kZSBhbmQgc3BsaXRNdWx0aXBsZU5vZGVzXG4gICAgICAgICAgICAgKiB3aGlsZSBwcmV2ZW50aW5nIHRoZSBoYW5kbGVycyBmb3IgdGhlbSBib3RoIGZpcmluZ1xuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGUgYmVpbmcgc3BsaXRcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIFRoZSBuZXcgbm9kZXMgY3JlYXRlZCBieSB0aGUgc3BsaXRcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ19fc3BsaXROb2RlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfX3NwbGl0Tm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pbk5vZGVQb2xpY3k7XG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBub2RlLmlkO1xuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgLy9pZiBpdCBoYXMgbm8gY2hpbGRyZW4gdG8gc3BsaXQgaW50b1xuICAgICAgICAgICAgICAgIGlmIChjaGlsZHJlbl9zdHJ1Y3RbbmFtZV0gPT09IHVuZGVmaW5lZCB8fCBfLmlzRW1wdHkoY2hpbGRyZW5fc3RydWN0W25hbWVdKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9yZW1vdmluZyB0aGUgbm9kZSBmcm9tIHRoZSBsaXN0IG9mIG5vZGVzXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzID0gXy5maWx0ZXIodGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbiAoZ3JhcGhOb2Rlcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ3JhcGhOb2RlcyAhPSBub2RlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXNHcmFwaC5ub2Rlcyk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlKTtcblxuICAgICAgICAgICAgICAgIC8vZ2V0dGluZyBhbGwgdGhlIG5vZGUgaWQncyBmb3IgZmluZGluZyBmbG93XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVfbmFtZXNfc2V0ID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZV9uYW1lc19zZXQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0uaWQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vc2V0IG9mIG5vZGVzIGFmdGVyIHRoZSBzcGxpdFxuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoaWxkcmVuX3N0cnVjdFtuYW1lXS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBub2RlX25hbWVzX3NldC5wdXNoKGNoaWxkcmVuX3N0cnVjdFtuYW1lXVtpXSk7XG4gICAgICAgICAgICAgICAgICAgIG5ld19ub2Rlcy5wdXNoKGNoaWxkcmVuX3N0cnVjdFtuYW1lXVtpXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciByZXREYXRhID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuZ2V0Rmxvd0JldHdlZW5TZXQobm9kZV9uYW1lc19zZXQpO1xuXG4gICAgICAgICAgICAgICAgLy9mb3JtYXR0aW5nIGRhdGEgZm9yIG5ldyBub2Rlc1xuICAgICAgICAgICAgICAgIHZhciB4TG9jID0gbm9kZS54O1xuICAgICAgICAgICAgICAgIHZhciB5TG9jID0gbm9kZS55O1xuICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnMgPSBub2RlLmFuY2VzdG9ycy5zbGljZSgpO1xuICAgICAgICAgICAgICAgIC8va2VlcGluZyBvcmRlcmluZyB0aGF0IGZpcnN0IGluIGFuY2VzdG9yIGxpc3QgaXMgY2xvc2VzdCBpbiByZWxhdGlvbnNoaXBcbiAgICAgICAgICAgICAgICBhbmNlc3RvcnMuc3BsaWNlKDAsIDAsIG5vZGUuaWQpO1xuICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBub2RlLmlkO1xuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZV9vYmpzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIHJhZGl1cyA9IG5vZGUucmFkaXVzICogdGhpc0dyYXBoLmNvbnN0cy5yYWRpdXNEZWNheTtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZURhdGEgPSByZXREYXRhLm5vZGVEYXRhO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZURhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgLy9jYWxjdWxhdGluZyB3aGljaCBvZiB0aGUgbm9kZXMgaW4gcmV0RGF0YVswXSBhcmUgbmV3XG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXdfbm9kZXMuaW5kZXhPZihub2RlRGF0YVtpXS5pZCkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkID0gbm9kZURhdGFbaV0uaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IG5vZGVEYXRhW2ldLnRleHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGUgPSBuZXcgVmlzdWFsaXplck5vZGUuTm9kZShudWxsLCBudWxsLCBpZCwgdGV4dCwgcmFkaXVzLCBwYXJlbnQsIGFuY2VzdG9ycywgeExvYywgeUxvYyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdfbm9kZS5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMucHVzaChuZXdfbm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdfbm9kZV9vYmpzLnB1c2gobmV3X25vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YShyZXREYXRhLmxpbmtEYXRhLCB0aGlzR3JhcGgubm9kZXMpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0Tm9kZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdExpbmtzKCk7XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS5zcGxpdE5vZGVzLnB1c2gobm9kZS5pZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ld19ub2RlX29ianM7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU3BsaXRzIHRoZSBnaXZlIG5vZGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGUgYmVpbmcgc3BsaXRcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3NwbGl0Tm9kZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3BsaXROb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzID0gdGhpcy5fX3NwbGl0Tm9kZShub2RlKTtcbiAgICAgICAgICAgICAgICBpZiAocmVzID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnNwbGl0Tm9kZUV2ZW50KHJlcyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU3BsaXRzIGFsbCB0aGUgbm9kZXMgcGFzc2VkIGluXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZXMgICBBcnJheSBvZiBub2RlcyB0byBiZSBzcGxpdFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnc3BsaXRNdWx0aXBsZU5vZGVzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzcGxpdE11bHRpcGxlTm9kZXMobm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaDtcbiAgICAgICAgICAgICAgICB2YXIgcmVzTm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSB0aGlzLl9fc3BsaXROb2RlKG5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzTm9kZXMgPSByZXNOb2Rlcy5jb25jYXQocmVzKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLnNwbGl0TXVsdGlwbGVOb2Rlc0V2ZW50KHJlcyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIGFmdGVyIGEgc2luZ2xlIG5vZGUgaXMgc3BsaXRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBuZXdOb2RlcyAgVGhlIG5ldyBub2Rlc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnc3BsaXROb2RlRXZlbnQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNwbGl0Tm9kZUV2ZW50KG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNldFBvc2l0aW9ucygpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBtdWx0aXBsZSBub2RlcyBhcmUgc3BsaXQgYXQgb25jZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5ld05vZGVzICBUaGUgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdzcGxpdE11bHRpcGxlTm9kZXNFdmVudCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3BsaXRNdWx0aXBsZU5vZGVzRXZlbnQobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaDtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc2V0UG9zaXRpb25zKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogdXNlZCB0byBzaGFyZSBjb2RlIGJldHdlZW4gam9pbk5vZGUgYW5kIGpvaW5NdWx0aXBsZU5vZGVcbiAgICAgICAgICAgICAqIHdoaWxlIHByZXZlbnRpbmcgYm90aCBoYW5kbGVycyBmaXJpbmdcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgICAgIG5vZGUgICAgVGhlIG5vZGUgdG8gam9pblxuICAgICAgICAgICAgICogQHJldHVybiAgICAge05vZGV9ICBUaGUgbmV3IG5vZGUgYWZ0ZXIgdGhlIGpvaW5cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ19fam9pbk5vZGUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9fam9pbk5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5Ob2RlUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgLy9jaGVjayB0aGF0IG5vZGUgc3RpbGwgZXhpc3RzXG4gICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG5vZGUpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gbm9kZS5pZDtcbiAgICAgICAgICAgICAgICAvL2lmIGl0IGhhcyBubyBhbmNlc3Rvciwgbm90aGluZyB0byBqb2luXG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbC5pbmRleE9mKG5hbWUpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciB0b19iZV9kZWxldGVkID0gW107XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVfbmFtZXNfc2V0ID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgLy9pZiBub2RlIHdvbid0IGJlIGNvbGxhcHNlZFxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLm5vZGVzW2ldLmFuY2VzdG9ycy5pbmRleE9mKG5vZGUucGFyZW50KSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZV9uYW1lc19zZXQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0uaWQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9fYmVfZGVsZXRlZC5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlX2lkID0gbm9kZS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgbm9kZV9uYW1lc19zZXQucHVzaChub2RlLnBhcmVudCk7XG5cbiAgICAgICAgICAgICAgICAvL2Zvcm1hdHRpbmcgZGF0YVxuICAgICAgICAgICAgICAgIHZhciByYWRpdXMgPSBub2RlLnJhZGl1cyAvIHRoaXNHcmFwaC5jb25zdHMucmFkaXVzRGVjYXk7XG4gICAgICAgICAgICAgICAgdmFyIHhMb2MgPSBub2RlLng7XG4gICAgICAgICAgICAgICAgdmFyIHlMb2MgPSBub2RlLnk7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IG5vZGUuYW5jZXN0b3JzWzFdO1xuICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnMgPSBub2RlLmFuY2VzdG9ycy5zbGljZSgxKTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGUgPSBuZXcgVmlzdWFsaXplck5vZGUuTm9kZSh4TG9jLCB5TG9jLCBuZXdfbm9kZV9pZCwgbmV3X25vZGVfaWQsIHJhZGl1cywgcGFyZW50LCBhbmNlc3RvcnMpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5wdXNoKG5ld19ub2RlKTtcblxuICAgICAgICAgICAgICAgIHZhciByZXREYXRhID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuZ2V0Rmxvd0JldHdlZW5TZXQobm9kZV9uYW1lc19zZXQpO1xuICAgICAgICAgICAgICAgIC8vcmVtb3ZlIGFsbCBub2RlcyB0aGF0IHdpbGwgYmUgam9pbmVkXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b19iZV9kZWxldGVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlX3RvX2RlbGV0ZSA9IHRvX2JlX2RlbGV0ZWRbaV07XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5zcGxpY2UodGhpc0dyYXBoLm5vZGVzLmluZGV4T2Yobm9kZV90b19kZWxldGUpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlX3RvX2RlbGV0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YShyZXREYXRhLmxpbmtEYXRhLCB0aGlzR3JhcGgubm9kZXMpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0Tm9kZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdExpbmtzKCk7XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS5zcGxpdE5vZGVzLnNwbGljZShzdGF0ZS5zcGxpdE5vZGVzLmluZGV4T2YobmV3X25vZGUuaWQpLCAxKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBuZXdfbm9kZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBKb2lucyB0aGUgZ2l2ZW4gbm9kZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZSB0byBqb2luXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdqb2luTm9kZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gam9pbk5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciBuZXdOb2RlID0gdGhpcy5fX2pvaW5Ob2RlKG5vZGUpO1xuICAgICAgICAgICAgICAgIGlmIChuZXdOb2RlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5qb2luTm9kZUV2ZW50KG5ld05vZGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBKb2lucyBhbGwgdGhlIGdpdmVuIG5vZGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZXMgICBUaGUgbm9kZXMgdG8gam9pblxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnam9pbk11bHRpcGxlTm9kZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gam9pbk11bHRpcGxlTm9kZShub2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSB0aGlzLl9fam9pbk5vZGUobm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICBuZXdfbm9kZXMucHVzaChyZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmpvaW5NdWx0aXBsZU5vZGVzRXZlbnQobmV3X25vZGVzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgYWZ0ZXIgYSBzaW5nbGUgbm9kZSBpcyBqb2luZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5ld05vZGUgIFRoZSBuZXcgbm9kZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnam9pbk5vZGVFdmVudCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gam9pbk5vZGVFdmVudChuZXdOb2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIGFmdGVyIG11bHRpcGxlIG5vZGVzIGFyZSBqb2luZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBuZXdOb2RlcyAgVGhlIG5ldyBub2Rlc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnam9pbk11bHRpcGxlTm9kZXNFdmVudCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gam9pbk11bHRpcGxlTm9kZXNFdmVudChuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIFNwbGl0Sm9pbk5vZGVQb2xpY3k7XG4gICAgfShOb2RlU2VsZWN0aW9uUG9saWN5LlBvbGljeSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBQb2xpY3k6IFNwbGl0Sm9pbk5vZGVQb2xpY3lcbiAgICB9O1xufV0pO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3MnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbmV0d29ya3MnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICduZXR3b3JrTGlzdCdcbiAgICAgICAgfSkuXG4gICAgICAgICAgICBzdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3MuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnbmV0d29ya2RldGFpbHMnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtzLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnbmV0d29ya2NyZWF0ZSdcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcFxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG52YXIgX2dldCA9IGZ1bmN0aW9uIGdldChvYmplY3QsIHByb3BlcnR5LCByZWNlaXZlcikgeyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7IH0gfSBlbHNlIGlmIChcInZhbHVlXCIgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH07XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuLyoqXG4gKiBUaGlzIHBvbGljeSBpcyB1c2VkIHRvIGNoYW5nZSB0aGUgdmlldyB0byBmb2N1cyBvbiBzcGxpdHRpbmcgYW5kIFxuICogam9pbmluZyBldmVudHMuXG4gKiBPdmVycmlkZXMgdGhlIGNlcnRhaW4gZm9yY2UgbGF5b3V0IGZ1bmN0aW9ucyBvZiB0aGUgZ3JhcGggdG8gcGFydGl0aW9uIGEgc3BsaXRcbiAqIGludG8gdGhlIGZvY3VzZWQgbm9kZXMgYW5kIHRoZSBjb25uZWN0ZWQgbm9kZXMuXG4gKiBcbiAqIEhhcyBzYXZlL2xvYWQgbWV0aG9kcyBmb3IgdGhlIHNhdmUgc3RhdGUgcG9saWN5LlxuICogSGFzIGJhY2sgYnV0dG9uIHN1cHBvcnQuXG4gKiBDYW4gYXV0byBjaGFuZ2UgdGhlIHRpdGxlIG9mIHRoZSBncmFwaC5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ1NwbGl0Sm9pblZpZXdQb2xpY3knLCBbJ1NwbGl0Sm9pbk5vZGVQb2xpY3knLCAnVmlzdWFsaXplck5vZGUnLCBmdW5jdGlvbiAoU3BsaXRKb2luTm9kZVBvbGljeSwgVmlzdWFsaXplck5vZGUpIHtcbiAgICB2YXIgU3BsaXRKb2luVmlld1BvbGljeSA9IGZ1bmN0aW9uIChfU3BsaXRKb2luTm9kZVBvbGljeSQpIHtcbiAgICAgICAgX2luaGVyaXRzKFNwbGl0Sm9pblZpZXdQb2xpY3ksIF9TcGxpdEpvaW5Ob2RlUG9saWN5JCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIFNwbGl0Sm9pblZpZXdQb2xpY3koKSB7XG4gICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU3BsaXRKb2luVmlld1BvbGljeSk7XG5cbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChTcGxpdEpvaW5WaWV3UG9saWN5Ll9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoU3BsaXRKb2luVmlld1BvbGljeSkpLmNhbGwodGhpcykpO1xuXG4gICAgICAgICAgICBfdGhpcy5wb2xpY3lOYW1lID0gXCJTcGxpdEpvaW5WaWV3UG9saWN5XCI7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2FsbGVkIHdoZW4gcG9saWN5IGlzIGluc3RhbGxlZFxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaFxuICAgICAgICAgKi9cblxuXG4gICAgICAgIF9jcmVhdGVDbGFzcyhTcGxpdEpvaW5WaWV3UG9saWN5LCBbe1xuICAgICAgICAgICAga2V5OiAnaW5pdGlhbGl6ZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdGlhbGl6ZShncmFwaCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgX2dldChTcGxpdEpvaW5WaWV3UG9saWN5LnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFNwbGl0Sm9pblZpZXdQb2xpY3kucHJvdG90eXBlKSwgJ2luaXRpYWxpemUnLCB0aGlzKS5jYWxsKHRoaXMsIGdyYXBoKTtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBncmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgc3RhdGUuc2F2ZWRTdGF0ZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAvLyBzdGF0ZS5mb2N1c0dyb3VwID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkgPSBbXTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3VwcyA9IFtdO1xuICAgICAgICAgICAgICAgIHN0YXRlLmZvY2kgPSBbXTtcbiAgICAgICAgICAgICAgICBzdGF0ZS56b29tcyA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLmxheW91dCA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLmxheW91dERlZmF1bHQgPSBudWxsO1xuICAgICAgICAgICAgICAgIHN0YXRlLnpvb21EZWZhdWx0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS5ub2RlSWRzVG9SZXNob3cgPSBudWxsO1xuICAgICAgICAgICAgICAgIHN0YXRlLmJhY2tCdXR0b25FbGVtID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS50aXRsZUVsZW0gPSBudWxsO1xuXG4gICAgICAgICAgICAgICAgdmFyIGNvbnN0cyA9IGdyYXBoLmNvbnN0cy5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgY29uc3RzLmJvdW5kYXJ5ID0gMC44O1xuXG4gICAgICAgICAgICAgICAgLy9vdmVycmlkaW5nIGQzZm9yY2UgbWV0aG9kcyBvZiB0aGUgZ3JhcGguXG4gICAgICAgICAgICAgICAgZ3JhcGguZDNGb3JjZUJvdW5kcyA9IHRoaXMuZDNGb3JjZUJvdW5kcztcbiAgICAgICAgICAgICAgICBncmFwaC5kM0ZvcmNlVGljayA9IHRoaXMuZDNGb3JjZVRpY2s7XG4gICAgICAgICAgICAgICAgZ3JhcGguZDNGb3JjZVN0YXJ0ID0gdGhpcy5kM0ZvcmNlU3RhcnQ7XG4gICAgICAgICAgICAgICAgZ3JhcGguZDNGb3JjZUVuZCA9IHRoaXMuZDNGb3JjZUVuZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBMaW5rcyB0aGUgcHJvdmlkZWQgZWxlbWVudCBhIGJhY2sgYnV0dG9uIGZlYXR1cmVcbiAgICAgICAgICAgICAqIERvZXNuJ3QgdHJpZ2dlciB0aGUgb24tY2xpY2sgZXZlbnRcbiAgICAgICAgICAgICAqIFRoYXQgc2hvdWxkIGJlIGRvbmUgdGhyb3VnaCBhbmd1bGFyIG5nLWNsaWNrLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtqUXVlcnl9ICBlbGVtICAgIFRoZSBqcXVlcnkgc2VsZWN0ZWQgZWxlbWVudFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnaW5zdGFsbEJhY2tCdXR0b24nLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluc3RhbGxCYWNrQnV0dG9uKGVsZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeSA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uRWxlbSA9IGVsZW07XG4gICAgICAgICAgICAgICAgc3RhdGUuYmFja0J1dHRvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnVuZG9MYXN0RXZlbnQuY2FsbCh0aGlzUG9saWN5KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2lsbCBhbGxvdyB0aGlzIHBvbGljeSB0byBjaGFuZ2UgdGhlIHRpdGxlIG9mIHRoZSBncmFwaFxuICAgICAgICAgICAgICogYXMgc3BsaXQgYW5kIGpvaW4gZXZlbnRzIG9jY3VyLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtqUXVlcnl9ICBlbGVtICAgIFRoZSBqcXVlcnkgc2VsZWN0ZWQgZWxlbWVudFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnaW5zdGFsbFRpdGxlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbnN0YWxsVGl0bGUoZWxlbSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgc3RhdGUudGl0bGVFbGVtID0gZWxlbTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgYmVpbmcgZGVzdHJveWVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIHNhdmVkU3RhdGUgIEFueSBwcm9wZXJ0eSBvbiB0aGlzXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0IHdpbGwgYmUgYWNjZXNzaWJsZVxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gdGhlIHZpZXcgcmVsb2Fkc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZGVzdHJveScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveShzYXZlZFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgLy9Pbmx5IGlmIHRoZSBzYXZlIHN0YXRlIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICAgICAgICBpZiAoc2F2ZWRTdGF0ZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2F2ZShzYXZlZFN0YXRlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2lsbCBzYXZlIHRoZSBjdXJyZW50IHN0YXRlLCBhbmQgYWxsIGhpc3RvcnkuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIHNhdmVkU3RhdGUgIEFueSBwcm9wZXJ0eSBvbiB0aGlzXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0IHdpbGwgYmUgYWNjZXNzaWJsZVxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gdGhlIHZpZXcgcmVsb2Fkc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnc2F2ZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2F2ZShzYXZlZFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICAgICAgdmFyIGxpbmtzID0gdGhpc0dyYXBoLmxpbmtzO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyVGl0bGUgPSBudWxsO1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS50aXRsZUVsZW0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBjdXJyVGl0bGUgPSBzdGF0ZS50aXRsZUVsZW0udGV4dCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZm9jdXNHcm91cHMgPSBzdGF0ZS5mb2N1c0dyb3VwcztcbiAgICAgICAgICAgICAgICB2YXIgZXZlbnRIaXN0b3J5ID0gc3RhdGUuZXZlbnRIaXN0b3J5O1xuICAgICAgICAgICAgICAgIHZhciB6b29tcyA9IHN0YXRlLnpvb21zO1xuICAgICAgICAgICAgICAgIHZhciBsYXlvdXQgPSBzdGF0ZS5sYXlvdXQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgbGF5b3V0RGVmYXVsdCA9IHN0YXRlLmxheW91dERlZmF1bHQ7XG4gICAgICAgICAgICAgICAgdmFyIHpvb21EZWZhdWx0ID0gc3RhdGUuem9vbURlZmF1bHQ7XG4gICAgICAgICAgICAgICAgdmFyIHJldCA9IHsgbm9kZXM6IG5vZGVzLCBsaW5rczogbGlua3MsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlczogc3RhdGUuc2F2ZWRTdGF0ZXMsIGN1cnJUaXRsZTogY3VyclRpdGxlLFxuICAgICAgICAgICAgICAgICAgICBmb2N1c0dyb3VwczogZm9jdXNHcm91cHMsXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50SGlzdG9yeTogZXZlbnRIaXN0b3J5LCB6b29tczogem9vbXMsXG4gICAgICAgICAgICAgICAgICAgIGxheW91dDogbGF5b3V0LCBsYXlvdXREZWZhdWx0OiBsYXlvdXREZWZhdWx0LFxuICAgICAgICAgICAgICAgICAgICB6b29tRGVmYXVsdDogem9vbURlZmF1bHQgfTtcbiAgICAgICAgICAgICAgICBzYXZlZFN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3kgPSByZXQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2lsbCBiZSBjYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgcmVsb2FkZWQsIGFzc3VtaW5nXG4gICAgICAgICAgICAgKiBzYXZlIHN0YXRlIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgbG9hZFN0YXRlICBDb250YWlucyBhbGwgdGhlIHNhdmVkXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJpYWJsZXNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2xvYWQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxvYWQobG9hZFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgbG9hZFN0YXRlID0gbG9hZFN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG4gICAgICAgICAgICAgICAgc3RhdGUuc2F2ZWRTdGF0ZXMgPSBsb2FkU3RhdGUuc3RhdGVzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IGxvYWRTdGF0ZS5saW5rcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMgPSBsb2FkU3RhdGUubm9kZXM7XG5cbiAgICAgICAgICAgICAgICB2YXIgY3VyclRpdGxlID0gbG9hZFN0YXRlLmN1cnJUaXRsZTtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUudGl0bGVFbGVtICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUudGl0bGVFbGVtLnRleHQoY3VyclRpdGxlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5ID0gbG9hZFN0YXRlLmV2ZW50SGlzdG9yeTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3VwcyA9IGxvYWRTdGF0ZS5mb2N1c0dyb3VwcztcbiAgICAgICAgICAgICAgICBzdGF0ZS56b29tcyA9IGxvYWRTdGF0ZS56b29tcztcbiAgICAgICAgICAgICAgICBzdGF0ZS5sYXlvdXQgPSBsb2FkU3RhdGUubGF5b3V0O1xuICAgICAgICAgICAgICAgIHN0YXRlLmxheW91dERlZmF1bHQgPSBsb2FkU3RhdGUubGF5b3V0RGVmYXVsdDtcbiAgICAgICAgICAgICAgICBzdGF0ZS56b29tRGVmYXVsdCA9IGxvYWRTdGF0ZS56b29tRGVmYXVsdDtcblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5iYWNrQnV0dG9uRWxlbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuYmFja0J1dHRvbkVsZW0uZmFkZVRvKCdzbG93JywgMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuXG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV0sIGQuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiZm9jdXNcIjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy9sb2FkaW5nIGEgcHJldmlvdXMgbGF5b3V0XG4gICAgICAgICAgICAgICAgdmFyIGxheW91dDtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGxheW91dCA9IHN0YXRlLmxheW91dERlZmF1bHQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciB6b29tID0gc3RhdGUuem9vbURlZmF1bHQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQoem9vbVswXSwgem9vbVsxXSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSBzdGF0ZS56b29tc1tzdGF0ZS5mb2N1c0dyb3Vwc107XG4gICAgICAgICAgICAgICAgICAgIGlmICh6b29tICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQoem9vbVswXSwgem9vbVsxXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ID0gc3RhdGUubGF5b3V0W3N0YXRlLmZvY3VzR3JvdXBzXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL2xheW91dCBjYW4ndCBiZSBudWxsXG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBvcyA9IGxheW91dFtuLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvcyA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhsYXlvdXQsIG4pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG4ueCA9IHBvcy54O1xuICAgICAgICAgICAgICAgICAgICBuLnkgPSBwb3MueTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3RhdGUuaW5pdEZvcmNlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGguY2FsbCh0aGlzR3JhcGgsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51cGRhdGVHcmFwaENhbGxiYWNrLmNhbGwodGhpc1BvbGljeSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVHJpZ2dlcmluZyBzcGxpdCBvbiBkb3VibGUgY2xpY2tcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogRm9jdXMgZ3JvdXAgc3RvcmVzIHRoZSBub2RlIHRoYXQgaXMgYWJvdXQgdG8gYmUgc3BsaXQuXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIFdoZW4gZm9jdXMgZ3JvdXAgaGFzIGxlbmd0aCAwLCB0aGUgZmlyc3Qgc3BsaXQgXG4gICAgICAgICAgICAgKiB3aWxsIGp1c3QgYmUgcHVzaGVkIG9uLlxuICAgICAgICAgICAgICogVGhlIG5vZGUgd2lsbCBiZSBzcGxpdCBhbmQgcHVzaGVkIHRvIHRoZSB0b3AgaGFsZiBcbiAgICAgICAgICAgICAqIG9mIHRoZSBzY3JlZW4sIGFuZCB0aGUgYm90dG9tIGhhbGYgd2lsbCBjb250YWluIGFueVxuICAgICAgICAgICAgICogbm9kZXMgaXQgaGFzIGNvbm5lY3Rpb25zIHRvLlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBXaGVuIGEgZm9jdXMgZ3JvdXAgbGVuZ3RoIGlzID49IDEsIGlmIHRoZSBub2RlIHRvIGJlXG4gICAgICAgICAgICAgKiBzcGxpdCBpcyBhIGZvY3VzIG5vZGUsIGl0IHdpbGwgcmVwbGFjZSBmb2N1c0dyb3Vwc1swXSBhbmRcbiAgICAgICAgICAgICAqIHRoZSB0b3AgaGFsZiB3aWxsIGJlIGl0cyBjaGlsZHJlbiwgYW5kIGJvdHRvbSBoYWxmIHdpbGxcbiAgICAgICAgICAgICAqIGJlIHRoZSBub2RlcyBpdCBoYXMgY29ubmVjdGlvbnMgdG8uXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIElmIHRoZSBzcGxpdCBpcyBpbiB0aGUgYm90dG9tIGhhbGYsIHRoZW4gdGhlIGJvdHRvbSBoYWxmXG4gICAgICAgICAgICAgKiB3aWxsIGRpc3BsYXkgaXQncyBjaGlsZHJlbiBhbmQgd2lsbCBvbmx5IHNob3cgY29ubmVjdGlvbnMgYmV0d2VlblxuICAgICAgICAgICAgICogdGhlIHR3byBncm91cHMsIGFuZCB3aWxsIHJlcGxhY2UgZm9jdXNHcm91cHNbMV0uXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09ian0gICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgZCAgICAgICBUaGUgbWF0Y2hpbmcgZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2RibGNsaWNrJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkYmxjbGljayhkM25vZGUsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIC8vY2hlY2sgaWYgY2FuIHNwbGl0XG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBkLmlkO1xuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkcmVuX3N0cnVjdFtuYW1lXSA9PT0gdW5kZWZpbmVkIHx8IF8uaXNFbXB0eShjaGlsZHJlbl9zdHJ1Y3RbbmFtZV0pKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwcy5zbGljZSgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAvL3RvcGxldmVsIHNwbGl0XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzLnB1c2goZC5pZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChfLmluY2x1ZGVzKGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV0sIGQuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vc3BsaXR0aW5nIGEgZm9jdXMgbm9kZVxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwc1swXSA9IGQuaWQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9zcGxpdHRpbmcgYVxuICAgICAgICAgICAgICAgICAgICAvL2Nvbm5lY3RlZCBub2RlXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzLnB1c2goZC5pZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChfLmluY2x1ZGVzKGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1sxXV0sIGQuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vc3BsaXR0aW5nIGFcbiAgICAgICAgICAgICAgICAgICAgLy9jb25uZWN0ZWQgbm9kZVxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwc1sxXSA9IGQuaWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMiAmJiBzdGF0ZS5mb2N1c0dyb3Vwc1sxXSA9PT0gZC5pZCkge1xuICAgICAgICAgICAgICAgICAgICAvL1NwbGl0dGluZyBhIGNvbm5lY3RlZCBub2RlLCBrZWVwIGFsbCBmb2N1cyBub2Rlc1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZXNUb0tlZXAgPSBbZF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlSWRzVG9SZXNob3cgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdyb3VwT25lTm9kZXMgPSBjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dO1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF8uaW5jbHVkZXMoZ3JvdXBPbmVOb2Rlcywgbm9kZS5pZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzVG9SZXNob3cucHVzaChub2RlLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1RvS2VlcC5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL01ha2Ugc3BsaXQgbm9kZXMgdGhlIGZvY3VzIGFuZCBrZWVwIG5vZGVzIHRoYXQgYXJlIGNvbm5lY3RlZFxuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZXNUb0tlZXAgPSBbZF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlSWRzVG9SZXNob3cgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5saW5rcywgZnVuY3Rpb24gKGxpbmspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaW5rLnNvdXJjZSA9PT0gZCAmJiBub2RlSWRzVG9SZXNob3cuaW5kZXhPZihsaW5rLnRhcmdldC5pZCkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rLnRhcmdldC5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluay50YXJnZXQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzVG9SZXNob3cucHVzaChsaW5rLnRhcmdldC5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNUb0tlZXAucHVzaChsaW5rLnRhcmdldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxpbmsudGFyZ2V0ID09PSBkICYmIG5vZGVJZHNUb1Jlc2hvdy5pbmRleE9mKGxpbmsuc291cmNlLmlkKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsuc291cmNlLlNwbGl0Sm9pblZpZXdQb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rLnNvdXJjZS5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImNvbm5lY3RlZFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHNUb1Jlc2hvdy5wdXNoKGxpbmsuc291cmNlLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1RvS2VlcC5wdXNoKGxpbmsuc291cmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9SZW1vdmluZyBsaW5rcyBmcm9tIHRoZSBub2RlIHRvIGJlIHNwbGl0XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZWFjaChmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5pZCAhPT0gZC5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuXG4gICAgICAgICAgICAgICAgLy9kaXNhYmxpbmcgdXBkYXRlIGdyYXBoIHRvIHByZXZlbnQgbmV3IGRhdGEgZnJvbVxuICAgICAgICAgICAgICAgIC8vcmVkcmF3aW5nIGxpbmtzIHdoaWxlIHRoZXJlIGFyZSBhbmltYXRpb25zIGdvaW5nIG9uXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN0YXRlLmRpc2FibGVVcGRhdGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2goZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuaWQgIT09IGQuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS50cmFuc2l0aW9uKCkuZGVsYXkoMjAwKS5kdXJhdGlvbig0MDApLnN0eWxlKFwib3BhY2l0eVwiLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vZGlzYWJsaW5nIHF0aXAgaWYgaW5zdGFsbGVkXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJCh0aGlzKS5xdGlwICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnF0aXAoJ2Rpc2FibGUnLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIHRyYW5zbGF0ZSA9IHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpO1xuICAgICAgICAgICAgICAgIHZhciBzY2FsZSA9IHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCk7XG4gICAgICAgICAgICAgICAgdmFyIHhMb2MgPSBwYXJzZUZsb2F0KHRoaXNHcmFwaC5zdmcuc3R5bGUoXCJ3aWR0aFwiKSkgLyBzY2FsZSAvIDIgKyB0cmFuc2xhdGVbMF07XG4gICAgICAgICAgICAgICAgdmFyIHlMb2MgPSBwYXJzZUZsb2F0KHRoaXNHcmFwaC5zdmcuc3R5bGUoXCJoZWlnaHRcIikpIC8gc2NhbGUgLyAyICsgdHJhbnNsYXRlWzFdO1xuICAgICAgICAgICAgICAgIGQueFN0YXJ0ID0gZC54O1xuICAgICAgICAgICAgICAgIGQueVN0YXJ0ID0gZC55O1xuICAgICAgICAgICAgICAgIGQueCA9IHhMb2M7XG4gICAgICAgICAgICAgICAgZC55ID0geUxvYztcbiAgICAgICAgICAgICAgICBkM25vZGUudHJhbnNpdGlvbihcIm5vZGVQb3NpdGlvblRyYW5zaXRpb25cIikuZHVyYXRpb24oNzUwKS5hdHRyVHdlZW4oXCJ0cmFuc2Zvcm1cIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHhTdGFydCA9IGQueFN0YXJ0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgeVN0YXJ0ID0gZC55U3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgIGQueFN0YXJ0ID0gZC54O1xuICAgICAgICAgICAgICAgICAgICBkLnlTdGFydCA9IGQueTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQzLmludGVycG9sYXRlU3RyaW5nKFwidHJhbnNsYXRlKFwiICsgeFN0YXJ0ICsgXCIsXCIgKyB5U3RhcnQgKyBcIilcIiwgXCJ0cmFuc2xhdGUoXCIgKyBkLnggKyBcIixcIiArIGQueSArIFwiKVwiKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHZhciBzcGxpdE5vZGVGdW5jID0gX2dldChTcGxpdEpvaW5WaWV3UG9saWN5LnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFNwbGl0Sm9pblZpZXdQb2xpY3kucHJvdG90eXBlKSwgJ3NwbGl0Tm9kZScsIHRoaXMpO1xuICAgICAgICAgICAgICAgIHN0YXRlLm5vZGVJZHNUb1Jlc2hvdyA9IG5vZGVJZHNUb1Jlc2hvdztcbiAgICAgICAgICAgICAgICAvL3dhaXRpbmcgZm9yIG5vZGUgdHJhbnNpdGlvblxuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzID0gbm9kZXNUb0tlZXA7XG4gICAgICAgICAgICAgICAgICAgIHNwbGl0Tm9kZUZ1bmMuY2FsbCh0aGlzUG9saWN5LCBkKTtcbiAgICAgICAgICAgICAgICB9LCA3NTApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRvIGJlIGNhbGxlZCBhZnRlciB0aGUgZ3JhcGggaXMgc3BsaXQuXG4gICAgICAgICAgICAgKiBCcmluZ3MgYWxsIG5vZGVzIGJhY2sgaW50byB2aWV3IGFuZCBzZXRzIHRoZWlyIGF0dHJpYnV0ZXNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3VwZGF0ZUdyYXBoQ2FsbGJhY2snLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUdyYXBoQ2FsbGJhY2soKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5lYWNoKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS50cmFuc2l0aW9uKCkuZHVyYXRpb24oNDAwKS5zdHlsZShcIm9wYWNpdHlcIiwgMSk7XG4gICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5jbGFzc2VkKFwiZm9jdXNcIiwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykuY2xhc3NlZChcImNvbm5lY3RlZFwiLCBmYWxzZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuU3BsaXRKb2luVmlld1BvbGljeSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPT09IFwiZm9jdXNcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5jbGFzc2VkKFwiZm9jdXNcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vZGUuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID09PSBcImNvbm5lY3RlZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLmNsYXNzZWQoXCJjb25uZWN0ZWRcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHN0YXRlLm5vZGVJZHNUb1Jlc2hvdyA9IG51bGw7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSYW5kb21seSBzZXRzIHRoZSBwb3NpdGlvbnMgb2YgYW55IHVuc2V0IG5vZGVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3NldFBvc2l0aW9ucycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0UG9zaXRpb25zKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5ID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGhDb25zdHMgPSB0aGlzR3JhcGguY29uc3RzO1xuXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IGdyYXBoQ29uc3RzLmRpc3BsYXlPZmZzZXQ7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgICAgIHZhciByZXQgPSB0aGlzUG9saWN5LmQzRm9yY2VCb3VuZHMuY2FsbCh0aGlzR3JhcGgpO1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0UmFuZG9tSW50KG1pbiwgbWF4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluICsgMSkpICsgbWluO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIF8uZm9yRWFjaChub2RlcywgZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUueCA9PSBudWxsIHx8IG5vZGUueSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IGdldFJhbmRvbUludChub2RlLnJhZGl1cyArIG9mZnNldCwgcmV0LndpZHRoIC0gbm9kZS5yYWRpdXMgLSBvZmZzZXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHkgPSBnZXRSYW5kb21JbnQobm9kZS5yYWRpdXMgKyBvZmZzZXQsIHJldC5oZWlnaHQgLSBub2RlLnJhZGl1cyAtIG9mZnNldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLnggPSB4O1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS55ID0geTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBvbiB0aGUgc3RhcnQgb2YgdGhlIGQzIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqIFdpbGwgb3ZlcnJpZGUgdGhlIG1ldGhvZCBvZiB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqIFwidGhpc1wiIHBvaW50cyB0byB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2QzRm9yY2VTdGFydCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZDNGb3JjZVN0YXJ0KCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmF0dHIoJ2N4JywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQueFN0YXJ0ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQueFN0YXJ0ID0gZC54U3RhcnQgKiB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpICsgdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKClbMF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCdjeScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLnlTdGFydCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLnlTdGFydCA9IGQueVN0YXJ0ICogdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKSArIHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpWzFdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHMuYXR0cigneDEnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5zb3VyY2UueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd5MScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnNvdXJjZS55O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3gyJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQudGFyZ2V0Lng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneTInLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC50YXJnZXQueTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgb24gdGhlIHN0YXJ0IG9mIHRoZSBkMyBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKiBXaWxsIG92ZXJyaWRlIHRoZSBtZXRob2Qgb2YgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKiBcInRoaXNcIiBwb2ludHMgdG8gdGhlIGdyYXBoXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkM0ZvcmNlRW5kJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkM0ZvcmNlRW5kKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kgPSBzdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZVBvbGljeS5sYXlvdXREZWZhdWx0ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZmF1bHRMYXlvdXQgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRMYXlvdXRbbi5pZF0gPSB7IHg6IG4ueCwgeTogbi55IH07XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZVBvbGljeS5sYXlvdXREZWZhdWx0ID0gZGVmYXVsdExheW91dDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zbGF0ZSA9IHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZVBvbGljeS56b29tRGVmYXVsdCA9IFt0cmFuc2xhdGUsIHNjYWxlXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5hdHRyKCdjeCcsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cignY3knLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55O1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzLmF0dHIoJ3gxJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuc291cmNlLng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneTEnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5zb3VyY2UueTtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd4MicsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnRhcmdldC54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3kyJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQudGFyZ2V0Lnk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2lsbCBiZSBjYWxsZWQgZHVyaW5nIEQzIGZvcmNlIHNpbXVsYXRpb25zXG4gICAgICAgICAgICAgKiBieSB0aGUgZ3JhcGgsIHNvIFwidGhpc1wiIHdpbGwgcG9pbnQgdG8gdGhlIGdyYXBoIG9iamVjdFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB3aWR0aCAgIEQzIExheW91dCBXaWR0aFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge251bWJlcn0gIGhlaWdodCAgRDMgTGF5b3V0IEhlaWdodFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZDNGb3JjZVRpY2snLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGQzRm9yY2VUaWNrKGUsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5ID0gc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSBjb25zdHMuZGlzcGxheU9mZnNldDtcbiAgICAgICAgICAgICAgICB2YXIgc2NhbGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpO1xuXG4gICAgICAgICAgICAgICAgLy8gTW92ZSBub2RlcyB0b3dhcmQgY2x1c3RlciBmb2N1cy5cbiAgICAgICAgICAgICAgICB2YXIgZm9jaSA9IHN0YXRlUG9saWN5LmZvY2k7XG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ3Jhdml0eShhbHBoYSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb2NpLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9PT0gXCJmb2N1c1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSArPSAoZm9jaVswXSAtIGQueSkgKiBhbHBoYTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gKGZvY2lbMV0gLSBkLnkpICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCArPSAod2lkdGggLyAyIC0gZC54KSAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gKGhlaWdodCAvIDIgLSBkLnkpICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC54ICs9ICh3aWR0aCAvIDIgLSBkLngpICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gTWFrZSBzdXJlIG5vZGVzIGFyZSB3aXRoaW4gYm91bmRzXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZWFjaCh0aGlzLmQzRm9yY2VDb2xsaWRlKC41KSkuZWFjaChncmF2aXR5KC4yICogZS5hbHBoYSkpLmF0dHIoXCJjeFwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC54ID0gTWF0aC5tYXgoKGQucmFkaXVzICsgb2Zmc2V0KSAvIHNjYWxlLCBNYXRoLm1pbih3aWR0aCArICgtb2Zmc2V0IC0gZC5yYWRpdXMpIC8gc2NhbGUsIGQueCkpO1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoXCJjeVwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5TcGxpdEpvaW5WaWV3UG9saWN5ID09IG51bGwgfHwgZC5TcGxpdEpvaW5WaWV3UG9saWN5ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQueSA9IE1hdGgubWF4KChkLnJhZGl1cyArIG9mZnNldCkgLyBzY2FsZSwgTWF0aC5taW4oaGVpZ2h0ICsgKC1vZmZzZXQgLSBkLnJhZGl1cykgLyBzY2FsZSwgZC55KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID09PSBcImZvY3VzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQueSA9IE1hdGgubWF4KGQucmFkaXVzICsgb2Zmc2V0LCBNYXRoLm1pbigoaGVpZ2h0ICsgKC1vZmZzZXQgLSBkLnJhZGl1cykgLyBzY2FsZSkgKiBjb25zdHMuU3BsaXRKb2luVmlld1BvbGljeS5ib3VuZGFyeSwgZC55KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID09PSBcImNvbm5lY3RlZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLnkgPSBNYXRoLm1heCgoaGVpZ2h0ICsgKG9mZnNldCAtIGQucmFkaXVzKSAvIHNjYWxlKSAqIGNvbnN0cy5TcGxpdEpvaW5WaWV3UG9saWN5LmJvdW5kYXJ5LCBNYXRoLm1pbihoZWlnaHQgKyAoLW9mZnNldCAtIGQucmFkaXVzKSAvIHNjYWxlLCBkLnkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocy5hdHRyKCd4MScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnNvdXJjZS54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3kxJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuc291cmNlLnk7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneDInLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC50YXJnZXQueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd5MicsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnRhcmdldC55O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGN1bGF0ZXMgdGhlIGJvdW5kYXJpZXMgb2YgdGhlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogV2lsbCBiZSBjYWxsZWQgZHVyaW5nIEQzIGZvcmNlIHNpbXVsYXRpb25zXG4gICAgICAgICAgICAgKiBieSB0aGUgZ3JhcGgsIHNvIFwidGhpc1wiIHdpbGwgcG9pbnQgdG8gdGhlIGdyYXBoIG9iamVjdFxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7T2JqZWN0fSAgICAgICAgICBSZXR1cm5zIGFuIG9iamVjdFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdCBoYXMgdGhlIHdpZHRoXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmQgaGVpZ2h0IGFzIFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllcyBcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2QzRm9yY2VCb3VuZHMnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGQzRm9yY2VCb3VuZHMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzLFxuICAgICAgICAgICAgICAgICAgICBjb25zdHNQb2xpY3kgPSBjb25zdHMuU3BsaXRKb2luVmlld1BvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kgPSBzdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXNHcmFwaC5ub2RlcztcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjYWxjTWF4Tm9kZXMod2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYXJlYSA9IHdpZHRoICogaGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmFkaXVzID0gdGhpc0dyYXBoLmNvbnN0cy5zdGFydFJhZGl1cztcbiAgICAgICAgICAgICAgICAgICAgLy90cmVhdGluZyB0aGVtIGFzIGEgc3F1YXJlIGZvciBhcHByb3hcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxlbmd0aCA9IHJhZGl1cyAqIDMuNTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFtb3VudCA9IGFyZWEgLyAobGVuZ3RoICogbGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFtb3VudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9UaGUgb2Zmc2V0IGlzIHRoZSBidWZmZXIgZnJvbSB0aGUgZWRnZXNcbiAgICAgICAgICAgICAgICAvL09yaWdpbmFsIFdpZHRoIGFuZCBIZWlnaHQgYXJlIGdpdmVuIHRvIHRoZSBmb3JjZSBsYXlvdXRcbiAgICAgICAgICAgICAgICAvL3NvIHRoYXQgaXQgaXMgY2VudGVyZWQsIGJ1dCBub2RlcyB3aWxsIGJlIGZvcmNlZCB0byBiZVxuICAgICAgICAgICAgICAgIC8vd2l0aGluIHRoZSBvZmZzZXQgYm91bmRzXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IGNvbnN0cy5kaXNwbGF5T2Zmc2V0O1xuICAgICAgICAgICAgICAgIHZhciBzdmdXaWR0aCA9IHBhcnNlRmxvYXQodGhpc0dyYXBoLnN2Zy5zdHlsZShcIndpZHRoXCIpKTtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnSGVpZ2h0ID0gcGFyc2VGbG9hdCh0aGlzR3JhcGguc3ZnLnN0eWxlKFwiaGVpZ2h0XCIpKTtcblxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IHN2Z1dpZHRoO1xuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBzdmdIZWlnaHQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgYW1vdW50ID0gY2FsY01heE5vZGVzKHdpZHRoIC0gMiAqIG9mZnNldCwgaGVpZ2h0IC0gMiAqIG9mZnNldCk7XG4gICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gMTtcbiAgICAgICAgICAgICAgICBpZiAobm9kZXMubGVuZ3RoID4gYW1vdW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHNjYWxlID0gYW1vdW50IC8gbm9kZXMubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguem9vbWVkKHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpLCBzY2FsZSk7XG4gICAgICAgICAgICAgICAgICAgIHdpZHRoIC89IHNjYWxlO1xuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgLz0gc2NhbGU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKSwgc2NhbGUpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vY2FsY3VsYXRpbmcgZm9jaSBmb3Igc2ltdWxhdGlvblxuICAgICAgICAgICAgICAgIHZhciBmb2N1c0dyb3VwcyA9IHN0YXRlUG9saWN5LmZvY3VzR3JvdXBzO1xuICAgICAgICAgICAgICAgIHZhciBmb2NpO1xuICAgICAgICAgICAgICAgIGlmIChmb2N1c0dyb3Vwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZm9jaSA9IFtoZWlnaHQgLyAyXTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL3NldHRpbmcgZm9jaSBoZWlnaHQgcG9zaXRpb24gYmFzZWQgb24gcGVyY2VudGFnZVxuICAgICAgICAgICAgICAgICAgICB2YXIgZm9jdXNOb2RlcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFtmb2N1c0dyb3Vwc1swXV07XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0c1BvbGljeS5ib3VuZGFyeSA9IGZvY3VzTm9kZXMubGVuZ3RoIC8gbm9kZXMubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdG9wID0gaGVpZ2h0ICogY29uc3RzUG9saWN5LmJvdW5kYXJ5O1xuICAgICAgICAgICAgICAgICAgICB2YXIgYm90ID0gaGVpZ2h0IC0gdG9wO1xuICAgICAgICAgICAgICAgICAgICBpZiAodG9wIDwgMiAqIHRoaXNHcmFwaC5jb25zdHMubWF4UmFkaXVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdHNQb2xpY3kuYm91bmRhcnkgPSAyLjUgKiB0aGlzR3JhcGguY29uc3RzLm1heFJhZGl1cyAvIGhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvcCA9IGhlaWdodCAqIGNvbnN0c1BvbGljeS5ib3VuZGFyeTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvdCA9IGhlaWdodCAtIHRvcDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoYm90IDwgMiAqIHRoaXNHcmFwaC5jb25zdHMubWF4UmFkaXVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdHNQb2xpY3kuYm91bmRhcnkgPSAxIC0gMi41ICogdGhpc0dyYXBoLmNvbnN0cy5tYXhSYWRpdXMgLyBoZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3AgPSBoZWlnaHQgKiBjb25zdHNQb2xpY3kuYm91bmRhcnk7XG4gICAgICAgICAgICAgICAgICAgICAgICBib3QgPSBoZWlnaHQgLSB0b3A7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZm9jaSA9IFt0b3AgLyAyLCB0b3AgKyBib3QgLyAyXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kuZm9jaSA9IGZvY2k7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgd2lkdGg6IHdpZHRoLCBoZWlnaHQ6IGhlaWdodCB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBhIHNpbmdsZSBub2RlIGlzIHNwbGl0XG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5ld05vZGVzICBUaGUgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdzcGxpdE5vZGVFdmVudCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3BsaXROb2RlRXZlbnQobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaChuZXdOb2RlcywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV0sIGQuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiZm9jdXNcIjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIHRpdGxlID0gbmV3Tm9kZXNbMF0ucGFyZW50O1xuICAgICAgICAgICAgICAgIC8vIHN0YXRlLmZvY3VzR3JvdXAgPSB0aXRsZTtcblxuICAgICAgICAgICAgICAgIC8vaWYgdGhlIGxhc3QgZXZlbnQgaGFzIHRoZSBzYW1lIGlkLCBpdCBtdXN0IGJlIHRoZVxuICAgICAgICAgICAgICAgIC8vb3BwcG9zaXRlIG9mIHRoaXMgZXZlbnQsIHNvIHdlIHJlbW92ZSB0aGF0IGV2ZW50IGZyb21cbiAgICAgICAgICAgICAgICAvL3RoZSBldmVudCBzdGFjay5cbiAgICAgICAgICAgICAgICAvL090aGVyd2lzZSwgd2UgYWRkIHRoZSBldmVudCBvdCB0aGUgc3RhY2tcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCAhPT0gMCAmJiBzdGF0ZS5ldmVudEhpc3Rvcnlbc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCAtIDFdLmlkID09PSB0aXRsZSkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkucG9wKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5LnB1c2goeyBpZDogdGl0bGUsIGV2ZW50OiAnc3BsaXQnIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5iYWNrQnV0dG9uRWxlbSAhPSBudWxsICYmIHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuYmFja0J1dHRvbkVsZW0uZmFkZVRvKCdzbG93JywgMSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLnRpdGxlRWxlbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0gc3RhdGUuZm9jdXNHcm91cHNbMF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSAnICYgJyArIHN0YXRlLmZvY3VzR3JvdXBzWzFdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLnRpdGxlRWxlbS50ZXh0KHRleHQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vcmUtZW5hYmxlIGdyYXBoIHVwZGF0ZVxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZS5kaXNhYmxlVXBkYXRlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpc1BvbGljeS5zZXRMYXlvdXQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTZXRzIHRoZSBsYXlvdXQgb2YgdGhlIG5vZGVzLiBcbiAgICAgICAgICAgICAqIElmIHRoZXJlIGlzIGEgcHJldmlvdXMgbGF5b3V0LCBpdCB3aWxsIGJlIGxvYWRlZC5cbiAgICAgICAgICAgICAqIEVsc2UsIGl0IHdpbGwgcnVuIGEgRDMgRm9yY2Ugc2ltdWxhdGlvbiBhbmQgY3JlYXRlIG9uZS5cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3NldExheW91dCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0TGF5b3V0KCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcbiAgICAgICAgICAgICAgICB2YXIgbGF5b3V0O1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ID0gc3RhdGUubGF5b3V0RGVmYXVsdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSBzdGF0ZS56b29tRGVmYXVsdDtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh6b29tWzBdLCB6b29tWzFdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbSA9IHN0YXRlLnpvb21zW3N0YXRlLmZvY3VzR3JvdXBzXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHpvb20gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh6b29tWzBdLCB6b29tWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBsYXlvdXQgPSBzdGF0ZS5sYXlvdXRbc3RhdGUuZm9jdXNHcm91cHNdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChsYXlvdXQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvcyA9IGxheW91dFtuLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwb3MgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGxheW91dCwgbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBuLnggPSBwb3MueDtcbiAgICAgICAgICAgICAgICAgICAgICAgIG4ueSA9IHBvcy55O1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoLmNhbGwodGhpc0dyYXBoLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnVwZGF0ZUdyYXBoQ2FsbGJhY2suY2FsbCh0aGlzUG9saWN5KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy9OZWVkIHRvIHJ1biBhIGZvcmNlIHNpbXVsYXRpb24gYXMgdGhpcyBsYXlvdXRcbiAgICAgICAgICAgICAgICAgICAgLy9oYXNuJ3QgYmVlbiBkb25lIGJlZm9yZVxuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3RhdGUuaW5pdEZvcmNlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRoaXNQb2xpY3kuc2V0UG9zaXRpb25zKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnVwZGF0ZUdyYXBoQ2FsbGJhY2suY2FsbCh0aGlzUG9saWN5KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLnpvb21zW3N0YXRlLmZvY3VzR3JvdXBzXSA9IFt0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKSwgdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKV07XG4gICAgICAgICAgICAgICAgICAgIHZhciBsYXlvdXQgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dFtuLmlkXSA9IHsgeDogbi54LCB5OiBuLnkgfTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmxheW91dFtzdGF0ZS5mb2N1c0dyb3Vwc10gPSBsYXlvdXQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIE92ZXJyaWRpbmcgZnJvbSBzdXBlciBjbGFzcyBzbyB0aGF0IHdlIGNhbiBoYXZlXG4gICAgICAgICAgICAgKiB0b3AgbGV2ZWwgbm9kZXMgcmVhcHBlYXIgd2hlbiB0aGV5IGFyZSBoaWRkZW5cbiAgICAgICAgICAgICAqIGR1ZSB0byB0aGVyZSBiZWluZyB0d28gZm9jdXMgZ3JvdXBzLlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gICAgICAgICAgbm9kZSAgICBUaGUgbm9kZSB0byBqb2luXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7Tm9kZX0gIFRoZSBuZXcgbm9kZSBhZnRlciB0aGUgam9pblxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnX19qb2luTm9kZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX19qb2luTm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlU3VwZXIgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luTm9kZVBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIC8vY2hlY2sgdGhhdCBub2RlIHN0aWxsIGV4aXN0c1xuICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGgubm9kZXMuaW5kZXhPZihub2RlKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IG5vZGUuaWQ7XG4gICAgICAgICAgICAgICAgLy9pZiBpdCBoYXMgbm8gYW5jZXN0b3IsIG5vdGhpbmcgdG8gam9pblxuICAgICAgICAgICAgICAgIGlmIChjaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwuaW5kZXhPZihuYW1lKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gbm9kZS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgdmFyIHRvX2JlX2RlbGV0ZWQgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZU5hbWVTZXQgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXNHcmFwaC5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIG5vZGUgd29uJ3QgYmUgY29sbGFwc2VkXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGgubm9kZXNbaV0uYW5jZXN0b3JzLmluZGV4T2Yobm9kZS5wYXJlbnQpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlTmFtZVNldC5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXS5pZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b19iZV9kZWxldGVkLnB1c2godGhpc0dyYXBoLm5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGVfaWQgPSBub2RlLnBhcmVudDtcbiAgICAgICAgICAgICAgICBub2RlTmFtZVNldC5wdXNoKG5vZGUucGFyZW50KTtcblxuICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnNfc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuYW5jZXN0b3JzX3N0cnVjdDtcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIC8vIC0gc2V0dGluZyBmb2N1c0dyb3VwcyAtXG4gICAgICAgICAgICAgICAgLy9laXRoZXIgcmVwbGFjaW5nIG9uZSBvZiB0aGUgZ3JvdXBzLFxuICAgICAgICAgICAgICAgIC8vb3Igam9pbmluZyBiYWNrIGludG8gYSB0b3AgbGV2ZWwsIHNvIHRoZXJlIGlzIG9ubHlcbiAgICAgICAgICAgICAgICAvL29uZSBmb2N1c1xuICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IHN0YXRlLmZvY3VzR3JvdXBzLmluZGV4T2YocGFyZW50KTtcbiAgICAgICAgICAgICAgICBpZiAoYW5jZXN0b3JzX3N0cnVjdFtwYXJlbnRdICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHNbaW5kZXhdID0gYW5jZXN0b3JzX3N0cnVjdFtwYXJlbnRdO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9uYW1lVG9BZGQgYXJlIHRvcCBsZXZlbCBub2RlcyB0aGF0IGFyZSB0byBiZSBhZGRlZFxuICAgICAgICAgICAgICAgIC8vdG8gdGhlIGdyYXBoLlxuICAgICAgICAgICAgICAgIHZhciBuYW1lVG9BZGQgPSBbXTtcbiAgICAgICAgICAgICAgICAvL3dpbGwgb25seSBuZWVkIHRvIGFkZCBhIHRvcCBsZXZlbCBub2RlIGlmIHRoZXJlIGlzXG4gICAgICAgICAgICAgICAgLy9vbmx5IG9uZSBmb2N1c1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9BZGQgb25seSB0aG9zdCB0aGF0IGFyZW4ndCBhbiBhbmNlc3RvciBvZiB0aGUgbm9kZVxuICAgICAgICAgICAgICAgICAgICAvL3RvIGpvaW4sIHRoZSBmb2N1cyBncm91cCBvciBhbiBhbmNlc3RvciBvZiBpdCxcbiAgICAgICAgICAgICAgICAgICAgLy9hbmQgYXJlbid0IGFscmVhZHkgaW4gbm9kZU5hbWVTZXQuXG4gICAgICAgICAgICAgICAgICAgIC8vZ2V0IGZsb3cgYmV0d2VlbiB0b3AgbGV2ZWwgYXMgbG9uZyBhc1xuICAgICAgICAgICAgICAgICAgICAvL3RoZSB0b3AgbGV2ZWwgaXNuJ3QgYW4gYW5jZXN0b3Igb2YgdGhlXG4gICAgICAgICAgICAgICAgICAgIC8vZm9jdXMgZ3JvdXAsIGFuZCBpc24ndCBhbHJlYWR5IHBhcnQgb2YgdGhlXG4gICAgICAgICAgICAgICAgICAgIC8vbm9kZSBzZXQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnMgPSBhbmNlc3RvcnNfc3RydWN0W25vZGUuaWRdO1xuICAgICAgICAgICAgICAgICAgICBhbmNlc3RvcnMucHVzaChzdGF0ZS5mb2N1c0dyb3Vwc1swXSk7XG4gICAgICAgICAgICAgICAgICAgIC8vdGhlIG9yIGVtcHR5IGFycmF5IGlzIHRvIHByZXZlbnQgY29uY2F0ZW5hdGluZyBhIG51bGxcbiAgICAgICAgICAgICAgICAgICAgLy9vciB1bmRlZmluZWQgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3JzID0gYW5jZXN0b3JzLmNvbmNhdChhbmNlc3RvcnNfc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzBdXSB8fCBbXSk7XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChjaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW5jZXN0b3JzLmluZGV4T2YobikgPT09IC0xICYmIG5vZGVOYW1lU2V0LmluZGV4T2YobikgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lVG9BZGQucHVzaChuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVOYW1lU2V0ID0gbm9kZU5hbWVTZXQuY29uY2F0KG5hbWVUb0FkZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy9ubyBmb2N1cyBncm91cHMgbWVhbnMgd2UgYXJlIGF0IHRvcCBsZXZlbFxuICAgICAgICAgICAgICAgICAgICAvL1Nob3VsZCBhZGQgYW55IHRvcCBsZXZlbCBub2RlcyB0aGF0IGFyZW4ndFxuICAgICAgICAgICAgICAgICAgICAvL2FscmVhZHkgdGhlcmVcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKGNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbCwgZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlTmFtZVNldC5pbmRleE9mKG4pID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkLnB1c2gobik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBub2RlTmFtZVNldCA9IG5vZGVOYW1lU2V0LmNvbmNhdChuYW1lVG9BZGQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vZm9ybWF0dGluZyBkYXRhXG4gICAgICAgICAgICAgICAgdmFyIHJhZGl1cyA9IG5vZGUucmFkaXVzIC8gdGhpc0dyYXBoLmNvbnN0cy5yYWRpdXNEZWNheTtcbiAgICAgICAgICAgICAgICB2YXIgeExvYyA9IG5vZGUueDtcbiAgICAgICAgICAgICAgICB2YXIgeUxvYyA9IG5vZGUueTtcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gbm9kZS5hbmNlc3RvcnNbMV07XG4gICAgICAgICAgICAgICAgdmFyIGFuY2VzdG9ycyA9IG5vZGUuYW5jZXN0b3JzLnNsaWNlKDEpO1xuICAgICAgICAgICAgICAgIHZhciBuZXdOb2RlID0gbmV3IFZpc3VhbGl6ZXJOb2RlLk5vZGUoeExvYywgeUxvYywgbmV3X25vZGVfaWQsIG5ld19ub2RlX2lkLCByYWRpdXMsIHBhcmVudCwgYW5jZXN0b3JzKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMucHVzaChuZXdOb2RlKTtcblxuICAgICAgICAgICAgICAgIC8vcmVtb3ZlIGFsbCBub2RlcyB0aGF0IHdpbGwgYmUgam9pbmVkXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b19iZV9kZWxldGVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlX3RvX2RlbGV0ZSA9IHRvX2JlX2RlbGV0ZWRbaV07XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5zcGxpY2UodGhpc0dyYXBoLm5vZGVzLmluZGV4T2Yobm9kZV90b19kZWxldGUpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlX3RvX2RlbGV0ZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHJldERhdGEgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5nZXRGbG93QmV0d2VlblNldChub2RlTmFtZVNldCk7XG4gICAgICAgICAgICAgICAgLy9ob2xkcyB0aGUgbm9kZURhdGEgd2hpY2ggd2lsbCBiZSBwcm9jZXNzZWRcbiAgICAgICAgICAgICAgICB2YXIgbm9kZXNUb1Byb2Nlc3MgPSBbXTtcbiAgICAgICAgICAgICAgICAvL2ZpbmRpbmcgdGhlIG5vZGUgZGF0YSB0aGF0IGNvcnJlc3BvbmRzIHRvIHRoZSB0b3AgbGV2ZWxcbiAgICAgICAgICAgICAgICAvL25vZGVzIHRvIGFkZCAtIG5hbWVUb0FkZC5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZURhdGEgPSByZXREYXRhLm5vZGVEYXRhO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZURhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWVUb0FkZC5pbmRleE9mKG5vZGVEYXRhW2ldLmlkKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzVG9Qcm9jZXNzLnB1c2gobm9kZURhdGFbaV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9UaGUgdG9wIGxldmVsIG5vZGVzIHRoYXQgYXJlIGFkZGVkXG4gICAgICAgICAgICAgICAgdmFyIG5ld05vZGVzID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UucHJvY2Vzc05vZGVEYXRhKG5vZGVzVG9Qcm9jZXNzKTtcbiAgICAgICAgICAgICAgICBfLmZvckVhY2gobmV3Tm9kZXMsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgICAgIG4ucmFkaXVzID0gbi5yYWRpdXMgfHwgdGhpc0dyYXBoLmNvbnN0cy5zdGFydFJhZGl1cztcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMgPSB0aGlzR3JhcGgubm9kZXMuY29uY2F0KG5ld05vZGVzKTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YShyZXREYXRhLmxpbmtEYXRhLCB0aGlzR3JhcGgubm9kZXMpO1xuICAgICAgICAgICAgICAgIC8vT25seSBrZWVwIHRvcCBsZXZlbCBub2RlcyB0aGF0IGhhdmUgY29ubmVjdGlvbnMgdG9cbiAgICAgICAgICAgICAgICAvL3RoZSBjdXJyZW50IGZvY3VzIGdyb3VwXG4gICAgICAgICAgICAgICAgLy93ZSByZW1vdmUgdGhlIG5vZGUgbmFtZSBmcm9tIG5hbWVUb0FkZCBpZiB3ZSBhcmVcbiAgICAgICAgICAgICAgICAvL2tlZXBpbmcgaXRcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubGlua3MsIGZ1bmN0aW9uIChsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2NoZWNraW5nIGlmIHRoZXJlIGV4aXN0cyBhIGxpbmsgdG91Y2hpbmcgZWFjaCBvZiBuYW1lVG9BZGRcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuYW1lVG9BZGQuaW5kZXhPZihsLnNvdXJjZS5pZCkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzWzBdID09PSBsLnRhcmdldC5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkLnNwbGljZShuYW1lVG9BZGQuaW5kZXhPZihsLnNvdXJjZS5pZCksIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobmFtZVRvQWRkLmluZGV4T2YobC50YXJnZXQuaWQpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwc1swXSA9PT0gbC5zb3VyY2UucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVUb0FkZC5zcGxpY2UobmFtZVRvQWRkLmluZGV4T2YobC50YXJnZXQuaWQpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vV2Ugd2FudCB0byBrZWVwIHRoZW0gYWxsXG4gICAgICAgICAgICAgICAgICAgIC8vc2luY2UgYW55IGxlZnQgaW4gbmFtZVRvQWRkIHdpbGwgYmUgcmVtb3ZlZCxcbiAgICAgICAgICAgICAgICAgICAgLy93ZSByZXNldCBuYW1lVG9BZGQgaGVyZS5cbiAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkID0gW107XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy93aGF0ZXZlciBpcyByZW1haW5pbmcgaW4gbmFtZVRvQWRkIGlzbid0IGNvbm5lY3RlZFxuICAgICAgICAgICAgICAgIC8vdG8gdGhlIGZvY3VzIGdyb3VwLCBzbyB3ZSBzaG91bGQgcmVtb3ZlIGl0LlxuICAgICAgICAgICAgICAgIHZhciBub2RlVG9SZW1vdmUgPSBbXTtcbiAgICAgICAgICAgICAgICBpZiAobmFtZVRvQWRkLmxlbmd0aCAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXNHcmFwaC5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWVUb0FkZC5pbmRleE9mKHRoaXNHcmFwaC5ub2Rlc1tpXS5pZCkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkLnNwbGljZShuYW1lVG9BZGQuaW5kZXhPZih0aGlzR3JhcGgubm9kZXNbaV0uaWQpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3BsaWNlTGlua3NGb3JOb2RlKHRoaXNHcmFwaC5ub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZVRvUmVtb3ZlLnB1c2godGhpc0dyYXBoLm5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobmFtZVRvQWRkLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKG5vZGVUb1JlbW92ZSwgZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnNwbGljZSh0aGlzR3JhcGgubm9kZXMuaW5kZXhPZihuKSwgMSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXRMaW5rcygpO1xuXG4gICAgICAgICAgICAgICAgc3RhdGVTdXBlci5zcGxpdE5vZGVzLnNwbGljZShzdGF0ZVN1cGVyLnNwbGl0Tm9kZXMuaW5kZXhPZihuZXdOb2RlLmlkKSwgMSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3Tm9kZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgYWZ0ZXIgYSBzaW5nbGUgbm9kZSBpcyBqb2luZWRcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogSWYgdGhlIGZvY3VzIGdyb3VwIGhhcyBiZWVuIHNlZW4gYmVmb3JlLCBpdCB3aWxsXG4gICAgICAgICAgICAgKiBsb2FkIHRoYXQgbGF5b3V0LiBPdGhlcndpc2UsIGl0IHdpbGwgcnVuIGEgZDMgZm9yY2VcbiAgICAgICAgICAgICAqIHNpbXVsYXRpb24gdG8gZ2VuZXJhdGUgb25lLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbmV3Tm9kZSAgVGhlIG5ldyBub2RlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdqb2luTm9kZUV2ZW50JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBqb2luTm9kZUV2ZW50KG5ld05vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeSA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICAvL2lmIHRoZSBsYXN0IGV2ZW50IGhhcyB0aGUgc2FtZSBpZCwgaXQgbXVzdCBiZSB0aGVcbiAgICAgICAgICAgICAgICAvL29wcHBvc2l0ZSBvZiB0aGlzIGV2ZW50LCBzbyB3ZSByZW1vdmUgdGhhdCBldmVudCBmcm9tXG4gICAgICAgICAgICAgICAgLy90aGUgZXZlbnQgc3RhY2suXG4gICAgICAgICAgICAgICAgLy9PdGhlcndpc2UsIHdlIGFkZCB0aGUgZXZlbnQgdG8gdGhlIHN0YWNrXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggIT09IDAgJiYgc3RhdGUuZXZlbnRIaXN0b3J5W3N0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggLSAxXS5pZCA9PT0gbmV3Tm9kZS5pZCkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkucG9wKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5LnB1c2goeyBpZDogbmV3Tm9kZS5pZCwgZXZlbnQ6ICdqb2luJyB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuXG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV0sIGQuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiZm9jdXNcIjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy9zZXR0aW5nIGJhY2sgYnV0dG9uXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmJhY2tCdXR0b25FbGVtICE9IG51bGwgJiYgc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uRWxlbS5mYWRlVG8oJ3Nsb3cnLCAwKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3NldHRpbmcgdGl0bGVcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUudGl0bGVFbGVtICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSBzdGF0ZS5mb2N1c0dyb3Vwc1swXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ICs9ICcgJiAnICsgc3RhdGUuZm9jdXNHcm91cHNbMV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc3RhdGUudGl0bGVFbGVtLnRleHQodGV4dCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kuc2V0TGF5b3V0KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVW5kb2VzIHRoZSBsYXN0IHNwbGl0IG9yIGpvaW4gZXZlbnQuXG4gICAgICAgICAgICAgKiBNZWFudCB0byBiZSBjYWxsZWQgYnkgdGhlIGJhY2sgYnV0dG9uLlxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAndW5kb0xhc3RFdmVudCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdW5kb0xhc3RFdmVudCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeSA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB2YXIgbGFzdCA9IHN0YXRlLmV2ZW50SGlzdG9yeVtzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgdmFyIGlkID0gbGFzdC5pZDtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZTtcbiAgICAgICAgICAgICAgICBpZiAobGFzdC5ldmVudCA9PT0gJ2pvaW4nKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUgPSB0aGlzR3JhcGguZmluZE5vZGVCeUlkKGlkKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQzbm9kZSA9IHRoaXNHcmFwaC5maW5kRDNOb2RlKGlkKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS5kYmxjbGljayhkM25vZGUsIG5vZGUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlSWQgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbaWRdWzBdO1xuICAgICAgICAgICAgICAgICAgICBub2RlID0gdGhpc0dyYXBoLmZpbmROb2RlQnlJZChub2RlSWQpO1xuICAgICAgICAgICAgICAgICAgICBfZ2V0KFNwbGl0Sm9pblZpZXdQb2xpY3kucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoU3BsaXRKb2luVmlld1BvbGljeS5wcm90b3R5cGUpLCAnam9pbk5vZGUnLCB0aGlzKS5jYWxsKHRoaXNQb2xpY3ksIG5vZGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfV0pO1xuXG4gICAgICAgIHJldHVybiBTcGxpdEpvaW5WaWV3UG9saWN5O1xuICAgIH0oU3BsaXRKb2luTm9kZVBvbGljeS5Qb2xpY3kpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgUG9saWN5OiBTcGxpdEpvaW5WaWV3UG9saWN5XG4gICAgfTtcbn1dKTtcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYub3JnYW5pemF0aW9ucycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvb3JnYW5pemF0aW9ucycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5saXN0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnb3JnYW5pemF0aW9ubGlzdCdcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnNlcnZpY2VsYnMnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvc2VydmljZWxicycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2VydmljZWxicy5saXN0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnc2VydmljZWxiTGlzdCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2VydmljZWxicy5jcmVhdGUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ3NlcnZpY2VsYkNyZWF0ZSdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2VydmljZWxicy5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdzZXJ2aWNlbGJEZXRhaWxzJ1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnNldHRpbmdzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncycsIHtcbiAgICAgICAgICAgIHVybDogJy9nbG9iYWwnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvc2V0dGluZ3MnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXR0aW5ncy9zZXR0aW5nc21lbnUuaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5sb2dzJywge1xuICAgICAgICAgICAgdXJsOiAnL2xvZ3MnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJycsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5hdXRoJywge1xuICAgICAgICAgICAgdXJsOiAnL2F1dGgnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJycsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5saWNlbnNlJywge1xuICAgICAgICAgICAgdXJsOiAnL2xpY2Vuc2UnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJycsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5wb2xpY2llcycsIHtcbiAgICAgICAgICAgIHVybDogJy9wb2xpY2llcycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLm5ldHdvcmtzJywge1xuICAgICAgICAgICAgdXJsOiAnL25ldHdvcmtzJyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ25ldHdvcmtzZXR0aW5nJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLnZvbHVtZXMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvdm9sdW1lcycsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICd2b2x1bWVzZXR0aW5nJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLmNsdXN0ZXInLCB7XG4gICAgICAgICAgICB1cmw6ICcvY2x1c3RlcicsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdjbHVzdGVyc2V0dGluZ3MnXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXBcblxuXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJywgXG5cdCdjb250aXYuZ3JhcGgnXSlcbiAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2NvbnRpdi5tZW51LnZpc3VhbGl6YXRpb24nLCB7XG4gICAgICAgICAgICB1cmw6ICcvdmlzdWFsaXphdGlvbicsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSlcbiAgICB9XSk7XG5cbid1c2Ugc3RyaWN0Jztcbi8vIERlY2xhcmUgYXBwIGxldmVsIG1vZHVsZSB3aGljaCBkZXBlbmRzIG9uIHZpZXdzLCBhbmQgY29tcG9uZW50c1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdkFwcCcsIFtcbiAgICAndWkucm91dGVyJyxcbiAgICAnY29udGl2LmxvZ2luJyxcbiAgICAnY29udGl2Lm1lbnUnLFxuICAgICdjb250aXYuZGFzaGJvYXJkJyxcbiAgICAnY29udGl2LmFwcGxpY2F0aW9uZ3JvdXBzJyxcbiAgICAnY29udGl2Lm5ldHdvcmtzJyxcbiAgICAnY29udGl2Lm5ldHdvcmtwb2xpY2llcycsXG4gICAgJ2NvbnRpdi5zZXJ2aWNlbGJzJyxcbiAgICAnY29udGl2Lm9yZ2FuaXphdGlvbnMnLFxuICAgICdjb250aXYuc2V0dGluZ3MnLFxuICAgICdjb250aXYudmlzdWFsaXphdGlvbidcbl0pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgJyR1cmxSb3V0ZXJQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdicsIHtcbiAgICAgICAgICAgIHVybDogJycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgZmx1aWQgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSk7XG4gICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubG9naW4nKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubG9naW4nLCB7XG4gICAgICAgICAgICB1cmw6ICcvJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbG9naW4vbG9naW4uaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTG9naW5DdHJsIGFzIGxvZ2luQ3RybCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ0xvZ2luQ3RybCcsIFsnJHN0YXRlJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgbG9naW5DdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9EYXNoYm9hcmQoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LmRhc2hib2FyZCcsIHsgdXNlcm5hbWU6IGxvZ2luQ3RybC51c2VybmFtZSB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBsb2dpbigpIHtcbiAgICAgICAgICAgIHJldHVyblRvRGFzaGJvYXJkKCk7XG4gICAgICAgIH1cbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihsb2dpbkN0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IobG9naW5DdHJsKTtcbiAgICAgICAgbG9naW5DdHJsLmxvZ2luID0gbG9naW47XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bG9naW5jdHJsLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE5LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm1lbnUnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudScsIHtcbiAgICAgICAgICAgIHVybDogJy9tJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbWVudS9tZW51Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ01lbnVDdHJsIGFzIG1lbnVDdHJsJyxcbiAgICAgICAgICAgIHBhcmFtczogeyB1c2VybmFtZTogbnVsbCB9XG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdNZW51Q3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcykge1xuICAgICAgICB2YXIgbWVudUN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBsb2dvdXQoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5sb2dpbicpO1xuICAgICAgICB9XG4gICAgICAgIG1lbnVDdHJsLnVzZXJuYW1lID0gJHN0YXRlUGFyYW1zLnVzZXJuYW1lO1xuICAgICAgICBtZW51Q3RybC5sb2dvdXQgPSBsb2dvdXQ7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bWVudUN0cmwuanMubWFwXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm9yZ2FuaXphdGlvbnMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5vcmdhbml6YXRpb25zLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdvcmdhbml6YXRpb25zL29yZ2FuaXphdGlvbmNyZWF0ZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdPcmdhbml6YXRpb25DcmVhdGVDdHJsIGFzIG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdPcmdhbml6YXRpb25DcmVhdGVDdHJsJywgWyckc3RhdGUnLCAnT3JnYW5pemF0aW9uc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCBPcmdhbml6YXRpb25zTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBvcmdhbml6YXRpb25DcmVhdGVDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Pcmdhbml6YXRpb25zKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5vcmdhbml6YXRpb25zLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxDcmVhdGluZygpIHtcbiAgICAgICAgICAgIHJldHVyblRvT3JnYW5pemF0aW9ucygpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZU9yZ2FuaXphdGlvbigpIHtcbiAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgaWYgKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybC5uZXdPcmdhbml6YXRpb24ua2V5ID0gb3JnYW5pemF0aW9uQ3JlYXRlQ3RybC5uZXdPcmdhbml6YXRpb24udGVuYW50TmFtZTtcbiAgICAgICAgICAgICAgICBPcmdhbml6YXRpb25zTW9kZWwuY3JlYXRlKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwubmV3T3JnYW5pemF0aW9uKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25DcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9Pcmdhbml6YXRpb25zKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25DcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmVzZXRGb3JtKCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25DcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25DcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwubmV3T3JnYW5pemF0aW9uID0ge1xuICAgICAgICAgICAgICAgIHRlbmFudE5hbWU6ICcnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwuY3JlYXRlT3JnYW5pemF0aW9uID0gY3JlYXRlT3JnYW5pemF0aW9uO1xuICAgICAgICBvcmdhbml6YXRpb25DcmVhdGVDdHJsLmNhbmNlbENyZWF0aW5nID0gY2FuY2VsQ3JlYXRpbmc7XG4gICAgICAgIHJlc2V0Rm9ybSgpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW9yZ2FuaXphdGlvbmNyZWF0ZWN0cmwuanMubWFwXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm9yZ2FuaXphdGlvbnMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5vcmdhbml6YXRpb25zLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdPcmdhbml6YXRpb25EZXRhaWxzQ3RybCBhcyBvcmdhbml6YXRpb25EZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ29yZ2FuaXphdGlvbnMvb3JnYW5pemF0aW9uZGV0YWlscy5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignT3JnYW5pemF0aW9uRGV0YWlsc0N0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnT3JnYW5pemF0aW9uc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIE9yZ2FuaXphdGlvbnNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Pcmdhbml6YXRpb25zKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5vcmdhbml6YXRpb25zLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBkZWxldGVPcmdhbml6YXRpb24oKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgT3JnYW5pemF0aW9uc01vZGVsLmRlbGV0ZShvcmdhbml6YXRpb25EZXRhaWxzQ3RybC5vcmdhbml6YXRpb24pLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIHJldHVyblRvT3JnYW5pemF0aW9ucygpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Iob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsKTtcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsKTtcbiAgICAgICAgT3JnYW5pemF0aW9uc01vZGVsLmdldE1vZGVsQnlLZXkoJHN0YXRlUGFyYW1zLmtleSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChvcmdhbml6YXRpb24pIHtcbiAgICAgICAgICAgIG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsLm9yZ2FuaXphdGlvbiA9IG9yZ2FuaXphdGlvbjtcbiAgICAgICAgfSk7XG4gICAgICAgIG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsLmRlbGV0ZU9yZ2FuaXphdGlvbiA9IGRlbGV0ZU9yZ2FuaXphdGlvbjtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1vcmdhbml6YXRpb25kZXRhaWxzY3RybC5qcy5tYXBcblxuXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52aXN1YWxpemF0aW9uLmVkZ2UnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2VkZ2Uve3NvdXJjZU5hbWUsIHRhcmdldE5hbWUsIHNvdXJjZUxpc3QsIHRhcmdldExpc3R9JyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlTmFtZTogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TmFtZTogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgc291cmNlTGlzdDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TGlzdDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1Zpc3VhbGl6YXRpb25FZGdlQ3RybCBhcyB2aXN1YWxpemF0aW9uZWRnZUN0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9uZWRnZS5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdWaXN1YWxpemF0aW9uRWRnZUN0cmwnLCBbXCIkc2NvcGVcIiwgXCIkaHR0cFwiLCAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdWaXN1YWxpemF0aW9uU2VydmljZScsICckaW50ZXJ2YWwnLFxuICAgICAgICBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkc3RhdGUsICRzdGF0ZVBhcmFtcywgVmlzdWFsaXphdGlvblNlcnZpY2UsICRpbnRlcnZhbCkge1xuICAgICAgICAgICAgdmFyIHNvdXJjZU5hbWUgPSAkc3RhdGVQYXJhbXMuc291cmNlTmFtZTtcbiAgICAgICAgICAgIHZhciB0YXJnZXROYW1lID0gJHN0YXRlUGFyYW1zLnRhcmdldE5hbWU7XG4gICAgICAgICAgICB2YXIgc291cmNlTGlzdCA9ICRzdGF0ZVBhcmFtcy5zb3VyY2VMaXN0O1xuICAgICAgICAgICAgdmFyIHRhcmdldExpc3QgPSAkc3RhdGVQYXJhbXMudGFyZ2V0TGlzdDtcblxuICAgICAgICAgICAgLy9JZiB0aGUgcGFnZSBpcyByZWxvYWRlZCwgdGhlc2Ugc3RhdGUgcGFyYW1zIGFyZSBhbGwgbnVsbCxcbiAgICAgICAgICAgIC8vc28gaXQgd2lsbCByb3V0ZSB0aGVtIGJhY2sgdG8gdGhlIHZpc3VhbGl6YXRpb24gdGFiIHRvcCB2aWV3XG4gICAgICAgICAgICBpZiAoc291cmNlTGlzdCA9PSBudWxsIHx8IHRhcmdldExpc3QgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUudmlzdWFsaXphdGlvbi5saXN0Jyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgZCA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICB2YXIgdCA9IGQuZ2V0U2Vjb25kcygpO1xuICAgICAgICAgICAgJHNjb3BlLmVkZ2VEYXRhSW50ZXJ2YWwgPSBcbiAgICAgICAgICAgICAgICAkaW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIFZpc3VhbGl6YXRpb25TZXJ2aWNlLmdldEVkZ2VEYXRhKHNvdXJjZUxpc3QsIHRhcmdldExpc3QsIHQudG9TdHJpbmcoKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0cyA9IHJlc3VsdC5yZXN1bHRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2gocmVzdWx0cywgZnVuY3Rpb24ocikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoXy5pc0VtcHR5KHIpID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSArPSByLnNlcmllc1swXS52YWx1ZXNbMF1bMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlTmFtZSA9IHNvdXJjZU5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRhcmdldE5hbWUgPSB0YXJnZXROYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5lZGdlRGF0YSA9IGRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVkZ2VEYXRhVGltZSA9IHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0sIDMwMDApO1xuXG4gICAgICAgICAgICAvL0Rlc3Ryb3lpbmcgdGhlIGludGVydmFsIGZ1bmN0aW9uIG9uIHJvdXRlIGNoYW5nZVxuICAgICAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7ICRpbnRlcnZhbC5jYW5jZWwoJHNjb3BlLmVkZ2VEYXRhSW50ZXJ2YWwpOyB9KTtcblxuXG4gICAgICAgICAgICBWaXN1YWxpemF0aW9uU2VydmljZS5nZXRPbGRFZGdlRGF0YShzb3VyY2VMaXN0LCB0YXJnZXRMaXN0KVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSByZXN1bHQucmVzdWx0cztcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVkZ2VEYXRhID0gW107XG4gICAgICAgICAgICAgICAgICAgIC8vcmVzdWx0cywgaWYgbm90IGVtcHR5LCBhcmUgZXhwZWN0ZWQgdG8gaGF2ZVxuICAgICAgICAgICAgICAgICAgICAvLzYgZGF0YSBlbnRyaWVzXG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChyZXN1bHRzLCBmdW5jdGlvbihyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoXy5pc0VtcHR5KHIpID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gci5zZXJpZXNbMF0udmFsdWVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfLmlzRW1wdHkoZWRnZURhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChkYXRhLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGdlRGF0YS5wdXNoKGRbMV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChkYXRhLCBmdW5jdGlvbihkLCBpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGdlRGF0YVtpXSArPSBkWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNvdXJjZU5hbWUgPSBzb3VyY2VOYW1lO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudGFyZ2V0TmFtZSA9IHRhcmdldE5hbWU7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zb3VyY2VMaXN0ID0gc291cmNlTGlzdDtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRhcmdldExpc3QgPSB0YXJnZXRMaXN0O1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUub2xkRWRnZURhdGEgPSBlZGdlRGF0YTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIH0pO1xuICAgIH1dKTtcblxuXG5cblxuXG5cblxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52aXN1YWxpemF0aW9uJylcbiAgICAuZGlyZWN0aXZlKFwidmlzdWFsaXphdGlvbkVkZ2VcIiwgWyckd2luZG93JyxcbiAgICAgICAgZnVuY3Rpb24oJHdpbmRvdykge1xuICAgICAgICAgICAgZnVuY3Rpb24gdmlzdWFsaXphdGlvbkVkZ2VEMyhzY29wZSwgZDMpIHtcbiAgICAgICAgICAgICAgICB2YXIgYm9keUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gYm9keUVsLmNsaWVudFdpZHRoIC0gNDAwLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSAgYm9keUVsLmNsaWVudEhlaWdodCAtIDQwMDtcblxuXG4gICAgICAgICAgICAgICAgLy90YWtlbiBmcm9tIGh0dHA6Ly9ibC5vY2tzLm9yZy9zaW1lbmJyZWtrZW4vNjYzNDA3MFxuICAgICAgICAgICAgICAgIC8vIC8qKiBNQUlOIFNWRyAqKi9cbiAgICAgICAgICAgICAgICB2YXIgbGltaXQgPSA1OSxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbiA9IDc1MCxcbiAgICAgICAgICAgICAgICBub3cgPSBuZXcgRGF0ZShEYXRlLm5vdygpIC0gZHVyYXRpb24pO1xuXG4gICAgICAgICAgICAgICAgdmFyIGdyb3VwcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJ29yYW5nZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkMy5yYW5nZShsaW1pdCkubWFwKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2NvcGUub2xkRWRnZURhdGFbTWF0aC5mbG9vcihkLzEwKV0gfHwgMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciB4ID0gZDMudGltZS5zY2FsZSgpXG4gICAgICAgICAgICAgICAgICAgIC5kb21haW4oW25vdyAtIChsaW1pdCAtIDIpLCBub3cgLSBkdXJhdGlvbl0pXG4gICAgICAgICAgICAgICAgICAgIC5yYW5nZShbMCwgd2lkdGhdKTtcblxuICAgICAgICAgICAgICAgIHZhciB5ID0gZDMuc2NhbGUubGluZWFyKClcbiAgICAgICAgICAgICAgICAgICAgLmRvbWFpbihbMCwgZDMubWF4KGdyb3Vwcy5jdXJyZW50LmRhdGEsIGZ1bmN0aW9uIChkKSB7IHJldHVybiBkICsgMTA7IH0pXSlcbiAgICAgICAgICAgICAgICAgICAgLnJhbmdlKFtoZWlnaHQsIDBdKTtcblxuICAgICAgICAgICAgICAgIHZhciBsaW5lID0gZDMuc3ZnLmxpbmUoKVxuICAgICAgICAgICAgICAgICAgICAuaW50ZXJwb2xhdGUoJ2Jhc2lzJylcbiAgICAgICAgICAgICAgICAgICAgLngoZnVuY3Rpb24oZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHgobm93IC0gKGxpbWl0IC0gMSAtIGkpICogZHVyYXRpb24pXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC55KGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB5KGQpXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIHhTdmcgPSBkMy5zZWxlY3QoJy5ncmFwaCcpLmFwcGVuZCgnc3ZnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgMjUpXG4gICAgICAgICAgICAgICAgICAgIC5zdHlsZSgnb3ZlcmZsb3cnLCAndmlzaWJsZScpXG4gICAgICAgICAgICAgICAgICAgIC5zdHlsZSgncG9zaXRpb24nLCAnZml4ZWQnKTtcblxuICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgdmFyIHlBeGlzID0geFN2Zy5hcHBlbmQoJ2cnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAneSBheGlzJylcbiAgICAgICAgICAgICAgICAgICAgLy8gLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoMCwnICsgd2lkdGggKyAnKScpXG4gICAgICAgICAgICAgICAgICAgIC5jYWxsKHkuYXhpcyA9IGQzLnN2Zy5heGlzKCkuc2NhbGUoeSkub3JpZW50KCdsZWZ0JykpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciBzdmc9IGQzLnNlbGVjdCgnLmdyYXBoJykuYXBwZW5kKCdzdmcnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnY2hhcnQnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignd2lkdGgnLCB3aWR0aCAtIDUwKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignaGVpZ2h0JywgaGVpZ2h0ICsgNTApO1xuICAgICAgICAgICAgICAgICAgICAvLyAuc3R5bGUoJ292ZXJmbG93JywgXCJ2aXNpYmxlXCIpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGF4aXMgPSBzdmcuYXBwZW5kKCdnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ3ggYXhpcycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDAsJyArIGhlaWdodCArICcpJylcbiAgICAgICAgICAgICAgICAgICAgLmNhbGwoeC5heGlzID0gZDMuc3ZnLmF4aXMoKS5zY2FsZSh4KS5vcmllbnQoJ2JvdHRvbScpKTtcblxuICAgICAgICAgICAgICAgIHZhciBwYXRocyA9IHN2Zy5hcHBlbmQoJ2cnKTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIG5hbWUgaW4gZ3JvdXBzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBncm91cCA9IGdyb3Vwc1tuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXAucGF0aCA9IHBhdGhzLmFwcGVuZCgncGF0aCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZGF0YShbZ3JvdXAuZGF0YV0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCBuYW1lICsgJyBncm91cCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ3N0cm9rZScsIGdyb3VwLmNvbG9yKVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHRpY2soKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vdyA9IG5ldyBEYXRlKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQWRkIG5ldyB2YWx1ZXNcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBncm91cHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBncm91cCA9IGdyb3Vwc1tuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLmRhdGEucHVzaChzY29wZS5lZGdlRGF0YSB8fCAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLnBhdGguYXR0cignZCcsIGxpbmUpXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBTaGlmdCBkb21haW5cbiAgICAgICAgICAgICAgICAgICAgeC5kb21haW4oW25vdyAtIChsaW1pdCAtIDIpICogZHVyYXRpb24sIG5vdyAtIGR1cmF0aW9uXSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2xpZGUgeC1heGlzIGxlZnRcbiAgICAgICAgICAgICAgICAgICAgYXhpcy50cmFuc2l0aW9uKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kdXJhdGlvbihkdXJhdGlvbilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lYXNlKCdsaW5lYXInKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhbGwoeC5heGlzKTtcblxuICAgICAgICAgICAgICAgICAgICB5QXhpcy50cmFuc2l0aW9uKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kdXJhdGlvbihkdXJhdGlvbilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lYXNlKCdsaW5lYXInKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhbGwoeS5heGlzKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBTbGlkZSBwYXRocyBsZWZ0XG4gICAgICAgICAgICAgICAgICAgIHBhdGhzLmF0dHIoJ3RyYW5zZm9ybScsIG51bGwpXG4gICAgICAgICAgICAgICAgICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZHVyYXRpb24oZHVyYXRpb24pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZWFzZSgnbGluZWFyJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKCcgKyB4KG5vdyAtIChsaW1pdCAtIDEpICogZHVyYXRpb24pICsgJyknKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVhY2goJ2VuZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpY2soKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIG9sZGVzdCBkYXRhIHBvaW50IGZyb20gZWFjaCBncm91cFxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBuYW1lIGluIGdyb3Vwcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdyb3VwID0gZ3JvdXBzW25hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXAuZGF0YS5zaGlmdCgpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGljaygpXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybntcbiAgICAgICAgICAgICAgICByZXN0cmljdDonRUEnLFxuICAgICAgICAgICAgICAgIHJlcGxhY2U6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9uZWRnZXRlbXBsYXRlLmh0bWwnLFxuICAgICAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlKXtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJHdhdGNoR3JvdXAoWydlZGdlRGF0YScsICdvbGRFZGdlRGF0YSddLFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNjb3BlLmVkZ2VEYXRhICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLm9sZEVkZ2VEYXRhICE9IG51bGwgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2NvcGUuaW5pdGlhbGl6ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuaW5pdGlhbGl6ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZDMgPSAkd2luZG93LmQzOyAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXN1YWxpemF0aW9uRWRnZUQzKHNjb3BlLCBkMyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICB9XG4gICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICBdXG4pO1xuXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicpXG4gICAgLnNlcnZpY2UoJ1N0YXRlU2F2ZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zYXZlZFN0YXRlcyA9IHt9O1xuICAgIH0pXG4gICAgLmRpcmVjdGl2ZShcInZpc3VhbGl6YXRpb25HcmFwaFwiLCBbJyR3aW5kb3cnLCAnJHN0YXRlJywgJ1Zpc3VhbGl6ZXJHcmFwaCcsICdQb2xpY3lTZXJ2aWNlJywgJ1Zpc3VhbGl6ZXJEYXRhU291cmNlJywgJ1N0YXRlU2F2ZScsXG4gICAgICAgIGZ1bmN0aW9uKCR3aW5kb3csICRzdGF0ZSwgVmlzdWFsaXplckdyYXBoLCBQb2xpY3lTZXJ2aWNlLCBWaXN1YWxpemVyRGF0YVNvdXJjZSwgU3RhdGVTYXZlKSB7XG4gICAgICAgICAgICBmdW5jdGlvbiB2aXN1YWxpemF0aW9ubGlzdGQzKHNjb3BlLCBlbGVtLCBWaXN1YWxpemVyR3JhcGgsIFBvbGljeVNlcnZpY2UsIFZpc3VhbGl6ZXJEYXRhU291cmNlLCBTdGF0ZVNhdmUpIHtcbiAgICAgICAgICAgICAgICAvL2Rvbid0IHJ1biB1bnRpbCBhbGwgaW5pdGlhbGl6YXRpb24gY2FsbHMgaGF2ZSByZXR1cm5lZFxuICAgICAgICAgICAgICAgIGlmIChzY29wZS5ub2RlcyA9PT0gdW5kZWZpbmVkIHx8IHNjb3BlLmxpbmtzID09PSB1bmRlZmluZWQgfHwgc2NvcGUuY2hpbGRyZW5fc3RydWN0ID09PSB1bmRlZmluZWQgfHxcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuYW5jZXN0b3JzX3N0cnVjdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL2NyZWF0aW5nIERhdGFTb3VyY2VcbiAgICAgICAgICAgICAgICB2YXIgZGF0YVNvdXJjZSA9IG5ldyBWaXN1YWxpemVyRGF0YVNvdXJjZS5EYXRhU291cmNlKHNjb3BlLm5vZGVzLCBzY29wZS5saW5rcywgc2NvcGUuY2hpbGRyZW5fc3RydWN0LCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmFuY2VzdG9yc19zdHJ1Y3QsIHNjb3BlLmxhYmVscywgc2NvcGUuc2VydmljZVNlbGVjdG9ycyk7XG4gICAgICAgICAgICAgICAgZGF0YVNvdXJjZS5zZXRBbmNlc3RvcnMoKTtcblxuICAgICAgICAgICAgICAgIHZhciBub2RlcywgbGlua3M7XG5cbiAgICAgICAgICAgICAgICB2YXIgdG9wRGF0YSA9IGRhdGFTb3VyY2UuZ2V0VG9wTGV2ZWxGbG93KCk7XG4gICAgICAgICAgICAgICAgbm9kZXMgPSBkYXRhU291cmNlLnByb2Nlc3NOb2RlRGF0YSh0b3BEYXRhLm5vZGVEYXRhKTtcbiAgICAgICAgICAgICAgICBsaW5rcyA9IGRhdGFTb3VyY2UucHJvY2Vzc0xpbmtEYXRhKHRvcERhdGEubGlua0RhdGEsIG5vZGVzKTtcblxuICAgICAgICAgICAgICAgIHZhciBib2R5RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnYm9keScpWzBdO1xuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBib2R5RWwuY2xpZW50V2lkdGgsXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCA9ICBib2R5RWwuY2xpZW50SGVpZ2h0O1xuXG4gICAgICAgICAgICAgICAgLyoqIE1BSU4gU1ZHICoqL1xuICAgICAgICAgICAgICAgIHZhciByYXdTdmc9ZWxlbS5maW5kKCdzdmcnKTtcblxuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSAkKHJhd1N2Zy5wYXJlbnQoKSkub2Zmc2V0KCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgZGl2V2lkdGggPSAkKHJhd1N2Zy5wYXJlbnQoKSkud2lkdGgoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdmcgPSBkMy5zZWxlY3QocmF3U3ZnWzBdKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcIndpZHRoXCIsIGRpdldpZHRoKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcImhlaWdodFwiLCBoZWlnaHQgLSBvZmZzZXQudG9wIC0gMjApO1xuXG4gICAgICAgICAgICAgICAgLy9pbnN0YWxsaW5nIHBvbGljaWVzXG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoID0gbmV3IFZpc3VhbGl6ZXJHcmFwaC5HcmFwaChzdmcsIG5vZGVzLCBsaW5rcywgZGF0YVNvdXJjZSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuY2hpbGRyZW5fc3RydWN0LCBzY29wZS5hbmNlc3RvcnNfc3RydWN0KTtcbiAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGguaW5zdGFsbERlZmF1bHRQYXRoUG9saWN5KG5ldyBQb2xpY3lTZXJ2aWNlLlNhdmVTdGF0ZVBvbGljeShTdGF0ZVNhdmUuc2F2ZWRTdGF0ZXMpKTtcbiAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGguaW5zdGFsbERlZmF1bHRQYXRoUG9saWN5KG5ldyBQb2xpY3lTZXJ2aWNlLlBhdGhDaGFuZ2VWaWV3UG9saWN5KCRzdGF0ZSkpO1xuICAgICAgICAgICAgICAgIC8vUVRpcFBvbGljeSBpcyBmb3IgYm90aCBOb2RlcyBhbmQgUGF0aHMsIGluc3RhbGwgc2FtZSBvbmUgb24gYm90aFxuICAgICAgICAgICAgICAgIHZhciBxVGlwUG9saWN5ID0gbmV3IFBvbGljeVNlcnZpY2UuUVRpcFBvbGljeSgpO1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5pbnN0YWxsRGVmYXVsdE5vZGVQb2xpY3kocVRpcFBvbGljeSk7XG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmluc3RhbGxEZWZhdWx0UGF0aFBvbGljeShxVGlwUG9saWN5KTtcbiAgICAgICAgICAgICAgICB2YXIgc3BsaXRKb2luVmlld1BvbGljeSA9IG5ldyBQb2xpY3lTZXJ2aWNlLlNwbGl0Sm9pblZpZXdQb2xpY3koKTtcbiAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGguaW5zdGFsbERlZmF1bHROb2RlUG9saWN5KHNwbGl0Sm9pblZpZXdQb2xpY3kpO1xuICAgICAgICAgICAgICAgIHNwbGl0Sm9pblZpZXdQb2xpY3kuaW5zdGFsbEJhY2tCdXR0b24oJCgnI2JhY2tCdXR0b24nKSk7XG4gICAgICAgICAgICAgICAgc3BsaXRKb2luVmlld1BvbGljeS5pbnN0YWxsVGl0bGUoJCgnI2dyYXBoLXRpdGxlJykpO1xuXG4gICAgICAgICAgICAgICAgLy9sb2FkIG9sZCB2aWV3IGlmIGl0IGV4aXN0cy5cbiAgICAgICAgICAgICAgICBpZiAoXy5pc0VtcHR5KFN0YXRlU2F2ZS5zYXZlZFN0YXRlcykgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdyYXBoID0gc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoO1xuICAgICAgICAgICAgICAgICAgICBncmFwaC5sb2FkKFN0YXRlU2F2ZS5zYXZlZFN0YXRlcyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm57XG4gICAgICAgICAgICAgICAgcmVzdHJpY3Q6J0VBJyxcbiAgICAgICAgICAgICAgICByZXBsYWNlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Zpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbnRlbXBsYXRlLmh0bWwnLFxuICAgICAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtKXtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHsgXG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLnVuYmluZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmRlc3Ryb3koKTt9KTtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJHdhdGNoR3JvdXAoWydub2RlcycsICdsaW5rcycsICdjaGlsZHJlbl9zdHJ1Y3QnLCAnYW5jZXN0b3JzX3N0cnVjdCddLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNjb3BlLm5vZGVzICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUubGlua3MgIT0gbnVsbCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5jaGlsZHJlbl9zdHJ1Y3QgIT0gbnVsbCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5hbmNlc3RvcnNfc3RydWN0ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNjb3BlLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzdWFsaXphdGlvbmxpc3RkMyhzY29wZSwgZWxlbSwgVmlzdWFsaXplckdyYXBoLCBQb2xpY3lTZXJ2aWNlLCBWaXN1YWxpemVyRGF0YVNvdXJjZSwgU3RhdGVTYXZlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGguZGF0YVNvdXJjZS5saW5rcyA9IHNjb3BlLmxpbmtzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGgudXBkYXRlTGlua0RhdGEoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgXVxuKTtcblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52aXN1YWxpemF0aW9uJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUudmlzdWFsaXphdGlvbi5saXN0Jywge1xuICAgICAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnVmlzdWFsaXphdGlvbkxpc3RDdHJsIGFzIHZpc3VhbGl6YXRpb25MaXN0Q3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb25saXN0Lmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICA7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1Zpc3VhbGl6YXRpb25MaXN0Q3RybCcsIFtcIiRzY29wZVwiLCBcIiRodHRwXCIsICdWaXN1YWxpemF0aW9uU2VydmljZScsICckaW50ZXJ2YWwnLCBcbiAgICAgICAgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgVmlzdWFsaXphdGlvblNlcnZpY2UsICRpbnRlcnZhbCkge1xuICAgICAgICAgICAgLy90byBzZWUgdGhlIGV4cGVjdGVkIGZvcm1hdCB0byBiZSByZXR1cm5lZCBmcm9tIHRoZXNlIGNhbGxzLFxuICAgICAgICAgICAgLy9sb29rIGF0IGFwcC9jb21wb25lbnRzL2dyYXBob2JqZWN0cy9kYXRhc291cmNlL3Zpc3VhbGl6ZXJkYXRhc291cmNlLmpzXG4gICAgICAgICAgICB2YXIgc3VjY2Vzc0dyYXBoRGF0YUNhbGxiYWNrID0gZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIGxpbmtzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVJZHMgPSBbXTtcbiAgICAgICAgICAgICAgICBfLmZvckVhY2gocmVzdWx0LnJlc3VsdHNbMF0uc2VyaWVzLCBmdW5jdGlvbihzZXJpZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVuZHBvaW50ID0gc2VyaWVzLnRhZ3MuRW5kcG9pbnRJUDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb3ZpZGVyID0gc2VyaWVzLnRhZ3MuUHJvdmlkZXJJUDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGU7XG4gICAgICAgICAgICAgICAgICAgIC8vY3JlYXRpbmcgbm9kZXNcbiAgICAgICAgICAgICAgICAgICAgaWYgKF8uaW5jbHVkZXMobm9kZUlkcywgZW5kcG9pbnQpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGVuZHBvaW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBlbmRwb2ludCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3JzOiBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXMucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHMucHVzaChlbmRwb2ludCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKF8uaW5jbHVkZXMobm9kZUlkcywgcHJvdmlkZXIpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHByb3ZpZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBwcm92aWRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3JzOiBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXMucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHMucHVzaChwcm92aWRlcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy9jcmVhdGluZyBsaW5rc1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGlua091dCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogZW5kcG9pbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IHByb3ZpZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0OiBzZXJpZXMudmFsdWVzWzBdWzJdXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGxpbmtzLnB1c2gobGlua091dCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsaW5rSW4gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6IHByb3ZpZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiBlbmRwb2ludCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHdlaWdodDogc2VyaWVzLnZhbHVlc1swXVsxXVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBsaW5rcy5wdXNoKGxpbmtJbik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLm5vZGVzID0gbm9kZXM7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxpbmtzID0gbGlua3M7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLy9pbml0aWFsIGNhbGxcbiAgICAgICAgICAgIFZpc3VhbGl6YXRpb25TZXJ2aWNlLmdldEdyYXBoRGF0YSgpLnRoZW4oc3VjY2Vzc0dyYXBoRGF0YUNhbGxiYWNrLCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vd2lsbCBmYWlsIHNpbGVudGx5LCBncmFwaCB3b24ndCBiZSBkaXNwbGF5ZWRcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHsgJGludGVydmFsLmNhbmNlbCgkc2NvcGUuZ3JhcGhEYXRhSW50ZXJ2YWwpOyB9KTtcblxuICAgICAgICAgICAgVmlzdWFsaXphdGlvblNlcnZpY2UuZ2V0U3RydWN0dXJlRGF0YSgpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vdG8gc2VlIHRoZSBleHBlY3RlZCBmb3JtIG9mIGFuY2VzdG9yX3N0cnVjdCBhbmQgY2hpbGRyZW5fc3RydWN0LCBcbiAgICAgICAgICAgICAgICAvL2xvb2sgYXQgYXBwL2NvbXBvbmVudHMvZ3JhcGhvYmplY3RzL2RhdGFzb3VyY2UvdmlzdWFsaXplcmRhdGFzb3VyY2UuanNcbiAgICAgICAgICAgICAgICAkc2NvcGUuYW5jZXN0b3JzX3N0cnVjdCA9IHJlc3VsdC5hbmNlc3RvcnNfc3RydWN0O1xuICAgICAgICAgICAgICAgICRzY29wZS5jaGlsZHJlbl9zdHJ1Y3QgPSByZXN1bHQuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgICRzY29wZS5sYWJlbHMgPSByZXN1bHQubGFiZWxzO1xuICAgICAgICAgICAgICAgICRzY29wZS5zZXJ2aWNlU2VsZWN0b3JzID0gcmVzdWx0LnNlcnZpY2VTZWxlY3RvcnM7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vd2lsbCBmYWlsIHNpbGVudGx5LCBncmFwaCB3b24ndCBiZSBkaXNwbGF5ZWRcbiAgICAgICAgICAgIH0pO1xuICAgIH1dKTtcblxuXG5cblxuXG5cblxuXG5cblxuXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicpXG4gICAgLmZhY3RvcnkoJ1Zpc3VhbGl6YXRpb25TZXJ2aWNlJywgWyckaHR0cCcsICckcScsIGZ1bmN0aW9uICgkaHR0cCwgJHEpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1ha2VzIGEgZ2V0IHJlcXVlc3Qgd2l0aCB0aGUgdXJsIGFuZCBjb25maWcuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICB1cmwgICAgIFRoZSB1cmxcbiAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGNvbmZpZyAgVGhlIGNvbmZpZ3VyYXRpb25zXG4gICAgICAgICAqIEByZXR1cm4gICAgIHskSHR0cCBQcm9taXNlfSAgIFByb21pc2Ugb2YgdGhlIHJlcXVlc3RcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIG1ha2VHZXQodXJsLCBjb25maWcpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAkaHR0cC5nZXQodXJsLCBjb25maWcpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYWtlcyBhIHBvc3QgcmVxdWVzdCB3aXRoIHRoZSB1cmwgYW5kIGRhdGFcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHVybCAgICAgVGhlIHVybFxuICAgICAgICAgKiBAcGFyYW0gICAgICB7SlNPTn0gICAgZGF0YSAgICBUaGUgZGF0YVxuICAgICAgICAgKiBAcmV0dXJuICAgICB7JEh0dHAgUHJvbWlzZX0gICBQcm9taXNlIG9mIHRoZSByZXF1ZXN0XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBtYWtlUG9zdCh1cmwsIGRhdGEpIHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogY29udmVydHMgdGhlIGRhdGEgaW50byB4LXd3dy1mcm9tLXVybGVuY29kZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SlNPTn0gIG9iaiAgICAgSlNPTiBkYXRhIG9iamVjdFxuICAgICAgICAgICAgICogQHJldHVybiAgICAge3N0cmluZ30gIHgtd3d3LWZvcm0tdXJsZW5jb2RlZCBzdHJpbmdcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdmFyIHBhcmFtID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gJycsIG5hbWUsIHZhbHVlLCBmdWxsU3ViTmFtZSwgc3ViTmFtZSwgc3ViVmFsdWUsIGlubmVyT2JqLCBpO1xuICAgICAgICAgICAgICAgIGZvciAobmFtZSBpbiBvYmopIHtcbiAgICAgICAgICAgICAgICAgIHZhbHVlID0gb2JqW25hbWVdO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGk9MDsgaTx2YWx1ZS5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlZhbHVlID0gdmFsdWVbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVsbFN1Yk5hbWUgPSBuYW1lICsgJ1snICsgaSArICddJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbm5lck9iaiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlubmVyT2JqW2Z1bGxTdWJOYW1lXSA9IHN1YlZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ICs9IHBhcmFtKGlubmVyT2JqKSArICcmJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIE9iamVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChzdWJOYW1lIGluIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViVmFsdWUgPSB2YWx1ZVtzdWJOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdWxsU3ViTmFtZSA9IG5hbWUgKyAnWycgKyBzdWJOYW1lICsgJ10nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlubmVyT2JqID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5uZXJPYmpbZnVsbFN1Yk5hbWVdID0gc3ViVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkgKz0gcGFyYW0oaW5uZXJPYmopICsgJyYnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYodmFsdWUgIT09IHVuZGVmaW5lZCAmJiB2YWx1ZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkgKz0gZW5jb2RlVVJJQ29tcG9uZW50KG5hbWUpICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKSArICcmJztcbiAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHF1ZXJ5Lmxlbmd0aCA/IHF1ZXJ5LnN1YnN0cigwLCBxdWVyeS5sZW5ndGggLSAxKSA6IHF1ZXJ5O1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICB1cmw6dXJsLFxuICAgICAgICAgICAgICAgIG1ldGhvZDonUE9TVCcsXG4gICAgICAgICAgICAgICAgZGF0YTogZGF0YSxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCdcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHRyYW5zZm9ybVJlcXVlc3Q6IFtmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhbmd1bGFyLmlzT2JqZWN0KGRhdGEpICYmIFN0cmluZyhkYXRhKSAhPT0gJ1tvYmplY3QgRmlsZV0nID8gcGFyYW0oZGF0YSkgOiBkYXRhO1xuICAgICAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0R3JhcGhEYXRhKCkge1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuVklTVUFMSVpBVElPTl9FTkRQT0lOVDtcbiAgICAgICAgICAgIHVybCArPSAnaW5mbHV4L3F1ZXJ5JztcbiAgICAgICAgICAgIHZhciBjb25maWcgPSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgICAgICAgICAgIGRiOlwidGVsZWdyYWZcIixcbiAgICAgICAgICAgICAgICAgICAgcTpcIlNFTEVDVCBCeXRlc0luLCBCeXRlc091dCwgRW5kcG9pbnRJUCwgUHJvdmlkZXJJUCBGUk9NIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDFtIEdST1VQIEJZICogTElNSVQgMVwiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBtYWtlR2V0KHVybCwgY29uZmlnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldFN0cnVjdHVyZURhdGEoKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WSVNVQUxJWkFUSU9OX0VORFBPSU5UO1xuICAgICAgICAgICAgdXJsICs9ICdzZXJ2aWNlcyc7XG4gICAgICAgICAgICByZXR1cm4gbWFrZUdldCh1cmwpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gYnVpbGRXaGVyZVF1ZXJ5KHBvaW50cywgdHlwZSkge1xuICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gXCIoXCI7XG4gICAgICAgICAgICBxdWVyeSArPSB0eXBlICsgXCI9XCI7XG4gICAgICAgICAgICBxdWVyeSArPSBcIidcIiArIHBvaW50c1swXSArIFwiJyBcIjtcbiAgICAgICAgICAgIC8vc3RhcnRzIGF0IDEsIHNvIHdpbGwgbm90IHJ1biBpZiBsZW5ndGggaXMgMVxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBwb2ludHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBxdWVyeSArPSAnT1IgJztcbiAgICAgICAgICAgICAgICBxdWVyeSArPSB0eXBlICsgXCI9XCI7XG4gICAgICAgICAgICAgICAgcXVlcnkgKz0gXCInXCIgKyBwb2ludHNbaV0gKyBcIicgXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBxdWVyeSArPSBcIilcIjtcbiAgICAgICAgICAgIHJldHVybiBxdWVyeTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldEVkZ2VEYXRhKHNvdXJjZUxpc3QsIHRhcmdldExpc3QsIHRpbWUpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLlZJU1VBTElaQVRJT05fRU5EUE9JTlQ7XG4gICAgICAgICAgICB1cmwgKz0gJ2luZmx1eC9xdWVyeSc7XG5cbiAgICAgICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICBkYiA6IFwidGVsZWdyYWZcIixcbiAgICAgICAgICAgICAgICAgICAgcTogXCJTRUxFQ1Qgc3VtKFwiICsgJ0J5dGVzT3V0JyArIFwiKSBmcm9tIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDE1cyBBTkQgXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeShzb3VyY2VMaXN0LCBcIkVuZHBvaW50SVBcIikgK1wiIEFORCBcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeSh0YXJnZXRMaXN0LCAnUHJvdmlkZXJJUCcpIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgXCJHUk9VUCBCWSB0aW1lKDIwcykgTElNSVQgMTsgU0VMRUNUIHN1bShcIiArICdCeXRlc0luJyArIFwiKSBmcm9tIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDE1cyBBTkQgXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeShzb3VyY2VMaXN0LCAnUHJvdmlkZXJJUCcpICtcIiBBTkQgXCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkodGFyZ2V0TGlzdCwgJ0VuZHBvaW50SVAnKSBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIFwiR1JPVVAgQlkgdGltZSgyMHMpIGZpbGwoMCkgTElNSVQgMVwiXG4gICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIG1ha2VQb3N0KHVybCwgZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICBcblxuICAgICAgICBmdW5jdGlvbiBnZXRPbGRFZGdlRGF0YShzb3VyY2VMaXN0LCB0YXJnZXRMaXN0KSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WSVNVQUxJWkFUSU9OX0VORFBPSU5UO1xuICAgICAgICAgICAgdXJsICs9ICdpbmZsdXgvcXVlcnknO1xuICAgICAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgICAgIGRiIDogXCJ0ZWxlZ3JhZlwiLFxuICAgICAgICAgICAgICAgICAgICBxOiBcIlNFTEVDVCBzdW0oXCIgKyAnQnl0ZXNPdXQnICsgXCIpIEZST00gaHR0cGpzb25fc3Zjc3RhdHMgV0hFUkUgdGltZSA+IG5vdygpIC0gMW0gQU5EIFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkoc291cmNlTGlzdCwgXCJFbmRwb2ludElQXCIpICtcIiBBTkQgXCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkodGFyZ2V0TGlzdCwgXCJQcm92aWRlcklQXCIpIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgXCIgR1JPVVAgQlkgdGltZSgxMHMpIGZpbGwoMCkgTElNSVQgNjsgU0VMRUNUIHN1bShcIiArICdCeXRlc0luJyArIFwiKSBGUk9NIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDFtIEFORCBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHNvdXJjZUxpc3QsIFwiUHJvdmlkZXJJUFwiKSArXCIgQU5EIFwiIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHRhcmdldExpc3QsIFwiRW5kcG9pbnRJUFwiKSBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIFwiIEdST1VQIEJZIHRpbWUoMTBzKSBmaWxsKDApIExJTUlUIDZcIlxuICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBtYWtlUG9zdCh1cmwsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldEdyYXBoRGF0YTogZ2V0R3JhcGhEYXRhLFxuICAgICAgICAgICAgZ2V0U3RydWN0dXJlRGF0YTogZ2V0U3RydWN0dXJlRGF0YSxcbiAgICAgICAgICAgIGdldEVkZ2VEYXRhOiBnZXRFZGdlRGF0YSxcbiAgICAgICAgICAgIGdldE9sZEVkZ2VEYXRhOiBnZXRPbGRFZGdlRGF0YVxuICAgICAgICB9XG4gICAgfV0pO1xuXG5cblxuXG5cblxuXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDEwLzE0LzE2LlxuICovXG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2RlbHMubW9kdWxlLmpzLm1hcCIsIi8qKlxuICogRGVmaW5pbmcgdGhlIEdyYXBoIE1vZHVsZS5cbiAqIFNlZSBERVNJR04ubWQgZm9yIGluZm8gb24gR3JhcGggT2JqZWN0cy5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcsIFtdKTtcblxuXG5cblxuIiwiYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiLCBbXSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwIiwiLyoqXG4gKiBUaGUgYmFzZSBjbGFzcyB0aGUgRGF0YVNvdXJjZSBvYmplY3QuXG4gKiBcbiAqIFRoZSBEYXRhU291cmNlIG9iamVjdCB0YWtlcyBpbiBub2RlIGFuZCBsaW5rIGRhdGEgZnJvbSB0aGUgc2VydmVyLCBcbiAqIGFuZCBwcm92aWRlcyBtZXRob2RzIGZvciBjb252ZXJ0aW5nIGFuZCBtYW5pcHVsYXRpbmcgdGhlIGRhdGEgZm9yXG4gKiB0aGUgZ3JhcGggb2JqZWN0LlxuICogXG4gKiBUbyB3cml0ZSB5b3VyIG93biBEYXRhU291cmNlIG9iamVjdCwgY3JlYXRlIGEgbmV3IGZhY3RvcnkgdGhhdCB1c2VzIHRoZSBcbiAqIERhdGFTb3VyY2UgeW91IHdhbnQgdG8gaW5oZXJpdCBhcyBhIGRlcGVuZGVuY3ksIGFuZCBleHRlbmQgXG4gKiBpdHMgRGF0YVNvdXJjZSBjbGFzcy4gXG4gKiBSZXR1cm4gdGhlIGNsYXNzIG9iamVjdCB3aXRoIERhdGFTb3VyY2UgYXMga2V5LlxuICogXG4gKiBOb2RlIGRhdGEgaXMgZXhwZWN0ZWQgdG8gYmUgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6XG4gKiB7aWQ6bm9kZV9pZCwgdGV4dDpub2RlX3RleHR9XG4gKiBcbiAqIExpbmsgZGF0YSBpcyBleHBlY3RlZCB0byBiZSBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDpcbiAqIHtzb3VyY2U6IHNvdXJjZU5vZGVJZCwgdGFyZ2V0OiB0YXJnZXROb2RlSWR9XG4gKiBcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ0RhdGFTb3VyY2UnLCBbJ05vZGUnLCAnTGluaycsIFxuICAgIFx0ZnVuY3Rpb24gKE5vZGUsIExpbmspIHtcblxuICAgIFx0Y2xhc3MgRGF0YVNvdXJjZSB7XG4gICAgXHRcdC8qKlxuICAgIFx0XHQgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgXHRcdCAqXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBub2RlcyAgICAgICAgICAgICAgVGhlIG5vZGUgZGF0YSBcbiAgICBcdFx0ICogQHBhcmFtICAgICAge0FycmF5fSAgIGxpbmtzICAgICAgICAgICAgICBUaGUgbGluayBkYXRhXG4gICAgXHRcdCAqL1xuXHRcdFx0Y29uc3RydWN0b3Iobm9kZXMsIGxpbmtzKSB7XG5cdFx0XHRcdHRoaXMubm9kZXMgPSBub2Rlcztcblx0XHRcdFx0dGhpcy5saW5rcyA9IGxpbmtzO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFJlcGxhY2VzIHRoZSBub2RlIGRhdGFcblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGVzICAgVGhlIG5vZGVzXG5cdFx0XHQgKi9cblx0XHRcdHVwZGF0ZU5vZGVzKG5vZGVzKSB7XG5cdFx0XHRcdHRoaXMubm9kZXMgPSBub2Rlcztcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBSZXBsYWNlcyB0aGUgbGluayBkYXRhXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0xpbmt9ICBsaW5rcyAgIFRoZSBsaW5rc1xuXHRcdFx0ICovXG5cdFx0XHR1cGRhdGVMaW5rcyhsaW5rcykge1xuXHRcdFx0XHR0aGlzLmxpbmtzID0gbGlua3M7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogUmV0dXJucyB0aGUgTmFtZSBhdHRyaWJ1dGUgb2YgdGhlIE5vZGUgd2l0aCB0aGUgXG5cdFx0XHQgKiBtYXRjaGluZyBpZFxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG5cdFx0XHQgKiBAcmV0dXJuICAgICB7c3RyaW5nfSAgbmFtZSBvZiB0aGUgbWF0Y2hpbmcgbm9kZVxuXHRcdFx0ICovXG5cdFx0XHRub2RlSWRUb05hbWUoaWQpIHtcblx0XHQgICAgICAgIHZhciBub2RlcyA9IHRoaXMubm9kZXM7XG5cdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0ICAgICAgICAgICAgaWYgKG5vZGVzW2ldLmlkID09IGlkKSB7XG5cdFx0ICAgICAgICAgICAgICAgIHJldHVybiBub2Rlc1tpXS5uYW1lO1xuXHRcdCAgICAgICAgICAgIH1cblx0XHQgICAgICAgIH1cblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBwcm9jZXNzIHRoZSBub2RlRGF0YSB0byBjcmVhdGUgTm9kZSBvYmplY3RzXG5cdFx0ICAgICAqXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVEYXRhICBOb2RlRGF0YSB0byBjb252ZXJ0IFxuXHRcdCAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gbm9kZSBvYmplY3RzXG5cdFx0ICAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIE5vZGUgb2JqZWN0c1xuXHRcdCAgICAgKi9cblx0XHQgICAgcHJvY2Vzc05vZGVEYXRhKG5vZGVEYXRhKSB7XG5cdFx0ICAgICAgICB2YXIgbm9kZXMgPSBbXTtcblx0XHQgICAgICAgIF8uZm9yRWFjaChub2RlRGF0YSwgZnVuY3Rpb24oZGF0YSkge1xuXHRcdCAgICAgICAgICAgIHZhciBuZXdOb2RlID0gbmV3IE5vZGUuTm9kZShudWxsLCBudWxsLCBkYXRhLmlkLCBkYXRhLnRleHQsIG51bGwpO1xuXHRcdCAgICAgICAgICAgIG5vZGVzLnB1c2gobmV3Tm9kZSk7XG5cdFx0ICAgICAgICB9KTtcblx0XHQgICAgICAgIHJldHVybiBub2Rlcztcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBwcm9jZXNzIHRoZSBsaW5rRGF0YVxuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBsaW5rRGF0YSAgVGhlIGxpbmsgZGF0YVxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlcyAgICAgVGhlIG5vZGVzIGZyb20gcHJvY2Vzc05vZGVEYXRhXG5cdFx0ICAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIExpbmsgb2JqZWN0c1xuXHRcdCAgICAgKi9cblx0XHQgICAgcHJvY2Vzc0xpbmtEYXRhKGxpbmtEYXRhLCBub2Rlcykge1xuXHRcdCAgICBcdC8qKlxuXHRcdFx0ICAgICAqIFJldHVybnMgdGhlIG5vZGUgdGhhdCBtYXRjaGVzIHRoZSBpZFxuXHRcdFx0ICAgICAqXG5cdFx0XHQgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gaWQgICAgICBUaGUgaWRlbnRpZmllclxuXHRcdFx0ICAgICAqIEByZXR1cm4gICAgIHtOb2RlfSAgIFRoZSBub2RlIHdpdGggdGhlIG1hdGNoaW5nIGlkXG5cdFx0XHQgICAgICovXG5cdFx0XHQgICAgZnVuY3Rpb24gZmluZE5vZGVCeUlkKGlkLCBub2Rlcykge1xuXHRcdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHQgICAgICAgICAgICBpZiAoaWQgPT0gbm9kZXNbaV0uaWQpIHtcblx0XHRcdCAgICAgICAgICAgICAgICByZXR1cm4gbm9kZXNbaV07XG5cdFx0XHQgICAgICAgICAgICB9XG5cdFx0XHQgICAgICAgIH1cblx0XHRcdCAgICB9XG5cblx0XHQgICAgICAgIHZhciBsaW5rcyA9IFtdO1xuXHRcdCAgICAgICAgLy90cmFuc2Zvcm1pbmcgbGluayBkYXRhXG5cdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpbmtEYXRhLmxlbmd0aDsgaSsrKSB7XG5cdFx0ICAgICAgICAgICAgaWYgKGxpbmtEYXRhW2ldLnNvdXJjZSAhPSBsaW5rRGF0YVtpXS50YXJnZXQpIHtcblx0XHQgICAgICAgICAgICAgICAgdmFyIHNvdXJjZSA9IGZpbmROb2RlQnlJZChsaW5rRGF0YVtpXS5zb3VyY2UsIG5vZGVzKTtcblx0XHQgICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IGZpbmROb2RlQnlJZChsaW5rRGF0YVtpXS50YXJnZXQsIG5vZGVzKTtcblx0XHQgICAgICAgICAgICAgICAgaWYgKHNvdXJjZSA9PSBudWxsIHx8IHRhcmdldCA9PSBudWxsKSB7XG5cdFx0ICAgICAgICAgICAgICAgIFx0Y29udGludWU7XG5cdFx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICB2YXIgbGluayA9IG5ldyBMaW5rLkxpbmsoc291cmNlLCB0YXJnZXQpO1xuXHQgICAgICAgICAgICAgICAgICAgIGxpbmtzLnB1c2gobGluayk7XG5cdFx0ICAgICAgICAgICAgfSAgXG5cdFx0ICAgICAgICB9XG5cdFx0ICAgICAgICByZXR1cm4gbGlua3M7XG5cdFx0ICAgIH1cblx0XHR9XG5cdFx0cmV0dXJuIHtcblx0XHRcdERhdGFTb3VyY2U6RGF0YVNvdXJjZVxuXHRcdH1cbn1dKTtcblxuXG5cblxuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8xNC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5tb2RlbHMnLCBbXSk7XG52YXIgQ29udGl2R2xvYmFscyA9IChmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgLy9SRVNUIGVuZHBvaW50cyBmb3IgTkVUTUFTVEVSXG4gICAgICAgICdORVRXT1JLU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9uZXR3b3Jrcy8nLFxuICAgICAgICAnTkVUV09SS1NfSU5TUEVDVF9FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9pbnNwZWN0L25ldHdvcmtzLycsXG4gICAgICAgICdTRVJWSUNFTEJTX0lOU1BFQ1RfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvaW5zcGVjdC9zZXJ2aWNlTEJzLycsXG4gICAgICAgICdQT0xJQ0lFU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9wb2xpY3lzLycsXG4gICAgICAgICdSVUxFU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9ydWxlcy8nLFxuICAgICAgICAnQVBQTElDQVRJT05HUk9VUFNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvZW5kcG9pbnRHcm91cHMvJyxcbiAgICAgICAgJ1NFUlZJQ0VMQlNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvc2VydmljZUxCcy8nLFxuICAgICAgICAnT1JHQU5JWkFUSU9OU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS90ZW5hbnRzLycsXG4gICAgICAgICdORVRXT1JLX1NFVFRJTkdTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL2dsb2JhbHMvJyxcbiAgICAgICAgJ05FVFBST0ZJTEVTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL25ldHByb2ZpbGVzLycsXG4gICAgICAgICdCR1BTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL0JncHMvJyxcbiAgICAgICAgJ0JHUFNfSU5TUEVDVF9FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9pbnNwZWN0L0JncHMvJyxcbiAgICAgICAgJ1ZJU1VBTElaQVRJT05fRU5EUE9JTlQnOiAnL3Zpc3VhbGl6YXRpb24vJyxcbiAgICAgICAgLy9SRVNUIGVuZHBvaW50cyBmb3IgVk9MTUFTVEVSXG4gICAgICAgICdWT0xVTUVTX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvdm9sdW1lcy8nLFxuICAgICAgICAnVk9MVU1FU19DUkVBVEVfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci92b2x1bWVzL2NyZWF0ZS8nLFxuICAgICAgICAnVk9MVU1FU19ERUxFVEVfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci92b2x1bWVzL3JlbW92ZS8nLFxuICAgICAgICAnVk9MVU1FU19DT1BZU05BUFNIT1RTX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvdm9sdW1lcy9jb3B5JyxcbiAgICAgICAgJ1ZPTFVNRVNfVVNFU19FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3VzZXMvbW91bnRzLycsXG4gICAgICAgICdWT0xVTUVTX1NOQVBTSE9UU19FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3NuYXBzaG90cy8nLFxuICAgICAgICAnU1RPUkFHRVBPTElDSUVTX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvcG9saWNpZXMvJyxcbiAgICAgICAgJ1ZPTFVNRVNfR0xPQkFMX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvZ2xvYmFsLycsXG4gICAgICAgIC8vUkVTVCBlbmRwb2ludHMgZm9yIENMVVNURVJcbiAgICAgICAgJ05PREVTX0xJU1RfRU5EUE9JTlQnOiAnL2luZm8vbm9kZXMnLFxuICAgICAgICAnTk9ERVNfRElTQ09WRVJfRU5EUE9JTlQnOiAnL2Rpc2NvdmVyL25vZGVzJyxcbiAgICAgICAgJ05PREVTX0NPTU1JU1NJT05fRU5EUE9JTlQnOiAnL2NvbW1pc3Npb24vbm9kZXMnLFxuICAgICAgICAnTk9ERVNfREVDT01NSVNTSU9OX0VORFBPSU5UJzogJy9kZWNvbW1pc3Npb24vbm9kZXMnLFxuICAgICAgICAnTk9ERVNfTUFJTlRFTkFOQ0VfRU5EUE9JTlQnOiAnL21haW50ZW5hbmNlL25vZGVzJyxcbiAgICAgICAgJ05PREVTX0xBU1RfSk9CX0VORFBPSU5UJzogJy9pbmZvL2pvYi9sYXN0JyxcbiAgICAgICAgJ05PREVTX0FDVElWRV9KT0JfRU5EUE9JTlQnOiAnL2luZm8vam9iL2FjdGl2ZScsXG4gICAgICAgICdOT0RFU19TRVRUSU5HU19TRVRfRU5EUE9JTlQnOiAnL2dsb2JhbHMnLFxuICAgICAgICAnTk9ERVNfU0VUVElOR1NfR0VUX0VORFBPSU5UJzogJy9pbmZvL2dsb2JhbHMnLFxuICAgICAgICAvL1JlZnJlc2ggaW50ZXJ2YWwgaW4gbWlsbGlzZWNvbmRzXG4gICAgICAgICdSRUZSRVNIX0lOVEVSVkFMJzogNTAwMCxcbiAgICAgICAgLy9SZWdFeCBmb3IgdmFsaWRhdGlvblxuICAgICAgICAnQ0lEUl9SRUdFWCc6ICdeKChbMC05XXxbMS05XVswLTldfDFbMC05XXsyfXwyWzAtNF1bMC05XXwyNVswLTVdKVxcLil7M30oWzAtOV18WzEtOV1bMC05XXwxWzAtOV17Mn18MlswLTRdWzAtOV18MjVbMC01XSkoXFwvKFswLTldfFsxLTJdWzAtOV18M1swLTJdKSkkJyxcbiAgICAgICAgJ1ZMQU5fUkVHRVgnOiAnXihbMC05XXsxLDR9Py1bMC05XXsxLDR9PykkJyxcbiAgICAgICAgJ1ZYTEFOX1JFR0VYJzogJ14oWzAtOV17MSw4fT8tWzAtOV17MSw4fT8pJCcsXG4gICAgICAgICdOVU1CRVJfUkVHRVgnOiAnXlswLTldKiQnXG4gICAgfTtcbn0pKCk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnV0aWxzJywgW10pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIi8qKlxuICogVGhlIERhdGFTb3VyY2UgdXNlZCBmb3IgdGhlIHZpc3VhbGl6YXRpb24gdGFiLlxuICogXG4gKiBOb2RlIERhdGEgZnJvbSB0aGUgc2VydmVyIGlzIGV4cGVjdGVkIHRvIGJlIGluIHRoZSBmb2xsb3dpbmcgZm9ybWF0OlxuICoge2lkOiBub2RlX2lkLCB0ZXh0OiBub2RlX3RleHR9XG4gKiBQYXJlbnQgYW5kIEFuY2VzdG9yIGF0dHJpYnV0ZXMgY2FuIGJlIHNldCBieSBjYWxsaW5nIHNldEFuY2VzdG9yc1xuICogXG4gKiBMaW5rIERhdGEgZnJvbSB0aGUgc2VydmVyIGlzIGV4cGVjdGVkIHRvIGJlIGluIHRoZSBmb2xsb3dpbmcgZm9ybWF0OlxuICoge3NvdXJjZTogc291cmNlTm9kZUlkLCB0YXJnZXQ6IHRhcmdldE5vZGVJZCwgd2VpZ2h0OiBsaW5rV2VpZ2h0fVxuICogXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdWaXN1YWxpemVyRGF0YVNvdXJjZScsIFsnRGF0YVNvdXJjZScsICdWaXN1YWxpemVyTm9kZScsICdWaXN1YWxpemVyTGluaycsIFxuICAgIFx0ZnVuY3Rpb24gKERhdGFTb3VyY2UsIFZpc3VhbGl6ZXJOb2RlLCBWaXN1YWxpemVyTGluaykge1xuXG4gICAgXHRjbGFzcyBWaXN1YWxpemVyRGF0YVNvdXJjZSBleHRlbmRzIERhdGFTb3VyY2UuRGF0YVNvdXJjZSB7XG4gICAgXHRcdC8qKlxuICAgIFx0XHQgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgXHRcdCAqIFxuICAgIFx0XHQgKiBDaGlsZHJlbiBTdHJ1Y3QgYW5kIGFuY2VzdG9yc19zdHJ1Y3QgYXJlIEpTT04gb2JqZWN0cyxcbiAgICBcdFx0ICogbWFwcGluZyBhIG5vZGUgSWQgdG8gYSBsaXN0IG9mIGl0J3MgY2hpbGRyZW4gb3IgYW5jZXN0b3JzLlxuICAgIFx0XHQgKiBDaGlsZHJlbiBTdHJ1Y3QgaXMgYWxzbyBleHBlY3RlZCB0byBoYXZlIGEgZmllbGQgY2FsbGVkXG4gICAgXHRcdCAqIHRvcExldmVsLCB0aGF0IG1hcHMgdG8gYSBsaXN0IG9mIGFsbCB0aGUgbm9kZXMgdGhhdCBkb24ndFxuICAgIFx0XHQgKiBoYXZlIGFueSBwYXJlbnRzLlxuICAgIFx0XHQgKlxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgbm9kZXMgICAgICAgICAgICAgIFRoZSBub2RlIGRhdGEgXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBsaW5rcyAgICAgICAgICAgICAgVGhlIGxpbmsgZGF0YVxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgY2hpbGRyZW5fc3RydWN0ICAgIFRoZSBjaGlsZHJlbiBzdHJ1Y3R1cmVcbiAgICBcdFx0ICogQHBhcmFtICAgICAge09iamVjdH0gIGFuY2VzdG9yc19zdHJ1Y3QgICBUaGUgYW5jZXN0b3JzIHN0cnVjdHVyZVxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgbGFiZWxzICAgICAgICAgICAgIFRoZSBsYWJlbHNcbiAgICBcdFx0ICogQHBhcmFtICAgICAge0FycmF5fSAgIHNlbGVjdG9ycyAgICAgICAgICBUaGUgc2VsZWN0b3JzXG4gICAgXHRcdCAqL1xuXHRcdFx0Y29uc3RydWN0b3Iobm9kZXMsIGxpbmtzLCBjaGlsZHJlbl9zdHJ1Y3QsIGFuY2VzdG9yc19zdHJ1Y3QsIFxuXHRcdFx0XHRcdGxhYmVscywgc2VsZWN0b3JzKSB7XG5cdFx0XHRcdHN1cGVyKG5vZGVzLGxpbmtzKTtcblx0XHRcdFx0dGhpcy5jaGlsZHJlbl9zdHJ1Y3QgPSBjaGlsZHJlbl9zdHJ1Y3Q7XG5cdFx0XHRcdHRoaXMuYW5jZXN0b3JzX3N0cnVjdCA9IGFuY2VzdG9yc19zdHJ1Y3Q7XG5cdFx0XHRcdHRoaXMubGFiZWxzID0gbGFiZWxzO1xuXHRcdFx0XHR0aGlzLnNlbGVjdG9ycyA9IHNlbGVjdG9ycztcblx0XHRcdH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogRGV0ZXJtaW5lcyBpZiBpdCBoYXMgY2hpbGQuXG5cdFx0ICAgICAqXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICAgaWQgICAgICBUaGUgaWRlbnRpZmllclxuXHRcdCAgICAgKiBAcmV0dXJuICAgICB7Ym9vbGVhbn0gIFRydWUgaWYgaGFzIGNoaWxkLCBGYWxzZSBvdGhlcndpc2UuXG5cdFx0ICAgICAqL1xuXHRcdCAgICBoYXNDaGlsZChpZCkge1xuXHRcdCAgICBcdGlmICh0aGlzLmNoaWxkcmVuX3N0cnVjdFtpZF0gPT0gbnVsbCkge1xuICAgICAgICAgICAgXHRcdHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIFx0fVxuICAgICAgICAgICAgXHRyZXR1cm4gdHJ1ZTtcdFxuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIFNldHMgdGhlIHBhcmVudCBhbmQgYW5jZXN0b3JzIGF0dHJpYnV0ZSB1c2luZyBcblx0XHQgICAgICogYW5jZXN0b3JzX3N0cnVjdCBmb3IgYWxsIHRoZSBub2Rlc1xuXHRcdCAgICAgKiBBbHNvIGFkZHMgYW55IG5vZGVzIHdpdGhvdXQgYW5jZXN0b3JzLCB0aGF0IGFyZW4ndCBcblx0XHQgICAgICogdG9wbGV2ZWwgdG8gdGhlIGNsaWVudCBzZXJ2aWNlLlxuXHRcdCAgICAgKi9cblx0XHQgICAgc2V0QW5jZXN0b3JzKCkge1xuXHRcdCAgICBcdHZhciB0aGlzRGF0YVNvdXJjZSA9IHRoaXM7XG5cdFx0ICAgIFx0dmFyIGFkZGVkQ2xpZW50ID0gZmFsc2U7XG5cdFx0ICAgIFx0Xy5mb3JFYWNoKHRoaXNEYXRhU291cmNlLm5vZGVzLCBmdW5jdGlvbihub2RlKSB7XG5cdFx0ICAgIFx0XHRub2RlLmFuY2VzdG9ycyA9IHRoaXNEYXRhU291cmNlLmFuY2VzdG9yc19zdHJ1Y3Rbbm9kZS5pZF0gfHwgW107XG5cdFx0ICAgIFx0XHRpZiAoXy5pc0VtcHR5KG5vZGUuYW5jZXN0b3JzKSA9PT0gZmFsc2UpIHtcblx0XHQgICAgXHRcdFx0bm9kZS5wYXJlbnQgPSBub2RlLmFuY2VzdG9yc1swXTtcblx0XHQgICAgXHRcdH0gZWxzZSB7XG5cdFx0ICAgIFx0XHRcdGlmIChfLmluY2x1ZGVzKHRoaXNEYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbCwgbm9kZS5pZCkgPT0gZmFsc2UpIHtcblx0XHQgICAgXHRcdFx0XHQvL2NvbnRhaW5lciBoYXMgbm8gcGFyZW50XG5cdFx0ICAgIFx0XHRcdFx0Ly9hZGRpbmcgdG8gY2xpZW50XG5cdFx0ICAgIFx0XHRcdFx0bm9kZS5hbmNlc3RvcnMucHVzaChcImNsaWVudFwiKTtcblx0XHQgICAgXHRcdFx0XHR0aGlzRGF0YVNvdXJjZS5hbmNlc3RvcnNfc3RydWN0W25vZGUuaWRdID0gW1wiY2xpZW50XCJdO1xuXHRcdCAgICBcdFx0XHRcdGlmIChhZGRlZENsaWVudCA9PT0gZmFsc2UpIHtcblx0XHQgICAgXHRcdFx0XHRcdGFkZGVkQ2xpZW50ID0gdHJ1ZTtcblx0XHRcdCAgICBcdFx0XHRcdHRoaXNEYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbC5wdXNoKFwiY2xpZW50XCIpO1xuXHRcdCAgICBcdFx0XHRcdFx0dGhpc0RhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0WydjbGllbnQnXSA9IFtdO1xuXHRcdCAgICBcdFx0XHRcdH1cblx0XHQgICAgXHRcdFx0XHR0aGlzRGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbJ2NsaWVudCddLnB1c2gobm9kZS5pZCk7XG5cdFx0XHQgICAgXHRcdH1cblx0XHQgICAgXHRcdH1cblx0XHQgICAgXHR9KVxuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIFJldHVybnMgdGhlIGZsb3cgYmV0d2VlbiB0aGUgaGlnaGVzdCBsZXZlbCBncm91cGluZ1xuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcmV0dXJuICAgICB7T2JqZWN0fSAgVGhlIHRvcCBsZXZlbCBmbG93LlxuXHRcdCAgICAgKi9cblx0XHQgICAgZ2V0VG9wTGV2ZWxGbG93KCkge1xuXHRcdCAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Rmxvd0JldHdlZW5TZXQodGhpcy5jaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwpO1xuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIEdldHMgdGhlIGZsb3cgYmV0d2VlbiBhbnkgc2V0IG9mIG5vZGUgbGV2ZWxzXG5cdFx0ICAgICAqXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVfbmFtZXMgIFRoZSBub2RlIG5hbWVzIGluIHRoZSBzZXRcblx0XHQgICAgICogQHJldHVybiAgICAge09iamVjdH0gIFRoZSBmbG93IGJldHdlZW4gc2V0LlxuXHRcdCAgICAgKi9cblx0XHQgICAgZ2V0Rmxvd0JldHdlZW5TZXQobm9kZV9uYW1lcykge1xuXHRcdCAgICAgICAgdmFyIGxvY2FsX25vZGVzID0gdGhpcy5ub2Rlcztcblx0XHQgICAgICAgIHZhciBpZE1hcHBpbmcgPSB7fTtcblx0XHQgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbG9jYWxfbm9kZXMubGVuZ3RoOyBpKyspIHtcblx0XHQgICAgICAgICAgICB2YXIgbm9kZSA9IGxvY2FsX25vZGVzW2ldO1xuXG5cdFx0ICAgICAgICAgICAgLy9pZiBub2RlIGlzIGFscmVhZHkgYXQgaXRzIGhpZ2hlc3QgbGV2ZWxcblx0XHQgICAgICAgICAgICBpZiAobm9kZS5hbmNlc3RvcnMgPT09IG51bGwpIHtcblx0XHQgICAgICAgICAgICAgICAgaWRNYXBwaW5nW25vZGUuaWRdID0gbm9kZS5uYW1lO1xuXHRcdCAgICAgICAgICAgIH0gZWxzZSB7XG5cdFx0ICAgICAgICAgICAgICAgIC8vY2hlY2sgdG8gc2VlIHdoaWNoIHRhZ3MgYXJlIHByZXNlbnQgaW4gdGhlIGFuY2VzdG9yIGxpc3Rcblx0XHQgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBub2RlX25hbWVzLmxlbmd0aDsgaisrKSB7XG5cdFx0ICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5hbmNlc3RvcnMuaW5kZXhPZihub2RlX25hbWVzW2pdKSA+IC0xKSB7XG5cdFx0ICAgICAgICAgICAgICAgICAgICAgICAgaWRNYXBwaW5nW25vZGUuaWRdID0gbm9kZV9uYW1lc1tqXTtcblx0XHQgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblx0XHQgICAgICAgICAgICAgICAgICAgIH1cblx0XHQgICAgICAgICAgICAgICAgfVxuXHRcdCAgICAgICAgICAgIH1cblx0XHQgICAgICAgIH0gICBcblx0XHQgICAgICAgIC8vbW9kaWZ5IGxpbmtzXG5cdFx0ICAgICAgICB2YXIgbGlua3MgPSB0aGlzLmxpbmtzO1xuXHRcdCAgICAgICAgdmFyIGxpbmtEYXRhID0gW107XG5cdFx0ICAgICAgICBcblx0XHQgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGlua3MubGVuZ3RoOyBpKyspIHtcblx0XHQgICAgICAgICAgICB2YXIgbGluayA9IFtdO1xuXHRcdCAgICAgICAgICAgIGxpbmsuc291cmNlID0gaWRNYXBwaW5nW2xpbmtzW2ldLnNvdXJjZV0gfHwgbGlua3NbaV0uc291cmNlO1xuXHRcdCAgICAgICAgICAgIGxpbmsudGFyZ2V0ID0gaWRNYXBwaW5nW2xpbmtzW2ldLnRhcmdldF0gfHwgbGlua3NbaV0udGFyZ2V0O1xuXHRcdCAgICAgICAgICAgIGxpbmsud2VpZ2h0ID0gbGlua3NbaV0ud2VpZ2h0O1xuXHRcdCAgICAgICAgICAgIGxpbmtEYXRhLnB1c2gobGluayk7XG5cdFx0ICAgICAgICB9XG5cblx0XHQgICAgICAgIC8vY3JlYXRpbmcgdGhlIG5vZGVEYXRhXG5cdFx0ICAgICAgICB2YXIgbm9kZURhdGEgPSBbXTtcblx0XHQgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZV9uYW1lcy5sZW5ndGg7IGkrKykge1xuXHRcdCAgICAgICAgICAgIHZhciBub2RlX3RvX2FkZCA9IFtdO1xuXHRcdCAgICAgICAgICAgIG5vZGVfdG9fYWRkLmlkID0gbm9kZV9uYW1lc1tpXTtcblx0XHQgICAgICAgICAgICBub2RlX3RvX2FkZC50ZXh0ID0gdGhpcy5ub2RlSWRUb05hbWUobm9kZV9uYW1lc1tpXSkgfHwgbm9kZV9uYW1lc1tpXTtcblxuXG5cdFx0ICAgICAgICAgICAgbm9kZV90b19hZGQuYW5jZXN0b3JzID0gdGhpcy5hbmNlc3RvcnNfc3RydWN0W25vZGVfbmFtZXNbaV1dIHx8IHRoaXMuYW5jZXN0b3JzX3N0cnVjdFtub2RlX3RvX2FkZC50ZXh0XSB8fCBbXTtcblx0XHQgICAgICAgICAgICBpZiAoXy5pc0VtcHR5KG5vZGVfdG9fYWRkLmFuY2VzdG9ycykgPT09IGZhbHNlKSB7XG5cdFx0ICAgICAgICAgICAgICAgIG5vZGVfdG9fYWRkLnBhcmVudCA9IG5vZGVfdG9fYWRkLmFuY2VzdG9yc1swXTtcblx0XHQgICAgICAgICAgICB9IGVsc2Uge1xuXHRcdCAgICAgICAgICAgICAgICBub2RlX3RvX2FkZC5wYXJlbnQgPSBudWxsO1xuXHRcdCAgICAgICAgICAgIH1cblx0XHQgICAgICAgICAgICBub2RlRGF0YS5wdXNoKG5vZGVfdG9fYWRkKTtcblx0XHQgICAgICAgIH1cblxuXHRcdCAgICAgICAgcmV0dXJuIHtub2RlRGF0YTpub2RlRGF0YSwgbGlua0RhdGE6bGlua0RhdGF9O1xuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIHByb2Nlc3MgdGhlIG5vZGVEYXRhIG91dHB1dCBvZiBnZXRGbG93QmV0d2VlblNldFxuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlRGF0YSAgTm9kZURhdGEgdG8gY29udmVydCBcblx0XHQgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIG5vZGUgb2JqZWN0c1xuXHRcdCAgICAgKiBAcmV0dXJuICAgICB7QXJyYXl9ICBOb2RlIG9iamVjdHNcblx0XHQgICAgICovXG5cdFx0ICAgIHByb2Nlc3NOb2RlRGF0YShub2RlRGF0YSkge1xuXHRcdCAgICAgICAgdmFyIG5vZGVzID0gW107XG5cdFx0ICAgICAgICBfLmZvckVhY2gobm9kZURhdGEsIGZ1bmN0aW9uKGRhdGEpIHtcblx0XHQgICAgICAgICAgICB2YXIgbmV3Tm9kZSA9IG5ldyBWaXN1YWxpemVyTm9kZS5Ob2RlKG51bGwsIG51bGwsIGRhdGEuaWQsIGRhdGEudGV4dCxcblx0XHQgICAgICAgICAgICAgICAgbnVsbCwgZGF0YS5wYXJlbnQsIGRhdGEuYW5jZXN0b3JzLCBudWxsLCBudWxsKTtcblx0XHQgICAgICAgICAgICBub2Rlcy5wdXNoKG5ld05vZGUpO1xuXHRcdCAgICAgICAgfSk7XG5cdFx0ICAgICAgICByZXR1cm4gbm9kZXM7XG5cdFx0ICAgIH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogcHJvY2VzcyB0aGUgbGlua0RhdGEgb3V0cHV0IG9mIGdldEZsb3dCZXR3ZWVuU2V0XG5cdFx0ICAgICAqXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIGxpbmtEYXRhICBUaGUgbGluayBkYXRhXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVzICAgICBUaGUgbm9kZXNcblx0XHQgICAgICogQHJldHVybiAgICAge0FycmF5fSAgTGluayBvYmplY3RzXG5cdFx0ICAgICAqL1xuXHRcdCAgICBwcm9jZXNzTGlua0RhdGEobGlua0RhdGEsIG5vZGVzKSB7XG5cdFx0ICAgIFx0LyoqXG5cdFx0XHQgICAgICogUmV0dXJucyB0aGUgbm9kZSB0aGF0IG1hdGNoZXMgdGhlIGlkXG5cdFx0XHQgICAgICpcblx0XHRcdCAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG5cdFx0XHQgICAgICogQHJldHVybiAgICAge05vZGV9ICAgVGhlIG5vZGUgd2l0aCB0aGUgbWF0Y2hpbmcgaWRcblx0XHRcdCAgICAgKi9cblx0XHRcdCAgICBmdW5jdGlvbiBmaW5kTm9kZUJ5SWQoaWQsIG5vZGVzKSB7XG5cdFx0XHQgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdCAgICAgICAgICAgIGlmIChpZCA9PSBub2Rlc1tpXS5pZCkge1xuXHRcdFx0ICAgICAgICAgICAgICAgIHJldHVybiBub2Rlc1tpXTtcblx0XHRcdCAgICAgICAgICAgIH1cblx0XHRcdCAgICAgICAgfVxuXHRcdFx0ICAgIH1cblxuXHRcdCAgICAgICAgdmFyIGxpbmtzID0gW107XG5cdFx0ICAgICAgICAvL2EgbWFwcGluZyBmcm9tIHNvdXJjZS5pZC10YXJnZXQuaWQgdG8gdGhlIGxpbmsgYWRkZWRcblx0XHQgICAgICAgIHZhciBhZGRlZF9saW5rcyA9IHt9O1xuXHRcdCAgICAgICAgLy90cmFuc2Zvcm1pbmcgbGluayBkYXRhXG5cdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpbmtEYXRhLmxlbmd0aDsgaSsrKSB7XG5cdFx0ICAgICAgICAgICAgaWYgKGxpbmtEYXRhW2ldLnNvdXJjZSAhPSBsaW5rRGF0YVtpXS50YXJnZXQpIHtcblx0XHQgICAgICAgICAgICAgICAgdmFyIHNvdXJjZSA9IGZpbmROb2RlQnlJZChsaW5rRGF0YVtpXS5zb3VyY2UsIG5vZGVzKTtcblx0XHQgICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IGZpbmROb2RlQnlJZChsaW5rRGF0YVtpXS50YXJnZXQsIG5vZGVzKTtcblx0XHQgICAgICAgICAgICAgICAgdmFyIHdlaWdodCA9IGxpbmtEYXRhW2ldLndlaWdodDtcblx0XHQgICAgICAgICAgICAgICAgLy9pbiBvcmRlciB0byBzdW0gYWxsIHRoZSB3ZWlnaHRzIG9mIHRoZSBsaW5rcyBvZiB0aGUgc3ViLW5vZGVzLFxuXHRcdCAgICAgICAgICAgICAgICAvL3dlIHVzZSBhZGRlZF9saW5rcyB0byBrZWVwIHRyYWNrIGlmIGFuIGxpbmsgd2FzIGFkZGVkXG5cdFx0ICAgICAgICAgICAgICAgIC8vaWYgaXQgaXMsIHdlIG1vZGlmeSBpdHMgd2VpZ2h0XG5cdFx0ICAgICAgICAgICAgICAgIGlmIChzb3VyY2UgPT0gbnVsbCB8fCB0YXJnZXQgPT0gbnVsbCkge1xuXHRcdCAgICAgICAgICAgICAgICBcdGNvbnRpbnVlO1xuXHRcdCAgICAgICAgICAgICAgICB9XG5cdFx0ICAgICAgICAgICAgICAgIGlmIChhZGRlZF9saW5rc1tzb3VyY2UuaWQgKyAnLScgKyB0YXJnZXQuaWRdID09PSB1bmRlZmluZWQpIHtcblx0XHQgICAgICAgICAgICAgICAgICAgIHZhciBsaW5rID0gbmV3IFZpc3VhbGl6ZXJMaW5rLkxpbmsoc291cmNlLCB0YXJnZXQsIHdlaWdodCk7XG5cdFx0ICAgICAgICAgICAgICAgICAgICBhZGRlZF9saW5rc1tzb3VyY2UuaWQgKyAnLScgKyB0YXJnZXQuaWRdID0gbGluaztcblx0XHQgICAgICAgICAgICAgICAgICAgIGxpbmtzLnB1c2gobGluayk7XG5cdFx0ICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdFx0ICAgICAgICAgICAgICAgICAgICB2YXIgZXhpc3RpbmdfbGluayA9IGFkZGVkX2xpbmtzW3NvdXJjZS5pZCArICctJyArIHRhcmdldC5pZF07XG5cdFx0ICAgICAgICAgICAgICAgICAgICBleGlzdGluZ19saW5rLnNldFdlaWdodChleGlzdGluZ19saW5rLmdldFJhd1dlaWdodCgpICsgd2VpZ2h0KTtcblx0XHQgICAgICAgICAgICAgICAgICAgIGV4aXN0aW5nX2xpbmsuaW5jcmVhc2VDb3VudCgpO1xuXHRcdCAgICAgICAgICAgICAgICB9XG5cdFx0ICAgICAgICAgICAgfSAgXG5cdFx0ICAgICAgICB9XG5cdFx0ICAgICAgICByZXR1cm4gbGlua3M7XG5cdFx0ICAgIH1cblx0XHR9XG5cdFx0cmV0dXJuIHtcblx0XHRcdERhdGFTb3VyY2U6IFZpc3VhbGl6ZXJEYXRhU291cmNlXG5cdFx0fVxufV0pO1xuXG5cblxuXG5cblxuIiwiLyoqXG4gKiBUaGUgYmFzZSBjbGFzcyB0aGUgZ3JhcGggb2JqZWN0LiBBbnkgbm9kZXMgb3IgbGlua3MgdGhhdCBhcmUgY29udGFpbmVkIGluXG4gKiBpdHMgbm9kZXMgb3IgbGlua3MgcHJvcGVydHkgd2lsbCBiZSBkcmF3biBvbiB1cGRhdGVHcmFwaC5cbiAqIFN1cHBvcnRzIHBvbGljaWVzLlxuICogXG4gKiBUbyB3cml0ZSB5b3VyIG93biBncmFwaCBvYmplY3QsIGNyZWF0ZSBhIG5ldyBmYWN0b3J5IHRoYXQgdXNlcyB0aGUgZ3JhcGhcbiAqIHlvdSB3YW50IHRvIGluaGVyaXQgYXMgYSBkZXBlbmRlbmN5LCBhbmQgZXh0ZW5kIGl0cyBncmFwaCBjbGFzcy4gXG4gKiBSZXR1cm4gdGhlIGNsYXNzIG9iamVjdCB3aXRoIEdyYXBoIGFzIGtleS5cbiAqIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnR3JhcGgnLCBbJ1BvbGljeVNlcnZpY2UnLCBmdW5jdGlvbiAoUG9saWN5U2VydmljZSkge1xuICAgICAgICBjbGFzcyBHcmFwaCB7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIGNvbnN0cnVjdG9yIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBTVkd9ICBzdmcgICAgIFRoZSBzdmcgdGhhdCB3aWxsIFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob2xkIHRoZSBncmFwaFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZXMgICAgICBMaXN0IG9mIG5vZGVzIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIGxpbmtzICAgICAgTGlzdCBvZiBsaW5rcyBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHN2Zywgbm9kZXMsIGxpbmtzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMgPSBub2RlcyB8fCBbXTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MgPSBsaW5rcyB8fCBbXTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzID0gW107XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMgPSBbXTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3kgPSBuZXcgUG9saWN5U2VydmljZS5Qb2xpY3koKTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgY2FuWm9vbTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgY2FuUGFuOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpbml0Rm9yY2U6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlVXBkYXRlOiBmYWxzZVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY29uc3RzID0ge1xuICAgICAgICAgICAgICAgICAgICBjaXJjbGVHQ2xhc3M6IFwiY29uY2VwdEdcIixcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGhDbGFzczogXCJncmFwaFwiLFxuICAgICAgICAgICAgICAgICAgICBwYXRoQ2xhc3M6IFwicGF0aFwiLFxuICAgICAgICAgICAgICAgICAgICBub2RlQ2xhc3M6IFwiY2lyY2xlXCIsXG4gICAgICAgICAgICAgICAgICAgIG5vZGVUZXh0OiBcIm5vZGVUZXh0XCIsXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0UmFkaXVzOiA1MCxcbiAgICAgICAgICAgICAgICAgICAgbWF4UmFkaXVzOiA2MCxcbiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogNSxcbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheU9mZnNldDogNjBcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgc3ZnLm9uKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcIm1vdXNlb3ZlclwiXS5jYWxsKHRoaXMsIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiZGJsY2xpY2tcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcImRibGNsaWNrXCJdLmNhbGwodGhpcywgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJjb250ZXh0bWVudVwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wiY29udGV4dG1lbnVcIl0uY2FsbCh0aGlzLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcIm1vdXNlb3V0XCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcIm1vdXNlb3V0XCJdLmNhbGwodGhpcywgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wibW91c2Vkb3duXCJdLmNhbGwodGhpcywgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZXVwXCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcIm1vdXNldXBcIl0uY2FsbCh0aGlzLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8gZGVmaW5lIGFycm93IG1hcmtlcnMgZm9yIGdyYXBoIGxpbmtzXG4gICAgICAgICAgICAgICAgdmFyIGRlZnMgPSBzdmcuYXBwZW5kKCdzdmc6ZGVmcycpO1xuICAgICAgICAgICAgICAgIGRlZnMuYXBwZW5kKCdzdmc6bWFya2VyJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2lkJywgJ2VuZC1hcnJvdycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwidmlld0JveFwiLCBcIjAgLTUgMTAgMTBcIilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJyZWZYXCIsIDIwKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcInJlZllcIiwgLTEpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwibWFya2VyV2lkdGhcIiwgNilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJtYXJrZXJIZWlnaHRcIiwgNilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJvcmllbnRcIiwgXCJhdXRvXCIpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJwYXRoXCIpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiZFwiLCBcIk0wLC01TDEwLDBMMCw1XCIpO1xuXG4gICAgICAgICAgICAgICAgLy8gZGVmaW5lIGFycm93IG1hcmtlcnMgZm9yIGxlYWRpbmcgYXJyb3dcbiAgICAgICAgICAgICAgICBkZWZzLmFwcGVuZCgnc3ZnOm1hcmtlcicpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdpZCcsICdtYXJrLWVuZC1hcnJvdycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd2aWV3Qm94JywgJzAgLTUgMTAgMTAnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigncmVmWCcsIDcpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdtYXJrZXJXaWR0aCcsIDMuNSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ21hcmtlckhlaWdodCcsIDMuNSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ29yaWVudCcsICdhdXRvJylcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgnc3ZnOnBhdGgnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignZCcsICdNMCwtNUwxMCwwTDAsNScpO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2ZyA9IHN2ZztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnRyA9IHN2Zy5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAgICAgICAgIC5jbGFzc2VkKHRoaXNHcmFwaC5jb25zdHMuZ3JhcGhDbGFzcywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z0cgPSB0aGlzR3JhcGguc3ZnRztcblxuICAgICAgICAgICAgICAgIC8vIHN2ZyBub2RlcyBhbmQgbGlua3MgXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzID0gc3ZnRy5hcHBlbmQoXCJnXCIpLnNlbGVjdEFsbChcImdcIik7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMgPSBzdmdHLmFwcGVuZChcImdcIikuc2VsZWN0QWxsKFwiZ1wiKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXRMaW5rcygpO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNldFBvc2l0aW9ucygpO1xuICAgICAgICAgICAgICAgIHZhciByZXNpemVGdW5jID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5vbldpbmRvd1Jlc2l6ZShzdmcpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguYmluZGluZ3MgPSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc2l6ZTpyZXNpemVGdW5jXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAkKHdpbmRvdykucmVzaXplKHJlc2l6ZUZ1bmMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIGNhbGxzIHRoZSBkZXN0cm95IG1ldGhvZCBmb3IgYWxsIHBvbGljaWVzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5LmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5LmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gdGhpc0dyYXBoLmJpbmRpbmdzKSB7XG4gICAgICAgICAgICAgICAgICAgICQod2luZG93KS5vZmYoa2V5LCB0aGlzR3JhcGguYmluZGluZ3Nba2V5XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJ1bnMgdGhlIGluaXQgZnVuY3Rpb24gZm9yIGFsbCB0aGUgbm9kZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5pdE5vZGVzKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUnVucyB0aGUgaW5pdCBmdW5jdGlvbiBmb3IgYWxsIHRoZSBsaW5rc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbml0TGlua3MoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5saW5rcywgZnVuY3Rpb24obGluaykge1xuICAgICAgICAgICAgICAgICAgICBsaW5rLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiByZXR1cm5zIHRoZSBub2RlIG1hdGNoaW5nIHRoZSBpZCwgXG4gICAgICAgICAgICAgKiBvciB1bmRlZmluZWQgaWYgdGhlcmUgaXMgbm9uZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7Tm9kZX0gIHsgbWF0Y2hpbmcgbm9kZSB9XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZpbmROb2RlQnlJZChpZCl7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSB0aGlzR3JhcGgubm9kZXNbaV0uaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzR3JhcGgubm9kZXNbaV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJldHVybnMgdGhlIGQzTm9kZSBvYmplY3QgdGhhdCBtYXRjaGVzIHRoZSBpZCxcbiAgICAgICAgICAgICAqIG9yIHVuZGVmaW5lZCBpZiB0aGVyZSBpcyBub25lXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGlkICAgICAgVGhlIGlkZW50aWZpZXJcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtEM05vZGV9IFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZpbmREM05vZGUoaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgZDNOb2RlO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2goZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5pZCA9PT0gaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQzTm9kZSA9IGQzLnNlbGVjdCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkM05vZGU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byBpbnN0YWxsIGEgZHJhZyBwb2xpY3kgdGhhdCB3aWxsIGJlIGNhbGxlZFxuICAgICAgICAgICAgICogd2hlbiBub2RlcyBhcmUgZHJhZ2dlZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkMy5iZWhhdmlvci5kcmFnfSAgZDNkcmFnICBEMyBkcmFnIG9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbnN0YWxsRHJhZ1BvbGljeShkM2RyYWcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRyYWcgPSBkM2RyYWc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byBpbnN0YWxsIGEgcG9saWN5IHRoYXQgd2lsbCBiZSBjYWxsZWQgXG4gICAgICAgICAgICAgKiB3aGVuIHRoZXJlIGlzIG1vdXNlIGludGVyYWN0aW9ucyB3aXRoIHRoZSBncmFwaCdzIHN2Z1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3kgIFRoZSBwb2xpY3kgdG8gaW5zdGFsbFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbnN0YWxsU3ZnUG9saWN5KHBvbGljeSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3ZnUG9saWN5ID0gcG9saWN5O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVzZWQgdG8gaW5zdGFsbCBwb2xpY2llcyB0aGF0IGFyZSBjYWxsZWQgd2hlbiB0aGVyZSBpc1xuICAgICAgICAgICAgICogbW91c2UgaW50ZXJhY3Rpb24gd2l0aCBhIG5vZGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UG9saWN5fSAgcG9saWN5ICBUaGUgcG9saWN5IHRvIGluc3RhbGxcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5zdGFsbERlZmF1bHROb2RlUG9saWN5KHBvbGljeSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzLnB1c2gocG9saWN5KTtcbiAgICAgICAgICAgICAgICBwb2xpY3kuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byByZW1vdmUgYW4gaW5zdGFsbGVkIHBvbGljeSBmb3Igbm9kZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHBvbGljeVJlbW92ZSAgVGhlIHBvbGljeSB0byByZW1vdmVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdW5pbnN0YWxsRGVmYXVsdE5vZGVQb2xpY3kocG9saWN5UmVtb3ZlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBvbGljeVJlbW92ZU5hbWU7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBwb2xpY3lSZW1vdmUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZS5wb2xpY3lOYW1lO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvbGljeS5wb2xpY3lOYW1lID09PSBwb2xpY3lSZW1vdmVOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2xpY3kuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJldHVybnMgdGhlIG5vZGUgcG9saWN5IG9iamVjdCB3aXRoIHRoZSBnaXZlbiBuYW1lXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHBvbGljeU5hbWUgIFRoZSBwb2xpY3kgbmFtZVxuICAgICAgICAgICAgICogQHJldHVybiAgICAge1BvbGljeX0gIHBvbGljeSAgICAgIFRoZSBtYXRjaGluZyBwb2xpY3lcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZ2V0Tm9kZVBvbGljeShwb2xpY3lOYW1lKSB7XG4gICAgICAgICAgICBcdHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3ksIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb2xpY3kucG9saWN5TmFtZSA9PT0gcG9saWN5TmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBvbGljeTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVzZWQgdG8gaW5zdGFsbCBwb2xpY2llcyB0aGF0IGFyZSBjYWxsZWQgd2hlbiB0aGVyZSBpcyBhXG4gICAgICAgICAgICAgKiBtb3VzZSBpbnRlcmFjdGlvbiB3aXRoIGEgcGF0aFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3kgIFRoZSBwb2xpY3kgdG8gaW5zdGFsbFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3kocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMucHVzaChwb2xpY3kpO1xuICAgICAgICAgICAgICAgIHBvbGljeS5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byByZW1vdmUgYW4gaW5zdGFsbGVkIHBvbGljeSBmb3IgbGlua3NcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UG9saWN5fSAgcG9saWN5UmVtb3ZlICBUaGUgcG9saWN5IHRvIHJlbW92ZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1bmluc3RhbGxEZWZhdWx0UGF0aFBvbGljeShwb2xpY3lSZW1vdmUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcG9saWN5UmVtb3ZlTmFtZTtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHBvbGljeVJlbW92ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlLnBvbGljeU5hbWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5LCBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9saWN5LnBvbGljeU5hbWUgPT09IHBvbGljeVJlbW92ZU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlcmUgaXMgYSBtb3VzZSBpbnRlcmFjdGlvbiB3aXRoIGEgcGF0aFxuICAgICAgICAgICAgICogUHJvcG9nYXRlcyB0aGUgZXZlbnQgdG8gYWxsIGluc3RhbGxlZCBwYXRoIHBvbGljaWVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGV2ZW50ICAgVGhlIGV2ZW50IHR5cGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM29iamVjdH0gIGQzcGF0aCAgVGhlIGQzIHBhdGhcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQYXRofSAgZCAgICAgICBUaGUgbWF0Y2hpbmcgTGluayBvYmplY3RcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgcGF0aFBvbGljeUV2ZW50KGV2ZW50LCBkM3BhdGgsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lbZXZlbnRdKGQzcGF0aCwgZCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGVyZSBpcyBhIG1vdXNlIGludGVyYWN0aW9uIHdpdGggYSBub2RlXG4gICAgICAgICAgICAgKiBQcm9wb2dhdGVzIHRoZSBldmVudCB0byBhbGwgaW5zdGFsbGVkIG5vZGUgcG9saWNpZXNcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGV2ZW50ICAgVGhlIGV2ZW50IHR5cGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM29iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQYXRofSAgZCAgICAgICBUaGUgbWF0Y2hpbmcgTm9kZSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgbm9kZVBvbGljeUV2ZW50KGV2ZW50LCBkM25vZGUsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMsIGZ1bmN0aW9uKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lbZXZlbnRdKGQzbm9kZSwgZCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTZXRzIHBhbiBhbmQgem9vbSBydWxlcyBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzLmJlaGF2aW9yLnpvb219ICBkM3pvb20gIEQzIHpvb20gb2JqXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluc3RhbGxab29tUG9saWN5KGQzem9vbSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZHJhZ1N2ZyA9IGQzem9vbTtcbiAgICAgICAgICAgICAgICB0aGlzLnN2Zy5jYWxsKHRoaXMuZHJhZ1N2Zyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIHdpbmRvdyBpcyByZXNpemVkXG4gICAgICAgICAgICAgKiBIb29rIGZvciBvdmVycmlkaW5nIGluIHN1YmNsYXNzZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBTVkd9ICBzdmcgICAgIFRoZSBzdmcgdGhhdCB0aGUgaGFuZGxlclxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpcyBhdHRhY2hlZCB0b1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBvbldpbmRvd1Jlc2l6ZShzdmcpIHt9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogSW5zZXJ0cyBsaW5lIGJyZWFrcyBpbiBub2RlIHRleHRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBFbGVtfSAgZ0VsICAgIFRoZSBlbGVtIHRvIGFkZCB0ZXh0IHRvXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgdGl0bGUgICBUaGUgdGl0bGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5zZXJ0VGl0bGVMaW5lYnJlYWtzIChnRWwsIHRpdGxlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHdvcmRzID0gdGl0bGUuc3BsaXQoL1xccysvZyksXG4gICAgICAgICAgICAgICAgICAgIG53b3JkcyA9IHdvcmRzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB2YXIgZWwgPSBnRWwuYXBwZW5kKFwidGV4dFwiKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCB0aGlzR3JhcGguY29uc3RzLm5vZGVUZXh0KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcInRleHQtYW5jaG9yXCIsXCJtaWRkbGVcIilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJkeVwiLCBcIi1cIiArIChud29yZHMtMSkqNy41KTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgd29yZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRzcGFuID0gZWwuYXBwZW5kKCd0c3BhbicpLnRleHQod29yZHNbaV0pO1xuICAgICAgICAgICAgICAgIGlmIChpID4gMClcbiAgICAgICAgICAgICAgICAgICAgdHNwYW4uYXR0cigneCcsIDApLmF0dHIoJ2R5JywgJzE1Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJlbW92ZXMgYWxsIGxpbmtzIGZyb20gdGhlIGdpdmVuIG5vZGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc3BsaWNlTGlua3NGb3JOb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgdG9TcGxpY2UgPSB0aGlzR3JhcGgubGlua3MuZmlsdGVyKGZ1bmN0aW9uKGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobC5zb3VyY2UgPT09IG5vZGUgfHwgbC50YXJnZXQgPT09IG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0b1NwbGljZS5tYXAoZnVuY3Rpb24obCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3Muc3BsaWNlKHRoaXNHcmFwaC5saW5rcy5pbmRleE9mKGwpLCAxKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBBZGRzIHRoZSBub2RlIHRvIHRoZSBncmFwaCBhbmQgdXBkYXRlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBhZGROb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICBub2RlLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyB0aGUgbm9kZSB0byB0aGUgZ3JhcGggYW5kIHVwZGF0ZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgcmVtb3ZlTm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnNwbGljZSh0aGlzR3JhcGgubm9kZXMuaW5kZXhPZihub2RlKSwgMSk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlKTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBBZGRzIHRoZSBsaW5rIHRvIHRoZSBncmFwaCBhbmQgdXBkYXRlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtsaW5rfSAgbGluayAgICBUaGUgbGlua1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBhZGRMaW5rKGxpbmspIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MucHVzaChsaW5rKTtcbiAgICAgICAgICAgICAgICBsaW5rLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyB0aGUgbGluayB0byB0aGUgZ3JhcGggYW5kIHVwZGF0ZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bGlua30gIGxpbmsgICAgVGhlIGxpbmtcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgcmVtb3ZlTGluayhsaW5rKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzLnNwbGljZSh0aGlzR3JhcGgubGlua3MuaW5kZXhPZihsaW5rKSwgMSk7XG4gICAgICAgICAgICAgICAgbGluay5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIHVwZGF0aW5nIGV4aXN0aW5nIHBhdGhzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BhdGh9ICBwYXRocyAgIExpc3Qgb2YgcGF0aHNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlRXhpc3RpbmdQYXRocyhwYXRocykge1xuICAgICAgICAgICAgICAgIHBhdGhzLmVhY2goZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICBkLnVwZGF0ZUF0dHIoZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgYWRkaW5nIG5ldyBwYXRoc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQYXRofSAgbmV3UGF0aHMgIExpc3Qgb2YgbmV3IHBhdGhzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHVwZGF0ZU5ld1BhdGhzKG5ld1BhdGhzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdExpbmtzKCk7XG5cbiAgICAgICAgICAgICAgICBuZXdQYXRocy5lYWNoKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5uZXdQYXRoQXR0cihkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy9pZiBub2RlIGRvZXNuJ3QgaGF2ZSBpdHMgb3duIHBvbGljeSwgdXNlIGRlZmF1bHQgZm9yIHRoZSBncmFwaFxuICAgICAgICAgICAgICAgIG5ld1BhdGhzLm9uKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZW92ZXJcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZW92ZXJcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcImRibGNsaWNrXCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQucGF0aFBvbGljeUV2ZW50KFwiZGJsY2xpY2tcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJkYmxjbGlja1wiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiY29udGV4dG1lbnVcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJjb250ZXh0bWVudVwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcImNvbnRleHRtZW51XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZW91dFwiLCBmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQucGF0aFBvbGljeUV2ZW50KFwibW91c2VvdXRcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZW91dFwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwibW91c2Vkb3duXCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZWRvd25cIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZWRvd25cIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcIm1vdXNldXBcIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnBhdGhQb2xpY3lFdmVudChcIm1vdXNldXBcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZXVwXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuY2FsbCh0aGlzR3JhcGguZHJhZyk7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgdXBkYXRpbmcgZXhpc3Rpbmcgbm9kZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlRXhpc3RpbmdOb2RlcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcyA9IHRoaXMuY2lyY2xlcy5kYXRhKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24oZCl7IHJldHVybiBkLmlkO30pXG4gICAgICAgICAgICAgICAgICAgIC5lYWNoKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQudXBkYXRlQXR0cihkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyBhZGRpbmcgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBuZXdOb2RlcyAgTGlzdCBvZiBuZXcgbm9kZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlTmV3Tm9kZXMobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgICAgIG5ld05vZGVzLmVhY2goZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5ncmFwaCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBkLm5ld05vZGVBdHRyKGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvL2lmIG5vZGUgZG9lc24ndCBoYXZlIGl0cyBvd24gcG9saWN5LCB1c2UgZGVmYXVsdCBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgICAgbmV3Tm9kZXMub24oXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlb3ZlclwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlb3ZlclwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiZGJsY2xpY2tcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5ub2RlUG9saWN5RXZlbnQoXCJkYmxjbGlja1wiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcImRibGNsaWNrXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJjb250ZXh0bWVudVwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcImNvbnRleHRtZW51XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwiY29udGV4dG1lbnVcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcIm1vdXNlb3V0XCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5ub2RlUG9saWN5RXZlbnQoXCJtb3VzZW91dFwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlb3V0XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlZG93blwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlZG93blwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwibW91c2V1cFwiLCBmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQubm9kZVBvbGljeUV2ZW50KFwibW91c2V1cFwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcIm1vdXNldXBcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5jYWxsKHRoaXNHcmFwaC5kcmFnKTtcblxuICAgICAgICAgICAgICAgIG5ld05vZGVzLmFwcGVuZChcImNpcmNsZVwiKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwiclwiLCBmdW5jdGlvbihkKSB7cmV0dXJuIFN0cmluZyhkLnJhZGl1cyl9KTtcblxuXG4gICAgICAgICAgICAgICAgbmV3Tm9kZXMuZWFjaChmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluc2VydFRpdGxlTGluZWJyZWFrcyhkMy5zZWxlY3QodGhpcyksIGQudGV4dCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUHJldmVudHMgbm9kZXMgZnJvbSBjb2xsaWRpbmdcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgYWxwaGEgICBBZmZlY3RzIGhvdyBtdWNoIGNoYW5nZVxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlIGNvbGxpc2lvbiBjYXVzZXNcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtib29sZWFufSAge1doZXRoZXIgbm9kZXMgYXJlIGNvbGxpZGVkfVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkM0ZvcmNlQ29sbGlkZShhbHBoYSkge1xuICAgICAgICAgICAgXHR2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgIFx0XHRjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzO1xuICAgICAgICAgICAgXHR2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICBcdHZhciBxdWFkdHJlZSA9IGQzLmdlb20ucXVhZHRyZWUobm9kZXMpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgciA9IGQucmFkaXVzICsgY29uc3RzLm1heFJhZGl1cyArIGNvbnN0cy5wYWRkaW5nLFxuICAgICAgICAgICAgICAgICAgICAgICAgbngxID0gZC54IC0gcixcbiAgICAgICAgICAgICAgICAgICAgICAgIG54MiA9IGQueCArIHIsXG4gICAgICAgICAgICAgICAgICAgICAgICBueTEgPSBkLnkgLSByLFxuICAgICAgICAgICAgICAgICAgICAgICAgbnkyID0gZC55ICsgcjtcbiAgICAgICAgICAgICAgICAgICAgcXVhZHRyZWUudmlzaXQoZnVuY3Rpb24ocXVhZCwgeDEsIHkxLCB4MiwgeTIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChxdWFkLnBvaW50ICYmIChxdWFkLnBvaW50ICE9PSBkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4ID0gZC54IC0gcXVhZC5wb2ludC54LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ID0gZC55IC0gcXVhZC5wb2ludC55LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsID0gTWF0aC5zcXJ0KHggKiB4ICsgeSAqIHkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByID0gZC5yYWRpdXMgKyBxdWFkLnBvaW50LnJhZGl1cyArIGNvbnN0cy5wYWRkaW5nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsIDwgcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbCA9IChsIC0gcikgLyBsICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnggLT0geCAqPSBsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55IC09IHkgKj0gbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1YWQucG9pbnQueCArPSB4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVhZC5wb2ludC55ICs9IHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB4MSA+IG54MiB8fCB4MiA8IG54MSB8fCB5MSA+IG55MiB8fCB5MiA8IG55MTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUaWNrIG9mIHRoZSBkMyBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzdGljayBldmVudH0gIGUgICAgRDN0aWNrIGV2ZW50XG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgd2lkdGggIFRoZSB3aWR0aCBvZiB0aGUgc2ltdWxhdGlvblxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge251bWJlcn0gIGhlaWdodCBUaGUgaGVpZ2h0IG9mIHRoZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGQzRm9yY2VUaWNrKGUsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgIFx0dmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICBcdFx0Y29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cztcblxuICAgICAgICAgICAgXHR2YXIgb2Zmc2V0ID0gY29uc3RzLmRpc3BsYXlPZmZzZXQ7XHRcbiAgICAgICAgICAgIFx0dmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgXHR2YXIgcSA9IGQzLmdlb20ucXVhZHRyZWUodGhpc0dyYXBoLm5vZGVzKSxcbiAgICAgICAgICAgICAgICAgICAgICBpID0gMCxcbiAgICAgICAgICAgICAgICAgICAgICBuID0gbm9kZXMubGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgICB3aGlsZSAoKytpIDwgbikge1xuICAgICAgICAgICAgICAgICAgICBxLnZpc2l0KHRoaXMuZDNGb3JjZUNvbGxpZGUobm9kZXNbaV0pKTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2godGhpcy5kM0ZvcmNlQ29sbGlkZSguNSkpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiY3hcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC54ID0gTWF0aC5tYXgoZC5yYWRpdXMgKyBvZmZzZXQsIE1hdGgubWluKHdpZHRoIC0gb2Zmc2V0IC0gZC5yYWRpdXMsIGQueCkpOyB9KVxuICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJjeVwiLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnkgPSBNYXRoLm1heChkLnJhZGl1cyArIG9mZnNldCwgTWF0aC5taW4oaGVpZ2h0IC0gb2Zmc2V0IC0gZC5yYWRpdXMsIGQueSkpOyB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoc1xuICAgICAgICAgICAgICAgICAgICAuYXR0cigneDEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS55OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneDInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC55OyB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTdGFydHMgb24gc3RhcnQgb2YgdGhlIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZVN0YXJ0KCkge1xuICAgICAgICAgICAgXHR2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHNcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueTsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueTsgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIG9uIHRoZSBlbmQgb2YgdGhlIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZUVuZCgpIHtcbiAgICAgICAgICAgIFx0dmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICBcdHRoaXNHcmFwaC5jaXJjbGVzXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjeCcsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2N5JywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC55OyB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocy5hdHRyKCd4MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLnk7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd4MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lnk7IH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGN1bGF0ZXMgdGhlIHdpZHRoIGFuZCBoZWlnaHQgYm91bmRzIGZvciB0aGUgXG4gICAgICAgICAgICAgKiBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHJldHVybiAgICAge09iamVjdH0gIHdpZHRoIGFuZCBoZWlnaHQgYXMgcHJvcGVydGllcyBcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZUJvdW5kcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnV2lkdGggPSAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLndpZHRoKCk7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z0hlaWdodCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykuaGVpZ2h0KCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBzdmdXaWR0aDtcbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gc3ZnSGVpZ2h0O1xuICAgICAgICAgICAgICAgIHJldHVybiB7d2lkdGg6d2lkdGgsIGhlaWdodDpoZWlnaHR9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIERvZXMgYSBkMyBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0Z1bmN0aW9ufSAgY2FsbGJhY2sgIFRoZSBjYWxsYmFja1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzZXRGb3JjZShjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgICAgIHZhciBsaW5rcyA9IHRoaXNHcmFwaC5saW5rcztcbiAgICAgICAgICAgICAgICBpZiAoXy5pc0VtcHR5KG5vZGVzKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGJvdW5kcyA9IHRoaXNHcmFwaC5kM0ZvcmNlQm91bmRzKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgZm9yY2UgPSBkMy5sYXlvdXQuZm9yY2UoKVxuICAgICAgICAgICAgICAgICAgICAuc2l6ZShbYm91bmRzLndpZHRoLCBib3VuZHMuaGVpZ2h0XSlcbiAgICAgICAgICAgICAgICAgICAgLm5vZGVzKG5vZGVzKVxuICAgICAgICAgICAgICAgICAgICAuY2hhcmdlKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtNjAwMDtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmxpbmtzKGxpbmtzKTtcblxuICAgICAgICAgICAgICAgIGZvcmNlLmxpbmtEaXN0YW5jZShib3VuZHMud2lkdGgvMyk7XG4gICAgICAgICAgICAgICAgZm9yY2UubGlua1N0cmVuZ3RoKC4yKTtcbiAgICAgICAgICAgICAgICBmb3JjZS5ncmF2aXR5KC4yKTtcblxuICAgICAgICAgICAgICAgIGZvcmNlLm9uKCd0aWNrJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgIFx0dGhpc0dyYXBoLmQzRm9yY2VUaWNrLmNhbGwodGhpc0dyYXBoLCBcbiAgICAgICAgICAgICAgICBcdFx0XHRlLCBib3VuZHMud2lkdGgsIGJvdW5kcy5oZWlnaHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZm9yY2Uub24oJ3N0YXJ0JywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgXHR0aGlzR3JhcGguZDNGb3JjZVN0YXJ0LmNhbGwodGhpc0dyYXBoKVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZm9yY2Uub24oJ2VuZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIFx0dGhpc0dyYXBoLmQzRm9yY2VFbmQuY2FsbCh0aGlzR3JhcGgpXG4gICAgICAgICAgICAgICAgfSk7IFxuXG5cbiAgICAgICAgICAgICAgICBmb3JjZS5zdGFydCgpO1xuICAgICAgICAgICAgICAgIHZhciBrID0gMDtcbiAgICAgICAgICAgICAgICB3aGlsZSAoKGZvcmNlLmFscGhhKCkgPiAxZS0yKSAmJiAoayA8IDE1MCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yY2UudGljaygpO1xuICAgICAgICAgICAgICAgICAgICBrID0gayArIDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvcmNlLnN0b3AoKTtcblxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjayAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgXHRjYWxsYmFjaygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTZXRzIHRoZSBwb3NpdGlvbnMgdG8gYmUgdGhlIGNlbnRlciBvZiB0aGUgc2NyZWVuIGlmIFxuICAgICAgICAgICAgICogbm90IHByb3ZpZGVkXG4gICAgICAgICAgICAgKiBhbHNvIHNldHMgdGhlIHJhZGl1cyBvZiB0aGUgbm9kZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc2V0UG9zaXRpb25zKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IHRoaXNHcmFwaC5jb25zdHMuZGlzcGxheU9mZnNldDtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnV2lkdGggPSAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLndpZHRoKCk7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z0hlaWdodCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykuaGVpZ2h0KCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBzdmdXaWR0aCAtICgyKm9mZnNldCk7XG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IHN2Z0hlaWdodCAtICgyKm9mZnNldCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVzW2ldLnJhZGl1cyA9IG5vZGVzW2ldLnJhZGl1cyB8fCB0aGlzR3JhcGguY29uc3RzLnN0YXJ0UmFkaXVzO1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZXNbaV0ueCA9PSBudWxsIHx8IG5vZGVzW2ldLnkgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm9kZXNbaV0ueFN0YXJ0ID0gd2lkdGgvMiAgKyBub2Rlc1tpXS5yYWRpdXMgKyBvZmZzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzW2ldLnggPSB3aWR0aC8yICArIG5vZGVzW2ldLnJhZGl1cyArIG9mZnNldDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5vZGVzW2ldLnlTdGFydCA9IGhlaWdodC8yICsgbm9kZXNbaV0ucmFkaXVzICsgb2Zmc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1tpXS55ID0gaGVpZ2h0LzIgKyBub2Rlc1tpXS5yYWRpdXMgKyBvZmZzZXRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgdG8gdXBkYXRlIHRoZSB2aWV3IG9mIHRoZSBncmFwaCB3aGVuXG4gICAgICAgICAgICAgKiBkYXRhIGNoYW5nZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RnVuY3Rpb259ICBjYWxsYmFjayAgVGhlIGNhbGxiYWNrXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHVwZGF0ZUdyYXBoKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlO1xuXG4gICAgICAgICAgICBcdGlmICh0aGlzR3JhcGguc3RhdGUuZGlzYWJsZVVwZGF0ZSkge1xuICAgICAgICAgICAgXHRcdHJldHVybjtcbiAgICAgICAgICAgIFx0fVxuXG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVFeGlzdGluZ05vZGVzKCk7XG4gICAgICAgICAgICAgICAgdmFyIG5ld0dzPSB0aGlzR3JhcGguY2lyY2xlcy5lbnRlcigpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJnXCIpO1xuXG4gICAgICAgICAgICBcdC8vIGNvbnNvbGUubG9nKCd1cGRhdGUnLCBuZXdHcyk7XG4gICAgICAgICAgICAgICAgbmV3R3MuY2xhc3NlZChjb25zdHMuY2lyY2xlR0NsYXNzLCB0cnVlKTtcbiAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIHRoaXMudXBkYXRlTmV3Tm9kZXMobmV3R3MpO1xuXG4gICAgICAgICAgICAgICAgLy8gcmVtb3ZlIG9sZCBub2Rlc1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmV4aXQoKS5yZW1vdmUoKTtcblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5pbml0Rm9yY2UgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNldEZvcmNlKGZ1bmN0aW9uKCkge1xuICAgIFx0ICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVOZXdOb2Rlcy5jYWxsKHRoaXNHcmFwaCwgbmV3R3MpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuaW5pdEZvcmNlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVOZXdOb2RlcyhuZXdHcyk7XG5cdCAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocyA9IHRoaXNHcmFwaC5wYXRocy5kYXRhKHRoaXNHcmFwaC5saW5rcywgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBTdHJpbmcoZC5zb3VyY2UuaWQpICsgXCIrXCIgKyBTdHJpbmcoZC50YXJnZXQuaWQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciBwYXRocyA9IHRoaXNHcmFwaC5wYXRocztcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUV4aXN0aW5nUGF0aHMocGF0aHMpO1xuXG4gICAgICAgICAgICAgICAgdmFyIG5ld3BhdGhzID0gcGF0aHMuZW50ZXIoKVxuICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJwYXRoXCIpXG4gICAgICAgICAgICAgICAgLnN0eWxlKCdtYXJrZXItZW5kJywndXJsKCNlbmQtYXJyb3cpJylcbiAgICAgICAgICAgICAgICAuY2xhc3NlZChcImxpbmtcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVOZXdQYXRocyhuZXdwYXRocyk7XG5cbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgb2xkIGxpbmtzXG4gICAgICAgICAgICAgICAgcGF0aHMuZXhpdCgpLnJlbW92ZSgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBcdGNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgR3JhcGg6IEdyYXBoXG4gICAgICAgIH1cbn1dKTtcblxuXG4iLCIvKipcbiAqIFRoZSBncmFwaCB0aGF0IGlzIHVzZWQgc3BlY2lmaWNhbGx5IGZvciB0aGUgdmlzdWFsaXphdGlvbiB0YWIuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdWaXN1YWxpemVyR3JhcGgnLCBbJ0dyYXBoJywgZnVuY3Rpb24gKEdyYXBoKSB7XG4gICAgXHRjbGFzcyBWaXN1YWxpemVyR3JhcGggZXh0ZW5kcyBHcmFwaC5HcmFwaCB7XG4gICAgXHRcdC8qKlxuICAgIFx0XHQgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgXHRcdCAqXG4gICAgXHRcdCAqIEBwYXJhbSAgIHtIVE1MIFNWR30gIHN2ZyAgICAgICAgICAgICBUaGUgc3ZnIHRoYXQgd2lsbCBcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob2xkIHRoZSBncmFwaFxuICAgICAgICAgICAgICogQHBhcmFtICAge0FycmF5fSAgbm9kZXMgICBcdFx0ICAgIExpc3Qgb2Ygbm9kZXNcbiAgICAgICAgICAgICAqIEBwYXJhbSAgIHtBcnJheX0gIGxpbmtzICAgXHRcdCAgICBMaXN0IG9mIGxpbmtzXG4gICAgXHRcdCAqIEBwYXJhbSAgIHtEYXRhU291cmNlfSAgZGF0YVNvdXJjZSAgICBUaGUgZGF0YSBzb3VyY2VcbiAgICBcdFx0ICovXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcihzdmcsIG5vZGVzLCBsaW5rcywgZGF0YVNvdXJjZSkge1xuICAgICAgICAgICAgICAgIHN1cGVyKHN2Zywgbm9kZXMsIGxpbmtzKTtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgICAgIC8vaG9sZHMgY3VycmVudCB0cmFuc2l0aW9ucyB0aGF0IGFyZSBvY2N1cmluZ1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZS50cmFuc2l0aW9uID0gW107XG4gICAgICAgICAgICAgICAgLy9NaW4gZGlzdGFuY2UgYmV0d2VlbiBub2RlcyB3aGVuIHNwYXduaW5nIHJhbmRvbWx5XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNvbnN0cy5lZGdlX2J1ZmZlciA9IDIwMDtcbiAgICAgICAgICAgICAgICAvL1NpemUgcmVkdWN0aW9uIGFzIHlvdSBnbyB0aHJvdWdoIGxldmVscyBpbiBub2Rlc1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jb25zdHMucmFkaXVzRGVjYXkgPSAxO1xuICAgICAgICAgICAgICAgIC8vQ3NzIGNsYXNzIGZvciBub2RlcyB0aGF0IGFyZSBjb250YWluZXJzXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNvbnN0cy5jb250YWluZXJDbGFzcyA9ICdjb250YWluZXInO1xuXG4gICAgICAgICAgICAgICAgLy9kYXRhU291cmNlIGhvbGRzIHRoZSBzZXJ2ZXIgZGF0YSBhbmQgbWV0aG9kcyBmb3JcbiAgICAgICAgICAgICAgICAvL2NvbnZlcnRpbmcgaXQgdG8gZGF0YSBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRhdGFTb3VyY2UgPSBkYXRhU291cmNlO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vRHJhZyBiZWhhdmlvciBmb3Igbm9kZXNcbiAgICAgICAgICAgICAgICB2YXIgZHJhZyA9IGQzLmJlaGF2aW9yLmRyYWcoKVxuICAgICAgICAgICAgICAgICAgICAub3JpZ2luKGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge3g6IGQueCwgeTogZC55fTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiZHJhZ3N0YXJ0XCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJkcmFnXCIsIGZ1bmN0aW9uKGFyZ3Mpe1xuICAgICAgICAgICAgICAgICAgICBcdGQzLnNlbGVjdCggdGhpcykuYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbiggZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCArPSBkMy5ldmVudC5keDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gZDMuZXZlbnQuZHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwidHJhbnNsYXRlKFwiICsgWyBkLngsZC55IF0gKyBcIilcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcdFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJkcmFnZW5kXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kcmFnID0gZHJhZztcblxuICAgICAgICAgICAgICAgIC8vUGFuIGFuZCBab29tIGJlaGF2aW9yIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAgICB2YXIgem9vbSA9IGQzLmJlaGF2aW9yLnpvb20oKVxuICAgICAgICAgICAgICAgICAgICAub24oXCJ6b29tXCIsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZDMuZXZlbnQuc291cmNlRXZlbnQgIT0gbnVsbCAmJiBkMy5ldmVudC5zb3VyY2VFdmVudC5jdHJsS2V5KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZC5jYWxsKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiem9vbXN0YXJ0XCIsIGZ1bmN0aW9uKGQsIGkpe1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguZHJhZ1N2ZyA9IHpvb207XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Zy5jYWxsKHpvb20pLm9uKFwiZGJsY2xpY2suem9vbVwiLCBudWxsKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2l0aCBubyBhcmdzIHdoZW4gdGhlIGdyYXBoIGhhcyBhIHpvb20gYWN0aW9uXG4gICAgICAgICAgICAgKiBDYW4gYWxzbyBiZSBjYWxsZWQgd2l0aCBhcmdzIHRvIGZvcmNlIGEgem9vbSBvciBwYW4gXG4gICAgICAgICAgICAgKiBldmVudCBmb3IgdGhlIGdyYXBoLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gICB0cmFuc2xhdGUgIFRoZSBhbW91bnQgdG8gdHJhbnNsYXRlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgc2NhbGUgICAgICBUaGUgYW1vdW50IHRvIHNjYWxlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHpvb21lZCh0cmFuc2xhdGUsIHNjYWxlKXtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLnN0YXRlLnJpZ2h0Q2xpY2sgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuanVzdFNjYWxlVHJhbnNHcmFwaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKHRyYW5zbGF0ZSAhPSBudWxsICYmIHNjYWxlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSB0aGlzR3JhcGguZHJhZ1N2ZztcbiAgICAgICAgICAgICAgICAgICAgem9vbS5zY2FsZShzY2FsZSk7XG4gICAgICAgICAgICAgICAgICAgIHpvb20udHJhbnNsYXRlKHRyYW5zbGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIC8vY3JlYXRpbmcgbmFtZXMgdG8gcHJldmVudCB0cmFuc2l0aW9uIGNvbmZsaWN0c1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbVNldENhbGxiYWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIFx0em9vbS5zY2FsZShzY2FsZSk7XG4gICAgICAgICAgICAgICAgICAgIFx0em9vbS50cmFuc2xhdGUodHJhbnNsYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zbGF0ZV9uYW1lID0gXCJ6b29tXCIgKyB0cmFuc2xhdGU7XG4gICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdChcIi5cIiArIHRoaXMuY29uc3RzLmdyYXBoQ2xhc3MpLnRyYW5zaXRpb24odHJhbnNsYXRlX25hbWUpLmRlbGF5KDEwMCkuZHVyYXRpb24oNzUwKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoJyArIHpvb20udHJhbnNsYXRlKCkgKyAnKSBzY2FsZSgnICsgem9vbS5zY2FsZSgpICsgJyknKS5lYWNoKFwiZW5kXCIsIHpvb21TZXRDYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGguc3RhdGUuY2FuWm9vbSkge1xuICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QoXCIuXCIgKyB0aGlzLmNvbnN0cy5ncmFwaENsYXNzKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKSArIFwiKSBzY2FsZShcIiArdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKSArIFwiKVwiKTsgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgd2luZG93IHJlc2l6ZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBTVkd9ICBzdmcgICAgVGhlIHN2ZyB0byByZXNpemVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgb25XaW5kb3dSZXNpemUoc3ZnKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJvZHlFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF07XG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykub2Zmc2V0KCk7XG4gICAgICAgICAgICAgICAgdmFyIGRpdldpZHRoID0gJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS53aWR0aCgpO1xuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBib2R5RWwuY2xpZW50SGVpZ2h0O1xuICAgICAgICAgICAgICAgIHN2Zy5hdHRyKFwid2lkdGhcIiwgZGl2V2lkdGgpLmF0dHIoXCJoZWlnaHRcIiwgaGVpZ2h0IC0gb2Zmc2V0LnRvcCAtIDIwKTtcblxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgc2VydmVyIHNlbmRzIHVwZGF0ZWQgZGF0YSBmb3IgdGhlIGxpbmtzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHVwZGF0ZUxpbmtEYXRhKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBub2RlX25hbWVzX3NldCA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpc0dyYXBoLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVfbmFtZXNfc2V0LnB1c2godGhpc0dyYXBoLm5vZGVzW2ldLmlkKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcmV0RGF0YSA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmdldEZsb3dCZXR3ZWVuU2V0KG5vZGVfbmFtZXNfc2V0KTtcbiAgICAgICAgICAgICAgICB2YXIgbGlua0RhdGEgPSByZXREYXRhLmxpbmtEYXRhO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YShsaW5rRGF0YSwgdGhpc0dyYXBoLm5vZGVzKTtcbiAgICAgICAgICAgICAgICB0aGlzLmluaXROb2RlcygpO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5pdExpbmtzKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIFxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIEdyYXBoOiBWaXN1YWxpemVyR3JhcGhcbiAgICAgICAgfVxufV0pO1xuXG5cblxuIiwiLyoqXG4gKiBUaGUgYmFzZSBjbGFzcyBmb3IgbGluayBvYmplY3RzIGZvciB0aGUgZ3JhcGguXG4gKiBTdXBwb3J0cyBwb2xpY2llcy5cbiAqIFxuICogVG8gd3JpdGUgeW91ciBvd24gbGluayBvYmplY3QsIGNyZWF0ZSBhIG5ldyBmYWN0b3J5IHRoYXQgdXNlcyB0aGUgbGlua1xuICogeW91IHdhbnQgdG8gaW5oZXJpdCBhcyBhIGRlcGVuZGVuY3ksIGFuZCBleHRlbmQgaXRzIGxpbmsgY2xhc3MuIFxuICogUmV0dXJuIHRoZSBjbGFzcyBvYmplY3Qgd2l0aCBMaW5rIGFzIGtleVxuICogXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdMaW5rJywgW2Z1bmN0aW9uICgpIHtcbiAgICBcdGNsYXNzIExpbmsge1xuICAgIFx0XHQvKipcbiAgICBcdFx0ICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgIFx0XHQgKlxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHNvdXJjZU5vZGUgIFRoZSBzb3VyY2Ugbm9kZVxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHRhcmdldE5vZGUgIFRoZSB0YXJnZXQgbm9kZVxuICAgIFx0XHQgKi9cblx0XHRcdGNvbnN0cnVjdG9yKHNvdXJjZU5vZGUsIHRhcmdldE5vZGUpIHtcblx0XHRcdFx0dGhpcy5zb3VyY2UgPSBzb3VyY2VOb2RlO1xuXHRcdFx0XHR0aGlzLnRhcmdldCA9IHRhcmdldE5vZGU7XG5cdFx0XHRcdHRoaXMuaGFzUG9saWN5ID0gZmFsc2U7XG5cdFx0XHRcdHRoaXMucGF0aFBvbGljaWVzID0gW107XG5cdFx0XHRcdHRoaXMuZ3JhcGggPSBudWxsO1xuXHRcdFx0XHR0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsbGVkIHdoZW4gYSBsaW5rIGlzIGFkZGVkIHRvIHRoZSBncmFwaFxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoIGl0IGlzIGFkZGVkIHRvXG5cdFx0XHQgKi9cblx0XHRcdGluaXRpYWxpemUoZ3JhcGgpIHtcblx0XHRcdFx0aWYgKHRoaXMuaW5pdGlhbGl6ZWQgPT0gZmFsc2UpIHtcblx0XHRcdFx0XHR0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcblx0XHRcdFx0XHR0aGlzLmdyYXBoID0gZ3JhcGg7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxsZWQgZHVyaW5nIHRoZSB1cGRhdGUgZ3JhcGggZm9yIGV4aXN0aW5nIGxpbmtzXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuXHRcdFx0ICogQHBhcmFtICAgICAge0xpbmt9ICBcdCAgIGQgICAgICAgTWF0Y2hpbmcgTGluayBPYmplY3QgICAgICAgXG5cdFx0XHQgKi9cblx0XHRcdHVwZGF0ZUF0dHIoZDNwYXRoLCBkKSB7XG5cdFx0XHRcdGQzcGF0aC5zdHlsZSgnbWFya2VyLWVuZCcsICd1cmwoI2VuZC1hcnJvdyknKVxuXHRcdCAgICAgICAgICAgIC5hdHRyKFwiZFwiLCBhcnJvd1BhdGgpO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCBkdXJpbmcgdGhlIGZpcnN0IHVwZGF0ZSBncmFwaCBmb3IgYSBsaW5rXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuXHRcdFx0ICogQHBhcmFtICAgICAge0xpbmt9ICBcdCAgIGQgICAgICAgTWF0Y2hpbmcgTGluayBPYmplY3QgICAgICAgXG5cdFx0XHQgKi9cblx0XHRcdG5ld1BhdGhBdHRyKGQzcGF0aCwgZCkge1xuXHRcdFx0XHRkM3BhdGguYXR0cignZCcsIGFycm93UGF0aCk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsY3VsYXRlcyB0aGUgYXJyb3cgcGF0aFxuXHRcdFx0ICpcblx0XHRcdCAqIEByZXR1cm4gICAgIHtzdHJpbmd9ICBUaGUgcGF0aCB0byBkcmF3XG5cdFx0XHQgKi9cblx0XHQgICAgYXJyb3dQYXRoKCkge1xuXHRcdCAgICBcdHZhciBkID0gdGhpcztcblx0XHQgICAgICAgIHZhciBkeCA9IGQudGFyZ2V0LnggLSBkLnNvdXJjZS54LFxuXHRcdCAgICAgICAgICAgIGR5ID0gZC50YXJnZXQueSAtIGQuc291cmNlLnksXG5cdFx0ICAgICAgICAgICAgZHIgPSBNYXRoLnNxcnQoZHggKiBkeCArIGR5ICogZHkpO1xuXHRcdCAgICAgICAgcmV0dXJuIFwiTVwiICsgZC5zb3VyY2UueCArIFwiLFwiICsgZC5zb3VyY2UueSArIFwiQVwiICsgZHIgKyBcIixcIiArIGRyICsgXCIgMCAwLDEgXCIgKyBkLnRhcmdldC54ICsgXCIsXCIgKyBkLnRhcmdldC55O1xuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIFVzZWQgdG8gaW5zdGFsbCBwb2xpY2llcyB0aGF0IGFyZSBjYWxsZWQgd2hlbiB0aGlzXG5cdFx0ICAgICAqIGxpbmsgaGFzIGEgbW91c2UgZXZlbnRcblx0XHQgICAgICpcblx0XHQgICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeSAgVGhlIHBvbGljeSB0byBpbnN0YWxsXG5cdFx0ICAgICAqL1xuXHRcdFx0aW5zdGFsbFBhdGhQb2xpY3kocG9saWN5KSB7XG5cdFx0XHRcdHRoaXMuaGFzUG9saWN5ID0gdHJ1ZTtcblx0XHRcdFx0dGhpcy5wYXRoUG9saWNpZXMucHVzaChwb2xpY3kpO1xuXHRcdFx0XHRwb2xpY3kuaW5pdGlhbGl6ZSh0aGlzLmdyYXBoKTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBVc2VkIHRvIHVuaW5zdGFsbCBwb2xpY3kgZm9yIHRoaXMgbGlua1xuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3lSZW1vdmUgIFRoZSBwb2xpY3kgdG8gcmVtb3ZlXG5cdFx0XHQgKi9cblx0XHRcdHVuaW5zdGFsbFBhdGhQb2xpY3kocG9saWN5UmVtb3ZlKSB7XG5cdFx0XHRcdHZhciBwb2xpY3lSZW1vdmVOYW1lO1xuXHRcdFx0XHR2YXIgdGhpc1BhdGggPSB0aGlzO1xuXHRcdFx0XHRpZiAodHlwZW9mIHBvbGljeVJlbW92ZSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHRwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmUucG9saWN5TmFtZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRfKHRoaXNQYXRoLnBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3ksIGluZGV4KSB7XG5cdFx0XHRcdFx0aWYgKHBvbGljeS5wb2xpY3lOYW1lID09PSBwb2xpY3lSZW1vdmVOYW1lKSB7XG5cdFx0XHRcdFx0XHRwb2xpY3kuZGVzdHJveSgpO1xuXHRcdFx0XHRcdFx0dGhpc1BhdGgucGF0aFBvbGljaWVzLnNwbGljZShpbmRleCwgMSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdFx0aWYgKHRoaXNQYXRoLnBhdGhQb2xpY2llcy5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0XHR0aGlzUGF0aC5oYXNQb2xpY3kgPSBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCB3aGVuIHRoZXJlIGlzIGEgbW91c2UgZXZlbnQgZm9yIHRoaXMgcGF0aFxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBldmVudCAgICAgVGhlIG1vdXNlIGV2ZW50XG5cdFx0XHQgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM3BhdGggIFRoZSBkMyBwYXRoXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgZCAgICAgICAgIFRoZSBtYXRjaGluZyBsaW5rIG9iamVjdFxuXHRcdFx0ICovXG5cdFx0XHRwYXRoUG9saWN5RXZlbnQoZXZlbnQsIGQzcGF0aCwgZCkge1xuXHRcdFx0XHRfKGQucGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSkge1xuXHRcdFx0XHRcdHBvbGljeVtldmVudF0oZDNwYXRoLCBkKTtcblx0XHRcdFx0fSlcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHtcblx0XHRcdExpbms6IExpbmtcblx0XHR9XG59XSk7XG5cblxuXG5cblxuXG4iLCIvKipcbiAqIFRoZSBsaW5rIHRoYXQgaXMgdXNlZCBzcGVjaWZpY2FsbHkgZm9yIHRoZSB2aXN1YWxpemF0aW9uIHRhYi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ1Zpc3VhbGl6ZXJMaW5rJywgWydMaW5rJywgZnVuY3Rpb24gKExpbmspIHtcblx0XHRjbGFzcyBWaXN1YWxpemVyTGluayBleHRlbmRzIExpbmsuTGluayB7XG5cdFx0XHQvKipcblx0XHRcdCAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHNvdXJjZU5vZGUgIFRoZSBzb3VyY2Ugbm9kZVxuXHRcdFx0ICogQHBhcmFtICAgICAge05vZGV9ICB0YXJnZXROb2RlICBUaGUgdGFyZ2V0IG5vZGVcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB3ZWlnaHQgICAgVGhlIHdlaWdodCBvZiB0aGUgbGlua1xuXHRcdFx0ICovXG5cdFx0ICAgIGNvbnN0cnVjdG9yKHNvdXJjZU5vZGUsIHRhcmdldE5vZGUsIHdlaWdodCkge1xuXHRcdCAgICAgICAgc3VwZXIoc291cmNlTm9kZSwgdGFyZ2V0Tm9kZSk7XG5cdFx0ICAgICAgICB0aGlzLndlaWdodCA9IHdlaWdodDtcblx0XHQgICAgICAgIC8vQ291bnQgaXMgdXNlZCB0byBrZWVwIHRyYWNrIG9mIGhvdyBtYW55XG5cdFx0ICAgICAgICAvL3BhdGhzIHRvIGl0cyBzdWJub2RlcyB0aGVyZSBhcmVcblx0XHQgICAgICAgIC8vaW4gb3JkZXIgdG8gY2FsY3VsYXRlIGF2ZXJhZ2UgdHJhZmZpY1xuXHRcdCAgICAgICAgdGhpcy5jb3VudCA9IDE7XG5cdFx0ICAgIH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogSW5jcmVhc2VzIHRoZSBjb3VudCBvZiB0aGUgbGlua1xuXHRcdCAgICAgKiBVU2VkIHRvIGtlZXAgdHJhY2sgb2YgaG93IG1hbnkgcGF0aHMgdG8gaXRzIHN1Ym5vZGVzXG5cdFx0ICAgICAqIHRoZXJlIGFyZSBpbiBvcmRlciB0byBjYWxjdWxhdGUgYXZlcmFnZSB0cmFmZmljXG5cdFx0ICAgICAqL1xuXHRcdCAgICBpbmNyZWFzZUNvdW50KCkge1xuXHRcdCAgICAgICAgdGhpcy5jb3VudCArPSAxO1xuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIENhbGN1bGF0ZXMgd2hlcmUgdG8gcGxhY2UgcXRpcCBmb3Jcblx0XHQgICAgICpcblx0XHQgICAgICogQHJldHVybiAgICAge09iamVjdH0gIE9iamVjdCB3aXRoIHFUaXAgc2V0dGluZ3Ncblx0XHQgICAgICovXG5cdFx0ICAgIHF0aXBIZWxwZXIoKSB7XG5cdFx0ICAgIFx0dmFyIHJldDtcblx0XHQgICAgXHR2YXIgZCA9IHRoaXM7XG5cdFx0ICAgIFx0dmFyIGR4ID0gKGQudGFyZ2V0LnggLSBkLnNvdXJjZS54KSAvIDIsXG5cdFx0ICAgICAgICAgICAgZHkgPSAoZC50YXJnZXQueSAtIGQuc291cmNlLnkpIC8gMjtcblx0XHQgICAgXHRpZiAoZC5zb3VyY2UueCA8IGQudGFyZ2V0LngpIHtcblx0ICAgIFx0XHRcdHJldCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG15OiAndG9wIGNlbnRlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICBhdDogJ2NlbnRlciBjZW50ZXInLCAvLyBhdCB0aGUgYm90dG9tIHJpZ2h0IG9mLi4uXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IFtkeCwgZHldLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWRqdXN0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcdHk6IDEwXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblx0XHQgICAgXHR9IGVsc2Uge1xuXHQgICAgXHRcdFx0cmV0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbXk6ICdib3R0b20gY2VudGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0OiAnY2VudGVyIGNlbnRlcicsIC8vIGF0IHRoZSBib3R0b20gcmlnaHQgb2YuLi5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogW2R4LCBkeV0sXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGp1c3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFx0eTogLTEwXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblx0XHQgICAgXHR9XG5cdFx0ICAgIFx0cmV0dXJuIHJldDtcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdFx0ICogQ2FsbGVkIHdoZW4gYSBsaW5rIGlzIGFkZGVkIHRvIHRoZSBncmFwaFxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoIGl0IGlzIGFkZGVkIHRvXG5cdFx0XHQgKi9cblx0XHRcdGluaXRpYWxpemUoZ3JhcGgpIHtcblx0XHRcdFx0aWYgKHRoaXMuaW5pdGlhbGl6ZWQgPT0gZmFsc2UpIHtcblx0XHRcdFx0XHRzdXBlci5pbml0aWFsaXplKGdyYXBoKTtcblx0XHRcdFx0XHR2YXIgc3RhdGUgPSBncmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluaztcblx0XHRcdFx0XHRpZiAoc3RhdGUgPT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0c3RhdGUgPSBncmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluayA9IHt9O1xuXHRcdFx0XHRcdFx0c3RhdGUubWF4V2VpZ2h0ID0gbnVsbDtcblx0XHRcdFx0XHRcdHN0YXRlLnVzZUF2Z1dlaWdodCA9IHRydWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHRoaXMudXBkYXRlTWF4V2VpZ2h0KCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBTZXRzIHdoZXRoZXIgdGhlIGdyYXBoIHNob3VsZCB1c2UgYXZnIHdlaWdodFxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtib29sZWFufSAgdmFsICAgICBUaGUgdmFsdWUgdG8gc2V0IHRvXG5cdFx0XHQgKi9cblx0XHRcdHNldFVzZUF2Z1dlaWdodCh2YWwpIHtcblx0XHQgICAgICAgIHRoaXMuZ3JhcGguc3RhdGUuVmlzdWFsaXplckxpbmsudXNlQXZnV2VpZ2h0ID0gISF2YWw7XG5cdFx0ICAgIH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogU2V0cyB0aGUgd2VpZ2h0IG9mIHRoaXMgbGlua1xuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgd2VpZ2h0ICBUaGUgd2VpZ2h0IHRvIHNldCB0b1xuXHRcdCAgICAgKi9cblx0XHQgICAgc2V0V2VpZ2h0KHdlaWdodCkge1xuXHRcdCAgICAgICAgdGhpcy53ZWlnaHQgPSB3ZWlnaHQ7XG5cdFx0ICAgIH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogR2V0cyB0aGUgcmF3IHdlaWdodC5cblx0XHQgICAgICpcblx0XHQgICAgICogQHJldHVybiAgICAge251bWJlcn0gIFRoZSByYXcgd2VpZ2h0LlxuXHRcdCAgICAgKi9cblx0XHQgICAgZ2V0UmF3V2VpZ2h0KCkge1xuXHRcdCAgICAgICAgcmV0dXJuIHRoaXMud2VpZ2h0OyBcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBHZXRzIHRoZSB3ZWlnaHQgdmFsdWUgb2YgdGhlIGxpbmssIGRlcGVuZGluZyBvbiB0aGVcblx0XHQgICAgICogdXNlQXZnV2VpZ3RoIHNldHRpbmdcblx0XHQgICAgICpcblx0XHQgICAgICogQHJldHVybiAgICAge251bWJlcn0gIFRoZSB3ZWlnaHQuXG5cdFx0ICAgICAqL1xuXHRcdCAgICBnZXRXZWlnaHQoKSB7XG5cdFx0ICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcblx0XHQgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluaztcblxuXHRcdCAgICAgICAgaWYgKHN0YXRlLnVzZUF2Z1dlaWdodCkge1xuXHRcdCAgICAgICAgICAgIHZhciB3ZWlnaHQgPSB0aGlzLndlaWdodCAvIHRoaXMuY291bnQ7XG5cdFx0ICAgICAgICAgICAgcmV0dXJuIHdlaWdodDtcblx0XHQgICAgICAgIH1cblx0XHQgICAgICAgIHJldHVybiB0aGlzLndlaWdodDtcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBVcGRhdGVzIHRoZSBtYXggd2VpZ2h0IG9mIHRoZSBncmFwaFxuXHRcdCAgICAgKi9cblx0XHQgICAgdXBkYXRlTWF4V2VpZ2h0ICgpIHtcblx0XHQgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuXHRcdCAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXG5cdFx0ICAgICAgICB2YXIgbWF4TGluayA9IF8ubWF4QnkodGhpc0dyYXBoLmxpbmtzLCBmdW5jdGlvbihsKSB7XG5cdFx0ICAgICAgICBcdGlmIChsLmdyYXBoICE9IG51bGwpIHtcblx0XHRcdFx0XHRcdHJldHVybiBsLmdldFdlaWdodCgpO1xuXHRcdCAgICAgICAgXHR9XG5cdFx0ICAgICAgICBcdHJldHVybiAwO1xuXHRcdCAgICAgICAgfSk7XG5cdFx0ICAgICAgICBzdGF0ZS5tYXhXZWlnaHQgPSBtYXhMaW5rLmdldFdlaWdodCgpO1xuXHRcdCAgICB9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsbGVkIGR1cmluZyB0aGUgdXBkYXRlIGdyYXBoIGZvciBleGlzdGluZyBsaW5rc1xuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzcGF0aCAgVGhlIGQzIHBhdGhcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtMaW5rfSAgXHQgICBkICAgICAgIE1hdGNoaW5nIExpbmsgT2JqZWN0ICAgICAgIFxuXHRcdFx0ICovXG5cdFx0XHR1cGRhdGVBdHRyKGQzcGF0aCwgZCkge1xuXHRcdCAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG5cdFx0ICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuVmlzdWFsaXplckxpbms7XG5cdFx0ICAgICAgICB0aGlzLnVwZGF0ZU1heFdlaWdodCgpO1xuXHQgICAgICAgICAgICB2YXIgY29sb3JTY2FsZSA9IGQzLnNjYWxlLmxpbmVhcigpXG5cdCAgICAgICAgICAgICAgICAuZG9tYWluKFswLCBzdGF0ZS5tYXhXZWlnaHRdKVxuXHQgICAgICAgICAgICAgICAgLnJhbmdlKFtcIiNmZmIzNjZcIiwgXCIjRjkyNjA2XCJdKTtcblx0ICAgICAgICAgICAgc3RhdGUuY29sb3JTY2FsZSA9IGNvbG9yU2NhbGU7XG5cdFx0XHRcdGQzcGF0aC5zdHlsZSgnbWFya2VyLWVuZCcsICd1cmwoI2VuZC1hcnJvdyknKVxuXHRcdCAgICAgICAgICAgIC5jbGFzc2VkKHRoaXNHcmFwaC5jb25zdHMuc2VsZWN0ZWRDbGFzcywgZnVuY3Rpb24oZCl7XG5cdFx0ICAgICAgICAgICAgICAgIHJldHVybiBkID09PSBzdGF0ZS5zZWxlY3RlZEVkZ2U7XG5cdFx0ICAgICAgICAgICAgfSlcblx0XHQgICAgICAgICAgICAuYXR0cihcImRcIiwgdGhpcy5hcnJvd1BhdGguY2FsbChkKSlcblx0XHQgICAgICAgICAgICAudHJhbnNpdGlvbihcImV4aXN0aW5nUGF0aFRyYW5zaXRpb25cIilcblx0XHQgICAgICAgICAgICAuZHVyYXRpb24oNzUwKVxuXHRcdCAgICAgICAgICAgIC5hdHRyKFwic3Ryb2tlXCIsIGZ1bmN0aW9uKGQpe1xuXHRcdCAgICAgICAgICAgICAgICB2YXIgYyA9IGNvbG9yU2NhbGUoZC5nZXRXZWlnaHQoKSk7XG5cdFx0ICAgICAgICAgICAgICAgIHJldHVybiBjO1xuXHRcdCAgICAgICAgICAgIH0pO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCBkdXJpbmcgdGhlIGZpcnN0IHVwZGF0ZSBncmFwaCBmb3IgdGhpcyBsaW5rXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuXHRcdFx0ICogQHBhcmFtICAgICAge0xpbmt9ICBcdCAgIGQgICAgICAgTWF0Y2hpbmcgTGluayBPYmplY3Rcblx0XHRcdCAqL1xuXHRcdFx0bmV3UGF0aEF0dHIoZDNwYXRoLCBkKSB7XG5cdFx0ICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcblx0XHQgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluaztcblx0ICAgICAgICAgICAgdGhpcy51cGRhdGVNYXhXZWlnaHQoKTtcblx0ICAgICAgICAgICAgdmFyIGNvbG9yU2NhbGUgPSBkMy5zY2FsZS5saW5lYXIoKVxuXHQgICAgICAgICAgICAgICAgLmRvbWFpbihbMCwgc3RhdGUubWF4V2VpZ2h0XSlcblx0ICAgICAgICAgICAgICAgIC5yYW5nZShbXCIjZmZiMzY2XCIsIFwiI0Y5MjYwNlwiXSk7XG5cdCAgICAgICAgICAgICAgICBcblx0XHRcdFx0ZDNwYXRoLnRyYW5zaXRpb24oXCJuZXdQYXRoVHJhbnNpdGlvblwiKVxuXHRcdCAgICAgICAgICAgIC5kdXJhdGlvbig3NTApXG5cdFx0ICAgICAgICAgICAgLmF0dHJUd2VlbihcIm9wYWNpdHlcIiwgZnVuY3Rpb24oZCkge1xuXHRcdCAgICAgICAgICAgICAgICByZXR1cm4gZDMuaW50ZXJwb2xhdGVTdHJpbmcoMCwxKTtcblx0XHQgICAgICAgICAgICB9KVxuXHRcdCAgICAgICAgICAgIC5hdHRyKFwic3Ryb2tlXCIsIGZ1bmN0aW9uKGQpe1xuXHRcdCAgICAgICAgICAgICAgICB2YXIgYyA9IGNvbG9yU2NhbGUoZC5nZXRXZWlnaHQoKSk7XG5cdFx0ICAgICAgICAgICAgICAgIHJldHVybiBjO1xuXHRcdCAgICAgICAgICAgIH0pXG5cdFx0ICAgICAgICAgICAgLmF0dHIoJ2QnLCB0aGlzLmFycm93UGF0aC5jYWxsKGQpKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0TGluayA6IFZpc3VhbGl6ZXJMaW5rXG5cdFx0fVxufV0pO1xuXG5cblxuXG5cbiIsIi8qKlxuICogVGhlIGJhc2UgY2xhc3MgZm9yIG5vZGUgb2JqZWN0cyBmb3IgdGhlIGdyYXBoLlxuICogU3VwcG9ydHMgcG9saWNpZXMuXG4gKiBcbiAqIFRvIHdyaXRlIHlvdXIgb3duIE5vZGUgb2JqZWN0LCBjcmVhdGUgYSBuZXcgZmFjdG9yeSB0aGF0IHVzZXMgdGhlIG5vZGVcbiAqIHlvdSB3YW50IHRvIGluaGVyaXQgYXMgYSBkZXBlbmRlbmN5LCBhbmQgZXh0ZW5kIGl0cyBub2RlIGNsYXNzLiBcbiAqIFJldHVybiB0aGUgY2xhc3Mgb2JqZWN0IHdpdGggTm9kZSBhcyBrZXlcbiAqIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnTm9kZScsIFtmdW5jdGlvbiAoKSB7XG5cdFx0Y2xhc3MgTm9kZSB7XG5cdFx0XHQvKipcblx0XHRcdCAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeCAgICAgICB4IGxvY2F0aW9uXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeSAgICAgICB5IGxvY2F0aW9uXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgaWQgICAgICBUaGUgaWRlbnRpZmllclxuXHRcdFx0ICogQHBhcmFtICAgICAge3N0cmluZ30gIHRleHQgICAgVGhlIHRleHQgdG8gZGlzcGxheVxuXHRcdFx0ICogQHBhcmFtICAgICAge251bWJlcn0gIHJhZGl1cyAgVGhlIHJhZGl1cyBvZiB0aGUgbm9kZVxuXHRcdFx0ICovXG5cdFx0XHRjb25zdHJ1Y3Rvcih4LCB5LCBpZCwgdGV4dCwgcmFkaXVzKSB7XG5cdFx0XHRcdHRoaXMueCA9IHg7XG5cdFx0XHRcdHRoaXMueSA9IHk7XG5cdFx0XHRcdHRoaXMucmFkaXVzID0gcmFkaXVzO1xuXHRcdFx0XHR0aGlzLmlkID0gaWQ7XG5cdFx0XHRcdHRoaXMudGV4dCA9IHRleHQ7XG5cdFx0XHRcdHRoaXMucmFkaXVzID0gcmFkaXVzO1xuXHRcdFx0XHR0aGlzLmhhc1BvbGljeSA9IGZhbHNlO1xuXHRcdFx0XHR0aGlzLnBvbGljeSA9IG51bGw7XG5cdFx0XHRcdHRoaXMubm9kZVBvbGljaWVzID0gW107XG5cdFx0XHRcdHRoaXMuZ3JhcGggPSBudWxsO1xuXHRcdFx0XHR0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsbGVkIHdoZW4gYSBub2RlIGlzIGFkZGVkIHRvIHRoZSBncmFwaFxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoIGl0IGlzIGFkZGVkIHRvXG5cdFx0XHQgKi9cblx0XHRcdGluaXRpYWxpemUoZ3JhcGgpIHtcblx0XHRcdFx0aWYgKHRoaXMuaW5pdGlhbGl6ZWQgPT0gZmFsc2UpIHtcblx0XHRcdFx0XHR0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcblx0XHRcdFx0XHR0aGlzLmdyYXBoID0gZ3JhcGg7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxsZWQgZHVyaW5nIHRoZSB1cGRhdGUgZ3JhcGggZm9yIGV4aXN0aW5nIGxpbmtzXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuXHRcdFx0ICovXG5cdFx0XHR1cGRhdGVBdHRyKGQzbm9kZSwgZCkge1xuXHRcdFx0XHRkM25vZGUuYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbihkKXtyZXR1cm4gXCJ0cmFuc2xhdGUoXCIgKyBkLnggKyBcIixcIiArIGQueSArIFwiKVwiO30pO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCBkdXJpbmcgdGhlIGZpcnN0IHVwZGF0ZSBncmFwaCBmb3IgYSBub2RlXG5cdFx0XHQgKiBIb29rIGZvciBzdWIgY2xhc3Nlc1xuXHRcdFx0ICogXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7Tm9kZX0gICAgICBkICAgICAgIE1hdGNoaW5nIE5vZGUgT2JqZWN0XG5cdFx0XHQgKi9cblx0XHRcdG5ld05vZGVBdHRyKGQzbm9kZSwgZCkge1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFNldHMgdGhlIHJhZGl1cyBvZiB0aGUgbm9kZS5cblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgcmFkaXVzICBUaGUgcmFkaXVzXG5cdFx0XHQgKi9cblx0XHRcdHNldFJhZGl1cyhyYWRpdXMpIHtcblx0XHRcdFx0dGhpcy5yYWRpdXMgPSByYWRpdXM7XG5cdFx0XHR9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIFVzZWQgdG8gaW5zdGFsbCBwb2xpY2llcyB0aGF0IGFyZSBjYWxsZWQgd2hlbiB0aGlzXG5cdFx0ICAgICAqIG5vZGUgaGFzIGEgbW91c2UgZXZlbnRcblx0XHQgICAgICpcblx0XHQgICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeSAgVGhlIHBvbGljeSB0byBpbnN0YWxsXG5cdFx0ICAgICAqL1xuXHRcdFx0aW5zdGFsbE5vZGVQb2xpY3kocG9saWN5KSB7XG5cdFx0XHRcdHRoaXMuaGFzUG9saWN5ID0gdHJ1ZTtcblx0XHRcdFx0dGhpcy5ub2RlUG9saWNpZXMucHVzaChwb2xpY3kpO1xuXHRcdFx0XHRwb2xpY3kuaW5pdGlhbGl6ZSh0aGlzLmdyYXBoKTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBVc2VkIHRvIHVuaW5zdGFsbCBwb2xpY3kgZm9yIHRoaXMgbm9kZVxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtQb2xpY3l8c3RyaW5nfSAgcG9saWN5UmVtb3ZlICBUaGUgcG9saWN5IHRvIHJlbW92ZVxuXHRcdFx0ICovXHRcdFx0XG5cdFx0XHR1bmluc3RhbGxOb2RlUG9saWN5KHBvbGljeVJlbW92ZSkge1xuXHRcdFx0XHR2YXIgcG9saWN5UmVtb3ZlTmFtZTtcblx0XHRcdFx0dmFyIHRoaXNOb2RlID0gdGhpcztcblx0XHRcdFx0aWYgKHR5cGVvZiBwb2xpY3lSZW1vdmUgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0cG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlLnBvbGljeU5hbWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0Xyh0aGlzTm9kZS5ub2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5LCBpbmRleCkge1xuXHRcdFx0XHRcdGlmIChwb2xpY3kucG9saWN5TmFtZSA9PT0gcG9saWN5UmVtb3ZlTmFtZSkge1xuXHRcdFx0XHRcdFx0cG9saWN5LmRlc3Ryb3koKTtcblx0XHRcdFx0XHRcdHRoaXNOb2RlLm5vZGVQb2xpY2llcy5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHRcdGlmICh0aGlzTm9kZS5ub2RlUG9saWNpZXMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdFx0dGhpc05vZGUuaGFzUG9saWN5ID0gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxsZWQgd2hlbiB0aGVyZSBpcyBhIG1vdXNlIGV2ZW50IGZvciB0aGlzIG5vZGVcblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgZXZlbnQgICAgIFRoZSBtb3VzZSBldmVudFxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuXHRcdFx0ICogQHBhcmFtICAgICAge09iamVjdH0gIGQgICAgICAgICBUaGUgbWF0Y2hpbmcgbm9kZSBvYmplY3Rcblx0XHRcdCAqL1xuXHRcdFx0bm9kZVBvbGljeUV2ZW50KGV2ZW50LCBkM25vZGUsIGQpIHtcblx0XHRcdFx0Xy5mb3JFYWNoKHRoaXMubm9kZVBvbGljaWVzLCBmdW5jdGlvbihwb2xpY3kpIHtcblx0XHRcdFx0XHRwb2xpY3lbZXZlbnRdKGQzbm9kZSwgZCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4ge1xuXHRcdFx0Tm9kZTogTm9kZVxuXHRcdH1cbn1dKTtcblxuXG5cblxuXG5cblxuIiwiLyoqXG4gKiBUaGUgbm9kZSB0aGF0IGlzIHVzZWQgc3BlY2lmaWNhbGx5IGZvciB0aGUgdmlzdWFsaXphdGlvbiB0YWIuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdWaXN1YWxpemVyTm9kZScsIFsnTm9kZScsIGZ1bmN0aW9uIChOb2RlKSB7XG5cdFx0Y2xhc3MgVmlzdWFsaXplck5vZGUgZXh0ZW5kcyBOb2RlLk5vZGUge1xuXHRcdFx0LyoqXG5cdFx0XHQgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge251bWJlcn0gIHggICAgICAgXHR4IGxvY2F0aW9uXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeSAgICAgICBcdHkgbG9jYXRpb25cblx0XHRcdCAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBpZCAgICAgIFx0VGhlIGlkZW50aWZpZXJcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICB0ZXh0ICAgIFx0VGhlIHRleHQgdG8gZGlzcGxheVxuXHRcdFx0ICogQHBhcmFtICAgICAge251bWJlcn0gIHJhZGl1cyAgXHRUaGUgcmFkaXVzIG9mIHRoZSBub2RlXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgcGFyZW50ICAgICBUaGUgcGFyZW50IGlkXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgYW5jZXN0b3JzICBBcnJheSBvZiBhbmNlc3RvcnMgSWRcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB4U3RhcnQgICAgIHggbG9jIHRvIHN0YXJ0IGFuaW1hdGlvblxuXHRcdFx0ICogQHBhcmFtICAgICAge251bWJlcn0gIHlTdGFydCAgICAgeSBsb2MgdG8gc3RhcnQgYW5pbWF0aW9uXG5cdFx0XHQgKi9cblx0XHQgICAgY29uc3RydWN0b3IoeCwgeSwgaWQsIHRleHQsIHJhZGl1cywgcGFyZW50LCBhbmNlc3RvcnMsIFxuXHRcdCAgICBcdHhTdGFydCwgeVN0YXJ0KSB7XG5cdFx0ICAgICAgICBzdXBlcih4LCB5LCBpZCwgdGV4dCwgcmFkaXVzKTtcblx0XHQgICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuXHRcdCAgICAgICAgdGhpcy5hbmNlc3RvcnMgPSBhbmNlc3RvcnM7XG5cdFx0ICAgICAgICBpZiAoeFN0YXJ0ID09IG51bGwpIHtcblx0XHQgICAgICAgIFx0dGhpcy54U3RhcnQgPSB4O1xuXHRcdCAgICAgICAgfSBlbHNlIHtcblx0XHQgICAgICAgIFx0dGhpcy54U3RhcnQgPSB4U3RhcnQ7XG5cdFx0ICAgICAgICB9XG5cdFx0ICAgICAgICBpZiAoeVN0YXJ0ID09IG51bGwpIHtcblx0XHQgICAgICAgIFx0dGhpcy55U3RhcnQgPSB5O1xuXHRcdCAgICAgICAgfSBlbHNlIHtcblx0XHQgICAgICAgIFx0dGhpcy55U3RhcnQgPSB5U3RhcnQ7XG5cdFx0ICAgICAgICB9XG5cdFx0ICAgIH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxsZWQgZHVyaW5nIHRoZSBmaXJzdCB1cGRhdGUgZ3JhcGggZm9yIGEgbm9kZVxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICBkICAgICAgICAgVGhlIG1hdGNoaW5nIE5vZGVcblx0XHRcdCAqL1xuXHRcdFx0bmV3Tm9kZUF0dHIoZDNub2RlLCBkKSB7XG5cdFx0XHRcdHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoO1xuXHRcdFx0XHRpZiAodGhpc0dyYXBoLmNvbnN0cy5jb250YWluZXJDbGFzcyAhPSBudWxsICYmXG5cdFx0XHRcdFx0XHR0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbZC5pZF0gPT0gbnVsbCkge1xuXHRcdFx0XHRcdGQzbm9kZS5jbGFzc2VkKHRoaXNHcmFwaC5jb25zdHMuY29udGFpbmVyQ2xhc3MsIHRydWUpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGQzbm9kZS50cmFuc2l0aW9uKFwibm9kZVBvc2l0aW9uVHJhbnNpdGlvblwiKVxuXHRcdCAgICAgICAgICAgICAgICAuZHVyYXRpb24oNzUwKVxuXHRcdCAgICAgICAgICAgICAgICAuYXR0clR3ZWVuKFwidHJhbnNmb3JtXCIsIGZ1bmN0aW9uKGQpIHtcblx0XHQgICAgICAgICAgICAgICAgICAgIGlmIChkLnhTdGFydCAhPSBudWxsICYmIGQueVN0YXJ0ICE9IG51bGwpIHtcblx0XHQgICAgICAgICAgICAgICAgICAgICAgICB2YXIgeFN0YXJ0ID0gZC54U3RhcnQ7XG5cdFx0ICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHlTdGFydCA9IGQueVN0YXJ0O1xuXHRcdCAgICAgICAgICAgICAgICAgICAgICAgIGQueFN0YXJ0ID0gZC54O1xuXHRcdCAgICAgICAgICAgICAgICAgICAgICAgIGQueVN0YXJ0ID0gZC55O1xuXHRcdCAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkMy5pbnRlcnBvbGF0ZVN0cmluZyhcInRyYW5zbGF0ZShcIiArIHhTdGFydCArIFwiLFwiICsgeVN0YXJ0ICsgXCIpXCIsIFwidHJhbnNsYXRlKFwiICsgZC54ICsgXCIsXCIgKyBkLnkgKyBcIilcIik7XG5cdFx0ICAgICAgICAgICAgICAgICAgICB9XG5cdFx0ICAgICAgICAgICAgICAgICAgICByZXR1cm4gZDMuaW50ZXJwb2xhdGVTdHJpbmcoXCJ0cmFuc2xhdGUoXCIgKyBkLnggKyBcIixcIiArIGQueSArIFwiKVwiLCBcInRyYW5zbGF0ZShcIiArIGQueCArIFwiLFwiICsgZC55ICsgXCIpXCIpO1xuXHRcdCAgICAgICAgICAgICAgICB9KTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0Tm9kZTogVmlzdWFsaXplck5vZGVcblx0XHR9XG5cbn1dKTtcblxuXG5cblxuXG5cblxuXG4iLCIvKipcbiAqIFRoaXMgcG9saWN5IGlzIHVzZWQgdG8gYWRkIGEgc2VsZWN0IG5vZGUgZmVhdHVyZS5cbiAqIFN1cHBvcnRzIHNlbGVjdGluZyBtdWx0aXBsZSBub2RlcyBieSB1c2luZyB0aGUgY3RybCBrZXkuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdOb2RlU2VsZWN0aW9uUG9saWN5JywgWydQb2xpY3knLCBmdW5jdGlvbiAoUG9saWN5KSB7XG5cbiAgICBcdGNsYXNzIE5vZGVTZWxlY3Rpb25Qb2xpY3kgZXh0ZW5kcyBQb2xpY3kuUG9saWN5IHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgICAgICBzdXBlcihcIk5vZGVTZWxlY3Rpb25Qb2xpY3lcIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gcG9saWN5IGlzIGluc3RhbGxlZFxuICAgICAgICAgICAgICogT3ZlcndyaXRlcyB0aGUgb24gZHJhZyBldmVudCBvZiB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgXG4gICAgXHRcdCAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFsbGVkIG9uXG4gICAgXHRcdCAqL1xuICAgICAgICAgICAgaW5pdGlhbGl6ZShncmFwaCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3VwZXIuaW5pdGlhbGl6ZShncmFwaCk7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLnNlbGVjdGVkTm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgY29uc3RzID0gZ3JhcGguY29uc3RzLk5vZGVTZWxlY3Rpb25Qb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICBjb25zdHMuc2VsZWN0ZWRDbGFzcyA9IFwic2VsZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAvL292ZXJ3cml0dGluZyBncmFwaCdzIG5vZGUgb24gZHJhZyBldmVudCB0byBzdXBwb3J0XG4gICAgICAgICAgICAgICAgLy9tb3ZpbmcgbXVsdGlwbGUgbm9kZXMgYXQgb25jZVxuICAgICAgICAgICAgICAgIHZhciBkcmFnID0gZ3JhcGguZHJhZztcbiAgICAgICAgICAgICAgICBkcmFnLm9uKCdkcmFnJywgZnVuY3Rpb24oYXJncykge1xuICAgICAgICAgICAgICAgIFx0dmFyIHRoaXNHcmFwaCA9IGdyYXBoO1xuICAgICAgICAgICAgICAgIFx0aWYgKHRoaXNHcmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgXHRcdHZhciBzZWxlY3RlZENsYXNzID0gdGhpc0dyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5LnNlbGVjdGVkQ2xhc3M7XG4gICAgICAgICAgICAgICAgXHRcdHZhciBzZWxlY3Rpb24gPSBkMy5zZWxlY3RBbGwoICcuJyArc2VsZWN0ZWRDbGFzcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBzZWxlY3Rpb25bMF0uaW5kZXhPZiggdGhpcyk9PS0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uLmNsYXNzZWQoc2VsZWN0ZWRDbGFzcywgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGlvbiA9IGQzLnNlbGVjdCggdGhpcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uLmNsYXNzZWQoc2VsZWN0ZWRDbGFzcywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IFxuXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb24uYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbiggZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCArPSBkMy5ldmVudC5keDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gZDMuZXZlbnQuZHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwidHJhbnNsYXRlKFwiICsgWyBkLngsZC55IF0gKyBcIilcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgICAgICBcdH1cblxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQWRkcyB0aGUgZ2l2ZW4gbm9kZSB0byB0aGUgYXJyYXkgb2Ygc2VsZWN0ZWQgbm9kZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM05vZGUgICAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgIG5vZGVEYXRhICBNYXRjaGluZyBOb2RlIG9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBhZGRTZWxlY3ROb2RlKGQzTm9kZSwgbm9kZURhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgZDNOb2RlLmNsYXNzZWQoY29uc3RzLnNlbGVjdGVkQ2xhc3MsIHRydWUpO1xuICAgICAgICAgICAgICAgIHN0YXRlLnNlbGVjdGVkTm9kZXMucHVzaChub2RlRGF0YSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyB0aGUgZ2l2ZW4gbm9kZSBmcm9tIHRoZSBhcnJheSBvZiBzZWxlY3RlZCBub2Rlcy5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM05vZGUgICAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgIG5vZGVEYXRhICBNYXRjaGluZyBub2RlIG9iamVjdCBcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgcmVtb3ZlU2VsZWN0RnJvbU5vZGUoZDNOb2RlLCBub2RlRGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzLk5vZGVTZWxlY3Rpb25Qb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5maWx0ZXIoZnVuY3Rpb24oY2QpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNkLmlkID09PSBub2RlRGF0YS5pZDtcbiAgICAgICAgICAgICAgICB9KS5jbGFzc2VkKGNvbnN0cy5zZWxlY3RlZENsYXNzLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gc3RhdGUuc2VsZWN0ZWROb2Rlcy5pbmRleE9mKG5vZGVEYXRhKTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zZWxlY3RlZE5vZGVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyBhbGwgc2VsZWN0ZWQgbm9kZXMuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHJlbW92ZUFsbFNlbGVjdGVkTm9kZXMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmNsYXNzZWQoY29uc3RzLnNlbGVjdGVkQ2xhc3MsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zZWxlY3RlZE5vZGVzID0gW107XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogT24gTW91c2Vkb3duLCBkZXRlcm1pbmVzIHdoZXRoZXIgdG8gY2hhbmdlIHRoZVxuICAgICAgICAgICAgICogc2VsZWN0ZWQgc3RhdHVzIG9mIHRoZSBjbGlja2VkIG5vZGUuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgZCAgICAgICBNYXRjaGluZyBOb2RlIE9iamVjdCAgICAgICBcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgbW91c2Vkb3duKGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuICAgICAgICAgICAgICAgIGQzLmV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIGlmIChkMy5ldmVudC5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5zZWxlY3RlZE5vZGVzLmluZGV4T2YoZCkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVTZWxlY3RGcm9tTm9kZShkM25vZGUsIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRTZWxlY3ROb2RlKGQzbm9kZSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHN0YXRlLnNlbGVjdGVkTm9kZXMuaW5kZXhPZihkKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIG5vIGNvbnRyb2wga2V5LCBhbmQgY2xpY2tlZCBub3Qgc2VsZWN0ZWQgbm9kZSxcbiAgICAgICAgICAgICAgICAgICAgLy9yZW1vdmUgYWxsIG9mIGN1cnJlbnQgc2VsZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQWxsU2VsZWN0ZWROb2RlcygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBPbiBNb3VzZXVwLCBkZXRlcm1pbmVzIHdoZXRoZXIgdG8gY2hhbmdlIHRoZVxuICAgICAgICAgICAgICogc2VsZWN0ZWQgc3RhdHVzIG9mIHRoZSBjbGlja2VkIG5vZGUuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgZCAgICAgICBNYXRjaGluZyBOb2RlIE9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBtb3VzZXVwKGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuICAgICAgICAgICAgICAgIGlmICghZDMuZXZlbnQuY3RybEtleSkge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIGxlbmd0aCBpcyBncmVhdGVyIHRoYW4gMSwgdGhlbiB3ZSBhcmUgbW92aW5nIG11bHRpcGxlIG5vZGVzXG4gICAgICAgICAgICAgICAgICAgIC8vbGVhdmUgdGhlbSBhbGwgaGlnaGxpZ2h0ZWRcbiAgICAgICAgICAgICAgICAgICAgLy9vdGhlcndpc2Ugd2UgYXJlIGp1c3QgbW92aW5nIG9uZSBub2RlLCBzbyB1bmhpZ2hsaWdodFxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuc2VsZWN0ZWROb2Rlcy5sZW5ndGggPD0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVTZWxlY3RGcm9tTm9kZShkM25vZGUsIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBQb2xpY3k6IE5vZGVTZWxlY3Rpb25Qb2xpY3lcbiAgICAgICAgfVxufV0pO1xuXG5cblxuXG5cblxuXG4iLCIvKipcbiAqIFRoaXMgcG9saWN5IGNoYW5nZXMgdGhlIHZpZXcgdG8gdGhlIHRpbWVncmFwaCBvZiBsaW5rIGRhdGEgb24gY2xpY2suXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdQYXRoQ2hhbmdlVmlld1BvbGljeScsIFsnUG9saWN5JywgZnVuY3Rpb24gKFBvbGljeSkge1xuICAgIFx0Y2xhc3MgUGF0aENoYW5nZVZpZXdQb2xpY3kgZXh0ZW5kcyBQb2xpY3kuUG9saWN5IHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHRvIGJ1aWxkIHBvbGljeVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgIHtBbmd1bGFyIFN0YXRlfSAgICAkc3RhdGUgICAgVXNlZCB0byBjaGFuZ2Ugdmlld1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcigkc3RhdGUpIHtcbiAgICAgICAgICAgICAgICBzdXBlcignUGF0aENoYW5nZVZpZXdQb2xpY3knKTtcbiAgICAgICAgICAgICAgICB0aGlzLiRzdGF0ZSA9ICRzdGF0ZTtcbiAgICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogR2VuZXJhdGVzIGEgbGlzdCBvZiBhbGwgY2hpbGQgY29udGFpbmVycyBvZiB0aGUgc2VydmljZVxuICAgICAgICAgICAgICogQ2FuIGhhbmRsZSBuZXN0ZWQgc2VydmljZXMuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGlkICAgICAgTm9kZSBJRFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBnZW5lcmF0ZUxpc3QoaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHJldExpc3QgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgZ2VuZXJhdGVMaXN0SGVscGVyID0gZnVuY3Rpb24oaWQsIHJldExpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVJZHMgPSB0aGlzUG9saWN5LmdyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0W2lkXTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2RlSWRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGRJZCA9IG5vZGVJZHNbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpc1BvbGljeS5ncmFwaC5kYXRhU291cmNlLmhhc0NoaWxkKGNoaWxkSWQpID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlJldExpc3QgPSBnZW5lcmF0ZUxpc3RIZWxwZXIoY2hpbGRJZCwgcmV0TGlzdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0TGlzdC5jb25jYXQoc3ViUmV0TGlzdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldExpc3QucHVzaChjaGlsZElkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBnZW5lcmF0ZUxpc3RIZWxwZXIoaWQsIHJldExpc3QpO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXRMaXN0XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byByZXJvdXRlIGFuIGVkZ2Ugd2hlbiBjbGlja2VkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0xpbmt9ICBlZGdlICAgIFRoZSBjbGlja2VkIGVkZ2VcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdmlld0VkZ2UoZWRnZSkge1xuICAgICAgICAgICAgICAgIHZhciBzb3VyY2VMaXN0ID0gW107XG4gICAgICAgICAgICAgICAgdmFyIHRhcmdldExpc3QgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgc291cmNlSWQgPSBlZGdlLnNvdXJjZS5pZDtcbiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0SWQgPSBlZGdlLnRhcmdldC5pZDtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmdyYXBoLmRhdGFTb3VyY2UuaGFzQ2hpbGQoc291cmNlSWQpID09PSB0cnVlKSB7Ly9Ob3QgYSBjb250YWluZXIgbm9kZSwgbmVlZCB0byBhZ2dyZWdhdGVcbiAgICAgICAgICAgICAgICAgICAgc291cmNlTGlzdCA9IHRoaXMuZ2VuZXJhdGVMaXN0KHNvdXJjZUlkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzb3VyY2VMaXN0ID0gW3NvdXJjZUlkXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ncmFwaC5kYXRhU291cmNlLmhhc0NoaWxkKHRhcmdldElkKSA9PT0gdHJ1ZSkgey8vTm90IGEgY29udGFpbmVyIG5vZGUsIG5lZWQgdG8gYWdncmVnYXRlXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldExpc3QgPSB0aGlzLmdlbmVyYXRlTGlzdCh0YXJnZXRJZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TGlzdCA9IFt0YXJnZXRJZF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuJHN0YXRlLmdvKCdjb250aXYubWVudS52aXN1YWxpemF0aW9uLmVkZ2UnLCBcbiAgICAgICAgICAgICAgICAgICAge3NvdXJjZU5hbWU6IHNvdXJjZUlkLCB0YXJnZXROYW1lOiB0YXJnZXRJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZUxpc3Q6IHNvdXJjZUxpc3QsIHRhcmdldExpc3Q6IHRhcmdldExpc3R9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbW91c2Vkb3duKGQzcGF0aCwgZCkge1xuICAgICAgICAgICAgICAgIHRoaXMudmlld0VkZ2UoZCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgUG9saWN5OiBQYXRoQ2hhbmdlVmlld1BvbGljeVxuICAgICAgICB9XG59XSk7XG5cblxuXG5cblxuXG5cblxuXG5cblxuIiwiLyoqXG4gKiBCYXNlIHBvbGljeSBjbGFzcyBmb3IgdGhlIGdyYXBoIG9iamVjdFxuICogXG4gKiBQb2xpY2llcyBhcmUgdXNlZCB0byBpc29sYXRlIGZlYXR1cmVzIGZvciBhIGdyYXBoLlxuICogUG9saWNpZXMgY2FuIGJlIGluc3RhbGxlZCBvbiBub2RlcywgbGlua3MsIG9yIHRoZSBncmFwaC5cbiAqIEVhY2ggcG9saWN5IGhhcyBpbnRlcmFjdGlvbiBoYW5kbGVycyB0aGF0IHdpbGwgYmUgY2FsbGVkIGJ5IHRoZSBncmFwaFxuICogaWYgaW5zdGFsbGVkLiBQb2xpY2llcyBjYW4gYWxzbyBtb2RpZnkgZ3JhcGggZnVuY3Rpb25zIChzZWUgUVRpcFBvbGljeSkuXG4gKiBNdWx0aXBsZSBwb2xpY2llcyBjYW4gYmUgaW5zdGFsbGVkIGZvciBhIG5vZGUgb3IgbGluay4gXG4gKiBcbiAqIFRvIHdyaXRlIHlvdXIgb3duIHBvbGljeSwgY3JlYXRlIGEgbmV3IGZhY3RvcnkgdGhhdCB1c2VzIHRoZSBwb2xpY3lcbiAqIHlvdSB3YW50IHRvIGluaGVyaXQgYXMgYSBkZXBlbmRlbmN5LCBhbmQgZXh0ZW5kIGl0cyBwb2xpY3kuIFxuICogUmV0dXJuIHRoZSBjbGFzcyBvYmplY3Qgd2l0aCBQb2xpY3kgYXMga2V5LCBhbmQgXG4gKiBhZGQgdGhlIHBvbGljeSB0byB0aGUgUG9saWN5U2VydmljZSBmYWN0b3J5LlxuICogXG4gKiBGb3Igc2F2aW5nIHN0YXRlIG9yIGNvbnN0cyBmb3IgdGhlIHBvbGljeSwgY3JlYXRlIGEgbmFtZXNwYWNlXG4gKiBpbiBncmFwaC5zdGF0ZSBhbmQgZ3JhcGguY29uc3RzLlxuICogRXguIFxuICogICAgICBncmFwaC5zdGF0ZS5teVBvbGljeSA9IHt9O1xuICogICAgICBncmFwaC5jb25zdHMubXlQb2xpY3kgPSB7fTtcbiAqICAgICAgXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdQb2xpY3knLCBbZnVuY3Rpb24gKCkge1xuICAgICAgICBjbGFzcyBQb2xpY3kge1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHBvbGljeU5hbWUgIFRoZSBwb2xpY3kgbmFtZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcihwb2xpY3lOYW1lKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wb2xpY3lOYW1lID0gcG9saWN5TmFtZTtcbiAgICAgICAgICAgICAgICB0aGlzLmdyYXBoID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIHBvbGljeSBpcyBpbnN0YWxsZWQuXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAge0dyYXBofSAgZ3JhcGggICBUaGUgR3JhcGggdGhhdCB0aGUgcG9saWN5IGlzXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgYmVpbmcgaW5zdGFsbGVkIG9uXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluaXRpYWxpemUoZ3JhcGgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47IFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLmdyYXBoID0gZ3JhcGg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogSGFuZGxlciwgbWVhbnQgdG8gYmUgb3ZlcnJpZGRlbiBpbiBzdWJjbGFzc2VzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICB7ZDMgb2JqZWN0fSAgICBkM29iaiAgICBUaGUgZDNvYmplY3RcbiAgICAgICAgICAgICAqIEBwYXJhbSAge05vZGUvTGluay9HcmFwaH0gIGQgICBUaGUgb2JqZWN0IGl0IHdhc1xuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbGxlZCBmb3IuICAgIFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBtb3VzZW92ZXIgKGQzb2JqLCBkKSB7fVxuICAgICAgICAgICAgZGJsY2xpY2soZDNvYmosIGQpIHt9XG4gICAgICAgICAgICBjb250ZXh0bWVudShkM29iaiwgZCkge31cbiAgICAgICAgICAgIG1vdXNlb3V0KGQzb2JqLCBkKSB7fVxuICAgICAgICAgICAgbW91c2Vkb3duKGQzb2JqLCBkKSB7fVxuICAgICAgICAgICAgbW91c2V1cChkM29iaiwgZCkge31cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBXaWxsIGJlIGNhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyBiZWluZyBkZXN0cm95ZWQuXG4gICAgICAgICAgICAgKiBVc2VkIHRvIHJlbW92ZSBhbnkgZWxlbWVudHMgb3IgYmluZGluZ3MgdGhlIHBvbGljeVxuICAgICAgICAgICAgICogaGFzIGFkZGVkLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkZXN0cm95KCkge31cbiAgICAgICAgfVxuICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIFBvbGljeTogUG9saWN5XG4gICAgICAgIH1cbn1dKTtcblxuXG5cblxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmFwcGxpY2F0aW9uZ3JvdXBzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3VwcycsIHtcbiAgICAgICAgICAgIHVybDogJy9hcHBsaWNhdGlvbmdyb3VwcycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMuY3JlYXRlJywge1xuICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdhcHBsaWNhdGlvbmdyb3VwY3JlYXRlJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3Vwcy5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdhcHBsaWNhdGlvbmdyb3VwZGV0YWlscydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMuZWRpdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9lZGl0LzprZXknLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnYXBwbGljYXRpb25ncm91cGRldGFpbHMnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdhcHBsaWNhdGlvbkdyb3VwbGlzdCdcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIi8qKlxuICogQ29udGFpbnMgYWxsIHRoZSBwb2xpY2llcy5cbiAqIFNlZSBwb2xpY3kuanMgZm9yIGluZm8gb24gaG93IHBvbGljaWVzIHdvcmsuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdQb2xpY3lTZXJ2aWNlJywgWydQb2xpY3knLCdRVGlwUG9saWN5JywgJ1BhdGhDaGFuZ2VWaWV3UG9saWN5JywgXG4gICAgICAgICdOb2RlU2VsZWN0aW9uUG9saWN5JywgJ1NwbGl0Sm9pbk5vZGVQb2xpY3knLCAnU3BsaXRKb2luVmlld1BvbGljeScsXG4gICAgICAgICdTYXZlU3RhdGVQb2xpY3knLFxuICAgICAgICAgICAgZnVuY3Rpb24gKFBvbGljeSwgUVRpcFBvbGljeSwgUGF0aENoYW5nZVZpZXdQb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgICAgICBOb2RlU2VsZWN0aW9uUG9saWN5LCAgU3BsaXRKb2luTm9kZVBvbGljeSwgXG4gICAgICAgICAgICAgICAgICAgICAgICBTcGxpdEpvaW5WaWV3UG9saWN5LCBTYXZlU3RhdGVQb2xpY3kpIHtcblxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIFBvbGljeTogUG9saWN5LlBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgUVRpcFBvbGljeTogUVRpcFBvbGljeS5Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIFBhdGhDaGFuZ2VWaWV3UG9saWN5OiBQYXRoQ2hhbmdlVmlld1BvbGljeS5Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIE5vZGVTZWxlY3Rpb25Qb2xpY3k6IE5vZGVTZWxlY3Rpb25Qb2xpY3kuUG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBTcGxpdEpvaW5Ob2RlUG9saWN5OiBTcGxpdEpvaW5Ob2RlUG9saWN5LlBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgU3BsaXRKb2luVmlld1BvbGljeTogU3BsaXRKb2luVmlld1BvbGljeS5Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIFNhdmVTdGF0ZVBvbGljeTogU2F2ZVN0YXRlUG9saWN5LlBvbGljeVxuICAgICAgICAgICAgICAgIH1cbn1dKTsiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZGFzaGJvYXJkJywgWydjb250aXYubW9kZWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmRhc2hib2FyZCcsIHtcbiAgICAgICAgICAgIHVybDogJy9kYXNoYm9hcmQnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnZGFzaGJvYXJkJ1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE5LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmxvZ2luJywgWydjb250aXYudXRpbHMnXSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwIiwiLyoqXG4gKiBUaGlzIHBvbGljeSBhZGRzIHRvb2x0aXAgZnVuY3Rpb25hbGl0eSB0byBub2RlcyBhbmQgbGlua3MuXG4gKiBXaGVuIGluc3RhbGxpbmcsIGluc3RhbGwgb24gYm90aCBsaW5rcyBhbmQgbm9kZXMuXG4gKiBcbiAqIFVzZXMgdGhlIHFUaXAgalF1ZXJ5IHBsdWdpblxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnUVRpcFBvbGljeScsIFsnUG9saWN5JywgZnVuY3Rpb24gKFBvbGljeSkge1xuICAgICAgICBjbGFzcyBRVGlwUG9saWN5IGV4dGVuZHMgUG9saWN5LlBvbGljeSB7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgICAgICAgICAgc3VwZXIoXCJRVGlwUG9saWN5XCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAgICAgKiBNb2RpZmllcyB0aGUgdXBkYXRlTmV3Tm9kZXMgYW5kIFxuICAgICAgICAgICAgICogdXBkYXRlTmV3UGF0aHMgbWV0aG9kIG9mIHRoZSBncmFwaCB0byBpbnN0YWxsIHF0aXBcbiAgICAgICAgICAgICAqIG9udG8gZWFjaCBub2RlIGFuZCBwYXRoLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoIGl0IGlzIFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YWxsZWQgb25cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5pdGlhbGl6ZShncmFwaCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3VwZXIuaW5pdGlhbGl6ZShncmFwaCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuUVRpcFBvbGljeSA9IHt9O1xuXG4gICAgICAgICAgICAgICAgc3RhdGUubW91c2Vkb3duID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICBncmFwaC5jb25zdHMuUVRpcFBvbGljeSA9IHt9O1xuXG4gICAgICAgICAgICAgICAgLy9UcmFja2luZyBtb3VzZSBjbGljayBzdGF0ZSB0byBtYWtlIHRvb2x0aXBcbiAgICAgICAgICAgICAgICAvL2Rpc2FwcGVhciBpZiB0aGUgbm9kZSBpcyBiZWluZyBkcmFnZ2VkLlxuICAgICAgICAgICAgICAgICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykubW91c2V1cChmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLm1vdXNldXAgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vb3ZlcnJpZGUgdXBkYXRlTmV3Tm9kZXMgYW5kIHVwZGF0ZU5ld1BhdGhzXG4gICAgICAgICAgICAgICAgLy90byBpbnN0YWxsIHF0aXBcbiAgICAgICAgICAgICAgICB2YXIgZ3JhcGhVcGRhdGVOZXdOb2RlcyA9IGdyYXBoLnVwZGF0ZU5ld05vZGVzO1xuICAgICAgICAgICAgICAgIGdyYXBoLnVwZGF0ZU5ld05vZGVzID0gZnVuY3Rpb24obmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGhVcGRhdGVOZXdOb2Rlcy5jYWxsKGdyYXBoLCBuZXdOb2Rlcyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kudXBkYXRlTmV3Tm9kZXMobmV3Tm9kZXMpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB2YXIgZ3JhcGhVcGRhdGVOZXdQYXRocyA9IGdyYXBoLnVwZGF0ZU5ld1BhdGhzO1xuICAgICAgICAgICAgICAgIGdyYXBoLnVwZGF0ZU5ld1BhdGhzID0gZnVuY3Rpb24obmV3UGF0aHMpIHtcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGhVcGRhdGVOZXdQYXRocy5jYWxsKGdyYXBoLCBuZXdQYXRocyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kudXBkYXRlTmV3UGF0aHMobmV3UGF0aHMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmVzIGFsbCBxVGlwcyBmcm9tIHRoZSBET00uXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgcG9saWN5IGlzIHVuaW5zdGFsbGVkIG9yXG4gICAgICAgICAgICAgKiB0aGUgZ3JhcGggaXMgZGVzdHJveWVkLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkZXN0cm95KCkge1xuICAgICAgICAgICAgICAgIC8vcmVtb3ZpbmcgYWxsIHF0aXAgZnJvbSBET01cbiAgICAgICAgICAgICAgICAkKCdbaWRePVwicXRpcFwiXScpLnJlbW92ZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEtlZXBpbmcgdHJhY2sgb2YgbW91c2Vkb3duIHN0YXRlXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzT2JqZWN0fSAgZDNvYmogIFRoZSBkMyBwYmplY3RcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlL0xpbmt9ICBkICAgICBUaGUgbWF0Y2hpbmcgZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgbW91c2Vkb3duKGQzb2JqLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlFUaXBQb2xpY3k7XG4gICAgICAgICAgICAgICAgc3RhdGUubW91c2Vkb3duID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBLZWVwaW5nIHRyYWNrIG9mIG1vdXNlZG93biBzdGF0ZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM09iamVjdH0gIGQzb2JqICBUaGUgZDMgcGJqZWN0XG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZS9MaW5rfSAgZCAgICAgVGhlIG1hdGNoaW5nIGRhdGEgb2JqZWN0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIG1vdXNldXAoZDNvYmosIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuUVRpcFBvbGljeTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5tb3VzZWRvd24gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgd2hlblFUaXBBdmFpbGFibGUoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIGludGVydmFsID0gNTAwOyAvLyBtc1xuICAgICAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJChkb2N1bWVudCkucXRpcCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQodGhpc1BvbGljeS53aGVuUVRpcEF2YWlsYWJsZShjYWxsYmFjayksIGludGVydmFsKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIGludGVydmFsKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiBOZXcgTm9kZXMgYXJlIGFkZGVkIGR1cmluZyB0aGVcbiAgICAgICAgICAgICAqIHVwZGF0ZSBncmFwaCBmdW5jdGlvblxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM05vZGV9ICBuZXdOb2RlcyAgVGhlIG5ldyBub2RlcyB0aGF0IGFyZVxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZWluZyBhZGRlZCB0byB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlTmV3Tm9kZXMobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuUVRpcFBvbGljeTtcblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGF0dGFjaFFUaXAoKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vYXR0YWNoaW5nIHF0aXBcbiAgICAgICAgICAgICAgICAgICAgbmV3Tm9kZXMuZWFjaChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGhpc05vZGUgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy9JZiBub2RlIGhhcyBjaGlsZHJlbiwgdGhlbiBpdCBpcyBhIHNlcnZpY2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbZC5pZF0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSBcIjxiPjx1PlNlbGVjdG9yczo8L2I+PC91PiBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0b3JNYXAgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5zZWxlY3RvcnNbZC5pZF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhhc0tleXMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gc2VsZWN0b3JNYXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzS2V5cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0ga2V5ICsgXCIgOiA8aT5cIisgc2VsZWN0b3JNYXBba2V5XSArIFwiPC9pPixcXG4gXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoYXNLZXlzID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbW1hIHdpbGwgYmUgcmVtb3ZlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gXCJObyBTZWxlY3RvcnMsIFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gXCI8Yj48dT5MYWJlbHM6PC9iPjwvdT4gXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxhYmVsc01hcCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmxhYmVsc1tkLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGFzS2V5cyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBsYWJlbHNNYXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzS2V5cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0ga2V5ICsgXCIgOiA8aT5cIisgbGFiZWxzTWFwW2tleV0gKyBcIjwvaT4sXFxuIFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFzS2V5cyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb21tYSB3aWxsIGJlIHJlbW92ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IFwiTm8gbGFiZWxzLCBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3JlbW92ZSBsYXN0IGNvbW1hXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gdGV4dC5zbGljZSgwLCAtMik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpc05vZGUpLnF0aXAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGQuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRleHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50czogeyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXBpID0gJCh0aGlzTm9kZSkucXRpcCgnYXBpJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gJCgnI2dyYXBoQ29udGFpbmVyJykub2Zmc2V0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9zaXRpb24gPSBbb2Zmc2V0LmxlZnQgKyAoKGQueCAqIHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCkpICsgdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKClbMF0pLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0LnRvcCArICgoZC55ICtkLnJhZGl1cykgKiB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpKSAgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKVsxXV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcGkuc2V0KCdwb3NpdGlvbi50YXJnZXQnLCBwb3NpdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIXN0YXRlLm1vdXNlZG93bjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxheTogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc29sbzogJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NlczogJ3F0aXAtYmx1ZSBxdGlwLXNoYWRvdydcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG15OiAndG9wIGNlbnRlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0OiAnYm90dG9tIGNlbnRlcidcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGFyZ2V0OiBwb3NpdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudDogJ21vdXNlZG93biBtb3VzZWxlYXZlJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL2luY2FzZSBsaWJyYXJ5IGhhc24ndCBsb2FkZWQgeWV0XG4gICAgICAgICAgICAgICAgaWYgKCQoZG9jdW1lbnQpLnF0aXAgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGF0dGFjaFFUaXAoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLndoZW5RVGlwQXZhaWxhYmxlKGF0dGFjaFFUaXApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiBuZXcgcGF0aHMgYXJlIGFkZGVkIGR1cmluZyB0aGVcbiAgICAgICAgICAgICAqIHVwZGF0ZSBncmFwaCBmdW5jdGlvblxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM1BhdGh9ICBuZXdQYXRocyAgVGhlIG5ldyBwYXRocyB0aGF0IGFyZVxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZWluZyBhZGRlZCB0byB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlTmV3UGF0aHMobmV3UGF0aHMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuUVRpcFBvbGljeTtcblxuICAgICAgICAgICAgICAgIC8vaW5jYXNlIGxpYnJhcnkgaGFzbid0IGxvYWRlZCB5ZXRcbiAgICAgICAgICAgICAgICBpZiAoJChkb2N1bWVudCkucXRpcCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9hZGRpbmcgcXRpcFxuICAgICAgICAgICAgICAgICAgICBuZXdQYXRocy5lYWNoKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aGlzUGF0aCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2dldHRpbmcgbWlkcG9pbnQgb2YgcGF0aFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhdGhFbCAgID0gZDMuc2VsZWN0KHRoaXMpLm5vZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtaWRwb2ludCA9IHBhdGhFbC5nZXRQb2ludEF0TGVuZ3RoKHBhdGhFbC5nZXRUb3RhbExlbmd0aCgpLzIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldFJldCA9IGQucXRpcEhlbHBlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSBcIkJ5dGVzOiBcIiArIGQuZ2V0V2VpZ2h0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXNQYXRoKS5xdGlwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRleHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vaWYgbW91c2UgaXMgZG93biwgZG9uJ3QgbGV0IHF0aXAgc2hvd1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICFzdGF0ZS5tb3VzZWRvd247XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3c6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsYXk6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvbG86ICQoJyNncmFwaENvbnRhaW5lcicpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc2VzOiAncXRpcC1ibHVlIHF0aXAtc2hhZG93J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXk6IHRhcmdldFJldC5teSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXQ6ICdjZW50ZXIgY2VudGVyJywgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogJ21vdXNlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRqdXN0OiB0YXJnZXRSZXQuYWRqdXN0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaWRlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50OiAnbW91c2Vkb3duIG1vdXNlbGVhdmUnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9ICAgXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgUG9saWN5OiBRVGlwUG9saWN5XG4gICAgICAgIH1cbn1dKTtcblxuXG5cblxuXG5cblxuXG4iLCIvKipcbiAqIFRoaXMgcG9saWN5IHByb3ZpZGVzIGEgd2F5IGZvciBwcm9wZXJ0aWVzIHRvIGJlIHNhdmVkIFxuICogYmV0d2VlbiB2aWV3IGNoYW5nZXNcbiAqIFxuICogSXQgbW9kaWZpZXMgdGhlIGRlc3Ryb3kgZnVuY3Rpb24gdG8gYWxzbyBwYXNzIGluIGFuIG9iamVjdCB0aGF0XG4gKiB3aWxsIGhhdmUgYWxsIGl0cyBwcm9wZXJ0aWVzIHNhdmVkIGFuZCB3aWxsIGJlIGF2YWlsYWJsZSBcbiAqIG9uIGdyYXBoIGxvYWQuIFdoZW4gc2F2aW5nIHZhcmlhYmxlcyB0byB0aGUgb2JqZWN0LCBuYW1lc3BhY2Ugd2l0aFxuICogdGhlIHBvbGljeSBuYW1lLlxuICogXG4gKiBUaGlzIHBvbGljeSBtdXN0IGJlIGxvYWRlZCBmaXJzdCBpbiBvcmRlciBmb3IgaXQgc2F2ZWQgdmFyaWFibGVzIFxuICogdG8gYmUgbG9hZGVkIHdoZW4gdGhlIHZpZXcgY29tZXMgYmFjayB0byB0aGUgZ3JhcGhcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ1NhdmVTdGF0ZVBvbGljeScsIFsnUG9saWN5JywgZnVuY3Rpb24gKFBvbGljeSkge1xuICAgIFx0Y2xhc3MgU2F2ZVN0YXRlUG9saWN5IGV4dGVuZHMgUG9saWN5LlBvbGljeSB7XG4gICAgXHRcdFxuICAgIFx0XHQvKipcbiAgICBcdFx0ICogVGFrZXMgaW4gdGhlIGFuZ3VsYXIgc2VydmljZSB0byB3aGljaCBpdCB3aWxsXG4gICAgXHRcdCAqIHNhdmUgaXQncyBwcm9wZXJ0aWVzIHRvLlxuICAgIFx0XHQgKlxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgc2F2ZWRTdGF0ZSAgT2JqZWN0IHRvIHNhdmUgXG4gICAgXHRcdCAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzIHRvXG4gICAgXHRcdCAqL1xuICAgIFx0XHRjb25zdHJ1Y3RvcihzYXZlZFN0YXRlKSB7XG4gICAgXHRcdFx0c3VwZXIoJ1NhdmVTdGF0ZVBvbGljeScpO1xuICAgIFx0XHRcdHRoaXMuc2F2ZWRTdGF0ZSA9IHNhdmVkU3RhdGU7XG4gICAgXHRcdH1cblxuICAgIFx0XHQvKipcbiAgICBcdFx0ICogQ2FsbGVkIHdoZW4gdGhlIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICBcdFx0ICogTW9kaWZpZXMgdGhlIGRlc3Ryb3kgbWV0aG9kIFxuICAgIFx0XHQgKiBhbmQgYWRkcyBhIGxvYWQgbWV0aG9kIHRvIHRoZSBncmFwaFxuICAgIFx0XHQgKlxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaCBpdCBpcyBcbiAgICBcdFx0ICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YWxsZWQgb25cbiAgICBcdFx0ICovXG4gICAgXHRcdGluaXRpYWxpemUoZ3JhcGgpIHtcbiAgICBcdFx0XHR0aGlzLmdyYXBoID0gZ3JhcGg7XG4gICAgXHRcdFx0dmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgIFx0XHRcdGdyYXBoLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcbiAgICBcdFx0XHRcdHRoaXNQb2xpY3kuZ3JhcGhEZXN0cm95LmNhbGwoZ3JhcGgsIHRoaXNQb2xpY3kuc2F2ZWRTdGF0ZSk7XG4gICAgXHRcdFx0fTtcblxuICAgIFx0XHRcdGdyYXBoLmxvYWQgPSBmdW5jdGlvbihzYXZlZFN0YXRlKSB7XG4gICAgXHRcdFx0XHR0aGlzUG9saWN5LmdyYXBoTG9hZC5jYWxsKGdyYXBoLCBzYXZlZFN0YXRlKTtcbiAgICBcdFx0XHR9XG4gICAgXHRcdH1cblxuICAgIFx0XHQvKipcbiAgICBcdFx0ICogV2lsbCBvdmVycmlkZSB0aGUgZ3JhcGgncyBkZWZhdWx0IGRlc3Ryb3ksIHdpdGggXG4gICAgXHRcdCAqIHRoaXMgcG9saWN5J3Mgc2F2ZWRTdGF0ZSBwYXNzZWQgaW4uXG4gICAgXHRcdCAqIENhbGxlZCB3aXRoIHRoaXMgYXMgdGhlIGdyYXBoXG4gICAgXHRcdCAqXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBzYXZlZFN0YXRlICBUaGUgc2F2ZWQgc3RhdGVcbiAgICBcdFx0ICovXG4gICAgXHRcdGdyYXBoRGVzdHJveShzYXZlZFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KHNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KHNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzR3JhcGguYmluZGluZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgJCh3aW5kb3cpLm9mZihrZXksIHRoaXNHcmFwaC5iaW5kaW5nc1trZXldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2lsbCBiZSBjYWxsZWQgd2l0aCB0aGUgZ3JhcGggYXMgdGhpc1xuICAgICAgICAgICAgICogVXNlZCB0byBoYXZlIGFsbCBvdGhlciBwb2xpY2llcyB1c2UgdGhlIGxvYWQgc3RhdGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgc2F2ZWRTdGF0ZSAgVGhlIHNhdmVkIHN0YXRlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGdyYXBoTG9hZChzYXZlZFN0YXRlKSB7XG4gICAgICAgICAgICBcdHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICBcdGlmIChwb2xpY3kubG9hZCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIFx0cG9saWN5LmxvYWQoc2F2ZWRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgIFx0fVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgIFx0aWYgKHBvbGljeS5sb2FkICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgXHRwb2xpY3kubG9hZChzYXZlZFN0YXRlKTtcbiAgICAgICAgICAgICAgICAgXHR9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgXHR9XG4gICAgXHRyZXR1cm4ge1xuICAgIFx0XHRQb2xpY3k6IFNhdmVTdGF0ZVBvbGljeVxuICAgIFx0fVxufV0pO1xuXG5cblxuXG5cblxuXG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubWVudScsIFtdKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3BvbGljaWVzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbmV0d29ya3BvbGljaWVzJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuaXNvbGF0aW9uJywge1xuICAgICAgICAgICAgdXJsOiAnL2lzb2xhdGlvbicsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPHVpLXZpZXcvPidcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbi5jcmVhdGUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2lzb2xhdGlvbnBvbGljeWNyZWF0ZSdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbi5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdpc29sYXRpb25wb2xpY3lkZXRhaWxzJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuaXNvbGF0aW9uLmVkaXQnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZWRpdC86a2V5JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2lzb2xhdGlvbnBvbGljeWRldGFpbHMnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGgnLCB7XG4gICAgICAgICAgICB1cmw6ICcvYmFuZHdpZHRoJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8dWktdmlldy8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuYmFuZHdpZHRoLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnYmFuZHdpZHRocG9saWN5Y3JlYXRlJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuYmFuZHdpZHRoLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2JhbmR3aWR0aHBvbGljeWRldGFpbHMnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGguZWRpdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9lZGl0LzprZXknLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnYmFuZHdpZHRocG9saWN5ZGV0YWlscydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLnJlZGlyZWN0aW9uJywge1xuICAgICAgICAgICAgdXJsOiAnL3JlZGlyZWN0aW9uJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8dWktdmlldy8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIHBhcmFtczogeyBwb2xpY3lUYWI6IG51bGwgfSxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ25ldHdvcmtwb2xpY2llc3RhYnMnXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIFRoaXMgcG9saWN5IGlzIHVzZWQgZm9yIHNwbGl0dGluZyBhIG5vZGUgaW50byBpdHMgY2hpbGRyZW4sXG4gKiBhbmQgam9pbmluZyB0aGVtIGJhY2sgdG8gdGhlaXIgcGFyZW50LlxuICogU3BsaXRzIG9uIGRvdWJsZSBjbGljaywgYW5kIGpvaW5zIG9uIHJpZ2h0IGNsaWNrLlxuICogSWYgbXVsdGlwbGUgbm9kZXMgYXJlIHNlbGVjdGVkIGF0IHRoZSB0aW1lIG9mIGEgc3BsaXQgb3Igam9pbiBldmVudCxcbiAqIGl0IHdpbGwgc3BsaXQgb3Igam9pbiBhbGwgb2YgdGhlbS5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ1NwbGl0Sm9pbk5vZGVQb2xpY3knLCBbJ05vZGVTZWxlY3Rpb25Qb2xpY3knLCAnVmlzdWFsaXplck5vZGUnLCBcbiAgICBcdFx0ZnVuY3Rpb24gKE5vZGVTZWxlY3Rpb25Qb2xpY3ksIFZpc3VhbGl6ZXJOb2RlKSB7XG5cdFx0Y2xhc3MgU3BsaXRKb2luTm9kZVBvbGljeSBleHRlbmRzIE5vZGVTZWxlY3Rpb25Qb2xpY3kuUG9saWN5IHtcblx0XHRcdC8qKlxuXHRcdFx0ICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuXHRcdFx0ICovXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgICAgICBzdXBlcigpO1xuICAgICAgICAgICAgICAgIHRoaXMucG9saWN5TmFtZSA9IFwiU3BsaXRKb2luTm9kZVBvbGljeVwiO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbml0aWFsaXplKGdyYXBoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdXBlci5pbml0aWFsaXplKGdyYXBoKTtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBncmFwaC5zdGF0ZS5TcGxpdEpvaW5Ob2RlUG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgc3RhdGUuc3BsaXROb2RlcyA9IFtdOyBcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUcmlnZ2VyaW5nIHNwbGl0IG9uIGRvdWJsZSBjbGlja1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBkICAgICAgVGhlIG1hdGNoaW5nIGRhdGEgb2JqZWN0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGRibGNsaWNrKGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdXBlclN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pbk5vZGVQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWQzLmV2ZW50LmN0cmxLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN1cGVyU3RhdGUuc2VsZWN0ZWROb2Rlcy5pbmRleE9mKGQpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3BsaXRNdWx0aXBsZU5vZGVzKHN1cGVyU3RhdGUuc2VsZWN0ZWROb2Rlcyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUFsbFNlbGVjdGVkTm9kZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3BsaXROb2RlKGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRyaWdnZXJpbmcgam9pbiBvbiByaWdodCBjbGlja1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09ian0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBkICAgICAgVGhlIG1hdGNoaW5nIGRhdGEgb2JqZWN0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGNvbnRleHRtZW51KGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdXBlclN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3k7XG4gICAgICAgICAgICAgICAgZDMuZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICBpZiAoIWQzLmV2ZW50LmN0cmxLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9pZiB0cnkgdG8gam9pbiBhIGhpZ2hsaWdodGVkIG5vZGUgd2hpbGUgbXVsdGlwbGUgbm9kZXMgYXJlIHNlbGVjdGVkLFxuICAgICAgICAgICAgICAgICAgICAvL3dlIGpvaW4gYWxsIGhpZ2hsaWdodGVkIG5vZGVzXG4gICAgICAgICAgICAgICAgICAgIHZhciBzZWxlY3RlZE5vZGVzID0gc3VwZXJTdGF0ZS5zZWxlY3RlZE5vZGVzO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWROb2Rlcy5pbmRleE9mKGQpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZWN0ZWROb2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuam9pbk5vZGUoc2VsZWN0ZWROb2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2lmIHdlIHRyeSB0byBqb2luIGEgbm9kZSB0aGF0IGlzbid0IHBhcnQgb2YgYSBoaWdobGlnaHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAvL3dlIHJlbW92ZSBhbGwgaGlnaGxpZ2h0cyBhbmQgdGhlbiBqb2luIHRoZSBjbGlja2VkIG5vZGVcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQWxsU2VsZWN0ZWROb2RlcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5qb2luTm9kZShkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTcGxpdHMgYSBub2RlLlxuICAgICAgICAgICAgICogdXNlZCB0byBzaGFyZSBjb2RlIGJldHdlZW4gc3BsaXROb2RlIGFuZCBzcGxpdE11bHRpcGxlTm9kZXNcbiAgICAgICAgICAgICAqIHdoaWxlIHByZXZlbnRpbmcgdGhlIGhhbmRsZXJzIGZvciB0aGVtIGJvdGggZmlyaW5nXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZSBiZWluZyBzcGxpdFxuICAgICAgICAgICAgICogQHJldHVybiAgICAge0FycmF5fSAgVGhlIG5ldyBub2RlcyBjcmVhdGVkIGJ5IHRoZSBzcGxpdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBfX3NwbGl0Tm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pbk5vZGVQb2xpY3k7XG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBub2RlLmlkO1xuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgLy9pZiBpdCBoYXMgbm8gY2hpbGRyZW4gdG8gc3BsaXQgaW50b1xuICAgICAgICAgICAgICAgIGlmIChjaGlsZHJlbl9zdHJ1Y3RbbmFtZV0gPT09IHVuZGVmaW5lZCB8fCBfLmlzRW1wdHkoY2hpbGRyZW5fc3RydWN0W25hbWVdKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9yZW1vdmluZyB0aGUgbm9kZSBmcm9tIHRoZSBsaXN0IG9mIG5vZGVzXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzID0gXy5maWx0ZXIodGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbihncmFwaE5vZGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBncmFwaE5vZGVzICE9IG5vZGU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2codGhpc0dyYXBoLm5vZGVzKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3BsaWNlTGlua3NGb3JOb2RlKG5vZGUpO1xuXG4gICAgICAgICAgICAgICAgLy9nZXR0aW5nIGFsbCB0aGUgbm9kZSBpZCdzIGZvciBmaW5kaW5nIGZsb3dcbiAgICAgICAgICAgICAgICB2YXIgbm9kZV9uYW1lc19zZXQgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXNHcmFwaC5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBub2RlX25hbWVzX3NldC5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXS5pZCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9zZXQgb2Ygbm9kZXMgYWZ0ZXIgdGhlIHNwbGl0XG4gICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hpbGRyZW5fc3RydWN0W25hbWVdLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVfbmFtZXNfc2V0LnB1c2goY2hpbGRyZW5fc3RydWN0W25hbWVdW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3X25vZGVzLnB1c2goY2hpbGRyZW5fc3RydWN0W25hbWVdW2ldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHJldERhdGEgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5nZXRGbG93QmV0d2VlblNldChub2RlX25hbWVzX3NldCk7XG5cbiAgICAgICAgICAgICAgICAvL2Zvcm1hdHRpbmcgZGF0YSBmb3IgbmV3IG5vZGVzXG4gICAgICAgICAgICAgICAgdmFyIHhMb2MgPSBub2RlLng7XG4gICAgICAgICAgICAgICAgdmFyIHlMb2MgPSBub2RlLnk7XG4gICAgICAgICAgICAgICAgdmFyIGFuY2VzdG9ycyA9IG5vZGUuYW5jZXN0b3JzLnNsaWNlKCk7XG4gICAgICAgICAgICAgICAgLy9rZWVwaW5nIG9yZGVyaW5nIHRoYXQgZmlyc3QgaW4gYW5jZXN0b3IgbGlzdCBpcyBjbG9zZXN0IGluIHJlbGF0aW9uc2hpcFxuICAgICAgICAgICAgICAgIGFuY2VzdG9ycy5zcGxpY2UoMCwgMCwgbm9kZS5pZCk7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IG5vZGUuaWQ7XG4gICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlX29ianMgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgcmFkaXVzID0gbm9kZS5yYWRpdXMgKiB0aGlzR3JhcGguY29uc3RzLnJhZGl1c0RlY2F5O1xuICAgICAgICAgICAgICAgIHZhciBub2RlRGF0YSA9IHJldERhdGEubm9kZURhdGE7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2RlRGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAvL2NhbGN1bGF0aW5nIHdoaWNoIG9mIHRoZSBub2RlcyBpbiByZXREYXRhWzBdIGFyZSBuZXdcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld19ub2Rlcy5pbmRleE9mKG5vZGVEYXRhW2ldLmlkKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWQgPSBub2RlRGF0YVtpXS5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gbm9kZURhdGFbaV0udGV4dDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZSA9IG5ldyBWaXN1YWxpemVyTm9kZS5Ob2RlKG51bGwsIG51bGwsIGlkLCB0ZXh0LCByYWRpdXMsIHBhcmVudCwgYW5jZXN0b3JzLCB4TG9jLCB5TG9jKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld19ub2RlLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5wdXNoKG5ld19ub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld19ub2RlX29ianMucHVzaChuZXdfbm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UucHJvY2Vzc0xpbmtEYXRhKHJldERhdGEubGlua0RhdGEsIHRoaXNHcmFwaC5ub2Rlcyk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXROb2RlcygpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0TGlua3MoKTtcblxuICAgICAgICAgICAgICAgIHN0YXRlLnNwbGl0Tm9kZXMucHVzaChub2RlLmlkKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3X25vZGVfb2JqcztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTcGxpdHMgdGhlIGdpdmUgbm9kZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZSBiZWluZyBzcGxpdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzcGxpdE5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciByZXMgPSB0aGlzLl9fc3BsaXROb2RlKG5vZGUpO1xuICAgICAgICAgICAgICAgIGlmIChyZXMgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc3BsaXROb2RlRXZlbnQocmVzKTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNwbGl0cyBhbGwgdGhlIG5vZGVzIHBhc3NlZCBpblxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVzICAgQXJyYXkgb2Ygbm9kZXMgdG8gYmUgc3BsaXRcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc3BsaXRNdWx0aXBsZU5vZGVzKG5vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG4gICAgICAgICAgICAgICAgdmFyIHJlc05vZGVzID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0gdGhpcy5fX3NwbGl0Tm9kZShub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIHJlc05vZGVzID0gcmVzTm9kZXMuY29uY2F0KHJlcyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5zcGxpdE11bHRpcGxlTm9kZXNFdmVudChyZXMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBhIHNpbmdsZSBub2RlIGlzIHNwbGl0XG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbmV3Tm9kZXMgIFRoZSBuZXcgbm9kZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc3BsaXROb2RlRXZlbnQobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaDtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc2V0UG9zaXRpb25zKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIGFmdGVyIG11bHRpcGxlIG5vZGVzIGFyZSBzcGxpdCBhdCBvbmNlXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbmV3Tm9kZXMgIFRoZSBuZXcgbm9kZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc3BsaXRNdWx0aXBsZU5vZGVzRXZlbnQobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaDtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc2V0UG9zaXRpb25zKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogdXNlZCB0byBzaGFyZSBjb2RlIGJldHdlZW4gam9pbk5vZGUgYW5kIGpvaW5NdWx0aXBsZU5vZGVcbiAgICAgICAgICAgICAqIHdoaWxlIHByZXZlbnRpbmcgYm90aCBoYW5kbGVycyBmaXJpbmdcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgICAgIG5vZGUgICAgVGhlIG5vZGUgdG8gam9pblxuICAgICAgICAgICAgICogQHJldHVybiAgICAge05vZGV9ICBUaGUgbmV3IG5vZGUgYWZ0ZXIgdGhlIGpvaW5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgX19qb2luTm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pbk5vZGVQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICAvL2NoZWNrIHRoYXQgbm9kZSBzdGlsbCBleGlzdHNcbiAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLm5vZGVzLmluZGV4T2Yobm9kZSkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBub2RlLmlkO1xuICAgICAgICAgICAgICAgIC8vaWYgaXQgaGFzIG5vIGFuY2VzdG9yLCBub3RoaW5nIHRvIGpvaW5cbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRyZW5fc3RydWN0LnRvcExldmVsLmluZGV4T2YobmFtZSkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHRvX2JlX2RlbGV0ZWQgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZV9uYW1lc19zZXQgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXNHcmFwaC5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIG5vZGUgd29uJ3QgYmUgY29sbGFwc2VkXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGgubm9kZXNbaV0uYW5jZXN0b3JzLmluZGV4T2Yobm9kZS5wYXJlbnQpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlX25hbWVzX3NldC5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXS5pZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b19iZV9kZWxldGVkLnB1c2godGhpc0dyYXBoLm5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGVfaWQgPSBub2RlLnBhcmVudDtcbiAgICAgICAgICAgICAgICBub2RlX25hbWVzX3NldC5wdXNoKG5vZGUucGFyZW50KTtcblxuICAgICAgICAgICAgICAgIC8vZm9ybWF0dGluZyBkYXRhXG4gICAgICAgICAgICAgICAgdmFyIHJhZGl1cyA9IG5vZGUucmFkaXVzIC8gdGhpc0dyYXBoLmNvbnN0cy5yYWRpdXNEZWNheTsgXG4gICAgICAgICAgICAgICAgdmFyIHhMb2MgPSBub2RlLng7XG4gICAgICAgICAgICAgICAgdmFyIHlMb2MgPSBub2RlLnk7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IG5vZGUuYW5jZXN0b3JzWzFdO1xuICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnMgPSBub2RlLmFuY2VzdG9ycy5zbGljZSgxKTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGUgPSBuZXcgVmlzdWFsaXplck5vZGUuTm9kZSh4TG9jLCB5TG9jLCBuZXdfbm9kZV9pZCwgbmV3X25vZGVfaWQsIHJhZGl1cywgcGFyZW50LCBhbmNlc3RvcnMpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5wdXNoKG5ld19ub2RlKTtcblxuICAgICAgICAgICAgICAgIHZhciByZXREYXRhID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuZ2V0Rmxvd0JldHdlZW5TZXQobm9kZV9uYW1lc19zZXQpO1xuICAgICAgICAgICAgICAgIC8vcmVtb3ZlIGFsbCBub2RlcyB0aGF0IHdpbGwgYmUgam9pbmVkXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b19iZV9kZWxldGVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlX3RvX2RlbGV0ZSA9IHRvX2JlX2RlbGV0ZWRbaV07XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5zcGxpY2UodGhpc0dyYXBoLm5vZGVzLmluZGV4T2Yobm9kZV90b19kZWxldGUpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlX3RvX2RlbGV0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YShyZXREYXRhLmxpbmtEYXRhLCB0aGlzR3JhcGgubm9kZXMpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0Tm9kZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdExpbmtzKCk7XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS5zcGxpdE5vZGVzLnNwbGljZShzdGF0ZS5zcGxpdE5vZGVzLmluZGV4T2YobmV3X25vZGUuaWQpLCAxKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBuZXdfbm9kZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBKb2lucyB0aGUgZ2l2ZW4gbm9kZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZSB0byBqb2luXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGpvaW5Ob2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3Tm9kZSA9IHRoaXMuX19qb2luTm9kZShub2RlKTtcbiAgICAgICAgICAgICAgICBpZiAobmV3Tm9kZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgXHR0aGlzLmpvaW5Ob2RlRXZlbnQobmV3Tm9kZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEpvaW5zIGFsbCB0aGUgZ2l2ZW4gbm9kZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlcyAgIFRoZSBub2RlcyB0byBqb2luXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGpvaW5NdWx0aXBsZU5vZGUobm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGVzID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0gdGhpcy5fX2pvaW5Ob2RlKG5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3X25vZGVzLnB1c2gocmVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5qb2luTXVsdGlwbGVOb2Rlc0V2ZW50KG5ld19ub2Rlcyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIGFmdGVyIGEgc2luZ2xlIG5vZGUgaXMgam9pbmVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBuZXdOb2RlICBUaGUgbmV3IG5vZGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgam9pbk5vZGVFdmVudChuZXdOb2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIGFmdGVyIG11bHRpcGxlIG5vZGVzIGFyZSBqb2luZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBuZXdOb2RlcyAgVGhlIG5ldyBub2Rlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBqb2luTXVsdGlwbGVOb2Rlc0V2ZW50KG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgUG9saWN5OiBTcGxpdEpvaW5Ob2RlUG9saWN5XG4gICAgICAgIH1cbn1dKTtcblxuXG5cblxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3MnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbmV0d29ya3MnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICduZXR3b3JrTGlzdCdcbiAgICAgICAgfSkuXG4gICAgICAgICAgICBzdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3MuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnbmV0d29ya2RldGFpbHMnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtzLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnbmV0d29ya2NyZWF0ZSdcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIi8qKlxuICogVGhpcyBwb2xpY3kgaXMgdXNlZCB0byBjaGFuZ2UgdGhlIHZpZXcgdG8gZm9jdXMgb24gc3BsaXR0aW5nIGFuZCBcbiAqIGpvaW5pbmcgZXZlbnRzLlxuICogT3ZlcnJpZGVzIHRoZSBjZXJ0YWluIGZvcmNlIGxheW91dCBmdW5jdGlvbnMgb2YgdGhlIGdyYXBoIHRvIHBhcnRpdGlvbiBhIHNwbGl0XG4gKiBpbnRvIHRoZSBmb2N1c2VkIG5vZGVzIGFuZCB0aGUgY29ubmVjdGVkIG5vZGVzLlxuICogXG4gKiBIYXMgc2F2ZS9sb2FkIG1ldGhvZHMgZm9yIHRoZSBzYXZlIHN0YXRlIHBvbGljeS5cbiAqIEhhcyBiYWNrIGJ1dHRvbiBzdXBwb3J0LlxuICogQ2FuIGF1dG8gY2hhbmdlIHRoZSB0aXRsZSBvZiB0aGUgZ3JhcGguXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdTcGxpdEpvaW5WaWV3UG9saWN5JywgWydTcGxpdEpvaW5Ob2RlUG9saWN5JywgJ1Zpc3VhbGl6ZXJOb2RlJywgZnVuY3Rpb24gKFNwbGl0Sm9pbk5vZGVQb2xpY3ksIFZpc3VhbGl6ZXJOb2RlKSB7IFxuICAgICAgICBjbGFzcyBTcGxpdEpvaW5WaWV3UG9saWN5IGV4dGVuZHMgU3BsaXRKb2luTm9kZVBvbGljeS5Qb2xpY3l7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgICAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBvbGljeU5hbWUgPSBcIlNwbGl0Sm9pblZpZXdQb2xpY3lcIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5pdGlhbGl6ZShncmFwaCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3VwZXIuaW5pdGlhbGl6ZShncmFwaCk7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLnNhdmVkU3RhdGVzID0gW107XG4gICAgICAgICAgICAgICAgLy8gc3RhdGUuZm9jdXNHcm91cCA9IG51bGw7XG4gICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5ID0gW107XG4gICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMgPSBbXTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5mb2NpID0gW107XG4gICAgICAgICAgICAgICAgc3RhdGUuem9vbXMgPSB7fTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5sYXlvdXQgPSB7fTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5sYXlvdXREZWZhdWx0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS56b29tRGVmYXVsdCA9IG51bGw7XG4gICAgICAgICAgICAgICAgc3RhdGUubm9kZUlkc1RvUmVzaG93ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uRWxlbSA9IG51bGw7XG4gICAgICAgICAgICAgICAgc3RhdGUudGl0bGVFbGVtID0gbnVsbDtcblxuICAgICAgICAgICAgICAgIHZhciBjb25zdHMgPSBncmFwaC5jb25zdHMuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIGNvbnN0cy5ib3VuZGFyeSA9IDAuODtcblxuICAgICAgICAgICAgICAgIC8vb3ZlcnJpZGluZyBkM2ZvcmNlIG1ldGhvZHMgb2YgdGhlIGdyYXBoLlxuICAgICAgICAgICAgICAgIGdyYXBoLmQzRm9yY2VCb3VuZHMgPSB0aGlzLmQzRm9yY2VCb3VuZHM7XG4gICAgICAgICAgICAgICAgZ3JhcGguZDNGb3JjZVRpY2sgPSB0aGlzLmQzRm9yY2VUaWNrO1xuICAgICAgICAgICAgICAgIGdyYXBoLmQzRm9yY2VTdGFydCA9IHRoaXMuZDNGb3JjZVN0YXJ0O1xuICAgICAgICAgICAgICAgIGdyYXBoLmQzRm9yY2VFbmQgPSB0aGlzLmQzRm9yY2VFbmQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogTGlua3MgdGhlIHByb3ZpZGVkIGVsZW1lbnQgYSBiYWNrIGJ1dHRvbiBmZWF0dXJlXG4gICAgICAgICAgICAgKiBEb2Vzbid0IHRyaWdnZXIgdGhlIG9uLWNsaWNrIGV2ZW50XG4gICAgICAgICAgICAgKiBUaGF0IHNob3VsZCBiZSBkb25lIHRocm91Z2ggYW5ndWxhciBuZy1jbGljay5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7alF1ZXJ5fSAgZWxlbSAgICBUaGUganF1ZXJ5IHNlbGVjdGVkIGVsZW1lbnRcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5zdGFsbEJhY2tCdXR0b24oZWxlbSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5ID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIHN0YXRlLmJhY2tCdXR0b25FbGVtID0gZWxlbTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51bmRvTGFzdEV2ZW50LmNhbGwodGhpc1BvbGljeSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2lsbCBhbGxvdyB0aGlzIHBvbGljeSB0byBjaGFuZ2UgdGhlIHRpdGxlIG9mIHRoZSBncmFwaFxuICAgICAgICAgICAgICogYXMgc3BsaXQgYW5kIGpvaW4gZXZlbnRzIG9jY3VyLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtqUXVlcnl9ICBlbGVtICAgIFRoZSBqcXVlcnkgc2VsZWN0ZWQgZWxlbWVudFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbnN0YWxsVGl0bGUoZWxlbSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgc3RhdGUudGl0bGVFbGVtID0gZWxlbTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgYmVpbmcgZGVzdHJveWVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIHNhdmVkU3RhdGUgIEFueSBwcm9wZXJ0eSBvbiB0aGlzXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0IHdpbGwgYmUgYWNjZXNzaWJsZVxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gdGhlIHZpZXcgcmVsb2Fkc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkZXN0cm95KHNhdmVkU3RhdGUpIHtcbiAgICAgICAgICAgICAgICAvL09ubHkgaWYgdGhlIHNhdmUgc3RhdGUgcG9saWN5IGlzIGluc3RhbGxlZFxuICAgICAgICAgICAgICAgIGlmIChzYXZlZFN0YXRlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zYXZlKHNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBXaWxsIHNhdmUgdGhlIGN1cnJlbnQgc3RhdGUsIGFuZCBhbGwgaGlzdG9yeS5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgc2F2ZWRTdGF0ZSAgQW55IHByb3BlcnR5IG9uIHRoaXNcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3Qgd2lsbCBiZSBhY2Nlc3NpYmxlXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiB0aGUgdmlldyByZWxvYWRzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNhdmUoc2F2ZWRTdGF0ZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgICAgIHZhciBsaW5rcyA9IHRoaXNHcmFwaC5saW5rcztcbiAgICAgICAgICAgICAgICB2YXIgY3VyclRpdGxlID0gbnVsbDtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUudGl0bGVFbGVtICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgY3VyclRpdGxlID0gc3RhdGUudGl0bGVFbGVtLnRleHQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGZvY3VzR3JvdXBzID0gc3RhdGUuZm9jdXNHcm91cHM7XG4gICAgICAgICAgICAgICAgdmFyIGV2ZW50SGlzdG9yeSA9IHN0YXRlLmV2ZW50SGlzdG9yeTtcbiAgICAgICAgICAgICAgICB2YXIgem9vbXMgPSBzdGF0ZS56b29tcztcbiAgICAgICAgICAgICAgICB2YXIgbGF5b3V0ID0gc3RhdGUubGF5b3V0O1xuXG4gICAgICAgICAgICAgICAgdmFyIGxheW91dERlZmF1bHQgPSBzdGF0ZS5sYXlvdXREZWZhdWx0O1xuICAgICAgICAgICAgICAgIHZhciB6b29tRGVmYXVsdCA9IHN0YXRlLnpvb21EZWZhdWx0O1xuICAgICAgICAgICAgICAgIHZhciByZXQgPSB7bm9kZXM6bm9kZXMsIGxpbmtzOmxpbmtzLCBcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVzOnN0YXRlLnNhdmVkU3RhdGVzLCBjdXJyVGl0bGU6Y3VyclRpdGxlLCBcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNHcm91cHM6IGZvY3VzR3JvdXBzLFxuICAgICAgICAgICAgICAgICAgICBldmVudEhpc3Rvcnk6ZXZlbnRIaXN0b3J5LCB6b29tczp6b29tcyxcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0OmxheW91dCwgbGF5b3V0RGVmYXVsdDpsYXlvdXREZWZhdWx0LFxuICAgICAgICAgICAgICAgICAgICB6b29tRGVmYXVsdDp6b29tRGVmYXVsdH07XG4gICAgICAgICAgICAgICAgc2F2ZWRTdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5ID0gcmV0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgYmUgY2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIHJlbG9hZGVkLCBhc3N1bWluZ1xuICAgICAgICAgICAgICogc2F2ZSBzdGF0ZSBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGxvYWRTdGF0ZSAgQ29udGFpbnMgYWxsIHRoZSBzYXZlZFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFibGVzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGxvYWQobG9hZFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgbG9hZFN0YXRlID0gbG9hZFN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG4gICAgICAgICAgICAgICAgc3RhdGUuc2F2ZWRTdGF0ZXMgPSBsb2FkU3RhdGUuc3RhdGVzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IGxvYWRTdGF0ZS5saW5rcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMgPSBsb2FkU3RhdGUubm9kZXM7XG5cbiAgICAgICAgICAgICAgICB2YXIgY3VyclRpdGxlID0gbG9hZFN0YXRlLmN1cnJUaXRsZTtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUudGl0bGVFbGVtICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUudGl0bGVFbGVtLnRleHQoY3VyclRpdGxlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5ID0gbG9hZFN0YXRlLmV2ZW50SGlzdG9yeTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3VwcyA9IGxvYWRTdGF0ZS5mb2N1c0dyb3VwcztcbiAgICAgICAgICAgICAgICBzdGF0ZS56b29tcyA9IGxvYWRTdGF0ZS56b29tcztcbiAgICAgICAgICAgICAgICBzdGF0ZS5sYXlvdXQgPSBsb2FkU3RhdGUubGF5b3V0O1xuICAgICAgICAgICAgICAgIHN0YXRlLmxheW91dERlZmF1bHQgPSBsb2FkU3RhdGUubGF5b3V0RGVmYXVsdDtcbiAgICAgICAgICAgICAgICBzdGF0ZS56b29tRGVmYXVsdCA9IGxvYWRTdGF0ZS56b29tRGVmYXVsdDtcblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5iYWNrQnV0dG9uRWxlbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuYmFja0J1dHRvbkVsZW0uZmFkZVRvKCdzbG93JywgMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuXG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF8uaW5jbHVkZXMoY2hpbGRyZW5fc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzBdXSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5pZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJmb2N1c1wiO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImNvbm5lY3RlZFwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvL2xvYWRpbmcgYSBwcmV2aW91cyBsYXlvdXRcbiAgICAgICAgICAgICAgICB2YXIgbGF5b3V0O1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ID0gc3RhdGUubGF5b3V0RGVmYXVsdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSBzdGF0ZS56b29tRGVmYXVsdDsgXG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQoem9vbVswXSwgem9vbVsxXSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSBzdGF0ZS56b29tc1tzdGF0ZS5mb2N1c0dyb3Vwc107XG4gICAgICAgICAgICAgICAgICAgIGlmICh6b29tICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQoem9vbVswXSwgem9vbVsxXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ID0gc3RhdGUubGF5b3V0W3N0YXRlLmZvY3VzR3JvdXBzXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL2xheW91dCBjYW4ndCBiZSBudWxsXG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24obikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcG9zID0gbGF5b3V0W24uaWRdO1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9zID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGxheW91dCwgbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbi54ID0gcG9zLng7XG4gICAgICAgICAgICAgICAgICAgIG4ueSA9IHBvcy55O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZS5pbml0Rm9yY2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaC5jYWxsKHRoaXNHcmFwaCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kudXBkYXRlR3JhcGhDYWxsYmFjay5jYWxsKHRoaXNQb2xpY3kpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRyaWdnZXJpbmcgc3BsaXQgb24gZG91YmxlIGNsaWNrXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEZvY3VzIGdyb3VwIHN0b3JlcyB0aGUgbm9kZSB0aGF0IGlzIGFib3V0IHRvIGJlIHNwbGl0LlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBXaGVuIGZvY3VzIGdyb3VwIGhhcyBsZW5ndGggMCwgdGhlIGZpcnN0IHNwbGl0IFxuICAgICAgICAgICAgICogd2lsbCBqdXN0IGJlIHB1c2hlZCBvbi5cbiAgICAgICAgICAgICAqIFRoZSBub2RlIHdpbGwgYmUgc3BsaXQgYW5kIHB1c2hlZCB0byB0aGUgdG9wIGhhbGYgXG4gICAgICAgICAgICAgKiBvZiB0aGUgc2NyZWVuLCBhbmQgdGhlIGJvdHRvbSBoYWxmIHdpbGwgY29udGFpbiBhbnlcbiAgICAgICAgICAgICAqIG5vZGVzIGl0IGhhcyBjb25uZWN0aW9ucyB0by5cbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogV2hlbiBhIGZvY3VzIGdyb3VwIGxlbmd0aCBpcyA+PSAxLCBpZiB0aGUgbm9kZSB0byBiZVxuICAgICAgICAgICAgICogc3BsaXQgaXMgYSBmb2N1cyBub2RlLCBpdCB3aWxsIHJlcGxhY2UgZm9jdXNHcm91cHNbMF0gYW5kXG4gICAgICAgICAgICAgKiB0aGUgdG9wIGhhbGYgd2lsbCBiZSBpdHMgY2hpbGRyZW4sIGFuZCBib3R0b20gaGFsZiB3aWxsXG4gICAgICAgICAgICAgKiBiZSB0aGUgbm9kZXMgaXQgaGFzIGNvbm5lY3Rpb25zIHRvLlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBJZiB0aGUgc3BsaXQgaXMgaW4gdGhlIGJvdHRvbSBoYWxmLCB0aGVuIHRoZSBib3R0b20gaGFsZlxuICAgICAgICAgICAgICogd2lsbCBkaXNwbGF5IGl0J3MgY2hpbGRyZW4gYW5kIHdpbGwgb25seSBzaG93IGNvbm5lY3Rpb25zIGJldHdlZW5cbiAgICAgICAgICAgICAqIHRoZSB0d28gZ3JvdXBzLCBhbmQgd2lsbCByZXBsYWNlIGZvY3VzR3JvdXBzWzFdLlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmp9ICAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGQgICAgICAgVGhlIG1hdGNoaW5nIGRhdGEgb2JqZWN0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGRibGNsaWNrKGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgLy9jaGVjayBpZiBjYW4gc3BsaXRcbiAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IGQuaWQ7XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRyZW5fc3RydWN0W25hbWVdID09PSB1bmRlZmluZWQgfHwgXy5pc0VtcHR5KGNoaWxkcmVuX3N0cnVjdFtuYW1lXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzLnNsaWNlKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAwKSB7IC8vdG9wbGV2ZWwgc3BsaXRcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMucHVzaChkLmlkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKF8uaW5jbHVkZXMoY2hpbGRyZW5fc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzBdXSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQuaWQpKSB7IC8vc3BsaXR0aW5nIGEgZm9jdXMgbm9kZVxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwc1swXSA9IGQuaWQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDEpIHsvL3NwbGl0dGluZyBhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2Nvbm5lY3RlZCBub2RlXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzLnB1c2goZC5pZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChfLmluY2x1ZGVzKGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1sxXV0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQuaWQpKSB7Ly9zcGxpdHRpbmcgYVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29ubmVjdGVkIG5vZGVcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHNbMV0gPSBkLmlkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMiAmJiBcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzWzFdID09PSBkLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vU3BsaXR0aW5nIGEgY29ubmVjdGVkIG5vZGUsIGtlZXAgYWxsIGZvY3VzIG5vZGVzXG4gICAgICAgICAgICAgICAgICAgIHZhciBub2Rlc1RvS2VlcCA9IFtkXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVJZHNUb1Jlc2hvdyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ3JvdXBPbmVOb2RlcyA9IGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV07XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKGdyb3VwT25lTm9kZXMsIG5vZGUuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlkc1RvUmVzaG93LnB1c2gobm9kZS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNUb0tlZXAucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy9NYWtlIHNwbGl0IG5vZGVzIHRoZSBmb2N1cyBhbmQga2VlcCBub2RlcyB0aGF0IGFyZSBjb25uZWN0ZWRcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVzVG9LZWVwID0gW2RdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZUlkc1RvUmVzaG93ID0gW107XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubGlua3MsIGZ1bmN0aW9uKGxpbmspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaW5rLnNvdXJjZSA9PT0gZCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzVG9SZXNob3cuaW5kZXhPZihsaW5rLnRhcmdldC5pZCkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rLnRhcmdldC5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluay50YXJnZXQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzVG9SZXNob3cucHVzaChsaW5rLnRhcmdldC5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNUb0tlZXAucHVzaChsaW5rLnRhcmdldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxpbmsudGFyZ2V0ID09PSBkICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzVG9SZXNob3cuaW5kZXhPZihsaW5rLnNvdXJjZS5pZCkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rLnNvdXJjZS5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluay5zb3VyY2UuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzVG9SZXNob3cucHVzaChsaW5rLnNvdXJjZS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNUb0tlZXAucHVzaChsaW5rLnNvdXJjZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vUmVtb3ZpbmcgbGlua3MgZnJvbSB0aGUgbm9kZSB0byBiZSBzcGxpdFxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2goZnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5pZCAhPT0gZC5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuXG4gICAgICAgICAgICAgICAgLy9kaXNhYmxpbmcgdXBkYXRlIGdyYXBoIHRvIHByZXZlbnQgbmV3IGRhdGEgZnJvbVxuICAgICAgICAgICAgICAgIC8vcmVkcmF3aW5nIGxpbmtzIHdoaWxlIHRoZXJlIGFyZSBhbmltYXRpb25zIGdvaW5nIG9uXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN0YXRlLmRpc2FibGVVcGRhdGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2goZnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5pZCAhPT0gZC5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLnRyYW5zaXRpb24oKS5kZWxheSgyMDApLmR1cmF0aW9uKDQwMCkuc3R5bGUoXCJvcGFjaXR5XCIsIDApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9kaXNhYmxpbmcgcXRpcCBpZiBpbnN0YWxsZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkKHRoaXMpLnF0aXAgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykucXRpcCgnZGlzYWJsZScsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgdHJhbnNsYXRlID0gdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKCk7XG4gICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKTtcbiAgICAgICAgICAgICAgICB2YXIgeExvYyA9IChwYXJzZUZsb2F0KHRoaXNHcmFwaC5zdmcuc3R5bGUoXCJ3aWR0aFwiKSkgLyBzY2FsZSkgLyAyICArIHRyYW5zbGF0ZVswXTtcbiAgICAgICAgICAgICAgICB2YXIgeUxvYyA9IChwYXJzZUZsb2F0KHRoaXNHcmFwaC5zdmcuc3R5bGUoXCJoZWlnaHRcIikpIC8gc2NhbGUpLyAyICArIHRyYW5zbGF0ZVsxXTtcbiAgICAgICAgICAgICAgICBkLnhTdGFydCA9IGQueDtcbiAgICAgICAgICAgICAgICBkLnlTdGFydCA9IGQueTtcbiAgICAgICAgICAgICAgICBkLnggPSB4TG9jO1xuICAgICAgICAgICAgICAgIGQueSA9IHlMb2M7XG4gICAgICAgICAgICAgICAgZDNub2RlLnRyYW5zaXRpb24oXCJub2RlUG9zaXRpb25UcmFuc2l0aW9uXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZHVyYXRpb24oNzUwKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHJUd2VlbihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHhTdGFydCA9IGQueFN0YXJ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB5U3RhcnQgPSBkLnlTdGFydDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnhTdGFydCA9IGQueDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnlTdGFydCA9IGQueTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZDMuaW50ZXJwb2xhdGVTdHJpbmcoXCJ0cmFuc2xhdGUoXCIgKyB4U3RhcnQgKyBcIixcIiArIHlTdGFydCArIFwiKVwiLCBcInRyYW5zbGF0ZShcIiArIGQueCArIFwiLFwiICsgZC55ICsgXCIpXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3BsaXROb2RlRnVuYyA9IHN1cGVyLnNwbGl0Tm9kZTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5ub2RlSWRzVG9SZXNob3cgPSBub2RlSWRzVG9SZXNob3c7XG4gICAgICAgICAgICAgICAgLy93YWl0aW5nIGZvciBub2RlIHRyYW5zaXRpb25cbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzID0gbm9kZXNUb0tlZXA7XG4gICAgICAgICAgICAgICAgICAgIHNwbGl0Tm9kZUZ1bmMuY2FsbCh0aGlzUG9saWN5LCBkKTtcbiAgICAgICAgICAgICAgICB9LCA3NTApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRvIGJlIGNhbGxlZCBhZnRlciB0aGUgZ3JhcGggaXMgc3BsaXQuXG4gICAgICAgICAgICAgKiBCcmluZ3MgYWxsIG5vZGVzIGJhY2sgaW50byB2aWV3IGFuZCBzZXRzIHRoZWlyIGF0dHJpYnV0ZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlR3JhcGhDYWxsYmFjaygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5lYWNoKGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS50cmFuc2l0aW9uKCkuZHVyYXRpb24oNDAwKS5zdHlsZShcIm9wYWNpdHlcIiwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykuY2xhc3NlZChcImZvY3VzXCIsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5jbGFzc2VkKFwiY29ubmVjdGVkXCIsIGZhbHNlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuU3BsaXRKb2luVmlld1BvbGljeSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID09PSBcImZvY3VzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLmNsYXNzZWQoXCJmb2N1c1wiLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vZGUuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID09PSBcImNvbm5lY3RlZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5jbGFzc2VkKFwiY29ubmVjdGVkXCIsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgc3RhdGUubm9kZUlkc1RvUmVzaG93ID0gbnVsbDtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSYW5kb21seSBzZXRzIHRoZSBwb3NpdGlvbnMgb2YgYW55IHVuc2V0IG5vZGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc2V0UG9zaXRpb25zKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5ID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGhDb25zdHMgPSB0aGlzR3JhcGguY29uc3RzO1xuXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IGdyYXBoQ29uc3RzLmRpc3BsYXlPZmZzZXQ7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgICAgIHZhciByZXQgPSB0aGlzUG9saWN5LmQzRm9yY2VCb3VuZHMuY2FsbCh0aGlzR3JhcGgpO1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0UmFuZG9tSW50KG1pbiwgbWF4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluICsgMSkpICsgbWluO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIF8uZm9yRWFjaChub2RlcywgZnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS54ID09IG51bGwgfHwgbm9kZS55ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4ID0gZ2V0UmFuZG9tSW50KG5vZGUucmFkaXVzICsgb2Zmc2V0LCByZXQud2lkdGggLSBub2RlLnJhZGl1cyAtIG9mZnNldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgeSA9IGdldFJhbmRvbUludChub2RlLnJhZGl1cyArIG9mZnNldCwgcmV0LmhlaWdodCAtIG5vZGUucmFkaXVzIC0gb2Zmc2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUueCA9IHg7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLnkgPSB5O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgb24gdGhlIHN0YXJ0IG9mIHRoZSBkMyBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKiBXaWxsIG92ZXJyaWRlIHRoZSBtZXRob2Qgb2YgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKiBcInRoaXNcIiBwb2ludHMgdG8gdGhlIGdyYXBoXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGQzRm9yY2VTdGFydCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlc1xuICAgICAgICAgICAgICAgICAgICAuYXR0cignY3gnLCBmdW5jdGlvbihkKSB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQueFN0YXJ0ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnhTdGFydCA9IChkLnhTdGFydCAqIHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCkpICsgdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKClbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC54O1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY3knLCBmdW5jdGlvbihkKSB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQueVN0YXJ0ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnlTdGFydCA9IChkLnlTdGFydCAqdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKSkgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKVsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd4MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLnk7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd4MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lnk7IH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBvbiB0aGUgc3RhcnQgb2YgdGhlIGQzIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqIFdpbGwgb3ZlcnJpZGUgdGhlIG1ldGhvZCBvZiB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqIFwidGhpc1wiIHBvaW50cyB0byB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZUVuZCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5ID0gc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGVQb2xpY3kubGF5b3V0RGVmYXVsdCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWZhdWx0TGF5b3V0ID0ge307XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRMYXlvdXRbbi5pZF0gPSB7eDpuLngsIHk6bi55fTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5LmxheW91dERlZmF1bHQgPSBkZWZhdWx0TGF5b3V0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2NhbGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdHJhbnNsYXRlID0gdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5Lnpvb21EZWZhdWx0ID0gW3RyYW5zbGF0ZSwgc2NhbGVdOyBcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlc1xuICAgICAgICAgICAgICAgICAgICAuYXR0cignY3gnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjeScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQueTsgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHMuYXR0cigneDEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS55OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneDInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC55OyB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBXaWxsIGJlIGNhbGxlZCBkdXJpbmcgRDMgZm9yY2Ugc2ltdWxhdGlvbnNcbiAgICAgICAgICAgICAqIGJ5IHRoZSBncmFwaCwgc28gXCJ0aGlzXCIgd2lsbCBwb2ludCB0byB0aGUgZ3JhcGggb2JqZWN0XG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge251bWJlcn0gIHdpZHRoICAgRDMgTGF5b3V0IFdpZHRoXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgaGVpZ2h0ICBEMyBMYXlvdXQgSGVpZ2h0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGQzRm9yY2VUaWNrKGUsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5ID0gc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSBjb25zdHMuZGlzcGxheU9mZnNldDtcbiAgICAgICAgICAgICAgICB2YXIgc2NhbGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpO1xuXG4gICAgICAgICAgICAgICAgLy8gTW92ZSBub2RlcyB0b3dhcmQgY2x1c3RlciBmb2N1cy5cbiAgICAgICAgICAgICAgICB2YXIgZm9jaSA9IHN0YXRlUG9saWN5LmZvY2k7XG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ3Jhdml0eShhbHBoYSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZvY2kubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID09PSBcImZvY3VzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55ICs9IChmb2NpWzBdIC0gZC55KSAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSArPSAoZm9jaVsxXSAtIGQueSkgKiBhbHBoYTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC54ICs9ICh3aWR0aC8yIC0gZC54KSAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gKGhlaWdodC8yIC0gZC55KSAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCArPSAod2lkdGgvMiAtIGQueCkgKiBhbHBoYTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBNYWtlIHN1cmUgbm9kZXMgYXJlIHdpdGhpbiBib3VuZHNcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlc1xuICAgICAgICAgICAgICAgICAgICAuZWFjaCh0aGlzLmQzRm9yY2VDb2xsaWRlKC41KSlcbiAgICAgICAgICAgICAgICAgICAgLmVhY2goZ3Jhdml0eSguMiAqIGUuYWxwaGEpKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcImN4XCIsIGZ1bmN0aW9uKGQpIHsgXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC54ID0gTWF0aC5tYXgoKGQucmFkaXVzICsgb2Zmc2V0KS9zY2FsZSwgTWF0aC5taW4od2lkdGggKyAoKC1vZmZzZXQtIGQucmFkaXVzKSAvIHNjYWxlKSwgZC54KSk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiY3lcIiwgZnVuY3Rpb24oZCkgeyBcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLlNwbGl0Sm9pblZpZXdQb2xpY3kgPT0gbnVsbCB8fCBkLlNwbGl0Sm9pblZpZXdQb2xpY3kgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSA9IE1hdGgubWF4KChkLnJhZGl1cyArIG9mZnNldCkvc2NhbGUsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5taW4oaGVpZ2h0ICsgKCgtb2Zmc2V0IC0gZC5yYWRpdXMpL3NjYWxlKSwgZC55KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPT09IFwiZm9jdXNcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSA9IE1hdGgubWF4KGQucmFkaXVzICsgb2Zmc2V0LCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgubWluKChoZWlnaHQgKyAoKC1vZmZzZXQgLSBkLnJhZGl1cykvc2NhbGUpKSpjb25zdHMuU3BsaXRKb2luVmlld1BvbGljeS5ib3VuZGFyeSwgZC55KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPT09IFwiY29ubmVjdGVkXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgPSBNYXRoLm1heCgoaGVpZ2h0ICsgKChvZmZzZXQgLSBkLnJhZGl1cykvc2NhbGUpKSAqY29uc3RzLlNwbGl0Sm9pblZpZXdQb2xpY3kuYm91bmRhcnksIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5taW4oaGVpZ2h0ICsgKCgtb2Zmc2V0IC0gZC5yYWRpdXMpL3NjYWxlKSwgZC55KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHNcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueTsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueTsgfSk7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxjdWxhdGVzIHRoZSBib3VuZGFyaWVzIG9mIHRoZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIFdpbGwgYmUgY2FsbGVkIGR1cmluZyBEMyBmb3JjZSBzaW11bGF0aW9uc1xuICAgICAgICAgICAgICogYnkgdGhlIGdyYXBoLCBzbyBcInRoaXNcIiB3aWxsIHBvaW50IHRvIHRoZSBncmFwaCBvYmplY3RcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHJldHVybiAgICAge09iamVjdH0gICAgICAgICAgUmV0dXJucyBhbiBvYmplY3RcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQgaGFzIHRoZSB3aWR0aFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5kIGhlaWdodCBhcyBcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXMgXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGQzRm9yY2VCb3VuZHMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzLFxuICAgICAgICAgICAgICAgICAgICBjb25zdHNQb2xpY3kgPSBjb25zdHMuU3BsaXRKb2luVmlld1BvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kgPSBzdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXNHcmFwaC5ub2RlcztcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjYWxjTWF4Tm9kZXMod2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYXJlYSA9IHdpZHRoICogaGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmFkaXVzID0gdGhpc0dyYXBoLmNvbnN0cy5zdGFydFJhZGl1cztcbiAgICAgICAgICAgICAgICAgICAgLy90cmVhdGluZyB0aGVtIGFzIGEgc3F1YXJlIGZvciBhcHByb3hcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxlbmd0aCA9IChyYWRpdXMgKjMuNSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhbW91bnQgPSBhcmVhIC8obGVuZ3RoICpsZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYW1vdW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL1RoZSBvZmZzZXQgaXMgdGhlIGJ1ZmZlciBmcm9tIHRoZSBlZGdlc1xuICAgICAgICAgICAgICAgIC8vT3JpZ2luYWwgV2lkdGggYW5kIEhlaWdodCBhcmUgZ2l2ZW4gdG8gdGhlIGZvcmNlIGxheW91dFxuICAgICAgICAgICAgICAgIC8vc28gdGhhdCBpdCBpcyBjZW50ZXJlZCwgYnV0IG5vZGVzIHdpbGwgYmUgZm9yY2VkIHRvIGJlXG4gICAgICAgICAgICAgICAgLy93aXRoaW4gdGhlIG9mZnNldCBib3VuZHNcbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gY29uc3RzLmRpc3BsYXlPZmZzZXQ7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z1dpZHRoID0gcGFyc2VGbG9hdCh0aGlzR3JhcGguc3ZnLnN0eWxlKFwid2lkdGhcIikpO1xuICAgICAgICAgICAgICAgIHZhciBzdmdIZWlnaHQgPSBwYXJzZUZsb2F0KHRoaXNHcmFwaC5zdmcuc3R5bGUoXCJoZWlnaHRcIikpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gc3ZnV2lkdGg7XG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IHN2Z0hlaWdodDtcblxuICAgICAgICAgICAgICAgIHZhciBhbW91bnQgPSBjYWxjTWF4Tm9kZXMod2lkdGggLSAoMipvZmZzZXQpLCBoZWlnaHQgLSAoMipvZmZzZXQpKTtcbiAgICAgICAgICAgICAgICB2YXIgc2NhbGUgPSAxO1xuICAgICAgICAgICAgICAgIGlmIChub2Rlcy5sZW5ndGggPiBhbW91bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NhbGUgPSBhbW91bnQgLyBub2Rlcy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQodGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKCksIHNjYWxlKTtcbiAgICAgICAgICAgICAgICAgICAgd2lkdGggLz0gc2NhbGU7XG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCAvPSBzY2FsZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguem9vbWVkKHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpLCBzY2FsZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9jYWxjdWxhdGluZyBmb2NpIGZvciBzaW11bGF0aW9uXG4gICAgICAgICAgICAgICAgdmFyIGZvY3VzR3JvdXBzID0gc3RhdGVQb2xpY3kuZm9jdXNHcm91cHM7XG4gICAgICAgICAgICAgICAgdmFyIGZvY2k7XG4gICAgICAgICAgICAgICAgaWYgKGZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBmb2NpID0gW2hlaWdodC8yXTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL3NldHRpbmcgZm9jaSBoZWlnaHQgcG9zaXRpb24gYmFzZWQgb24gcGVyY2VudGFnZVxuICAgICAgICAgICAgICAgICAgICB2YXIgZm9jdXNOb2RlcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFtmb2N1c0dyb3Vwc1swXV07XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0c1BvbGljeS5ib3VuZGFyeSA9IGZvY3VzTm9kZXMubGVuZ3RoIC8gbm9kZXMubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdG9wID0gaGVpZ2h0ICogY29uc3RzUG9saWN5LmJvdW5kYXJ5O1xuICAgICAgICAgICAgICAgICAgICB2YXIgYm90ID0gaGVpZ2h0IC0gdG9wO1xuICAgICAgICAgICAgICAgICAgICBpZiAodG9wIDwgMip0aGlzR3JhcGguY29uc3RzLm1heFJhZGl1cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3RzUG9saWN5LmJvdW5kYXJ5ID0gKDIuNSAqIHRoaXNHcmFwaC5jb25zdHMubWF4UmFkaXVzKSAvIGhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvcCA9IGhlaWdodCAqIGNvbnN0c1BvbGljeS5ib3VuZGFyeTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvdCA9IGhlaWdodCAtIHRvcDtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChib3QgPCAyKiB0aGlzR3JhcGguY29uc3RzLm1heFJhZGl1cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3RzUG9saWN5LmJvdW5kYXJ5ID0gMSAtICgoMi41ICogdGhpc0dyYXBoLmNvbnN0cy5tYXhSYWRpdXMpIC8gaGVpZ2h0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvcCA9IGhlaWdodCAqIGNvbnN0c1BvbGljeS5ib3VuZGFyeTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvdCA9IGhlaWdodCAtIHRvcDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmb2NpID0gW3RvcC8yLCB0b3AgKyBib3QgLyAyXTtcblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdGF0ZVBvbGljeS5mb2NpID0gZm9jaTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge3dpZHRoOndpZHRoLCBoZWlnaHQ6aGVpZ2h0fTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgYWZ0ZXIgYSBzaW5nbGUgbm9kZSBpcyBzcGxpdFxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBuZXdOb2RlcyAgVGhlIG5ldyBub2Rlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzcGxpdE5vZGVFdmVudChuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKG5ld05vZGVzLCBmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV0sIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiZm9jdXNcIjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIHRpdGxlID0gbmV3Tm9kZXNbMF0ucGFyZW50O1xuICAgICAgICAgICAgICAgIC8vIHN0YXRlLmZvY3VzR3JvdXAgPSB0aXRsZTtcblxuICAgICAgICAgICAgICAgIC8vaWYgdGhlIGxhc3QgZXZlbnQgaGFzIHRoZSBzYW1lIGlkLCBpdCBtdXN0IGJlIHRoZVxuICAgICAgICAgICAgICAgIC8vb3BwcG9zaXRlIG9mIHRoaXMgZXZlbnQsIHNvIHdlIHJlbW92ZSB0aGF0IGV2ZW50IGZyb21cbiAgICAgICAgICAgICAgICAvL3RoZSBldmVudCBzdGFjay5cbiAgICAgICAgICAgICAgICAvL090aGVyd2lzZSwgd2UgYWRkIHRoZSBldmVudCBvdCB0aGUgc3RhY2tcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCAhPT0gMCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5W3N0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggLSAxXS5pZCA9PT0gdGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5LnBvcCgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeS5wdXNoKHtpZDp0aXRsZSwgZXZlbnQ6J3NwbGl0J30pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5iYWNrQnV0dG9uRWxlbSAhPSBudWxsICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuYmFja0J1dHRvbkVsZW0uZmFkZVRvKCdzbG93JywgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS50aXRsZUVsZW0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ICs9IHN0YXRlLmZvY3VzR3JvdXBzWzBdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0gJyAmICcgKyBzdGF0ZS5mb2N1c0dyb3Vwc1sxXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS50aXRsZUVsZW0udGV4dCh0ZXh0KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3JlLWVuYWJsZSBncmFwaCB1cGRhdGVcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3RhdGUuZGlzYWJsZVVwZGF0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kuc2V0TGF5b3V0KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU2V0cyB0aGUgbGF5b3V0IG9mIHRoZSBub2Rlcy4gXG4gICAgICAgICAgICAgKiBJZiB0aGVyZSBpcyBhIHByZXZpb3VzIGxheW91dCwgaXQgd2lsbCBiZSBsb2FkZWQuXG4gICAgICAgICAgICAgKiBFbHNlLCBpdCB3aWxsIHJ1biBhIEQzIEZvcmNlIHNpbXVsYXRpb24gYW5kIGNyZWF0ZSBvbmUuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNldExheW91dCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG4gICAgICAgICAgICAgICAgdmFyIGxheW91dDtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGxheW91dCA9IHN0YXRlLmxheW91dERlZmF1bHQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciB6b29tID0gc3RhdGUuem9vbURlZmF1bHQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQoem9vbVswXSwgem9vbVsxXSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSBzdGF0ZS56b29tc1tzdGF0ZS5mb2N1c0dyb3Vwc107XG4gICAgICAgICAgICAgICAgICAgIGlmICh6b29tICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQoem9vbVswXSwgem9vbVsxXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ID0gc3RhdGUubGF5b3V0W3N0YXRlLmZvY3VzR3JvdXBzXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAobGF5b3V0ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24obikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvcyA9IGxheW91dFtuLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwb3MgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGxheW91dCwgbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBuLnggPSBwb3MueDtcbiAgICAgICAgICAgICAgICAgICAgICAgIG4ueSA9IHBvcy55O1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoLmNhbGwodGhpc0dyYXBoLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kudXBkYXRlR3JhcGhDYWxsYmFjay5jYWxsKHRoaXNQb2xpY3kpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL05lZWQgdG8gcnVuIGEgZm9yY2Ugc2ltdWxhdGlvbiBhcyB0aGlzIGxheW91dFxuICAgICAgICAgICAgICAgICAgICAvL2hhc24ndCBiZWVuIGRvbmUgYmVmb3JlXG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZS5pbml0Rm9yY2UgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhpc1BvbGljeS5zZXRQb3NpdGlvbnMoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51cGRhdGVHcmFwaENhbGxiYWNrLmNhbGwodGhpc1BvbGljeSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS56b29tc1tzdGF0ZS5mb2N1c0dyb3Vwc10gPSBbdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCldO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGF5b3V0ID0ge307XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dFtuLmlkXSA9IHt4Om4ueCwgeTpuLnl9O1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUubGF5b3V0W3N0YXRlLmZvY3VzR3JvdXBzXSA9IGxheW91dDtcbiAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIE92ZXJyaWRpbmcgZnJvbSBzdXBlciBjbGFzcyBzbyB0aGF0IHdlIGNhbiBoYXZlXG4gICAgICAgICAgICAgKiB0b3AgbGV2ZWwgbm9kZXMgcmVhcHBlYXIgd2hlbiB0aGV5IGFyZSBoaWRkZW5cbiAgICAgICAgICAgICAqIGR1ZSB0byB0aGVyZSBiZWluZyB0d28gZm9jdXMgZ3JvdXBzLlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gICAgICAgICAgbm9kZSAgICBUaGUgbm9kZSB0byBqb2luXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7Tm9kZX0gIFRoZSBuZXcgbm9kZSBhZnRlciB0aGUgam9pblxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBfX2pvaW5Ob2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVTdXBlciA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5Ob2RlUG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgLy9jaGVjayB0aGF0IG5vZGUgc3RpbGwgZXhpc3RzXG4gICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG5vZGUpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gbm9kZS5pZDtcbiAgICAgICAgICAgICAgICAvL2lmIGl0IGhhcyBubyBhbmNlc3Rvciwgbm90aGluZyB0byBqb2luXG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbC5pbmRleE9mKG5hbWUpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBub2RlLnBhcmVudDtcbiAgICAgICAgICAgICAgICB2YXIgdG9fYmVfZGVsZXRlZCA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBub2RlTmFtZVNldCA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpc0dyYXBoLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgbm9kZSB3b24ndCBiZSBjb2xsYXBzZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5ub2Rlc1tpXS5hbmNlc3RvcnMuaW5kZXhPZihub2RlLnBhcmVudCkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVOYW1lU2V0LnB1c2godGhpc0dyYXBoLm5vZGVzW2ldLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvX2JlX2RlbGV0ZWQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZV9pZCA9IG5vZGUucGFyZW50O1xuICAgICAgICAgICAgICAgIG5vZGVOYW1lU2V0LnB1c2gobm9kZS5wYXJlbnQpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFuY2VzdG9yc19zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5hbmNlc3RvcnNfc3RydWN0O1xuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgLy8gLSBzZXR0aW5nIGZvY3VzR3JvdXBzIC1cbiAgICAgICAgICAgICAgICAvL2VpdGhlciByZXBsYWNpbmcgb25lIG9mIHRoZSBncm91cHMsXG4gICAgICAgICAgICAgICAgLy9vciBqb2luaW5nIGJhY2sgaW50byBhIHRvcCBsZXZlbCwgc28gdGhlcmUgaXMgb25seVxuICAgICAgICAgICAgICAgIC8vb25lIGZvY3VzXG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gc3RhdGUuZm9jdXNHcm91cHMuaW5kZXhPZihwYXJlbnQpO1xuICAgICAgICAgICAgICAgIGlmIChhbmNlc3RvcnNfc3RydWN0W3BhcmVudF0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwc1tpbmRleF0gPSBhbmNlc3RvcnNfc3RydWN0W3BhcmVudF07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL25hbWVUb0FkZCBhcmUgdG9wIGxldmVsIG5vZGVzIHRoYXQgYXJlIHRvIGJlIGFkZGVkXG4gICAgICAgICAgICAgICAgLy90byB0aGUgZ3JhcGguXG4gICAgICAgICAgICAgICAgdmFyIG5hbWVUb0FkZCA9IFtdO1xuICAgICAgICAgICAgICAgIC8vd2lsbCBvbmx5IG5lZWQgdG8gYWRkIGEgdG9wIGxldmVsIG5vZGUgaWYgdGhlcmUgaXNcbiAgICAgICAgICAgICAgICAvL29ubHkgb25lIGZvY3VzXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAvL0FkZCBvbmx5IHRob3N0IHRoYXQgYXJlbid0IGFuIGFuY2VzdG9yIG9mIHRoZSBub2RlXG4gICAgICAgICAgICAgICAgICAgIC8vdG8gam9pbiwgdGhlIGZvY3VzIGdyb3VwIG9yIGFuIGFuY2VzdG9yIG9mIGl0LFxuICAgICAgICAgICAgICAgICAgICAvL2FuZCBhcmVuJ3QgYWxyZWFkeSBpbiBub2RlTmFtZVNldC5cbiAgICAgICAgICAgICAgICAgICAgLy9nZXQgZmxvdyBiZXR3ZWVuIHRvcCBsZXZlbCBhcyBsb25nIGFzXG4gICAgICAgICAgICAgICAgICAgIC8vdGhlIHRvcCBsZXZlbCBpc24ndCBhbiBhbmNlc3RvciBvZiB0aGVcbiAgICAgICAgICAgICAgICAgICAgLy9mb2N1cyBncm91cCwgYW5kIGlzbid0IGFscmVhZHkgcGFydCBvZiB0aGVcbiAgICAgICAgICAgICAgICAgICAgLy9ub2RlIHNldDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFuY2VzdG9ycyA9IGFuY2VzdG9yc19zdHJ1Y3Rbbm9kZS5pZF07XG4gICAgICAgICAgICAgICAgICAgIGFuY2VzdG9ycy5wdXNoKHN0YXRlLmZvY3VzR3JvdXBzWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgLy90aGUgb3IgZW1wdHkgYXJyYXkgaXMgdG8gcHJldmVudCBjb25jYXRlbmF0aW5nIGEgbnVsbFxuICAgICAgICAgICAgICAgICAgICAvL29yIHVuZGVmaW5lZCB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICBhbmNlc3RvcnMgPSBhbmNlc3RvcnMuY29uY2F0KGFuY2VzdG9yc19zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dIHx8IFtdKTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKGNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbCwgZnVuY3Rpb24obikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFuY2VzdG9ycy5pbmRleE9mKG4pID09PSAtMSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlTmFtZVNldC5pbmRleE9mKG4pID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkLnB1c2gobik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBub2RlTmFtZVNldCA9IG5vZGVOYW1lU2V0LmNvbmNhdChuYW1lVG9BZGQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vbm8gZm9jdXMgZ3JvdXBzIG1lYW5zIHdlIGFyZSBhdCB0b3AgbGV2ZWxcbiAgICAgICAgICAgICAgICAgICAgLy9TaG91bGQgYWRkIGFueSB0b3AgbGV2ZWwgbm9kZXMgdGhhdCBhcmVuJ3RcbiAgICAgICAgICAgICAgICAgICAgLy9hbHJlYWR5IHRoZXJlXG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChjaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwsIGZ1bmN0aW9uKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlTmFtZVNldC5pbmRleE9mKG4pID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkLnB1c2gobik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBub2RlTmFtZVNldCA9IG5vZGVOYW1lU2V0LmNvbmNhdChuYW1lVG9BZGQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vZm9ybWF0dGluZyBkYXRhXG4gICAgICAgICAgICAgICAgdmFyIHJhZGl1cyA9IG5vZGUucmFkaXVzIC8gdGhpc0dyYXBoLmNvbnN0cy5yYWRpdXNEZWNheTsgXG4gICAgICAgICAgICAgICAgdmFyIHhMb2MgPSBub2RlLng7XG4gICAgICAgICAgICAgICAgdmFyIHlMb2MgPSBub2RlLnk7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IG5vZGUuYW5jZXN0b3JzWzFdO1xuICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnMgPSBub2RlLmFuY2VzdG9ycy5zbGljZSgxKTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3Tm9kZSA9IG5ldyBWaXN1YWxpemVyTm9kZS5Ob2RlKHhMb2MsIHlMb2MsIG5ld19ub2RlX2lkLCBuZXdfbm9kZV9pZCwgcmFkaXVzLCBwYXJlbnQsIGFuY2VzdG9ycyk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnB1c2gobmV3Tm9kZSk7XG5cbiAgICAgICAgICAgICAgICAvL3JlbW92ZSBhbGwgbm9kZXMgdGhhdCB3aWxsIGJlIGpvaW5lZFxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdG9fYmVfZGVsZXRlZC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZV90b19kZWxldGUgPSB0b19iZV9kZWxldGVkW2ldO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMuc3BsaWNlKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG5vZGVfdG9fZGVsZXRlKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zcGxpY2VMaW5rc0Zvck5vZGUobm9kZV90b19kZWxldGUpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciByZXREYXRhID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuZ2V0Rmxvd0JldHdlZW5TZXQobm9kZU5hbWVTZXQpO1xuICAgICAgICAgICAgICAgIC8vaG9sZHMgdGhlIG5vZGVEYXRhIHdoaWNoIHdpbGwgYmUgcHJvY2Vzc2VkXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzVG9Qcm9jZXNzID0gW107XG4gICAgICAgICAgICAgICAgLy9maW5kaW5nIHRoZSBub2RlIGRhdGEgdGhhdCBjb3JyZXNwb25kcyB0byB0aGUgdG9wIGxldmVsXG4gICAgICAgICAgICAgICAgLy9ub2RlcyB0byBhZGQgLSBuYW1lVG9BZGQuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVEYXRhID0gcmV0RGF0YS5ub2RlRGF0YTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVEYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuYW1lVG9BZGQuaW5kZXhPZihub2RlRGF0YVtpXS5pZCkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1RvUHJvY2Vzcy5wdXNoKG5vZGVEYXRhW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vVGhlIHRvcCBsZXZlbCBub2RlcyB0aGF0IGFyZSBhZGRlZFxuICAgICAgICAgICAgICAgIHZhciBuZXdOb2RlcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NOb2RlRGF0YShub2Rlc1RvUHJvY2Vzcyk7XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKG5ld05vZGVzLCBmdW5jdGlvbihuKSB7XG4gICAgICAgICAgICAgICAgICAgIG4ucmFkaXVzID0gbi5yYWRpdXMgfHwgdGhpc0dyYXBoLmNvbnN0cy5zdGFydFJhZGl1cztcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMgPSB0aGlzR3JhcGgubm9kZXMuY29uY2F0KG5ld05vZGVzKTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YShyZXREYXRhLmxpbmtEYXRhLCB0aGlzR3JhcGgubm9kZXMpO1xuICAgICAgICAgICAgICAgIC8vT25seSBrZWVwIHRvcCBsZXZlbCBub2RlcyB0aGF0IGhhdmUgY29ubmVjdGlvbnMgdG9cbiAgICAgICAgICAgICAgICAvL3RoZSBjdXJyZW50IGZvY3VzIGdyb3VwXG4gICAgICAgICAgICAgICAgLy93ZSByZW1vdmUgdGhlIG5vZGUgbmFtZSBmcm9tIG5hbWVUb0FkZCBpZiB3ZSBhcmVcbiAgICAgICAgICAgICAgICAvL2tlZXBpbmcgaXRcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubGlua3MsIGZ1bmN0aW9uKGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vY2hlY2tpbmcgaWYgdGhlcmUgZXhpc3RzIGEgbGluayB0b3VjaGluZyBlYWNoIG9mIG5hbWVUb0FkZFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWVUb0FkZC5pbmRleE9mKGwuc291cmNlLmlkKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHNbMF0gPT09IGwudGFyZ2V0LnBhcmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lVG9BZGQuc3BsaWNlKG5hbWVUb0FkZC5pbmRleE9mKGwuc291cmNlLmlkKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChuYW1lVG9BZGQuaW5kZXhPZihsLnRhcmdldC5pZCkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzWzBdID09PSBsLnNvdXJjZS5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkLnNwbGljZShuYW1lVG9BZGQuaW5kZXhPZihsLnRhcmdldC5pZCksIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL1dlIHdhbnQgdG8ga2VlcCB0aGVtIGFsbFxuICAgICAgICAgICAgICAgICAgICAvL3NpbmNlIGFueSBsZWZ0IGluIG5hbWVUb0FkZCB3aWxsIGJlIHJlbW92ZWQsXG4gICAgICAgICAgICAgICAgICAgIC8vd2UgcmVzZXQgbmFtZVRvQWRkIGhlcmUuXG4gICAgICAgICAgICAgICAgICAgIG5hbWVUb0FkZCA9IFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvL3doYXRldmVyIGlzIHJlbWFpbmluZyBpbiBuYW1lVG9BZGQgaXNuJ3QgY29ubmVjdGVkXG4gICAgICAgICAgICAgICAgLy90byB0aGUgZm9jdXMgZ3JvdXAsIHNvIHdlIHNob3VsZCByZW1vdmUgaXQuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVUb1JlbW92ZSA9IFtdO1xuICAgICAgICAgICAgICAgIGlmIChuYW1lVG9BZGQubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpc0dyYXBoLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmFtZVRvQWRkLmluZGV4T2YodGhpc0dyYXBoLm5vZGVzW2ldLmlkKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lVG9BZGQuc3BsaWNlKG5hbWVUb0FkZC5pbmRleE9mKHRoaXNHcmFwaC5ub2Rlc1tpXS5pZCksIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zcGxpY2VMaW5rc0Zvck5vZGUodGhpc0dyYXBoLm5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlVG9SZW1vdmUucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuYW1lVG9BZGQubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfLmZvckVhY2gobm9kZVRvUmVtb3ZlLCBmdW5jdGlvbihuKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5zcGxpY2UodGhpc0dyYXBoLm5vZGVzLmluZGV4T2YobiksIDEpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXROb2RlcygpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0TGlua3MoKTtcblxuICAgICAgICAgICAgICAgIHN0YXRlU3VwZXIuc3BsaXROb2Rlcy5zcGxpY2Uoc3RhdGVTdXBlci5zcGxpdE5vZGVzLmluZGV4T2YobmV3Tm9kZS5pZCksIDEpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ld05vZGU7IFxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBhIHNpbmdsZSBub2RlIGlzIGpvaW5lZFxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBJZiB0aGUgZm9jdXMgZ3JvdXAgaGFzIGJlZW4gc2VlbiBiZWZvcmUsIGl0IHdpbGxcbiAgICAgICAgICAgICAqIGxvYWQgdGhhdCBsYXlvdXQuIE90aGVyd2lzZSwgaXQgd2lsbCBydW4gYSBkMyBmb3JjZVxuICAgICAgICAgICAgICogc2ltdWxhdGlvbiB0byBnZW5lcmF0ZSBvbmUuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBuZXdOb2RlICBUaGUgbmV3IG5vZGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgam9pbk5vZGVFdmVudChuZXdOb2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kgPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgLy9pZiB0aGUgbGFzdCBldmVudCBoYXMgdGhlIHNhbWUgaWQsIGl0IG11c3QgYmUgdGhlXG4gICAgICAgICAgICAgICAgLy9vcHBwb3NpdGUgb2YgdGhpcyBldmVudCwgc28gd2UgcmVtb3ZlIHRoYXQgZXZlbnQgZnJvbVxuICAgICAgICAgICAgICAgIC8vdGhlIGV2ZW50IHN0YWNrLlxuICAgICAgICAgICAgICAgIC8vT3RoZXJ3aXNlLCB3ZSBhZGQgdGhlIGV2ZW50IHRvIHRoZSBzdGFja1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoICE9PSAwICYmXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeVtzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoIC0gMV0uaWQgPT09IG5ld05vZGUuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5LnBvcCgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeS5wdXNoKHtpZDpuZXdOb2RlLmlkLCBldmVudDonam9pbid9KVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG5cbiAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoXy5pbmNsdWRlcyhjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImZvY3VzXCI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiY29ubmVjdGVkXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vc2V0dGluZyBiYWNrIGJ1dHRvblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5iYWNrQnV0dG9uRWxlbSAhPSBudWxsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uRWxlbS5mYWRlVG8oJ3Nsb3cnLCAwKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3NldHRpbmcgdGl0bGVcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUudGl0bGVFbGVtICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSBzdGF0ZS5mb2N1c0dyb3Vwc1swXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ICs9ICcgJiAnICsgc3RhdGUuZm9jdXNHcm91cHNbMV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc3RhdGUudGl0bGVFbGVtLnRleHQodGV4dCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kuc2V0TGF5b3V0KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVW5kb2VzIHRoZSBsYXN0IHNwbGl0IG9yIGpvaW4gZXZlbnQuXG4gICAgICAgICAgICAgKiBNZWFudCB0byBiZSBjYWxsZWQgYnkgdGhlIGJhY2sgYnV0dG9uLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1bmRvTGFzdEV2ZW50KCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5ID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIHZhciBsYXN0ID0gc3RhdGUuZXZlbnRIaXN0b3J5W3N0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgICB2YXIgaWQgPSBsYXN0LmlkO1xuICAgICAgICAgICAgICAgIHZhciBub2RlO1xuICAgICAgICAgICAgICAgIGlmIChsYXN0LmV2ZW50ID09PSAnam9pbicpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZSA9IHRoaXNHcmFwaC5maW5kTm9kZUJ5SWQoaWQpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZDNub2RlID0gdGhpc0dyYXBoLmZpbmREM05vZGUoaWQpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LmRibGNsaWNrKGQzbm9kZSwgbm9kZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVJZCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFtpZF1bMF07XG4gICAgICAgICAgICAgICAgICAgIG5vZGUgPSB0aGlzR3JhcGguZmluZE5vZGVCeUlkKG5vZGVJZCk7XG4gICAgICAgICAgICAgICAgICAgIHN1cGVyLmpvaW5Ob2RlLmNhbGwodGhpc1BvbGljeSwgbm9kZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIFBvbGljeTogU3BsaXRKb2luVmlld1BvbGljeVxuICAgICAgICB9XG59XSk7XG5cblxuXG5cblxuXG5cbiIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYub3JnYW5pemF0aW9ucycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvb3JnYW5pemF0aW9ucycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5saXN0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnb3JnYW5pemF0aW9ubGlzdCdcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zZXJ2aWNlbGJzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzJywge1xuICAgICAgICAgICAgdXJsOiAnL3NlcnZpY2VsYnMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ3NlcnZpY2VsYkxpc3QnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMuY3JlYXRlJywge1xuICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdzZXJ2aWNlbGJDcmVhdGUnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnc2VydmljZWxiRGV0YWlscydcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYuc2V0dGluZ3MnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzJywge1xuICAgICAgICAgICAgdXJsOiAnL2dsb2JhbCcsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9zZXR0aW5ncycsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NldHRpbmdzL3NldHRpbmdzbWVudS5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLmxvZ3MnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbG9ncycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLmF1dGgnLCB7XG4gICAgICAgICAgICB1cmw6ICcvYXV0aCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLmxpY2Vuc2UnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGljZW5zZScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLnBvbGljaWVzJywge1xuICAgICAgICAgICAgdXJsOiAnL3BvbGljaWVzJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICcnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMubmV0d29ya3MnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbmV0d29ya3MnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnbmV0d29ya3NldHRpbmcnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMudm9sdW1lcycsIHtcbiAgICAgICAgICAgIHVybDogJy92b2x1bWVzJyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ3ZvbHVtZXNldHRpbmcnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMuY2x1c3RlcicsIHtcbiAgICAgICAgICAgIHVybDogJy9jbHVzdGVyJyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2NsdXN0ZXJzZXR0aW5ncydcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIlxuXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJywgXG5cdCdjb250aXYuZ3JhcGgnXSlcbiAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2NvbnRpdi5tZW51LnZpc3VhbGl6YXRpb24nLCB7XG4gICAgICAgICAgICB1cmw6ICcvdmlzdWFsaXphdGlvbicsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSlcbiAgICB9XSk7XG4iLCIndXNlIHN0cmljdCc7XG4vLyBEZWNsYXJlIGFwcCBsZXZlbCBtb2R1bGUgd2hpY2ggZGVwZW5kcyBvbiB2aWV3cywgYW5kIGNvbXBvbmVudHNcbmFuZ3VsYXIubW9kdWxlKCdjb250aXZBcHAnLCBbXG4gICAgJ3VpLnJvdXRlcicsXG4gICAgJ2NvbnRpdi5sb2dpbicsXG4gICAgJ2NvbnRpdi5tZW51JyxcbiAgICAnY29udGl2LmRhc2hib2FyZCcsXG4gICAgJ2NvbnRpdi5hcHBsaWNhdGlvbmdyb3VwcycsXG4gICAgJ2NvbnRpdi5uZXR3b3JrcycsXG4gICAgJ2NvbnRpdi5uZXR3b3JrcG9saWNpZXMnLFxuICAgICdjb250aXYuc2VydmljZWxicycsXG4gICAgJ2NvbnRpdi5vcmdhbml6YXRpb25zJyxcbiAgICAnY29udGl2LnNldHRpbmdzJyxcbiAgICAnY29udGl2LnZpc3VhbGl6YXRpb24nXG5dKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsICckdXJsUm91dGVyUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYnLCB7XG4gICAgICAgICAgICB1cmw6ICcnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGZsdWlkIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pO1xuICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvJyk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5sb2dpbicpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5sb2dpbicsIHtcbiAgICAgICAgICAgIHVybDogJy8nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdsb2dpbi9sb2dpbi5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdMb2dpbkN0cmwgYXMgbG9naW5DdHJsJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTG9naW5DdHJsJywgWyckc3RhdGUnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBsb2dpbkN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub0Rhc2hib2FyZCgpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuZGFzaGJvYXJkJywgeyB1c2VybmFtZTogbG9naW5DdHJsLnVzZXJuYW1lIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGxvZ2luKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9EYXNoYm9hcmQoKTtcbiAgICAgICAgfVxuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGxvZ2luQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihsb2dpbkN0cmwpO1xuICAgICAgICBsb2dpbkN0cmwubG9naW4gPSBsb2dpbjtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1sb2dpbmN0cmwuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE5LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm1lbnUnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudScsIHtcbiAgICAgICAgICAgIHVybDogJy9tJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbWVudS9tZW51Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ01lbnVDdHJsIGFzIG1lbnVDdHJsJyxcbiAgICAgICAgICAgIHBhcmFtczogeyB1c2VybmFtZTogbnVsbCB9XG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdNZW51Q3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcykge1xuICAgICAgICB2YXIgbWVudUN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBsb2dvdXQoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5sb2dpbicpO1xuICAgICAgICB9XG4gICAgICAgIG1lbnVDdHJsLnVzZXJuYW1lID0gJHN0YXRlUGFyYW1zLnVzZXJuYW1lO1xuICAgICAgICBtZW51Q3RybC5sb2dvdXQgPSBsb2dvdXQ7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bWVudUN0cmwuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5vcmdhbml6YXRpb25zJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5jcmVhdGUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnb3JnYW5pemF0aW9ucy9vcmdhbml6YXRpb25jcmVhdGUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnT3JnYW5pemF0aW9uQ3JlYXRlQ3RybCBhcyBvcmdhbml6YXRpb25DcmVhdGVDdHJsJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignT3JnYW5pemF0aW9uQ3JlYXRlQ3RybCcsIFsnJHN0YXRlJywgJ09yZ2FuaXphdGlvbnNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgT3JnYW5pemF0aW9uc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvT3JnYW5pemF0aW9ucygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub09yZ2FuaXphdGlvbnMoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVPcmdhbml6YXRpb24oKSB7XG4gICAgICAgICAgICAvL2Zvcm0gY29udHJvbGxlciBpcyBpbmplY3RlZCBieSB0aGUgaHRtbCB0ZW1wbGF0ZVxuICAgICAgICAgICAgLy9jaGVja2luZyBpZiBhbGwgdmFsaWRhdGlvbnMgaGF2ZSBwYXNzZWRcbiAgICAgICAgICAgIGlmIChvcmdhbml6YXRpb25DcmVhdGVDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwubmV3T3JnYW5pemF0aW9uLmtleSA9IG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwubmV3T3JnYW5pemF0aW9uLnRlbmFudE5hbWU7XG4gICAgICAgICAgICAgICAgT3JnYW5pemF0aW9uc01vZGVsLmNyZWF0ZShvcmdhbml6YXRpb25DcmVhdGVDdHJsLm5ld09yZ2FuaXphdGlvbikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvT3JnYW5pemF0aW9ucygpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25DcmVhdGVDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJlc2V0Rm9ybSgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBvcmdhbml6YXRpb25DcmVhdGVDdHJsLm5ld09yZ2FuaXphdGlvbiA9IHtcbiAgICAgICAgICAgICAgICB0ZW5hbnROYW1lOiAnJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBvcmdhbml6YXRpb25DcmVhdGVDdHJsLmNyZWF0ZU9yZ2FuaXphdGlvbiA9IGNyZWF0ZU9yZ2FuaXphdGlvbjtcbiAgICAgICAgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybC5jYW5jZWxDcmVhdGluZyA9IGNhbmNlbENyZWF0aW5nO1xuICAgICAgICByZXNldEZvcm0oKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1vcmdhbml6YXRpb25jcmVhdGVjdHJsLmpzLm1hcCIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYub3JnYW5pemF0aW9ucycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ09yZ2FuaXphdGlvbkRldGFpbHNDdHJsIGFzIG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnb3JnYW5pemF0aW9ucy9vcmdhbml6YXRpb25kZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdPcmdhbml6YXRpb25EZXRhaWxzQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdPcmdhbml6YXRpb25zTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgT3JnYW5pemF0aW9uc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgb3JnYW5pemF0aW9uRGV0YWlsc0N0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub09yZ2FuaXphdGlvbnMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMubGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGRlbGV0ZU9yZ2FuaXphdGlvbigpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBPcmdhbml6YXRpb25zTW9kZWwuZGVsZXRlKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsLm9yZ2FuaXphdGlvbikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9Pcmdhbml6YXRpb25zKCk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICBPcmdhbml6YXRpb25zTW9kZWwuZ2V0TW9kZWxCeUtleSgkc3RhdGVQYXJhbXMua2V5KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKG9yZ2FuaXphdGlvbikge1xuICAgICAgICAgICAgb3JnYW5pemF0aW9uRGV0YWlsc0N0cmwub3JnYW5pemF0aW9uID0gb3JnYW5pemF0aW9uO1xuICAgICAgICB9KTtcbiAgICAgICAgb3JnYW5pemF0aW9uRGV0YWlsc0N0cmwuZGVsZXRlT3JnYW5pemF0aW9uID0gZGVsZXRlT3JnYW5pemF0aW9uO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW9yZ2FuaXphdGlvbmRldGFpbHNjdHJsLmpzLm1hcCIsIlxuXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52aXN1YWxpemF0aW9uLmVkZ2UnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2VkZ2Uve3NvdXJjZU5hbWUsIHRhcmdldE5hbWUsIHNvdXJjZUxpc3QsIHRhcmdldExpc3R9JyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlTmFtZTogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TmFtZTogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgc291cmNlTGlzdDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TGlzdDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1Zpc3VhbGl6YXRpb25FZGdlQ3RybCBhcyB2aXN1YWxpemF0aW9uZWRnZUN0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9uZWRnZS5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdWaXN1YWxpemF0aW9uRWRnZUN0cmwnLCBbXCIkc2NvcGVcIiwgXCIkaHR0cFwiLCAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdWaXN1YWxpemF0aW9uU2VydmljZScsICckaW50ZXJ2YWwnLFxuICAgICAgICBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkc3RhdGUsICRzdGF0ZVBhcmFtcywgVmlzdWFsaXphdGlvblNlcnZpY2UsICRpbnRlcnZhbCkge1xuICAgICAgICAgICAgdmFyIHNvdXJjZU5hbWUgPSAkc3RhdGVQYXJhbXMuc291cmNlTmFtZTtcbiAgICAgICAgICAgIHZhciB0YXJnZXROYW1lID0gJHN0YXRlUGFyYW1zLnRhcmdldE5hbWU7XG4gICAgICAgICAgICB2YXIgc291cmNlTGlzdCA9ICRzdGF0ZVBhcmFtcy5zb3VyY2VMaXN0O1xuICAgICAgICAgICAgdmFyIHRhcmdldExpc3QgPSAkc3RhdGVQYXJhbXMudGFyZ2V0TGlzdDtcblxuICAgICAgICAgICAgLy9JZiB0aGUgcGFnZSBpcyByZWxvYWRlZCwgdGhlc2Ugc3RhdGUgcGFyYW1zIGFyZSBhbGwgbnVsbCxcbiAgICAgICAgICAgIC8vc28gaXQgd2lsbCByb3V0ZSB0aGVtIGJhY2sgdG8gdGhlIHZpc3VhbGl6YXRpb24gdGFiIHRvcCB2aWV3XG4gICAgICAgICAgICBpZiAoc291cmNlTGlzdCA9PSBudWxsIHx8IHRhcmdldExpc3QgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUudmlzdWFsaXphdGlvbi5saXN0Jyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgZCA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICB2YXIgdCA9IGQuZ2V0U2Vjb25kcygpO1xuICAgICAgICAgICAgJHNjb3BlLmVkZ2VEYXRhSW50ZXJ2YWwgPSBcbiAgICAgICAgICAgICAgICAkaW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIFZpc3VhbGl6YXRpb25TZXJ2aWNlLmdldEVkZ2VEYXRhKHNvdXJjZUxpc3QsIHRhcmdldExpc3QsIHQudG9TdHJpbmcoKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0cyA9IHJlc3VsdC5yZXN1bHRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2gocmVzdWx0cywgZnVuY3Rpb24ocikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoXy5pc0VtcHR5KHIpID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSArPSByLnNlcmllc1swXS52YWx1ZXNbMF1bMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlTmFtZSA9IHNvdXJjZU5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRhcmdldE5hbWUgPSB0YXJnZXROYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5lZGdlRGF0YSA9IGRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVkZ2VEYXRhVGltZSA9IHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0sIDMwMDApO1xuXG4gICAgICAgICAgICAvL0Rlc3Ryb3lpbmcgdGhlIGludGVydmFsIGZ1bmN0aW9uIG9uIHJvdXRlIGNoYW5nZVxuICAgICAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7ICRpbnRlcnZhbC5jYW5jZWwoJHNjb3BlLmVkZ2VEYXRhSW50ZXJ2YWwpOyB9KTtcblxuXG4gICAgICAgICAgICBWaXN1YWxpemF0aW9uU2VydmljZS5nZXRPbGRFZGdlRGF0YShzb3VyY2VMaXN0LCB0YXJnZXRMaXN0KVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSByZXN1bHQucmVzdWx0cztcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVkZ2VEYXRhID0gW107XG4gICAgICAgICAgICAgICAgICAgIC8vcmVzdWx0cywgaWYgbm90IGVtcHR5LCBhcmUgZXhwZWN0ZWQgdG8gaGF2ZVxuICAgICAgICAgICAgICAgICAgICAvLzYgZGF0YSBlbnRyaWVzXG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChyZXN1bHRzLCBmdW5jdGlvbihyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoXy5pc0VtcHR5KHIpID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gci5zZXJpZXNbMF0udmFsdWVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfLmlzRW1wdHkoZWRnZURhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChkYXRhLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGdlRGF0YS5wdXNoKGRbMV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChkYXRhLCBmdW5jdGlvbihkLCBpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGdlRGF0YVtpXSArPSBkWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNvdXJjZU5hbWUgPSBzb3VyY2VOYW1lO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudGFyZ2V0TmFtZSA9IHRhcmdldE5hbWU7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zb3VyY2VMaXN0ID0gc291cmNlTGlzdDtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRhcmdldExpc3QgPSB0YXJnZXRMaXN0O1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUub2xkRWRnZURhdGEgPSBlZGdlRGF0YTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIH0pO1xuICAgIH1dKTtcblxuXG5cblxuIiwiXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicpXG4gICAgLmRpcmVjdGl2ZShcInZpc3VhbGl6YXRpb25FZGdlXCIsIFsnJHdpbmRvdycsXG4gICAgICAgIGZ1bmN0aW9uKCR3aW5kb3cpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIHZpc3VhbGl6YXRpb25FZGdlRDMoc2NvcGUsIGQzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJvZHlFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF07XG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IGJvZHlFbC5jbGllbnRXaWR0aCAtIDQwMCxcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gIGJvZHlFbC5jbGllbnRIZWlnaHQgLSA0MDA7XG5cblxuICAgICAgICAgICAgICAgIC8vdGFrZW4gZnJvbSBodHRwOi8vYmwub2Nrcy5vcmcvc2ltZW5icmVra2VuLzY2MzQwNzBcbiAgICAgICAgICAgICAgICAvLyAvKiogTUFJTiBTVkcgKiovXG4gICAgICAgICAgICAgICAgdmFyIGxpbWl0ID0gNTksXG4gICAgICAgICAgICAgICAgZHVyYXRpb24gPSA3NTAsXG4gICAgICAgICAgICAgICAgbm93ID0gbmV3IERhdGUoRGF0ZS5ub3coKSAtIGR1cmF0aW9uKTtcblxuICAgICAgICAgICAgICAgIHZhciBncm91cHMgPSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdvcmFuZ2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZDMucmFuZ2UobGltaXQpLm1hcChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNjb3BlLm9sZEVkZ2VEYXRhW01hdGguZmxvb3IoZC8xMCldIHx8IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgeCA9IGQzLnRpbWUuc2NhbGUoKVxuICAgICAgICAgICAgICAgICAgICAuZG9tYWluKFtub3cgLSAobGltaXQgLSAyKSwgbm93IC0gZHVyYXRpb25dKVxuICAgICAgICAgICAgICAgICAgICAucmFuZ2UoWzAsIHdpZHRoXSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgeSA9IGQzLnNjYWxlLmxpbmVhcigpXG4gICAgICAgICAgICAgICAgICAgIC5kb21haW4oWzAsIGQzLm1heChncm91cHMuY3VycmVudC5kYXRhLCBmdW5jdGlvbiAoZCkgeyByZXR1cm4gZCArIDEwOyB9KV0pXG4gICAgICAgICAgICAgICAgICAgIC5yYW5nZShbaGVpZ2h0LCAwXSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbGluZSA9IGQzLnN2Zy5saW5lKClcbiAgICAgICAgICAgICAgICAgICAgLmludGVycG9sYXRlKCdiYXNpcycpXG4gICAgICAgICAgICAgICAgICAgIC54KGZ1bmN0aW9uKGQsIGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB4KG5vdyAtIChsaW1pdCAtIDEgLSBpKSAqIGR1cmF0aW9uKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAueShmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geShkKVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHZhciB4U3ZnID0gZDMuc2VsZWN0KCcuZ3JhcGgnKS5hcHBlbmQoJ3N2ZycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd3aWR0aCcsIDI1KVxuICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ292ZXJmbG93JywgJ3Zpc2libGUnKVxuICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ3Bvc2l0aW9uJywgJ2ZpeGVkJyk7XG5cbiAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgIHZhciB5QXhpcyA9IHhTdmcuYXBwZW5kKCdnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ3kgYXhpcycpXG4gICAgICAgICAgICAgICAgICAgIC8vIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDAsJyArIHdpZHRoICsgJyknKVxuICAgICAgICAgICAgICAgICAgICAuY2FsbCh5LmF4aXMgPSBkMy5zdmcuYXhpcygpLnNjYWxlKHkpLm9yaWVudCgnbGVmdCcpKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgc3ZnPSBkMy5zZWxlY3QoJy5ncmFwaCcpLmFwcGVuZCgnc3ZnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2NoYXJ0JylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgd2lkdGggLSA1MClcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2hlaWdodCcsIGhlaWdodCArIDUwKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gLnN0eWxlKCdvdmVyZmxvdycsIFwidmlzaWJsZVwiKTtcblxuICAgICAgICAgICAgICAgIHZhciBheGlzID0gc3ZnLmFwcGVuZCgnZycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICd4IGF4aXMnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZSgwLCcgKyBoZWlnaHQgKyAnKScpXG4gICAgICAgICAgICAgICAgICAgIC5jYWxsKHguYXhpcyA9IGQzLnN2Zy5heGlzKCkuc2NhbGUoeCkub3JpZW50KCdib3R0b20nKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgcGF0aHMgPSBzdmcuYXBwZW5kKCdnJyk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBuYW1lIGluIGdyb3Vwcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ3JvdXAgPSBncm91cHNbbmFtZV07XG4gICAgICAgICAgICAgICAgICAgIGdyb3VwLnBhdGggPSBwYXRocy5hcHBlbmQoJ3BhdGgnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmRhdGEoW2dyb3VwLmRhdGFdKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgbmFtZSArICcgZ3JvdXAnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN0eWxlKCdzdHJva2UnLCBncm91cC5jb2xvcilcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiB0aWNrKCkge1xuICAgICAgICAgICAgICAgICAgICBub3cgPSBuZXcgRGF0ZSgpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCBuZXcgdmFsdWVzXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIG5hbWUgaW4gZ3JvdXBzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ3JvdXAgPSBncm91cHNbbmFtZV07XG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cC5kYXRhLnB1c2goc2NvcGUuZWRnZURhdGEgfHwgMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cC5wYXRoLmF0dHIoJ2QnLCBsaW5lKVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2hpZnQgZG9tYWluXG4gICAgICAgICAgICAgICAgICAgIHguZG9tYWluKFtub3cgLSAobGltaXQgLSAyKSAqIGR1cmF0aW9uLCBub3cgLSBkdXJhdGlvbl0pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFNsaWRlIHgtYXhpcyBsZWZ0XG4gICAgICAgICAgICAgICAgICAgIGF4aXMudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZHVyYXRpb24oZHVyYXRpb24pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZWFzZSgnbGluZWFyJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYWxsKHguYXhpcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgeUF4aXMudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZHVyYXRpb24oZHVyYXRpb24pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZWFzZSgnbGluZWFyJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYWxsKHkuYXhpcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2xpZGUgcGF0aHMgbGVmdFxuICAgICAgICAgICAgICAgICAgICBwYXRocy5hdHRyKCd0cmFuc2Zvcm0nLCBudWxsKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmR1cmF0aW9uKGR1cmF0aW9uKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVhc2UoJ2xpbmVhcicpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZSgnICsgeChub3cgLSAobGltaXQgLSAxKSAqIGR1cmF0aW9uKSArICcpJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lYWNoKCdlbmQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aWNrKClcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBvbGRlc3QgZGF0YSBwb2ludCBmcm9tIGVhY2ggZ3JvdXBcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBncm91cHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBncm91cCA9IGdyb3Vwc1tuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLmRhdGEuc2hpZnQoKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRpY2soKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm57XG4gICAgICAgICAgICAgICAgcmVzdHJpY3Q6J0VBJyxcbiAgICAgICAgICAgICAgICByZXBsYWNlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Zpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbmVkZ2V0ZW1wbGF0ZS5odG1sJyxcbiAgICAgICAgICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSl7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiR3YXRjaEdyb3VwKFsnZWRnZURhdGEnLCAnb2xkRWRnZURhdGEnXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzY29wZS5lZGdlRGF0YSAhPSBudWxsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5vbGRFZGdlRGF0YSAhPSBudWxsICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNjb3BlLmluaXRpYWxpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmluaXRpYWxpemUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQzID0gJHdpbmRvdy5kMzsgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzdWFsaXphdGlvbkVkZ2VEMyhzY29wZSwgZDMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgXVxuKTtcbiIsIlxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52aXN1YWxpemF0aW9uJylcbiAgICAuc2VydmljZSgnU3RhdGVTYXZlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNhdmVkU3RhdGVzID0ge307XG4gICAgfSlcbiAgICAuZGlyZWN0aXZlKFwidmlzdWFsaXphdGlvbkdyYXBoXCIsIFsnJHdpbmRvdycsICckc3RhdGUnLCAnVmlzdWFsaXplckdyYXBoJywgJ1BvbGljeVNlcnZpY2UnLCAnVmlzdWFsaXplckRhdGFTb3VyY2UnLCAnU3RhdGVTYXZlJyxcbiAgICAgICAgZnVuY3Rpb24oJHdpbmRvdywgJHN0YXRlLCBWaXN1YWxpemVyR3JhcGgsIFBvbGljeVNlcnZpY2UsIFZpc3VhbGl6ZXJEYXRhU291cmNlLCBTdGF0ZVNhdmUpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIHZpc3VhbGl6YXRpb25saXN0ZDMoc2NvcGUsIGVsZW0sIFZpc3VhbGl6ZXJHcmFwaCwgUG9saWN5U2VydmljZSwgVmlzdWFsaXplckRhdGFTb3VyY2UsIFN0YXRlU2F2ZSkge1xuICAgICAgICAgICAgICAgIC8vZG9uJ3QgcnVuIHVudGlsIGFsbCBpbml0aWFsaXphdGlvbiBjYWxscyBoYXZlIHJldHVybmVkXG4gICAgICAgICAgICAgICAgaWYgKHNjb3BlLm5vZGVzID09PSB1bmRlZmluZWQgfHwgc2NvcGUubGlua3MgPT09IHVuZGVmaW5lZCB8fCBzY29wZS5jaGlsZHJlbl9zdHJ1Y3QgPT09IHVuZGVmaW5lZCB8fFxuICAgICAgICAgICAgICAgICAgICBzY29wZS5hbmNlc3RvcnNfc3RydWN0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vY3JlYXRpbmcgRGF0YVNvdXJjZVxuICAgICAgICAgICAgICAgIHZhciBkYXRhU291cmNlID0gbmV3IFZpc3VhbGl6ZXJEYXRhU291cmNlLkRhdGFTb3VyY2Uoc2NvcGUubm9kZXMsIHNjb3BlLmxpbmtzLCBzY29wZS5jaGlsZHJlbl9zdHJ1Y3QsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuYW5jZXN0b3JzX3N0cnVjdCwgc2NvcGUubGFiZWxzLCBzY29wZS5zZXJ2aWNlU2VsZWN0b3JzKTtcbiAgICAgICAgICAgICAgICBkYXRhU291cmNlLnNldEFuY2VzdG9ycygpO1xuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzLCBsaW5rcztcblxuICAgICAgICAgICAgICAgIHZhciB0b3BEYXRhID0gZGF0YVNvdXJjZS5nZXRUb3BMZXZlbEZsb3coKTtcbiAgICAgICAgICAgICAgICBub2RlcyA9IGRhdGFTb3VyY2UucHJvY2Vzc05vZGVEYXRhKHRvcERhdGEubm9kZURhdGEpO1xuICAgICAgICAgICAgICAgIGxpbmtzID0gZGF0YVNvdXJjZS5wcm9jZXNzTGlua0RhdGEodG9wRGF0YS5saW5rRGF0YSwgbm9kZXMpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGJvZHlFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF07XG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IGJvZHlFbC5jbGllbnRXaWR0aCxcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gIGJvZHlFbC5jbGllbnRIZWlnaHQ7XG5cbiAgICAgICAgICAgICAgICAvKiogTUFJTiBTVkcgKiovXG4gICAgICAgICAgICAgICAgdmFyIHJhd1N2Zz1lbGVtLmZpbmQoJ3N2ZycpO1xuXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9ICQocmF3U3ZnLnBhcmVudCgpKS5vZmZzZXQoKTtcblxuICAgICAgICAgICAgICAgIHZhciBkaXZXaWR0aCA9ICQocmF3U3ZnLnBhcmVudCgpKS53aWR0aCgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN2ZyA9IGQzLnNlbGVjdChyYXdTdmdbMF0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwid2lkdGhcIiwgZGl2V2lkdGgpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGhlaWdodCAtIG9mZnNldC50b3AgLSAyMCk7XG5cbiAgICAgICAgICAgICAgICAvL2luc3RhbGxpbmcgcG9saWNpZXNcbiAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGggPSBuZXcgVmlzdWFsaXplckdyYXBoLkdyYXBoKHN2Zywgbm9kZXMsIGxpbmtzLCBkYXRhU291cmNlLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5jaGlsZHJlbl9zdHJ1Y3QsIHNjb3BlLmFuY2VzdG9yc19zdHJ1Y3QpO1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5pbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3kobmV3IFBvbGljeVNlcnZpY2UuU2F2ZVN0YXRlUG9saWN5KFN0YXRlU2F2ZS5zYXZlZFN0YXRlcykpO1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5pbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3kobmV3IFBvbGljeVNlcnZpY2UuUGF0aENoYW5nZVZpZXdQb2xpY3koJHN0YXRlKSk7XG4gICAgICAgICAgICAgICAgLy9RVGlwUG9saWN5IGlzIGZvciBib3RoIE5vZGVzIGFuZCBQYXRocywgaW5zdGFsbCBzYW1lIG9uZSBvbiBib3RoXG4gICAgICAgICAgICAgICAgdmFyIHFUaXBQb2xpY3kgPSBuZXcgUG9saWN5U2VydmljZS5RVGlwUG9saWN5KCk7XG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmluc3RhbGxEZWZhdWx0Tm9kZVBvbGljeShxVGlwUG9saWN5KTtcbiAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGguaW5zdGFsbERlZmF1bHRQYXRoUG9saWN5KHFUaXBQb2xpY3kpO1xuICAgICAgICAgICAgICAgIHZhciBzcGxpdEpvaW5WaWV3UG9saWN5ID0gbmV3IFBvbGljeVNlcnZpY2UuU3BsaXRKb2luVmlld1BvbGljeSgpO1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5pbnN0YWxsRGVmYXVsdE5vZGVQb2xpY3koc3BsaXRKb2luVmlld1BvbGljeSk7XG4gICAgICAgICAgICAgICAgc3BsaXRKb2luVmlld1BvbGljeS5pbnN0YWxsQmFja0J1dHRvbigkKCcjYmFja0J1dHRvbicpKTtcbiAgICAgICAgICAgICAgICBzcGxpdEpvaW5WaWV3UG9saWN5Lmluc3RhbGxUaXRsZSgkKCcjZ3JhcGgtdGl0bGUnKSk7XG5cbiAgICAgICAgICAgICAgICAvL2xvYWQgb2xkIHZpZXcgaWYgaXQgZXhpc3RzLlxuICAgICAgICAgICAgICAgIGlmIChfLmlzRW1wdHkoU3RhdGVTYXZlLnNhdmVkU3RhdGVzKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ3JhcGggPSBzY29wZS52aXN1YWxpemF0aW9uR3JhcGg7XG4gICAgICAgICAgICAgICAgICAgIGdyYXBoLmxvYWQoU3RhdGVTYXZlLnNhdmVkU3RhdGVzKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybntcbiAgICAgICAgICAgICAgICByZXN0cmljdDonRUEnLFxuICAgICAgICAgICAgICAgIHJlcGxhY2U6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9udGVtcGxhdGUuaHRtbCcsXG4gICAgICAgICAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW0pe1xuICAgICAgICAgICAgICAgICAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkgeyBcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykudW5iaW5kKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGguZGVzdHJveSgpO30pO1xuICAgICAgICAgICAgICAgICAgICBzY29wZS4kd2F0Y2hHcm91cChbJ25vZGVzJywgJ2xpbmtzJywgJ2NoaWxkcmVuX3N0cnVjdCcsICdhbmNlc3RvcnNfc3RydWN0J10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2NvcGUubm9kZXMgIT0gbnVsbCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5saW5rcyAhPSBudWxsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmNoaWxkcmVuX3N0cnVjdCAhPSBudWxsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmFuY2VzdG9yc19zdHJ1Y3QgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2NvcGUuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXN1YWxpemF0aW9ubGlzdGQzKHNjb3BlLCBlbGVtLCBWaXN1YWxpemVyR3JhcGgsIFBvbGljeVNlcnZpY2UsIFZpc3VhbGl6ZXJEYXRhU291cmNlLCBTdGF0ZVNhdmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5kYXRhU291cmNlLmxpbmtzID0gc2NvcGUubGlua3M7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC51cGRhdGVMaW5rRGF0YSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICB9XG4gICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICBdXG4pO1xuXG5cblxuXG5cblxuXG5cblxuXG5cblxuIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52aXN1YWxpemF0aW9uJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUudmlzdWFsaXphdGlvbi5saXN0Jywge1xuICAgICAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnVmlzdWFsaXphdGlvbkxpc3RDdHJsIGFzIHZpc3VhbGl6YXRpb25MaXN0Q3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb25saXN0Lmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICA7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1Zpc3VhbGl6YXRpb25MaXN0Q3RybCcsIFtcIiRzY29wZVwiLCBcIiRodHRwXCIsICdWaXN1YWxpemF0aW9uU2VydmljZScsICckaW50ZXJ2YWwnLCBcbiAgICAgICAgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgVmlzdWFsaXphdGlvblNlcnZpY2UsICRpbnRlcnZhbCkge1xuICAgICAgICAgICAgLy90byBzZWUgdGhlIGV4cGVjdGVkIGZvcm1hdCB0byBiZSByZXR1cm5lZCBmcm9tIHRoZXNlIGNhbGxzLFxuICAgICAgICAgICAgLy9sb29rIGF0IGFwcC9jb21wb25lbnRzL2dyYXBob2JqZWN0cy9kYXRhc291cmNlL3Zpc3VhbGl6ZXJkYXRhc291cmNlLmpzXG4gICAgICAgICAgICB2YXIgc3VjY2Vzc0dyYXBoRGF0YUNhbGxiYWNrID0gZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIGxpbmtzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVJZHMgPSBbXTtcbiAgICAgICAgICAgICAgICBfLmZvckVhY2gocmVzdWx0LnJlc3VsdHNbMF0uc2VyaWVzLCBmdW5jdGlvbihzZXJpZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVuZHBvaW50ID0gc2VyaWVzLnRhZ3MuRW5kcG9pbnRJUDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb3ZpZGVyID0gc2VyaWVzLnRhZ3MuUHJvdmlkZXJJUDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGU7XG4gICAgICAgICAgICAgICAgICAgIC8vY3JlYXRpbmcgbm9kZXNcbiAgICAgICAgICAgICAgICAgICAgaWYgKF8uaW5jbHVkZXMobm9kZUlkcywgZW5kcG9pbnQpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGVuZHBvaW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBlbmRwb2ludCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3JzOiBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXMucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHMucHVzaChlbmRwb2ludCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKF8uaW5jbHVkZXMobm9kZUlkcywgcHJvdmlkZXIpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHByb3ZpZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBwcm92aWRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3JzOiBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXMucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHMucHVzaChwcm92aWRlcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy9jcmVhdGluZyBsaW5rc1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGlua091dCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogZW5kcG9pbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IHByb3ZpZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0OiBzZXJpZXMudmFsdWVzWzBdWzJdXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGxpbmtzLnB1c2gobGlua091dCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsaW5rSW4gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6IHByb3ZpZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiBlbmRwb2ludCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHdlaWdodDogc2VyaWVzLnZhbHVlc1swXVsxXVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBsaW5rcy5wdXNoKGxpbmtJbik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLm5vZGVzID0gbm9kZXM7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxpbmtzID0gbGlua3M7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLy9pbml0aWFsIGNhbGxcbiAgICAgICAgICAgIFZpc3VhbGl6YXRpb25TZXJ2aWNlLmdldEdyYXBoRGF0YSgpLnRoZW4oc3VjY2Vzc0dyYXBoRGF0YUNhbGxiYWNrLCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vd2lsbCBmYWlsIHNpbGVudGx5LCBncmFwaCB3b24ndCBiZSBkaXNwbGF5ZWRcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHsgJGludGVydmFsLmNhbmNlbCgkc2NvcGUuZ3JhcGhEYXRhSW50ZXJ2YWwpOyB9KTtcblxuICAgICAgICAgICAgVmlzdWFsaXphdGlvblNlcnZpY2UuZ2V0U3RydWN0dXJlRGF0YSgpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vdG8gc2VlIHRoZSBleHBlY3RlZCBmb3JtIG9mIGFuY2VzdG9yX3N0cnVjdCBhbmQgY2hpbGRyZW5fc3RydWN0LCBcbiAgICAgICAgICAgICAgICAvL2xvb2sgYXQgYXBwL2NvbXBvbmVudHMvZ3JhcGhvYmplY3RzL2RhdGFzb3VyY2UvdmlzdWFsaXplcmRhdGFzb3VyY2UuanNcbiAgICAgICAgICAgICAgICAkc2NvcGUuYW5jZXN0b3JzX3N0cnVjdCA9IHJlc3VsdC5hbmNlc3RvcnNfc3RydWN0O1xuICAgICAgICAgICAgICAgICRzY29wZS5jaGlsZHJlbl9zdHJ1Y3QgPSByZXN1bHQuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgICRzY29wZS5sYWJlbHMgPSByZXN1bHQubGFiZWxzO1xuICAgICAgICAgICAgICAgICRzY29wZS5zZXJ2aWNlU2VsZWN0b3JzID0gcmVzdWx0LnNlcnZpY2VTZWxlY3RvcnM7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vd2lsbCBmYWlsIHNpbGVudGx5LCBncmFwaCB3b24ndCBiZSBkaXNwbGF5ZWRcbiAgICAgICAgICAgIH0pO1xuICAgIH1dKTtcblxuXG5cblxuXG5cblxuXG5cblxuXG4iLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nKVxuICAgIC5mYWN0b3J5KCdWaXN1YWxpemF0aW9uU2VydmljZScsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbiAoJGh0dHAsICRxKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYWtlcyBhIGdldCByZXF1ZXN0IHdpdGggdGhlIHVybCBhbmQgY29uZmlnLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgdXJsICAgICBUaGUgdXJsXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBjb25maWcgIFRoZSBjb25maWd1cmF0aW9uc1xuICAgICAgICAgKiBAcmV0dXJuICAgICB7JEh0dHAgUHJvbWlzZX0gICBQcm9taXNlIG9mIHRoZSByZXF1ZXN0XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBtYWtlR2V0KHVybCwgY29uZmlnKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCwgY29uZmlnKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogTWFrZXMgYSBwb3N0IHJlcXVlc3Qgd2l0aCB0aGUgdXJsIGFuZCBkYXRhXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICB1cmwgICAgIFRoZSB1cmxcbiAgICAgICAgICogQHBhcmFtICAgICAge0pTT059ICAgIGRhdGEgICAgVGhlIGRhdGFcbiAgICAgICAgICogQHJldHVybiAgICAgeyRIdHRwIFByb21pc2V9ICAgUHJvbWlzZSBvZiB0aGUgcmVxdWVzdFxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gbWFrZVBvc3QodXJsLCBkYXRhKSB7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIGNvbnZlcnRzIHRoZSBkYXRhIGludG8geC13d3ctZnJvbS11cmxlbmNvZGVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0pTT059ICBvYmogICAgIEpTT04gZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtzdHJpbmd9ICB4LXd3dy1mb3JtLXVybGVuY29kZWQgc3RyaW5nXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHZhciBwYXJhbSA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgICAgICAgICAgIHZhciBxdWVyeSA9ICcnLCBuYW1lLCB2YWx1ZSwgZnVsbFN1Yk5hbWUsIHN1Yk5hbWUsIHN1YlZhbHVlLCBpbm5lck9iaiwgaTtcbiAgICAgICAgICAgICAgICBmb3IgKG5hbWUgaW4gb2JqKSB7XG4gICAgICAgICAgICAgICAgICB2YWx1ZSA9IG9ialtuYW1lXTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpPTA7IGk8dmFsdWUubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJWYWx1ZSA9IHZhbHVlW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bGxTdWJOYW1lID0gbmFtZSArICdbJyArIGkgKyAnXSc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5uZXJPYmogPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbm5lck9ialtmdWxsU3ViTmFtZV0gPSBzdWJWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeSArPSBwYXJhbShpbm5lck9iaikgKyAnJic7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBPYmplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoc3ViTmFtZSBpbiB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlZhbHVlID0gdmFsdWVbc3ViTmFtZV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVsbFN1Yk5hbWUgPSBuYW1lICsgJ1snICsgc3ViTmFtZSArICddJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbm5lck9iaiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlubmVyT2JqW2Z1bGxTdWJOYW1lXSA9IHN1YlZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ICs9IHBhcmFtKGlubmVyT2JqKSArICcmJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmKHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ICs9IGVuY29kZVVSSUNvbXBvbmVudChuYW1lKSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkgKyAnJic7XG4gICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBxdWVyeS5sZW5ndGggPyBxdWVyeS5zdWJzdHIoMCwgcXVlcnkubGVuZ3RoIC0gMSkgOiBxdWVyeTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgdXJsOnVybCxcbiAgICAgICAgICAgICAgICBtZXRob2Q6J1BPU1QnLFxuICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEsXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm1SZXF1ZXN0OiBbZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYW5ndWxhci5pc09iamVjdChkYXRhKSAmJiBTdHJpbmcoZGF0YSkgIT09ICdbb2JqZWN0IEZpbGVdJyA/IHBhcmFtKGRhdGEpIDogZGF0YTtcbiAgICAgICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldEdyYXBoRGF0YSgpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLlZJU1VBTElaQVRJT05fRU5EUE9JTlQ7XG4gICAgICAgICAgICB1cmwgKz0gJ2luZmx1eC9xdWVyeSc7XG4gICAgICAgICAgICB2YXIgY29uZmlnID0ge1xuICAgICAgICAgICAgICAgIHBhcmFtczoge1xuICAgICAgICAgICAgICAgICAgICBkYjpcInRlbGVncmFmXCIsXG4gICAgICAgICAgICAgICAgICAgIHE6XCJTRUxFQ1QgQnl0ZXNJbiwgQnl0ZXNPdXQsIEVuZHBvaW50SVAsIFByb3ZpZGVySVAgRlJPTSBodHRwanNvbl9zdmNzdGF0cyBXSEVSRSB0aW1lID4gbm93KCkgLSAxbSBHUk9VUCBCWSAqIExJTUlUIDFcIlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gbWFrZUdldCh1cmwsIGNvbmZpZyk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRTdHJ1Y3R1cmVEYXRhKCkge1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuVklTVUFMSVpBVElPTl9FTkRQT0lOVDtcbiAgICAgICAgICAgIHVybCArPSAnc2VydmljZXMnO1xuICAgICAgICAgICAgcmV0dXJuIG1ha2VHZXQodXJsKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGJ1aWxkV2hlcmVRdWVyeShwb2ludHMsIHR5cGUpIHtcbiAgICAgICAgICAgIHZhciBxdWVyeSA9IFwiKFwiO1xuICAgICAgICAgICAgcXVlcnkgKz0gdHlwZSArIFwiPVwiO1xuICAgICAgICAgICAgcXVlcnkgKz0gXCInXCIgKyBwb2ludHNbMF0gKyBcIicgXCI7XG4gICAgICAgICAgICAvL3N0YXJ0cyBhdCAxLCBzbyB3aWxsIG5vdCBydW4gaWYgbGVuZ3RoIGlzIDFcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgcG9pbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcXVlcnkgKz0gJ09SICc7XG4gICAgICAgICAgICAgICAgcXVlcnkgKz0gdHlwZSArIFwiPVwiO1xuICAgICAgICAgICAgICAgIHF1ZXJ5ICs9IFwiJ1wiICsgcG9pbnRzW2ldICsgXCInIFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcXVlcnkgKz0gXCIpXCI7XG4gICAgICAgICAgICByZXR1cm4gcXVlcnk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRFZGdlRGF0YShzb3VyY2VMaXN0LCB0YXJnZXRMaXN0LCB0aW1lKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WSVNVQUxJWkFUSU9OX0VORFBPSU5UO1xuICAgICAgICAgICAgdXJsICs9ICdpbmZsdXgvcXVlcnknO1xuXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICAgICAgZGIgOiBcInRlbGVncmFmXCIsXG4gICAgICAgICAgICAgICAgICAgIHE6IFwiU0VMRUNUIHN1bShcIiArICdCeXRlc091dCcgKyBcIikgZnJvbSBodHRwanNvbl9zdmNzdGF0cyBXSEVSRSB0aW1lID4gbm93KCkgLSAxNXMgQU5EIFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkoc291cmNlTGlzdCwgXCJFbmRwb2ludElQXCIpICtcIiBBTkQgXCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkodGFyZ2V0TGlzdCwgJ1Byb3ZpZGVySVAnKSBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIFwiR1JPVVAgQlkgdGltZSgyMHMpIExJTUlUIDE7IFNFTEVDVCBzdW0oXCIgKyAnQnl0ZXNJbicgKyBcIikgZnJvbSBodHRwanNvbl9zdmNzdGF0cyBXSEVSRSB0aW1lID4gbm93KCkgLSAxNXMgQU5EIFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkoc291cmNlTGlzdCwgJ1Byb3ZpZGVySVAnKSArXCIgQU5EIFwiIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHRhcmdldExpc3QsICdFbmRwb2ludElQJykgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBcIkdST1VQIEJZIHRpbWUoMjBzKSBmaWxsKDApIExJTUlUIDFcIlxuICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBtYWtlUG9zdCh1cmwsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgXG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0T2xkRWRnZURhdGEoc291cmNlTGlzdCwgdGFyZ2V0TGlzdCkge1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuVklTVUFMSVpBVElPTl9FTkRQT0lOVDtcbiAgICAgICAgICAgIHVybCArPSAnaW5mbHV4L3F1ZXJ5JztcbiAgICAgICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICBkYiA6IFwidGVsZWdyYWZcIixcbiAgICAgICAgICAgICAgICAgICAgcTogXCJTRUxFQ1Qgc3VtKFwiICsgJ0J5dGVzT3V0JyArIFwiKSBGUk9NIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDFtIEFORCBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHNvdXJjZUxpc3QsIFwiRW5kcG9pbnRJUFwiKSArXCIgQU5EIFwiIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHRhcmdldExpc3QsIFwiUHJvdmlkZXJJUFwiKSBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIFwiIEdST1VQIEJZIHRpbWUoMTBzKSBmaWxsKDApIExJTUlUIDY7IFNFTEVDVCBzdW0oXCIgKyAnQnl0ZXNJbicgKyBcIikgRlJPTSBodHRwanNvbl9zdmNzdGF0cyBXSEVSRSB0aW1lID4gbm93KCkgLSAxbSBBTkQgXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeShzb3VyY2VMaXN0LCBcIlByb3ZpZGVySVBcIikgK1wiIEFORCBcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeSh0YXJnZXRMaXN0LCBcIkVuZHBvaW50SVBcIikgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBcIiBHUk9VUCBCWSB0aW1lKDEwcykgZmlsbCgwKSBMSU1JVCA2XCJcbiAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gbWFrZVBvc3QodXJsLCBkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRHcmFwaERhdGE6IGdldEdyYXBoRGF0YSxcbiAgICAgICAgICAgIGdldFN0cnVjdHVyZURhdGE6IGdldFN0cnVjdHVyZURhdGEsXG4gICAgICAgICAgICBnZXRFZGdlRGF0YTogZ2V0RWRnZURhdGEsXG4gICAgICAgICAgICBnZXRPbGRFZGdlRGF0YTogZ2V0T2xkRWRnZURhdGFcbiAgICAgICAgfVxuICAgIH1dKTtcblxuXG5cblxuXG5cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
=======
'use strict';

/**
 * Defining the Graph Module.
 * See DESIGN.md for info on Graph Objects.
 */
angular.module('contiv.graph', []);
angular.module("contiv.directives", []);
//# sourceMappingURL=module.js.map
'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/**
 * The base class the DataSource object.
 * 
 * The DataSource object takes in node and link data from the server, 
 * and provides methods for converting and manipulating the data for
 * the graph object.
 * 
 * To write your own DataSource object, create a new factory that uses the 
 * DataSource you want to inherit as a dependency, and extend 
 * its DataSource class. 
 * Return the class object with DataSource as key.
 * 
 * Node data is expected to be in the following format:
 * {id:node_id, text:node_text}
 * 
 * Link data is expected to be in the following format:
 * {source: sourceNodeId, target: targetNodeId}
 * 
 */
angular.module('contiv.graph').factory('DataSource', ['Node', 'Link', function (Node, Link) {
	var DataSource = function () {
		/**
   * Constructs the object.
   *
   * @param      {Array}   nodes              The node data 
   * @param      {Array}   links              The link data
   */
		function DataSource(nodes, links) {
			_classCallCheck(this, DataSource);

			this.nodes = nodes;
			this.links = links;
		}

		/**
   * Replaces the node data
   *
   * @param      {Node}  nodes   The nodes
   */


		_createClass(DataSource, [{
			key: 'updateNodes',
			value: function updateNodes(nodes) {
				this.nodes = nodes;
			}

			/**
    * Replaces the link data
    *
    * @param      {Link}  links   The links
    */

		}, {
			key: 'updateLinks',
			value: function updateLinks(links) {
				this.links = links;
			}

			/**
    * Returns the Name attribute of the Node with the 
    * matching id
    *
    * @param      {string}  id      The identifier
    * @return     {string}  name of the matching node
    */

		}, {
			key: 'nodeIdToName',
			value: function nodeIdToName(id) {
				var nodes = this.nodes;
				for (var i = 0; i < nodes.length; i++) {
					if (nodes[i].id == id) {
						return nodes[i].name;
					}
				}
			}

			/**
    * process the nodeData to create Node objects
    *
    * @param      {Array}  nodeData  NodeData to convert 
    *                                to node objects
    * @return     {Array}  Node objects
    */

		}, {
			key: 'processNodeData',
			value: function processNodeData(nodeData) {
				var nodes = [];
				_.forEach(nodeData, function (data) {
					var newNode = new Node.Node(null, null, data.id, data.text, null);
					nodes.push(newNode);
				});
				return nodes;
			}

			/**
    * process the linkData
    *
    * @param      {Array}  linkData  The link data
    * @param      {Array}  nodes     The nodes from processNodeData
    * @return     {Array}  Link objects
    */

		}, {
			key: 'processLinkData',
			value: function processLinkData(linkData, nodes) {
				/**
     * Returns the node that matches the id
     *
     * @param      {string} id      The identifier
     * @return     {Node}   The node with the matching id
     */
				function findNodeById(id, nodes) {
					for (var i = 0; i < nodes.length; i++) {
						if (id == nodes[i].id) {
							return nodes[i];
						}
					}
				}

				var links = [];
				//transforming link data
				for (var i = 0; i < linkData.length; i++) {
					if (linkData[i].source != linkData[i].target) {
						var source = findNodeById(linkData[i].source, nodes);
						var target = findNodeById(linkData[i].target, nodes);
						if (source == null || target == null) {
							continue;
						}
						var link = new Link.Link(source, target);
						links.push(link);
					}
				}
				return links;
			}
		}]);

		return DataSource;
	}();

	return {
		DataSource: DataSource
	};
}]);
/**
 * Created by vjain3 on 3/14/16.
 */
angular.module('contiv.models', []);
var ContivGlobals = (function () {
    return {
        //REST endpoints for NETMASTER
        'NETWORKS_ENDPOINT': '/netmaster/api/v1/networks/',
        'NETWORKS_INSPECT_ENDPOINT': '/netmaster/api/v1/inspect/networks/',
        'SERVICELBS_INSPECT_ENDPOINT': '/netmaster/api/v1/inspect/serviceLBs/',
        'POLICIES_ENDPOINT': '/netmaster/api/v1/policys/',
        'RULES_ENDPOINT': '/netmaster/api/v1/rules/',
        'APPLICATIONGROUPS_ENDPOINT': '/netmaster/api/v1/endpointGroups/',
        'SERVICELBS_ENDPOINT': '/netmaster/api/v1/serviceLBs/',
        'ORGANIZATIONS_ENDPOINT': '/netmaster/api/v1/tenants/',
        'NETWORK_SETTINGS_ENDPOINT': '/netmaster/api/v1/globals/',
        'NETPROFILES_ENDPOINT': '/netmaster/api/v1/netprofiles/',
        'BGPS_ENDPOINT': '/netmaster/api/v1/Bgps/',
        'BGPS_INSPECT_ENDPOINT': '/netmaster/api/v1/inspect/Bgps/',
        'VISUALIZATION_ENDPOINT': '/visualization/',
        //REST endpoints for VOLMASTER
        'VOLUMES_ENDPOINT': '/volmaster/volumes/',
        'VOLUMES_CREATE_ENDPOINT': '/volmaster/volumes/create/',
        'VOLUMES_DELETE_ENDPOINT': '/volmaster/volumes/remove/',
        'VOLUMES_COPYSNAPSHOTS_ENDPOINT': '/volmaster/volumes/copy',
        'VOLUMES_USES_ENDPOINT': '/volmaster/uses/mounts/',
        'VOLUMES_SNAPSHOTS_ENDPOINT': '/volmaster/snapshots/',
        'STORAGEPOLICIES_ENDPOINT': '/volmaster/policies/',
        'VOLUMES_GLOBAL_ENDPOINT': '/volmaster/global/',
        //REST endpoints for CLUSTER
        'NODES_LIST_ENDPOINT': '/info/nodes',
        'NODES_DISCOVER_ENDPOINT': '/discover/nodes',
        'NODES_COMMISSION_ENDPOINT': '/commission/nodes',
        'NODES_DECOMMISSION_ENDPOINT': '/decommission/nodes',
        'NODES_MAINTENANCE_ENDPOINT': '/maintenance/nodes',
        'NODES_LAST_JOB_ENDPOINT': '/info/job/last',
        'NODES_ACTIVE_JOB_ENDPOINT': '/info/job/active',
        'NODES_SETTINGS_SET_ENDPOINT': '/globals',
        'NODES_SETTINGS_GET_ENDPOINT': '/info/globals',
        //Refresh interval in milliseconds
        'REFRESH_INTERVAL': 5000,
        //RegEx for validation
        'CIDR_REGEX': '^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\/([0-9]|[1-2][0-9]|3[0-2]))$',
        'VLAN_REGEX': '^([0-9]{1,4}?-[0-9]{1,4}?)$',
        'VXLAN_REGEX': '^([0-9]{1,8}?-[0-9]{1,8}?)$',
        'NUMBER_REGEX': '^[0-9]*$'
    };
})();
//# sourceMappingURL=module.js.map
'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

/**
 * The DataSource used for the visualization tab.
 * 
 * Node Data from the server is expected to be in the following format:
 * {id: node_id, text: node_text}
 * Parent and Ancestor attributes can be set by calling setAncestors
 * 
 * Link Data from the server is expected to be in the following format:
 * {source: sourceNodeId, target: targetNodeId, weight: linkWeight}
 * 
 */
angular.module('contiv.graph').factory('VisualizerDataSource', ['DataSource', 'VisualizerNode', 'VisualizerLink', function (DataSource, VisualizerNode, VisualizerLink) {
	var VisualizerDataSource = function (_DataSource$DataSourc) {
		_inherits(VisualizerDataSource, _DataSource$DataSourc);

		/**
   * Constructs the object.
   * 
   * Children Struct and ancestors_struct are JSON objects,
   * mapping a node Id to a list of it's children or ancestors.
   * Children Struct is also expected to have a field called
   * topLevel, that maps to a list of all the nodes that don't
   * have any parents.
   *
   * @param      {Array}   nodes              The node data 
   * @param      {Array}   links              The link data
   * @param      {Object}  children_struct    The children structure
   * @param      {Object}  ancestors_struct   The ancestors structure
   * @param      {Array}   labels             The labels
   * @param      {Array}   selectors          The selectors
   */
		function VisualizerDataSource(nodes, links, children_struct, ancestors_struct, labels, selectors) {
			_classCallCheck(this, VisualizerDataSource);

			var _this = _possibleConstructorReturn(this, (VisualizerDataSource.__proto__ || Object.getPrototypeOf(VisualizerDataSource)).call(this, nodes, links));

			_this.children_struct = children_struct;
			_this.ancestors_struct = ancestors_struct;
			_this.labels = labels;
			_this.selectors = selectors;
			return _this;
		}

		/**
   * Determines if it has child.
   *
   * @param      {string}   id      The identifier
   * @return     {boolean}  True if has child, False otherwise.
   */


		_createClass(VisualizerDataSource, [{
			key: 'hasChild',
			value: function hasChild(id) {
				if (this.children_struct[id] == null) {
					return false;
				}
				return true;
			}

			/**
    * Sets the parent and ancestors attribute using 
    * ancestors_struct for all the nodes
    * Also adds any nodes without ancestors, that aren't 
    * toplevel to the client service.
    */

		}, {
			key: 'setAncestors',
			value: function setAncestors() {
				var thisDataSource = this;
				var addedClient = false;
				_.forEach(thisDataSource.nodes, function (node) {
					node.ancestors = thisDataSource.ancestors_struct[node.id] || [];
					if (_.isEmpty(node.ancestors) === false) {
						node.parent = node.ancestors[0];
					} else {
						if (_.includes(thisDataSource.children_struct.topLevel, node.id) == false) {
							//container has no parent
							//adding to client
							node.ancestors.push("client");
							thisDataSource.ancestors_struct[node.id] = ["client"];
							if (addedClient === false) {
								addedClient = true;
								thisDataSource.children_struct.topLevel.push("client");
								thisDataSource.children_struct['client'] = [];
							}
							thisDataSource.children_struct['client'].push(node.id);
						}
					}
				});
			}

			/**
    * Returns the flow between the highest level grouping
    *
    * @return     {Object}  The top level flow.
    */

		}, {
			key: 'getTopLevelFlow',
			value: function getTopLevelFlow() {
				return this.getFlowBetweenSet(this.children_struct.topLevel);
			}

			/**
    * Gets the flow between any set of node levels
    *
    * @param      {Array}  node_names  The node names in the set
    * @return     {Object}  The flow between set.
    */

		}, {
			key: 'getFlowBetweenSet',
			value: function getFlowBetweenSet(node_names) {
				var local_nodes = this.nodes;
				var idMapping = {};
				for (var i = 0; i < local_nodes.length; i++) {
					var node = local_nodes[i];

					//if node is already at its highest level
					if (node.ancestors === null) {
						idMapping[node.id] = node.name;
					} else {
						//check to see which tags are present in the ancestor list
						for (var j = 0; j < node_names.length; j++) {
							if (node.ancestors.indexOf(node_names[j]) > -1) {
								idMapping[node.id] = node_names[j];
								break;
							}
						}
					}
				}
				//modify links
				var links = this.links;
				var linkData = [];

				for (var i = 0; i < links.length; i++) {
					var link = [];
					link.source = idMapping[links[i].source] || links[i].source;
					link.target = idMapping[links[i].target] || links[i].target;
					link.weight = links[i].weight;
					linkData.push(link);
				}

				//creating the nodeData
				var nodeData = [];
				for (var i = 0; i < node_names.length; i++) {
					var node_to_add = [];
					node_to_add.id = node_names[i];
					node_to_add.text = this.nodeIdToName(node_names[i]) || node_names[i];

					node_to_add.ancestors = this.ancestors_struct[node_names[i]] || this.ancestors_struct[node_to_add.text] || [];
					if (_.isEmpty(node_to_add.ancestors) === false) {
						node_to_add.parent = node_to_add.ancestors[0];
					} else {
						node_to_add.parent = null;
					}
					nodeData.push(node_to_add);
				}

				return { nodeData: nodeData, linkData: linkData };
			}

			/**
    * process the nodeData output of getFlowBetweenSet
    *
    * @param      {Array}  nodeData  NodeData to convert 
    *                                to node objects
    * @return     {Array}  Node objects
    */

		}, {
			key: 'processNodeData',
			value: function processNodeData(nodeData) {
				var nodes = [];
				_.forEach(nodeData, function (data) {
					var newNode = new VisualizerNode.Node(null, null, data.id, data.text, null, data.parent, data.ancestors, null, null);
					nodes.push(newNode);
				});
				return nodes;
			}

			/**
    * process the linkData output of getFlowBetweenSet
    *
    * @param      {Array}  linkData  The link data
    * @param      {Array}  nodes     The nodes
    * @return     {Array}  Link objects
    */

		}, {
			key: 'processLinkData',
			value: function processLinkData(linkData, nodes) {
				/**
     * Returns the node that matches the id
     *
     * @param      {string} id      The identifier
     * @return     {Node}   The node with the matching id
     */
				function findNodeById(id, nodes) {
					for (var i = 0; i < nodes.length; i++) {
						if (id == nodes[i].id) {
							return nodes[i];
						}
					}
				}

				var links = [];
				//a mapping from source.id-target.id to the link added
				var added_links = {};
				//transforming link data
				for (var i = 0; i < linkData.length; i++) {
					if (linkData[i].source != linkData[i].target) {
						var source = findNodeById(linkData[i].source, nodes);
						var target = findNodeById(linkData[i].target, nodes);
						var weight = linkData[i].weight;
						//in order to sum all the weights of the links of the sub-nodes,
						//we use added_links to keep track if an link was added
						//if it is, we modify its weight
						if (source == null || target == null) {
							continue;
						}
						if (added_links[source.id + '-' + target.id] === undefined) {
							var link = new VisualizerLink.Link(source, target, weight);
							added_links[source.id + '-' + target.id] = link;
							links.push(link);
						} else {
							var existing_link = added_links[source.id + '-' + target.id];
							existing_link.setWeight(existing_link.getRawWeight() + weight);
							existing_link.increaseCount();
						}
					}
				}
				return links;
			}
		}]);

		return VisualizerDataSource;
	}(DataSource.DataSource);

	return {
		DataSource: VisualizerDataSource
	};
}]);
/**
 * Created by vjain3 on 5/18/16.
 */
angular.module('contiv.utils', []);
//# sourceMappingURL=module.js.map
'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/**
 * The base class the graph object. Any nodes or links that are contained in
 * its nodes or links property will be drawn on updateGraph.
 * Supports policies.
 * 
 * To write your own graph object, create a new factory that uses the graph
 * you want to inherit as a dependency, and extend its graph class. 
 * Return the class object with Graph as key.
 * 
 */
angular.module('contiv.graph').factory('Graph', ['PolicyService', function (PolicyService) {
    var Graph = function () {
        /**
         * constructor for the graph
         *
         * @param      {HTML SVG}  svg     The svg that will 
         *                                 hold the graph
         * @param      {Array}  nodes      List of nodes for the graph
         * @param      {Array}  links      List of links for the graph
         */
        function Graph(svg, nodes, links) {
            _classCallCheck(this, Graph);

            var thisGraph = this;

            thisGraph.nodes = nodes || [];
            thisGraph.links = links || [];

            thisGraph.defaultNodePolicies = [];
            thisGraph.defaultPathPolicies = [];

            thisGraph.svgPolicy = new PolicyService.Policy();

            thisGraph.state = {
                canZoom: true,
                canPan: true,
                initForce: false,
                disableUpdate: false
            };

            thisGraph.consts = {
                circleGClass: "conceptG",
                graphClass: "graph",
                pathClass: "path",
                nodeClass: "circle",
                nodeText: "nodeText",
                startRadius: 50,
                maxRadius: 60,
                padding: 5,
                displayOffset: 60
            };

            svg.on("mouseover", function (d) {
                thisGraph.svgPolicy["mouseover"].call(this, d);
            }).on("dblclick", function (d) {
                thisGraph.svgPolicy["dblclick"].call(this, d);
            }).on("contextmenu", function (d) {
                thisGraph.svgPolicy["contextmenu"].call(this, d);
            }).on("mouseout", function (d) {
                thisGraph.svgPolicy["mouseout"].call(this, d);
            }).on("mousedown", function (d) {
                thisGraph.svgPolicy["mousedown"].call(this, d);
            }).on("mouseup", function (d) {
                thisGraph.svgPolicy["mouseup"].call(this, d);
            });

            // define arrow markers for graph links
            var defs = svg.append('svg:defs');
            defs.append('svg:marker').attr('id', 'end-arrow').attr("viewBox", "0 -5 10 10").attr("refX", 20).attr("refY", -1).attr("markerWidth", 6).attr("markerHeight", 6).attr("orient", "auto").append("path").attr("d", "M0,-5L10,0L0,5");

            // define arrow markers for leading arrow
            defs.append('svg:marker').attr('id', 'mark-end-arrow').attr('viewBox', '0 -5 10 10').attr('refX', 7).attr('markerWidth', 3.5).attr('markerHeight', 3.5).attr('orient', 'auto').append('svg:path').attr('d', 'M0,-5L10,0L0,5');

            thisGraph.svg = svg;
            thisGraph.svgG = svg.append("g").classed(thisGraph.consts.graphClass, true);
            var svgG = thisGraph.svgG;

            // svg nodes and links 
            thisGraph.paths = svgG.append("g").selectAll("g");
            thisGraph.circles = svgG.append("g").selectAll("g");
            thisGraph.initNodes();
            thisGraph.initLinks();

            thisGraph.setPositions();
            var resizeFunc = function resizeFunc() {
                thisGraph.onWindowResize(svg);
            };

            thisGraph.bindings = {
                resize: resizeFunc
            };
            $(window).resize(resizeFunc);
        }

        /**
         * calls the destroy method for all policies
         */


        _createClass(Graph, [{
            key: 'destroy',
            value: function destroy() {
                var thisGraph = this;
                _(thisGraph.defaultNodePolicies).forEach(function (policy) {
                    policy.destroy();
                });
                _(thisGraph.defaultPathPolicies).forEach(function (policy) {
                    policy.destroy();
                });
                thisGraph.svgPolicy.destroy();
                for (var key in thisGraph.bindings) {
                    $(window).off(key, thisGraph.bindings[key]);
                }
            }

            /**
             * Runs the init function for all the nodes
             */

        }, {
            key: 'initNodes',
            value: function initNodes() {
                var thisGraph = this;
                _.forEach(thisGraph.nodes, function (node) {
                    node.initialize(thisGraph);
                });
            }

            /**
             * Runs the init function for all the links
             */

        }, {
            key: 'initLinks',
            value: function initLinks() {
                var thisGraph = this;
                _.forEach(thisGraph.links, function (link) {
                    link.initialize(thisGraph);
                });
            }

            /**
             * returns the node matching the id, 
             * or undefined if there is none
             *
             * @param      {Object}  id      The identifier
             * @return     {Node}  { matching node }
             */

        }, {
            key: 'findNodeById',
            value: function findNodeById(id) {
                var thisGraph = this;
                for (var i = 0; i < thisGraph.nodes.length; i++) {
                    if (id === thisGraph.nodes[i].id) {
                        return thisGraph.nodes[i];
                    }
                }
            }
        }, {
            key: 'findD3Node',


            /**
             * Returns the d3Node object that matches the id,
             * or undefined if there is none
             *
             * @param      {string}  id      The identifier
             * @return     {D3Node} The d3 node
             */
            value: function findD3Node(id) {
                var thisGraph = this;
                var d3Node;
                thisGraph.circles.each(function (d) {
                    if (d.id === id) {
                        d3Node = d3.select(this);
                    }
                });
                return d3Node;
            }

            /**
             * Used to install a drag policy that will be called
             * when nodes are dragged
             *
             * @param      {d3.behavior.drag}  d3drag  D3 drag object
             */

        }, {
            key: 'installDragPolicy',
            value: function installDragPolicy(d3drag) {
                this.drag = d3drag;
            }

            /**
             * Used to install a policy that will be called 
             * when there is mouse interactions with the graph's svg
             *
             * @param      {Policy}  policy  The policy to install
             */

        }, {
            key: 'installSvgPolicy',
            value: function installSvgPolicy(policy) {
                this.svgPolicy = policy;
            }

            /**
             * Used to install policies that are called when there is
             * mouse interaction with a node
             *
             * @param      {Policy}  policy  The policy to install
             */

        }, {
            key: 'installDefaultNodePolicy',
            value: function installDefaultNodePolicy(policy) {
                var thisGraph = this;
                thisGraph.defaultNodePolicies.push(policy);
                policy.initialize(thisGraph);
            }

            /**
             * Used to remove an installed policy for nodes
             *
             * @param      {Node}  policyRemove  The policy to remove
             */

        }, {
            key: 'uninstallDefaultNodePolicy',
            value: function uninstallDefaultNodePolicy(policyRemove) {
                var policyRemoveName;
                if (typeof policyRemove === 'string') {
                    policyRemoveName = policyRemove;
                } else {
                    policyRemoveName = policyRemove.policyName;
                }
                _(thisGraph.defaultNodePolicies).forEach(function (policy, index) {
                    if (policy.policyName === policyRemoveName) {
                        policy.destroy();
                        thisGraph.defaultNodePolicies.splice(index, 1);
                    }
                });
            }

            /**
             * Returns the node policy object with the given name
             *
             * @param      {string}  policyName  The policy name
             * @return     {Policy}  policy      The matching policy
             */

        }, {
            key: 'getNodePolicy',
            value: function getNodePolicy(policyName) {
                var thisGraph = this;

                _(thisGraph.defaultNodePolicies).forEach(function (policy, index) {
                    if (policy.policyName === policyName) {
                        return policy;
                    }
                });
            }

            /**
             * Used to install policies that are called when there is a
             * mouse interaction with a path
             *
             * @param      {Policy}  policy  The policy to install
             */

        }, {
            key: 'installDefaultPathPolicy',
            value: function installDefaultPathPolicy(policy) {
                var thisGraph = this;
                thisGraph.defaultPathPolicies.push(policy);
                policy.initialize(thisGraph);
            }

            /**
             * Used to remove an installed policy for links
             *
             * @param      {Policy}  policyRemove  The policy to remove
             */

        }, {
            key: 'uninstallDefaultPathPolicy',
            value: function uninstallDefaultPathPolicy(policyRemove) {
                var policyRemoveName;
                var thisGraph = this;
                if (typeof policyRemove === 'string') {
                    policyRemoveName = policyRemove;
                } else {
                    policyRemoveName = policyRemove.policyName;
                }
                _(thisGraph.defaultPathPolicies).forEach(function (policy, index) {
                    if (policy.policyName === policyRemoveName) {
                        policy.destroy();
                        thisGraph.defaultPathPolicies.splice(index, 1);
                    }
                });
            }

            /**
             * Called when there is a mouse interaction with a path
             * Propogates the event to all installed path policies
             *
             * @param      {string}  event   The event type
             * @param      {d3object}  d3path  The d3 path
             * @param      {Path}  d       The matching Link object
             */

        }, {
            key: 'pathPolicyEvent',
            value: function pathPolicyEvent(event, d3path, d) {
                var thisGraph = this;
                _(thisGraph.defaultPathPolicies).forEach(function (policy) {
                    policy[event](d3path, d);
                });
            }

            /**
             * Called when there is a mouse interaction with a node
             * Propogates the event to all installed node policies
             * 
             * @param      {string}  event   The event type
             * @param      {d3object}  d3node  The d3 node
             * @param      {Path}  d       The matching Node object
             */

        }, {
            key: 'nodePolicyEvent',
            value: function nodePolicyEvent(event, d3node, d) {
                var thisGraph = this;
                _.forEach(thisGraph.defaultNodePolicies, function (policy) {
                    policy[event](d3node, d);
                });
            }

            /**
             * Sets pan and zoom rules for the graph
             *
             * @param      {d3.behavior.zoom}  d3zoom  D3 zoom obj
             */

        }, {
            key: 'installZoomPolicy',
            value: function installZoomPolicy(d3zoom) {
                this.dragSvg = d3zoom;
                this.svg.call(this.dragSvg);
            }

            /**
             * Called when the window is resized
             * Hook for overriding in subclasses
             *
             * @param      {HTML SVG}  svg     The svg that the handler
             *                                 is attached to
             */

        }, {
            key: 'onWindowResize',
            value: function onWindowResize(svg) {}

            /**
             * Inserts line breaks in node text
             *
             * @param      {HTML Elem}  gEl    The elem to add text to
             * @param      {string}  title   The title
             */

        }, {
            key: 'insertTitleLinebreaks',
            value: function insertTitleLinebreaks(gEl, title) {
                var thisGraph = this;
                var words = title.split(/\s+/g),
                    nwords = words.length;
                var el = gEl.append("text").attr('class', thisGraph.consts.nodeText).attr("text-anchor", "middle").attr("dy", "-" + (nwords - 1) * 7.5);

                for (var i = 0; i < words.length; i++) {
                    var tspan = el.append('tspan').text(words[i]);
                    if (i > 0) tspan.attr('x', 0).attr('dy', '15');
                }
            }

            /**
             * Removes all links from the given node
             *
             * @param      {Node}  node    The node
             */

        }, {
            key: 'spliceLinksForNode',
            value: function spliceLinksForNode(node) {
                var thisGraph = this,
                    toSplice = thisGraph.links.filter(function (l) {
                    return l.source === node || l.target === node;
                });
                toSplice.map(function (l) {
                    thisGraph.links.splice(thisGraph.links.indexOf(l), 1);
                });
            }

            /**
             * Adds the node to the graph and updates
             *
             * @param      {Node}  node    The node
             */

        }, {
            key: 'addNode',
            value: function addNode(node) {
                var thisGraph = this;
                thisGraph.nodes.push(node);
                node.initialize(thisGraph);
                thisGraph.updateGraph();
            }
        }, {
            key: 'removeNode',


            /**
             * Removes the node to the graph and updates
             *
             * @param      {Node}  node    The node
             */
            value: function removeNode(node) {
                var thisGraph = this;
                thisGraph.nodes.splice(thisGraph.nodes.indexOf(node), 1);
                thisGraph.spliceLinksForNode(node);

                thisGraph.updateGraph();
            }
        }, {
            key: 'addLink',


            /**
             * Adds the link to the graph and updates
             *
             * @param      {link}  link    The link
             */
            value: function addLink(link) {
                var thisGraph = this;
                thisGraph.links.push(link);
                link.initialize(thisGraph);
                thisGraph.updateGraph();
            }
        }, {
            key: 'removeLink',


            /**
             * Removes the link to the graph and updates
             *
             * @param      {link}  link    The link
             */
            value: function removeLink(link) {
                var thisGraph = this;
                thisGraph.links.splice(thisGraph.links.indexOf(link), 1);
                link.initialize(thisGraph);
                thisGraph.updateGraph();
            }

            /**
             * Called when the graph is updating existing paths
             *
             * @param      {Path}  paths   List of paths
             */

        }, {
            key: 'updateExistingPaths',
            value: function updateExistingPaths(paths) {
                paths.each(function (d) {
                    d.updateAttr(d3.select(this), d);
                });
            }

            /**
             * Called when the graph is adding new paths
             *
             * @param      {Path}  newPaths  List of new paths
             */

        }, {
            key: 'updateNewPaths',
            value: function updateNewPaths(newPaths) {
                var thisGraph = this;

                thisGraph.initLinks();

                newPaths.each(function (d) {
                    d.newPathAttr(d3.select(this), d);
                });

                //if node doesn't have its own policy, use default for the graph
                newPaths.on("mouseover", function (d) {
                    if (d.hasPolicy) {
                        d.pathPolicyEvent("mouseover", d3.select(this), d);
                    } else {
                        thisGraph.pathPolicyEvent("mouseover", d3.select(this), d);
                    }
                }).on("dblclick", function (d) {
                    if (d.hasPolicy) {
                        d.pathPolicyEvent("dblclick", d3.select(this), d);
                    } else {
                        thisGraph.pathPolicyEvent("dblclick", d3.select(this), d);
                    }
                }).on("contextmenu", function (d) {
                    if (d.hasPolicy) {
                        d.pathPolicyEvent("contextmenu", d3.select(this), d);
                    } else {
                        thisGraph.pathPolicyEvent("contextmenu", d3.select(this), d);
                    }
                }).on("mouseout", function (d) {
                    if (d.hasPolicy) {
                        d.pathPolicyEvent("mouseout", d3.select(this), d);
                    } else {
                        thisGraph.pathPolicyEvent("mouseout", d3.select(this), d);
                    }
                }).on("mousedown", function (d) {
                    if (d.hasPolicy) {
                        d.pathPolicyEvent("mousedown", d3.select(this), d);
                    } else {
                        thisGraph.pathPolicyEvent("mousedown", d3.select(this), d);
                    }
                }).on("mouseup", function (d) {
                    if (d.hasPolicy) {
                        d.pathPolicyEvent("mouseup", d3.select(this), d);
                    } else {
                        thisGraph.pathPolicyEvent("mouseup", d3.select(this), d);
                    }
                }).call(thisGraph.drag);
            }

            /**
             * Called when the graph is updating existing nodes
             */

        }, {
            key: 'updateExistingNodes',
            value: function updateExistingNodes() {
                var thisGraph = this;
                thisGraph.circles = this.circles.data(thisGraph.nodes, function (d) {
                    return d.id;
                }).each(function (d) {
                    d.updateAttr(d3.select(this), d);
                });
            }

            /**
             * Called when the graph is adding new nodes
             *
             * @param      {Node}  newNodes  List of new nodes
             */

        }, {
            key: 'updateNewNodes',
            value: function updateNewNodes(newNodes) {
                var thisGraph = this;

                newNodes.each(function (d) {
                    if (d.graph == null) {
                        d.initialize(thisGraph);
                    }
                    d.newNodeAttr(d3.select(this), d);
                });

                //if node doesn't have its own policy, use default for the graph
                newNodes.on("mouseover", function (d) {
                    if (d.hasPolicy) {
                        d.nodePolicyEvent("mouseover", d3.select(this), d);
                    } else {
                        thisGraph.nodePolicyEvent("mouseover", d3.select(this), d);
                    }
                }).on("dblclick", function (d) {
                    if (d.hasPolicy) {
                        d.nodePolicyEvent("dblclick", d3.select(this), d);
                    } else {
                        thisGraph.nodePolicyEvent("dblclick", d3.select(this), d);
                    }
                }).on("contextmenu", function (d) {
                    if (d.hasPolicy) {
                        d.nodePolicyEvent("contextmenu", d3.select(this), d);
                    } else {
                        thisGraph.nodePolicyEvent("contextmenu", d3.select(this), d);
                    }
                }).on("mouseout", function (d) {
                    if (d.hasPolicy) {
                        d.nodePolicyEvent("mouseout", d3.select(this), d);
                    } else {
                        thisGraph.nodePolicyEvent("mouseout", d3.select(this), d);
                    }
                }).on("mousedown", function (d) {
                    if (d.hasPolicy) {
                        d.nodePolicyEvent("mousedown", d3.select(this), d);
                    } else {
                        thisGraph.nodePolicyEvent("mousedown", d3.select(this), d);
                    }
                }).on("mouseup", function (d) {
                    if (d.hasPolicy) {
                        d.nodePolicyEvent("mouseup", d3.select(this), d);
                    } else {
                        thisGraph.nodePolicyEvent("mouseup", d3.select(this), d);
                    }
                }).call(thisGraph.drag);

                newNodes.append("circle").attr("r", function (d) {
                    return String(d.radius);
                });

                newNodes.each(function (d) {
                    thisGraph.insertTitleLinebreaks(d3.select(this), d.text);
                });
            }

            /**
             * Prevents nodes from colliding
             *
             * @param      {number}  alpha   Affects how much change
             *                               the collision causes
             * @return     {boolean}  {Whether nodes are collided}
             */

        }, {
            key: 'd3ForceCollide',
            value: function d3ForceCollide(alpha) {
                var thisGraph = this,
                    consts = thisGraph.consts;
                var nodes = thisGraph.nodes;
                var quadtree = d3.geom.quadtree(nodes);
                return function (d) {
                    var r = d.radius + consts.maxRadius + consts.padding,
                        nx1 = d.x - r,
                        nx2 = d.x + r,
                        ny1 = d.y - r,
                        ny2 = d.y + r;
                    quadtree.visit(function (quad, x1, y1, x2, y2) {
                        if (quad.point && quad.point !== d) {
                            var x = d.x - quad.point.x,
                                y = d.y - quad.point.y,
                                l = Math.sqrt(x * x + y * y),
                                r = d.radius + quad.point.radius + consts.padding;
                            if (l < r) {
                                l = (l - r) / l * alpha;
                                d.x -= x *= l;
                                d.y -= y *= l;
                                quad.point.x += x;
                                quad.point.y += y;
                            }
                        }
                        return x1 > nx2 || x2 < nx1 || y1 > ny2 || y2 < ny1;
                    });
                };
            }

            /**
             * Tick of the d3 force simulation
             *
             * @param      {D3tick event}  e    D3tick event
             * @param      {number}  width  The width of the simulation
             * @param      {number}  height The height of the simulation
             */

        }, {
            key: 'd3ForceTick',
            value: function d3ForceTick(e, width, height) {
                var thisGraph = this,
                    consts = thisGraph.consts;

                var offset = consts.displayOffset;
                var nodes = thisGraph.nodes;
                var q = d3.geom.quadtree(thisGraph.nodes),
                    i = 0,
                    n = nodes.length;

                while (++i < n) {
                    q.visit(this.d3ForceCollide(nodes[i]));
                }

                thisGraph.circles.each(this.d3ForceCollide(.5)).attr("cx", function (d) {
                    return d.x = Math.max(d.radius + offset, Math.min(width - offset - d.radius, d.x));
                }).attr("cy", function (d) {
                    return d.y = Math.max(d.radius + offset, Math.min(height - offset - d.radius, d.y));
                });

                thisGraph.paths.attr('x1', function (d) {
                    return d.source.x;
                }).attr('y1', function (d) {
                    return d.source.y;
                }).attr('x2', function (d) {
                    return d.target.x;
                }).attr('y2', function (d) {
                    return d.target.y;
                });
            }

            /**
             * Starts on start of the force simulation
             */

        }, {
            key: 'd3ForceStart',
            value: function d3ForceStart() {
                var thisGraph = this;
                thisGraph.paths.attr('x1', function (d) {
                    return d.source.x;
                }).attr('y1', function (d) {
                    return d.source.y;
                }).attr('x2', function (d) {
                    return d.target.x;
                }).attr('y2', function (d) {
                    return d.target.y;
                });
            }

            /**
             * Called on the end of the force simulation
             */

        }, {
            key: 'd3ForceEnd',
            value: function d3ForceEnd() {
                var thisGraph = this;
                thisGraph.circles.attr('cx', function (d) {
                    return d.x;
                }).attr('cy', function (d) {
                    return d.y;
                });

                thisGraph.paths.attr('x1', function (d) {
                    return d.source.x;
                }).attr('y1', function (d) {
                    return d.source.y;
                }).attr('x2', function (d) {
                    return d.target.x;
                }).attr('y2', function (d) {
                    return d.target.y;
                });
            }

            /**
             * Calculates the width and height bounds for the 
             * force simulation
             *
             * @return     {Object}  width and height as properties 
             */

        }, {
            key: 'd3ForceBounds',
            value: function d3ForceBounds() {
                var svgWidth = $('#visualization-graph').width();
                var svgHeight = $('#visualization-graph').height();

                var width = svgWidth;
                var height = svgHeight;
                return { width: width, height: height };
            }

            /**
             * Does a d3 force simulation
             *
             * @param      {Function}  callback  The callback
             */

        }, {
            key: 'setForce',
            value: function setForce(callback) {
                var thisGraph = this;

                var nodes = thisGraph.nodes;
                var links = thisGraph.links;
                if (_.isEmpty(nodes)) {
                    return;
                }

                var bounds = thisGraph.d3ForceBounds();

                var force = d3.layout.force().size([bounds.width, bounds.height]).nodes(nodes).charge(function (d) {
                    return -6000;
                }).links(links);

                force.linkDistance(bounds.width / 3);
                force.linkStrength(.2);
                force.gravity(.2);

                force.on('tick', function (e) {
                    thisGraph.d3ForceTick.call(thisGraph, e, bounds.width, bounds.height);
                });

                force.on('start', function () {
                    thisGraph.d3ForceStart.call(thisGraph);
                });

                force.on('end', function () {
                    thisGraph.d3ForceEnd.call(thisGraph);
                });

                force.start();
                var k = 0;
                while (force.alpha() > 1e-2 && k < 150) {
                    force.tick();
                    k = k + 1;
                }
                force.stop();

                if (callback != null) {
                    callback();
                }
            }

            /**
             * Sets the positions to be the center of the screen if 
             * not provided
             * also sets the radius of the nodes
             */

        }, {
            key: 'setPositions',
            value: function setPositions() {
                var thisGraph = this;

                var offset = thisGraph.consts.displayOffset;
                var svgWidth = $('#visualization-graph').width();
                var svgHeight = $('#visualization-graph').height();

                var width = svgWidth - 2 * offset;
                var height = svgHeight - 2 * offset;

                var nodes = thisGraph.nodes;

                for (var i = 0; i < nodes.length; i++) {
                    nodes[i].radius = nodes[i].radius || thisGraph.consts.startRadius;
                    if (nodes[i].x == null || nodes[i].y == null) {
                        // nodes[i].xStart = width/2  + nodes[i].radius + offset
                        nodes[i].x = width / 2 + nodes[i].radius + offset;
                        // nodes[i].yStart = height/2 + nodes[i].radius + offset
                        nodes[i].y = height / 2 + nodes[i].radius + offset;
                    }
                }
            }

            /**
             * Called to update the view of the graph when
             * data changes
             *
             * @param      {Function}  callback  The callback
             */

        }, {
            key: 'updateGraph',
            value: function updateGraph(callback) {
                var thisGraph = this,
                    consts = thisGraph.consts,
                    state = thisGraph.state;

                if (thisGraph.state.disableUpdate) {
                    return;
                }

                this.updateExistingNodes();
                var newGs = thisGraph.circles.enter().append("g");

                // console.log('update', newGs);
                newGs.classed(consts.circleGClass, true);

                // this.updateNewNodes(newGs);

                // remove old nodes
                thisGraph.circles.exit().remove();

                if (state.initForce == false) {
                    thisGraph.setForce(function () {
                        thisGraph.updateNewNodes.call(thisGraph, newGs);
                    });
                    state.initForce = true;
                } else {
                    this.updateNewNodes(newGs);
                }

                thisGraph.paths = thisGraph.paths.data(thisGraph.links, function (d) {
                    return String(d.source.id) + "+" + String(d.target.id);
                });
                var paths = thisGraph.paths;
                this.updateExistingPaths(paths);

                var newpaths = paths.enter().append("path").style('marker-end', 'url(#end-arrow)').classed("link", true);
                this.updateNewPaths(newpaths);

                // remove old links
                paths.exit().remove();

                if (callback != null) {
                    callback();
                }
            }
        }]);

        return Graph;
    }();

    return {
        Graph: Graph
    };
}]);
/**
 * Created by vjain3 on 5/18/16.
 */
angular.module('contiv.applicationgroups', ['contiv.models', 'contiv.directives', 'contiv.utils'])
    .config(['$stateProvider', function ($stateProvider) {
        $stateProvider
            .state('contiv.menu.applicationgroups', {
            url: '/applicationgroups',
            abstract: true,
            template: '<div ui-view class="ui container"/>'
        })
            .state('contiv.menu.applicationgroups.create', {
            url: '/create',
            component: 'applicationgroupcreate'
        })
            .state('contiv.menu.applicationgroups.details', {
            url: '/details/:key',
            component: 'applicationgroupdetails'
        })
            .state('contiv.menu.applicationgroups.edit', {
            url: '/edit/:key',
            component: 'applicationgroupdetails'
        })
            .state('contiv.menu.applicationgroups.list', {
            url: '/list',
            component: 'applicationGrouplist'
        });
    }]);
//# sourceMappingURL=module.js.map
'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

/**
 * The graph that is used specifically for the visualization tab.
 */
angular.module('contiv.graph').factory('VisualizerGraph', ['Graph', function (Graph) {
    var VisualizerGraph = function (_Graph$Graph) {
        _inherits(VisualizerGraph, _Graph$Graph);

        /**
         * Constructs the object.
         *
         * @param   {HTML SVG}  svg             The svg that will 
               *                                      hold the graph
               * @param   {Array}  nodes   		    List of nodes
               * @param   {Array}  links   		    List of links
         * @param   {DataSource}  dataSource    The data source
         */
        function VisualizerGraph(svg, nodes, links, dataSource) {
            _classCallCheck(this, VisualizerGraph);

            var _this = _possibleConstructorReturn(this, (VisualizerGraph.__proto__ || Object.getPrototypeOf(VisualizerGraph)).call(this, svg, nodes, links));

            var thisGraph = _this;

            //holds current transitions that are occuring
            thisGraph.state.transition = [];
            //Min distance between nodes when spawning randomly
            thisGraph.consts.edge_buffer = 200;
            //Size reduction as you go through levels in nodes
            thisGraph.consts.radiusDecay = 1;
            //Css class for nodes that are containers
            thisGraph.consts.containerClass = 'container';

            //dataSource holds the server data and methods for
            //converting it to data for the graph
            thisGraph.dataSource = dataSource;

            //Drag behavior for nodes
            var drag = d3.behavior.drag().origin(function (d) {
                return { x: d.x, y: d.y };
            }).on("dragstart", function () {}).on("drag", function (args) {
                d3.select(this).attr("transform", function (d, i) {
                    d.x += d3.event.dx;
                    d.y += d3.event.dy;
                    return "translate(" + [d.x, d.y] + ")";
                });
                thisGraph.updateGraph();
            }).on("dragend", function () {});

            thisGraph.drag = drag;

            //Pan and Zoom behavior for the graph
            var zoom = d3.behavior.zoom().on("zoom", function () {
                if (d3.event.sourceEvent != null && d3.event.sourceEvent.ctrlKey) {
                    return false;
                } else {
                    thisGraph.zoomed.call(thisGraph);
                }
                return true;
            }).on("zoomstart", function (d, i) {});
            thisGraph.dragSvg = zoom;
            thisGraph.svg.call(zoom).on("dblclick.zoom", null);
            return _this;
        }

        /**
         * Called with no args when the graph has a zoom action
         * Can also be called with args to force a zoom or pan 
         * event for the graph.
         *
         * @param      {Array}   translate  The amount to translate
         * @param      {number}  scale      The amount to scale
         */


        _createClass(VisualizerGraph, [{
            key: 'zoomed',
            value: function zoomed(translate, scale) {
                var thisGraph = this;
                if (thisGraph.state.rightClick == true) {
                    return;
                }
                this.state.justScaleTransGraph = true;
                if (translate != null && scale != null) {
                    var zoom = thisGraph.dragSvg;
                    zoom.scale(scale);
                    zoom.translate(translate);
                    //creating names to prevent transition conflicts
                    var zoomSetCallback = function zoomSetCallback() {
                        zoom.scale(scale);
                        zoom.translate(translate);
                    };
                    var translate_name = "zoom" + translate;
                    d3.select("." + this.consts.graphClass).transition(translate_name).delay(100).duration(750).attr('transform', 'translate(' + zoom.translate() + ') scale(' + zoom.scale() + ')').each("end", zoomSetCallback);
                    return;
                }
                if (thisGraph.state.canZoom) {
                    d3.select("." + this.consts.graphClass).attr("transform", "translate(" + thisGraph.dragSvg.translate() + ") scale(" + thisGraph.dragSvg.scale() + ")");
                }
            }
        }, {
            key: 'onWindowResize',


            /**
             * Called when the window resizes
             *
             * @param      {HTML SVG}  svg    The svg to resize
             */
            value: function onWindowResize(svg) {
                var bodyEl = document.getElementsByTagName('body')[0];
                var offset = $('#visualization-graph').offset();
                var divWidth = $('#visualization-graph').width();
                var height = bodyEl.clientHeight;
                svg.attr("width", divWidth).attr("height", height - offset.top - 20);
            }
        }, {
            key: 'updateLinkData',


            /**
             * Called when the server sends updated data for the links
             */
            value: function updateLinkData() {
                var thisGraph = this;
                var node_names_set = [];
                for (var i = 0; i < thisGraph.nodes.length; i++) {
                    node_names_set.push(thisGraph.nodes[i].id);
                }
                var retData = thisGraph.dataSource.getFlowBetweenSet(node_names_set);
                var linkData = retData.linkData;
                thisGraph.links = thisGraph.dataSource.processLinkData(linkData, thisGraph.nodes);
                this.initNodes();
                this.initLinks();
                thisGraph.updateGraph();
            }
        }]);

        return VisualizerGraph;
    }(Graph.Graph);

    return {
        Graph: VisualizerGraph
    };
}]);
/**
 * Created by vjain3 on 5/18/16.
 */
angular.module('contiv.dashboard', ['contiv.models'])
    .config(['$stateProvider', function ($stateProvider) {
        $stateProvider
            .state('contiv.menu.dashboard', {
            url: '/dashboard',
            component: 'dashboard'
        });
    }]);
//# sourceMappingURL=module.js.map
'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/**
 * The base class for link objects for the graph.
 * Supports policies.
 * 
 * To write your own link object, create a new factory that uses the link
 * you want to inherit as a dependency, and extend its link class. 
 * Return the class object with Link as key
 * 
 */
angular.module('contiv.graph').factory('Link', [function () {
	var Link = function () {
		/**
   * Constructs the object.
   *
   * @param      {Node}  sourceNode  The source node
   * @param      {Node}  targetNode  The target node
   */
		function Link(sourceNode, targetNode) {
			_classCallCheck(this, Link);

			this.source = sourceNode;
			this.target = targetNode;
			this.hasPolicy = false;
			this.pathPolicies = [];
			this.graph = null;
			this.initialized = false;
		}

		/**
   * Called when a link is added to the graph
   *
   * @param      {Graph}  graph   The graph it is added to
   */


		_createClass(Link, [{
			key: 'initialize',
			value: function initialize(graph) {
				if (this.initialized == false) {
					this.initialized = true;
					this.graph = graph;
				}
			}

			/**
    * Called during the update graph for existing links
    *
    * @param      {D3Object}  d3path  The d3 path
    * @param      {Link}  	   d       Matching Link Object       
    */

		}, {
			key: 'updateAttr',
			value: function updateAttr(d3path, d) {
				d3path.style('marker-end', 'url(#end-arrow)').attr("d", arrowPath);
			}

			/**
    * Called during the first update graph for a link
    *
    * @param      {D3Object}  d3path  The d3 path
    * @param      {Link}  	   d       Matching Link Object       
    */

		}, {
			key: 'newPathAttr',
			value: function newPathAttr(d3path, d) {
				d3path.attr('d', arrowPath);
			}

			/**
    * Calculates the arrow path
    *
    * @return     {string}  The path to draw
    */

		}, {
			key: 'arrowPath',
			value: function arrowPath() {
				var d = this;
				var dx = d.target.x - d.source.x,
				    dy = d.target.y - d.source.y,
				    dr = Math.sqrt(dx * dx + dy * dy);
				return "M" + d.source.x + "," + d.source.y + "A" + dr + "," + dr + " 0 0,1 " + d.target.x + "," + d.target.y;
			}

			/**
    * Used to install policies that are called when this
    * link has a mouse event
    *
    * @param      {Policy}  policy  The policy to install
    */

		}, {
			key: 'installPathPolicy',
			value: function installPathPolicy(policy) {
				this.hasPolicy = true;
				this.pathPolicies.push(policy);
				policy.initialize(this.graph);
			}

			/**
    * Used to uninstall policy for this link
    *
    * @param      {Policy}  policyRemove  The policy to remove
    */

		}, {
			key: 'uninstallPathPolicy',
			value: function uninstallPathPolicy(policyRemove) {
				var policyRemoveName;
				var thisPath = this;
				if (typeof policyRemove === 'string') {
					policyRemoveName = policyRemove;
				} else {
					policyRemoveName = policyRemove.policyName;
				}
				_(thisPath.pathPolicies).forEach(function (policy, index) {
					if (policy.policyName === policyRemoveName) {
						policy.destroy();
						thisPath.pathPolicies.splice(index, 1);
					}
				});
				if (thisPath.pathPolicies.length === 0) {
					thisPath.hasPolicy = false;
				}
			}

			/**
    * Called when there is a mouse event for this path
    *
    * @param      {string}  event     The mouse event
    * @param      {D3Object}  d3path  The d3 path
    * @param      {Object}  d         The matching link object
    */

		}, {
			key: 'pathPolicyEvent',
			value: function pathPolicyEvent(event, d3path, d) {
				_(d.pathPolicies).forEach(function (policy) {
					policy[event](d3path, d);
				});
			}
		}]);

		return Link;
	}();

	return {
		Link: Link
	};
}]);
/**
 * Created by vjain3 on 5/19/16.
 */
angular.module('contiv.login', ['contiv.utils'])
    .config(['$stateProvider', function ($stateProvider) {
        $stateProvider
            .state('contiv.login', {
            url: '/',
            component: 'login'
        });
    }]);
//# sourceMappingURL=module.js.map
'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

/**
 * The link that is used specifically for the visualization tab.
 */
angular.module('contiv.graph').factory('VisualizerLink', ['Link', function (Link) {
	var VisualizerLink = function (_Link$Link) {
		_inherits(VisualizerLink, _Link$Link);

		/**
   * Constructs the object.
   *
   * @param      {Node}  sourceNode  The source node
   * @param      {Node}  targetNode  The target node
   * @param      {number}  weight    The weight of the link
   */
		function VisualizerLink(sourceNode, targetNode, weight) {
			_classCallCheck(this, VisualizerLink);

			var _this = _possibleConstructorReturn(this, (VisualizerLink.__proto__ || Object.getPrototypeOf(VisualizerLink)).call(this, sourceNode, targetNode));

			_this.weight = weight;
			//Count is used to keep track of how many
			//paths to its subnodes there are
			//in order to calculate average traffic
			_this.count = 1;
			return _this;
		}

		/**
   * Increases the count of the link
   * USed to keep track of how many paths to its subnodes
   * there are in order to calculate average traffic
   */


		_createClass(VisualizerLink, [{
			key: 'increaseCount',
			value: function increaseCount() {
				this.count += 1;
			}

			/**
    * Calculates where to place qtip for
    *
    * @return     {Object}  Object with qTip settings
    */

		}, {
			key: 'qtipHelper',
			value: function qtipHelper() {
				var ret;
				var d = this;
				var dx = (d.target.x - d.source.x) / 2,
				    dy = (d.target.y - d.source.y) / 2;
				if (d.source.x < d.target.x) {
					ret = {
						my: 'top center',
						at: 'center center', // at the bottom right of...
						target: [dx, dy],
						adjust: {
							y: 10
						}
					};
				} else {
					ret = {
						my: 'bottom center',
						at: 'center center', // at the bottom right of...
						target: [dx, dy],
						adjust: {
							y: -10
						}
					};
				}
				return ret;
			}

			/**
   * Called when a link is added to the graph
   *
   * @param      {Graph}  graph   The graph it is added to
   */

		}, {
			key: 'initialize',
			value: function initialize(graph) {
				if (this.initialized == false) {
					_get(VisualizerLink.prototype.__proto__ || Object.getPrototypeOf(VisualizerLink.prototype), 'initialize', this).call(this, graph);
					var state = graph.state.VisualizerLink;
					if (state == null) {
						state = graph.state.VisualizerLink = {};
						state.maxWeight = null;
						state.useAvgWeight = true;
					}
					this.updateMaxWeight();
				}
			}

			/**
    * Sets whether the graph should use avg weight
    *
    * @param      {boolean}  val     The value to set to
    */

		}, {
			key: 'setUseAvgWeight',
			value: function setUseAvgWeight(val) {
				this.graph.state.VisualizerLink.useAvgWeight = !!val;
			}

			/**
    * Sets the weight of this link
    *
    * @param      {number}  weight  The weight to set to
    */

		}, {
			key: 'setWeight',
			value: function setWeight(weight) {
				this.weight = weight;
			}

			/**
    * Gets the raw weight.
    *
    * @return     {number}  The raw weight.
    */

		}, {
			key: 'getRawWeight',
			value: function getRawWeight() {
				return this.weight;
			}

			/**
    * Gets the weight value of the link, depending on the
    * useAvgWeigth setting
    *
    * @return     {number}  The weight.
    */

		}, {
			key: 'getWeight',
			value: function getWeight() {
				var thisGraph = this.graph,
				    state = thisGraph.state.VisualizerLink;

				if (state.useAvgWeight) {
					var weight = this.weight / this.count;
					return weight;
				}
				return this.weight;
			}

			/**
    * Updates the max weight of the graph
    */

		}, {
			key: 'updateMaxWeight',
			value: function updateMaxWeight() {
				var thisGraph = this.graph,
				    state = thisGraph.state.VisualizerLink;

				var maxLink = _.maxBy(thisGraph.links, function (l) {
					if (l.graph != null) {
						return l.getWeight();
					}
					return 0;
				});
				state.maxWeight = maxLink.getWeight();
			}

			/**
    * Called during the update graph for existing links
    *
    * @param      {D3Object}  d3path  The d3 path
    * @param      {Link}  	   d       Matching Link Object       
    */

		}, {
			key: 'updateAttr',
			value: function updateAttr(d3path, d) {
				var thisGraph = this.graph,
				    state = thisGraph.state.VisualizerLink;
				this.updateMaxWeight();
				var colorScale = d3.scale.linear().domain([0, state.maxWeight]).range(["#ffb366", "#F92606"]);
				state.colorScale = colorScale;
				d3path.style('marker-end', 'url(#end-arrow)').classed(thisGraph.consts.selectedClass, function (d) {
					return d === state.selectedEdge;
				}).attr("d", this.arrowPath.call(d)).transition("existingPathTransition").duration(750).attr("stroke", function (d) {
					var c = colorScale(d.getWeight());
					return c;
				});
			}

			/**
    * Called during the first update graph for this link
    *
    * @param      {D3Object}  d3path  The d3 path
    * @param      {Link}  	   d       Matching Link Object
    */

		}, {
			key: 'newPathAttr',
			value: function newPathAttr(d3path, d) {
				var thisGraph = this.graph,
				    state = thisGraph.state.VisualizerLink;
				this.updateMaxWeight();
				var colorScale = d3.scale.linear().domain([0, state.maxWeight]).range(["#ffb366", "#F92606"]);

				d3path.transition("newPathTransition").duration(750).attrTween("opacity", function (d) {
					return d3.interpolateString(0, 1);
				}).attr("stroke", function (d) {
					var c = colorScale(d.getWeight());
					return c;
				}).attr('d', this.arrowPath.call(d));
			}
		}]);

		return VisualizerLink;
	}(Link.Link);

	return {
		Link: VisualizerLink
	};
}]);
/**
 * Created by vjain3 on 5/19/16.
 */
angular.module('contiv.menu', []);
//# sourceMappingURL=module.js.map
'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/**
 * The base class for node objects for the graph.
 * Supports policies.
 * 
 * To write your own Node object, create a new factory that uses the node
 * you want to inherit as a dependency, and extend its node class. 
 * Return the class object with Node as key
 * 
 */
angular.module('contiv.graph').factory('Node', [function () {
	var Node = function () {
		/**
   * Constructs the object.
   *
   * @param      {number}  x       x location
   * @param      {number}  y       y location
   * @param      {string}  id      The identifier
   * @param      {string}  text    The text to display
   * @param      {number}  radius  The radius of the node
   */
		function Node(x, y, id, text, radius) {
			_classCallCheck(this, Node);

			this.x = x;
			this.y = y;
			this.radius = radius;
			this.id = id;
			this.text = text;
			this.radius = radius;
			this.hasPolicy = false;
			this.policy = null;
			this.nodePolicies = [];
			this.graph = null;
			this.initialized = false;
		}

		/**
   * Called when a node is added to the graph
   *
   * @param      {Graph}  graph   The graph it is added to
   */


		_createClass(Node, [{
			key: 'initialize',
			value: function initialize(graph) {
				if (this.initialized == false) {
					this.initialized = true;
					this.graph = graph;
				}
			}

			/**
    * Called during the update graph for existing links
    *
    * @param      {D3Object}  d3node  The d3 node
    */

		}, {
			key: 'updateAttr',
			value: function updateAttr(d3node, d) {
				d3node.attr("transform", function (d) {
					return "translate(" + d.x + "," + d.y + ")";
				});
			}

			/**
    * Called during the first update graph for a node
    * Hook for sub classes
    * 
    * @param      {D3Object}  d3node  The d3 node
    * @param      {Node}      d       Matching Node Object
    */

		}, {
			key: 'newNodeAttr',
			value: function newNodeAttr(d3node, d) {}

			/**
    * Sets the radius of the node.
    *
    * @param      {number}  radius  The radius
    */

		}, {
			key: 'setRadius',
			value: function setRadius(radius) {
				this.radius = radius;
			}

			/**
    * Used to install policies that are called when this
    * node has a mouse event
    *
    * @param      {Policy}  policy  The policy to install
    */

		}, {
			key: 'installNodePolicy',
			value: function installNodePolicy(policy) {
				this.hasPolicy = true;
				this.nodePolicies.push(policy);
				policy.initialize(this.graph);
			}

			/**
    * Used to uninstall policy for this node
    *
    * @param      {Policy|string}  policyRemove  The policy to remove
    */

		}, {
			key: 'uninstallNodePolicy',
			value: function uninstallNodePolicy(policyRemove) {
				var policyRemoveName;
				var thisNode = this;
				if (typeof policyRemove === 'string') {
					policyRemoveName = policyRemove;
				} else {
					policyRemoveName = policyRemove.policyName;
				}
				_(thisNode.nodePolicies).forEach(function (policy, index) {
					if (policy.policyName === policyRemoveName) {
						policy.destroy();
						thisNode.nodePolicies.splice(index, 1);
					}
				});
				if (thisNode.nodePolicies.length === 0) {
					thisNode.hasPolicy = false;
				}
			}

			/**
    * Called when there is a mouse event for this node
    *
    * @param      {string}  event     The mouse event
    * @param      {D3Object}  d3node  The d3 node
    * @param      {Object}  d         The matching node object
    */

		}, {
			key: 'nodePolicyEvent',
			value: function nodePolicyEvent(event, d3node, d) {
				_.forEach(this.nodePolicies, function (policy) {
					policy[event](d3node, d);
				});
			}
		}]);

		return Node;
	}();

	return {
		Node: Node
	};
}]);
/**
 * Created by vjain3 on 5/18/16.
 */
angular.module('contiv.networkpolicies', ['contiv.models', 'contiv.directives', 'contiv.utils'])
    .config(['$stateProvider', function ($stateProvider) {
        $stateProvider
            .state('contiv.menu.networkpolicies', {
            url: '/networkpolicies',
            abstract: true,
            template: '<div ui-view class="ui container"/>'
        })
            .state('contiv.menu.networkpolicies.isolation', {
            url: '/isolation',
            abstract: true,
            template: '<ui-view/>'
        })
            .state('contiv.menu.networkpolicies.isolation.create', {
            url: '/create',
            component: 'isolationpolicycreate'
        })
            .state('contiv.menu.networkpolicies.isolation.details', {
            url: '/details/:key',
            component: 'isolationpolicydetails'
        })
            .state('contiv.menu.networkpolicies.isolation.edit', {
            url: '/edit/:key',
            component: 'isolationpolicydetails'
        })
            .state('contiv.menu.networkpolicies.bandwidth', {
            url: '/bandwidth',
            abstract: true,
            template: '<ui-view/>'
        })
            .state('contiv.menu.networkpolicies.bandwidth.create', {
            url: '/create',
            component: 'bandwidthpolicycreate'
        })
            .state('contiv.menu.networkpolicies.bandwidth.details', {
            url: '/details/:key',
            component: 'bandwidthpolicydetails'
        })
            .state('contiv.menu.networkpolicies.bandwidth.edit', {
            url: '/edit/:key',
            component: 'bandwidthpolicydetails'
        })
            .state('contiv.menu.networkpolicies.redirection', {
            url: '/redirection',
            abstract: true,
            template: '<ui-view/>'
        })
            .state('contiv.menu.networkpolicies.list', {
            url: '/list',
            params: { policyTab: null },
            component: 'networkpoliciestabs'
        });
    }]);
//# sourceMappingURL=module.js.map
'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

/**
 * The node that is used specifically for the visualization tab.
 */
angular.module('contiv.graph').factory('VisualizerNode', ['Node', function (Node) {
	var VisualizerNode = function (_Node$Node) {
		_inherits(VisualizerNode, _Node$Node);

		/**
   * Constructs the object.
   *
   * @param      {number}  x       	x location
   * @param      {number}  y       	y location
   * @param      {string}  id      	The identifier
   * @param      {string}  text    	The text to display
   * @param      {number}  radius  	The radius of the node
   * @param      {string}  parent     The parent id
   * @param      {Array}   ancestors  Array of ancestors Id
   * @param      {number}  xStart     x loc to start animation
   * @param      {number}  yStart     y loc to start animation
   */
		function VisualizerNode(x, y, id, text, radius, parent, ancestors, xStart, yStart) {
			_classCallCheck(this, VisualizerNode);

			var _this = _possibleConstructorReturn(this, (VisualizerNode.__proto__ || Object.getPrototypeOf(VisualizerNode)).call(this, x, y, id, text, radius));

			_this.parent = parent;
			_this.ancestors = ancestors;
			if (xStart == null) {
				_this.xStart = x;
			} else {
				_this.xStart = xStart;
			}
			if (yStart == null) {
				_this.yStart = y;
			} else {
				_this.yStart = yStart;
			}
			return _this;
		}

		/**
   * Called during the first update graph for a node
   *
   * @param      {D3Object}  d3node  The d3 node
   * @param      {Node}    d         The matching Node
   */


		_createClass(VisualizerNode, [{
			key: 'newNodeAttr',
			value: function newNodeAttr(d3node, d) {
				var thisGraph = this.graph;
				if (thisGraph.consts.containerClass != null && thisGraph.dataSource.children_struct[d.id] == null) {
					d3node.classed(thisGraph.consts.containerClass, true);
				}
				d3node.transition("nodePositionTransition").duration(750).attrTween("transform", function (d) {
					if (d.xStart != null && d.yStart != null) {
						var xStart = d.xStart;
						var yStart = d.yStart;
						d.xStart = d.x;
						d.yStart = d.y;
						return d3.interpolateString("translate(" + xStart + "," + yStart + ")", "translate(" + d.x + "," + d.y + ")");
					}
					return d3.interpolateString("translate(" + d.x + "," + d.y + ")", "translate(" + d.x + "," + d.y + ")");
				});
			}
		}]);

		return VisualizerNode;
	}(Node.Node);

	return {
		Node: VisualizerNode
	};
}]);
/**
 * Created by vjain3 on 5/18/16.
 */
angular.module('contiv.networks', ['contiv.models', 'contiv.directives', 'contiv.utils'])
    .config(['$stateProvider', function ($stateProvider) {
        $stateProvider.state('contiv.menu.networks', {
            url: '/networks',
            abstract: true,
            template: '<div ui-view class="ui container"/>'
        })
            .state('contiv.menu.networks.list', {
            url: '/list',
            component: 'networkList'
        }).
            state('contiv.menu.networks.details', {
            url: '/details/:key',
            component: 'networkdetails'
        })
            .state('contiv.menu.networks.create', {
            url: '/create',
            component: 'networkcreate'
        });
    }]);
//# sourceMappingURL=module.js.map
'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

/**
 * This policy is used to add a select node feature.
 * Supports selecting multiple nodes by using the ctrl key.
 */
angular.module('contiv.graph').factory('NodeSelectionPolicy', ['Policy', function (Policy) {
    var NodeSelectionPolicy = function (_Policy$Policy) {
        _inherits(NodeSelectionPolicy, _Policy$Policy);

        /**
         * Constructs the object.
         */
        function NodeSelectionPolicy() {
            _classCallCheck(this, NodeSelectionPolicy);

            return _possibleConstructorReturn(this, (NodeSelectionPolicy.__proto__ || Object.getPrototypeOf(NodeSelectionPolicy)).call(this, "NodeSelectionPolicy"));
        }

        /**
         * Called when policy is installed
         * Overwrites the on drag event of the graph
         * 
         * @param      {Graph}  graph   The graph it is 
        *                              installed on
        */


        _createClass(NodeSelectionPolicy, [{
            key: 'initialize',
            value: function initialize(graph) {
                if (this.initialized) {
                    return;
                }
                _get(NodeSelectionPolicy.prototype.__proto__ || Object.getPrototypeOf(NodeSelectionPolicy.prototype), 'initialize', this).call(this, graph);
                var state = graph.state.NodeSelectionPolicy = {};
                state.selectedNodes = [];
                var consts = graph.consts.NodeSelectionPolicy = {};
                consts.selectedClass = "selected";
                //overwritting graph's node on drag event to support
                //moving multiple nodes at once
                var drag = graph.drag;
                drag.on('drag', function (args) {
                    var thisGraph = graph;
                    if (thisGraph.consts.NodeSelectionPolicy != null) {
                        var selectedClass = thisGraph.consts.NodeSelectionPolicy.selectedClass;
                        var selection = d3.selectAll('.' + selectedClass);

                        if (selection[0].indexOf(this) == -1) {
                            selection.classed(selectedClass, false);
                            selection = d3.select(this);
                            selection.classed(selectedClass, true);
                        }

                        selection.attr("transform", function (d, i) {
                            d.x += d3.event.dx;
                            d.y += d3.event.dy;
                            return "translate(" + [d.x, d.y] + ")";
                        });
                        thisGraph.updateGraph();
                    }
                });
            }

            /**
             * Adds the given node to the array of selected nodes
             *
             * @param      {D3Object}  d3Node    The d3 node
             * @param      {Node}      nodeData  Matching Node object
             */

        }, {
            key: 'addSelectNode',
            value: function addSelectNode(d3Node, nodeData) {
                var thisGraph = this.graph,
                    state = thisGraph.state.NodeSelectionPolicy,
                    consts = thisGraph.consts.NodeSelectionPolicy;

                d3Node.classed(consts.selectedClass, true);
                state.selectedNodes.push(nodeData);
            }

            /**
             * Removes the given node from the array of selected nodes.
             *
             * @param      {D3Object}  d3Node    The d3 node
             * @param      {Node}      nodeData  Matching node object 
             */

        }, {
            key: 'removeSelectFromNode',
            value: function removeSelectFromNode(d3Node, nodeData) {
                var thisGraph = this.graph,
                    state = thisGraph.state.NodeSelectionPolicy,
                    consts = thisGraph.consts.NodeSelectionPolicy;

                thisGraph.circles.filter(function (cd) {
                    return cd.id === nodeData.id;
                }).classed(consts.selectedClass, false);
                var index = state.selectedNodes.indexOf(nodeData);
                state.selectedNodes.splice(index, 1);
            }

            /**
             * Removes all selected nodes.
             */

        }, {
            key: 'removeAllSelectedNodes',
            value: function removeAllSelectedNodes() {
                var thisGraph = this.graph,
                    state = thisGraph.state.NodeSelectionPolicy,
                    consts = thisGraph.consts.NodeSelectionPolicy;

                thisGraph.circles.classed(consts.selectedClass, false);
                state.selectedNodes = [];
            }

            /**
             * On Mousedown, determines whether to change the
             * selected status of the clicked node.
             *
             * @param      {D3Object}  d3node  The d3 node
             * @param      {Node}      d       Matching Node Object       
             */

        }, {
            key: 'mousedown',
            value: function mousedown(d3node, d) {
                var thisGraph = this.graph,
                    state = thisGraph.state.NodeSelectionPolicy;
                d3.event.stopPropagation();
                if (d3.event.ctrlKey) {
                    if (state.selectedNodes.indexOf(d) > -1) {
                        this.removeSelectFromNode(d3node, d);
                    } else {
                        this.addSelectNode(d3node, d);
                    }
                } else if (state.selectedNodes.indexOf(d) == -1) {
                    //if no control key, and clicked not selected node,
                    //remove all of current selection
                    this.removeAllSelectedNodes();
                }
            }

            /**
             * On Mouseup, determines whether to change the
             * selected status of the clicked node.
             *
             * @param      {D3Object}  d3node  The d3 node
             * @param      {Node}      d       Matching Node Object
             */

        }, {
            key: 'mouseup',
            value: function mouseup(d3node, d) {
                var thisGraph = this.graph,
                    state = thisGraph.state.NodeSelectionPolicy;
                if (!d3.event.ctrlKey) {
                    //if length is greater than 1, then we are moving multiple nodes
                    //leave them all highlighted
                    //otherwise we are just moving one node, so unhighlight
                    if (state.selectedNodes.length <= 1) {
                        this.removeSelectFromNode(d3node, d);
                    }
                }
            }
        }]);

        return NodeSelectionPolicy;
    }(Policy.Policy);

    return {
        Policy: NodeSelectionPolicy
    };
}]);
/**
 * Created by vjain3 on 5/18/16.
 */
angular.module('contiv.nodes', ['contiv.models', 'contiv.directives', 'contiv.utils'])
    .config(['$stateProvider', function ($stateProvider) {
        $stateProvider
            .state('contiv.menu.nodes', {
            url: '/nodes',
            abstract: true,
            template: '<div ui-view class="ui container"/>'
        });
    }]);
//# sourceMappingURL=module.js.map
'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

/**
 * This policy changes the view to the timegraph of link data on click.
 */
angular.module('contiv.graph').factory('PathChangeViewPolicy', ['Policy', function (Policy) {
    var PathChangeViewPolicy = function (_Policy$Policy) {
        _inherits(PathChangeViewPolicy, _Policy$Policy);

        /**
         * Called to build policy
         *
         * @param   {Angular State}    $state    Used to change view
         */
        function PathChangeViewPolicy($state) {
            _classCallCheck(this, PathChangeViewPolicy);

            var _this = _possibleConstructorReturn(this, (PathChangeViewPolicy.__proto__ || Object.getPrototypeOf(PathChangeViewPolicy)).call(this, 'PathChangeViewPolicy'));

            _this.$state = $state;
            return _this;
        }

        /**
         * Generates a list of all child containers of the service
         * Can handle nested services.
         *
         * @param      {string}  id      Node ID
         */


        _createClass(PathChangeViewPolicy, [{
            key: 'generateList',
            value: function generateList(id) {
                var thisPolicy = this;
                var retList = [];
                var generateListHelper = function generateListHelper(id, retList) {
                    var nodeIds = thisPolicy.graph.dataSource.children_struct[id];
                    for (var i = 0; i < nodeIds.length; i++) {
                        var childId = nodeIds[i];
                        if (thisPolicy.graph.dataSource.hasChild(childId) === true) {
                            var subRetList = generateListHelper(childId, retList);
                            retList.concat(subRetList);
                        } else {
                            retList.push(childId);
                        }
                    }
                };
                generateListHelper(id, retList);
                return retList;
            }

            /**
             * Used to reroute an edge when clicked
             *
             * @param      {Link}  edge    The clicked edge
             */

        }, {
            key: 'viewEdge',
            value: function viewEdge(edge) {
                var sourceList = [];
                var targetList = [];
                var sourceId = edge.source.id;
                var targetId = edge.target.id;

                if (this.graph.dataSource.hasChild(sourceId) === true) {
                    //Not a container node, need to aggregate
                    sourceList = this.generateList(sourceId);
                } else {
                    sourceList = [sourceId];
                }

                if (this.graph.dataSource.hasChild(targetId) === true) {
                    //Not a container node, need to aggregate
                    targetList = this.generateList(targetId);
                } else {
                    targetList = [targetId];
                }
                this.$state.go('contiv.menu.visualization.edge', { sourceName: sourceId, targetName: targetId,
                    sourceList: sourceList, targetList: targetList });
            }
        }, {
            key: 'mousedown',
            value: function mousedown(d3path, d) {
                this.viewEdge(d);
            }
        }]);

        return PathChangeViewPolicy;
    }(Policy.Policy);

    return {
        Policy: PathChangeViewPolicy
    };
}]);
angular.module('contiv.organizations', ['contiv.models', 'contiv.directives', 'contiv.utils'])
    .config(['$stateProvider', function ($stateProvider) {
        $stateProvider.state('contiv.menu.organizations', {
            url: '/organizations',
            abstract: true,
            template: '<div ui-view class="ui container"/>'
        })
            .state('contiv.menu.organizations.list', {
            url: '/list',
            component: 'organizationlist'
        });
    }]);
//# sourceMappingURL=module.js.map
'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/**
 * Base policy class for the graph object
 * 
 * Policies are used to isolate features for a graph.
 * Policies can be installed on nodes, links, or the graph.
 * Each policy has interaction handlers that will be called by the graph
 * if installed. Policies can also modify graph functions (see QTipPolicy).
 * Multiple policies can be installed for a node or link. 
 * 
 * To write your own policy, create a new factory that uses the policy
 * you want to inherit as a dependency, and extend its policy. 
 * Return the class object with Policy as key, and 
 * add the policy to the PolicyService factory.
 * 
 * For saving state or consts for the policy, create a namespace
 * in graph.state and graph.consts.
 * Ex. 
 *      graph.state.myPolicy = {};
 *      graph.consts.myPolicy = {};
 *      
 */
angular.module('contiv.graph').factory('Policy', [function () {
  var Policy = function () {
    /**
     * Constructs the object.
     *
     * @param      {string}  policyName  The policy name
     */
    function Policy(policyName) {
      _classCallCheck(this, Policy);

      this.policyName = policyName;
      this.graph = null;
      this.initialized = false;
    }

    /**
     * Called when the policy is installed.
     * 
     * @param  {Graph}  graph   The Graph that the policy is
     *                          being installed on
     */


    _createClass(Policy, [{
      key: 'initialize',
      value: function initialize(graph) {
        if (this.initialized) {
          return;
        }
        this.initialized = true;
        this.graph = graph;
      }

      /**
       * Handler, meant to be overridden in subclasses
       *
       * @param  {d3 object}    d3obj    The d3object
       * @param  {Node/Link/Graph}  d   The object it was
       *                                installed for.    
       */

    }, {
      key: 'mouseover',
      value: function mouseover(d3obj, d) {}
    }, {
      key: 'dblclick',
      value: function dblclick(d3obj, d) {}
    }, {
      key: 'contextmenu',
      value: function contextmenu(d3obj, d) {}
    }, {
      key: 'mouseout',
      value: function mouseout(d3obj, d) {}
    }, {
      key: 'mousedown',
      value: function mousedown(d3obj, d) {}
    }, {
      key: 'mouseup',
      value: function mouseup(d3obj, d) {}

      /**
       * Will be called when the graph is being destroyed.
       * Used to remove any elements or bindings the policy
       * has added.
       */

    }, {
      key: 'destroy',
      value: function destroy() {}
    }]);

    return Policy;
  }();

  return {
    Policy: Policy
  };
}]);
/**
 * Created by vjain3 on 5/18/16.
 */
angular.module('contiv.servicelbs', ['contiv.models', 'contiv.directives', 'contiv.utils'])
    .config(['$stateProvider', function ($stateProvider) {
        $stateProvider
            .state('contiv.menu.servicelbs', {
            url: '/servicelbs',
            abstract: true,
            template: '<div ui-view class="ui container"/>'
        })
            .state('contiv.menu.servicelbs.list', {
            url: '/list',
            component: 'servicelbList'
        })
            .state('contiv.menu.servicelbs.create', {
            url: '/create',
            component: 'servicelbCreate'
        })
            .state('contiv.menu.servicelbs.details', {
            url: '/details/:key',
            component: 'servicelbDetails'
        });
    }]);
//# sourceMappingURL=module.js.map
'use strict';

/**
 * Contains all the policies.
 * See policy.js for info on how policies work.
 */
angular.module('contiv.graph').factory('PolicyService', ['Policy', 'QTipPolicy', 'PathChangeViewPolicy', 'NodeSelectionPolicy', 'SplitJoinNodePolicy', 'SplitJoinViewPolicy', 'SaveStatePolicy', function (Policy, QTipPolicy, PathChangeViewPolicy, NodeSelectionPolicy, SplitJoinNodePolicy, SplitJoinViewPolicy, SaveStatePolicy) {

    return {
        Policy: Policy.Policy,
        QTipPolicy: QTipPolicy.Policy,
        PathChangeViewPolicy: PathChangeViewPolicy.Policy,
        NodeSelectionPolicy: NodeSelectionPolicy.Policy,
        SplitJoinNodePolicy: SplitJoinNodePolicy.Policy,
        SplitJoinViewPolicy: SplitJoinViewPolicy.Policy,
        SaveStatePolicy: SaveStatePolicy.Policy
    };
}]);
angular.module('contiv.settings', ['contiv.models', 'contiv.directives', 'contiv.utils'])
    .config(['$stateProvider', function ($stateProvider) {
        $stateProvider
            .state('contiv.menu.settings', {
            url: '/global',
            abstract: true,
            template: '<div ui-view class="ui container"/>'
        })
            .state('contiv.menu.settings.details', {
            url: '/settings',
            templateUrl: 'settings/settingsmenu.html'
        })
            .state('contiv.menu.settings.details.logs', {
            url: '/logs',
            controller: '',
            templateUrl: ''
        })
            .state('contiv.menu.settings.details.auth', {
            url: '/auth',
            controller: '',
            templateUrl: ''
        })
            .state('contiv.menu.settings.details.license', {
            url: '/license',
            controller: '',
            templateUrl: ''
        })
            .state('contiv.menu.settings.details.policies', {
            url: '/policies',
            controller: '',
            templateUrl: ''
        })
            .state('contiv.menu.settings.details.networks', {
            url: '/networks',
            component: 'networksetting'
        })
            .state('contiv.menu.settings.details.volumes', {
            url: '/volumes',
            component: 'volumesetting'
        })
            .state('contiv.menu.settings.details.cluster', {
            url: '/cluster',
            component: 'clustersettings'
        });
    }]);
//# sourceMappingURL=module.js.map
'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

/**
 * This policy adds tooltip functionality to nodes and links.
 * When installing, install on both links and nodes.
 * 
 * Uses the qTip jQuery plugin
 */
angular.module('contiv.graph').factory('QTipPolicy', ['Policy', function (Policy) {
    var QTipPolicy = function (_Policy$Policy) {
        _inherits(QTipPolicy, _Policy$Policy);

        /**
         * Constructs the object.
         */
        function QTipPolicy() {
            _classCallCheck(this, QTipPolicy);

            return _possibleConstructorReturn(this, (QTipPolicy.__proto__ || Object.getPrototypeOf(QTipPolicy)).call(this, "QTipPolicy"));
        }

        /**
         * Called when the policy is installed
         * Modifies the updateNewNodes and 
         * updateNewPaths method of the graph to install qtip
         * onto each node and path.
         *
         * @param      {Graph}  graph   The graph it is 
         *                              installed on
         */


        _createClass(QTipPolicy, [{
            key: 'initialize',
            value: function initialize(graph) {
                if (this.initialized) {
                    return;
                }
                _get(QTipPolicy.prototype.__proto__ || Object.getPrototypeOf(QTipPolicy.prototype), 'initialize', this).call(this, graph);

                var thisPolicy = this;
                var state = graph.state.QTipPolicy = {};

                state.mousedown = false;

                graph.consts.QTipPolicy = {};

                //Tracking mouse click state to make tooltip
                //disappear if the node is being dragged.
                $('#visualization-graph').mouseup(function (e) {
                    state.mouseup = false;
                });

                //override updateNewNodes and updateNewPaths
                //to install qtip
                var graphUpdateNewNodes = graph.updateNewNodes;
                graph.updateNewNodes = function (newNodes) {
                    graphUpdateNewNodes.call(graph, newNodes);
                    thisPolicy.updateNewNodes(newNodes);
                };

                var graphUpdateNewPaths = graph.updateNewPaths;
                graph.updateNewPaths = function (newPaths) {
                    graphUpdateNewPaths.call(graph, newPaths);
                    thisPolicy.updateNewPaths(newPaths);
                };
            }

            /**
             * Removes all qTips from the DOM.
             * Called when the policy is uninstalled or
             * the graph is destroyed.
             */

        }, {
            key: 'destroy',
            value: function destroy() {
                //removing all qtip from DOM
                $('[id^="qtip"]').remove();
            }

            /**
             * Keeping track of mousedown state
             *
             * @param      {d3Object}  d3obj  The d3 pbject
             * @param      {Node/Link}  d     The matching data object
             */

        }, {
            key: 'mousedown',
            value: function mousedown(d3obj, d) {
                var thisGraph = this.graph,
                    state = thisGraph.state.QTipPolicy;
                state.mousedown = true;
            }

            /**
             * Keeping track of mousedown state
             *
             * @param      {d3Object}  d3obj  The d3 pbject
             * @param      {Node/Link}  d     The matching data object
             */

        }, {
            key: 'mouseup',
            value: function mouseup(d3obj, d) {
                var thisGraph = this.graph,
                    state = thisGraph.state.QTipPolicy;
                state.mousedown = false;
            }
        }, {
            key: 'whenQTipAvailable',
            value: function whenQTipAvailable(callback) {
                var thisPolicy = this;
                var interval = 500; // ms
                window.setTimeout(function () {
                    if ($(document).qtip != null) {
                        callback();
                    } else {
                        window.setTimeout(thisPolicy.whenQTipAvailable(callback), interval);
                    }
                }, interval);
            }

            /**
             * Called when New Nodes are added during the
             * update graph function
             *
             * @param      {d3Node}  newNodes  The new nodes that are
             *                                 being added to the graph
             */

        }, {
            key: 'updateNewNodes',
            value: function updateNewNodes(newNodes) {
                var thisGraph = this.graph,
                    state = thisGraph.state.QTipPolicy;

                function attachQTip() {
                    //attaching qtip
                    newNodes.each(function (d) {
                        var thisNode = this;

                        var text;

                        //If node has children, then it is a service
                        if (thisGraph.dataSource.children_struct[d.id] != null) {
                            text = "<b><u>Selectors:</b></u> ";
                            var selectorMap = thisGraph.dataSource.selectors[d.id];
                            var hasKeys = false;
                            for (var key in selectorMap) {
                                hasKeys = true;
                                text += key + " : <i>" + selectorMap[key] + "</i>,\n ";
                            }
                            if (hasKeys === false) {
                                //comma will be removed
                                text = "No Selectors, ";
                            }
                        } else {
                            text = "<b><u>Labels:</b></u> ";
                            var labelsMap = thisGraph.dataSource.labels[d.id];
                            var hasKeys = false;
                            for (var key in labelsMap) {
                                hasKeys = true;
                                text += key + " : <i>" + labelsMap[key] + "</i>,\n ";
                            }
                            if (hasKeys === false) {
                                //comma will be removed
                                text = "No labels, ";
                            }
                        }
                        //remove last comma
                        text = text.slice(0, -2);

                        $(thisNode).qtip({
                            content: {
                                title: d.id,
                                text: text
                            },
                            events: {
                                show: function show() {
                                    var api = $(thisNode).qtip('api');
                                    var offset = $('#graphContainer').offset();
                                    var position = [offset.left + (d.x * thisGraph.dragSvg.scale() + thisGraph.dragSvg.translate()[0]), offset.top + (d.y + d.radius) * thisGraph.dragSvg.scale() + thisGraph.dragSvg.translate()[1]];
                                    api.set('position.target', position);
                                    return !state.mousedown;
                                }
                            },
                            show: {
                                delay: 0,
                                solo: $('#visualization-graph')
                            },
                            style: {
                                classes: 'qtip-blue qtip-shadow'
                            },
                            position: {
                                my: 'top center',
                                at: 'bottom center'
                                // target: position
                            },
                            hide: {
                                event: 'mousedown mouseleave'
                            }
                        });
                    });
                }
                //incase library hasn't loaded yet
                if ($(document).qtip != undefined) {
                    attachQTip();
                } else {
                    this.whenQTipAvailable(attachQTip);
                }
            }

            /**
             * Called when new paths are added during the
             * update graph function
             *
             * @param      {d3Path}  newPaths  The new paths that are
             *                                 being added to the graph
             */

        }, {
            key: 'updateNewPaths',
            value: function updateNewPaths(newPaths) {
                var thisGraph = this.graph,
                    state = thisGraph.state.QTipPolicy;

                //incase library hasn't loaded yet
                if ($(document).qtip != undefined) {
                    //adding qtip
                    newPaths.each(function (d) {
                        var thisPath = this;
                        //getting midpoint of path
                        var pathEl = d3.select(this).node();
                        var midpoint = pathEl.getPointAtLength(pathEl.getTotalLength() / 2);
                        var targetRet = d.qtipHelper();
                        var text = "Bytes: " + d.getWeight();
                        $(thisPath).qtip({
                            content: {
                                text: text
                            },
                            events: {
                                show: function show() {
                                    //if mouse is down, don't let qtip show
                                    return !state.mousedown;
                                }
                            },
                            show: {
                                delay: 0,
                                solo: $('#graphContainer')
                            },
                            style: {
                                classes: 'qtip-blue qtip-shadow'
                            },
                            position: {
                                my: targetRet.my,
                                at: 'center center',
                                target: 'mouse',
                                adjust: targetRet.adjust
                            },
                            hide: {
                                event: 'mousedown mouseleave'
                            }

                        });
                    });
                }
            }
        }]);

        return QTipPolicy;
    }(Policy.Policy);

    return {
        Policy: QTipPolicy
    };
}]);
'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

/**
 * This policy provides a way for properties to be saved 
 * between view changes
 * 
 * It modifies the destroy function to also pass in an object that
 * will have all its properties saved and will be available 
 * on graph load. When saving variables to the object, namespace with
 * the policy name.
 * 
 * This policy must be loaded first in order for it saved variables 
 * to be loaded when the view comes back to the graph
 */
angular.module('contiv.graph').factory('SaveStatePolicy', ['Policy', function (Policy) {
    var SaveStatePolicy = function (_Policy$Policy) {
        _inherits(SaveStatePolicy, _Policy$Policy);

        /**
         * Takes in the angular service to which it will
         * save it's properties to.
         *
         * @param      {Object}  savedState  Object to save 
         *                                   properties to
         */
        function SaveStatePolicy(savedState) {
            _classCallCheck(this, SaveStatePolicy);

            var _this = _possibleConstructorReturn(this, (SaveStatePolicy.__proto__ || Object.getPrototypeOf(SaveStatePolicy)).call(this, 'SaveStatePolicy'));

            _this.savedState = savedState;
            return _this;
        }

        /**
         * Called when the policy is installed
         * Modifies the destroy method 
         * and adds a load method to the graph
         *
         * @param      {Graph}  graph   The graph it is 
         *                              installed on
         */


        _createClass(SaveStatePolicy, [{
            key: 'initialize',
            value: function initialize(graph) {
                this.graph = graph;
                var thisPolicy = this;
                graph.destroy = function () {
                    thisPolicy.graphDestroy.call(graph, thisPolicy.savedState);
                };

                graph.load = function (savedState) {
                    thisPolicy.graphLoad.call(graph, savedState);
                };
            }

            /**
             * Will override the graph's default destroy, with 
             * this policy's savedState passed in.
             * Called with this as the graph
             *
             * @param      {Object}  savedState  The saved state
             */

        }, {
            key: 'graphDestroy',
            value: function graphDestroy(savedState) {
                var thisGraph = this;
                _(thisGraph.defaultNodePolicies).forEach(function (policy) {
                    policy.destroy(savedState);
                });
                _(thisGraph.defaultPathPolicies).forEach(function (policy) {
                    policy.destroy(savedState);
                });
                for (var key in thisGraph.bindings) {
                    $(window).off(key, thisGraph.bindings[key]);
                }
            }

            /**
             * Will be called with the graph as this
             * Used to have all other policies use the load state
             *
             * @param      {Object}  savedState  The saved state
             */

        }, {
            key: 'graphLoad',
            value: function graphLoad(savedState) {
                var thisGraph = this;
                _(thisGraph.defaultNodePolicies).forEach(function (policy) {
                    if (policy.load != null) {
                        policy.load(savedState);
                    }
                });
                _(thisGraph.defaultPathPolicies).forEach(function (policy) {
                    if (policy.load != null) {
                        policy.load(savedState);
                    }
                });
            }
        }]);

        return SaveStatePolicy;
    }(Policy.Policy);

    return {
        Policy: SaveStatePolicy
    };
}]);
/**
 * Created by vjain3 on 5/18/16.
 */
angular.module('contiv.storagepolicies', ['contiv.models', 'contiv.directives', 'contiv.utils'])
    .config(['$stateProvider', function ($stateProvider) {
        $stateProvider
            .state('contiv.menu.storagepolicies', {
            url: '/storagepolicies',
            abstract: true,
            template: '<div ui-view class="ui container"/>'
        })
            .state('contiv.menu.storagepolicies.list', {
            url: '/list',
            component: 'storagepolicylist'
        });
    }]);
//# sourceMappingURL=module.js.map


angular.module('contiv.visualization', ['contiv.models', 'contiv.directives', 'contiv.utils', 
	'contiv.graph'])
 .config(['$stateProvider', function ($stateProvider) {
        $stateProvider.state('contiv.menu.visualization', {
            url: '/visualization',
            abstract: true,
            template: '<div ui-view class="ui container"/>'
        })
    }]);

'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

/**
 * This policy is used for splitting a node into its children,
 * and joining them back to their parent.
 * Splits on double click, and joins on right click.
 * If multiple nodes are selected at the time of a split or join event,
 * it will split or join all of them.
 */
angular.module('contiv.graph').factory('SplitJoinNodePolicy', ['NodeSelectionPolicy', 'VisualizerNode', function (NodeSelectionPolicy, VisualizerNode) {
    var SplitJoinNodePolicy = function (_NodeSelectionPolicy$) {
        _inherits(SplitJoinNodePolicy, _NodeSelectionPolicy$);

        /**
         * Constructs the object.
         */
        function SplitJoinNodePolicy() {
            _classCallCheck(this, SplitJoinNodePolicy);

            var _this = _possibleConstructorReturn(this, (SplitJoinNodePolicy.__proto__ || Object.getPrototypeOf(SplitJoinNodePolicy)).call(this));

            _this.policyName = "SplitJoinNodePolicy";
            return _this;
        }

        /**
         * Called when policy is installed
         *
         * @param      {Graph}  graph   The graph
         */


        _createClass(SplitJoinNodePolicy, [{
            key: 'initialize',
            value: function initialize(graph) {
                if (this.initialized) {
                    return;
                }
                _get(SplitJoinNodePolicy.prototype.__proto__ || Object.getPrototypeOf(SplitJoinNodePolicy.prototype), 'initialize', this).call(this, graph);
                var state = graph.state.SplitJoinNodePolicy = {};
                state.splitNodes = [];
            }

            /**
             * Triggering split on double click
             *
             * @param      {D3Object}  d3node  The d3 node
             * @param      {Object}  d      The matching data object
             */

        }, {
            key: 'dblclick',
            value: function dblclick(d3node, d) {
                var thisGraph = this.graph,
                    superState = thisGraph.state.SplitJoinNodePolicy;

                if (!d3.event.ctrlKey) {
                    if (superState.selectedNodes.indexOf(d) > -1) {
                        this.splitMultipleNodes(superState.selectedNodes);
                    } else {
                        this.removeAllSelectedNodes();
                        this.splitNode(d);
                    }
                }
            }

            /**
             * Triggering join on right click
             *
             * @param      {D3Obj}  d3node  The d3 node
             * @param      {Object}  d      The matching data object
             */

        }, {
            key: 'contextmenu',
            value: function contextmenu(d3node, d) {
                var thisGraph = this.graph,
                    superState = thisGraph.state.NodeSelectionPolicy;
                d3.event.preventDefault();
                if (!d3.event.ctrlKey) {
                    //if try to join a highlighted node while multiple nodes are selected,
                    //we join all highlighted nodes
                    var selectedNodes = superState.selectedNodes;
                    if (selectedNodes.indexOf(d) > -1) {
                        for (var i = 0; i < selectedNodes.length; i++) {
                            this.joinNode(selectedNodes[i]);
                        }
                    } else {
                        //if we try to join a node that isn't part of a highlight,
                        //we remove all highlights and then join the clicked node
                        this.removeAllSelectedNodes();
                        this.joinNode(d);
                    }
                }
            }

            /**
             * Splits a node.
             * used to share code between splitNode and splitMultipleNodes
             * while preventing the handlers for them both firing
             * 
             * @param      {Node}  node    The node being split
             * @return     {Array}  The new nodes created by the split
             */

        }, {
            key: '__splitNode',
            value: function __splitNode(node) {
                var thisGraph = this.graph,
                    state = thisGraph.state.SplitJoinNodePolicy;
                var name = node.id;
                var children_struct = thisGraph.dataSource.children_struct;
                //if it has no children to split into
                if (children_struct[name] === undefined || _.isEmpty(children_struct[name])) {
                    return;
                }

                //removing the node from the list of nodes
                thisGraph.nodes = _.filter(thisGraph.nodes, function (graphNodes) {
                    return graphNodes != node;
                });
                // console.log(thisGraph.nodes);
                thisGraph.spliceLinksForNode(node);

                //getting all the node id's for finding flow
                var node_names_set = [];
                for (var i = 0; i < thisGraph.nodes.length; i++) {
                    node_names_set.push(thisGraph.nodes[i].id);
                }

                //set of nodes after the split
                var new_nodes = [];
                for (var i = 0; i < children_struct[name].length; i++) {
                    node_names_set.push(children_struct[name][i]);
                    new_nodes.push(children_struct[name][i]);
                }
                var retData = thisGraph.dataSource.getFlowBetweenSet(node_names_set);

                //formatting data for new nodes
                var xLoc = node.x;
                var yLoc = node.y;
                var ancestors = node.ancestors.slice();
                //keeping ordering that first in ancestor list is closest in relationship
                ancestors.splice(0, 0, node.id);
                var parent = node.id;
                var new_node_objs = [];
                var radius = node.radius * thisGraph.consts.radiusDecay;
                var nodeData = retData.nodeData;
                for (var i = 0; i < nodeData.length; i++) {
                    //calculating which of the nodes in retData[0] are new
                    if (new_nodes.indexOf(nodeData[i].id) > -1) {
                        var id = nodeData[i].id;
                        var text = nodeData[i].text;
                        var new_node = new VisualizerNode.Node(null, null, id, text, radius, parent, ancestors, xLoc, yLoc);
                        new_node.initialize(thisGraph);
                        thisGraph.nodes.push(new_node);
                        new_node_objs.push(new_node);
                    }
                }
                thisGraph.links = thisGraph.dataSource.processLinkData(retData.linkData, thisGraph.nodes);
                thisGraph.initNodes();
                thisGraph.initLinks();

                state.splitNodes.push(node.id);
                return new_node_objs;
            }

            /**
             * Splits the give node
             *
             * @param      {Node}  node    The node being split
             */

        }, {
            key: 'splitNode',
            value: function splitNode(node) {
                var res = this.__splitNode(node);
                if (res == null) {
                    return;
                }
                this.splitNodeEvent(res);
            }

            /**
             * Splits all the nodes passed in
             *
             * @param      {Array}  nodes   Array of nodes to be split
             */

        }, {
            key: 'splitMultipleNodes',
            value: function splitMultipleNodes(nodes) {
                var thisGraph = this.graph;
                var resNodes = [];
                for (var i = 0; i < nodes.length; i++) {
                    var res = this.__splitNode(nodes[i]);
                    resNodes = resNodes.concat(res);
                }

                this.splitMultipleNodesEvent(res);
            }

            /**
             * Called after a single node is split
             *
             * @param      {Array}  newNodes  The new nodes
             */

        }, {
            key: 'splitNodeEvent',
            value: function splitNodeEvent(newNodes) {
                var thisGraph = this.graph;
                thisGraph.setPositions();
                thisGraph.updateGraph();
            }

            /**
             * Called after multiple nodes are split at once
             *
             * @param      {Array}  newNodes  The new nodes
             */

        }, {
            key: 'splitMultipleNodesEvent',
            value: function splitMultipleNodesEvent(newNodes) {
                var thisGraph = this.graph;
                thisGraph.setPositions();
                thisGraph.updateGraph();
            }

            /**
             * used to share code between joinNode and joinMultipleNode
             * while preventing both handlers firing
             * 
             * @param      {Node}          node    The node to join
             * @return     {Node}  The new node after the join
             */

        }, {
            key: '__joinNode',
            value: function __joinNode(node) {
                var thisGraph = this.graph,
                    state = thisGraph.state.SplitJoinNodePolicy;

                //check that node still exists
                if (thisGraph.nodes.indexOf(node) == -1) {
                    return;
                }

                var children_struct = thisGraph.dataSource.children_struct;
                var name = node.id;
                //if it has no ancestor, nothing to join
                if (children_struct.topLevel.indexOf(name) > -1) {
                    return;
                }

                var to_be_deleted = [];
                var node_names_set = [];
                for (var i = 0; i < thisGraph.nodes.length; i++) {
                    //if node won't be collapsed
                    if (thisGraph.nodes[i].ancestors.indexOf(node.parent) == -1) {
                        node_names_set.push(thisGraph.nodes[i].id);
                    } else {
                        to_be_deleted.push(thisGraph.nodes[i]);
                    }
                }
                var new_node_id = node.parent;
                node_names_set.push(node.parent);

                //formatting data
                var radius = node.radius / thisGraph.consts.radiusDecay;
                var xLoc = node.x;
                var yLoc = node.y;
                var parent = node.ancestors[1];
                var ancestors = node.ancestors.slice(1);
                var new_node = new VisualizerNode.Node(xLoc, yLoc, new_node_id, new_node_id, radius, parent, ancestors);
                thisGraph.nodes.push(new_node);

                var retData = thisGraph.dataSource.getFlowBetweenSet(node_names_set);
                //remove all nodes that will be joined
                for (var i = 0; i < to_be_deleted.length; i++) {
                    var node_to_delete = to_be_deleted[i];
                    thisGraph.nodes.splice(thisGraph.nodes.indexOf(node_to_delete), 1);
                    thisGraph.spliceLinksForNode(node_to_delete);
                }
                thisGraph.links = thisGraph.dataSource.processLinkData(retData.linkData, thisGraph.nodes);
                thisGraph.initNodes();
                thisGraph.initLinks();

                state.splitNodes.splice(state.splitNodes.indexOf(new_node.id), 1);

                return new_node;
            }

            /**
             * Joins the given node
             *
             * @param      {Node}  node    The node to join
             */

        }, {
            key: 'joinNode',
            value: function joinNode(node) {
                var newNode = this.__joinNode(node);
                if (newNode != null) {
                    this.joinNodeEvent(newNode);
                }
            }

            /**
             * Joins all the given nodes
             *
             * @param      {Array}  nodes   The nodes to join
             */

        }, {
            key: 'joinMultipleNode',
            value: function joinMultipleNode(nodes) {
                var new_nodes = [];
                for (var i = 0; i < nodes.length; i++) {
                    var res = this.__joinNode(nodes[i]);
                    new_nodes.push(res);
                }
                this.joinMultipleNodesEvent(new_nodes);
            }

            /**
             * Called after a single node is joined
             *
             * @param      {Node}  newNode  The new node
             */

        }, {
            key: 'joinNodeEvent',
            value: function joinNodeEvent(newNode) {
                var thisGraph = this.graph;
                thisGraph.updateGraph();
            }

            /**
             * Called after multiple nodes are joined
             *
             * @param      {Array}  newNodes  The new nodes
             */

        }, {
            key: 'joinMultipleNodesEvent',
            value: function joinMultipleNodesEvent(newNodes) {
                var thisGraph = this.graph;
                thisGraph.updateGraph();
            }
        }]);

        return SplitJoinNodePolicy;
    }(NodeSelectionPolicy.Policy);

    return {
        Policy: SplitJoinNodePolicy
    };
}]);
/**
 * Created by vjain3 on 5/18/16.
 */
angular.module('contiv.volumes', ['contiv.models', 'contiv.directives', 'contiv.utils'])
    .config(['$stateProvider', function ($stateProvider) {
        $stateProvider
            .state('contiv.menu.volumes', {
            url: '/volumes',
            abstract: true,
            template: '<div ui-view class="ui container"/>'
        })
            .state('contiv.menu.volumes.list', {
            url: '/list',
            component: 'volumelist'
        })
            .state('contiv.menu.volumes.details', {
            url: '/details/:key',
            component: 'volumedetails'
        });
    }]);
//# sourceMappingURL=module.js.map
'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

/**
 * This policy is used to change the view to focus on splitting and 
 * joining events.
 * Overrides the certain force layout functions of the graph to partition a split
 * into the focused nodes and the connected nodes.
 * 
 * Has save/load methods for the save state policy.
 * Has back button support.
 * Can auto change the title of the graph.
 */
angular.module('contiv.graph').factory('SplitJoinViewPolicy', ['SplitJoinNodePolicy', 'VisualizerNode', function (SplitJoinNodePolicy, VisualizerNode) {
    var SplitJoinViewPolicy = function (_SplitJoinNodePolicy$) {
        _inherits(SplitJoinViewPolicy, _SplitJoinNodePolicy$);

        /**
         * Constructs the object.
         */
        function SplitJoinViewPolicy() {
            _classCallCheck(this, SplitJoinViewPolicy);

            var _this = _possibleConstructorReturn(this, (SplitJoinViewPolicy.__proto__ || Object.getPrototypeOf(SplitJoinViewPolicy)).call(this));

            _this.policyName = "SplitJoinViewPolicy";
            return _this;
        }

        /**
         * Called when policy is installed
         *
         * @param      {Graph}  graph   The graph
         */


        _createClass(SplitJoinViewPolicy, [{
            key: 'initialize',
            value: function initialize(graph) {
                if (this.initialized) {
                    return;
                }
                _get(SplitJoinViewPolicy.prototype.__proto__ || Object.getPrototypeOf(SplitJoinViewPolicy.prototype), 'initialize', this).call(this, graph);
                var state = graph.state.SplitJoinViewPolicy = {};
                state.savedStates = [];
                // state.focusGroup = null;
                state.eventHistory = [];
                state.focusGroups = [];
                state.foci = [];
                state.zooms = {};
                state.layout = {};
                state.layoutDefault = null;
                state.zoomDefault = null;
                state.nodeIdsToReshow = null;
                state.backButtonElem = null;
                state.titleElem = null;

                var consts = graph.consts.SplitJoinViewPolicy = {};
                consts.boundary = 0.8;

                //overriding d3force methods of the graph.
                graph.d3ForceBounds = this.d3ForceBounds;
                graph.d3ForceTick = this.d3ForceTick;
                graph.d3ForceStart = this.d3ForceStart;
                graph.d3ForceEnd = this.d3ForceEnd;
            }

            /**
             * Links the provided element a back button feature
             * Doesn't trigger the on-click event
             * That should be done through angular ng-click.
             *
             * @param      {jQuery}  elem    The jquery selected element
             */

        }, {
            key: 'installBackButton',
            value: function installBackButton(elem) {
                var thisGraph = this.graph,
                    thisPolicy = this,
                    state = thisGraph.state.SplitJoinViewPolicy;

                state.backButtonElem = elem;
                state.backButton = function () {
                    if (state.eventHistory.length > 0) {
                        thisPolicy.undoLastEvent.call(thisPolicy);
                    }
                };
            }

            /**
             * Will allow this policy to change the title of the graph
             * as split and join events occur.
             *
             * @param      {jQuery}  elem    The jquery selected element
             */

        }, {
            key: 'installTitle',
            value: function installTitle(elem) {
                var thisGraph = this.graph,
                    state = thisGraph.state.SplitJoinViewPolicy;

                state.titleElem = elem;
            }

            /**
             * Called when the graph is being destroyed
             *
             * @param      {Object}  savedState  Any property on this
             *                                   object will be accessible
             *                                   when the view reloads
             */

        }, {
            key: 'destroy',
            value: function destroy(savedState) {
                //Only if the save state policy is installed
                if (savedState != null) {
                    this.save(savedState);
                }
            }

            /**
             * Will save the current state, and all history.
             *
             * @param      {Object}  savedState  Any property on this
             *                                   object will be accessible
             *                                   when the view reloads
             */

        }, {
            key: 'save',
            value: function save(savedState) {
                var thisGraph = this.graph,
                    state = thisGraph.state.SplitJoinViewPolicy;

                var nodes = thisGraph.nodes;
                var links = thisGraph.links;
                var currTitle = null;
                if (state.titleElem != null) {
                    currTitle = state.titleElem.text();
                }
                var focusGroups = state.focusGroups;
                var eventHistory = state.eventHistory;
                var zooms = state.zooms;
                var layout = state.layout;

                var layoutDefault = state.layoutDefault;
                var zoomDefault = state.zoomDefault;
                var ret = { nodes: nodes, links: links,
                    states: state.savedStates, currTitle: currTitle,
                    focusGroups: focusGroups,
                    eventHistory: eventHistory, zooms: zooms,
                    layout: layout, layoutDefault: layoutDefault,
                    zoomDefault: zoomDefault };
                savedState.SplitJoinViewPolicy = ret;
            }

            /**
             * Will be called when the graph is reloaded, assuming
             * save state policy is installed
             *
             * @param      {Object}  loadState  Contains all the saved
             *                                  variables
             */

        }, {
            key: 'load',
            value: function load(loadState) {
                var thisPolicy = this;
                var thisGraph = this.graph,
                    state = thisGraph.state.SplitJoinViewPolicy;

                loadState = loadState.SplitJoinViewPolicy;
                state.savedStates = loadState.states;
                thisGraph.links = loadState.links;
                thisGraph.nodes = loadState.nodes;

                var currTitle = loadState.currTitle;
                if (state.titleElem != null) {
                    state.titleElem.text(currTitle);
                }
                state.eventHistory = loadState.eventHistory;
                state.focusGroups = loadState.focusGroups;
                state.zooms = loadState.zooms;
                state.layout = loadState.layout;
                state.layoutDefault = loadState.layoutDefault;
                state.zoomDefault = loadState.zoomDefault;

                if (state.backButtonElem != null) {
                    if (state.eventHistory.length > 0) {
                        state.backButtonElem.fadeTo('slow', 1);
                    }
                }

                var children_struct = thisGraph.dataSource.children_struct;

                _.forEach(thisGraph.nodes, function (d) {
                    d.SplitJoinViewPolicy = {};
                    if (_.includes(children_struct[state.focusGroups[0]], d.id)) {
                        d.SplitJoinViewPolicy.type = "focus";
                    } else {
                        d.SplitJoinViewPolicy.type = "connected";
                    }
                });

                //loading a previous layout
                var layout;
                if (state.focusGroups.length === 0) {
                    layout = state.layoutDefault;
                    var zoom = state.zoomDefault;
                    thisGraph.zoomed(zoom[0], zoom[1]);
                } else {
                    var zoom = state.zooms[state.focusGroups];
                    if (zoom != null) {
                        thisGraph.zoomed(zoom[0], zoom[1]);
                    }
                    layout = state.layout[state.focusGroups];
                }

                //layout can't be null
                _.forEach(thisGraph.nodes, function (n) {
                    var pos = layout[n.id];
                    if (pos == null) {
                        console.log(layout, n);
                    }
                    n.x = pos.x;
                    n.y = pos.y;
                });
                thisGraph.state.initForce = true;
                thisGraph.updateGraph.call(thisGraph, function () {
                    thisPolicy.updateGraphCallback.call(thisPolicy);
                });
            }

            /**
             * Triggering split on double click
             * 
             * Focus group stores the node that is about to be split.
             * 
             * When focus group has length 0, the first split 
             * will just be pushed on.
             * The node will be split and pushed to the top half 
             * of the screen, and the bottom half will contain any
             * nodes it has connections to.
             * 
             * When a focus group length is >= 1, if the node to be
             * split is a focus node, it will replace focusGroups[0] and
             * the top half will be its children, and bottom half will
             * be the nodes it has connections to.
             * 
             * If the split is in the bottom half, then the bottom half
             * will display it's children and will only show connections between
             * the two groups, and will replace focusGroups[1].
             * 
             * @param      {D3Obj}   d3node  The d3 node
             * @param      {Object}  d       The matching data object
             */

        }, {
            key: 'dblclick',
            value: function dblclick(d3node, d) {
                var thisGraph = this.graph,
                    state = thisGraph.state.SplitJoinViewPolicy;

                //check if can split
                var name = d.id;
                var children_struct = thisGraph.dataSource.children_struct;
                if (children_struct[name] === undefined || _.isEmpty(children_struct[name])) {
                    return;
                }

                state.focusGroups.slice();

                if (state.focusGroups.length === 0) {
                    //toplevel split
                    state.focusGroups.push(d.id);
                } else if (_.includes(children_struct[state.focusGroups[0]], d.id)) {
                    //splitting a focus node
                    state.focusGroups[0] = d.id;
                } else if (state.focusGroups.length === 1) {
                    //splitting a
                    //connected node
                    state.focusGroups.push(d.id);
                } else if (_.includes(children_struct[state.focusGroups[1]], d.id)) {
                    //splitting a
                    //connected node
                    state.focusGroups[1] = d.id;
                }

                if (state.focusGroups.length === 2 && state.focusGroups[1] === d.id) {
                    //Splitting a connected node, keep all focus nodes
                    var nodesToKeep = [d];
                    var nodeIdsToReshow = [];
                    var groupOneNodes = children_struct[state.focusGroups[0]];
                    _.forEach(thisGraph.nodes, function (node) {
                        if (_.includes(groupOneNodes, node.id)) {
                            nodeIdsToReshow.push(node.id);
                            nodesToKeep.push(node);
                        }
                    });
                } else {
                    //Make split nodes the focus and keep nodes that are connected
                    var nodesToKeep = [d];
                    var nodeIdsToReshow = [];
                    _.forEach(thisGraph.links, function (link) {
                        if (link.source === d && nodeIdsToReshow.indexOf(link.target.id) == -1) {
                            link.target.SplitJoinViewPolicy = {};
                            link.target.SplitJoinViewPolicy.type = "connected";
                            nodeIdsToReshow.push(link.target.id);
                            nodesToKeep.push(link.target);
                        } else if (link.target === d && nodeIdsToReshow.indexOf(link.source.id) == -1) {
                            link.source.SplitJoinViewPolicy = {};
                            link.source.SplitJoinViewPolicy.type = "connected";
                            nodeIdsToReshow.push(link.source.id);
                            nodesToKeep.push(link.source);
                        }
                    });
                }

                //Removing links from the node to be split
                thisGraph.circles.each(function (node) {
                    if (node.id !== d.id) {
                        thisGraph.spliceLinksForNode(node);
                    }
                });
                thisGraph.updateGraph();

                //disabling update graph to prevent new data from
                //redrawing links while there are animations going on
                thisGraph.state.disableUpdate = true;
                thisGraph.circles.each(function (node) {
                    if (node.id !== d.id) {
                        d3.select(this).transition().delay(200).duration(400).style("opacity", 0);
                    } else {
                        //disabling qtip if installed
                        if ($(this).qtip != null) {
                            $(this).qtip('disable', true);
                        }
                    }
                });

                var translate = thisGraph.dragSvg.translate();
                var scale = thisGraph.dragSvg.scale();
                var xLoc = parseFloat(thisGraph.svg.style("width")) / scale / 2 + translate[0];
                var yLoc = parseFloat(thisGraph.svg.style("height")) / scale / 2 + translate[1];
                d.xStart = d.x;
                d.yStart = d.y;
                d.x = xLoc;
                d.y = yLoc;
                d3node.transition("nodePositionTransition").duration(750).attrTween("transform", function (d) {
                    var xStart = d.xStart;
                    var yStart = d.yStart;
                    d.xStart = d.x;
                    d.yStart = d.y;
                    return d3.interpolateString("translate(" + xStart + "," + yStart + ")", "translate(" + d.x + "," + d.y + ")");
                });

                var splitNodeFunc = _get(SplitJoinViewPolicy.prototype.__proto__ || Object.getPrototypeOf(SplitJoinViewPolicy.prototype), 'splitNode', this);
                state.nodeIdsToReshow = nodeIdsToReshow;
                //waiting for node transition
                var thisPolicy = this;
                setTimeout(function () {
                    thisGraph.nodes = nodesToKeep;
                    splitNodeFunc.call(thisPolicy, d);
                }, 750);
            }

            /**
             * To be called after the graph is split.
             * Brings all nodes back into view and sets their attributes
             */

        }, {
            key: 'updateGraphCallback',
            value: function updateGraphCallback() {
                var thisGraph = this.graph,
                    state = thisGraph.state.SplitJoinViewPolicy;

                thisGraph.circles.each(function (node) {
                    d3.select(this).transition().duration(400).style("opacity", 1);
                    d3.select(this).classed("focus", false);
                    d3.select(this).classed("connected", false);

                    if (node.SplitJoinViewPolicy != null) {
                        if (node.SplitJoinViewPolicy.type === "focus") {
                            d3.select(this).classed("focus", true);
                        } else if (node.SplitJoinViewPolicy.type === "connected") {
                            d3.select(this).classed("connected", true);
                        }
                    }
                });

                state.nodeIdsToReshow = null;

                thisGraph.updateGraph();
            }

            /**
             * Randomly sets the positions of any unset node
             */

        }, {
            key: 'setPositions',
            value: function setPositions() {
                var thisGraph = this.graph,
                    thisPolicy = this,
                    graphConsts = thisGraph.consts;

                var offset = graphConsts.displayOffset;
                var nodes = thisGraph.nodes;
                var ret = thisPolicy.d3ForceBounds.call(thisGraph);

                function getRandomInt(min, max) {
                    return Math.floor(Math.random() * (max - min + 1)) + min;
                }

                _.forEach(nodes, function (node) {
                    if (node.x == null || node.y == null) {
                        var x = getRandomInt(node.radius + offset, ret.width - node.radius - offset);
                        var y = getRandomInt(node.radius + offset, ret.height - node.radius - offset);
                        node.x = x;
                        node.y = y;
                    }
                });
            }

            /**
             * Called on the start of the d3 force simulation
             * Will override the method of the graph
             * "this" points to the graph
             */

        }, {
            key: 'd3ForceStart',
            value: function d3ForceStart() {
                var thisGraph = this;
                thisGraph.circles.attr('cx', function (d) {
                    if (d.xStart != null) {
                        d.xStart = d.xStart * thisGraph.dragSvg.scale() + thisGraph.dragSvg.translate()[0];
                    }
                    return d.x;
                }).attr('cy', function (d) {
                    if (d.yStart != null) {
                        d.yStart = d.yStart * thisGraph.dragSvg.scale() + thisGraph.dragSvg.translate()[1];
                    }
                    return d.y;
                });

                thisGraph.paths.attr('x1', function (d) {
                    return d.source.x;
                }).attr('y1', function (d) {
                    return d.source.y;
                }).attr('x2', function (d) {
                    return d.target.x;
                }).attr('y2', function (d) {
                    return d.target.y;
                });
            }

            /**
             * Called on the start of the d3 force simulation
             * Will override the method of the graph
             * "this" points to the graph
             */

        }, {
            key: 'd3ForceEnd',
            value: function d3ForceEnd() {
                var thisGraph = this,
                    state = thisGraph.state,
                    statePolicy = state.SplitJoinViewPolicy;
                if (statePolicy.layoutDefault == null) {
                    var defaultLayout = {};
                    _.forEach(thisGraph.nodes, function (n) {
                        defaultLayout[n.id] = { x: n.x, y: n.y };
                    });
                    statePolicy.layoutDefault = defaultLayout;
                    var scale = thisGraph.dragSvg.scale();
                    var translate = thisGraph.dragSvg.translate();
                    statePolicy.zoomDefault = [translate, scale];
                }

                thisGraph.circles.attr('cx', function (d) {
                    return d.x;
                }).attr('cy', function (d) {
                    return d.y;
                });

                thisGraph.paths.attr('x1', function (d) {
                    return d.source.x;
                }).attr('y1', function (d) {
                    return d.source.y;
                }).attr('x2', function (d) {
                    return d.target.x;
                }).attr('y2', function (d) {
                    return d.target.y;
                });
            }

            /**
             * Will be called during D3 force simulations
             * by the graph, so "this" will point to the graph object
             *
             * @param      {number}  width   D3 Layout Width
             * @param      {number}  height  D3 Layout Height
             */

        }, {
            key: 'd3ForceTick',
            value: function d3ForceTick(e, width, height) {
                var thisGraph = this,
                    state = thisGraph.state,
                    consts = thisGraph.consts,
                    statePolicy = state.SplitJoinViewPolicy;

                var offset = consts.displayOffset;
                var scale = thisGraph.dragSvg.scale();

                // Move nodes toward cluster focus.
                var foci = statePolicy.foci;
                function gravity(alpha) {
                    return function (d) {
                        if (foci.length === 2) {
                            if (d.SplitJoinViewPolicy.type === "focus") {
                                d.y += (foci[0] - d.y) * alpha;
                            } else {
                                d.y += (foci[1] - d.y) * alpha;
                            }
                            d.x += (width / 2 - d.x) * alpha;
                        } else {
                            d.y += (height / 2 - d.y) * alpha;
                            d.x += (width / 2 - d.x) * alpha;
                        }
                    };
                }

                // Make sure nodes are within bounds
                thisGraph.circles.each(this.d3ForceCollide(.5)).each(gravity(.2 * e.alpha)).attr("cx", function (d) {
                    return d.x = Math.max((d.radius + offset) / scale, Math.min(width + (-offset - d.radius) / scale, d.x));
                }).attr("cy", function (d) {
                    if (d.SplitJoinViewPolicy == null || d.SplitJoinViewPolicy == null) {
                        d.y = Math.max((d.radius + offset) / scale, Math.min(height + (-offset - d.radius) / scale, d.y));
                        return d.y;
                    } else if (d.SplitJoinViewPolicy.type === "focus") {
                        d.y = Math.max(d.radius + offset, Math.min((height + (-offset - d.radius) / scale) * consts.SplitJoinViewPolicy.boundary, d.y));
                        return d.y;
                    } else if (d.SplitJoinViewPolicy.type === "connected") {
                        d.y = Math.max((height + (offset - d.radius) / scale) * consts.SplitJoinViewPolicy.boundary, Math.min(height + (-offset - d.radius) / scale, d.y));
                        return d.y;
                    }
                });

                thisGraph.paths.attr('x1', function (d) {
                    return d.source.x;
                }).attr('y1', function (d) {
                    return d.source.y;
                }).attr('x2', function (d) {
                    return d.target.x;
                }).attr('y2', function (d) {
                    return d.target.y;
                });
            }

            /**
             * Calculates the boundaries of the simulation
             * 
             * Will be called during D3 force simulations
             * by the graph, so "this" will point to the graph object
             * 
             * @return     {Object}          Returns an object
             *                               that has the width
             *                               and height as 
             *                               properties 
             */

        }, {
            key: 'd3ForceBounds',
            value: function d3ForceBounds() {
                var thisGraph = this,
                    state = thisGraph.state,
                    consts = thisGraph.consts,
                    constsPolicy = consts.SplitJoinViewPolicy,
                    statePolicy = state.SplitJoinViewPolicy;
                var nodes = thisGraph.nodes;
                function calcMaxNodes(width, height) {
                    var area = width * height;
                    var radius = thisGraph.consts.startRadius;
                    //treating them as a square for approx
                    var length = radius * 3.5;
                    var amount = area / (length * length);
                    return amount;
                }
                //The offset is the buffer from the edges
                //Original Width and Height are given to the force layout
                //so that it is centered, but nodes will be forced to be
                //within the offset bounds
                var offset = consts.displayOffset;
                var svgWidth = parseFloat(thisGraph.svg.style("width"));
                var svgHeight = parseFloat(thisGraph.svg.style("height"));

                var width = svgWidth;
                var height = svgHeight;

                var amount = calcMaxNodes(width - 2 * offset, height - 2 * offset);
                var scale = 1;
                if (nodes.length > amount) {
                    scale = amount / nodes.length;
                    thisGraph.zoomed(thisGraph.dragSvg.translate(), scale);
                    width /= scale;
                    height /= scale;
                } else {
                    thisGraph.zoomed(thisGraph.dragSvg.translate(), scale);
                }

                //calculating foci for simulation
                var focusGroups = statePolicy.focusGroups;
                var foci;
                if (focusGroups.length === 0) {
                    foci = [height / 2];
                } else {
                    //setting foci height position based on percentage
                    var focusNodes = thisGraph.dataSource.children_struct[focusGroups[0]];
                    constsPolicy.boundary = focusNodes.length / nodes.length;
                    var top = height * constsPolicy.boundary;
                    var bot = height - top;
                    if (top < 2 * thisGraph.consts.maxRadius) {
                        constsPolicy.boundary = 2.5 * thisGraph.consts.maxRadius / height;
                        top = height * constsPolicy.boundary;
                        bot = height - top;
                    }
                    if (bot < 2 * thisGraph.consts.maxRadius) {
                        constsPolicy.boundary = 1 - 2.5 * thisGraph.consts.maxRadius / height;
                        top = height * constsPolicy.boundary;
                        bot = height - top;
                    }
                    foci = [top / 2, top + bot / 2];
                }
                statePolicy.foci = foci;
                return { width: width, height: height };
            }

            /**
             * Called after a single node is split
             * 
             * @param      {Array}  newNodes  The new nodes
             */

        }, {
            key: 'splitNodeEvent',
            value: function splitNodeEvent(newNodes) {
                var thisPolicy = this;
                var thisGraph = this.graph,
                    state = thisGraph.state.SplitJoinViewPolicy;

                var children_struct = thisGraph.dataSource.children_struct;
                _.forEach(newNodes, function (d) {
                    d.SplitJoinViewPolicy = {};
                    if (_.includes(children_struct[state.focusGroups[0]], d.id)) {
                        d.SplitJoinViewPolicy.type = "focus";
                    } else {
                        d.SplitJoinViewPolicy.type = "connected";
                    }
                });

                var title = newNodes[0].parent;
                // state.focusGroup = title;

                //if the last event has the same id, it must be the
                //oppposite of this event, so we remove that event from
                //the event stack.
                //Otherwise, we add the event ot the stack
                if (state.eventHistory.length !== 0 && state.eventHistory[state.eventHistory.length - 1].id === title) {
                    state.eventHistory.pop();
                } else {
                    state.eventHistory.push({ id: title, event: 'split' });
                }

                if (state.backButtonElem != null && state.eventHistory.length !== 0) {
                    state.backButtonElem.fadeTo('slow', 1);
                }

                if (state.titleElem != null) {
                    var text = "";
                    if (state.focusGroups.length > 0) {
                        text += state.focusGroups[0];
                    }
                    if (state.focusGroups.length === 2) {
                        text += ' & ' + state.focusGroups[1];
                    }
                    state.titleElem.text(text);
                }

                //re-enable graph update
                thisGraph.state.disableUpdate = false;
                thisPolicy.setLayout();
            }

            /**
             * Sets the layout of the nodes. 
             * If there is a previous layout, it will be loaded.
             * Else, it will run a D3 Force simulation and create one.
             */

        }, {
            key: 'setLayout',
            value: function setLayout() {
                var thisPolicy = this;
                var thisGraph = this.graph,
                    state = thisGraph.state.SplitJoinViewPolicy;
                var layout;
                if (state.focusGroups.length === 0) {
                    layout = state.layoutDefault;
                    var zoom = state.zoomDefault;
                    thisGraph.zoomed(zoom[0], zoom[1]);
                } else {
                    var zoom = state.zooms[state.focusGroups];
                    if (zoom != null) {
                        thisGraph.zoomed(zoom[0], zoom[1]);
                    }
                    layout = state.layout[state.focusGroups];
                }

                if (layout != null) {
                    _.forEach(thisGraph.nodes, function (n) {
                        var pos = layout[n.id];
                        if (pos == null) {
                            console.log(layout, n);
                        }
                        n.x = pos.x;
                        n.y = pos.y;
                    });
                    thisGraph.updateGraph.call(thisGraph, function () {
                        thisPolicy.updateGraphCallback.call(thisPolicy);
                    });
                } else {
                    //Need to run a force simulation as this layout
                    //hasn't been done before
                    thisGraph.state.initForce = false;
                    // thisPolicy.setPositions();
                    thisGraph.updateGraph(function () {
                        thisPolicy.updateGraphCallback.call(thisPolicy);
                    });
                    state.zooms[state.focusGroups] = [thisGraph.dragSvg.translate(), thisGraph.dragSvg.scale()];
                    var layout = {};
                    _.forEach(thisGraph.nodes, function (n) {
                        layout[n.id] = { x: n.x, y: n.y };
                    });
                    state.layout[state.focusGroups] = layout;
                }
            }

            /**
             * Overriding from super class so that we can have
             * top level nodes reappear when they are hidden
             * due to there being two focus groups.
             * 
             * @param      {Node}          node    The node to join
             * @return     {Node}  The new node after the join
             */

        }, {
            key: '__joinNode',
            value: function __joinNode(node) {
                var thisGraph = this.graph,
                    stateSuper = thisGraph.state.SplitJoinNodePolicy,
                    state = thisGraph.state.SplitJoinViewPolicy;

                //check that node still exists
                if (thisGraph.nodes.indexOf(node) == -1) {
                    return;
                }

                var children_struct = thisGraph.dataSource.children_struct;
                var name = node.id;
                //if it has no ancestor, nothing to join
                if (children_struct.topLevel.indexOf(name) > -1) {
                    return;
                }

                var parent = node.parent;
                var to_be_deleted = [];
                var nodeNameSet = [];
                for (var i = 0; i < thisGraph.nodes.length; i++) {
                    //if node won't be collapsed
                    if (thisGraph.nodes[i].ancestors.indexOf(node.parent) == -1) {
                        nodeNameSet.push(thisGraph.nodes[i].id);
                    } else {
                        to_be_deleted.push(thisGraph.nodes[i]);
                    }
                }
                var new_node_id = node.parent;
                nodeNameSet.push(node.parent);

                var ancestors_struct = thisGraph.dataSource.ancestors_struct;
                var children_struct = thisGraph.dataSource.children_struct;
                // - setting focusGroups -
                //either replacing one of the groups,
                //or joining back into a top level, so there is only
                //one focus
                var index = state.focusGroups.indexOf(parent);
                if (ancestors_struct[parent] != null) {
                    state.focusGroups[index] = ancestors_struct[parent];
                } else {
                    state.focusGroups.splice(index, 1);
                }

                //nameToAdd are top level nodes that are to be added
                //to the graph.
                var nameToAdd = [];
                //will only need to add a top level node if there is
                //only one focus
                if (state.focusGroups.length === 1) {
                    //Add only thost that aren't an ancestor of the node
                    //to join, the focus group or an ancestor of it,
                    //and aren't already in nodeNameSet.
                    //get flow between top level as long as
                    //the top level isn't an ancestor of the
                    //focus group, and isn't already part of the
                    //node set;
                    var ancestors = ancestors_struct[node.id];
                    ancestors.push(state.focusGroups[0]);
                    //the or empty array is to prevent concatenating a null
                    //or undefined value
                    ancestors = ancestors.concat(ancestors_struct[state.focusGroups[0]] || []);
                    _.forEach(children_struct.topLevel, function (n) {
                        if (ancestors.indexOf(n) === -1 && nodeNameSet.indexOf(n) == -1) {
                            nameToAdd.push(n);
                        }
                    });
                    nodeNameSet = nodeNameSet.concat(nameToAdd);
                } else if (state.focusGroups.length === 0) {
                    //no focus groups means we are at top level
                    //Should add any top level nodes that aren't
                    //already there
                    _.forEach(children_struct.topLevel, function (n) {
                        if (nodeNameSet.indexOf(n) == -1) {
                            nameToAdd.push(n);
                        }
                    });
                    nodeNameSet = nodeNameSet.concat(nameToAdd);
                }

                //formatting data
                var radius = node.radius / thisGraph.consts.radiusDecay;
                var xLoc = node.x;
                var yLoc = node.y;
                var parent = node.ancestors[1];
                var ancestors = node.ancestors.slice(1);
                var newNode = new VisualizerNode.Node(xLoc, yLoc, new_node_id, new_node_id, radius, parent, ancestors);
                thisGraph.nodes.push(newNode);

                //remove all nodes that will be joined
                for (var i = 0; i < to_be_deleted.length; i++) {
                    var node_to_delete = to_be_deleted[i];
                    thisGraph.nodes.splice(thisGraph.nodes.indexOf(node_to_delete), 1);
                    thisGraph.spliceLinksForNode(node_to_delete);
                }

                var retData = thisGraph.dataSource.getFlowBetweenSet(nodeNameSet);
                //holds the nodeData which will be processed
                var nodesToProcess = [];
                //finding the node data that corresponds to the top level
                //nodes to add - nameToAdd.
                var nodeData = retData.nodeData;
                for (var i = 0; i < nodeData.length; i++) {
                    if (nameToAdd.indexOf(nodeData[i].id) !== -1) {
                        nodesToProcess.push(nodeData[i]);
                    }
                }

                //The top level nodes that are added
                var newNodes = thisGraph.dataSource.processNodeData(nodesToProcess);
                _.forEach(newNodes, function (n) {
                    n.radius = n.radius || thisGraph.consts.startRadius;
                });
                thisGraph.nodes = thisGraph.nodes.concat(newNodes);

                thisGraph.links = thisGraph.dataSource.processLinkData(retData.linkData, thisGraph.nodes);
                //Only keep top level nodes that have connections to
                //the current focus group
                //we remove the node name from nameToAdd if we are
                //keeping it
                if (state.focusGroups.length === 1) {
                    _.forEach(thisGraph.links, function (l) {
                        //checking if there exists a link touching each of nameToAdd
                        if (nameToAdd.indexOf(l.source.id) !== -1) {
                            if (state.focusGroups[0] === l.target.parent) {
                                nameToAdd.splice(nameToAdd.indexOf(l.source.id), 1);
                            }
                        } else if (nameToAdd.indexOf(l.target.id) !== -1) {
                            if (state.focusGroups[0] === l.source.parent) {
                                nameToAdd.splice(nameToAdd.indexOf(l.target.id), 1);
                            }
                        }
                    });
                } else {
                    //We want to keep them all
                    //since any left in nameToAdd will be removed,
                    //we reset nameToAdd here.
                    nameToAdd = [];
                }

                //whatever is remaining in nameToAdd isn't connected
                //to the focus group, so we should remove it.
                var nodeToRemove = [];
                if (nameToAdd.length !== 0) {
                    for (var i = 0; i < thisGraph.nodes.length; i++) {
                        if (nameToAdd.indexOf(thisGraph.nodes[i].id) !== -1) {
                            nameToAdd.splice(nameToAdd.indexOf(thisGraph.nodes[i].id), 1);
                            thisGraph.spliceLinksForNode(thisGraph.nodes[i]);
                            nodeToRemove.push(thisGraph.nodes[i]);
                            if (nameToAdd.length === 0) {
                                break;
                            }
                        }
                    }
                }
                _.forEach(nodeToRemove, function (n) {
                    thisGraph.nodes.splice(thisGraph.nodes.indexOf(n), 1);
                });

                thisGraph.initNodes();
                thisGraph.initLinks();

                stateSuper.splitNodes.splice(stateSuper.splitNodes.indexOf(newNode.id), 1);

                return newNode;
            }

            /**
             * Called after a single node is joined
             * 
             * If the focus group has been seen before, it will
             * load that layout. Otherwise, it will run a d3 force
             * simulation to generate one.
             *
             * @param      {Node}  newNode  The new node
             */

        }, {
            key: 'joinNodeEvent',
            value: function joinNodeEvent(newNode) {
                var thisGraph = this.graph,
                    thisPolicy = this,
                    state = thisGraph.state.SplitJoinViewPolicy;

                //if the last event has the same id, it must be the
                //oppposite of this event, so we remove that event from
                //the event stack.
                //Otherwise, we add the event to the stack
                if (state.eventHistory.length !== 0 && state.eventHistory[state.eventHistory.length - 1].id === newNode.id) {
                    state.eventHistory.pop();
                } else {
                    state.eventHistory.push({ id: newNode.id, event: 'join' });
                }

                var children_struct = thisGraph.dataSource.children_struct;

                _.forEach(thisGraph.nodes, function (d) {
                    d.SplitJoinViewPolicy = {};
                    if (_.includes(children_struct[state.focusGroups[0]], d.id)) {
                        d.SplitJoinViewPolicy.type = "focus";
                    } else {
                        d.SplitJoinViewPolicy.type = "connected";
                    }
                });

                //setting back button
                if (state.backButtonElem != null && state.eventHistory.length === 0) {
                    state.backButtonElem.fadeTo('slow', 0);
                }

                //setting title
                if (state.titleElem != null) {
                    var text = "";
                    if (state.focusGroups.length > 0) {
                        text += state.focusGroups[0];
                    }
                    if (state.focusGroups.length === 2) {
                        text += ' & ' + state.focusGroups[1];
                    }
                    state.titleElem.text(text);
                }
                thisPolicy.setLayout();
            }

            /**
             * Undoes the last split or join event.
             * Meant to be called by the back button.
             */

        }, {
            key: 'undoLastEvent',
            value: function undoLastEvent() {
                var thisGraph = this.graph,
                    thisPolicy = this,
                    state = thisGraph.state.SplitJoinViewPolicy;

                var last = state.eventHistory[state.eventHistory.length - 1];
                var id = last.id;
                var node;
                if (last.event === 'join') {
                    node = thisGraph.findNodeById(id);
                    var d3node = thisGraph.findD3Node(id);
                    thisPolicy.dblclick(d3node, node);
                } else {
                    var nodeId = thisGraph.dataSource.children_struct[id][0];
                    node = thisGraph.findNodeById(nodeId);
                    _get(SplitJoinViewPolicy.prototype.__proto__ || Object.getPrototypeOf(SplitJoinViewPolicy.prototype), 'joinNode', this).call(thisPolicy, node);
                }
            }
        }]);

        return SplitJoinViewPolicy;
    }(SplitJoinNodePolicy.Policy);

    return {
        Policy: SplitJoinViewPolicy
    };
}]);
'use strict';
// Declare app level module which depends on views, and components
angular.module('contivApp', [
    'ui.router',
    'contiv.login',
    'contiv.menu',
    'contiv.dashboard',
    'contiv.applicationgroups',
    'contiv.networks',
    'contiv.networkpolicies',
    'contiv.storagepolicies',
    'contiv.servicelbs',
    'contiv.volumes',
    'contiv.nodes',
    'contiv.organizations',
    'contiv.settings',
    'contiv.visualization'
])
    .config(['$stateProvider', '$urlRouterProvider', function ($stateProvider, $urlRouterProvider) {
        $stateProvider
            .state('contiv', {
            url: '',
            abstract: true,
            template: '<div ui-view class="ui fluid container"/>'
        });
        $urlRouterProvider.otherwise('/');
    }]);
//# sourceMappingURL=app.js.map
/**
 * Created by vjain3 on 5/19/16.
 */
angular.module('contiv.menu')
    .config(['$stateProvider', function ($stateProvider) {
        $stateProvider
            .state('contiv.menu', {
            url: '/m',
            templateUrl: 'menu/menu.html',
            controller: 'MenuCtrl as menuCtrl',
            params: { username: null }
        });
    }])
    .controller('MenuCtrl', ['$state', '$stateParams', function ($state, $stateParams) {
        var menuCtrl = this;
        function logout() {
            $state.go('contiv.login');
        }
        menuCtrl.username = $stateParams.username;
        menuCtrl.logout = logout;
    }]);
//# sourceMappingURL=menuCtrl.js.map
angular.module('contiv.nodes')
    .factory('BgpService', ['$http', '$q', function ($http, $q) {
        function getBgp(ctrl) {
            var deferred = $q.defer();
            var url = ContivGlobals.BGPS_ENDPOINT + ctrl.key + '/';
            $http.get(url).then(function successCallback(result) {
                deferred.resolve(result.data);
                ctrl.neighbor = result.data;
                ctrl.neighbors.push({ 'name': ctrl.neighbor['neighbor'], 'value': ctrl.neighbor['neighbor-as'] });
            }, function errorCallback(result) {
                deferred.reject(result.data);
            });
            return deferred.promise;
        }
        function updateBgp(ctrl) {
            var url = ContivGlobals.BGPS_ENDPOINT + ctrl.key + '/';
            return $http.post(url, ctrl.neighbor);
        }
        ;
        function getBgpInspect(key) {
            var deferred = $q.defer();
            var url = ContivGlobals.BGPS_INSPECT_ENDPOINT + key + '/';
            $http.get(url).then(function successCallback(result) {
                deferred.resolve(result.data);
            }, function errorCallback(result) {
                deferred.reject(result.data);
            });
            return deferred.promise;
        }
        return {
            getBgp: getBgp,
            updateBgp: updateBgp,
            getBgpInspect: getBgpInspect
        };
    }]);
//# sourceMappingURL=bgpservice.js.map
angular.module("contiv.nodes")
    .directive("ctvLogs", function () {
    return {
        restrict: 'E',
        templateUrl: 'nodes/logs.html',
        scope: {
            log: "=",
            title: "@"
        }
    };
});
//# sourceMappingURL=logsdirective.js.map
angular.module('contiv.nodes')
    .factory('LogService', ['$http', '$q', function ($http, $q) {
        function getActiveLogs() {
            var deferred = $q.defer();
            var url = ContivGlobals.NODES_ACTIVE_JOB_ENDPOINT;
            $http.get(url).then(function successCallback(result) {
                deferred.resolve(result.data);
            }, function errorCallback(result) {
                deferred.reject(result.data);
            });
            return deferred.promise;
        }
        function getLastLogs() {
            var deferred = $q.defer();
            var url = ContivGlobals.NODES_LAST_JOB_ENDPOINT;
            $http.get(url).then(function successCallback(result) {
                deferred.resolve(result.data);
            }, function errorCallback(result) {
                deferred.reject(result.data);
            });
            return deferred.promise;
        }
        return {
            getActiveLogs: getActiveLogs,
            getLastLogs: getLastLogs
        };
    }]);
//# sourceMappingURL=logservice.js.map
angular.module('contiv.nodes')
    .config(['$stateProvider', function ($stateProvider) {
        $stateProvider
            .state('contiv.menu.nodes.activelog', {
            url: '/activelog',
            controller: 'NodeActiveJobLogsCtrl as nodeActiveJobLogsCtrl',
            template: '<ctv-logs title="Active Job" log="nodeActiveJobLogsCtrl.activeLogs"></ctv-logs>'
        });
    }])
    .controller('NodeActiveJobLogsCtrl', ['$scope', '$interval', 'LogService',
    function ($scope, $interval, LogService) {
        var nodeActiveJobLogsCtrl = this;
        function getActiveLogs() {
            LogService.getActiveLogs().then(function successCallback(result) {
                nodeActiveJobLogsCtrl.activeLogs = result;
            }, function errorCallback(result) {
                //Once the job finishes, endpoint returns 500 error. So reset the activeLogs
                nodeActiveJobLogsCtrl.activeLogs = {
                    desc: 'There is currently no active job. Check Last Job for a job that recently finished.'
                };
            });
        }
        getActiveLogs();
        var promise;
        //Don't do auto-refresh if one is already in progress
        if (!angular.isDefined(promise)) {
            promise = $interval(function () {
                getActiveLogs();
            }, ContivGlobals.REFRESH_INTERVAL);
        }
        //stop polling when user moves away from the page
        $scope.$on('$destroy', function () {
            $interval.cancel(promise);
        });
    }]);
//# sourceMappingURL=nodeactivejoblogsctrl.js.map
/**
 * Created by vjain3 on 3/25/16.
 */
angular.module('contiv.nodes')
    .config(['$stateProvider', function ($stateProvider) {
        $stateProvider
            .state('contiv.menu.nodes.commission', {
            url: '/commission/:key',
            controller: 'NodeCommissionCtrl as nodeCommissionCtrl',
            templateUrl: 'nodes/nodecommission.html'
        });
    }])
    .controller('NodeCommissionCtrl', [
    '$state', '$stateParams', 'NodesModel', 'CRUDHelperService', 'NodesService',
    function ($state, $stateParams, NodesModel, CRUDHelperService, NodesService) {
        var nodeCommissionCtrl = this;
        function returnToNodeDetails() {
            $state.go('contiv.menu.nodes.details.info', { 'key': $stateParams.key });
        }
        function cancelCommissioningNode() {
            returnToNodeDetails();
        }
        function commission() {
            if (nodeCommissionCtrl.form.$valid) {
                CRUDHelperService.hideServerError(nodeCommissionCtrl);
                CRUDHelperService.startLoader(nodeCommissionCtrl);
                nodeCommissionCtrl.nodeOpsObj.nodes = [$stateParams.key];
                NodesService.cleanupExtraVars(nodeCommissionCtrl);
                NodesService.createExtraVars(nodeCommissionCtrl);
                NodesModel.commission(nodeCommissionCtrl.nodeOpsObj).then(function successCallback(result) {
                    CRUDHelperService.stopLoader(nodeCommissionCtrl);
                    returnToNodeDetails();
                }, function errorCallback(result) {
                    CRUDHelperService.stopLoader(nodeCommissionCtrl);
                    CRUDHelperService.showServerError(nodeCommissionCtrl, result);
                });
            }
        }
        nodeCommissionCtrl.nodeOpsObj = {};
        nodeCommissionCtrl.extra_vars = {}; //TODO Intialize from global settings
        nodeCommissionCtrl.ansibleVariables = [];
        nodeCommissionCtrl.envVariables = [];
        NodesService.getSettings(nodeCommissionCtrl);
        nodeCommissionCtrl.cancelCommissioningNode = cancelCommissioningNode;
        nodeCommissionCtrl.commission = commission;
        CRUDHelperService.stopLoader(nodeCommissionCtrl);
        CRUDHelperService.hideServerError(nodeCommissionCtrl);
    }]);
//# sourceMappingURL=nodecommissionctrl.js.map
/**
 * Created by vjain3 on 3/25/16.
 */
angular.module('contiv.nodes')
    .config(['$stateProvider', function ($stateProvider) {
        $stateProvider
            .state('contiv.menu.nodes.details', {
            url: '/details/:key',
            controller: 'NodeDetailsCtrl as nodeDetailsCtrl',
            templateUrl: 'nodes/nodedetails.html'
        })
            .state('contiv.menu.nodes.details.info', {
            url: '/info',
            controller: 'NodeDetailsCtrl as nodeDetailsCtrl',
            templateUrl: 'nodes/nodeinfo.html'
        })
            .state('contiv.menu.nodes.details.stats', {
            url: '/stats',
            controller: 'NodeDetailsCtrl as nodeDetailsCtrl',
            templateUrl: 'nodes/nodestats.html'
        })
            .state('contiv.menu.nodes.details.logs', {
            url: '/logs',
            controller: 'NodeDetailsCtrl as nodeDetailsCtrl',
            templateUrl: 'nodes/nodelogs.html'
        })
            .state('contiv.menu.nodes.details.edit', {
            url: '/edit',
            controller: 'NodeDetailsCtrl as nodeDetailsCtrl',
            templateUrl: 'nodes/nodeinfo.html'
        });
    }])
    .controller('NodeDetailsCtrl', ['$state', '$stateParams', '$scope', '$interval', 'NodesModel', 'BgpService',
    function ($state, $stateParams, $scope, $interval, NodesModel, BgpService) {
        var nodeDetailsCtrl = this;
        nodeDetailsCtrl.numberpattern = ContivGlobals.NUMBER_REGEX;
        function decommission() {
            var nodeOpsObj = {
                nodes: [$stateParams.key]
            };
            NodesModel.decommission(nodeOpsObj).then(function (result) {
                //Disable all buttons initially. Poll will assign values appropriately.
                nodeDetailsCtrl.showCommissionButton = false;
                nodeDetailsCtrl.commissionButtonEnabled = false;
                nodeDetailsCtrl.upgradeButtonEnabled = false;
            });
        }
        function upgrade() {
            var nodeOpsObj = {
                nodes: [$stateParams.key]
            };
            NodesModel.upgrade(nodeOpsObj).then(function (result) {
                //Disable all buttons initially. Poll will assign values appropriately.
                nodeDetailsCtrl.showCommissionButton = false;
                nodeDetailsCtrl.commissionButtonEnabled = false;
                nodeDetailsCtrl.upgradeButtonEnabled = false;
            });
        }
        /**
         * Display buttons based on status of node
         */
        function setButtonDisplay() {
            switch (nodeDetailsCtrl.node['inventory_state'].status) {
                case 'Unallocated':
                    nodeDetailsCtrl.showCommissionButton = true;
                    nodeDetailsCtrl.commissionButtonEnabled = true;
                    nodeDetailsCtrl.upgradeButtonEnabled = false;
                    break;
                case 'Decommissioned':
                    nodeDetailsCtrl.showCommissionButton = true;
                    nodeDetailsCtrl.commissionButtonEnabled = true;
                    nodeDetailsCtrl.upgradeButtonEnabled = false;
                    break;
                case 'Provisioning':
                    nodeDetailsCtrl.showCommissionButton = true;
                    nodeDetailsCtrl.commissionButtonEnabled = false;
                    nodeDetailsCtrl.upgradeButtonEnabled = false;
                    break;
                case 'Allocated':
                    nodeDetailsCtrl.showCommissionButton = false;
                    nodeDetailsCtrl.commissionButtonEnabled = true;
                    nodeDetailsCtrl.upgradeButtonEnabled = true;
                    break;
                case 'Cancelled':
                    nodeDetailsCtrl.showCommissionButton = false;
                    nodeDetailsCtrl.commissionButtonEnabled = false;
                    nodeDetailsCtrl.upgradeButtonEnabled = false;
                    break;
                case 'Maintenance':
                    nodeDetailsCtrl.showCommissionButton = true;
                    nodeDetailsCtrl.commissionButtonEnabled = false;
                    nodeDetailsCtrl.upgradeButtonEnabled = false;
                    break;
                default:
                    nodeDetailsCtrl.showCommissionButton = true;
                    nodeDetailsCtrl.commissionButtonEnabled = false;
                    nodeDetailsCtrl.upgradeButtonEnabled = false;
                    break;
            }
        }
        function getNodeInfo(reload) {
            NodesModel.getModelByKey($stateParams.key, reload)
                .then(function (node) {
                nodeDetailsCtrl.node = node;
                setButtonDisplay();
            });
        }
        function setMode() {
            if ($state.is('contiv.menu.nodes.details.edit')) {
                nodeDetailsCtrl.mode = 'edit';
            }
            else {
                nodeDetailsCtrl.mode = 'details';
            }
        }
        function returnToInfo() {
            $state.go('contiv.menu.nodes.details.info');
        }
        function updateBgpInfo() {
            if (nodeDetailsCtrl.form.$valid) {
                nodeDetailsCtrl.neighbor.key = $stateParams.key;
                // backend only supports adding one neighbor currently
                nodeDetailsCtrl.neighbors.forEach(function (item) {
                    nodeDetailsCtrl.neighbor['neighbor'] = item.name;
                    nodeDetailsCtrl.neighbor['neighbor-as'] = item.value;
                });
                BgpService.updateBgp(nodeDetailsCtrl).then(function successCallback(result) {
                    nodeDetailsCtrl.neighbor = result.config.data;
                    returnToInfo();
                }, function errorCallback(result) {
                });
            }
        }
        function getBgpInfo() {
            BgpService.getBgp(nodeDetailsCtrl).then(function successCallback(result) {
                nodeDetailsCtrl.neighbor = result;
            }, function errorCallback(result) {
            });
        }
        function getBgpInspect() {
            BgpService.getBgpInspect($stateParams.key).then(function successCallback(result) {
                nodeDetailsCtrl.inspect = result;
                nodeDetailsCtrl.routes = result.Oper.routes;
                nodeDetailsCtrl.filteredroutes = result.Oper.routes;
            }, function errorCallback(result) {
            });
        }
        nodeDetailsCtrl.decommission = decommission;
        nodeDetailsCtrl.upgrade = upgrade;
        nodeDetailsCtrl.setMode = setMode;
        nodeDetailsCtrl.updateBgpInfo = updateBgpInfo;
        nodeDetailsCtrl.returnToInfo = returnToInfo;
        nodeDetailsCtrl.neighbors = [];
        nodeDetailsCtrl.neighbor = {};
        nodeDetailsCtrl.key = $stateParams.key;
        getBgpInfo();
        getBgpInspect();
        setMode();
        //Load from cache for quick display initially
        getNodeInfo(false);
        var promise;
        //Don't do auto-refresh if one is already in progress
        if (!angular.isDefined(promise)) {
            promise = $interval(function () {
                getNodeInfo(true);
            }, 5000);
        }
        //stop polling when user moves away from the page
        $scope.$on('$destroy', function () {
            $interval.cancel(promise);
        });
    }]);
//# sourceMappingURL=nodedetailsctrl.js.map
/**
 * Created by vjain3 on 6/14/16.
 */
angular.module("contiv.nodes")
    .directive("ctvNodestatus", function () {
    return {
        restrict: 'E',
        scope: {
            node: '='
        },
        templateUrl: 'nodes/nodestatus.html'
    };
})
    .directive("ctvNodestate", function () {
    return {
        restrict: 'E',
        scope: {
            node: '='
        },
        templateUrl: 'nodes/nodestate.html'
    };
});
//# sourceMappingURL=nodedirective.js.map
angular.module('contiv.nodes')
    .config(['$stateProvider', function ($stateProvider) {
        $stateProvider
            .state('contiv.menu.nodes.discover', {
            url: '/discover',
            controller: 'NodeDiscoverCtrl as nodeDiscoverCtrl',
            templateUrl: 'nodes/nodediscover.html'
        });
    }])
    .controller('NodeDiscoverCtrl', [
    '$state', '$stateParams', 'NodesModel', 'CRUDHelperService', 'NodesService',
    function ($state, $stateParams, NodesModel, CRUDHelperService, NodesService) {
        var nodeDiscoverCtrl = this;
        function returnToNodes() {
            $state.go('contiv.menu.nodes.list');
        }
        function cancelDiscoveringNode() {
            returnToNodes();
        }
        function discover() {
            if (nodeDiscoverCtrl.form.$valid) {
                CRUDHelperService.hideServerError(nodeDiscoverCtrl);
                CRUDHelperService.startLoader(nodeDiscoverCtrl);
                createIPAddrArray();
                NodesService.createExtraVars(nodeDiscoverCtrl);
                NodesModel.discover(nodeDiscoverCtrl.nodeOpsObj).then(function successCallback(result) {
                    CRUDHelperService.stopLoader(nodeDiscoverCtrl);
                    returnToNodes();
                }, function errorCallback(result) {
                    CRUDHelperService.stopLoader(nodeDiscoverCtrl);
                    CRUDHelperService.showServerError(nodeDiscoverCtrl, result);
                });
            }
        }
        function createIPAddrArray() {
            nodeDiscoverCtrl.nodeOpsObj.addrs = _.words(nodeDiscoverCtrl.nodeIPAddr, /[^, ]+/g);
        }
        nodeDiscoverCtrl.nodeOpsObj = {};
        nodeDiscoverCtrl.extra_vars = {}; //TODO Intialize from global settings
        nodeDiscoverCtrl.ansibleVariables = [];
        nodeDiscoverCtrl.envVariables = [];
        nodeDiscoverCtrl.nodeIPAddr = ''; //IP address of nodes to discover
        NodesService.getSettings(nodeDiscoverCtrl);
        nodeDiscoverCtrl.discover = discover;
        nodeDiscoverCtrl.cancelDiscoveringNode = cancelDiscoveringNode;
        CRUDHelperService.stopLoader(nodeDiscoverCtrl);
        CRUDHelperService.hideServerError(nodeDiscoverCtrl);
    }]);
//# sourceMappingURL=nodediscoverctrl.js.map
angular.module('contiv.nodes')
    .config(['$stateProvider', function ($stateProvider) {
        $stateProvider
            .state('contiv.menu.nodes.lastlog', {
            url: '/lastlog',
            controller: 'NodeLastJobLogsCtrl as nodeLastJobLogsCtrl',
            template: '<ctv-logs title="Last Job" log="nodeLastJobLogsCtrl.lastLogs"></ctv-logs>'
        });
    }])
    .controller('NodeLastJobLogsCtrl', ['$scope', '$interval', 'LogService',
    function ($scope, $interval, LogService) {
        var nodeLastJobLogsCtrl = this;
        function getLastLogs() {
            LogService.getLastLogs().then(function successCallback(result) {
                nodeLastJobLogsCtrl.lastLogs = result;
            }, function errorCallback(result) {
            });
        }
        getLastLogs();
        var promise;
        //Don't do auto-refresh if one is already in progress
        if (!angular.isDefined(promise)) {
            promise = $interval(function () {
                getLastLogs();
            }, ContivGlobals.REFRESH_INTERVAL);
        }
        //stop polling when user moves away from the page
        $scope.$on('$destroy', function () {
            $interval.cancel(promise);
        });
    }]);
//# sourceMappingURL=nodelastjoblogsctrl.js.map
/**
 * Created by vjain3 on 3/22/16.
 */
angular.module('contiv.nodes')
    .config(['$stateProvider', function ($stateProvider) {
        $stateProvider
            .state('contiv.menu.nodes.list', {
            url: '/list',
            controller: 'NodeListCtrl as nodeListCtrl',
            templateUrl: 'nodes/nodelist.html'
        });
    }])
    .controller('NodeListCtrl', ['$scope', '$interval', '$filter', 'NodesModel', 'CRUDHelperService',
    function ($scope, $interval, $filter, NodesModel, CRUDHelperService) {
        var nodeListCtrl = this;
        function getNodes(reload) {
            NodesModel.get(reload)
                .then(function successCallback(result) {
                CRUDHelperService.stopLoader(nodeListCtrl);
                nodeListCtrl.nodes = result;
            }, function errorCallback(result) {
                CRUDHelperService.stopLoader(nodeListCtrl);
            });
        }
        //Load from cache for quick display initially
        getNodes(false);
        var promise;
        //Don't do auto-refresh if one is already in progress
        if (!angular.isDefined(promise)) {
            promise = $interval(function () {
                getNodes(true);
            }, ContivGlobals.REFRESH_INTERVAL);
        }
        //stop polling when user moves away from the page
        $scope.$on('$destroy', function () {
            $interval.cancel(promise);
        });
    }]);
//# sourceMappingURL=nodelistctrl.js.map
angular.module('contiv.organizations')
    .config(['$stateProvider', function ($stateProvider) {
        $stateProvider
            .state('contiv.menu.organizations.create', {
            url: '/create',
            templateUrl: 'organizations/organizationcreate.html',
            controller: 'OrganizationCreateCtrl as organizationCreateCtrl'
        });
    }])
    .controller('OrganizationCreateCtrl', ['$state', 'OrganizationsModel', 'CRUDHelperService',
    function ($state, OrganizationsModel, CRUDHelperService) {
        var organizationCreateCtrl = this;
        function returnToOrganizations() {
            $state.go('contiv.menu.organizations.list');
        }
        function cancelCreating() {
            returnToOrganizations();
        }
        function createOrganization() {
            //form controller is injected by the html template
            //checking if all validations have passed
            if (organizationCreateCtrl.form.$valid) {
                CRUDHelperService.hideServerError(organizationCreateCtrl);
                CRUDHelperService.startLoader(organizationCreateCtrl);
                organizationCreateCtrl.newOrganization.key = organizationCreateCtrl.newOrganization.tenantName;
                OrganizationsModel.create(organizationCreateCtrl.newOrganization).then(function successCallback(result) {
                    CRUDHelperService.stopLoader(organizationCreateCtrl);
                    returnToOrganizations();
                }, function errorCallback(result) {
                    CRUDHelperService.stopLoader(organizationCreateCtrl);
                    CRUDHelperService.showServerError(organizationCreateCtrl, result);
                });
            }
        }
        function resetForm() {
            CRUDHelperService.stopLoader(organizationCreateCtrl);
            CRUDHelperService.hideServerError(organizationCreateCtrl);
            organizationCreateCtrl.newOrganization = {
                tenantName: ''
            };
        }
        organizationCreateCtrl.createOrganization = createOrganization;
        organizationCreateCtrl.cancelCreating = cancelCreating;
        resetForm();
    }]);
//# sourceMappingURL=organizationcreatectrl.js.map
angular.module('contiv.organizations')
    .config(['$stateProvider', function ($stateProvider) {
        $stateProvider
            .state('contiv.menu.organizations.details', {
            url: '/details/:key',
            controller: 'OrganizationDetailsCtrl as organizationDetailsCtrl',
            templateUrl: 'organizations/organizationdetails.html'
        });
    }])
    .controller('OrganizationDetailsCtrl', ['$state', '$stateParams', 'OrganizationsModel', 'CRUDHelperService',
    function ($state, $stateParams, OrganizationsModel, CRUDHelperService) {
        var organizationDetailsCtrl = this;
        function returnToOrganizations() {
            $state.go('contiv.menu.organizations.list');
        }
        function deleteOrganization() {
            CRUDHelperService.hideServerError(organizationDetailsCtrl);
            CRUDHelperService.startLoader(organizationDetailsCtrl);
            OrganizationsModel.delete(organizationDetailsCtrl.organization).then(function successCallback(result) {
                CRUDHelperService.stopLoader(organizationDetailsCtrl);
                returnToOrganizations();
            }, function errorCallback(result) {
                CRUDHelperService.stopLoader(organizationDetailsCtrl);
                CRUDHelperService.showServerError(organizationDetailsCtrl, result);
            });
        }
        CRUDHelperService.stopLoader(organizationDetailsCtrl);
        CRUDHelperService.hideServerError(organizationDetailsCtrl);
        OrganizationsModel.getModelByKey($stateParams.key)
            .then(function (organization) {
            organizationDetailsCtrl.organization = organization;
        });
        organizationDetailsCtrl.deleteOrganization = deleteOrganization;
    }]);
//# sourceMappingURL=organizationdetailsctrl.js.map
/**
 * Created by vjain3 on 6/1/16.
 */
angular.module('contiv.storagepolicies')
    .config(['$stateProvider', function ($stateProvider) {
        $stateProvider
            .state('contiv.menu.storagepolicies.create', {
            url: '/create',
            templateUrl: 'storage_policies/storagepolicycreate.html',
            controller: 'StoragePolicyCreateCtrl as storagePolicyCreateCtrl'
        });
    }])
    .controller('StoragePolicyCreateCtrl', ['$state', '$stateParams', 'StoragePoliciesModel', 'CRUDHelperService',
    function ($state, $stateParams, StoragePoliciesModel, CRUDHelperService) {
        var storagePolicyCreateCtrl = this;
        function returnToStoragePolicies() {
            $state.go('contiv.menu.storagepolicies.list');
        }
        function cancelCreating() {
            returnToStoragePolicies();
        }
        function createFilesystemCmds() {
            storagePolicyCreateCtrl.filesystemcmds.forEach(function (item) {
                storagePolicyCreateCtrl.newStoragePolicy.filesystems[item.name] = item.value;
            });
        }
        function createPolicy() {
            //form controller is injected by the html template
            //checking if all validations have passed
            if (storagePolicyCreateCtrl.form.$valid) {
                CRUDHelperService.hideServerError(storagePolicyCreateCtrl);
                CRUDHelperService.startLoader(storagePolicyCreateCtrl);
                createFilesystemCmds();
                StoragePoliciesModel.create(storagePolicyCreateCtrl.newStoragePolicy)
                    .then(function successCallback(result) {
                    CRUDHelperService.stopLoader(storagePolicyCreateCtrl);
                    returnToStoragePolicies();
                }, function errorCallback(result) {
                    CRUDHelperService.stopLoader(storagePolicyCreateCtrl);
                    CRUDHelperService.showServerError(storagePolicyCreateCtrl, result);
                });
            }
        }
        function resetForm() {
            CRUDHelperService.stopLoader(storagePolicyCreateCtrl);
            CRUDHelperService.hideServerError(storagePolicyCreateCtrl);
            storagePolicyCreateCtrl.newStoragePolicy = {
                "name": "",
                "backends": {
                    "crud": "ceph",
                    "mount": "ceph",
                    "snapshot": "ceph"
                },
                "unlocked": false,
                "driver": {
                    "pool": "rbd"
                },
                "create": {
                    "size": "0",
                    "filesystem": ""
                },
                "runtime": {
                    "snapshots": true,
                    "snapshot": {
                        "frequency": "30m",
                        "keep": 20
                    },
                    "rate-limit": {
                        "write-iops": 0,
                        "read-iops": 0,
                        "write-bps": 0,
                        "read-bps": 0
                    }
                },
                "filesystems": {}
            };
        }
        storagePolicyCreateCtrl.createPolicy = createPolicy;
        storagePolicyCreateCtrl.cancelCreating = cancelCreating;
        storagePolicyCreateCtrl.filesystemcmds = [];
        resetForm();
    }]);
//# sourceMappingURL=storagepolicycreatectrl.js.map
/**
 * Created by vjain3 on 5/27/16.
 */
angular.module('contiv.storagepolicies')
    .config(['$stateProvider', function ($stateProvider) {
        $stateProvider
            .state('contiv.menu.storagepolicies.details', {
            url: '/details/:key',
            controller: 'StoragePolicyDetailsCtrl as storagePolicyDetailsCtrl',
            templateUrl: 'storage_policies/storagepolicydetails.html'
        })
            .state('contiv.menu.storagepolicies.edit', {
            url: '/details/:key',
            controller: 'StoragePolicyDetailsCtrl as storagePolicyDetailsCtrl',
            templateUrl: 'storage_policies/storagepolicydetails.html'
        });
    }])
    .controller('StoragePolicyDetailsCtrl', ['$state', '$stateParams', '$scope', '$interval', '$filter', 'StoragePoliciesModel', 'VolumesModel', 'CRUDHelperService',
    function ($state, $stateParams, $scope, $interval, $filter, StoragePoliciesModel, VolumesModel, CRUDHelperService) {
        var storagePolicyDetailsCtrl = this;
        storagePolicyDetailsCtrl.filesystemcmds = [];
        /**
         * To show edit or details screen based on the route
         */
        function setMode() {
            if ($state.is('contiv.menu.storagepolicies.edit')) {
                storagePolicyDetailsCtrl.mode = 'edit';
            }
            else {
                storagePolicyDetailsCtrl.mode = 'details';
            }
        }
        function returnToPolicies() {
            $state.go('contiv.menu.storagepolicies.list');
        }
        function returnToPolicyDetails() {
            $state.go('contiv.menu.storagepolicies.details', { 'key': storagePolicyDetailsCtrl.policy.name });
        }
        function cancelEditing() {
            returnToPolicyDetails();
        }
        function deletePolicy() {
            CRUDHelperService.hideServerError(storagePolicyDetailsCtrl);
            CRUDHelperService.startLoader(storagePolicyDetailsCtrl);
            StoragePoliciesModel.deleteUsingKey(storagePolicyDetailsCtrl.policy.name, 'name').then(function successCallback(result) {
                CRUDHelperService.stopLoader(storagePolicyDetailsCtrl);
                returnToPolicies();
            }, function errorCallback(result) {
                CRUDHelperService.stopLoader(storagePolicyDetailsCtrl);
                CRUDHelperService.showServerError(storagePolicyDetailsCtrl, result);
            });
        }
        /**
         * Get volumes belonging to a policy
         */
        function getVolumes(reload) {
            VolumesModel.get(reload).then(function (result) {
                storagePolicyDetailsCtrl.volumes = $filter('orderBy')(_.filter(result, {
                    'policy': storagePolicyDetailsCtrl.policy.name
                }), 'name');
            });
        }
        function initializeFilesystemCmdsArray() {
            angular.forEach(storagePolicyDetailsCtrl.policy.filesystems, function (value, key) {
                this.push({ name: key, value: value });
            }, storagePolicyDetailsCtrl.filesystemcmds);
        }
        function createFilesystemCmds() {
            storagePolicyDetailsCtrl.filesystemcmds.forEach(function (item) {
                storagePolicyDetailsCtrl.policy.filesystems[item.name] = item.value;
            });
        }
        function savePolicy() {
            //form controller is injected by the html template
            //checking if all validations have passed
            if (storagePolicyDetailsCtrl.form.$valid) {
                CRUDHelperService.hideServerError(storagePolicyDetailsCtrl);
                CRUDHelperService.startLoader(storagePolicyDetailsCtrl);
                createFilesystemCmds();
                StoragePoliciesModel.save(storagePolicyDetailsCtrl.policy).then(function successCallback(result) {
                    CRUDHelperService.stopLoader(storagePolicyDetailsCtrl);
                    returnToPolicyDetails();
                }, function errorCallback(result) {
                    CRUDHelperService.stopLoader(storagePolicyDetailsCtrl);
                    CRUDHelperService.showServerError(storagePolicyDetailsCtrl, result);
                });
            }
        }
        CRUDHelperService.stopLoader(storagePolicyDetailsCtrl);
        CRUDHelperService.hideServerError(storagePolicyDetailsCtrl);
        StoragePoliciesModel.getModelByKey($stateParams.key, false, 'name')
            .then(function (policy) {
            storagePolicyDetailsCtrl.policy = policy;
            initializeFilesystemCmdsArray();
            getVolumes(false);
        });
        storagePolicyDetailsCtrl.deletePolicy = deletePolicy;
        storagePolicyDetailsCtrl.savePolicy = savePolicy;
        storagePolicyDetailsCtrl.cancelEditing = cancelEditing;
        setMode();
        var promise;
        //Don't do autorefresh if one is already in progress
        if (!angular.isDefined(promise)) {
            promise = $interval(function () {
                getVolumes(true);
            }, ContivGlobals.REFRESH_INTERVAL);
        }
        //stop polling when user moves away from the page
        $scope.$on('$destroy', function () {
            $interval.cancel(promise);
        });
    }]);
//# sourceMappingURL=storagepolicydetailsctrl.js.map
/**
 * Created by vjain3 on 6/2/16.
 */
angular.module("contiv.storagepolicies")
    .directive("ctvStoragepolicybasicsettings", function () {
    return {};
})
    .directive("ctvStoragepolicyfilesystemsettings", function () {
    return {
        restrict: 'E',
        scope: {
            policy: '=',
            filesystemcmds: '='
        },
        link: function (scope) {
            scope.filesystems = ['ext4', 'btrfs'];
        },
        templateUrl: 'storage_policies/filesystemsettings.html'
    };
})
    .directive("ctvStoragepolicysnapshotsettings", function () {
    return {
        restrict: 'E',
        scope: {
            policy: '='
        },
        templateUrl: 'storage_policies/snapshotsettings.html'
    };
})
    .directive("ctvStoragepolicyrwopssettings", function () {
    return {
        restrict: 'E',
        scope: {
            policy: '='
        },
        templateUrl: 'storage_policies/rwopssettings.html'
    };
})
    .directive("ctvStoragepolicybackenddrivers", function () {
    return {
        restrict: 'E',
        scope: {
            policy: '='
        },
        templateUrl: 'storage_policies/backenddrivers.html'
    };
});
//# sourceMappingURL=storagepolicydirective.js.map


angular.module('contiv.visualization')
    .config(['$stateProvider', function ($stateProvider) {
        $stateProvider
            .state('contiv.menu.visualization.edge', {
                url: '/edge/{sourceName, targetName, sourceList, targetList}',
                params: {
                    sourceName: null,
                    targetName: null,
                    sourceList: null,
                    targetList: null
                },
                controller: 'VisualizationEdgeCtrl as visualizationedgeCtrl',
                templateUrl: 'visualization/visualizationedge.html'
            })
        ;
    }])
    .controller('VisualizationEdgeCtrl', ["$scope", "$http", '$state', '$stateParams', 'VisualizationService', '$interval',
        function($scope, $http, $state, $stateParams, VisualizationService, $interval) {
            var sourceName = $stateParams.sourceName;
            var targetName = $stateParams.targetName;
            var sourceList = $stateParams.sourceList;
            var targetList = $stateParams.targetList;

            //If the page is reloaded, these state params are all null,
            //so it will route them back to the visualization tab top view
            if (sourceList == null || targetList == null) {
                $state.go('contiv.menu.visualization.list');
                return;
            }

            var d = new Date();
            var t = d.getSeconds();
            $scope.edgeDataInterval = 
                $interval(function() {
                    VisualizationService.getEdgeData(sourceList, targetList, t.toString())
                        .then(function successCallback(result) {
                            var results = result.results;
                            var data = 0;
                            _.forEach(results, function(r) {
                                if (_.isEmpty(r) === false) {
                                    data += r.series[0].values[0][1];
                                }
                            });
                            $scope.sourceName = sourceName;
                            $scope.targetName = targetName;
                            $scope.edgeData = data;
                            $scope.edgeDataTime = t;
                        }, function errorCallback(result) {
                        });
                    }, 3000);

            //Destroying the interval function on route change
            $scope.$on('$destroy', function () { $interval.cancel($scope.edgeDataInterval); });


            VisualizationService.getOldEdgeData(sourceList, targetList)
                .then(function successCallback(result) {
                    var results = result.results;
                    var edgeData = [];
                    //results, if not empty, are expected to have
                    //6 data entries
                    _.forEach(results, function(r) {
                        if (_.isEmpty(r) === false) {
                            var data = r.series[0].values;
                            if (_.isEmpty(edgeData)) {
                                _.forEach(data, function(d) {
                                    edgeData.push(d[1]);
                                })
                            } else {
                                _.forEach(data, function(d, i) {
                                    edgeData[i] += d[1];
                                })
                            }
                        }
                    });

                    $scope.sourceName = sourceName;
                    $scope.targetName = targetName;
                    $scope.sourceList = sourceList;
                    $scope.targetList = targetList;
                    $scope.oldEdgeData = edgeData;
                }, function errorCallback(result) {
                });
    }]);







angular.module('contiv.visualization')
    .directive("visualizationEdge", ['$window',
        function($window) {
            function visualizationEdgeD3(scope, d3) {
                var bodyEl = document.getElementsByTagName('body')[0];
              
                var width = bodyEl.clientWidth - 400,
                    height =  bodyEl.clientHeight - 400;


                //taken from http://bl.ocks.org/simenbrekken/6634070
                // /** MAIN SVG **/
                var limit = 59,
                duration = 750,
                now = new Date(Date.now() - duration);

                var groups = {
                    current: {
                        value: 0,
                        color: 'orange',
                        data: d3.range(limit).map(function(d) {
                            return scope.oldEdgeData[Math.floor(d/10)] || 0;
                        })
                    }
                };
                var x = d3.time.scale()
                    .domain([now - (limit - 2), now - duration])
                    .range([0, width]);

                var y = d3.scale.linear()
                    .domain([0, d3.max(groups.current.data, function (d) { return d + 10; })])
                    .range([height, 0]);

                var line = d3.svg.line()
                    .interpolate('basis')
                    .x(function(d, i) {
                        return x(now - (limit - 1 - i) * duration)
                    })
                    .y(function(d) {
                        return y(d)
                    });

                var xSvg = d3.select('.graph').append('svg')
                    .attr('width', 25)
                    .style('overflow', 'visible')
                    .style('position', 'fixed');

                

                var yAxis = xSvg.append('g')
                    .attr('class', 'y axis')
                    // .attr('transform', 'translate(0,' + width + ')')
                    .call(y.axis = d3.svg.axis().scale(y).orient('left'));
                
                var svg= d3.select('.graph').append('svg')
                    .attr('class', 'chart')
                    .attr('width', width - 50)
                    .attr('height', height + 50);
                    // .style('overflow', "visible");

                var axis = svg.append('g')
                    .attr('class', 'x axis')
                    .attr('transform', 'translate(0,' + height + ')')
                    .call(x.axis = d3.svg.axis().scale(x).orient('bottom'));

                var paths = svg.append('g');

                for (var name in groups) {
                    var group = groups[name];
                    group.path = paths.append('path')
                        .data([group.data])
                        .attr('class', name + ' group')
                        .style('stroke', group.color)
                }

                function tick() {
                    now = new Date();

                    // Add new values
                    for (var name in groups) {
                        var group = groups[name];
                        group.data.push(scope.edgeData || 0);
                        group.path.attr('d', line)
                    }

                    // Shift domain
                    x.domain([now - (limit - 2) * duration, now - duration]);

                    // Slide x-axis left
                    axis.transition()
                        .duration(duration)
                        .ease('linear')
                        .call(x.axis);

                    yAxis.transition()
                        .duration(duration)
                        .ease('linear')
                        .call(y.axis);

                    // Slide paths left
                    paths.attr('transform', null)
                        .transition()
                        .duration(duration)
                        .ease('linear')
                        .attr('transform', 'translate(' + x(now - (limit - 1) * duration) + ')')
                        .each('end', function() {
                            tick()
                        });

                    // Remove oldest data point from each group
                    for (var name in groups) {
                        var group = groups[name];
                        group.data.shift()
                    }
                }
                tick()
            }

            return{
                restrict:'EA',
                replace: false,
                templateUrl: 'visualization/visualizationedgetemplate.html',
                link: function(scope){
                    scope.$watchGroup(['edgeData', 'oldEdgeData'],
                        function() {
                            if (scope.edgeData != null &&
                                    scope.oldEdgeData != null ) {
                                if (!scope.initialize) {
                                    scope.initialize = true;
                                    var d3 = $window.d3;  
                                    visualizationEdgeD3(scope, d3);
                                }
                            } 
                        });
               }
           };
        }
    ]
);


angular.module('contiv.visualization')
    .service('StateSave', function () {
        this.savedStates = {};
    })
    .directive("visualizationGraph", ['$window', '$state', 'VisualizerGraph', 'PolicyService', 'VisualizerDataSource', 'StateSave',
        function($window, $state, VisualizerGraph, PolicyService, VisualizerDataSource, StateSave) {
            function visualizationlistd3(scope, elem, VisualizerGraph, PolicyService, VisualizerDataSource, StateSave) {
                //don't run until all initialization calls have returned
                if (scope.nodes === undefined || scope.links === undefined || scope.children_struct === undefined ||
                    scope.ancestors_struct === undefined) {
                    return;
                }

                //creating DataSource
                var dataSource = new VisualizerDataSource.DataSource(scope.nodes, scope.links, scope.children_struct, 
                                    scope.ancestors_struct, scope.labels, scope.serviceSelectors);
                dataSource.setAncestors();

                var nodes, links;

                var topData = dataSource.getTopLevelFlow();
                nodes = dataSource.processNodeData(topData.nodeData);
                links = dataSource.processLinkData(topData.linkData, nodes);

                var bodyEl = document.getElementsByTagName('body')[0];
              
                var width = bodyEl.clientWidth,
                    height =  bodyEl.clientHeight;

                /** MAIN SVG **/
                var rawSvg=elem.find('svg');

                var offset = $(rawSvg.parent()).offset();

                var divWidth = $(rawSvg.parent()).width();

                var svg = d3.select(rawSvg[0])
                    .attr("width", divWidth)
                    .attr("height", height - offset.top - 20);

                //installing policies
                scope.visualizationGraph = new VisualizerGraph.Graph(svg, nodes, links, dataSource, 
                            scope.children_struct, scope.ancestors_struct);
                scope.visualizationGraph.installDefaultPathPolicy(new PolicyService.SaveStatePolicy(StateSave.savedStates));
                scope.visualizationGraph.installDefaultPathPolicy(new PolicyService.PathChangeViewPolicy($state));
                //QTipPolicy is for both Nodes and Paths, install same one on both
                var qTipPolicy = new PolicyService.QTipPolicy();
                scope.visualizationGraph.installDefaultNodePolicy(qTipPolicy);
                scope.visualizationGraph.installDefaultPathPolicy(qTipPolicy);
                var splitJoinViewPolicy = new PolicyService.SplitJoinViewPolicy();
                scope.visualizationGraph.installDefaultNodePolicy(splitJoinViewPolicy);
                splitJoinViewPolicy.installBackButton($('#backButton'));
                splitJoinViewPolicy.installTitle($('#graph-title'));

                //load old view if it exists.
                if (_.isEmpty(StateSave.savedStates) == false) {
                    var graph = scope.visualizationGraph;
                    graph.load(StateSave.savedStates);
                } else {
                    scope.visualizationGraph.updateGraph();
                }
            }

            return{
                restrict:'EA',
                replace: false,
                templateUrl: 'visualization/visualizationtemplate.html',
                link: function(scope, elem){
                    scope.$on('$destroy', function () { 
                        $('#visualization-graph').unbind();
                        scope.visualizationGraph.destroy();});
                    scope.$watchGroup(['nodes', 'links', 'children_struct', 'ancestors_struct'],
                            function() {
                        if (scope.nodes != null &&
                                scope.links != null &&
                                scope.children_struct != null &&
                                scope.ancestors_struct != null) {
                            if (!scope.initialized) {
                                scope.initialized = true;
                                visualizationlistd3(scope, elem, VisualizerGraph, PolicyService, VisualizerDataSource, StateSave);
                            } else {
                                scope.visualizationGraph.dataSource.links = scope.links;
                                scope.visualizationGraph.updateLinkData();
                            }
                        }
                    });
               }
           };
        }
    ]
);













angular.module('contiv.visualization')
    .config(['$stateProvider', function ($stateProvider) {
        $stateProvider
            .state('contiv.menu.visualization.list', {
                url: '/list',
                controller: 'VisualizationListCtrl as visualizationListCtrl',
                templateUrl: 'visualization/visualizationlist.html'
            })
        ;
    }])
    .controller('VisualizationListCtrl', ["$scope", "$http", 'VisualizationService', '$interval', 
        function($scope, $http, VisualizationService, $interval) {
            //to see the expected format to be returned from these calls,
            //look at app/components/graphobjects/datasource/visualizerdatasource.js
            var successGraphDataCallback = function(result) {
                var nodes = [];
                var links = [];
                var nodeIds = [];
                _.forEach(result.results[0].series, function(series) {
                    var endpoint = series.tags.EndpointIP;
                    var provider = series.tags.ProviderIP;
                    var node;
                    //creating nodes
                    if (_.includes(nodeIds, endpoint) == false) {
                        node = {
                            name: endpoint,
                            id: endpoint,
                            parent: null,
                            ancestors: null
                        };
                        nodes.push(node);
                        nodeIds.push(endpoint);
                    }
                    if (_.includes(nodeIds, provider) == false) {
                        node = {
                            name: provider,
                            id: provider,
                            parent: null,
                            ancestors: null
                        };
                        nodes.push(node);
                        nodeIds.push(provider);
                    }
                    //creating links
                    var linkOut = {
                        source: endpoint,
                        target: provider,
                        weight: series.values[0][2]
                    };
                    links.push(linkOut);
                    var linkIn = {
                        source: provider,
                        target: endpoint,
                        weight: series.values[0][1]
                    };
                    links.push(linkIn);
                });
                $scope.nodes = nodes;
                $scope.links = links;
            };
            //initial call
            VisualizationService.getGraphData().then(successGraphDataCallback, function errorCallback(result) {
                //will fail silently, graph won't be displayed
            });

            $scope.$on('$destroy', function () { $interval.cancel($scope.graphDataInterval); });

            VisualizationService.getStructureData().then(function successCallback(result) {
                //to see the expected form of ancestor_struct and children_struct, 
                //look at app/components/graphobjects/datasource/visualizerdatasource.js
                $scope.ancestors_struct = result.ancestors_struct;
                $scope.children_struct = result.children_struct;
                $scope.labels = result.labels;
                $scope.serviceSelectors = result.serviceSelectors;
            }, function errorCallback(result) {
                //will fail silently, graph won't be displayed
            });
    }]);












angular.module('contiv.visualization')
    .factory('VisualizationService', ['$http', '$q', function ($http, $q) {
        /**
         * Makes a get request with the url and config.
         *
         * @param      {string}  url     The url
         * @param      {Object}  config  The configurations
         * @return     {$Http Promise}   Promise of the request
         */
        function makeGet(url, config) {
            var deferred = $q.defer();
            $http.get(url, config).then(function successCallback(result) {
                deferred.resolve(result.data);
            }, function errorCallback(result) {
                deferred.reject(result.data);
            });
            return deferred.promise;
        }

        /**
         * Makes a post request with the url and data
         *
         * @param      {string}  url     The url
         * @param      {JSON}    data    The data
         * @return     {$Http Promise}   Promise of the request
         */
        function makePost(url, data) {
            /**
             * converts the data into x-www-from-urlencoded
             *
             * @param      {JSON}  obj     JSON data object
             * @return     {string}  x-www-form-urlencoded string
             */
            var param = function(obj) {
                var query = '', name, value, fullSubName, subName, subValue, innerObj, i;
                for (name in obj) {
                  value = obj[name];

                    if (value instanceof Array) {
                        for (i=0; i<value.length; ++i) {
                            subValue = value[i];
                            fullSubName = name + '[' + i + ']';
                            innerObj = {};
                            innerObj[fullSubName] = subValue;
                            query += param(innerObj) + '&';
                        }
                    } else if (value instanceof Object) {
                        for (subName in value) {
                            subValue = value[subName];
                            fullSubName = name + '[' + subName + ']';
                            innerObj = {};
                            innerObj[fullSubName] = subValue;
                            query += param(innerObj) + '&';
                        }
                    } else if(value !== undefined && value !== null) {
                        query += encodeURIComponent(name) + '=' + encodeURIComponent(value) + '&';
                   }
                }

                return query.length ? query.substr(0, query.length - 1) : query;
            };

            var deferred = $q.defer();
            $http({
                url:url,
                method:'POST',
                data: data,
                headers: {
                  'Content-Type': 'application/x-www-form-urlencoded'
                },
                transformRequest: [function(data) {
                    return angular.isObject(data) && String(data) !== '[object File]' ? param(data) : data;
                  }]
            })
            .then(function successCallback(result) {
                deferred.resolve(result.data);
            }, function errorCallback(result) {
                deferred.reject(result.data);
            });
            return deferred.promise;
        }

        function getGraphData() {
            var url = ContivGlobals.VISUALIZATION_ENDPOINT;
            url += 'influx/query';
            var config = {
                params: {
                    db:"telegraf",
                    q:"SELECT BytesIn, BytesOut, EndpointIP, ProviderIP FROM httpjson_svcstats WHERE time > now() - 1m GROUP BY * LIMIT 1"
                }
            };
            return makeGet(url, config);
        }

        function getStructureData() {
            var url = ContivGlobals.VISUALIZATION_ENDPOINT;
            url += 'services';
            return makeGet(url);
        }

        function buildWhereQuery(points, type) {
            var query = "(";
            query += type + "=";
            query += "'" + points[0] + "' ";
            //starts at 1, so will not run if length is 1
            for (var i = 1; i < points.length; i++) {
                query += 'OR ';
                query += type + "=";
                query += "'" + points[i] + "' ";
            }
            query += ")";
            return query;
        }

        function getEdgeData(sourceList, targetList, time) {
            var url = ContivGlobals.VISUALIZATION_ENDPOINT;
            url += 'influx/query';

            var data = {
                    db : "telegraf",
                    q: "SELECT sum(" + 'BytesOut' + ") from httpjson_svcstats WHERE time > now() - 15s AND "
                         + buildWhereQuery(sourceList, "EndpointIP") +" AND " 
                         + buildWhereQuery(targetList, 'ProviderIP') 
                         + "GROUP BY time(20s) LIMIT 1; SELECT sum(" + 'BytesIn' + ") from httpjson_svcstats WHERE time > now() - 15s AND "
                         + buildWhereQuery(sourceList, 'ProviderIP') +" AND " 
                         + buildWhereQuery(targetList, 'EndpointIP') 
                         + "GROUP BY time(20s) fill(0) LIMIT 1"
                     };
            return makePost(url, data);
        }

        

        function getOldEdgeData(sourceList, targetList) {
            var url = ContivGlobals.VISUALIZATION_ENDPOINT;
            url += 'influx/query';
            var data = {
                    db : "telegraf",
                    q: "SELECT sum(" + 'BytesOut' + ") FROM httpjson_svcstats WHERE time > now() - 1m AND "
                         + buildWhereQuery(sourceList, "EndpointIP") +" AND " 
                         + buildWhereQuery(targetList, "ProviderIP") 
                         + " GROUP BY time(10s) fill(0) LIMIT 6; SELECT sum(" + 'BytesIn' + ") FROM httpjson_svcstats WHERE time > now() - 1m AND "
                         + buildWhereQuery(sourceList, "ProviderIP") +" AND " 
                         + buildWhereQuery(targetList, "EndpointIP") 
                         + " GROUP BY time(10s) fill(0) LIMIT 6"
                     };
            return makePost(url, data);
        }

        return {
            getGraphData: getGraphData,
            getStructureData: getStructureData,
            getEdgeData: getEdgeData,
            getOldEdgeData: getOldEdgeData
        }
    }]);







/**
 * Created by vjain3 on 6/3/16.
 */
angular.module('contiv.volumes')
    .config(['$stateProvider', function ($stateProvider) {
        $stateProvider
            .state('contiv.menu.volumes.create', {
            url: '/create',
            templateUrl: 'volumes/volumecreate.html',
            controller: 'VolumeCreateCtrl as volumeCreateCtrl'
        });
    }])
    .controller('VolumeCreateCtrl', ['$state', '$stateParams', 'VolumesModel', 'StoragePoliciesModel', 'CRUDHelperService',
    function ($state, $stateParams, VolumesModel, StoragePoliciesModel, CRUDHelperService) {
        var volumeCreateCtrl = this;
        volumeCreateCtrl.filesystems = ['ext4', 'btrfs'];
        function returnToVolumesModel() {
            $state.go('contiv.menu.volumes.list');
        }
        function cancelCreating() {
            returnToVolumesModel();
        }
        /**
         * Get storage policies.
         */
        function getStoragePolicies() {
            StoragePoliciesModel.get().then(function (result) {
                volumeCreateCtrl.policies = result;
            });
        }
        function applyPolicySettings() {
            volumeCreateCtrl.newVolume.policy = volumeCreateCtrl.selectedPolicy.name;
            volumeCreateCtrl.newVolume.backends = volumeCreateCtrl.selectedPolicy.backends;
            volumeCreateCtrl.newVolume.driver = volumeCreateCtrl.selectedPolicy.driver;
            volumeCreateCtrl.newVolume.create = volumeCreateCtrl.selectedPolicy.create;
            volumeCreateCtrl.newVolume.runtime = volumeCreateCtrl.selectedPolicy.runtime;
        }
        function createVolume() {
            //form controller is injected by the html template
            //checking if all validations have passed
            if (volumeCreateCtrl.form.$valid) {
                CRUDHelperService.hideServerError(volumeCreateCtrl);
                CRUDHelperService.startLoader(volumeCreateCtrl);
                applyPolicySettings();
                VolumesModel.create(volumeCreateCtrl.newVolume).then(function successCallback(result) {
                    CRUDHelperService.stopLoader(volumeCreateCtrl);
                    returnToVolumesModel();
                }, function errorCallback(result) {
                    CRUDHelperService.stopLoader(volumeCreateCtrl);
                    CRUDHelperService.showServerError(volumeCreateCtrl, result);
                });
            }
        }
        function resetForm() {
            CRUDHelperService.stopLoader(volumeCreateCtrl);
            CRUDHelperService.hideServerError(volumeCreateCtrl);
            volumeCreateCtrl.newVolume = {
                "name": "",
                "backends": {},
                "driver": {},
                "create": {},
                "runtime": {}
            };
        }
        volumeCreateCtrl.createVolume = createVolume;
        volumeCreateCtrl.cancelCreating = cancelCreating;
        getStoragePolicies();
        resetForm();
    }]);
//# sourceMappingURL=volumecreatectrl.js.map
/**
 * Created by cshampur on 8/9/16.
 */
angular.module('contiv.volumes')
    .config(['$stateProvider', function ($stateProvider) {
        $stateProvider
            .state('contiv.menu.volumes.copy', {
            url: '/copy/',
            params: { snapshot: null, policy: null, volume: null },
            controller: 'VolumeSnapshotCopyCtrl as volumeSnapshotCopyCtrl',
            templateUrl: 'volumes/volumesnapshotcopy.html'
        });
    }])
    .controller('VolumeSnapshotCopyCtrl', ['$state', '$stateParams', '$scope', '$interval', '$http', 'VolumesModel', 'CRUDHelperService',
    function ($state, $stateParams, $scope, $interval, $http, VolumesModel, CRUDHelperService) {
        var volumeSnapshotCopyCtrl = this;
        function cancelCopy() {
            $state.go('contiv.menu.volumes.details', { key: $stateParams.policy + '/' + $stateParams.volume });
        }
        function goToNewVolume() {
            $state.go('contiv.menu.volumes.details', { key: $stateParams.policy + '/' + volumeSnapshotCopyCtrl.newvolume });
        }
        function copySnapshot() {
            if (volumeSnapshotCopyCtrl.form.$valid) {
                CRUDHelperService.hideServerError(volumeSnapshotCopyCtrl);
                CRUDHelperService.startLoader(volumeSnapshotCopyCtrl);
                var model = {};
                model.policy = $stateParams.policy;
                model.name = $stateParams.volume;
                VolumesModel.copy(model, $stateParams.snapshot, volumeSnapshotCopyCtrl.newvolume)
                    .then(function successCallback(result) {
                    CRUDHelperService.stopLoader(volumeSnapshotCopyCtrl);
                    goToNewVolume();
                }, function errorCallback(result) {
                    CRUDHelperService.stopLoader(volumeSnapshotCopyCtrl);
                    CRUDHelperService.showServerError(volumeSnapshotCopyCtrl, result);
                });
            }
        }
        volumeSnapshotCopyCtrl.policy = $stateParams.policy;
        volumeSnapshotCopyCtrl.volume = $stateParams.volume;
        volumeSnapshotCopyCtrl.snapshot = $stateParams.snapshot;
        volumeSnapshotCopyCtrl.copySnapshot = copySnapshot;
        volumeSnapshotCopyCtrl.cancelCopy = cancelCopy;
    }]);
//# sourceMappingURL=volumesnapshotcopyctrl.js.map
angular.module("contiv.directives")
    .directive("ctvAcivalid", function () {
        return {
            restrict: 'E',
            templateUrl: 'components/directives/nodes/acivalid.html',
            scope: {
                form: "="
            }
        };
    });
angular.module("contiv.directives")
    .directive("ctvControlinterface", function () {
        return {
            restrict: 'E',
            templateUrl: 'components/directives/nodes/controlinterface.html',
            scope: {
                extravars: "="
            }
        };
    });
angular.module("contiv.directives")
    .directive("ctvNetworkmode", function () {
        return {
            restrict: 'E',
            templateUrl: 'components/directives/nodes/networkmode.html',
            scope: {
                extravars: "="
            }
        };
    });
angular.module("contiv.directives")
    .directive("ctvScheduler", function () {
        return {
            restrict: 'E',
            templateUrl: 'components/directives/nodes/scheduler.html',
            scope: {
                extravars: "="
            }
        };
    });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImRpcmVjdGl2ZXMvbW9kdWxlLmpzIiwiZGF0YXNvdXJjZS9kYXRhc291cmNlLmpzIiwibW9kZWxzL21vZHVsZS5qcyIsImRhdGFzb3VyY2UvdmlzdWFsaXplcmRhdGFzb3VyY2UuanMiLCJ1dGlscy9tb2R1bGUuanMiLCJncmFwaC9ncmFwaC5qcyIsImFwcGxpY2F0aW9uZ3JvdXBzL21vZHVsZS5qcyIsImdyYXBoL3Zpc3VhbGl6ZXJncmFwaC5qcyIsImRhc2hib2FyZC9tb2R1bGUuanMiLCJsaW5rL2xpbmsuanMiLCJsb2dpbi9tb2R1bGUuanMiLCJsaW5rL3Zpc3VhbGl6ZXJsaW5rLmpzIiwibWVudS9tb2R1bGUuanMiLCJub2RlL25vZGUuanMiLCJuZXR3b3JrX3BvbGljaWVzL21vZHVsZS5qcyIsIm5vZGUvdmlzdWFsaXplcm5vZGUuanMiLCJuZXR3b3Jrcy9tb2R1bGUuanMiLCJwb2xpY3kvbm9kZXNlbGVjdGlvbnBvbGljeS5qcyIsIm5vZGVzL21vZHVsZS5qcyIsInBvbGljeS9wYXRoY2hhbmdldmlld3BvbGljeS5qcyIsIm9yZ2FuaXphdGlvbnMvbW9kdWxlLmpzIiwicG9saWN5L3BvbGljeS5qcyIsInNlcnZpY2VfbGJzL21vZHVsZS5qcyIsInBvbGljeS9wb2xpY3lzZXJ2aWNlLmpzIiwic2V0dGluZ3MvbW9kdWxlLmpzIiwicG9saWN5L3F0aXBwb2xpY3kuanMiLCJwb2xpY3kvc2F2ZXN0YXRlcG9saWN5LmpzIiwic3RvcmFnZV9wb2xpY2llcy9tb2R1bGUuanMiLCJ2aXN1YWxpemF0aW9uL21vZHVsZS5qcyIsInBvbGljeS9zcGxpdGpvaW5ub2RlcG9saWN5LmpzIiwidm9sdW1lcy9tb2R1bGUuanMiLCJwb2xpY3kvc3BsaXRqb2ludmlld3BvbGljeS5qcyIsImFwcC5qcyIsIm1lbnUvbWVudUN0cmwuanMiLCJub2Rlcy9iZ3BzZXJ2aWNlLmpzIiwibm9kZXMvbG9nc2RpcmVjdGl2ZS5qcyIsIm5vZGVzL2xvZ3NlcnZpY2UuanMiLCJub2Rlcy9ub2RlYWN0aXZlam9ibG9nc2N0cmwuanMiLCJub2Rlcy9ub2RlY29tbWlzc2lvbmN0cmwuanMiLCJub2Rlcy9ub2RlZGV0YWlsc2N0cmwuanMiLCJub2Rlcy9ub2RlZGlyZWN0aXZlLmpzIiwibm9kZXMvbm9kZWRpc2NvdmVyY3RybC5qcyIsIm5vZGVzL25vZGVsYXN0am9ibG9nc2N0cmwuanMiLCJub2Rlcy9ub2RlbGlzdGN0cmwuanMiLCJvcmdhbml6YXRpb25zL29yZ2FuaXphdGlvbmNyZWF0ZWN0cmwuanMiLCJvcmdhbml6YXRpb25zL29yZ2FuaXphdGlvbmRldGFpbHNjdHJsLmpzIiwic3RvcmFnZV9wb2xpY2llcy9zdG9yYWdlcG9saWN5Y3JlYXRlY3RybC5qcyIsInN0b3JhZ2VfcG9saWNpZXMvc3RvcmFnZXBvbGljeWRldGFpbHNjdHJsLmpzIiwic3RvcmFnZV9wb2xpY2llcy9zdG9yYWdlcG9saWN5ZGlyZWN0aXZlLmpzIiwidmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9uZWRnZWN0cmwuanMiLCJ2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb25lZGdlZGlyZWN0aXZlLmpzIiwidmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9uZ3JhcGhkaXJlY3RpdmUuanMiLCJ2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb25saXN0Y3RybC5qcyIsInZpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbnNlcnZpY2UuanMiLCJ2b2x1bWVzL3ZvbHVtZWNyZWF0ZWN0cmwuanMiLCJ2b2x1bWVzL3ZvbHVtZXNuYXBzaG90Y29weWN0cmwuanMiLCJjb21wb25lbnRzL2RpcmVjdGl2ZXMvbm9kZXMvYWNpdmFsaWRkaXJlY3RpdmUuanMiLCJjb21wb25lbnRzL2RpcmVjdGl2ZXMvbm9kZXMvY29udHJvbGludGVyZmFjZWRpcmVjdGl2ZS5qcyIsImNvbXBvbmVudHMvZGlyZWN0aXZlcy9ub2Rlcy9uZXR3b3JrbW9kZWRpcmVjdGl2ZS5qcyIsImNvbXBvbmVudHMvZGlyZWN0aXZlcy9ub2Rlcy9zY2hlZHVsZXJkaXJlY3RpdmUuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImZhY3RvcnkiLCJOb2RlIiwiTGluayIsIkRhdGFTb3VyY2UiLCJub2RlcyIsImxpbmtzIiwiaWQiLCJpIiwibGVuZ3RoIiwibmFtZSIsIm5vZGVEYXRhIiwiXyIsImZvckVhY2giLCJkYXRhIiwibmV3Tm9kZSIsInRleHQiLCJwdXNoIiwibGlua0RhdGEiLCJmaW5kTm9kZUJ5SWQiLCJzb3VyY2UiLCJ0YXJnZXQiLCJsaW5rIiwiVmlzdWFsaXplck5vZGUiLCJWaXN1YWxpemVyTGluayIsIlZpc3VhbGl6ZXJEYXRhU291cmNlIiwiY2hpbGRyZW5fc3RydWN0IiwiYW5jZXN0b3JzX3N0cnVjdCIsImxhYmVscyIsInNlbGVjdG9ycyIsInRoaXNEYXRhU291cmNlIiwiYWRkZWRDbGllbnQiLCJub2RlIiwiYW5jZXN0b3JzIiwiaXNFbXB0eSIsInBhcmVudCIsImluY2x1ZGVzIiwidG9wTGV2ZWwiLCJnZXRGbG93QmV0d2VlblNldCIsIm5vZGVfbmFtZXMiLCJsb2NhbF9ub2RlcyIsImlkTWFwcGluZyIsImoiLCJpbmRleE9mIiwid2VpZ2h0Iiwibm9kZV90b19hZGQiLCJub2RlSWRUb05hbWUiLCJhZGRlZF9saW5rcyIsInVuZGVmaW5lZCIsImV4aXN0aW5nX2xpbmsiLCJzZXRXZWlnaHQiLCJnZXRSYXdXZWlnaHQiLCJpbmNyZWFzZUNvdW50IiwiUG9saWN5U2VydmljZSIsIkdyYXBoIiwic3ZnIiwidGhpc0dyYXBoIiwiZGVmYXVsdE5vZGVQb2xpY2llcyIsImRlZmF1bHRQYXRoUG9saWNpZXMiLCJzdmdQb2xpY3kiLCJQb2xpY3kiLCJzdGF0ZSIsImNhblpvb20iLCJjYW5QYW4iLCJpbml0Rm9yY2UiLCJkaXNhYmxlVXBkYXRlIiwiY29uc3RzIiwiY2lyY2xlR0NsYXNzIiwiZ3JhcGhDbGFzcyIsInBhdGhDbGFzcyIsIm5vZGVDbGFzcyIsIm5vZGVUZXh0Iiwic3RhcnRSYWRpdXMiLCJtYXhSYWRpdXMiLCJwYWRkaW5nIiwiZGlzcGxheU9mZnNldCIsIm9uIiwiZCIsImNhbGwiLCJkZWZzIiwiYXBwZW5kIiwiYXR0ciIsInN2Z0ciLCJjbGFzc2VkIiwicGF0aHMiLCJzZWxlY3RBbGwiLCJjaXJjbGVzIiwiaW5pdE5vZGVzIiwiaW5pdExpbmtzIiwic2V0UG9zaXRpb25zIiwicmVzaXplRnVuYyIsIm9uV2luZG93UmVzaXplIiwiYmluZGluZ3MiLCJyZXNpemUiLCIkIiwid2luZG93IiwicG9saWN5IiwiZGVzdHJveSIsImtleSIsIm9mZiIsImluaXRpYWxpemUiLCJkM05vZGUiLCJlYWNoIiwiZDMiLCJzZWxlY3QiLCJkM2RyYWciLCJkcmFnIiwicG9saWN5UmVtb3ZlIiwicG9saWN5UmVtb3ZlTmFtZSIsInBvbGljeU5hbWUiLCJpbmRleCIsInNwbGljZSIsImV2ZW50IiwiZDNwYXRoIiwiZDNub2RlIiwiZDN6b29tIiwiZHJhZ1N2ZyIsImdFbCIsInRpdGxlIiwid29yZHMiLCJzcGxpdCIsIm53b3JkcyIsImVsIiwidHNwYW4iLCJ0b1NwbGljZSIsImZpbHRlciIsImwiLCJtYXAiLCJ1cGRhdGVHcmFwaCIsInNwbGljZUxpbmtzRm9yTm9kZSIsInVwZGF0ZUF0dHIiLCJuZXdQYXRocyIsIm5ld1BhdGhBdHRyIiwiaGFzUG9saWN5IiwicGF0aFBvbGljeUV2ZW50IiwibmV3Tm9kZXMiLCJncmFwaCIsIm5ld05vZGVBdHRyIiwibm9kZVBvbGljeUV2ZW50IiwiU3RyaW5nIiwicmFkaXVzIiwiaW5zZXJ0VGl0bGVMaW5lYnJlYWtzIiwiYWxwaGEiLCJxdWFkdHJlZSIsImdlb20iLCJyIiwibngxIiwieCIsIm54MiIsIm55MSIsInkiLCJueTIiLCJ2aXNpdCIsInF1YWQiLCJ4MSIsInkxIiwieDIiLCJ5MiIsInBvaW50IiwiTWF0aCIsInNxcnQiLCJlIiwid2lkdGgiLCJoZWlnaHQiLCJvZmZzZXQiLCJxIiwibiIsImQzRm9yY2VDb2xsaWRlIiwibWF4IiwibWluIiwic3ZnV2lkdGgiLCJzdmdIZWlnaHQiLCJjYWxsYmFjayIsImJvdW5kcyIsImQzRm9yY2VCb3VuZHMiLCJmb3JjZSIsImxheW91dCIsInNpemUiLCJjaGFyZ2UiLCJsaW5rRGlzdGFuY2UiLCJsaW5rU3RyZW5ndGgiLCJncmF2aXR5IiwiZDNGb3JjZVRpY2siLCJkM0ZvcmNlU3RhcnQiLCJkM0ZvcmNlRW5kIiwic3RhcnQiLCJrIiwidGljayIsInN0b3AiLCJ1cGRhdGVFeGlzdGluZ05vZGVzIiwibmV3R3MiLCJlbnRlciIsImV4aXQiLCJyZW1vdmUiLCJzZXRGb3JjZSIsInVwZGF0ZU5ld05vZGVzIiwidXBkYXRlRXhpc3RpbmdQYXRocyIsIm5ld3BhdGhzIiwic3R5bGUiLCJ1cGRhdGVOZXdQYXRocyIsIlZpc3VhbGl6ZXJHcmFwaCIsImRhdGFTb3VyY2UiLCJ0cmFuc2l0aW9uIiwiZWRnZV9idWZmZXIiLCJyYWRpdXNEZWNheSIsImNvbnRhaW5lckNsYXNzIiwiYmVoYXZpb3IiLCJvcmlnaW4iLCJhcmdzIiwiZHgiLCJkeSIsInpvb20iLCJzb3VyY2VFdmVudCIsImN0cmxLZXkiLCJ6b29tZWQiLCJ0cmFuc2xhdGUiLCJzY2FsZSIsInJpZ2h0Q2xpY2siLCJqdXN0U2NhbGVUcmFuc0dyYXBoIiwiem9vbVNldENhbGxiYWNrIiwidHJhbnNsYXRlX25hbWUiLCJkZWxheSIsImR1cmF0aW9uIiwiYm9keUVsIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsImRpdldpZHRoIiwiY2xpZW50SGVpZ2h0IiwidG9wIiwibm9kZV9uYW1lc19zZXQiLCJyZXREYXRhIiwicHJvY2Vzc0xpbmtEYXRhIiwic291cmNlTm9kZSIsInRhcmdldE5vZGUiLCJwYXRoUG9saWNpZXMiLCJpbml0aWFsaXplZCIsImFycm93UGF0aCIsImRyIiwidGhpc1BhdGgiLCJjb3VudCIsInJldCIsIm15IiwiYXQiLCJhZGp1c3QiLCJtYXhXZWlnaHQiLCJ1c2VBdmdXZWlnaHQiLCJ1cGRhdGVNYXhXZWlnaHQiLCJ2YWwiLCJtYXhMaW5rIiwibWF4QnkiLCJnZXRXZWlnaHQiLCJjb2xvclNjYWxlIiwibGluZWFyIiwiZG9tYWluIiwicmFuZ2UiLCJzZWxlY3RlZENsYXNzIiwic2VsZWN0ZWRFZGdlIiwiYyIsImF0dHJUd2VlbiIsImludGVycG9sYXRlU3RyaW5nIiwibm9kZVBvbGljaWVzIiwidGhpc05vZGUiLCJ4U3RhcnQiLCJ5U3RhcnQiLCJOb2RlU2VsZWN0aW9uUG9saWN5Iiwic2VsZWN0ZWROb2RlcyIsInNlbGVjdGlvbiIsImNkIiwic3RvcFByb3BhZ2F0aW9uIiwicmVtb3ZlU2VsZWN0RnJvbU5vZGUiLCJhZGRTZWxlY3ROb2RlIiwicmVtb3ZlQWxsU2VsZWN0ZWROb2RlcyIsIlBhdGhDaGFuZ2VWaWV3UG9saWN5IiwiJHN0YXRlIiwidGhpc1BvbGljeSIsInJldExpc3QiLCJnZW5lcmF0ZUxpc3RIZWxwZXIiLCJub2RlSWRzIiwiY2hpbGRJZCIsImhhc0NoaWxkIiwic3ViUmV0TGlzdCIsImNvbmNhdCIsImVkZ2UiLCJzb3VyY2VMaXN0IiwidGFyZ2V0TGlzdCIsInNvdXJjZUlkIiwidGFyZ2V0SWQiLCJnZW5lcmF0ZUxpc3QiLCJnbyIsInNvdXJjZU5hbWUiLCJ0YXJnZXROYW1lIiwidmlld0VkZ2UiLCJkM29iaiIsIlFUaXBQb2xpY3kiLCJTcGxpdEpvaW5Ob2RlUG9saWN5IiwiU3BsaXRKb2luVmlld1BvbGljeSIsIlNhdmVTdGF0ZVBvbGljeSIsIm1vdXNlZG93biIsIm1vdXNldXAiLCJncmFwaFVwZGF0ZU5ld05vZGVzIiwiZ3JhcGhVcGRhdGVOZXdQYXRocyIsImludGVydmFsIiwic2V0VGltZW91dCIsInF0aXAiLCJ3aGVuUVRpcEF2YWlsYWJsZSIsImF0dGFjaFFUaXAiLCJzZWxlY3Rvck1hcCIsImhhc0tleXMiLCJsYWJlbHNNYXAiLCJzbGljZSIsImNvbnRlbnQiLCJldmVudHMiLCJzaG93IiwiYXBpIiwicG9zaXRpb24iLCJsZWZ0Iiwic2V0Iiwic29sbyIsImNsYXNzZXMiLCJoaWRlIiwicGF0aEVsIiwibWlkcG9pbnQiLCJnZXRQb2ludEF0TGVuZ3RoIiwiZ2V0VG90YWxMZW5ndGgiLCJ0YXJnZXRSZXQiLCJxdGlwSGVscGVyIiwic2F2ZWRTdGF0ZSIsImdyYXBoRGVzdHJveSIsImxvYWQiLCJncmFwaExvYWQiLCJzcGxpdE5vZGVzIiwic3VwZXJTdGF0ZSIsInNwbGl0TXVsdGlwbGVOb2RlcyIsInNwbGl0Tm9kZSIsInByZXZlbnREZWZhdWx0Iiwiam9pbk5vZGUiLCJncmFwaE5vZGVzIiwibmV3X25vZGVzIiwieExvYyIsInlMb2MiLCJuZXdfbm9kZV9vYmpzIiwibmV3X25vZGUiLCJyZXMiLCJfX3NwbGl0Tm9kZSIsInNwbGl0Tm9kZUV2ZW50IiwicmVzTm9kZXMiLCJzcGxpdE11bHRpcGxlTm9kZXNFdmVudCIsInRvX2JlX2RlbGV0ZWQiLCJuZXdfbm9kZV9pZCIsIm5vZGVfdG9fZGVsZXRlIiwiX19qb2luTm9kZSIsImpvaW5Ob2RlRXZlbnQiLCJqb2luTXVsdGlwbGVOb2Rlc0V2ZW50Iiwic2F2ZWRTdGF0ZXMiLCJldmVudEhpc3RvcnkiLCJmb2N1c0dyb3VwcyIsImZvY2kiLCJ6b29tcyIsImxheW91dERlZmF1bHQiLCJ6b29tRGVmYXVsdCIsIm5vZGVJZHNUb1Jlc2hvdyIsImJhY2tCdXR0b25FbGVtIiwidGl0bGVFbGVtIiwiYm91bmRhcnkiLCJlbGVtIiwiYmFja0J1dHRvbiIsInVuZG9MYXN0RXZlbnQiLCJzYXZlIiwiY3VyclRpdGxlIiwic3RhdGVzIiwibG9hZFN0YXRlIiwiZmFkZVRvIiwidHlwZSIsInBvcyIsImNvbnNvbGUiLCJsb2ciLCJ1cGRhdGVHcmFwaENhbGxiYWNrIiwibm9kZXNUb0tlZXAiLCJncm91cE9uZU5vZGVzIiwicGFyc2VGbG9hdCIsInNwbGl0Tm9kZUZ1bmMiLCJncmFwaENvbnN0cyIsImdldFJhbmRvbUludCIsImZsb29yIiwicmFuZG9tIiwic3RhdGVQb2xpY3kiLCJkZWZhdWx0TGF5b3V0IiwiY29uc3RzUG9saWN5IiwiY2FsY01heE5vZGVzIiwiYXJlYSIsImFtb3VudCIsImZvY3VzTm9kZXMiLCJib3QiLCJwb3AiLCJzZXRMYXlvdXQiLCJzdGF0ZVN1cGVyIiwibm9kZU5hbWVTZXQiLCJuYW1lVG9BZGQiLCJub2Rlc1RvUHJvY2VzcyIsInByb2Nlc3NOb2RlRGF0YSIsIm5vZGVUb1JlbW92ZSIsImxhc3QiLCJmaW5kRDNOb2RlIiwiZGJsY2xpY2siLCJub2RlSWQiXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7QUFJQUEsUUFBUUMsTUFBUixDQUFlLGNBQWYsRUFBK0IsRUFBL0I7QUNKQTtBQUNBOzs7Ozs7O0FDREE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFtQkFELFFBQVFDLE1BQVIsQ0FBZSxjQUFmLEVBQ0tDLE9BREwsQ0FDYSxZQURiLEVBQzJCLENBQUMsTUFBRCxFQUFTLE1BQVQsRUFDdEIsVUFBVUMsSUFBVixFQUFnQkMsSUFBaEIsRUFBc0I7QUFBQSxLQUVoQkMsVUFGZ0I7QUFHckI7Ozs7OztBQU1ILHNCQUFZQyxLQUFaLEVBQW1CQyxLQUFuQixFQUEwQjtBQUFBOztBQUN6QixRQUFLRCxLQUFMLEdBQWFBLEtBQWI7QUFDQSxRQUFLQyxLQUFMLEdBQWFBLEtBQWI7QUFDQTs7QUFFRDs7Ozs7OztBQWR3QjtBQUFBO0FBQUEsK0JBbUJaRCxLQW5CWSxFQW1CTDtBQUNsQixTQUFLQSxLQUFMLEdBQWFBLEtBQWI7QUFDQTs7QUFFRDs7Ozs7O0FBdkJ3QjtBQUFBO0FBQUEsK0JBNEJaQyxLQTVCWSxFQTRCTDtBQUNsQixTQUFLQSxLQUFMLEdBQWFBLEtBQWI7QUFDQTs7QUFFRDs7Ozs7Ozs7QUFoQ3dCO0FBQUE7QUFBQSxnQ0F1Q1hDLEVBdkNXLEVBdUNQO0FBQ1YsUUFBSUYsUUFBUSxLQUFLQSxLQUFqQjtBQUNBLFNBQUssSUFBSUcsSUFBSSxDQUFiLEVBQWdCQSxJQUFJSCxNQUFNSSxNQUExQixFQUFrQ0QsR0FBbEMsRUFBdUM7QUFDbkMsU0FBSUgsTUFBTUcsQ0FBTixFQUFTRCxFQUFULElBQWVBLEVBQW5CLEVBQXVCO0FBQ25CLGFBQU9GLE1BQU1HLENBQU4sRUFBU0UsSUFBaEI7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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzNCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3JCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNuQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDWEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMzQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDbkNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDaERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM1S0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3RCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2hEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDL0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3RDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzdDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDbENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNsRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2hIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMvQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMxRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM3SUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDeEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3pGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2xLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3JFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzdDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ1RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDVEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJhcHAvYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBEZWZpbmluZyB0aGUgR3JhcGggTW9kdWxlLlxuICogU2VlIERFU0lHTi5tZCBmb3IgaW5mbyBvbiBHcmFwaCBPYmplY3RzLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJywgW10pO1xuXG5cblxuXG4iLCJhbmd1bGFyLm1vZHVsZShcImNvbnRpdi5kaXJlY3RpdmVzXCIsIFtdKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIFRoZSBiYXNlIGNsYXNzIHRoZSBEYXRhU291cmNlIG9iamVjdC5cbiAqIFxuICogVGhlIERhdGFTb3VyY2Ugb2JqZWN0IHRha2VzIGluIG5vZGUgYW5kIGxpbmsgZGF0YSBmcm9tIHRoZSBzZXJ2ZXIsIFxuICogYW5kIHByb3ZpZGVzIG1ldGhvZHMgZm9yIGNvbnZlcnRpbmcgYW5kIG1hbmlwdWxhdGluZyB0aGUgZGF0YSBmb3JcbiAqIHRoZSBncmFwaCBvYmplY3QuXG4gKiBcbiAqIFRvIHdyaXRlIHlvdXIgb3duIERhdGFTb3VyY2Ugb2JqZWN0LCBjcmVhdGUgYSBuZXcgZmFjdG9yeSB0aGF0IHVzZXMgdGhlIFxuICogRGF0YVNvdXJjZSB5b3Ugd2FudCB0byBpbmhlcml0IGFzIGEgZGVwZW5kZW5jeSwgYW5kIGV4dGVuZCBcbiAqIGl0cyBEYXRhU291cmNlIGNsYXNzLiBcbiAqIFJldHVybiB0aGUgY2xhc3Mgb2JqZWN0IHdpdGggRGF0YVNvdXJjZSBhcyBrZXkuXG4gKiBcbiAqIE5vZGUgZGF0YSBpcyBleHBlY3RlZCB0byBiZSBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDpcbiAqIHtpZDpub2RlX2lkLCB0ZXh0Om5vZGVfdGV4dH1cbiAqIFxuICogTGluayBkYXRhIGlzIGV4cGVjdGVkIHRvIGJlIGluIHRoZSBmb2xsb3dpbmcgZm9ybWF0OlxuICoge3NvdXJjZTogc291cmNlTm9kZUlkLCB0YXJnZXQ6IHRhcmdldE5vZGVJZH1cbiAqIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnRGF0YVNvdXJjZScsIFsnTm9kZScsICdMaW5rJywgXG4gICAgXHRmdW5jdGlvbiAoTm9kZSwgTGluaykge1xuXG4gICAgXHRjbGFzcyBEYXRhU291cmNlIHtcbiAgICBcdFx0LyoqXG4gICAgXHRcdCAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICBcdFx0ICpcbiAgICBcdFx0ICogQHBhcmFtICAgICAge0FycmF5fSAgIG5vZGVzICAgICAgICAgICAgICBUaGUgbm9kZSBkYXRhIFxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgbGlua3MgICAgICAgICAgICAgIFRoZSBsaW5rIGRhdGFcbiAgICBcdFx0ICovXG5cdFx0XHRjb25zdHJ1Y3Rvcihub2RlcywgbGlua3MpIHtcblx0XHRcdFx0dGhpcy5ub2RlcyA9IG5vZGVzO1xuXHRcdFx0XHR0aGlzLmxpbmtzID0gbGlua3M7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogUmVwbGFjZXMgdGhlIG5vZGUgZGF0YVxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZXMgICBUaGUgbm9kZXNcblx0XHRcdCAqL1xuXHRcdFx0dXBkYXRlTm9kZXMobm9kZXMpIHtcblx0XHRcdFx0dGhpcy5ub2RlcyA9IG5vZGVzO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFJlcGxhY2VzIHRoZSBsaW5rIGRhdGFcblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7TGlua30gIGxpbmtzICAgVGhlIGxpbmtzXG5cdFx0XHQgKi9cblx0XHRcdHVwZGF0ZUxpbmtzKGxpbmtzKSB7XG5cdFx0XHRcdHRoaXMubGlua3MgPSBsaW5rcztcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBSZXR1cm5zIHRoZSBOYW1lIGF0dHJpYnV0ZSBvZiB0aGUgTm9kZSB3aXRoIHRoZSBcblx0XHRcdCAqIG1hdGNoaW5nIGlkXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge3N0cmluZ30gIGlkICAgICAgVGhlIGlkZW50aWZpZXJcblx0XHRcdCAqIEByZXR1cm4gICAgIHtzdHJpbmd9ICBuYW1lIG9mIHRoZSBtYXRjaGluZyBub2RlXG5cdFx0XHQgKi9cblx0XHRcdG5vZGVJZFRvTmFtZShpZCkge1xuXHRcdCAgICAgICAgdmFyIG5vZGVzID0gdGhpcy5ub2Rlcztcblx0XHQgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcblx0XHQgICAgICAgICAgICBpZiAobm9kZXNbaV0uaWQgPT0gaWQpIHtcblx0XHQgICAgICAgICAgICAgICAgcmV0dXJuIG5vZGVzW2ldLm5hbWU7XG5cdFx0ICAgICAgICAgICAgfVxuXHRcdCAgICAgICAgfVxuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIHByb2Nlc3MgdGhlIG5vZGVEYXRhIHRvIGNyZWF0ZSBOb2RlIG9iamVjdHNcblx0XHQgICAgICpcblx0XHQgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZURhdGEgIE5vZGVEYXRhIHRvIGNvbnZlcnQgXG5cdFx0ICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0byBub2RlIG9iamVjdHNcblx0XHQgICAgICogQHJldHVybiAgICAge0FycmF5fSAgTm9kZSBvYmplY3RzXG5cdFx0ICAgICAqL1xuXHRcdCAgICBwcm9jZXNzTm9kZURhdGEobm9kZURhdGEpIHtcblx0XHQgICAgICAgIHZhciBub2RlcyA9IFtdO1xuXHRcdCAgICAgICAgXy5mb3JFYWNoKG5vZGVEYXRhLCBmdW5jdGlvbihkYXRhKSB7XG5cdFx0ICAgICAgICAgICAgdmFyIG5ld05vZGUgPSBuZXcgTm9kZS5Ob2RlKG51bGwsIG51bGwsIGRhdGEuaWQsIGRhdGEudGV4dCwgbnVsbCk7XG5cdFx0ICAgICAgICAgICAgbm9kZXMucHVzaChuZXdOb2RlKTtcblx0XHQgICAgICAgIH0pO1xuXHRcdCAgICAgICAgcmV0dXJuIG5vZGVzO1xuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIHByb2Nlc3MgdGhlIGxpbmtEYXRhXG5cdFx0ICAgICAqXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIGxpbmtEYXRhICBUaGUgbGluayBkYXRhXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVzICAgICBUaGUgbm9kZXMgZnJvbSBwcm9jZXNzTm9kZURhdGFcblx0XHQgICAgICogQHJldHVybiAgICAge0FycmF5fSAgTGluayBvYmplY3RzXG5cdFx0ICAgICAqL1xuXHRcdCAgICBwcm9jZXNzTGlua0RhdGEobGlua0RhdGEsIG5vZGVzKSB7XG5cdFx0ICAgIFx0LyoqXG5cdFx0XHQgICAgICogUmV0dXJucyB0aGUgbm9kZSB0aGF0IG1hdGNoZXMgdGhlIGlkXG5cdFx0XHQgICAgICpcblx0XHRcdCAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG5cdFx0XHQgICAgICogQHJldHVybiAgICAge05vZGV9ICAgVGhlIG5vZGUgd2l0aCB0aGUgbWF0Y2hpbmcgaWRcblx0XHRcdCAgICAgKi9cblx0XHRcdCAgICBmdW5jdGlvbiBmaW5kTm9kZUJ5SWQoaWQsIG5vZGVzKSB7XG5cdFx0XHQgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdCAgICAgICAgICAgIGlmIChpZCA9PSBub2Rlc1tpXS5pZCkge1xuXHRcdFx0ICAgICAgICAgICAgICAgIHJldHVybiBub2Rlc1tpXTtcblx0XHRcdCAgICAgICAgICAgIH1cblx0XHRcdCAgICAgICAgfVxuXHRcdFx0ICAgIH1cblxuXHRcdCAgICAgICAgdmFyIGxpbmtzID0gW107XG5cdFx0ICAgICAgICAvL3RyYW5zZm9ybWluZyBsaW5rIGRhdGFcblx0XHQgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGlua0RhdGEubGVuZ3RoOyBpKyspIHtcblx0XHQgICAgICAgICAgICBpZiAobGlua0RhdGFbaV0uc291cmNlICE9IGxpbmtEYXRhW2ldLnRhcmdldCkge1xuXHRcdCAgICAgICAgICAgICAgICB2YXIgc291cmNlID0gZmluZE5vZGVCeUlkKGxpbmtEYXRhW2ldLnNvdXJjZSwgbm9kZXMpO1xuXHRcdCAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0ID0gZmluZE5vZGVCeUlkKGxpbmtEYXRhW2ldLnRhcmdldCwgbm9kZXMpO1xuXHRcdCAgICAgICAgICAgICAgICBpZiAoc291cmNlID09IG51bGwgfHwgdGFyZ2V0ID09IG51bGwpIHtcblx0XHQgICAgICAgICAgICAgICAgXHRjb250aW51ZTtcblx0XHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgICAgIHZhciBsaW5rID0gbmV3IExpbmsuTGluayhzb3VyY2UsIHRhcmdldCk7XG5cdCAgICAgICAgICAgICAgICAgICAgbGlua3MucHVzaChsaW5rKTtcblx0XHQgICAgICAgICAgICB9ICBcblx0XHQgICAgICAgIH1cblx0XHQgICAgICAgIHJldHVybiBsaW5rcztcblx0XHQgICAgfVxuXHRcdH1cblx0XHRyZXR1cm4ge1xuXHRcdFx0RGF0YVNvdXJjZTpEYXRhU291cmNlXG5cdFx0fVxufV0pO1xuXG5cblxuXG5cblxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzE0LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm1vZGVscycsIFtdKTtcbnZhciBDb250aXZHbG9iYWxzID0gKGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICAvL1JFU1QgZW5kcG9pbnRzIGZvciBORVRNQVNURVJcbiAgICAgICAgJ05FVFdPUktTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL25ldHdvcmtzLycsXG4gICAgICAgICdORVRXT1JLU19JTlNQRUNUX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL2luc3BlY3QvbmV0d29ya3MvJyxcbiAgICAgICAgJ1NFUlZJQ0VMQlNfSU5TUEVDVF9FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9pbnNwZWN0L3NlcnZpY2VMQnMvJyxcbiAgICAgICAgJ1BPTElDSUVTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL3BvbGljeXMvJyxcbiAgICAgICAgJ1JVTEVTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL3J1bGVzLycsXG4gICAgICAgICdBUFBMSUNBVElPTkdST1VQU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9lbmRwb2ludEdyb3Vwcy8nLFxuICAgICAgICAnU0VSVklDRUxCU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9zZXJ2aWNlTEJzLycsXG4gICAgICAgICdPUkdBTklaQVRJT05TX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL3RlbmFudHMvJyxcbiAgICAgICAgJ05FVFdPUktfU0VUVElOR1NfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvZ2xvYmFscy8nLFxuICAgICAgICAnTkVUUFJPRklMRVNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvbmV0cHJvZmlsZXMvJyxcbiAgICAgICAgJ0JHUFNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvQmdwcy8nLFxuICAgICAgICAnQkdQU19JTlNQRUNUX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL2luc3BlY3QvQmdwcy8nLFxuICAgICAgICAnVklTVUFMSVpBVElPTl9FTkRQT0lOVCc6ICcvdmlzdWFsaXphdGlvbi8nLFxuICAgICAgICAvL1JFU1QgZW5kcG9pbnRzIGZvciBWT0xNQVNURVJcbiAgICAgICAgJ1ZPTFVNRVNfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci92b2x1bWVzLycsXG4gICAgICAgICdWT0xVTUVTX0NSRUFURV9FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3ZvbHVtZXMvY3JlYXRlLycsXG4gICAgICAgICdWT0xVTUVTX0RFTEVURV9FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3ZvbHVtZXMvcmVtb3ZlLycsXG4gICAgICAgICdWT0xVTUVTX0NPUFlTTkFQU0hPVFNfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci92b2x1bWVzL2NvcHknLFxuICAgICAgICAnVk9MVU1FU19VU0VTX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvdXNlcy9tb3VudHMvJyxcbiAgICAgICAgJ1ZPTFVNRVNfU05BUFNIT1RTX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvc25hcHNob3RzLycsXG4gICAgICAgICdTVE9SQUdFUE9MSUNJRVNfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci9wb2xpY2llcy8nLFxuICAgICAgICAnVk9MVU1FU19HTE9CQUxfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci9nbG9iYWwvJyxcbiAgICAgICAgLy9SRVNUIGVuZHBvaW50cyBmb3IgQ0xVU1RFUlxuICAgICAgICAnTk9ERVNfTElTVF9FTkRQT0lOVCc6ICcvaW5mby9ub2RlcycsXG4gICAgICAgICdOT0RFU19ESVNDT1ZFUl9FTkRQT0lOVCc6ICcvZGlzY292ZXIvbm9kZXMnLFxuICAgICAgICAnTk9ERVNfQ09NTUlTU0lPTl9FTkRQT0lOVCc6ICcvY29tbWlzc2lvbi9ub2RlcycsXG4gICAgICAgICdOT0RFU19ERUNPTU1JU1NJT05fRU5EUE9JTlQnOiAnL2RlY29tbWlzc2lvbi9ub2RlcycsXG4gICAgICAgICdOT0RFU19NQUlOVEVOQU5DRV9FTkRQT0lOVCc6ICcvbWFpbnRlbmFuY2Uvbm9kZXMnLFxuICAgICAgICAnTk9ERVNfTEFTVF9KT0JfRU5EUE9JTlQnOiAnL2luZm8vam9iL2xhc3QnLFxuICAgICAgICAnTk9ERVNfQUNUSVZFX0pPQl9FTkRQT0lOVCc6ICcvaW5mby9qb2IvYWN0aXZlJyxcbiAgICAgICAgJ05PREVTX1NFVFRJTkdTX1NFVF9FTkRQT0lOVCc6ICcvZ2xvYmFscycsXG4gICAgICAgICdOT0RFU19TRVRUSU5HU19HRVRfRU5EUE9JTlQnOiAnL2luZm8vZ2xvYmFscycsXG4gICAgICAgIC8vUmVmcmVzaCBpbnRlcnZhbCBpbiBtaWxsaXNlY29uZHNcbiAgICAgICAgJ1JFRlJFU0hfSU5URVJWQUwnOiA1MDAwLFxuICAgICAgICAvL1JlZ0V4IGZvciB2YWxpZGF0aW9uXG4gICAgICAgICdDSURSX1JFR0VYJzogJ14oKFswLTldfFsxLTldWzAtOV18MVswLTldezJ9fDJbMC00XVswLTldfDI1WzAtNV0pXFwuKXszfShbMC05XXxbMS05XVswLTldfDFbMC05XXsyfXwyWzAtNF1bMC05XXwyNVswLTVdKShcXC8oWzAtOV18WzEtMl1bMC05XXwzWzAtMl0pKSQnLFxuICAgICAgICAnVkxBTl9SRUdFWCc6ICdeKFswLTldezEsNH0/LVswLTldezEsNH0/KSQnLFxuICAgICAgICAnVlhMQU5fUkVHRVgnOiAnXihbMC05XXsxLDh9Py1bMC05XXsxLDh9PykkJyxcbiAgICAgICAgJ05VTUJFUl9SRUdFWCc6ICdeWzAtOV0qJCdcbiAgICB9O1xufSkoKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIFRoZSBEYXRhU291cmNlIHVzZWQgZm9yIHRoZSB2aXN1YWxpemF0aW9uIHRhYi5cbiAqIFxuICogTm9kZSBEYXRhIGZyb20gdGhlIHNlcnZlciBpcyBleHBlY3RlZCB0byBiZSBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDpcbiAqIHtpZDogbm9kZV9pZCwgdGV4dDogbm9kZV90ZXh0fVxuICogUGFyZW50IGFuZCBBbmNlc3RvciBhdHRyaWJ1dGVzIGNhbiBiZSBzZXQgYnkgY2FsbGluZyBzZXRBbmNlc3RvcnNcbiAqIFxuICogTGluayBEYXRhIGZyb20gdGhlIHNlcnZlciBpcyBleHBlY3RlZCB0byBiZSBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDpcbiAqIHtzb3VyY2U6IHNvdXJjZU5vZGVJZCwgdGFyZ2V0OiB0YXJnZXROb2RlSWQsIHdlaWdodDogbGlua1dlaWdodH1cbiAqIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnVmlzdWFsaXplckRhdGFTb3VyY2UnLCBbJ0RhdGFTb3VyY2UnLCAnVmlzdWFsaXplck5vZGUnLCAnVmlzdWFsaXplckxpbmsnLCBcbiAgICBcdGZ1bmN0aW9uIChEYXRhU291cmNlLCBWaXN1YWxpemVyTm9kZSwgVmlzdWFsaXplckxpbmspIHtcblxuICAgIFx0Y2xhc3MgVmlzdWFsaXplckRhdGFTb3VyY2UgZXh0ZW5kcyBEYXRhU291cmNlLkRhdGFTb3VyY2Uge1xuICAgIFx0XHQvKipcbiAgICBcdFx0ICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgIFx0XHQgKiBcbiAgICBcdFx0ICogQ2hpbGRyZW4gU3RydWN0IGFuZCBhbmNlc3RvcnNfc3RydWN0IGFyZSBKU09OIG9iamVjdHMsXG4gICAgXHRcdCAqIG1hcHBpbmcgYSBub2RlIElkIHRvIGEgbGlzdCBvZiBpdCdzIGNoaWxkcmVuIG9yIGFuY2VzdG9ycy5cbiAgICBcdFx0ICogQ2hpbGRyZW4gU3RydWN0IGlzIGFsc28gZXhwZWN0ZWQgdG8gaGF2ZSBhIGZpZWxkIGNhbGxlZFxuICAgIFx0XHQgKiB0b3BMZXZlbCwgdGhhdCBtYXBzIHRvIGEgbGlzdCBvZiBhbGwgdGhlIG5vZGVzIHRoYXQgZG9uJ3RcbiAgICBcdFx0ICogaGF2ZSBhbnkgcGFyZW50cy5cbiAgICBcdFx0ICpcbiAgICBcdFx0ICogQHBhcmFtICAgICAge0FycmF5fSAgIG5vZGVzICAgICAgICAgICAgICBUaGUgbm9kZSBkYXRhIFxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgbGlua3MgICAgICAgICAgICAgIFRoZSBsaW5rIGRhdGFcbiAgICBcdFx0ICogQHBhcmFtICAgICAge09iamVjdH0gIGNoaWxkcmVuX3N0cnVjdCAgICBUaGUgY2hpbGRyZW4gc3RydWN0dXJlXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBhbmNlc3RvcnNfc3RydWN0ICAgVGhlIGFuY2VzdG9ycyBzdHJ1Y3R1cmVcbiAgICBcdFx0ICogQHBhcmFtICAgICAge0FycmF5fSAgIGxhYmVscyAgICAgICAgICAgICBUaGUgbGFiZWxzXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBzZWxlY3RvcnMgICAgICAgICAgVGhlIHNlbGVjdG9yc1xuICAgIFx0XHQgKi9cblx0XHRcdGNvbnN0cnVjdG9yKG5vZGVzLCBsaW5rcywgY2hpbGRyZW5fc3RydWN0LCBhbmNlc3RvcnNfc3RydWN0LCBcblx0XHRcdFx0XHRsYWJlbHMsIHNlbGVjdG9ycykge1xuXHRcdFx0XHRzdXBlcihub2RlcyxsaW5rcyk7XG5cdFx0XHRcdHRoaXMuY2hpbGRyZW5fc3RydWN0ID0gY2hpbGRyZW5fc3RydWN0O1xuXHRcdFx0XHR0aGlzLmFuY2VzdG9yc19zdHJ1Y3QgPSBhbmNlc3RvcnNfc3RydWN0O1xuXHRcdFx0XHR0aGlzLmxhYmVscyA9IGxhYmVscztcblx0XHRcdFx0dGhpcy5zZWxlY3RvcnMgPSBzZWxlY3RvcnM7XG5cdFx0XHR9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIERldGVybWluZXMgaWYgaXQgaGFzIGNoaWxkLlxuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgIGlkICAgICAgVGhlIGlkZW50aWZpZXJcblx0XHQgICAgICogQHJldHVybiAgICAge2Jvb2xlYW59ICBUcnVlIGlmIGhhcyBjaGlsZCwgRmFsc2Ugb3RoZXJ3aXNlLlxuXHRcdCAgICAgKi9cblx0XHQgICAgaGFzQ2hpbGQoaWQpIHtcblx0XHQgICAgXHRpZiAodGhpcy5jaGlsZHJlbl9zdHJ1Y3RbaWRdID09IG51bGwpIHtcbiAgICAgICAgICAgIFx0XHRyZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBcdH1cbiAgICAgICAgICAgIFx0cmV0dXJuIHRydWU7XHRcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBTZXRzIHRoZSBwYXJlbnQgYW5kIGFuY2VzdG9ycyBhdHRyaWJ1dGUgdXNpbmcgXG5cdFx0ICAgICAqIGFuY2VzdG9yc19zdHJ1Y3QgZm9yIGFsbCB0aGUgbm9kZXNcblx0XHQgICAgICogQWxzbyBhZGRzIGFueSBub2RlcyB3aXRob3V0IGFuY2VzdG9ycywgdGhhdCBhcmVuJ3QgXG5cdFx0ICAgICAqIHRvcGxldmVsIHRvIHRoZSBjbGllbnQgc2VydmljZS5cblx0XHQgICAgICovXG5cdFx0ICAgIHNldEFuY2VzdG9ycygpIHtcblx0XHQgICAgXHR2YXIgdGhpc0RhdGFTb3VyY2UgPSB0aGlzO1xuXHRcdCAgICBcdHZhciBhZGRlZENsaWVudCA9IGZhbHNlO1xuXHRcdCAgICBcdF8uZm9yRWFjaCh0aGlzRGF0YVNvdXJjZS5ub2RlcywgZnVuY3Rpb24obm9kZSkge1xuXHRcdCAgICBcdFx0bm9kZS5hbmNlc3RvcnMgPSB0aGlzRGF0YVNvdXJjZS5hbmNlc3RvcnNfc3RydWN0W25vZGUuaWRdIHx8IFtdO1xuXHRcdCAgICBcdFx0aWYgKF8uaXNFbXB0eShub2RlLmFuY2VzdG9ycykgPT09IGZhbHNlKSB7XG5cdFx0ICAgIFx0XHRcdG5vZGUucGFyZW50ID0gbm9kZS5hbmNlc3RvcnNbMF07XG5cdFx0ICAgIFx0XHR9IGVsc2Uge1xuXHRcdCAgICBcdFx0XHRpZiAoXy5pbmNsdWRlcyh0aGlzRGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwsIG5vZGUuaWQpID09IGZhbHNlKSB7XG5cdFx0ICAgIFx0XHRcdFx0Ly9jb250YWluZXIgaGFzIG5vIHBhcmVudFxuXHRcdCAgICBcdFx0XHRcdC8vYWRkaW5nIHRvIGNsaWVudFxuXHRcdCAgICBcdFx0XHRcdG5vZGUuYW5jZXN0b3JzLnB1c2goXCJjbGllbnRcIik7XG5cdFx0ICAgIFx0XHRcdFx0dGhpc0RhdGFTb3VyY2UuYW5jZXN0b3JzX3N0cnVjdFtub2RlLmlkXSA9IFtcImNsaWVudFwiXTtcblx0XHQgICAgXHRcdFx0XHRpZiAoYWRkZWRDbGllbnQgPT09IGZhbHNlKSB7XG5cdFx0ICAgIFx0XHRcdFx0XHRhZGRlZENsaWVudCA9IHRydWU7XG5cdFx0XHQgICAgXHRcdFx0XHR0aGlzRGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwucHVzaChcImNsaWVudFwiKTtcblx0XHQgICAgXHRcdFx0XHRcdHRoaXNEYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFsnY2xpZW50J10gPSBbXTtcblx0XHQgICAgXHRcdFx0XHR9XG5cdFx0ICAgIFx0XHRcdFx0dGhpc0RhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0WydjbGllbnQnXS5wdXNoKG5vZGUuaWQpO1xuXHRcdFx0ICAgIFx0XHR9XG5cdFx0ICAgIFx0XHR9XG5cdFx0ICAgIFx0fSlcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBSZXR1cm5zIHRoZSBmbG93IGJldHdlZW4gdGhlIGhpZ2hlc3QgbGV2ZWwgZ3JvdXBpbmdcblx0XHQgICAgICpcblx0XHQgICAgICogQHJldHVybiAgICAge09iamVjdH0gIFRoZSB0b3AgbGV2ZWwgZmxvdy5cblx0XHQgICAgICovXG5cdFx0ICAgIGdldFRvcExldmVsRmxvdygpIHtcblx0XHQgICAgICAgIHJldHVybiB0aGlzLmdldEZsb3dCZXR3ZWVuU2V0KHRoaXMuY2hpbGRyZW5fc3RydWN0LnRvcExldmVsKTtcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBHZXRzIHRoZSBmbG93IGJldHdlZW4gYW55IHNldCBvZiBub2RlIGxldmVsc1xuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlX25hbWVzICBUaGUgbm9kZSBuYW1lcyBpbiB0aGUgc2V0XG5cdFx0ICAgICAqIEByZXR1cm4gICAgIHtPYmplY3R9ICBUaGUgZmxvdyBiZXR3ZWVuIHNldC5cblx0XHQgICAgICovXG5cdFx0ICAgIGdldEZsb3dCZXR3ZWVuU2V0KG5vZGVfbmFtZXMpIHtcblx0XHQgICAgICAgIHZhciBsb2NhbF9ub2RlcyA9IHRoaXMubm9kZXM7XG5cdFx0ICAgICAgICB2YXIgaWRNYXBwaW5nID0ge307XG5cdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxvY2FsX25vZGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0ICAgICAgICAgICAgdmFyIG5vZGUgPSBsb2NhbF9ub2Rlc1tpXTtcblxuXHRcdCAgICAgICAgICAgIC8vaWYgbm9kZSBpcyBhbHJlYWR5IGF0IGl0cyBoaWdoZXN0IGxldmVsXG5cdFx0ICAgICAgICAgICAgaWYgKG5vZGUuYW5jZXN0b3JzID09PSBudWxsKSB7XG5cdFx0ICAgICAgICAgICAgICAgIGlkTWFwcGluZ1tub2RlLmlkXSA9IG5vZGUubmFtZTtcblx0XHQgICAgICAgICAgICB9IGVsc2Uge1xuXHRcdCAgICAgICAgICAgICAgICAvL2NoZWNrIHRvIHNlZSB3aGljaCB0YWdzIGFyZSBwcmVzZW50IGluIHRoZSBhbmNlc3RvciBsaXN0XG5cdFx0ICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbm9kZV9uYW1lcy5sZW5ndGg7IGorKykge1xuXHRcdCAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuYW5jZXN0b3JzLmluZGV4T2Yobm9kZV9uYW1lc1tqXSkgPiAtMSkge1xuXHRcdCAgICAgICAgICAgICAgICAgICAgICAgIGlkTWFwcGluZ1tub2RlLmlkXSA9IG5vZGVfbmFtZXNbal07XG5cdFx0ICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cdFx0ICAgICAgICAgICAgICAgICAgICB9XG5cdFx0ICAgICAgICAgICAgICAgIH1cblx0XHQgICAgICAgICAgICB9XG5cdFx0ICAgICAgICB9ICAgXG5cdFx0ICAgICAgICAvL21vZGlmeSBsaW5rc1xuXHRcdCAgICAgICAgdmFyIGxpbmtzID0gdGhpcy5saW5rcztcblx0XHQgICAgICAgIHZhciBsaW5rRGF0YSA9IFtdO1xuXHRcdCAgICAgICAgXG5cdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpbmtzLmxlbmd0aDsgaSsrKSB7XG5cdFx0ICAgICAgICAgICAgdmFyIGxpbmsgPSBbXTtcblx0XHQgICAgICAgICAgICBsaW5rLnNvdXJjZSA9IGlkTWFwcGluZ1tsaW5rc1tpXS5zb3VyY2VdIHx8IGxpbmtzW2ldLnNvdXJjZTtcblx0XHQgICAgICAgICAgICBsaW5rLnRhcmdldCA9IGlkTWFwcGluZ1tsaW5rc1tpXS50YXJnZXRdIHx8IGxpbmtzW2ldLnRhcmdldDtcblx0XHQgICAgICAgICAgICBsaW5rLndlaWdodCA9IGxpbmtzW2ldLndlaWdodDtcblx0XHQgICAgICAgICAgICBsaW5rRGF0YS5wdXNoKGxpbmspO1xuXHRcdCAgICAgICAgfVxuXG5cdFx0ICAgICAgICAvL2NyZWF0aW5nIHRoZSBub2RlRGF0YVxuXHRcdCAgICAgICAgdmFyIG5vZGVEYXRhID0gW107XG5cdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVfbmFtZXMubGVuZ3RoOyBpKyspIHtcblx0XHQgICAgICAgICAgICB2YXIgbm9kZV90b19hZGQgPSBbXTtcblx0XHQgICAgICAgICAgICBub2RlX3RvX2FkZC5pZCA9IG5vZGVfbmFtZXNbaV07XG5cdFx0ICAgICAgICAgICAgbm9kZV90b19hZGQudGV4dCA9IHRoaXMubm9kZUlkVG9OYW1lKG5vZGVfbmFtZXNbaV0pIHx8IG5vZGVfbmFtZXNbaV07XG5cblxuXHRcdCAgICAgICAgICAgIG5vZGVfdG9fYWRkLmFuY2VzdG9ycyA9IHRoaXMuYW5jZXN0b3JzX3N0cnVjdFtub2RlX25hbWVzW2ldXSB8fCB0aGlzLmFuY2VzdG9yc19zdHJ1Y3Rbbm9kZV90b19hZGQudGV4dF0gfHwgW107XG5cdFx0ICAgICAgICAgICAgaWYgKF8uaXNFbXB0eShub2RlX3RvX2FkZC5hbmNlc3RvcnMpID09PSBmYWxzZSkge1xuXHRcdCAgICAgICAgICAgICAgICBub2RlX3RvX2FkZC5wYXJlbnQgPSBub2RlX3RvX2FkZC5hbmNlc3RvcnNbMF07XG5cdFx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0XHQgICAgICAgICAgICAgICAgbm9kZV90b19hZGQucGFyZW50ID0gbnVsbDtcblx0XHQgICAgICAgICAgICB9XG5cdFx0ICAgICAgICAgICAgbm9kZURhdGEucHVzaChub2RlX3RvX2FkZCk7XG5cdFx0ICAgICAgICB9XG5cblx0XHQgICAgICAgIHJldHVybiB7bm9kZURhdGE6bm9kZURhdGEsIGxpbmtEYXRhOmxpbmtEYXRhfTtcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBwcm9jZXNzIHRoZSBub2RlRGF0YSBvdXRwdXQgb2YgZ2V0Rmxvd0JldHdlZW5TZXRcblx0XHQgICAgICpcblx0XHQgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZURhdGEgIE5vZGVEYXRhIHRvIGNvbnZlcnQgXG5cdFx0ICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0byBub2RlIG9iamVjdHNcblx0XHQgICAgICogQHJldHVybiAgICAge0FycmF5fSAgTm9kZSBvYmplY3RzXG5cdFx0ICAgICAqL1xuXHRcdCAgICBwcm9jZXNzTm9kZURhdGEobm9kZURhdGEpIHtcblx0XHQgICAgICAgIHZhciBub2RlcyA9IFtdO1xuXHRcdCAgICAgICAgXy5mb3JFYWNoKG5vZGVEYXRhLCBmdW5jdGlvbihkYXRhKSB7XG5cdFx0ICAgICAgICAgICAgdmFyIG5ld05vZGUgPSBuZXcgVmlzdWFsaXplck5vZGUuTm9kZShudWxsLCBudWxsLCBkYXRhLmlkLCBkYXRhLnRleHQsXG5cdFx0ICAgICAgICAgICAgICAgIG51bGwsIGRhdGEucGFyZW50LCBkYXRhLmFuY2VzdG9ycywgbnVsbCwgbnVsbCk7XG5cdFx0ICAgICAgICAgICAgbm9kZXMucHVzaChuZXdOb2RlKTtcblx0XHQgICAgICAgIH0pO1xuXHRcdCAgICAgICAgcmV0dXJuIG5vZGVzO1xuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIHByb2Nlc3MgdGhlIGxpbmtEYXRhIG91dHB1dCBvZiBnZXRGbG93QmV0d2VlblNldFxuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBsaW5rRGF0YSAgVGhlIGxpbmsgZGF0YVxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlcyAgICAgVGhlIG5vZGVzXG5cdFx0ICAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIExpbmsgb2JqZWN0c1xuXHRcdCAgICAgKi9cblx0XHQgICAgcHJvY2Vzc0xpbmtEYXRhKGxpbmtEYXRhLCBub2Rlcykge1xuXHRcdCAgICBcdC8qKlxuXHRcdFx0ICAgICAqIFJldHVybnMgdGhlIG5vZGUgdGhhdCBtYXRjaGVzIHRoZSBpZFxuXHRcdFx0ICAgICAqXG5cdFx0XHQgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gaWQgICAgICBUaGUgaWRlbnRpZmllclxuXHRcdFx0ICAgICAqIEByZXR1cm4gICAgIHtOb2RlfSAgIFRoZSBub2RlIHdpdGggdGhlIG1hdGNoaW5nIGlkXG5cdFx0XHQgICAgICovXG5cdFx0XHQgICAgZnVuY3Rpb24gZmluZE5vZGVCeUlkKGlkLCBub2Rlcykge1xuXHRcdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHQgICAgICAgICAgICBpZiAoaWQgPT0gbm9kZXNbaV0uaWQpIHtcblx0XHRcdCAgICAgICAgICAgICAgICByZXR1cm4gbm9kZXNbaV07XG5cdFx0XHQgICAgICAgICAgICB9XG5cdFx0XHQgICAgICAgIH1cblx0XHRcdCAgICB9XG5cblx0XHQgICAgICAgIHZhciBsaW5rcyA9IFtdO1xuXHRcdCAgICAgICAgLy9hIG1hcHBpbmcgZnJvbSBzb3VyY2UuaWQtdGFyZ2V0LmlkIHRvIHRoZSBsaW5rIGFkZGVkXG5cdFx0ICAgICAgICB2YXIgYWRkZWRfbGlua3MgPSB7fTtcblx0XHQgICAgICAgIC8vdHJhbnNmb3JtaW5nIGxpbmsgZGF0YVxuXHRcdCAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5rRGF0YS5sZW5ndGg7IGkrKykge1xuXHRcdCAgICAgICAgICAgIGlmIChsaW5rRGF0YVtpXS5zb3VyY2UgIT0gbGlua0RhdGFbaV0udGFyZ2V0KSB7XG5cdFx0ICAgICAgICAgICAgICAgIHZhciBzb3VyY2UgPSBmaW5kTm9kZUJ5SWQobGlua0RhdGFbaV0uc291cmNlLCBub2Rlcyk7XG5cdFx0ICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSBmaW5kTm9kZUJ5SWQobGlua0RhdGFbaV0udGFyZ2V0LCBub2Rlcyk7XG5cdFx0ICAgICAgICAgICAgICAgIHZhciB3ZWlnaHQgPSBsaW5rRGF0YVtpXS53ZWlnaHQ7XG5cdFx0ICAgICAgICAgICAgICAgIC8vaW4gb3JkZXIgdG8gc3VtIGFsbCB0aGUgd2VpZ2h0cyBvZiB0aGUgbGlua3Mgb2YgdGhlIHN1Yi1ub2Rlcyxcblx0XHQgICAgICAgICAgICAgICAgLy93ZSB1c2UgYWRkZWRfbGlua3MgdG8ga2VlcCB0cmFjayBpZiBhbiBsaW5rIHdhcyBhZGRlZFxuXHRcdCAgICAgICAgICAgICAgICAvL2lmIGl0IGlzLCB3ZSBtb2RpZnkgaXRzIHdlaWdodFxuXHRcdCAgICAgICAgICAgICAgICBpZiAoc291cmNlID09IG51bGwgfHwgdGFyZ2V0ID09IG51bGwpIHtcblx0XHQgICAgICAgICAgICAgICAgXHRjb250aW51ZTtcblx0XHQgICAgICAgICAgICAgICAgfVxuXHRcdCAgICAgICAgICAgICAgICBpZiAoYWRkZWRfbGlua3Nbc291cmNlLmlkICsgJy0nICsgdGFyZ2V0LmlkXSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0ICAgICAgICAgICAgICAgICAgICB2YXIgbGluayA9IG5ldyBWaXN1YWxpemVyTGluay5MaW5rKHNvdXJjZSwgdGFyZ2V0LCB3ZWlnaHQpO1xuXHRcdCAgICAgICAgICAgICAgICAgICAgYWRkZWRfbGlua3Nbc291cmNlLmlkICsgJy0nICsgdGFyZ2V0LmlkXSA9IGxpbms7XG5cdFx0ICAgICAgICAgICAgICAgICAgICBsaW5rcy5wdXNoKGxpbmspO1xuXHRcdCAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHRcdCAgICAgICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nX2xpbmsgPSBhZGRlZF9saW5rc1tzb3VyY2UuaWQgKyAnLScgKyB0YXJnZXQuaWRdO1xuXHRcdCAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdfbGluay5zZXRXZWlnaHQoZXhpc3RpbmdfbGluay5nZXRSYXdXZWlnaHQoKSArIHdlaWdodCk7XG5cdFx0ICAgICAgICAgICAgICAgICAgICBleGlzdGluZ19saW5rLmluY3JlYXNlQ291bnQoKTtcblx0XHQgICAgICAgICAgICAgICAgfVxuXHRcdCAgICAgICAgICAgIH0gIFxuXHRcdCAgICAgICAgfVxuXHRcdCAgICAgICAgcmV0dXJuIGxpbmtzO1xuXHRcdCAgICB9XG5cdFx0fVxuXHRcdHJldHVybiB7XG5cdFx0XHREYXRhU291cmNlOiBWaXN1YWxpemVyRGF0YVNvdXJjZVxuXHRcdH1cbn1dKTtcblxuXG5cblxuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi51dGlscycsIFtdKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIFRoZSBiYXNlIGNsYXNzIHRoZSBncmFwaCBvYmplY3QuIEFueSBub2RlcyBvciBsaW5rcyB0aGF0IGFyZSBjb250YWluZWQgaW5cbiAqIGl0cyBub2RlcyBvciBsaW5rcyBwcm9wZXJ0eSB3aWxsIGJlIGRyYXduIG9uIHVwZGF0ZUdyYXBoLlxuICogU3VwcG9ydHMgcG9saWNpZXMuXG4gKiBcbiAqIFRvIHdyaXRlIHlvdXIgb3duIGdyYXBoIG9iamVjdCwgY3JlYXRlIGEgbmV3IGZhY3RvcnkgdGhhdCB1c2VzIHRoZSBncmFwaFxuICogeW91IHdhbnQgdG8gaW5oZXJpdCBhcyBhIGRlcGVuZGVuY3ksIGFuZCBleHRlbmQgaXRzIGdyYXBoIGNsYXNzLiBcbiAqIFJldHVybiB0aGUgY2xhc3Mgb2JqZWN0IHdpdGggR3JhcGggYXMga2V5LlxuICogXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdHcmFwaCcsIFsnUG9saWN5U2VydmljZScsIGZ1bmN0aW9uIChQb2xpY3lTZXJ2aWNlKSB7XG4gICAgICAgIGNsYXNzIEdyYXBoIHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogY29uc3RydWN0b3IgZm9yIHRoZSBncmFwaFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtIVE1MIFNWR30gIHN2ZyAgICAgVGhlIHN2ZyB0aGF0IHdpbGwgXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvbGQgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlcyAgICAgIExpc3Qgb2Ygbm9kZXMgZm9yIHRoZSBncmFwaFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbGlua3MgICAgICBMaXN0IG9mIGxpbmtzIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgY29uc3RydWN0b3Ioc3ZnLCBub2RlcywgbGlua3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlcyA9IG5vZGVzIHx8IFtdO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IGxpbmtzIHx8IFtdO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMgPSBbXTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcyA9IFtdO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeSA9IG5ldyBQb2xpY3lTZXJ2aWNlLlBvbGljeSgpO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN0YXRlID0ge1xuICAgICAgICAgICAgICAgICAgICBjYW5ab29tOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBjYW5QYW46IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGluaXRGb3JjZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVVcGRhdGU6IGZhbHNlXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jb25zdHMgPSB7XG4gICAgICAgICAgICAgICAgICAgIGNpcmNsZUdDbGFzczogXCJjb25jZXB0R1wiLFxuICAgICAgICAgICAgICAgICAgICBncmFwaENsYXNzOiBcImdyYXBoXCIsXG4gICAgICAgICAgICAgICAgICAgIHBhdGhDbGFzczogXCJwYXRoXCIsXG4gICAgICAgICAgICAgICAgICAgIG5vZGVDbGFzczogXCJjaXJjbGVcIixcbiAgICAgICAgICAgICAgICAgICAgbm9kZVRleHQ6IFwibm9kZVRleHRcIixcbiAgICAgICAgICAgICAgICAgICAgc3RhcnRSYWRpdXM6IDUwLFxuICAgICAgICAgICAgICAgICAgICBtYXhSYWRpdXM6IDYwLFxuICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiA1LFxuICAgICAgICAgICAgICAgICAgICBkaXNwbGF5T2Zmc2V0OiA2MFxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBzdmcub24oXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wibW91c2VvdmVyXCJdLmNhbGwodGhpcywgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJkYmxjbGlja1wiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wiZGJsY2xpY2tcIl0uY2FsbCh0aGlzLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcImNvbnRleHRtZW51XCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3lbXCJjb250ZXh0bWVudVwiXS5jYWxsKHRoaXMsIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwibW91c2VvdXRcIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wibW91c2VvdXRcIl0uY2FsbCh0aGlzLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcIm1vdXNlZG93blwiLCBmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3lbXCJtb3VzZWRvd25cIl0uY2FsbCh0aGlzLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcIm1vdXNldXBcIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wibW91c2V1cFwiXS5jYWxsKHRoaXMsIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvLyBkZWZpbmUgYXJyb3cgbWFya2VycyBmb3IgZ3JhcGggbGlua3NcbiAgICAgICAgICAgICAgICB2YXIgZGVmcyA9IHN2Zy5hcHBlbmQoJ3N2ZzpkZWZzJyk7XG4gICAgICAgICAgICAgICAgZGVmcy5hcHBlbmQoJ3N2ZzptYXJrZXInKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignaWQnLCAnZW5kLWFycm93JylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ2aWV3Qm94XCIsIFwiMCAtNSAxMCAxMFwiKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcInJlZlhcIiwgMjApXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwicmVmWVwiLCAtMSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJtYXJrZXJXaWR0aFwiLCA2KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcIm1hcmtlckhlaWdodFwiLCA2KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcIm9yaWVudFwiLCBcImF1dG9cIilcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChcInBhdGhcIilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJkXCIsIFwiTTAsLTVMMTAsMEwwLDVcIik7XG5cbiAgICAgICAgICAgICAgICAvLyBkZWZpbmUgYXJyb3cgbWFya2VycyBmb3IgbGVhZGluZyBhcnJvd1xuICAgICAgICAgICAgICAgIGRlZnMuYXBwZW5kKCdzdmc6bWFya2VyJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2lkJywgJ21hcmstZW5kLWFycm93JylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3ZpZXdCb3gnLCAnMCAtNSAxMCAxMCcpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdyZWZYJywgNylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ21hcmtlcldpZHRoJywgMy41KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignbWFya2VySGVpZ2h0JywgMy41KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignb3JpZW50JywgJ2F1dG8nKVxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCdzdmc6cGF0aCcpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdkJywgJ00wLC01TDEwLDBMMCw1Jyk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnID0gc3ZnO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdHID0gc3ZnLmFwcGVuZChcImdcIilcbiAgICAgICAgICAgICAgICAgICAgLmNsYXNzZWQodGhpc0dyYXBoLmNvbnN0cy5ncmFwaENsYXNzLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnRyA9IHRoaXNHcmFwaC5zdmdHO1xuXG4gICAgICAgICAgICAgICAgLy8gc3ZnIG5vZGVzIGFuZCBsaW5rcyBcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHMgPSBzdmdHLmFwcGVuZChcImdcIikuc2VsZWN0QWxsKFwiZ1wiKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcyA9IHN2Z0cuYXBwZW5kKFwiZ1wiKS5zZWxlY3RBbGwoXCJnXCIpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0Tm9kZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdExpbmtzKCk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc2V0UG9zaXRpb25zKCk7XG4gICAgICAgICAgICAgICAgdmFyIHJlc2l6ZUZ1bmMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm9uV2luZG93UmVzaXplKHN2Zyk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5iaW5kaW5ncyA9IHtcbiAgICAgICAgICAgICAgICAgICAgcmVzaXplOnJlc2l6ZUZ1bmNcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICQod2luZG93KS5yZXNpemUocmVzaXplRnVuYyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogY2FsbHMgdGhlIGRlc3Ryb3kgbWV0aG9kIGZvciBhbGwgcG9saWNpZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZGVzdHJveSgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5LmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3kuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3kuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzR3JhcGguYmluZGluZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgJCh3aW5kb3cpLm9mZihrZXksIHRoaXNHcmFwaC5iaW5kaW5nc1trZXldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUnVucyB0aGUgaW5pdCBmdW5jdGlvbiBmb3IgYWxsIHRoZSBub2Rlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbml0Tm9kZXMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBub2RlLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSdW5zIHRoZSBpbml0IGZ1bmN0aW9uIGZvciBhbGwgdGhlIGxpbmtzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluaXRMaW5rcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLmxpbmtzLCBmdW5jdGlvbihsaW5rKSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmsuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIHJldHVybnMgdGhlIG5vZGUgbWF0Y2hpbmcgdGhlIGlkLCBcbiAgICAgICAgICAgICAqIG9yIHVuZGVmaW5lZCBpZiB0aGVyZSBpcyBub25lXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGlkICAgICAgVGhlIGlkZW50aWZpZXJcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtOb2RlfSAgeyBtYXRjaGluZyBub2RlIH1cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZmluZE5vZGVCeUlkKGlkKXtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXNHcmFwaC5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaWQgPT09IHRoaXNHcmFwaC5ub2Rlc1tpXS5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNHcmFwaC5ub2Rlc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmV0dXJucyB0aGUgZDNOb2RlIG9iamVjdCB0aGF0IG1hdGNoZXMgdGhlIGlkLFxuICAgICAgICAgICAgICogb3IgdW5kZWZpbmVkIGlmIHRoZXJlIGlzIG5vbmVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgaWQgICAgICBUaGUgaWRlbnRpZmllclxuICAgICAgICAgICAgICogQHJldHVybiAgICAge0QzTm9kZX0gVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZmluZEQzTm9kZShpZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBkM05vZGU7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZWFjaChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmlkID09PSBpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZDNOb2RlID0gZDMuc2VsZWN0KHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGQzTm9kZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIGluc3RhbGwgYSBkcmFnIHBvbGljeSB0aGF0IHdpbGwgYmUgY2FsbGVkXG4gICAgICAgICAgICAgKiB3aGVuIG5vZGVzIGFyZSBkcmFnZ2VkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzLmJlaGF2aW9yLmRyYWd9ICBkM2RyYWcgIEQzIGRyYWcgb2JqZWN0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluc3RhbGxEcmFnUG9saWN5KGQzZHJhZykge1xuICAgICAgICAgICAgICAgIHRoaXMuZHJhZyA9IGQzZHJhZztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIGluc3RhbGwgYSBwb2xpY3kgdGhhdCB3aWxsIGJlIGNhbGxlZCBcbiAgICAgICAgICAgICAqIHdoZW4gdGhlcmUgaXMgbW91c2UgaW50ZXJhY3Rpb25zIHdpdGggdGhlIGdyYXBoJ3Mgc3ZnXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeSAgVGhlIHBvbGljeSB0byBpbnN0YWxsXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluc3RhbGxTdmdQb2xpY3kocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdmdQb2xpY3kgPSBwb2xpY3k7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byBpbnN0YWxsIHBvbGljaWVzIHRoYXQgYXJlIGNhbGxlZCB3aGVuIHRoZXJlIGlzXG4gICAgICAgICAgICAgKiBtb3VzZSBpbnRlcmFjdGlvbiB3aXRoIGEgbm9kZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3kgIFRoZSBwb2xpY3kgdG8gaW5zdGFsbFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbnN0YWxsRGVmYXVsdE5vZGVQb2xpY3kocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMucHVzaChwb2xpY3kpO1xuICAgICAgICAgICAgICAgIHBvbGljeS5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIHJlbW92ZSBhbiBpbnN0YWxsZWQgcG9saWN5IGZvciBub2Rlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgcG9saWN5UmVtb3ZlICBUaGUgcG9saWN5IHRvIHJlbW92ZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1bmluc3RhbGxEZWZhdWx0Tm9kZVBvbGljeShwb2xpY3lSZW1vdmUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcG9saWN5UmVtb3ZlTmFtZTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHBvbGljeVJlbW92ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlLnBvbGljeU5hbWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5LCBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9saWN5LnBvbGljeU5hbWUgPT09IHBvbGljeVJlbW92ZU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmV0dXJucyB0aGUgbm9kZSBwb2xpY3kgb2JqZWN0IHdpdGggdGhlIGdpdmVuIG5hbWVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgcG9saWN5TmFtZSAgVGhlIHBvbGljeSBuYW1lXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7UG9saWN5fSAgcG9saWN5ICAgICAgVGhlIG1hdGNoaW5nIHBvbGljeVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBnZXROb2RlUG9saWN5KHBvbGljeU5hbWUpIHtcbiAgICAgICAgICAgIFx0dmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvbGljeS5wb2xpY3lOYW1lID09PSBwb2xpY3lOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcG9saWN5O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byBpbnN0YWxsIHBvbGljaWVzIHRoYXQgYXJlIGNhbGxlZCB3aGVuIHRoZXJlIGlzIGFcbiAgICAgICAgICAgICAqIG1vdXNlIGludGVyYWN0aW9uIHdpdGggYSBwYXRoXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeSAgVGhlIHBvbGljeSB0byBpbnN0YWxsXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluc3RhbGxEZWZhdWx0UGF0aFBvbGljeShwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcy5wdXNoKHBvbGljeSk7XG4gICAgICAgICAgICAgICAgcG9saWN5LmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIHJlbW92ZSBhbiBpbnN0YWxsZWQgcG9saWN5IGZvciBsaW5rc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3lSZW1vdmUgIFRoZSBwb2xpY3kgdG8gcmVtb3ZlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHVuaW5zdGFsbERlZmF1bHRQYXRoUG9saWN5KHBvbGljeVJlbW92ZSkge1xuICAgICAgICAgICAgICAgIHZhciBwb2xpY3lSZW1vdmVOYW1lO1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcG9saWN5UmVtb3ZlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmUucG9saWN5TmFtZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3ksIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb2xpY3kucG9saWN5TmFtZSA9PT0gcG9saWN5UmVtb3ZlTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9saWN5LmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGVyZSBpcyBhIG1vdXNlIGludGVyYWN0aW9uIHdpdGggYSBwYXRoXG4gICAgICAgICAgICAgKiBQcm9wb2dhdGVzIHRoZSBldmVudCB0byBhbGwgaW5zdGFsbGVkIHBhdGggcG9saWNpZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgZXZlbnQgICBUaGUgZXZlbnQgdHlwZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2Qzb2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BhdGh9ICBkICAgICAgIFRoZSBtYXRjaGluZyBMaW5rIG9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBwYXRoUG9saWN5RXZlbnQoZXZlbnQsIGQzcGF0aCwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVtldmVudF0oZDNwYXRoLCBkKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZXJlIGlzIGEgbW91c2UgaW50ZXJhY3Rpb24gd2l0aCBhIG5vZGVcbiAgICAgICAgICAgICAqIFByb3BvZ2F0ZXMgdGhlIGV2ZW50IHRvIGFsbCBpbnN0YWxsZWQgbm9kZSBwb2xpY2llc1xuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgZXZlbnQgICBUaGUgZXZlbnQgdHlwZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2Qzb2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BhdGh9ICBkICAgICAgIFRoZSBtYXRjaGluZyBOb2RlIG9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBub2RlUG9saWN5RXZlbnQoZXZlbnQsIGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcywgZnVuY3Rpb24ocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVtldmVudF0oZDNub2RlLCBkKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNldHMgcGFuIGFuZCB6b29tIHJ1bGVzIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7ZDMuYmVoYXZpb3Iuem9vbX0gIGQzem9vbSAgRDMgem9vbSBvYmpcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5zdGFsbFpvb21Qb2xpY3koZDN6b29tKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kcmFnU3ZnID0gZDN6b29tO1xuICAgICAgICAgICAgICAgIHRoaXMuc3ZnLmNhbGwodGhpcy5kcmFnU3ZnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgd2luZG93IGlzIHJlc2l6ZWRcbiAgICAgICAgICAgICAqIEhvb2sgZm9yIG92ZXJyaWRpbmcgaW4gc3ViY2xhc3Nlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtIVE1MIFNWR30gIHN2ZyAgICAgVGhlIHN2ZyB0aGF0IHRoZSBoYW5kbGVyXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzIGF0dGFjaGVkIHRvXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIG9uV2luZG93UmVzaXplKHN2Zykge31cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBJbnNlcnRzIGxpbmUgYnJlYWtzIGluIG5vZGUgdGV4dFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtIVE1MIEVsZW19ICBnRWwgICAgVGhlIGVsZW0gdG8gYWRkIHRleHQgdG9cbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICB0aXRsZSAgIFRoZSB0aXRsZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbnNlcnRUaXRsZUxpbmVicmVha3MgKGdFbCwgdGl0bGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgd29yZHMgPSB0aXRsZS5zcGxpdCgvXFxzKy9nKSxcbiAgICAgICAgICAgICAgICAgICAgbndvcmRzID0gd29yZHMubGVuZ3RoO1xuICAgICAgICAgICAgICAgIHZhciBlbCA9IGdFbC5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsIHRoaXNHcmFwaC5jb25zdHMubm9kZVRleHQpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwidGV4dC1hbmNob3JcIixcIm1pZGRsZVwiKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcImR5XCIsIFwiLVwiICsgKG53b3Jkcy0xKSo3LjUpO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB3b3Jkcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdHNwYW4gPSBlbC5hcHBlbmQoJ3RzcGFuJykudGV4dCh3b3Jkc1tpXSk7XG4gICAgICAgICAgICAgICAgaWYgKGkgPiAwKVxuICAgICAgICAgICAgICAgICAgICB0c3Bhbi5hdHRyKCd4JywgMCkuYXR0cignZHknLCAnMTUnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyBhbGwgbGlua3MgZnJvbSB0aGUgZ2l2ZW4gbm9kZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzcGxpY2VMaW5rc0Zvck5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICB0b1NwbGljZSA9IHRoaXNHcmFwaC5saW5rcy5maWx0ZXIoZnVuY3Rpb24obCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsLnNvdXJjZSA9PT0gbm9kZSB8fCBsLnRhcmdldCA9PT0gbm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRvU3BsaWNlLm1hcChmdW5jdGlvbihsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcy5zcGxpY2UodGhpc0dyYXBoLmxpbmtzLmluZGV4T2YobCksIDEpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEFkZHMgdGhlIG5vZGUgdG8gdGhlIGdyYXBoIGFuZCB1cGRhdGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBub2RlICAgIFRoZSBub2RlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGFkZE5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgIG5vZGUuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmVzIHRoZSBub2RlIHRvIHRoZSBncmFwaCBhbmQgdXBkYXRlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICByZW1vdmVOb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMuc3BsaWNlKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG5vZGUpLCAxKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3BsaWNlTGlua3NGb3JOb2RlKG5vZGUpO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEFkZHMgdGhlIGxpbmsgdG8gdGhlIGdyYXBoIGFuZCB1cGRhdGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2xpbmt9ICBsaW5rICAgIFRoZSBsaW5rXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGFkZExpbmsobGluaykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcy5wdXNoKGxpbmspO1xuICAgICAgICAgICAgICAgIGxpbmsuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmVzIHRoZSBsaW5rIHRvIHRoZSBncmFwaCBhbmQgdXBkYXRlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtsaW5rfSAgbGluayAgICBUaGUgbGlua1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICByZW1vdmVMaW5rKGxpbmspIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3Muc3BsaWNlKHRoaXNHcmFwaC5saW5rcy5pbmRleE9mKGxpbmspLCAxKTtcbiAgICAgICAgICAgICAgICBsaW5rLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgdXBkYXRpbmcgZXhpc3RpbmcgcGF0aHNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UGF0aH0gIHBhdGhzICAgTGlzdCBvZiBwYXRoc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1cGRhdGVFeGlzdGluZ1BhdGhzKHBhdGhzKSB7XG4gICAgICAgICAgICAgICAgcGF0aHMuZWFjaChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgIGQudXBkYXRlQXR0cihkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyBhZGRpbmcgbmV3IHBhdGhzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BhdGh9ICBuZXdQYXRocyAgTGlzdCBvZiBuZXcgcGF0aHNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlTmV3UGF0aHMobmV3UGF0aHMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0TGlua3MoKTtcblxuICAgICAgICAgICAgICAgIG5ld1BhdGhzLmVhY2goZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICBkLm5ld1BhdGhBdHRyKGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvL2lmIG5vZGUgZG9lc24ndCBoYXZlIGl0cyBvd24gcG9saWN5LCB1c2UgZGVmYXVsdCBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgICAgbmV3UGF0aHMub24oXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlb3ZlclwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlb3ZlclwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiZGJsY2xpY2tcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJkYmxjbGlja1wiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcImRibGNsaWNrXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJjb250ZXh0bWVudVwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnBhdGhQb2xpY3lFdmVudChcImNvbnRleHRtZW51XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aFBvbGljeUV2ZW50KFwiY29udGV4dG1lbnVcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcIm1vdXNlb3V0XCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZW91dFwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlb3V0XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlZG93blwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlZG93blwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwibW91c2V1cFwiLCBmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQucGF0aFBvbGljeUV2ZW50KFwibW91c2V1cFwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcIm1vdXNldXBcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5jYWxsKHRoaXNHcmFwaC5kcmFnKTtcbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyB1cGRhdGluZyBleGlzdGluZyBub2Rlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1cGRhdGVFeGlzdGluZ05vZGVzKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzID0gdGhpcy5jaXJjbGVzLmRhdGEodGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbihkKXsgcmV0dXJuIGQuaWQ7fSlcbiAgICAgICAgICAgICAgICAgICAgLmVhY2goZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC51cGRhdGVBdHRyKGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIGFkZGluZyBuZXcgbm9kZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5ld05vZGVzICBMaXN0IG9mIG5ldyBub2Rlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1cGRhdGVOZXdOb2RlcyhuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgbmV3Tm9kZXMuZWFjaChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmdyYXBoID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGQubmV3Tm9kZUF0dHIoZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vaWYgbm9kZSBkb2Vzbid0IGhhdmUgaXRzIG93biBwb2xpY3ksIHVzZSBkZWZhdWx0IGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAgICBuZXdOb2Rlcy5vbihcIm1vdXNlb3ZlclwiLCBmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQubm9kZVBvbGljeUV2ZW50KFwibW91c2VvdmVyXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwibW91c2VvdmVyXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJkYmxjbGlja1wiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcImRibGNsaWNrXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwiZGJsY2xpY2tcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcImNvbnRleHRtZW51XCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQubm9kZVBvbGljeUV2ZW50KFwiY29udGV4dG1lbnVcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlUG9saWN5RXZlbnQoXCJjb250ZXh0bWVudVwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwibW91c2VvdXRcIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlb3V0XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwibW91c2VvdXRcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcIm1vdXNlZG93blwiLCBmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQubm9kZVBvbGljeUV2ZW50KFwibW91c2Vkb3duXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwibW91c2Vkb3duXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZXVwXCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5ub2RlUG9saWN5RXZlbnQoXCJtb3VzZXVwXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwibW91c2V1cFwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmNhbGwodGhpc0dyYXBoLmRyYWcpO1xuXG4gICAgICAgICAgICAgICAgbmV3Tm9kZXMuYXBwZW5kKFwiY2lyY2xlXCIpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJyXCIsIGZ1bmN0aW9uKGQpIHtyZXR1cm4gU3RyaW5nKGQucmFkaXVzKX0pO1xuXG5cbiAgICAgICAgICAgICAgICBuZXdOb2Rlcy5lYWNoKGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5zZXJ0VGl0bGVMaW5lYnJlYWtzKGQzLnNlbGVjdCh0aGlzKSwgZC50ZXh0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBQcmV2ZW50cyBub2RlcyBmcm9tIGNvbGxpZGluZ1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICBhbHBoYSAgIEFmZmVjdHMgaG93IG11Y2ggY2hhbmdlXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGUgY29sbGlzaW9uIGNhdXNlc1xuICAgICAgICAgICAgICogQHJldHVybiAgICAge2Jvb2xlYW59ICB7V2hldGhlciBub2RlcyBhcmUgY29sbGlkZWR9XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGQzRm9yY2VDb2xsaWRlKGFscGhhKSB7XG4gICAgICAgICAgICBcdHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgXHRcdGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHM7XG4gICAgICAgICAgICBcdHZhciBub2RlcyA9IHRoaXNHcmFwaC5ub2RlcztcbiAgICAgICAgICAgIFx0dmFyIHF1YWR0cmVlID0gZDMuZ2VvbS5xdWFkdHJlZShub2Rlcyk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByID0gZC5yYWRpdXMgKyBjb25zdHMubWF4UmFkaXVzICsgY29uc3RzLnBhZGRpbmcsXG4gICAgICAgICAgICAgICAgICAgICAgICBueDEgPSBkLnggLSByLFxuICAgICAgICAgICAgICAgICAgICAgICAgbngyID0gZC54ICsgcixcbiAgICAgICAgICAgICAgICAgICAgICAgIG55MSA9IGQueSAtIHIsXG4gICAgICAgICAgICAgICAgICAgICAgICBueTIgPSBkLnkgKyByO1xuICAgICAgICAgICAgICAgICAgICBxdWFkdHJlZS52aXNpdChmdW5jdGlvbihxdWFkLCB4MSwgeTEsIHgyLCB5Mikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHF1YWQucG9pbnQgJiYgKHF1YWQucG9pbnQgIT09IGQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHggPSBkLnggLSBxdWFkLnBvaW50LngsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHkgPSBkLnkgLSBxdWFkLnBvaW50LnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwgPSBNYXRoLnNxcnQoeCAqIHggKyB5ICogeSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIgPSBkLnJhZGl1cyArIHF1YWQucG9pbnQucmFkaXVzICsgY29uc3RzLnBhZGRpbmc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGwgPCByKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsID0gKGwgLSByKSAvIGwgKiBhbHBoYTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCAtPSB4ICo9IGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgLT0geSAqPSBsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVhZC5wb2ludC54ICs9IHg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWFkLnBvaW50LnkgKz0geTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHgxID4gbngyIHx8IHgyIDwgbngxIHx8IHkxID4gbnkyIHx8IHkyIDwgbnkxO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRpY2sgb2YgdGhlIGQzIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDN0aWNrIGV2ZW50fSAgZSAgICBEM3RpY2sgZXZlbnRcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB3aWR0aCAgVGhlIHdpZHRoIG9mIHRoZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgaGVpZ2h0IFRoZSBoZWlnaHQgb2YgdGhlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZVRpY2soZSwgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgXHR2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgIFx0XHRjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzO1xuXG4gICAgICAgICAgICBcdHZhciBvZmZzZXQgPSBjb25zdHMuZGlzcGxheU9mZnNldDtcdFxuICAgICAgICAgICAgXHR2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICBcdHZhciBxID0gZDMuZ2VvbS5xdWFkdHJlZSh0aGlzR3JhcGgubm9kZXMpLFxuICAgICAgICAgICAgICAgICAgICAgIGkgPSAwLFxuICAgICAgICAgICAgICAgICAgICAgIG4gPSBub2Rlcy5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICAgIHdoaWxlICgrK2kgPCBuKSB7XG4gICAgICAgICAgICAgICAgICAgIHEudmlzaXQodGhpcy5kM0ZvcmNlQ29sbGlkZShub2Rlc1tpXSkpO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZWFjaCh0aGlzLmQzRm9yY2VDb2xsaWRlKC41KSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJjeFwiLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnggPSBNYXRoLm1heChkLnJhZGl1cyArIG9mZnNldCwgTWF0aC5taW4od2lkdGggLSBvZmZzZXQgLSBkLnJhZGl1cywgZC54KSk7IH0pXG4gICAgICAgICAgICAgICAgICAgICAuYXR0cihcImN5XCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQueSA9IE1hdGgubWF4KGQucmFkaXVzICsgb2Zmc2V0LCBNYXRoLm1pbihoZWlnaHQgLSBvZmZzZXQgLSBkLnJhZGl1cywgZC55KSk7IH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd4MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLnk7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd4MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lnk7IH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFN0YXJ0cyBvbiBzdGFydCBvZiB0aGUgZm9yY2Ugc2ltdWxhdGlvblxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkM0ZvcmNlU3RhcnQoKSB7XG4gICAgICAgICAgICBcdHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoc1xuICAgICAgICAgICAgICAgICAgICAuYXR0cigneDEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS55OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneDInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC55OyB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgb24gdGhlIGVuZCBvZiB0aGUgZm9yY2Ugc2ltdWxhdGlvblxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkM0ZvcmNlRW5kKCkge1xuICAgICAgICAgICAgXHR2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgIFx0dGhpc0dyYXBoLmNpcmNsZXNcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2N4JywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY3knLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnk7IH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzLmF0dHIoJ3gxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueTsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueTsgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsY3VsYXRlcyB0aGUgd2lkdGggYW5kIGhlaWdodCBib3VuZHMgZm9yIHRoZSBcbiAgICAgICAgICAgICAqIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7T2JqZWN0fSAgd2lkdGggYW5kIGhlaWdodCBhcyBwcm9wZXJ0aWVzIFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkM0ZvcmNlQm91bmRzKCkge1xuICAgICAgICAgICAgICAgIHZhciBzdmdXaWR0aCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykud2lkdGgoKTtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnSGVpZ2h0ID0gJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS5oZWlnaHQoKTtcblxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IHN2Z1dpZHRoO1xuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBzdmdIZWlnaHQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHt3aWR0aDp3aWR0aCwgaGVpZ2h0OmhlaWdodH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogRG9lcyBhIGQzIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RnVuY3Rpb259ICBjYWxsYmFjayAgVGhlIGNhbGxiYWNrXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNldEZvcmNlKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICAgICAgdmFyIGxpbmtzID0gdGhpc0dyYXBoLmxpbmtzO1xuICAgICAgICAgICAgICAgIGlmIChfLmlzRW1wdHkobm9kZXMpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgYm91bmRzID0gdGhpc0dyYXBoLmQzRm9yY2VCb3VuZHMoKTtcblxuICAgICAgICAgICAgICAgIHZhciBmb3JjZSA9IGQzLmxheW91dC5mb3JjZSgpXG4gICAgICAgICAgICAgICAgICAgIC5zaXplKFtib3VuZHMud2lkdGgsIGJvdW5kcy5oZWlnaHRdKVxuICAgICAgICAgICAgICAgICAgICAubm9kZXMobm9kZXMpXG4gICAgICAgICAgICAgICAgICAgIC5jaGFyZ2UoZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC02MDAwO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAubGlua3MobGlua3MpO1xuXG4gICAgICAgICAgICAgICAgZm9yY2UubGlua0Rpc3RhbmNlKGJvdW5kcy53aWR0aC8zKTtcbiAgICAgICAgICAgICAgICBmb3JjZS5saW5rU3RyZW5ndGgoLjIpO1xuICAgICAgICAgICAgICAgIGZvcmNlLmdyYXZpdHkoLjIpO1xuXG4gICAgICAgICAgICAgICAgZm9yY2Uub24oJ3RpY2snLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgXHR0aGlzR3JhcGguZDNGb3JjZVRpY2suY2FsbCh0aGlzR3JhcGgsIFxuICAgICAgICAgICAgICAgIFx0XHRcdGUsIGJvdW5kcy53aWR0aCwgYm91bmRzLmhlaWdodCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBmb3JjZS5vbignc3RhcnQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBcdHRoaXNHcmFwaC5kM0ZvcmNlU3RhcnQuY2FsbCh0aGlzR3JhcGgpXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBmb3JjZS5vbignZW5kJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgXHR0aGlzR3JhcGguZDNGb3JjZUVuZC5jYWxsKHRoaXNHcmFwaClcbiAgICAgICAgICAgICAgICB9KTsgXG5cblxuICAgICAgICAgICAgICAgIGZvcmNlLnN0YXJ0KCk7XG4gICAgICAgICAgICAgICAgdmFyIGsgPSAwO1xuICAgICAgICAgICAgICAgIHdoaWxlICgoZm9yY2UuYWxwaGEoKSA+IDFlLTIpICYmIChrIDwgMTUwKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3JjZS50aWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIGsgPSBrICsgMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yY2Uuc3RvcCgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBcdGNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNldHMgdGhlIHBvc2l0aW9ucyB0byBiZSB0aGUgY2VudGVyIG9mIHRoZSBzY3JlZW4gaWYgXG4gICAgICAgICAgICAgKiBub3QgcHJvdmlkZWRcbiAgICAgICAgICAgICAqIGFsc28gc2V0cyB0aGUgcmFkaXVzIG9mIHRoZSBub2Rlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzZXRQb3NpdGlvbnMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gdGhpc0dyYXBoLmNvbnN0cy5kaXNwbGF5T2Zmc2V0O1xuICAgICAgICAgICAgICAgIHZhciBzdmdXaWR0aCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykud2lkdGgoKTtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnSGVpZ2h0ID0gJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS5oZWlnaHQoKTtcblxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IHN2Z1dpZHRoIC0gKDIqb2Zmc2V0KTtcbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gc3ZnSGVpZ2h0IC0gKDIqb2Zmc2V0KTtcblxuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXNHcmFwaC5ub2RlcztcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZXNbaV0ucmFkaXVzID0gbm9kZXNbaV0ucmFkaXVzIHx8IHRoaXNHcmFwaC5jb25zdHMuc3RhcnRSYWRpdXM7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2Rlc1tpXS54ID09IG51bGwgfHwgbm9kZXNbaV0ueSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBub2Rlc1tpXS54U3RhcnQgPSB3aWR0aC8yICArIG5vZGVzW2ldLnJhZGl1cyArIG9mZnNldFxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNbaV0ueCA9IHdpZHRoLzIgICsgbm9kZXNbaV0ucmFkaXVzICsgb2Zmc2V0O1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm9kZXNbaV0ueVN0YXJ0ID0gaGVpZ2h0LzIgKyBub2Rlc1tpXS5yYWRpdXMgKyBvZmZzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzW2ldLnkgPSBoZWlnaHQvMiArIG5vZGVzW2ldLnJhZGl1cyArIG9mZnNldFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB0byB1cGRhdGUgdGhlIHZpZXcgb2YgdGhlIGdyYXBoIHdoZW5cbiAgICAgICAgICAgICAqIGRhdGEgY2hhbmdlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtGdW5jdGlvbn0gIGNhbGxiYWNrICBUaGUgY2FsbGJhY2tcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlR3JhcGgoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGU7XG5cbiAgICAgICAgICAgIFx0aWYgKHRoaXNHcmFwaC5zdGF0ZS5kaXNhYmxlVXBkYXRlKSB7XG4gICAgICAgICAgICBcdFx0cmV0dXJuO1xuICAgICAgICAgICAgXHR9XG5cbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUV4aXN0aW5nTm9kZXMoKTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3R3M9IHRoaXNHcmFwaC5jaXJjbGVzLmVudGVyKClcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChcImdcIik7XG5cbiAgICAgICAgICAgIFx0Ly8gY29uc29sZS5sb2coJ3VwZGF0ZScsIG5ld0dzKTtcbiAgICAgICAgICAgICAgICBuZXdHcy5jbGFzc2VkKGNvbnN0cy5jaXJjbGVHQ2xhc3MsIHRydWUpO1xuICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gdGhpcy51cGRhdGVOZXdOb2RlcyhuZXdHcyk7XG5cbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgb2xkIG5vZGVzXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZXhpdCgpLnJlbW92ZSgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmluaXRGb3JjZSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc2V0Rm9yY2UoZnVuY3Rpb24oKSB7XG4gICAgXHQgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZU5ld05vZGVzLmNhbGwodGhpc0dyYXBoLCBuZXdHcyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5pbml0Rm9yY2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZU5ld05vZGVzKG5ld0dzKTtcblx0ICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzID0gdGhpc0dyYXBoLnBhdGhzLmRhdGEodGhpc0dyYXBoLmxpbmtzLCBmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFN0cmluZyhkLnNvdXJjZS5pZCkgKyBcIitcIiArIFN0cmluZyhkLnRhcmdldC5pZCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdmFyIHBhdGhzID0gdGhpc0dyYXBoLnBhdGhzO1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRXhpc3RpbmdQYXRocyhwYXRocyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbmV3cGF0aHMgPSBwYXRocy5lbnRlcigpXG4gICAgICAgICAgICAgICAgLmFwcGVuZChcInBhdGhcIilcbiAgICAgICAgICAgICAgICAuc3R5bGUoJ21hcmtlci1lbmQnLCd1cmwoI2VuZC1hcnJvdyknKVxuICAgICAgICAgICAgICAgIC5jbGFzc2VkKFwibGlua1wiLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZU5ld1BhdGhzKG5ld3BhdGhzKTtcblxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBvbGQgbGlua3NcbiAgICAgICAgICAgICAgICBwYXRocy5leGl0KCkucmVtb3ZlKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIFx0Y2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBHcmFwaDogR3JhcGhcbiAgICAgICAgfVxufV0pO1xuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5hcHBsaWNhdGlvbmdyb3VwcycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvYXBwbGljYXRpb25ncm91cHMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnYXBwbGljYXRpb25ncm91cGNyZWF0ZSdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnYXBwbGljYXRpb25ncm91cGRldGFpbHMnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmVkaXQnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZWRpdC86a2V5JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2FwcGxpY2F0aW9uZ3JvdXBkZXRhaWxzJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3Vwcy5saXN0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnYXBwbGljYXRpb25Hcm91cGxpc3QnXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIFRoZSBncmFwaCB0aGF0IGlzIHVzZWQgc3BlY2lmaWNhbGx5IGZvciB0aGUgdmlzdWFsaXphdGlvbiB0YWIuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdWaXN1YWxpemVyR3JhcGgnLCBbJ0dyYXBoJywgZnVuY3Rpb24gKEdyYXBoKSB7XG4gICAgXHRjbGFzcyBWaXN1YWxpemVyR3JhcGggZXh0ZW5kcyBHcmFwaC5HcmFwaCB7XG4gICAgXHRcdC8qKlxuICAgIFx0XHQgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgXHRcdCAqXG4gICAgXHRcdCAqIEBwYXJhbSAgIHtIVE1MIFNWR30gIHN2ZyAgICAgICAgICAgICBUaGUgc3ZnIHRoYXQgd2lsbCBcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob2xkIHRoZSBncmFwaFxuICAgICAgICAgICAgICogQHBhcmFtICAge0FycmF5fSAgbm9kZXMgICBcdFx0ICAgIExpc3Qgb2Ygbm9kZXNcbiAgICAgICAgICAgICAqIEBwYXJhbSAgIHtBcnJheX0gIGxpbmtzICAgXHRcdCAgICBMaXN0IG9mIGxpbmtzXG4gICAgXHRcdCAqIEBwYXJhbSAgIHtEYXRhU291cmNlfSAgZGF0YVNvdXJjZSAgICBUaGUgZGF0YSBzb3VyY2VcbiAgICBcdFx0ICovXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcihzdmcsIG5vZGVzLCBsaW5rcywgZGF0YVNvdXJjZSkge1xuICAgICAgICAgICAgICAgIHN1cGVyKHN2Zywgbm9kZXMsIGxpbmtzKTtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgICAgIC8vaG9sZHMgY3VycmVudCB0cmFuc2l0aW9ucyB0aGF0IGFyZSBvY2N1cmluZ1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZS50cmFuc2l0aW9uID0gW107XG4gICAgICAgICAgICAgICAgLy9NaW4gZGlzdGFuY2UgYmV0d2VlbiBub2RlcyB3aGVuIHNwYXduaW5nIHJhbmRvbWx5XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNvbnN0cy5lZGdlX2J1ZmZlciA9IDIwMDtcbiAgICAgICAgICAgICAgICAvL1NpemUgcmVkdWN0aW9uIGFzIHlvdSBnbyB0aHJvdWdoIGxldmVscyBpbiBub2Rlc1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jb25zdHMucmFkaXVzRGVjYXkgPSAxO1xuICAgICAgICAgICAgICAgIC8vQ3NzIGNsYXNzIGZvciBub2RlcyB0aGF0IGFyZSBjb250YWluZXJzXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNvbnN0cy5jb250YWluZXJDbGFzcyA9ICdjb250YWluZXInO1xuXG4gICAgICAgICAgICAgICAgLy9kYXRhU291cmNlIGhvbGRzIHRoZSBzZXJ2ZXIgZGF0YSBhbmQgbWV0aG9kcyBmb3JcbiAgICAgICAgICAgICAgICAvL2NvbnZlcnRpbmcgaXQgdG8gZGF0YSBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRhdGFTb3VyY2UgPSBkYXRhU291cmNlO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vRHJhZyBiZWhhdmlvciBmb3Igbm9kZXNcbiAgICAgICAgICAgICAgICB2YXIgZHJhZyA9IGQzLmJlaGF2aW9yLmRyYWcoKVxuICAgICAgICAgICAgICAgICAgICAub3JpZ2luKGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge3g6IGQueCwgeTogZC55fTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiZHJhZ3N0YXJ0XCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJkcmFnXCIsIGZ1bmN0aW9uKGFyZ3Mpe1xuICAgICAgICAgICAgICAgICAgICBcdGQzLnNlbGVjdCggdGhpcykuYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbiggZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCArPSBkMy5ldmVudC5keDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gZDMuZXZlbnQuZHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwidHJhbnNsYXRlKFwiICsgWyBkLngsZC55IF0gKyBcIilcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcdFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJkcmFnZW5kXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kcmFnID0gZHJhZztcblxuICAgICAgICAgICAgICAgIC8vUGFuIGFuZCBab29tIGJlaGF2aW9yIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAgICB2YXIgem9vbSA9IGQzLmJlaGF2aW9yLnpvb20oKVxuICAgICAgICAgICAgICAgICAgICAub24oXCJ6b29tXCIsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZDMuZXZlbnQuc291cmNlRXZlbnQgIT0gbnVsbCAmJiBkMy5ldmVudC5zb3VyY2VFdmVudC5jdHJsS2V5KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZC5jYWxsKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiem9vbXN0YXJ0XCIsIGZ1bmN0aW9uKGQsIGkpe1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguZHJhZ1N2ZyA9IHpvb207XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Zy5jYWxsKHpvb20pLm9uKFwiZGJsY2xpY2suem9vbVwiLCBudWxsKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2l0aCBubyBhcmdzIHdoZW4gdGhlIGdyYXBoIGhhcyBhIHpvb20gYWN0aW9uXG4gICAgICAgICAgICAgKiBDYW4gYWxzbyBiZSBjYWxsZWQgd2l0aCBhcmdzIHRvIGZvcmNlIGEgem9vbSBvciBwYW4gXG4gICAgICAgICAgICAgKiBldmVudCBmb3IgdGhlIGdyYXBoLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gICB0cmFuc2xhdGUgIFRoZSBhbW91bnQgdG8gdHJhbnNsYXRlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgc2NhbGUgICAgICBUaGUgYW1vdW50IHRvIHNjYWxlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHpvb21lZCh0cmFuc2xhdGUsIHNjYWxlKXtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLnN0YXRlLnJpZ2h0Q2xpY2sgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuanVzdFNjYWxlVHJhbnNHcmFwaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKHRyYW5zbGF0ZSAhPSBudWxsICYmIHNjYWxlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSB0aGlzR3JhcGguZHJhZ1N2ZztcbiAgICAgICAgICAgICAgICAgICAgem9vbS5zY2FsZShzY2FsZSk7XG4gICAgICAgICAgICAgICAgICAgIHpvb20udHJhbnNsYXRlKHRyYW5zbGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIC8vY3JlYXRpbmcgbmFtZXMgdG8gcHJldmVudCB0cmFuc2l0aW9uIGNvbmZsaWN0c1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbVNldENhbGxiYWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIFx0em9vbS5zY2FsZShzY2FsZSk7XG4gICAgICAgICAgICAgICAgICAgIFx0em9vbS50cmFuc2xhdGUodHJhbnNsYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zbGF0ZV9uYW1lID0gXCJ6b29tXCIgKyB0cmFuc2xhdGU7XG4gICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdChcIi5cIiArIHRoaXMuY29uc3RzLmdyYXBoQ2xhc3MpLnRyYW5zaXRpb24odHJhbnNsYXRlX25hbWUpLmRlbGF5KDEwMCkuZHVyYXRpb24oNzUwKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoJyArIHpvb20udHJhbnNsYXRlKCkgKyAnKSBzY2FsZSgnICsgem9vbS5zY2FsZSgpICsgJyknKS5lYWNoKFwiZW5kXCIsIHpvb21TZXRDYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGguc3RhdGUuY2FuWm9vbSkge1xuICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QoXCIuXCIgKyB0aGlzLmNvbnN0cy5ncmFwaENsYXNzKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKSArIFwiKSBzY2FsZShcIiArdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKSArIFwiKVwiKTsgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgd2luZG93IHJlc2l6ZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBTVkd9ICBzdmcgICAgVGhlIHN2ZyB0byByZXNpemVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgb25XaW5kb3dSZXNpemUoc3ZnKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJvZHlFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF07XG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykub2Zmc2V0KCk7XG4gICAgICAgICAgICAgICAgdmFyIGRpdldpZHRoID0gJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS53aWR0aCgpO1xuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBib2R5RWwuY2xpZW50SGVpZ2h0O1xuICAgICAgICAgICAgICAgIHN2Zy5hdHRyKFwid2lkdGhcIiwgZGl2V2lkdGgpLmF0dHIoXCJoZWlnaHRcIiwgaGVpZ2h0IC0gb2Zmc2V0LnRvcCAtIDIwKTtcblxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgc2VydmVyIHNlbmRzIHVwZGF0ZWQgZGF0YSBmb3IgdGhlIGxpbmtzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHVwZGF0ZUxpbmtEYXRhKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBub2RlX25hbWVzX3NldCA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpc0dyYXBoLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVfbmFtZXNfc2V0LnB1c2godGhpc0dyYXBoLm5vZGVzW2ldLmlkKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcmV0RGF0YSA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmdldEZsb3dCZXR3ZWVuU2V0KG5vZGVfbmFtZXNfc2V0KTtcbiAgICAgICAgICAgICAgICB2YXIgbGlua0RhdGEgPSByZXREYXRhLmxpbmtEYXRhO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YShsaW5rRGF0YSwgdGhpc0dyYXBoLm5vZGVzKTtcbiAgICAgICAgICAgICAgICB0aGlzLmluaXROb2RlcygpO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5pdExpbmtzKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIFxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIEdyYXBoOiBWaXN1YWxpemVyR3JhcGhcbiAgICAgICAgfVxufV0pO1xuXG5cblxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmRhc2hib2FyZCcsIFsnY29udGl2Lm1vZGVscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5kYXNoYm9hcmQnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGFzaGJvYXJkJyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2Rhc2hib2FyZCdcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIi8qKlxuICogVGhlIGJhc2UgY2xhc3MgZm9yIGxpbmsgb2JqZWN0cyBmb3IgdGhlIGdyYXBoLlxuICogU3VwcG9ydHMgcG9saWNpZXMuXG4gKiBcbiAqIFRvIHdyaXRlIHlvdXIgb3duIGxpbmsgb2JqZWN0LCBjcmVhdGUgYSBuZXcgZmFjdG9yeSB0aGF0IHVzZXMgdGhlIGxpbmtcbiAqIHlvdSB3YW50IHRvIGluaGVyaXQgYXMgYSBkZXBlbmRlbmN5LCBhbmQgZXh0ZW5kIGl0cyBsaW5rIGNsYXNzLiBcbiAqIFJldHVybiB0aGUgY2xhc3Mgb2JqZWN0IHdpdGggTGluayBhcyBrZXlcbiAqIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnTGluaycsIFtmdW5jdGlvbiAoKSB7XG4gICAgXHRjbGFzcyBMaW5rIHtcbiAgICBcdFx0LyoqXG4gICAgXHRcdCAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICBcdFx0ICpcbiAgICBcdFx0ICogQHBhcmFtICAgICAge05vZGV9ICBzb3VyY2VOb2RlICBUaGUgc291cmNlIG5vZGVcbiAgICBcdFx0ICogQHBhcmFtICAgICAge05vZGV9ICB0YXJnZXROb2RlICBUaGUgdGFyZ2V0IG5vZGVcbiAgICBcdFx0ICovXG5cdFx0XHRjb25zdHJ1Y3Rvcihzb3VyY2VOb2RlLCB0YXJnZXROb2RlKSB7XG5cdFx0XHRcdHRoaXMuc291cmNlID0gc291cmNlTm9kZTtcblx0XHRcdFx0dGhpcy50YXJnZXQgPSB0YXJnZXROb2RlO1xuXHRcdFx0XHR0aGlzLmhhc1BvbGljeSA9IGZhbHNlO1xuXHRcdFx0XHR0aGlzLnBhdGhQb2xpY2llcyA9IFtdO1xuXHRcdFx0XHR0aGlzLmdyYXBoID0gbnVsbDtcblx0XHRcdFx0dGhpcy5pbml0aWFsaXplZCA9IGZhbHNlO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCB3aGVuIGEgbGluayBpcyBhZGRlZCB0byB0aGUgZ3JhcGhcblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaCBpdCBpcyBhZGRlZCB0b1xuXHRcdFx0ICovXG5cdFx0XHRpbml0aWFsaXplKGdyYXBoKSB7XG5cdFx0XHRcdGlmICh0aGlzLmluaXRpYWxpemVkID09IGZhbHNlKSB7XG5cdFx0XHRcdFx0dGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG5cdFx0XHRcdFx0dGhpcy5ncmFwaCA9IGdyYXBoO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsbGVkIGR1cmluZyB0aGUgdXBkYXRlIGdyYXBoIGZvciBleGlzdGluZyBsaW5rc1xuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzcGF0aCAgVGhlIGQzIHBhdGhcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtMaW5rfSAgXHQgICBkICAgICAgIE1hdGNoaW5nIExpbmsgT2JqZWN0ICAgICAgIFxuXHRcdFx0ICovXG5cdFx0XHR1cGRhdGVBdHRyKGQzcGF0aCwgZCkge1xuXHRcdFx0XHRkM3BhdGguc3R5bGUoJ21hcmtlci1lbmQnLCAndXJsKCNlbmQtYXJyb3cpJylcblx0XHQgICAgICAgICAgICAuYXR0cihcImRcIiwgYXJyb3dQYXRoKTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxsZWQgZHVyaW5nIHRoZSBmaXJzdCB1cGRhdGUgZ3JhcGggZm9yIGEgbGlua1xuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzcGF0aCAgVGhlIGQzIHBhdGhcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtMaW5rfSAgXHQgICBkICAgICAgIE1hdGNoaW5nIExpbmsgT2JqZWN0ICAgICAgIFxuXHRcdFx0ICovXG5cdFx0XHRuZXdQYXRoQXR0cihkM3BhdGgsIGQpIHtcblx0XHRcdFx0ZDNwYXRoLmF0dHIoJ2QnLCBhcnJvd1BhdGgpO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGN1bGF0ZXMgdGhlIGFycm93IHBhdGhcblx0XHRcdCAqXG5cdFx0XHQgKiBAcmV0dXJuICAgICB7c3RyaW5nfSAgVGhlIHBhdGggdG8gZHJhd1xuXHRcdFx0ICovXG5cdFx0ICAgIGFycm93UGF0aCgpIHtcblx0XHQgICAgXHR2YXIgZCA9IHRoaXM7XG5cdFx0ICAgICAgICB2YXIgZHggPSBkLnRhcmdldC54IC0gZC5zb3VyY2UueCxcblx0XHQgICAgICAgICAgICBkeSA9IGQudGFyZ2V0LnkgLSBkLnNvdXJjZS55LFxuXHRcdCAgICAgICAgICAgIGRyID0gTWF0aC5zcXJ0KGR4ICogZHggKyBkeSAqIGR5KTtcblx0XHQgICAgICAgIHJldHVybiBcIk1cIiArIGQuc291cmNlLnggKyBcIixcIiArIGQuc291cmNlLnkgKyBcIkFcIiArIGRyICsgXCIsXCIgKyBkciArIFwiIDAgMCwxIFwiICsgZC50YXJnZXQueCArIFwiLFwiICsgZC50YXJnZXQueTtcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBVc2VkIHRvIGluc3RhbGwgcG9saWNpZXMgdGhhdCBhcmUgY2FsbGVkIHdoZW4gdGhpc1xuXHRcdCAgICAgKiBsaW5rIGhhcyBhIG1vdXNlIGV2ZW50XG5cdFx0ICAgICAqXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3kgIFRoZSBwb2xpY3kgdG8gaW5zdGFsbFxuXHRcdCAgICAgKi9cblx0XHRcdGluc3RhbGxQYXRoUG9saWN5KHBvbGljeSkge1xuXHRcdFx0XHR0aGlzLmhhc1BvbGljeSA9IHRydWU7XG5cdFx0XHRcdHRoaXMucGF0aFBvbGljaWVzLnB1c2gocG9saWN5KTtcblx0XHRcdFx0cG9saWN5LmluaXRpYWxpemUodGhpcy5ncmFwaCk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogVXNlZCB0byB1bmluc3RhbGwgcG9saWN5IGZvciB0aGlzIGxpbmtcblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7UG9saWN5fSAgcG9saWN5UmVtb3ZlICBUaGUgcG9saWN5IHRvIHJlbW92ZVxuXHRcdFx0ICovXG5cdFx0XHR1bmluc3RhbGxQYXRoUG9saWN5KHBvbGljeVJlbW92ZSkge1xuXHRcdFx0XHR2YXIgcG9saWN5UmVtb3ZlTmFtZTtcblx0XHRcdFx0dmFyIHRoaXNQYXRoID0gdGhpcztcblx0XHRcdFx0aWYgKHR5cGVvZiBwb2xpY3lSZW1vdmUgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0cG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlLnBvbGljeU5hbWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0Xyh0aGlzUGF0aC5wYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5LCBpbmRleCkge1xuXHRcdFx0XHRcdGlmIChwb2xpY3kucG9saWN5TmFtZSA9PT0gcG9saWN5UmVtb3ZlTmFtZSkge1xuXHRcdFx0XHRcdFx0cG9saWN5LmRlc3Ryb3koKTtcblx0XHRcdFx0XHRcdHRoaXNQYXRoLnBhdGhQb2xpY2llcy5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHRcdGlmICh0aGlzUGF0aC5wYXRoUG9saWNpZXMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdFx0dGhpc1BhdGguaGFzUG9saWN5ID0gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxsZWQgd2hlbiB0aGVyZSBpcyBhIG1vdXNlIGV2ZW50IGZvciB0aGlzIHBhdGhcblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgZXZlbnQgICAgIFRoZSBtb3VzZSBldmVudFxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuXHRcdFx0ICogQHBhcmFtICAgICAge09iamVjdH0gIGQgICAgICAgICBUaGUgbWF0Y2hpbmcgbGluayBvYmplY3Rcblx0XHRcdCAqL1xuXHRcdFx0cGF0aFBvbGljeUV2ZW50KGV2ZW50LCBkM3BhdGgsIGQpIHtcblx0XHRcdFx0XyhkLnBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3kpIHtcblx0XHRcdFx0XHRwb2xpY3lbZXZlbnRdKGQzcGF0aCwgZCk7XG5cdFx0XHRcdH0pXG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB7XG5cdFx0XHRMaW5rOiBMaW5rXG5cdFx0fVxufV0pO1xuXG5cblxuXG5cblxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE5LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmxvZ2luJywgWydjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2LmxvZ2luJywge1xuICAgICAgICAgICAgdXJsOiAnLycsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdsb2dpbidcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIi8qKlxuICogVGhlIGxpbmsgdGhhdCBpcyB1c2VkIHNwZWNpZmljYWxseSBmb3IgdGhlIHZpc3VhbGl6YXRpb24gdGFiLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnVmlzdWFsaXplckxpbmsnLCBbJ0xpbmsnLCBmdW5jdGlvbiAoTGluaykge1xuXHRcdGNsYXNzIFZpc3VhbGl6ZXJMaW5rIGV4dGVuZHMgTGluay5MaW5rIHtcblx0XHRcdC8qKlxuXHRcdFx0ICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtOb2RlfSAgc291cmNlTm9kZSAgVGhlIHNvdXJjZSBub2RlXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHRhcmdldE5vZGUgIFRoZSB0YXJnZXQgbm9kZVxuXHRcdFx0ICogQHBhcmFtICAgICAge251bWJlcn0gIHdlaWdodCAgICBUaGUgd2VpZ2h0IG9mIHRoZSBsaW5rXG5cdFx0XHQgKi9cblx0XHQgICAgY29uc3RydWN0b3Ioc291cmNlTm9kZSwgdGFyZ2V0Tm9kZSwgd2VpZ2h0KSB7XG5cdFx0ICAgICAgICBzdXBlcihzb3VyY2VOb2RlLCB0YXJnZXROb2RlKTtcblx0XHQgICAgICAgIHRoaXMud2VpZ2h0ID0gd2VpZ2h0O1xuXHRcdCAgICAgICAgLy9Db3VudCBpcyB1c2VkIHRvIGtlZXAgdHJhY2sgb2YgaG93IG1hbnlcblx0XHQgICAgICAgIC8vcGF0aHMgdG8gaXRzIHN1Ym5vZGVzIHRoZXJlIGFyZVxuXHRcdCAgICAgICAgLy9pbiBvcmRlciB0byBjYWxjdWxhdGUgYXZlcmFnZSB0cmFmZmljXG5cdFx0ICAgICAgICB0aGlzLmNvdW50ID0gMTtcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBJbmNyZWFzZXMgdGhlIGNvdW50IG9mIHRoZSBsaW5rXG5cdFx0ICAgICAqIFVTZWQgdG8ga2VlcCB0cmFjayBvZiBob3cgbWFueSBwYXRocyB0byBpdHMgc3Vibm9kZXNcblx0XHQgICAgICogdGhlcmUgYXJlIGluIG9yZGVyIHRvIGNhbGN1bGF0ZSBhdmVyYWdlIHRyYWZmaWNcblx0XHQgICAgICovXG5cdFx0ICAgIGluY3JlYXNlQ291bnQoKSB7XG5cdFx0ICAgICAgICB0aGlzLmNvdW50ICs9IDE7XG5cdFx0ICAgIH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogQ2FsY3VsYXRlcyB3aGVyZSB0byBwbGFjZSBxdGlwIGZvclxuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcmV0dXJuICAgICB7T2JqZWN0fSAgT2JqZWN0IHdpdGggcVRpcCBzZXR0aW5nc1xuXHRcdCAgICAgKi9cblx0XHQgICAgcXRpcEhlbHBlcigpIHtcblx0XHQgICAgXHR2YXIgcmV0O1xuXHRcdCAgICBcdHZhciBkID0gdGhpcztcblx0XHQgICAgXHR2YXIgZHggPSAoZC50YXJnZXQueCAtIGQuc291cmNlLngpIC8gMixcblx0XHQgICAgICAgICAgICBkeSA9IChkLnRhcmdldC55IC0gZC5zb3VyY2UueSkgLyAyO1xuXHRcdCAgICBcdGlmIChkLnNvdXJjZS54IDwgZC50YXJnZXQueCkge1xuXHQgICAgXHRcdFx0cmV0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbXk6ICd0b3AgY2VudGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0OiAnY2VudGVyIGNlbnRlcicsIC8vIGF0IHRoZSBib3R0b20gcmlnaHQgb2YuLi5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogW2R4LCBkeV0sXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGp1c3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFx0eTogMTBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXHRcdCAgICBcdH0gZWxzZSB7XG5cdCAgICBcdFx0XHRyZXQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBteTogJ2JvdHRvbSBjZW50ZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXQ6ICdjZW50ZXIgY2VudGVyJywgLy8gYXQgdGhlIGJvdHRvbSByaWdodCBvZi4uLlxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiBbZHgsIGR5XSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkanVzdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXHR5OiAtMTBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXHRcdCAgICBcdH1cblx0XHQgICAgXHRyZXR1cm4gcmV0O1xuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0XHQgKiBDYWxsZWQgd2hlbiBhIGxpbmsgaXMgYWRkZWQgdG8gdGhlIGdyYXBoXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgYWRkZWQgdG9cblx0XHRcdCAqL1xuXHRcdFx0aW5pdGlhbGl6ZShncmFwaCkge1xuXHRcdFx0XHRpZiAodGhpcy5pbml0aWFsaXplZCA9PSBmYWxzZSkge1xuXHRcdFx0XHRcdHN1cGVyLmluaXRpYWxpemUoZ3JhcGgpO1xuXHRcdFx0XHRcdHZhciBzdGF0ZSA9IGdyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXHRcdFx0XHRcdGlmIChzdGF0ZSA9PSBudWxsKSB7XG5cdFx0XHRcdFx0XHRzdGF0ZSA9IGdyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rID0ge307XG5cdFx0XHRcdFx0XHRzdGF0ZS5tYXhXZWlnaHQgPSBudWxsO1xuXHRcdFx0XHRcdFx0c3RhdGUudXNlQXZnV2VpZ2h0ID0gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0dGhpcy51cGRhdGVNYXhXZWlnaHQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFNldHMgd2hldGhlciB0aGUgZ3JhcGggc2hvdWxkIHVzZSBhdmcgd2VpZ2h0XG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge2Jvb2xlYW59ICB2YWwgICAgIFRoZSB2YWx1ZSB0byBzZXQgdG9cblx0XHRcdCAqL1xuXHRcdFx0c2V0VXNlQXZnV2VpZ2h0KHZhbCkge1xuXHRcdCAgICAgICAgdGhpcy5ncmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluay51c2VBdmdXZWlnaHQgPSAhIXZhbDtcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBTZXRzIHRoZSB3ZWlnaHQgb2YgdGhpcyBsaW5rXG5cdFx0ICAgICAqXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB3ZWlnaHQgIFRoZSB3ZWlnaHQgdG8gc2V0IHRvXG5cdFx0ICAgICAqL1xuXHRcdCAgICBzZXRXZWlnaHQod2VpZ2h0KSB7XG5cdFx0ICAgICAgICB0aGlzLndlaWdodCA9IHdlaWdodDtcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBHZXRzIHRoZSByYXcgd2VpZ2h0LlxuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcmV0dXJuICAgICB7bnVtYmVyfSAgVGhlIHJhdyB3ZWlnaHQuXG5cdFx0ICAgICAqL1xuXHRcdCAgICBnZXRSYXdXZWlnaHQoKSB7XG5cdFx0ICAgICAgICByZXR1cm4gdGhpcy53ZWlnaHQ7IFxuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIEdldHMgdGhlIHdlaWdodCB2YWx1ZSBvZiB0aGUgbGluaywgZGVwZW5kaW5nIG9uIHRoZVxuXHRcdCAgICAgKiB1c2VBdmdXZWlndGggc2V0dGluZ1xuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcmV0dXJuICAgICB7bnVtYmVyfSAgVGhlIHdlaWdodC5cblx0XHQgICAgICovXG5cdFx0ICAgIGdldFdlaWdodCgpIHtcblx0XHQgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuXHRcdCAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXG5cdFx0ICAgICAgICBpZiAoc3RhdGUudXNlQXZnV2VpZ2h0KSB7XG5cdFx0ICAgICAgICAgICAgdmFyIHdlaWdodCA9IHRoaXMud2VpZ2h0IC8gdGhpcy5jb3VudDtcblx0XHQgICAgICAgICAgICByZXR1cm4gd2VpZ2h0O1xuXHRcdCAgICAgICAgfVxuXHRcdCAgICAgICAgcmV0dXJuIHRoaXMud2VpZ2h0O1xuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIFVwZGF0ZXMgdGhlIG1heCB3ZWlnaHQgb2YgdGhlIGdyYXBoXG5cdFx0ICAgICAqL1xuXHRcdCAgICB1cGRhdGVNYXhXZWlnaHQgKCkge1xuXHRcdCAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG5cdFx0ICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuVmlzdWFsaXplckxpbms7XG5cblx0XHQgICAgICAgIHZhciBtYXhMaW5rID0gXy5tYXhCeSh0aGlzR3JhcGgubGlua3MsIGZ1bmN0aW9uKGwpIHtcblx0XHQgICAgICAgIFx0aWYgKGwuZ3JhcGggIT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIGwuZ2V0V2VpZ2h0KCk7XG5cdFx0ICAgICAgICBcdH1cblx0XHQgICAgICAgIFx0cmV0dXJuIDA7XG5cdFx0ICAgICAgICB9KTtcblx0XHQgICAgICAgIHN0YXRlLm1heFdlaWdodCA9IG1heExpbmsuZ2V0V2VpZ2h0KCk7XG5cdFx0ICAgIH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxsZWQgZHVyaW5nIHRoZSB1cGRhdGUgZ3JhcGggZm9yIGV4aXN0aW5nIGxpbmtzXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuXHRcdFx0ICogQHBhcmFtICAgICAge0xpbmt9ICBcdCAgIGQgICAgICAgTWF0Y2hpbmcgTGluayBPYmplY3QgICAgICAgXG5cdFx0XHQgKi9cblx0XHRcdHVwZGF0ZUF0dHIoZDNwYXRoLCBkKSB7XG5cdFx0ICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcblx0XHQgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluaztcblx0XHQgICAgICAgIHRoaXMudXBkYXRlTWF4V2VpZ2h0KCk7XG5cdCAgICAgICAgICAgIHZhciBjb2xvclNjYWxlID0gZDMuc2NhbGUubGluZWFyKClcblx0ICAgICAgICAgICAgICAgIC5kb21haW4oWzAsIHN0YXRlLm1heFdlaWdodF0pXG5cdCAgICAgICAgICAgICAgICAucmFuZ2UoW1wiI2ZmYjM2NlwiLCBcIiNGOTI2MDZcIl0pO1xuXHQgICAgICAgICAgICBzdGF0ZS5jb2xvclNjYWxlID0gY29sb3JTY2FsZTtcblx0XHRcdFx0ZDNwYXRoLnN0eWxlKCdtYXJrZXItZW5kJywgJ3VybCgjZW5kLWFycm93KScpXG5cdFx0ICAgICAgICAgICAgLmNsYXNzZWQodGhpc0dyYXBoLmNvbnN0cy5zZWxlY3RlZENsYXNzLCBmdW5jdGlvbihkKXtcblx0XHQgICAgICAgICAgICAgICAgcmV0dXJuIGQgPT09IHN0YXRlLnNlbGVjdGVkRWRnZTtcblx0XHQgICAgICAgICAgICB9KVxuXHRcdCAgICAgICAgICAgIC5hdHRyKFwiZFwiLCB0aGlzLmFycm93UGF0aC5jYWxsKGQpKVxuXHRcdCAgICAgICAgICAgIC50cmFuc2l0aW9uKFwiZXhpc3RpbmdQYXRoVHJhbnNpdGlvblwiKVxuXHRcdCAgICAgICAgICAgIC5kdXJhdGlvbig3NTApXG5cdFx0ICAgICAgICAgICAgLmF0dHIoXCJzdHJva2VcIiwgZnVuY3Rpb24oZCl7XG5cdFx0ICAgICAgICAgICAgICAgIHZhciBjID0gY29sb3JTY2FsZShkLmdldFdlaWdodCgpKTtcblx0XHQgICAgICAgICAgICAgICAgcmV0dXJuIGM7XG5cdFx0ICAgICAgICAgICAgfSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsbGVkIGR1cmluZyB0aGUgZmlyc3QgdXBkYXRlIGdyYXBoIGZvciB0aGlzIGxpbmtcblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM3BhdGggIFRoZSBkMyBwYXRoXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7TGlua30gIFx0ICAgZCAgICAgICBNYXRjaGluZyBMaW5rIE9iamVjdFxuXHRcdFx0ICovXG5cdFx0XHRuZXdQYXRoQXR0cihkM3BhdGgsIGQpIHtcblx0XHQgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuXHRcdCAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXHQgICAgICAgICAgICB0aGlzLnVwZGF0ZU1heFdlaWdodCgpO1xuXHQgICAgICAgICAgICB2YXIgY29sb3JTY2FsZSA9IGQzLnNjYWxlLmxpbmVhcigpXG5cdCAgICAgICAgICAgICAgICAuZG9tYWluKFswLCBzdGF0ZS5tYXhXZWlnaHRdKVxuXHQgICAgICAgICAgICAgICAgLnJhbmdlKFtcIiNmZmIzNjZcIiwgXCIjRjkyNjA2XCJdKTtcblx0ICAgICAgICAgICAgICAgIFxuXHRcdFx0XHRkM3BhdGgudHJhbnNpdGlvbihcIm5ld1BhdGhUcmFuc2l0aW9uXCIpXG5cdFx0ICAgICAgICAgICAgLmR1cmF0aW9uKDc1MClcblx0XHQgICAgICAgICAgICAuYXR0clR3ZWVuKFwib3BhY2l0eVwiLCBmdW5jdGlvbihkKSB7XG5cdFx0ICAgICAgICAgICAgICAgIHJldHVybiBkMy5pbnRlcnBvbGF0ZVN0cmluZygwLDEpO1xuXHRcdCAgICAgICAgICAgIH0pXG5cdFx0ICAgICAgICAgICAgLmF0dHIoXCJzdHJva2VcIiwgZnVuY3Rpb24oZCl7XG5cdFx0ICAgICAgICAgICAgICAgIHZhciBjID0gY29sb3JTY2FsZShkLmdldFdlaWdodCgpKTtcblx0XHQgICAgICAgICAgICAgICAgcmV0dXJuIGM7XG5cdFx0ICAgICAgICAgICAgfSlcblx0XHQgICAgICAgICAgICAuYXR0cignZCcsIHRoaXMuYXJyb3dQYXRoLmNhbGwoZCkpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB7XG5cdFx0XHRMaW5rIDogVmlzdWFsaXplckxpbmtcblx0XHR9XG59XSk7XG5cblxuXG5cblxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE5LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm1lbnUnLCBbXSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwIiwiLyoqXG4gKiBUaGUgYmFzZSBjbGFzcyBmb3Igbm9kZSBvYmplY3RzIGZvciB0aGUgZ3JhcGguXG4gKiBTdXBwb3J0cyBwb2xpY2llcy5cbiAqIFxuICogVG8gd3JpdGUgeW91ciBvd24gTm9kZSBvYmplY3QsIGNyZWF0ZSBhIG5ldyBmYWN0b3J5IHRoYXQgdXNlcyB0aGUgbm9kZVxuICogeW91IHdhbnQgdG8gaW5oZXJpdCBhcyBhIGRlcGVuZGVuY3ksIGFuZCBleHRlbmQgaXRzIG5vZGUgY2xhc3MuIFxuICogUmV0dXJuIHRoZSBjbGFzcyBvYmplY3Qgd2l0aCBOb2RlIGFzIGtleVxuICogXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdOb2RlJywgW2Z1bmN0aW9uICgpIHtcblx0XHRjbGFzcyBOb2RlIHtcblx0XHRcdC8qKlxuXHRcdFx0ICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB4ICAgICAgIHggbG9jYXRpb25cblx0XHRcdCAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB5ICAgICAgIHkgbG9jYXRpb25cblx0XHRcdCAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgdGV4dCAgICBUaGUgdGV4dCB0byBkaXNwbGF5XG5cdFx0XHQgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgcmFkaXVzICBUaGUgcmFkaXVzIG9mIHRoZSBub2RlXG5cdFx0XHQgKi9cblx0XHRcdGNvbnN0cnVjdG9yKHgsIHksIGlkLCB0ZXh0LCByYWRpdXMpIHtcblx0XHRcdFx0dGhpcy54ID0geDtcblx0XHRcdFx0dGhpcy55ID0geTtcblx0XHRcdFx0dGhpcy5yYWRpdXMgPSByYWRpdXM7XG5cdFx0XHRcdHRoaXMuaWQgPSBpZDtcblx0XHRcdFx0dGhpcy50ZXh0ID0gdGV4dDtcblx0XHRcdFx0dGhpcy5yYWRpdXMgPSByYWRpdXM7XG5cdFx0XHRcdHRoaXMuaGFzUG9saWN5ID0gZmFsc2U7XG5cdFx0XHRcdHRoaXMucG9saWN5ID0gbnVsbDtcblx0XHRcdFx0dGhpcy5ub2RlUG9saWNpZXMgPSBbXTtcblx0XHRcdFx0dGhpcy5ncmFwaCA9IG51bGw7XG5cdFx0XHRcdHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxsZWQgd2hlbiBhIG5vZGUgaXMgYWRkZWQgdG8gdGhlIGdyYXBoXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgYWRkZWQgdG9cblx0XHRcdCAqL1xuXHRcdFx0aW5pdGlhbGl6ZShncmFwaCkge1xuXHRcdFx0XHRpZiAodGhpcy5pbml0aWFsaXplZCA9PSBmYWxzZSkge1xuXHRcdFx0XHRcdHRoaXMuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuXHRcdFx0XHRcdHRoaXMuZ3JhcGggPSBncmFwaDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCBkdXJpbmcgdGhlIHVwZGF0ZSBncmFwaCBmb3IgZXhpc3RpbmcgbGlua3Ncblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG5cdFx0XHQgKi9cblx0XHRcdHVwZGF0ZUF0dHIoZDNub2RlLCBkKSB7XG5cdFx0XHRcdGQzbm9kZS5hdHRyKFwidHJhbnNmb3JtXCIsIGZ1bmN0aW9uKGQpe3JldHVybiBcInRyYW5zbGF0ZShcIiArIGQueCArIFwiLFwiICsgZC55ICsgXCIpXCI7fSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsbGVkIGR1cmluZyB0aGUgZmlyc3QgdXBkYXRlIGdyYXBoIGZvciBhIG5vZGVcblx0XHRcdCAqIEhvb2sgZm9yIHN1YiBjbGFzc2VzXG5cdFx0XHQgKiBcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgIGQgICAgICAgTWF0Y2hpbmcgTm9kZSBPYmplY3Rcblx0XHRcdCAqL1xuXHRcdFx0bmV3Tm9kZUF0dHIoZDNub2RlLCBkKSB7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogU2V0cyB0aGUgcmFkaXVzIG9mIHRoZSBub2RlLlxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICByYWRpdXMgIFRoZSByYWRpdXNcblx0XHRcdCAqL1xuXHRcdFx0c2V0UmFkaXVzKHJhZGl1cykge1xuXHRcdFx0XHR0aGlzLnJhZGl1cyA9IHJhZGl1cztcblx0XHRcdH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogVXNlZCB0byBpbnN0YWxsIHBvbGljaWVzIHRoYXQgYXJlIGNhbGxlZCB3aGVuIHRoaXNcblx0XHQgICAgICogbm9kZSBoYXMgYSBtb3VzZSBldmVudFxuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7UG9saWN5fSAgcG9saWN5ICBUaGUgcG9saWN5IHRvIGluc3RhbGxcblx0XHQgICAgICovXG5cdFx0XHRpbnN0YWxsTm9kZVBvbGljeShwb2xpY3kpIHtcblx0XHRcdFx0dGhpcy5oYXNQb2xpY3kgPSB0cnVlO1xuXHRcdFx0XHR0aGlzLm5vZGVQb2xpY2llcy5wdXNoKHBvbGljeSk7XG5cdFx0XHRcdHBvbGljeS5pbml0aWFsaXplKHRoaXMuZ3JhcGgpO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFVzZWQgdG8gdW5pbnN0YWxsIHBvbGljeSBmb3IgdGhpcyBub2RlXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge1BvbGljeXxzdHJpbmd9ICBwb2xpY3lSZW1vdmUgIFRoZSBwb2xpY3kgdG8gcmVtb3ZlXG5cdFx0XHQgKi9cdFx0XHRcblx0XHRcdHVuaW5zdGFsbE5vZGVQb2xpY3kocG9saWN5UmVtb3ZlKSB7XG5cdFx0XHRcdHZhciBwb2xpY3lSZW1vdmVOYW1lO1xuXHRcdFx0XHR2YXIgdGhpc05vZGUgPSB0aGlzO1xuXHRcdFx0XHRpZiAodHlwZW9mIHBvbGljeVJlbW92ZSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHRwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmUucG9saWN5TmFtZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRfKHRoaXNOb2RlLm5vZGVQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3ksIGluZGV4KSB7XG5cdFx0XHRcdFx0aWYgKHBvbGljeS5wb2xpY3lOYW1lID09PSBwb2xpY3lSZW1vdmVOYW1lKSB7XG5cdFx0XHRcdFx0XHRwb2xpY3kuZGVzdHJveSgpO1xuXHRcdFx0XHRcdFx0dGhpc05vZGUubm9kZVBvbGljaWVzLnNwbGljZShpbmRleCwgMSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdFx0aWYgKHRoaXNOb2RlLm5vZGVQb2xpY2llcy5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0XHR0aGlzTm9kZS5oYXNQb2xpY3kgPSBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCB3aGVuIHRoZXJlIGlzIGEgbW91c2UgZXZlbnQgZm9yIHRoaXMgbm9kZVxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBldmVudCAgICAgVGhlIG1vdXNlIGV2ZW50XG5cdFx0XHQgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgZCAgICAgICAgIFRoZSBtYXRjaGluZyBub2RlIG9iamVjdFxuXHRcdFx0ICovXG5cdFx0XHRub2RlUG9saWN5RXZlbnQoZXZlbnQsIGQzbm9kZSwgZCkge1xuXHRcdFx0XHRfLmZvckVhY2godGhpcy5ub2RlUG9saWNpZXMsIGZ1bmN0aW9uKHBvbGljeSkge1xuXHRcdFx0XHRcdHBvbGljeVtldmVudF0oZDNub2RlLCBkKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB7XG5cdFx0XHROb2RlOiBOb2RlXG5cdFx0fVxufV0pO1xuXG5cblxuXG5cblxuXG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3BvbGljaWVzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbmV0d29ya3BvbGljaWVzJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuaXNvbGF0aW9uJywge1xuICAgICAgICAgICAgdXJsOiAnL2lzb2xhdGlvbicsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPHVpLXZpZXcvPidcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbi5jcmVhdGUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2lzb2xhdGlvbnBvbGljeWNyZWF0ZSdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbi5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdpc29sYXRpb25wb2xpY3lkZXRhaWxzJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuaXNvbGF0aW9uLmVkaXQnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZWRpdC86a2V5JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2lzb2xhdGlvbnBvbGljeWRldGFpbHMnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGgnLCB7XG4gICAgICAgICAgICB1cmw6ICcvYmFuZHdpZHRoJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8dWktdmlldy8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuYmFuZHdpZHRoLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnYmFuZHdpZHRocG9saWN5Y3JlYXRlJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuYmFuZHdpZHRoLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2JhbmR3aWR0aHBvbGljeWRldGFpbHMnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGguZWRpdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9lZGl0LzprZXknLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnYmFuZHdpZHRocG9saWN5ZGV0YWlscydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLnJlZGlyZWN0aW9uJywge1xuICAgICAgICAgICAgdXJsOiAnL3JlZGlyZWN0aW9uJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8dWktdmlldy8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIHBhcmFtczogeyBwb2xpY3lUYWI6IG51bGwgfSxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ25ldHdvcmtwb2xpY2llc3RhYnMnXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIFRoZSBub2RlIHRoYXQgaXMgdXNlZCBzcGVjaWZpY2FsbHkgZm9yIHRoZSB2aXN1YWxpemF0aW9uIHRhYi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ1Zpc3VhbGl6ZXJOb2RlJywgWydOb2RlJywgZnVuY3Rpb24gKE5vZGUpIHtcblx0XHRjbGFzcyBWaXN1YWxpemVyTm9kZSBleHRlbmRzIE5vZGUuTm9kZSB7XG5cdFx0XHQvKipcblx0XHRcdCAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeCAgICAgICBcdHggbG9jYXRpb25cblx0XHRcdCAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB5ICAgICAgIFx0eSBsb2NhdGlvblxuXHRcdFx0ICogQHBhcmFtICAgICAge3N0cmluZ30gIGlkICAgICAgXHRUaGUgaWRlbnRpZmllclxuXHRcdFx0ICogQHBhcmFtICAgICAge3N0cmluZ30gIHRleHQgICAgXHRUaGUgdGV4dCB0byBkaXNwbGF5XG5cdFx0XHQgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgcmFkaXVzICBcdFRoZSByYWRpdXMgb2YgdGhlIG5vZGVcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBwYXJlbnQgICAgIFRoZSBwYXJlbnQgaWRcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBhbmNlc3RvcnMgIEFycmF5IG9mIGFuY2VzdG9ycyBJZFxuXHRcdFx0ICogQHBhcmFtICAgICAge251bWJlcn0gIHhTdGFydCAgICAgeCBsb2MgdG8gc3RhcnQgYW5pbWF0aW9uXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeVN0YXJ0ICAgICB5IGxvYyB0byBzdGFydCBhbmltYXRpb25cblx0XHRcdCAqL1xuXHRcdCAgICBjb25zdHJ1Y3Rvcih4LCB5LCBpZCwgdGV4dCwgcmFkaXVzLCBwYXJlbnQsIGFuY2VzdG9ycywgXG5cdFx0ICAgIFx0eFN0YXJ0LCB5U3RhcnQpIHtcblx0XHQgICAgICAgIHN1cGVyKHgsIHksIGlkLCB0ZXh0LCByYWRpdXMpO1xuXHRcdCAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG5cdFx0ICAgICAgICB0aGlzLmFuY2VzdG9ycyA9IGFuY2VzdG9ycztcblx0XHQgICAgICAgIGlmICh4U3RhcnQgPT0gbnVsbCkge1xuXHRcdCAgICAgICAgXHR0aGlzLnhTdGFydCA9IHg7XG5cdFx0ICAgICAgICB9IGVsc2Uge1xuXHRcdCAgICAgICAgXHR0aGlzLnhTdGFydCA9IHhTdGFydDtcblx0XHQgICAgICAgIH1cblx0XHQgICAgICAgIGlmICh5U3RhcnQgPT0gbnVsbCkge1xuXHRcdCAgICAgICAgXHR0aGlzLnlTdGFydCA9IHk7XG5cdFx0ICAgICAgICB9IGVsc2Uge1xuXHRcdCAgICAgICAgXHR0aGlzLnlTdGFydCA9IHlTdGFydDtcblx0XHQgICAgICAgIH1cblx0XHQgICAgfVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCBkdXJpbmcgdGhlIGZpcnN0IHVwZGF0ZSBncmFwaCBmb3IgYSBub2RlXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuXHRcdFx0ICogQHBhcmFtICAgICAge05vZGV9ICAgIGQgICAgICAgICBUaGUgbWF0Y2hpbmcgTm9kZVxuXHRcdFx0ICovXG5cdFx0XHRuZXdOb2RlQXR0cihkM25vZGUsIGQpIHtcblx0XHRcdFx0dmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG5cdFx0XHRcdGlmICh0aGlzR3JhcGguY29uc3RzLmNvbnRhaW5lckNsYXNzICE9IG51bGwgJiZcblx0XHRcdFx0XHRcdHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFtkLmlkXSA9PSBudWxsKSB7XG5cdFx0XHRcdFx0ZDNub2RlLmNsYXNzZWQodGhpc0dyYXBoLmNvbnN0cy5jb250YWluZXJDbGFzcywgdHJ1ZSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0ZDNub2RlLnRyYW5zaXRpb24oXCJub2RlUG9zaXRpb25UcmFuc2l0aW9uXCIpXG5cdFx0ICAgICAgICAgICAgICAgIC5kdXJhdGlvbig3NTApXG5cdFx0ICAgICAgICAgICAgICAgIC5hdHRyVHdlZW4oXCJ0cmFuc2Zvcm1cIiwgZnVuY3Rpb24oZCkge1xuXHRcdCAgICAgICAgICAgICAgICAgICAgaWYgKGQueFN0YXJ0ICE9IG51bGwgJiYgZC55U3RhcnQgIT0gbnVsbCkge1xuXHRcdCAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4U3RhcnQgPSBkLnhTdGFydDtcblx0XHQgICAgICAgICAgICAgICAgICAgICAgICB2YXIgeVN0YXJ0ID0gZC55U3RhcnQ7XG5cdFx0ICAgICAgICAgICAgICAgICAgICAgICAgZC54U3RhcnQgPSBkLng7XG5cdFx0ICAgICAgICAgICAgICAgICAgICAgICAgZC55U3RhcnQgPSBkLnk7XG5cdFx0ICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQzLmludGVycG9sYXRlU3RyaW5nKFwidHJhbnNsYXRlKFwiICsgeFN0YXJ0ICsgXCIsXCIgKyB5U3RhcnQgKyBcIilcIiwgXCJ0cmFuc2xhdGUoXCIgKyBkLnggKyBcIixcIiArIGQueSArIFwiKVwiKTtcblx0XHQgICAgICAgICAgICAgICAgICAgIH1cblx0XHQgICAgICAgICAgICAgICAgICAgIHJldHVybiBkMy5pbnRlcnBvbGF0ZVN0cmluZyhcInRyYW5zbGF0ZShcIiArIGQueCArIFwiLFwiICsgZC55ICsgXCIpXCIsIFwidHJhbnNsYXRlKFwiICsgZC54ICsgXCIsXCIgKyBkLnkgKyBcIilcIik7XG5cdFx0ICAgICAgICAgICAgICAgIH0pO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB7XG5cdFx0XHROb2RlOiBWaXN1YWxpemVyTm9kZVxuXHRcdH1cblxufV0pO1xuXG5cblxuXG5cblxuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtzJywge1xuICAgICAgICAgICAgdXJsOiAnL25ldHdvcmtzJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3Jrcy5saXN0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnbmV0d29ya0xpc3QnXG4gICAgICAgIH0pLlxuICAgICAgICAgICAgc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ25ldHdvcmtkZXRhaWxzJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3Jrcy5jcmVhdGUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ25ldHdvcmtjcmVhdGUnXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIFRoaXMgcG9saWN5IGlzIHVzZWQgdG8gYWRkIGEgc2VsZWN0IG5vZGUgZmVhdHVyZS5cbiAqIFN1cHBvcnRzIHNlbGVjdGluZyBtdWx0aXBsZSBub2RlcyBieSB1c2luZyB0aGUgY3RybCBrZXkuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdOb2RlU2VsZWN0aW9uUG9saWN5JywgWydQb2xpY3knLCBmdW5jdGlvbiAoUG9saWN5KSB7XG5cbiAgICBcdGNsYXNzIE5vZGVTZWxlY3Rpb25Qb2xpY3kgZXh0ZW5kcyBQb2xpY3kuUG9saWN5IHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgICAgICBzdXBlcihcIk5vZGVTZWxlY3Rpb25Qb2xpY3lcIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gcG9saWN5IGlzIGluc3RhbGxlZFxuICAgICAgICAgICAgICogT3ZlcndyaXRlcyB0aGUgb24gZHJhZyBldmVudCBvZiB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgXG4gICAgXHRcdCAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFsbGVkIG9uXG4gICAgXHRcdCAqL1xuICAgICAgICAgICAgaW5pdGlhbGl6ZShncmFwaCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3VwZXIuaW5pdGlhbGl6ZShncmFwaCk7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLnNlbGVjdGVkTm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgY29uc3RzID0gZ3JhcGguY29uc3RzLk5vZGVTZWxlY3Rpb25Qb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICBjb25zdHMuc2VsZWN0ZWRDbGFzcyA9IFwic2VsZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAvL292ZXJ3cml0dGluZyBncmFwaCdzIG5vZGUgb24gZHJhZyBldmVudCB0byBzdXBwb3J0XG4gICAgICAgICAgICAgICAgLy9tb3ZpbmcgbXVsdGlwbGUgbm9kZXMgYXQgb25jZVxuICAgICAgICAgICAgICAgIHZhciBkcmFnID0gZ3JhcGguZHJhZztcbiAgICAgICAgICAgICAgICBkcmFnLm9uKCdkcmFnJywgZnVuY3Rpb24oYXJncykge1xuICAgICAgICAgICAgICAgIFx0dmFyIHRoaXNHcmFwaCA9IGdyYXBoO1xuICAgICAgICAgICAgICAgIFx0aWYgKHRoaXNHcmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgXHRcdHZhciBzZWxlY3RlZENsYXNzID0gdGhpc0dyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5LnNlbGVjdGVkQ2xhc3M7XG4gICAgICAgICAgICAgICAgXHRcdHZhciBzZWxlY3Rpb24gPSBkMy5zZWxlY3RBbGwoICcuJyArc2VsZWN0ZWRDbGFzcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBzZWxlY3Rpb25bMF0uaW5kZXhPZiggdGhpcyk9PS0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uLmNsYXNzZWQoc2VsZWN0ZWRDbGFzcywgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGlvbiA9IGQzLnNlbGVjdCggdGhpcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uLmNsYXNzZWQoc2VsZWN0ZWRDbGFzcywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IFxuXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb24uYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbiggZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCArPSBkMy5ldmVudC5keDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gZDMuZXZlbnQuZHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwidHJhbnNsYXRlKFwiICsgWyBkLngsZC55IF0gKyBcIilcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgICAgICBcdH1cblxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQWRkcyB0aGUgZ2l2ZW4gbm9kZSB0byB0aGUgYXJyYXkgb2Ygc2VsZWN0ZWQgbm9kZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM05vZGUgICAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgIG5vZGVEYXRhICBNYXRjaGluZyBOb2RlIG9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBhZGRTZWxlY3ROb2RlKGQzTm9kZSwgbm9kZURhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgZDNOb2RlLmNsYXNzZWQoY29uc3RzLnNlbGVjdGVkQ2xhc3MsIHRydWUpO1xuICAgICAgICAgICAgICAgIHN0YXRlLnNlbGVjdGVkTm9kZXMucHVzaChub2RlRGF0YSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyB0aGUgZ2l2ZW4gbm9kZSBmcm9tIHRoZSBhcnJheSBvZiBzZWxlY3RlZCBub2Rlcy5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM05vZGUgICAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgIG5vZGVEYXRhICBNYXRjaGluZyBub2RlIG9iamVjdCBcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgcmVtb3ZlU2VsZWN0RnJvbU5vZGUoZDNOb2RlLCBub2RlRGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzLk5vZGVTZWxlY3Rpb25Qb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5maWx0ZXIoZnVuY3Rpb24oY2QpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNkLmlkID09PSBub2RlRGF0YS5pZDtcbiAgICAgICAgICAgICAgICB9KS5jbGFzc2VkKGNvbnN0cy5zZWxlY3RlZENsYXNzLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gc3RhdGUuc2VsZWN0ZWROb2Rlcy5pbmRleE9mKG5vZGVEYXRhKTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zZWxlY3RlZE5vZGVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyBhbGwgc2VsZWN0ZWQgbm9kZXMuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHJlbW92ZUFsbFNlbGVjdGVkTm9kZXMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmNsYXNzZWQoY29uc3RzLnNlbGVjdGVkQ2xhc3MsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zZWxlY3RlZE5vZGVzID0gW107XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogT24gTW91c2Vkb3duLCBkZXRlcm1pbmVzIHdoZXRoZXIgdG8gY2hhbmdlIHRoZVxuICAgICAgICAgICAgICogc2VsZWN0ZWQgc3RhdHVzIG9mIHRoZSBjbGlja2VkIG5vZGUuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgZCAgICAgICBNYXRjaGluZyBOb2RlIE9iamVjdCAgICAgICBcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgbW91c2Vkb3duKGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuICAgICAgICAgICAgICAgIGQzLmV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIGlmIChkMy5ldmVudC5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5zZWxlY3RlZE5vZGVzLmluZGV4T2YoZCkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVTZWxlY3RGcm9tTm9kZShkM25vZGUsIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRTZWxlY3ROb2RlKGQzbm9kZSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHN0YXRlLnNlbGVjdGVkTm9kZXMuaW5kZXhPZihkKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIG5vIGNvbnRyb2wga2V5LCBhbmQgY2xpY2tlZCBub3Qgc2VsZWN0ZWQgbm9kZSxcbiAgICAgICAgICAgICAgICAgICAgLy9yZW1vdmUgYWxsIG9mIGN1cnJlbnQgc2VsZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQWxsU2VsZWN0ZWROb2RlcygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBPbiBNb3VzZXVwLCBkZXRlcm1pbmVzIHdoZXRoZXIgdG8gY2hhbmdlIHRoZVxuICAgICAgICAgICAgICogc2VsZWN0ZWQgc3RhdHVzIG9mIHRoZSBjbGlja2VkIG5vZGUuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgZCAgICAgICBNYXRjaGluZyBOb2RlIE9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBtb3VzZXVwKGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuICAgICAgICAgICAgICAgIGlmICghZDMuZXZlbnQuY3RybEtleSkge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIGxlbmd0aCBpcyBncmVhdGVyIHRoYW4gMSwgdGhlbiB3ZSBhcmUgbW92aW5nIG11bHRpcGxlIG5vZGVzXG4gICAgICAgICAgICAgICAgICAgIC8vbGVhdmUgdGhlbSBhbGwgaGlnaGxpZ2h0ZWRcbiAgICAgICAgICAgICAgICAgICAgLy9vdGhlcndpc2Ugd2UgYXJlIGp1c3QgbW92aW5nIG9uZSBub2RlLCBzbyB1bmhpZ2hsaWdodFxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuc2VsZWN0ZWROb2Rlcy5sZW5ndGggPD0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVTZWxlY3RGcm9tTm9kZShkM25vZGUsIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBQb2xpY3k6IE5vZGVTZWxlY3Rpb25Qb2xpY3lcbiAgICAgICAgfVxufV0pO1xuXG5cblxuXG5cblxuXG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzJywge1xuICAgICAgICAgICAgdXJsOiAnL25vZGVzJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwIiwiLyoqXG4gKiBUaGlzIHBvbGljeSBjaGFuZ2VzIHRoZSB2aWV3IHRvIHRoZSB0aW1lZ3JhcGggb2YgbGluayBkYXRhIG9uIGNsaWNrLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnUGF0aENoYW5nZVZpZXdQb2xpY3knLCBbJ1BvbGljeScsIGZ1bmN0aW9uIChQb2xpY3kpIHtcbiAgICBcdGNsYXNzIFBhdGhDaGFuZ2VWaWV3UG9saWN5IGV4dGVuZHMgUG9saWN5LlBvbGljeSB7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB0byBidWlsZCBwb2xpY3lcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICB7QW5ndWxhciBTdGF0ZX0gICAgJHN0YXRlICAgIFVzZWQgdG8gY2hhbmdlIHZpZXdcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgY29uc3RydWN0b3IoJHN0YXRlKSB7XG4gICAgICAgICAgICAgICAgc3VwZXIoJ1BhdGhDaGFuZ2VWaWV3UG9saWN5Jyk7XG4gICAgICAgICAgICAgICAgdGhpcy4kc3RhdGUgPSAkc3RhdGU7XG4gICAgICAgICAgICB9XG5cblxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEdlbmVyYXRlcyBhIGxpc3Qgb2YgYWxsIGNoaWxkIGNvbnRhaW5lcnMgb2YgdGhlIHNlcnZpY2VcbiAgICAgICAgICAgICAqIENhbiBoYW5kbGUgbmVzdGVkIHNlcnZpY2VzLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBpZCAgICAgIE5vZGUgSURcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZ2VuZXJhdGVMaXN0KGlkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciByZXRMaXN0ID0gW107XG4gICAgICAgICAgICAgICAgdmFyIGdlbmVyYXRlTGlzdEhlbHBlciA9IGZ1bmN0aW9uKGlkLCByZXRMaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlSWRzID0gdGhpc1BvbGljeS5ncmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFtpZF07XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZUlkcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkSWQgPSBub2RlSWRzW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNQb2xpY3kuZ3JhcGguZGF0YVNvdXJjZS5oYXNDaGlsZChjaGlsZElkKSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJSZXRMaXN0ID0gZ2VuZXJhdGVMaXN0SGVscGVyKGNoaWxkSWQsIHJldExpc3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldExpc3QuY29uY2F0KHN1YlJldExpc3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXRMaXN0LnB1c2goY2hpbGRJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZ2VuZXJhdGVMaXN0SGVscGVyKGlkLCByZXRMaXN0KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmV0TGlzdFxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVzZWQgdG8gcmVyb3V0ZSBhbiBlZGdlIHdoZW4gY2xpY2tlZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtMaW5rfSAgZWRnZSAgICBUaGUgY2xpY2tlZCBlZGdlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHZpZXdFZGdlKGVkZ2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgc291cmNlTGlzdCA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciB0YXJnZXRMaXN0ID0gW107XG4gICAgICAgICAgICAgICAgdmFyIHNvdXJjZUlkID0gZWRnZS5zb3VyY2UuaWQ7XG4gICAgICAgICAgICAgICAgdmFyIHRhcmdldElkID0gZWRnZS50YXJnZXQuaWQ7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ncmFwaC5kYXRhU291cmNlLmhhc0NoaWxkKHNvdXJjZUlkKSA9PT0gdHJ1ZSkgey8vTm90IGEgY29udGFpbmVyIG5vZGUsIG5lZWQgdG8gYWdncmVnYXRlXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZUxpc3QgPSB0aGlzLmdlbmVyYXRlTGlzdChzb3VyY2VJZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlTGlzdCA9IFtzb3VyY2VJZF07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZ3JhcGguZGF0YVNvdXJjZS5oYXNDaGlsZCh0YXJnZXRJZCkgPT09IHRydWUpIHsvL05vdCBhIGNvbnRhaW5lciBub2RlLCBuZWVkIHRvIGFnZ3JlZ2F0ZVxuICAgICAgICAgICAgICAgICAgICB0YXJnZXRMaXN0ID0gdGhpcy5nZW5lcmF0ZUxpc3QodGFyZ2V0SWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldExpc3QgPSBbdGFyZ2V0SWRdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLiRzdGF0ZS5nbygnY29udGl2Lm1lbnUudmlzdWFsaXphdGlvbi5lZGdlJywgXG4gICAgICAgICAgICAgICAgICAgIHtzb3VyY2VOYW1lOiBzb3VyY2VJZCwgdGFyZ2V0TmFtZTogdGFyZ2V0SWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VMaXN0OiBzb3VyY2VMaXN0LCB0YXJnZXRMaXN0OiB0YXJnZXRMaXN0fSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG1vdXNlZG93bihkM3BhdGgsIGQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdFZGdlKGQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIFBvbGljeTogUGF0aENoYW5nZVZpZXdQb2xpY3lcbiAgICAgICAgfVxufV0pO1xuXG5cblxuXG5cblxuXG5cblxuXG5cbiIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYub3JnYW5pemF0aW9ucycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvb3JnYW5pemF0aW9ucycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5saXN0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnb3JnYW5pemF0aW9ubGlzdCdcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIi8qKlxuICogQmFzZSBwb2xpY3kgY2xhc3MgZm9yIHRoZSBncmFwaCBvYmplY3RcbiAqIFxuICogUG9saWNpZXMgYXJlIHVzZWQgdG8gaXNvbGF0ZSBmZWF0dXJlcyBmb3IgYSBncmFwaC5cbiAqIFBvbGljaWVzIGNhbiBiZSBpbnN0YWxsZWQgb24gbm9kZXMsIGxpbmtzLCBvciB0aGUgZ3JhcGguXG4gKiBFYWNoIHBvbGljeSBoYXMgaW50ZXJhY3Rpb24gaGFuZGxlcnMgdGhhdCB3aWxsIGJlIGNhbGxlZCBieSB0aGUgZ3JhcGhcbiAqIGlmIGluc3RhbGxlZC4gUG9saWNpZXMgY2FuIGFsc28gbW9kaWZ5IGdyYXBoIGZ1bmN0aW9ucyAoc2VlIFFUaXBQb2xpY3kpLlxuICogTXVsdGlwbGUgcG9saWNpZXMgY2FuIGJlIGluc3RhbGxlZCBmb3IgYSBub2RlIG9yIGxpbmsuIFxuICogXG4gKiBUbyB3cml0ZSB5b3VyIG93biBwb2xpY3ksIGNyZWF0ZSBhIG5ldyBmYWN0b3J5IHRoYXQgdXNlcyB0aGUgcG9saWN5XG4gKiB5b3Ugd2FudCB0byBpbmhlcml0IGFzIGEgZGVwZW5kZW5jeSwgYW5kIGV4dGVuZCBpdHMgcG9saWN5LiBcbiAqIFJldHVybiB0aGUgY2xhc3Mgb2JqZWN0IHdpdGggUG9saWN5IGFzIGtleSwgYW5kIFxuICogYWRkIHRoZSBwb2xpY3kgdG8gdGhlIFBvbGljeVNlcnZpY2UgZmFjdG9yeS5cbiAqIFxuICogRm9yIHNhdmluZyBzdGF0ZSBvciBjb25zdHMgZm9yIHRoZSBwb2xpY3ksIGNyZWF0ZSBhIG5hbWVzcGFjZVxuICogaW4gZ3JhcGguc3RhdGUgYW5kIGdyYXBoLmNvbnN0cy5cbiAqIEV4LiBcbiAqICAgICAgZ3JhcGguc3RhdGUubXlQb2xpY3kgPSB7fTtcbiAqICAgICAgZ3JhcGguY29uc3RzLm15UG9saWN5ID0ge307XG4gKiAgICAgIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnUG9saWN5JywgW2Z1bmN0aW9uICgpIHtcbiAgICAgICAgY2xhc3MgUG9saWN5IHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBwb2xpY3lOYW1lICBUaGUgcG9saWN5IG5hbWVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgY29uc3RydWN0b3IocG9saWN5TmFtZSkge1xuICAgICAgICAgICAgICAgIHRoaXMucG9saWN5TmFtZSA9IHBvbGljeU5hbWU7XG4gICAgICAgICAgICAgICAgdGhpcy5ncmFwaCA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplZCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBwb2xpY3kgaXMgaW5zdGFsbGVkLlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gIHtHcmFwaH0gIGdyYXBoICAgVGhlIEdyYXBoIHRoYXQgdGhlIHBvbGljeSBpc1xuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgIGJlaW5nIGluc3RhbGxlZCBvblxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbml0aWFsaXplKGdyYXBoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOyBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5ncmFwaCA9IGdyYXBoO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEhhbmRsZXIsIG1lYW50IHRvIGJlIG92ZXJyaWRkZW4gaW4gc3ViY2xhc3Nlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAge2QzIG9iamVjdH0gICAgZDNvYmogICAgVGhlIGQzb2JqZWN0XG4gICAgICAgICAgICAgKiBAcGFyYW0gIHtOb2RlL0xpbmsvR3JhcGh9ICBkICAgVGhlIG9iamVjdCBpdCB3YXNcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YWxsZWQgZm9yLiAgICBcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgbW91c2VvdmVyIChkM29iaiwgZCkge31cbiAgICAgICAgICAgIGRibGNsaWNrKGQzb2JqLCBkKSB7fVxuICAgICAgICAgICAgY29udGV4dG1lbnUoZDNvYmosIGQpIHt9XG4gICAgICAgICAgICBtb3VzZW91dChkM29iaiwgZCkge31cbiAgICAgICAgICAgIG1vdXNlZG93bihkM29iaiwgZCkge31cbiAgICAgICAgICAgIG1vdXNldXAoZDNvYmosIGQpIHt9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2lsbCBiZSBjYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgYmVpbmcgZGVzdHJveWVkLlxuICAgICAgICAgICAgICogVXNlZCB0byByZW1vdmUgYW55IGVsZW1lbnRzIG9yIGJpbmRpbmdzIHRoZSBwb2xpY3lcbiAgICAgICAgICAgICAqIGhhcyBhZGRlZC5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZGVzdHJveSgpIHt9XG4gICAgICAgIH1cbiAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBQb2xpY3k6IFBvbGljeVxuICAgICAgICB9XG59XSk7XG5cblxuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zZXJ2aWNlbGJzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzJywge1xuICAgICAgICAgICAgdXJsOiAnL3NlcnZpY2VsYnMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ3NlcnZpY2VsYkxpc3QnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMuY3JlYXRlJywge1xuICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdzZXJ2aWNlbGJDcmVhdGUnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnc2VydmljZWxiRGV0YWlscydcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIi8qKlxuICogQ29udGFpbnMgYWxsIHRoZSBwb2xpY2llcy5cbiAqIFNlZSBwb2xpY3kuanMgZm9yIGluZm8gb24gaG93IHBvbGljaWVzIHdvcmsuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdQb2xpY3lTZXJ2aWNlJywgWydQb2xpY3knLCdRVGlwUG9saWN5JywgJ1BhdGhDaGFuZ2VWaWV3UG9saWN5JywgXG4gICAgICAgICdOb2RlU2VsZWN0aW9uUG9saWN5JywgJ1NwbGl0Sm9pbk5vZGVQb2xpY3knLCAnU3BsaXRKb2luVmlld1BvbGljeScsXG4gICAgICAgICdTYXZlU3RhdGVQb2xpY3knLFxuICAgICAgICAgICAgZnVuY3Rpb24gKFBvbGljeSwgUVRpcFBvbGljeSwgUGF0aENoYW5nZVZpZXdQb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgICAgICBOb2RlU2VsZWN0aW9uUG9saWN5LCAgU3BsaXRKb2luTm9kZVBvbGljeSwgXG4gICAgICAgICAgICAgICAgICAgICAgICBTcGxpdEpvaW5WaWV3UG9saWN5LCBTYXZlU3RhdGVQb2xpY3kpIHtcblxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIFBvbGljeTogUG9saWN5LlBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgUVRpcFBvbGljeTogUVRpcFBvbGljeS5Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIFBhdGhDaGFuZ2VWaWV3UG9saWN5OiBQYXRoQ2hhbmdlVmlld1BvbGljeS5Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIE5vZGVTZWxlY3Rpb25Qb2xpY3k6IE5vZGVTZWxlY3Rpb25Qb2xpY3kuUG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBTcGxpdEpvaW5Ob2RlUG9saWN5OiBTcGxpdEpvaW5Ob2RlUG9saWN5LlBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgU3BsaXRKb2luVmlld1BvbGljeTogU3BsaXRKb2luVmlld1BvbGljeS5Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIFNhdmVTdGF0ZVBvbGljeTogU2F2ZVN0YXRlUG9saWN5LlBvbGljeVxuICAgICAgICAgICAgICAgIH1cbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2LnNldHRpbmdzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncycsIHtcbiAgICAgICAgICAgIHVybDogJy9nbG9iYWwnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvc2V0dGluZ3MnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXR0aW5ncy9zZXR0aW5nc21lbnUuaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5sb2dzJywge1xuICAgICAgICAgICAgdXJsOiAnL2xvZ3MnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJycsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5hdXRoJywge1xuICAgICAgICAgICAgdXJsOiAnL2F1dGgnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJycsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5saWNlbnNlJywge1xuICAgICAgICAgICAgdXJsOiAnL2xpY2Vuc2UnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJycsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5wb2xpY2llcycsIHtcbiAgICAgICAgICAgIHVybDogJy9wb2xpY2llcycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLm5ldHdvcmtzJywge1xuICAgICAgICAgICAgdXJsOiAnL25ldHdvcmtzJyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ25ldHdvcmtzZXR0aW5nJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLnZvbHVtZXMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvdm9sdW1lcycsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICd2b2x1bWVzZXR0aW5nJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLmNsdXN0ZXInLCB7XG4gICAgICAgICAgICB1cmw6ICcvY2x1c3RlcicsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdjbHVzdGVyc2V0dGluZ3MnXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIFRoaXMgcG9saWN5IGFkZHMgdG9vbHRpcCBmdW5jdGlvbmFsaXR5IHRvIG5vZGVzIGFuZCBsaW5rcy5cbiAqIFdoZW4gaW5zdGFsbGluZywgaW5zdGFsbCBvbiBib3RoIGxpbmtzIGFuZCBub2Rlcy5cbiAqIFxuICogVXNlcyB0aGUgcVRpcCBqUXVlcnkgcGx1Z2luXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdRVGlwUG9saWN5JywgWydQb2xpY3knLCBmdW5jdGlvbiAoUG9saWN5KSB7XG4gICAgICAgIGNsYXNzIFFUaXBQb2xpY3kgZXh0ZW5kcyBQb2xpY3kuUG9saWN5IHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgICAgICBzdXBlcihcIlFUaXBQb2xpY3lcIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICAgICAqIE1vZGlmaWVzIHRoZSB1cGRhdGVOZXdOb2RlcyBhbmQgXG4gICAgICAgICAgICAgKiB1cGRhdGVOZXdQYXRocyBtZXRob2Qgb2YgdGhlIGdyYXBoIHRvIGluc3RhbGwgcXRpcFxuICAgICAgICAgICAgICogb250byBlYWNoIG5vZGUgYW5kIHBhdGguXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbGxlZCBvblxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbml0aWFsaXplKGdyYXBoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdXBlci5pbml0aWFsaXplKGdyYXBoKTtcblxuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBncmFwaC5zdGF0ZS5RVGlwUG9saWN5ID0ge307XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS5tb3VzZWRvd24gPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIGdyYXBoLmNvbnN0cy5RVGlwUG9saWN5ID0ge307XG5cbiAgICAgICAgICAgICAgICAvL1RyYWNraW5nIG1vdXNlIGNsaWNrIHN0YXRlIHRvIG1ha2UgdG9vbHRpcFxuICAgICAgICAgICAgICAgIC8vZGlzYXBwZWFyIGlmIHRoZSBub2RlIGlzIGJlaW5nIGRyYWdnZWQuXG4gICAgICAgICAgICAgICAgJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS5tb3VzZXVwKGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUubW91c2V1cCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy9vdmVycmlkZSB1cGRhdGVOZXdOb2RlcyBhbmQgdXBkYXRlTmV3UGF0aHNcbiAgICAgICAgICAgICAgICAvL3RvIGluc3RhbGwgcXRpcFxuICAgICAgICAgICAgICAgIHZhciBncmFwaFVwZGF0ZU5ld05vZGVzID0gZ3JhcGgudXBkYXRlTmV3Tm9kZXM7XG4gICAgICAgICAgICAgICAgZ3JhcGgudXBkYXRlTmV3Tm9kZXMgPSBmdW5jdGlvbihuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgICAgICBncmFwaFVwZGF0ZU5ld05vZGVzLmNhbGwoZ3JhcGgsIG5ld05vZGVzKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51cGRhdGVOZXdOb2RlcyhuZXdOb2Rlcyk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHZhciBncmFwaFVwZGF0ZU5ld1BhdGhzID0gZ3JhcGgudXBkYXRlTmV3UGF0aHM7XG4gICAgICAgICAgICAgICAgZ3JhcGgudXBkYXRlTmV3UGF0aHMgPSBmdW5jdGlvbihuZXdQYXRocykge1xuICAgICAgICAgICAgICAgICAgICBncmFwaFVwZGF0ZU5ld1BhdGhzLmNhbGwoZ3JhcGgsIG5ld1BhdGhzKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51cGRhdGVOZXdQYXRocyhuZXdQYXRocyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJlbW92ZXMgYWxsIHFUaXBzIGZyb20gdGhlIERPTS5cbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBwb2xpY3kgaXMgdW5pbnN0YWxsZWQgb3JcbiAgICAgICAgICAgICAqIHRoZSBncmFwaCBpcyBkZXN0cm95ZWQuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICAgICAgLy9yZW1vdmluZyBhbGwgcXRpcCBmcm9tIERPTVxuICAgICAgICAgICAgICAgICQoJ1tpZF49XCJxdGlwXCJdJykucmVtb3ZlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogS2VlcGluZyB0cmFjayBvZiBtb3VzZWRvd24gc3RhdGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7ZDNPYmplY3R9ICBkM29iaiAgVGhlIGQzIHBiamVjdFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGUvTGlua30gIGQgICAgIFRoZSBtYXRjaGluZyBkYXRhIG9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBtb3VzZWRvd24oZDNvYmosIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuUVRpcFBvbGljeTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5tb3VzZWRvd24gPSB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEtlZXBpbmcgdHJhY2sgb2YgbW91c2Vkb3duIHN0YXRlXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzT2JqZWN0fSAgZDNvYmogIFRoZSBkMyBwYmplY3RcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlL0xpbmt9ICBkICAgICBUaGUgbWF0Y2hpbmcgZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgbW91c2V1cChkM29iaiwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5RVGlwUG9saWN5O1xuICAgICAgICAgICAgICAgIHN0YXRlLm1vdXNlZG93biA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB3aGVuUVRpcEF2YWlsYWJsZShjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgaW50ZXJ2YWwgPSA1MDA7IC8vIG1zXG4gICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkKGRvY3VtZW50KS5xdGlwICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dCh0aGlzUG9saWN5LndoZW5RVGlwQXZhaWxhYmxlKGNhbGxiYWNrKSwgaW50ZXJ2YWwpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgaW50ZXJ2YWwpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIE5ldyBOb2RlcyBhcmUgYWRkZWQgZHVyaW5nIHRoZVxuICAgICAgICAgICAgICogdXBkYXRlIGdyYXBoIGZ1bmN0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzTm9kZX0gIG5ld05vZGVzICBUaGUgbmV3IG5vZGVzIHRoYXQgYXJlXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlaW5nIGFkZGVkIHRvIHRoZSBncmFwaFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1cGRhdGVOZXdOb2RlcyhuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5RVGlwUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gYXR0YWNoUVRpcCgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9hdHRhY2hpbmcgcXRpcFxuICAgICAgICAgICAgICAgICAgICBuZXdOb2Rlcy5lYWNoKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aGlzTm9kZSA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL0lmIG5vZGUgaGFzIGNoaWxkcmVuLCB0aGVuIGl0IGlzIGEgc2VydmljZVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFtkLmlkXSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IFwiPGI+PHU+U2VsZWN0b3JzOjwvYj48L3U+IFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZWxlY3Rvck1hcCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnNlbGVjdG9yc1tkLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGFzS2V5cyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBzZWxlY3Rvck1hcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNLZXlzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSBrZXkgKyBcIiA6IDxpPlwiKyBzZWxlY3Rvck1hcFtrZXldICsgXCI8L2k+LFxcbiBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhhc0tleXMgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29tbWEgd2lsbCBiZSByZW1vdmVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSBcIk5vIFNlbGVjdG9ycywgXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSBcIjxiPjx1PkxhYmVsczo8L2I+PC91PiBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGFiZWxzTWFwID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UubGFiZWxzW2QuaWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoYXNLZXlzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGxhYmVsc01hcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNLZXlzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSBrZXkgKyBcIiA6IDxpPlwiKyBsYWJlbHNNYXBba2V5XSArIFwiPC9pPixcXG4gXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoYXNLZXlzID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbW1hIHdpbGwgYmUgcmVtb3ZlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gXCJObyBsYWJlbHMsIFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vcmVtb3ZlIGxhc3QgY29tbWFcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSB0ZXh0LnNsaWNlKDAsIC0yKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzTm9kZSkucXRpcCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogZC5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRzOiB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcGkgPSAkKHRoaXNOb2RlKS5xdGlwKCdhcGknKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSAkKCcjZ3JhcGhDb250YWluZXInKS5vZmZzZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IFtvZmZzZXQubGVmdCArICgoZC54ICogdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKSkgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKVswXSksIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQudG9wICsgKChkLnkgK2QucmFkaXVzKSAqIHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCkpICArIHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpWzFdXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwaS5zZXQoJ3Bvc2l0aW9uLnRhcmdldCcsIHBvc2l0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhc3RhdGUubW91c2Vkb3duO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGF5OiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb2xvOiAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc2VzOiAncXRpcC1ibHVlIHF0aXAtc2hhZG93J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXk6ICd0b3AgY2VudGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXQ6ICdib3R0b20gY2VudGVyJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0YXJnZXQ6IHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaWRlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50OiAnbW91c2Vkb3duIG1vdXNlbGVhdmUnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vaW5jYXNlIGxpYnJhcnkgaGFzbid0IGxvYWRlZCB5ZXRcbiAgICAgICAgICAgICAgICBpZiAoJChkb2N1bWVudCkucXRpcCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgYXR0YWNoUVRpcCgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMud2hlblFUaXBBdmFpbGFibGUoYXR0YWNoUVRpcCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIG5ldyBwYXRocyBhcmUgYWRkZWQgZHVyaW5nIHRoZVxuICAgICAgICAgICAgICogdXBkYXRlIGdyYXBoIGZ1bmN0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzUGF0aH0gIG5ld1BhdGhzICBUaGUgbmV3IHBhdGhzIHRoYXQgYXJlXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlaW5nIGFkZGVkIHRvIHRoZSBncmFwaFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1cGRhdGVOZXdQYXRocyhuZXdQYXRocykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5RVGlwUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgLy9pbmNhc2UgbGlicmFyeSBoYXNuJ3QgbG9hZGVkIHlldFxuICAgICAgICAgICAgICAgIGlmICgkKGRvY3VtZW50KS5xdGlwICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvL2FkZGluZyBxdGlwXG4gICAgICAgICAgICAgICAgICAgIG5ld1BhdGhzLmVhY2goZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRoaXNQYXRoID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vZ2V0dGluZyBtaWRwb2ludCBvZiBwYXRoXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aEVsICAgPSBkMy5zZWxlY3QodGhpcykubm9kZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1pZHBvaW50ID0gcGF0aEVsLmdldFBvaW50QXRMZW5ndGgocGF0aEVsLmdldFRvdGFsTGVuZ3RoKCkvMik7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0UmV0ID0gZC5xdGlwSGVscGVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IFwiQnl0ZXM6IFwiICsgZC5nZXRXZWlnaHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpc1BhdGgpLnF0aXAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3c6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9pZiBtb3VzZSBpcyBkb3duLCBkb24ndCBsZXQgcXRpcCBzaG93XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIXN0YXRlLm1vdXNlZG93bjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxheTogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc29sbzogJCgnI2dyYXBoQ29udGFpbmVyJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzZXM6ICdxdGlwLWJsdWUgcXRpcC1zaGFkb3cnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBteTogdGFyZ2V0UmV0Lm15LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdDogJ2NlbnRlciBjZW50ZXInLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiAnbW91c2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGp1c3Q6IHRhcmdldFJldC5hZGp1c3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQ6ICdtb3VzZWRvd24gbW91c2VsZWF2ZSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0gICBcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBQb2xpY3k6IFFUaXBQb2xpY3lcbiAgICAgICAgfVxufV0pO1xuXG5cblxuXG5cblxuXG5cbiIsIi8qKlxuICogVGhpcyBwb2xpY3kgcHJvdmlkZXMgYSB3YXkgZm9yIHByb3BlcnRpZXMgdG8gYmUgc2F2ZWQgXG4gKiBiZXR3ZWVuIHZpZXcgY2hhbmdlc1xuICogXG4gKiBJdCBtb2RpZmllcyB0aGUgZGVzdHJveSBmdW5jdGlvbiB0byBhbHNvIHBhc3MgaW4gYW4gb2JqZWN0IHRoYXRcbiAqIHdpbGwgaGF2ZSBhbGwgaXRzIHByb3BlcnRpZXMgc2F2ZWQgYW5kIHdpbGwgYmUgYXZhaWxhYmxlIFxuICogb24gZ3JhcGggbG9hZC4gV2hlbiBzYXZpbmcgdmFyaWFibGVzIHRvIHRoZSBvYmplY3QsIG5hbWVzcGFjZSB3aXRoXG4gKiB0aGUgcG9saWN5IG5hbWUuXG4gKiBcbiAqIFRoaXMgcG9saWN5IG11c3QgYmUgbG9hZGVkIGZpcnN0IGluIG9yZGVyIGZvciBpdCBzYXZlZCB2YXJpYWJsZXMgXG4gKiB0byBiZSBsb2FkZWQgd2hlbiB0aGUgdmlldyBjb21lcyBiYWNrIHRvIHRoZSBncmFwaFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnU2F2ZVN0YXRlUG9saWN5JywgWydQb2xpY3knLCBmdW5jdGlvbiAoUG9saWN5KSB7XG4gICAgXHRjbGFzcyBTYXZlU3RhdGVQb2xpY3kgZXh0ZW5kcyBQb2xpY3kuUG9saWN5IHtcbiAgICBcdFx0XG4gICAgXHRcdC8qKlxuICAgIFx0XHQgKiBUYWtlcyBpbiB0aGUgYW5ndWxhciBzZXJ2aWNlIHRvIHdoaWNoIGl0IHdpbGxcbiAgICBcdFx0ICogc2F2ZSBpdCdzIHByb3BlcnRpZXMgdG8uXG4gICAgXHRcdCAqXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBzYXZlZFN0YXRlICBPYmplY3QgdG8gc2F2ZSBcbiAgICBcdFx0ICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXMgdG9cbiAgICBcdFx0ICovXG4gICAgXHRcdGNvbnN0cnVjdG9yKHNhdmVkU3RhdGUpIHtcbiAgICBcdFx0XHRzdXBlcignU2F2ZVN0YXRlUG9saWN5Jyk7XG4gICAgXHRcdFx0dGhpcy5zYXZlZFN0YXRlID0gc2F2ZWRTdGF0ZTtcbiAgICBcdFx0fVxuXG4gICAgXHRcdC8qKlxuICAgIFx0XHQgKiBDYWxsZWQgd2hlbiB0aGUgcG9saWN5IGlzIGluc3RhbGxlZFxuICAgIFx0XHQgKiBNb2RpZmllcyB0aGUgZGVzdHJveSBtZXRob2QgXG4gICAgXHRcdCAqIGFuZCBhZGRzIGEgbG9hZCBtZXRob2QgdG8gdGhlIGdyYXBoXG4gICAgXHRcdCAqXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoIGl0IGlzIFxuICAgIFx0XHQgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbGxlZCBvblxuICAgIFx0XHQgKi9cbiAgICBcdFx0aW5pdGlhbGl6ZShncmFwaCkge1xuICAgIFx0XHRcdHRoaXMuZ3JhcGggPSBncmFwaDtcbiAgICBcdFx0XHR2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgXHRcdFx0Z3JhcGguZGVzdHJveSA9IGZ1bmN0aW9uKCkge1xuICAgIFx0XHRcdFx0dGhpc1BvbGljeS5ncmFwaERlc3Ryb3kuY2FsbChncmFwaCwgdGhpc1BvbGljeS5zYXZlZFN0YXRlKTtcbiAgICBcdFx0XHR9O1xuXG4gICAgXHRcdFx0Z3JhcGgubG9hZCA9IGZ1bmN0aW9uKHNhdmVkU3RhdGUpIHtcbiAgICBcdFx0XHRcdHRoaXNQb2xpY3kuZ3JhcGhMb2FkLmNhbGwoZ3JhcGgsIHNhdmVkU3RhdGUpO1xuICAgIFx0XHRcdH1cbiAgICBcdFx0fVxuXG4gICAgXHRcdC8qKlxuICAgIFx0XHQgKiBXaWxsIG92ZXJyaWRlIHRoZSBncmFwaCdzIGRlZmF1bHQgZGVzdHJveSwgd2l0aCBcbiAgICBcdFx0ICogdGhpcyBwb2xpY3kncyBzYXZlZFN0YXRlIHBhc3NlZCBpbi5cbiAgICBcdFx0ICogQ2FsbGVkIHdpdGggdGhpcyBhcyB0aGUgZ3JhcGhcbiAgICBcdFx0ICpcbiAgICBcdFx0ICogQHBhcmFtICAgICAge09iamVjdH0gIHNhdmVkU3RhdGUgIFRoZSBzYXZlZCBzdGF0ZVxuICAgIFx0XHQgKi9cbiAgICBcdFx0Z3JhcGhEZXN0cm95KHNhdmVkU3RhdGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5LmRlc3Ryb3koc2F2ZWRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5LmRlc3Ryb3koc2F2ZWRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHRoaXNHcmFwaC5iaW5kaW5ncykge1xuICAgICAgICAgICAgICAgICAgICAkKHdpbmRvdykub2ZmKGtleSwgdGhpc0dyYXBoLmJpbmRpbmdzW2tleV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBXaWxsIGJlIGNhbGxlZCB3aXRoIHRoZSBncmFwaCBhcyB0aGlzXG4gICAgICAgICAgICAgKiBVc2VkIHRvIGhhdmUgYWxsIG90aGVyIHBvbGljaWVzIHVzZSB0aGUgbG9hZCBzdGF0ZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBzYXZlZFN0YXRlICBUaGUgc2F2ZWQgc3RhdGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZ3JhcGhMb2FkKHNhdmVkU3RhdGUpIHtcbiAgICAgICAgICAgIFx0dmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgIFx0aWYgKHBvbGljeS5sb2FkICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgXHRwb2xpY3kubG9hZChzYXZlZFN0YXRlKTtcbiAgICAgICAgICAgICAgICAgXHR9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgXHRpZiAocG9saWN5LmxvYWQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBcdHBvbGljeS5sb2FkKHNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgICAgICBcdH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICBcdH1cbiAgICBcdHJldHVybiB7XG4gICAgXHRcdFBvbGljeTogU2F2ZVN0YXRlUG9saWN5XG4gICAgXHR9XG59XSk7XG5cblxuXG5cblxuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zdG9yYWdlcG9saWNpZXMnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcycsIHtcbiAgICAgICAgICAgIHVybDogJy9zdG9yYWdlcG9saWNpZXMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5saXN0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnc3RvcmFnZXBvbGljeWxpc3QnXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCJcblxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52aXN1YWxpemF0aW9uJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscycsIFxuXHQnY29udGl2LmdyYXBoJ10pXG4gLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdjb250aXYubWVudS52aXN1YWxpemF0aW9uJywge1xuICAgICAgICAgICAgdXJsOiAnL3Zpc3VhbGl6YXRpb24nLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgfV0pO1xuIiwiLyoqXG4gKiBUaGlzIHBvbGljeSBpcyB1c2VkIGZvciBzcGxpdHRpbmcgYSBub2RlIGludG8gaXRzIGNoaWxkcmVuLFxuICogYW5kIGpvaW5pbmcgdGhlbSBiYWNrIHRvIHRoZWlyIHBhcmVudC5cbiAqIFNwbGl0cyBvbiBkb3VibGUgY2xpY2ssIGFuZCBqb2lucyBvbiByaWdodCBjbGljay5cbiAqIElmIG11bHRpcGxlIG5vZGVzIGFyZSBzZWxlY3RlZCBhdCB0aGUgdGltZSBvZiBhIHNwbGl0IG9yIGpvaW4gZXZlbnQsXG4gKiBpdCB3aWxsIHNwbGl0IG9yIGpvaW4gYWxsIG9mIHRoZW0uXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdTcGxpdEpvaW5Ob2RlUG9saWN5JywgWydOb2RlU2VsZWN0aW9uUG9saWN5JywgJ1Zpc3VhbGl6ZXJOb2RlJywgXG4gICAgXHRcdGZ1bmN0aW9uIChOb2RlU2VsZWN0aW9uUG9saWN5LCBWaXN1YWxpemVyTm9kZSkge1xuXHRcdGNsYXNzIFNwbGl0Sm9pbk5vZGVQb2xpY3kgZXh0ZW5kcyBOb2RlU2VsZWN0aW9uUG9saWN5LlBvbGljeSB7XG5cdFx0XHQvKipcblx0XHRcdCAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cblx0XHRcdCAqL1xuICAgICAgICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgICAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBvbGljeU5hbWUgPSBcIlNwbGl0Sm9pbk5vZGVQb2xpY3lcIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5pdGlhbGl6ZShncmFwaCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3VwZXIuaW5pdGlhbGl6ZShncmFwaCk7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuU3BsaXRKb2luTm9kZVBvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLnNwbGl0Tm9kZXMgPSBbXTsgXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVHJpZ2dlcmluZyBzcGxpdCBvbiBkb3VibGUgY2xpY2tcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgZCAgICAgIFRoZSBtYXRjaGluZyBkYXRhIG9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkYmxjbGljayhkM25vZGUsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3VwZXJTdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5Ob2RlUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgaWYgKCFkMy5ldmVudC5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdXBlclN0YXRlLnNlbGVjdGVkTm9kZXMuaW5kZXhPZihkKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNwbGl0TXVsdGlwbGVOb2RlcyhzdXBlclN0YXRlLnNlbGVjdGVkTm9kZXMpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVBbGxTZWxlY3RlZE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNwbGl0Tm9kZShkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUcmlnZ2VyaW5nIGpvaW4gb24gcmlnaHQgY2xpY2tcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmp9ICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgZCAgICAgIFRoZSBtYXRjaGluZyBkYXRhIG9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb250ZXh0bWVudShkM25vZGUsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3VwZXJTdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuICAgICAgICAgICAgICAgIGQzLmV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgaWYgKCFkMy5ldmVudC5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgdHJ5IHRvIGpvaW4gYSBoaWdobGlnaHRlZCBub2RlIHdoaWxlIG11bHRpcGxlIG5vZGVzIGFyZSBzZWxlY3RlZCxcbiAgICAgICAgICAgICAgICAgICAgLy93ZSBqb2luIGFsbCBoaWdobGlnaHRlZCBub2Rlc1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWROb2RlcyA9IHN1cGVyU3RhdGUuc2VsZWN0ZWROb2RlcztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkTm9kZXMuaW5kZXhPZihkKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGVjdGVkTm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmpvaW5Ob2RlKHNlbGVjdGVkTm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9pZiB3ZSB0cnkgdG8gam9pbiBhIG5vZGUgdGhhdCBpc24ndCBwYXJ0IG9mIGEgaGlnaGxpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAgICAgLy93ZSByZW1vdmUgYWxsIGhpZ2hsaWdodHMgYW5kIHRoZW4gam9pbiB0aGUgY2xpY2tlZCBub2RlXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUFsbFNlbGVjdGVkTm9kZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuam9pbk5vZGUoZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU3BsaXRzIGEgbm9kZS5cbiAgICAgICAgICAgICAqIHVzZWQgdG8gc2hhcmUgY29kZSBiZXR3ZWVuIHNwbGl0Tm9kZSBhbmQgc3BsaXRNdWx0aXBsZU5vZGVzXG4gICAgICAgICAgICAgKiB3aGlsZSBwcmV2ZW50aW5nIHRoZSBoYW5kbGVycyBmb3IgdGhlbSBib3RoIGZpcmluZ1xuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGUgYmVpbmcgc3BsaXRcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIFRoZSBuZXcgbm9kZXMgY3JlYXRlZCBieSB0aGUgc3BsaXRcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgX19zcGxpdE5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5Ob2RlUG9saWN5O1xuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gbm9kZS5pZDtcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIC8vaWYgaXQgaGFzIG5vIGNoaWxkcmVuIHRvIHNwbGl0IGludG9cbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRyZW5fc3RydWN0W25hbWVdID09PSB1bmRlZmluZWQgfHwgXy5pc0VtcHR5KGNoaWxkcmVuX3N0cnVjdFtuYW1lXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vcmVtb3ZpbmcgdGhlIG5vZGUgZnJvbSB0aGUgbGlzdCBvZiBub2Rlc1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlcyA9IF8uZmlsdGVyKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24oZ3JhcGhOb2Rlcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ3JhcGhOb2RlcyAhPSBub2RlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXNHcmFwaC5ub2Rlcyk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlKTtcblxuICAgICAgICAgICAgICAgIC8vZ2V0dGluZyBhbGwgdGhlIG5vZGUgaWQncyBmb3IgZmluZGluZyBmbG93XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVfbmFtZXNfc2V0ID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZV9uYW1lc19zZXQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0uaWQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vc2V0IG9mIG5vZGVzIGFmdGVyIHRoZSBzcGxpdFxuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoaWxkcmVuX3N0cnVjdFtuYW1lXS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBub2RlX25hbWVzX3NldC5wdXNoKGNoaWxkcmVuX3N0cnVjdFtuYW1lXVtpXSk7XG4gICAgICAgICAgICAgICAgICAgIG5ld19ub2Rlcy5wdXNoKGNoaWxkcmVuX3N0cnVjdFtuYW1lXVtpXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciByZXREYXRhID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuZ2V0Rmxvd0JldHdlZW5TZXQobm9kZV9uYW1lc19zZXQpO1xuXG4gICAgICAgICAgICAgICAgLy9mb3JtYXR0aW5nIGRhdGEgZm9yIG5ldyBub2Rlc1xuICAgICAgICAgICAgICAgIHZhciB4TG9jID0gbm9kZS54O1xuICAgICAgICAgICAgICAgIHZhciB5TG9jID0gbm9kZS55O1xuICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnMgPSBub2RlLmFuY2VzdG9ycy5zbGljZSgpO1xuICAgICAgICAgICAgICAgIC8va2VlcGluZyBvcmRlcmluZyB0aGF0IGZpcnN0IGluIGFuY2VzdG9yIGxpc3QgaXMgY2xvc2VzdCBpbiByZWxhdGlvbnNoaXBcbiAgICAgICAgICAgICAgICBhbmNlc3RvcnMuc3BsaWNlKDAsIDAsIG5vZGUuaWQpO1xuICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBub2RlLmlkO1xuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZV9vYmpzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIHJhZGl1cyA9IG5vZGUucmFkaXVzICogdGhpc0dyYXBoLmNvbnN0cy5yYWRpdXNEZWNheTtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZURhdGEgPSByZXREYXRhLm5vZGVEYXRhO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZURhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgLy9jYWxjdWxhdGluZyB3aGljaCBvZiB0aGUgbm9kZXMgaW4gcmV0RGF0YVswXSBhcmUgbmV3XG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXdfbm9kZXMuaW5kZXhPZihub2RlRGF0YVtpXS5pZCkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkID0gbm9kZURhdGFbaV0uaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IG5vZGVEYXRhW2ldLnRleHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGUgPSBuZXcgVmlzdWFsaXplck5vZGUuTm9kZShudWxsLCBudWxsLCBpZCwgdGV4dCwgcmFkaXVzLCBwYXJlbnQsIGFuY2VzdG9ycywgeExvYywgeUxvYyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdfbm9kZS5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMucHVzaChuZXdfbm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdfbm9kZV9vYmpzLnB1c2gobmV3X25vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YShyZXREYXRhLmxpbmtEYXRhLCB0aGlzR3JhcGgubm9kZXMpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0Tm9kZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdExpbmtzKCk7XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS5zcGxpdE5vZGVzLnB1c2gobm9kZS5pZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ld19ub2RlX29ianM7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU3BsaXRzIHRoZSBnaXZlIG5vZGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGUgYmVpbmcgc3BsaXRcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc3BsaXROb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzID0gdGhpcy5fX3NwbGl0Tm9kZShub2RlKTtcbiAgICAgICAgICAgICAgICBpZiAocmVzID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnNwbGl0Tm9kZUV2ZW50KHJlcyk7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTcGxpdHMgYWxsIHRoZSBub2RlcyBwYXNzZWQgaW5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlcyAgIEFycmF5IG9mIG5vZGVzIHRvIGJlIHNwbGl0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNwbGl0TXVsdGlwbGVOb2Rlcyhub2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoO1xuICAgICAgICAgICAgICAgIHZhciByZXNOb2RlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IHRoaXMuX19zcGxpdE5vZGUobm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICByZXNOb2RlcyA9IHJlc05vZGVzLmNvbmNhdChyZXMpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuc3BsaXRNdWx0aXBsZU5vZGVzRXZlbnQocmVzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgYWZ0ZXIgYSBzaW5nbGUgbm9kZSBpcyBzcGxpdFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5ld05vZGVzICBUaGUgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNwbGl0Tm9kZUV2ZW50KG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNldFBvc2l0aW9ucygpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBtdWx0aXBsZSBub2RlcyBhcmUgc3BsaXQgYXQgb25jZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5ld05vZGVzICBUaGUgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNwbGl0TXVsdGlwbGVOb2Rlc0V2ZW50KG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNldFBvc2l0aW9ucygpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIHVzZWQgdG8gc2hhcmUgY29kZSBiZXR3ZWVuIGpvaW5Ob2RlIGFuZCBqb2luTXVsdGlwbGVOb2RlXG4gICAgICAgICAgICAgKiB3aGlsZSBwcmV2ZW50aW5nIGJvdGggaGFuZGxlcnMgZmlyaW5nXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgICAgICBub2RlICAgIFRoZSBub2RlIHRvIGpvaW5cbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtOb2RlfSAgVGhlIG5ldyBub2RlIGFmdGVyIHRoZSBqb2luXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIF9fam9pbk5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5Ob2RlUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgLy9jaGVjayB0aGF0IG5vZGUgc3RpbGwgZXhpc3RzXG4gICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG5vZGUpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gbm9kZS5pZDtcbiAgICAgICAgICAgICAgICAvL2lmIGl0IGhhcyBubyBhbmNlc3Rvciwgbm90aGluZyB0byBqb2luXG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbC5pbmRleE9mKG5hbWUpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciB0b19iZV9kZWxldGVkID0gW107XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVfbmFtZXNfc2V0ID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgLy9pZiBub2RlIHdvbid0IGJlIGNvbGxhcHNlZFxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLm5vZGVzW2ldLmFuY2VzdG9ycy5pbmRleE9mKG5vZGUucGFyZW50KSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZV9uYW1lc19zZXQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0uaWQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9fYmVfZGVsZXRlZC5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlX2lkID0gbm9kZS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgbm9kZV9uYW1lc19zZXQucHVzaChub2RlLnBhcmVudCk7XG5cbiAgICAgICAgICAgICAgICAvL2Zvcm1hdHRpbmcgZGF0YVxuICAgICAgICAgICAgICAgIHZhciByYWRpdXMgPSBub2RlLnJhZGl1cyAvIHRoaXNHcmFwaC5jb25zdHMucmFkaXVzRGVjYXk7IFxuICAgICAgICAgICAgICAgIHZhciB4TG9jID0gbm9kZS54O1xuICAgICAgICAgICAgICAgIHZhciB5TG9jID0gbm9kZS55O1xuICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBub2RlLmFuY2VzdG9yc1sxXTtcbiAgICAgICAgICAgICAgICB2YXIgYW5jZXN0b3JzID0gbm9kZS5hbmNlc3RvcnMuc2xpY2UoMSk7XG4gICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlID0gbmV3IFZpc3VhbGl6ZXJOb2RlLk5vZGUoeExvYywgeUxvYywgbmV3X25vZGVfaWQsIG5ld19ub2RlX2lkLCByYWRpdXMsIHBhcmVudCwgYW5jZXN0b3JzKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMucHVzaChuZXdfbm9kZSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgcmV0RGF0YSA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmdldEZsb3dCZXR3ZWVuU2V0KG5vZGVfbmFtZXNfc2V0KTtcbiAgICAgICAgICAgICAgICAvL3JlbW92ZSBhbGwgbm9kZXMgdGhhdCB3aWxsIGJlIGpvaW5lZFxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdG9fYmVfZGVsZXRlZC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZV90b19kZWxldGUgPSB0b19iZV9kZWxldGVkW2ldO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMuc3BsaWNlKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG5vZGVfdG9fZGVsZXRlKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zcGxpY2VMaW5rc0Zvck5vZGUobm9kZV90b19kZWxldGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5wcm9jZXNzTGlua0RhdGEocmV0RGF0YS5saW5rRGF0YSwgdGhpc0dyYXBoLm5vZGVzKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXRMaW5rcygpO1xuXG4gICAgICAgICAgICAgICAgc3RhdGUuc3BsaXROb2Rlcy5zcGxpY2Uoc3RhdGUuc3BsaXROb2Rlcy5pbmRleE9mKG5ld19ub2RlLmlkKSwgMSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3X25vZGU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogSm9pbnMgdGhlIGdpdmVuIG5vZGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGUgdG8gam9pblxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBqb2luTm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5ld05vZGUgPSB0aGlzLl9fam9pbk5vZGUobm9kZSk7XG4gICAgICAgICAgICAgICAgaWYgKG5ld05vZGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIFx0dGhpcy5qb2luTm9kZUV2ZW50KG5ld05vZGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBKb2lucyBhbGwgdGhlIGdpdmVuIG5vZGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZXMgICBUaGUgbm9kZXMgdG8gam9pblxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBqb2luTXVsdGlwbGVOb2RlKG5vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IHRoaXMuX19qb2luTm9kZShub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIG5ld19ub2Rlcy5wdXNoKHJlcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuam9pbk11bHRpcGxlTm9kZXNFdmVudChuZXdfbm9kZXMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBhIHNpbmdsZSBub2RlIGlzIGpvaW5lZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbmV3Tm9kZSAgVGhlIG5ldyBub2RlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGpvaW5Ob2RlRXZlbnQobmV3Tm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBtdWx0aXBsZSBub2RlcyBhcmUgam9pbmVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbmV3Tm9kZXMgIFRoZSBuZXcgbm9kZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgam9pbk11bHRpcGxlTm9kZXNFdmVudChuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIFBvbGljeTogU3BsaXRKb2luTm9kZVBvbGljeVxuICAgICAgICB9XG59XSk7XG5cblxuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52b2x1bWVzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52b2x1bWVzJywge1xuICAgICAgICAgICAgdXJsOiAnL3ZvbHVtZXMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZvbHVtZXMubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ3ZvbHVtZWxpc3QnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZvbHVtZXMuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29tcG9uZW50OiAndm9sdW1lZGV0YWlscydcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIi8qKlxuICogVGhpcyBwb2xpY3kgaXMgdXNlZCB0byBjaGFuZ2UgdGhlIHZpZXcgdG8gZm9jdXMgb24gc3BsaXR0aW5nIGFuZCBcbiAqIGpvaW5pbmcgZXZlbnRzLlxuICogT3ZlcnJpZGVzIHRoZSBjZXJ0YWluIGZvcmNlIGxheW91dCBmdW5jdGlvbnMgb2YgdGhlIGdyYXBoIHRvIHBhcnRpdGlvbiBhIHNwbGl0XG4gKiBpbnRvIHRoZSBmb2N1c2VkIG5vZGVzIGFuZCB0aGUgY29ubmVjdGVkIG5vZGVzLlxuICogXG4gKiBIYXMgc2F2ZS9sb2FkIG1ldGhvZHMgZm9yIHRoZSBzYXZlIHN0YXRlIHBvbGljeS5cbiAqIEhhcyBiYWNrIGJ1dHRvbiBzdXBwb3J0LlxuICogQ2FuIGF1dG8gY2hhbmdlIHRoZSB0aXRsZSBvZiB0aGUgZ3JhcGguXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdTcGxpdEpvaW5WaWV3UG9saWN5JywgWydTcGxpdEpvaW5Ob2RlUG9saWN5JywgJ1Zpc3VhbGl6ZXJOb2RlJywgZnVuY3Rpb24gKFNwbGl0Sm9pbk5vZGVQb2xpY3ksIFZpc3VhbGl6ZXJOb2RlKSB7IFxuICAgICAgICBjbGFzcyBTcGxpdEpvaW5WaWV3UG9saWN5IGV4dGVuZHMgU3BsaXRKb2luTm9kZVBvbGljeS5Qb2xpY3l7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgICAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBvbGljeU5hbWUgPSBcIlNwbGl0Sm9pblZpZXdQb2xpY3lcIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5pdGlhbGl6ZShncmFwaCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3VwZXIuaW5pdGlhbGl6ZShncmFwaCk7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLnNhdmVkU3RhdGVzID0gW107XG4gICAgICAgICAgICAgICAgLy8gc3RhdGUuZm9jdXNHcm91cCA9IG51bGw7XG4gICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5ID0gW107XG4gICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMgPSBbXTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5mb2NpID0gW107XG4gICAgICAgICAgICAgICAgc3RhdGUuem9vbXMgPSB7fTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5sYXlvdXQgPSB7fTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5sYXlvdXREZWZhdWx0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS56b29tRGVmYXVsdCA9IG51bGw7XG4gICAgICAgICAgICAgICAgc3RhdGUubm9kZUlkc1RvUmVzaG93ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uRWxlbSA9IG51bGw7XG4gICAgICAgICAgICAgICAgc3RhdGUudGl0bGVFbGVtID0gbnVsbDtcblxuICAgICAgICAgICAgICAgIHZhciBjb25zdHMgPSBncmFwaC5jb25zdHMuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIGNvbnN0cy5ib3VuZGFyeSA9IDAuODtcblxuICAgICAgICAgICAgICAgIC8vb3ZlcnJpZGluZyBkM2ZvcmNlIG1ldGhvZHMgb2YgdGhlIGdyYXBoLlxuICAgICAgICAgICAgICAgIGdyYXBoLmQzRm9yY2VCb3VuZHMgPSB0aGlzLmQzRm9yY2VCb3VuZHM7XG4gICAgICAgICAgICAgICAgZ3JhcGguZDNGb3JjZVRpY2sgPSB0aGlzLmQzRm9yY2VUaWNrO1xuICAgICAgICAgICAgICAgIGdyYXBoLmQzRm9yY2VTdGFydCA9IHRoaXMuZDNGb3JjZVN0YXJ0O1xuICAgICAgICAgICAgICAgIGdyYXBoLmQzRm9yY2VFbmQgPSB0aGlzLmQzRm9yY2VFbmQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogTGlua3MgdGhlIHByb3ZpZGVkIGVsZW1lbnQgYSBiYWNrIGJ1dHRvbiBmZWF0dXJlXG4gICAgICAgICAgICAgKiBEb2Vzbid0IHRyaWdnZXIgdGhlIG9uLWNsaWNrIGV2ZW50XG4gICAgICAgICAgICAgKiBUaGF0IHNob3VsZCBiZSBkb25lIHRocm91Z2ggYW5ndWxhciBuZy1jbGljay5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7alF1ZXJ5fSAgZWxlbSAgICBUaGUganF1ZXJ5IHNlbGVjdGVkIGVsZW1lbnRcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5zdGFsbEJhY2tCdXR0b24oZWxlbSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5ID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIHN0YXRlLmJhY2tCdXR0b25FbGVtID0gZWxlbTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51bmRvTGFzdEV2ZW50LmNhbGwodGhpc1BvbGljeSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2lsbCBhbGxvdyB0aGlzIHBvbGljeSB0byBjaGFuZ2UgdGhlIHRpdGxlIG9mIHRoZSBncmFwaFxuICAgICAgICAgICAgICogYXMgc3BsaXQgYW5kIGpvaW4gZXZlbnRzIG9jY3VyLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtqUXVlcnl9ICBlbGVtICAgIFRoZSBqcXVlcnkgc2VsZWN0ZWQgZWxlbWVudFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbnN0YWxsVGl0bGUoZWxlbSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgc3RhdGUudGl0bGVFbGVtID0gZWxlbTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgYmVpbmcgZGVzdHJveWVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIHNhdmVkU3RhdGUgIEFueSBwcm9wZXJ0eSBvbiB0aGlzXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0IHdpbGwgYmUgYWNjZXNzaWJsZVxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gdGhlIHZpZXcgcmVsb2Fkc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkZXN0cm95KHNhdmVkU3RhdGUpIHtcbiAgICAgICAgICAgICAgICAvL09ubHkgaWYgdGhlIHNhdmUgc3RhdGUgcG9saWN5IGlzIGluc3RhbGxlZFxuICAgICAgICAgICAgICAgIGlmIChzYXZlZFN0YXRlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zYXZlKHNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBXaWxsIHNhdmUgdGhlIGN1cnJlbnQgc3RhdGUsIGFuZCBhbGwgaGlzdG9yeS5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgc2F2ZWRTdGF0ZSAgQW55IHByb3BlcnR5IG9uIHRoaXNcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3Qgd2lsbCBiZSBhY2Nlc3NpYmxlXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiB0aGUgdmlldyByZWxvYWRzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNhdmUoc2F2ZWRTdGF0ZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgICAgIHZhciBsaW5rcyA9IHRoaXNHcmFwaC5saW5rcztcbiAgICAgICAgICAgICAgICB2YXIgY3VyclRpdGxlID0gbnVsbDtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUudGl0bGVFbGVtICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgY3VyclRpdGxlID0gc3RhdGUudGl0bGVFbGVtLnRleHQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGZvY3VzR3JvdXBzID0gc3RhdGUuZm9jdXNHcm91cHM7XG4gICAgICAgICAgICAgICAgdmFyIGV2ZW50SGlzdG9yeSA9IHN0YXRlLmV2ZW50SGlzdG9yeTtcbiAgICAgICAgICAgICAgICB2YXIgem9vbXMgPSBzdGF0ZS56b29tcztcbiAgICAgICAgICAgICAgICB2YXIgbGF5b3V0ID0gc3RhdGUubGF5b3V0O1xuXG4gICAgICAgICAgICAgICAgdmFyIGxheW91dERlZmF1bHQgPSBzdGF0ZS5sYXlvdXREZWZhdWx0O1xuICAgICAgICAgICAgICAgIHZhciB6b29tRGVmYXVsdCA9IHN0YXRlLnpvb21EZWZhdWx0O1xuICAgICAgICAgICAgICAgIHZhciByZXQgPSB7bm9kZXM6bm9kZXMsIGxpbmtzOmxpbmtzLCBcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVzOnN0YXRlLnNhdmVkU3RhdGVzLCBjdXJyVGl0bGU6Y3VyclRpdGxlLCBcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNHcm91cHM6IGZvY3VzR3JvdXBzLFxuICAgICAgICAgICAgICAgICAgICBldmVudEhpc3Rvcnk6ZXZlbnRIaXN0b3J5LCB6b29tczp6b29tcyxcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0OmxheW91dCwgbGF5b3V0RGVmYXVsdDpsYXlvdXREZWZhdWx0LFxuICAgICAgICAgICAgICAgICAgICB6b29tRGVmYXVsdDp6b29tRGVmYXVsdH07XG4gICAgICAgICAgICAgICAgc2F2ZWRTdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5ID0gcmV0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgYmUgY2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIHJlbG9hZGVkLCBhc3N1bWluZ1xuICAgICAgICAgICAgICogc2F2ZSBzdGF0ZSBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGxvYWRTdGF0ZSAgQ29udGFpbnMgYWxsIHRoZSBzYXZlZFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFibGVzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGxvYWQobG9hZFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgbG9hZFN0YXRlID0gbG9hZFN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG4gICAgICAgICAgICAgICAgc3RhdGUuc2F2ZWRTdGF0ZXMgPSBsb2FkU3RhdGUuc3RhdGVzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IGxvYWRTdGF0ZS5saW5rcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMgPSBsb2FkU3RhdGUubm9kZXM7XG5cbiAgICAgICAgICAgICAgICB2YXIgY3VyclRpdGxlID0gbG9hZFN0YXRlLmN1cnJUaXRsZTtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUudGl0bGVFbGVtICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUudGl0bGVFbGVtLnRleHQoY3VyclRpdGxlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5ID0gbG9hZFN0YXRlLmV2ZW50SGlzdG9yeTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3VwcyA9IGxvYWRTdGF0ZS5mb2N1c0dyb3VwcztcbiAgICAgICAgICAgICAgICBzdGF0ZS56b29tcyA9IGxvYWRTdGF0ZS56b29tcztcbiAgICAgICAgICAgICAgICBzdGF0ZS5sYXlvdXQgPSBsb2FkU3RhdGUubGF5b3V0O1xuICAgICAgICAgICAgICAgIHN0YXRlLmxheW91dERlZmF1bHQgPSBsb2FkU3RhdGUubGF5b3V0RGVmYXVsdDtcbiAgICAgICAgICAgICAgICBzdGF0ZS56b29tRGVmYXVsdCA9IGxvYWRTdGF0ZS56b29tRGVmYXVsdDtcblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5iYWNrQnV0dG9uRWxlbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuYmFja0J1dHRvbkVsZW0uZmFkZVRvKCdzbG93JywgMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuXG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF8uaW5jbHVkZXMoY2hpbGRyZW5fc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzBdXSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5pZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJmb2N1c1wiO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImNvbm5lY3RlZFwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvL2xvYWRpbmcgYSBwcmV2aW91cyBsYXlvdXRcbiAgICAgICAgICAgICAgICB2YXIgbGF5b3V0O1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ID0gc3RhdGUubGF5b3V0RGVmYXVsdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSBzdGF0ZS56b29tRGVmYXVsdDsgXG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQoem9vbVswXSwgem9vbVsxXSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSBzdGF0ZS56b29tc1tzdGF0ZS5mb2N1c0dyb3Vwc107XG4gICAgICAgICAgICAgICAgICAgIGlmICh6b29tICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQoem9vbVswXSwgem9vbVsxXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ID0gc3RhdGUubGF5b3V0W3N0YXRlLmZvY3VzR3JvdXBzXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL2xheW91dCBjYW4ndCBiZSBudWxsXG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24obikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcG9zID0gbGF5b3V0W24uaWRdO1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9zID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGxheW91dCwgbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbi54ID0gcG9zLng7XG4gICAgICAgICAgICAgICAgICAgIG4ueSA9IHBvcy55O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZS5pbml0Rm9yY2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaC5jYWxsKHRoaXNHcmFwaCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kudXBkYXRlR3JhcGhDYWxsYmFjay5jYWxsKHRoaXNQb2xpY3kpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRyaWdnZXJpbmcgc3BsaXQgb24gZG91YmxlIGNsaWNrXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEZvY3VzIGdyb3VwIHN0b3JlcyB0aGUgbm9kZSB0aGF0IGlzIGFib3V0IHRvIGJlIHNwbGl0LlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBXaGVuIGZvY3VzIGdyb3VwIGhhcyBsZW5ndGggMCwgdGhlIGZpcnN0IHNwbGl0IFxuICAgICAgICAgICAgICogd2lsbCBqdXN0IGJlIHB1c2hlZCBvbi5cbiAgICAgICAgICAgICAqIFRoZSBub2RlIHdpbGwgYmUgc3BsaXQgYW5kIHB1c2hlZCB0byB0aGUgdG9wIGhhbGYgXG4gICAgICAgICAgICAgKiBvZiB0aGUgc2NyZWVuLCBhbmQgdGhlIGJvdHRvbSBoYWxmIHdpbGwgY29udGFpbiBhbnlcbiAgICAgICAgICAgICAqIG5vZGVzIGl0IGhhcyBjb25uZWN0aW9ucyB0by5cbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogV2hlbiBhIGZvY3VzIGdyb3VwIGxlbmd0aCBpcyA+PSAxLCBpZiB0aGUgbm9kZSB0byBiZVxuICAgICAgICAgICAgICogc3BsaXQgaXMgYSBmb2N1cyBub2RlLCBpdCB3aWxsIHJlcGxhY2UgZm9jdXNHcm91cHNbMF0gYW5kXG4gICAgICAgICAgICAgKiB0aGUgdG9wIGhhbGYgd2lsbCBiZSBpdHMgY2hpbGRyZW4sIGFuZCBib3R0b20gaGFsZiB3aWxsXG4gICAgICAgICAgICAgKiBiZSB0aGUgbm9kZXMgaXQgaGFzIGNvbm5lY3Rpb25zIHRvLlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBJZiB0aGUgc3BsaXQgaXMgaW4gdGhlIGJvdHRvbSBoYWxmLCB0aGVuIHRoZSBib3R0b20gaGFsZlxuICAgICAgICAgICAgICogd2lsbCBkaXNwbGF5IGl0J3MgY2hpbGRyZW4gYW5kIHdpbGwgb25seSBzaG93IGNvbm5lY3Rpb25zIGJldHdlZW5cbiAgICAgICAgICAgICAqIHRoZSB0d28gZ3JvdXBzLCBhbmQgd2lsbCByZXBsYWNlIGZvY3VzR3JvdXBzWzFdLlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmp9ICAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGQgICAgICAgVGhlIG1hdGNoaW5nIGRhdGEgb2JqZWN0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGRibGNsaWNrKGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgLy9jaGVjayBpZiBjYW4gc3BsaXRcbiAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IGQuaWQ7XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRyZW5fc3RydWN0W25hbWVdID09PSB1bmRlZmluZWQgfHwgXy5pc0VtcHR5KGNoaWxkcmVuX3N0cnVjdFtuYW1lXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzLnNsaWNlKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAwKSB7IC8vdG9wbGV2ZWwgc3BsaXRcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMucHVzaChkLmlkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKF8uaW5jbHVkZXMoY2hpbGRyZW5fc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzBdXSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQuaWQpKSB7IC8vc3BsaXR0aW5nIGEgZm9jdXMgbm9kZVxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwc1swXSA9IGQuaWQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDEpIHsvL3NwbGl0dGluZyBhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2Nvbm5lY3RlZCBub2RlXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzLnB1c2goZC5pZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChfLmluY2x1ZGVzKGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1sxXV0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQuaWQpKSB7Ly9zcGxpdHRpbmcgYVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29ubmVjdGVkIG5vZGVcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHNbMV0gPSBkLmlkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMiAmJiBcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzWzFdID09PSBkLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vU3BsaXR0aW5nIGEgY29ubmVjdGVkIG5vZGUsIGtlZXAgYWxsIGZvY3VzIG5vZGVzXG4gICAgICAgICAgICAgICAgICAgIHZhciBub2Rlc1RvS2VlcCA9IFtkXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVJZHNUb1Jlc2hvdyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ3JvdXBPbmVOb2RlcyA9IGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV07XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKGdyb3VwT25lTm9kZXMsIG5vZGUuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlkc1RvUmVzaG93LnB1c2gobm9kZS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNUb0tlZXAucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy9NYWtlIHNwbGl0IG5vZGVzIHRoZSBmb2N1cyBhbmQga2VlcCBub2RlcyB0aGF0IGFyZSBjb25uZWN0ZWRcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVzVG9LZWVwID0gW2RdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZUlkc1RvUmVzaG93ID0gW107XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubGlua3MsIGZ1bmN0aW9uKGxpbmspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaW5rLnNvdXJjZSA9PT0gZCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzVG9SZXNob3cuaW5kZXhPZihsaW5rLnRhcmdldC5pZCkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rLnRhcmdldC5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluay50YXJnZXQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzVG9SZXNob3cucHVzaChsaW5rLnRhcmdldC5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNUb0tlZXAucHVzaChsaW5rLnRhcmdldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxpbmsudGFyZ2V0ID09PSBkICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzVG9SZXNob3cuaW5kZXhPZihsaW5rLnNvdXJjZS5pZCkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rLnNvdXJjZS5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluay5zb3VyY2UuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzVG9SZXNob3cucHVzaChsaW5rLnNvdXJjZS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNUb0tlZXAucHVzaChsaW5rLnNvdXJjZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vUmVtb3ZpbmcgbGlua3MgZnJvbSB0aGUgbm9kZSB0byBiZSBzcGxpdFxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2goZnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5pZCAhPT0gZC5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuXG4gICAgICAgICAgICAgICAgLy9kaXNhYmxpbmcgdXBkYXRlIGdyYXBoIHRvIHByZXZlbnQgbmV3IGRhdGEgZnJvbVxuICAgICAgICAgICAgICAgIC8vcmVkcmF3aW5nIGxpbmtzIHdoaWxlIHRoZXJlIGFyZSBhbmltYXRpb25zIGdvaW5nIG9uXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN0YXRlLmRpc2FibGVVcGRhdGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2goZnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5pZCAhPT0gZC5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLnRyYW5zaXRpb24oKS5kZWxheSgyMDApLmR1cmF0aW9uKDQwMCkuc3R5bGUoXCJvcGFjaXR5XCIsIDApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9kaXNhYmxpbmcgcXRpcCBpZiBpbnN0YWxsZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkKHRoaXMpLnF0aXAgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykucXRpcCgnZGlzYWJsZScsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgdHJhbnNsYXRlID0gdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKCk7XG4gICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKTtcbiAgICAgICAgICAgICAgICB2YXIgeExvYyA9IChwYXJzZUZsb2F0KHRoaXNHcmFwaC5zdmcuc3R5bGUoXCJ3aWR0aFwiKSkgLyBzY2FsZSkgLyAyICArIHRyYW5zbGF0ZVswXTtcbiAgICAgICAgICAgICAgICB2YXIgeUxvYyA9IChwYXJzZUZsb2F0KHRoaXNHcmFwaC5zdmcuc3R5bGUoXCJoZWlnaHRcIikpIC8gc2NhbGUpLyAyICArIHRyYW5zbGF0ZVsxXTtcbiAgICAgICAgICAgICAgICBkLnhTdGFydCA9IGQueDtcbiAgICAgICAgICAgICAgICBkLnlTdGFydCA9IGQueTtcbiAgICAgICAgICAgICAgICBkLnggPSB4TG9jO1xuICAgICAgICAgICAgICAgIGQueSA9IHlMb2M7XG4gICAgICAgICAgICAgICAgZDNub2RlLnRyYW5zaXRpb24oXCJub2RlUG9zaXRpb25UcmFuc2l0aW9uXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZHVyYXRpb24oNzUwKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHJUd2VlbihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHhTdGFydCA9IGQueFN0YXJ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB5U3RhcnQgPSBkLnlTdGFydDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnhTdGFydCA9IGQueDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnlTdGFydCA9IGQueTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZDMuaW50ZXJwb2xhdGVTdHJpbmcoXCJ0cmFuc2xhdGUoXCIgKyB4U3RhcnQgKyBcIixcIiArIHlTdGFydCArIFwiKVwiLCBcInRyYW5zbGF0ZShcIiArIGQueCArIFwiLFwiICsgZC55ICsgXCIpXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3BsaXROb2RlRnVuYyA9IHN1cGVyLnNwbGl0Tm9kZTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5ub2RlSWRzVG9SZXNob3cgPSBub2RlSWRzVG9SZXNob3c7XG4gICAgICAgICAgICAgICAgLy93YWl0aW5nIGZvciBub2RlIHRyYW5zaXRpb25cbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzID0gbm9kZXNUb0tlZXA7XG4gICAgICAgICAgICAgICAgICAgIHNwbGl0Tm9kZUZ1bmMuY2FsbCh0aGlzUG9saWN5LCBkKTtcbiAgICAgICAgICAgICAgICB9LCA3NTApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRvIGJlIGNhbGxlZCBhZnRlciB0aGUgZ3JhcGggaXMgc3BsaXQuXG4gICAgICAgICAgICAgKiBCcmluZ3MgYWxsIG5vZGVzIGJhY2sgaW50byB2aWV3IGFuZCBzZXRzIHRoZWlyIGF0dHJpYnV0ZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlR3JhcGhDYWxsYmFjaygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5lYWNoKGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS50cmFuc2l0aW9uKCkuZHVyYXRpb24oNDAwKS5zdHlsZShcIm9wYWNpdHlcIiwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykuY2xhc3NlZChcImZvY3VzXCIsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5jbGFzc2VkKFwiY29ubmVjdGVkXCIsIGZhbHNlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuU3BsaXRKb2luVmlld1BvbGljeSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID09PSBcImZvY3VzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLmNsYXNzZWQoXCJmb2N1c1wiLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vZGUuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID09PSBcImNvbm5lY3RlZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5jbGFzc2VkKFwiY29ubmVjdGVkXCIsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgc3RhdGUubm9kZUlkc1RvUmVzaG93ID0gbnVsbDtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSYW5kb21seSBzZXRzIHRoZSBwb3NpdGlvbnMgb2YgYW55IHVuc2V0IG5vZGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc2V0UG9zaXRpb25zKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5ID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGhDb25zdHMgPSB0aGlzR3JhcGguY29uc3RzO1xuXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IGdyYXBoQ29uc3RzLmRpc3BsYXlPZmZzZXQ7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgICAgIHZhciByZXQgPSB0aGlzUG9saWN5LmQzRm9yY2VCb3VuZHMuY2FsbCh0aGlzR3JhcGgpO1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0UmFuZG9tSW50KG1pbiwgbWF4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluICsgMSkpICsgbWluO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIF8uZm9yRWFjaChub2RlcywgZnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS54ID09IG51bGwgfHwgbm9kZS55ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4ID0gZ2V0UmFuZG9tSW50KG5vZGUucmFkaXVzICsgb2Zmc2V0LCByZXQud2lkdGggLSBub2RlLnJhZGl1cyAtIG9mZnNldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgeSA9IGdldFJhbmRvbUludChub2RlLnJhZGl1cyArIG9mZnNldCwgcmV0LmhlaWdodCAtIG5vZGUucmFkaXVzIC0gb2Zmc2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUueCA9IHg7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLnkgPSB5O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgb24gdGhlIHN0YXJ0IG9mIHRoZSBkMyBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKiBXaWxsIG92ZXJyaWRlIHRoZSBtZXRob2Qgb2YgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKiBcInRoaXNcIiBwb2ludHMgdG8gdGhlIGdyYXBoXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGQzRm9yY2VTdGFydCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlc1xuICAgICAgICAgICAgICAgICAgICAuYXR0cignY3gnLCBmdW5jdGlvbihkKSB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQueFN0YXJ0ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnhTdGFydCA9IChkLnhTdGFydCAqIHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCkpICsgdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKClbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC54O1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY3knLCBmdW5jdGlvbihkKSB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQueVN0YXJ0ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnlTdGFydCA9IChkLnlTdGFydCAqdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKSkgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKVsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd4MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLnk7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd4MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lnk7IH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBvbiB0aGUgc3RhcnQgb2YgdGhlIGQzIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqIFdpbGwgb3ZlcnJpZGUgdGhlIG1ldGhvZCBvZiB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqIFwidGhpc1wiIHBvaW50cyB0byB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZUVuZCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5ID0gc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGVQb2xpY3kubGF5b3V0RGVmYXVsdCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWZhdWx0TGF5b3V0ID0ge307XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRMYXlvdXRbbi5pZF0gPSB7eDpuLngsIHk6bi55fTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5LmxheW91dERlZmF1bHQgPSBkZWZhdWx0TGF5b3V0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2NhbGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdHJhbnNsYXRlID0gdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5Lnpvb21EZWZhdWx0ID0gW3RyYW5zbGF0ZSwgc2NhbGVdOyBcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlc1xuICAgICAgICAgICAgICAgICAgICAuYXR0cignY3gnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjeScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQueTsgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHMuYXR0cigneDEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS55OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneDInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC55OyB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBXaWxsIGJlIGNhbGxlZCBkdXJpbmcgRDMgZm9yY2Ugc2ltdWxhdGlvbnNcbiAgICAgICAgICAgICAqIGJ5IHRoZSBncmFwaCwgc28gXCJ0aGlzXCIgd2lsbCBwb2ludCB0byB0aGUgZ3JhcGggb2JqZWN0XG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge251bWJlcn0gIHdpZHRoICAgRDMgTGF5b3V0IFdpZHRoXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgaGVpZ2h0ICBEMyBMYXlvdXQgSGVpZ2h0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGQzRm9yY2VUaWNrKGUsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5ID0gc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSBjb25zdHMuZGlzcGxheU9mZnNldDtcbiAgICAgICAgICAgICAgICB2YXIgc2NhbGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpO1xuXG4gICAgICAgICAgICAgICAgLy8gTW92ZSBub2RlcyB0b3dhcmQgY2x1c3RlciBmb2N1cy5cbiAgICAgICAgICAgICAgICB2YXIgZm9jaSA9IHN0YXRlUG9saWN5LmZvY2k7XG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ3Jhdml0eShhbHBoYSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZvY2kubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID09PSBcImZvY3VzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55ICs9IChmb2NpWzBdIC0gZC55KSAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSArPSAoZm9jaVsxXSAtIGQueSkgKiBhbHBoYTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC54ICs9ICh3aWR0aC8yIC0gZC54KSAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gKGhlaWdodC8yIC0gZC55KSAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCArPSAod2lkdGgvMiAtIGQueCkgKiBhbHBoYTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBNYWtlIHN1cmUgbm9kZXMgYXJlIHdpdGhpbiBib3VuZHNcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlc1xuICAgICAgICAgICAgICAgICAgICAuZWFjaCh0aGlzLmQzRm9yY2VDb2xsaWRlKC41KSlcbiAgICAgICAgICAgICAgICAgICAgLmVhY2goZ3Jhdml0eSguMiAqIGUuYWxwaGEpKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcImN4XCIsIGZ1bmN0aW9uKGQpIHsgXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC54ID0gTWF0aC5tYXgoKGQucmFkaXVzICsgb2Zmc2V0KS9zY2FsZSwgTWF0aC5taW4od2lkdGggKyAoKC1vZmZzZXQtIGQucmFkaXVzKSAvIHNjYWxlKSwgZC54KSk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiY3lcIiwgZnVuY3Rpb24oZCkgeyBcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLlNwbGl0Sm9pblZpZXdQb2xpY3kgPT0gbnVsbCB8fCBkLlNwbGl0Sm9pblZpZXdQb2xpY3kgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSA9IE1hdGgubWF4KChkLnJhZGl1cyArIG9mZnNldCkvc2NhbGUsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5taW4oaGVpZ2h0ICsgKCgtb2Zmc2V0IC0gZC5yYWRpdXMpL3NjYWxlKSwgZC55KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPT09IFwiZm9jdXNcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSA9IE1hdGgubWF4KGQucmFkaXVzICsgb2Zmc2V0LCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgubWluKChoZWlnaHQgKyAoKC1vZmZzZXQgLSBkLnJhZGl1cykvc2NhbGUpKSpjb25zdHMuU3BsaXRKb2luVmlld1BvbGljeS5ib3VuZGFyeSwgZC55KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPT09IFwiY29ubmVjdGVkXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgPSBNYXRoLm1heCgoaGVpZ2h0ICsgKChvZmZzZXQgLSBkLnJhZGl1cykvc2NhbGUpKSAqY29uc3RzLlNwbGl0Sm9pblZpZXdQb2xpY3kuYm91bmRhcnksIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5taW4oaGVpZ2h0ICsgKCgtb2Zmc2V0IC0gZC5yYWRpdXMpL3NjYWxlKSwgZC55KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHNcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueTsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueTsgfSk7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxjdWxhdGVzIHRoZSBib3VuZGFyaWVzIG9mIHRoZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIFdpbGwgYmUgY2FsbGVkIGR1cmluZyBEMyBmb3JjZSBzaW11bGF0aW9uc1xuICAgICAgICAgICAgICogYnkgdGhlIGdyYXBoLCBzbyBcInRoaXNcIiB3aWxsIHBvaW50IHRvIHRoZSBncmFwaCBvYmplY3RcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHJldHVybiAgICAge09iamVjdH0gICAgICAgICAgUmV0dXJucyBhbiBvYmplY3RcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQgaGFzIHRoZSB3aWR0aFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5kIGhlaWdodCBhcyBcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXMgXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGQzRm9yY2VCb3VuZHMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzLFxuICAgICAgICAgICAgICAgICAgICBjb25zdHNQb2xpY3kgPSBjb25zdHMuU3BsaXRKb2luVmlld1BvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kgPSBzdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXNHcmFwaC5ub2RlcztcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjYWxjTWF4Tm9kZXMod2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYXJlYSA9IHdpZHRoICogaGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmFkaXVzID0gdGhpc0dyYXBoLmNvbnN0cy5zdGFydFJhZGl1cztcbiAgICAgICAgICAgICAgICAgICAgLy90cmVhdGluZyB0aGVtIGFzIGEgc3F1YXJlIGZvciBhcHByb3hcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxlbmd0aCA9IChyYWRpdXMgKjMuNSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhbW91bnQgPSBhcmVhIC8obGVuZ3RoICpsZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYW1vdW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL1RoZSBvZmZzZXQgaXMgdGhlIGJ1ZmZlciBmcm9tIHRoZSBlZGdlc1xuICAgICAgICAgICAgICAgIC8vT3JpZ2luYWwgV2lkdGggYW5kIEhlaWdodCBhcmUgZ2l2ZW4gdG8gdGhlIGZvcmNlIGxheW91dFxuICAgICAgICAgICAgICAgIC8vc28gdGhhdCBpdCBpcyBjZW50ZXJlZCwgYnV0IG5vZGVzIHdpbGwgYmUgZm9yY2VkIHRvIGJlXG4gICAgICAgICAgICAgICAgLy93aXRoaW4gdGhlIG9mZnNldCBib3VuZHNcbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gY29uc3RzLmRpc3BsYXlPZmZzZXQ7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z1dpZHRoID0gcGFyc2VGbG9hdCh0aGlzR3JhcGguc3ZnLnN0eWxlKFwid2lkdGhcIikpO1xuICAgICAgICAgICAgICAgIHZhciBzdmdIZWlnaHQgPSBwYXJzZUZsb2F0KHRoaXNHcmFwaC5zdmcuc3R5bGUoXCJoZWlnaHRcIikpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gc3ZnV2lkdGg7XG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IHN2Z0hlaWdodDtcblxuICAgICAgICAgICAgICAgIHZhciBhbW91bnQgPSBjYWxjTWF4Tm9kZXMod2lkdGggLSAoMipvZmZzZXQpLCBoZWlnaHQgLSAoMipvZmZzZXQpKTtcbiAgICAgICAgICAgICAgICB2YXIgc2NhbGUgPSAxO1xuICAgICAgICAgICAgICAgIGlmIChub2Rlcy5sZW5ndGggPiBhbW91bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NhbGUgPSBhbW91bnQgLyBub2Rlcy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQodGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKCksIHNjYWxlKTtcbiAgICAgICAgICAgICAgICAgICAgd2lkdGggLz0gc2NhbGU7XG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCAvPSBzY2FsZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguem9vbWVkKHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpLCBzY2FsZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9jYWxjdWxhdGluZyBmb2NpIGZvciBzaW11bGF0aW9uXG4gICAgICAgICAgICAgICAgdmFyIGZvY3VzR3JvdXBzID0gc3RhdGVQb2xpY3kuZm9jdXNHcm91cHM7XG4gICAgICAgICAgICAgICAgdmFyIGZvY2k7XG4gICAgICAgICAgICAgICAgaWYgKGZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBmb2NpID0gW2hlaWdodC8yXTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL3NldHRpbmcgZm9jaSBoZWlnaHQgcG9zaXRpb24gYmFzZWQgb24gcGVyY2VudGFnZVxuICAgICAgICAgICAgICAgICAgICB2YXIgZm9jdXNOb2RlcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFtmb2N1c0dyb3Vwc1swXV07XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0c1BvbGljeS5ib3VuZGFyeSA9IGZvY3VzTm9kZXMubGVuZ3RoIC8gbm9kZXMubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdG9wID0gaGVpZ2h0ICogY29uc3RzUG9saWN5LmJvdW5kYXJ5O1xuICAgICAgICAgICAgICAgICAgICB2YXIgYm90ID0gaGVpZ2h0IC0gdG9wO1xuICAgICAgICAgICAgICAgICAgICBpZiAodG9wIDwgMip0aGlzR3JhcGguY29uc3RzLm1heFJhZGl1cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3RzUG9saWN5LmJvdW5kYXJ5ID0gKDIuNSAqIHRoaXNHcmFwaC5jb25zdHMubWF4UmFkaXVzKSAvIGhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvcCA9IGhlaWdodCAqIGNvbnN0c1BvbGljeS5ib3VuZGFyeTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvdCA9IGhlaWdodCAtIHRvcDtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChib3QgPCAyKiB0aGlzR3JhcGguY29uc3RzLm1heFJhZGl1cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3RzUG9saWN5LmJvdW5kYXJ5ID0gMSAtICgoMi41ICogdGhpc0dyYXBoLmNvbnN0cy5tYXhSYWRpdXMpIC8gaGVpZ2h0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvcCA9IGhlaWdodCAqIGNvbnN0c1BvbGljeS5ib3VuZGFyeTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvdCA9IGhlaWdodCAtIHRvcDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmb2NpID0gW3RvcC8yLCB0b3AgKyBib3QgLyAyXTtcblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdGF0ZVBvbGljeS5mb2NpID0gZm9jaTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge3dpZHRoOndpZHRoLCBoZWlnaHQ6aGVpZ2h0fTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgYWZ0ZXIgYSBzaW5nbGUgbm9kZSBpcyBzcGxpdFxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBuZXdOb2RlcyAgVGhlIG5ldyBub2Rlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzcGxpdE5vZGVFdmVudChuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKG5ld05vZGVzLCBmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV0sIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiZm9jdXNcIjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIHRpdGxlID0gbmV3Tm9kZXNbMF0ucGFyZW50O1xuICAgICAgICAgICAgICAgIC8vIHN0YXRlLmZvY3VzR3JvdXAgPSB0aXRsZTtcblxuICAgICAgICAgICAgICAgIC8vaWYgdGhlIGxhc3QgZXZlbnQgaGFzIHRoZSBzYW1lIGlkLCBpdCBtdXN0IGJlIHRoZVxuICAgICAgICAgICAgICAgIC8vb3BwcG9zaXRlIG9mIHRoaXMgZXZlbnQsIHNvIHdlIHJlbW92ZSB0aGF0IGV2ZW50IGZyb21cbiAgICAgICAgICAgICAgICAvL3RoZSBldmVudCBzdGFjay5cbiAgICAgICAgICAgICAgICAvL090aGVyd2lzZSwgd2UgYWRkIHRoZSBldmVudCBvdCB0aGUgc3RhY2tcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCAhPT0gMCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5W3N0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggLSAxXS5pZCA9PT0gdGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5LnBvcCgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeS5wdXNoKHtpZDp0aXRsZSwgZXZlbnQ6J3NwbGl0J30pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5iYWNrQnV0dG9uRWxlbSAhPSBudWxsICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuYmFja0J1dHRvbkVsZW0uZmFkZVRvKCdzbG93JywgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS50aXRsZUVsZW0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ICs9IHN0YXRlLmZvY3VzR3JvdXBzWzBdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0gJyAmICcgKyBzdGF0ZS5mb2N1c0dyb3Vwc1sxXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS50aXRsZUVsZW0udGV4dCh0ZXh0KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3JlLWVuYWJsZSBncmFwaCB1cGRhdGVcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3RhdGUuZGlzYWJsZVVwZGF0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kuc2V0TGF5b3V0KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU2V0cyB0aGUgbGF5b3V0IG9mIHRoZSBub2Rlcy4gXG4gICAgICAgICAgICAgKiBJZiB0aGVyZSBpcyBhIHByZXZpb3VzIGxheW91dCwgaXQgd2lsbCBiZSBsb2FkZWQuXG4gICAgICAgICAgICAgKiBFbHNlLCBpdCB3aWxsIHJ1biBhIEQzIEZvcmNlIHNpbXVsYXRpb24gYW5kIGNyZWF0ZSBvbmUuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNldExheW91dCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG4gICAgICAgICAgICAgICAgdmFyIGxheW91dDtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGxheW91dCA9IHN0YXRlLmxheW91dERlZmF1bHQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciB6b29tID0gc3RhdGUuem9vbURlZmF1bHQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQoem9vbVswXSwgem9vbVsxXSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSBzdGF0ZS56b29tc1tzdGF0ZS5mb2N1c0dyb3Vwc107XG4gICAgICAgICAgICAgICAgICAgIGlmICh6b29tICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQoem9vbVswXSwgem9vbVsxXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ID0gc3RhdGUubGF5b3V0W3N0YXRlLmZvY3VzR3JvdXBzXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAobGF5b3V0ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24obikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvcyA9IGxheW91dFtuLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwb3MgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGxheW91dCwgbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBuLnggPSBwb3MueDtcbiAgICAgICAgICAgICAgICAgICAgICAgIG4ueSA9IHBvcy55O1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoLmNhbGwodGhpc0dyYXBoLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kudXBkYXRlR3JhcGhDYWxsYmFjay5jYWxsKHRoaXNQb2xpY3kpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL05lZWQgdG8gcnVuIGEgZm9yY2Ugc2ltdWxhdGlvbiBhcyB0aGlzIGxheW91dFxuICAgICAgICAgICAgICAgICAgICAvL2hhc24ndCBiZWVuIGRvbmUgYmVmb3JlXG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZS5pbml0Rm9yY2UgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhpc1BvbGljeS5zZXRQb3NpdGlvbnMoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51cGRhdGVHcmFwaENhbGxiYWNrLmNhbGwodGhpc1BvbGljeSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS56b29tc1tzdGF0ZS5mb2N1c0dyb3Vwc10gPSBbdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCldO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGF5b3V0ID0ge307XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dFtuLmlkXSA9IHt4Om4ueCwgeTpuLnl9O1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUubGF5b3V0W3N0YXRlLmZvY3VzR3JvdXBzXSA9IGxheW91dDtcbiAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIE92ZXJyaWRpbmcgZnJvbSBzdXBlciBjbGFzcyBzbyB0aGF0IHdlIGNhbiBoYXZlXG4gICAgICAgICAgICAgKiB0b3AgbGV2ZWwgbm9kZXMgcmVhcHBlYXIgd2hlbiB0aGV5IGFyZSBoaWRkZW5cbiAgICAgICAgICAgICAqIGR1ZSB0byB0aGVyZSBiZWluZyB0d28gZm9jdXMgZ3JvdXBzLlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gICAgICAgICAgbm9kZSAgICBUaGUgbm9kZSB0byBqb2luXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7Tm9kZX0gIFRoZSBuZXcgbm9kZSBhZnRlciB0aGUgam9pblxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBfX2pvaW5Ob2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVTdXBlciA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5Ob2RlUG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgLy9jaGVjayB0aGF0IG5vZGUgc3RpbGwgZXhpc3RzXG4gICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG5vZGUpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gbm9kZS5pZDtcbiAgICAgICAgICAgICAgICAvL2lmIGl0IGhhcyBubyBhbmNlc3Rvciwgbm90aGluZyB0byBqb2luXG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbC5pbmRleE9mKG5hbWUpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBub2RlLnBhcmVudDtcbiAgICAgICAgICAgICAgICB2YXIgdG9fYmVfZGVsZXRlZCA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBub2RlTmFtZVNldCA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpc0dyYXBoLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgbm9kZSB3b24ndCBiZSBjb2xsYXBzZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5ub2Rlc1tpXS5hbmNlc3RvcnMuaW5kZXhPZihub2RlLnBhcmVudCkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVOYW1lU2V0LnB1c2godGhpc0dyYXBoLm5vZGVzW2ldLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvX2JlX2RlbGV0ZWQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZV9pZCA9IG5vZGUucGFyZW50O1xuICAgICAgICAgICAgICAgIG5vZGVOYW1lU2V0LnB1c2gobm9kZS5wYXJlbnQpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFuY2VzdG9yc19zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5hbmNlc3RvcnNfc3RydWN0O1xuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgLy8gLSBzZXR0aW5nIGZvY3VzR3JvdXBzIC1cbiAgICAgICAgICAgICAgICAvL2VpdGhlciByZXBsYWNpbmcgb25lIG9mIHRoZSBncm91cHMsXG4gICAgICAgICAgICAgICAgLy9vciBqb2luaW5nIGJhY2sgaW50byBhIHRvcCBsZXZlbCwgc28gdGhlcmUgaXMgb25seVxuICAgICAgICAgICAgICAgIC8vb25lIGZvY3VzXG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gc3RhdGUuZm9jdXNHcm91cHMuaW5kZXhPZihwYXJlbnQpO1xuICAgICAgICAgICAgICAgIGlmIChhbmNlc3RvcnNfc3RydWN0W3BhcmVudF0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwc1tpbmRleF0gPSBhbmNlc3RvcnNfc3RydWN0W3BhcmVudF07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL25hbWVUb0FkZCBhcmUgdG9wIGxldmVsIG5vZGVzIHRoYXQgYXJlIHRvIGJlIGFkZGVkXG4gICAgICAgICAgICAgICAgLy90byB0aGUgZ3JhcGguXG4gICAgICAgICAgICAgICAgdmFyIG5hbWVUb0FkZCA9IFtdO1xuICAgICAgICAgICAgICAgIC8vd2lsbCBvbmx5IG5lZWQgdG8gYWRkIGEgdG9wIGxldmVsIG5vZGUgaWYgdGhlcmUgaXNcbiAgICAgICAgICAgICAgICAvL29ubHkgb25lIGZvY3VzXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAvL0FkZCBvbmx5IHRob3N0IHRoYXQgYXJlbid0IGFuIGFuY2VzdG9yIG9mIHRoZSBub2RlXG4gICAgICAgICAgICAgICAgICAgIC8vdG8gam9pbiwgdGhlIGZvY3VzIGdyb3VwIG9yIGFuIGFuY2VzdG9yIG9mIGl0LFxuICAgICAgICAgICAgICAgICAgICAvL2FuZCBhcmVuJ3QgYWxyZWFkeSBpbiBub2RlTmFtZVNldC5cbiAgICAgICAgICAgICAgICAgICAgLy9nZXQgZmxvdyBiZXR3ZWVuIHRvcCBsZXZlbCBhcyBsb25nIGFzXG4gICAgICAgICAgICAgICAgICAgIC8vdGhlIHRvcCBsZXZlbCBpc24ndCBhbiBhbmNlc3RvciBvZiB0aGVcbiAgICAgICAgICAgICAgICAgICAgLy9mb2N1cyBncm91cCwgYW5kIGlzbid0IGFscmVhZHkgcGFydCBvZiB0aGVcbiAgICAgICAgICAgICAgICAgICAgLy9ub2RlIHNldDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFuY2VzdG9ycyA9IGFuY2VzdG9yc19zdHJ1Y3Rbbm9kZS5pZF07XG4gICAgICAgICAgICAgICAgICAgIGFuY2VzdG9ycy5wdXNoKHN0YXRlLmZvY3VzR3JvdXBzWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgLy90aGUgb3IgZW1wdHkgYXJyYXkgaXMgdG8gcHJldmVudCBjb25jYXRlbmF0aW5nIGEgbnVsbFxuICAgICAgICAgICAgICAgICAgICAvL29yIHVuZGVmaW5lZCB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICBhbmNlc3RvcnMgPSBhbmNlc3RvcnMuY29uY2F0KGFuY2VzdG9yc19zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dIHx8IFtdKTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKGNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbCwgZnVuY3Rpb24obikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFuY2VzdG9ycy5pbmRleE9mKG4pID09PSAtMSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlTmFtZVNldC5pbmRleE9mKG4pID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkLnB1c2gobik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBub2RlTmFtZVNldCA9IG5vZGVOYW1lU2V0LmNvbmNhdChuYW1lVG9BZGQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vbm8gZm9jdXMgZ3JvdXBzIG1lYW5zIHdlIGFyZSBhdCB0b3AgbGV2ZWxcbiAgICAgICAgICAgICAgICAgICAgLy9TaG91bGQgYWRkIGFueSB0b3AgbGV2ZWwgbm9kZXMgdGhhdCBhcmVuJ3RcbiAgICAgICAgICAgICAgICAgICAgLy9hbHJlYWR5IHRoZXJlXG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChjaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwsIGZ1bmN0aW9uKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlTmFtZVNldC5pbmRleE9mKG4pID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkLnB1c2gobik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBub2RlTmFtZVNldCA9IG5vZGVOYW1lU2V0LmNvbmNhdChuYW1lVG9BZGQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vZm9ybWF0dGluZyBkYXRhXG4gICAgICAgICAgICAgICAgdmFyIHJhZGl1cyA9IG5vZGUucmFkaXVzIC8gdGhpc0dyYXBoLmNvbnN0cy5yYWRpdXNEZWNheTsgXG4gICAgICAgICAgICAgICAgdmFyIHhMb2MgPSBub2RlLng7XG4gICAgICAgICAgICAgICAgdmFyIHlMb2MgPSBub2RlLnk7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IG5vZGUuYW5jZXN0b3JzWzFdO1xuICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnMgPSBub2RlLmFuY2VzdG9ycy5zbGljZSgxKTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3Tm9kZSA9IG5ldyBWaXN1YWxpemVyTm9kZS5Ob2RlKHhMb2MsIHlMb2MsIG5ld19ub2RlX2lkLCBuZXdfbm9kZV9pZCwgcmFkaXVzLCBwYXJlbnQsIGFuY2VzdG9ycyk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnB1c2gobmV3Tm9kZSk7XG5cbiAgICAgICAgICAgICAgICAvL3JlbW92ZSBhbGwgbm9kZXMgdGhhdCB3aWxsIGJlIGpvaW5lZFxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdG9fYmVfZGVsZXRlZC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZV90b19kZWxldGUgPSB0b19iZV9kZWxldGVkW2ldO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMuc3BsaWNlKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG5vZGVfdG9fZGVsZXRlKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zcGxpY2VMaW5rc0Zvck5vZGUobm9kZV90b19kZWxldGUpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciByZXREYXRhID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuZ2V0Rmxvd0JldHdlZW5TZXQobm9kZU5hbWVTZXQpO1xuICAgICAgICAgICAgICAgIC8vaG9sZHMgdGhlIG5vZGVEYXRhIHdoaWNoIHdpbGwgYmUgcHJvY2Vzc2VkXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzVG9Qcm9jZXNzID0gW107XG4gICAgICAgICAgICAgICAgLy9maW5kaW5nIHRoZSBub2RlIGRhdGEgdGhhdCBjb3JyZXNwb25kcyB0byB0aGUgdG9wIGxldmVsXG4gICAgICAgICAgICAgICAgLy9ub2RlcyB0byBhZGQgLSBuYW1lVG9BZGQuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVEYXRhID0gcmV0RGF0YS5ub2RlRGF0YTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVEYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuYW1lVG9BZGQuaW5kZXhPZihub2RlRGF0YVtpXS5pZCkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1RvUHJvY2Vzcy5wdXNoKG5vZGVEYXRhW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vVGhlIHRvcCBsZXZlbCBub2RlcyB0aGF0IGFyZSBhZGRlZFxuICAgICAgICAgICAgICAgIHZhciBuZXdOb2RlcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NOb2RlRGF0YShub2Rlc1RvUHJvY2Vzcyk7XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKG5ld05vZGVzLCBmdW5jdGlvbihuKSB7XG4gICAgICAgICAgICAgICAgICAgIG4ucmFkaXVzID0gbi5yYWRpdXMgfHwgdGhpc0dyYXBoLmNvbnN0cy5zdGFydFJhZGl1cztcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMgPSB0aGlzR3JhcGgubm9kZXMuY29uY2F0KG5ld05vZGVzKTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YShyZXREYXRhLmxpbmtEYXRhLCB0aGlzR3JhcGgubm9kZXMpO1xuICAgICAgICAgICAgICAgIC8vT25seSBrZWVwIHRvcCBsZXZlbCBub2RlcyB0aGF0IGhhdmUgY29ubmVjdGlvbnMgdG9cbiAgICAgICAgICAgICAgICAvL3RoZSBjdXJyZW50IGZvY3VzIGdyb3VwXG4gICAgICAgICAgICAgICAgLy93ZSByZW1vdmUgdGhlIG5vZGUgbmFtZSBmcm9tIG5hbWVUb0FkZCBpZiB3ZSBhcmVcbiAgICAgICAgICAgICAgICAvL2tlZXBpbmcgaXRcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubGlua3MsIGZ1bmN0aW9uKGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vY2hlY2tpbmcgaWYgdGhlcmUgZXhpc3RzIGEgbGluayB0b3VjaGluZyBlYWNoIG9mIG5hbWVUb0FkZFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWVUb0FkZC5pbmRleE9mKGwuc291cmNlLmlkKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHNbMF0gPT09IGwudGFyZ2V0LnBhcmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lVG9BZGQuc3BsaWNlKG5hbWVUb0FkZC5pbmRleE9mKGwuc291cmNlLmlkKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChuYW1lVG9BZGQuaW5kZXhPZihsLnRhcmdldC5pZCkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzWzBdID09PSBsLnNvdXJjZS5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkLnNwbGljZShuYW1lVG9BZGQuaW5kZXhPZihsLnRhcmdldC5pZCksIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL1dlIHdhbnQgdG8ga2VlcCB0aGVtIGFsbFxuICAgICAgICAgICAgICAgICAgICAvL3NpbmNlIGFueSBsZWZ0IGluIG5hbWVUb0FkZCB3aWxsIGJlIHJlbW92ZWQsXG4gICAgICAgICAgICAgICAgICAgIC8vd2UgcmVzZXQgbmFtZVRvQWRkIGhlcmUuXG4gICAgICAgICAgICAgICAgICAgIG5hbWVUb0FkZCA9IFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvL3doYXRldmVyIGlzIHJlbWFpbmluZyBpbiBuYW1lVG9BZGQgaXNuJ3QgY29ubmVjdGVkXG4gICAgICAgICAgICAgICAgLy90byB0aGUgZm9jdXMgZ3JvdXAsIHNvIHdlIHNob3VsZCByZW1vdmUgaXQuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVUb1JlbW92ZSA9IFtdO1xuICAgICAgICAgICAgICAgIGlmIChuYW1lVG9BZGQubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpc0dyYXBoLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmFtZVRvQWRkLmluZGV4T2YodGhpc0dyYXBoLm5vZGVzW2ldLmlkKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lVG9BZGQuc3BsaWNlKG5hbWVUb0FkZC5pbmRleE9mKHRoaXNHcmFwaC5ub2Rlc1tpXS5pZCksIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zcGxpY2VMaW5rc0Zvck5vZGUodGhpc0dyYXBoLm5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlVG9SZW1vdmUucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuYW1lVG9BZGQubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfLmZvckVhY2gobm9kZVRvUmVtb3ZlLCBmdW5jdGlvbihuKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5zcGxpY2UodGhpc0dyYXBoLm5vZGVzLmluZGV4T2YobiksIDEpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXROb2RlcygpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0TGlua3MoKTtcblxuICAgICAgICAgICAgICAgIHN0YXRlU3VwZXIuc3BsaXROb2Rlcy5zcGxpY2Uoc3RhdGVTdXBlci5zcGxpdE5vZGVzLmluZGV4T2YobmV3Tm9kZS5pZCksIDEpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ld05vZGU7IFxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBhIHNpbmdsZSBub2RlIGlzIGpvaW5lZFxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBJZiB0aGUgZm9jdXMgZ3JvdXAgaGFzIGJlZW4gc2VlbiBiZWZvcmUsIGl0IHdpbGxcbiAgICAgICAgICAgICAqIGxvYWQgdGhhdCBsYXlvdXQuIE90aGVyd2lzZSwgaXQgd2lsbCBydW4gYSBkMyBmb3JjZVxuICAgICAgICAgICAgICogc2ltdWxhdGlvbiB0byBnZW5lcmF0ZSBvbmUuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBuZXdOb2RlICBUaGUgbmV3IG5vZGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgam9pbk5vZGVFdmVudChuZXdOb2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kgPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgLy9pZiB0aGUgbGFzdCBldmVudCBoYXMgdGhlIHNhbWUgaWQsIGl0IG11c3QgYmUgdGhlXG4gICAgICAgICAgICAgICAgLy9vcHBwb3NpdGUgb2YgdGhpcyBldmVudCwgc28gd2UgcmVtb3ZlIHRoYXQgZXZlbnQgZnJvbVxuICAgICAgICAgICAgICAgIC8vdGhlIGV2ZW50IHN0YWNrLlxuICAgICAgICAgICAgICAgIC8vT3RoZXJ3aXNlLCB3ZSBhZGQgdGhlIGV2ZW50IHRvIHRoZSBzdGFja1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoICE9PSAwICYmXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeVtzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoIC0gMV0uaWQgPT09IG5ld05vZGUuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5LnBvcCgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeS5wdXNoKHtpZDpuZXdOb2RlLmlkLCBldmVudDonam9pbid9KVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG5cbiAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoXy5pbmNsdWRlcyhjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImZvY3VzXCI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiY29ubmVjdGVkXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vc2V0dGluZyBiYWNrIGJ1dHRvblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5iYWNrQnV0dG9uRWxlbSAhPSBudWxsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uRWxlbS5mYWRlVG8oJ3Nsb3cnLCAwKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3NldHRpbmcgdGl0bGVcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUudGl0bGVFbGVtICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSBzdGF0ZS5mb2N1c0dyb3Vwc1swXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ICs9ICcgJiAnICsgc3RhdGUuZm9jdXNHcm91cHNbMV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc3RhdGUudGl0bGVFbGVtLnRleHQodGV4dCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kuc2V0TGF5b3V0KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVW5kb2VzIHRoZSBsYXN0IHNwbGl0IG9yIGpvaW4gZXZlbnQuXG4gICAgICAgICAgICAgKiBNZWFudCB0byBiZSBjYWxsZWQgYnkgdGhlIGJhY2sgYnV0dG9uLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1bmRvTGFzdEV2ZW50KCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5ID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIHZhciBsYXN0ID0gc3RhdGUuZXZlbnRIaXN0b3J5W3N0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgICB2YXIgaWQgPSBsYXN0LmlkO1xuICAgICAgICAgICAgICAgIHZhciBub2RlO1xuICAgICAgICAgICAgICAgIGlmIChsYXN0LmV2ZW50ID09PSAnam9pbicpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZSA9IHRoaXNHcmFwaC5maW5kTm9kZUJ5SWQoaWQpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZDNub2RlID0gdGhpc0dyYXBoLmZpbmREM05vZGUoaWQpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LmRibGNsaWNrKGQzbm9kZSwgbm9kZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVJZCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFtpZF1bMF07XG4gICAgICAgICAgICAgICAgICAgIG5vZGUgPSB0aGlzR3JhcGguZmluZE5vZGVCeUlkKG5vZGVJZCk7XG4gICAgICAgICAgICAgICAgICAgIHN1cGVyLmpvaW5Ob2RlLmNhbGwodGhpc1BvbGljeSwgbm9kZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIFBvbGljeTogU3BsaXRKb2luVmlld1BvbGljeVxuICAgICAgICB9XG59XSk7XG5cblxuXG5cblxuXG5cbiIsIid1c2Ugc3RyaWN0Jztcbi8vIERlY2xhcmUgYXBwIGxldmVsIG1vZHVsZSB3aGljaCBkZXBlbmRzIG9uIHZpZXdzLCBhbmQgY29tcG9uZW50c1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdkFwcCcsIFtcbiAgICAndWkucm91dGVyJyxcbiAgICAnY29udGl2LmxvZ2luJyxcbiAgICAnY29udGl2Lm1lbnUnLFxuICAgICdjb250aXYuZGFzaGJvYXJkJyxcbiAgICAnY29udGl2LmFwcGxpY2F0aW9uZ3JvdXBzJyxcbiAgICAnY29udGl2Lm5ldHdvcmtzJyxcbiAgICAnY29udGl2Lm5ldHdvcmtwb2xpY2llcycsXG4gICAgJ2NvbnRpdi5zdG9yYWdlcG9saWNpZXMnLFxuICAgICdjb250aXYuc2VydmljZWxicycsXG4gICAgJ2NvbnRpdi52b2x1bWVzJyxcbiAgICAnY29udGl2Lm5vZGVzJyxcbiAgICAnY29udGl2Lm9yZ2FuaXphdGlvbnMnLFxuICAgICdjb250aXYuc2V0dGluZ3MnLFxuICAgICdjb250aXYudmlzdWFsaXphdGlvbidcbl0pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgJyR1cmxSb3V0ZXJQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdicsIHtcbiAgICAgICAgICAgIHVybDogJycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgZmx1aWQgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSk7XG4gICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE5LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm1lbnUnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudScsIHtcbiAgICAgICAgICAgIHVybDogJy9tJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbWVudS9tZW51Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ01lbnVDdHJsIGFzIG1lbnVDdHJsJyxcbiAgICAgICAgICAgIHBhcmFtczogeyB1c2VybmFtZTogbnVsbCB9XG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdNZW51Q3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcykge1xuICAgICAgICB2YXIgbWVudUN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBsb2dvdXQoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5sb2dpbicpO1xuICAgICAgICB9XG4gICAgICAgIG1lbnVDdHJsLnVzZXJuYW1lID0gJHN0YXRlUGFyYW1zLnVzZXJuYW1lO1xuICAgICAgICBtZW51Q3RybC5sb2dvdXQgPSBsb2dvdXQ7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bWVudUN0cmwuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmZhY3RvcnkoJ0JncFNlcnZpY2UnLCBbJyRodHRwJywgJyRxJywgZnVuY3Rpb24gKCRodHRwLCAkcSkge1xuICAgICAgICBmdW5jdGlvbiBnZXRCZ3AoY3RybCkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLkJHUFNfRU5EUE9JTlQgKyBjdHJsLmtleSArICcvJztcbiAgICAgICAgICAgICRodHRwLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgIGN0cmwubmVpZ2hib3IgPSByZXN1bHQuZGF0YTtcbiAgICAgICAgICAgICAgICBjdHJsLm5laWdoYm9ycy5wdXNoKHsgJ25hbWUnOiBjdHJsLm5laWdoYm9yWyduZWlnaGJvciddLCAndmFsdWUnOiBjdHJsLm5laWdoYm9yWyduZWlnaGJvci1hcyddIH0pO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVCZ3AoY3RybCkge1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuQkdQU19FTkRQT0lOVCArIGN0cmwua2V5ICsgJy8nO1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QodXJsLCBjdHJsLm5laWdoYm9yKTtcbiAgICAgICAgfVxuICAgICAgICA7XG4gICAgICAgIGZ1bmN0aW9uIGdldEJncEluc3BlY3Qoa2V5KSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuQkdQU19JTlNQRUNUX0VORFBPSU5UICsga2V5ICsgJy8nO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRCZ3A6IGdldEJncCxcbiAgICAgICAgICAgIHVwZGF0ZUJncDogdXBkYXRlQmdwLFxuICAgICAgICAgICAgZ2V0QmdwSW5zcGVjdDogZ2V0QmdwSW5zcGVjdFxuICAgICAgICB9O1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJncHNlcnZpY2UuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoXCJjb250aXYubm9kZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2TG9nc1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9sb2dzLmh0bWwnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgbG9nOiBcIj1cIixcbiAgICAgICAgICAgIHRpdGxlOiBcIkBcIlxuICAgICAgICB9XG4gICAgfTtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bG9nc2RpcmVjdGl2ZS5qcy5tYXAiLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJylcbiAgICAuZmFjdG9yeSgnTG9nU2VydmljZScsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbiAoJGh0dHAsICRxKSB7XG4gICAgICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUxvZ3MoKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuTk9ERVNfQUNUSVZFX0pPQl9FTkRQT0lOVDtcbiAgICAgICAgICAgICRodHRwLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnZXRMYXN0TG9ncygpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5OT0RFU19MQVNUX0pPQl9FTkRQT0lOVDtcbiAgICAgICAgICAgICRodHRwLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0QWN0aXZlTG9nczogZ2V0QWN0aXZlTG9ncyxcbiAgICAgICAgICAgIGdldExhc3RMb2dzOiBnZXRMYXN0TG9nc1xuICAgICAgICB9O1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxvZ3NlcnZpY2UuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmFjdGl2ZWxvZycsIHtcbiAgICAgICAgICAgIHVybDogJy9hY3RpdmVsb2cnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVBY3RpdmVKb2JMb2dzQ3RybCBhcyBub2RlQWN0aXZlSm9iTG9nc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8Y3R2LWxvZ3MgdGl0bGU9XCJBY3RpdmUgSm9iXCIgbG9nPVwibm9kZUFjdGl2ZUpvYkxvZ3NDdHJsLmFjdGl2ZUxvZ3NcIj48L2N0di1sb2dzPidcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVBY3RpdmVKb2JMb2dzQ3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICdMb2dTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsIExvZ1NlcnZpY2UpIHtcbiAgICAgICAgdmFyIG5vZGVBY3RpdmVKb2JMb2dzQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUxvZ3MoKSB7XG4gICAgICAgICAgICBMb2dTZXJ2aWNlLmdldEFjdGl2ZUxvZ3MoKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBub2RlQWN0aXZlSm9iTG9nc0N0cmwuYWN0aXZlTG9ncyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy9PbmNlIHRoZSBqb2IgZmluaXNoZXMsIGVuZHBvaW50IHJldHVybnMgNTAwIGVycm9yLiBTbyByZXNldCB0aGUgYWN0aXZlTG9nc1xuICAgICAgICAgICAgICAgIG5vZGVBY3RpdmVKb2JMb2dzQ3RybC5hY3RpdmVMb2dzID0ge1xuICAgICAgICAgICAgICAgICAgICBkZXNjOiAnVGhlcmUgaXMgY3VycmVudGx5IG5vIGFjdGl2ZSBqb2IuIENoZWNrIExhc3QgSm9iIGZvciBhIGpvYiB0aGF0IHJlY2VudGx5IGZpbmlzaGVkLidcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZ2V0QWN0aXZlTG9ncygpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0QWN0aXZlTG9ncygpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bm9kZWFjdGl2ZWpvYmxvZ3NjdHJsLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8yNS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmNvbW1pc3Npb24nLCB7XG4gICAgICAgICAgICB1cmw6ICcvY29tbWlzc2lvbi86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlQ29tbWlzc2lvbkN0cmwgYXMgbm9kZUNvbW1pc3Npb25DdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWNvbW1pc3Npb24uaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVDb21taXNzaW9uQ3RybCcsIFtcbiAgICAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdOb2Rlc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJywgJ05vZGVzU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBOb2Rlc01vZGVsLCBDUlVESGVscGVyU2VydmljZSwgTm9kZXNTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBub2RlQ29tbWlzc2lvbkN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub05vZGVEZXRhaWxzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLmluZm8nLCB7ICdrZXknOiAkc3RhdGVQYXJhbXMua2V5IH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbENvbW1pc3Npb25pbmdOb2RlKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9Ob2RlRGV0YWlscygpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNvbW1pc3Npb24oKSB7XG4gICAgICAgICAgICBpZiAobm9kZUNvbW1pc3Npb25DdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIobm9kZUNvbW1pc3Npb25DdHJsKTtcbiAgICAgICAgICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwubm9kZU9wc09iai5ub2RlcyA9IFskc3RhdGVQYXJhbXMua2V5XTtcbiAgICAgICAgICAgICAgICBOb2Rlc1NlcnZpY2UuY2xlYW51cEV4dHJhVmFycyhub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgICAgICAgICAgICAgIE5vZGVzU2VydmljZS5jcmVhdGVFeHRyYVZhcnMobm9kZUNvbW1pc3Npb25DdHJsKTtcbiAgICAgICAgICAgICAgICBOb2Rlc01vZGVsLmNvbW1pc3Npb24obm9kZUNvbW1pc3Npb25DdHJsLm5vZGVPcHNPYmopLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvTm9kZURldGFpbHMoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihub2RlQ29tbWlzc2lvbkN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLm5vZGVPcHNPYmogPSB7fTtcbiAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLmV4dHJhX3ZhcnMgPSB7fTsgLy9UT0RPIEludGlhbGl6ZSBmcm9tIGdsb2JhbCBzZXR0aW5nc1xuICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuYW5zaWJsZVZhcmlhYmxlcyA9IFtdO1xuICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuZW52VmFyaWFibGVzID0gW107XG4gICAgICAgIE5vZGVzU2VydmljZS5nZXRTZXR0aW5ncyhub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuY2FuY2VsQ29tbWlzc2lvbmluZ05vZGUgPSBjYW5jZWxDb21taXNzaW9uaW5nTm9kZTtcbiAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLmNvbW1pc3Npb24gPSBjb21taXNzaW9uO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVjb21taXNzaW9uY3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMjUvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZURldGFpbHNDdHJsIGFzIG5vZGVEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVkZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMuaW5mbycsIHtcbiAgICAgICAgICAgIHVybDogJy9pbmZvJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGV0YWlsc0N0cmwgYXMgbm9kZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWluZm8uaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMuZGV0YWlscy5zdGF0cycsIHtcbiAgICAgICAgICAgIHVybDogJy9zdGF0cycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZURldGFpbHNDdHJsIGFzIG5vZGVEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVzdGF0cy5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLmxvZ3MnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbG9ncycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZURldGFpbHNDdHJsIGFzIG5vZGVEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVsb2dzLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMuZWRpdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9lZGl0JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGV0YWlsc0N0cmwgYXMgbm9kZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWluZm8uaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVEZXRhaWxzQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICckc2NvcGUnLCAnJGludGVydmFsJywgJ05vZGVzTW9kZWwnLCAnQmdwU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCAkc2NvcGUsICRpbnRlcnZhbCwgTm9kZXNNb2RlbCwgQmdwU2VydmljZSkge1xuICAgICAgICB2YXIgbm9kZURldGFpbHNDdHJsID0gdGhpcztcbiAgICAgICAgbm9kZURldGFpbHNDdHJsLm51bWJlcnBhdHRlcm4gPSBDb250aXZHbG9iYWxzLk5VTUJFUl9SRUdFWDtcbiAgICAgICAgZnVuY3Rpb24gZGVjb21taXNzaW9uKCkge1xuICAgICAgICAgICAgdmFyIG5vZGVPcHNPYmogPSB7XG4gICAgICAgICAgICAgICAgbm9kZXM6IFskc3RhdGVQYXJhbXMua2V5XVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIE5vZGVzTW9kZWwuZGVjb21taXNzaW9uKG5vZGVPcHNPYmopLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vRGlzYWJsZSBhbGwgYnV0dG9ucyBpbml0aWFsbHkuIFBvbGwgd2lsbCBhc3NpZ24gdmFsdWVzIGFwcHJvcHJpYXRlbHkuXG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiB1cGdyYWRlKCkge1xuICAgICAgICAgICAgdmFyIG5vZGVPcHNPYmogPSB7XG4gICAgICAgICAgICAgICAgbm9kZXM6IFskc3RhdGVQYXJhbXMua2V5XVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIE5vZGVzTW9kZWwudXBncmFkZShub2RlT3BzT2JqKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAvL0Rpc2FibGUgYWxsIGJ1dHRvbnMgaW5pdGlhbGx5LiBQb2xsIHdpbGwgYXNzaWduIHZhbHVlcyBhcHByb3ByaWF0ZWx5LlxuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERpc3BsYXkgYnV0dG9ucyBiYXNlZCBvbiBzdGF0dXMgb2Ygbm9kZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gc2V0QnV0dG9uRGlzcGxheSgpIHtcbiAgICAgICAgICAgIHN3aXRjaCAobm9kZURldGFpbHNDdHJsLm5vZGVbJ2ludmVudG9yeV9zdGF0ZSddLnN0YXR1cykge1xuICAgICAgICAgICAgICAgIGNhc2UgJ1VuYWxsb2NhdGVkJzpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0RlY29tbWlzc2lvbmVkJzpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ1Byb3Zpc2lvbmluZyc6XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnQWxsb2NhdGVkJzpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0NhbmNlbGxlZCc6XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ01haW50ZW5hbmNlJzpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdldE5vZGVJbmZvKHJlbG9hZCkge1xuICAgICAgICAgICAgTm9kZXNNb2RlbC5nZXRNb2RlbEJ5S2V5KCRzdGF0ZVBhcmFtcy5rZXksIHJlbG9hZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5ub2RlID0gbm9kZTtcbiAgICAgICAgICAgICAgICBzZXRCdXR0b25EaXNwbGF5KCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBzZXRNb2RlKCkge1xuICAgICAgICAgICAgaWYgKCRzdGF0ZS5pcygnY29udGl2Lm1lbnUubm9kZXMuZGV0YWlscy5lZGl0JykpIHtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubW9kZSA9ICdlZGl0JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5tb2RlID0gJ2RldGFpbHMnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvSW5mbygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubm9kZXMuZGV0YWlscy5pbmZvJyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlQmdwSW5mbygpIHtcbiAgICAgICAgICAgIGlmIChub2RlRGV0YWlsc0N0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3Iua2V5ID0gJHN0YXRlUGFyYW1zLmtleTtcbiAgICAgICAgICAgICAgICAvLyBiYWNrZW5kIG9ubHkgc3VwcG9ydHMgYWRkaW5nIG9uZSBuZWlnaGJvciBjdXJyZW50bHlcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3JzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm5laWdoYm9yWyduZWlnaGJvciddID0gaXRlbS5uYW1lO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3JbJ25laWdoYm9yLWFzJ10gPSBpdGVtLnZhbHVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIEJncFNlcnZpY2UudXBkYXRlQmdwKG5vZGVEZXRhaWxzQ3RybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvciA9IHJlc3VsdC5jb25maWcuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9JbmZvKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnZXRCZ3BJbmZvKCkge1xuICAgICAgICAgICAgQmdwU2VydmljZS5nZXRCZ3Aobm9kZURldGFpbHNDdHJsKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3IgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0QmdwSW5zcGVjdCgpIHtcbiAgICAgICAgICAgIEJncFNlcnZpY2UuZ2V0QmdwSW5zcGVjdCgkc3RhdGVQYXJhbXMua2V5KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuaW5zcGVjdCA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwucm91dGVzID0gcmVzdWx0Lk9wZXIucm91dGVzO1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5maWx0ZXJlZHJvdXRlcyA9IHJlc3VsdC5PcGVyLnJvdXRlcztcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBub2RlRGV0YWlsc0N0cmwuZGVjb21taXNzaW9uID0gZGVjb21taXNzaW9uO1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZSA9IHVwZ3JhZGU7XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zZXRNb2RlID0gc2V0TW9kZTtcbiAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZGF0ZUJncEluZm8gPSB1cGRhdGVCZ3BJbmZvO1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwucmV0dXJuVG9JbmZvID0gcmV0dXJuVG9JbmZvO1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3JzID0gW107XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvciA9IHt9O1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwua2V5ID0gJHN0YXRlUGFyYW1zLmtleTtcbiAgICAgICAgZ2V0QmdwSW5mbygpO1xuICAgICAgICBnZXRCZ3BJbnNwZWN0KCk7XG4gICAgICAgIHNldE1vZGUoKTtcbiAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgIGdldE5vZGVJbmZvKGZhbHNlKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldE5vZGVJbmZvKHRydWUpO1xuICAgICAgICAgICAgfSwgNTAwMCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVkZXRhaWxzY3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDYvMTQvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2Lm5vZGVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dk5vZGVzdGF0dXNcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBub2RlOiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2Rlc3RhdHVzLmh0bWwnXG4gICAgfTtcbn0pXG4gICAgLmRpcmVjdGl2ZShcImN0dk5vZGVzdGF0ZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIG5vZGU6ICc9J1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVzdGF0ZS5odG1sJ1xuICAgIH07XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVkaXJlY3RpdmUuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRpc2NvdmVyJywge1xuICAgICAgICAgICAgdXJsOiAnL2Rpc2NvdmVyJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGlzY292ZXJDdHJsIGFzIG5vZGVEaXNjb3ZlckN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2RlZGlzY292ZXIuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVEaXNjb3ZlckN0cmwnLCBbXG4gICAgJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnTm9kZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsICdOb2Rlc1NlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgTm9kZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UsIE5vZGVzU2VydmljZSkge1xuICAgICAgICB2YXIgbm9kZURpc2NvdmVyQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvTm9kZXMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5vZGVzLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxEaXNjb3ZlcmluZ05vZGUoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub05vZGVzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZGlzY292ZXIoKSB7XG4gICAgICAgICAgICBpZiAobm9kZURpc2NvdmVyQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihub2RlRGlzY292ZXJDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihub2RlRGlzY292ZXJDdHJsKTtcbiAgICAgICAgICAgICAgICBjcmVhdGVJUEFkZHJBcnJheSgpO1xuICAgICAgICAgICAgICAgIE5vZGVzU2VydmljZS5jcmVhdGVFeHRyYVZhcnMobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgICAgICAgICAgICAgTm9kZXNNb2RlbC5kaXNjb3Zlcihub2RlRGlzY292ZXJDdHJsLm5vZGVPcHNPYmopLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub05vZGVzKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihub2RlRGlzY292ZXJDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKG5vZGVEaXNjb3ZlckN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlSVBBZGRyQXJyYXkoKSB7XG4gICAgICAgICAgICBub2RlRGlzY292ZXJDdHJsLm5vZGVPcHNPYmouYWRkcnMgPSBfLndvcmRzKG5vZGVEaXNjb3ZlckN0cmwubm9kZUlQQWRkciwgL1teLCBdKy9nKTtcbiAgICAgICAgfVxuICAgICAgICBub2RlRGlzY292ZXJDdHJsLm5vZGVPcHNPYmogPSB7fTtcbiAgICAgICAgbm9kZURpc2NvdmVyQ3RybC5leHRyYV92YXJzID0ge307IC8vVE9ETyBJbnRpYWxpemUgZnJvbSBnbG9iYWwgc2V0dGluZ3NcbiAgICAgICAgbm9kZURpc2NvdmVyQ3RybC5hbnNpYmxlVmFyaWFibGVzID0gW107XG4gICAgICAgIG5vZGVEaXNjb3ZlckN0cmwuZW52VmFyaWFibGVzID0gW107XG4gICAgICAgIG5vZGVEaXNjb3ZlckN0cmwubm9kZUlQQWRkciA9ICcnOyAvL0lQIGFkZHJlc3Mgb2Ygbm9kZXMgdG8gZGlzY292ZXJcbiAgICAgICAgTm9kZXNTZXJ2aWNlLmdldFNldHRpbmdzKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICBub2RlRGlzY292ZXJDdHJsLmRpc2NvdmVyID0gZGlzY292ZXI7XG4gICAgICAgIG5vZGVEaXNjb3ZlckN0cmwuY2FuY2VsRGlzY292ZXJpbmdOb2RlID0gY2FuY2VsRGlzY292ZXJpbmdOb2RlO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bm9kZWRpc2NvdmVyY3RybC5qcy5tYXAiLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMubGFzdGxvZycsIHtcbiAgICAgICAgICAgIHVybDogJy9sYXN0bG9nJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlTGFzdEpvYkxvZ3NDdHJsIGFzIG5vZGVMYXN0Sm9iTG9nc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8Y3R2LWxvZ3MgdGl0bGU9XCJMYXN0IEpvYlwiIGxvZz1cIm5vZGVMYXN0Sm9iTG9nc0N0cmwubGFzdExvZ3NcIj48L2N0di1sb2dzPidcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVMYXN0Sm9iTG9nc0N0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnTG9nU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzY29wZSwgJGludGVydmFsLCBMb2dTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBub2RlTGFzdEpvYkxvZ3NDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gZ2V0TGFzdExvZ3MoKSB7XG4gICAgICAgICAgICBMb2dTZXJ2aWNlLmdldExhc3RMb2dzKCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgbm9kZUxhc3RKb2JMb2dzQ3RybC5sYXN0TG9ncyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBnZXRMYXN0TG9ncygpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0TGFzdExvZ3MoKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVsYXN0am9ibG9nc2N0cmwuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzIyLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlTGlzdEN0cmwgYXMgbm9kZUxpc3RDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWxpc3QuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVMaXN0Q3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ05vZGVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgTm9kZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIG5vZGVMaXN0Q3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGdldE5vZGVzKHJlbG9hZCkge1xuICAgICAgICAgICAgTm9kZXNNb2RlbC5nZXQocmVsb2FkKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgbm9kZUxpc3RDdHJsLm5vZGVzID0gcmVzdWx0O1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVMaXN0Q3RybCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgZ2V0Tm9kZXMoZmFsc2UpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0Tm9kZXModHJ1ZSk7XG4gICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1ub2RlbGlzdGN0cmwuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5vcmdhbml6YXRpb25zJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5jcmVhdGUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnb3JnYW5pemF0aW9ucy9vcmdhbml6YXRpb25jcmVhdGUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnT3JnYW5pemF0aW9uQ3JlYXRlQ3RybCBhcyBvcmdhbml6YXRpb25DcmVhdGVDdHJsJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignT3JnYW5pemF0aW9uQ3JlYXRlQ3RybCcsIFsnJHN0YXRlJywgJ09yZ2FuaXphdGlvbnNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgT3JnYW5pemF0aW9uc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvT3JnYW5pemF0aW9ucygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub09yZ2FuaXphdGlvbnMoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVPcmdhbml6YXRpb24oKSB7XG4gICAgICAgICAgICAvL2Zvcm0gY29udHJvbGxlciBpcyBpbmplY3RlZCBieSB0aGUgaHRtbCB0ZW1wbGF0ZVxuICAgICAgICAgICAgLy9jaGVja2luZyBpZiBhbGwgdmFsaWRhdGlvbnMgaGF2ZSBwYXNzZWRcbiAgICAgICAgICAgIGlmIChvcmdhbml6YXRpb25DcmVhdGVDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwubmV3T3JnYW5pemF0aW9uLmtleSA9IG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwubmV3T3JnYW5pemF0aW9uLnRlbmFudE5hbWU7XG4gICAgICAgICAgICAgICAgT3JnYW5pemF0aW9uc01vZGVsLmNyZWF0ZShvcmdhbml6YXRpb25DcmVhdGVDdHJsLm5ld09yZ2FuaXphdGlvbikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvT3JnYW5pemF0aW9ucygpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25DcmVhdGVDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJlc2V0Rm9ybSgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBvcmdhbml6YXRpb25DcmVhdGVDdHJsLm5ld09yZ2FuaXphdGlvbiA9IHtcbiAgICAgICAgICAgICAgICB0ZW5hbnROYW1lOiAnJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBvcmdhbml6YXRpb25DcmVhdGVDdHJsLmNyZWF0ZU9yZ2FuaXphdGlvbiA9IGNyZWF0ZU9yZ2FuaXphdGlvbjtcbiAgICAgICAgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybC5jYW5jZWxDcmVhdGluZyA9IGNhbmNlbENyZWF0aW5nO1xuICAgICAgICByZXNldEZvcm0oKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1vcmdhbml6YXRpb25jcmVhdGVjdHJsLmpzLm1hcCIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYub3JnYW5pemF0aW9ucycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ09yZ2FuaXphdGlvbkRldGFpbHNDdHJsIGFzIG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnb3JnYW5pemF0aW9ucy9vcmdhbml6YXRpb25kZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdPcmdhbml6YXRpb25EZXRhaWxzQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdPcmdhbml6YXRpb25zTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgT3JnYW5pemF0aW9uc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgb3JnYW5pemF0aW9uRGV0YWlsc0N0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub09yZ2FuaXphdGlvbnMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMubGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGRlbGV0ZU9yZ2FuaXphdGlvbigpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBPcmdhbml6YXRpb25zTW9kZWwuZGVsZXRlKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsLm9yZ2FuaXphdGlvbikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9Pcmdhbml6YXRpb25zKCk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICBPcmdhbml6YXRpb25zTW9kZWwuZ2V0TW9kZWxCeUtleSgkc3RhdGVQYXJhbXMua2V5KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKG9yZ2FuaXphdGlvbikge1xuICAgICAgICAgICAgb3JnYW5pemF0aW9uRGV0YWlsc0N0cmwub3JnYW5pemF0aW9uID0gb3JnYW5pemF0aW9uO1xuICAgICAgICB9KTtcbiAgICAgICAgb3JnYW5pemF0aW9uRGV0YWlsc0N0cmwuZGVsZXRlT3JnYW5pemF0aW9uID0gZGVsZXRlT3JnYW5pemF0aW9uO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW9yZ2FuaXphdGlvbmRldGFpbHNjdHJsLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNi8xLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnN0b3JhZ2Vwb2xpY2llcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5jcmVhdGUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9zdG9yYWdlcG9saWN5Y3JlYXRlLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1N0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsIGFzIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignU3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnU3RvcmFnZVBvbGljaWVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgU3RvcmFnZVBvbGljaWVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvU3RvcmFnZVBvbGljaWVzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMubGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbENyZWF0aW5nKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9TdG9yYWdlUG9saWNpZXMoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVGaWxlc3lzdGVtQ21kcygpIHtcbiAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLmZpbGVzeXN0ZW1jbWRzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5uZXdTdG9yYWdlUG9saWN5LmZpbGVzeXN0ZW1zW2l0ZW0ubmFtZV0gPSBpdGVtLnZhbHVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlUG9saWN5KCkge1xuICAgICAgICAgICAgLy9mb3JtIGNvbnRyb2xsZXIgaXMgaW5qZWN0ZWQgYnkgdGhlIGh0bWwgdGVtcGxhdGVcbiAgICAgICAgICAgIC8vY2hlY2tpbmcgaWYgYWxsIHZhbGlkYXRpb25zIGhhdmUgcGFzc2VkXG4gICAgICAgICAgICBpZiAoc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBjcmVhdGVGaWxlc3lzdGVtQ21kcygpO1xuICAgICAgICAgICAgICAgIFN0b3JhZ2VQb2xpY2llc01vZGVsLmNyZWF0ZShzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5uZXdTdG9yYWdlUG9saWN5KVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1N0b3JhZ2VQb2xpY2llcygpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmVzZXRGb3JtKCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwubmV3U3RvcmFnZVBvbGljeSA9IHtcbiAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICBcImJhY2tlbmRzXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJjcnVkXCI6IFwiY2VwaFwiLFxuICAgICAgICAgICAgICAgICAgICBcIm1vdW50XCI6IFwiY2VwaFwiLFxuICAgICAgICAgICAgICAgICAgICBcInNuYXBzaG90XCI6IFwiY2VwaFwiXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBcInVubG9ja2VkXCI6IGZhbHNlLFxuICAgICAgICAgICAgICAgIFwiZHJpdmVyXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJwb29sXCI6IFwicmJkXCJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFwiY3JlYXRlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJzaXplXCI6IFwiMFwiLFxuICAgICAgICAgICAgICAgICAgICBcImZpbGVzeXN0ZW1cIjogXCJcIlxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXCJydW50aW1lXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJzbmFwc2hvdHNcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgXCJzbmFwc2hvdFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImZyZXF1ZW5jeVwiOiBcIjMwbVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJrZWVwXCI6IDIwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFwicmF0ZS1saW1pdFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcIndyaXRlLWlvcHNcIjogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVhZC1pb3BzXCI6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIndyaXRlLWJwc1wiOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWFkLWJwc1wiOiAwXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFwiZmlsZXN5c3RlbXNcIjoge31cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwuY3JlYXRlUG9saWN5ID0gY3JlYXRlUG9saWN5O1xuICAgICAgICBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5jYW5jZWxDcmVhdGluZyA9IGNhbmNlbENyZWF0aW5nO1xuICAgICAgICBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5maWxlc3lzdGVtY21kcyA9IFtdO1xuICAgICAgICByZXNldEZvcm0oKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdG9yYWdlcG9saWN5Y3JlYXRlY3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMjcvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc3RvcmFnZXBvbGljaWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwgYXMgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9zdG9yYWdlcG9saWN5ZGV0YWlscy5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMuZWRpdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1N0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCBhcyBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL3N0b3JhZ2Vwb2xpY3lkZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdTdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ1N0b3JhZ2VQb2xpY2llc01vZGVsJywgJ1ZvbHVtZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCAkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgU3RvcmFnZVBvbGljaWVzTW9kZWwsIFZvbHVtZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCA9IHRoaXM7XG4gICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5maWxlc3lzdGVtY21kcyA9IFtdO1xuICAgICAgICAvKipcbiAgICAgICAgICogVG8gc2hvdyBlZGl0IG9yIGRldGFpbHMgc2NyZWVuIGJhc2VkIG9uIHRoZSByb3V0ZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gc2V0TW9kZSgpIHtcbiAgICAgICAgICAgIGlmICgkc3RhdGUuaXMoJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5lZGl0JykpIHtcbiAgICAgICAgICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwubW9kZSA9ICdlZGl0JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5tb2RlID0gJ2RldGFpbHMnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvUG9saWNpZXMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Qb2xpY3lEZXRhaWxzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMuZGV0YWlscycsIHsgJ2tleSc6IHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kubmFtZSB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxFZGl0aW5nKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9Qb2xpY3lEZXRhaWxzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZGVsZXRlUG9saWN5KCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgU3RvcmFnZVBvbGljaWVzTW9kZWwuZGVsZXRlVXNpbmdLZXkoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnBvbGljeS5uYW1lLCAnbmFtZScpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICByZXR1cm5Ub1BvbGljaWVzKCk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdldCB2b2x1bWVzIGJlbG9uZ2luZyB0byBhIHBvbGljeVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gZ2V0Vm9sdW1lcyhyZWxvYWQpIHtcbiAgICAgICAgICAgIFZvbHVtZXNNb2RlbC5nZXQocmVsb2FkKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwudm9sdW1lcyA9ICRmaWx0ZXIoJ29yZGVyQnknKShfLmZpbHRlcihyZXN1bHQsIHtcbiAgICAgICAgICAgICAgICAgICAgJ3BvbGljeSc6IHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kubmFtZVxuICAgICAgICAgICAgICAgIH0pLCAnbmFtZScpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gaW5pdGlhbGl6ZUZpbGVzeXN0ZW1DbWRzQXJyYXkoKSB7XG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnBvbGljeS5maWxlc3lzdGVtcywgZnVuY3Rpb24gKHZhbHVlLCBrZXkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnB1c2goeyBuYW1lOiBrZXksIHZhbHVlOiB2YWx1ZSB9KTtcbiAgICAgICAgICAgIH0sIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5maWxlc3lzdGVtY21kcyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlRmlsZXN5c3RlbUNtZHMoKSB7XG4gICAgICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwuZmlsZXN5c3RlbWNtZHMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kuZmlsZXN5c3RlbXNbaXRlbS5uYW1lXSA9IGl0ZW0udmFsdWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBzYXZlUG9saWN5KCkge1xuICAgICAgICAgICAgLy9mb3JtIGNvbnRyb2xsZXIgaXMgaW5qZWN0ZWQgYnkgdGhlIGh0bWwgdGVtcGxhdGVcbiAgICAgICAgICAgIC8vY2hlY2tpbmcgaWYgYWxsIHZhbGlkYXRpb25zIGhhdmUgcGFzc2VkXG4gICAgICAgICAgICBpZiAoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBjcmVhdGVGaWxlc3lzdGVtQ21kcygpO1xuICAgICAgICAgICAgICAgIFN0b3JhZ2VQb2xpY2llc01vZGVsLnNhdmUoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnBvbGljeSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9Qb2xpY3lEZXRhaWxzKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgIFN0b3JhZ2VQb2xpY2llc01vZGVsLmdldE1vZGVsQnlLZXkoJHN0YXRlUGFyYW1zLmtleSwgZmFsc2UsICduYW1lJylcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kgPSBwb2xpY3k7XG4gICAgICAgICAgICBpbml0aWFsaXplRmlsZXN5c3RlbUNtZHNBcnJheSgpO1xuICAgICAgICAgICAgZ2V0Vm9sdW1lcyhmYWxzZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwuZGVsZXRlUG9saWN5ID0gZGVsZXRlUG9saWN5O1xuICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwuc2F2ZVBvbGljeSA9IHNhdmVQb2xpY3k7XG4gICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5jYW5jZWxFZGl0aW5nID0gY2FuY2VsRWRpdGluZztcbiAgICAgICAgc2V0TW9kZSgpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXRWb2x1bWVzKHRydWUpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3RvcmFnZXBvbGljeWRldGFpbHNjdHJsLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNi8yLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5zdG9yYWdlcG9saWNpZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2U3RvcmFnZXBvbGljeWJhc2ljc2V0dGluZ3NcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7fTtcbn0pXG4gICAgLmRpcmVjdGl2ZShcImN0dlN0b3JhZ2Vwb2xpY3lmaWxlc3lzdGVtc2V0dGluZ3NcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBwb2xpY3k6ICc9JyxcbiAgICAgICAgICAgIGZpbGVzeXN0ZW1jbWRzOiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlKSB7XG4gICAgICAgICAgICBzY29wZS5maWxlc3lzdGVtcyA9IFsnZXh0NCcsICdidHJmcyddO1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvZmlsZXN5c3RlbXNldHRpbmdzLmh0bWwnXG4gICAgfTtcbn0pXG4gICAgLmRpcmVjdGl2ZShcImN0dlN0b3JhZ2Vwb2xpY3lzbmFwc2hvdHNldHRpbmdzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgcG9saWN5OiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL3NuYXBzaG90c2V0dGluZ3MuaHRtbCdcbiAgICB9O1xufSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2U3RvcmFnZXBvbGljeXJ3b3Bzc2V0dGluZ3NcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBwb2xpY3k6ICc9J1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvcndvcHNzZXR0aW5ncy5odG1sJ1xuICAgIH07XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZTdG9yYWdlcG9saWN5YmFja2VuZGRyaXZlcnNcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBwb2xpY3k6ICc9J1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvYmFja2VuZGRyaXZlcnMuaHRtbCdcbiAgICB9O1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdG9yYWdlcG9saWN5ZGlyZWN0aXZlLmpzLm1hcCIsIlxuXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52aXN1YWxpemF0aW9uLmVkZ2UnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2VkZ2Uve3NvdXJjZU5hbWUsIHRhcmdldE5hbWUsIHNvdXJjZUxpc3QsIHRhcmdldExpc3R9JyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlTmFtZTogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TmFtZTogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgc291cmNlTGlzdDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TGlzdDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1Zpc3VhbGl6YXRpb25FZGdlQ3RybCBhcyB2aXN1YWxpemF0aW9uZWRnZUN0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9uZWRnZS5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdWaXN1YWxpemF0aW9uRWRnZUN0cmwnLCBbXCIkc2NvcGVcIiwgXCIkaHR0cFwiLCAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdWaXN1YWxpemF0aW9uU2VydmljZScsICckaW50ZXJ2YWwnLFxuICAgICAgICBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkc3RhdGUsICRzdGF0ZVBhcmFtcywgVmlzdWFsaXphdGlvblNlcnZpY2UsICRpbnRlcnZhbCkge1xuICAgICAgICAgICAgdmFyIHNvdXJjZU5hbWUgPSAkc3RhdGVQYXJhbXMuc291cmNlTmFtZTtcbiAgICAgICAgICAgIHZhciB0YXJnZXROYW1lID0gJHN0YXRlUGFyYW1zLnRhcmdldE5hbWU7XG4gICAgICAgICAgICB2YXIgc291cmNlTGlzdCA9ICRzdGF0ZVBhcmFtcy5zb3VyY2VMaXN0O1xuICAgICAgICAgICAgdmFyIHRhcmdldExpc3QgPSAkc3RhdGVQYXJhbXMudGFyZ2V0TGlzdDtcblxuICAgICAgICAgICAgLy9JZiB0aGUgcGFnZSBpcyByZWxvYWRlZCwgdGhlc2Ugc3RhdGUgcGFyYW1zIGFyZSBhbGwgbnVsbCxcbiAgICAgICAgICAgIC8vc28gaXQgd2lsbCByb3V0ZSB0aGVtIGJhY2sgdG8gdGhlIHZpc3VhbGl6YXRpb24gdGFiIHRvcCB2aWV3XG4gICAgICAgICAgICBpZiAoc291cmNlTGlzdCA9PSBudWxsIHx8IHRhcmdldExpc3QgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUudmlzdWFsaXphdGlvbi5saXN0Jyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgZCA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICB2YXIgdCA9IGQuZ2V0U2Vjb25kcygpO1xuICAgICAgICAgICAgJHNjb3BlLmVkZ2VEYXRhSW50ZXJ2YWwgPSBcbiAgICAgICAgICAgICAgICAkaW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIFZpc3VhbGl6YXRpb25TZXJ2aWNlLmdldEVkZ2VEYXRhKHNvdXJjZUxpc3QsIHRhcmdldExpc3QsIHQudG9TdHJpbmcoKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0cyA9IHJlc3VsdC5yZXN1bHRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2gocmVzdWx0cywgZnVuY3Rpb24ocikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoXy5pc0VtcHR5KHIpID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSArPSByLnNlcmllc1swXS52YWx1ZXNbMF1bMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlTmFtZSA9IHNvdXJjZU5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRhcmdldE5hbWUgPSB0YXJnZXROYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5lZGdlRGF0YSA9IGRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVkZ2VEYXRhVGltZSA9IHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0sIDMwMDApO1xuXG4gICAgICAgICAgICAvL0Rlc3Ryb3lpbmcgdGhlIGludGVydmFsIGZ1bmN0aW9uIG9uIHJvdXRlIGNoYW5nZVxuICAgICAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7ICRpbnRlcnZhbC5jYW5jZWwoJHNjb3BlLmVkZ2VEYXRhSW50ZXJ2YWwpOyB9KTtcblxuXG4gICAgICAgICAgICBWaXN1YWxpemF0aW9uU2VydmljZS5nZXRPbGRFZGdlRGF0YShzb3VyY2VMaXN0LCB0YXJnZXRMaXN0KVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSByZXN1bHQucmVzdWx0cztcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVkZ2VEYXRhID0gW107XG4gICAgICAgICAgICAgICAgICAgIC8vcmVzdWx0cywgaWYgbm90IGVtcHR5LCBhcmUgZXhwZWN0ZWQgdG8gaGF2ZVxuICAgICAgICAgICAgICAgICAgICAvLzYgZGF0YSBlbnRyaWVzXG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChyZXN1bHRzLCBmdW5jdGlvbihyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoXy5pc0VtcHR5KHIpID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gci5zZXJpZXNbMF0udmFsdWVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfLmlzRW1wdHkoZWRnZURhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChkYXRhLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGdlRGF0YS5wdXNoKGRbMV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChkYXRhLCBmdW5jdGlvbihkLCBpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGdlRGF0YVtpXSArPSBkWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNvdXJjZU5hbWUgPSBzb3VyY2VOYW1lO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudGFyZ2V0TmFtZSA9IHRhcmdldE5hbWU7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zb3VyY2VMaXN0ID0gc291cmNlTGlzdDtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRhcmdldExpc3QgPSB0YXJnZXRMaXN0O1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUub2xkRWRnZURhdGEgPSBlZGdlRGF0YTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIH0pO1xuICAgIH1dKTtcblxuXG5cblxuIiwiXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicpXG4gICAgLmRpcmVjdGl2ZShcInZpc3VhbGl6YXRpb25FZGdlXCIsIFsnJHdpbmRvdycsXG4gICAgICAgIGZ1bmN0aW9uKCR3aW5kb3cpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIHZpc3VhbGl6YXRpb25FZGdlRDMoc2NvcGUsIGQzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJvZHlFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF07XG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IGJvZHlFbC5jbGllbnRXaWR0aCAtIDQwMCxcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gIGJvZHlFbC5jbGllbnRIZWlnaHQgLSA0MDA7XG5cblxuICAgICAgICAgICAgICAgIC8vdGFrZW4gZnJvbSBodHRwOi8vYmwub2Nrcy5vcmcvc2ltZW5icmVra2VuLzY2MzQwNzBcbiAgICAgICAgICAgICAgICAvLyAvKiogTUFJTiBTVkcgKiovXG4gICAgICAgICAgICAgICAgdmFyIGxpbWl0ID0gNTksXG4gICAgICAgICAgICAgICAgZHVyYXRpb24gPSA3NTAsXG4gICAgICAgICAgICAgICAgbm93ID0gbmV3IERhdGUoRGF0ZS5ub3coKSAtIGR1cmF0aW9uKTtcblxuICAgICAgICAgICAgICAgIHZhciBncm91cHMgPSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdvcmFuZ2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZDMucmFuZ2UobGltaXQpLm1hcChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNjb3BlLm9sZEVkZ2VEYXRhW01hdGguZmxvb3IoZC8xMCldIHx8IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgeCA9IGQzLnRpbWUuc2NhbGUoKVxuICAgICAgICAgICAgICAgICAgICAuZG9tYWluKFtub3cgLSAobGltaXQgLSAyKSwgbm93IC0gZHVyYXRpb25dKVxuICAgICAgICAgICAgICAgICAgICAucmFuZ2UoWzAsIHdpZHRoXSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgeSA9IGQzLnNjYWxlLmxpbmVhcigpXG4gICAgICAgICAgICAgICAgICAgIC5kb21haW4oWzAsIGQzLm1heChncm91cHMuY3VycmVudC5kYXRhLCBmdW5jdGlvbiAoZCkgeyByZXR1cm4gZCArIDEwOyB9KV0pXG4gICAgICAgICAgICAgICAgICAgIC5yYW5nZShbaGVpZ2h0LCAwXSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbGluZSA9IGQzLnN2Zy5saW5lKClcbiAgICAgICAgICAgICAgICAgICAgLmludGVycG9sYXRlKCdiYXNpcycpXG4gICAgICAgICAgICAgICAgICAgIC54KGZ1bmN0aW9uKGQsIGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB4KG5vdyAtIChsaW1pdCAtIDEgLSBpKSAqIGR1cmF0aW9uKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAueShmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geShkKVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHZhciB4U3ZnID0gZDMuc2VsZWN0KCcuZ3JhcGgnKS5hcHBlbmQoJ3N2ZycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd3aWR0aCcsIDI1KVxuICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ292ZXJmbG93JywgJ3Zpc2libGUnKVxuICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ3Bvc2l0aW9uJywgJ2ZpeGVkJyk7XG5cbiAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgIHZhciB5QXhpcyA9IHhTdmcuYXBwZW5kKCdnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ3kgYXhpcycpXG4gICAgICAgICAgICAgICAgICAgIC8vIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDAsJyArIHdpZHRoICsgJyknKVxuICAgICAgICAgICAgICAgICAgICAuY2FsbCh5LmF4aXMgPSBkMy5zdmcuYXhpcygpLnNjYWxlKHkpLm9yaWVudCgnbGVmdCcpKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgc3ZnPSBkMy5zZWxlY3QoJy5ncmFwaCcpLmFwcGVuZCgnc3ZnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2NoYXJ0JylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgd2lkdGggLSA1MClcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2hlaWdodCcsIGhlaWdodCArIDUwKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gLnN0eWxlKCdvdmVyZmxvdycsIFwidmlzaWJsZVwiKTtcblxuICAgICAgICAgICAgICAgIHZhciBheGlzID0gc3ZnLmFwcGVuZCgnZycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICd4IGF4aXMnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZSgwLCcgKyBoZWlnaHQgKyAnKScpXG4gICAgICAgICAgICAgICAgICAgIC5jYWxsKHguYXhpcyA9IGQzLnN2Zy5heGlzKCkuc2NhbGUoeCkub3JpZW50KCdib3R0b20nKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgcGF0aHMgPSBzdmcuYXBwZW5kKCdnJyk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBuYW1lIGluIGdyb3Vwcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ3JvdXAgPSBncm91cHNbbmFtZV07XG4gICAgICAgICAgICAgICAgICAgIGdyb3VwLnBhdGggPSBwYXRocy5hcHBlbmQoJ3BhdGgnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmRhdGEoW2dyb3VwLmRhdGFdKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgbmFtZSArICcgZ3JvdXAnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN0eWxlKCdzdHJva2UnLCBncm91cC5jb2xvcilcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiB0aWNrKCkge1xuICAgICAgICAgICAgICAgICAgICBub3cgPSBuZXcgRGF0ZSgpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCBuZXcgdmFsdWVzXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIG5hbWUgaW4gZ3JvdXBzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ3JvdXAgPSBncm91cHNbbmFtZV07XG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cC5kYXRhLnB1c2goc2NvcGUuZWRnZURhdGEgfHwgMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cC5wYXRoLmF0dHIoJ2QnLCBsaW5lKVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2hpZnQgZG9tYWluXG4gICAgICAgICAgICAgICAgICAgIHguZG9tYWluKFtub3cgLSAobGltaXQgLSAyKSAqIGR1cmF0aW9uLCBub3cgLSBkdXJhdGlvbl0pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFNsaWRlIHgtYXhpcyBsZWZ0XG4gICAgICAgICAgICAgICAgICAgIGF4aXMudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZHVyYXRpb24oZHVyYXRpb24pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZWFzZSgnbGluZWFyJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYWxsKHguYXhpcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgeUF4aXMudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZHVyYXRpb24oZHVyYXRpb24pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZWFzZSgnbGluZWFyJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYWxsKHkuYXhpcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2xpZGUgcGF0aHMgbGVmdFxuICAgICAgICAgICAgICAgICAgICBwYXRocy5hdHRyKCd0cmFuc2Zvcm0nLCBudWxsKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmR1cmF0aW9uKGR1cmF0aW9uKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVhc2UoJ2xpbmVhcicpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZSgnICsgeChub3cgLSAobGltaXQgLSAxKSAqIGR1cmF0aW9uKSArICcpJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lYWNoKCdlbmQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aWNrKClcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBvbGRlc3QgZGF0YSBwb2ludCBmcm9tIGVhY2ggZ3JvdXBcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBncm91cHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBncm91cCA9IGdyb3Vwc1tuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLmRhdGEuc2hpZnQoKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRpY2soKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm57XG4gICAgICAgICAgICAgICAgcmVzdHJpY3Q6J0VBJyxcbiAgICAgICAgICAgICAgICByZXBsYWNlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Zpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbmVkZ2V0ZW1wbGF0ZS5odG1sJyxcbiAgICAgICAgICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSl7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiR3YXRjaEdyb3VwKFsnZWRnZURhdGEnLCAnb2xkRWRnZURhdGEnXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzY29wZS5lZGdlRGF0YSAhPSBudWxsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5vbGRFZGdlRGF0YSAhPSBudWxsICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNjb3BlLmluaXRpYWxpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmluaXRpYWxpemUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQzID0gJHdpbmRvdy5kMzsgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzdWFsaXphdGlvbkVkZ2VEMyhzY29wZSwgZDMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgXVxuKTtcbiIsIlxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52aXN1YWxpemF0aW9uJylcbiAgICAuc2VydmljZSgnU3RhdGVTYXZlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNhdmVkU3RhdGVzID0ge307XG4gICAgfSlcbiAgICAuZGlyZWN0aXZlKFwidmlzdWFsaXphdGlvbkdyYXBoXCIsIFsnJHdpbmRvdycsICckc3RhdGUnLCAnVmlzdWFsaXplckdyYXBoJywgJ1BvbGljeVNlcnZpY2UnLCAnVmlzdWFsaXplckRhdGFTb3VyY2UnLCAnU3RhdGVTYXZlJyxcbiAgICAgICAgZnVuY3Rpb24oJHdpbmRvdywgJHN0YXRlLCBWaXN1YWxpemVyR3JhcGgsIFBvbGljeVNlcnZpY2UsIFZpc3VhbGl6ZXJEYXRhU291cmNlLCBTdGF0ZVNhdmUpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIHZpc3VhbGl6YXRpb25saXN0ZDMoc2NvcGUsIGVsZW0sIFZpc3VhbGl6ZXJHcmFwaCwgUG9saWN5U2VydmljZSwgVmlzdWFsaXplckRhdGFTb3VyY2UsIFN0YXRlU2F2ZSkge1xuICAgICAgICAgICAgICAgIC8vZG9uJ3QgcnVuIHVudGlsIGFsbCBpbml0aWFsaXphdGlvbiBjYWxscyBoYXZlIHJldHVybmVkXG4gICAgICAgICAgICAgICAgaWYgKHNjb3BlLm5vZGVzID09PSB1bmRlZmluZWQgfHwgc2NvcGUubGlua3MgPT09IHVuZGVmaW5lZCB8fCBzY29wZS5jaGlsZHJlbl9zdHJ1Y3QgPT09IHVuZGVmaW5lZCB8fFxuICAgICAgICAgICAgICAgICAgICBzY29wZS5hbmNlc3RvcnNfc3RydWN0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vY3JlYXRpbmcgRGF0YVNvdXJjZVxuICAgICAgICAgICAgICAgIHZhciBkYXRhU291cmNlID0gbmV3IFZpc3VhbGl6ZXJEYXRhU291cmNlLkRhdGFTb3VyY2Uoc2NvcGUubm9kZXMsIHNjb3BlLmxpbmtzLCBzY29wZS5jaGlsZHJlbl9zdHJ1Y3QsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuYW5jZXN0b3JzX3N0cnVjdCwgc2NvcGUubGFiZWxzLCBzY29wZS5zZXJ2aWNlU2VsZWN0b3JzKTtcbiAgICAgICAgICAgICAgICBkYXRhU291cmNlLnNldEFuY2VzdG9ycygpO1xuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzLCBsaW5rcztcblxuICAgICAgICAgICAgICAgIHZhciB0b3BEYXRhID0gZGF0YVNvdXJjZS5nZXRUb3BMZXZlbEZsb3coKTtcbiAgICAgICAgICAgICAgICBub2RlcyA9IGRhdGFTb3VyY2UucHJvY2Vzc05vZGVEYXRhKHRvcERhdGEubm9kZURhdGEpO1xuICAgICAgICAgICAgICAgIGxpbmtzID0gZGF0YVNvdXJjZS5wcm9jZXNzTGlua0RhdGEodG9wRGF0YS5saW5rRGF0YSwgbm9kZXMpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGJvZHlFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF07XG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IGJvZHlFbC5jbGllbnRXaWR0aCxcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gIGJvZHlFbC5jbGllbnRIZWlnaHQ7XG5cbiAgICAgICAgICAgICAgICAvKiogTUFJTiBTVkcgKiovXG4gICAgICAgICAgICAgICAgdmFyIHJhd1N2Zz1lbGVtLmZpbmQoJ3N2ZycpO1xuXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9ICQocmF3U3ZnLnBhcmVudCgpKS5vZmZzZXQoKTtcblxuICAgICAgICAgICAgICAgIHZhciBkaXZXaWR0aCA9ICQocmF3U3ZnLnBhcmVudCgpKS53aWR0aCgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN2ZyA9IGQzLnNlbGVjdChyYXdTdmdbMF0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwid2lkdGhcIiwgZGl2V2lkdGgpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGhlaWdodCAtIG9mZnNldC50b3AgLSAyMCk7XG5cbiAgICAgICAgICAgICAgICAvL2luc3RhbGxpbmcgcG9saWNpZXNcbiAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGggPSBuZXcgVmlzdWFsaXplckdyYXBoLkdyYXBoKHN2Zywgbm9kZXMsIGxpbmtzLCBkYXRhU291cmNlLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5jaGlsZHJlbl9zdHJ1Y3QsIHNjb3BlLmFuY2VzdG9yc19zdHJ1Y3QpO1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5pbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3kobmV3IFBvbGljeVNlcnZpY2UuU2F2ZVN0YXRlUG9saWN5KFN0YXRlU2F2ZS5zYXZlZFN0YXRlcykpO1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5pbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3kobmV3IFBvbGljeVNlcnZpY2UuUGF0aENoYW5nZVZpZXdQb2xpY3koJHN0YXRlKSk7XG4gICAgICAgICAgICAgICAgLy9RVGlwUG9saWN5IGlzIGZvciBib3RoIE5vZGVzIGFuZCBQYXRocywgaW5zdGFsbCBzYW1lIG9uZSBvbiBib3RoXG4gICAgICAgICAgICAgICAgdmFyIHFUaXBQb2xpY3kgPSBuZXcgUG9saWN5U2VydmljZS5RVGlwUG9saWN5KCk7XG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmluc3RhbGxEZWZhdWx0Tm9kZVBvbGljeShxVGlwUG9saWN5KTtcbiAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGguaW5zdGFsbERlZmF1bHRQYXRoUG9saWN5KHFUaXBQb2xpY3kpO1xuICAgICAgICAgICAgICAgIHZhciBzcGxpdEpvaW5WaWV3UG9saWN5ID0gbmV3IFBvbGljeVNlcnZpY2UuU3BsaXRKb2luVmlld1BvbGljeSgpO1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5pbnN0YWxsRGVmYXVsdE5vZGVQb2xpY3koc3BsaXRKb2luVmlld1BvbGljeSk7XG4gICAgICAgICAgICAgICAgc3BsaXRKb2luVmlld1BvbGljeS5pbnN0YWxsQmFja0J1dHRvbigkKCcjYmFja0J1dHRvbicpKTtcbiAgICAgICAgICAgICAgICBzcGxpdEpvaW5WaWV3UG9saWN5Lmluc3RhbGxUaXRsZSgkKCcjZ3JhcGgtdGl0bGUnKSk7XG5cbiAgICAgICAgICAgICAgICAvL2xvYWQgb2xkIHZpZXcgaWYgaXQgZXhpc3RzLlxuICAgICAgICAgICAgICAgIGlmIChfLmlzRW1wdHkoU3RhdGVTYXZlLnNhdmVkU3RhdGVzKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ3JhcGggPSBzY29wZS52aXN1YWxpemF0aW9uR3JhcGg7XG4gICAgICAgICAgICAgICAgICAgIGdyYXBoLmxvYWQoU3RhdGVTYXZlLnNhdmVkU3RhdGVzKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybntcbiAgICAgICAgICAgICAgICByZXN0cmljdDonRUEnLFxuICAgICAgICAgICAgICAgIHJlcGxhY2U6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9udGVtcGxhdGUuaHRtbCcsXG4gICAgICAgICAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW0pe1xuICAgICAgICAgICAgICAgICAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkgeyBcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykudW5iaW5kKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGguZGVzdHJveSgpO30pO1xuICAgICAgICAgICAgICAgICAgICBzY29wZS4kd2F0Y2hHcm91cChbJ25vZGVzJywgJ2xpbmtzJywgJ2NoaWxkcmVuX3N0cnVjdCcsICdhbmNlc3RvcnNfc3RydWN0J10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2NvcGUubm9kZXMgIT0gbnVsbCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5saW5rcyAhPSBudWxsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmNoaWxkcmVuX3N0cnVjdCAhPSBudWxsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmFuY2VzdG9yc19zdHJ1Y3QgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2NvcGUuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXN1YWxpemF0aW9ubGlzdGQzKHNjb3BlLCBlbGVtLCBWaXN1YWxpemVyR3JhcGgsIFBvbGljeVNlcnZpY2UsIFZpc3VhbGl6ZXJEYXRhU291cmNlLCBTdGF0ZVNhdmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5kYXRhU291cmNlLmxpbmtzID0gc2NvcGUubGlua3M7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC51cGRhdGVMaW5rRGF0YSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICB9XG4gICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICBdXG4pO1xuXG5cblxuXG5cblxuXG5cblxuXG5cblxuIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52aXN1YWxpemF0aW9uJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUudmlzdWFsaXphdGlvbi5saXN0Jywge1xuICAgICAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnVmlzdWFsaXphdGlvbkxpc3RDdHJsIGFzIHZpc3VhbGl6YXRpb25MaXN0Q3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb25saXN0Lmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICA7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1Zpc3VhbGl6YXRpb25MaXN0Q3RybCcsIFtcIiRzY29wZVwiLCBcIiRodHRwXCIsICdWaXN1YWxpemF0aW9uU2VydmljZScsICckaW50ZXJ2YWwnLCBcbiAgICAgICAgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgVmlzdWFsaXphdGlvblNlcnZpY2UsICRpbnRlcnZhbCkge1xuICAgICAgICAgICAgLy90byBzZWUgdGhlIGV4cGVjdGVkIGZvcm1hdCB0byBiZSByZXR1cm5lZCBmcm9tIHRoZXNlIGNhbGxzLFxuICAgICAgICAgICAgLy9sb29rIGF0IGFwcC9jb21wb25lbnRzL2dyYXBob2JqZWN0cy9kYXRhc291cmNlL3Zpc3VhbGl6ZXJkYXRhc291cmNlLmpzXG4gICAgICAgICAgICB2YXIgc3VjY2Vzc0dyYXBoRGF0YUNhbGxiYWNrID0gZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIGxpbmtzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVJZHMgPSBbXTtcbiAgICAgICAgICAgICAgICBfLmZvckVhY2gocmVzdWx0LnJlc3VsdHNbMF0uc2VyaWVzLCBmdW5jdGlvbihzZXJpZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVuZHBvaW50ID0gc2VyaWVzLnRhZ3MuRW5kcG9pbnRJUDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb3ZpZGVyID0gc2VyaWVzLnRhZ3MuUHJvdmlkZXJJUDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGU7XG4gICAgICAgICAgICAgICAgICAgIC8vY3JlYXRpbmcgbm9kZXNcbiAgICAgICAgICAgICAgICAgICAgaWYgKF8uaW5jbHVkZXMobm9kZUlkcywgZW5kcG9pbnQpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGVuZHBvaW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBlbmRwb2ludCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3JzOiBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXMucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHMucHVzaChlbmRwb2ludCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKF8uaW5jbHVkZXMobm9kZUlkcywgcHJvdmlkZXIpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHByb3ZpZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBwcm92aWRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3JzOiBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXMucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHMucHVzaChwcm92aWRlcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy9jcmVhdGluZyBsaW5rc1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGlua091dCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogZW5kcG9pbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IHByb3ZpZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0OiBzZXJpZXMudmFsdWVzWzBdWzJdXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGxpbmtzLnB1c2gobGlua091dCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsaW5rSW4gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6IHByb3ZpZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiBlbmRwb2ludCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHdlaWdodDogc2VyaWVzLnZhbHVlc1swXVsxXVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBsaW5rcy5wdXNoKGxpbmtJbik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLm5vZGVzID0gbm9kZXM7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxpbmtzID0gbGlua3M7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLy9pbml0aWFsIGNhbGxcbiAgICAgICAgICAgIFZpc3VhbGl6YXRpb25TZXJ2aWNlLmdldEdyYXBoRGF0YSgpLnRoZW4oc3VjY2Vzc0dyYXBoRGF0YUNhbGxiYWNrLCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vd2lsbCBmYWlsIHNpbGVudGx5LCBncmFwaCB3b24ndCBiZSBkaXNwbGF5ZWRcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHsgJGludGVydmFsLmNhbmNlbCgkc2NvcGUuZ3JhcGhEYXRhSW50ZXJ2YWwpOyB9KTtcblxuICAgICAgICAgICAgVmlzdWFsaXphdGlvblNlcnZpY2UuZ2V0U3RydWN0dXJlRGF0YSgpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vdG8gc2VlIHRoZSBleHBlY3RlZCBmb3JtIG9mIGFuY2VzdG9yX3N0cnVjdCBhbmQgY2hpbGRyZW5fc3RydWN0LCBcbiAgICAgICAgICAgICAgICAvL2xvb2sgYXQgYXBwL2NvbXBvbmVudHMvZ3JhcGhvYmplY3RzL2RhdGFzb3VyY2UvdmlzdWFsaXplcmRhdGFzb3VyY2UuanNcbiAgICAgICAgICAgICAgICAkc2NvcGUuYW5jZXN0b3JzX3N0cnVjdCA9IHJlc3VsdC5hbmNlc3RvcnNfc3RydWN0O1xuICAgICAgICAgICAgICAgICRzY29wZS5jaGlsZHJlbl9zdHJ1Y3QgPSByZXN1bHQuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgICRzY29wZS5sYWJlbHMgPSByZXN1bHQubGFiZWxzO1xuICAgICAgICAgICAgICAgICRzY29wZS5zZXJ2aWNlU2VsZWN0b3JzID0gcmVzdWx0LnNlcnZpY2VTZWxlY3RvcnM7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vd2lsbCBmYWlsIHNpbGVudGx5LCBncmFwaCB3b24ndCBiZSBkaXNwbGF5ZWRcbiAgICAgICAgICAgIH0pO1xuICAgIH1dKTtcblxuXG5cblxuXG5cblxuXG5cblxuXG4iLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nKVxuICAgIC5mYWN0b3J5KCdWaXN1YWxpemF0aW9uU2VydmljZScsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbiAoJGh0dHAsICRxKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYWtlcyBhIGdldCByZXF1ZXN0IHdpdGggdGhlIHVybCBhbmQgY29uZmlnLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgdXJsICAgICBUaGUgdXJsXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBjb25maWcgIFRoZSBjb25maWd1cmF0aW9uc1xuICAgICAgICAgKiBAcmV0dXJuICAgICB7JEh0dHAgUHJvbWlzZX0gICBQcm9taXNlIG9mIHRoZSByZXF1ZXN0XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBtYWtlR2V0KHVybCwgY29uZmlnKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCwgY29uZmlnKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogTWFrZXMgYSBwb3N0IHJlcXVlc3Qgd2l0aCB0aGUgdXJsIGFuZCBkYXRhXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICB1cmwgICAgIFRoZSB1cmxcbiAgICAgICAgICogQHBhcmFtICAgICAge0pTT059ICAgIGRhdGEgICAgVGhlIGRhdGFcbiAgICAgICAgICogQHJldHVybiAgICAgeyRIdHRwIFByb21pc2V9ICAgUHJvbWlzZSBvZiB0aGUgcmVxdWVzdFxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gbWFrZVBvc3QodXJsLCBkYXRhKSB7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIGNvbnZlcnRzIHRoZSBkYXRhIGludG8geC13d3ctZnJvbS11cmxlbmNvZGVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0pTT059ICBvYmogICAgIEpTT04gZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtzdHJpbmd9ICB4LXd3dy1mb3JtLXVybGVuY29kZWQgc3RyaW5nXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHZhciBwYXJhbSA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgICAgICAgICAgIHZhciBxdWVyeSA9ICcnLCBuYW1lLCB2YWx1ZSwgZnVsbFN1Yk5hbWUsIHN1Yk5hbWUsIHN1YlZhbHVlLCBpbm5lck9iaiwgaTtcbiAgICAgICAgICAgICAgICBmb3IgKG5hbWUgaW4gb2JqKSB7XG4gICAgICAgICAgICAgICAgICB2YWx1ZSA9IG9ialtuYW1lXTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpPTA7IGk8dmFsdWUubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJWYWx1ZSA9IHZhbHVlW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bGxTdWJOYW1lID0gbmFtZSArICdbJyArIGkgKyAnXSc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5uZXJPYmogPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbm5lck9ialtmdWxsU3ViTmFtZV0gPSBzdWJWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeSArPSBwYXJhbShpbm5lck9iaikgKyAnJic7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBPYmplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoc3ViTmFtZSBpbiB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlZhbHVlID0gdmFsdWVbc3ViTmFtZV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVsbFN1Yk5hbWUgPSBuYW1lICsgJ1snICsgc3ViTmFtZSArICddJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbm5lck9iaiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlubmVyT2JqW2Z1bGxTdWJOYW1lXSA9IHN1YlZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ICs9IHBhcmFtKGlubmVyT2JqKSArICcmJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmKHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ICs9IGVuY29kZVVSSUNvbXBvbmVudChuYW1lKSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkgKyAnJic7XG4gICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBxdWVyeS5sZW5ndGggPyBxdWVyeS5zdWJzdHIoMCwgcXVlcnkubGVuZ3RoIC0gMSkgOiBxdWVyeTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgdXJsOnVybCxcbiAgICAgICAgICAgICAgICBtZXRob2Q6J1BPU1QnLFxuICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEsXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm1SZXF1ZXN0OiBbZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYW5ndWxhci5pc09iamVjdChkYXRhKSAmJiBTdHJpbmcoZGF0YSkgIT09ICdbb2JqZWN0IEZpbGVdJyA/IHBhcmFtKGRhdGEpIDogZGF0YTtcbiAgICAgICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldEdyYXBoRGF0YSgpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLlZJU1VBTElaQVRJT05fRU5EUE9JTlQ7XG4gICAgICAgICAgICB1cmwgKz0gJ2luZmx1eC9xdWVyeSc7XG4gICAgICAgICAgICB2YXIgY29uZmlnID0ge1xuICAgICAgICAgICAgICAgIHBhcmFtczoge1xuICAgICAgICAgICAgICAgICAgICBkYjpcInRlbGVncmFmXCIsXG4gICAgICAgICAgICAgICAgICAgIHE6XCJTRUxFQ1QgQnl0ZXNJbiwgQnl0ZXNPdXQsIEVuZHBvaW50SVAsIFByb3ZpZGVySVAgRlJPTSBodHRwanNvbl9zdmNzdGF0cyBXSEVSRSB0aW1lID4gbm93KCkgLSAxbSBHUk9VUCBCWSAqIExJTUlUIDFcIlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gbWFrZUdldCh1cmwsIGNvbmZpZyk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRTdHJ1Y3R1cmVEYXRhKCkge1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuVklTVUFMSVpBVElPTl9FTkRQT0lOVDtcbiAgICAgICAgICAgIHVybCArPSAnc2VydmljZXMnO1xuICAgICAgICAgICAgcmV0dXJuIG1ha2VHZXQodXJsKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGJ1aWxkV2hlcmVRdWVyeShwb2ludHMsIHR5cGUpIHtcbiAgICAgICAgICAgIHZhciBxdWVyeSA9IFwiKFwiO1xuICAgICAgICAgICAgcXVlcnkgKz0gdHlwZSArIFwiPVwiO1xuICAgICAgICAgICAgcXVlcnkgKz0gXCInXCIgKyBwb2ludHNbMF0gKyBcIicgXCI7XG4gICAgICAgICAgICAvL3N0YXJ0cyBhdCAxLCBzbyB3aWxsIG5vdCBydW4gaWYgbGVuZ3RoIGlzIDFcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgcG9pbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcXVlcnkgKz0gJ09SICc7XG4gICAgICAgICAgICAgICAgcXVlcnkgKz0gdHlwZSArIFwiPVwiO1xuICAgICAgICAgICAgICAgIHF1ZXJ5ICs9IFwiJ1wiICsgcG9pbnRzW2ldICsgXCInIFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcXVlcnkgKz0gXCIpXCI7XG4gICAgICAgICAgICByZXR1cm4gcXVlcnk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRFZGdlRGF0YShzb3VyY2VMaXN0LCB0YXJnZXRMaXN0LCB0aW1lKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WSVNVQUxJWkFUSU9OX0VORFBPSU5UO1xuICAgICAgICAgICAgdXJsICs9ICdpbmZsdXgvcXVlcnknO1xuXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICAgICAgZGIgOiBcInRlbGVncmFmXCIsXG4gICAgICAgICAgICAgICAgICAgIHE6IFwiU0VMRUNUIHN1bShcIiArICdCeXRlc091dCcgKyBcIikgZnJvbSBodHRwanNvbl9zdmNzdGF0cyBXSEVSRSB0aW1lID4gbm93KCkgLSAxNXMgQU5EIFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkoc291cmNlTGlzdCwgXCJFbmRwb2ludElQXCIpICtcIiBBTkQgXCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkodGFyZ2V0TGlzdCwgJ1Byb3ZpZGVySVAnKSBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIFwiR1JPVVAgQlkgdGltZSgyMHMpIExJTUlUIDE7IFNFTEVDVCBzdW0oXCIgKyAnQnl0ZXNJbicgKyBcIikgZnJvbSBodHRwanNvbl9zdmNzdGF0cyBXSEVSRSB0aW1lID4gbm93KCkgLSAxNXMgQU5EIFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkoc291cmNlTGlzdCwgJ1Byb3ZpZGVySVAnKSArXCIgQU5EIFwiIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHRhcmdldExpc3QsICdFbmRwb2ludElQJykgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBcIkdST1VQIEJZIHRpbWUoMjBzKSBmaWxsKDApIExJTUlUIDFcIlxuICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBtYWtlUG9zdCh1cmwsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgXG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0T2xkRWRnZURhdGEoc291cmNlTGlzdCwgdGFyZ2V0TGlzdCkge1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuVklTVUFMSVpBVElPTl9FTkRQT0lOVDtcbiAgICAgICAgICAgIHVybCArPSAnaW5mbHV4L3F1ZXJ5JztcbiAgICAgICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICBkYiA6IFwidGVsZWdyYWZcIixcbiAgICAgICAgICAgICAgICAgICAgcTogXCJTRUxFQ1Qgc3VtKFwiICsgJ0J5dGVzT3V0JyArIFwiKSBGUk9NIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDFtIEFORCBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHNvdXJjZUxpc3QsIFwiRW5kcG9pbnRJUFwiKSArXCIgQU5EIFwiIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHRhcmdldExpc3QsIFwiUHJvdmlkZXJJUFwiKSBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIFwiIEdST1VQIEJZIHRpbWUoMTBzKSBmaWxsKDApIExJTUlUIDY7IFNFTEVDVCBzdW0oXCIgKyAnQnl0ZXNJbicgKyBcIikgRlJPTSBodHRwanNvbl9zdmNzdGF0cyBXSEVSRSB0aW1lID4gbm93KCkgLSAxbSBBTkQgXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeShzb3VyY2VMaXN0LCBcIlByb3ZpZGVySVBcIikgK1wiIEFORCBcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeSh0YXJnZXRMaXN0LCBcIkVuZHBvaW50SVBcIikgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBcIiBHUk9VUCBCWSB0aW1lKDEwcykgZmlsbCgwKSBMSU1JVCA2XCJcbiAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gbWFrZVBvc3QodXJsLCBkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRHcmFwaERhdGE6IGdldEdyYXBoRGF0YSxcbiAgICAgICAgICAgIGdldFN0cnVjdHVyZURhdGE6IGdldFN0cnVjdHVyZURhdGEsXG4gICAgICAgICAgICBnZXRFZGdlRGF0YTogZ2V0RWRnZURhdGEsXG4gICAgICAgICAgICBnZXRPbGRFZGdlRGF0YTogZ2V0T2xkRWRnZURhdGFcbiAgICAgICAgfVxuICAgIH1dKTtcblxuXG5cblxuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNi8zLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZvbHVtZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52b2x1bWVzLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2b2x1bWVzL3ZvbHVtZWNyZWF0ZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWb2x1bWVDcmVhdGVDdHJsIGFzIHZvbHVtZUNyZWF0ZUN0cmwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdWb2x1bWVDcmVhdGVDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ1ZvbHVtZXNNb2RlbCcsICdTdG9yYWdlUG9saWNpZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBWb2x1bWVzTW9kZWwsIFN0b3JhZ2VQb2xpY2llc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgdm9sdW1lQ3JlYXRlQ3RybCA9IHRoaXM7XG4gICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwuZmlsZXN5c3RlbXMgPSBbJ2V4dDQnLCAnYnRyZnMnXTtcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Wb2x1bWVzTW9kZWwoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZvbHVtZXMubGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbENyZWF0aW5nKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9Wb2x1bWVzTW9kZWwoKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IHN0b3JhZ2UgcG9saWNpZXMuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBnZXRTdG9yYWdlUG9saWNpZXMoKSB7XG4gICAgICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbC5nZXQoKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLnBvbGljaWVzID0gcmVzdWx0O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gYXBwbHlQb2xpY3lTZXR0aW5ncygpIHtcbiAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwubmV3Vm9sdW1lLnBvbGljeSA9IHZvbHVtZUNyZWF0ZUN0cmwuc2VsZWN0ZWRQb2xpY3kubmFtZTtcbiAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwubmV3Vm9sdW1lLmJhY2tlbmRzID0gdm9sdW1lQ3JlYXRlQ3RybC5zZWxlY3RlZFBvbGljeS5iYWNrZW5kcztcbiAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwubmV3Vm9sdW1lLmRyaXZlciA9IHZvbHVtZUNyZWF0ZUN0cmwuc2VsZWN0ZWRQb2xpY3kuZHJpdmVyO1xuICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUuY3JlYXRlID0gdm9sdW1lQ3JlYXRlQ3RybC5zZWxlY3RlZFBvbGljeS5jcmVhdGU7XG4gICAgICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLm5ld1ZvbHVtZS5ydW50aW1lID0gdm9sdW1lQ3JlYXRlQ3RybC5zZWxlY3RlZFBvbGljeS5ydW50aW1lO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZVZvbHVtZSgpIHtcbiAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgaWYgKHZvbHVtZUNyZWF0ZUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgYXBwbHlQb2xpY3lTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIFZvbHVtZXNNb2RlbC5jcmVhdGUodm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1ZvbHVtZXNNb2RlbCgpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcih2b2x1bWVDcmVhdGVDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJlc2V0Rm9ybSgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLm5ld1ZvbHVtZSA9IHtcbiAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICBcImJhY2tlbmRzXCI6IHt9LFxuICAgICAgICAgICAgICAgIFwiZHJpdmVyXCI6IHt9LFxuICAgICAgICAgICAgICAgIFwiY3JlYXRlXCI6IHt9LFxuICAgICAgICAgICAgICAgIFwicnVudGltZVwiOiB7fVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLmNyZWF0ZVZvbHVtZSA9IGNyZWF0ZVZvbHVtZTtcbiAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5jYW5jZWxDcmVhdGluZyA9IGNhbmNlbENyZWF0aW5nO1xuICAgICAgICBnZXRTdG9yYWdlUG9saWNpZXMoKTtcbiAgICAgICAgcmVzZXRGb3JtKCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dm9sdW1lY3JlYXRlY3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgY3NoYW1wdXIgb24gOC85LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZvbHVtZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52b2x1bWVzLmNvcHknLCB7XG4gICAgICAgICAgICB1cmw6ICcvY29weS8nLFxuICAgICAgICAgICAgcGFyYW1zOiB7IHNuYXBzaG90OiBudWxsLCBwb2xpY3k6IG51bGwsIHZvbHVtZTogbnVsbCB9LFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1ZvbHVtZVNuYXBzaG90Q29weUN0cmwgYXMgdm9sdW1lU25hcHNob3RDb3B5Q3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZvbHVtZXMvdm9sdW1lc25hcHNob3Rjb3B5Lmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdWb2x1bWVTbmFwc2hvdENvcHlDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGh0dHAnLCAnVm9sdW1lc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRzY29wZSwgJGludGVydmFsLCAkaHR0cCwgVm9sdW1lc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgdm9sdW1lU25hcHNob3RDb3B5Q3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbENvcHkoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZvbHVtZXMuZGV0YWlscycsIHsga2V5OiAkc3RhdGVQYXJhbXMucG9saWN5ICsgJy8nICsgJHN0YXRlUGFyYW1zLnZvbHVtZSB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnb1RvTmV3Vm9sdW1lKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS52b2x1bWVzLmRldGFpbHMnLCB7IGtleTogJHN0YXRlUGFyYW1zLnBvbGljeSArICcvJyArIHZvbHVtZVNuYXBzaG90Q29weUN0cmwubmV3dm9sdW1lIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNvcHlTbmFwc2hvdCgpIHtcbiAgICAgICAgICAgIGlmICh2b2x1bWVTbmFwc2hvdENvcHlDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHZvbHVtZVNuYXBzaG90Q29weUN0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKHZvbHVtZVNuYXBzaG90Q29weUN0cmwpO1xuICAgICAgICAgICAgICAgIHZhciBtb2RlbCA9IHt9O1xuICAgICAgICAgICAgICAgIG1vZGVsLnBvbGljeSA9ICRzdGF0ZVBhcmFtcy5wb2xpY3k7XG4gICAgICAgICAgICAgICAgbW9kZWwubmFtZSA9ICRzdGF0ZVBhcmFtcy52b2x1bWU7XG4gICAgICAgICAgICAgICAgVm9sdW1lc01vZGVsLmNvcHkobW9kZWwsICRzdGF0ZVBhcmFtcy5zbmFwc2hvdCwgdm9sdW1lU25hcHNob3RDb3B5Q3RybC5uZXd2b2x1bWUpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVTbmFwc2hvdENvcHlDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgZ29Ub05ld1ZvbHVtZSgpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lU25hcHNob3RDb3B5Q3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcih2b2x1bWVTbmFwc2hvdENvcHlDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZvbHVtZVNuYXBzaG90Q29weUN0cmwucG9saWN5ID0gJHN0YXRlUGFyYW1zLnBvbGljeTtcbiAgICAgICAgdm9sdW1lU25hcHNob3RDb3B5Q3RybC52b2x1bWUgPSAkc3RhdGVQYXJhbXMudm9sdW1lO1xuICAgICAgICB2b2x1bWVTbmFwc2hvdENvcHlDdHJsLnNuYXBzaG90ID0gJHN0YXRlUGFyYW1zLnNuYXBzaG90O1xuICAgICAgICB2b2x1bWVTbmFwc2hvdENvcHlDdHJsLmNvcHlTbmFwc2hvdCA9IGNvcHlTbmFwc2hvdDtcbiAgICAgICAgdm9sdW1lU25hcHNob3RDb3B5Q3RybC5jYW5jZWxDb3B5ID0gY2FuY2VsQ29weTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD12b2x1bWVzbmFwc2hvdGNvcHljdHJsLmpzLm1hcCIsImFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2QWNpdmFsaWRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9kaXJlY3RpdmVzL25vZGVzL2FjaXZhbGlkLmh0bWwnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBmb3JtOiBcIj1cIlxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pOyIsImFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2Q29udHJvbGludGVyZmFjZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvbm9kZXMvY29udHJvbGludGVyZmFjZS5odG1sJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgZXh0cmF2YXJzOiBcIj1cIlxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pOyIsImFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2TmV0d29ya21vZGVcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9kaXJlY3RpdmVzL25vZGVzL25ldHdvcmttb2RlLmh0bWwnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBleHRyYXZhcnM6IFwiPVwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7IiwiYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZTY2hlZHVsZXJcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9kaXJlY3RpdmVzL25vZGVzL3NjaGVkdWxlci5odG1sJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgZXh0cmF2YXJzOiBcIj1cIlxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
>>>>>>> 3d51c09... login ctrl to angular 2
=======
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}angular.module("contiv.graph",[]),angular.module("contiv.directives",[]),angular.module("contiv.models",[]);var ContivGlobals=function(){return{NETWORKS_ENDPOINT:"/netmaster/api/v1/networks/",NETWORKS_INSPECT_ENDPOINT:"/netmaster/api/v1/inspect/networks/",SERVICELBS_INSPECT_ENDPOINT:"/netmaster/api/v1/inspect/serviceLBs/",POLICIES_ENDPOINT:"/netmaster/api/v1/policys/",RULES_ENDPOINT:"/netmaster/api/v1/rules/",APPLICATIONGROUPS_ENDPOINT:"/netmaster/api/v1/endpointGroups/",SERVICELBS_ENDPOINT:"/netmaster/api/v1/serviceLBs/",ORGANIZATIONS_ENDPOINT:"/netmaster/api/v1/tenants/",NETWORK_SETTINGS_ENDPOINT:"/netmaster/api/v1/globals/",NETPROFILES_ENDPOINT:"/netmaster/api/v1/netprofiles/",BGPS_ENDPOINT:"/netmaster/api/v1/Bgps/",BGPS_INSPECT_ENDPOINT:"/netmaster/api/v1/inspect/Bgps/",VISUALIZATION_ENDPOINT:"/visualization/",VOLUMES_ENDPOINT:"/volmaster/volumes/",VOLUMES_CREATE_ENDPOINT:"/volmaster/volumes/create/",VOLUMES_DELETE_ENDPOINT:"/volmaster/volumes/remove/",VOLUMES_COPYSNAPSHOTS_ENDPOINT:"/volmaster/volumes/copy",VOLUMES_USES_ENDPOINT:"/volmaster/uses/mounts/",VOLUMES_SNAPSHOTS_ENDPOINT:"/volmaster/snapshots/",STORAGEPOLICIES_ENDPOINT:"/volmaster/policies/",VOLUMES_GLOBAL_ENDPOINT:"/volmaster/global/",NODES_LIST_ENDPOINT:"/info/nodes",NODES_DISCOVER_ENDPOINT:"/discover/nodes",NODES_COMMISSION_ENDPOINT:"/commission/nodes",NODES_DECOMMISSION_ENDPOINT:"/decommission/nodes",NODES_MAINTENANCE_ENDPOINT:"/maintenance/nodes",NODES_LAST_JOB_ENDPOINT:"/info/job/last",NODES_ACTIVE_JOB_ENDPOINT:"/info/job/active",NODES_SETTINGS_SET_ENDPOINT:"/globals",NODES_SETTINGS_GET_ENDPOINT:"/info/globals",REFRESH_INTERVAL:5e3,CIDR_REGEX:"^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]).){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(/([0-9]|[1-2][0-9]|3[0-2]))$",VLAN_REGEX:"^([0-9]{1,4}?-[0-9]{1,4}?)$",VXLAN_REGEX:"^([0-9]{1,8}?-[0-9]{1,8}?)$",NUMBER_REGEX:"^[0-9]*$"}}(),_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();angular.module("contiv.graph").factory("DataSource",["Node","Link",function(t,e){var n=function(){function n(t,e){_classCallCheck(this,n),this.nodes=t,this.links=e}return _createClass(n,[{key:"updateNodes",value:function(t){this.nodes=t}},{key:"updateLinks",value:function(t){this.links=t}},{key:"nodeIdToName",value:function(t){for(var e=this.nodes,n=0;n<e.length;n++)if(e[n].id==t)return e[n].name}},{key:"processNodeData",value:function(e){var n=[];return _.forEach(e,function(e){var o=new t.Node(null,null,e.id,e.text,null);n.push(o)}),n}},{key:"processLinkData",value:function(t,n){function o(t,e){for(var n=0;n<e.length;n++)if(t==e[n].id)return e[n]}for(var i=[],r=0;r<t.length;r++)if(t[r].source!=t[r].target){var a=o(t[r].source,n),s=o(t[r].target,n);if(null==a||null==s)continue;var l=new e.Link(a,s);i.push(l)}return i}}]),n}();return{DataSource:n}}]),angular.module("contiv.utils",[]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();angular.module("contiv.graph").factory("VisualizerDataSource",["DataSource","VisualizerNode","VisualizerLink",function(t,e,n){var o=function(t){function o(t,e,n,i,r,a){_classCallCheck(this,o);var s=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t,e));return s.children_struct=n,s.ancestors_struct=i,s.labels=r,s.selectors=a,s}return _inherits(o,t),_createClass(o,[{key:"hasChild",value:function(t){return null!=this.children_struct[t]}},{key:"setAncestors",value:function(){var t=this,e=!1;_.forEach(t.nodes,function(n){n.ancestors=t.ancestors_struct[n.id]||[],_.isEmpty(n.ancestors)===!1?n.parent=n.ancestors[0]:0==_.includes(t.children_struct.topLevel,n.id)&&(n.ancestors.push("client"),t.ancestors_struct[n.id]=["client"],e===!1&&(e=!0,t.children_struct.topLevel.push("client"),t.children_struct.client=[]),t.children_struct.client.push(n.id))})}},{key:"getTopLevelFlow",value:function(){return this.getFlowBetweenSet(this.children_struct.topLevel)}},{key:"getFlowBetweenSet",value:function(t){for(var e=this.nodes,n={},o=0;o<e.length;o++){var i=e[o];if(null===i.ancestors)n[i.id]=i.name;else for(var r=0;r<t.length;r++)if(i.ancestors.indexOf(t[r])>-1){n[i.id]=t[r];break}}for(var a=this.links,s=[],o=0;o<a.length;o++){var l=[];l.source=n[a[o].source]||a[o].source,l.target=n[a[o].target]||a[o].target,l.weight=a[o].weight,s.push(l)}for(var c=[],o=0;o<t.length;o++){var u=[];u.id=t[o],u.text=this.nodeIdToName(t[o])||t[o],u.ancestors=this.ancestors_struct[t[o]]||this.ancestors_struct[u.text]||[],_.isEmpty(u.ancestors)===!1?u.parent=u.ancestors[0]:u.parent=null,c.push(u)}return{nodeData:c,linkData:s}}},{key:"processNodeData",value:function(t){var n=[];return _.forEach(t,function(t){var o=new e.Node(null,null,t.id,t.text,null,t.parent,t.ancestors,null,null);n.push(o)}),n}},{key:"processLinkData",value:function(t,e){function o(t,e){for(var n=0;n<e.length;n++)if(t==e[n].id)return e[n]}for(var i=[],r={},a=0;a<t.length;a++)if(t[a].source!=t[a].target){var s=o(t[a].source,e),l=o(t[a].target,e),c=t[a].weight;if(null==s||null==l)continue;if(void 0===r[s.id+"-"+l.id]){var u=new n.Link(s,l,c);r[s.id+"-"+l.id]=u,i.push(u)}else{var d=r[s.id+"-"+l.id];d.setWeight(d.getRawWeight()+c),d.increaseCount()}}return i}}]),o}(t.DataSource);return{DataSource:o}}]),angular.module("contiv.applicationgroups",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(t){t.state("contiv.menu.applicationgroups",{url:"/applicationgroups","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.applicationgroups.create",{url:"/create",component:"applicationgroupcreate"}).state("contiv.menu.applicationgroups.details",{url:"/details/:key",component:"applicationgroupdetails"}).state("contiv.menu.applicationgroups.edit",{url:"/edit/:key",component:"applicationgroupdetails"}).state("contiv.menu.applicationgroups.list",{url:"/list",component:"applicationGrouplist"})}]),angular.module("contiv.dashboard",["contiv.models"]).config(["$stateProvider",function(t){t.state("contiv.menu.dashboard",{url:"/dashboard",component:"dashboard"})}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();angular.module("contiv.graph").factory("Graph",["PolicyService",function(t){var e=function(){function e(n,o,i){_classCallCheck(this,e);var r=this;r.nodes=o||[],r.links=i||[],r.defaultNodePolicies=[],r.defaultPathPolicies=[],r.svgPolicy=new t.Policy,r.state={canZoom:!0,canPan:!0,initForce:!1,disableUpdate:!1},r.consts={circleGClass:"conceptG",graphClass:"graph",pathClass:"path",nodeClass:"circle",nodeText:"nodeText",startRadius:50,maxRadius:60,padding:5,displayOffset:60},n.on("mouseover",function(t){r.svgPolicy.mouseover.call(this,t)}).on("dblclick",function(t){r.svgPolicy.dblclick.call(this,t)}).on("contextmenu",function(t){r.svgPolicy.contextmenu.call(this,t)}).on("mouseout",function(t){r.svgPolicy.mouseout.call(this,t)}).on("mousedown",function(t){r.svgPolicy.mousedown.call(this,t)}).on("mouseup",function(t){r.svgPolicy.mouseup.call(this,t)});var a=n.append("svg:defs");a.append("svg:marker").attr("id","end-arrow").attr("viewBox","0 -5 10 10").attr("refX",20).attr("refY",-1).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5"),a.append("svg:marker").attr("id","mark-end-arrow").attr("viewBox","0 -5 10 10").attr("refX",7).attr("markerWidth",3.5).attr("markerHeight",3.5).attr("orient","auto").append("svg:path").attr("d","M0,-5L10,0L0,5"),r.svg=n,r.svgG=n.append("g").classed(r.consts.graphClass,!0);var s=r.svgG;r.paths=s.append("g").selectAll("g"),r.circles=s.append("g").selectAll("g"),r.initNodes(),r.initLinks(),r.setPositions();var l=function(){r.onWindowResize(n)};r.bindings={resize:l},$(window).resize(l)}return _createClass(e,[{key:"destroy",value:function(){var t=this;_(t.defaultNodePolicies).forEach(function(t){t.destroy()}),_(t.defaultPathPolicies).forEach(function(t){t.destroy()}),t.svgPolicy.destroy();for(var e in t.bindings)$(window).off(e,t.bindings[e])}},{key:"initNodes",value:function(){var t=this;_.forEach(t.nodes,function(e){e.initialize(t)})}},{key:"initLinks",value:function(){var t=this;_.forEach(t.links,function(e){e.initialize(t)})}},{key:"findNodeById",value:function(t){for(var e=this,n=0;n<e.nodes.length;n++)if(t===e.nodes[n].id)return e.nodes[n]}},{key:"findD3Node",value:function(t){var e,n=this;return n.circles.each(function(n){n.id===t&&(e=d3.select(this))}),e}},{key:"installDragPolicy",value:function(t){this.drag=t}},{key:"installSvgPolicy",value:function(t){this.svgPolicy=t}},{key:"installDefaultNodePolicy",value:function(t){var e=this;e.defaultNodePolicies.push(t),t.initialize(e)}},{key:"uninstallDefaultNodePolicy",value:function(t){var e;e="string"==typeof t?t:t.policyName,_(thisGraph.defaultNodePolicies).forEach(function(t,n){t.policyName===e&&(t.destroy(),thisGraph.defaultNodePolicies.splice(n,1))})}},{key:"getNodePolicy",value:function(t){var e=this;_(e.defaultNodePolicies).forEach(function(e,n){return e.policyName===t?e:void 0})}},{key:"installDefaultPathPolicy",value:function(t){var e=this;e.defaultPathPolicies.push(t),t.initialize(e)}},{key:"uninstallDefaultPathPolicy",value:function(t){var e,n=this;e="string"==typeof t?t:t.policyName,_(n.defaultPathPolicies).forEach(function(t,o){t.policyName===e&&(t.destroy(),n.defaultPathPolicies.splice(o,1))})}},{key:"pathPolicyEvent",value:function(t,e,n){var o=this;_(o.defaultPathPolicies).forEach(function(o){o[t](e,n)})}},{key:"nodePolicyEvent",value:function(t,e,n){var o=this;_.forEach(o.defaultNodePolicies,function(o){o[t](e,n)})}},{key:"installZoomPolicy",value:function(t){this.dragSvg=t,this.svg.call(this.dragSvg)}},{key:"onWindowResize",value:function(t){}},{key:"insertTitleLinebreaks",value:function(t,e){for(var n=this,o=e.split(/\s+/g),i=o.length,r=t.append("text").attr("class",n.consts.nodeText).attr("text-anchor","middle").attr("dy","-"+7.5*(i-1)),a=0;a<o.length;a++){var s=r.append("tspan").text(o[a]);a>0&&s.attr("x",0).attr("dy","15")}}},{key:"spliceLinksForNode",value:function(t){var e=this,n=e.links.filter(function(e){return e.source===t||e.target===t});n.map(function(t){e.links.splice(e.links.indexOf(t),1)})}},{key:"addNode",value:function(t){var e=this;e.nodes.push(t),t.initialize(e),e.updateGraph()}},{key:"removeNode",value:function(t){var e=this;e.nodes.splice(e.nodes.indexOf(t),1),e.spliceLinksForNode(t),e.updateGraph()}},{key:"addLink",value:function(t){var e=this;e.links.push(t),t.initialize(e),e.updateGraph()}},{key:"removeLink",value:function(t){var e=this;e.links.splice(e.links.indexOf(t),1),t.initialize(e),e.updateGraph()}},{key:"updateExistingPaths",value:function(t){t.each(function(t){t.updateAttr(d3.select(this),t)})}},{key:"updateNewPaths",value:function(t){var e=this;e.initLinks(),t.each(function(t){t.newPathAttr(d3.select(this),t)}),t.on("mouseover",function(t){t.hasPolicy?t.pathPolicyEvent("mouseover",d3.select(this),t):e.pathPolicyEvent("mouseover",d3.select(this),t)}).on("dblclick",function(t){t.hasPolicy?t.pathPolicyEvent("dblclick",d3.select(this),t):e.pathPolicyEvent("dblclick",d3.select(this),t)}).on("contextmenu",function(t){t.hasPolicy?t.pathPolicyEvent("contextmenu",d3.select(this),t):e.pathPolicyEvent("contextmenu",d3.select(this),t)}).on("mouseout",function(t){t.hasPolicy?t.pathPolicyEvent("mouseout",d3.select(this),t):e.pathPolicyEvent("mouseout",d3.select(this),t)}).on("mousedown",function(t){t.hasPolicy?t.pathPolicyEvent("mousedown",d3.select(this),t):e.pathPolicyEvent("mousedown",d3.select(this),t)}).on("mouseup",function(t){t.hasPolicy?t.pathPolicyEvent("mouseup",d3.select(this),t):e.pathPolicyEvent("mouseup",d3.select(this),t)}).call(e.drag)}},{key:"updateExistingNodes",value:function(){var t=this;t.circles=this.circles.data(t.nodes,function(t){return t.id}).each(function(t){t.updateAttr(d3.select(this),t)})}},{key:"updateNewNodes",value:function(t){var e=this;t.each(function(t){null==t.graph&&t.initialize(e),t.newNodeAttr(d3.select(this),t)}),t.on("mouseover",function(t){t.hasPolicy?t.nodePolicyEvent("mouseover",d3.select(this),t):e.nodePolicyEvent("mouseover",d3.select(this),t)}).on("dblclick",function(t){t.hasPolicy?t.nodePolicyEvent("dblclick",d3.select(this),t):e.nodePolicyEvent("dblclick",d3.select(this),t)}).on("contextmenu",function(t){t.hasPolicy?t.nodePolicyEvent("contextmenu",d3.select(this),t):e.nodePolicyEvent("contextmenu",d3.select(this),t)}).on("mouseout",function(t){t.hasPolicy?t.nodePolicyEvent("mouseout",d3.select(this),t):e.nodePolicyEvent("mouseout",d3.select(this),t)}).on("mousedown",function(t){t.hasPolicy?t.nodePolicyEvent("mousedown",d3.select(this),t):e.nodePolicyEvent("mousedown",d3.select(this),t)}).on("mouseup",function(t){t.hasPolicy?t.nodePolicyEvent("mouseup",d3.select(this),t):e.nodePolicyEvent("mouseup",d3.select(this),t)}).call(e.drag),t.append("circle").attr("r",function(t){return String(t.radius)}),t.each(function(t){e.insertTitleLinebreaks(d3.select(this),t.text)})}},{key:"d3ForceCollide",value:function(t){var e=this,n=e.consts,o=e.nodes,i=d3.geom.quadtree(o);return function(e){var o=e.radius+n.maxRadius+n.padding,r=e.x-o,a=e.x+o,s=e.y-o,l=e.y+o;i.visit(function(o,i,c,u,d){if(o.point&&o.point!==e){var p=e.x-o.point.x,f=e.y-o.point.y,v=Math.sqrt(p*p+f*f),h=e.radius+o.point.radius+n.padding;h>v&&(v=(v-h)/v*t,e.x-=p*=v,e.y-=f*=v,o.point.x+=p,o.point.y+=f)}return i>a||r>u||c>l||s>d})}}},{key:"d3ForceTick",value:function(t,e,n){for(var o=this,i=o.consts,r=i.displayOffset,a=o.nodes,s=d3.geom.quadtree(o.nodes),l=0,c=a.length;++l<c;)s.visit(this.d3ForceCollide(a[l]));o.circles.each(this.d3ForceCollide(.5)).attr("cx",function(t){return t.x=Math.max(t.radius+r,Math.min(e-r-t.radius,t.x))}).attr("cy",function(t){return t.y=Math.max(t.radius+r,Math.min(n-r-t.radius,t.y))}),o.paths.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y})}},{key:"d3ForceStart",value:function(){var t=this;t.paths.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y})}},{key:"d3ForceEnd",value:function(){var t=this;t.circles.attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}),t.paths.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y})}},{key:"d3ForceBounds",value:function(){var t=$("#visualization-graph").width(),e=$("#visualization-graph").height(),n=t,o=e;return{width:n,height:o}}},{key:"setForce",value:function(t){var e=this,n=e.nodes,o=e.links;if(!_.isEmpty(n)){var i=e.d3ForceBounds(),r=d3.layout.force().size([i.width,i.height]).nodes(n).charge(function(t){return-6e3}).links(o);r.linkDistance(i.width/3),r.linkStrength(.2),r.gravity(.2),r.on("tick",function(t){e.d3ForceTick.call(e,t,i.width,i.height)}),r.on("start",function(){e.d3ForceStart.call(e)}),r.on("end",function(){e.d3ForceEnd.call(e)}),r.start();for(var a=0;r.alpha()>.01&&150>a;)r.tick(),a+=1;r.stop(),null!=t&&t()}}},{key:"setPositions",value:function(){for(var t=this,e=t.consts.displayOffset,n=$("#visualization-graph").width(),o=$("#visualization-graph").height(),i=n-2*e,r=o-2*e,a=t.nodes,s=0;s<a.length;s++)a[s].radius=a[s].radius||t.consts.startRadius,null!=a[s].x&&null!=a[s].y||(a[s].x=i/2+a[s].radius+e,a[s].y=r/2+a[s].radius+e)}},{key:"updateGraph",value:function(t){var e=this,n=e.consts,o=e.state;if(!e.state.disableUpdate){this.updateExistingNodes();var i=e.circles.enter().append("g");i.classed(n.circleGClass,!0),e.circles.exit().remove(),0==o.initForce?(e.setForce(function(){e.updateNewNodes.call(e,i)}),o.initForce=!0):this.updateNewNodes(i),e.paths=e.paths.data(e.links,function(t){return String(t.source.id)+"+"+String(t.target.id)});var r=e.paths;this.updateExistingPaths(r);var a=r.enter().append("path").style("marker-end","url(#end-arrow)").classed("link",!0);this.updateNewPaths(a),r.exit().remove(),null!=t&&t()}}}]),e}();return{Graph:e}}]),angular.module("contiv.login",["contiv.utils"]).config(["$stateProvider",function(t){t.state("contiv.login",{url:"/",component:"login"})}]),angular.module("contiv.menu",[]),angular.module("contiv.networkpolicies",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(t){t.state("contiv.menu.networkpolicies",{url:"/networkpolicies","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.networkpolicies.isolation",{url:"/isolation","abstract":!0,template:"<ui-view/>"}).state("contiv.menu.networkpolicies.isolation.create",{url:"/create",component:"isolationpolicycreate"}).state("contiv.menu.networkpolicies.isolation.details",{url:"/details/:key",component:"isolationpolicydetails"}).state("contiv.menu.networkpolicies.isolation.edit",{url:"/edit/:key",component:"isolationpolicydetails"}).state("contiv.menu.networkpolicies.bandwidth",{url:"/bandwidth","abstract":!0,template:"<ui-view/>"}).state("contiv.menu.networkpolicies.bandwidth.create",{url:"/create",component:"bandwidthpolicycreate"}).state("contiv.menu.networkpolicies.bandwidth.details",{url:"/details/:key",component:"bandwidthpolicydetails"}).state("contiv.menu.networkpolicies.bandwidth.edit",{url:"/edit/:key",component:"bandwidthpolicydetails"}).state("contiv.menu.networkpolicies.redirection",{url:"/redirection","abstract":!0,template:"<ui-view/>"}).state("contiv.menu.networkpolicies.list",{url:"/list",params:{policyTab:null},component:"networkpoliciestabs"})}]),angular.module("contiv.networks",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(t){t.state("contiv.menu.networks",{url:"/networks","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.networks.list",{url:"/list",component:"networkList"}).state("contiv.menu.networks.details",{url:"/details/:key",component:"networkdetails"}).state("contiv.menu.networks.create",{url:"/create",component:"networkcreate"})}]),angular.module("contiv.nodes",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(t){t.state("contiv.menu.nodes",{url:"/nodes","abstract":!0,template:'<div ui-view class="ui container"/>'})}]),angular.module("contiv.organizations",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(t){t.state("contiv.menu.organizations",{url:"/organizations","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.organizations.list",{url:"/list",component:"organizationlist"})}]),angular.module("contiv.servicelbs",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(t){t.state("contiv.menu.servicelbs",{url:"/servicelbs","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.servicelbs.list",{url:"/list",component:"servicelbList"}).state("contiv.menu.servicelbs.create",{url:"/create",component:"servicelbCreate"}).state("contiv.menu.servicelbs.details",{url:"/details/:key",component:"servicelbDetails"})}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();angular.module("contiv.graph").factory("VisualizerGraph",["Graph",function(t){var e=function(t){function e(t,n,o,i){_classCallCheck(this,e);var r=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o)),a=r;a.state.transition=[],a.consts.edge_buffer=200,a.consts.radiusDecay=1,a.consts.containerClass="container",a.dataSource=i;var s=d3.behavior.drag().origin(function(t){return{x:t.x,y:t.y}}).on("dragstart",function(){}).on("drag",function(t){d3.select(this).attr("transform",function(t,e){return t.x+=d3.event.dx,t.y+=d3.event.dy,"translate("+[t.x,t.y]+")"}),a.updateGraph()}).on("dragend",function(){});a.drag=s;var l=d3.behavior.zoom().on("zoom",function(){return null!=d3.event.sourceEvent&&d3.event.sourceEvent.ctrlKey?!1:(a.zoomed.call(a),!0)}).on("zoomstart",function(t,e){});return a.dragSvg=l,a.svg.call(l).on("dblclick.zoom",null),r}return _inherits(e,t),_createClass(e,[{key:"zoomed",value:function(t,e){var n=this;if(1!=n.state.rightClick){if(this.state.justScaleTransGraph=!0,null!=t&&null!=e){var o=n.dragSvg;o.scale(e),o.translate(t);var i=function(){o.scale(e),o.translate(t)},r="zoom"+t;return void d3.select("."+this.consts.graphClass).transition(r).delay(100).duration(750).attr("transform","translate("+o.translate()+") scale("+o.scale()+")").each("end",i)}n.state.canZoom&&d3.select("."+this.consts.graphClass).attr("transform","translate("+n.dragSvg.translate()+") scale("+n.dragSvg.scale()+")")}}},{key:"onWindowResize",value:function(t){var e=document.getElementsByTagName("body")[0],n=$("#visualization-graph").offset(),o=$("#visualization-graph").width(),i=e.clientHeight;t.attr("width",o).attr("height",i-n.top-20)}},{key:"updateLinkData",value:function(){for(var t=this,e=[],n=0;n<t.nodes.length;n++)e.push(t.nodes[n].id);var o=t.dataSource.getFlowBetweenSet(e),i=o.linkData;t.links=t.dataSource.processLinkData(i,t.nodes),this.initNodes(),this.initLinks(),t.updateGraph()}}]),e}(t.Graph);return{Graph:e}}]),angular.module("contiv.settings",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(t){t.state("contiv.menu.settings",{url:"/global","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.settings.details",{url:"/settings",templateUrl:"settings/settingsmenu.html"}).state("contiv.menu.settings.details.logs",{url:"/logs",controller:"",templateUrl:""}).state("contiv.menu.settings.details.auth",{url:"/auth",controller:"",templateUrl:""}).state("contiv.menu.settings.details.license",{url:"/license",controller:"",templateUrl:""}).state("contiv.menu.settings.details.policies",{url:"/policies",controller:"",templateUrl:""}).state("contiv.menu.settings.details.networks",{url:"/networks",component:"networksetting"}).state("contiv.menu.settings.details.volumes",{url:"/volumes",component:"volumesetting"}).state("contiv.menu.settings.details.cluster",{url:"/cluster",component:"clustersettings"})}]),angular.module("contiv.storagepolicies",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(t){t.state("contiv.menu.storagepolicies",{url:"/storagepolicies","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.storagepolicies.list",{url:"/list",component:"storagepolicylist"})}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();angular.module("contiv.graph").factory("Link",[function(){var t=function(){function t(e,n){_classCallCheck(this,t),this.source=e,this.target=n,this.hasPolicy=!1,this.pathPolicies=[],this.graph=null,this.initialized=!1}return _createClass(t,[{key:"initialize",value:function(t){0==this.initialized&&(this.initialized=!0,this.graph=t)}},{key:"updateAttr",value:function(t,e){t.style("marker-end","url(#end-arrow)").attr("d",arrowPath)}},{key:"newPathAttr",value:function(t,e){t.attr("d",arrowPath)}},{key:"arrowPath",value:function(){var t=this,e=t.target.x-t.source.x,n=t.target.y-t.source.y,o=Math.sqrt(e*e+n*n);return"M"+t.source.x+","+t.source.y+"A"+o+","+o+" 0 0,1 "+t.target.x+","+t.target.y}},{key:"installPathPolicy",value:function(t){this.hasPolicy=!0,this.pathPolicies.push(t),t.initialize(this.graph)}},{key:"uninstallPathPolicy",value:function(t){var e,n=this;e="string"==typeof t?t:t.policyName,_(n.pathPolicies).forEach(function(t,o){t.policyName===e&&(t.destroy(),n.pathPolicies.splice(o,1))}),0===n.pathPolicies.length&&(n.hasPolicy=!1)}},{key:"pathPolicyEvent",value:function(t,e,n){_(n.pathPolicies).forEach(function(o){o[t](e,n)})}}]),t}();return{Link:t}}]),angular.module("contiv.visualization",["contiv.models","contiv.directives","contiv.utils","contiv.graph"]).config(["$stateProvider",function(t){t.state("contiv.menu.visualization",{url:"/visualization","abstract":!0,template:'<div ui-view class="ui container"/>'})}]),angular.module("contiv.volumes",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(t){t.state("contiv.menu.volumes",{url:"/volumes","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.volumes.list",{url:"/list",component:"volumelist"}).state("contiv.menu.volumes.details",{url:"/details/:key",component:"volumedetails"
})}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),_get=function t(e,n,o){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var r=Object.getPrototypeOf(e);return null===r?void 0:t(r,n,o)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(o)};angular.module("contiv.graph").factory("VisualizerLink",["Link",function(t){var e=function(t){function e(t,n,o){_classCallCheck(this,e);var i=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.weight=o,i.count=1,i}return _inherits(e,t),_createClass(e,[{key:"increaseCount",value:function(){this.count+=1}},{key:"qtipHelper",value:function(){var t,e=this,n=(e.target.x-e.source.x)/2,o=(e.target.y-e.source.y)/2;return t=e.source.x<e.target.x?{my:"top center",at:"center center",target:[n,o],adjust:{y:10}}:{my:"bottom center",at:"center center",target:[n,o],adjust:{y:-10}}}},{key:"initialize",value:function(t){if(0==this.initialized){_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"initialize",this).call(this,t);var n=t.state.VisualizerLink;null==n&&(n=t.state.VisualizerLink={},n.maxWeight=null,n.useAvgWeight=!0),this.updateMaxWeight()}}},{key:"setUseAvgWeight",value:function(t){this.graph.state.VisualizerLink.useAvgWeight=!!t}},{key:"setWeight",value:function(t){this.weight=t}},{key:"getRawWeight",value:function(){return this.weight}},{key:"getWeight",value:function(){var t=this.graph,e=t.state.VisualizerLink;if(e.useAvgWeight){var n=this.weight/this.count;return n}return this.weight}},{key:"updateMaxWeight",value:function(){var t=this.graph,e=t.state.VisualizerLink,n=_.maxBy(t.links,function(t){return null!=t.graph?t.getWeight():0});e.maxWeight=n.getWeight()}},{key:"updateAttr",value:function(t,e){var n=this.graph,o=n.state.VisualizerLink;this.updateMaxWeight();var i=d3.scale.linear().domain([0,o.maxWeight]).range(["#ffb366","#F92606"]);o.colorScale=i,t.style("marker-end","url(#end-arrow)").classed(n.consts.selectedClass,function(t){return t===o.selectedEdge}).attr("d",this.arrowPath.call(e)).transition("existingPathTransition").duration(750).attr("stroke",function(t){var e=i(t.getWeight());return e})}},{key:"newPathAttr",value:function(t,e){var n=this.graph,o=n.state.VisualizerLink;this.updateMaxWeight();var i=d3.scale.linear().domain([0,o.maxWeight]).range(["#ffb366","#F92606"]);t.transition("newPathTransition").duration(750).attrTween("opacity",function(t){return d3.interpolateString(0,1)}).attr("stroke",function(t){var e=i(t.getWeight());return e}).attr("d",this.arrowPath.call(e))}}]),e}(t.Link);return{Link:e}}]),angular.module("contivApp",["ui.router","contiv.login","contiv.menu","contiv.dashboard","contiv.applicationgroups","contiv.networks","contiv.networkpolicies","contiv.storagepolicies","contiv.servicelbs","contiv.volumes","contiv.nodes","contiv.organizations","contiv.settings","contiv.visualization"]).config(["$stateProvider","$urlRouterProvider",function(t,e){t.state("contiv",{url:"","abstract":!0,template:'<div ui-view class="ui fluid container"/>'}),e.otherwise("/")}]),angular.module("contiv.menu").config(["$stateProvider",function(t){t.state("contiv.menu",{url:"/m",templateUrl:"menu/menu.html",controller:"MenuCtrl as menuCtrl",params:{username:null}})}]).controller("MenuCtrl",["$state","$stateParams",function(t,e){function n(){t.go("contiv.login")}var o=this;o.username=e.username,o.logout=n}]),angular.module("contiv.nodes").factory("BgpService",["$http","$q",function(t,e){function n(n){var o=e.defer(),i=ContivGlobals.BGPS_ENDPOINT+n.key+"/";return t.get(i).then(function(t){o.resolve(t.data),n.neighbor=t.data,n.neighbors.push({name:n.neighbor.neighbor,value:n.neighbor["neighbor-as"]})},function(t){o.reject(t.data)}),o.promise}function o(e){var n=ContivGlobals.BGPS_ENDPOINT+e.key+"/";return t.post(n,e.neighbor)}function i(n){var o=e.defer(),i=ContivGlobals.BGPS_INSPECT_ENDPOINT+n+"/";return t.get(i).then(function(t){o.resolve(t.data)},function(t){o.reject(t.data)}),o.promise}return{getBgp:n,updateBgp:o,getBgpInspect:i}}]),angular.module("contiv.nodes").directive("ctvLogs",function(){return{restrict:"E",templateUrl:"nodes/logs.html",scope:{log:"=",title:"@"}}}),angular.module("contiv.nodes").factory("LogService",["$http","$q",function(t,e){function n(){var n=e.defer(),o=ContivGlobals.NODES_ACTIVE_JOB_ENDPOINT;return t.get(o).then(function(t){n.resolve(t.data)},function(t){n.reject(t.data)}),n.promise}function o(){var n=e.defer(),o=ContivGlobals.NODES_LAST_JOB_ENDPOINT;return t.get(o).then(function(t){n.resolve(t.data)},function(t){n.reject(t.data)}),n.promise}return{getActiveLogs:n,getLastLogs:o}}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();angular.module("contiv.graph").factory("Node",[function(){var t=function(){function t(e,n,o,i,r){_classCallCheck(this,t),this.x=e,this.y=n,this.radius=r,this.id=o,this.text=i,this.radius=r,this.hasPolicy=!1,this.policy=null,this.nodePolicies=[],this.graph=null,this.initialized=!1}return _createClass(t,[{key:"initialize",value:function(t){0==this.initialized&&(this.initialized=!0,this.graph=t)}},{key:"updateAttr",value:function(t,e){t.attr("transform",function(t){return"translate("+t.x+","+t.y+")"})}},{key:"newNodeAttr",value:function(t,e){}},{key:"setRadius",value:function(t){this.radius=t}},{key:"installNodePolicy",value:function(t){this.hasPolicy=!0,this.nodePolicies.push(t),t.initialize(this.graph)}},{key:"uninstallNodePolicy",value:function(t){var e,n=this;e="string"==typeof t?t:t.policyName,_(n.nodePolicies).forEach(function(t,o){t.policyName===e&&(t.destroy(),n.nodePolicies.splice(o,1))}),0===n.nodePolicies.length&&(n.hasPolicy=!1)}},{key:"nodePolicyEvent",value:function(t,e,n){_.forEach(this.nodePolicies,function(o){o[t](e,n)})}}]),t}();return{Node:t}}]),angular.module("contiv.nodes").config(["$stateProvider",function(t){t.state("contiv.menu.nodes.activelog",{url:"/activelog",controller:"NodeActiveJobLogsCtrl as nodeActiveJobLogsCtrl",template:'<ctv-logs title="Active Job" log="nodeActiveJobLogsCtrl.activeLogs"></ctv-logs>'})}]).controller("NodeActiveJobLogsCtrl",["$scope","$interval","LogService",function(t,e,n){function o(){n.getActiveLogs().then(function(t){i.activeLogs=t},function(t){i.activeLogs={desc:"There is currently no active job. Check Last Job for a job that recently finished."}})}var i=this;o();var r;angular.isDefined(r)||(r=e(function(){o()},ContivGlobals.REFRESH_INTERVAL)),t.$on("$destroy",function(){e.cancel(r)})}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();angular.module("contiv.graph").factory("VisualizerNode",["Node",function(t){var e=function(t){function e(t,n,o,i,r,a,s,l,c){_classCallCheck(this,e);var u=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o,i,r));return u.parent=a,u.ancestors=s,null==l?u.xStart=t:u.xStart=l,null==c?u.yStart=n:u.yStart=c,u}return _inherits(e,t),_createClass(e,[{key:"newNodeAttr",value:function(t,e){var n=this.graph;null!=n.consts.containerClass&&null==n.dataSource.children_struct[e.id]&&t.classed(n.consts.containerClass,!0),t.transition("nodePositionTransition").duration(750).attrTween("transform",function(t){if(null!=t.xStart&&null!=t.yStart){var e=t.xStart,n=t.yStart;return t.xStart=t.x,t.yStart=t.y,d3.interpolateString("translate("+e+","+n+")","translate("+t.x+","+t.y+")")}return d3.interpolateString("translate("+t.x+","+t.y+")","translate("+t.x+","+t.y+")")})}}]),e}(t.Node);return{Node:e}}]),angular.module("contiv.nodes").config(["$stateProvider",function(t){t.state("contiv.menu.nodes.commission",{url:"/commission/:key",controller:"NodeCommissionCtrl as nodeCommissionCtrl",templateUrl:"nodes/nodecommission.html"})}]).controller("NodeCommissionCtrl",["$state","$stateParams","NodesModel","CRUDHelperService","NodesService",function(t,e,n,o,i){function r(){t.go("contiv.menu.nodes.details.info",{key:e.key})}function a(){r()}function s(){l.form.$valid&&(o.hideServerError(l),o.startLoader(l),l.nodeOpsObj.nodes=[e.key],i.cleanupExtraVars(l),i.createExtraVars(l),n.commission(l.nodeOpsObj).then(function(t){o.stopLoader(l),r()},function(t){o.stopLoader(l),o.showServerError(l,t)}))}var l=this;l.nodeOpsObj={},l.extra_vars={},l.ansibleVariables=[],l.envVariables=[],i.getSettings(l),l.cancelCommissioningNode=a,l.commission=s,o.stopLoader(l),o.hideServerError(l)}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),_get=function e(t,n,o){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,n,o)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(o)};angular.module("contiv.graph").factory("NodeSelectionPolicy",["Policy",function(t){var e=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"NodeSelectionPolicy"))}return _inherits(e,t),_createClass(e,[{key:"initialize",value:function(t){if(!this.initialized){_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"initialize",this).call(this,t);var n=t.state.NodeSelectionPolicy={};n.selectedNodes=[];var o=t.consts.NodeSelectionPolicy={};o.selectedClass="selected";var i=t.drag;i.on("drag",function(e){var n=t;if(null!=n.consts.NodeSelectionPolicy){var o=n.consts.NodeSelectionPolicy.selectedClass,i=d3.selectAll("."+o);-1==i[0].indexOf(this)&&(i.classed(o,!1),i=d3.select(this),i.classed(o,!0)),i.attr("transform",function(t,e){return t.x+=d3.event.dx,t.y+=d3.event.dy,"translate("+[t.x,t.y]+")"}),n.updateGraph()}})}}},{key:"addSelectNode",value:function(t,e){var n=this.graph,o=n.state.NodeSelectionPolicy,i=n.consts.NodeSelectionPolicy;t.classed(i.selectedClass,!0),o.selectedNodes.push(e)}},{key:"removeSelectFromNode",value:function(t,e){var n=this.graph,o=n.state.NodeSelectionPolicy,i=n.consts.NodeSelectionPolicy;n.circles.filter(function(t){return t.id===e.id}).classed(i.selectedClass,!1);var r=o.selectedNodes.indexOf(e);o.selectedNodes.splice(r,1)}},{key:"removeAllSelectedNodes",value:function(){var t=this.graph,e=t.state.NodeSelectionPolicy,n=t.consts.NodeSelectionPolicy;t.circles.classed(n.selectedClass,!1),e.selectedNodes=[]}},{key:"mousedown",value:function(t,e){var n=this.graph,o=n.state.NodeSelectionPolicy;d3.event.stopPropagation(),d3.event.ctrlKey?o.selectedNodes.indexOf(e)>-1?this.removeSelectFromNode(t,e):this.addSelectNode(t,e):-1==o.selectedNodes.indexOf(e)&&this.removeAllSelectedNodes()}},{key:"mouseup",value:function(t,e){var n=this.graph,o=n.state.NodeSelectionPolicy;d3.event.ctrlKey||o.selectedNodes.length<=1&&this.removeSelectFromNode(t,e)}}]),e}(t.Policy);return{Policy:e}}]),angular.module("contiv.nodes").config(["$stateProvider",function(t){t.state("contiv.menu.nodes.details",{url:"/details/:key",controller:"NodeDetailsCtrl as nodeDetailsCtrl",templateUrl:"nodes/nodedetails.html"}).state("contiv.menu.nodes.details.info",{url:"/info",controller:"NodeDetailsCtrl as nodeDetailsCtrl",templateUrl:"nodes/nodeinfo.html"}).state("contiv.menu.nodes.details.stats",{url:"/stats",controller:"NodeDetailsCtrl as nodeDetailsCtrl",templateUrl:"nodes/nodestats.html"}).state("contiv.menu.nodes.details.logs",{url:"/logs",controller:"NodeDetailsCtrl as nodeDetailsCtrl",templateUrl:"nodes/nodelogs.html"}).state("contiv.menu.nodes.details.edit",{url:"/edit",controller:"NodeDetailsCtrl as nodeDetailsCtrl",templateUrl:"nodes/nodeinfo.html"})}]).controller("NodeDetailsCtrl",["$state","$stateParams","$scope","$interval","NodesModel","BgpService",function(t,e,n,o,i,r){function a(){var t={nodes:[e.key]};i.decommission(t).then(function(t){h.showCommissionButton=!1,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1})}function s(){var t={nodes:[e.key]};i.upgrade(t).then(function(t){h.showCommissionButton=!1,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1})}function l(){switch(h.node.inventory_state.status){case"Unallocated":h.showCommissionButton=!0,h.commissionButtonEnabled=!0,h.upgradeButtonEnabled=!1;break;case"Decommissioned":h.showCommissionButton=!0,h.commissionButtonEnabled=!0,h.upgradeButtonEnabled=!1;break;case"Provisioning":h.showCommissionButton=!0,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1;break;case"Allocated":h.showCommissionButton=!1,h.commissionButtonEnabled=!0,h.upgradeButtonEnabled=!0;break;case"Cancelled":h.showCommissionButton=!1,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1;break;case"Maintenance":h.showCommissionButton=!0,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1;break;default:h.showCommissionButton=!0,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1}}function c(t){i.getModelByKey(e.key,t).then(function(t){h.node=t,l()})}function u(){t.is("contiv.menu.nodes.details.edit")?h.mode="edit":h.mode="details"}function d(){t.go("contiv.menu.nodes.details.info")}function p(){h.form.$valid&&(h.neighbor.key=e.key,h.neighbors.forEach(function(t){h.neighbor.neighbor=t.name,h.neighbor["neighbor-as"]=t.value}),r.updateBgp(h).then(function(t){h.neighbor=t.config.data,d()},function(t){}))}function f(){r.getBgp(h).then(function(t){h.neighbor=t},function(t){})}function v(){r.getBgpInspect(e.key).then(function(t){h.inspect=t,h.routes=t.Oper.routes,h.filteredroutes=t.Oper.routes},function(t){})}var h=this;h.numberpattern=ContivGlobals.NUMBER_REGEX,h.decommission=a,h.upgrade=s,h.setMode=u,h.updateBgpInfo=p,h.returnToInfo=d,h.neighbors=[],h.neighbor={},h.key=e.key,f(),v(),u(),c(!1);var y;angular.isDefined(y)||(y=o(function(){c(!0)},5e3)),n.$on("$destroy",function(){o.cancel(y)})}]),angular.module("contiv.nodes").directive("ctvNodestatus",function(){return{restrict:"E",scope:{node:"="},templateUrl:"nodes/nodestatus.html"}}).directive("ctvNodestate",function(){return{restrict:"E",scope:{node:"="},templateUrl:"nodes/nodestate.html"}}),angular.module("contiv.nodes").config(["$stateProvider",function(t){t.state("contiv.menu.nodes.discover",{url:"/discover",controller:"NodeDiscoverCtrl as nodeDiscoverCtrl",templateUrl:"nodes/nodediscover.html"})}]).controller("NodeDiscoverCtrl",["$state","$stateParams","NodesModel","CRUDHelperService","NodesService",function(t,e,n,o,i){function r(){t.go("contiv.menu.nodes.list")}function a(){r()}function s(){c.form.$valid&&(o.hideServerError(c),o.startLoader(c),l(),i.createExtraVars(c),n.discover(c.nodeOpsObj).then(function(t){o.stopLoader(c),r()},function(t){o.stopLoader(c),o.showServerError(c,t)}))}function l(){c.nodeOpsObj.addrs=_.words(c.nodeIPAddr,/[^, ]+/g)}var c=this;c.nodeOpsObj={},c.extra_vars={},c.ansibleVariables=[],c.envVariables=[],c.nodeIPAddr="",i.getSettings(c),c.discover=s,c.cancelDiscoveringNode=a,o.stopLoader(c),o.hideServerError(c)}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();angular.module("contiv.graph").factory("PathChangeViewPolicy",["Policy",function(t){var e=function(t){function e(t){_classCallCheck(this,e);var n=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"PathChangeViewPolicy"));return n.$state=t,n}return _inherits(e,t),_createClass(e,[{key:"generateList",value:function(t){var e=this,n=[],o=function i(t,n){for(var o=e.graph.dataSource.children_struct[t],r=0;r<o.length;r++){var a=o[r];if(e.graph.dataSource.hasChild(a)===!0){var s=i(a,n);n.concat(s)}else n.push(a)}};return o(t,n),n}},{key:"viewEdge",value:function(t){var e=[],n=[],o=t.source.id,i=t.target.id;e=this.graph.dataSource.hasChild(o)===!0?this.generateList(o):[o],n=this.graph.dataSource.hasChild(i)===!0?this.generateList(i):[i],this.$state.go("contiv.menu.visualization.edge",{sourceName:o,targetName:i,sourceList:e,targetList:n})}},{key:"mousedown",value:function(t,e){this.viewEdge(e)}}]),e}(t.Policy);return{Policy:e}}]),angular.module("contiv.nodes").config(["$stateProvider",function(t){t.state("contiv.menu.nodes.lastlog",{url:"/lastlog",controller:"NodeLastJobLogsCtrl as nodeLastJobLogsCtrl",template:'<ctv-logs title="Last Job" log="nodeLastJobLogsCtrl.lastLogs"></ctv-logs>'})}]).controller("NodeLastJobLogsCtrl",["$scope","$interval","LogService",function(t,e,n){function o(){n.getLastLogs().then(function(t){i.lastLogs=t},function(t){})}var i=this;o();var r;angular.isDefined(r)||(r=e(function(){o()},ContivGlobals.REFRESH_INTERVAL)),t.$on("$destroy",function(){e.cancel(r)})}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();angular.module("contiv.graph").factory("Policy",[function(){var t=function(){function t(e){_classCallCheck(this,t),this.policyName=e,this.graph=null,this.initialized=!1}return _createClass(t,[{key:"initialize",value:function(t){this.initialized||(this.initialized=!0,this.graph=t)}},{key:"mouseover",value:function(t,e){}},{key:"dblclick",value:function(t,e){}},{key:"contextmenu",value:function(t,e){}},{key:"mouseout",value:function(t,e){}},{key:"mousedown",value:function(t,e){}},{key:"mouseup",value:function(t,e){}},{key:"destroy",value:function(){}}]),t}();return{Policy:t}}]),angular.module("contiv.nodes").config(["$stateProvider",function(t){t.state("contiv.menu.nodes.list",{url:"/list",controller:"NodeListCtrl as nodeListCtrl",templateUrl:"nodes/nodelist.html"})}]).controller("NodeListCtrl",["$scope","$interval","$filter","NodesModel","CRUDHelperService",function(t,e,n,o,i){function r(t){o.get(t).then(function(t){i.stopLoader(a),a.nodes=t},function(t){i.stopLoader(a)})}var a=this;r(!1);var s;angular.isDefined(s)||(s=e(function(){r(!0)},ContivGlobals.REFRESH_INTERVAL)),t.$on("$destroy",function(){e.cancel(s)})}]),angular.module("contiv.graph").factory("PolicyService",["Policy","QTipPolicy","PathChangeViewPolicy","NodeSelectionPolicy","SplitJoinNodePolicy","SplitJoinViewPolicy","SaveStatePolicy",function(t,e,n,o,i,r,a){return{Policy:t.Policy,QTipPolicy:e.Policy,PathChangeViewPolicy:n.Policy,NodeSelectionPolicy:o.Policy,SplitJoinNodePolicy:i.Policy,SplitJoinViewPolicy:r.Policy,SaveStatePolicy:a.Policy}}]),angular.module("contiv.organizations").config(["$stateProvider",function(t){t.state("contiv.menu.organizations.create",{url:"/create",templateUrl:"organizations/organizationcreate.html",controller:"OrganizationCreateCtrl as organizationCreateCtrl"})}]).controller("OrganizationCreateCtrl",["$state","OrganizationsModel","CRUDHelperService",function(t,e,n){function o(){t.go("contiv.menu.organizations.list")}function i(){o()}function r(){s.form.$valid&&(n.hideServerError(s),n.startLoader(s),s.newOrganization.key=s.newOrganization.tenantName,e.create(s.newOrganization).then(function(t){n.stopLoader(s),o()},function(t){n.stopLoader(s),n.showServerError(s,t)}))}function a(){n.stopLoader(s),n.hideServerError(s),s.newOrganization={tenantName:""}}var s=this;s.createOrganization=r,s.cancelCreating=i,a()}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),_get=function n(t,e,o){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,e);if(void 0===i){var r=Object.getPrototypeOf(t);return null===r?void 0:n(r,e,o)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(o)};angular.module("contiv.graph").factory("QTipPolicy",["Policy",function(t){var e=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"QTipPolicy"))}return _inherits(e,t),_createClass(e,[{key:"initialize",value:function(t){if(!this.initialized){_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"initialize",this).call(this,t);var n=this,o=t.state.QTipPolicy={};o.mousedown=!1,t.consts.QTipPolicy={},$("#visualization-graph").mouseup(function(t){o.mouseup=!1});var i=t.updateNewNodes;t.updateNewNodes=function(e){i.call(t,e),n.updateNewNodes(e)};var r=t.updateNewPaths;t.updateNewPaths=function(e){r.call(t,e),n.updateNewPaths(e)}}}},{key:"destroy",value:function(){$('[id^="qtip"]').remove()}},{key:"mousedown",value:function(t,e){var n=this.graph,o=n.state.QTipPolicy;o.mousedown=!0}},{key:"mouseup",value:function(t,e){var n=this.graph,o=n.state.QTipPolicy;o.mousedown=!1}},{key:"whenQTipAvailable",value:function(t){var e=this,n=500;window.setTimeout(function(){null!=$(document).qtip?t():window.setTimeout(e.whenQTipAvailable(t),n)},n)}},{key:"updateNewNodes",value:function(t){function e(){t.each(function(t){var e,i=this;if(null!=n.dataSource.children_struct[t.id]){e="<b><u>Selectors:</b></u> ";var r=n.dataSource.selectors[t.id],a=!1;for(var s in r)a=!0,e+=s+" : <i>"+r[s]+"</i>,\n ";a===!1&&(e="No Selectors, ")}else{e="<b><u>Labels:</b></u> ";var l=n.dataSource.labels[t.id],a=!1;for(var s in l)a=!0,e+=s+" : <i>"+l[s]+"</i>,\n ";a===!1&&(e="No labels, ")}e=e.slice(0,-2),$(i).qtip({content:{title:t.id,text:e},events:{show:function(){var e=$(i).qtip("api"),r=$("#graphContainer").offset(),a=[r.left+(t.x*n.dragSvg.scale()+n.dragSvg.translate()[0]),r.top+(t.y+t.radius)*n.dragSvg.scale()+n.dragSvg.translate()[1]];return e.set("position.target",a),!o.mousedown}},show:{delay:0,solo:$("#visualization-graph")},style:{classes:"qtip-blue qtip-shadow"},position:{my:"top center",at:"bottom center"},hide:{event:"mousedown mouseleave"}})})}var n=this.graph,o=n.state.QTipPolicy;void 0!=$(document).qtip?e():this.whenQTipAvailable(e)}},{key:"updateNewPaths",value:function(t){var e=this.graph,n=e.state.QTipPolicy;void 0!=$(document).qtip&&t.each(function(t){var e=this,o=d3.select(this).node(),i=(o.getPointAtLength(o.getTotalLength()/2),t.qtipHelper()),r="Bytes: "+t.getWeight();$(e).qtip({content:{text:r},events:{show:function(){return!n.mousedown}},show:{delay:0,solo:$("#graphContainer")},style:{classes:"qtip-blue qtip-shadow"},position:{my:i.my,at:"center center",target:"mouse",adjust:i.adjust},hide:{event:"mousedown mouseleave"}})})}}]),e}(t.Policy);return{Policy:e}}]),angular.module("contiv.organizations").config(["$stateProvider",function(t){t.state("contiv.menu.organizations.details",{url:"/details/:key",controller:"OrganizationDetailsCtrl as organizationDetailsCtrl",templateUrl:"organizations/organizationdetails.html"})}]).controller("OrganizationDetailsCtrl",["$state","$stateParams","OrganizationsModel","CRUDHelperService",function(t,e,n,o){function i(){t.go("contiv.menu.organizations.list")}function r(){o.hideServerError(a),o.startLoader(a),n["delete"](a.organization).then(function(t){o.stopLoader(a),i()},function(t){o.stopLoader(a),o.showServerError(a,t)})}var a=this;o.stopLoader(a),o.hideServerError(a),n.getModelByKey(e.key).then(function(t){a.organization=t}),a.deleteOrganization=r}]),angular.module("contiv.storagepolicies").config(["$stateProvider",function(t){t.state("contiv.menu.storagepolicies.create",{url:"/create",templateUrl:"storage_policies/storagepolicycreate.html",controller:"StoragePolicyCreateCtrl as storagePolicyCreateCtrl"})}]).controller("StoragePolicyCreateCtrl",["$state","$stateParams","StoragePoliciesModel","CRUDHelperService",function(t,e,n,o){function i(){t.go("contiv.menu.storagepolicies.list")}function r(){i()}function a(){c.filesystemcmds.forEach(function(t){c.newStoragePolicy.filesystems[t.name]=t.value})}function s(){c.form.$valid&&(o.hideServerError(c),o.startLoader(c),a(),n.create(c.newStoragePolicy).then(function(t){o.stopLoader(c),i()},function(t){o.stopLoader(c),o.showServerError(c,t)}))}function l(){o.stopLoader(c),o.hideServerError(c),c.newStoragePolicy={name:"",backends:{crud:"ceph",mount:"ceph",snapshot:"ceph"},unlocked:!1,driver:{pool:"rbd"},create:{size:"0",filesystem:""},runtime:{snapshots:!0,snapshot:{frequency:"30m",keep:20},"rate-limit":{"write-iops":0,"read-iops":0,"write-bps":0,"read-bps":0}},filesystems:{}}}var c=this;c.createPolicy=s,c.cancelCreating=r,c.filesystemcmds=[],l()}]),angular.module("contiv.storagepolicies").config(["$stateProvider",function(t){t.state("contiv.menu.storagepolicies.details",{url:"/details/:key",controller:"StoragePolicyDetailsCtrl as storagePolicyDetailsCtrl",templateUrl:"storage_policies/storagepolicydetails.html"}).state("contiv.menu.storagepolicies.edit",{url:"/details/:key",controller:"StoragePolicyDetailsCtrl as storagePolicyDetailsCtrl",templateUrl:"storage_policies/storagepolicydetails.html"})}]).controller("StoragePolicyDetailsCtrl",["$state","$stateParams","$scope","$interval","$filter","StoragePoliciesModel","VolumesModel","CRUDHelperService",function(t,e,n,o,i,r,a,s){function l(){t.is("contiv.menu.storagepolicies.edit")?g.mode="edit":g.mode="details"}function c(){t.go("contiv.menu.storagepolicies.list")}function u(){t.go("contiv.menu.storagepolicies.details",{key:g.policy.name})}function d(){u()}function p(){s.hideServerError(g),s.startLoader(g),r.deleteUsingKey(g.policy.name,"name").then(function(t){s.stopLoader(g),c()},function(t){s.stopLoader(g),s.showServerError(g,t)})}function f(t){a.get(t).then(function(t){g.volumes=i("orderBy")(_.filter(t,{policy:g.policy.name}),"name")})}function v(){angular.forEach(g.policy.filesystems,function(t,e){this.push({name:e,value:t})},g.filesystemcmds)}function h(){g.filesystemcmds.forEach(function(t){g.policy.filesystems[t.name]=t.value})}function y(){g.form.$valid&&(s.hideServerError(g),s.startLoader(g),h(),r.save(g.policy).then(function(t){s.stopLoader(g),u()},function(t){s.stopLoader(g),s.showServerError(g,t)}))}var g=this;g.filesystemcmds=[],s.stopLoader(g),s.hideServerError(g),r.getModelByKey(e.key,!1,"name").then(function(t){g.policy=t,v(),f(!1)}),g.deletePolicy=p,g.savePolicy=y,g.cancelEditing=d,l();var m;angular.isDefined(m)||(m=o(function(){f(!0)},ContivGlobals.REFRESH_INTERVAL)),n.$on("$destroy",function(){o.cancel(m)})}]),angular.module("contiv.storagepolicies").directive("ctvStoragepolicybasicsettings",function(){return{}}).directive("ctvStoragepolicyfilesystemsettings",function(){return{restrict:"E",scope:{policy:"=",filesystemcmds:"="},link:function(t){t.filesystems=["ext4","btrfs"]},templateUrl:"storage_policies/filesystemsettings.html"}}).directive("ctvStoragepolicysnapshotsettings",function(){return{restrict:"E",scope:{policy:"="},templateUrl:"storage_policies/snapshotsettings.html"}}).directive("ctvStoragepolicyrwopssettings",function(){return{restrict:"E",scope:{policy:"="},templateUrl:"storage_policies/rwopssettings.html"}}).directive("ctvStoragepolicybackenddrivers",function(){return{restrict:"E",scope:{policy:"="},templateUrl:"storage_policies/backenddrivers.html"}});var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();angular.module("contiv.graph").factory("SaveStatePolicy",["Policy",function(t){var e=function(t){function e(t){_classCallCheck(this,e);var n=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"SaveStatePolicy"));return n.savedState=t,n}return _inherits(e,t),_createClass(e,[{key:"initialize",value:function(t){this.graph=t;var e=this;t.destroy=function(){e.graphDestroy.call(t,e.savedState)},t.load=function(n){e.graphLoad.call(t,n)}}},{key:"graphDestroy",value:function(t){var e=this;_(e.defaultNodePolicies).forEach(function(e){e.destroy(t)}),_(e.defaultPathPolicies).forEach(function(e){e.destroy(t)});for(var n in e.bindings)$(window).off(n,e.bindings[n])}},{key:"graphLoad",value:function(t){var e=this;_(e.defaultNodePolicies).forEach(function(e){null!=e.load&&e.load(t)}),_(e.defaultPathPolicies).forEach(function(e){null!=e.load&&e.load(t)})}}]),e}(t.Policy);return{Policy:e}}]),angular.module("contiv.visualization").config(["$stateProvider",function(t){t.state("contiv.menu.visualization.edge",{url:"/edge/{sourceName, targetName, sourceList, targetList}",params:{sourceName:null,targetName:null,sourceList:null,targetList:null},controller:"VisualizationEdgeCtrl as visualizationedgeCtrl",templateUrl:"visualization/visualizationedge.html"})}]).controller("VisualizationEdgeCtrl",["$scope","$http","$state","$stateParams","VisualizationService","$interval",function(t,e,n,o,i,r){var a=o.sourceName,s=o.targetName,l=o.sourceList,c=o.targetList;if(null==l||null==c)return void n.go("contiv.menu.visualization.list");var u=new Date,d=u.getSeconds();t.edgeDataInterval=r(function(){i.getEdgeData(l,c,d.toString()).then(function(e){var n=e.results,o=0;_.forEach(n,function(t){_.isEmpty(t)===!1&&(o+=t.series[0].values[0][1])}),t.sourceName=a,t.targetName=s,t.edgeData=o,t.edgeDataTime=d},function(t){})},3e3),t.$on("$destroy",function(){r.cancel(t.edgeDataInterval)}),i.getOldEdgeData(l,c).then(function(e){var n=e.results,o=[];_.forEach(n,function(t){if(_.isEmpty(t)===!1){var e=t.series[0].values;_.isEmpty(o)?_.forEach(e,function(t){o.push(t[1])}):_.forEach(e,function(t,e){o[e]+=t[1]})}}),t.sourceName=a,t.targetName=s,t.sourceList=l,t.targetList=c,t.oldEdgeData=o},function(t){})}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),_get=function o(t,e,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,e);if(void 0===i){var r=Object.getPrototypeOf(t);return null===r?void 0:o(r,e,n)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(n)};angular.module("contiv.graph").factory("SplitJoinNodePolicy",["NodeSelectionPolicy","VisualizerNode",function(t,e){var n=function(t){function n(){_classCallCheck(this,n);var t=_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.policyName="SplitJoinNodePolicy",t}return _inherits(n,t),_createClass(n,[{key:"initialize",value:function(t){if(!this.initialized){_get(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"initialize",this).call(this,t);var e=t.state.SplitJoinNodePolicy={};e.splitNodes=[]}}},{key:"dblclick",value:function(t,e){var n=this.graph,o=n.state.SplitJoinNodePolicy;d3.event.ctrlKey||(o.selectedNodes.indexOf(e)>-1?this.splitMultipleNodes(o.selectedNodes):(this.removeAllSelectedNodes(),this.splitNode(e)))}},{key:"contextmenu",value:function(t,e){var n=this.graph,o=n.state.NodeSelectionPolicy;if(d3.event.preventDefault(),!d3.event.ctrlKey){var i=o.selectedNodes;if(i.indexOf(e)>-1)for(var r=0;r<i.length;r++)this.joinNode(i[r]);else this.removeAllSelectedNodes(),this.joinNode(e)}}},{key:"__splitNode",value:function(t){var n=this.graph,o=n.state.SplitJoinNodePolicy,i=t.id,r=n.dataSource.children_struct;if(void 0!==r[i]&&!_.isEmpty(r[i])){n.nodes=_.filter(n.nodes,function(e){return e!=t}),n.spliceLinksForNode(t);for(var a=[],s=0;s<n.nodes.length;s++)a.push(n.nodes[s].id);for(var l=[],s=0;s<r[i].length;s++)a.push(r[i][s]),l.push(r[i][s]);
var c=n.dataSource.getFlowBetweenSet(a),u=t.x,d=t.y,p=t.ancestors.slice();p.splice(0,0,t.id);for(var f=t.id,v=[],h=t.radius*n.consts.radiusDecay,y=c.nodeData,s=0;s<y.length;s++)if(l.indexOf(y[s].id)>-1){var g=y[s].id,m=y[s].text,P=new e.Node(null,null,g,m,h,f,p,u,d);P.initialize(n),n.nodes.push(P),v.push(P)}return n.links=n.dataSource.processLinkData(c.linkData,n.nodes),n.initNodes(),n.initLinks(),o.splitNodes.push(t.id),v}}},{key:"splitNode",value:function(t){var e=this.__splitNode(t);null!=e&&this.splitNodeEvent(e)}},{key:"splitMultipleNodes",value:function(t){for(var e=(this.graph,[]),n=0;n<t.length;n++){var o=this.__splitNode(t[n]);e=e.concat(o)}this.splitMultipleNodesEvent(o)}},{key:"splitNodeEvent",value:function(t){var e=this.graph;e.setPositions(),e.updateGraph()}},{key:"splitMultipleNodesEvent",value:function(t){var e=this.graph;e.setPositions(),e.updateGraph()}},{key:"__joinNode",value:function(t){var n=this.graph,o=n.state.SplitJoinNodePolicy;if(-1!=n.nodes.indexOf(t)){var i=n.dataSource.children_struct,r=t.id;if(!(i.topLevel.indexOf(r)>-1)){for(var a=[],s=[],l=0;l<n.nodes.length;l++)-1==n.nodes[l].ancestors.indexOf(t.parent)?s.push(n.nodes[l].id):a.push(n.nodes[l]);var c=t.parent;s.push(t.parent);var u=t.radius/n.consts.radiusDecay,d=t.x,p=t.y,f=t.ancestors[1],v=t.ancestors.slice(1),h=new e.Node(d,p,c,c,u,f,v);n.nodes.push(h);for(var y=n.dataSource.getFlowBetweenSet(s),l=0;l<a.length;l++){var g=a[l];n.nodes.splice(n.nodes.indexOf(g),1),n.spliceLinksForNode(g)}return n.links=n.dataSource.processLinkData(y.linkData,n.nodes),n.initNodes(),n.initLinks(),o.splitNodes.splice(o.splitNodes.indexOf(h.id),1),h}}}},{key:"joinNode",value:function(t){var e=this.__joinNode(t);null!=e&&this.joinNodeEvent(e)}},{key:"joinMultipleNode",value:function(t){for(var e=[],n=0;n<t.length;n++){var o=this.__joinNode(t[n]);e.push(o)}this.joinMultipleNodesEvent(e)}},{key:"joinNodeEvent",value:function(t){var e=this.graph;e.updateGraph()}},{key:"joinMultipleNodesEvent",value:function(t){var e=this.graph;e.updateGraph()}}]),n}(t.Policy);return{Policy:n}}]),angular.module("contiv.visualization").directive("visualizationEdge",["$window",function(t){function e(t,e){function n(){l=new Date;for(var e in c){var o=c[e];o.data.push(t.edgeData||0),o.path.attr("d",p)}u.domain([l-(a-2)*s,l-s]),y.transition().duration(s).ease("linear").call(u.axis),v.transition().duration(s).ease("linear").call(d.axis),g.attr("transform",null).transition().duration(s).ease("linear").attr("transform","translate("+u(l-(a-1)*s)+")").each("end",function(){n()});for(var e in c){var o=c[e];o.data.shift()}}var o=document.getElementsByTagName("body")[0],i=o.clientWidth-400,r=o.clientHeight-400,a=59,s=750,l=new Date(Date.now()-s),c={current:{value:0,color:"orange",data:e.range(a).map(function(e){return t.oldEdgeData[Math.floor(e/10)]||0})}},u=e.time.scale().domain([l-(a-2),l-s]).range([0,i]),d=e.scale.linear().domain([0,e.max(c.current.data,function(t){return t+10})]).range([r,0]),p=e.svg.line().interpolate("basis").x(function(t,e){return u(l-(a-1-e)*s)}).y(function(t){return d(t)}),f=e.select(".graph").append("svg").attr("width",25).style("overflow","visible").style("position","fixed"),v=f.append("g").attr("class","y axis").call(d.axis=e.svg.axis().scale(d).orient("left")),h=e.select(".graph").append("svg").attr("class","chart").attr("width",i-50).attr("height",r+50),y=h.append("g").attr("class","x axis").attr("transform","translate(0,"+r+")").call(u.axis=e.svg.axis().scale(u).orient("bottom")),g=h.append("g");for(var m in c){var P=c[m];P.path=g.append("path").data([P.data]).attr("class",m+" group").style("stroke",P.color)}n()}return{restrict:"EA",replace:!1,templateUrl:"visualization/visualizationedgetemplate.html",link:function(n){n.$watchGroup(["edgeData","oldEdgeData"],function(){if(null!=n.edgeData&&null!=n.oldEdgeData&&!n.initialize){n.initialize=!0;var o=t.d3;e(n,o)}})}}}]),angular.module("contiv.visualization").service("StateSave",function(){this.savedStates={}}).directive("visualizationGraph",["$window","$state","VisualizerGraph","PolicyService","VisualizerDataSource","StateSave",function(t,e,n,o,i,r){function a(t,n,o,i,r,a){if(void 0!==t.nodes&&void 0!==t.links&&void 0!==t.children_struct&&void 0!==t.ancestors_struct){var s=new r.DataSource(t.nodes,t.links,t.children_struct,t.ancestors_struct,t.labels,t.serviceSelectors);s.setAncestors();var l,c,u=s.getTopLevelFlow();l=s.processNodeData(u.nodeData),c=s.processLinkData(u.linkData,l);var d=document.getElementsByTagName("body")[0],p=(d.clientWidth,d.clientHeight),f=n.find("svg"),v=$(f.parent()).offset(),h=$(f.parent()).width(),y=d3.select(f[0]).attr("width",h).attr("height",p-v.top-20);t.visualizationGraph=new o.Graph(y,l,c,s,t.children_struct,t.ancestors_struct),t.visualizationGraph.installDefaultPathPolicy(new i.SaveStatePolicy(a.savedStates)),t.visualizationGraph.installDefaultPathPolicy(new i.PathChangeViewPolicy(e));var g=new i.QTipPolicy;t.visualizationGraph.installDefaultNodePolicy(g),t.visualizationGraph.installDefaultPathPolicy(g);var m=new i.SplitJoinViewPolicy;if(t.visualizationGraph.installDefaultNodePolicy(m),m.installBackButton($("#backButton")),m.installTitle($("#graph-title")),0==_.isEmpty(a.savedStates)){var P=t.visualizationGraph;P.load(a.savedStates)}else t.visualizationGraph.updateGraph()}}return{restrict:"EA",replace:!1,templateUrl:"visualization/visualizationtemplate.html",link:function(t,e){t.$on("$destroy",function(){$("#visualization-graph").unbind(),t.visualizationGraph.destroy()}),t.$watchGroup(["nodes","links","children_struct","ancestors_struct"],function(){null!=t.nodes&&null!=t.links&&null!=t.children_struct&&null!=t.ancestors_struct&&(t.initialized?(t.visualizationGraph.dataSource.links=t.links,t.visualizationGraph.updateLinkData()):(t.initialized=!0,a(t,e,n,o,i,r)))})}}}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),_get=function i(t,e,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(void 0===o){var r=Object.getPrototypeOf(t);return null===r?void 0:i(r,e,n)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(n)};angular.module("contiv.graph").factory("SplitJoinViewPolicy",["SplitJoinNodePolicy","VisualizerNode",function(t,e){var n=function(t){function n(){_classCallCheck(this,n);var t=_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.policyName="SplitJoinViewPolicy",t}return _inherits(n,t),_createClass(n,[{key:"initialize",value:function(t){if(!this.initialized){_get(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"initialize",this).call(this,t);var e=t.state.SplitJoinViewPolicy={};e.savedStates=[],e.eventHistory=[],e.focusGroups=[],e.foci=[],e.zooms={},e.layout={},e.layoutDefault=null,e.zoomDefault=null,e.nodeIdsToReshow=null,e.backButtonElem=null,e.titleElem=null;var o=t.consts.SplitJoinViewPolicy={};o.boundary=.8,t.d3ForceBounds=this.d3ForceBounds,t.d3ForceTick=this.d3ForceTick,t.d3ForceStart=this.d3ForceStart,t.d3ForceEnd=this.d3ForceEnd}}},{key:"installBackButton",value:function(t){var e=this.graph,n=this,o=e.state.SplitJoinViewPolicy;o.backButtonElem=t,o.backButton=function(){o.eventHistory.length>0&&n.undoLastEvent.call(n)}}},{key:"installTitle",value:function(t){var e=this.graph,n=e.state.SplitJoinViewPolicy;n.titleElem=t}},{key:"destroy",value:function(t){null!=t&&this.save(t)}},{key:"save",value:function(t){var e=this.graph,n=e.state.SplitJoinViewPolicy,o=e.nodes,i=e.links,r=null;null!=n.titleElem&&(r=n.titleElem.text());var a=n.focusGroups,s=n.eventHistory,l=n.zooms,c=n.layout,u=n.layoutDefault,d=n.zoomDefault,p={nodes:o,links:i,states:n.savedStates,currTitle:r,focusGroups:a,eventHistory:s,zooms:l,layout:c,layoutDefault:u,zoomDefault:d};t.SplitJoinViewPolicy=p}},{key:"load",value:function(t){var e=this,n=this.graph,o=n.state.SplitJoinViewPolicy;t=t.SplitJoinViewPolicy,o.savedStates=t.states,n.links=t.links,n.nodes=t.nodes;var i=t.currTitle;null!=o.titleElem&&o.titleElem.text(i),o.eventHistory=t.eventHistory,o.focusGroups=t.focusGroups,o.zooms=t.zooms,o.layout=t.layout,o.layoutDefault=t.layoutDefault,o.zoomDefault=t.zoomDefault,null!=o.backButtonElem&&o.eventHistory.length>0&&o.backButtonElem.fadeTo("slow",1);var r=n.dataSource.children_struct;_.forEach(n.nodes,function(t){t.SplitJoinViewPolicy={},_.includes(r[o.focusGroups[0]],t.id)?t.SplitJoinViewPolicy.type="focus":t.SplitJoinViewPolicy.type="connected"});var a;if(0===o.focusGroups.length){a=o.layoutDefault;var s=o.zoomDefault;n.zoomed(s[0],s[1])}else{var s=o.zooms[o.focusGroups];null!=s&&n.zoomed(s[0],s[1]),a=o.layout[o.focusGroups]}_.forEach(n.nodes,function(t){var e=a[t.id];null==e&&console.log(a,t),t.x=e.x,t.y=e.y}),n.state.initForce=!0,n.updateGraph.call(n,function(){e.updateGraphCallback.call(e)})}},{key:"dblclick",value:function(t,e){var o=this.graph,i=o.state.SplitJoinViewPolicy,r=e.id,a=o.dataSource.children_struct;if(void 0!==a[r]&&!_.isEmpty(a[r])){if(i.focusGroups.slice(),0===i.focusGroups.length?i.focusGroups.push(e.id):_.includes(a[i.focusGroups[0]],e.id)?i.focusGroups[0]=e.id:1===i.focusGroups.length?i.focusGroups.push(e.id):_.includes(a[i.focusGroups[1]],e.id)&&(i.focusGroups[1]=e.id),2===i.focusGroups.length&&i.focusGroups[1]===e.id){var s=[e],l=[],c=a[i.focusGroups[0]];_.forEach(o.nodes,function(t){_.includes(c,t.id)&&(l.push(t.id),s.push(t))})}else{var s=[e],l=[];_.forEach(o.links,function(t){t.source===e&&-1==l.indexOf(t.target.id)?(t.target.SplitJoinViewPolicy={},t.target.SplitJoinViewPolicy.type="connected",l.push(t.target.id),s.push(t.target)):t.target===e&&-1==l.indexOf(t.source.id)&&(t.source.SplitJoinViewPolicy={},t.source.SplitJoinViewPolicy.type="connected",l.push(t.source.id),s.push(t.source))})}o.circles.each(function(t){t.id!==e.id&&o.spliceLinksForNode(t)}),o.updateGraph(),o.state.disableUpdate=!0,o.circles.each(function(t){t.id!==e.id?d3.select(this).transition().delay(200).duration(400).style("opacity",0):null!=$(this).qtip&&$(this).qtip("disable",!0)});var u=o.dragSvg.translate(),d=o.dragSvg.scale(),p=parseFloat(o.svg.style("width"))/d/2+u[0],f=parseFloat(o.svg.style("height"))/d/2+u[1];e.xStart=e.x,e.yStart=e.y,e.x=p,e.y=f,t.transition("nodePositionTransition").duration(750).attrTween("transform",function(t){var e=t.xStart,n=t.yStart;return t.xStart=t.x,t.yStart=t.y,d3.interpolateString("translate("+e+","+n+")","translate("+t.x+","+t.y+")")});var v=_get(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"splitNode",this);i.nodeIdsToReshow=l;var h=this;setTimeout(function(){o.nodes=s,v.call(h,e)},750)}}},{key:"updateGraphCallback",value:function(){var t=this.graph,e=t.state.SplitJoinViewPolicy;t.circles.each(function(t){d3.select(this).transition().duration(400).style("opacity",1),d3.select(this).classed("focus",!1),d3.select(this).classed("connected",!1),null!=t.SplitJoinViewPolicy&&("focus"===t.SplitJoinViewPolicy.type?d3.select(this).classed("focus",!0):"connected"===t.SplitJoinViewPolicy.type&&d3.select(this).classed("connected",!0))}),e.nodeIdsToReshow=null,t.updateGraph()}},{key:"setPositions",value:function(){function t(t,e){return Math.floor(Math.random()*(e-t+1))+t}var e=this.graph,n=this,o=e.consts,i=o.displayOffset,r=e.nodes,a=n.d3ForceBounds.call(e);_.forEach(r,function(e){if(null==e.x||null==e.y){var n=t(e.radius+i,a.width-e.radius-i),o=t(e.radius+i,a.height-e.radius-i);e.x=n,e.y=o}})}},{key:"d3ForceStart",value:function(){var t=this;t.circles.attr("cx",function(e){return null!=e.xStart&&(e.xStart=e.xStart*t.dragSvg.scale()+t.dragSvg.translate()[0]),e.x}).attr("cy",function(e){return null!=e.yStart&&(e.yStart=e.yStart*t.dragSvg.scale()+t.dragSvg.translate()[1]),e.y}),t.paths.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y})}},{key:"d3ForceEnd",value:function(){var t=this,e=t.state,n=e.SplitJoinViewPolicy;if(null==n.layoutDefault){var o={};_.forEach(t.nodes,function(t){o[t.id]={x:t.x,y:t.y}}),n.layoutDefault=o;var i=t.dragSvg.scale(),r=t.dragSvg.translate();n.zoomDefault=[r,i]}t.circles.attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}),t.paths.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y})}},{key:"d3ForceTick",value:function(t,e,n){function o(t){return function(o){2===u.length?("focus"===o.SplitJoinViewPolicy.type?o.y+=(u[0]-o.y)*t:o.y+=(u[1]-o.y)*t,o.x+=(e/2-o.x)*t):(o.y+=(n/2-o.y)*t,o.x+=(e/2-o.x)*t)}}var i=this,r=i.state,a=i.consts,s=r.SplitJoinViewPolicy,l=a.displayOffset,c=i.dragSvg.scale(),u=s.foci;i.circles.each(this.d3ForceCollide(.5)).each(o(.2*t.alpha)).attr("cx",function(t){return t.x=Math.max((t.radius+l)/c,Math.min(e+(-l-t.radius)/c,t.x))}).attr("cy",function(t){return null==t.SplitJoinViewPolicy||null==t.SplitJoinViewPolicy?(t.y=Math.max((t.radius+l)/c,Math.min(n+(-l-t.radius)/c,t.y)),t.y):"focus"===t.SplitJoinViewPolicy.type?(t.y=Math.max(t.radius+l,Math.min((n+(-l-t.radius)/c)*a.SplitJoinViewPolicy.boundary,t.y)),t.y):"connected"===t.SplitJoinViewPolicy.type?(t.y=Math.max((n+(l-t.radius)/c)*a.SplitJoinViewPolicy.boundary,Math.min(n+(-l-t.radius)/c,t.y)),t.y):void 0}),i.paths.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y})}},{key:"d3ForceBounds",value:function(){function t(t,n){var o=t*n,i=e.consts.startRadius,r=3.5*i,a=o/(r*r);return a}var e=this,n=e.state,o=e.consts,i=o.SplitJoinViewPolicy,r=n.SplitJoinViewPolicy,a=e.nodes,s=o.displayOffset,l=parseFloat(e.svg.style("width")),c=parseFloat(e.svg.style("height")),u=l,d=c,p=t(u-2*s,d-2*s),f=1;a.length>p?(f=p/a.length,e.zoomed(e.dragSvg.translate(),f),u/=f,d/=f):e.zoomed(e.dragSvg.translate(),f);var v,h=r.focusGroups;if(0===h.length)v=[d/2];else{var y=e.dataSource.children_struct[h[0]];i.boundary=y.length/a.length;var g=d*i.boundary,m=d-g;g<2*e.consts.maxRadius&&(i.boundary=2.5*e.consts.maxRadius/d,g=d*i.boundary,m=d-g),m<2*e.consts.maxRadius&&(i.boundary=1-2.5*e.consts.maxRadius/d,g=d*i.boundary,m=d-g),v=[g/2,g+m/2]}return r.foci=v,{width:u,height:d}}},{key:"splitNodeEvent",value:function(t){var e=this,n=this.graph,o=n.state.SplitJoinViewPolicy,i=n.dataSource.children_struct;_.forEach(t,function(t){t.SplitJoinViewPolicy={},_.includes(i[o.focusGroups[0]],t.id)?t.SplitJoinViewPolicy.type="focus":t.SplitJoinViewPolicy.type="connected"});var r=t[0].parent;if(0!==o.eventHistory.length&&o.eventHistory[o.eventHistory.length-1].id===r?o.eventHistory.pop():o.eventHistory.push({id:r,event:"split"}),null!=o.backButtonElem&&0!==o.eventHistory.length&&o.backButtonElem.fadeTo("slow",1),null!=o.titleElem){var a="";o.focusGroups.length>0&&(a+=o.focusGroups[0]),2===o.focusGroups.length&&(a+=" & "+o.focusGroups[1]),o.titleElem.text(a)}n.state.disableUpdate=!1,e.setLayout()}},{key:"setLayout",value:function(){var t,e=this,n=this.graph,o=n.state.SplitJoinViewPolicy;if(0===o.focusGroups.length){t=o.layoutDefault;var i=o.zoomDefault;n.zoomed(i[0],i[1])}else{var i=o.zooms[o.focusGroups];null!=i&&n.zoomed(i[0],i[1]),t=o.layout[o.focusGroups]}if(null!=t)_.forEach(n.nodes,function(e){var n=t[e.id];null==n&&console.log(t,e),e.x=n.x,e.y=n.y}),n.updateGraph.call(n,function(){e.updateGraphCallback.call(e)});else{n.state.initForce=!1,n.updateGraph(function(){e.updateGraphCallback.call(e)}),o.zooms[o.focusGroups]=[n.dragSvg.translate(),n.dragSvg.scale()];var t={};_.forEach(n.nodes,function(e){t[e.id]={x:e.x,y:e.y}}),o.layout[o.focusGroups]=t}}},{key:"__joinNode",value:function(t){var n=this.graph,o=n.state.SplitJoinNodePolicy,i=n.state.SplitJoinViewPolicy;if(-1!=n.nodes.indexOf(t)){var r=n.dataSource.children_struct,a=t.id;if(!(r.topLevel.indexOf(a)>-1)){for(var s=t.parent,l=[],c=[],u=0;u<n.nodes.length;u++)-1==n.nodes[u].ancestors.indexOf(t.parent)?c.push(n.nodes[u].id):l.push(n.nodes[u]);var d=t.parent;c.push(t.parent);var p=n.dataSource.ancestors_struct,r=n.dataSource.children_struct,f=i.focusGroups.indexOf(s);null!=p[s]?i.focusGroups[f]=p[s]:i.focusGroups.splice(f,1);var v=[];if(1===i.focusGroups.length){var h=p[t.id];h.push(i.focusGroups[0]),h=h.concat(p[i.focusGroups[0]]||[]),_.forEach(r.topLevel,function(t){-1===h.indexOf(t)&&-1==c.indexOf(t)&&v.push(t)}),c=c.concat(v)}else 0===i.focusGroups.length&&(_.forEach(r.topLevel,function(t){-1==c.indexOf(t)&&v.push(t)}),c=c.concat(v));var y=t.radius/n.consts.radiusDecay,g=t.x,m=t.y,s=t.ancestors[1],h=t.ancestors.slice(1),P=new e.Node(g,m,d,d,y,s,h);n.nodes.push(P);for(var u=0;u<l.length;u++){var b=l[u];n.nodes.splice(n.nodes.indexOf(b),1),n.spliceLinksForNode(b)}for(var w=n.dataSource.getFlowBetweenSet(c),k=[],S=w.nodeData,u=0;u<S.length;u++)-1!==v.indexOf(S[u].id)&&k.push(S[u]);var E=n.dataSource.processNodeData(k);_.forEach(E,function(t){t.radius=t.radius||n.consts.startRadius}),n.nodes=n.nodes.concat(E),n.links=n.dataSource.processLinkData(w.linkData,n.nodes),1===i.focusGroups.length?_.forEach(n.links,function(t){-1!==v.indexOf(t.source.id)?i.focusGroups[0]===t.target.parent&&v.splice(v.indexOf(t.source.id),1):-1!==v.indexOf(t.target.id)&&i.focusGroups[0]===t.source.parent&&v.splice(v.indexOf(t.target.id),1)}):v=[];var N=[];if(0!==v.length)for(var u=0;u<n.nodes.length&&(-1===v.indexOf(n.nodes[u].id)||(v.splice(v.indexOf(n.nodes[u].id),1),n.spliceLinksForNode(n.nodes[u]),N.push(n.nodes[u]),0!==v.length));u++);return _.forEach(N,function(t){n.nodes.splice(n.nodes.indexOf(t),1)}),n.initNodes(),n.initLinks(),o.splitNodes.splice(o.splitNodes.indexOf(P.id),1),P}}}},{key:"joinNodeEvent",value:function(t){var e=this.graph,n=this,o=e.state.SplitJoinViewPolicy;0!==o.eventHistory.length&&o.eventHistory[o.eventHistory.length-1].id===t.id?o.eventHistory.pop():o.eventHistory.push({id:t.id,event:"join"});var i=e.dataSource.children_struct;if(_.forEach(e.nodes,function(t){t.SplitJoinViewPolicy={},_.includes(i[o.focusGroups[0]],t.id)?t.SplitJoinViewPolicy.type="focus":t.SplitJoinViewPolicy.type="connected"}),null!=o.backButtonElem&&0===o.eventHistory.length&&o.backButtonElem.fadeTo("slow",0),null!=o.titleElem){var r="";o.focusGroups.length>0&&(r+=o.focusGroups[0]),2===o.focusGroups.length&&(r+=" & "+o.focusGroups[1]),o.titleElem.text(r)}n.setLayout()}},{key:"undoLastEvent",value:function(){var t,e=this.graph,o=this,i=e.state.SplitJoinViewPolicy,r=i.eventHistory[i.eventHistory.length-1],a=r.id;if("join"===r.event){t=e.findNodeById(a);var s=e.findD3Node(a);o.dblclick(s,t)}else{var l=e.dataSource.children_struct[a][0];t=e.findNodeById(l),_get(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"joinNode",this).call(o,t)}}}]),n}(t.Policy);return{Policy:n}}]),angular.module("contiv.visualization").config(["$stateProvider",function(t){t.state("contiv.menu.visualization.list",{url:"/list",controller:"VisualizationListCtrl as visualizationListCtrl",templateUrl:"visualization/visualizationlist.html"})}]).controller("VisualizationListCtrl",["$scope","$http","VisualizationService","$interval",function(t,e,n,o){var i=function(e){var n=[],o=[],i=[];_.forEach(e.results[0].series,function(t){var e,r=t.tags.EndpointIP,a=t.tags.ProviderIP;0==_.includes(i,r)&&(e={name:r,id:r,parent:null,ancestors:null},n.push(e),i.push(r)),0==_.includes(i,a)&&(e={name:a,id:a,parent:null,ancestors:null},n.push(e),i.push(a));var s={source:r,target:a,weight:t.values[0][2]};o.push(s);var l={source:a,target:r,weight:t.values[0][1]};o.push(l)}),t.nodes=n,t.links=o};n.getGraphData().then(i,function(t){}),t.$on("$destroy",function(){o.cancel(t.graphDataInterval)}),n.getStructureData().then(function(e){t.ancestors_struct=e.ancestors_struct,t.children_struct=e.children_struct,t.labels=e.labels,t.serviceSelectors=e.serviceSelectors},function(t){})}]),angular.module("contiv.visualization").factory("VisualizationService",["$http","$q",function(t,e){function n(n,o){var i=e.defer();return t.get(n,o).then(function(t){i.resolve(t.data)},function(t){i.reject(t.data)}),i.promise}function o(n,o){var i=function(t){var e,n,o,r,a,s,l,c="";for(e in t)if(n=t[e],n instanceof Array)for(l=0;l<n.length;++l)a=n[l],o=e+"["+l+"]",s={},s[o]=a,c+=i(s)+"&";else if(n instanceof Object)for(r in n)a=n[r],o=e+"["+r+"]",s={},s[o]=a,c+=i(s)+"&";else void 0!==n&&null!==n&&(c+=encodeURIComponent(e)+"="+encodeURIComponent(n)+"&");return c.length?c.substr(0,c.length-1):c},r=e.defer();return t({url:n,method:"POST",data:o,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(t){return angular.isObject(t)&&"[object File]"!==String(t)?i(t):t}]}).then(function(t){r.resolve(t.data)},function(t){r.reject(t.data)}),r.promise}function i(){var t=ContivGlobals.VISUALIZATION_ENDPOINT;t+="influx/query";var e={params:{db:"telegraf",q:"SELECT BytesIn, BytesOut, EndpointIP, ProviderIP FROM httpjson_svcstats WHERE time > now() - 1m GROUP BY * LIMIT 1"}};return n(t,e)}function r(){var t=ContivGlobals.VISUALIZATION_ENDPOINT;return t+="services",n(t)}function a(t,e){var n="(";n+=e+"=",n+="'"+t[0]+"' ";for(var o=1;o<t.length;o++)n+="OR ",n+=e+"=",n+="'"+t[o]+"' ";return n+=")"}function s(t,e,n){var i=ContivGlobals.VISUALIZATION_ENDPOINT;i+="influx/query";var r={db:"telegraf",q:"SELECT sum(BytesOut) from httpjson_svcstats WHERE time > now() - 15s AND "+a(t,"EndpointIP")+" AND "+a(e,"ProviderIP")+"GROUP BY time(20s) LIMIT 1; SELECT sum(BytesIn) from httpjson_svcstats WHERE time > now() - 15s AND "+a(t,"ProviderIP")+" AND "+a(e,"EndpointIP")+"GROUP BY time(20s) fill(0) LIMIT 1"};return o(i,r)}function l(t,e){var n=ContivGlobals.VISUALIZATION_ENDPOINT;n+="influx/query";var i={db:"telegraf",q:"SELECT sum(BytesOut) FROM httpjson_svcstats WHERE time > now() - 1m AND "+a(t,"EndpointIP")+" AND "+a(e,"ProviderIP")+" GROUP BY time(10s) fill(0) LIMIT 6; SELECT sum(BytesIn) FROM httpjson_svcstats WHERE time > now() - 1m AND "+a(t,"ProviderIP")+" AND "+a(e,"EndpointIP")+" GROUP BY time(10s) fill(0) LIMIT 6"};return o(n,i)}return{getGraphData:i,getStructureData:r,getEdgeData:s,getOldEdgeData:l}}]),angular.module("contiv.volumes").config(["$stateProvider",function(t){t.state("contiv.menu.volumes.create",{url:"/create",templateUrl:"volumes/volumecreate.html",controller:"VolumeCreateCtrl as volumeCreateCtrl"})}]).controller("VolumeCreateCtrl",["$state","$stateParams","VolumesModel","StoragePoliciesModel","CRUDHelperService",function(t,e,n,o,i){function r(){t.go("contiv.menu.volumes.list")}function a(){r()}function s(){o.get().then(function(t){d.policies=t})}function l(){d.newVolume.policy=d.selectedPolicy.name,d.newVolume.backends=d.selectedPolicy.backends,d.newVolume.driver=d.selectedPolicy.driver,d.newVolume.create=d.selectedPolicy.create,d.newVolume.runtime=d.selectedPolicy.runtime}function c(){d.form.$valid&&(i.hideServerError(d),i.startLoader(d),l(),n.create(d.newVolume).then(function(t){i.stopLoader(d),r()},function(t){i.stopLoader(d),i.showServerError(d,t)}))}function u(){i.stopLoader(d),i.hideServerError(d),d.newVolume={name:"",backends:{},driver:{},create:{},runtime:{}}}var d=this;d.filesystems=["ext4","btrfs"],d.createVolume=c,d.cancelCreating=a,s(),u()}]),angular.module("contiv.volumes").config(["$stateProvider",function(t){t.state("contiv.menu.volumes.copy",{url:"/copy/",params:{snapshot:null,policy:null,volume:null},controller:"VolumeSnapshotCopyCtrl as volumeSnapshotCopyCtrl",templateUrl:"volumes/volumesnapshotcopy.html"})}]).controller("VolumeSnapshotCopyCtrl",["$state","$stateParams","$scope","$interval","$http","VolumesModel","CRUDHelperService",function(t,e,n,o,i,r,a){function s(){t.go("contiv.menu.volumes.details",{key:e.policy+"/"+e.volume})}function l(){t.go("contiv.menu.volumes.details",{key:e.policy+"/"+u.newvolume})}function c(){if(u.form.$valid){a.hideServerError(u),a.startLoader(u);var t={};t.policy=e.policy,t.name=e.volume,r.copy(t,e.snapshot,u.newvolume).then(function(t){a.stopLoader(u),l()},function(t){a.stopLoader(u),a.showServerError(u,t)})}}var u=this;u.policy=e.policy,u.volume=e.volume,u.snapshot=e.snapshot,u.copySnapshot=c,u.cancelCopy=s}]),angular.module("contiv.directives").directive("ctvAcivalid",function(){return{restrict:"E",templateUrl:"components/directives/nodes/acivalid.html",scope:{form:"="}}}),angular.module("contiv.directives").directive("ctvControlinterface",function(){return{restrict:"E",templateUrl:"components/directives/nodes/controlinterface.html",scope:{extravars:"="}}}),angular.module("contiv.directives").directive("ctvNetworkmode",function(){return{restrict:"E",templateUrl:"components/directives/nodes/networkmode.html",scope:{extravars:"="}}}),angular.module("contiv.directives").directive("ctvScheduler",function(){return{restrict:"E",templateUrl:"components/directives/nodes/scheduler.html",scope:{extravars:"="}}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9idW5kbGUuanMiLCJtb2R1bGUuanMiLCJkaXJlY3RpdmVzL21vZHVsZS5qcyIsIm1vZGVscy9tb2R1bGUuanMiLCJkYXRhc291cmNlL2RhdGFzb3VyY2UuanMiLCJ1dGlscy9tb2R1bGUuanMiLCJkYXRhc291cmNlL3Zpc3VhbGl6ZXJkYXRhc291cmNlLmpzIiwiYXBwbGljYXRpb25ncm91cHMvbW9kdWxlLmpzIiwiZGFzaGJvYXJkL21vZHVsZS5qcyIsImdyYXBoL2dyYXBoLmpzIiwibG9naW4vbW9kdWxlLmpzIiwibWVudS9tb2R1bGUuanMiLCJuZXR3b3JrX3BvbGljaWVzL21vZHVsZS5qcyIsIm5ldHdvcmtzL21vZHVsZS5qcyIsIm5vZGVzL21vZHVsZS5qcyIsIm9yZ2FuaXphdGlvbnMvbW9kdWxlLmpzIiwic2VydmljZV9sYnMvbW9kdWxlLmpzIiwiZ3JhcGgvdmlzdWFsaXplcmdyYXBoLmpzIiwic2V0dGluZ3MvbW9kdWxlLmpzIiwic3RvcmFnZV9wb2xpY2llcy9tb2R1bGUuanMiLCJsaW5rL2xpbmsuanMiLCJ2aXN1YWxpemF0aW9uL21vZHVsZS5qcyIsInZvbHVtZXMvbW9kdWxlLmpzIiwibGluay92aXN1YWxpemVybGluay5qcyIsImFwcC5qcyIsIm1lbnUvbWVudUN0cmwuanMiLCJub2Rlcy9iZ3BzZXJ2aWNlLmpzIiwibm9kZXMvbG9nc2RpcmVjdGl2ZS5qcyIsIm5vZGVzL2xvZ3NlcnZpY2UuanMiLCJub2RlL25vZGUuanMiLCJub2Rlcy9ub2RlYWN0aXZlam9ibG9nc2N0cmwuanMiLCJub2RlL3Zpc3VhbGl6ZXJub2RlLmpzIiwibm9kZXMvbm9kZWNvbW1pc3Npb25jdHJsLmpzIiwicG9saWN5L25vZGVzZWxlY3Rpb25wb2xpY3kuanMiLCJub2Rlcy9ub2RlZGV0YWlsc2N0cmwuanMiLCJub2Rlcy9ub2RlZGlyZWN0aXZlLmpzIiwibm9kZXMvbm9kZWRpc2NvdmVyY3RybC5qcyIsInBvbGljeS9wYXRoY2hhbmdldmlld3BvbGljeS5qcyIsIm5vZGVzL25vZGVsYXN0am9ibG9nc2N0cmwuanMiLCJwb2xpY3kvcG9saWN5LmpzIiwibm9kZXMvbm9kZWxpc3RjdHJsLmpzIiwicG9saWN5L3BvbGljeXNlcnZpY2UuanMiLCJvcmdhbml6YXRpb25zL29yZ2FuaXphdGlvbmNyZWF0ZWN0cmwuanMiLCJwb2xpY3kvcXRpcHBvbGljeS5qcyIsIm9yZ2FuaXphdGlvbnMvb3JnYW5pemF0aW9uZGV0YWlsc2N0cmwuanMiLCJzdG9yYWdlX3BvbGljaWVzL3N0b3JhZ2Vwb2xpY3ljcmVhdGVjdHJsLmpzIiwic3RvcmFnZV9wb2xpY2llcy9zdG9yYWdlcG9saWN5ZGV0YWlsc2N0cmwuanMiLCJzdG9yYWdlX3BvbGljaWVzL3N0b3JhZ2Vwb2xpY3lkaXJlY3RpdmUuanMiLCJwb2xpY3kvc2F2ZXN0YXRlcG9saWN5LmpzIiwidmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9uZWRnZWN0cmwuanMiLCJwb2xpY3kvc3BsaXRqb2lubm9kZXBvbGljeS5qcyIsInZpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbmVkZ2VkaXJlY3RpdmUuanMiLCJ2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb25ncmFwaGRpcmVjdGl2ZS5qcyIsInBvbGljeS9zcGxpdGpvaW52aWV3cG9saWN5LmpzIiwidmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9ubGlzdGN0cmwuanMiLCJ2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb25zZXJ2aWNlLmpzIiwidm9sdW1lcy92b2x1bWVjcmVhdGVjdHJsLmpzIiwidm9sdW1lcy92b2x1bWVzbmFwc2hvdGNvcHljdHJsLmpzIiwiY29tcG9uZW50cy9kaXJlY3RpdmVzL25vZGVzL2FjaXZhbGlkZGlyZWN0aXZlLmpzIiwiY29tcG9uZW50cy9kaXJlY3RpdmVzL25vZGVzL2NvbnRyb2xpbnRlcmZhY2VkaXJlY3RpdmUuanMiLCJjb21wb25lbnRzL2RpcmVjdGl2ZXMvbm9kZXMvbmV0d29ya21vZGVkaXJlY3RpdmUuanMiLCJjb21wb25lbnRzL2RpcmVjdGl2ZXMvbm9kZXMvc2NoZWR1bGVyZGlyZWN0aXZlLmpzIl0sIm5hbWVzIjpbIl9jbGFzc0NhbGxDaGVjayIsImluc3RhbmNlIiwiQ29uc3RydWN0b3IiLCJUeXBlRXJyb3IiLCJfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiIsInNlbGYiLCJjYWxsIiwiUmVmZXJlbmNlRXJyb3IiLCJfaW5oZXJpdHMiLCJzdWJDbGFzcyIsInN1cGVyQ2xhc3MiLCJwcm90b3R5cGUiLCJPYmplY3QiLCJjcmVhdGUiLCJjb25zdHJ1Y3RvciIsInZhbHVlIiwiZW51bWVyYWJsZSIsIndyaXRhYmxlIiwiY29uZmlndXJhYmxlIiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJhbmd1bGFyIiwibW9kdWxlIiwiQ29udGl2R2xvYmFscyIsIk5FVFdPUktTX0VORFBPSU5UIiwiTkVUV09SS1NfSU5TUEVDVF9FTkRQT0lOVCIsIlNFUlZJQ0VMQlNfSU5TUEVDVF9FTkRQT0lOVCIsIlBPTElDSUVTX0VORFBPSU5UIiwiUlVMRVNfRU5EUE9JTlQiLCJBUFBMSUNBVElPTkdST1VQU19FTkRQT0lOVCIsIlNFUlZJQ0VMQlNfRU5EUE9JTlQiLCJPUkdBTklaQVRJT05TX0VORFBPSU5UIiwiTkVUV09SS19TRVRUSU5HU19FTkRQT0lOVCIsIk5FVFBST0ZJTEVTX0VORFBPSU5UIiwiQkdQU19FTkRQT0lOVCIsIkJHUFNfSU5TUEVDVF9FTkRQT0lOVCIsIlZJU1VBTElaQVRJT05fRU5EUE9JTlQiLCJWT0xVTUVTX0VORFBPSU5UIiwiVk9MVU1FU19DUkVBVEVfRU5EUE9JTlQiLCJWT0xVTUVTX0RFTEVURV9FTkRQT0lOVCIsIlZPTFVNRVNfQ09QWVNOQVBTSE9UU19FTkRQT0lOVCIsIlZPTFVNRVNfVVNFU19FTkRQT0lOVCIsIlZPTFVNRVNfU05BUFNIT1RTX0VORFBPSU5UIiwiU1RPUkFHRVBPTElDSUVTX0VORFBPSU5UIiwiVk9MVU1FU19HTE9CQUxfRU5EUE9JTlQiLCJOT0RFU19MSVNUX0VORFBPSU5UIiwiTk9ERVNfRElTQ09WRVJfRU5EUE9JTlQiLCJOT0RFU19DT01NSVNTSU9OX0VORFBPSU5UIiwiTk9ERVNfREVDT01NSVNTSU9OX0VORFBPSU5UIiwiTk9ERVNfTUFJTlRFTkFOQ0VfRU5EUE9JTlQiLCJOT0RFU19MQVNUX0pPQl9FTkRQT0lOVCIsIk5PREVTX0FDVElWRV9KT0JfRU5EUE9JTlQiLCJOT0RFU19TRVRUSU5HU19TRVRfRU5EUE9JTlQiLCJOT0RFU19TRVRUSU5HU19HRVRfRU5EUE9JTlQiLCJSRUZSRVNIX0lOVEVSVkFMIiwiQ0lEUl9SRUdFWCIsIlZMQU5fUkVHRVgiLCJWWExBTl9SRUdFWCIsIk5VTUJFUl9SRUdFWCIsIl9jcmVhdGVDbGFzcyIsImRlZmluZVByb3BlcnRpZXMiLCJ0YXJnZXQiLCJwcm9wcyIsImkiLCJsZW5ndGgiLCJkZXNjcmlwdG9yIiwiZGVmaW5lUHJvcGVydHkiLCJrZXkiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJmYWN0b3J5IiwiTm9kZSIsIkxpbmsiLCJEYXRhU291cmNlIiwibm9kZXMiLCJsaW5rcyIsInRoaXMiLCJpZCIsIm5hbWUiLCJub2RlRGF0YSIsIl8iLCJmb3JFYWNoIiwiZGF0YSIsIm5ld05vZGUiLCJ0ZXh0IiwicHVzaCIsImxpbmtEYXRhIiwiZmluZE5vZGVCeUlkIiwic291cmNlIiwibGluayIsIlZpc3VhbGl6ZXJOb2RlIiwiVmlzdWFsaXplckxpbmsiLCJWaXN1YWxpemVyRGF0YVNvdXJjZSIsIl9EYXRhU291cmNlJERhdGFTb3VyYyIsImNoaWxkcmVuX3N0cnVjdCIsImFuY2VzdG9yc19zdHJ1Y3QiLCJsYWJlbHMiLCJzZWxlY3RvcnMiLCJfdGhpcyIsImdldFByb3RvdHlwZU9mIiwidGhpc0RhdGFTb3VyY2UiLCJhZGRlZENsaWVudCIsIm5vZGUiLCJhbmNlc3RvcnMiLCJpc0VtcHR5IiwicGFyZW50IiwiaW5jbHVkZXMiLCJ0b3BMZXZlbCIsImdldEZsb3dCZXR3ZWVuU2V0Iiwibm9kZV9uYW1lcyIsImxvY2FsX25vZGVzIiwiaWRNYXBwaW5nIiwiaiIsImluZGV4T2YiLCJ3ZWlnaHQiLCJub2RlX3RvX2FkZCIsIm5vZGVJZFRvTmFtZSIsImFkZGVkX2xpbmtzIiwidW5kZWZpbmVkIiwiZXhpc3RpbmdfbGluayIsInNldFdlaWdodCIsImdldFJhd1dlaWdodCIsImluY3JlYXNlQ291bnQiLCJjb25maWciLCIkc3RhdGVQcm92aWRlciIsInN0YXRlIiwidXJsIiwiYWJzdHJhY3QiLCJ0ZW1wbGF0ZSIsImNvbXBvbmVudCIsIlBvbGljeVNlcnZpY2UiLCJHcmFwaCIsInN2ZyIsInRoaXNHcmFwaCIsImRlZmF1bHROb2RlUG9saWNpZXMiLCJkZWZhdWx0UGF0aFBvbGljaWVzIiwic3ZnUG9saWN5IiwiUG9saWN5IiwiY2FuWm9vbSIsImNhblBhbiIsImluaXRGb3JjZSIsImRpc2FibGVVcGRhdGUiLCJjb25zdHMiLCJjaXJjbGVHQ2xhc3MiLCJncmFwaENsYXNzIiwicGF0aENsYXNzIiwibm9kZUNsYXNzIiwibm9kZVRleHQiLCJzdGFydFJhZGl1cyIsIm1heFJhZGl1cyIsInBhZGRpbmciLCJkaXNwbGF5T2Zmc2V0Iiwib24iLCJkIiwiZGVmcyIsImFwcGVuZCIsImF0dHIiLCJzdmdHIiwiY2xhc3NlZCIsInBhdGhzIiwic2VsZWN0QWxsIiwiY2lyY2xlcyIsImluaXROb2RlcyIsImluaXRMaW5rcyIsInNldFBvc2l0aW9ucyIsInJlc2l6ZUZ1bmMiLCJvbldpbmRvd1Jlc2l6ZSIsImJpbmRpbmdzIiwicmVzaXplIiwiJCIsIndpbmRvdyIsInBvbGljeSIsImRlc3Ryb3kiLCJvZmYiLCJpbml0aWFsaXplIiwiZDNOb2RlIiwiZWFjaCIsImQzIiwic2VsZWN0IiwiZDNkcmFnIiwiZHJhZyIsInBvbGljeVJlbW92ZSIsInBvbGljeVJlbW92ZU5hbWUiLCJwb2xpY3lOYW1lIiwiaW5kZXgiLCJzcGxpY2UiLCJldmVudCIsImQzcGF0aCIsImQzbm9kZSIsImQzem9vbSIsImRyYWdTdmciLCJnRWwiLCJ0aXRsZSIsIndvcmRzIiwic3BsaXQiLCJud29yZHMiLCJlbCIsInRzcGFuIiwidG9TcGxpY2UiLCJmaWx0ZXIiLCJsIiwibWFwIiwidXBkYXRlR3JhcGgiLCJzcGxpY2VMaW5rc0Zvck5vZGUiLCJ1cGRhdGVBdHRyIiwibmV3UGF0aHMiLCJuZXdQYXRoQXR0ciIsImhhc1BvbGljeSIsInBhdGhQb2xpY3lFdmVudCIsIm5ld05vZGVzIiwiZ3JhcGgiLCJuZXdOb2RlQXR0ciIsIm5vZGVQb2xpY3lFdmVudCIsIlN0cmluZyIsInJhZGl1cyIsImluc2VydFRpdGxlTGluZWJyZWFrcyIsImFscGhhIiwicXVhZHRyZWUiLCJnZW9tIiwiciIsIm54MSIsIngiLCJueDIiLCJueTEiLCJ5IiwibnkyIiwidmlzaXQiLCJxdWFkIiwieDEiLCJ5MSIsIngyIiwieTIiLCJwb2ludCIsIk1hdGgiLCJzcXJ0IiwiZSIsIndpZHRoIiwiaGVpZ2h0Iiwib2Zmc2V0IiwicSIsIm4iLCJkM0ZvcmNlQ29sbGlkZSIsIm1heCIsIm1pbiIsInN2Z1dpZHRoIiwic3ZnSGVpZ2h0IiwiY2FsbGJhY2siLCJib3VuZHMiLCJkM0ZvcmNlQm91bmRzIiwiZm9yY2UiLCJsYXlvdXQiLCJzaXplIiwiY2hhcmdlIiwibGlua0Rpc3RhbmNlIiwibGlua1N0cmVuZ3RoIiwiZ3Jhdml0eSIsImQzRm9yY2VUaWNrIiwiZDNGb3JjZVN0YXJ0IiwiZDNGb3JjZUVuZCIsInN0YXJ0IiwiayIsInRpY2siLCJzdG9wIiwidXBkYXRlRXhpc3RpbmdOb2RlcyIsIm5ld0dzIiwiZW50ZXIiLCJleGl0IiwicmVtb3ZlIiwic2V0Rm9yY2UiLCJ1cGRhdGVOZXdOb2RlcyIsInVwZGF0ZUV4aXN0aW5nUGF0aHMiLCJuZXdwYXRocyIsInN0eWxlIiwidXBkYXRlTmV3UGF0aHMiLCJwYXJhbXMiLCJwb2xpY3lUYWIiLCJWaXN1YWxpemVyR3JhcGgiLCJfR3JhcGgkR3JhcGgiLCJkYXRhU291cmNlIiwidHJhbnNpdGlvbiIsImVkZ2VfYnVmZmVyIiwicmFkaXVzRGVjYXkiLCJjb250YWluZXJDbGFzcyIsImJlaGF2aW9yIiwib3JpZ2luIiwiYXJncyIsImR4IiwiZHkiLCJ6b29tIiwic291cmNlRXZlbnQiLCJjdHJsS2V5Iiwiem9vbWVkIiwidHJhbnNsYXRlIiwic2NhbGUiLCJyaWdodENsaWNrIiwianVzdFNjYWxlVHJhbnNHcmFwaCIsInpvb21TZXRDYWxsYmFjayIsInRyYW5zbGF0ZV9uYW1lIiwiZGVsYXkiLCJkdXJhdGlvbiIsImJvZHlFbCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJkaXZXaWR0aCIsImNsaWVudEhlaWdodCIsInRvcCIsIm5vZGVfbmFtZXNfc2V0IiwicmV0RGF0YSIsInByb2Nlc3NMaW5rRGF0YSIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsInNvdXJjZU5vZGUiLCJ0YXJnZXROb2RlIiwicGF0aFBvbGljaWVzIiwiaW5pdGlhbGl6ZWQiLCJhcnJvd1BhdGgiLCJkciIsInRoaXNQYXRoIiwiX2dldCIsImdldCIsIm9iamVjdCIsInByb3BlcnR5IiwicmVjZWl2ZXIiLCJGdW5jdGlvbiIsImRlc2MiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJnZXR0ZXIiLCJfTGluayRMaW5rIiwiY291bnQiLCJyZXQiLCJteSIsImF0IiwiYWRqdXN0IiwibWF4V2VpZ2h0IiwidXNlQXZnV2VpZ2h0IiwidXBkYXRlTWF4V2VpZ2h0IiwidmFsIiwibWF4TGluayIsIm1heEJ5IiwiZ2V0V2VpZ2h0IiwiY29sb3JTY2FsZSIsImxpbmVhciIsImRvbWFpbiIsInJhbmdlIiwic2VsZWN0ZWRDbGFzcyIsInNlbGVjdGVkRWRnZSIsImMiLCJhdHRyVHdlZW4iLCJpbnRlcnBvbGF0ZVN0cmluZyIsIiR1cmxSb3V0ZXJQcm92aWRlciIsIm90aGVyd2lzZSIsInVzZXJuYW1lIiwiJHN0YXRlIiwiJHN0YXRlUGFyYW1zIiwibG9nb3V0IiwiZ28iLCJtZW51Q3RybCIsIiRodHRwIiwiJHEiLCJnZXRCZ3AiLCJjdHJsIiwiZGVmZXJyZWQiLCJkZWZlciIsInRoZW4iLCJyZXN1bHQiLCJyZXNvbHZlIiwibmVpZ2hib3IiLCJuZWlnaGJvcnMiLCJyZWplY3QiLCJwcm9taXNlIiwidXBkYXRlQmdwIiwicG9zdCIsImdldEJncEluc3BlY3QiLCJkaXJlY3RpdmUiLCJyZXN0cmljdCIsInNjb3BlIiwibG9nIiwiZ2V0QWN0aXZlTG9ncyIsImdldExhc3RMb2dzIiwibm9kZVBvbGljaWVzIiwidGhpc05vZGUiLCIkc2NvcGUiLCIkaW50ZXJ2YWwiLCJMb2dTZXJ2aWNlIiwibm9kZUFjdGl2ZUpvYkxvZ3NDdHJsIiwiYWN0aXZlTG9ncyIsImlzRGVmaW5lZCIsIiRvbiIsImNhbmNlbCIsIl9Ob2RlJE5vZGUiLCJ4U3RhcnQiLCJ5U3RhcnQiLCJOb2Rlc01vZGVsIiwiQ1JVREhlbHBlclNlcnZpY2UiLCJOb2Rlc1NlcnZpY2UiLCJyZXR1cm5Ub05vZGVEZXRhaWxzIiwiY2FuY2VsQ29tbWlzc2lvbmluZ05vZGUiLCJjb21taXNzaW9uIiwibm9kZUNvbW1pc3Npb25DdHJsIiwiZm9ybSIsIiR2YWxpZCIsImhpZGVTZXJ2ZXJFcnJvciIsInN0YXJ0TG9hZGVyIiwibm9kZU9wc09iaiIsImNsZWFudXBFeHRyYVZhcnMiLCJjcmVhdGVFeHRyYVZhcnMiLCJzdG9wTG9hZGVyIiwic2hvd1NlcnZlckVycm9yIiwiZXh0cmFfdmFycyIsImFuc2libGVWYXJpYWJsZXMiLCJlbnZWYXJpYWJsZXMiLCJnZXRTZXR0aW5ncyIsIk5vZGVTZWxlY3Rpb25Qb2xpY3kiLCJfUG9saWN5JFBvbGljeSIsInNlbGVjdGVkTm9kZXMiLCJzZWxlY3Rpb24iLCJjZCIsInN0b3BQcm9wYWdhdGlvbiIsInJlbW92ZVNlbGVjdEZyb21Ob2RlIiwiYWRkU2VsZWN0Tm9kZSIsInJlbW92ZUFsbFNlbGVjdGVkTm9kZXMiLCJCZ3BTZXJ2aWNlIiwiZGVjb21taXNzaW9uIiwibm9kZURldGFpbHNDdHJsIiwic2hvd0NvbW1pc3Npb25CdXR0b24iLCJjb21taXNzaW9uQnV0dG9uRW5hYmxlZCIsInVwZ3JhZGVCdXR0b25FbmFibGVkIiwidXBncmFkZSIsInNldEJ1dHRvbkRpc3BsYXkiLCJzdGF0dXMiLCJnZXROb2RlSW5mbyIsInJlbG9hZCIsImdldE1vZGVsQnlLZXkiLCJzZXRNb2RlIiwiaXMiLCJtb2RlIiwicmV0dXJuVG9JbmZvIiwidXBkYXRlQmdwSW5mbyIsIml0ZW0iLCJnZXRCZ3BJbmZvIiwiaW5zcGVjdCIsInJvdXRlcyIsIk9wZXIiLCJmaWx0ZXJlZHJvdXRlcyIsIm51bWJlcnBhdHRlcm4iLCJyZXR1cm5Ub05vZGVzIiwiY2FuY2VsRGlzY292ZXJpbmdOb2RlIiwiZGlzY292ZXIiLCJub2RlRGlzY292ZXJDdHJsIiwiY3JlYXRlSVBBZGRyQXJyYXkiLCJhZGRycyIsIm5vZGVJUEFkZHIiLCJQYXRoQ2hhbmdlVmlld1BvbGljeSIsInRoaXNQb2xpY3kiLCJyZXRMaXN0IiwiZ2VuZXJhdGVMaXN0SGVscGVyIiwibm9kZUlkcyIsImNoaWxkSWQiLCJoYXNDaGlsZCIsInN1YlJldExpc3QiLCJjb25jYXQiLCJlZGdlIiwic291cmNlTGlzdCIsInRhcmdldExpc3QiLCJzb3VyY2VJZCIsInRhcmdldElkIiwiZ2VuZXJhdGVMaXN0Iiwic291cmNlTmFtZSIsInRhcmdldE5hbWUiLCJ2aWV3RWRnZSIsIm5vZGVMYXN0Sm9iTG9nc0N0cmwiLCJsYXN0TG9ncyIsImQzb2JqIiwiJGZpbHRlciIsImdldE5vZGVzIiwibm9kZUxpc3RDdHJsIiwiUVRpcFBvbGljeSIsIlNwbGl0Sm9pbk5vZGVQb2xpY3kiLCJTcGxpdEpvaW5WaWV3UG9saWN5IiwiU2F2ZVN0YXRlUG9saWN5IiwiT3JnYW5pemF0aW9uc01vZGVsIiwicmV0dXJuVG9Pcmdhbml6YXRpb25zIiwiY2FuY2VsQ3JlYXRpbmciLCJjcmVhdGVPcmdhbml6YXRpb24iLCJvcmdhbml6YXRpb25DcmVhdGVDdHJsIiwibmV3T3JnYW5pemF0aW9uIiwidGVuYW50TmFtZSIsInJlc2V0Rm9ybSIsIm1vdXNlZG93biIsIm1vdXNldXAiLCJncmFwaFVwZGF0ZU5ld05vZGVzIiwiZ3JhcGhVcGRhdGVOZXdQYXRocyIsImludGVydmFsIiwic2V0VGltZW91dCIsInF0aXAiLCJ3aGVuUVRpcEF2YWlsYWJsZSIsImF0dGFjaFFUaXAiLCJzZWxlY3Rvck1hcCIsImhhc0tleXMiLCJsYWJlbHNNYXAiLCJzbGljZSIsImNvbnRlbnQiLCJldmVudHMiLCJzaG93IiwiYXBpIiwicG9zaXRpb24iLCJsZWZ0Iiwic2V0Iiwic29sbyIsImNsYXNzZXMiLCJoaWRlIiwicGF0aEVsIiwidGFyZ2V0UmV0IiwiZ2V0UG9pbnRBdExlbmd0aCIsImdldFRvdGFsTGVuZ3RoIiwicXRpcEhlbHBlciIsImRlbGV0ZU9yZ2FuaXphdGlvbiIsIm9yZ2FuaXphdGlvbkRldGFpbHNDdHJsIiwib3JnYW5pemF0aW9uIiwiU3RvcmFnZVBvbGljaWVzTW9kZWwiLCJyZXR1cm5Ub1N0b3JhZ2VQb2xpY2llcyIsImNyZWF0ZUZpbGVzeXN0ZW1DbWRzIiwic3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwiLCJmaWxlc3lzdGVtY21kcyIsIm5ld1N0b3JhZ2VQb2xpY3kiLCJmaWxlc3lzdGVtcyIsImNyZWF0ZVBvbGljeSIsImJhY2tlbmRzIiwiY3J1ZCIsIm1vdW50Iiwic25hcHNob3QiLCJ1bmxvY2tlZCIsImRyaXZlciIsInBvb2wiLCJmaWxlc3lzdGVtIiwicnVudGltZSIsInNuYXBzaG90cyIsImZyZXF1ZW5jeSIsImtlZXAiLCJyYXRlLWxpbWl0Iiwid3JpdGUtaW9wcyIsInJlYWQtaW9wcyIsIndyaXRlLWJwcyIsInJlYWQtYnBzIiwiVm9sdW1lc01vZGVsIiwic3RvcmFnZVBvbGljeURldGFpbHNDdHJsIiwicmV0dXJuVG9Qb2xpY2llcyIsInJldHVyblRvUG9saWN5RGV0YWlscyIsImNhbmNlbEVkaXRpbmciLCJkZWxldGVQb2xpY3kiLCJkZWxldGVVc2luZ0tleSIsImdldFZvbHVtZXMiLCJ2b2x1bWVzIiwiaW5pdGlhbGl6ZUZpbGVzeXN0ZW1DbWRzQXJyYXkiLCJzYXZlUG9saWN5Iiwic2F2ZSIsInNhdmVkU3RhdGUiLCJncmFwaERlc3Ryb3kiLCJsb2FkIiwiZ3JhcGhMb2FkIiwiVmlzdWFsaXphdGlvblNlcnZpY2UiLCJEYXRlIiwidCIsImdldFNlY29uZHMiLCJlZGdlRGF0YUludGVydmFsIiwiZ2V0RWRnZURhdGEiLCJ0b1N0cmluZyIsInJlc3VsdHMiLCJzZXJpZXMiLCJ2YWx1ZXMiLCJlZGdlRGF0YSIsImVkZ2VEYXRhVGltZSIsImdldE9sZEVkZ2VEYXRhIiwib2xkRWRnZURhdGEiLCJfTm9kZVNlbGVjdGlvblBvbGljeSQiLCJzcGxpdE5vZGVzIiwic3VwZXJTdGF0ZSIsInNwbGl0TXVsdGlwbGVOb2RlcyIsInNwbGl0Tm9kZSIsInByZXZlbnREZWZhdWx0Iiwiam9pbk5vZGUiLCJncmFwaE5vZGVzIiwibmV3X25vZGVzIiwieExvYyIsInlMb2MiLCJuZXdfbm9kZV9vYmpzIiwibmV3X25vZGUiLCJyZXMiLCJfX3NwbGl0Tm9kZSIsInNwbGl0Tm9kZUV2ZW50IiwicmVzTm9kZXMiLCJzcGxpdE11bHRpcGxlTm9kZXNFdmVudCIsInRvX2JlX2RlbGV0ZWQiLCJuZXdfbm9kZV9pZCIsIm5vZGVfdG9fZGVsZXRlIiwiX19qb2luTm9kZSIsImpvaW5Ob2RlRXZlbnQiLCJqb2luTXVsdGlwbGVOb2Rlc0V2ZW50IiwiJHdpbmRvdyIsInZpc3VhbGl6YXRpb25FZGdlRDMiLCJub3ciLCJncm91cHMiLCJncm91cCIsInBhdGgiLCJsaW5lIiwibGltaXQiLCJheGlzIiwiZWFzZSIsInlBeGlzIiwic2hpZnQiLCJjbGllbnRXaWR0aCIsImN1cnJlbnQiLCJjb2xvciIsImZsb29yIiwidGltZSIsImludGVycG9sYXRlIiwieFN2ZyIsIm9yaWVudCIsInJlcGxhY2UiLCIkd2F0Y2hHcm91cCIsInNlcnZpY2UiLCJzYXZlZFN0YXRlcyIsIlN0YXRlU2F2ZSIsInZpc3VhbGl6YXRpb25saXN0ZDMiLCJlbGVtIiwic2VydmljZVNlbGVjdG9ycyIsInNldEFuY2VzdG9ycyIsInRvcERhdGEiLCJnZXRUb3BMZXZlbEZsb3ciLCJwcm9jZXNzTm9kZURhdGEiLCJyYXdTdmciLCJmaW5kIiwidmlzdWFsaXphdGlvbkdyYXBoIiwiaW5zdGFsbERlZmF1bHRQYXRoUG9saWN5IiwicVRpcFBvbGljeSIsImluc3RhbGxEZWZhdWx0Tm9kZVBvbGljeSIsInNwbGl0Sm9pblZpZXdQb2xpY3kiLCJpbnN0YWxsQmFja0J1dHRvbiIsImluc3RhbGxUaXRsZSIsInVuYmluZCIsInVwZGF0ZUxpbmtEYXRhIiwiX1NwbGl0Sm9pbk5vZGVQb2xpY3kkIiwiZXZlbnRIaXN0b3J5IiwiZm9jdXNHcm91cHMiLCJmb2NpIiwiem9vbXMiLCJsYXlvdXREZWZhdWx0Iiwiem9vbURlZmF1bHQiLCJub2RlSWRzVG9SZXNob3ciLCJiYWNrQnV0dG9uRWxlbSIsInRpdGxlRWxlbSIsImJvdW5kYXJ5IiwiYmFja0J1dHRvbiIsInVuZG9MYXN0RXZlbnQiLCJjdXJyVGl0bGUiLCJzdGF0ZXMiLCJsb2FkU3RhdGUiLCJmYWRlVG8iLCJ0eXBlIiwicG9zIiwiY29uc29sZSIsInVwZGF0ZUdyYXBoQ2FsbGJhY2siLCJub2Rlc1RvS2VlcCIsImdyb3VwT25lTm9kZXMiLCJwYXJzZUZsb2F0Iiwic3BsaXROb2RlRnVuYyIsImdldFJhbmRvbUludCIsInJhbmRvbSIsImdyYXBoQ29uc3RzIiwic3RhdGVQb2xpY3kiLCJkZWZhdWx0TGF5b3V0IiwiY2FsY01heE5vZGVzIiwiYXJlYSIsImFtb3VudCIsImNvbnN0c1BvbGljeSIsImZvY3VzTm9kZXMiLCJib3QiLCJwb3AiLCJzZXRMYXlvdXQiLCJzdGF0ZVN1cGVyIiwibm9kZU5hbWVTZXQiLCJuYW1lVG9BZGQiLCJub2Rlc1RvUHJvY2VzcyIsIm5vZGVUb1JlbW92ZSIsImxhc3QiLCJmaW5kRDNOb2RlIiwiZGJsY2xpY2siLCJub2RlSWQiLCJzdWNjZXNzR3JhcGhEYXRhQ2FsbGJhY2siLCJlbmRwb2ludCIsInRhZ3MiLCJFbmRwb2ludElQIiwicHJvdmlkZXIiLCJQcm92aWRlcklQIiwibGlua091dCIsImxpbmtJbiIsImdldEdyYXBoRGF0YSIsImdyYXBoRGF0YUludGVydmFsIiwiZ2V0U3RydWN0dXJlRGF0YSIsIm1ha2VHZXQiLCJtYWtlUG9zdCIsInBhcmFtIiwib2JqIiwiZnVsbFN1Yk5hbWUiLCJzdWJOYW1lIiwic3ViVmFsdWUiLCJpbm5lck9iaiIsInF1ZXJ5IiwiQXJyYXkiLCJlbmNvZGVVUklDb21wb25lbnQiLCJzdWJzdHIiLCJtZXRob2QiLCJoZWFkZXJzIiwiQ29udGVudC1UeXBlIiwidHJhbnNmb3JtUmVxdWVzdCIsImlzT2JqZWN0IiwiZGIiLCJidWlsZFdoZXJlUXVlcnkiLCJwb2ludHMiLCJyZXR1cm5Ub1ZvbHVtZXNNb2RlbCIsImdldFN0b3JhZ2VQb2xpY2llcyIsInZvbHVtZUNyZWF0ZUN0cmwiLCJwb2xpY2llcyIsImFwcGx5UG9saWN5U2V0dGluZ3MiLCJuZXdWb2x1bWUiLCJzZWxlY3RlZFBvbGljeSIsImNyZWF0ZVZvbHVtZSIsInZvbHVtZSIsImNhbmNlbENvcHkiLCJnb1RvTmV3Vm9sdW1lIiwidm9sdW1lU25hcHNob3RDb3B5Q3RybCIsIm5ld3ZvbHVtZSIsImNvcHlTbmFwc2hvdCIsIm1vZGVsIiwiY29weSIsImV4dHJhdmFycyJdLCJtYXBwaW5ncyI6IkFBQUEsWUE4REEsU0FBU0EsaUJBQWdCQyxFQUFVQyxHQUFlLEtBQU1ELFlBQW9CQyxJQUFnQixLQUFNLElBQUlDLFdBQVUscUNBNkpoSCxRQUFTSCxpQkFBZ0JDLEVBQVVDLEdBQWUsS0FBTUQsWUFBb0JDLElBQWdCLEtBQU0sSUFBSUMsV0FBVSxxQ0FFaEgsUUFBU0MsNEJBQTJCQyxFQUFNQyxHQUFRLElBQUtELEVBQVEsS0FBTSxJQUFJRSxnQkFBZSw0REFBZ0UsUUFBT0QsR0FBeUIsZ0JBQVRBLElBQXFDLGtCQUFUQSxHQUE4QkQsRUFBUEMsRUFFbE8sUUFBU0UsV0FBVUMsRUFBVUMsR0FBYyxHQUEwQixrQkFBZkEsSUFBNEMsT0FBZkEsRUFBdUIsS0FBTSxJQUFJUCxXQUFVLGlFQUFvRU8sR0FBZUQsR0FBU0UsVUFBWUMs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QUFBLCtDQUNBa0UsT0FDQXdXLFVBQUEsUUNOQTFzQixRQUFBQyxPQUFBLHFCQUNBK1YsVUFBQSxlQUFBLFdBQ0EsT0FDQUMsU0FBQSxJQUNBakUsWUFBQSw2Q0FDQWtFLE9BQ0F3VyxVQUFBIiwiZmlsZSI6ImFwcC9idW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbi8qKlxuICogRGVmaW5pbmcgdGhlIEdyYXBoIE1vZHVsZS5cbiAqIFNlZSBERVNJR04ubWQgZm9yIGluZm8gb24gR3JhcGggT2JqZWN0cy5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcsIFtdKTtcbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIiwgW10pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzE0LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm1vZGVscycsIFtdKTtcbnZhciBDb250aXZHbG9iYWxzID0gKGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICAvL1JFU1QgZW5kcG9pbnRzIGZvciBORVRNQVNURVJcbiAgICAgICAgJ05FVFdPUktTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL25ldHdvcmtzLycsXG4gICAgICAgICdORVRXT1JLU19JTlNQRUNUX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL2luc3BlY3QvbmV0d29ya3MvJyxcbiAgICAgICAgJ1NFUlZJQ0VMQlNfSU5TUEVDVF9FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9pbnNwZWN0L3NlcnZpY2VMQnMvJyxcbiAgICAgICAgJ1BPTElDSUVTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL3BvbGljeXMvJyxcbiAgICAgICAgJ1JVTEVTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL3J1bGVzLycsXG4gICAgICAgICdBUFBMSUNBVElPTkdST1VQU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9lbmRwb2ludEdyb3Vwcy8nLFxuICAgICAgICAnU0VSVklDRUxCU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9zZXJ2aWNlTEJzLycsXG4gICAgICAgICdPUkdBTklaQVRJT05TX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL3RlbmFudHMvJyxcbiAgICAgICAgJ05FVFdPUktfU0VUVElOR1NfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvZ2xvYmFscy8nLFxuICAgICAgICAnTkVUUFJPRklMRVNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvbmV0cHJvZmlsZXMvJyxcbiAgICAgICAgJ0JHUFNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvQmdwcy8nLFxuICAgICAgICAnQkdQU19JTlNQRUNUX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL2luc3BlY3QvQmdwcy8nLFxuICAgICAgICAnVklTVUFMSVpBVElPTl9FTkRQT0lOVCc6ICcvdmlzdWFsaXphdGlvbi8nLFxuICAgICAgICAvL1JFU1QgZW5kcG9pbnRzIGZvciBWT0xNQVNURVJcbiAgICAgICAgJ1ZPTFVNRVNfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci92b2x1bWVzLycsXG4gICAgICAgICdWT0xVTUVTX0NSRUFURV9FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3ZvbHVtZXMvY3JlYXRlLycsXG4gICAgICAgICdWT0xVTUVTX0RFTEVURV9FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3ZvbHVtZXMvcmVtb3ZlLycsXG4gICAgICAgICdWT0xVTUVTX0NPUFlTTkFQU0hPVFNfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci92b2x1bWVzL2NvcHknLFxuICAgICAgICAnVk9MVU1FU19VU0VTX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvdXNlcy9tb3VudHMvJyxcbiAgICAgICAgJ1ZPTFVNRVNfU05BUFNIT1RTX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvc25hcHNob3RzLycsXG4gICAgICAgICdTVE9SQUdFUE9MSUNJRVNfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci9wb2xpY2llcy8nLFxuICAgICAgICAnVk9MVU1FU19HTE9CQUxfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci9nbG9iYWwvJyxcbiAgICAgICAgLy9SRVNUIGVuZHBvaW50cyBmb3IgQ0xVU1RFUlxuICAgICAgICAnTk9ERVNfTElTVF9FTkRQT0lOVCc6ICcvaW5mby9ub2RlcycsXG4gICAgICAgICdOT0RFU19ESVNDT1ZFUl9FTkRQT0lOVCc6ICcvZGlzY292ZXIvbm9kZXMnLFxuICAgICAgICAnTk9ERVNfQ09NTUlTU0lPTl9FTkRQT0lOVCc6ICcvY29tbWlzc2lvbi9ub2RlcycsXG4gICAgICAgICdOT0RFU19ERUNPTU1JU1NJT05fRU5EUE9JTlQnOiAnL2RlY29tbWlzc2lvbi9ub2RlcycsXG4gICAgICAgICdOT0RFU19NQUlOVEVOQU5DRV9FTkRQT0lOVCc6ICcvbWFpbnRlbmFuY2Uvbm9kZXMnLFxuICAgICAgICAnTk9ERVNfTEFTVF9KT0JfRU5EUE9JTlQnOiAnL2luZm8vam9iL2xhc3QnLFxuICAgICAgICAnTk9ERVNfQUNUSVZFX0pPQl9FTkRQT0lOVCc6ICcvaW5mby9qb2IvYWN0aXZlJyxcbiAgICAgICAgJ05PREVTX1NFVFRJTkdTX1NFVF9FTkRQT0lOVCc6ICcvZ2xvYmFscycsXG4gICAgICAgICdOT0RFU19TRVRUSU5HU19HRVRfRU5EUE9JTlQnOiAnL2luZm8vZ2xvYmFscycsXG4gICAgICAgIC8vUmVmcmVzaCBpbnRlcnZhbCBpbiBtaWxsaXNlY29uZHNcbiAgICAgICAgJ1JFRlJFU0hfSU5URVJWQUwnOiA1MDAwLFxuICAgICAgICAvL1JlZ0V4IGZvciB2YWxpZGF0aW9uXG4gICAgICAgICdDSURSX1JFR0VYJzogJ14oKFswLTldfFsxLTldWzAtOV18MVswLTldezJ9fDJbMC00XVswLTldfDI1WzAtNV0pXFwuKXszfShbMC05XXxbMS05XVswLTldfDFbMC05XXsyfXwyWzAtNF1bMC05XXwyNVswLTVdKShcXC8oWzAtOV18WzEtMl1bMC05XXwzWzAtMl0pKSQnLFxuICAgICAgICAnVkxBTl9SRUdFWCc6ICdeKFswLTldezEsNH0/LVswLTldezEsNH0/KSQnLFxuICAgICAgICAnVlhMQU5fUkVHRVgnOiAnXihbMC05XXsxLDh9Py1bMC05XXsxLDh9PykkJyxcbiAgICAgICAgJ05VTUJFUl9SRUdFWCc6ICdeWzAtOV0qJCdcbiAgICB9O1xufSkoKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXBcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLyoqXG4gKiBUaGUgYmFzZSBjbGFzcyB0aGUgRGF0YVNvdXJjZSBvYmplY3QuXG4gKiBcbiAqIFRoZSBEYXRhU291cmNlIG9iamVjdCB0YWtlcyBpbiBub2RlIGFuZCBsaW5rIGRhdGEgZnJvbSB0aGUgc2VydmVyLCBcbiAqIGFuZCBwcm92aWRlcyBtZXRob2RzIGZvciBjb252ZXJ0aW5nIGFuZCBtYW5pcHVsYXRpbmcgdGhlIGRhdGEgZm9yXG4gKiB0aGUgZ3JhcGggb2JqZWN0LlxuICogXG4gKiBUbyB3cml0ZSB5b3VyIG93biBEYXRhU291cmNlIG9iamVjdCwgY3JlYXRlIGEgbmV3IGZhY3RvcnkgdGhhdCB1c2VzIHRoZSBcbiAqIERhdGFTb3VyY2UgeW91IHdhbnQgdG8gaW5oZXJpdCBhcyBhIGRlcGVuZGVuY3ksIGFuZCBleHRlbmQgXG4gKiBpdHMgRGF0YVNvdXJjZSBjbGFzcy4gXG4gKiBSZXR1cm4gdGhlIGNsYXNzIG9iamVjdCB3aXRoIERhdGFTb3VyY2UgYXMga2V5LlxuICogXG4gKiBOb2RlIGRhdGEgaXMgZXhwZWN0ZWQgdG8gYmUgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6XG4gKiB7aWQ6bm9kZV9pZCwgdGV4dDpub2RlX3RleHR9XG4gKiBcbiAqIExpbmsgZGF0YSBpcyBleHBlY3RlZCB0byBiZSBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDpcbiAqIHtzb3VyY2U6IHNvdXJjZU5vZGVJZCwgdGFyZ2V0OiB0YXJnZXROb2RlSWR9XG4gKiBcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ0RhdGFTb3VyY2UnLCBbJ05vZGUnLCAnTGluaycsIGZ1bmN0aW9uIChOb2RlLCBMaW5rKSB7XG5cdHZhciBEYXRhU291cmNlID0gZnVuY3Rpb24gKCkge1xuXHRcdC8qKlxuICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAqXG4gICAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBub2RlcyAgICAgICAgICAgICAgVGhlIG5vZGUgZGF0YSBcbiAgICogQHBhcmFtICAgICAge0FycmF5fSAgIGxpbmtzICAgICAgICAgICAgICBUaGUgbGluayBkYXRhXG4gICAqL1xuXHRcdGZ1bmN0aW9uIERhdGFTb3VyY2Uobm9kZXMsIGxpbmtzKSB7XG5cdFx0XHRfY2xhc3NDYWxsQ2hlY2sodGhpcywgRGF0YVNvdXJjZSk7XG5cblx0XHRcdHRoaXMubm9kZXMgPSBub2Rlcztcblx0XHRcdHRoaXMubGlua3MgPSBsaW5rcztcblx0XHR9XG5cblx0XHQvKipcbiAgICogUmVwbGFjZXMgdGhlIG5vZGUgZGF0YVxuICAgKlxuICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGVzICAgVGhlIG5vZGVzXG4gICAqL1xuXG5cblx0XHRfY3JlYXRlQ2xhc3MoRGF0YVNvdXJjZSwgW3tcblx0XHRcdGtleTogJ3VwZGF0ZU5vZGVzJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVOb2Rlcyhub2Rlcykge1xuXHRcdFx0XHR0aGlzLm5vZGVzID0gbm9kZXM7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogUmVwbGFjZXMgdGhlIGxpbmsgZGF0YVxuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtMaW5rfSAgbGlua3MgICBUaGUgbGlua3NcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAndXBkYXRlTGlua3MnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUxpbmtzKGxpbmtzKSB7XG5cdFx0XHRcdHRoaXMubGlua3MgPSBsaW5rcztcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBSZXR1cm5zIHRoZSBOYW1lIGF0dHJpYnV0ZSBvZiB0aGUgTm9kZSB3aXRoIHRoZSBcbiAgICAqIG1hdGNoaW5nIGlkXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGlkICAgICAgVGhlIGlkZW50aWZpZXJcbiAgICAqIEByZXR1cm4gICAgIHtzdHJpbmd9ICBuYW1lIG9mIHRoZSBtYXRjaGluZyBub2RlXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ25vZGVJZFRvTmFtZScsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gbm9kZUlkVG9OYW1lKGlkKSB7XG5cdFx0XHRcdHZhciBub2RlcyA9IHRoaXMubm9kZXM7XG5cdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRpZiAobm9kZXNbaV0uaWQgPT0gaWQpIHtcblx0XHRcdFx0XHRcdHJldHVybiBub2Rlc1tpXS5uYW1lO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIHByb2Nlc3MgdGhlIG5vZGVEYXRhIHRvIGNyZWF0ZSBOb2RlIG9iamVjdHNcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlRGF0YSAgTm9kZURhdGEgdG8gY29udmVydCBcbiAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0byBub2RlIG9iamVjdHNcbiAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIE5vZGUgb2JqZWN0c1xuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdwcm9jZXNzTm9kZURhdGEnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHByb2Nlc3NOb2RlRGF0YShub2RlRGF0YSkge1xuXHRcdFx0XHR2YXIgbm9kZXMgPSBbXTtcblx0XHRcdFx0Xy5mb3JFYWNoKG5vZGVEYXRhLCBmdW5jdGlvbiAoZGF0YSkge1xuXHRcdFx0XHRcdHZhciBuZXdOb2RlID0gbmV3IE5vZGUuTm9kZShudWxsLCBudWxsLCBkYXRhLmlkLCBkYXRhLnRleHQsIG51bGwpO1xuXHRcdFx0XHRcdG5vZGVzLnB1c2gobmV3Tm9kZSk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRyZXR1cm4gbm9kZXM7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogcHJvY2VzcyB0aGUgbGlua0RhdGFcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBsaW5rRGF0YSAgVGhlIGxpbmsgZGF0YVxuICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZXMgICAgIFRoZSBub2RlcyBmcm9tIHByb2Nlc3NOb2RlRGF0YVxuICAgICogQHJldHVybiAgICAge0FycmF5fSAgTGluayBvYmplY3RzXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3Byb2Nlc3NMaW5rRGF0YScsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gcHJvY2Vzc0xpbmtEYXRhKGxpbmtEYXRhLCBub2Rlcykge1xuXHRcdFx0XHQvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBub2RlIHRoYXQgbWF0Y2hlcyB0aGUgaWRcbiAgICAgKlxuICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9IGlkICAgICAgVGhlIGlkZW50aWZpZXJcbiAgICAgKiBAcmV0dXJuICAgICB7Tm9kZX0gICBUaGUgbm9kZSB3aXRoIHRoZSBtYXRjaGluZyBpZFxuICAgICAqL1xuXHRcdFx0XHRmdW5jdGlvbiBmaW5kTm9kZUJ5SWQoaWQsIG5vZGVzKSB7XG5cdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0aWYgKGlkID09IG5vZGVzW2ldLmlkKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBub2Rlc1tpXTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR2YXIgbGlua3MgPSBbXTtcblx0XHRcdFx0Ly90cmFuc2Zvcm1pbmcgbGluayBkYXRhXG5cdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbGlua0RhdGEubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRpZiAobGlua0RhdGFbaV0uc291cmNlICE9IGxpbmtEYXRhW2ldLnRhcmdldCkge1xuXHRcdFx0XHRcdFx0dmFyIHNvdXJjZSA9IGZpbmROb2RlQnlJZChsaW5rRGF0YVtpXS5zb3VyY2UsIG5vZGVzKTtcblx0XHRcdFx0XHRcdHZhciB0YXJnZXQgPSBmaW5kTm9kZUJ5SWQobGlua0RhdGFbaV0udGFyZ2V0LCBub2Rlcyk7XG5cdFx0XHRcdFx0XHRpZiAoc291cmNlID09IG51bGwgfHwgdGFyZ2V0ID09IG51bGwpIHtcblx0XHRcdFx0XHRcdFx0Y29udGludWU7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR2YXIgbGluayA9IG5ldyBMaW5rLkxpbmsoc291cmNlLCB0YXJnZXQpO1xuXHRcdFx0XHRcdFx0bGlua3MucHVzaChsaW5rKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIGxpbmtzO1xuXHRcdFx0fVxuXHRcdH1dKTtcblxuXHRcdHJldHVybiBEYXRhU291cmNlO1xuXHR9KCk7XG5cblx0cmV0dXJuIHtcblx0XHREYXRhU291cmNlOiBEYXRhU291cmNlXG5cdH07XG59XSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudXRpbHMnLCBbXSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuLyoqXG4gKiBUaGUgRGF0YVNvdXJjZSB1c2VkIGZvciB0aGUgdmlzdWFsaXphdGlvbiB0YWIuXG4gKiBcbiAqIE5vZGUgRGF0YSBmcm9tIHRoZSBzZXJ2ZXIgaXMgZXhwZWN0ZWQgdG8gYmUgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6XG4gKiB7aWQ6IG5vZGVfaWQsIHRleHQ6IG5vZGVfdGV4dH1cbiAqIFBhcmVudCBhbmQgQW5jZXN0b3IgYXR0cmlidXRlcyBjYW4gYmUgc2V0IGJ5IGNhbGxpbmcgc2V0QW5jZXN0b3JzXG4gKiBcbiAqIExpbmsgRGF0YSBmcm9tIHRoZSBzZXJ2ZXIgaXMgZXhwZWN0ZWQgdG8gYmUgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6XG4gKiB7c291cmNlOiBzb3VyY2VOb2RlSWQsIHRhcmdldDogdGFyZ2V0Tm9kZUlkLCB3ZWlnaHQ6IGxpbmtXZWlnaHR9XG4gKiBcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ1Zpc3VhbGl6ZXJEYXRhU291cmNlJywgWydEYXRhU291cmNlJywgJ1Zpc3VhbGl6ZXJOb2RlJywgJ1Zpc3VhbGl6ZXJMaW5rJywgZnVuY3Rpb24gKERhdGFTb3VyY2UsIFZpc3VhbGl6ZXJOb2RlLCBWaXN1YWxpemVyTGluaykge1xuXHR2YXIgVmlzdWFsaXplckRhdGFTb3VyY2UgPSBmdW5jdGlvbiAoX0RhdGFTb3VyY2UkRGF0YVNvdXJjKSB7XG5cdFx0X2luaGVyaXRzKFZpc3VhbGl6ZXJEYXRhU291cmNlLCBfRGF0YVNvdXJjZSREYXRhU291cmMpO1xuXG5cdFx0LyoqXG4gICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICogXG4gICAqIENoaWxkcmVuIFN0cnVjdCBhbmQgYW5jZXN0b3JzX3N0cnVjdCBhcmUgSlNPTiBvYmplY3RzLFxuICAgKiBtYXBwaW5nIGEgbm9kZSBJZCB0byBhIGxpc3Qgb2YgaXQncyBjaGlsZHJlbiBvciBhbmNlc3RvcnMuXG4gICAqIENoaWxkcmVuIFN0cnVjdCBpcyBhbHNvIGV4cGVjdGVkIHRvIGhhdmUgYSBmaWVsZCBjYWxsZWRcbiAgICogdG9wTGV2ZWwsIHRoYXQgbWFwcyB0byBhIGxpc3Qgb2YgYWxsIHRoZSBub2RlcyB0aGF0IGRvbid0XG4gICAqIGhhdmUgYW55IHBhcmVudHMuXG4gICAqXG4gICAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBub2RlcyAgICAgICAgICAgICAgVGhlIG5vZGUgZGF0YSBcbiAgICogQHBhcmFtICAgICAge0FycmF5fSAgIGxpbmtzICAgICAgICAgICAgICBUaGUgbGluayBkYXRhXG4gICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBjaGlsZHJlbl9zdHJ1Y3QgICAgVGhlIGNoaWxkcmVuIHN0cnVjdHVyZVxuICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgYW5jZXN0b3JzX3N0cnVjdCAgIFRoZSBhbmNlc3RvcnMgc3RydWN0dXJlXG4gICAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBsYWJlbHMgICAgICAgICAgICAgVGhlIGxhYmVsc1xuICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgc2VsZWN0b3JzICAgICAgICAgIFRoZSBzZWxlY3RvcnNcbiAgICovXG5cdFx0ZnVuY3Rpb24gVmlzdWFsaXplckRhdGFTb3VyY2Uobm9kZXMsIGxpbmtzLCBjaGlsZHJlbl9zdHJ1Y3QsIGFuY2VzdG9yc19zdHJ1Y3QsIGxhYmVscywgc2VsZWN0b3JzKSB7XG5cdFx0XHRfY2xhc3NDYWxsQ2hlY2sodGhpcywgVmlzdWFsaXplckRhdGFTb3VyY2UpO1xuXG5cdFx0XHR2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoVmlzdWFsaXplckRhdGFTb3VyY2UuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihWaXN1YWxpemVyRGF0YVNvdXJjZSkpLmNhbGwodGhpcywgbm9kZXMsIGxpbmtzKSk7XG5cblx0XHRcdF90aGlzLmNoaWxkcmVuX3N0cnVjdCA9IGNoaWxkcmVuX3N0cnVjdDtcblx0XHRcdF90aGlzLmFuY2VzdG9yc19zdHJ1Y3QgPSBhbmNlc3RvcnNfc3RydWN0O1xuXHRcdFx0X3RoaXMubGFiZWxzID0gbGFiZWxzO1xuXHRcdFx0X3RoaXMuc2VsZWN0b3JzID0gc2VsZWN0b3JzO1xuXHRcdFx0cmV0dXJuIF90aGlzO1xuXHRcdH1cblxuXHRcdC8qKlxuICAgKiBEZXRlcm1pbmVzIGlmIGl0IGhhcyBjaGlsZC5cbiAgICpcbiAgICogQHBhcmFtICAgICAge3N0cmluZ30gICBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG4gICAqIEByZXR1cm4gICAgIHtib29sZWFufSAgVHJ1ZSBpZiBoYXMgY2hpbGQsIEZhbHNlIG90aGVyd2lzZS5cbiAgICovXG5cblxuXHRcdF9jcmVhdGVDbGFzcyhWaXN1YWxpemVyRGF0YVNvdXJjZSwgW3tcblx0XHRcdGtleTogJ2hhc0NoaWxkJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBoYXNDaGlsZChpZCkge1xuXHRcdFx0XHRpZiAodGhpcy5jaGlsZHJlbl9zdHJ1Y3RbaWRdID09IG51bGwpIHtcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogU2V0cyB0aGUgcGFyZW50IGFuZCBhbmNlc3RvcnMgYXR0cmlidXRlIHVzaW5nIFxuICAgICogYW5jZXN0b3JzX3N0cnVjdCBmb3IgYWxsIHRoZSBub2Rlc1xuICAgICogQWxzbyBhZGRzIGFueSBub2RlcyB3aXRob3V0IGFuY2VzdG9ycywgdGhhdCBhcmVuJ3QgXG4gICAgKiB0b3BsZXZlbCB0byB0aGUgY2xpZW50IHNlcnZpY2UuXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3NldEFuY2VzdG9ycycsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gc2V0QW5jZXN0b3JzKCkge1xuXHRcdFx0XHR2YXIgdGhpc0RhdGFTb3VyY2UgPSB0aGlzO1xuXHRcdFx0XHR2YXIgYWRkZWRDbGllbnQgPSBmYWxzZTtcblx0XHRcdFx0Xy5mb3JFYWNoKHRoaXNEYXRhU291cmNlLm5vZGVzLCBmdW5jdGlvbiAobm9kZSkge1xuXHRcdFx0XHRcdG5vZGUuYW5jZXN0b3JzID0gdGhpc0RhdGFTb3VyY2UuYW5jZXN0b3JzX3N0cnVjdFtub2RlLmlkXSB8fCBbXTtcblx0XHRcdFx0XHRpZiAoXy5pc0VtcHR5KG5vZGUuYW5jZXN0b3JzKSA9PT0gZmFsc2UpIHtcblx0XHRcdFx0XHRcdG5vZGUucGFyZW50ID0gbm9kZS5hbmNlc3RvcnNbMF07XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGlmIChfLmluY2x1ZGVzKHRoaXNEYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbCwgbm9kZS5pZCkgPT0gZmFsc2UpIHtcblx0XHRcdFx0XHRcdFx0Ly9jb250YWluZXIgaGFzIG5vIHBhcmVudFxuXHRcdFx0XHRcdFx0XHQvL2FkZGluZyB0byBjbGllbnRcblx0XHRcdFx0XHRcdFx0bm9kZS5hbmNlc3RvcnMucHVzaChcImNsaWVudFwiKTtcblx0XHRcdFx0XHRcdFx0dGhpc0RhdGFTb3VyY2UuYW5jZXN0b3JzX3N0cnVjdFtub2RlLmlkXSA9IFtcImNsaWVudFwiXTtcblx0XHRcdFx0XHRcdFx0aWYgKGFkZGVkQ2xpZW50ID09PSBmYWxzZSkge1xuXHRcdFx0XHRcdFx0XHRcdGFkZGVkQ2xpZW50ID0gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0XHR0aGlzRGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwucHVzaChcImNsaWVudFwiKTtcblx0XHRcdFx0XHRcdFx0XHR0aGlzRGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbJ2NsaWVudCddID0gW107XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0dGhpc0RhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0WydjbGllbnQnXS5wdXNoKG5vZGUuaWQpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogUmV0dXJucyB0aGUgZmxvdyBiZXR3ZWVuIHRoZSBoaWdoZXN0IGxldmVsIGdyb3VwaW5nXG4gICAgKlxuICAgICogQHJldHVybiAgICAge09iamVjdH0gIFRoZSB0b3AgbGV2ZWwgZmxvdy5cbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnZ2V0VG9wTGV2ZWxGbG93Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBnZXRUb3BMZXZlbEZsb3coKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLmdldEZsb3dCZXR3ZWVuU2V0KHRoaXMuY2hpbGRyZW5fc3RydWN0LnRvcExldmVsKTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBHZXRzIHRoZSBmbG93IGJldHdlZW4gYW55IHNldCBvZiBub2RlIGxldmVsc1xuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVfbmFtZXMgIFRoZSBub2RlIG5hbWVzIGluIHRoZSBzZXRcbiAgICAqIEByZXR1cm4gICAgIHtPYmplY3R9ICBUaGUgZmxvdyBiZXR3ZWVuIHNldC5cbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnZ2V0Rmxvd0JldHdlZW5TZXQnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGdldEZsb3dCZXR3ZWVuU2V0KG5vZGVfbmFtZXMpIHtcblx0XHRcdFx0dmFyIGxvY2FsX25vZGVzID0gdGhpcy5ub2Rlcztcblx0XHRcdFx0dmFyIGlkTWFwcGluZyA9IHt9O1xuXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGxvY2FsX25vZGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0dmFyIG5vZGUgPSBsb2NhbF9ub2Rlc1tpXTtcblxuXHRcdFx0XHRcdC8vaWYgbm9kZSBpcyBhbHJlYWR5IGF0IGl0cyBoaWdoZXN0IGxldmVsXG5cdFx0XHRcdFx0aWYgKG5vZGUuYW5jZXN0b3JzID09PSBudWxsKSB7XG5cdFx0XHRcdFx0XHRpZE1hcHBpbmdbbm9kZS5pZF0gPSBub2RlLm5hbWU7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdC8vY2hlY2sgdG8gc2VlIHdoaWNoIHRhZ3MgYXJlIHByZXNlbnQgaW4gdGhlIGFuY2VzdG9yIGxpc3Rcblx0XHRcdFx0XHRcdGZvciAodmFyIGogPSAwOyBqIDwgbm9kZV9uYW1lcy5sZW5ndGg7IGorKykge1xuXHRcdFx0XHRcdFx0XHRpZiAobm9kZS5hbmNlc3RvcnMuaW5kZXhPZihub2RlX25hbWVzW2pdKSA+IC0xKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWRNYXBwaW5nW25vZGUuaWRdID0gbm9kZV9uYW1lc1tqXTtcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHQvL21vZGlmeSBsaW5rc1xuXHRcdFx0XHR2YXIgbGlua3MgPSB0aGlzLmxpbmtzO1xuXHRcdFx0XHR2YXIgbGlua0RhdGEgPSBbXTtcblxuXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGxpbmtzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0dmFyIGxpbmsgPSBbXTtcblx0XHRcdFx0XHRsaW5rLnNvdXJjZSA9IGlkTWFwcGluZ1tsaW5rc1tpXS5zb3VyY2VdIHx8IGxpbmtzW2ldLnNvdXJjZTtcblx0XHRcdFx0XHRsaW5rLnRhcmdldCA9IGlkTWFwcGluZ1tsaW5rc1tpXS50YXJnZXRdIHx8IGxpbmtzW2ldLnRhcmdldDtcblx0XHRcdFx0XHRsaW5rLndlaWdodCA9IGxpbmtzW2ldLndlaWdodDtcblx0XHRcdFx0XHRsaW5rRGF0YS5wdXNoKGxpbmspO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly9jcmVhdGluZyB0aGUgbm9kZURhdGFcblx0XHRcdFx0dmFyIG5vZGVEYXRhID0gW107XG5cdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZV9uYW1lcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdHZhciBub2RlX3RvX2FkZCA9IFtdO1xuXHRcdFx0XHRcdG5vZGVfdG9fYWRkLmlkID0gbm9kZV9uYW1lc1tpXTtcblx0XHRcdFx0XHRub2RlX3RvX2FkZC50ZXh0ID0gdGhpcy5ub2RlSWRUb05hbWUobm9kZV9uYW1lc1tpXSkgfHwgbm9kZV9uYW1lc1tpXTtcblxuXHRcdFx0XHRcdG5vZGVfdG9fYWRkLmFuY2VzdG9ycyA9IHRoaXMuYW5jZXN0b3JzX3N0cnVjdFtub2RlX25hbWVzW2ldXSB8fCB0aGlzLmFuY2VzdG9yc19zdHJ1Y3Rbbm9kZV90b19hZGQudGV4dF0gfHwgW107XG5cdFx0XHRcdFx0aWYgKF8uaXNFbXB0eShub2RlX3RvX2FkZC5hbmNlc3RvcnMpID09PSBmYWxzZSkge1xuXHRcdFx0XHRcdFx0bm9kZV90b19hZGQucGFyZW50ID0gbm9kZV90b19hZGQuYW5jZXN0b3JzWzBdO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRub2RlX3RvX2FkZC5wYXJlbnQgPSBudWxsO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRub2RlRGF0YS5wdXNoKG5vZGVfdG9fYWRkKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHVybiB7IG5vZGVEYXRhOiBub2RlRGF0YSwgbGlua0RhdGE6IGxpbmtEYXRhIH07XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogcHJvY2VzcyB0aGUgbm9kZURhdGEgb3V0cHV0IG9mIGdldEZsb3dCZXR3ZWVuU2V0XG4gICAgKlxuICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZURhdGEgIE5vZGVEYXRhIHRvIGNvbnZlcnQgXG4gICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gbm9kZSBvYmplY3RzXG4gICAgKiBAcmV0dXJuICAgICB7QXJyYXl9ICBOb2RlIG9iamVjdHNcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAncHJvY2Vzc05vZGVEYXRhJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBwcm9jZXNzTm9kZURhdGEobm9kZURhdGEpIHtcblx0XHRcdFx0dmFyIG5vZGVzID0gW107XG5cdFx0XHRcdF8uZm9yRWFjaChub2RlRGF0YSwgZnVuY3Rpb24gKGRhdGEpIHtcblx0XHRcdFx0XHR2YXIgbmV3Tm9kZSA9IG5ldyBWaXN1YWxpemVyTm9kZS5Ob2RlKG51bGwsIG51bGwsIGRhdGEuaWQsIGRhdGEudGV4dCwgbnVsbCwgZGF0YS5wYXJlbnQsIGRhdGEuYW5jZXN0b3JzLCBudWxsLCBudWxsKTtcblx0XHRcdFx0XHRub2Rlcy5wdXNoKG5ld05vZGUpO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0cmV0dXJuIG5vZGVzO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIHByb2Nlc3MgdGhlIGxpbmtEYXRhIG91dHB1dCBvZiBnZXRGbG93QmV0d2VlblNldFxuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIGxpbmtEYXRhICBUaGUgbGluayBkYXRhXG4gICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlcyAgICAgVGhlIG5vZGVzXG4gICAgKiBAcmV0dXJuICAgICB7QXJyYXl9ICBMaW5rIG9iamVjdHNcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAncHJvY2Vzc0xpbmtEYXRhJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBwcm9jZXNzTGlua0RhdGEobGlua0RhdGEsIG5vZGVzKSB7XG5cdFx0XHRcdC8qKlxuICAgICAqIFJldHVybnMgdGhlIG5vZGUgdGhhdCBtYXRjaGVzIHRoZSBpZFxuICAgICAqXG4gICAgICogQHBhcmFtICAgICAge3N0cmluZ30gaWQgICAgICBUaGUgaWRlbnRpZmllclxuICAgICAqIEByZXR1cm4gICAgIHtOb2RlfSAgIFRoZSBub2RlIHdpdGggdGhlIG1hdGNoaW5nIGlkXG4gICAgICovXG5cdFx0XHRcdGZ1bmN0aW9uIGZpbmROb2RlQnlJZChpZCwgbm9kZXMpIHtcblx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRpZiAoaWQgPT0gbm9kZXNbaV0uaWQpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIG5vZGVzW2ldO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdHZhciBsaW5rcyA9IFtdO1xuXHRcdFx0XHQvL2EgbWFwcGluZyBmcm9tIHNvdXJjZS5pZC10YXJnZXQuaWQgdG8gdGhlIGxpbmsgYWRkZWRcblx0XHRcdFx0dmFyIGFkZGVkX2xpbmtzID0ge307XG5cdFx0XHRcdC8vdHJhbnNmb3JtaW5nIGxpbmsgZGF0YVxuXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGxpbmtEYXRhLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0aWYgKGxpbmtEYXRhW2ldLnNvdXJjZSAhPSBsaW5rRGF0YVtpXS50YXJnZXQpIHtcblx0XHRcdFx0XHRcdHZhciBzb3VyY2UgPSBmaW5kTm9kZUJ5SWQobGlua0RhdGFbaV0uc291cmNlLCBub2Rlcyk7XG5cdFx0XHRcdFx0XHR2YXIgdGFyZ2V0ID0gZmluZE5vZGVCeUlkKGxpbmtEYXRhW2ldLnRhcmdldCwgbm9kZXMpO1xuXHRcdFx0XHRcdFx0dmFyIHdlaWdodCA9IGxpbmtEYXRhW2ldLndlaWdodDtcblx0XHRcdFx0XHRcdC8vaW4gb3JkZXIgdG8gc3VtIGFsbCB0aGUgd2VpZ2h0cyBvZiB0aGUgbGlua3Mgb2YgdGhlIHN1Yi1ub2Rlcyxcblx0XHRcdFx0XHRcdC8vd2UgdXNlIGFkZGVkX2xpbmtzIHRvIGtlZXAgdHJhY2sgaWYgYW4gbGluayB3YXMgYWRkZWRcblx0XHRcdFx0XHRcdC8vaWYgaXQgaXMsIHdlIG1vZGlmeSBpdHMgd2VpZ2h0XG5cdFx0XHRcdFx0XHRpZiAoc291cmNlID09IG51bGwgfHwgdGFyZ2V0ID09IG51bGwpIHtcblx0XHRcdFx0XHRcdFx0Y29udGludWU7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRpZiAoYWRkZWRfbGlua3Nbc291cmNlLmlkICsgJy0nICsgdGFyZ2V0LmlkXSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBsaW5rID0gbmV3IFZpc3VhbGl6ZXJMaW5rLkxpbmsoc291cmNlLCB0YXJnZXQsIHdlaWdodCk7XG5cdFx0XHRcdFx0XHRcdGFkZGVkX2xpbmtzW3NvdXJjZS5pZCArICctJyArIHRhcmdldC5pZF0gPSBsaW5rO1xuXHRcdFx0XHRcdFx0XHRsaW5rcy5wdXNoKGxpbmspO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0dmFyIGV4aXN0aW5nX2xpbmsgPSBhZGRlZF9saW5rc1tzb3VyY2UuaWQgKyAnLScgKyB0YXJnZXQuaWRdO1xuXHRcdFx0XHRcdFx0XHRleGlzdGluZ19saW5rLnNldFdlaWdodChleGlzdGluZ19saW5rLmdldFJhd1dlaWdodCgpICsgd2VpZ2h0KTtcblx0XHRcdFx0XHRcdFx0ZXhpc3RpbmdfbGluay5pbmNyZWFzZUNvdW50KCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBsaW5rcztcblx0XHRcdH1cblx0XHR9XSk7XG5cblx0XHRyZXR1cm4gVmlzdWFsaXplckRhdGFTb3VyY2U7XG5cdH0oRGF0YVNvdXJjZS5EYXRhU291cmNlKTtcblxuXHRyZXR1cm4ge1xuXHRcdERhdGFTb3VyY2U6IFZpc3VhbGl6ZXJEYXRhU291cmNlXG5cdH07XG59XSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuYXBwbGljYXRpb25ncm91cHMnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzJywge1xuICAgICAgICAgICAgdXJsOiAnL2FwcGxpY2F0aW9uZ3JvdXBzJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3Vwcy5jcmVhdGUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2FwcGxpY2F0aW9uZ3JvdXBjcmVhdGUnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2FwcGxpY2F0aW9uZ3JvdXBkZXRhaWxzJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3Vwcy5lZGl0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2VkaXQvOmtleScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdhcHBsaWNhdGlvbmdyb3VwZGV0YWlscydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2FwcGxpY2F0aW9uR3JvdXBsaXN0J1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZGFzaGJvYXJkJywgWydjb250aXYubW9kZWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmRhc2hib2FyZCcsIHtcbiAgICAgICAgICAgIHVybDogJy9kYXNoYm9hcmQnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnZGFzaGJvYXJkJ1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbi8qKlxuICogVGhlIGJhc2UgY2xhc3MgdGhlIGdyYXBoIG9iamVjdC4gQW55IG5vZGVzIG9yIGxpbmtzIHRoYXQgYXJlIGNvbnRhaW5lZCBpblxuICogaXRzIG5vZGVzIG9yIGxpbmtzIHByb3BlcnR5IHdpbGwgYmUgZHJhd24gb24gdXBkYXRlR3JhcGguXG4gKiBTdXBwb3J0cyBwb2xpY2llcy5cbiAqIFxuICogVG8gd3JpdGUgeW91ciBvd24gZ3JhcGggb2JqZWN0LCBjcmVhdGUgYSBuZXcgZmFjdG9yeSB0aGF0IHVzZXMgdGhlIGdyYXBoXG4gKiB5b3Ugd2FudCB0byBpbmhlcml0IGFzIGEgZGVwZW5kZW5jeSwgYW5kIGV4dGVuZCBpdHMgZ3JhcGggY2xhc3MuIFxuICogUmV0dXJuIHRoZSBjbGFzcyBvYmplY3Qgd2l0aCBHcmFwaCBhcyBrZXkuXG4gKiBcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ0dyYXBoJywgWydQb2xpY3lTZXJ2aWNlJywgZnVuY3Rpb24gKFBvbGljeVNlcnZpY2UpIHtcbiAgICB2YXIgR3JhcGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBjb25zdHJ1Y3RvciBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtIVE1MIFNWR30gIHN2ZyAgICAgVGhlIHN2ZyB0aGF0IHdpbGwgXG4gICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9sZCB0aGUgZ3JhcGhcbiAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZXMgICAgICBMaXN0IG9mIG5vZGVzIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbGlua3MgICAgICBMaXN0IG9mIGxpbmtzIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIEdyYXBoKHN2Zywgbm9kZXMsIGxpbmtzKSB7XG4gICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgR3JhcGgpO1xuXG4gICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzID0gbm9kZXMgfHwgW107XG4gICAgICAgICAgICB0aGlzR3JhcGgubGlua3MgPSBsaW5rcyB8fCBbXTtcblxuICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMgPSBbXTtcbiAgICAgICAgICAgIHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzID0gW107XG5cbiAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3kgPSBuZXcgUG9saWN5U2VydmljZS5Qb2xpY3koKTtcblxuICAgICAgICAgICAgdGhpc0dyYXBoLnN0YXRlID0ge1xuICAgICAgICAgICAgICAgIGNhblpvb206IHRydWUsXG4gICAgICAgICAgICAgICAgY2FuUGFuOiB0cnVlLFxuICAgICAgICAgICAgICAgIGluaXRGb3JjZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgZGlzYWJsZVVwZGF0ZTogZmFsc2VcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHRoaXNHcmFwaC5jb25zdHMgPSB7XG4gICAgICAgICAgICAgICAgY2lyY2xlR0NsYXNzOiBcImNvbmNlcHRHXCIsXG4gICAgICAgICAgICAgICAgZ3JhcGhDbGFzczogXCJncmFwaFwiLFxuICAgICAgICAgICAgICAgIHBhdGhDbGFzczogXCJwYXRoXCIsXG4gICAgICAgICAgICAgICAgbm9kZUNsYXNzOiBcImNpcmNsZVwiLFxuICAgICAgICAgICAgICAgIG5vZGVUZXh0OiBcIm5vZGVUZXh0XCIsXG4gICAgICAgICAgICAgICAgc3RhcnRSYWRpdXM6IDUwLFxuICAgICAgICAgICAgICAgIG1heFJhZGl1czogNjAsXG4gICAgICAgICAgICAgICAgcGFkZGluZzogNSxcbiAgICAgICAgICAgICAgICBkaXNwbGF5T2Zmc2V0OiA2MFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgc3ZnLm9uKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcIm1vdXNlb3ZlclwiXS5jYWxsKHRoaXMsIGQpO1xuICAgICAgICAgICAgfSkub24oXCJkYmxjbGlja1wiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3lbXCJkYmxjbGlja1wiXS5jYWxsKHRoaXMsIGQpO1xuICAgICAgICAgICAgfSkub24oXCJjb250ZXh0bWVudVwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3lbXCJjb250ZXh0bWVudVwiXS5jYWxsKHRoaXMsIGQpO1xuICAgICAgICAgICAgfSkub24oXCJtb3VzZW91dFwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3lbXCJtb3VzZW91dFwiXS5jYWxsKHRoaXMsIGQpO1xuICAgICAgICAgICAgfSkub24oXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wibW91c2Vkb3duXCJdLmNhbGwodGhpcywgZCk7XG4gICAgICAgICAgICB9KS5vbihcIm1vdXNldXBcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wibW91c2V1cFwiXS5jYWxsKHRoaXMsIGQpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIGRlZmluZSBhcnJvdyBtYXJrZXJzIGZvciBncmFwaCBsaW5rc1xuICAgICAgICAgICAgdmFyIGRlZnMgPSBzdmcuYXBwZW5kKCdzdmc6ZGVmcycpO1xuICAgICAgICAgICAgZGVmcy5hcHBlbmQoJ3N2ZzptYXJrZXInKS5hdHRyKCdpZCcsICdlbmQtYXJyb3cnKS5hdHRyKFwidmlld0JveFwiLCBcIjAgLTUgMTAgMTBcIikuYXR0cihcInJlZlhcIiwgMjApLmF0dHIoXCJyZWZZXCIsIC0xKS5hdHRyKFwibWFya2VyV2lkdGhcIiwgNikuYXR0cihcIm1hcmtlckhlaWdodFwiLCA2KS5hdHRyKFwib3JpZW50XCIsIFwiYXV0b1wiKS5hcHBlbmQoXCJwYXRoXCIpLmF0dHIoXCJkXCIsIFwiTTAsLTVMMTAsMEwwLDVcIik7XG5cbiAgICAgICAgICAgIC8vIGRlZmluZSBhcnJvdyBtYXJrZXJzIGZvciBsZWFkaW5nIGFycm93XG4gICAgICAgICAgICBkZWZzLmFwcGVuZCgnc3ZnOm1hcmtlcicpLmF0dHIoJ2lkJywgJ21hcmstZW5kLWFycm93JykuYXR0cigndmlld0JveCcsICcwIC01IDEwIDEwJykuYXR0cigncmVmWCcsIDcpLmF0dHIoJ21hcmtlcldpZHRoJywgMy41KS5hdHRyKCdtYXJrZXJIZWlnaHQnLCAzLjUpLmF0dHIoJ29yaWVudCcsICdhdXRvJykuYXBwZW5kKCdzdmc6cGF0aCcpLmF0dHIoJ2QnLCAnTTAsLTVMMTAsMEwwLDUnKTtcblxuICAgICAgICAgICAgdGhpc0dyYXBoLnN2ZyA9IHN2ZztcbiAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdHID0gc3ZnLmFwcGVuZChcImdcIikuY2xhc3NlZCh0aGlzR3JhcGguY29uc3RzLmdyYXBoQ2xhc3MsIHRydWUpO1xuICAgICAgICAgICAgdmFyIHN2Z0cgPSB0aGlzR3JhcGguc3ZnRztcblxuICAgICAgICAgICAgLy8gc3ZnIG5vZGVzIGFuZCBsaW5rcyBcbiAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocyA9IHN2Z0cuYXBwZW5kKFwiZ1wiKS5zZWxlY3RBbGwoXCJnXCIpO1xuICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMgPSBzdmdHLmFwcGVuZChcImdcIikuc2VsZWN0QWxsKFwiZ1wiKTtcbiAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0Tm9kZXMoKTtcbiAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0TGlua3MoKTtcblxuICAgICAgICAgICAgdGhpc0dyYXBoLnNldFBvc2l0aW9ucygpO1xuICAgICAgICAgICAgdmFyIHJlc2l6ZUZ1bmMgPSBmdW5jdGlvbiByZXNpemVGdW5jKCkge1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5vbldpbmRvd1Jlc2l6ZShzdmcpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdGhpc0dyYXBoLmJpbmRpbmdzID0ge1xuICAgICAgICAgICAgICAgIHJlc2l6ZTogcmVzaXplRnVuY1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICQod2luZG93KS5yZXNpemUocmVzaXplRnVuYyk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogY2FsbHMgdGhlIGRlc3Ryb3kgbWV0aG9kIGZvciBhbGwgcG9saWNpZXNcbiAgICAgICAgICovXG5cblxuICAgICAgICBfY3JlYXRlQ2xhc3MoR3JhcGgsIFt7XG4gICAgICAgICAgICBrZXk6ICdkZXN0cm95JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3kuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3kuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3kuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzR3JhcGguYmluZGluZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgJCh3aW5kb3cpLm9mZihrZXksIHRoaXNHcmFwaC5iaW5kaW5nc1trZXldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUnVucyB0aGUgaW5pdCBmdW5jdGlvbiBmb3IgYWxsIHRoZSBub2Rlc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnaW5pdE5vZGVzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0Tm9kZXMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUnVucyB0aGUgaW5pdCBmdW5jdGlvbiBmb3IgYWxsIHRoZSBsaW5rc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnaW5pdExpbmtzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0TGlua3MoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5saW5rcywgZnVuY3Rpb24gKGxpbmspIHtcbiAgICAgICAgICAgICAgICAgICAgbGluay5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogcmV0dXJucyB0aGUgbm9kZSBtYXRjaGluZyB0aGUgaWQsIFxuICAgICAgICAgICAgICogb3IgdW5kZWZpbmVkIGlmIHRoZXJlIGlzIG5vbmVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgaWQgICAgICBUaGUgaWRlbnRpZmllclxuICAgICAgICAgICAgICogQHJldHVybiAgICAge05vZGV9ICB7IG1hdGNoaW5nIG5vZGUgfVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZmluZE5vZGVCeUlkJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBmaW5kTm9kZUJ5SWQoaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXNHcmFwaC5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaWQgPT09IHRoaXNHcmFwaC5ub2Rlc1tpXS5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNHcmFwaC5ub2Rlc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZmluZEQzTm9kZScsXG5cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZXR1cm5zIHRoZSBkM05vZGUgb2JqZWN0IHRoYXQgbWF0Y2hlcyB0aGUgaWQsXG4gICAgICAgICAgICAgKiBvciB1bmRlZmluZWQgaWYgdGhlcmUgaXMgbm9uZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7RDNOb2RlfSBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZmluZEQzTm9kZShpZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBkM05vZGU7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZWFjaChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5pZCA9PT0gaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQzTm9kZSA9IGQzLnNlbGVjdCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkM05vZGU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byBpbnN0YWxsIGEgZHJhZyBwb2xpY3kgdGhhdCB3aWxsIGJlIGNhbGxlZFxuICAgICAgICAgICAgICogd2hlbiBub2RlcyBhcmUgZHJhZ2dlZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkMy5iZWhhdmlvci5kcmFnfSAgZDNkcmFnICBEMyBkcmFnIG9iamVjdFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnaW5zdGFsbERyYWdQb2xpY3knLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluc3RhbGxEcmFnUG9saWN5KGQzZHJhZykge1xuICAgICAgICAgICAgICAgIHRoaXMuZHJhZyA9IGQzZHJhZztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIGluc3RhbGwgYSBwb2xpY3kgdGhhdCB3aWxsIGJlIGNhbGxlZCBcbiAgICAgICAgICAgICAqIHdoZW4gdGhlcmUgaXMgbW91c2UgaW50ZXJhY3Rpb25zIHdpdGggdGhlIGdyYXBoJ3Mgc3ZnXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeSAgVGhlIHBvbGljeSB0byBpbnN0YWxsXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdpbnN0YWxsU3ZnUG9saWN5JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbnN0YWxsU3ZnUG9saWN5KHBvbGljeSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3ZnUG9saWN5ID0gcG9saWN5O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVzZWQgdG8gaW5zdGFsbCBwb2xpY2llcyB0aGF0IGFyZSBjYWxsZWQgd2hlbiB0aGVyZSBpc1xuICAgICAgICAgICAgICogbW91c2UgaW50ZXJhY3Rpb24gd2l0aCBhIG5vZGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UG9saWN5fSAgcG9saWN5ICBUaGUgcG9saWN5IHRvIGluc3RhbGxcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2luc3RhbGxEZWZhdWx0Tm9kZVBvbGljeScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5zdGFsbERlZmF1bHROb2RlUG9saWN5KHBvbGljeSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzLnB1c2gocG9saWN5KTtcbiAgICAgICAgICAgICAgICBwb2xpY3kuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVzZWQgdG8gcmVtb3ZlIGFuIGluc3RhbGxlZCBwb2xpY3kgZm9yIG5vZGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBwb2xpY3lSZW1vdmUgIFRoZSBwb2xpY3kgdG8gcmVtb3ZlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd1bmluc3RhbGxEZWZhdWx0Tm9kZVBvbGljeScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdW5pbnN0YWxsRGVmYXVsdE5vZGVQb2xpY3kocG9saWN5UmVtb3ZlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBvbGljeVJlbW92ZU5hbWU7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBwb2xpY3lSZW1vdmUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZS5wb2xpY3lOYW1lO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3ksIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb2xpY3kucG9saWN5TmFtZSA9PT0gcG9saWN5UmVtb3ZlTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9saWN5LmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZXR1cm5zIHRoZSBub2RlIHBvbGljeSBvYmplY3Qgd2l0aCB0aGUgZ2l2ZW4gbmFtZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBwb2xpY3lOYW1lICBUaGUgcG9saWN5IG5hbWVcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtQb2xpY3l9ICBwb2xpY3kgICAgICBUaGUgbWF0Y2hpbmcgcG9saWN5XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdnZXROb2RlUG9saWN5JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXROb2RlUG9saWN5KHBvbGljeU5hbWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24gKHBvbGljeSwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvbGljeS5wb2xpY3lOYW1lID09PSBwb2xpY3lOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcG9saWN5O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byBpbnN0YWxsIHBvbGljaWVzIHRoYXQgYXJlIGNhbGxlZCB3aGVuIHRoZXJlIGlzIGFcbiAgICAgICAgICAgICAqIG1vdXNlIGludGVyYWN0aW9uIHdpdGggYSBwYXRoXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeSAgVGhlIHBvbGljeSB0byBpbnN0YWxsXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdpbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3knLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluc3RhbGxEZWZhdWx0UGF0aFBvbGljeShwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcy5wdXNoKHBvbGljeSk7XG4gICAgICAgICAgICAgICAgcG9saWN5LmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIHJlbW92ZSBhbiBpbnN0YWxsZWQgcG9saWN5IGZvciBsaW5rc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3lSZW1vdmUgIFRoZSBwb2xpY3kgdG8gcmVtb3ZlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd1bmluc3RhbGxEZWZhdWx0UGF0aFBvbGljeScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdW5pbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3kocG9saWN5UmVtb3ZlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBvbGljeVJlbW92ZU5hbWU7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBwb2xpY3lSZW1vdmUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZS5wb2xpY3lOYW1lO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3ksIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb2xpY3kucG9saWN5TmFtZSA9PT0gcG9saWN5UmVtb3ZlTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9saWN5LmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGVyZSBpcyBhIG1vdXNlIGludGVyYWN0aW9uIHdpdGggYSBwYXRoXG4gICAgICAgICAgICAgKiBQcm9wb2dhdGVzIHRoZSBldmVudCB0byBhbGwgaW5zdGFsbGVkIHBhdGggcG9saWNpZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgZXZlbnQgICBUaGUgZXZlbnQgdHlwZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2Qzb2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BhdGh9ICBkICAgICAgIFRoZSBtYXRjaGluZyBMaW5rIG9iamVjdFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAncGF0aFBvbGljeUV2ZW50JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwYXRoUG9saWN5RXZlbnQoZXZlbnQsIGQzcGF0aCwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lbZXZlbnRdKGQzcGF0aCwgZCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlcmUgaXMgYSBtb3VzZSBpbnRlcmFjdGlvbiB3aXRoIGEgbm9kZVxuICAgICAgICAgICAgICogUHJvcG9nYXRlcyB0aGUgZXZlbnQgdG8gYWxsIGluc3RhbGxlZCBub2RlIHBvbGljaWVzXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBldmVudCAgIFRoZSBldmVudCB0eXBlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7ZDNvYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UGF0aH0gIGQgICAgICAgVGhlIG1hdGNoaW5nIE5vZGUgb2JqZWN0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdub2RlUG9saWN5RXZlbnQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG5vZGVQb2xpY3lFdmVudChldmVudCwgZDNub2RlLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzLCBmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVtldmVudF0oZDNub2RlLCBkKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTZXRzIHBhbiBhbmQgem9vbSBydWxlcyBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzLmJlaGF2aW9yLnpvb219ICBkM3pvb20gIEQzIHpvb20gb2JqXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdpbnN0YWxsWm9vbVBvbGljeScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5zdGFsbFpvb21Qb2xpY3koZDN6b29tKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kcmFnU3ZnID0gZDN6b29tO1xuICAgICAgICAgICAgICAgIHRoaXMuc3ZnLmNhbGwodGhpcy5kcmFnU3ZnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgd2luZG93IGlzIHJlc2l6ZWRcbiAgICAgICAgICAgICAqIEhvb2sgZm9yIG92ZXJyaWRpbmcgaW4gc3ViY2xhc3Nlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtIVE1MIFNWR30gIHN2ZyAgICAgVGhlIHN2ZyB0aGF0IHRoZSBoYW5kbGVyXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzIGF0dGFjaGVkIHRvXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdvbldpbmRvd1Jlc2l6ZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb25XaW5kb3dSZXNpemUoc3ZnKSB7fVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEluc2VydHMgbGluZSBicmVha3MgaW4gbm9kZSB0ZXh0XG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0hUTUwgRWxlbX0gIGdFbCAgICBUaGUgZWxlbSB0byBhZGQgdGV4dCB0b1xuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHRpdGxlICAgVGhlIHRpdGxlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdpbnNlcnRUaXRsZUxpbmVicmVha3MnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluc2VydFRpdGxlTGluZWJyZWFrcyhnRWwsIHRpdGxlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHdvcmRzID0gdGl0bGUuc3BsaXQoL1xccysvZyksXG4gICAgICAgICAgICAgICAgICAgIG53b3JkcyA9IHdvcmRzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB2YXIgZWwgPSBnRWwuYXBwZW5kKFwidGV4dFwiKS5hdHRyKCdjbGFzcycsIHRoaXNHcmFwaC5jb25zdHMubm9kZVRleHQpLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcIm1pZGRsZVwiKS5hdHRyKFwiZHlcIiwgXCItXCIgKyAobndvcmRzIC0gMSkgKiA3LjUpO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB3b3Jkcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdHNwYW4gPSBlbC5hcHBlbmQoJ3RzcGFuJykudGV4dCh3b3Jkc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpID4gMCkgdHNwYW4uYXR0cigneCcsIDApLmF0dHIoJ2R5JywgJzE1Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJlbW92ZXMgYWxsIGxpbmtzIGZyb20gdGhlIGdpdmVuIG5vZGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3NwbGljZUxpbmtzRm9yTm9kZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3BsaWNlTGlua3NGb3JOb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgdG9TcGxpY2UgPSB0aGlzR3JhcGgubGlua3MuZmlsdGVyKGZ1bmN0aW9uIChsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBsLnNvdXJjZSA9PT0gbm9kZSB8fCBsLnRhcmdldCA9PT0gbm9kZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0b1NwbGljZS5tYXAoZnVuY3Rpb24gKGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzLnNwbGljZSh0aGlzR3JhcGgubGlua3MuaW5kZXhPZihsKSwgMSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQWRkcyB0aGUgbm9kZSB0byB0aGUgZ3JhcGggYW5kIHVwZGF0ZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2FkZE5vZGUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZE5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgIG5vZGUuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdyZW1vdmVOb2RlJyxcblxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJlbW92ZXMgdGhlIG5vZGUgdG8gdGhlIGdyYXBoIGFuZCB1cGRhdGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBub2RlICAgIFRoZSBub2RlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVOb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMuc3BsaWNlKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG5vZGUpLCAxKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3BsaWNlTGlua3NGb3JOb2RlKG5vZGUpO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2FkZExpbmsnLFxuXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQWRkcyB0aGUgbGluayB0byB0aGUgZ3JhcGggYW5kIHVwZGF0ZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bGlua30gIGxpbmsgICAgVGhlIGxpbmtcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZExpbmsobGluaykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcy5wdXNoKGxpbmspO1xuICAgICAgICAgICAgICAgIGxpbmsuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdyZW1vdmVMaW5rJyxcblxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJlbW92ZXMgdGhlIGxpbmsgdG8gdGhlIGdyYXBoIGFuZCB1cGRhdGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2xpbmt9ICBsaW5rICAgIFRoZSBsaW5rXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVMaW5rKGxpbmspIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3Muc3BsaWNlKHRoaXNHcmFwaC5saW5rcy5pbmRleE9mKGxpbmspLCAxKTtcbiAgICAgICAgICAgICAgICBsaW5rLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgdXBkYXRpbmcgZXhpc3RpbmcgcGF0aHNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UGF0aH0gIHBhdGhzICAgTGlzdCBvZiBwYXRoc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAndXBkYXRlRXhpc3RpbmdQYXRocycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlRXhpc3RpbmdQYXRocyhwYXRocykge1xuICAgICAgICAgICAgICAgIHBhdGhzLmVhY2goZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC51cGRhdGVBdHRyKGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIGFkZGluZyBuZXcgcGF0aHNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UGF0aH0gIG5ld1BhdGhzICBMaXN0IG9mIG5ldyBwYXRoc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAndXBkYXRlTmV3UGF0aHMnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZU5ld1BhdGhzKG5ld1BhdGhzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdExpbmtzKCk7XG5cbiAgICAgICAgICAgICAgICBuZXdQYXRocy5lYWNoKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGQubmV3UGF0aEF0dHIoZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vaWYgbm9kZSBkb2Vzbid0IGhhdmUgaXRzIG93biBwb2xpY3ksIHVzZSBkZWZhdWx0IGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAgICBuZXdQYXRocy5vbihcIm1vdXNlb3ZlclwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQucGF0aFBvbGljeUV2ZW50KFwibW91c2VvdmVyXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aFBvbGljeUV2ZW50KFwibW91c2VvdmVyXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5vbihcImRibGNsaWNrXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJkYmxjbGlja1wiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcImRibGNsaWNrXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5vbihcImNvbnRleHRtZW51XCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJjb250ZXh0bWVudVwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcImNvbnRleHRtZW51XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5vbihcIm1vdXNlb3V0XCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZW91dFwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlb3V0XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5vbihcIm1vdXNlZG93blwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQucGF0aFBvbGljeUV2ZW50KFwibW91c2Vkb3duXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aFBvbGljeUV2ZW50KFwibW91c2Vkb3duXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5vbihcIm1vdXNldXBcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLnBhdGhQb2xpY3lFdmVudChcIm1vdXNldXBcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZXVwXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXNHcmFwaC5kcmFnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgdXBkYXRpbmcgZXhpc3Rpbmcgbm9kZXNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3VwZGF0ZUV4aXN0aW5nTm9kZXMnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUV4aXN0aW5nTm9kZXMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMgPSB0aGlzLmNpcmNsZXMuZGF0YSh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLmlkO1xuICAgICAgICAgICAgICAgIH0pLmVhY2goZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC51cGRhdGVBdHRyKGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIGFkZGluZyBuZXcgbm9kZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5ld05vZGVzICBMaXN0IG9mIG5ldyBub2Rlc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAndXBkYXRlTmV3Tm9kZXMnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZU5ld05vZGVzKG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICBuZXdOb2Rlcy5lYWNoKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmdyYXBoID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGQubmV3Tm9kZUF0dHIoZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vaWYgbm9kZSBkb2Vzbid0IGhhdmUgaXRzIG93biBwb2xpY3ksIHVzZSBkZWZhdWx0IGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAgICBuZXdOb2Rlcy5vbihcIm1vdXNlb3ZlclwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQubm9kZVBvbGljeUV2ZW50KFwibW91c2VvdmVyXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwibW91c2VvdmVyXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5vbihcImRibGNsaWNrXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5ub2RlUG9saWN5RXZlbnQoXCJkYmxjbGlja1wiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcImRibGNsaWNrXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5vbihcImNvbnRleHRtZW51XCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5ub2RlUG9saWN5RXZlbnQoXCJjb250ZXh0bWVudVwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcImNvbnRleHRtZW51XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5vbihcIm1vdXNlb3V0XCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5ub2RlUG9saWN5RXZlbnQoXCJtb3VzZW91dFwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlb3V0XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5vbihcIm1vdXNlZG93blwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQubm9kZVBvbGljeUV2ZW50KFwibW91c2Vkb3duXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwibW91c2Vkb3duXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5vbihcIm1vdXNldXBcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcIm1vdXNldXBcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlUG9saWN5RXZlbnQoXCJtb3VzZXVwXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXNHcmFwaC5kcmFnKTtcblxuICAgICAgICAgICAgICAgIG5ld05vZGVzLmFwcGVuZChcImNpcmNsZVwiKS5hdHRyKFwiclwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gU3RyaW5nKGQucmFkaXVzKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIG5ld05vZGVzLmVhY2goZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluc2VydFRpdGxlTGluZWJyZWFrcyhkMy5zZWxlY3QodGhpcyksIGQudGV4dCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUHJldmVudHMgbm9kZXMgZnJvbSBjb2xsaWRpbmdcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgYWxwaGEgICBBZmZlY3RzIGhvdyBtdWNoIGNoYW5nZVxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlIGNvbGxpc2lvbiBjYXVzZXNcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtib29sZWFufSAge1doZXRoZXIgbm9kZXMgYXJlIGNvbGxpZGVkfVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZDNGb3JjZUNvbGxpZGUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGQzRm9yY2VDb2xsaWRlKGFscGhhKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHM7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgICAgIHZhciBxdWFkdHJlZSA9IGQzLmdlb20ucXVhZHRyZWUobm9kZXMpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgciA9IGQucmFkaXVzICsgY29uc3RzLm1heFJhZGl1cyArIGNvbnN0cy5wYWRkaW5nLFxuICAgICAgICAgICAgICAgICAgICAgICAgbngxID0gZC54IC0gcixcbiAgICAgICAgICAgICAgICAgICAgICAgIG54MiA9IGQueCArIHIsXG4gICAgICAgICAgICAgICAgICAgICAgICBueTEgPSBkLnkgLSByLFxuICAgICAgICAgICAgICAgICAgICAgICAgbnkyID0gZC55ICsgcjtcbiAgICAgICAgICAgICAgICAgICAgcXVhZHRyZWUudmlzaXQoZnVuY3Rpb24gKHF1YWQsIHgxLCB5MSwgeDIsIHkyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocXVhZC5wb2ludCAmJiBxdWFkLnBvaW50ICE9PSBkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHggPSBkLnggLSBxdWFkLnBvaW50LngsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHkgPSBkLnkgLSBxdWFkLnBvaW50LnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwgPSBNYXRoLnNxcnQoeCAqIHggKyB5ICogeSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIgPSBkLnJhZGl1cyArIHF1YWQucG9pbnQucmFkaXVzICsgY29uc3RzLnBhZGRpbmc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGwgPCByKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwgPSAobCAtIHIpIC8gbCAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnggLT0geCAqPSBsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgLT0geSAqPSBsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWFkLnBvaW50LnggKz0geDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVhZC5wb2ludC55ICs9IHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHgxID4gbngyIHx8IHgyIDwgbngxIHx8IHkxID4gbnkyIHx8IHkyIDwgbnkxO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRpY2sgb2YgdGhlIGQzIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDN0aWNrIGV2ZW50fSAgZSAgICBEM3RpY2sgZXZlbnRcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB3aWR0aCAgVGhlIHdpZHRoIG9mIHRoZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgaGVpZ2h0IFRoZSBoZWlnaHQgb2YgdGhlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2QzRm9yY2VUaWNrJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkM0ZvcmNlVGljayhlLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHM7XG5cbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gY29uc3RzLmRpc3BsYXlPZmZzZXQ7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgICAgIHZhciBxID0gZDMuZ2VvbS5xdWFkdHJlZSh0aGlzR3JhcGgubm9kZXMpLFxuICAgICAgICAgICAgICAgICAgICBpID0gMCxcbiAgICAgICAgICAgICAgICAgICAgbiA9IG5vZGVzLmxlbmd0aDtcblxuICAgICAgICAgICAgICAgIHdoaWxlICgrK2kgPCBuKSB7XG4gICAgICAgICAgICAgICAgICAgIHEudmlzaXQodGhpcy5kM0ZvcmNlQ29sbGlkZShub2Rlc1tpXSkpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2godGhpcy5kM0ZvcmNlQ29sbGlkZSguNSkpLmF0dHIoXCJjeFwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC54ID0gTWF0aC5tYXgoZC5yYWRpdXMgKyBvZmZzZXQsIE1hdGgubWluKHdpZHRoIC0gb2Zmc2V0IC0gZC5yYWRpdXMsIGQueCkpO1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoXCJjeVwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55ID0gTWF0aC5tYXgoZC5yYWRpdXMgKyBvZmZzZXQsIE1hdGgubWluKGhlaWdodCAtIG9mZnNldCAtIGQucmFkaXVzLCBkLnkpKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocy5hdHRyKCd4MScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnNvdXJjZS54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3kxJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuc291cmNlLnk7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneDInLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC50YXJnZXQueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd5MicsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnRhcmdldC55O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFN0YXJ0cyBvbiBzdGFydCBvZiB0aGUgZm9yY2Ugc2ltdWxhdGlvblxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZDNGb3JjZVN0YXJ0JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkM0ZvcmNlU3RhcnQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzLmF0dHIoJ3gxJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuc291cmNlLng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneTEnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5zb3VyY2UueTtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd4MicsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnRhcmdldC54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3kyJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQudGFyZ2V0Lnk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIG9uIHRoZSBlbmQgb2YgdGhlIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2QzRm9yY2VFbmQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGQzRm9yY2VFbmQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuYXR0cignY3gnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ2N5JywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocy5hdHRyKCd4MScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnNvdXJjZS54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3kxJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuc291cmNlLnk7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneDInLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC50YXJnZXQueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd5MicsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnRhcmdldC55O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGN1bGF0ZXMgdGhlIHdpZHRoIGFuZCBoZWlnaHQgYm91bmRzIGZvciB0aGUgXG4gICAgICAgICAgICAgKiBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHJldHVybiAgICAge09iamVjdH0gIHdpZHRoIGFuZCBoZWlnaHQgYXMgcHJvcGVydGllcyBcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2QzRm9yY2VCb3VuZHMnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGQzRm9yY2VCb3VuZHMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z1dpZHRoID0gJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS53aWR0aCgpO1xuICAgICAgICAgICAgICAgIHZhciBzdmdIZWlnaHQgPSAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLmhlaWdodCgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gc3ZnV2lkdGg7XG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IHN2Z0hlaWdodDtcbiAgICAgICAgICAgICAgICByZXR1cm4geyB3aWR0aDogd2lkdGgsIGhlaWdodDogaGVpZ2h0IH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogRG9lcyBhIGQzIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RnVuY3Rpb259ICBjYWxsYmFjayAgVGhlIGNhbGxiYWNrXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdzZXRGb3JjZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0Rm9yY2UoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXNHcmFwaC5ub2RlcztcbiAgICAgICAgICAgICAgICB2YXIgbGlua3MgPSB0aGlzR3JhcGgubGlua3M7XG4gICAgICAgICAgICAgICAgaWYgKF8uaXNFbXB0eShub2RlcykpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBib3VuZHMgPSB0aGlzR3JhcGguZDNGb3JjZUJvdW5kcygpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGZvcmNlID0gZDMubGF5b3V0LmZvcmNlKCkuc2l6ZShbYm91bmRzLndpZHRoLCBib3VuZHMuaGVpZ2h0XSkubm9kZXMobm9kZXMpLmNoYXJnZShmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTYwMDA7XG4gICAgICAgICAgICAgICAgfSkubGlua3MobGlua3MpO1xuXG4gICAgICAgICAgICAgICAgZm9yY2UubGlua0Rpc3RhbmNlKGJvdW5kcy53aWR0aCAvIDMpO1xuICAgICAgICAgICAgICAgIGZvcmNlLmxpbmtTdHJlbmd0aCguMik7XG4gICAgICAgICAgICAgICAgZm9yY2UuZ3Jhdml0eSguMik7XG5cbiAgICAgICAgICAgICAgICBmb3JjZS5vbigndGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kM0ZvcmNlVGljay5jYWxsKHRoaXNHcmFwaCwgZSwgYm91bmRzLndpZHRoLCBib3VuZHMuaGVpZ2h0KTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGZvcmNlLm9uKCdzdGFydCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLmQzRm9yY2VTdGFydC5jYWxsKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBmb3JjZS5vbignZW5kJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguZDNGb3JjZUVuZC5jYWxsKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBmb3JjZS5zdGFydCgpO1xuICAgICAgICAgICAgICAgIHZhciBrID0gMDtcbiAgICAgICAgICAgICAgICB3aGlsZSAoZm9yY2UuYWxwaGEoKSA+IDFlLTIgJiYgayA8IDE1MCkge1xuICAgICAgICAgICAgICAgICAgICBmb3JjZS50aWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIGsgPSBrICsgMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yY2Uuc3RvcCgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU2V0cyB0aGUgcG9zaXRpb25zIHRvIGJlIHRoZSBjZW50ZXIgb2YgdGhlIHNjcmVlbiBpZiBcbiAgICAgICAgICAgICAqIG5vdCBwcm92aWRlZFxuICAgICAgICAgICAgICogYWxzbyBzZXRzIHRoZSByYWRpdXMgb2YgdGhlIG5vZGVzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdzZXRQb3NpdGlvbnMnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldFBvc2l0aW9ucygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSB0aGlzR3JhcGguY29uc3RzLmRpc3BsYXlPZmZzZXQ7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z1dpZHRoID0gJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS53aWR0aCgpO1xuICAgICAgICAgICAgICAgIHZhciBzdmdIZWlnaHQgPSAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLmhlaWdodCgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gc3ZnV2lkdGggLSAyICogb2Zmc2V0O1xuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBzdmdIZWlnaHQgLSAyICogb2Zmc2V0O1xuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBub2Rlc1tpXS5yYWRpdXMgPSBub2Rlc1tpXS5yYWRpdXMgfHwgdGhpc0dyYXBoLmNvbnN0cy5zdGFydFJhZGl1cztcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGVzW2ldLnggPT0gbnVsbCB8fCBub2Rlc1tpXS55ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5vZGVzW2ldLnhTdGFydCA9IHdpZHRoLzIgICsgbm9kZXNbaV0ucmFkaXVzICsgb2Zmc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1tpXS54ID0gd2lkdGggLyAyICsgbm9kZXNbaV0ucmFkaXVzICsgb2Zmc2V0O1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm9kZXNbaV0ueVN0YXJ0ID0gaGVpZ2h0LzIgKyBub2Rlc1tpXS5yYWRpdXMgKyBvZmZzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzW2ldLnkgPSBoZWlnaHQgLyAyICsgbm9kZXNbaV0ucmFkaXVzICsgb2Zmc2V0O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB0byB1cGRhdGUgdGhlIHZpZXcgb2YgdGhlIGdyYXBoIHdoZW5cbiAgICAgICAgICAgICAqIGRhdGEgY2hhbmdlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtGdW5jdGlvbn0gIGNhbGxiYWNrICBUaGUgY2FsbGJhY2tcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3VwZGF0ZUdyYXBoJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVHcmFwaChjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGguc3RhdGUuZGlzYWJsZVVwZGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVFeGlzdGluZ05vZGVzKCk7XG4gICAgICAgICAgICAgICAgdmFyIG5ld0dzID0gdGhpc0dyYXBoLmNpcmNsZXMuZW50ZXIoKS5hcHBlbmQoXCJnXCIpO1xuXG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ3VwZGF0ZScsIG5ld0dzKTtcbiAgICAgICAgICAgICAgICBuZXdHcy5jbGFzc2VkKGNvbnN0cy5jaXJjbGVHQ2xhc3MsIHRydWUpO1xuXG4gICAgICAgICAgICAgICAgLy8gdGhpcy51cGRhdGVOZXdOb2RlcyhuZXdHcyk7XG5cbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgb2xkIG5vZGVzXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZXhpdCgpLnJlbW92ZSgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmluaXRGb3JjZSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc2V0Rm9yY2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZU5ld05vZGVzLmNhbGwodGhpc0dyYXBoLCBuZXdHcyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5pbml0Rm9yY2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlTmV3Tm9kZXMobmV3R3MpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocyA9IHRoaXNHcmFwaC5wYXRocy5kYXRhKHRoaXNHcmFwaC5saW5rcywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFN0cmluZyhkLnNvdXJjZS5pZCkgKyBcIitcIiArIFN0cmluZyhkLnRhcmdldC5pZCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdmFyIHBhdGhzID0gdGhpc0dyYXBoLnBhdGhzO1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRXhpc3RpbmdQYXRocyhwYXRocyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbmV3cGF0aHMgPSBwYXRocy5lbnRlcigpLmFwcGVuZChcInBhdGhcIikuc3R5bGUoJ21hcmtlci1lbmQnLCAndXJsKCNlbmQtYXJyb3cpJykuY2xhc3NlZChcImxpbmtcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVOZXdQYXRocyhuZXdwYXRocyk7XG5cbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgb2xkIGxpbmtzXG4gICAgICAgICAgICAgICAgcGF0aHMuZXhpdCgpLnJlbW92ZSgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1dKTtcblxuICAgICAgICByZXR1cm4gR3JhcGg7XG4gICAgfSgpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgR3JhcGg6IEdyYXBoXG4gICAgfTtcbn1dKTtcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5sb2dpbicsIFsnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5sb2dpbicsIHtcbiAgICAgICAgICAgIHVybDogJy8nLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnbG9naW4nXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5tZW51JywgW10pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtwb2xpY2llcycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzJywge1xuICAgICAgICAgICAgdXJsOiAnL25ldHdvcmtwb2xpY2llcycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbicsIHtcbiAgICAgICAgICAgIHVybDogJy9pc29sYXRpb24nLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzx1aS12aWV3Lz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5pc29sYXRpb24uY3JlYXRlJywge1xuICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdpc29sYXRpb25wb2xpY3ljcmVhdGUnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5pc29sYXRpb24uZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnaXNvbGF0aW9ucG9saWN5ZGV0YWlscydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbi5lZGl0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2VkaXQvOmtleScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdpc29sYXRpb25wb2xpY3lkZXRhaWxzJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuYmFuZHdpZHRoJywge1xuICAgICAgICAgICAgdXJsOiAnL2JhbmR3aWR0aCcsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPHVpLXZpZXcvPidcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmJhbmR3aWR0aC5jcmVhdGUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2JhbmR3aWR0aHBvbGljeWNyZWF0ZSdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmJhbmR3aWR0aC5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdiYW5kd2lkdGhwb2xpY3lkZXRhaWxzJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuYmFuZHdpZHRoLmVkaXQnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZWRpdC86a2V5JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2JhbmR3aWR0aHBvbGljeWRldGFpbHMnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5yZWRpcmVjdGlvbicsIHtcbiAgICAgICAgICAgIHVybDogJy9yZWRpcmVjdGlvbicsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPHVpLXZpZXcvPidcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBwYXJhbXM6IHsgcG9saWN5VGFiOiBudWxsIH0sXG4gICAgICAgICAgICBjb21wb25lbnQ6ICduZXR3b3JrcG9saWNpZXN0YWJzJ1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3MnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcycsIHtcbiAgICAgICAgICAgIHVybDogJy9uZXR3b3JrcycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3MubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ25ldHdvcmtMaXN0J1xuICAgICAgICB9KS5cbiAgICAgICAgICAgIHN0YXRlKCdjb250aXYubWVudS5uZXR3b3Jrcy5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICduZXR3b3JrZGV0YWlscydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3MuY3JlYXRlJywge1xuICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICduZXR3b3JrY3JlYXRlJ1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzJywge1xuICAgICAgICAgICAgdXJsOiAnL25vZGVzJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm9yZ2FuaXphdGlvbnMnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdjb250aXYubWVudS5vcmdhbml6YXRpb25zJywge1xuICAgICAgICAgICAgdXJsOiAnL29yZ2FuaXphdGlvbnMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ29yZ2FuaXphdGlvbmxpc3QnXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zZXJ2aWNlbGJzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzJywge1xuICAgICAgICAgICAgdXJsOiAnL3NlcnZpY2VsYnMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ3NlcnZpY2VsYkxpc3QnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMuY3JlYXRlJywge1xuICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdzZXJ2aWNlbGJDcmVhdGUnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnc2VydmljZWxiRGV0YWlscydcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcFxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbi8qKlxuICogVGhlIGdyYXBoIHRoYXQgaXMgdXNlZCBzcGVjaWZpY2FsbHkgZm9yIHRoZSB2aXN1YWxpemF0aW9uIHRhYi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ1Zpc3VhbGl6ZXJHcmFwaCcsIFsnR3JhcGgnLCBmdW5jdGlvbiAoR3JhcGgpIHtcbiAgICB2YXIgVmlzdWFsaXplckdyYXBoID0gZnVuY3Rpb24gKF9HcmFwaCRHcmFwaCkge1xuICAgICAgICBfaW5oZXJpdHMoVmlzdWFsaXplckdyYXBoLCBfR3JhcGgkR3JhcGgpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgIHtIVE1MIFNWR30gIHN2ZyAgICAgICAgICAgICBUaGUgc3ZnIHRoYXQgd2lsbCBcbiAgICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvbGQgdGhlIGdyYXBoXG4gICAgICAgICAgICAgICAqIEBwYXJhbSAgIHtBcnJheX0gIG5vZGVzICAgXHRcdCAgICBMaXN0IG9mIG5vZGVzXG4gICAgICAgICAgICAgICAqIEBwYXJhbSAgIHtBcnJheX0gIGxpbmtzICAgXHRcdCAgICBMaXN0IG9mIGxpbmtzXG4gICAgICAgICAqIEBwYXJhbSAgIHtEYXRhU291cmNlfSAgZGF0YVNvdXJjZSAgICBUaGUgZGF0YSBzb3VyY2VcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIFZpc3VhbGl6ZXJHcmFwaChzdmcsIG5vZGVzLCBsaW5rcywgZGF0YVNvdXJjZSkge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZpc3VhbGl6ZXJHcmFwaCk7XG5cbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChWaXN1YWxpemVyR3JhcGguX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihWaXN1YWxpemVyR3JhcGgpKS5jYWxsKHRoaXMsIHN2Zywgbm9kZXMsIGxpbmtzKSk7XG5cbiAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSBfdGhpcztcblxuICAgICAgICAgICAgLy9ob2xkcyBjdXJyZW50IHRyYW5zaXRpb25zIHRoYXQgYXJlIG9jY3VyaW5nXG4gICAgICAgICAgICB0aGlzR3JhcGguc3RhdGUudHJhbnNpdGlvbiA9IFtdO1xuICAgICAgICAgICAgLy9NaW4gZGlzdGFuY2UgYmV0d2VlbiBub2RlcyB3aGVuIHNwYXduaW5nIHJhbmRvbWx5XG4gICAgICAgICAgICB0aGlzR3JhcGguY29uc3RzLmVkZ2VfYnVmZmVyID0gMjAwO1xuICAgICAgICAgICAgLy9TaXplIHJlZHVjdGlvbiBhcyB5b3UgZ28gdGhyb3VnaCBsZXZlbHMgaW4gbm9kZXNcbiAgICAgICAgICAgIHRoaXNHcmFwaC5jb25zdHMucmFkaXVzRGVjYXkgPSAxO1xuICAgICAgICAgICAgLy9Dc3MgY2xhc3MgZm9yIG5vZGVzIHRoYXQgYXJlIGNvbnRhaW5lcnNcbiAgICAgICAgICAgIHRoaXNHcmFwaC5jb25zdHMuY29udGFpbmVyQ2xhc3MgPSAnY29udGFpbmVyJztcblxuICAgICAgICAgICAgLy9kYXRhU291cmNlIGhvbGRzIHRoZSBzZXJ2ZXIgZGF0YSBhbmQgbWV0aG9kcyBmb3JcbiAgICAgICAgICAgIC8vY29udmVydGluZyBpdCB0byBkYXRhIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgIHRoaXNHcmFwaC5kYXRhU291cmNlID0gZGF0YVNvdXJjZTtcblxuICAgICAgICAgICAgLy9EcmFnIGJlaGF2aW9yIGZvciBub2Rlc1xuICAgICAgICAgICAgdmFyIGRyYWcgPSBkMy5iZWhhdmlvci5kcmFnKCkub3JpZ2luKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgeDogZC54LCB5OiBkLnkgfTtcbiAgICAgICAgICAgIH0pLm9uKFwiZHJhZ3N0YXJ0XCIsIGZ1bmN0aW9uICgpIHt9KS5vbihcImRyYWdcIiwgZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykuYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbiAoZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICBkLnggKz0gZDMuZXZlbnQuZHg7XG4gICAgICAgICAgICAgICAgICAgIGQueSArPSBkMy5ldmVudC5keTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwidHJhbnNsYXRlKFwiICsgW2QueCwgZC55XSArIFwiKVwiO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfSkub24oXCJkcmFnZW5kXCIsIGZ1bmN0aW9uICgpIHt9KTtcblxuICAgICAgICAgICAgdGhpc0dyYXBoLmRyYWcgPSBkcmFnO1xuXG4gICAgICAgICAgICAvL1BhbiBhbmQgWm9vbSBiZWhhdmlvciBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICB2YXIgem9vbSA9IGQzLmJlaGF2aW9yLnpvb20oKS5vbihcInpvb21cIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChkMy5ldmVudC5zb3VyY2VFdmVudCAhPSBudWxsICYmIGQzLmV2ZW50LnNvdXJjZUV2ZW50LmN0cmxLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQuY2FsbCh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0pLm9uKFwiem9vbXN0YXJ0XCIsIGZ1bmN0aW9uIChkLCBpKSB7fSk7XG4gICAgICAgICAgICB0aGlzR3JhcGguZHJhZ1N2ZyA9IHpvb207XG4gICAgICAgICAgICB0aGlzR3JhcGguc3ZnLmNhbGwoem9vbSkub24oXCJkYmxjbGljay56b29tXCIsIG51bGwpO1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENhbGxlZCB3aXRoIG5vIGFyZ3Mgd2hlbiB0aGUgZ3JhcGggaGFzIGEgem9vbSBhY3Rpb25cbiAgICAgICAgICogQ2FuIGFsc28gYmUgY2FsbGVkIHdpdGggYXJncyB0byBmb3JjZSBhIHpvb20gb3IgcGFuIFxuICAgICAgICAgKiBldmVudCBmb3IgdGhlIGdyYXBoLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgdHJhbnNsYXRlICBUaGUgYW1vdW50IHRvIHRyYW5zbGF0ZVxuICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgc2NhbGUgICAgICBUaGUgYW1vdW50IHRvIHNjYWxlXG4gICAgICAgICAqL1xuXG5cbiAgICAgICAgX2NyZWF0ZUNsYXNzKFZpc3VhbGl6ZXJHcmFwaCwgW3tcbiAgICAgICAgICAgIGtleTogJ3pvb21lZCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gem9vbWVkKHRyYW5zbGF0ZSwgc2NhbGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLnN0YXRlLnJpZ2h0Q2xpY2sgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuanVzdFNjYWxlVHJhbnNHcmFwaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKHRyYW5zbGF0ZSAhPSBudWxsICYmIHNjYWxlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSB0aGlzR3JhcGguZHJhZ1N2ZztcbiAgICAgICAgICAgICAgICAgICAgem9vbS5zY2FsZShzY2FsZSk7XG4gICAgICAgICAgICAgICAgICAgIHpvb20udHJhbnNsYXRlKHRyYW5zbGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIC8vY3JlYXRpbmcgbmFtZXMgdG8gcHJldmVudCB0cmFuc2l0aW9uIGNvbmZsaWN0c1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbVNldENhbGxiYWNrID0gZnVuY3Rpb24gem9vbVNldENhbGxiYWNrKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgem9vbS5zY2FsZShzY2FsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB6b29tLnRyYW5zbGF0ZSh0cmFuc2xhdGUpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB2YXIgdHJhbnNsYXRlX25hbWUgPSBcInpvb21cIiArIHRyYW5zbGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KFwiLlwiICsgdGhpcy5jb25zdHMuZ3JhcGhDbGFzcykudHJhbnNpdGlvbih0cmFuc2xhdGVfbmFtZSkuZGVsYXkoMTAwKS5kdXJhdGlvbig3NTApLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoJyArIHpvb20udHJhbnNsYXRlKCkgKyAnKSBzY2FsZSgnICsgem9vbS5zY2FsZSgpICsgJyknKS5lYWNoKFwiZW5kXCIsIHpvb21TZXRDYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5zdGF0ZS5jYW5ab29tKSB7XG4gICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdChcIi5cIiArIHRoaXMuY29uc3RzLmdyYXBoQ2xhc3MpLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKSArIFwiKSBzY2FsZShcIiArIHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCkgKyBcIilcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdvbldpbmRvd1Jlc2l6ZScsXG5cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgd2luZG93IHJlc2l6ZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBTVkd9ICBzdmcgICAgVGhlIHN2ZyB0byByZXNpemVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uV2luZG93UmVzaXplKHN2Zykge1xuICAgICAgICAgICAgICAgIHZhciBib2R5RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnYm9keScpWzBdO1xuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLm9mZnNldCgpO1xuICAgICAgICAgICAgICAgIHZhciBkaXZXaWR0aCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykud2lkdGgoKTtcbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gYm9keUVsLmNsaWVudEhlaWdodDtcbiAgICAgICAgICAgICAgICBzdmcuYXR0cihcIndpZHRoXCIsIGRpdldpZHRoKS5hdHRyKFwiaGVpZ2h0XCIsIGhlaWdodCAtIG9mZnNldC50b3AgLSAyMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3VwZGF0ZUxpbmtEYXRhJyxcblxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBzZXJ2ZXIgc2VuZHMgdXBkYXRlZCBkYXRhIGZvciB0aGUgbGlua3NcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUxpbmtEYXRhKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBub2RlX25hbWVzX3NldCA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpc0dyYXBoLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVfbmFtZXNfc2V0LnB1c2godGhpc0dyYXBoLm5vZGVzW2ldLmlkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHJldERhdGEgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5nZXRGbG93QmV0d2VlblNldChub2RlX25hbWVzX3NldCk7XG4gICAgICAgICAgICAgICAgdmFyIGxpbmtEYXRhID0gcmV0RGF0YS5saW5rRGF0YTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5wcm9jZXNzTGlua0RhdGEobGlua0RhdGEsIHRoaXNHcmFwaC5ub2Rlcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5pbml0Tm9kZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRMaW5rcygpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIFZpc3VhbGl6ZXJHcmFwaDtcbiAgICB9KEdyYXBoLkdyYXBoKTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIEdyYXBoOiBWaXN1YWxpemVyR3JhcGhcbiAgICB9O1xufV0pO1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zZXR0aW5ncycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZ2xvYmFsJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL3NldHRpbmdzJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2V0dGluZ3Mvc2V0dGluZ3NtZW51Lmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMubG9ncycsIHtcbiAgICAgICAgICAgIHVybDogJy9sb2dzJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICcnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMuYXV0aCcsIHtcbiAgICAgICAgICAgIHVybDogJy9hdXRoJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICcnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMubGljZW5zZScsIHtcbiAgICAgICAgICAgIHVybDogJy9saWNlbnNlJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICcnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMucG9saWNpZXMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvcG9saWNpZXMnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJycsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5uZXR3b3JrcycsIHtcbiAgICAgICAgICAgIHVybDogJy9uZXR3b3JrcycsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICduZXR3b3Jrc2V0dGluZydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy52b2x1bWVzJywge1xuICAgICAgICAgICAgdXJsOiAnL3ZvbHVtZXMnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAndm9sdW1lc2V0dGluZydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5jbHVzdGVyJywge1xuICAgICAgICAgICAgdXJsOiAnL2NsdXN0ZXInLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnY2x1c3RlcnNldHRpbmdzJ1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc3RvcmFnZXBvbGljaWVzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvc3RvcmFnZXBvbGljaWVzJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ3N0b3JhZ2Vwb2xpY3lsaXN0J1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbi8qKlxuICogVGhlIGJhc2UgY2xhc3MgZm9yIGxpbmsgb2JqZWN0cyBmb3IgdGhlIGdyYXBoLlxuICogU3VwcG9ydHMgcG9saWNpZXMuXG4gKiBcbiAqIFRvIHdyaXRlIHlvdXIgb3duIGxpbmsgb2JqZWN0LCBjcmVhdGUgYSBuZXcgZmFjdG9yeSB0aGF0IHVzZXMgdGhlIGxpbmtcbiAqIHlvdSB3YW50IHRvIGluaGVyaXQgYXMgYSBkZXBlbmRlbmN5LCBhbmQgZXh0ZW5kIGl0cyBsaW5rIGNsYXNzLiBcbiAqIFJldHVybiB0aGUgY2xhc3Mgb2JqZWN0IHdpdGggTGluayBhcyBrZXlcbiAqIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnTGluaycsIFtmdW5jdGlvbiAoKSB7XG5cdHZhciBMaW5rID0gZnVuY3Rpb24gKCkge1xuXHRcdC8qKlxuICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAqXG4gICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgc291cmNlTm9kZSAgVGhlIHNvdXJjZSBub2RlXG4gICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgdGFyZ2V0Tm9kZSAgVGhlIHRhcmdldCBub2RlXG4gICAqL1xuXHRcdGZ1bmN0aW9uIExpbmsoc291cmNlTm9kZSwgdGFyZ2V0Tm9kZSkge1xuXHRcdFx0X2NsYXNzQ2FsbENoZWNrKHRoaXMsIExpbmspO1xuXG5cdFx0XHR0aGlzLnNvdXJjZSA9IHNvdXJjZU5vZGU7XG5cdFx0XHR0aGlzLnRhcmdldCA9IHRhcmdldE5vZGU7XG5cdFx0XHR0aGlzLmhhc1BvbGljeSA9IGZhbHNlO1xuXHRcdFx0dGhpcy5wYXRoUG9saWNpZXMgPSBbXTtcblx0XHRcdHRoaXMuZ3JhcGggPSBudWxsO1xuXHRcdFx0dGhpcy5pbml0aWFsaXplZCA9IGZhbHNlO1xuXHRcdH1cblxuXHRcdC8qKlxuICAgKiBDYWxsZWQgd2hlbiBhIGxpbmsgaXMgYWRkZWQgdG8gdGhlIGdyYXBoXG4gICAqXG4gICAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoIGl0IGlzIGFkZGVkIHRvXG4gICAqL1xuXG5cblx0XHRfY3JlYXRlQ2xhc3MoTGluaywgW3tcblx0XHRcdGtleTogJ2luaXRpYWxpemUnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemUoZ3JhcGgpIHtcblx0XHRcdFx0aWYgKHRoaXMuaW5pdGlhbGl6ZWQgPT0gZmFsc2UpIHtcblx0XHRcdFx0XHR0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcblx0XHRcdFx0XHR0aGlzLmdyYXBoID0gZ3JhcGg7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBDYWxsZWQgZHVyaW5nIHRoZSB1cGRhdGUgZ3JhcGggZm9yIGV4aXN0aW5nIGxpbmtzXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuICAgICogQHBhcmFtICAgICAge0xpbmt9ICBcdCAgIGQgICAgICAgTWF0Y2hpbmcgTGluayBPYmplY3QgICAgICAgXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3VwZGF0ZUF0dHInLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUF0dHIoZDNwYXRoLCBkKSB7XG5cdFx0XHRcdGQzcGF0aC5zdHlsZSgnbWFya2VyLWVuZCcsICd1cmwoI2VuZC1hcnJvdyknKS5hdHRyKFwiZFwiLCBhcnJvd1BhdGgpO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIENhbGxlZCBkdXJpbmcgdGhlIGZpcnN0IHVwZGF0ZSBncmFwaCBmb3IgYSBsaW5rXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuICAgICogQHBhcmFtICAgICAge0xpbmt9ICBcdCAgIGQgICAgICAgTWF0Y2hpbmcgTGluayBPYmplY3QgICAgICAgXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ25ld1BhdGhBdHRyJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBuZXdQYXRoQXR0cihkM3BhdGgsIGQpIHtcblx0XHRcdFx0ZDNwYXRoLmF0dHIoJ2QnLCBhcnJvd1BhdGgpO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIENhbGN1bGF0ZXMgdGhlIGFycm93IHBhdGhcbiAgICAqXG4gICAgKiBAcmV0dXJuICAgICB7c3RyaW5nfSAgVGhlIHBhdGggdG8gZHJhd1xuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdhcnJvd1BhdGgnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGFycm93UGF0aCgpIHtcblx0XHRcdFx0dmFyIGQgPSB0aGlzO1xuXHRcdFx0XHR2YXIgZHggPSBkLnRhcmdldC54IC0gZC5zb3VyY2UueCxcblx0XHRcdFx0ICAgIGR5ID0gZC50YXJnZXQueSAtIGQuc291cmNlLnksXG5cdFx0XHRcdCAgICBkciA9IE1hdGguc3FydChkeCAqIGR4ICsgZHkgKiBkeSk7XG5cdFx0XHRcdHJldHVybiBcIk1cIiArIGQuc291cmNlLnggKyBcIixcIiArIGQuc291cmNlLnkgKyBcIkFcIiArIGRyICsgXCIsXCIgKyBkciArIFwiIDAgMCwxIFwiICsgZC50YXJnZXQueCArIFwiLFwiICsgZC50YXJnZXQueTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBVc2VkIHRvIGluc3RhbGwgcG9saWNpZXMgdGhhdCBhcmUgY2FsbGVkIHdoZW4gdGhpc1xuICAgICogbGluayBoYXMgYSBtb3VzZSBldmVudFxuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3kgIFRoZSBwb2xpY3kgdG8gaW5zdGFsbFxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdpbnN0YWxsUGF0aFBvbGljeScsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gaW5zdGFsbFBhdGhQb2xpY3kocG9saWN5KSB7XG5cdFx0XHRcdHRoaXMuaGFzUG9saWN5ID0gdHJ1ZTtcblx0XHRcdFx0dGhpcy5wYXRoUG9saWNpZXMucHVzaChwb2xpY3kpO1xuXHRcdFx0XHRwb2xpY3kuaW5pdGlhbGl6ZSh0aGlzLmdyYXBoKTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBVc2VkIHRvIHVuaW5zdGFsbCBwb2xpY3kgZm9yIHRoaXMgbGlua1xuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3lSZW1vdmUgIFRoZSBwb2xpY3kgdG8gcmVtb3ZlXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3VuaW5zdGFsbFBhdGhQb2xpY3knLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHVuaW5zdGFsbFBhdGhQb2xpY3kocG9saWN5UmVtb3ZlKSB7XG5cdFx0XHRcdHZhciBwb2xpY3lSZW1vdmVOYW1lO1xuXHRcdFx0XHR2YXIgdGhpc1BhdGggPSB0aGlzO1xuXHRcdFx0XHRpZiAodHlwZW9mIHBvbGljeVJlbW92ZSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHRwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmUucG9saWN5TmFtZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRfKHRoaXNQYXRoLnBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5LCBpbmRleCkge1xuXHRcdFx0XHRcdGlmIChwb2xpY3kucG9saWN5TmFtZSA9PT0gcG9saWN5UmVtb3ZlTmFtZSkge1xuXHRcdFx0XHRcdFx0cG9saWN5LmRlc3Ryb3koKTtcblx0XHRcdFx0XHRcdHRoaXNQYXRoLnBhdGhQb2xpY2llcy5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHRcdGlmICh0aGlzUGF0aC5wYXRoUG9saWNpZXMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdFx0dGhpc1BhdGguaGFzUG9saWN5ID0gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBDYWxsZWQgd2hlbiB0aGVyZSBpcyBhIG1vdXNlIGV2ZW50IGZvciB0aGlzIHBhdGhcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgZXZlbnQgICAgIFRoZSBtb3VzZSBldmVudFxuICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGQgICAgICAgICBUaGUgbWF0Y2hpbmcgbGluayBvYmplY3RcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAncGF0aFBvbGljeUV2ZW50Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBwYXRoUG9saWN5RXZlbnQoZXZlbnQsIGQzcGF0aCwgZCkge1xuXHRcdFx0XHRfKGQucGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3kpIHtcblx0XHRcdFx0XHRwb2xpY3lbZXZlbnRdKGQzcGF0aCwgZCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1dKTtcblxuXHRcdHJldHVybiBMaW5rO1xuXHR9KCk7XG5cblx0cmV0dXJuIHtcblx0XHRMaW5rOiBMaW5rXG5cdH07XG59XSk7XG5cblxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52aXN1YWxpemF0aW9uJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscycsIFxuXHQnY29udGl2LmdyYXBoJ10pXG4gLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdjb250aXYubWVudS52aXN1YWxpemF0aW9uJywge1xuICAgICAgICAgICAgdXJsOiAnL3Zpc3VhbGl6YXRpb24nLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgfV0pO1xuXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudm9sdW1lcycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUudm9sdW1lcycsIHtcbiAgICAgICAgICAgIHVybDogJy92b2x1bWVzJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52b2x1bWVzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICd2b2x1bWVsaXN0J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52b2x1bWVzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ3ZvbHVtZWRldGFpbHMnXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXBcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxudmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQob2JqZWN0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IHJldHVybiBnZXQocGFyZW50LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpOyB9IH0gZWxzZSBpZiAoXCJ2YWx1ZVwiIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9O1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbi8qKlxuICogVGhlIGxpbmsgdGhhdCBpcyB1c2VkIHNwZWNpZmljYWxseSBmb3IgdGhlIHZpc3VhbGl6YXRpb24gdGFiLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnVmlzdWFsaXplckxpbmsnLCBbJ0xpbmsnLCBmdW5jdGlvbiAoTGluaykge1xuXHR2YXIgVmlzdWFsaXplckxpbmsgPSBmdW5jdGlvbiAoX0xpbmskTGluaykge1xuXHRcdF9pbmhlcml0cyhWaXN1YWxpemVyTGluaywgX0xpbmskTGluayk7XG5cblx0XHQvKipcbiAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgKlxuICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHNvdXJjZU5vZGUgIFRoZSBzb3VyY2Ugbm9kZVxuICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHRhcmdldE5vZGUgIFRoZSB0YXJnZXQgbm9kZVxuICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgd2VpZ2h0ICAgIFRoZSB3ZWlnaHQgb2YgdGhlIGxpbmtcbiAgICovXG5cdFx0ZnVuY3Rpb24gVmlzdWFsaXplckxpbmsoc291cmNlTm9kZSwgdGFyZ2V0Tm9kZSwgd2VpZ2h0KSB7XG5cdFx0XHRfY2xhc3NDYWxsQ2hlY2sodGhpcywgVmlzdWFsaXplckxpbmspO1xuXG5cdFx0XHR2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoVmlzdWFsaXplckxpbmsuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihWaXN1YWxpemVyTGluaykpLmNhbGwodGhpcywgc291cmNlTm9kZSwgdGFyZ2V0Tm9kZSkpO1xuXG5cdFx0XHRfdGhpcy53ZWlnaHQgPSB3ZWlnaHQ7XG5cdFx0XHQvL0NvdW50IGlzIHVzZWQgdG8ga2VlcCB0cmFjayBvZiBob3cgbWFueVxuXHRcdFx0Ly9wYXRocyB0byBpdHMgc3Vibm9kZXMgdGhlcmUgYXJlXG5cdFx0XHQvL2luIG9yZGVyIHRvIGNhbGN1bGF0ZSBhdmVyYWdlIHRyYWZmaWNcblx0XHRcdF90aGlzLmNvdW50ID0gMTtcblx0XHRcdHJldHVybiBfdGhpcztcblx0XHR9XG5cblx0XHQvKipcbiAgICogSW5jcmVhc2VzIHRoZSBjb3VudCBvZiB0aGUgbGlua1xuICAgKiBVU2VkIHRvIGtlZXAgdHJhY2sgb2YgaG93IG1hbnkgcGF0aHMgdG8gaXRzIHN1Ym5vZGVzXG4gICAqIHRoZXJlIGFyZSBpbiBvcmRlciB0byBjYWxjdWxhdGUgYXZlcmFnZSB0cmFmZmljXG4gICAqL1xuXG5cblx0XHRfY3JlYXRlQ2xhc3MoVmlzdWFsaXplckxpbmssIFt7XG5cdFx0XHRrZXk6ICdpbmNyZWFzZUNvdW50Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBpbmNyZWFzZUNvdW50KCkge1xuXHRcdFx0XHR0aGlzLmNvdW50ICs9IDE7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogQ2FsY3VsYXRlcyB3aGVyZSB0byBwbGFjZSBxdGlwIGZvclxuICAgICpcbiAgICAqIEByZXR1cm4gICAgIHtPYmplY3R9ICBPYmplY3Qgd2l0aCBxVGlwIHNldHRpbmdzXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3F0aXBIZWxwZXInLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHF0aXBIZWxwZXIoKSB7XG5cdFx0XHRcdHZhciByZXQ7XG5cdFx0XHRcdHZhciBkID0gdGhpcztcblx0XHRcdFx0dmFyIGR4ID0gKGQudGFyZ2V0LnggLSBkLnNvdXJjZS54KSAvIDIsXG5cdFx0XHRcdCAgICBkeSA9IChkLnRhcmdldC55IC0gZC5zb3VyY2UueSkgLyAyO1xuXHRcdFx0XHRpZiAoZC5zb3VyY2UueCA8IGQudGFyZ2V0LngpIHtcblx0XHRcdFx0XHRyZXQgPSB7XG5cdFx0XHRcdFx0XHRteTogJ3RvcCBjZW50ZXInLFxuXHRcdFx0XHRcdFx0YXQ6ICdjZW50ZXIgY2VudGVyJywgLy8gYXQgdGhlIGJvdHRvbSByaWdodCBvZi4uLlxuXHRcdFx0XHRcdFx0dGFyZ2V0OiBbZHgsIGR5XSxcblx0XHRcdFx0XHRcdGFkanVzdDoge1xuXHRcdFx0XHRcdFx0XHR5OiAxMFxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cmV0ID0ge1xuXHRcdFx0XHRcdFx0bXk6ICdib3R0b20gY2VudGVyJyxcblx0XHRcdFx0XHRcdGF0OiAnY2VudGVyIGNlbnRlcicsIC8vIGF0IHRoZSBib3R0b20gcmlnaHQgb2YuLi5cblx0XHRcdFx0XHRcdHRhcmdldDogW2R4LCBkeV0sXG5cdFx0XHRcdFx0XHRhZGp1c3Q6IHtcblx0XHRcdFx0XHRcdFx0eTogLTEwXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gcmV0O1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICogQ2FsbGVkIHdoZW4gYSBsaW5rIGlzIGFkZGVkIHRvIHRoZSBncmFwaFxuICAgKlxuICAgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaCBpdCBpcyBhZGRlZCB0b1xuICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ2luaXRpYWxpemUnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemUoZ3JhcGgpIHtcblx0XHRcdFx0aWYgKHRoaXMuaW5pdGlhbGl6ZWQgPT0gZmFsc2UpIHtcblx0XHRcdFx0XHRfZ2V0KFZpc3VhbGl6ZXJMaW5rLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFZpc3VhbGl6ZXJMaW5rLnByb3RvdHlwZSksICdpbml0aWFsaXplJywgdGhpcykuY2FsbCh0aGlzLCBncmFwaCk7XG5cdFx0XHRcdFx0dmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuVmlzdWFsaXplckxpbms7XG5cdFx0XHRcdFx0aWYgKHN0YXRlID09IG51bGwpIHtcblx0XHRcdFx0XHRcdHN0YXRlID0gZ3JhcGguc3RhdGUuVmlzdWFsaXplckxpbmsgPSB7fTtcblx0XHRcdFx0XHRcdHN0YXRlLm1heFdlaWdodCA9IG51bGw7XG5cdFx0XHRcdFx0XHRzdGF0ZS51c2VBdmdXZWlnaHQgPSB0cnVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHR0aGlzLnVwZGF0ZU1heFdlaWdodCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogU2V0cyB3aGV0aGVyIHRoZSBncmFwaCBzaG91bGQgdXNlIGF2ZyB3ZWlnaHRcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7Ym9vbGVhbn0gIHZhbCAgICAgVGhlIHZhbHVlIHRvIHNldCB0b1xuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdzZXRVc2VBdmdXZWlnaHQnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHNldFVzZUF2Z1dlaWdodCh2YWwpIHtcblx0XHRcdFx0dGhpcy5ncmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluay51c2VBdmdXZWlnaHQgPSAhIXZhbDtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBTZXRzIHRoZSB3ZWlnaHQgb2YgdGhpcyBsaW5rXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge251bWJlcn0gIHdlaWdodCAgVGhlIHdlaWdodCB0byBzZXQgdG9cbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnc2V0V2VpZ2h0Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBzZXRXZWlnaHQod2VpZ2h0KSB7XG5cdFx0XHRcdHRoaXMud2VpZ2h0ID0gd2VpZ2h0O1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIEdldHMgdGhlIHJhdyB3ZWlnaHQuXG4gICAgKlxuICAgICogQHJldHVybiAgICAge251bWJlcn0gIFRoZSByYXcgd2VpZ2h0LlxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdnZXRSYXdXZWlnaHQnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGdldFJhd1dlaWdodCgpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMud2VpZ2h0O1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIEdldHMgdGhlIHdlaWdodCB2YWx1ZSBvZiB0aGUgbGluaywgZGVwZW5kaW5nIG9uIHRoZVxuICAgICogdXNlQXZnV2VpZ3RoIHNldHRpbmdcbiAgICAqXG4gICAgKiBAcmV0dXJuICAgICB7bnVtYmVyfSAgVGhlIHdlaWdodC5cbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnZ2V0V2VpZ2h0Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBnZXRXZWlnaHQoKSB7XG5cdFx0XHRcdHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuXHRcdFx0XHQgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuVmlzdWFsaXplckxpbms7XG5cblx0XHRcdFx0aWYgKHN0YXRlLnVzZUF2Z1dlaWdodCkge1xuXHRcdFx0XHRcdHZhciB3ZWlnaHQgPSB0aGlzLndlaWdodCAvIHRoaXMuY291bnQ7XG5cdFx0XHRcdFx0cmV0dXJuIHdlaWdodDtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdGhpcy53ZWlnaHQ7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogVXBkYXRlcyB0aGUgbWF4IHdlaWdodCBvZiB0aGUgZ3JhcGhcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAndXBkYXRlTWF4V2VpZ2h0Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVNYXhXZWlnaHQoKSB7XG5cdFx0XHRcdHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuXHRcdFx0XHQgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuVmlzdWFsaXplckxpbms7XG5cblx0XHRcdFx0dmFyIG1heExpbmsgPSBfLm1heEJ5KHRoaXNHcmFwaC5saW5rcywgZnVuY3Rpb24gKGwpIHtcblx0XHRcdFx0XHRpZiAobC5ncmFwaCAhPSBudWxsKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gbC5nZXRXZWlnaHQoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIDA7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRzdGF0ZS5tYXhXZWlnaHQgPSBtYXhMaW5rLmdldFdlaWdodCgpO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIENhbGxlZCBkdXJpbmcgdGhlIHVwZGF0ZSBncmFwaCBmb3IgZXhpc3RpbmcgbGlua3NcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM3BhdGggIFRoZSBkMyBwYXRoXG4gICAgKiBAcGFyYW0gICAgICB7TGlua30gIFx0ICAgZCAgICAgICBNYXRjaGluZyBMaW5rIE9iamVjdCAgICAgICBcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAndXBkYXRlQXR0cicsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gdXBkYXRlQXR0cihkM3BhdGgsIGQpIHtcblx0XHRcdFx0dmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG5cdFx0XHRcdCAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluaztcblx0XHRcdFx0dGhpcy51cGRhdGVNYXhXZWlnaHQoKTtcblx0XHRcdFx0dmFyIGNvbG9yU2NhbGUgPSBkMy5zY2FsZS5saW5lYXIoKS5kb21haW4oWzAsIHN0YXRlLm1heFdlaWdodF0pLnJhbmdlKFtcIiNmZmIzNjZcIiwgXCIjRjkyNjA2XCJdKTtcblx0XHRcdFx0c3RhdGUuY29sb3JTY2FsZSA9IGNvbG9yU2NhbGU7XG5cdFx0XHRcdGQzcGF0aC5zdHlsZSgnbWFya2VyLWVuZCcsICd1cmwoI2VuZC1hcnJvdyknKS5jbGFzc2VkKHRoaXNHcmFwaC5jb25zdHMuc2VsZWN0ZWRDbGFzcywgZnVuY3Rpb24gKGQpIHtcblx0XHRcdFx0XHRyZXR1cm4gZCA9PT0gc3RhdGUuc2VsZWN0ZWRFZGdlO1xuXHRcdFx0XHR9KS5hdHRyKFwiZFwiLCB0aGlzLmFycm93UGF0aC5jYWxsKGQpKS50cmFuc2l0aW9uKFwiZXhpc3RpbmdQYXRoVHJhbnNpdGlvblwiKS5kdXJhdGlvbig3NTApLmF0dHIoXCJzdHJva2VcIiwgZnVuY3Rpb24gKGQpIHtcblx0XHRcdFx0XHR2YXIgYyA9IGNvbG9yU2NhbGUoZC5nZXRXZWlnaHQoKSk7XG5cdFx0XHRcdFx0cmV0dXJuIGM7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIENhbGxlZCBkdXJpbmcgdGhlIGZpcnN0IHVwZGF0ZSBncmFwaCBmb3IgdGhpcyBsaW5rXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuICAgICogQHBhcmFtICAgICAge0xpbmt9ICBcdCAgIGQgICAgICAgTWF0Y2hpbmcgTGluayBPYmplY3RcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnbmV3UGF0aEF0dHInLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIG5ld1BhdGhBdHRyKGQzcGF0aCwgZCkge1xuXHRcdFx0XHR2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcblx0XHRcdFx0ICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXHRcdFx0XHR0aGlzLnVwZGF0ZU1heFdlaWdodCgpO1xuXHRcdFx0XHR2YXIgY29sb3JTY2FsZSA9IGQzLnNjYWxlLmxpbmVhcigpLmRvbWFpbihbMCwgc3RhdGUubWF4V2VpZ2h0XSkucmFuZ2UoW1wiI2ZmYjM2NlwiLCBcIiNGOTI2MDZcIl0pO1xuXG5cdFx0XHRcdGQzcGF0aC50cmFuc2l0aW9uKFwibmV3UGF0aFRyYW5zaXRpb25cIikuZHVyYXRpb24oNzUwKS5hdHRyVHdlZW4oXCJvcGFjaXR5XCIsIGZ1bmN0aW9uIChkKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGQzLmludGVycG9sYXRlU3RyaW5nKDAsIDEpO1xuXHRcdFx0XHR9KS5hdHRyKFwic3Ryb2tlXCIsIGZ1bmN0aW9uIChkKSB7XG5cdFx0XHRcdFx0dmFyIGMgPSBjb2xvclNjYWxlKGQuZ2V0V2VpZ2h0KCkpO1xuXHRcdFx0XHRcdHJldHVybiBjO1xuXHRcdFx0XHR9KS5hdHRyKCdkJywgdGhpcy5hcnJvd1BhdGguY2FsbChkKSk7XG5cdFx0XHR9XG5cdFx0fV0pO1xuXG5cdFx0cmV0dXJuIFZpc3VhbGl6ZXJMaW5rO1xuXHR9KExpbmsuTGluayk7XG5cblx0cmV0dXJuIHtcblx0XHRMaW5rOiBWaXN1YWxpemVyTGlua1xuXHR9O1xufV0pO1xuJ3VzZSBzdHJpY3QnO1xuLy8gRGVjbGFyZSBhcHAgbGV2ZWwgbW9kdWxlIHdoaWNoIGRlcGVuZHMgb24gdmlld3MsIGFuZCBjb21wb25lbnRzXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2QXBwJywgW1xuICAgICd1aS5yb3V0ZXInLFxuICAgICdjb250aXYubG9naW4nLFxuICAgICdjb250aXYubWVudScsXG4gICAgJ2NvbnRpdi5kYXNoYm9hcmQnLFxuICAgICdjb250aXYuYXBwbGljYXRpb25ncm91cHMnLFxuICAgICdjb250aXYubmV0d29ya3MnLFxuICAgICdjb250aXYubmV0d29ya3BvbGljaWVzJyxcbiAgICAnY29udGl2LnN0b3JhZ2Vwb2xpY2llcycsXG4gICAgJ2NvbnRpdi5zZXJ2aWNlbGJzJyxcbiAgICAnY29udGl2LnZvbHVtZXMnLFxuICAgICdjb250aXYubm9kZXMnLFxuICAgICdjb250aXYub3JnYW5pemF0aW9ucycsXG4gICAgJ2NvbnRpdi5zZXR0aW5ncycsXG4gICAgJ2NvbnRpdi52aXN1YWxpemF0aW9uJ1xuXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCAnJHVybFJvdXRlclByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Jywge1xuICAgICAgICAgICAgdXJsOiAnJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBmbHVpZCBjb250YWluZXJcIi8+J1xuICAgICAgICB9KTtcbiAgICAgICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5tZW51JylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ21lbnUvbWVudS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdNZW51Q3RybCBhcyBtZW51Q3RybCcsXG4gICAgICAgICAgICBwYXJhbXM6IHsgdXNlcm5hbWU6IG51bGwgfVxuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTWVudUN0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMpIHtcbiAgICAgICAgdmFyIG1lbnVDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gbG9nb3V0KCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubG9naW4nKTtcbiAgICAgICAgfVxuICAgICAgICBtZW51Q3RybC51c2VybmFtZSA9ICRzdGF0ZVBhcmFtcy51c2VybmFtZTtcbiAgICAgICAgbWVudUN0cmwubG9nb3V0ID0gbG9nb3V0O1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1lbnVDdHJsLmpzLm1hcFxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmZhY3RvcnkoJ0JncFNlcnZpY2UnLCBbJyRodHRwJywgJyRxJywgZnVuY3Rpb24gKCRodHRwLCAkcSkge1xuICAgICAgICBmdW5jdGlvbiBnZXRCZ3AoY3RybCkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLkJHUFNfRU5EUE9JTlQgKyBjdHJsLmtleSArICcvJztcbiAgICAgICAgICAgICRodHRwLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgIGN0cmwubmVpZ2hib3IgPSByZXN1bHQuZGF0YTtcbiAgICAgICAgICAgICAgICBjdHJsLm5laWdoYm9ycy5wdXNoKHsgJ25hbWUnOiBjdHJsLm5laWdoYm9yWyduZWlnaGJvciddLCAndmFsdWUnOiBjdHJsLm5laWdoYm9yWyduZWlnaGJvci1hcyddIH0pO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVCZ3AoY3RybCkge1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuQkdQU19FTkRQT0lOVCArIGN0cmwua2V5ICsgJy8nO1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QodXJsLCBjdHJsLm5laWdoYm9yKTtcbiAgICAgICAgfVxuICAgICAgICA7XG4gICAgICAgIGZ1bmN0aW9uIGdldEJncEluc3BlY3Qoa2V5KSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuQkdQU19JTlNQRUNUX0VORFBPSU5UICsga2V5ICsgJy8nO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRCZ3A6IGdldEJncCxcbiAgICAgICAgICAgIHVwZGF0ZUJncDogdXBkYXRlQmdwLFxuICAgICAgICAgICAgZ2V0QmdwSW5zcGVjdDogZ2V0QmdwSW5zcGVjdFxuICAgICAgICB9O1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJncHNlcnZpY2UuanMubWFwXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5ub2Rlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZMb2dzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL2xvZ3MuaHRtbCcsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBsb2c6IFwiPVwiLFxuICAgICAgICAgICAgdGl0bGU6IFwiQFwiXG4gICAgICAgIH1cbiAgICB9O1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1sb2dzZGlyZWN0aXZlLmpzLm1hcFxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmZhY3RvcnkoJ0xvZ1NlcnZpY2UnLCBbJyRodHRwJywgJyRxJywgZnVuY3Rpb24gKCRodHRwLCAkcSkge1xuICAgICAgICBmdW5jdGlvbiBnZXRBY3RpdmVMb2dzKCkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLk5PREVTX0FDVElWRV9KT0JfRU5EUE9JTlQ7XG4gICAgICAgICAgICAkaHR0cC5nZXQodXJsKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0TGFzdExvZ3MoKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuTk9ERVNfTEFTVF9KT0JfRU5EUE9JTlQ7XG4gICAgICAgICAgICAkaHR0cC5nZXQodXJsKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldEFjdGl2ZUxvZ3M6IGdldEFjdGl2ZUxvZ3MsXG4gICAgICAgICAgICBnZXRMYXN0TG9nczogZ2V0TGFzdExvZ3NcbiAgICAgICAgfTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1sb2dzZXJ2aWNlLmpzLm1hcFxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4vKipcbiAqIFRoZSBiYXNlIGNsYXNzIGZvciBub2RlIG9iamVjdHMgZm9yIHRoZSBncmFwaC5cbiAqIFN1cHBvcnRzIHBvbGljaWVzLlxuICogXG4gKiBUbyB3cml0ZSB5b3VyIG93biBOb2RlIG9iamVjdCwgY3JlYXRlIGEgbmV3IGZhY3RvcnkgdGhhdCB1c2VzIHRoZSBub2RlXG4gKiB5b3Ugd2FudCB0byBpbmhlcml0IGFzIGEgZGVwZW5kZW5jeSwgYW5kIGV4dGVuZCBpdHMgbm9kZSBjbGFzcy4gXG4gKiBSZXR1cm4gdGhlIGNsYXNzIG9iamVjdCB3aXRoIE5vZGUgYXMga2V5XG4gKiBcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ05vZGUnLCBbZnVuY3Rpb24gKCkge1xuXHR2YXIgTm9kZSA9IGZ1bmN0aW9uICgpIHtcblx0XHQvKipcbiAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgKlxuICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeCAgICAgICB4IGxvY2F0aW9uXG4gICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB5ICAgICAgIHkgbG9jYXRpb25cbiAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGlkICAgICAgVGhlIGlkZW50aWZpZXJcbiAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHRleHQgICAgVGhlIHRleHQgdG8gZGlzcGxheVxuICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgcmFkaXVzICBUaGUgcmFkaXVzIG9mIHRoZSBub2RlXG4gICAqL1xuXHRcdGZ1bmN0aW9uIE5vZGUoeCwgeSwgaWQsIHRleHQsIHJhZGl1cykge1xuXHRcdFx0X2NsYXNzQ2FsbENoZWNrKHRoaXMsIE5vZGUpO1xuXG5cdFx0XHR0aGlzLnggPSB4O1xuXHRcdFx0dGhpcy55ID0geTtcblx0XHRcdHRoaXMucmFkaXVzID0gcmFkaXVzO1xuXHRcdFx0dGhpcy5pZCA9IGlkO1xuXHRcdFx0dGhpcy50ZXh0ID0gdGV4dDtcblx0XHRcdHRoaXMucmFkaXVzID0gcmFkaXVzO1xuXHRcdFx0dGhpcy5oYXNQb2xpY3kgPSBmYWxzZTtcblx0XHRcdHRoaXMucG9saWN5ID0gbnVsbDtcblx0XHRcdHRoaXMubm9kZVBvbGljaWVzID0gW107XG5cdFx0XHR0aGlzLmdyYXBoID0gbnVsbDtcblx0XHRcdHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcblx0XHR9XG5cblx0XHQvKipcbiAgICogQ2FsbGVkIHdoZW4gYSBub2RlIGlzIGFkZGVkIHRvIHRoZSBncmFwaFxuICAgKlxuICAgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaCBpdCBpcyBhZGRlZCB0b1xuICAgKi9cblxuXG5cdFx0X2NyZWF0ZUNsYXNzKE5vZGUsIFt7XG5cdFx0XHRrZXk6ICdpbml0aWFsaXplJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBpbml0aWFsaXplKGdyYXBoKSB7XG5cdFx0XHRcdGlmICh0aGlzLmluaXRpYWxpemVkID09IGZhbHNlKSB7XG5cdFx0XHRcdFx0dGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG5cdFx0XHRcdFx0dGhpcy5ncmFwaCA9IGdyYXBoO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogQ2FsbGVkIGR1cmluZyB0aGUgdXBkYXRlIGdyYXBoIGZvciBleGlzdGluZyBsaW5rc1xuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAndXBkYXRlQXR0cicsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gdXBkYXRlQXR0cihkM25vZGUsIGQpIHtcblx0XHRcdFx0ZDNub2RlLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZnVuY3Rpb24gKGQpIHtcblx0XHRcdFx0XHRyZXR1cm4gXCJ0cmFuc2xhdGUoXCIgKyBkLnggKyBcIixcIiArIGQueSArIFwiKVwiO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBDYWxsZWQgZHVyaW5nIHRoZSBmaXJzdCB1cGRhdGUgZ3JhcGggZm9yIGEgbm9kZVxuICAgICogSG9vayBmb3Igc3ViIGNsYXNzZXNcbiAgICAqIFxuICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgZCAgICAgICBNYXRjaGluZyBOb2RlIE9iamVjdFxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICduZXdOb2RlQXR0cicsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gbmV3Tm9kZUF0dHIoZDNub2RlLCBkKSB7fVxuXG5cdFx0XHQvKipcbiAgICAqIFNldHMgdGhlIHJhZGl1cyBvZiB0aGUgbm9kZS5cbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgcmFkaXVzICBUaGUgcmFkaXVzXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3NldFJhZGl1cycsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gc2V0UmFkaXVzKHJhZGl1cykge1xuXHRcdFx0XHR0aGlzLnJhZGl1cyA9IHJhZGl1cztcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBVc2VkIHRvIGluc3RhbGwgcG9saWNpZXMgdGhhdCBhcmUgY2FsbGVkIHdoZW4gdGhpc1xuICAgICogbm9kZSBoYXMgYSBtb3VzZSBldmVudFxuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3kgIFRoZSBwb2xpY3kgdG8gaW5zdGFsbFxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdpbnN0YWxsTm9kZVBvbGljeScsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gaW5zdGFsbE5vZGVQb2xpY3kocG9saWN5KSB7XG5cdFx0XHRcdHRoaXMuaGFzUG9saWN5ID0gdHJ1ZTtcblx0XHRcdFx0dGhpcy5ub2RlUG9saWNpZXMucHVzaChwb2xpY3kpO1xuXHRcdFx0XHRwb2xpY3kuaW5pdGlhbGl6ZSh0aGlzLmdyYXBoKTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBVc2VkIHRvIHVuaW5zdGFsbCBwb2xpY3kgZm9yIHRoaXMgbm9kZVxuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l8c3RyaW5nfSAgcG9saWN5UmVtb3ZlICBUaGUgcG9saWN5IHRvIHJlbW92ZVxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICd1bmluc3RhbGxOb2RlUG9saWN5Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiB1bmluc3RhbGxOb2RlUG9saWN5KHBvbGljeVJlbW92ZSkge1xuXHRcdFx0XHR2YXIgcG9saWN5UmVtb3ZlTmFtZTtcblx0XHRcdFx0dmFyIHRoaXNOb2RlID0gdGhpcztcblx0XHRcdFx0aWYgKHR5cGVvZiBwb2xpY3lSZW1vdmUgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0cG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlLnBvbGljeU5hbWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0Xyh0aGlzTm9kZS5ub2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24gKHBvbGljeSwgaW5kZXgpIHtcblx0XHRcdFx0XHRpZiAocG9saWN5LnBvbGljeU5hbWUgPT09IHBvbGljeVJlbW92ZU5hbWUpIHtcblx0XHRcdFx0XHRcdHBvbGljeS5kZXN0cm95KCk7XG5cdFx0XHRcdFx0XHR0aGlzTm9kZS5ub2RlUG9saWNpZXMuc3BsaWNlKGluZGV4LCAxKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRpZiAodGhpc05vZGUubm9kZVBvbGljaWVzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0XHRcdHRoaXNOb2RlLmhhc1BvbGljeSA9IGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogQ2FsbGVkIHdoZW4gdGhlcmUgaXMgYSBtb3VzZSBldmVudCBmb3IgdGhpcyBub2RlXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGV2ZW50ICAgICBUaGUgbW91c2UgZXZlbnRcbiAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBkICAgICAgICAgVGhlIG1hdGNoaW5nIG5vZGUgb2JqZWN0XG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ25vZGVQb2xpY3lFdmVudCcsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gbm9kZVBvbGljeUV2ZW50KGV2ZW50LCBkM25vZGUsIGQpIHtcblx0XHRcdFx0Xy5mb3JFYWNoKHRoaXMubm9kZVBvbGljaWVzLCBmdW5jdGlvbiAocG9saWN5KSB7XG5cdFx0XHRcdFx0cG9saWN5W2V2ZW50XShkM25vZGUsIGQpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XSk7XG5cblx0XHRyZXR1cm4gTm9kZTtcblx0fSgpO1xuXG5cdHJldHVybiB7XG5cdFx0Tm9kZTogTm9kZVxuXHR9O1xufV0pO1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmFjdGl2ZWxvZycsIHtcbiAgICAgICAgICAgIHVybDogJy9hY3RpdmVsb2cnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVBY3RpdmVKb2JMb2dzQ3RybCBhcyBub2RlQWN0aXZlSm9iTG9nc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8Y3R2LWxvZ3MgdGl0bGU9XCJBY3RpdmUgSm9iXCIgbG9nPVwibm9kZUFjdGl2ZUpvYkxvZ3NDdHJsLmFjdGl2ZUxvZ3NcIj48L2N0di1sb2dzPidcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVBY3RpdmVKb2JMb2dzQ3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICdMb2dTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsIExvZ1NlcnZpY2UpIHtcbiAgICAgICAgdmFyIG5vZGVBY3RpdmVKb2JMb2dzQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUxvZ3MoKSB7XG4gICAgICAgICAgICBMb2dTZXJ2aWNlLmdldEFjdGl2ZUxvZ3MoKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBub2RlQWN0aXZlSm9iTG9nc0N0cmwuYWN0aXZlTG9ncyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy9PbmNlIHRoZSBqb2IgZmluaXNoZXMsIGVuZHBvaW50IHJldHVybnMgNTAwIGVycm9yLiBTbyByZXNldCB0aGUgYWN0aXZlTG9nc1xuICAgICAgICAgICAgICAgIG5vZGVBY3RpdmVKb2JMb2dzQ3RybC5hY3RpdmVMb2dzID0ge1xuICAgICAgICAgICAgICAgICAgICBkZXNjOiAnVGhlcmUgaXMgY3VycmVudGx5IG5vIGFjdGl2ZSBqb2IuIENoZWNrIExhc3QgSm9iIGZvciBhIGpvYiB0aGF0IHJlY2VudGx5IGZpbmlzaGVkLidcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZ2V0QWN0aXZlTG9ncygpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0QWN0aXZlTG9ncygpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bm9kZWFjdGl2ZWpvYmxvZ3NjdHJsLmpzLm1hcFxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbi8qKlxuICogVGhlIG5vZGUgdGhhdCBpcyB1c2VkIHNwZWNpZmljYWxseSBmb3IgdGhlIHZpc3VhbGl6YXRpb24gdGFiLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnVmlzdWFsaXplck5vZGUnLCBbJ05vZGUnLCBmdW5jdGlvbiAoTm9kZSkge1xuXHR2YXIgVmlzdWFsaXplck5vZGUgPSBmdW5jdGlvbiAoX05vZGUkTm9kZSkge1xuXHRcdF9pbmhlcml0cyhWaXN1YWxpemVyTm9kZSwgX05vZGUkTm9kZSk7XG5cblx0XHQvKipcbiAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgKlxuICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeCAgICAgICBcdHggbG9jYXRpb25cbiAgICogQHBhcmFtICAgICAge251bWJlcn0gIHkgICAgICAgXHR5IGxvY2F0aW9uXG4gICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBpZCAgICAgIFx0VGhlIGlkZW50aWZpZXJcbiAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHRleHQgICAgXHRUaGUgdGV4dCB0byBkaXNwbGF5XG4gICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICByYWRpdXMgIFx0VGhlIHJhZGl1cyBvZiB0aGUgbm9kZVxuICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgcGFyZW50ICAgICBUaGUgcGFyZW50IGlkXG4gICAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBhbmNlc3RvcnMgIEFycmF5IG9mIGFuY2VzdG9ycyBJZFxuICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeFN0YXJ0ICAgICB4IGxvYyB0byBzdGFydCBhbmltYXRpb25cbiAgICogQHBhcmFtICAgICAge251bWJlcn0gIHlTdGFydCAgICAgeSBsb2MgdG8gc3RhcnQgYW5pbWF0aW9uXG4gICAqL1xuXHRcdGZ1bmN0aW9uIFZpc3VhbGl6ZXJOb2RlKHgsIHksIGlkLCB0ZXh0LCByYWRpdXMsIHBhcmVudCwgYW5jZXN0b3JzLCB4U3RhcnQsIHlTdGFydCkge1xuXHRcdFx0X2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZpc3VhbGl6ZXJOb2RlKTtcblxuXHRcdFx0dmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKFZpc3VhbGl6ZXJOb2RlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoVmlzdWFsaXplck5vZGUpKS5jYWxsKHRoaXMsIHgsIHksIGlkLCB0ZXh0LCByYWRpdXMpKTtcblxuXHRcdFx0X3RoaXMucGFyZW50ID0gcGFyZW50O1xuXHRcdFx0X3RoaXMuYW5jZXN0b3JzID0gYW5jZXN0b3JzO1xuXHRcdFx0aWYgKHhTdGFydCA9PSBudWxsKSB7XG5cdFx0XHRcdF90aGlzLnhTdGFydCA9IHg7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRfdGhpcy54U3RhcnQgPSB4U3RhcnQ7XG5cdFx0XHR9XG5cdFx0XHRpZiAoeVN0YXJ0ID09IG51bGwpIHtcblx0XHRcdFx0X3RoaXMueVN0YXJ0ID0geTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdF90aGlzLnlTdGFydCA9IHlTdGFydDtcblx0XHRcdH1cblx0XHRcdHJldHVybiBfdGhpcztcblx0XHR9XG5cblx0XHQvKipcbiAgICogQ2FsbGVkIGR1cmluZyB0aGUgZmlyc3QgdXBkYXRlIGdyYXBoIGZvciBhIG5vZGVcbiAgICpcbiAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gICAgZCAgICAgICAgIFRoZSBtYXRjaGluZyBOb2RlXG4gICAqL1xuXG5cblx0XHRfY3JlYXRlQ2xhc3MoVmlzdWFsaXplck5vZGUsIFt7XG5cdFx0XHRrZXk6ICduZXdOb2RlQXR0cicsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gbmV3Tm9kZUF0dHIoZDNub2RlLCBkKSB7XG5cdFx0XHRcdHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoO1xuXHRcdFx0XHRpZiAodGhpc0dyYXBoLmNvbnN0cy5jb250YWluZXJDbGFzcyAhPSBudWxsICYmIHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFtkLmlkXSA9PSBudWxsKSB7XG5cdFx0XHRcdFx0ZDNub2RlLmNsYXNzZWQodGhpc0dyYXBoLmNvbnN0cy5jb250YWluZXJDbGFzcywgdHJ1ZSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0ZDNub2RlLnRyYW5zaXRpb24oXCJub2RlUG9zaXRpb25UcmFuc2l0aW9uXCIpLmR1cmF0aW9uKDc1MCkuYXR0clR3ZWVuKFwidHJhbnNmb3JtXCIsIGZ1bmN0aW9uIChkKSB7XG5cdFx0XHRcdFx0aWYgKGQueFN0YXJ0ICE9IG51bGwgJiYgZC55U3RhcnQgIT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0dmFyIHhTdGFydCA9IGQueFN0YXJ0O1xuXHRcdFx0XHRcdFx0dmFyIHlTdGFydCA9IGQueVN0YXJ0O1xuXHRcdFx0XHRcdFx0ZC54U3RhcnQgPSBkLng7XG5cdFx0XHRcdFx0XHRkLnlTdGFydCA9IGQueTtcblx0XHRcdFx0XHRcdHJldHVybiBkMy5pbnRlcnBvbGF0ZVN0cmluZyhcInRyYW5zbGF0ZShcIiArIHhTdGFydCArIFwiLFwiICsgeVN0YXJ0ICsgXCIpXCIsIFwidHJhbnNsYXRlKFwiICsgZC54ICsgXCIsXCIgKyBkLnkgKyBcIilcIik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiBkMy5pbnRlcnBvbGF0ZVN0cmluZyhcInRyYW5zbGF0ZShcIiArIGQueCArIFwiLFwiICsgZC55ICsgXCIpXCIsIFwidHJhbnNsYXRlKFwiICsgZC54ICsgXCIsXCIgKyBkLnkgKyBcIilcIik7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1dKTtcblxuXHRcdHJldHVybiBWaXN1YWxpemVyTm9kZTtcblx0fShOb2RlLk5vZGUpO1xuXG5cdHJldHVybiB7XG5cdFx0Tm9kZTogVmlzdWFsaXplck5vZGVcblx0fTtcbn1dKTtcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8yNS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmNvbW1pc3Npb24nLCB7XG4gICAgICAgICAgICB1cmw6ICcvY29tbWlzc2lvbi86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlQ29tbWlzc2lvbkN0cmwgYXMgbm9kZUNvbW1pc3Npb25DdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWNvbW1pc3Npb24uaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVDb21taXNzaW9uQ3RybCcsIFtcbiAgICAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdOb2Rlc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJywgJ05vZGVzU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBOb2Rlc01vZGVsLCBDUlVESGVscGVyU2VydmljZSwgTm9kZXNTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBub2RlQ29tbWlzc2lvbkN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub05vZGVEZXRhaWxzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLmluZm8nLCB7ICdrZXknOiAkc3RhdGVQYXJhbXMua2V5IH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbENvbW1pc3Npb25pbmdOb2RlKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9Ob2RlRGV0YWlscygpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNvbW1pc3Npb24oKSB7XG4gICAgICAgICAgICBpZiAobm9kZUNvbW1pc3Npb25DdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIobm9kZUNvbW1pc3Npb25DdHJsKTtcbiAgICAgICAgICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwubm9kZU9wc09iai5ub2RlcyA9IFskc3RhdGVQYXJhbXMua2V5XTtcbiAgICAgICAgICAgICAgICBOb2Rlc1NlcnZpY2UuY2xlYW51cEV4dHJhVmFycyhub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgICAgICAgICAgICAgIE5vZGVzU2VydmljZS5jcmVhdGVFeHRyYVZhcnMobm9kZUNvbW1pc3Npb25DdHJsKTtcbiAgICAgICAgICAgICAgICBOb2Rlc01vZGVsLmNvbW1pc3Npb24obm9kZUNvbW1pc3Npb25DdHJsLm5vZGVPcHNPYmopLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvTm9kZURldGFpbHMoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihub2RlQ29tbWlzc2lvbkN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLm5vZGVPcHNPYmogPSB7fTtcbiAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLmV4dHJhX3ZhcnMgPSB7fTsgLy9UT0RPIEludGlhbGl6ZSBmcm9tIGdsb2JhbCBzZXR0aW5nc1xuICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuYW5zaWJsZVZhcmlhYmxlcyA9IFtdO1xuICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuZW52VmFyaWFibGVzID0gW107XG4gICAgICAgIE5vZGVzU2VydmljZS5nZXRTZXR0aW5ncyhub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuY2FuY2VsQ29tbWlzc2lvbmluZ05vZGUgPSBjYW5jZWxDb21taXNzaW9uaW5nTm9kZTtcbiAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLmNvbW1pc3Npb24gPSBjb21taXNzaW9uO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVjb21taXNzaW9uY3RybC5qcy5tYXBcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxudmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQob2JqZWN0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IHJldHVybiBnZXQocGFyZW50LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpOyB9IH0gZWxzZSBpZiAoXCJ2YWx1ZVwiIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9O1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbi8qKlxuICogVGhpcyBwb2xpY3kgaXMgdXNlZCB0byBhZGQgYSBzZWxlY3Qgbm9kZSBmZWF0dXJlLlxuICogU3VwcG9ydHMgc2VsZWN0aW5nIG11bHRpcGxlIG5vZGVzIGJ5IHVzaW5nIHRoZSBjdHJsIGtleS5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ05vZGVTZWxlY3Rpb25Qb2xpY3knLCBbJ1BvbGljeScsIGZ1bmN0aW9uIChQb2xpY3kpIHtcbiAgICB2YXIgTm9kZVNlbGVjdGlvblBvbGljeSA9IGZ1bmN0aW9uIChfUG9saWN5JFBvbGljeSkge1xuICAgICAgICBfaW5oZXJpdHMoTm9kZVNlbGVjdGlvblBvbGljeSwgX1BvbGljeSRQb2xpY3kpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBOb2RlU2VsZWN0aW9uUG9saWN5KCkge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE5vZGVTZWxlY3Rpb25Qb2xpY3kpO1xuXG4gICAgICAgICAgICByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKE5vZGVTZWxlY3Rpb25Qb2xpY3kuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihOb2RlU2VsZWN0aW9uUG9saWN5KSkuY2FsbCh0aGlzLCBcIk5vZGVTZWxlY3Rpb25Qb2xpY3lcIikpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENhbGxlZCB3aGVuIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICogT3ZlcndyaXRlcyB0aGUgb24gZHJhZyBldmVudCBvZiB0aGUgZ3JhcGhcbiAgICAgICAgICogXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoIGl0IGlzIFxuICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFsbGVkIG9uXG4gICAgICAgICovXG5cblxuICAgICAgICBfY3JlYXRlQ2xhc3MoTm9kZVNlbGVjdGlvblBvbGljeSwgW3tcbiAgICAgICAgICAgIGtleTogJ2luaXRpYWxpemUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemUoZ3JhcGgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF9nZXQoTm9kZVNlbGVjdGlvblBvbGljeS5wcm90b3R5cGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihOb2RlU2VsZWN0aW9uUG9saWN5LnByb3RvdHlwZSksICdpbml0aWFsaXplJywgdGhpcykuY2FsbCh0aGlzLCBncmFwaCk7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLnNlbGVjdGVkTm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgY29uc3RzID0gZ3JhcGguY29uc3RzLk5vZGVTZWxlY3Rpb25Qb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICBjb25zdHMuc2VsZWN0ZWRDbGFzcyA9IFwic2VsZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAvL292ZXJ3cml0dGluZyBncmFwaCdzIG5vZGUgb24gZHJhZyBldmVudCB0byBzdXBwb3J0XG4gICAgICAgICAgICAgICAgLy9tb3ZpbmcgbXVsdGlwbGUgbm9kZXMgYXQgb25jZVxuICAgICAgICAgICAgICAgIHZhciBkcmFnID0gZ3JhcGguZHJhZztcbiAgICAgICAgICAgICAgICBkcmFnLm9uKCdkcmFnJywgZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IGdyYXBoO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZWxlY3RlZENsYXNzID0gdGhpc0dyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5LnNlbGVjdGVkQ2xhc3M7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0aW9uID0gZDMuc2VsZWN0QWxsKCcuJyArIHNlbGVjdGVkQ2xhc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0aW9uWzBdLmluZGV4T2YodGhpcykgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb24uY2xhc3NlZChzZWxlY3RlZENsYXNzLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uID0gZDMuc2VsZWN0KHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGlvbi5jbGFzc2VkKHNlbGVjdGVkQ2xhc3MsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb24uYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbiAoZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCArPSBkMy5ldmVudC5keDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gZDMuZXZlbnQuZHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwidHJhbnNsYXRlKFwiICsgW2QueCwgZC55XSArIFwiKVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEFkZHMgdGhlIGdpdmVuIG5vZGUgdG8gdGhlIGFycmF5IG9mIHNlbGVjdGVkIG5vZGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNOb2RlICAgIFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gICAgICBub2RlRGF0YSAgTWF0Y2hpbmcgTm9kZSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2FkZFNlbGVjdE5vZGUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZFNlbGVjdE5vZGUoZDNOb2RlLCBub2RlRGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzLk5vZGVTZWxlY3Rpb25Qb2xpY3k7XG5cbiAgICAgICAgICAgICAgICBkM05vZGUuY2xhc3NlZChjb25zdHMuc2VsZWN0ZWRDbGFzcywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgc3RhdGUuc2VsZWN0ZWROb2Rlcy5wdXNoKG5vZGVEYXRhKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmVzIHRoZSBnaXZlbiBub2RlIGZyb20gdGhlIGFycmF5IG9mIHNlbGVjdGVkIG5vZGVzLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzTm9kZSAgICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgbm9kZURhdGEgIE1hdGNoaW5nIG5vZGUgb2JqZWN0IFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAncmVtb3ZlU2VsZWN0RnJvbU5vZGUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZVNlbGVjdEZyb21Ob2RlKGQzTm9kZSwgbm9kZURhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZmlsdGVyKGZ1bmN0aW9uIChjZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2QuaWQgPT09IG5vZGVEYXRhLmlkO1xuICAgICAgICAgICAgICAgIH0pLmNsYXNzZWQoY29uc3RzLnNlbGVjdGVkQ2xhc3MsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBzdGF0ZS5zZWxlY3RlZE5vZGVzLmluZGV4T2Yobm9kZURhdGEpO1xuICAgICAgICAgICAgICAgIHN0YXRlLnNlbGVjdGVkTm9kZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmVzIGFsbCBzZWxlY3RlZCBub2Rlcy5cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3JlbW92ZUFsbFNlbGVjdGVkTm9kZXMnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZUFsbFNlbGVjdGVkTm9kZXMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmNsYXNzZWQoY29uc3RzLnNlbGVjdGVkQ2xhc3MsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zZWxlY3RlZE5vZGVzID0gW107XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogT24gTW91c2Vkb3duLCBkZXRlcm1pbmVzIHdoZXRoZXIgdG8gY2hhbmdlIHRoZVxuICAgICAgICAgICAgICogc2VsZWN0ZWQgc3RhdHVzIG9mIHRoZSBjbGlja2VkIG5vZGUuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgZCAgICAgICBNYXRjaGluZyBOb2RlIE9iamVjdCAgICAgICBcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ21vdXNlZG93bicsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbW91c2Vkb3duKGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuICAgICAgICAgICAgICAgIGQzLmV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIGlmIChkMy5ldmVudC5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5zZWxlY3RlZE5vZGVzLmluZGV4T2YoZCkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVTZWxlY3RGcm9tTm9kZShkM25vZGUsIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRTZWxlY3ROb2RlKGQzbm9kZSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHN0YXRlLnNlbGVjdGVkTm9kZXMuaW5kZXhPZihkKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIG5vIGNvbnRyb2wga2V5LCBhbmQgY2xpY2tlZCBub3Qgc2VsZWN0ZWQgbm9kZSxcbiAgICAgICAgICAgICAgICAgICAgLy9yZW1vdmUgYWxsIG9mIGN1cnJlbnQgc2VsZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQWxsU2VsZWN0ZWROb2RlcygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBPbiBNb3VzZXVwLCBkZXRlcm1pbmVzIHdoZXRoZXIgdG8gY2hhbmdlIHRoZVxuICAgICAgICAgICAgICogc2VsZWN0ZWQgc3RhdHVzIG9mIHRoZSBjbGlja2VkIG5vZGUuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgZCAgICAgICBNYXRjaGluZyBOb2RlIE9iamVjdFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnbW91c2V1cCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbW91c2V1cChkM25vZGUsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeTtcbiAgICAgICAgICAgICAgICBpZiAoIWQzLmV2ZW50LmN0cmxLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9pZiBsZW5ndGggaXMgZ3JlYXRlciB0aGFuIDEsIHRoZW4gd2UgYXJlIG1vdmluZyBtdWx0aXBsZSBub2Rlc1xuICAgICAgICAgICAgICAgICAgICAvL2xlYXZlIHRoZW0gYWxsIGhpZ2hsaWdodGVkXG4gICAgICAgICAgICAgICAgICAgIC8vb3RoZXJ3aXNlIHdlIGFyZSBqdXN0IG1vdmluZyBvbmUgbm9kZSwgc28gdW5oaWdobGlnaHRcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLnNlbGVjdGVkTm9kZXMubGVuZ3RoIDw9IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlU2VsZWN0RnJvbU5vZGUoZDNub2RlLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfV0pO1xuXG4gICAgICAgIHJldHVybiBOb2RlU2VsZWN0aW9uUG9saWN5O1xuICAgIH0oUG9saWN5LlBvbGljeSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBQb2xpY3k6IE5vZGVTZWxlY3Rpb25Qb2xpY3lcbiAgICB9O1xufV0pO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzI1LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVEZXRhaWxzQ3RybCBhcyBub2RlRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2RlZGV0YWlscy5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLmluZm8nLCB7XG4gICAgICAgICAgICB1cmw6ICcvaW5mbycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZURldGFpbHNDdHJsIGFzIG5vZGVEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVpbmZvLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMuc3RhdHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvc3RhdHMnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVEZXRhaWxzQ3RybCBhcyBub2RlRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2Rlc3RhdHMuaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMuZGV0YWlscy5sb2dzJywge1xuICAgICAgICAgICAgdXJsOiAnL2xvZ3MnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVEZXRhaWxzQ3RybCBhcyBub2RlRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2RlbG9ncy5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLmVkaXQnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZWRpdCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZURldGFpbHNDdHJsIGFzIG5vZGVEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVpbmZvLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOb2RlRGV0YWlsc0N0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnJHNjb3BlJywgJyRpbnRlcnZhbCcsICdOb2Rlc01vZGVsJywgJ0JncFNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgJHNjb3BlLCAkaW50ZXJ2YWwsIE5vZGVzTW9kZWwsIEJncFNlcnZpY2UpIHtcbiAgICAgICAgdmFyIG5vZGVEZXRhaWxzQ3RybCA9IHRoaXM7XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC5udW1iZXJwYXR0ZXJuID0gQ29udGl2R2xvYmFscy5OVU1CRVJfUkVHRVg7XG4gICAgICAgIGZ1bmN0aW9uIGRlY29tbWlzc2lvbigpIHtcbiAgICAgICAgICAgIHZhciBub2RlT3BzT2JqID0ge1xuICAgICAgICAgICAgICAgIG5vZGVzOiBbJHN0YXRlUGFyYW1zLmtleV1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBOb2Rlc01vZGVsLmRlY29tbWlzc2lvbihub2RlT3BzT2JqKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAvL0Rpc2FibGUgYWxsIGJ1dHRvbnMgaW5pdGlhbGx5LiBQb2xsIHdpbGwgYXNzaWduIHZhbHVlcyBhcHByb3ByaWF0ZWx5LlxuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gdXBncmFkZSgpIHtcbiAgICAgICAgICAgIHZhciBub2RlT3BzT2JqID0ge1xuICAgICAgICAgICAgICAgIG5vZGVzOiBbJHN0YXRlUGFyYW1zLmtleV1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBOb2Rlc01vZGVsLnVwZ3JhZGUobm9kZU9wc09iaikudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy9EaXNhYmxlIGFsbCBidXR0b25zIGluaXRpYWxseS4gUG9sbCB3aWxsIGFzc2lnbiB2YWx1ZXMgYXBwcm9wcmlhdGVseS5cbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEaXNwbGF5IGJ1dHRvbnMgYmFzZWQgb24gc3RhdHVzIG9mIG5vZGVcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHNldEJ1dHRvbkRpc3BsYXkoKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKG5vZGVEZXRhaWxzQ3RybC5ub2RlWydpbnZlbnRvcnlfc3RhdGUnXS5zdGF0dXMpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdVbmFsbG9jYXRlZCc6XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdEZWNvbW1pc3Npb25lZCc6XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdQcm92aXNpb25pbmcnOlxuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0FsbG9jYXRlZCc6XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdDYW5jZWxsZWQnOlxuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdNYWludGVuYW5jZSc6XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnZXROb2RlSW5mbyhyZWxvYWQpIHtcbiAgICAgICAgICAgIE5vZGVzTW9kZWwuZ2V0TW9kZWxCeUtleSgkc3RhdGVQYXJhbXMua2V5LCByZWxvYWQpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubm9kZSA9IG5vZGU7XG4gICAgICAgICAgICAgICAgc2V0QnV0dG9uRGlzcGxheSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gc2V0TW9kZSgpIHtcbiAgICAgICAgICAgIGlmICgkc3RhdGUuaXMoJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMuZWRpdCcpKSB7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm1vZGUgPSAnZWRpdCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubW9kZSA9ICdkZXRhaWxzJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub0luZm8oKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMuaW5mbycpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUJncEluZm8oKSB7XG4gICAgICAgICAgICBpZiAobm9kZURldGFpbHNDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm5laWdoYm9yLmtleSA9ICRzdGF0ZVBhcmFtcy5rZXk7XG4gICAgICAgICAgICAgICAgLy8gYmFja2VuZCBvbmx5IHN1cHBvcnRzIGFkZGluZyBvbmUgbmVpZ2hib3IgY3VycmVudGx5XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm5laWdoYm9ycy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvclsnbmVpZ2hib3InXSA9IGl0ZW0ubmFtZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm5laWdoYm9yWyduZWlnaGJvci1hcyddID0gaXRlbS52YWx1ZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBCZ3BTZXJ2aWNlLnVwZGF0ZUJncChub2RlRGV0YWlsc0N0cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3IgPSByZXN1bHQuY29uZmlnLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvSW5mbygpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0QmdwSW5mbygpIHtcbiAgICAgICAgICAgIEJncFNlcnZpY2UuZ2V0QmdwKG5vZGVEZXRhaWxzQ3RybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm5laWdoYm9yID0gcmVzdWx0O1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdldEJncEluc3BlY3QoKSB7XG4gICAgICAgICAgICBCZ3BTZXJ2aWNlLmdldEJncEluc3BlY3QoJHN0YXRlUGFyYW1zLmtleSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmluc3BlY3QgPSByZXN1bHQ7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnJvdXRlcyA9IHJlc3VsdC5PcGVyLnJvdXRlcztcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuZmlsdGVyZWRyb3V0ZXMgPSByZXN1bHQuT3Blci5yb3V0ZXM7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgbm9kZURldGFpbHNDdHJsLmRlY29tbWlzc2lvbiA9IGRlY29tbWlzc2lvbjtcbiAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGUgPSB1cGdyYWRlO1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2V0TW9kZSA9IHNldE1vZGU7XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGRhdGVCZ3BJbmZvID0gdXBkYXRlQmdwSW5mbztcbiAgICAgICAgbm9kZURldGFpbHNDdHJsLnJldHVyblRvSW5mbyA9IHJldHVyblRvSW5mbztcbiAgICAgICAgbm9kZURldGFpbHNDdHJsLm5laWdoYm9ycyA9IFtdO1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3IgPSB7fTtcbiAgICAgICAgbm9kZURldGFpbHNDdHJsLmtleSA9ICRzdGF0ZVBhcmFtcy5rZXk7XG4gICAgICAgIGdldEJncEluZm8oKTtcbiAgICAgICAgZ2V0QmdwSW5zcGVjdCgpO1xuICAgICAgICBzZXRNb2RlKCk7XG4gICAgICAgIC8vTG9hZCBmcm9tIGNhY2hlIGZvciBxdWljayBkaXNwbGF5IGluaXRpYWxseVxuICAgICAgICBnZXROb2RlSW5mbyhmYWxzZSk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG8tcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXROb2RlSW5mbyh0cnVlKTtcbiAgICAgICAgICAgIH0sIDUwMDApO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1ub2RlZGV0YWlsc2N0cmwuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDYvMTQvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2Lm5vZGVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dk5vZGVzdGF0dXNcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBub2RlOiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2Rlc3RhdHVzLmh0bWwnXG4gICAgfTtcbn0pXG4gICAgLmRpcmVjdGl2ZShcImN0dk5vZGVzdGF0ZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIG5vZGU6ICc9J1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVzdGF0ZS5odG1sJ1xuICAgIH07XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVkaXJlY3RpdmUuanMubWFwXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMuZGlzY292ZXInLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGlzY292ZXInLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVEaXNjb3ZlckN0cmwgYXMgbm9kZURpc2NvdmVyQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVkaXNjb3Zlci5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTm9kZURpc2NvdmVyQ3RybCcsIFtcbiAgICAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdOb2Rlc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJywgJ05vZGVzU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBOb2Rlc01vZGVsLCBDUlVESGVscGVyU2VydmljZSwgTm9kZXNTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBub2RlRGlzY292ZXJDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Ob2RlcygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubm9kZXMubGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbERpc2NvdmVyaW5nTm9kZSgpIHtcbiAgICAgICAgICAgIHJldHVyblRvTm9kZXMoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBkaXNjb3ZlcigpIHtcbiAgICAgICAgICAgIGlmIChub2RlRGlzY292ZXJDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICAgICAgICAgIGNyZWF0ZUlQQWRkckFycmF5KCk7XG4gICAgICAgICAgICAgICAgTm9kZXNTZXJ2aWNlLmNyZWF0ZUV4dHJhVmFycyhub2RlRGlzY292ZXJDdHJsKTtcbiAgICAgICAgICAgICAgICBOb2Rlc01vZGVsLmRpc2NvdmVyKG5vZGVEaXNjb3ZlckN0cmwubm9kZU9wc09iaikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvTm9kZXMoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Iobm9kZURpc2NvdmVyQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVJUEFkZHJBcnJheSgpIHtcbiAgICAgICAgICAgIG5vZGVEaXNjb3ZlckN0cmwubm9kZU9wc09iai5hZGRycyA9IF8ud29yZHMobm9kZURpc2NvdmVyQ3RybC5ub2RlSVBBZGRyLCAvW14sIF0rL2cpO1xuICAgICAgICB9XG4gICAgICAgIG5vZGVEaXNjb3ZlckN0cmwubm9kZU9wc09iaiA9IHt9O1xuICAgICAgICBub2RlRGlzY292ZXJDdHJsLmV4dHJhX3ZhcnMgPSB7fTsgLy9UT0RPIEludGlhbGl6ZSBmcm9tIGdsb2JhbCBzZXR0aW5nc1xuICAgICAgICBub2RlRGlzY292ZXJDdHJsLmFuc2libGVWYXJpYWJsZXMgPSBbXTtcbiAgICAgICAgbm9kZURpc2NvdmVyQ3RybC5lbnZWYXJpYWJsZXMgPSBbXTtcbiAgICAgICAgbm9kZURpc2NvdmVyQ3RybC5ub2RlSVBBZGRyID0gJyc7IC8vSVAgYWRkcmVzcyBvZiBub2RlcyB0byBkaXNjb3ZlclxuICAgICAgICBOb2Rlc1NlcnZpY2UuZ2V0U2V0dGluZ3Mobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgICAgIG5vZGVEaXNjb3ZlckN0cmwuZGlzY292ZXIgPSBkaXNjb3ZlcjtcbiAgICAgICAgbm9kZURpc2NvdmVyQ3RybC5jYW5jZWxEaXNjb3ZlcmluZ05vZGUgPSBjYW5jZWxEaXNjb3ZlcmluZ05vZGU7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihub2RlRGlzY292ZXJDdHJsKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1ub2RlZGlzY292ZXJjdHJsLmpzLm1hcFxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbi8qKlxuICogVGhpcyBwb2xpY3kgY2hhbmdlcyB0aGUgdmlldyB0byB0aGUgdGltZWdyYXBoIG9mIGxpbmsgZGF0YSBvbiBjbGljay5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ1BhdGhDaGFuZ2VWaWV3UG9saWN5JywgWydQb2xpY3knLCBmdW5jdGlvbiAoUG9saWN5KSB7XG4gICAgdmFyIFBhdGhDaGFuZ2VWaWV3UG9saWN5ID0gZnVuY3Rpb24gKF9Qb2xpY3kkUG9saWN5KSB7XG4gICAgICAgIF9pbmhlcml0cyhQYXRoQ2hhbmdlVmlld1BvbGljeSwgX1BvbGljeSRQb2xpY3kpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYWxsZWQgdG8gYnVpbGQgcG9saWN5XG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgIHtBbmd1bGFyIFN0YXRlfSAgICAkc3RhdGUgICAgVXNlZCB0byBjaGFuZ2Ugdmlld1xuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gUGF0aENoYW5nZVZpZXdQb2xpY3koJHN0YXRlKSB7XG4gICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUGF0aENoYW5nZVZpZXdQb2xpY3kpO1xuXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoUGF0aENoYW5nZVZpZXdQb2xpY3kuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihQYXRoQ2hhbmdlVmlld1BvbGljeSkpLmNhbGwodGhpcywgJ1BhdGhDaGFuZ2VWaWV3UG9saWN5JykpO1xuXG4gICAgICAgICAgICBfdGhpcy4kc3RhdGUgPSAkc3RhdGU7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogR2VuZXJhdGVzIGEgbGlzdCBvZiBhbGwgY2hpbGQgY29udGFpbmVycyBvZiB0aGUgc2VydmljZVxuICAgICAgICAgKiBDYW4gaGFuZGxlIG5lc3RlZCBzZXJ2aWNlcy5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGlkICAgICAgTm9kZSBJRFxuICAgICAgICAgKi9cblxuXG4gICAgICAgIF9jcmVhdGVDbGFzcyhQYXRoQ2hhbmdlVmlld1BvbGljeSwgW3tcbiAgICAgICAgICAgIGtleTogJ2dlbmVyYXRlTGlzdCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2VuZXJhdGVMaXN0KGlkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciByZXRMaXN0ID0gW107XG4gICAgICAgICAgICAgICAgdmFyIGdlbmVyYXRlTGlzdEhlbHBlciA9IGZ1bmN0aW9uIGdlbmVyYXRlTGlzdEhlbHBlcihpZCwgcmV0TGlzdCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZUlkcyA9IHRoaXNQb2xpY3kuZ3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbaWRdO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVJZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZElkID0gbm9kZUlkc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzUG9saWN5LmdyYXBoLmRhdGFTb3VyY2UuaGFzQ2hpbGQoY2hpbGRJZCkgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUmV0TGlzdCA9IGdlbmVyYXRlTGlzdEhlbHBlcihjaGlsZElkLCByZXRMaXN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXRMaXN0LmNvbmNhdChzdWJSZXRMaXN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0TGlzdC5wdXNoKGNoaWxkSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBnZW5lcmF0ZUxpc3RIZWxwZXIoaWQsIHJldExpc3QpO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXRMaXN0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVzZWQgdG8gcmVyb3V0ZSBhbiBlZGdlIHdoZW4gY2xpY2tlZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtMaW5rfSAgZWRnZSAgICBUaGUgY2xpY2tlZCBlZGdlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd2aWV3RWRnZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmlld0VkZ2UoZWRnZSkge1xuICAgICAgICAgICAgICAgIHZhciBzb3VyY2VMaXN0ID0gW107XG4gICAgICAgICAgICAgICAgdmFyIHRhcmdldExpc3QgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgc291cmNlSWQgPSBlZGdlLnNvdXJjZS5pZDtcbiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0SWQgPSBlZGdlLnRhcmdldC5pZDtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmdyYXBoLmRhdGFTb3VyY2UuaGFzQ2hpbGQoc291cmNlSWQpID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vTm90IGEgY29udGFpbmVyIG5vZGUsIG5lZWQgdG8gYWdncmVnYXRlXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZUxpc3QgPSB0aGlzLmdlbmVyYXRlTGlzdChzb3VyY2VJZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlTGlzdCA9IFtzb3VyY2VJZF07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZ3JhcGguZGF0YVNvdXJjZS5oYXNDaGlsZCh0YXJnZXRJZCkgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9Ob3QgYSBjb250YWluZXIgbm9kZSwgbmVlZCB0byBhZ2dyZWdhdGVcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TGlzdCA9IHRoaXMuZ2VuZXJhdGVMaXN0KHRhcmdldElkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRMaXN0ID0gW3RhcmdldElkXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy4kc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZpc3VhbGl6YXRpb24uZWRnZScsIHsgc291cmNlTmFtZTogc291cmNlSWQsIHRhcmdldE5hbWU6IHRhcmdldElkLFxuICAgICAgICAgICAgICAgICAgICBzb3VyY2VMaXN0OiBzb3VyY2VMaXN0LCB0YXJnZXRMaXN0OiB0YXJnZXRMaXN0IH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdtb3VzZWRvd24nLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdXNlZG93bihkM3BhdGgsIGQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdFZGdlKGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIFBhdGhDaGFuZ2VWaWV3UG9saWN5O1xuICAgIH0oUG9saWN5LlBvbGljeSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBQb2xpY3k6IFBhdGhDaGFuZ2VWaWV3UG9saWN5XG4gICAgfTtcbn1dKTtcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5sYXN0bG9nJywge1xuICAgICAgICAgICAgdXJsOiAnL2xhc3Rsb2cnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVMYXN0Sm9iTG9nc0N0cmwgYXMgbm9kZUxhc3RKb2JMb2dzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxjdHYtbG9ncyB0aXRsZT1cIkxhc3QgSm9iXCIgbG9nPVwibm9kZUxhc3RKb2JMb2dzQ3RybC5sYXN0TG9nc1wiPjwvY3R2LWxvZ3M+J1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTm9kZUxhc3RKb2JMb2dzQ3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICdMb2dTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsIExvZ1NlcnZpY2UpIHtcbiAgICAgICAgdmFyIG5vZGVMYXN0Sm9iTG9nc0N0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBnZXRMYXN0TG9ncygpIHtcbiAgICAgICAgICAgIExvZ1NlcnZpY2UuZ2V0TGFzdExvZ3MoKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBub2RlTGFzdEpvYkxvZ3NDdHJsLmxhc3RMb2dzID0gcmVzdWx0O1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGdldExhc3RMb2dzKCk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG8tcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXRMYXN0TG9ncygpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bm9kZWxhc3Rqb2Jsb2dzY3RybC5qcy5tYXBcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLyoqXG4gKiBCYXNlIHBvbGljeSBjbGFzcyBmb3IgdGhlIGdyYXBoIG9iamVjdFxuICogXG4gKiBQb2xpY2llcyBhcmUgdXNlZCB0byBpc29sYXRlIGZlYXR1cmVzIGZvciBhIGdyYXBoLlxuICogUG9saWNpZXMgY2FuIGJlIGluc3RhbGxlZCBvbiBub2RlcywgbGlua3MsIG9yIHRoZSBncmFwaC5cbiAqIEVhY2ggcG9saWN5IGhhcyBpbnRlcmFjdGlvbiBoYW5kbGVycyB0aGF0IHdpbGwgYmUgY2FsbGVkIGJ5IHRoZSBncmFwaFxuICogaWYgaW5zdGFsbGVkLiBQb2xpY2llcyBjYW4gYWxzbyBtb2RpZnkgZ3JhcGggZnVuY3Rpb25zIChzZWUgUVRpcFBvbGljeSkuXG4gKiBNdWx0aXBsZSBwb2xpY2llcyBjYW4gYmUgaW5zdGFsbGVkIGZvciBhIG5vZGUgb3IgbGluay4gXG4gKiBcbiAqIFRvIHdyaXRlIHlvdXIgb3duIHBvbGljeSwgY3JlYXRlIGEgbmV3IGZhY3RvcnkgdGhhdCB1c2VzIHRoZSBwb2xpY3lcbiAqIHlvdSB3YW50IHRvIGluaGVyaXQgYXMgYSBkZXBlbmRlbmN5LCBhbmQgZXh0ZW5kIGl0cyBwb2xpY3kuIFxuICogUmV0dXJuIHRoZSBjbGFzcyBvYmplY3Qgd2l0aCBQb2xpY3kgYXMga2V5LCBhbmQgXG4gKiBhZGQgdGhlIHBvbGljeSB0byB0aGUgUG9saWN5U2VydmljZSBmYWN0b3J5LlxuICogXG4gKiBGb3Igc2F2aW5nIHN0YXRlIG9yIGNvbnN0cyBmb3IgdGhlIHBvbGljeSwgY3JlYXRlIGEgbmFtZXNwYWNlXG4gKiBpbiBncmFwaC5zdGF0ZSBhbmQgZ3JhcGguY29uc3RzLlxuICogRXguIFxuICogICAgICBncmFwaC5zdGF0ZS5teVBvbGljeSA9IHt9O1xuICogICAgICBncmFwaC5jb25zdHMubXlQb2xpY3kgPSB7fTtcbiAqICAgICAgXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdQb2xpY3knLCBbZnVuY3Rpb24gKCkge1xuICB2YXIgUG9saWN5ID0gZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBwb2xpY3lOYW1lICBUaGUgcG9saWN5IG5hbWVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBQb2xpY3kocG9saWN5TmFtZSkge1xuICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFBvbGljeSk7XG5cbiAgICAgIHRoaXMucG9saWN5TmFtZSA9IHBvbGljeU5hbWU7XG4gICAgICB0aGlzLmdyYXBoID0gbnVsbDtcbiAgICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgd2hlbiB0aGUgcG9saWN5IGlzIGluc3RhbGxlZC5cbiAgICAgKiBcbiAgICAgKiBAcGFyYW0gIHtHcmFwaH0gIGdyYXBoICAgVGhlIEdyYXBoIHRoYXQgdGhlIHBvbGljeSBpc1xuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICBiZWluZyBpbnN0YWxsZWQgb25cbiAgICAgKi9cblxuXG4gICAgX2NyZWF0ZUNsYXNzKFBvbGljeSwgW3tcbiAgICAgIGtleTogJ2luaXRpYWxpemUnLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemUoZ3JhcGgpIHtcbiAgICAgICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgIHRoaXMuZ3JhcGggPSBncmFwaDtcbiAgICAgIH1cblxuICAgICAgLyoqXG4gICAgICAgKiBIYW5kbGVyLCBtZWFudCB0byBiZSBvdmVycmlkZGVuIGluIHN1YmNsYXNzZXNcbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0gIHtkMyBvYmplY3R9ICAgIGQzb2JqICAgIFRoZSBkM29iamVjdFxuICAgICAgICogQHBhcmFtICB7Tm9kZS9MaW5rL0dyYXBofSAgZCAgIFRoZSBvYmplY3QgaXQgd2FzXG4gICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFsbGVkIGZvci4gICAgXG4gICAgICAgKi9cblxuICAgIH0sIHtcbiAgICAgIGtleTogJ21vdXNlb3ZlcicsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gbW91c2VvdmVyKGQzb2JqLCBkKSB7fVxuICAgIH0sIHtcbiAgICAgIGtleTogJ2RibGNsaWNrJyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBkYmxjbGljayhkM29iaiwgZCkge31cbiAgICB9LCB7XG4gICAgICBrZXk6ICdjb250ZXh0bWVudScsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gY29udGV4dG1lbnUoZDNvYmosIGQpIHt9XG4gICAgfSwge1xuICAgICAga2V5OiAnbW91c2VvdXQnLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdXNlb3V0KGQzb2JqLCBkKSB7fVxuICAgIH0sIHtcbiAgICAgIGtleTogJ21vdXNlZG93bicsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gbW91c2Vkb3duKGQzb2JqLCBkKSB7fVxuICAgIH0sIHtcbiAgICAgIGtleTogJ21vdXNldXAnLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdXNldXAoZDNvYmosIGQpIHt9XG5cbiAgICAgIC8qKlxuICAgICAgICogV2lsbCBiZSBjYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgYmVpbmcgZGVzdHJveWVkLlxuICAgICAgICogVXNlZCB0byByZW1vdmUgYW55IGVsZW1lbnRzIG9yIGJpbmRpbmdzIHRoZSBwb2xpY3lcbiAgICAgICAqIGhhcyBhZGRlZC5cbiAgICAgICAqL1xuXG4gICAgfSwge1xuICAgICAga2V5OiAnZGVzdHJveScsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHt9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIFBvbGljeTtcbiAgfSgpO1xuXG4gIHJldHVybiB7XG4gICAgUG9saWN5OiBQb2xpY3lcbiAgfTtcbn1dKTtcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8yMi8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZUxpc3RDdHJsIGFzIG5vZGVMaXN0Q3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVsaXN0Lmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOb2RlTGlzdEN0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdOb2Rlc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIE5vZGVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBub2RlTGlzdEN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBnZXROb2RlcyhyZWxvYWQpIHtcbiAgICAgICAgICAgIE5vZGVzTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihub2RlTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgIG5vZGVMaXN0Q3RybC5ub2RlcyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihub2RlTGlzdEN0cmwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgIGdldE5vZGVzKGZhbHNlKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldE5vZGVzKHRydWUpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bm9kZWxpc3RjdHJsLmpzLm1hcFxuJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIENvbnRhaW5zIGFsbCB0aGUgcG9saWNpZXMuXG4gKiBTZWUgcG9saWN5LmpzIGZvciBpbmZvIG9uIGhvdyBwb2xpY2llcyB3b3JrLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnUG9saWN5U2VydmljZScsIFsnUG9saWN5JywgJ1FUaXBQb2xpY3knLCAnUGF0aENoYW5nZVZpZXdQb2xpY3knLCAnTm9kZVNlbGVjdGlvblBvbGljeScsICdTcGxpdEpvaW5Ob2RlUG9saWN5JywgJ1NwbGl0Sm9pblZpZXdQb2xpY3knLCAnU2F2ZVN0YXRlUG9saWN5JywgZnVuY3Rpb24gKFBvbGljeSwgUVRpcFBvbGljeSwgUGF0aENoYW5nZVZpZXdQb2xpY3ksIE5vZGVTZWxlY3Rpb25Qb2xpY3ksIFNwbGl0Sm9pbk5vZGVQb2xpY3ksIFNwbGl0Sm9pblZpZXdQb2xpY3ksIFNhdmVTdGF0ZVBvbGljeSkge1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgUG9saWN5OiBQb2xpY3kuUG9saWN5LFxuICAgICAgICBRVGlwUG9saWN5OiBRVGlwUG9saWN5LlBvbGljeSxcbiAgICAgICAgUGF0aENoYW5nZVZpZXdQb2xpY3k6IFBhdGhDaGFuZ2VWaWV3UG9saWN5LlBvbGljeSxcbiAgICAgICAgTm9kZVNlbGVjdGlvblBvbGljeTogTm9kZVNlbGVjdGlvblBvbGljeS5Qb2xpY3ksXG4gICAgICAgIFNwbGl0Sm9pbk5vZGVQb2xpY3k6IFNwbGl0Sm9pbk5vZGVQb2xpY3kuUG9saWN5LFxuICAgICAgICBTcGxpdEpvaW5WaWV3UG9saWN5OiBTcGxpdEpvaW5WaWV3UG9saWN5LlBvbGljeSxcbiAgICAgICAgU2F2ZVN0YXRlUG9saWN5OiBTYXZlU3RhdGVQb2xpY3kuUG9saWN5XG4gICAgfTtcbn1dKTtcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYub3JnYW5pemF0aW9ucycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMuY3JlYXRlJywge1xuICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ29yZ2FuaXphdGlvbnMvb3JnYW5pemF0aW9uY3JlYXRlLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ09yZ2FuaXphdGlvbkNyZWF0ZUN0cmwgYXMgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ09yZ2FuaXphdGlvbkNyZWF0ZUN0cmwnLCBbJyRzdGF0ZScsICdPcmdhbml6YXRpb25zTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsIE9yZ2FuaXphdGlvbnNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub09yZ2FuaXphdGlvbnMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMubGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbENyZWF0aW5nKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9Pcmdhbml6YXRpb25zKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlT3JnYW5pemF0aW9uKCkge1xuICAgICAgICAgICAgLy9mb3JtIGNvbnRyb2xsZXIgaXMgaW5qZWN0ZWQgYnkgdGhlIGh0bWwgdGVtcGxhdGVcbiAgICAgICAgICAgIC8vY2hlY2tpbmcgaWYgYWxsIHZhbGlkYXRpb25zIGhhdmUgcGFzc2VkXG4gICAgICAgICAgICBpZiAob3JnYW5pemF0aW9uQ3JlYXRlQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25DcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihvcmdhbml6YXRpb25DcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBvcmdhbml6YXRpb25DcmVhdGVDdHJsLm5ld09yZ2FuaXphdGlvbi5rZXkgPSBvcmdhbml6YXRpb25DcmVhdGVDdHJsLm5ld09yZ2FuaXphdGlvbi50ZW5hbnROYW1lO1xuICAgICAgICAgICAgICAgIE9yZ2FuaXphdGlvbnNNb2RlbC5jcmVhdGUob3JnYW5pemF0aW9uQ3JlYXRlQ3RybC5uZXdPcmdhbml6YXRpb24pLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub09yZ2FuaXphdGlvbnMoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Iob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXNldEZvcm0oKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybC5uZXdPcmdhbml6YXRpb24gPSB7XG4gICAgICAgICAgICAgICAgdGVuYW50TmFtZTogJydcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybC5jcmVhdGVPcmdhbml6YXRpb24gPSBjcmVhdGVPcmdhbml6YXRpb247XG4gICAgICAgIG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwuY2FuY2VsQ3JlYXRpbmcgPSBjYW5jZWxDcmVhdGluZztcbiAgICAgICAgcmVzZXRGb3JtKCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9b3JnYW5pemF0aW9uY3JlYXRlY3RybC5qcy5tYXBcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxudmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQob2JqZWN0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IHJldHVybiBnZXQocGFyZW50LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpOyB9IH0gZWxzZSBpZiAoXCJ2YWx1ZVwiIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9O1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbi8qKlxuICogVGhpcyBwb2xpY3kgYWRkcyB0b29sdGlwIGZ1bmN0aW9uYWxpdHkgdG8gbm9kZXMgYW5kIGxpbmtzLlxuICogV2hlbiBpbnN0YWxsaW5nLCBpbnN0YWxsIG9uIGJvdGggbGlua3MgYW5kIG5vZGVzLlxuICogXG4gKiBVc2VzIHRoZSBxVGlwIGpRdWVyeSBwbHVnaW5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ1FUaXBQb2xpY3knLCBbJ1BvbGljeScsIGZ1bmN0aW9uIChQb2xpY3kpIHtcbiAgICB2YXIgUVRpcFBvbGljeSA9IGZ1bmN0aW9uIChfUG9saWN5JFBvbGljeSkge1xuICAgICAgICBfaW5oZXJpdHMoUVRpcFBvbGljeSwgX1BvbGljeSRQb2xpY3kpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBRVGlwUG9saWN5KCkge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFFUaXBQb2xpY3kpO1xuXG4gICAgICAgICAgICByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKFFUaXBQb2xpY3kuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihRVGlwUG9saWN5KSkuY2FsbCh0aGlzLCBcIlFUaXBQb2xpY3lcIikpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAqIE1vZGlmaWVzIHRoZSB1cGRhdGVOZXdOb2RlcyBhbmQgXG4gICAgICAgICAqIHVwZGF0ZU5ld1BhdGhzIG1ldGhvZCBvZiB0aGUgZ3JhcGggdG8gaW5zdGFsbCBxdGlwXG4gICAgICAgICAqIG9udG8gZWFjaCBub2RlIGFuZCBwYXRoLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaCBpdCBpcyBcbiAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YWxsZWQgb25cbiAgICAgICAgICovXG5cblxuICAgICAgICBfY3JlYXRlQ2xhc3MoUVRpcFBvbGljeSwgW3tcbiAgICAgICAgICAgIGtleTogJ2luaXRpYWxpemUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemUoZ3JhcGgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF9nZXQoUVRpcFBvbGljeS5wcm90b3R5cGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihRVGlwUG9saWN5LnByb3RvdHlwZSksICdpbml0aWFsaXplJywgdGhpcykuY2FsbCh0aGlzLCBncmFwaCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuUVRpcFBvbGljeSA9IHt9O1xuXG4gICAgICAgICAgICAgICAgc3RhdGUubW91c2Vkb3duID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICBncmFwaC5jb25zdHMuUVRpcFBvbGljeSA9IHt9O1xuXG4gICAgICAgICAgICAgICAgLy9UcmFja2luZyBtb3VzZSBjbGljayBzdGF0ZSB0byBtYWtlIHRvb2x0aXBcbiAgICAgICAgICAgICAgICAvL2Rpc2FwcGVhciBpZiB0aGUgbm9kZSBpcyBiZWluZyBkcmFnZ2VkLlxuICAgICAgICAgICAgICAgICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykubW91c2V1cChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5tb3VzZXVwID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvL292ZXJyaWRlIHVwZGF0ZU5ld05vZGVzIGFuZCB1cGRhdGVOZXdQYXRoc1xuICAgICAgICAgICAgICAgIC8vdG8gaW5zdGFsbCBxdGlwXG4gICAgICAgICAgICAgICAgdmFyIGdyYXBoVXBkYXRlTmV3Tm9kZXMgPSBncmFwaC51cGRhdGVOZXdOb2RlcztcbiAgICAgICAgICAgICAgICBncmFwaC51cGRhdGVOZXdOb2RlcyA9IGZ1bmN0aW9uIChuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgICAgICBncmFwaFVwZGF0ZU5ld05vZGVzLmNhbGwoZ3JhcGgsIG5ld05vZGVzKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51cGRhdGVOZXdOb2RlcyhuZXdOb2Rlcyk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHZhciBncmFwaFVwZGF0ZU5ld1BhdGhzID0gZ3JhcGgudXBkYXRlTmV3UGF0aHM7XG4gICAgICAgICAgICAgICAgZ3JhcGgudXBkYXRlTmV3UGF0aHMgPSBmdW5jdGlvbiAobmV3UGF0aHMpIHtcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGhVcGRhdGVOZXdQYXRocy5jYWxsKGdyYXBoLCBuZXdQYXRocyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kudXBkYXRlTmV3UGF0aHMobmV3UGF0aHMpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyBhbGwgcVRpcHMgZnJvbSB0aGUgRE9NLlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIHBvbGljeSBpcyB1bmluc3RhbGxlZCBvclxuICAgICAgICAgICAgICogdGhlIGdyYXBoIGlzIGRlc3Ryb3llZC5cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICAgICAgLy9yZW1vdmluZyBhbGwgcXRpcCBmcm9tIERPTVxuICAgICAgICAgICAgICAgICQoJ1tpZF49XCJxdGlwXCJdJykucmVtb3ZlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogS2VlcGluZyB0cmFjayBvZiBtb3VzZWRvd24gc3RhdGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7ZDNPYmplY3R9ICBkM29iaiAgVGhlIGQzIHBiamVjdFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGUvTGlua30gIGQgICAgIFRoZSBtYXRjaGluZyBkYXRhIG9iamVjdFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnbW91c2Vkb3duJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtb3VzZWRvd24oZDNvYmosIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuUVRpcFBvbGljeTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5tb3VzZWRvd24gPSB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEtlZXBpbmcgdHJhY2sgb2YgbW91c2Vkb3duIHN0YXRlXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzT2JqZWN0fSAgZDNvYmogIFRoZSBkMyBwYmplY3RcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlL0xpbmt9ICBkICAgICBUaGUgbWF0Y2hpbmcgZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ21vdXNldXAnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdXNldXAoZDNvYmosIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuUVRpcFBvbGljeTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5tb3VzZWRvd24gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnd2hlblFUaXBBdmFpbGFibGUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHdoZW5RVGlwQXZhaWxhYmxlKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBpbnRlcnZhbCA9IDUwMDsgLy8gbXNcbiAgICAgICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkKGRvY3VtZW50KS5xdGlwICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dCh0aGlzUG9saWN5LndoZW5RVGlwQXZhaWxhYmxlKGNhbGxiYWNrKSwgaW50ZXJ2YWwpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgaW50ZXJ2YWwpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIE5ldyBOb2RlcyBhcmUgYWRkZWQgZHVyaW5nIHRoZVxuICAgICAgICAgICAgICogdXBkYXRlIGdyYXBoIGZ1bmN0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzTm9kZX0gIG5ld05vZGVzICBUaGUgbmV3IG5vZGVzIHRoYXQgYXJlXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlaW5nIGFkZGVkIHRvIHRoZSBncmFwaFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAndXBkYXRlTmV3Tm9kZXMnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZU5ld05vZGVzKG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlFUaXBQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhdHRhY2hRVGlwKCkge1xuICAgICAgICAgICAgICAgICAgICAvL2F0dGFjaGluZyBxdGlwXG4gICAgICAgICAgICAgICAgICAgIG5ld05vZGVzLmVhY2goZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aGlzTm9kZSA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL0lmIG5vZGUgaGFzIGNoaWxkcmVuLCB0aGVuIGl0IGlzIGEgc2VydmljZVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFtkLmlkXSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IFwiPGI+PHU+U2VsZWN0b3JzOjwvYj48L3U+IFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZWxlY3Rvck1hcCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnNlbGVjdG9yc1tkLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGFzS2V5cyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBzZWxlY3Rvck1hcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNLZXlzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSBrZXkgKyBcIiA6IDxpPlwiICsgc2VsZWN0b3JNYXBba2V5XSArIFwiPC9pPixcXG4gXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoYXNLZXlzID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbW1hIHdpbGwgYmUgcmVtb3ZlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gXCJObyBTZWxlY3RvcnMsIFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IFwiPGI+PHU+TGFiZWxzOjwvYj48L3U+IFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsYWJlbHNNYXAgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5sYWJlbHNbZC5pZF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhhc0tleXMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gbGFiZWxzTWFwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc0tleXMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ICs9IGtleSArIFwiIDogPGk+XCIgKyBsYWJlbHNNYXBba2V5XSArIFwiPC9pPixcXG4gXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoYXNLZXlzID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbW1hIHdpbGwgYmUgcmVtb3ZlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gXCJObyBsYWJlbHMsIFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vcmVtb3ZlIGxhc3QgY29tbWFcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSB0ZXh0LnNsaWNlKDAsIC0yKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzTm9kZSkucXRpcCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogZC5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3c6IGZ1bmN0aW9uIHNob3coKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXBpID0gJCh0aGlzTm9kZSkucXRpcCgnYXBpJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gJCgnI2dyYXBoQ29udGFpbmVyJykub2Zmc2V0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9zaXRpb24gPSBbb2Zmc2V0LmxlZnQgKyAoZC54ICogdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKSArIHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpWzBdKSwgb2Zmc2V0LnRvcCArIChkLnkgKyBkLnJhZGl1cykgKiB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpICsgdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKClbMV1dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBpLnNldCgncG9zaXRpb24udGFyZ2V0JywgcG9zaXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICFzdGF0ZS5tb3VzZWRvd247XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3c6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsYXk6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvbG86ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzZXM6ICdxdGlwLWJsdWUgcXRpcC1zaGFkb3cnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBteTogJ3RvcCBjZW50ZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdDogJ2JvdHRvbSBjZW50ZXInXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRhcmdldDogcG9zaXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQ6ICdtb3VzZWRvd24gbW91c2VsZWF2ZSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vaW5jYXNlIGxpYnJhcnkgaGFzbid0IGxvYWRlZCB5ZXRcbiAgICAgICAgICAgICAgICBpZiAoJChkb2N1bWVudCkucXRpcCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgYXR0YWNoUVRpcCgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMud2hlblFUaXBBdmFpbGFibGUoYXR0YWNoUVRpcCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIG5ldyBwYXRocyBhcmUgYWRkZWQgZHVyaW5nIHRoZVxuICAgICAgICAgICAgICogdXBkYXRlIGdyYXBoIGZ1bmN0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzUGF0aH0gIG5ld1BhdGhzICBUaGUgbmV3IHBhdGhzIHRoYXQgYXJlXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlaW5nIGFkZGVkIHRvIHRoZSBncmFwaFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAndXBkYXRlTmV3UGF0aHMnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZU5ld1BhdGhzKG5ld1BhdGhzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlFUaXBQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICAvL2luY2FzZSBsaWJyYXJ5IGhhc24ndCBsb2FkZWQgeWV0XG4gICAgICAgICAgICAgICAgaWYgKCQoZG9jdW1lbnQpLnF0aXAgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vYWRkaW5nIHF0aXBcbiAgICAgICAgICAgICAgICAgICAgbmV3UGF0aHMuZWFjaChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRoaXNQYXRoID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vZ2V0dGluZyBtaWRwb2ludCBvZiBwYXRoXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aEVsID0gZDMuc2VsZWN0KHRoaXMpLm5vZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtaWRwb2ludCA9IHBhdGhFbC5nZXRQb2ludEF0TGVuZ3RoKHBhdGhFbC5nZXRUb3RhbExlbmd0aCgpIC8gMik7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0UmV0ID0gZC5xdGlwSGVscGVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IFwiQnl0ZXM6IFwiICsgZC5nZXRXZWlnaHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpc1BhdGgpLnF0aXAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3c6IGZ1bmN0aW9uIHNob3coKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2lmIG1vdXNlIGlzIGRvd24sIGRvbid0IGxldCBxdGlwIHNob3dcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhc3RhdGUubW91c2Vkb3duO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGF5OiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb2xvOiAkKCcjZ3JhcGhDb250YWluZXInKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NlczogJ3F0aXAtYmx1ZSBxdGlwLXNoYWRvdydcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG15OiB0YXJnZXRSZXQubXksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0OiAnY2VudGVyIGNlbnRlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogJ21vdXNlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRqdXN0OiB0YXJnZXRSZXQuYWRqdXN0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaWRlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50OiAnbW91c2Vkb3duIG1vdXNlbGVhdmUnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIFFUaXBQb2xpY3k7XG4gICAgfShQb2xpY3kuUG9saWN5KTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIFBvbGljeTogUVRpcFBvbGljeVxuICAgIH07XG59XSk7XG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm9yZ2FuaXphdGlvbnMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5vcmdhbml6YXRpb25zLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdPcmdhbml6YXRpb25EZXRhaWxzQ3RybCBhcyBvcmdhbml6YXRpb25EZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ29yZ2FuaXphdGlvbnMvb3JnYW5pemF0aW9uZGV0YWlscy5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignT3JnYW5pemF0aW9uRGV0YWlsc0N0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnT3JnYW5pemF0aW9uc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIE9yZ2FuaXphdGlvbnNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Pcmdhbml6YXRpb25zKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5vcmdhbml6YXRpb25zLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBkZWxldGVPcmdhbml6YXRpb24oKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgT3JnYW5pemF0aW9uc01vZGVsLmRlbGV0ZShvcmdhbml6YXRpb25EZXRhaWxzQ3RybC5vcmdhbml6YXRpb24pLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIHJldHVyblRvT3JnYW5pemF0aW9ucygpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Iob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsKTtcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsKTtcbiAgICAgICAgT3JnYW5pemF0aW9uc01vZGVsLmdldE1vZGVsQnlLZXkoJHN0YXRlUGFyYW1zLmtleSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChvcmdhbml6YXRpb24pIHtcbiAgICAgICAgICAgIG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsLm9yZ2FuaXphdGlvbiA9IG9yZ2FuaXphdGlvbjtcbiAgICAgICAgfSk7XG4gICAgICAgIG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsLmRlbGV0ZU9yZ2FuaXphdGlvbiA9IGRlbGV0ZU9yZ2FuaXphdGlvbjtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1vcmdhbml6YXRpb25kZXRhaWxzY3RybC5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNi8xLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnN0b3JhZ2Vwb2xpY2llcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5jcmVhdGUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9zdG9yYWdlcG9saWN5Y3JlYXRlLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1N0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsIGFzIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignU3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnU3RvcmFnZVBvbGljaWVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgU3RvcmFnZVBvbGljaWVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvU3RvcmFnZVBvbGljaWVzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMubGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbENyZWF0aW5nKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9TdG9yYWdlUG9saWNpZXMoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVGaWxlc3lzdGVtQ21kcygpIHtcbiAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLmZpbGVzeXN0ZW1jbWRzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5uZXdTdG9yYWdlUG9saWN5LmZpbGVzeXN0ZW1zW2l0ZW0ubmFtZV0gPSBpdGVtLnZhbHVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlUG9saWN5KCkge1xuICAgICAgICAgICAgLy9mb3JtIGNvbnRyb2xsZXIgaXMgaW5qZWN0ZWQgYnkgdGhlIGh0bWwgdGVtcGxhdGVcbiAgICAgICAgICAgIC8vY2hlY2tpbmcgaWYgYWxsIHZhbGlkYXRpb25zIGhhdmUgcGFzc2VkXG4gICAgICAgICAgICBpZiAoc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBjcmVhdGVGaWxlc3lzdGVtQ21kcygpO1xuICAgICAgICAgICAgICAgIFN0b3JhZ2VQb2xpY2llc01vZGVsLmNyZWF0ZShzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5uZXdTdG9yYWdlUG9saWN5KVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1N0b3JhZ2VQb2xpY2llcygpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmVzZXRGb3JtKCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwubmV3U3RvcmFnZVBvbGljeSA9IHtcbiAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICBcImJhY2tlbmRzXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJjcnVkXCI6IFwiY2VwaFwiLFxuICAgICAgICAgICAgICAgICAgICBcIm1vdW50XCI6IFwiY2VwaFwiLFxuICAgICAgICAgICAgICAgICAgICBcInNuYXBzaG90XCI6IFwiY2VwaFwiXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBcInVubG9ja2VkXCI6IGZhbHNlLFxuICAgICAgICAgICAgICAgIFwiZHJpdmVyXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJwb29sXCI6IFwicmJkXCJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFwiY3JlYXRlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJzaXplXCI6IFwiMFwiLFxuICAgICAgICAgICAgICAgICAgICBcImZpbGVzeXN0ZW1cIjogXCJcIlxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXCJydW50aW1lXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJzbmFwc2hvdHNcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgXCJzbmFwc2hvdFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImZyZXF1ZW5jeVwiOiBcIjMwbVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJrZWVwXCI6IDIwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFwicmF0ZS1saW1pdFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcIndyaXRlLWlvcHNcIjogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVhZC1pb3BzXCI6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIndyaXRlLWJwc1wiOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWFkLWJwc1wiOiAwXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFwiZmlsZXN5c3RlbXNcIjoge31cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwuY3JlYXRlUG9saWN5ID0gY3JlYXRlUG9saWN5O1xuICAgICAgICBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5jYW5jZWxDcmVhdGluZyA9IGNhbmNlbENyZWF0aW5nO1xuICAgICAgICBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5maWxlc3lzdGVtY21kcyA9IFtdO1xuICAgICAgICByZXNldEZvcm0oKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdG9yYWdlcG9saWN5Y3JlYXRlY3RybC5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8yNy8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zdG9yYWdlcG9saWNpZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1N0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCBhcyBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL3N0b3JhZ2Vwb2xpY3lkZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5lZGl0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU3RvcmFnZVBvbGljeURldGFpbHNDdHJsIGFzIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvc3RvcmFnZXBvbGljeWRldGFpbHMuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1N0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnU3RvcmFnZVBvbGljaWVzTW9kZWwnLCAnVm9sdW1lc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBTdG9yYWdlUG9saWNpZXNNb2RlbCwgVm9sdW1lc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsID0gdGhpcztcbiAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmZpbGVzeXN0ZW1jbWRzID0gW107XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUbyBzaG93IGVkaXQgb3IgZGV0YWlscyBzY3JlZW4gYmFzZWQgb24gdGhlIHJvdXRlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBzZXRNb2RlKCkge1xuICAgICAgICAgICAgaWYgKCRzdGF0ZS5pcygnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmVkaXQnKSkge1xuICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5tb2RlID0gJ2VkaXQnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLm1vZGUgPSAnZGV0YWlscyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Qb2xpY2llcygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1BvbGljeURldGFpbHMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5kZXRhaWxzJywgeyAna2V5Jzogc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnBvbGljeS5uYW1lIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbEVkaXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub1BvbGljeURldGFpbHMoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBkZWxldGVQb2xpY3koKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbC5kZWxldGVVc2luZ0tleShzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5Lm5hbWUsICduYW1lJykudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIHJldHVyblRvUG9saWNpZXMoKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IHZvbHVtZXMgYmVsb25naW5nIHRvIGEgcG9saWN5XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBnZXRWb2x1bWVzKHJlbG9hZCkge1xuICAgICAgICAgICAgVm9sdW1lc01vZGVsLmdldChyZWxvYWQpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC52b2x1bWVzID0gJGZpbHRlcignb3JkZXJCeScpKF8uZmlsdGVyKHJlc3VsdCwge1xuICAgICAgICAgICAgICAgICAgICAncG9saWN5Jzogc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnBvbGljeS5uYW1lXG4gICAgICAgICAgICAgICAgfSksICduYW1lJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBpbml0aWFsaXplRmlsZXN5c3RlbUNtZHNBcnJheSgpIHtcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5LmZpbGVzeXN0ZW1zLCBmdW5jdGlvbiAodmFsdWUsIGtleSkge1xuICAgICAgICAgICAgICAgIHRoaXMucHVzaCh7IG5hbWU6IGtleSwgdmFsdWU6IHZhbHVlIH0pO1xuICAgICAgICAgICAgfSwgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmZpbGVzeXN0ZW1jbWRzKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVGaWxlc3lzdGVtQ21kcygpIHtcbiAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5maWxlc3lzdGVtY21kcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnBvbGljeS5maWxlc3lzdGVtc1tpdGVtLm5hbWVdID0gaXRlbS52YWx1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHNhdmVQb2xpY3koKSB7XG4gICAgICAgICAgICAvL2Zvcm0gY29udHJvbGxlciBpcyBpbmplY3RlZCBieSB0aGUgaHRtbCB0ZW1wbGF0ZVxuICAgICAgICAgICAgLy9jaGVja2luZyBpZiBhbGwgdmFsaWRhdGlvbnMgaGF2ZSBwYXNzZWRcbiAgICAgICAgICAgIGlmIChzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIGNyZWF0ZUZpbGVzeXN0ZW1DbWRzKCk7XG4gICAgICAgICAgICAgICAgU3RvcmFnZVBvbGljaWVzTW9kZWwuc2F2ZShzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1BvbGljeURldGFpbHMoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgU3RvcmFnZVBvbGljaWVzTW9kZWwuZ2V0TW9kZWxCeUtleSgkc3RhdGVQYXJhbXMua2V5LCBmYWxzZSwgJ25hbWUnKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnBvbGljeSA9IHBvbGljeTtcbiAgICAgICAgICAgIGluaXRpYWxpemVGaWxlc3lzdGVtQ21kc0FycmF5KCk7XG4gICAgICAgICAgICBnZXRWb2x1bWVzKGZhbHNlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5kZWxldGVQb2xpY3kgPSBkZWxldGVQb2xpY3k7XG4gICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5zYXZlUG9saWN5ID0gc2F2ZVBvbGljeTtcbiAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmNhbmNlbEVkaXRpbmcgPSBjYW5jZWxFZGl0aW5nO1xuICAgICAgICBzZXRNb2RlKCk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG9yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldFZvbHVtZXModHJ1ZSk7XG4gICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdG9yYWdlcG9saWN5ZGV0YWlsc2N0cmwuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDYvMi8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoXCJjb250aXYuc3RvcmFnZXBvbGljaWVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dlN0b3JhZ2Vwb2xpY3liYXNpY3NldHRpbmdzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge307XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZTdG9yYWdlcG9saWN5ZmlsZXN5c3RlbXNldHRpbmdzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgcG9saWN5OiAnPScsXG4gICAgICAgICAgICBmaWxlc3lzdGVtY21kczogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSkge1xuICAgICAgICAgICAgc2NvcGUuZmlsZXN5c3RlbXMgPSBbJ2V4dDQnLCAnYnRyZnMnXTtcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL2ZpbGVzeXN0ZW1zZXR0aW5ncy5odG1sJ1xuICAgIH07XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZTdG9yYWdlcG9saWN5c25hcHNob3RzZXR0aW5nc1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIHBvbGljeTogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9zbmFwc2hvdHNldHRpbmdzLmh0bWwnXG4gICAgfTtcbn0pXG4gICAgLmRpcmVjdGl2ZShcImN0dlN0b3JhZ2Vwb2xpY3lyd29wc3NldHRpbmdzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgcG9saWN5OiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL3J3b3Bzc2V0dGluZ3MuaHRtbCdcbiAgICB9O1xufSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2U3RvcmFnZXBvbGljeWJhY2tlbmRkcml2ZXJzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgcG9saWN5OiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL2JhY2tlbmRkcml2ZXJzLmh0bWwnXG4gICAgfTtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3RvcmFnZXBvbGljeWRpcmVjdGl2ZS5qcy5tYXBcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG4vKipcbiAqIFRoaXMgcG9saWN5IHByb3ZpZGVzIGEgd2F5IGZvciBwcm9wZXJ0aWVzIHRvIGJlIHNhdmVkIFxuICogYmV0d2VlbiB2aWV3IGNoYW5nZXNcbiAqIFxuICogSXQgbW9kaWZpZXMgdGhlIGRlc3Ryb3kgZnVuY3Rpb24gdG8gYWxzbyBwYXNzIGluIGFuIG9iamVjdCB0aGF0XG4gKiB3aWxsIGhhdmUgYWxsIGl0cyBwcm9wZXJ0aWVzIHNhdmVkIGFuZCB3aWxsIGJlIGF2YWlsYWJsZSBcbiAqIG9uIGdyYXBoIGxvYWQuIFdoZW4gc2F2aW5nIHZhcmlhYmxlcyB0byB0aGUgb2JqZWN0LCBuYW1lc3BhY2Ugd2l0aFxuICogdGhlIHBvbGljeSBuYW1lLlxuICogXG4gKiBUaGlzIHBvbGljeSBtdXN0IGJlIGxvYWRlZCBmaXJzdCBpbiBvcmRlciBmb3IgaXQgc2F2ZWQgdmFyaWFibGVzIFxuICogdG8gYmUgbG9hZGVkIHdoZW4gdGhlIHZpZXcgY29tZXMgYmFjayB0byB0aGUgZ3JhcGhcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ1NhdmVTdGF0ZVBvbGljeScsIFsnUG9saWN5JywgZnVuY3Rpb24gKFBvbGljeSkge1xuICAgIHZhciBTYXZlU3RhdGVQb2xpY3kgPSBmdW5jdGlvbiAoX1BvbGljeSRQb2xpY3kpIHtcbiAgICAgICAgX2luaGVyaXRzKFNhdmVTdGF0ZVBvbGljeSwgX1BvbGljeSRQb2xpY3kpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUYWtlcyBpbiB0aGUgYW5ndWxhciBzZXJ2aWNlIHRvIHdoaWNoIGl0IHdpbGxcbiAgICAgICAgICogc2F2ZSBpdCdzIHByb3BlcnRpZXMgdG8uXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBzYXZlZFN0YXRlICBPYmplY3QgdG8gc2F2ZSBcbiAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXMgdG9cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIFNhdmVTdGF0ZVBvbGljeShzYXZlZFN0YXRlKSB7XG4gICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU2F2ZVN0YXRlUG9saWN5KTtcblxuICAgICAgICAgICAgdmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKFNhdmVTdGF0ZVBvbGljeS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFNhdmVTdGF0ZVBvbGljeSkpLmNhbGwodGhpcywgJ1NhdmVTdGF0ZVBvbGljeScpKTtcblxuICAgICAgICAgICAgX3RoaXMuc2F2ZWRTdGF0ZSA9IHNhdmVkU3RhdGU7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICogTW9kaWZpZXMgdGhlIGRlc3Ryb3kgbWV0aG9kIFxuICAgICAgICAgKiBhbmQgYWRkcyBhIGxvYWQgbWV0aG9kIHRvIHRoZSBncmFwaFxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaCBpdCBpcyBcbiAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YWxsZWQgb25cbiAgICAgICAgICovXG5cblxuICAgICAgICBfY3JlYXRlQ2xhc3MoU2F2ZVN0YXRlUG9saWN5LCBbe1xuICAgICAgICAgICAga2V5OiAnaW5pdGlhbGl6ZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdGlhbGl6ZShncmFwaCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZ3JhcGggPSBncmFwaDtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgZ3JhcGguZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS5ncmFwaERlc3Ryb3kuY2FsbChncmFwaCwgdGhpc1BvbGljeS5zYXZlZFN0YXRlKTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgZ3JhcGgubG9hZCA9IGZ1bmN0aW9uIChzYXZlZFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kuZ3JhcGhMb2FkLmNhbGwoZ3JhcGgsIHNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2lsbCBvdmVycmlkZSB0aGUgZ3JhcGgncyBkZWZhdWx0IGRlc3Ryb3ksIHdpdGggXG4gICAgICAgICAgICAgKiB0aGlzIHBvbGljeSdzIHNhdmVkU3RhdGUgcGFzc2VkIGluLlxuICAgICAgICAgICAgICogQ2FsbGVkIHdpdGggdGhpcyBhcyB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgc2F2ZWRTdGF0ZSAgVGhlIHNhdmVkIHN0YXRlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdncmFwaERlc3Ryb3knLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdyYXBoRGVzdHJveShzYXZlZFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KHNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3kuZGVzdHJveShzYXZlZFN0YXRlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gdGhpc0dyYXBoLmJpbmRpbmdzKSB7XG4gICAgICAgICAgICAgICAgICAgICQod2luZG93KS5vZmYoa2V5LCB0aGlzR3JhcGguYmluZGluZ3Nba2V5XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgYmUgY2FsbGVkIHdpdGggdGhlIGdyYXBoIGFzIHRoaXNcbiAgICAgICAgICAgICAqIFVzZWQgdG8gaGF2ZSBhbGwgb3RoZXIgcG9saWNpZXMgdXNlIHRoZSBsb2FkIHN0YXRlXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIHNhdmVkU3RhdGUgIFRoZSBzYXZlZCBzdGF0ZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZ3JhcGhMb2FkJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBncmFwaExvYWQoc2F2ZWRTdGF0ZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9saWN5LmxvYWQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9saWN5LmxvYWQoc2F2ZWRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvbGljeS5sb2FkICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljeS5sb2FkKHNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1dKTtcblxuICAgICAgICByZXR1cm4gU2F2ZVN0YXRlUG9saWN5O1xuICAgIH0oUG9saWN5LlBvbGljeSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBQb2xpY3k6IFNhdmVTdGF0ZVBvbGljeVxuICAgIH07XG59XSk7XG5cblxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52aXN1YWxpemF0aW9uJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUudmlzdWFsaXphdGlvbi5lZGdlJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9lZGdlL3tzb3VyY2VOYW1lLCB0YXJnZXROYW1lLCBzb3VyY2VMaXN0LCB0YXJnZXRMaXN0fScsXG4gICAgICAgICAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZU5hbWU6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldE5hbWU6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZUxpc3Q6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldExpc3Q6IG51bGxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWaXN1YWxpemF0aW9uRWRnZUN0cmwgYXMgdmlzdWFsaXphdGlvbmVkZ2VDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Zpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbmVkZ2UuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignVmlzdWFsaXphdGlvbkVkZ2VDdHJsJywgW1wiJHNjb3BlXCIsIFwiJGh0dHBcIiwgJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnVmlzdWFsaXphdGlvblNlcnZpY2UnLCAnJGludGVydmFsJyxcbiAgICAgICAgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJHN0YXRlLCAkc3RhdGVQYXJhbXMsIFZpc3VhbGl6YXRpb25TZXJ2aWNlLCAkaW50ZXJ2YWwpIHtcbiAgICAgICAgICAgIHZhciBzb3VyY2VOYW1lID0gJHN0YXRlUGFyYW1zLnNvdXJjZU5hbWU7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0TmFtZSA9ICRzdGF0ZVBhcmFtcy50YXJnZXROYW1lO1xuICAgICAgICAgICAgdmFyIHNvdXJjZUxpc3QgPSAkc3RhdGVQYXJhbXMuc291cmNlTGlzdDtcbiAgICAgICAgICAgIHZhciB0YXJnZXRMaXN0ID0gJHN0YXRlUGFyYW1zLnRhcmdldExpc3Q7XG5cbiAgICAgICAgICAgIC8vSWYgdGhlIHBhZ2UgaXMgcmVsb2FkZWQsIHRoZXNlIHN0YXRlIHBhcmFtcyBhcmUgYWxsIG51bGwsXG4gICAgICAgICAgICAvL3NvIGl0IHdpbGwgcm91dGUgdGhlbSBiYWNrIHRvIHRoZSB2aXN1YWxpemF0aW9uIHRhYiB0b3Agdmlld1xuICAgICAgICAgICAgaWYgKHNvdXJjZUxpc3QgPT0gbnVsbCB8fCB0YXJnZXRMaXN0ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZpc3VhbGl6YXRpb24ubGlzdCcpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgdmFyIHQgPSBkLmdldFNlY29uZHMoKTtcbiAgICAgICAgICAgICRzY29wZS5lZGdlRGF0YUludGVydmFsID0gXG4gICAgICAgICAgICAgICAgJGludGVydmFsKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBWaXN1YWxpemF0aW9uU2VydmljZS5nZXRFZGdlRGF0YShzb3VyY2VMaXN0LCB0YXJnZXRMaXN0LCB0LnRvU3RyaW5nKCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSByZXN1bHQucmVzdWx0cztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHJlc3VsdHMsIGZ1bmN0aW9uKHIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF8uaXNFbXB0eShyKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgKz0gci5zZXJpZXNbMF0udmFsdWVzWzBdWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNvdXJjZU5hbWUgPSBzb3VyY2VOYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS50YXJnZXROYW1lID0gdGFyZ2V0TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZWRnZURhdGEgPSBkYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5lZGdlRGF0YVRpbWUgPSB0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9LCAzMDAwKTtcblxuICAgICAgICAgICAgLy9EZXN0cm95aW5nIHRoZSBpbnRlcnZhbCBmdW5jdGlvbiBvbiByb3V0ZSBjaGFuZ2VcbiAgICAgICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkgeyAkaW50ZXJ2YWwuY2FuY2VsKCRzY29wZS5lZGdlRGF0YUludGVydmFsKTsgfSk7XG5cblxuICAgICAgICAgICAgVmlzdWFsaXphdGlvblNlcnZpY2UuZ2V0T2xkRWRnZURhdGEoc291cmNlTGlzdCwgdGFyZ2V0TGlzdClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHRzID0gcmVzdWx0LnJlc3VsdHM7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlZGdlRGF0YSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAvL3Jlc3VsdHMsIGlmIG5vdCBlbXB0eSwgYXJlIGV4cGVjdGVkIHRvIGhhdmVcbiAgICAgICAgICAgICAgICAgICAgLy82IGRhdGEgZW50cmllc1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2gocmVzdWx0cywgZnVuY3Rpb24ocikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF8uaXNFbXB0eShyKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHIuc2VyaWVzWzBdLnZhbHVlcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoXy5pc0VtcHR5KGVkZ2VEYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goZGF0YSwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRnZURhdGEucHVzaChkWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goZGF0YSwgZnVuY3Rpb24oZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRnZURhdGFbaV0gKz0gZFsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zb3VyY2VOYW1lID0gc291cmNlTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRhcmdldE5hbWUgPSB0YXJnZXROYW1lO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlTGlzdCA9IHNvdXJjZUxpc3Q7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50YXJnZXRMaXN0ID0gdGFyZ2V0TGlzdDtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm9sZEVkZ2VEYXRhID0gZWRnZURhdGE7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICB9XSk7XG5cblxuXG5cblxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG52YXIgX2dldCA9IGZ1bmN0aW9uIGdldChvYmplY3QsIHByb3BlcnR5LCByZWNlaXZlcikgeyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7IH0gfSBlbHNlIGlmIChcInZhbHVlXCIgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH07XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuLyoqXG4gKiBUaGlzIHBvbGljeSBpcyB1c2VkIGZvciBzcGxpdHRpbmcgYSBub2RlIGludG8gaXRzIGNoaWxkcmVuLFxuICogYW5kIGpvaW5pbmcgdGhlbSBiYWNrIHRvIHRoZWlyIHBhcmVudC5cbiAqIFNwbGl0cyBvbiBkb3VibGUgY2xpY2ssIGFuZCBqb2lucyBvbiByaWdodCBjbGljay5cbiAqIElmIG11bHRpcGxlIG5vZGVzIGFyZSBzZWxlY3RlZCBhdCB0aGUgdGltZSBvZiBhIHNwbGl0IG9yIGpvaW4gZXZlbnQsXG4gKiBpdCB3aWxsIHNwbGl0IG9yIGpvaW4gYWxsIG9mIHRoZW0uXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdTcGxpdEpvaW5Ob2RlUG9saWN5JywgWydOb2RlU2VsZWN0aW9uUG9saWN5JywgJ1Zpc3VhbGl6ZXJOb2RlJywgZnVuY3Rpb24gKE5vZGVTZWxlY3Rpb25Qb2xpY3ksIFZpc3VhbGl6ZXJOb2RlKSB7XG4gICAgdmFyIFNwbGl0Sm9pbk5vZGVQb2xpY3kgPSBmdW5jdGlvbiAoX05vZGVTZWxlY3Rpb25Qb2xpY3kkKSB7XG4gICAgICAgIF9pbmhlcml0cyhTcGxpdEpvaW5Ob2RlUG9saWN5LCBfTm9kZVNlbGVjdGlvblBvbGljeSQpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBTcGxpdEpvaW5Ob2RlUG9saWN5KCkge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNwbGl0Sm9pbk5vZGVQb2xpY3kpO1xuXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoU3BsaXRKb2luTm9kZVBvbGljeS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFNwbGl0Sm9pbk5vZGVQb2xpY3kpKS5jYWxsKHRoaXMpKTtcblxuICAgICAgICAgICAgX3RoaXMucG9saWN5TmFtZSA9IFwiU3BsaXRKb2luTm9kZVBvbGljeVwiO1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENhbGxlZCB3aGVuIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGhcbiAgICAgICAgICovXG5cblxuICAgICAgICBfY3JlYXRlQ2xhc3MoU3BsaXRKb2luTm9kZVBvbGljeSwgW3tcbiAgICAgICAgICAgIGtleTogJ2luaXRpYWxpemUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemUoZ3JhcGgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF9nZXQoU3BsaXRKb2luTm9kZVBvbGljeS5wcm90b3R5cGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihTcGxpdEpvaW5Ob2RlUG9saWN5LnByb3RvdHlwZSksICdpbml0aWFsaXplJywgdGhpcykuY2FsbCh0aGlzLCBncmFwaCk7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuU3BsaXRKb2luTm9kZVBvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLnNwbGl0Tm9kZXMgPSBbXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUcmlnZ2VyaW5nIHNwbGl0IG9uIGRvdWJsZSBjbGlja1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBkICAgICAgVGhlIG1hdGNoaW5nIGRhdGEgb2JqZWN0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkYmxjbGljaycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGJsY2xpY2soZDNub2RlLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN1cGVyU3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luTm9kZVBvbGljeTtcblxuICAgICAgICAgICAgICAgIGlmICghZDMuZXZlbnQuY3RybEtleSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3VwZXJTdGF0ZS5zZWxlY3RlZE5vZGVzLmluZGV4T2YoZCkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGxpdE11bHRpcGxlTm9kZXMoc3VwZXJTdGF0ZS5zZWxlY3RlZE5vZGVzKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQWxsU2VsZWN0ZWROb2RlcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGxpdE5vZGUoZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVHJpZ2dlcmluZyBqb2luIG9uIHJpZ2h0IGNsaWNrXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqfSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGQgICAgICBUaGUgbWF0Y2hpbmcgZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2NvbnRleHRtZW51JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb250ZXh0bWVudShkM25vZGUsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3VwZXJTdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuICAgICAgICAgICAgICAgIGQzLmV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgaWYgKCFkMy5ldmVudC5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgdHJ5IHRvIGpvaW4gYSBoaWdobGlnaHRlZCBub2RlIHdoaWxlIG11bHRpcGxlIG5vZGVzIGFyZSBzZWxlY3RlZCxcbiAgICAgICAgICAgICAgICAgICAgLy93ZSBqb2luIGFsbCBoaWdobGlnaHRlZCBub2Rlc1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWROb2RlcyA9IHN1cGVyU3RhdGUuc2VsZWN0ZWROb2RlcztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkTm9kZXMuaW5kZXhPZihkKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGVjdGVkTm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmpvaW5Ob2RlKHNlbGVjdGVkTm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9pZiB3ZSB0cnkgdG8gam9pbiBhIG5vZGUgdGhhdCBpc24ndCBwYXJ0IG9mIGEgaGlnaGxpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAgICAgLy93ZSByZW1vdmUgYWxsIGhpZ2hsaWdodHMgYW5kIHRoZW4gam9pbiB0aGUgY2xpY2tlZCBub2RlXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUFsbFNlbGVjdGVkTm9kZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuam9pbk5vZGUoZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU3BsaXRzIGEgbm9kZS5cbiAgICAgICAgICAgICAqIHVzZWQgdG8gc2hhcmUgY29kZSBiZXR3ZWVuIHNwbGl0Tm9kZSBhbmQgc3BsaXRNdWx0aXBsZU5vZGVzXG4gICAgICAgICAgICAgKiB3aGlsZSBwcmV2ZW50aW5nIHRoZSBoYW5kbGVycyBmb3IgdGhlbSBib3RoIGZpcmluZ1xuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGUgYmVpbmcgc3BsaXRcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIFRoZSBuZXcgbm9kZXMgY3JlYXRlZCBieSB0aGUgc3BsaXRcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ19fc3BsaXROb2RlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfX3NwbGl0Tm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pbk5vZGVQb2xpY3k7XG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBub2RlLmlkO1xuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgLy9pZiBpdCBoYXMgbm8gY2hpbGRyZW4gdG8gc3BsaXQgaW50b1xuICAgICAgICAgICAgICAgIGlmIChjaGlsZHJlbl9zdHJ1Y3RbbmFtZV0gPT09IHVuZGVmaW5lZCB8fCBfLmlzRW1wdHkoY2hpbGRyZW5fc3RydWN0W25hbWVdKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9yZW1vdmluZyB0aGUgbm9kZSBmcm9tIHRoZSBsaXN0IG9mIG5vZGVzXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzID0gXy5maWx0ZXIodGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbiAoZ3JhcGhOb2Rlcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ3JhcGhOb2RlcyAhPSBub2RlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXNHcmFwaC5ub2Rlcyk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlKTtcblxuICAgICAgICAgICAgICAgIC8vZ2V0dGluZyBhbGwgdGhlIG5vZGUgaWQncyBmb3IgZmluZGluZyBmbG93XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVfbmFtZXNfc2V0ID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZV9uYW1lc19zZXQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0uaWQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vc2V0IG9mIG5vZGVzIGFmdGVyIHRoZSBzcGxpdFxuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoaWxkcmVuX3N0cnVjdFtuYW1lXS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBub2RlX25hbWVzX3NldC5wdXNoKGNoaWxkcmVuX3N0cnVjdFtuYW1lXVtpXSk7XG4gICAgICAgICAgICAgICAgICAgIG5ld19ub2Rlcy5wdXNoKGNoaWxkcmVuX3N0cnVjdFtuYW1lXVtpXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciByZXREYXRhID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuZ2V0Rmxvd0JldHdlZW5TZXQobm9kZV9uYW1lc19zZXQpO1xuXG4gICAgICAgICAgICAgICAgLy9mb3JtYXR0aW5nIGRhdGEgZm9yIG5ldyBub2Rlc1xuICAgICAgICAgICAgICAgIHZhciB4TG9jID0gbm9kZS54O1xuICAgICAgICAgICAgICAgIHZhciB5TG9jID0gbm9kZS55O1xuICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnMgPSBub2RlLmFuY2VzdG9ycy5zbGljZSgpO1xuICAgICAgICAgICAgICAgIC8va2VlcGluZyBvcmRlcmluZyB0aGF0IGZpcnN0IGluIGFuY2VzdG9yIGxpc3QgaXMgY2xvc2VzdCBpbiByZWxhdGlvbnNoaXBcbiAgICAgICAgICAgICAgICBhbmNlc3RvcnMuc3BsaWNlKDAsIDAsIG5vZGUuaWQpO1xuICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBub2RlLmlkO1xuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZV9vYmpzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIHJhZGl1cyA9IG5vZGUucmFkaXVzICogdGhpc0dyYXBoLmNvbnN0cy5yYWRpdXNEZWNheTtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZURhdGEgPSByZXREYXRhLm5vZGVEYXRhO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZURhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgLy9jYWxjdWxhdGluZyB3aGljaCBvZiB0aGUgbm9kZXMgaW4gcmV0RGF0YVswXSBhcmUgbmV3XG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXdfbm9kZXMuaW5kZXhPZihub2RlRGF0YVtpXS5pZCkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkID0gbm9kZURhdGFbaV0uaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IG5vZGVEYXRhW2ldLnRleHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGUgPSBuZXcgVmlzdWFsaXplck5vZGUuTm9kZShudWxsLCBudWxsLCBpZCwgdGV4dCwgcmFkaXVzLCBwYXJlbnQsIGFuY2VzdG9ycywgeExvYywgeUxvYyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdfbm9kZS5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMucHVzaChuZXdfbm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdfbm9kZV9vYmpzLnB1c2gobmV3X25vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YShyZXREYXRhLmxpbmtEYXRhLCB0aGlzR3JhcGgubm9kZXMpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0Tm9kZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdExpbmtzKCk7XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS5zcGxpdE5vZGVzLnB1c2gobm9kZS5pZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ld19ub2RlX29ianM7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU3BsaXRzIHRoZSBnaXZlIG5vZGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGUgYmVpbmcgc3BsaXRcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3NwbGl0Tm9kZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3BsaXROb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzID0gdGhpcy5fX3NwbGl0Tm9kZShub2RlKTtcbiAgICAgICAgICAgICAgICBpZiAocmVzID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnNwbGl0Tm9kZUV2ZW50KHJlcyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU3BsaXRzIGFsbCB0aGUgbm9kZXMgcGFzc2VkIGluXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZXMgICBBcnJheSBvZiBub2RlcyB0byBiZSBzcGxpdFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnc3BsaXRNdWx0aXBsZU5vZGVzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzcGxpdE11bHRpcGxlTm9kZXMobm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaDtcbiAgICAgICAgICAgICAgICB2YXIgcmVzTm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSB0aGlzLl9fc3BsaXROb2RlKG5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzTm9kZXMgPSByZXNOb2Rlcy5jb25jYXQocmVzKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLnNwbGl0TXVsdGlwbGVOb2Rlc0V2ZW50KHJlcyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIGFmdGVyIGEgc2luZ2xlIG5vZGUgaXMgc3BsaXRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBuZXdOb2RlcyAgVGhlIG5ldyBub2Rlc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnc3BsaXROb2RlRXZlbnQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNwbGl0Tm9kZUV2ZW50KG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNldFBvc2l0aW9ucygpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBtdWx0aXBsZSBub2RlcyBhcmUgc3BsaXQgYXQgb25jZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5ld05vZGVzICBUaGUgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdzcGxpdE11bHRpcGxlTm9kZXNFdmVudCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3BsaXRNdWx0aXBsZU5vZGVzRXZlbnQobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaDtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc2V0UG9zaXRpb25zKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogdXNlZCB0byBzaGFyZSBjb2RlIGJldHdlZW4gam9pbk5vZGUgYW5kIGpvaW5NdWx0aXBsZU5vZGVcbiAgICAgICAgICAgICAqIHdoaWxlIHByZXZlbnRpbmcgYm90aCBoYW5kbGVycyBmaXJpbmdcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgICAgIG5vZGUgICAgVGhlIG5vZGUgdG8gam9pblxuICAgICAgICAgICAgICogQHJldHVybiAgICAge05vZGV9ICBUaGUgbmV3IG5vZGUgYWZ0ZXIgdGhlIGpvaW5cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ19fam9pbk5vZGUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9fam9pbk5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5Ob2RlUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgLy9jaGVjayB0aGF0IG5vZGUgc3RpbGwgZXhpc3RzXG4gICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG5vZGUpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gbm9kZS5pZDtcbiAgICAgICAgICAgICAgICAvL2lmIGl0IGhhcyBubyBhbmNlc3Rvciwgbm90aGluZyB0byBqb2luXG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbC5pbmRleE9mKG5hbWUpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciB0b19iZV9kZWxldGVkID0gW107XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVfbmFtZXNfc2V0ID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgLy9pZiBub2RlIHdvbid0IGJlIGNvbGxhcHNlZFxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLm5vZGVzW2ldLmFuY2VzdG9ycy5pbmRleE9mKG5vZGUucGFyZW50KSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZV9uYW1lc19zZXQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0uaWQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9fYmVfZGVsZXRlZC5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlX2lkID0gbm9kZS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgbm9kZV9uYW1lc19zZXQucHVzaChub2RlLnBhcmVudCk7XG5cbiAgICAgICAgICAgICAgICAvL2Zvcm1hdHRpbmcgZGF0YVxuICAgICAgICAgICAgICAgIHZhciByYWRpdXMgPSBub2RlLnJhZGl1cyAvIHRoaXNHcmFwaC5jb25zdHMucmFkaXVzRGVjYXk7XG4gICAgICAgICAgICAgICAgdmFyIHhMb2MgPSBub2RlLng7XG4gICAgICAgICAgICAgICAgdmFyIHlMb2MgPSBub2RlLnk7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IG5vZGUuYW5jZXN0b3JzWzFdO1xuICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnMgPSBub2RlLmFuY2VzdG9ycy5zbGljZSgxKTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGUgPSBuZXcgVmlzdWFsaXplck5vZGUuTm9kZSh4TG9jLCB5TG9jLCBuZXdfbm9kZV9pZCwgbmV3X25vZGVfaWQsIHJhZGl1cywgcGFyZW50LCBhbmNlc3RvcnMpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5wdXNoKG5ld19ub2RlKTtcblxuICAgICAgICAgICAgICAgIHZhciByZXREYXRhID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuZ2V0Rmxvd0JldHdlZW5TZXQobm9kZV9uYW1lc19zZXQpO1xuICAgICAgICAgICAgICAgIC8vcmVtb3ZlIGFsbCBub2RlcyB0aGF0IHdpbGwgYmUgam9pbmVkXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b19iZV9kZWxldGVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlX3RvX2RlbGV0ZSA9IHRvX2JlX2RlbGV0ZWRbaV07XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5zcGxpY2UodGhpc0dyYXBoLm5vZGVzLmluZGV4T2Yobm9kZV90b19kZWxldGUpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlX3RvX2RlbGV0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YShyZXREYXRhLmxpbmtEYXRhLCB0aGlzR3JhcGgubm9kZXMpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0Tm9kZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdExpbmtzKCk7XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS5zcGxpdE5vZGVzLnNwbGljZShzdGF0ZS5zcGxpdE5vZGVzLmluZGV4T2YobmV3X25vZGUuaWQpLCAxKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBuZXdfbm9kZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBKb2lucyB0aGUgZ2l2ZW4gbm9kZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZSB0byBqb2luXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdqb2luTm9kZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gam9pbk5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciBuZXdOb2RlID0gdGhpcy5fX2pvaW5Ob2RlKG5vZGUpO1xuICAgICAgICAgICAgICAgIGlmIChuZXdOb2RlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5qb2luTm9kZUV2ZW50KG5ld05vZGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBKb2lucyBhbGwgdGhlIGdpdmVuIG5vZGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZXMgICBUaGUgbm9kZXMgdG8gam9pblxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnam9pbk11bHRpcGxlTm9kZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gam9pbk11bHRpcGxlTm9kZShub2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSB0aGlzLl9fam9pbk5vZGUobm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICBuZXdfbm9kZXMucHVzaChyZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmpvaW5NdWx0aXBsZU5vZGVzRXZlbnQobmV3X25vZGVzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgYWZ0ZXIgYSBzaW5nbGUgbm9kZSBpcyBqb2luZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5ld05vZGUgIFRoZSBuZXcgbm9kZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnam9pbk5vZGVFdmVudCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gam9pbk5vZGVFdmVudChuZXdOb2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIGFmdGVyIG11bHRpcGxlIG5vZGVzIGFyZSBqb2luZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBuZXdOb2RlcyAgVGhlIG5ldyBub2Rlc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnam9pbk11bHRpcGxlTm9kZXNFdmVudCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gam9pbk11bHRpcGxlTm9kZXNFdmVudChuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIFNwbGl0Sm9pbk5vZGVQb2xpY3k7XG4gICAgfShOb2RlU2VsZWN0aW9uUG9saWN5LlBvbGljeSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBQb2xpY3k6IFNwbGl0Sm9pbk5vZGVQb2xpY3lcbiAgICB9O1xufV0pO1xuXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicpXG4gICAgLmRpcmVjdGl2ZShcInZpc3VhbGl6YXRpb25FZGdlXCIsIFsnJHdpbmRvdycsXG4gICAgICAgIGZ1bmN0aW9uKCR3aW5kb3cpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIHZpc3VhbGl6YXRpb25FZGdlRDMoc2NvcGUsIGQzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJvZHlFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF07XG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IGJvZHlFbC5jbGllbnRXaWR0aCAtIDQwMCxcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gIGJvZHlFbC5jbGllbnRIZWlnaHQgLSA0MDA7XG5cblxuICAgICAgICAgICAgICAgIC8vdGFrZW4gZnJvbSBodHRwOi8vYmwub2Nrcy5vcmcvc2ltZW5icmVra2VuLzY2MzQwNzBcbiAgICAgICAgICAgICAgICAvLyAvKiogTUFJTiBTVkcgKiovXG4gICAgICAgICAgICAgICAgdmFyIGxpbWl0ID0gNTksXG4gICAgICAgICAgICAgICAgZHVyYXRpb24gPSA3NTAsXG4gICAgICAgICAgICAgICAgbm93ID0gbmV3IERhdGUoRGF0ZS5ub3coKSAtIGR1cmF0aW9uKTtcblxuICAgICAgICAgICAgICAgIHZhciBncm91cHMgPSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdvcmFuZ2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZDMucmFuZ2UobGltaXQpLm1hcChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNjb3BlLm9sZEVkZ2VEYXRhW01hdGguZmxvb3IoZC8xMCldIHx8IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgeCA9IGQzLnRpbWUuc2NhbGUoKVxuICAgICAgICAgICAgICAgICAgICAuZG9tYWluKFtub3cgLSAobGltaXQgLSAyKSwgbm93IC0gZHVyYXRpb25dKVxuICAgICAgICAgICAgICAgICAgICAucmFuZ2UoWzAsIHdpZHRoXSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgeSA9IGQzLnNjYWxlLmxpbmVhcigpXG4gICAgICAgICAgICAgICAgICAgIC5kb21haW4oWzAsIGQzLm1heChncm91cHMuY3VycmVudC5kYXRhLCBmdW5jdGlvbiAoZCkgeyByZXR1cm4gZCArIDEwOyB9KV0pXG4gICAgICAgICAgICAgICAgICAgIC5yYW5nZShbaGVpZ2h0LCAwXSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbGluZSA9IGQzLnN2Zy5saW5lKClcbiAgICAgICAgICAgICAgICAgICAgLmludGVycG9sYXRlKCdiYXNpcycpXG4gICAgICAgICAgICAgICAgICAgIC54KGZ1bmN0aW9uKGQsIGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB4KG5vdyAtIChsaW1pdCAtIDEgLSBpKSAqIGR1cmF0aW9uKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAueShmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geShkKVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHZhciB4U3ZnID0gZDMuc2VsZWN0KCcuZ3JhcGgnKS5hcHBlbmQoJ3N2ZycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd3aWR0aCcsIDI1KVxuICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ292ZXJmbG93JywgJ3Zpc2libGUnKVxuICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ3Bvc2l0aW9uJywgJ2ZpeGVkJyk7XG5cbiAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgIHZhciB5QXhpcyA9IHhTdmcuYXBwZW5kKCdnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ3kgYXhpcycpXG4gICAgICAgICAgICAgICAgICAgIC8vIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDAsJyArIHdpZHRoICsgJyknKVxuICAgICAgICAgICAgICAgICAgICAuY2FsbCh5LmF4aXMgPSBkMy5zdmcuYXhpcygpLnNjYWxlKHkpLm9yaWVudCgnbGVmdCcpKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgc3ZnPSBkMy5zZWxlY3QoJy5ncmFwaCcpLmFwcGVuZCgnc3ZnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2NoYXJ0JylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgd2lkdGggLSA1MClcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2hlaWdodCcsIGhlaWdodCArIDUwKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gLnN0eWxlKCdvdmVyZmxvdycsIFwidmlzaWJsZVwiKTtcblxuICAgICAgICAgICAgICAgIHZhciBheGlzID0gc3ZnLmFwcGVuZCgnZycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICd4IGF4aXMnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZSgwLCcgKyBoZWlnaHQgKyAnKScpXG4gICAgICAgICAgICAgICAgICAgIC5jYWxsKHguYXhpcyA9IGQzLnN2Zy5heGlzKCkuc2NhbGUoeCkub3JpZW50KCdib3R0b20nKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgcGF0aHMgPSBzdmcuYXBwZW5kKCdnJyk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBuYW1lIGluIGdyb3Vwcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ3JvdXAgPSBncm91cHNbbmFtZV07XG4gICAgICAgICAgICAgICAgICAgIGdyb3VwLnBhdGggPSBwYXRocy5hcHBlbmQoJ3BhdGgnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmRhdGEoW2dyb3VwLmRhdGFdKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgbmFtZSArICcgZ3JvdXAnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN0eWxlKCdzdHJva2UnLCBncm91cC5jb2xvcilcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiB0aWNrKCkge1xuICAgICAgICAgICAgICAgICAgICBub3cgPSBuZXcgRGF0ZSgpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCBuZXcgdmFsdWVzXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIG5hbWUgaW4gZ3JvdXBzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ3JvdXAgPSBncm91cHNbbmFtZV07XG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cC5kYXRhLnB1c2goc2NvcGUuZWRnZURhdGEgfHwgMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cC5wYXRoLmF0dHIoJ2QnLCBsaW5lKVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2hpZnQgZG9tYWluXG4gICAgICAgICAgICAgICAgICAgIHguZG9tYWluKFtub3cgLSAobGltaXQgLSAyKSAqIGR1cmF0aW9uLCBub3cgLSBkdXJhdGlvbl0pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFNsaWRlIHgtYXhpcyBsZWZ0XG4gICAgICAgICAgICAgICAgICAgIGF4aXMudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZHVyYXRpb24oZHVyYXRpb24pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZWFzZSgnbGluZWFyJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYWxsKHguYXhpcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgeUF4aXMudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZHVyYXRpb24oZHVyYXRpb24pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZWFzZSgnbGluZWFyJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYWxsKHkuYXhpcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2xpZGUgcGF0aHMgbGVmdFxuICAgICAgICAgICAgICAgICAgICBwYXRocy5hdHRyKCd0cmFuc2Zvcm0nLCBudWxsKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmR1cmF0aW9uKGR1cmF0aW9uKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVhc2UoJ2xpbmVhcicpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZSgnICsgeChub3cgLSAobGltaXQgLSAxKSAqIGR1cmF0aW9uKSArICcpJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lYWNoKCdlbmQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aWNrKClcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBvbGRlc3QgZGF0YSBwb2ludCBmcm9tIGVhY2ggZ3JvdXBcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBncm91cHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBncm91cCA9IGdyb3Vwc1tuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLmRhdGEuc2hpZnQoKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRpY2soKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm57XG4gICAgICAgICAgICAgICAgcmVzdHJpY3Q6J0VBJyxcbiAgICAgICAgICAgICAgICByZXBsYWNlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Zpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbmVkZ2V0ZW1wbGF0ZS5odG1sJyxcbiAgICAgICAgICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSl7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiR3YXRjaEdyb3VwKFsnZWRnZURhdGEnLCAnb2xkRWRnZURhdGEnXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzY29wZS5lZGdlRGF0YSAhPSBudWxsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5vbGRFZGdlRGF0YSAhPSBudWxsICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNjb3BlLmluaXRpYWxpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmluaXRpYWxpemUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQzID0gJHdpbmRvdy5kMzsgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzdWFsaXphdGlvbkVkZ2VEMyhzY29wZSwgZDMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgXVxuKTtcblxuXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nKVxuICAgIC5zZXJ2aWNlKCdTdGF0ZVNhdmUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2F2ZWRTdGF0ZXMgPSB7fTtcbiAgICB9KVxuICAgIC5kaXJlY3RpdmUoXCJ2aXN1YWxpemF0aW9uR3JhcGhcIiwgWyckd2luZG93JywgJyRzdGF0ZScsICdWaXN1YWxpemVyR3JhcGgnLCAnUG9saWN5U2VydmljZScsICdWaXN1YWxpemVyRGF0YVNvdXJjZScsICdTdGF0ZVNhdmUnLFxuICAgICAgICBmdW5jdGlvbigkd2luZG93LCAkc3RhdGUsIFZpc3VhbGl6ZXJHcmFwaCwgUG9saWN5U2VydmljZSwgVmlzdWFsaXplckRhdGFTb3VyY2UsIFN0YXRlU2F2ZSkge1xuICAgICAgICAgICAgZnVuY3Rpb24gdmlzdWFsaXphdGlvbmxpc3RkMyhzY29wZSwgZWxlbSwgVmlzdWFsaXplckdyYXBoLCBQb2xpY3lTZXJ2aWNlLCBWaXN1YWxpemVyRGF0YVNvdXJjZSwgU3RhdGVTYXZlKSB7XG4gICAgICAgICAgICAgICAgLy9kb24ndCBydW4gdW50aWwgYWxsIGluaXRpYWxpemF0aW9uIGNhbGxzIGhhdmUgcmV0dXJuZWRcbiAgICAgICAgICAgICAgICBpZiAoc2NvcGUubm9kZXMgPT09IHVuZGVmaW5lZCB8fCBzY29wZS5saW5rcyA9PT0gdW5kZWZpbmVkIHx8IHNjb3BlLmNoaWxkcmVuX3N0cnVjdCA9PT0gdW5kZWZpbmVkIHx8XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLmFuY2VzdG9yc19zdHJ1Y3QgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9jcmVhdGluZyBEYXRhU291cmNlXG4gICAgICAgICAgICAgICAgdmFyIGRhdGFTb3VyY2UgPSBuZXcgVmlzdWFsaXplckRhdGFTb3VyY2UuRGF0YVNvdXJjZShzY29wZS5ub2Rlcywgc2NvcGUubGlua3MsIHNjb3BlLmNoaWxkcmVuX3N0cnVjdCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5hbmNlc3RvcnNfc3RydWN0LCBzY29wZS5sYWJlbHMsIHNjb3BlLnNlcnZpY2VTZWxlY3RvcnMpO1xuICAgICAgICAgICAgICAgIGRhdGFTb3VyY2Uuc2V0QW5jZXN0b3JzKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMsIGxpbmtzO1xuXG4gICAgICAgICAgICAgICAgdmFyIHRvcERhdGEgPSBkYXRhU291cmNlLmdldFRvcExldmVsRmxvdygpO1xuICAgICAgICAgICAgICAgIG5vZGVzID0gZGF0YVNvdXJjZS5wcm9jZXNzTm9kZURhdGEodG9wRGF0YS5ub2RlRGF0YSk7XG4gICAgICAgICAgICAgICAgbGlua3MgPSBkYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YSh0b3BEYXRhLmxpbmtEYXRhLCBub2Rlcyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgYm9keUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gYm9keUVsLmNsaWVudFdpZHRoLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSAgYm9keUVsLmNsaWVudEhlaWdodDtcblxuICAgICAgICAgICAgICAgIC8qKiBNQUlOIFNWRyAqKi9cbiAgICAgICAgICAgICAgICB2YXIgcmF3U3ZnPWVsZW0uZmluZCgnc3ZnJyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gJChyYXdTdmcucGFyZW50KCkpLm9mZnNldCgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGRpdldpZHRoID0gJChyYXdTdmcucGFyZW50KCkpLndpZHRoKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3ZnID0gZDMuc2VsZWN0KHJhd1N2Z1swXSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCBkaXZXaWR0aClcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJoZWlnaHRcIiwgaGVpZ2h0IC0gb2Zmc2V0LnRvcCAtIDIwKTtcblxuICAgICAgICAgICAgICAgIC8vaW5zdGFsbGluZyBwb2xpY2llc1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaCA9IG5ldyBWaXN1YWxpemVyR3JhcGguR3JhcGgoc3ZnLCBub2RlcywgbGlua3MsIGRhdGFTb3VyY2UsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmNoaWxkcmVuX3N0cnVjdCwgc2NvcGUuYW5jZXN0b3JzX3N0cnVjdCk7XG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmluc3RhbGxEZWZhdWx0UGF0aFBvbGljeShuZXcgUG9saWN5U2VydmljZS5TYXZlU3RhdGVQb2xpY3koU3RhdGVTYXZlLnNhdmVkU3RhdGVzKSk7XG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmluc3RhbGxEZWZhdWx0UGF0aFBvbGljeShuZXcgUG9saWN5U2VydmljZS5QYXRoQ2hhbmdlVmlld1BvbGljeSgkc3RhdGUpKTtcbiAgICAgICAgICAgICAgICAvL1FUaXBQb2xpY3kgaXMgZm9yIGJvdGggTm9kZXMgYW5kIFBhdGhzLCBpbnN0YWxsIHNhbWUgb25lIG9uIGJvdGhcbiAgICAgICAgICAgICAgICB2YXIgcVRpcFBvbGljeSA9IG5ldyBQb2xpY3lTZXJ2aWNlLlFUaXBQb2xpY3koKTtcbiAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGguaW5zdGFsbERlZmF1bHROb2RlUG9saWN5KHFUaXBQb2xpY3kpO1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5pbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3kocVRpcFBvbGljeSk7XG4gICAgICAgICAgICAgICAgdmFyIHNwbGl0Sm9pblZpZXdQb2xpY3kgPSBuZXcgUG9saWN5U2VydmljZS5TcGxpdEpvaW5WaWV3UG9saWN5KCk7XG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmluc3RhbGxEZWZhdWx0Tm9kZVBvbGljeShzcGxpdEpvaW5WaWV3UG9saWN5KTtcbiAgICAgICAgICAgICAgICBzcGxpdEpvaW5WaWV3UG9saWN5Lmluc3RhbGxCYWNrQnV0dG9uKCQoJyNiYWNrQnV0dG9uJykpO1xuICAgICAgICAgICAgICAgIHNwbGl0Sm9pblZpZXdQb2xpY3kuaW5zdGFsbFRpdGxlKCQoJyNncmFwaC10aXRsZScpKTtcblxuICAgICAgICAgICAgICAgIC8vbG9hZCBvbGQgdmlldyBpZiBpdCBleGlzdHMuXG4gICAgICAgICAgICAgICAgaWYgKF8uaXNFbXB0eShTdGF0ZVNhdmUuc2F2ZWRTdGF0ZXMpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBncmFwaCA9IHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaDtcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGgubG9hZChTdGF0ZVNhdmUuc2F2ZWRTdGF0ZXMpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJue1xuICAgICAgICAgICAgICAgIHJlc3RyaWN0OidFQScsXG4gICAgICAgICAgICAgICAgcmVwbGFjZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb250ZW1wbGF0ZS5odG1sJyxcbiAgICAgICAgICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbSl7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS51bmJpbmQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5kZXN0cm95KCk7fSk7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiR3YXRjaEdyb3VwKFsnbm9kZXMnLCAnbGlua3MnLCAnY2hpbGRyZW5fc3RydWN0JywgJ2FuY2VzdG9yc19zdHJ1Y3QnXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzY29wZS5ub2RlcyAhPSBudWxsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmxpbmtzICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuY2hpbGRyZW5fc3RydWN0ICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuYW5jZXN0b3JzX3N0cnVjdCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzY29wZS5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5pbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc3VhbGl6YXRpb25saXN0ZDMoc2NvcGUsIGVsZW0sIFZpc3VhbGl6ZXJHcmFwaCwgUG9saWN5U2VydmljZSwgVmlzdWFsaXplckRhdGFTb3VyY2UsIFN0YXRlU2F2ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmRhdGFTb3VyY2UubGlua3MgPSBzY29wZS5saW5rcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLnVwZGF0ZUxpbmtEYXRhKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIF1cbik7XG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxudmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQob2JqZWN0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IHJldHVybiBnZXQocGFyZW50LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpOyB9IH0gZWxzZSBpZiAoXCJ2YWx1ZVwiIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9O1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbi8qKlxuICogVGhpcyBwb2xpY3kgaXMgdXNlZCB0byBjaGFuZ2UgdGhlIHZpZXcgdG8gZm9jdXMgb24gc3BsaXR0aW5nIGFuZCBcbiAqIGpvaW5pbmcgZXZlbnRzLlxuICogT3ZlcnJpZGVzIHRoZSBjZXJ0YWluIGZvcmNlIGxheW91dCBmdW5jdGlvbnMgb2YgdGhlIGdyYXBoIHRvIHBhcnRpdGlvbiBhIHNwbGl0XG4gKiBpbnRvIHRoZSBmb2N1c2VkIG5vZGVzIGFuZCB0aGUgY29ubmVjdGVkIG5vZGVzLlxuICogXG4gKiBIYXMgc2F2ZS9sb2FkIG1ldGhvZHMgZm9yIHRoZSBzYXZlIHN0YXRlIHBvbGljeS5cbiAqIEhhcyBiYWNrIGJ1dHRvbiBzdXBwb3J0LlxuICogQ2FuIGF1dG8gY2hhbmdlIHRoZSB0aXRsZSBvZiB0aGUgZ3JhcGguXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdTcGxpdEpvaW5WaWV3UG9saWN5JywgWydTcGxpdEpvaW5Ob2RlUG9saWN5JywgJ1Zpc3VhbGl6ZXJOb2RlJywgZnVuY3Rpb24gKFNwbGl0Sm9pbk5vZGVQb2xpY3ksIFZpc3VhbGl6ZXJOb2RlKSB7XG4gICAgdmFyIFNwbGl0Sm9pblZpZXdQb2xpY3kgPSBmdW5jdGlvbiAoX1NwbGl0Sm9pbk5vZGVQb2xpY3kkKSB7XG4gICAgICAgIF9pbmhlcml0cyhTcGxpdEpvaW5WaWV3UG9saWN5LCBfU3BsaXRKb2luTm9kZVBvbGljeSQpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBTcGxpdEpvaW5WaWV3UG9saWN5KCkge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNwbGl0Sm9pblZpZXdQb2xpY3kpO1xuXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoU3BsaXRKb2luVmlld1BvbGljeS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFNwbGl0Sm9pblZpZXdQb2xpY3kpKS5jYWxsKHRoaXMpKTtcblxuICAgICAgICAgICAgX3RoaXMucG9saWN5TmFtZSA9IFwiU3BsaXRKb2luVmlld1BvbGljeVwiO1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENhbGxlZCB3aGVuIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGhcbiAgICAgICAgICovXG5cblxuICAgICAgICBfY3JlYXRlQ2xhc3MoU3BsaXRKb2luVmlld1BvbGljeSwgW3tcbiAgICAgICAgICAgIGtleTogJ2luaXRpYWxpemUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemUoZ3JhcGgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF9nZXQoU3BsaXRKb2luVmlld1BvbGljeS5wcm90b3R5cGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihTcGxpdEpvaW5WaWV3UG9saWN5LnByb3RvdHlwZSksICdpbml0aWFsaXplJywgdGhpcykuY2FsbCh0aGlzLCBncmFwaCk7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLnNhdmVkU3RhdGVzID0gW107XG4gICAgICAgICAgICAgICAgLy8gc3RhdGUuZm9jdXNHcm91cCA9IG51bGw7XG4gICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5ID0gW107XG4gICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMgPSBbXTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5mb2NpID0gW107XG4gICAgICAgICAgICAgICAgc3RhdGUuem9vbXMgPSB7fTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5sYXlvdXQgPSB7fTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5sYXlvdXREZWZhdWx0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS56b29tRGVmYXVsdCA9IG51bGw7XG4gICAgICAgICAgICAgICAgc3RhdGUubm9kZUlkc1RvUmVzaG93ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uRWxlbSA9IG51bGw7XG4gICAgICAgICAgICAgICAgc3RhdGUudGl0bGVFbGVtID0gbnVsbDtcblxuICAgICAgICAgICAgICAgIHZhciBjb25zdHMgPSBncmFwaC5jb25zdHMuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIGNvbnN0cy5ib3VuZGFyeSA9IDAuODtcblxuICAgICAgICAgICAgICAgIC8vb3ZlcnJpZGluZyBkM2ZvcmNlIG1ldGhvZHMgb2YgdGhlIGdyYXBoLlxuICAgICAgICAgICAgICAgIGdyYXBoLmQzRm9yY2VCb3VuZHMgPSB0aGlzLmQzRm9yY2VCb3VuZHM7XG4gICAgICAgICAgICAgICAgZ3JhcGguZDNGb3JjZVRpY2sgPSB0aGlzLmQzRm9yY2VUaWNrO1xuICAgICAgICAgICAgICAgIGdyYXBoLmQzRm9yY2VTdGFydCA9IHRoaXMuZDNGb3JjZVN0YXJ0O1xuICAgICAgICAgICAgICAgIGdyYXBoLmQzRm9yY2VFbmQgPSB0aGlzLmQzRm9yY2VFbmQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogTGlua3MgdGhlIHByb3ZpZGVkIGVsZW1lbnQgYSBiYWNrIGJ1dHRvbiBmZWF0dXJlXG4gICAgICAgICAgICAgKiBEb2Vzbid0IHRyaWdnZXIgdGhlIG9uLWNsaWNrIGV2ZW50XG4gICAgICAgICAgICAgKiBUaGF0IHNob3VsZCBiZSBkb25lIHRocm91Z2ggYW5ndWxhciBuZy1jbGljay5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7alF1ZXJ5fSAgZWxlbSAgICBUaGUganF1ZXJ5IHNlbGVjdGVkIGVsZW1lbnRcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2luc3RhbGxCYWNrQnV0dG9uJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbnN0YWxsQmFja0J1dHRvbihlbGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kgPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgc3RhdGUuYmFja0J1dHRvbkVsZW0gPSBlbGVtO1xuICAgICAgICAgICAgICAgIHN0YXRlLmJhY2tCdXR0b24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51bmRvTGFzdEV2ZW50LmNhbGwodGhpc1BvbGljeSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgYWxsb3cgdGhpcyBwb2xpY3kgdG8gY2hhbmdlIHRoZSB0aXRsZSBvZiB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqIGFzIHNwbGl0IGFuZCBqb2luIGV2ZW50cyBvY2N1ci5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7alF1ZXJ5fSAgZWxlbSAgICBUaGUganF1ZXJ5IHNlbGVjdGVkIGVsZW1lbnRcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2luc3RhbGxUaXRsZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5zdGFsbFRpdGxlKGVsZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIHN0YXRlLnRpdGxlRWxlbSA9IGVsZW07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIGJlaW5nIGRlc3Ryb3llZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBzYXZlZFN0YXRlICBBbnkgcHJvcGVydHkgb24gdGhpc1xuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdCB3aWxsIGJlIGFjY2Vzc2libGVcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGVuIHRoZSB2aWV3IHJlbG9hZHNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koc2F2ZWRTdGF0ZSkge1xuICAgICAgICAgICAgICAgIC8vT25seSBpZiB0aGUgc2F2ZSBzdGF0ZSBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAgICAgICAgaWYgKHNhdmVkU3RhdGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNhdmUoc2F2ZWRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgc2F2ZSB0aGUgY3VycmVudCBzdGF0ZSwgYW5kIGFsbCBoaXN0b3J5LlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBzYXZlZFN0YXRlICBBbnkgcHJvcGVydHkgb24gdGhpc1xuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdCB3aWxsIGJlIGFjY2Vzc2libGVcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGVuIHRoZSB2aWV3IHJlbG9hZHNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3NhdmUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNhdmUoc2F2ZWRTdGF0ZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgICAgIHZhciBsaW5rcyA9IHRoaXNHcmFwaC5saW5rcztcbiAgICAgICAgICAgICAgICB2YXIgY3VyclRpdGxlID0gbnVsbDtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUudGl0bGVFbGVtICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgY3VyclRpdGxlID0gc3RhdGUudGl0bGVFbGVtLnRleHQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGZvY3VzR3JvdXBzID0gc3RhdGUuZm9jdXNHcm91cHM7XG4gICAgICAgICAgICAgICAgdmFyIGV2ZW50SGlzdG9yeSA9IHN0YXRlLmV2ZW50SGlzdG9yeTtcbiAgICAgICAgICAgICAgICB2YXIgem9vbXMgPSBzdGF0ZS56b29tcztcbiAgICAgICAgICAgICAgICB2YXIgbGF5b3V0ID0gc3RhdGUubGF5b3V0O1xuXG4gICAgICAgICAgICAgICAgdmFyIGxheW91dERlZmF1bHQgPSBzdGF0ZS5sYXlvdXREZWZhdWx0O1xuICAgICAgICAgICAgICAgIHZhciB6b29tRGVmYXVsdCA9IHN0YXRlLnpvb21EZWZhdWx0O1xuICAgICAgICAgICAgICAgIHZhciByZXQgPSB7IG5vZGVzOiBub2RlcywgbGlua3M6IGxpbmtzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZXM6IHN0YXRlLnNhdmVkU3RhdGVzLCBjdXJyVGl0bGU6IGN1cnJUaXRsZSxcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNHcm91cHM6IGZvY3VzR3JvdXBzLFxuICAgICAgICAgICAgICAgICAgICBldmVudEhpc3Rvcnk6IGV2ZW50SGlzdG9yeSwgem9vbXM6IHpvb21zLFxuICAgICAgICAgICAgICAgICAgICBsYXlvdXQ6IGxheW91dCwgbGF5b3V0RGVmYXVsdDogbGF5b3V0RGVmYXVsdCxcbiAgICAgICAgICAgICAgICAgICAgem9vbURlZmF1bHQ6IHpvb21EZWZhdWx0IH07XG4gICAgICAgICAgICAgICAgc2F2ZWRTdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5ID0gcmV0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgYmUgY2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIHJlbG9hZGVkLCBhc3N1bWluZ1xuICAgICAgICAgICAgICogc2F2ZSBzdGF0ZSBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGxvYWRTdGF0ZSAgQ29udGFpbnMgYWxsIHRoZSBzYXZlZFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFibGVzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdsb2FkJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBsb2FkKGxvYWRTdGF0ZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIGxvYWRTdGF0ZSA9IGxvYWRTdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuICAgICAgICAgICAgICAgIHN0YXRlLnNhdmVkU3RhdGVzID0gbG9hZFN0YXRlLnN0YXRlcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MgPSBsb2FkU3RhdGUubGlua3M7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzID0gbG9hZFN0YXRlLm5vZGVzO1xuXG4gICAgICAgICAgICAgICAgdmFyIGN1cnJUaXRsZSA9IGxvYWRTdGF0ZS5jdXJyVGl0bGU7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLnRpdGxlRWxlbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLnRpdGxlRWxlbS50ZXh0KGN1cnJUaXRsZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeSA9IGxvYWRTdGF0ZS5ldmVudEhpc3Rvcnk7XG4gICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMgPSBsb2FkU3RhdGUuZm9jdXNHcm91cHM7XG4gICAgICAgICAgICAgICAgc3RhdGUuem9vbXMgPSBsb2FkU3RhdGUuem9vbXM7XG4gICAgICAgICAgICAgICAgc3RhdGUubGF5b3V0ID0gbG9hZFN0YXRlLmxheW91dDtcbiAgICAgICAgICAgICAgICBzdGF0ZS5sYXlvdXREZWZhdWx0ID0gbG9hZFN0YXRlLmxheW91dERlZmF1bHQ7XG4gICAgICAgICAgICAgICAgc3RhdGUuem9vbURlZmF1bHQgPSBsb2FkU3RhdGUuem9vbURlZmF1bHQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuYmFja0J1dHRvbkVsZW0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLmJhY2tCdXR0b25FbGVtLmZhZGVUbygnc2xvdycsIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcblxuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoXy5pbmNsdWRlcyhjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dLCBkLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImZvY3VzXCI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiY29ubmVjdGVkXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vbG9hZGluZyBhIHByZXZpb3VzIGxheW91dFxuICAgICAgICAgICAgICAgIHZhciBsYXlvdXQ7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBsYXlvdXQgPSBzdGF0ZS5sYXlvdXREZWZhdWx0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbSA9IHN0YXRlLnpvb21EZWZhdWx0O1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguem9vbWVkKHpvb21bMF0sIHpvb21bMV0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB6b29tID0gc3RhdGUuem9vbXNbc3RhdGUuZm9jdXNHcm91cHNdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoem9vbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguem9vbWVkKHpvb21bMF0sIHpvb21bMV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGxheW91dCA9IHN0YXRlLmxheW91dFtzdGF0ZS5mb2N1c0dyb3Vwc107XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9sYXlvdXQgY2FuJ3QgYmUgbnVsbFxuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwb3MgPSBsYXlvdXRbbi5pZF07XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb3MgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cobGF5b3V0LCBuKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBuLnggPSBwb3MueDtcbiAgICAgICAgICAgICAgICAgICAgbi55ID0gcG9zLnk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN0YXRlLmluaXRGb3JjZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoLmNhbGwodGhpc0dyYXBoLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kudXBkYXRlR3JhcGhDYWxsYmFjay5jYWxsKHRoaXNQb2xpY3kpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRyaWdnZXJpbmcgc3BsaXQgb24gZG91YmxlIGNsaWNrXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEZvY3VzIGdyb3VwIHN0b3JlcyB0aGUgbm9kZSB0aGF0IGlzIGFib3V0IHRvIGJlIHNwbGl0LlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBXaGVuIGZvY3VzIGdyb3VwIGhhcyBsZW5ndGggMCwgdGhlIGZpcnN0IHNwbGl0IFxuICAgICAgICAgICAgICogd2lsbCBqdXN0IGJlIHB1c2hlZCBvbi5cbiAgICAgICAgICAgICAqIFRoZSBub2RlIHdpbGwgYmUgc3BsaXQgYW5kIHB1c2hlZCB0byB0aGUgdG9wIGhhbGYgXG4gICAgICAgICAgICAgKiBvZiB0aGUgc2NyZWVuLCBhbmQgdGhlIGJvdHRvbSBoYWxmIHdpbGwgY29udGFpbiBhbnlcbiAgICAgICAgICAgICAqIG5vZGVzIGl0IGhhcyBjb25uZWN0aW9ucyB0by5cbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogV2hlbiBhIGZvY3VzIGdyb3VwIGxlbmd0aCBpcyA+PSAxLCBpZiB0aGUgbm9kZSB0byBiZVxuICAgICAgICAgICAgICogc3BsaXQgaXMgYSBmb2N1cyBub2RlLCBpdCB3aWxsIHJlcGxhY2UgZm9jdXNHcm91cHNbMF0gYW5kXG4gICAgICAgICAgICAgKiB0aGUgdG9wIGhhbGYgd2lsbCBiZSBpdHMgY2hpbGRyZW4sIGFuZCBib3R0b20gaGFsZiB3aWxsXG4gICAgICAgICAgICAgKiBiZSB0aGUgbm9kZXMgaXQgaGFzIGNvbm5lY3Rpb25zIHRvLlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBJZiB0aGUgc3BsaXQgaXMgaW4gdGhlIGJvdHRvbSBoYWxmLCB0aGVuIHRoZSBib3R0b20gaGFsZlxuICAgICAgICAgICAgICogd2lsbCBkaXNwbGF5IGl0J3MgY2hpbGRyZW4gYW5kIHdpbGwgb25seSBzaG93IGNvbm5lY3Rpb25zIGJldHdlZW5cbiAgICAgICAgICAgICAqIHRoZSB0d28gZ3JvdXBzLCBhbmQgd2lsbCByZXBsYWNlIGZvY3VzR3JvdXBzWzFdLlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmp9ICAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGQgICAgICAgVGhlIG1hdGNoaW5nIGRhdGEgb2JqZWN0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkYmxjbGljaycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGJsY2xpY2soZDNub2RlLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICAvL2NoZWNrIGlmIGNhbiBzcGxpdFxuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gZC5pZDtcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIGlmIChjaGlsZHJlbl9zdHJ1Y3RbbmFtZV0gPT09IHVuZGVmaW5lZCB8fCBfLmlzRW1wdHkoY2hpbGRyZW5fc3RydWN0W25hbWVdKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMuc2xpY2UoKTtcblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy90b3BsZXZlbCBzcGxpdFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwcy5wdXNoKGQuaWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXy5pbmNsdWRlcyhjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dLCBkLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICAvL3NwbGl0dGluZyBhIGZvY3VzIG5vZGVcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHNbMF0gPSBkLmlkO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vc3BsaXR0aW5nIGFcbiAgICAgICAgICAgICAgICAgICAgLy9jb25uZWN0ZWQgbm9kZVxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwcy5wdXNoKGQuaWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXy5pbmNsdWRlcyhjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMV1dLCBkLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICAvL3NwbGl0dGluZyBhXG4gICAgICAgICAgICAgICAgICAgIC8vY29ubmVjdGVkIG5vZGVcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHNbMV0gPSBkLmlkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDIgJiYgc3RhdGUuZm9jdXNHcm91cHNbMV0gPT09IGQuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9TcGxpdHRpbmcgYSBjb25uZWN0ZWQgbm9kZSwga2VlcCBhbGwgZm9jdXMgbm9kZXNcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVzVG9LZWVwID0gW2RdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZUlkc1RvUmVzaG93ID0gW107XG4gICAgICAgICAgICAgICAgICAgIHZhciBncm91cE9uZU5vZGVzID0gY2hpbGRyZW5fc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzBdXTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKGdyb3VwT25lTm9kZXMsIG5vZGUuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlkc1RvUmVzaG93LnB1c2gobm9kZS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNUb0tlZXAucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy9NYWtlIHNwbGl0IG5vZGVzIHRoZSBmb2N1cyBhbmQga2VlcCBub2RlcyB0aGF0IGFyZSBjb25uZWN0ZWRcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVzVG9LZWVwID0gW2RdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZUlkc1RvUmVzaG93ID0gW107XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubGlua3MsIGZ1bmN0aW9uIChsaW5rKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobGluay5zb3VyY2UgPT09IGQgJiYgbm9kZUlkc1RvUmVzaG93LmluZGV4T2YobGluay50YXJnZXQuaWQpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluay50YXJnZXQuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsudGFyZ2V0LlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiY29ubmVjdGVkXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlkc1RvUmVzaG93LnB1c2gobGluay50YXJnZXQuaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzVG9LZWVwLnB1c2gobGluay50YXJnZXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChsaW5rLnRhcmdldCA9PT0gZCAmJiBub2RlSWRzVG9SZXNob3cuaW5kZXhPZihsaW5rLnNvdXJjZS5pZCkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rLnNvdXJjZS5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluay5zb3VyY2UuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzVG9SZXNob3cucHVzaChsaW5rLnNvdXJjZS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNUb0tlZXAucHVzaChsaW5rLnNvdXJjZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vUmVtb3ZpbmcgbGlua3MgZnJvbSB0aGUgbm9kZSB0byBiZSBzcGxpdFxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2goZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuaWQgIT09IGQuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zcGxpY2VMaW5rc0Zvck5vZGUobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcblxuICAgICAgICAgICAgICAgIC8vZGlzYWJsaW5nIHVwZGF0ZSBncmFwaCB0byBwcmV2ZW50IG5ldyBkYXRhIGZyb21cbiAgICAgICAgICAgICAgICAvL3JlZHJhd2luZyBsaW5rcyB3aGlsZSB0aGVyZSBhcmUgYW5pbWF0aW9ucyBnb2luZyBvblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZS5kaXNhYmxlVXBkYXRlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5lYWNoKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLmlkICE9PSBkLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykudHJhbnNpdGlvbigpLmRlbGF5KDIwMCkuZHVyYXRpb24oNDAwKS5zdHlsZShcIm9wYWNpdHlcIiwgMCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2Rpc2FibGluZyBxdGlwIGlmIGluc3RhbGxlZFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQodGhpcykucXRpcCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5xdGlwKCdkaXNhYmxlJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHZhciB0cmFuc2xhdGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKTtcbiAgICAgICAgICAgICAgICB2YXIgc2NhbGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpO1xuICAgICAgICAgICAgICAgIHZhciB4TG9jID0gcGFyc2VGbG9hdCh0aGlzR3JhcGguc3ZnLnN0eWxlKFwid2lkdGhcIikpIC8gc2NhbGUgLyAyICsgdHJhbnNsYXRlWzBdO1xuICAgICAgICAgICAgICAgIHZhciB5TG9jID0gcGFyc2VGbG9hdCh0aGlzR3JhcGguc3ZnLnN0eWxlKFwiaGVpZ2h0XCIpKSAvIHNjYWxlIC8gMiArIHRyYW5zbGF0ZVsxXTtcbiAgICAgICAgICAgICAgICBkLnhTdGFydCA9IGQueDtcbiAgICAgICAgICAgICAgICBkLnlTdGFydCA9IGQueTtcbiAgICAgICAgICAgICAgICBkLnggPSB4TG9jO1xuICAgICAgICAgICAgICAgIGQueSA9IHlMb2M7XG4gICAgICAgICAgICAgICAgZDNub2RlLnRyYW5zaXRpb24oXCJub2RlUG9zaXRpb25UcmFuc2l0aW9uXCIpLmR1cmF0aW9uKDc1MCkuYXR0clR3ZWVuKFwidHJhbnNmb3JtXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB4U3RhcnQgPSBkLnhTdGFydDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHlTdGFydCA9IGQueVN0YXJ0O1xuICAgICAgICAgICAgICAgICAgICBkLnhTdGFydCA9IGQueDtcbiAgICAgICAgICAgICAgICAgICAgZC55U3RhcnQgPSBkLnk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkMy5pbnRlcnBvbGF0ZVN0cmluZyhcInRyYW5zbGF0ZShcIiArIHhTdGFydCArIFwiLFwiICsgeVN0YXJ0ICsgXCIpXCIsIFwidHJhbnNsYXRlKFwiICsgZC54ICsgXCIsXCIgKyBkLnkgKyBcIilcIik7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3BsaXROb2RlRnVuYyA9IF9nZXQoU3BsaXRKb2luVmlld1BvbGljeS5wcm90b3R5cGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihTcGxpdEpvaW5WaWV3UG9saWN5LnByb3RvdHlwZSksICdzcGxpdE5vZGUnLCB0aGlzKTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5ub2RlSWRzVG9SZXNob3cgPSBub2RlSWRzVG9SZXNob3c7XG4gICAgICAgICAgICAgICAgLy93YWl0aW5nIGZvciBub2RlIHRyYW5zaXRpb25cbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlcyA9IG5vZGVzVG9LZWVwO1xuICAgICAgICAgICAgICAgICAgICBzcGxpdE5vZGVGdW5jLmNhbGwodGhpc1BvbGljeSwgZCk7XG4gICAgICAgICAgICAgICAgfSwgNzUwKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUbyBiZSBjYWxsZWQgYWZ0ZXIgdGhlIGdyYXBoIGlzIHNwbGl0LlxuICAgICAgICAgICAgICogQnJpbmdzIGFsbCBub2RlcyBiYWNrIGludG8gdmlldyBhbmQgc2V0cyB0aGVpciBhdHRyaWJ1dGVzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd1cGRhdGVHcmFwaENhbGxiYWNrJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVHcmFwaENhbGxiYWNrKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZWFjaChmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykudHJhbnNpdGlvbigpLmR1cmF0aW9uKDQwMCkuc3R5bGUoXCJvcGFjaXR5XCIsIDEpO1xuICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykuY2xhc3NlZChcImZvY3VzXCIsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLmNsYXNzZWQoXCJjb25uZWN0ZWRcIiwgZmFsc2UpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLlNwbGl0Sm9pblZpZXdQb2xpY3kgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID09PSBcImZvY3VzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykuY2xhc3NlZChcImZvY3VzXCIsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChub2RlLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9PT0gXCJjb25uZWN0ZWRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5jbGFzc2VkKFwiY29ubmVjdGVkXCIsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS5ub2RlSWRzVG9SZXNob3cgPSBudWxsO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmFuZG9tbHkgc2V0cyB0aGUgcG9zaXRpb25zIG9mIGFueSB1bnNldCBub2RlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdzZXRQb3NpdGlvbnMnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldFBvc2l0aW9ucygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeSA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIGdyYXBoQ29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cztcblxuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSBncmFwaENvbnN0cy5kaXNwbGF5T2Zmc2V0O1xuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXNHcmFwaC5ub2RlcztcbiAgICAgICAgICAgICAgICB2YXIgcmV0ID0gdGhpc1BvbGljeS5kM0ZvcmNlQm91bmRzLmNhbGwodGhpc0dyYXBoKTtcblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdldFJhbmRvbUludChtaW4sIG1heCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbiArIDEpKSArIG1pbjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfLmZvckVhY2gobm9kZXMsIGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLnggPT0gbnVsbCB8fCBub2RlLnkgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHggPSBnZXRSYW5kb21JbnQobm9kZS5yYWRpdXMgKyBvZmZzZXQsIHJldC53aWR0aCAtIG5vZGUucmFkaXVzIC0gb2Zmc2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB5ID0gZ2V0UmFuZG9tSW50KG5vZGUucmFkaXVzICsgb2Zmc2V0LCByZXQuaGVpZ2h0IC0gbm9kZS5yYWRpdXMgLSBvZmZzZXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS54ID0geDtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUueSA9IHk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgb24gdGhlIHN0YXJ0IG9mIHRoZSBkMyBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKiBXaWxsIG92ZXJyaWRlIHRoZSBtZXRob2Qgb2YgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKiBcInRoaXNcIiBwb2ludHMgdG8gdGhlIGdyYXBoXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkM0ZvcmNlU3RhcnQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGQzRm9yY2VTdGFydCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5hdHRyKCdjeCcsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLnhTdGFydCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLnhTdGFydCA9IGQueFN0YXJ0ICogdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKSArIHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpWzBdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cignY3knLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC55U3RhcnQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC55U3RhcnQgPSBkLnlTdGFydCAqIHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCkgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKVsxXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55O1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzLmF0dHIoJ3gxJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuc291cmNlLng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneTEnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5zb3VyY2UueTtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd4MicsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnRhcmdldC54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3kyJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQudGFyZ2V0Lnk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIG9uIHRoZSBzdGFydCBvZiB0aGUgZDMgZm9yY2Ugc2ltdWxhdGlvblxuICAgICAgICAgICAgICogV2lsbCBvdmVycmlkZSB0aGUgbWV0aG9kIG9mIHRoZSBncmFwaFxuICAgICAgICAgICAgICogXCJ0aGlzXCIgcG9pbnRzIHRvIHRoZSBncmFwaFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZDNGb3JjZUVuZCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZDNGb3JjZUVuZCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5ID0gc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGVQb2xpY3kubGF5b3V0RGVmYXVsdCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWZhdWx0TGF5b3V0ID0ge307XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0TGF5b3V0W24uaWRdID0geyB4OiBuLngsIHk6IG4ueSB9O1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kubGF5b3V0RGVmYXVsdCA9IGRlZmF1bHRMYXlvdXQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzY2FsZSA9IHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0cmFuc2xhdGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kuem9vbURlZmF1bHQgPSBbdHJhbnNsYXRlLCBzY2FsZV07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuYXR0cignY3gnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ2N5JywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocy5hdHRyKCd4MScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnNvdXJjZS54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3kxJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuc291cmNlLnk7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneDInLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC50YXJnZXQueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd5MicsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnRhcmdldC55O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgYmUgY2FsbGVkIGR1cmluZyBEMyBmb3JjZSBzaW11bGF0aW9uc1xuICAgICAgICAgICAgICogYnkgdGhlIGdyYXBoLCBzbyBcInRoaXNcIiB3aWxsIHBvaW50IHRvIHRoZSBncmFwaCBvYmplY3RcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgd2lkdGggICBEMyBMYXlvdXQgV2lkdGhcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICBoZWlnaHQgIEQzIExheW91dCBIZWlnaHRcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2QzRm9yY2VUaWNrJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkM0ZvcmNlVGljayhlLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZVBvbGljeSA9IHN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gY29uc3RzLmRpc3BsYXlPZmZzZXQ7XG4gICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKTtcblxuICAgICAgICAgICAgICAgIC8vIE1vdmUgbm9kZXMgdG93YXJkIGNsdXN0ZXIgZm9jdXMuXG4gICAgICAgICAgICAgICAgdmFyIGZvY2kgPSBzdGF0ZVBvbGljeS5mb2NpO1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdyYXZpdHkoYWxwaGEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm9jaS5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPT09IFwiZm9jdXNcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gKGZvY2lbMF0gLSBkLnkpICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55ICs9IChmb2NpWzFdIC0gZC55KSAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnggKz0gKHdpZHRoIC8gMiAtIGQueCkgKiBhbHBoYTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55ICs9IChoZWlnaHQgLyAyIC0gZC55KSAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCArPSAod2lkdGggLyAyIC0gZC54KSAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIE1ha2Ugc3VyZSBub2RlcyBhcmUgd2l0aGluIGJvdW5kc1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2godGhpcy5kM0ZvcmNlQ29sbGlkZSguNSkpLmVhY2goZ3Jhdml0eSguMiAqIGUuYWxwaGEpKS5hdHRyKFwiY3hcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueCA9IE1hdGgubWF4KChkLnJhZGl1cyArIG9mZnNldCkgLyBzY2FsZSwgTWF0aC5taW4od2lkdGggKyAoLW9mZnNldCAtIGQucmFkaXVzKSAvIHNjYWxlLCBkLngpKTtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKFwiY3lcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuU3BsaXRKb2luVmlld1BvbGljeSA9PSBudWxsIHx8IGQuU3BsaXRKb2luVmlld1BvbGljeSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLnkgPSBNYXRoLm1heCgoZC5yYWRpdXMgKyBvZmZzZXQpIC8gc2NhbGUsIE1hdGgubWluKGhlaWdodCArICgtb2Zmc2V0IC0gZC5yYWRpdXMpIC8gc2NhbGUsIGQueSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9PT0gXCJmb2N1c1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLnkgPSBNYXRoLm1heChkLnJhZGl1cyArIG9mZnNldCwgTWF0aC5taW4oKGhlaWdodCArICgtb2Zmc2V0IC0gZC5yYWRpdXMpIC8gc2NhbGUpICogY29uc3RzLlNwbGl0Sm9pblZpZXdQb2xpY3kuYm91bmRhcnksIGQueSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9PT0gXCJjb25uZWN0ZWRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC55ID0gTWF0aC5tYXgoKGhlaWdodCArIChvZmZzZXQgLSBkLnJhZGl1cykgLyBzY2FsZSkgKiBjb25zdHMuU3BsaXRKb2luVmlld1BvbGljeS5ib3VuZGFyeSwgTWF0aC5taW4oaGVpZ2h0ICsgKC1vZmZzZXQgLSBkLnJhZGl1cykgLyBzY2FsZSwgZC55KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHMuYXR0cigneDEnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5zb3VyY2UueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd5MScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnNvdXJjZS55O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3gyJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQudGFyZ2V0Lng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneTInLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC50YXJnZXQueTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxjdWxhdGVzIHRoZSBib3VuZGFyaWVzIG9mIHRoZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIFdpbGwgYmUgY2FsbGVkIGR1cmluZyBEMyBmb3JjZSBzaW11bGF0aW9uc1xuICAgICAgICAgICAgICogYnkgdGhlIGdyYXBoLCBzbyBcInRoaXNcIiB3aWxsIHBvaW50IHRvIHRoZSBncmFwaCBvYmplY3RcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHJldHVybiAgICAge09iamVjdH0gICAgICAgICAgUmV0dXJucyBhbiBvYmplY3RcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQgaGFzIHRoZSB3aWR0aFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5kIGhlaWdodCBhcyBcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXMgXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkM0ZvcmNlQm91bmRzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkM0ZvcmNlQm91bmRzKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cyxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzUG9saWN5ID0gY29uc3RzLlNwbGl0Sm9pblZpZXdQb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5ID0gc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gY2FsY01heE5vZGVzKHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZWEgPSB3aWR0aCAqIGhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJhZGl1cyA9IHRoaXNHcmFwaC5jb25zdHMuc3RhcnRSYWRpdXM7XG4gICAgICAgICAgICAgICAgICAgIC8vdHJlYXRpbmcgdGhlbSBhcyBhIHNxdWFyZSBmb3IgYXBwcm94XG4gICAgICAgICAgICAgICAgICAgIHZhciBsZW5ndGggPSByYWRpdXMgKiAzLjU7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhbW91bnQgPSBhcmVhIC8gKGxlbmd0aCAqIGxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhbW91bnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vVGhlIG9mZnNldCBpcyB0aGUgYnVmZmVyIGZyb20gdGhlIGVkZ2VzXG4gICAgICAgICAgICAgICAgLy9PcmlnaW5hbCBXaWR0aCBhbmQgSGVpZ2h0IGFyZSBnaXZlbiB0byB0aGUgZm9yY2UgbGF5b3V0XG4gICAgICAgICAgICAgICAgLy9zbyB0aGF0IGl0IGlzIGNlbnRlcmVkLCBidXQgbm9kZXMgd2lsbCBiZSBmb3JjZWQgdG8gYmVcbiAgICAgICAgICAgICAgICAvL3dpdGhpbiB0aGUgb2Zmc2V0IGJvdW5kc1xuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSBjb25zdHMuZGlzcGxheU9mZnNldDtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnV2lkdGggPSBwYXJzZUZsb2F0KHRoaXNHcmFwaC5zdmcuc3R5bGUoXCJ3aWR0aFwiKSk7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z0hlaWdodCA9IHBhcnNlRmxvYXQodGhpc0dyYXBoLnN2Zy5zdHlsZShcImhlaWdodFwiKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBzdmdXaWR0aDtcbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gc3ZnSGVpZ2h0O1xuXG4gICAgICAgICAgICAgICAgdmFyIGFtb3VudCA9IGNhbGNNYXhOb2Rlcyh3aWR0aCAtIDIgKiBvZmZzZXQsIGhlaWdodCAtIDIgKiBvZmZzZXQpO1xuICAgICAgICAgICAgICAgIHZhciBzY2FsZSA9IDE7XG4gICAgICAgICAgICAgICAgaWYgKG5vZGVzLmxlbmd0aCA+IGFtb3VudCkge1xuICAgICAgICAgICAgICAgICAgICBzY2FsZSA9IGFtb3VudCAvIG5vZGVzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKSwgc2NhbGUpO1xuICAgICAgICAgICAgICAgICAgICB3aWR0aCAvPSBzY2FsZTtcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0IC89IHNjYWxlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQodGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKCksIHNjYWxlKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL2NhbGN1bGF0aW5nIGZvY2kgZm9yIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAgICB2YXIgZm9jdXNHcm91cHMgPSBzdGF0ZVBvbGljeS5mb2N1c0dyb3VwcztcbiAgICAgICAgICAgICAgICB2YXIgZm9jaTtcbiAgICAgICAgICAgICAgICBpZiAoZm9jdXNHcm91cHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvY2kgPSBbaGVpZ2h0IC8gMl07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy9zZXR0aW5nIGZvY2kgaGVpZ2h0IHBvc2l0aW9uIGJhc2VkIG9uIHBlcmNlbnRhZ2VcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZvY3VzTm9kZXMgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbZm9jdXNHcm91cHNbMF1dO1xuICAgICAgICAgICAgICAgICAgICBjb25zdHNQb2xpY3kuYm91bmRhcnkgPSBmb2N1c05vZGVzLmxlbmd0aCAvIG5vZGVzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRvcCA9IGhlaWdodCAqIGNvbnN0c1BvbGljeS5ib3VuZGFyeTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJvdCA9IGhlaWdodCAtIHRvcDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRvcCA8IDIgKiB0aGlzR3JhcGguY29uc3RzLm1heFJhZGl1cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3RzUG9saWN5LmJvdW5kYXJ5ID0gMi41ICogdGhpc0dyYXBoLmNvbnN0cy5tYXhSYWRpdXMgLyBoZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3AgPSBoZWlnaHQgKiBjb25zdHNQb2xpY3kuYm91bmRhcnk7XG4gICAgICAgICAgICAgICAgICAgICAgICBib3QgPSBoZWlnaHQgLSB0b3A7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGJvdCA8IDIgKiB0aGlzR3JhcGguY29uc3RzLm1heFJhZGl1cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3RzUG9saWN5LmJvdW5kYXJ5ID0gMSAtIDIuNSAqIHRoaXNHcmFwaC5jb25zdHMubWF4UmFkaXVzIC8gaGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9wID0gaGVpZ2h0ICogY29uc3RzUG9saWN5LmJvdW5kYXJ5O1xuICAgICAgICAgICAgICAgICAgICAgICAgYm90ID0gaGVpZ2h0IC0gdG9wO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZvY2kgPSBbdG9wIC8gMiwgdG9wICsgYm90IC8gMl07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5LmZvY2kgPSBmb2NpO1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHdpZHRoOiB3aWR0aCwgaGVpZ2h0OiBoZWlnaHQgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgYWZ0ZXIgYSBzaW5nbGUgbm9kZSBpcyBzcGxpdFxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBuZXdOb2RlcyAgVGhlIG5ldyBub2Rlc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnc3BsaXROb2RlRXZlbnQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNwbGl0Tm9kZUV2ZW50KG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICBfLmZvckVhY2gobmV3Tm9kZXMsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoXy5pbmNsdWRlcyhjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dLCBkLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImZvY3VzXCI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiY29ubmVjdGVkXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHZhciB0aXRsZSA9IG5ld05vZGVzWzBdLnBhcmVudDtcbiAgICAgICAgICAgICAgICAvLyBzdGF0ZS5mb2N1c0dyb3VwID0gdGl0bGU7XG5cbiAgICAgICAgICAgICAgICAvL2lmIHRoZSBsYXN0IGV2ZW50IGhhcyB0aGUgc2FtZSBpZCwgaXQgbXVzdCBiZSB0aGVcbiAgICAgICAgICAgICAgICAvL29wcHBvc2l0ZSBvZiB0aGlzIGV2ZW50LCBzbyB3ZSByZW1vdmUgdGhhdCBldmVudCBmcm9tXG4gICAgICAgICAgICAgICAgLy90aGUgZXZlbnQgc3RhY2suXG4gICAgICAgICAgICAgICAgLy9PdGhlcndpc2UsIHdlIGFkZCB0aGUgZXZlbnQgb3QgdGhlIHN0YWNrXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggIT09IDAgJiYgc3RhdGUuZXZlbnRIaXN0b3J5W3N0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggLSAxXS5pZCA9PT0gdGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5LnBvcCgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeS5wdXNoKHsgaWQ6IHRpdGxlLCBldmVudDogJ3NwbGl0JyB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuYmFja0J1dHRvbkVsZW0gIT0gbnVsbCAmJiBzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmJhY2tCdXR0b25FbGVtLmZhZGVUbygnc2xvdycsIDEpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS50aXRsZUVsZW0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ICs9IHN0YXRlLmZvY3VzR3JvdXBzWzBdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0gJyAmICcgKyBzdGF0ZS5mb2N1c0dyb3Vwc1sxXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS50aXRsZUVsZW0udGV4dCh0ZXh0KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3JlLWVuYWJsZSBncmFwaCB1cGRhdGVcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3RhdGUuZGlzYWJsZVVwZGF0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kuc2V0TGF5b3V0KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU2V0cyB0aGUgbGF5b3V0IG9mIHRoZSBub2Rlcy4gXG4gICAgICAgICAgICAgKiBJZiB0aGVyZSBpcyBhIHByZXZpb3VzIGxheW91dCwgaXQgd2lsbCBiZSBsb2FkZWQuXG4gICAgICAgICAgICAgKiBFbHNlLCBpdCB3aWxsIHJ1biBhIEQzIEZvcmNlIHNpbXVsYXRpb24gYW5kIGNyZWF0ZSBvbmUuXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdzZXRMYXlvdXQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldExheW91dCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG4gICAgICAgICAgICAgICAgdmFyIGxheW91dDtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGxheW91dCA9IHN0YXRlLmxheW91dERlZmF1bHQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciB6b29tID0gc3RhdGUuem9vbURlZmF1bHQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQoem9vbVswXSwgem9vbVsxXSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSBzdGF0ZS56b29tc1tzdGF0ZS5mb2N1c0dyb3Vwc107XG4gICAgICAgICAgICAgICAgICAgIGlmICh6b29tICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQoem9vbVswXSwgem9vbVsxXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ID0gc3RhdGUubGF5b3V0W3N0YXRlLmZvY3VzR3JvdXBzXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAobGF5b3V0ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb3MgPSBsYXlvdXRbbi5pZF07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocG9zID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhsYXlvdXQsIG4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgbi54ID0gcG9zLng7XG4gICAgICAgICAgICAgICAgICAgICAgICBuLnkgPSBwb3MueTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaC5jYWxsKHRoaXNHcmFwaCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51cGRhdGVHcmFwaENhbGxiYWNrLmNhbGwodGhpc1BvbGljeSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vTmVlZCB0byBydW4gYSBmb3JjZSBzaW11bGF0aW9uIGFzIHRoaXMgbGF5b3V0XG4gICAgICAgICAgICAgICAgICAgIC8vaGFzbid0IGJlZW4gZG9uZSBiZWZvcmVcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN0YXRlLmluaXRGb3JjZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAvLyB0aGlzUG9saWN5LnNldFBvc2l0aW9ucygpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51cGRhdGVHcmFwaENhbGxiYWNrLmNhbGwodGhpc1BvbGljeSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS56b29tc1tzdGF0ZS5mb2N1c0dyb3Vwc10gPSBbdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKCksIHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCldO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGF5b3V0ID0ge307XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYXlvdXRbbi5pZF0gPSB7IHg6IG4ueCwgeTogbi55IH07XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5sYXlvdXRbc3RhdGUuZm9jdXNHcm91cHNdID0gbGF5b3V0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBPdmVycmlkaW5nIGZyb20gc3VwZXIgY2xhc3Mgc28gdGhhdCB3ZSBjYW4gaGF2ZVxuICAgICAgICAgICAgICogdG9wIGxldmVsIG5vZGVzIHJlYXBwZWFyIHdoZW4gdGhleSBhcmUgaGlkZGVuXG4gICAgICAgICAgICAgKiBkdWUgdG8gdGhlcmUgYmVpbmcgdHdvIGZvY3VzIGdyb3Vwcy5cbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgICAgIG5vZGUgICAgVGhlIG5vZGUgdG8gam9pblxuICAgICAgICAgICAgICogQHJldHVybiAgICAge05vZGV9ICBUaGUgbmV3IG5vZGUgYWZ0ZXIgdGhlIGpvaW5cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ19fam9pbk5vZGUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9fam9pbk5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZVN1cGVyID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pbk5vZGVQb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICAvL2NoZWNrIHRoYXQgbm9kZSBzdGlsbCBleGlzdHNcbiAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLm5vZGVzLmluZGV4T2Yobm9kZSkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBub2RlLmlkO1xuICAgICAgICAgICAgICAgIC8vaWYgaXQgaGFzIG5vIGFuY2VzdG9yLCBub3RoaW5nIHRvIGpvaW5cbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRyZW5fc3RydWN0LnRvcExldmVsLmluZGV4T2YobmFtZSkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IG5vZGUucGFyZW50O1xuICAgICAgICAgICAgICAgIHZhciB0b19iZV9kZWxldGVkID0gW107XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVOYW1lU2V0ID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgLy9pZiBub2RlIHdvbid0IGJlIGNvbGxhcHNlZFxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLm5vZGVzW2ldLmFuY2VzdG9ycy5pbmRleE9mKG5vZGUucGFyZW50KSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZU5hbWVTZXQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0uaWQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9fYmVfZGVsZXRlZC5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlX2lkID0gbm9kZS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgbm9kZU5hbWVTZXQucHVzaChub2RlLnBhcmVudCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgYW5jZXN0b3JzX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmFuY2VzdG9yc19zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICAvLyAtIHNldHRpbmcgZm9jdXNHcm91cHMgLVxuICAgICAgICAgICAgICAgIC8vZWl0aGVyIHJlcGxhY2luZyBvbmUgb2YgdGhlIGdyb3VwcyxcbiAgICAgICAgICAgICAgICAvL29yIGpvaW5pbmcgYmFjayBpbnRvIGEgdG9wIGxldmVsLCBzbyB0aGVyZSBpcyBvbmx5XG4gICAgICAgICAgICAgICAgLy9vbmUgZm9jdXNcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBzdGF0ZS5mb2N1c0dyb3Vwcy5pbmRleE9mKHBhcmVudCk7XG4gICAgICAgICAgICAgICAgaWYgKGFuY2VzdG9yc19zdHJ1Y3RbcGFyZW50XSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzW2luZGV4XSA9IGFuY2VzdG9yc19zdHJ1Y3RbcGFyZW50XTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vbmFtZVRvQWRkIGFyZSB0b3AgbGV2ZWwgbm9kZXMgdGhhdCBhcmUgdG8gYmUgYWRkZWRcbiAgICAgICAgICAgICAgICAvL3RvIHRoZSBncmFwaC5cbiAgICAgICAgICAgICAgICB2YXIgbmFtZVRvQWRkID0gW107XG4gICAgICAgICAgICAgICAgLy93aWxsIG9ubHkgbmVlZCB0byBhZGQgYSB0b3AgbGV2ZWwgbm9kZSBpZiB0aGVyZSBpc1xuICAgICAgICAgICAgICAgIC8vb25seSBvbmUgZm9jdXNcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vQWRkIG9ubHkgdGhvc3QgdGhhdCBhcmVuJ3QgYW4gYW5jZXN0b3Igb2YgdGhlIG5vZGVcbiAgICAgICAgICAgICAgICAgICAgLy90byBqb2luLCB0aGUgZm9jdXMgZ3JvdXAgb3IgYW4gYW5jZXN0b3Igb2YgaXQsXG4gICAgICAgICAgICAgICAgICAgIC8vYW5kIGFyZW4ndCBhbHJlYWR5IGluIG5vZGVOYW1lU2V0LlxuICAgICAgICAgICAgICAgICAgICAvL2dldCBmbG93IGJldHdlZW4gdG9wIGxldmVsIGFzIGxvbmcgYXNcbiAgICAgICAgICAgICAgICAgICAgLy90aGUgdG9wIGxldmVsIGlzbid0IGFuIGFuY2VzdG9yIG9mIHRoZVxuICAgICAgICAgICAgICAgICAgICAvL2ZvY3VzIGdyb3VwLCBhbmQgaXNuJ3QgYWxyZWFkeSBwYXJ0IG9mIHRoZVxuICAgICAgICAgICAgICAgICAgICAvL25vZGUgc2V0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgYW5jZXN0b3JzID0gYW5jZXN0b3JzX3N0cnVjdFtub2RlLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3JzLnB1c2goc3RhdGUuZm9jdXNHcm91cHNbMF0pO1xuICAgICAgICAgICAgICAgICAgICAvL3RoZSBvciBlbXB0eSBhcnJheSBpcyB0byBwcmV2ZW50IGNvbmNhdGVuYXRpbmcgYSBudWxsXG4gICAgICAgICAgICAgICAgICAgIC8vb3IgdW5kZWZpbmVkIHZhbHVlXG4gICAgICAgICAgICAgICAgICAgIGFuY2VzdG9ycyA9IGFuY2VzdG9ycy5jb25jYXQoYW5jZXN0b3JzX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV0gfHwgW10pO1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goY2hpbGRyZW5fc3RydWN0LnRvcExldmVsLCBmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFuY2VzdG9ycy5pbmRleE9mKG4pID09PSAtMSAmJiBub2RlTmFtZVNldC5pbmRleE9mKG4pID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkLnB1c2gobik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBub2RlTmFtZVNldCA9IG5vZGVOYW1lU2V0LmNvbmNhdChuYW1lVG9BZGQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vbm8gZm9jdXMgZ3JvdXBzIG1lYW5zIHdlIGFyZSBhdCB0b3AgbGV2ZWxcbiAgICAgICAgICAgICAgICAgICAgLy9TaG91bGQgYWRkIGFueSB0b3AgbGV2ZWwgbm9kZXMgdGhhdCBhcmVuJ3RcbiAgICAgICAgICAgICAgICAgICAgLy9hbHJlYWR5IHRoZXJlXG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChjaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZU5hbWVTZXQuaW5kZXhPZihuKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVUb0FkZC5wdXNoKG4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZU5hbWVTZXQgPSBub2RlTmFtZVNldC5jb25jYXQobmFtZVRvQWRkKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL2Zvcm1hdHRpbmcgZGF0YVxuICAgICAgICAgICAgICAgIHZhciByYWRpdXMgPSBub2RlLnJhZGl1cyAvIHRoaXNHcmFwaC5jb25zdHMucmFkaXVzRGVjYXk7XG4gICAgICAgICAgICAgICAgdmFyIHhMb2MgPSBub2RlLng7XG4gICAgICAgICAgICAgICAgdmFyIHlMb2MgPSBub2RlLnk7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IG5vZGUuYW5jZXN0b3JzWzFdO1xuICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnMgPSBub2RlLmFuY2VzdG9ycy5zbGljZSgxKTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3Tm9kZSA9IG5ldyBWaXN1YWxpemVyTm9kZS5Ob2RlKHhMb2MsIHlMb2MsIG5ld19ub2RlX2lkLCBuZXdfbm9kZV9pZCwgcmFkaXVzLCBwYXJlbnQsIGFuY2VzdG9ycyk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnB1c2gobmV3Tm9kZSk7XG5cbiAgICAgICAgICAgICAgICAvL3JlbW92ZSBhbGwgbm9kZXMgdGhhdCB3aWxsIGJlIGpvaW5lZFxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdG9fYmVfZGVsZXRlZC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZV90b19kZWxldGUgPSB0b19iZV9kZWxldGVkW2ldO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMuc3BsaWNlKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG5vZGVfdG9fZGVsZXRlKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zcGxpY2VMaW5rc0Zvck5vZGUobm9kZV90b19kZWxldGUpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciByZXREYXRhID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuZ2V0Rmxvd0JldHdlZW5TZXQobm9kZU5hbWVTZXQpO1xuICAgICAgICAgICAgICAgIC8vaG9sZHMgdGhlIG5vZGVEYXRhIHdoaWNoIHdpbGwgYmUgcHJvY2Vzc2VkXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzVG9Qcm9jZXNzID0gW107XG4gICAgICAgICAgICAgICAgLy9maW5kaW5nIHRoZSBub2RlIGRhdGEgdGhhdCBjb3JyZXNwb25kcyB0byB0aGUgdG9wIGxldmVsXG4gICAgICAgICAgICAgICAgLy9ub2RlcyB0byBhZGQgLSBuYW1lVG9BZGQuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVEYXRhID0gcmV0RGF0YS5ub2RlRGF0YTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVEYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuYW1lVG9BZGQuaW5kZXhPZihub2RlRGF0YVtpXS5pZCkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1RvUHJvY2Vzcy5wdXNoKG5vZGVEYXRhW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vVGhlIHRvcCBsZXZlbCBub2RlcyB0aGF0IGFyZSBhZGRlZFxuICAgICAgICAgICAgICAgIHZhciBuZXdOb2RlcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NOb2RlRGF0YShub2Rlc1RvUHJvY2Vzcyk7XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKG5ld05vZGVzLCBmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgICAgICAgICBuLnJhZGl1cyA9IG4ucmFkaXVzIHx8IHRoaXNHcmFwaC5jb25zdHMuc3RhcnRSYWRpdXM7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzID0gdGhpc0dyYXBoLm5vZGVzLmNvbmNhdChuZXdOb2Rlcyk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5wcm9jZXNzTGlua0RhdGEocmV0RGF0YS5saW5rRGF0YSwgdGhpc0dyYXBoLm5vZGVzKTtcbiAgICAgICAgICAgICAgICAvL09ubHkga2VlcCB0b3AgbGV2ZWwgbm9kZXMgdGhhdCBoYXZlIGNvbm5lY3Rpb25zIHRvXG4gICAgICAgICAgICAgICAgLy90aGUgY3VycmVudCBmb2N1cyBncm91cFxuICAgICAgICAgICAgICAgIC8vd2UgcmVtb3ZlIHRoZSBub2RlIG5hbWUgZnJvbSBuYW1lVG9BZGQgaWYgd2UgYXJlXG4gICAgICAgICAgICAgICAgLy9rZWVwaW5nIGl0XG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLmxpbmtzLCBmdW5jdGlvbiAobCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9jaGVja2luZyBpZiB0aGVyZSBleGlzdHMgYSBsaW5rIHRvdWNoaW5nIGVhY2ggb2YgbmFtZVRvQWRkXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmFtZVRvQWRkLmluZGV4T2YobC5zb3VyY2UuaWQpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwc1swXSA9PT0gbC50YXJnZXQucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVUb0FkZC5zcGxpY2UobmFtZVRvQWRkLmluZGV4T2YobC5zb3VyY2UuaWQpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5hbWVUb0FkZC5pbmRleE9mKGwudGFyZ2V0LmlkKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHNbMF0gPT09IGwuc291cmNlLnBhcmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lVG9BZGQuc3BsaWNlKG5hbWVUb0FkZC5pbmRleE9mKGwudGFyZ2V0LmlkKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL1dlIHdhbnQgdG8ga2VlcCB0aGVtIGFsbFxuICAgICAgICAgICAgICAgICAgICAvL3NpbmNlIGFueSBsZWZ0IGluIG5hbWVUb0FkZCB3aWxsIGJlIHJlbW92ZWQsXG4gICAgICAgICAgICAgICAgICAgIC8vd2UgcmVzZXQgbmFtZVRvQWRkIGhlcmUuXG4gICAgICAgICAgICAgICAgICAgIG5hbWVUb0FkZCA9IFtdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vd2hhdGV2ZXIgaXMgcmVtYWluaW5nIGluIG5hbWVUb0FkZCBpc24ndCBjb25uZWN0ZWRcbiAgICAgICAgICAgICAgICAvL3RvIHRoZSBmb2N1cyBncm91cCwgc28gd2Ugc2hvdWxkIHJlbW92ZSBpdC5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZVRvUmVtb3ZlID0gW107XG4gICAgICAgICAgICAgICAgaWYgKG5hbWVUb0FkZC5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuYW1lVG9BZGQuaW5kZXhPZih0aGlzR3JhcGgubm9kZXNbaV0uaWQpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVUb0FkZC5zcGxpY2UobmFtZVRvQWRkLmluZGV4T2YodGhpc0dyYXBoLm5vZGVzW2ldLmlkKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZSh0aGlzR3JhcGgubm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVUb1JlbW92ZS5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWVUb0FkZC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF8uZm9yRWFjaChub2RlVG9SZW1vdmUsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5zcGxpY2UodGhpc0dyYXBoLm5vZGVzLmluZGV4T2YobiksIDEpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXROb2RlcygpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0TGlua3MoKTtcblxuICAgICAgICAgICAgICAgIHN0YXRlU3VwZXIuc3BsaXROb2Rlcy5zcGxpY2Uoc3RhdGVTdXBlci5zcGxpdE5vZGVzLmluZGV4T2YobmV3Tm9kZS5pZCksIDEpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ld05vZGU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIGFmdGVyIGEgc2luZ2xlIG5vZGUgaXMgam9pbmVkXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIElmIHRoZSBmb2N1cyBncm91cCBoYXMgYmVlbiBzZWVuIGJlZm9yZSwgaXQgd2lsbFxuICAgICAgICAgICAgICogbG9hZCB0aGF0IGxheW91dC4gT3RoZXJ3aXNlLCBpdCB3aWxsIHJ1biBhIGQzIGZvcmNlXG4gICAgICAgICAgICAgKiBzaW11bGF0aW9uIHRvIGdlbmVyYXRlIG9uZS5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5ld05vZGUgIFRoZSBuZXcgbm9kZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnam9pbk5vZGVFdmVudCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gam9pbk5vZGVFdmVudChuZXdOb2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kgPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgLy9pZiB0aGUgbGFzdCBldmVudCBoYXMgdGhlIHNhbWUgaWQsIGl0IG11c3QgYmUgdGhlXG4gICAgICAgICAgICAgICAgLy9vcHBwb3NpdGUgb2YgdGhpcyBldmVudCwgc28gd2UgcmVtb3ZlIHRoYXQgZXZlbnQgZnJvbVxuICAgICAgICAgICAgICAgIC8vdGhlIGV2ZW50IHN0YWNrLlxuICAgICAgICAgICAgICAgIC8vT3RoZXJ3aXNlLCB3ZSBhZGQgdGhlIGV2ZW50IHRvIHRoZSBzdGFja1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoICE9PSAwICYmIHN0YXRlLmV2ZW50SGlzdG9yeVtzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoIC0gMV0uaWQgPT09IG5ld05vZGUuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5LnBvcCgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeS5wdXNoKHsgaWQ6IG5ld05vZGUuaWQsIGV2ZW50OiAnam9pbicgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcblxuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoXy5pbmNsdWRlcyhjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dLCBkLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImZvY3VzXCI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiY29ubmVjdGVkXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vc2V0dGluZyBiYWNrIGJ1dHRvblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5iYWNrQnV0dG9uRWxlbSAhPSBudWxsICYmIHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuYmFja0J1dHRvbkVsZW0uZmFkZVRvKCdzbG93JywgMCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9zZXR0aW5nIHRpdGxlXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLnRpdGxlRWxlbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0gc3RhdGUuZm9jdXNHcm91cHNbMF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSAnICYgJyArIHN0YXRlLmZvY3VzR3JvdXBzWzFdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLnRpdGxlRWxlbS50ZXh0KHRleHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnNldExheW91dCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVuZG9lcyB0aGUgbGFzdCBzcGxpdCBvciBqb2luIGV2ZW50LlxuICAgICAgICAgICAgICogTWVhbnQgdG8gYmUgY2FsbGVkIGJ5IHRoZSBiYWNrIGJ1dHRvbi5cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3VuZG9MYXN0RXZlbnQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVuZG9MYXN0RXZlbnQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kgPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdmFyIGxhc3QgPSBzdGF0ZS5ldmVudEhpc3Rvcnlbc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgIHZhciBpZCA9IGxhc3QuaWQ7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGU7XG4gICAgICAgICAgICAgICAgaWYgKGxhc3QuZXZlbnQgPT09ICdqb2luJykge1xuICAgICAgICAgICAgICAgICAgICBub2RlID0gdGhpc0dyYXBoLmZpbmROb2RlQnlJZChpZCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkM25vZGUgPSB0aGlzR3JhcGguZmluZEQzTm9kZShpZCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kuZGJsY2xpY2soZDNub2RlLCBub2RlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZUlkID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0W2lkXVswXTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZSA9IHRoaXNHcmFwaC5maW5kTm9kZUJ5SWQobm9kZUlkKTtcbiAgICAgICAgICAgICAgICAgICAgX2dldChTcGxpdEpvaW5WaWV3UG9saWN5LnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFNwbGl0Sm9pblZpZXdQb2xpY3kucHJvdG90eXBlKSwgJ2pvaW5Ob2RlJywgdGhpcykuY2FsbCh0aGlzUG9saWN5LCBub2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1dKTtcblxuICAgICAgICByZXR1cm4gU3BsaXRKb2luVmlld1BvbGljeTtcbiAgICB9KFNwbGl0Sm9pbk5vZGVQb2xpY3kuUG9saWN5KTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIFBvbGljeTogU3BsaXRKb2luVmlld1BvbGljeVxuICAgIH07XG59XSk7XG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52aXN1YWxpemF0aW9uLmxpc3QnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWaXN1YWxpemF0aW9uTGlzdEN0cmwgYXMgdmlzdWFsaXphdGlvbkxpc3RDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Zpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbmxpc3QuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignVmlzdWFsaXphdGlvbkxpc3RDdHJsJywgW1wiJHNjb3BlXCIsIFwiJGh0dHBcIiwgJ1Zpc3VhbGl6YXRpb25TZXJ2aWNlJywgJyRpbnRlcnZhbCcsIFxuICAgICAgICBmdW5jdGlvbigkc2NvcGUsICRodHRwLCBWaXN1YWxpemF0aW9uU2VydmljZSwgJGludGVydmFsKSB7XG4gICAgICAgICAgICAvL3RvIHNlZSB0aGUgZXhwZWN0ZWQgZm9ybWF0IHRvIGJlIHJldHVybmVkIGZyb20gdGhlc2UgY2FsbHMsXG4gICAgICAgICAgICAvL2xvb2sgYXQgYXBwL2NvbXBvbmVudHMvZ3JhcGhvYmplY3RzL2RhdGFzb3VyY2UvdmlzdWFsaXplcmRhdGFzb3VyY2UuanNcbiAgICAgICAgICAgIHZhciBzdWNjZXNzR3JhcGhEYXRhQ2FsbGJhY2sgPSBmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgbGlua3MgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZUlkcyA9IFtdO1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaChyZXN1bHQucmVzdWx0c1swXS5zZXJpZXMsIGZ1bmN0aW9uKHNlcmllcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZW5kcG9pbnQgPSBzZXJpZXMudGFncy5FbmRwb2ludElQO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJvdmlkZXIgPSBzZXJpZXMudGFncy5Qcm92aWRlcklQO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZTtcbiAgICAgICAgICAgICAgICAgICAgLy9jcmVhdGluZyBub2Rlc1xuICAgICAgICAgICAgICAgICAgICBpZiAoXy5pbmNsdWRlcyhub2RlSWRzLCBlbmRwb2ludCkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogZW5kcG9pbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGVuZHBvaW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNlc3RvcnM6IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlkcy5wdXNoKGVuZHBvaW50KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoXy5pbmNsdWRlcyhub2RlSWRzLCBwcm92aWRlcikgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogcHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHByb3ZpZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNlc3RvcnM6IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlkcy5wdXNoKHByb3ZpZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvL2NyZWF0aW5nIGxpbmtzXG4gICAgICAgICAgICAgICAgICAgIHZhciBsaW5rT3V0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiBlbmRwb2ludCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogcHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ6IHNlcmllcy52YWx1ZXNbMF1bMl1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgbGlua3MucHVzaChsaW5rT3V0KTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxpbmtJbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogcHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IGVuZHBvaW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0OiBzZXJpZXMudmFsdWVzWzBdWzFdXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGxpbmtzLnB1c2gobGlua0luKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAkc2NvcGUubm9kZXMgPSBub2RlcztcbiAgICAgICAgICAgICAgICAkc2NvcGUubGlua3MgPSBsaW5rcztcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAvL2luaXRpYWwgY2FsbFxuICAgICAgICAgICAgVmlzdWFsaXphdGlvblNlcnZpY2UuZ2V0R3JhcGhEYXRhKCkudGhlbihzdWNjZXNzR3JhcGhEYXRhQ2FsbGJhY2ssIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy93aWxsIGZhaWwgc2lsZW50bHksIGdyYXBoIHdvbid0IGJlIGRpc3BsYXllZFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkgeyAkaW50ZXJ2YWwuY2FuY2VsKCRzY29wZS5ncmFwaERhdGFJbnRlcnZhbCk7IH0pO1xuXG4gICAgICAgICAgICBWaXN1YWxpemF0aW9uU2VydmljZS5nZXRTdHJ1Y3R1cmVEYXRhKCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy90byBzZWUgdGhlIGV4cGVjdGVkIGZvcm0gb2YgYW5jZXN0b3Jfc3RydWN0IGFuZCBjaGlsZHJlbl9zdHJ1Y3QsIFxuICAgICAgICAgICAgICAgIC8vbG9vayBhdCBhcHAvY29tcG9uZW50cy9ncmFwaG9iamVjdHMvZGF0YXNvdXJjZS92aXN1YWxpemVyZGF0YXNvdXJjZS5qc1xuICAgICAgICAgICAgICAgICRzY29wZS5hbmNlc3RvcnNfc3RydWN0ID0gcmVzdWx0LmFuY2VzdG9yc19zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoaWxkcmVuX3N0cnVjdCA9IHJlc3VsdC5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxhYmVscyA9IHJlc3VsdC5sYWJlbHM7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlcnZpY2VTZWxlY3RvcnMgPSByZXN1bHQuc2VydmljZVNlbGVjdG9ycztcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy93aWxsIGZhaWwgc2lsZW50bHksIGdyYXBoIHdvbid0IGJlIGRpc3BsYXllZFxuICAgICAgICAgICAgfSk7XG4gICAgfV0pO1xuXG5cblxuXG5cblxuXG5cblxuXG5cblxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52aXN1YWxpemF0aW9uJylcbiAgICAuZmFjdG9yeSgnVmlzdWFsaXphdGlvblNlcnZpY2UnLCBbJyRodHRwJywgJyRxJywgZnVuY3Rpb24gKCRodHRwLCAkcSkge1xuICAgICAgICAvKipcbiAgICAgICAgICogTWFrZXMgYSBnZXQgcmVxdWVzdCB3aXRoIHRoZSB1cmwgYW5kIGNvbmZpZy5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHVybCAgICAgVGhlIHVybFxuICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgY29uZmlnICBUaGUgY29uZmlndXJhdGlvbnNcbiAgICAgICAgICogQHJldHVybiAgICAgeyRIdHRwIFByb21pc2V9ICAgUHJvbWlzZSBvZiB0aGUgcmVxdWVzdFxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gbWFrZUdldCh1cmwsIGNvbmZpZykge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICRodHRwLmdldCh1cmwsIGNvbmZpZykudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1ha2VzIGEgcG9zdCByZXF1ZXN0IHdpdGggdGhlIHVybCBhbmQgZGF0YVxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgdXJsICAgICBUaGUgdXJsXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtKU09OfSAgICBkYXRhICAgIFRoZSBkYXRhXG4gICAgICAgICAqIEByZXR1cm4gICAgIHskSHR0cCBQcm9taXNlfSAgIFByb21pc2Ugb2YgdGhlIHJlcXVlc3RcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIG1ha2VQb3N0KHVybCwgZGF0YSkge1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBjb252ZXJ0cyB0aGUgZGF0YSBpbnRvIHgtd3d3LWZyb20tdXJsZW5jb2RlZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtKU09OfSAgb2JqICAgICBKU09OIGRhdGEgb2JqZWN0XG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7c3RyaW5nfSAgeC13d3ctZm9ybS11cmxlbmNvZGVkIHN0cmluZ1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB2YXIgcGFyYW0gPSBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICAgICAgICB2YXIgcXVlcnkgPSAnJywgbmFtZSwgdmFsdWUsIGZ1bGxTdWJOYW1lLCBzdWJOYW1lLCBzdWJWYWx1ZSwgaW5uZXJPYmosIGk7XG4gICAgICAgICAgICAgICAgZm9yIChuYW1lIGluIG9iaikge1xuICAgICAgICAgICAgICAgICAgdmFsdWUgPSBvYmpbbmFtZV07XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaT0wOyBpPHZhbHVlLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViVmFsdWUgPSB2YWx1ZVtpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdWxsU3ViTmFtZSA9IG5hbWUgKyAnWycgKyBpICsgJ10nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlubmVyT2JqID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5uZXJPYmpbZnVsbFN1Yk5hbWVdID0gc3ViVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkgKz0gcGFyYW0oaW5uZXJPYmopICsgJyYnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHN1Yk5hbWUgaW4gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJWYWx1ZSA9IHZhbHVlW3N1Yk5hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bGxTdWJOYW1lID0gbmFtZSArICdbJyArIHN1Yk5hbWUgKyAnXSc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5uZXJPYmogPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbm5lck9ialtmdWxsU3ViTmFtZV0gPSBzdWJWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeSArPSBwYXJhbShpbm5lck9iaikgKyAnJic7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZih2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHZhbHVlICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyeSArPSBlbmNvZGVVUklDb21wb25lbnQobmFtZSkgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQodmFsdWUpICsgJyYnO1xuICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gcXVlcnkubGVuZ3RoID8gcXVlcnkuc3Vic3RyKDAsIHF1ZXJ5Lmxlbmd0aCAtIDEpIDogcXVlcnk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgIHVybDp1cmwsXG4gICAgICAgICAgICAgICAgbWV0aG9kOidQT1NUJyxcbiAgICAgICAgICAgICAgICBkYXRhOiBkYXRhLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJ1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdHJhbnNmb3JtUmVxdWVzdDogW2Z1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFuZ3VsYXIuaXNPYmplY3QoZGF0YSkgJiYgU3RyaW5nKGRhdGEpICE9PSAnW29iamVjdCBGaWxlXScgPyBwYXJhbShkYXRhKSA6IGRhdGE7XG4gICAgICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRHcmFwaERhdGEoKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WSVNVQUxJWkFUSU9OX0VORFBPSU5UO1xuICAgICAgICAgICAgdXJsICs9ICdpbmZsdXgvcXVlcnknO1xuICAgICAgICAgICAgdmFyIGNvbmZpZyA9IHtcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICAgICAgICAgICAgZGI6XCJ0ZWxlZ3JhZlwiLFxuICAgICAgICAgICAgICAgICAgICBxOlwiU0VMRUNUIEJ5dGVzSW4sIEJ5dGVzT3V0LCBFbmRwb2ludElQLCBQcm92aWRlcklQIEZST00gaHR0cGpzb25fc3Zjc3RhdHMgV0hFUkUgdGltZSA+IG5vdygpIC0gMW0gR1JPVVAgQlkgKiBMSU1JVCAxXCJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIG1ha2VHZXQodXJsLCBjb25maWcpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0U3RydWN0dXJlRGF0YSgpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLlZJU1VBTElaQVRJT05fRU5EUE9JTlQ7XG4gICAgICAgICAgICB1cmwgKz0gJ3NlcnZpY2VzJztcbiAgICAgICAgICAgIHJldHVybiBtYWtlR2V0KHVybCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBidWlsZFdoZXJlUXVlcnkocG9pbnRzLCB0eXBlKSB7XG4gICAgICAgICAgICB2YXIgcXVlcnkgPSBcIihcIjtcbiAgICAgICAgICAgIHF1ZXJ5ICs9IHR5cGUgKyBcIj1cIjtcbiAgICAgICAgICAgIHF1ZXJ5ICs9IFwiJ1wiICsgcG9pbnRzWzBdICsgXCInIFwiO1xuICAgICAgICAgICAgLy9zdGFydHMgYXQgMSwgc28gd2lsbCBub3QgcnVuIGlmIGxlbmd0aCBpcyAxXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IHBvaW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHF1ZXJ5ICs9ICdPUiAnO1xuICAgICAgICAgICAgICAgIHF1ZXJ5ICs9IHR5cGUgKyBcIj1cIjtcbiAgICAgICAgICAgICAgICBxdWVyeSArPSBcIidcIiArIHBvaW50c1tpXSArIFwiJyBcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHF1ZXJ5ICs9IFwiKVwiO1xuICAgICAgICAgICAgcmV0dXJuIHF1ZXJ5O1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0RWRnZURhdGEoc291cmNlTGlzdCwgdGFyZ2V0TGlzdCwgdGltZSkge1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuVklTVUFMSVpBVElPTl9FTkRQT0lOVDtcbiAgICAgICAgICAgIHVybCArPSAnaW5mbHV4L3F1ZXJ5JztcblxuICAgICAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgICAgIGRiIDogXCJ0ZWxlZ3JhZlwiLFxuICAgICAgICAgICAgICAgICAgICBxOiBcIlNFTEVDVCBzdW0oXCIgKyAnQnl0ZXNPdXQnICsgXCIpIGZyb20gaHR0cGpzb25fc3Zjc3RhdHMgV0hFUkUgdGltZSA+IG5vdygpIC0gMTVzIEFORCBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHNvdXJjZUxpc3QsIFwiRW5kcG9pbnRJUFwiKSArXCIgQU5EIFwiIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHRhcmdldExpc3QsICdQcm92aWRlcklQJykgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBcIkdST1VQIEJZIHRpbWUoMjBzKSBMSU1JVCAxOyBTRUxFQ1Qgc3VtKFwiICsgJ0J5dGVzSW4nICsgXCIpIGZyb20gaHR0cGpzb25fc3Zjc3RhdHMgV0hFUkUgdGltZSA+IG5vdygpIC0gMTVzIEFORCBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHNvdXJjZUxpc3QsICdQcm92aWRlcklQJykgK1wiIEFORCBcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeSh0YXJnZXRMaXN0LCAnRW5kcG9pbnRJUCcpIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgXCJHUk9VUCBCWSB0aW1lKDIwcykgZmlsbCgwKSBMSU1JVCAxXCJcbiAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gbWFrZVBvc3QodXJsLCBkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIFxuXG4gICAgICAgIGZ1bmN0aW9uIGdldE9sZEVkZ2VEYXRhKHNvdXJjZUxpc3QsIHRhcmdldExpc3QpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLlZJU1VBTElaQVRJT05fRU5EUE9JTlQ7XG4gICAgICAgICAgICB1cmwgKz0gJ2luZmx1eC9xdWVyeSc7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICAgICAgZGIgOiBcInRlbGVncmFmXCIsXG4gICAgICAgICAgICAgICAgICAgIHE6IFwiU0VMRUNUIHN1bShcIiArICdCeXRlc091dCcgKyBcIikgRlJPTSBodHRwanNvbl9zdmNzdGF0cyBXSEVSRSB0aW1lID4gbm93KCkgLSAxbSBBTkQgXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeShzb3VyY2VMaXN0LCBcIkVuZHBvaW50SVBcIikgK1wiIEFORCBcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeSh0YXJnZXRMaXN0LCBcIlByb3ZpZGVySVBcIikgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBcIiBHUk9VUCBCWSB0aW1lKDEwcykgZmlsbCgwKSBMSU1JVCA2OyBTRUxFQ1Qgc3VtKFwiICsgJ0J5dGVzSW4nICsgXCIpIEZST00gaHR0cGpzb25fc3Zjc3RhdHMgV0hFUkUgdGltZSA+IG5vdygpIC0gMW0gQU5EIFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkoc291cmNlTGlzdCwgXCJQcm92aWRlcklQXCIpICtcIiBBTkQgXCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkodGFyZ2V0TGlzdCwgXCJFbmRwb2ludElQXCIpIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgXCIgR1JPVVAgQlkgdGltZSgxMHMpIGZpbGwoMCkgTElNSVQgNlwiXG4gICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIG1ha2VQb3N0KHVybCwgZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0R3JhcGhEYXRhOiBnZXRHcmFwaERhdGEsXG4gICAgICAgICAgICBnZXRTdHJ1Y3R1cmVEYXRhOiBnZXRTdHJ1Y3R1cmVEYXRhLFxuICAgICAgICAgICAgZ2V0RWRnZURhdGE6IGdldEVkZ2VEYXRhLFxuICAgICAgICAgICAgZ2V0T2xkRWRnZURhdGE6IGdldE9sZEVkZ2VEYXRhXG4gICAgICAgIH1cbiAgICB9XSk7XG5cblxuXG5cblxuXG5cbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNi8zLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZvbHVtZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52b2x1bWVzLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2b2x1bWVzL3ZvbHVtZWNyZWF0ZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWb2x1bWVDcmVhdGVDdHJsIGFzIHZvbHVtZUNyZWF0ZUN0cmwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdWb2x1bWVDcmVhdGVDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ1ZvbHVtZXNNb2RlbCcsICdTdG9yYWdlUG9saWNpZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBWb2x1bWVzTW9kZWwsIFN0b3JhZ2VQb2xpY2llc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgdm9sdW1lQ3JlYXRlQ3RybCA9IHRoaXM7XG4gICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwuZmlsZXN5c3RlbXMgPSBbJ2V4dDQnLCAnYnRyZnMnXTtcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Wb2x1bWVzTW9kZWwoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZvbHVtZXMubGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbENyZWF0aW5nKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9Wb2x1bWVzTW9kZWwoKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IHN0b3JhZ2UgcG9saWNpZXMuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBnZXRTdG9yYWdlUG9saWNpZXMoKSB7XG4gICAgICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbC5nZXQoKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLnBvbGljaWVzID0gcmVzdWx0O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gYXBwbHlQb2xpY3lTZXR0aW5ncygpIHtcbiAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwubmV3Vm9sdW1lLnBvbGljeSA9IHZvbHVtZUNyZWF0ZUN0cmwuc2VsZWN0ZWRQb2xpY3kubmFtZTtcbiAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwubmV3Vm9sdW1lLmJhY2tlbmRzID0gdm9sdW1lQ3JlYXRlQ3RybC5zZWxlY3RlZFBvbGljeS5iYWNrZW5kcztcbiAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwubmV3Vm9sdW1lLmRyaXZlciA9IHZvbHVtZUNyZWF0ZUN0cmwuc2VsZWN0ZWRQb2xpY3kuZHJpdmVyO1xuICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUuY3JlYXRlID0gdm9sdW1lQ3JlYXRlQ3RybC5zZWxlY3RlZFBvbGljeS5jcmVhdGU7XG4gICAgICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLm5ld1ZvbHVtZS5ydW50aW1lID0gdm9sdW1lQ3JlYXRlQ3RybC5zZWxlY3RlZFBvbGljeS5ydW50aW1lO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZVZvbHVtZSgpIHtcbiAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgaWYgKHZvbHVtZUNyZWF0ZUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgYXBwbHlQb2xpY3lTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIFZvbHVtZXNNb2RlbC5jcmVhdGUodm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1ZvbHVtZXNNb2RlbCgpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcih2b2x1bWVDcmVhdGVDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJlc2V0Rm9ybSgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLm5ld1ZvbHVtZSA9IHtcbiAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICBcImJhY2tlbmRzXCI6IHt9LFxuICAgICAgICAgICAgICAgIFwiZHJpdmVyXCI6IHt9LFxuICAgICAgICAgICAgICAgIFwiY3JlYXRlXCI6IHt9LFxuICAgICAgICAgICAgICAgIFwicnVudGltZVwiOiB7fVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLmNyZWF0ZVZvbHVtZSA9IGNyZWF0ZVZvbHVtZTtcbiAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5jYW5jZWxDcmVhdGluZyA9IGNhbmNlbENyZWF0aW5nO1xuICAgICAgICBnZXRTdG9yYWdlUG9saWNpZXMoKTtcbiAgICAgICAgcmVzZXRGb3JtKCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dm9sdW1lY3JlYXRlY3RybC5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSBjc2hhbXB1ciBvbiA4LzkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudm9sdW1lcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZvbHVtZXMuY29weScsIHtcbiAgICAgICAgICAgIHVybDogJy9jb3B5LycsXG4gICAgICAgICAgICBwYXJhbXM6IHsgc25hcHNob3Q6IG51bGwsIHBvbGljeTogbnVsbCwgdm9sdW1lOiBudWxsIH0sXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVm9sdW1lU25hcHNob3RDb3B5Q3RybCBhcyB2b2x1bWVTbmFwc2hvdENvcHlDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndm9sdW1lcy92b2x1bWVzbmFwc2hvdGNvcHkuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1ZvbHVtZVNuYXBzaG90Q29weUN0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckaHR0cCcsICdWb2x1bWVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgJHNjb3BlLCAkaW50ZXJ2YWwsICRodHRwLCBWb2x1bWVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2b2x1bWVTbmFwc2hvdENvcHlDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ29weSgpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUudm9sdW1lcy5kZXRhaWxzJywgeyBrZXk6ICRzdGF0ZVBhcmFtcy5wb2xpY3kgKyAnLycgKyAkc3RhdGVQYXJhbXMudm9sdW1lIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdvVG9OZXdWb2x1bWUoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZvbHVtZXMuZGV0YWlscycsIHsga2V5OiAkc3RhdGVQYXJhbXMucG9saWN5ICsgJy8nICsgdm9sdW1lU25hcHNob3RDb3B5Q3RybC5uZXd2b2x1bWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY29weVNuYXBzaG90KCkge1xuICAgICAgICAgICAgaWYgKHZvbHVtZVNuYXBzaG90Q29weUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iodm9sdW1lU25hcHNob3RDb3B5Q3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIodm9sdW1lU25hcHNob3RDb3B5Q3RybCk7XG4gICAgICAgICAgICAgICAgdmFyIG1vZGVsID0ge307XG4gICAgICAgICAgICAgICAgbW9kZWwucG9saWN5ID0gJHN0YXRlUGFyYW1zLnBvbGljeTtcbiAgICAgICAgICAgICAgICBtb2RlbC5uYW1lID0gJHN0YXRlUGFyYW1zLnZvbHVtZTtcbiAgICAgICAgICAgICAgICBWb2x1bWVzTW9kZWwuY29weShtb2RlbCwgJHN0YXRlUGFyYW1zLnNuYXBzaG90LCB2b2x1bWVTbmFwc2hvdENvcHlDdHJsLm5ld3ZvbHVtZSlcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZVNuYXBzaG90Q29weUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBnb1RvTmV3Vm9sdW1lKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVTbmFwc2hvdENvcHlDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHZvbHVtZVNuYXBzaG90Q29weUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdm9sdW1lU25hcHNob3RDb3B5Q3RybC5wb2xpY3kgPSAkc3RhdGVQYXJhbXMucG9saWN5O1xuICAgICAgICB2b2x1bWVTbmFwc2hvdENvcHlDdHJsLnZvbHVtZSA9ICRzdGF0ZVBhcmFtcy52b2x1bWU7XG4gICAgICAgIHZvbHVtZVNuYXBzaG90Q29weUN0cmwuc25hcHNob3QgPSAkc3RhdGVQYXJhbXMuc25hcHNob3Q7XG4gICAgICAgIHZvbHVtZVNuYXBzaG90Q29weUN0cmwuY29weVNuYXBzaG90ID0gY29weVNuYXBzaG90O1xuICAgICAgICB2b2x1bWVTbmFwc2hvdENvcHlDdHJsLmNhbmNlbENvcHkgPSBjYW5jZWxDb3B5O1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXZvbHVtZXNuYXBzaG90Y29weWN0cmwuanMubWFwXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5kaXJlY3RpdmVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dkFjaXZhbGlkXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy9ub2Rlcy9hY2l2YWxpZC5odG1sJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgZm9ybTogXCI9XCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTtcbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2Q29udHJvbGludGVyZmFjZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvbm9kZXMvY29udHJvbGludGVyZmFjZS5odG1sJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgZXh0cmF2YXJzOiBcIj1cIlxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pO1xuYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZOZXR3b3JrbW9kZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvbm9kZXMvbmV0d29ya21vZGUuaHRtbCcsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIGV4dHJhdmFyczogXCI9XCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTtcbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2U2NoZWR1bGVyXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy9ub2Rlcy9zY2hlZHVsZXIuaHRtbCcsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIGV4dHJhdmFyczogXCI9XCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTsiLCIvKipcbiAqIERlZmluaW5nIHRoZSBHcmFwaCBNb2R1bGUuXG4gKiBTZWUgREVTSUdOLm1kIGZvciBpbmZvIG9uIEdyYXBoIE9iamVjdHMuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnLCBbXSk7XG5cblxuXG5cbiIsImFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIiwgW10pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8xNC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5tb2RlbHMnLCBbXSk7XG52YXIgQ29udGl2R2xvYmFscyA9IChmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgLy9SRVNUIGVuZHBvaW50cyBmb3IgTkVUTUFTVEVSXG4gICAgICAgICdORVRXT1JLU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9uZXR3b3Jrcy8nLFxuICAgICAgICAnTkVUV09SS1NfSU5TUEVDVF9FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9pbnNwZWN0L25ldHdvcmtzLycsXG4gICAgICAgICdTRVJWSUNFTEJTX0lOU1BFQ1RfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvaW5zcGVjdC9zZXJ2aWNlTEJzLycsXG4gICAgICAgICdQT0xJQ0lFU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9wb2xpY3lzLycsXG4gICAgICAgICdSVUxFU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9ydWxlcy8nLFxuICAgICAgICAnQVBQTElDQVRJT05HUk9VUFNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvZW5kcG9pbnRHcm91cHMvJyxcbiAgICAgICAgJ1NFUlZJQ0VMQlNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvc2VydmljZUxCcy8nLFxuICAgICAgICAnT1JHQU5JWkFUSU9OU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS90ZW5hbnRzLycsXG4gICAgICAgICdORVRXT1JLX1NFVFRJTkdTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL2dsb2JhbHMvJyxcbiAgICAgICAgJ05FVFBST0ZJTEVTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL25ldHByb2ZpbGVzLycsXG4gICAgICAgICdCR1BTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL0JncHMvJyxcbiAgICAgICAgJ0JHUFNfSU5TUEVDVF9FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9pbnNwZWN0L0JncHMvJyxcbiAgICAgICAgJ1ZJU1VBTElaQVRJT05fRU5EUE9JTlQnOiAnL3Zpc3VhbGl6YXRpb24vJyxcbiAgICAgICAgLy9SRVNUIGVuZHBvaW50cyBmb3IgVk9MTUFTVEVSXG4gICAgICAgICdWT0xVTUVTX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvdm9sdW1lcy8nLFxuICAgICAgICAnVk9MVU1FU19DUkVBVEVfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci92b2x1bWVzL2NyZWF0ZS8nLFxuICAgICAgICAnVk9MVU1FU19ERUxFVEVfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci92b2x1bWVzL3JlbW92ZS8nLFxuICAgICAgICAnVk9MVU1FU19DT1BZU05BUFNIT1RTX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvdm9sdW1lcy9jb3B5JyxcbiAgICAgICAgJ1ZPTFVNRVNfVVNFU19FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3VzZXMvbW91bnRzLycsXG4gICAgICAgICdWT0xVTUVTX1NOQVBTSE9UU19FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3NuYXBzaG90cy8nLFxuICAgICAgICAnU1RPUkFHRVBPTElDSUVTX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvcG9saWNpZXMvJyxcbiAgICAgICAgJ1ZPTFVNRVNfR0xPQkFMX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvZ2xvYmFsLycsXG4gICAgICAgIC8vUkVTVCBlbmRwb2ludHMgZm9yIENMVVNURVJcbiAgICAgICAgJ05PREVTX0xJU1RfRU5EUE9JTlQnOiAnL2luZm8vbm9kZXMnLFxuICAgICAgICAnTk9ERVNfRElTQ09WRVJfRU5EUE9JTlQnOiAnL2Rpc2NvdmVyL25vZGVzJyxcbiAgICAgICAgJ05PREVTX0NPTU1JU1NJT05fRU5EUE9JTlQnOiAnL2NvbW1pc3Npb24vbm9kZXMnLFxuICAgICAgICAnTk9ERVNfREVDT01NSVNTSU9OX0VORFBPSU5UJzogJy9kZWNvbW1pc3Npb24vbm9kZXMnLFxuICAgICAgICAnTk9ERVNfTUFJTlRFTkFOQ0VfRU5EUE9JTlQnOiAnL21haW50ZW5hbmNlL25vZGVzJyxcbiAgICAgICAgJ05PREVTX0xBU1RfSk9CX0VORFBPSU5UJzogJy9pbmZvL2pvYi9sYXN0JyxcbiAgICAgICAgJ05PREVTX0FDVElWRV9KT0JfRU5EUE9JTlQnOiAnL2luZm8vam9iL2FjdGl2ZScsXG4gICAgICAgICdOT0RFU19TRVRUSU5HU19TRVRfRU5EUE9JTlQnOiAnL2dsb2JhbHMnLFxuICAgICAgICAnTk9ERVNfU0VUVElOR1NfR0VUX0VORFBPSU5UJzogJy9pbmZvL2dsb2JhbHMnLFxuICAgICAgICAvL1JlZnJlc2ggaW50ZXJ2YWwgaW4gbWlsbGlzZWNvbmRzXG4gICAgICAgICdSRUZSRVNIX0lOVEVSVkFMJzogNTAwMCxcbiAgICAgICAgLy9SZWdFeCBmb3IgdmFsaWRhdGlvblxuICAgICAgICAnQ0lEUl9SRUdFWCc6ICdeKChbMC05XXxbMS05XVswLTldfDFbMC05XXsyfXwyWzAtNF1bMC05XXwyNVswLTVdKVxcLil7M30oWzAtOV18WzEtOV1bMC05XXwxWzAtOV17Mn18MlswLTRdWzAtOV18MjVbMC01XSkoXFwvKFswLTldfFsxLTJdWzAtOV18M1swLTJdKSkkJyxcbiAgICAgICAgJ1ZMQU5fUkVHRVgnOiAnXihbMC05XXsxLDR9Py1bMC05XXsxLDR9PykkJyxcbiAgICAgICAgJ1ZYTEFOX1JFR0VYJzogJ14oWzAtOV17MSw4fT8tWzAtOV17MSw4fT8pJCcsXG4gICAgICAgICdOVU1CRVJfUkVHRVgnOiAnXlswLTldKiQnXG4gICAgfTtcbn0pKCk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwIiwiLyoqXG4gKiBUaGUgYmFzZSBjbGFzcyB0aGUgRGF0YVNvdXJjZSBvYmplY3QuXG4gKiBcbiAqIFRoZSBEYXRhU291cmNlIG9iamVjdCB0YWtlcyBpbiBub2RlIGFuZCBsaW5rIGRhdGEgZnJvbSB0aGUgc2VydmVyLCBcbiAqIGFuZCBwcm92aWRlcyBtZXRob2RzIGZvciBjb252ZXJ0aW5nIGFuZCBtYW5pcHVsYXRpbmcgdGhlIGRhdGEgZm9yXG4gKiB0aGUgZ3JhcGggb2JqZWN0LlxuICogXG4gKiBUbyB3cml0ZSB5b3VyIG93biBEYXRhU291cmNlIG9iamVjdCwgY3JlYXRlIGEgbmV3IGZhY3RvcnkgdGhhdCB1c2VzIHRoZSBcbiAqIERhdGFTb3VyY2UgeW91IHdhbnQgdG8gaW5oZXJpdCBhcyBhIGRlcGVuZGVuY3ksIGFuZCBleHRlbmQgXG4gKiBpdHMgRGF0YVNvdXJjZSBjbGFzcy4gXG4gKiBSZXR1cm4gdGhlIGNsYXNzIG9iamVjdCB3aXRoIERhdGFTb3VyY2UgYXMga2V5LlxuICogXG4gKiBOb2RlIGRhdGEgaXMgZXhwZWN0ZWQgdG8gYmUgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6XG4gKiB7aWQ6bm9kZV9pZCwgdGV4dDpub2RlX3RleHR9XG4gKiBcbiAqIExpbmsgZGF0YSBpcyBleHBlY3RlZCB0byBiZSBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDpcbiAqIHtzb3VyY2U6IHNvdXJjZU5vZGVJZCwgdGFyZ2V0OiB0YXJnZXROb2RlSWR9XG4gKiBcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ0RhdGFTb3VyY2UnLCBbJ05vZGUnLCAnTGluaycsIFxuICAgIFx0ZnVuY3Rpb24gKE5vZGUsIExpbmspIHtcblxuICAgIFx0Y2xhc3MgRGF0YVNvdXJjZSB7XG4gICAgXHRcdC8qKlxuICAgIFx0XHQgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgXHRcdCAqXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBub2RlcyAgICAgICAgICAgICAgVGhlIG5vZGUgZGF0YSBcbiAgICBcdFx0ICogQHBhcmFtICAgICAge0FycmF5fSAgIGxpbmtzICAgICAgICAgICAgICBUaGUgbGluayBkYXRhXG4gICAgXHRcdCAqL1xuXHRcdFx0Y29uc3RydWN0b3Iobm9kZXMsIGxpbmtzKSB7XG5cdFx0XHRcdHRoaXMubm9kZXMgPSBub2Rlcztcblx0XHRcdFx0dGhpcy5saW5rcyA9IGxpbmtzO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFJlcGxhY2VzIHRoZSBub2RlIGRhdGFcblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGVzICAgVGhlIG5vZGVzXG5cdFx0XHQgKi9cblx0XHRcdHVwZGF0ZU5vZGVzKG5vZGVzKSB7XG5cdFx0XHRcdHRoaXMubm9kZXMgPSBub2Rlcztcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBSZXBsYWNlcyB0aGUgbGluayBkYXRhXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0xpbmt9ICBsaW5rcyAgIFRoZSBsaW5rc1xuXHRcdFx0ICovXG5cdFx0XHR1cGRhdGVMaW5rcyhsaW5rcykge1xuXHRcdFx0XHR0aGlzLmxpbmtzID0gbGlua3M7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogUmV0dXJucyB0aGUgTmFtZSBhdHRyaWJ1dGUgb2YgdGhlIE5vZGUgd2l0aCB0aGUgXG5cdFx0XHQgKiBtYXRjaGluZyBpZFxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG5cdFx0XHQgKiBAcmV0dXJuICAgICB7c3RyaW5nfSAgbmFtZSBvZiB0aGUgbWF0Y2hpbmcgbm9kZVxuXHRcdFx0ICovXG5cdFx0XHRub2RlSWRUb05hbWUoaWQpIHtcblx0XHQgICAgICAgIHZhciBub2RlcyA9IHRoaXMubm9kZXM7XG5cdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0ICAgICAgICAgICAgaWYgKG5vZGVzW2ldLmlkID09IGlkKSB7XG5cdFx0ICAgICAgICAgICAgICAgIHJldHVybiBub2Rlc1tpXS5uYW1lO1xuXHRcdCAgICAgICAgICAgIH1cblx0XHQgICAgICAgIH1cblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBwcm9jZXNzIHRoZSBub2RlRGF0YSB0byBjcmVhdGUgTm9kZSBvYmplY3RzXG5cdFx0ICAgICAqXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVEYXRhICBOb2RlRGF0YSB0byBjb252ZXJ0IFxuXHRcdCAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gbm9kZSBvYmplY3RzXG5cdFx0ICAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIE5vZGUgb2JqZWN0c1xuXHRcdCAgICAgKi9cblx0XHQgICAgcHJvY2Vzc05vZGVEYXRhKG5vZGVEYXRhKSB7XG5cdFx0ICAgICAgICB2YXIgbm9kZXMgPSBbXTtcblx0XHQgICAgICAgIF8uZm9yRWFjaChub2RlRGF0YSwgZnVuY3Rpb24oZGF0YSkge1xuXHRcdCAgICAgICAgICAgIHZhciBuZXdOb2RlID0gbmV3IE5vZGUuTm9kZShudWxsLCBudWxsLCBkYXRhLmlkLCBkYXRhLnRleHQsIG51bGwpO1xuXHRcdCAgICAgICAgICAgIG5vZGVzLnB1c2gobmV3Tm9kZSk7XG5cdFx0ICAgICAgICB9KTtcblx0XHQgICAgICAgIHJldHVybiBub2Rlcztcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBwcm9jZXNzIHRoZSBsaW5rRGF0YVxuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBsaW5rRGF0YSAgVGhlIGxpbmsgZGF0YVxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlcyAgICAgVGhlIG5vZGVzIGZyb20gcHJvY2Vzc05vZGVEYXRhXG5cdFx0ICAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIExpbmsgb2JqZWN0c1xuXHRcdCAgICAgKi9cblx0XHQgICAgcHJvY2Vzc0xpbmtEYXRhKGxpbmtEYXRhLCBub2Rlcykge1xuXHRcdCAgICBcdC8qKlxuXHRcdFx0ICAgICAqIFJldHVybnMgdGhlIG5vZGUgdGhhdCBtYXRjaGVzIHRoZSBpZFxuXHRcdFx0ICAgICAqXG5cdFx0XHQgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gaWQgICAgICBUaGUgaWRlbnRpZmllclxuXHRcdFx0ICAgICAqIEByZXR1cm4gICAgIHtOb2RlfSAgIFRoZSBub2RlIHdpdGggdGhlIG1hdGNoaW5nIGlkXG5cdFx0XHQgICAgICovXG5cdFx0XHQgICAgZnVuY3Rpb24gZmluZE5vZGVCeUlkKGlkLCBub2Rlcykge1xuXHRcdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHQgICAgICAgICAgICBpZiAoaWQgPT0gbm9kZXNbaV0uaWQpIHtcblx0XHRcdCAgICAgICAgICAgICAgICByZXR1cm4gbm9kZXNbaV07XG5cdFx0XHQgICAgICAgICAgICB9XG5cdFx0XHQgICAgICAgIH1cblx0XHRcdCAgICB9XG5cblx0XHQgICAgICAgIHZhciBsaW5rcyA9IFtdO1xuXHRcdCAgICAgICAgLy90cmFuc2Zvcm1pbmcgbGluayBkYXRhXG5cdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpbmtEYXRhLmxlbmd0aDsgaSsrKSB7XG5cdFx0ICAgICAgICAgICAgaWYgKGxpbmtEYXRhW2ldLnNvdXJjZSAhPSBsaW5rRGF0YVtpXS50YXJnZXQpIHtcblx0XHQgICAgICAgICAgICAgICAgdmFyIHNvdXJjZSA9IGZpbmROb2RlQnlJZChsaW5rRGF0YVtpXS5zb3VyY2UsIG5vZGVzKTtcblx0XHQgICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IGZpbmROb2RlQnlJZChsaW5rRGF0YVtpXS50YXJnZXQsIG5vZGVzKTtcblx0XHQgICAgICAgICAgICAgICAgaWYgKHNvdXJjZSA9PSBudWxsIHx8IHRhcmdldCA9PSBudWxsKSB7XG5cdFx0ICAgICAgICAgICAgICAgIFx0Y29udGludWU7XG5cdFx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICB2YXIgbGluayA9IG5ldyBMaW5rLkxpbmsoc291cmNlLCB0YXJnZXQpO1xuXHQgICAgICAgICAgICAgICAgICAgIGxpbmtzLnB1c2gobGluayk7XG5cdFx0ICAgICAgICAgICAgfSAgXG5cdFx0ICAgICAgICB9XG5cdFx0ICAgICAgICByZXR1cm4gbGlua3M7XG5cdFx0ICAgIH1cblx0XHR9XG5cdFx0cmV0dXJuIHtcblx0XHRcdERhdGFTb3VyY2U6RGF0YVNvdXJjZVxuXHRcdH1cbn1dKTtcblxuXG5cblxuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi51dGlscycsIFtdKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIFRoZSBEYXRhU291cmNlIHVzZWQgZm9yIHRoZSB2aXN1YWxpemF0aW9uIHRhYi5cbiAqIFxuICogTm9kZSBEYXRhIGZyb20gdGhlIHNlcnZlciBpcyBleHBlY3RlZCB0byBiZSBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDpcbiAqIHtpZDogbm9kZV9pZCwgdGV4dDogbm9kZV90ZXh0fVxuICogUGFyZW50IGFuZCBBbmNlc3RvciBhdHRyaWJ1dGVzIGNhbiBiZSBzZXQgYnkgY2FsbGluZyBzZXRBbmNlc3RvcnNcbiAqIFxuICogTGluayBEYXRhIGZyb20gdGhlIHNlcnZlciBpcyBleHBlY3RlZCB0byBiZSBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDpcbiAqIHtzb3VyY2U6IHNvdXJjZU5vZGVJZCwgdGFyZ2V0OiB0YXJnZXROb2RlSWQsIHdlaWdodDogbGlua1dlaWdodH1cbiAqIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnVmlzdWFsaXplckRhdGFTb3VyY2UnLCBbJ0RhdGFTb3VyY2UnLCAnVmlzdWFsaXplck5vZGUnLCAnVmlzdWFsaXplckxpbmsnLCBcbiAgICBcdGZ1bmN0aW9uIChEYXRhU291cmNlLCBWaXN1YWxpemVyTm9kZSwgVmlzdWFsaXplckxpbmspIHtcblxuICAgIFx0Y2xhc3MgVmlzdWFsaXplckRhdGFTb3VyY2UgZXh0ZW5kcyBEYXRhU291cmNlLkRhdGFTb3VyY2Uge1xuICAgIFx0XHQvKipcbiAgICBcdFx0ICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgIFx0XHQgKiBcbiAgICBcdFx0ICogQ2hpbGRyZW4gU3RydWN0IGFuZCBhbmNlc3RvcnNfc3RydWN0IGFyZSBKU09OIG9iamVjdHMsXG4gICAgXHRcdCAqIG1hcHBpbmcgYSBub2RlIElkIHRvIGEgbGlzdCBvZiBpdCdzIGNoaWxkcmVuIG9yIGFuY2VzdG9ycy5cbiAgICBcdFx0ICogQ2hpbGRyZW4gU3RydWN0IGlzIGFsc28gZXhwZWN0ZWQgdG8gaGF2ZSBhIGZpZWxkIGNhbGxlZFxuICAgIFx0XHQgKiB0b3BMZXZlbCwgdGhhdCBtYXBzIHRvIGEgbGlzdCBvZiBhbGwgdGhlIG5vZGVzIHRoYXQgZG9uJ3RcbiAgICBcdFx0ICogaGF2ZSBhbnkgcGFyZW50cy5cbiAgICBcdFx0ICpcbiAgICBcdFx0ICogQHBhcmFtICAgICAge0FycmF5fSAgIG5vZGVzICAgICAgICAgICAgICBUaGUgbm9kZSBkYXRhIFxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgbGlua3MgICAgICAgICAgICAgIFRoZSBsaW5rIGRhdGFcbiAgICBcdFx0ICogQHBhcmFtICAgICAge09iamVjdH0gIGNoaWxkcmVuX3N0cnVjdCAgICBUaGUgY2hpbGRyZW4gc3RydWN0dXJlXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBhbmNlc3RvcnNfc3RydWN0ICAgVGhlIGFuY2VzdG9ycyBzdHJ1Y3R1cmVcbiAgICBcdFx0ICogQHBhcmFtICAgICAge0FycmF5fSAgIGxhYmVscyAgICAgICAgICAgICBUaGUgbGFiZWxzXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBzZWxlY3RvcnMgICAgICAgICAgVGhlIHNlbGVjdG9yc1xuICAgIFx0XHQgKi9cblx0XHRcdGNvbnN0cnVjdG9yKG5vZGVzLCBsaW5rcywgY2hpbGRyZW5fc3RydWN0LCBhbmNlc3RvcnNfc3RydWN0LCBcblx0XHRcdFx0XHRsYWJlbHMsIHNlbGVjdG9ycykge1xuXHRcdFx0XHRzdXBlcihub2RlcyxsaW5rcyk7XG5cdFx0XHRcdHRoaXMuY2hpbGRyZW5fc3RydWN0ID0gY2hpbGRyZW5fc3RydWN0O1xuXHRcdFx0XHR0aGlzLmFuY2VzdG9yc19zdHJ1Y3QgPSBhbmNlc3RvcnNfc3RydWN0O1xuXHRcdFx0XHR0aGlzLmxhYmVscyA9IGxhYmVscztcblx0XHRcdFx0dGhpcy5zZWxlY3RvcnMgPSBzZWxlY3RvcnM7XG5cdFx0XHR9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIERldGVybWluZXMgaWYgaXQgaGFzIGNoaWxkLlxuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgIGlkICAgICAgVGhlIGlkZW50aWZpZXJcblx0XHQgICAgICogQHJldHVybiAgICAge2Jvb2xlYW59ICBUcnVlIGlmIGhhcyBjaGlsZCwgRmFsc2Ugb3RoZXJ3aXNlLlxuXHRcdCAgICAgKi9cblx0XHQgICAgaGFzQ2hpbGQoaWQpIHtcblx0XHQgICAgXHRpZiAodGhpcy5jaGlsZHJlbl9zdHJ1Y3RbaWRdID09IG51bGwpIHtcbiAgICAgICAgICAgIFx0XHRyZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBcdH1cbiAgICAgICAgICAgIFx0cmV0dXJuIHRydWU7XHRcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBTZXRzIHRoZSBwYXJlbnQgYW5kIGFuY2VzdG9ycyBhdHRyaWJ1dGUgdXNpbmcgXG5cdFx0ICAgICAqIGFuY2VzdG9yc19zdHJ1Y3QgZm9yIGFsbCB0aGUgbm9kZXNcblx0XHQgICAgICogQWxzbyBhZGRzIGFueSBub2RlcyB3aXRob3V0IGFuY2VzdG9ycywgdGhhdCBhcmVuJ3QgXG5cdFx0ICAgICAqIHRvcGxldmVsIHRvIHRoZSBjbGllbnQgc2VydmljZS5cblx0XHQgICAgICovXG5cdFx0ICAgIHNldEFuY2VzdG9ycygpIHtcblx0XHQgICAgXHR2YXIgdGhpc0RhdGFTb3VyY2UgPSB0aGlzO1xuXHRcdCAgICBcdHZhciBhZGRlZENsaWVudCA9IGZhbHNlO1xuXHRcdCAgICBcdF8uZm9yRWFjaCh0aGlzRGF0YVNvdXJjZS5ub2RlcywgZnVuY3Rpb24obm9kZSkge1xuXHRcdCAgICBcdFx0bm9kZS5hbmNlc3RvcnMgPSB0aGlzRGF0YVNvdXJjZS5hbmNlc3RvcnNfc3RydWN0W25vZGUuaWRdIHx8IFtdO1xuXHRcdCAgICBcdFx0aWYgKF8uaXNFbXB0eShub2RlLmFuY2VzdG9ycykgPT09IGZhbHNlKSB7XG5cdFx0ICAgIFx0XHRcdG5vZGUucGFyZW50ID0gbm9kZS5hbmNlc3RvcnNbMF07XG5cdFx0ICAgIFx0XHR9IGVsc2Uge1xuXHRcdCAgICBcdFx0XHRpZiAoXy5pbmNsdWRlcyh0aGlzRGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwsIG5vZGUuaWQpID09IGZhbHNlKSB7XG5cdFx0ICAgIFx0XHRcdFx0Ly9jb250YWluZXIgaGFzIG5vIHBhcmVudFxuXHRcdCAgICBcdFx0XHRcdC8vYWRkaW5nIHRvIGNsaWVudFxuXHRcdCAgICBcdFx0XHRcdG5vZGUuYW5jZXN0b3JzLnB1c2goXCJjbGllbnRcIik7XG5cdFx0ICAgIFx0XHRcdFx0dGhpc0RhdGFTb3VyY2UuYW5jZXN0b3JzX3N0cnVjdFtub2RlLmlkXSA9IFtcImNsaWVudFwiXTtcblx0XHQgICAgXHRcdFx0XHRpZiAoYWRkZWRDbGllbnQgPT09IGZhbHNlKSB7XG5cdFx0ICAgIFx0XHRcdFx0XHRhZGRlZENsaWVudCA9IHRydWU7XG5cdFx0XHQgICAgXHRcdFx0XHR0aGlzRGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwucHVzaChcImNsaWVudFwiKTtcblx0XHQgICAgXHRcdFx0XHRcdHRoaXNEYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFsnY2xpZW50J10gPSBbXTtcblx0XHQgICAgXHRcdFx0XHR9XG5cdFx0ICAgIFx0XHRcdFx0dGhpc0RhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0WydjbGllbnQnXS5wdXNoKG5vZGUuaWQpO1xuXHRcdFx0ICAgIFx0XHR9XG5cdFx0ICAgIFx0XHR9XG5cdFx0ICAgIFx0fSlcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBSZXR1cm5zIHRoZSBmbG93IGJldHdlZW4gdGhlIGhpZ2hlc3QgbGV2ZWwgZ3JvdXBpbmdcblx0XHQgICAgICpcblx0XHQgICAgICogQHJldHVybiAgICAge09iamVjdH0gIFRoZSB0b3AgbGV2ZWwgZmxvdy5cblx0XHQgICAgICovXG5cdFx0ICAgIGdldFRvcExldmVsRmxvdygpIHtcblx0XHQgICAgICAgIHJldHVybiB0aGlzLmdldEZsb3dCZXR3ZWVuU2V0KHRoaXMuY2hpbGRyZW5fc3RydWN0LnRvcExldmVsKTtcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBHZXRzIHRoZSBmbG93IGJldHdlZW4gYW55IHNldCBvZiBub2RlIGxldmVsc1xuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlX25hbWVzICBUaGUgbm9kZSBuYW1lcyBpbiB0aGUgc2V0XG5cdFx0ICAgICAqIEByZXR1cm4gICAgIHtPYmplY3R9ICBUaGUgZmxvdyBiZXR3ZWVuIHNldC5cblx0XHQgICAgICovXG5cdFx0ICAgIGdldEZsb3dCZXR3ZWVuU2V0KG5vZGVfbmFtZXMpIHtcblx0XHQgICAgICAgIHZhciBsb2NhbF9ub2RlcyA9IHRoaXMubm9kZXM7XG5cdFx0ICAgICAgICB2YXIgaWRNYXBwaW5nID0ge307XG5cdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxvY2FsX25vZGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0ICAgICAgICAgICAgdmFyIG5vZGUgPSBsb2NhbF9ub2Rlc1tpXTtcblxuXHRcdCAgICAgICAgICAgIC8vaWYgbm9kZSBpcyBhbHJlYWR5IGF0IGl0cyBoaWdoZXN0IGxldmVsXG5cdFx0ICAgICAgICAgICAgaWYgKG5vZGUuYW5jZXN0b3JzID09PSBudWxsKSB7XG5cdFx0ICAgICAgICAgICAgICAgIGlkTWFwcGluZ1tub2RlLmlkXSA9IG5vZGUubmFtZTtcblx0XHQgICAgICAgICAgICB9IGVsc2Uge1xuXHRcdCAgICAgICAgICAgICAgICAvL2NoZWNrIHRvIHNlZSB3aGljaCB0YWdzIGFyZSBwcmVzZW50IGluIHRoZSBhbmNlc3RvciBsaXN0XG5cdFx0ICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbm9kZV9uYW1lcy5sZW5ndGg7IGorKykge1xuXHRcdCAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuYW5jZXN0b3JzLmluZGV4T2Yobm9kZV9uYW1lc1tqXSkgPiAtMSkge1xuXHRcdCAgICAgICAgICAgICAgICAgICAgICAgIGlkTWFwcGluZ1tub2RlLmlkXSA9IG5vZGVfbmFtZXNbal07XG5cdFx0ICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cdFx0ICAgICAgICAgICAgICAgICAgICB9XG5cdFx0ICAgICAgICAgICAgICAgIH1cblx0XHQgICAgICAgICAgICB9XG5cdFx0ICAgICAgICB9ICAgXG5cdFx0ICAgICAgICAvL21vZGlmeSBsaW5rc1xuXHRcdCAgICAgICAgdmFyIGxpbmtzID0gdGhpcy5saW5rcztcblx0XHQgICAgICAgIHZhciBsaW5rRGF0YSA9IFtdO1xuXHRcdCAgICAgICAgXG5cdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpbmtzLmxlbmd0aDsgaSsrKSB7XG5cdFx0ICAgICAgICAgICAgdmFyIGxpbmsgPSBbXTtcblx0XHQgICAgICAgICAgICBsaW5rLnNvdXJjZSA9IGlkTWFwcGluZ1tsaW5rc1tpXS5zb3VyY2VdIHx8IGxpbmtzW2ldLnNvdXJjZTtcblx0XHQgICAgICAgICAgICBsaW5rLnRhcmdldCA9IGlkTWFwcGluZ1tsaW5rc1tpXS50YXJnZXRdIHx8IGxpbmtzW2ldLnRhcmdldDtcblx0XHQgICAgICAgICAgICBsaW5rLndlaWdodCA9IGxpbmtzW2ldLndlaWdodDtcblx0XHQgICAgICAgICAgICBsaW5rRGF0YS5wdXNoKGxpbmspO1xuXHRcdCAgICAgICAgfVxuXG5cdFx0ICAgICAgICAvL2NyZWF0aW5nIHRoZSBub2RlRGF0YVxuXHRcdCAgICAgICAgdmFyIG5vZGVEYXRhID0gW107XG5cdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVfbmFtZXMubGVuZ3RoOyBpKyspIHtcblx0XHQgICAgICAgICAgICB2YXIgbm9kZV90b19hZGQgPSBbXTtcblx0XHQgICAgICAgICAgICBub2RlX3RvX2FkZC5pZCA9IG5vZGVfbmFtZXNbaV07XG5cdFx0ICAgICAgICAgICAgbm9kZV90b19hZGQudGV4dCA9IHRoaXMubm9kZUlkVG9OYW1lKG5vZGVfbmFtZXNbaV0pIHx8IG5vZGVfbmFtZXNbaV07XG5cblxuXHRcdCAgICAgICAgICAgIG5vZGVfdG9fYWRkLmFuY2VzdG9ycyA9IHRoaXMuYW5jZXN0b3JzX3N0cnVjdFtub2RlX25hbWVzW2ldXSB8fCB0aGlzLmFuY2VzdG9yc19zdHJ1Y3Rbbm9kZV90b19hZGQudGV4dF0gfHwgW107XG5cdFx0ICAgICAgICAgICAgaWYgKF8uaXNFbXB0eShub2RlX3RvX2FkZC5hbmNlc3RvcnMpID09PSBmYWxzZSkge1xuXHRcdCAgICAgICAgICAgICAgICBub2RlX3RvX2FkZC5wYXJlbnQgPSBub2RlX3RvX2FkZC5hbmNlc3RvcnNbMF07XG5cdFx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0XHQgICAgICAgICAgICAgICAgbm9kZV90b19hZGQucGFyZW50ID0gbnVsbDtcblx0XHQgICAgICAgICAgICB9XG5cdFx0ICAgICAgICAgICAgbm9kZURhdGEucHVzaChub2RlX3RvX2FkZCk7XG5cdFx0ICAgICAgICB9XG5cblx0XHQgICAgICAgIHJldHVybiB7bm9kZURhdGE6bm9kZURhdGEsIGxpbmtEYXRhOmxpbmtEYXRhfTtcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBwcm9jZXNzIHRoZSBub2RlRGF0YSBvdXRwdXQgb2YgZ2V0Rmxvd0JldHdlZW5TZXRcblx0XHQgICAgICpcblx0XHQgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZURhdGEgIE5vZGVEYXRhIHRvIGNvbnZlcnQgXG5cdFx0ICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0byBub2RlIG9iamVjdHNcblx0XHQgICAgICogQHJldHVybiAgICAge0FycmF5fSAgTm9kZSBvYmplY3RzXG5cdFx0ICAgICAqL1xuXHRcdCAgICBwcm9jZXNzTm9kZURhdGEobm9kZURhdGEpIHtcblx0XHQgICAgICAgIHZhciBub2RlcyA9IFtdO1xuXHRcdCAgICAgICAgXy5mb3JFYWNoKG5vZGVEYXRhLCBmdW5jdGlvbihkYXRhKSB7XG5cdFx0ICAgICAgICAgICAgdmFyIG5ld05vZGUgPSBuZXcgVmlzdWFsaXplck5vZGUuTm9kZShudWxsLCBudWxsLCBkYXRhLmlkLCBkYXRhLnRleHQsXG5cdFx0ICAgICAgICAgICAgICAgIG51bGwsIGRhdGEucGFyZW50LCBkYXRhLmFuY2VzdG9ycywgbnVsbCwgbnVsbCk7XG5cdFx0ICAgICAgICAgICAgbm9kZXMucHVzaChuZXdOb2RlKTtcblx0XHQgICAgICAgIH0pO1xuXHRcdCAgICAgICAgcmV0dXJuIG5vZGVzO1xuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIHByb2Nlc3MgdGhlIGxpbmtEYXRhIG91dHB1dCBvZiBnZXRGbG93QmV0d2VlblNldFxuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBsaW5rRGF0YSAgVGhlIGxpbmsgZGF0YVxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlcyAgICAgVGhlIG5vZGVzXG5cdFx0ICAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIExpbmsgb2JqZWN0c1xuXHRcdCAgICAgKi9cblx0XHQgICAgcHJvY2Vzc0xpbmtEYXRhKGxpbmtEYXRhLCBub2Rlcykge1xuXHRcdCAgICBcdC8qKlxuXHRcdFx0ICAgICAqIFJldHVybnMgdGhlIG5vZGUgdGhhdCBtYXRjaGVzIHRoZSBpZFxuXHRcdFx0ICAgICAqXG5cdFx0XHQgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gaWQgICAgICBUaGUgaWRlbnRpZmllclxuXHRcdFx0ICAgICAqIEByZXR1cm4gICAgIHtOb2RlfSAgIFRoZSBub2RlIHdpdGggdGhlIG1hdGNoaW5nIGlkXG5cdFx0XHQgICAgICovXG5cdFx0XHQgICAgZnVuY3Rpb24gZmluZE5vZGVCeUlkKGlkLCBub2Rlcykge1xuXHRcdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHQgICAgICAgICAgICBpZiAoaWQgPT0gbm9kZXNbaV0uaWQpIHtcblx0XHRcdCAgICAgICAgICAgICAgICByZXR1cm4gbm9kZXNbaV07XG5cdFx0XHQgICAgICAgICAgICB9XG5cdFx0XHQgICAgICAgIH1cblx0XHRcdCAgICB9XG5cblx0XHQgICAgICAgIHZhciBsaW5rcyA9IFtdO1xuXHRcdCAgICAgICAgLy9hIG1hcHBpbmcgZnJvbSBzb3VyY2UuaWQtdGFyZ2V0LmlkIHRvIHRoZSBsaW5rIGFkZGVkXG5cdFx0ICAgICAgICB2YXIgYWRkZWRfbGlua3MgPSB7fTtcblx0XHQgICAgICAgIC8vdHJhbnNmb3JtaW5nIGxpbmsgZGF0YVxuXHRcdCAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5rRGF0YS5sZW5ndGg7IGkrKykge1xuXHRcdCAgICAgICAgICAgIGlmIChsaW5rRGF0YVtpXS5zb3VyY2UgIT0gbGlua0RhdGFbaV0udGFyZ2V0KSB7XG5cdFx0ICAgICAgICAgICAgICAgIHZhciBzb3VyY2UgPSBmaW5kTm9kZUJ5SWQobGlua0RhdGFbaV0uc291cmNlLCBub2Rlcyk7XG5cdFx0ICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSBmaW5kTm9kZUJ5SWQobGlua0RhdGFbaV0udGFyZ2V0LCBub2Rlcyk7XG5cdFx0ICAgICAgICAgICAgICAgIHZhciB3ZWlnaHQgPSBsaW5rRGF0YVtpXS53ZWlnaHQ7XG5cdFx0ICAgICAgICAgICAgICAgIC8vaW4gb3JkZXIgdG8gc3VtIGFsbCB0aGUgd2VpZ2h0cyBvZiB0aGUgbGlua3Mgb2YgdGhlIHN1Yi1ub2Rlcyxcblx0XHQgICAgICAgICAgICAgICAgLy93ZSB1c2UgYWRkZWRfbGlua3MgdG8ga2VlcCB0cmFjayBpZiBhbiBsaW5rIHdhcyBhZGRlZFxuXHRcdCAgICAgICAgICAgICAgICAvL2lmIGl0IGlzLCB3ZSBtb2RpZnkgaXRzIHdlaWdodFxuXHRcdCAgICAgICAgICAgICAgICBpZiAoc291cmNlID09IG51bGwgfHwgdGFyZ2V0ID09IG51bGwpIHtcblx0XHQgICAgICAgICAgICAgICAgXHRjb250aW51ZTtcblx0XHQgICAgICAgICAgICAgICAgfVxuXHRcdCAgICAgICAgICAgICAgICBpZiAoYWRkZWRfbGlua3Nbc291cmNlLmlkICsgJy0nICsgdGFyZ2V0LmlkXSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0ICAgICAgICAgICAgICAgICAgICB2YXIgbGluayA9IG5ldyBWaXN1YWxpemVyTGluay5MaW5rKHNvdXJjZSwgdGFyZ2V0LCB3ZWlnaHQpO1xuXHRcdCAgICAgICAgICAgICAgICAgICAgYWRkZWRfbGlua3Nbc291cmNlLmlkICsgJy0nICsgdGFyZ2V0LmlkXSA9IGxpbms7XG5cdFx0ICAgICAgICAgICAgICAgICAgICBsaW5rcy5wdXNoKGxpbmspO1xuXHRcdCAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHRcdCAgICAgICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nX2xpbmsgPSBhZGRlZF9saW5rc1tzb3VyY2UuaWQgKyAnLScgKyB0YXJnZXQuaWRdO1xuXHRcdCAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdfbGluay5zZXRXZWlnaHQoZXhpc3RpbmdfbGluay5nZXRSYXdXZWlnaHQoKSArIHdlaWdodCk7XG5cdFx0ICAgICAgICAgICAgICAgICAgICBleGlzdGluZ19saW5rLmluY3JlYXNlQ291bnQoKTtcblx0XHQgICAgICAgICAgICAgICAgfVxuXHRcdCAgICAgICAgICAgIH0gIFxuXHRcdCAgICAgICAgfVxuXHRcdCAgICAgICAgcmV0dXJuIGxpbmtzO1xuXHRcdCAgICB9XG5cdFx0fVxuXHRcdHJldHVybiB7XG5cdFx0XHREYXRhU291cmNlOiBWaXN1YWxpemVyRGF0YVNvdXJjZVxuXHRcdH1cbn1dKTtcblxuXG5cblxuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5hcHBsaWNhdGlvbmdyb3VwcycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvYXBwbGljYXRpb25ncm91cHMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnYXBwbGljYXRpb25ncm91cGNyZWF0ZSdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnYXBwbGljYXRpb25ncm91cGRldGFpbHMnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmVkaXQnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZWRpdC86a2V5JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2FwcGxpY2F0aW9uZ3JvdXBkZXRhaWxzJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3Vwcy5saXN0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnYXBwbGljYXRpb25Hcm91cGxpc3QnXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZGFzaGJvYXJkJywgWydjb250aXYubW9kZWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmRhc2hib2FyZCcsIHtcbiAgICAgICAgICAgIHVybDogJy9kYXNoYm9hcmQnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnZGFzaGJvYXJkJ1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwIiwiLyoqXG4gKiBUaGUgYmFzZSBjbGFzcyB0aGUgZ3JhcGggb2JqZWN0LiBBbnkgbm9kZXMgb3IgbGlua3MgdGhhdCBhcmUgY29udGFpbmVkIGluXG4gKiBpdHMgbm9kZXMgb3IgbGlua3MgcHJvcGVydHkgd2lsbCBiZSBkcmF3biBvbiB1cGRhdGVHcmFwaC5cbiAqIFN1cHBvcnRzIHBvbGljaWVzLlxuICogXG4gKiBUbyB3cml0ZSB5b3VyIG93biBncmFwaCBvYmplY3QsIGNyZWF0ZSBhIG5ldyBmYWN0b3J5IHRoYXQgdXNlcyB0aGUgZ3JhcGhcbiAqIHlvdSB3YW50IHRvIGluaGVyaXQgYXMgYSBkZXBlbmRlbmN5LCBhbmQgZXh0ZW5kIGl0cyBncmFwaCBjbGFzcy4gXG4gKiBSZXR1cm4gdGhlIGNsYXNzIG9iamVjdCB3aXRoIEdyYXBoIGFzIGtleS5cbiAqIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnR3JhcGgnLCBbJ1BvbGljeVNlcnZpY2UnLCBmdW5jdGlvbiAoUG9saWN5U2VydmljZSkge1xuICAgICAgICBjbGFzcyBHcmFwaCB7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIGNvbnN0cnVjdG9yIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBTVkd9ICBzdmcgICAgIFRoZSBzdmcgdGhhdCB3aWxsIFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob2xkIHRoZSBncmFwaFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZXMgICAgICBMaXN0IG9mIG5vZGVzIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIGxpbmtzICAgICAgTGlzdCBvZiBsaW5rcyBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHN2Zywgbm9kZXMsIGxpbmtzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMgPSBub2RlcyB8fCBbXTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MgPSBsaW5rcyB8fCBbXTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzID0gW107XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMgPSBbXTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3kgPSBuZXcgUG9saWN5U2VydmljZS5Qb2xpY3koKTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgY2FuWm9vbTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgY2FuUGFuOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpbml0Rm9yY2U6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlVXBkYXRlOiBmYWxzZVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY29uc3RzID0ge1xuICAgICAgICAgICAgICAgICAgICBjaXJjbGVHQ2xhc3M6IFwiY29uY2VwdEdcIixcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGhDbGFzczogXCJncmFwaFwiLFxuICAgICAgICAgICAgICAgICAgICBwYXRoQ2xhc3M6IFwicGF0aFwiLFxuICAgICAgICAgICAgICAgICAgICBub2RlQ2xhc3M6IFwiY2lyY2xlXCIsXG4gICAgICAgICAgICAgICAgICAgIG5vZGVUZXh0OiBcIm5vZGVUZXh0XCIsXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0UmFkaXVzOiA1MCxcbiAgICAgICAgICAgICAgICAgICAgbWF4UmFkaXVzOiA2MCxcbiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogNSxcbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheU9mZnNldDogNjBcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgc3ZnLm9uKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcIm1vdXNlb3ZlclwiXS5jYWxsKHRoaXMsIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiZGJsY2xpY2tcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcImRibGNsaWNrXCJdLmNhbGwodGhpcywgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJjb250ZXh0bWVudVwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wiY29udGV4dG1lbnVcIl0uY2FsbCh0aGlzLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcIm1vdXNlb3V0XCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcIm1vdXNlb3V0XCJdLmNhbGwodGhpcywgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wibW91c2Vkb3duXCJdLmNhbGwodGhpcywgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZXVwXCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcIm1vdXNldXBcIl0uY2FsbCh0aGlzLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8gZGVmaW5lIGFycm93IG1hcmtlcnMgZm9yIGdyYXBoIGxpbmtzXG4gICAgICAgICAgICAgICAgdmFyIGRlZnMgPSBzdmcuYXBwZW5kKCdzdmc6ZGVmcycpO1xuICAgICAgICAgICAgICAgIGRlZnMuYXBwZW5kKCdzdmc6bWFya2VyJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2lkJywgJ2VuZC1hcnJvdycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwidmlld0JveFwiLCBcIjAgLTUgMTAgMTBcIilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJyZWZYXCIsIDIwKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcInJlZllcIiwgLTEpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwibWFya2VyV2lkdGhcIiwgNilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJtYXJrZXJIZWlnaHRcIiwgNilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJvcmllbnRcIiwgXCJhdXRvXCIpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJwYXRoXCIpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiZFwiLCBcIk0wLC01TDEwLDBMMCw1XCIpO1xuXG4gICAgICAgICAgICAgICAgLy8gZGVmaW5lIGFycm93IG1hcmtlcnMgZm9yIGxlYWRpbmcgYXJyb3dcbiAgICAgICAgICAgICAgICBkZWZzLmFwcGVuZCgnc3ZnOm1hcmtlcicpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdpZCcsICdtYXJrLWVuZC1hcnJvdycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd2aWV3Qm94JywgJzAgLTUgMTAgMTAnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigncmVmWCcsIDcpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdtYXJrZXJXaWR0aCcsIDMuNSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ21hcmtlckhlaWdodCcsIDMuNSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ29yaWVudCcsICdhdXRvJylcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgnc3ZnOnBhdGgnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignZCcsICdNMCwtNUwxMCwwTDAsNScpO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2ZyA9IHN2ZztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnRyA9IHN2Zy5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAgICAgICAgIC5jbGFzc2VkKHRoaXNHcmFwaC5jb25zdHMuZ3JhcGhDbGFzcywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z0cgPSB0aGlzR3JhcGguc3ZnRztcblxuICAgICAgICAgICAgICAgIC8vIHN2ZyBub2RlcyBhbmQgbGlua3MgXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzID0gc3ZnRy5hcHBlbmQoXCJnXCIpLnNlbGVjdEFsbChcImdcIik7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMgPSBzdmdHLmFwcGVuZChcImdcIikuc2VsZWN0QWxsKFwiZ1wiKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXRMaW5rcygpO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNldFBvc2l0aW9ucygpO1xuICAgICAgICAgICAgICAgIHZhciByZXNpemVGdW5jID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5vbldpbmRvd1Jlc2l6ZShzdmcpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguYmluZGluZ3MgPSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc2l6ZTpyZXNpemVGdW5jXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAkKHdpbmRvdykucmVzaXplKHJlc2l6ZUZ1bmMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIGNhbGxzIHRoZSBkZXN0cm95IG1ldGhvZCBmb3IgYWxsIHBvbGljaWVzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5LmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5LmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gdGhpc0dyYXBoLmJpbmRpbmdzKSB7XG4gICAgICAgICAgICAgICAgICAgICQod2luZG93KS5vZmYoa2V5LCB0aGlzR3JhcGguYmluZGluZ3Nba2V5XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJ1bnMgdGhlIGluaXQgZnVuY3Rpb24gZm9yIGFsbCB0aGUgbm9kZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5pdE5vZGVzKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUnVucyB0aGUgaW5pdCBmdW5jdGlvbiBmb3IgYWxsIHRoZSBsaW5rc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbml0TGlua3MoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5saW5rcywgZnVuY3Rpb24obGluaykge1xuICAgICAgICAgICAgICAgICAgICBsaW5rLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiByZXR1cm5zIHRoZSBub2RlIG1hdGNoaW5nIHRoZSBpZCwgXG4gICAgICAgICAgICAgKiBvciB1bmRlZmluZWQgaWYgdGhlcmUgaXMgbm9uZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7Tm9kZX0gIHsgbWF0Y2hpbmcgbm9kZSB9XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZpbmROb2RlQnlJZChpZCl7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSB0aGlzR3JhcGgubm9kZXNbaV0uaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzR3JhcGgubm9kZXNbaV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJldHVybnMgdGhlIGQzTm9kZSBvYmplY3QgdGhhdCBtYXRjaGVzIHRoZSBpZCxcbiAgICAgICAgICAgICAqIG9yIHVuZGVmaW5lZCBpZiB0aGVyZSBpcyBub25lXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGlkICAgICAgVGhlIGlkZW50aWZpZXJcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtEM05vZGV9IFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZpbmREM05vZGUoaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgZDNOb2RlO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2goZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5pZCA9PT0gaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQzTm9kZSA9IGQzLnNlbGVjdCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkM05vZGU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byBpbnN0YWxsIGEgZHJhZyBwb2xpY3kgdGhhdCB3aWxsIGJlIGNhbGxlZFxuICAgICAgICAgICAgICogd2hlbiBub2RlcyBhcmUgZHJhZ2dlZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkMy5iZWhhdmlvci5kcmFnfSAgZDNkcmFnICBEMyBkcmFnIG9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbnN0YWxsRHJhZ1BvbGljeShkM2RyYWcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRyYWcgPSBkM2RyYWc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byBpbnN0YWxsIGEgcG9saWN5IHRoYXQgd2lsbCBiZSBjYWxsZWQgXG4gICAgICAgICAgICAgKiB3aGVuIHRoZXJlIGlzIG1vdXNlIGludGVyYWN0aW9ucyB3aXRoIHRoZSBncmFwaCdzIHN2Z1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3kgIFRoZSBwb2xpY3kgdG8gaW5zdGFsbFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbnN0YWxsU3ZnUG9saWN5KHBvbGljeSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3ZnUG9saWN5ID0gcG9saWN5O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVzZWQgdG8gaW5zdGFsbCBwb2xpY2llcyB0aGF0IGFyZSBjYWxsZWQgd2hlbiB0aGVyZSBpc1xuICAgICAgICAgICAgICogbW91c2UgaW50ZXJhY3Rpb24gd2l0aCBhIG5vZGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UG9saWN5fSAgcG9saWN5ICBUaGUgcG9saWN5IHRvIGluc3RhbGxcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5zdGFsbERlZmF1bHROb2RlUG9saWN5KHBvbGljeSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzLnB1c2gocG9saWN5KTtcbiAgICAgICAgICAgICAgICBwb2xpY3kuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byByZW1vdmUgYW4gaW5zdGFsbGVkIHBvbGljeSBmb3Igbm9kZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHBvbGljeVJlbW92ZSAgVGhlIHBvbGljeSB0byByZW1vdmVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdW5pbnN0YWxsRGVmYXVsdE5vZGVQb2xpY3kocG9saWN5UmVtb3ZlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBvbGljeVJlbW92ZU5hbWU7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBwb2xpY3lSZW1vdmUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZS5wb2xpY3lOYW1lO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvbGljeS5wb2xpY3lOYW1lID09PSBwb2xpY3lSZW1vdmVOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2xpY3kuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJldHVybnMgdGhlIG5vZGUgcG9saWN5IG9iamVjdCB3aXRoIHRoZSBnaXZlbiBuYW1lXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHBvbGljeU5hbWUgIFRoZSBwb2xpY3kgbmFtZVxuICAgICAgICAgICAgICogQHJldHVybiAgICAge1BvbGljeX0gIHBvbGljeSAgICAgIFRoZSBtYXRjaGluZyBwb2xpY3lcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZ2V0Tm9kZVBvbGljeShwb2xpY3lOYW1lKSB7XG4gICAgICAgICAgICBcdHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3ksIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb2xpY3kucG9saWN5TmFtZSA9PT0gcG9saWN5TmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBvbGljeTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVzZWQgdG8gaW5zdGFsbCBwb2xpY2llcyB0aGF0IGFyZSBjYWxsZWQgd2hlbiB0aGVyZSBpcyBhXG4gICAgICAgICAgICAgKiBtb3VzZSBpbnRlcmFjdGlvbiB3aXRoIGEgcGF0aFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3kgIFRoZSBwb2xpY3kgdG8gaW5zdGFsbFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3kocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMucHVzaChwb2xpY3kpO1xuICAgICAgICAgICAgICAgIHBvbGljeS5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byByZW1vdmUgYW4gaW5zdGFsbGVkIHBvbGljeSBmb3IgbGlua3NcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UG9saWN5fSAgcG9saWN5UmVtb3ZlICBUaGUgcG9saWN5IHRvIHJlbW92ZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1bmluc3RhbGxEZWZhdWx0UGF0aFBvbGljeShwb2xpY3lSZW1vdmUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcG9saWN5UmVtb3ZlTmFtZTtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHBvbGljeVJlbW92ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlLnBvbGljeU5hbWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5LCBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9saWN5LnBvbGljeU5hbWUgPT09IHBvbGljeVJlbW92ZU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlcmUgaXMgYSBtb3VzZSBpbnRlcmFjdGlvbiB3aXRoIGEgcGF0aFxuICAgICAgICAgICAgICogUHJvcG9nYXRlcyB0aGUgZXZlbnQgdG8gYWxsIGluc3RhbGxlZCBwYXRoIHBvbGljaWVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGV2ZW50ICAgVGhlIGV2ZW50IHR5cGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM29iamVjdH0gIGQzcGF0aCAgVGhlIGQzIHBhdGhcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQYXRofSAgZCAgICAgICBUaGUgbWF0Y2hpbmcgTGluayBvYmplY3RcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgcGF0aFBvbGljeUV2ZW50KGV2ZW50LCBkM3BhdGgsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lbZXZlbnRdKGQzcGF0aCwgZCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGVyZSBpcyBhIG1vdXNlIGludGVyYWN0aW9uIHdpdGggYSBub2RlXG4gICAgICAgICAgICAgKiBQcm9wb2dhdGVzIHRoZSBldmVudCB0byBhbGwgaW5zdGFsbGVkIG5vZGUgcG9saWNpZXNcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGV2ZW50ICAgVGhlIGV2ZW50IHR5cGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM29iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQYXRofSAgZCAgICAgICBUaGUgbWF0Y2hpbmcgTm9kZSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgbm9kZVBvbGljeUV2ZW50KGV2ZW50LCBkM25vZGUsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMsIGZ1bmN0aW9uKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lbZXZlbnRdKGQzbm9kZSwgZCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTZXRzIHBhbiBhbmQgem9vbSBydWxlcyBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzLmJlaGF2aW9yLnpvb219ICBkM3pvb20gIEQzIHpvb20gb2JqXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluc3RhbGxab29tUG9saWN5KGQzem9vbSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZHJhZ1N2ZyA9IGQzem9vbTtcbiAgICAgICAgICAgICAgICB0aGlzLnN2Zy5jYWxsKHRoaXMuZHJhZ1N2Zyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIHdpbmRvdyBpcyByZXNpemVkXG4gICAgICAgICAgICAgKiBIb29rIGZvciBvdmVycmlkaW5nIGluIHN1YmNsYXNzZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBTVkd9ICBzdmcgICAgIFRoZSBzdmcgdGhhdCB0aGUgaGFuZGxlclxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpcyBhdHRhY2hlZCB0b1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBvbldpbmRvd1Jlc2l6ZShzdmcpIHt9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogSW5zZXJ0cyBsaW5lIGJyZWFrcyBpbiBub2RlIHRleHRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBFbGVtfSAgZ0VsICAgIFRoZSBlbGVtIHRvIGFkZCB0ZXh0IHRvXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgdGl0bGUgICBUaGUgdGl0bGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5zZXJ0VGl0bGVMaW5lYnJlYWtzIChnRWwsIHRpdGxlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHdvcmRzID0gdGl0bGUuc3BsaXQoL1xccysvZyksXG4gICAgICAgICAgICAgICAgICAgIG53b3JkcyA9IHdvcmRzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB2YXIgZWwgPSBnRWwuYXBwZW5kKFwidGV4dFwiKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCB0aGlzR3JhcGguY29uc3RzLm5vZGVUZXh0KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcInRleHQtYW5jaG9yXCIsXCJtaWRkbGVcIilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJkeVwiLCBcIi1cIiArIChud29yZHMtMSkqNy41KTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgd29yZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRzcGFuID0gZWwuYXBwZW5kKCd0c3BhbicpLnRleHQod29yZHNbaV0pO1xuICAgICAgICAgICAgICAgIGlmIChpID4gMClcbiAgICAgICAgICAgICAgICAgICAgdHNwYW4uYXR0cigneCcsIDApLmF0dHIoJ2R5JywgJzE1Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJlbW92ZXMgYWxsIGxpbmtzIGZyb20gdGhlIGdpdmVuIG5vZGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc3BsaWNlTGlua3NGb3JOb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgdG9TcGxpY2UgPSB0aGlzR3JhcGgubGlua3MuZmlsdGVyKGZ1bmN0aW9uKGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobC5zb3VyY2UgPT09IG5vZGUgfHwgbC50YXJnZXQgPT09IG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0b1NwbGljZS5tYXAoZnVuY3Rpb24obCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3Muc3BsaWNlKHRoaXNHcmFwaC5saW5rcy5pbmRleE9mKGwpLCAxKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBBZGRzIHRoZSBub2RlIHRvIHRoZSBncmFwaCBhbmQgdXBkYXRlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBhZGROb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICBub2RlLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyB0aGUgbm9kZSB0byB0aGUgZ3JhcGggYW5kIHVwZGF0ZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgcmVtb3ZlTm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnNwbGljZSh0aGlzR3JhcGgubm9kZXMuaW5kZXhPZihub2RlKSwgMSk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlKTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBBZGRzIHRoZSBsaW5rIHRvIHRoZSBncmFwaCBhbmQgdXBkYXRlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtsaW5rfSAgbGluayAgICBUaGUgbGlua1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBhZGRMaW5rKGxpbmspIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MucHVzaChsaW5rKTtcbiAgICAgICAgICAgICAgICBsaW5rLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyB0aGUgbGluayB0byB0aGUgZ3JhcGggYW5kIHVwZGF0ZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bGlua30gIGxpbmsgICAgVGhlIGxpbmtcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgcmVtb3ZlTGluayhsaW5rKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzLnNwbGljZSh0aGlzR3JhcGgubGlua3MuaW5kZXhPZihsaW5rKSwgMSk7XG4gICAgICAgICAgICAgICAgbGluay5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIHVwZGF0aW5nIGV4aXN0aW5nIHBhdGhzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BhdGh9ICBwYXRocyAgIExpc3Qgb2YgcGF0aHNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlRXhpc3RpbmdQYXRocyhwYXRocykge1xuICAgICAgICAgICAgICAgIHBhdGhzLmVhY2goZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICBkLnVwZGF0ZUF0dHIoZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgYWRkaW5nIG5ldyBwYXRoc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQYXRofSAgbmV3UGF0aHMgIExpc3Qgb2YgbmV3IHBhdGhzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHVwZGF0ZU5ld1BhdGhzKG5ld1BhdGhzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdExpbmtzKCk7XG5cbiAgICAgICAgICAgICAgICBuZXdQYXRocy5lYWNoKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5uZXdQYXRoQXR0cihkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy9pZiBub2RlIGRvZXNuJ3QgaGF2ZSBpdHMgb3duIHBvbGljeSwgdXNlIGRlZmF1bHQgZm9yIHRoZSBncmFwaFxuICAgICAgICAgICAgICAgIG5ld1BhdGhzLm9uKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZW92ZXJcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZW92ZXJcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcImRibGNsaWNrXCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQucGF0aFBvbGljeUV2ZW50KFwiZGJsY2xpY2tcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJkYmxjbGlja1wiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiY29udGV4dG1lbnVcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJjb250ZXh0bWVudVwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcImNvbnRleHRtZW51XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZW91dFwiLCBmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQucGF0aFBvbGljeUV2ZW50KFwibW91c2VvdXRcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZW91dFwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwibW91c2Vkb3duXCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZWRvd25cIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZWRvd25cIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcIm1vdXNldXBcIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnBhdGhQb2xpY3lFdmVudChcIm1vdXNldXBcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZXVwXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuY2FsbCh0aGlzR3JhcGguZHJhZyk7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgdXBkYXRpbmcgZXhpc3Rpbmcgbm9kZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlRXhpc3RpbmdOb2RlcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcyA9IHRoaXMuY2lyY2xlcy5kYXRhKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24oZCl7IHJldHVybiBkLmlkO30pXG4gICAgICAgICAgICAgICAgICAgIC5lYWNoKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQudXBkYXRlQXR0cihkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyBhZGRpbmcgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBuZXdOb2RlcyAgTGlzdCBvZiBuZXcgbm9kZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlTmV3Tm9kZXMobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgICAgIG5ld05vZGVzLmVhY2goZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5ncmFwaCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBkLm5ld05vZGVBdHRyKGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvL2lmIG5vZGUgZG9lc24ndCBoYXZlIGl0cyBvd24gcG9saWN5LCB1c2UgZGVmYXVsdCBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgICAgbmV3Tm9kZXMub24oXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlb3ZlclwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlb3ZlclwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiZGJsY2xpY2tcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5ub2RlUG9saWN5RXZlbnQoXCJkYmxjbGlja1wiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcImRibGNsaWNrXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJjb250ZXh0bWVudVwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcImNvbnRleHRtZW51XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwiY29udGV4dG1lbnVcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcIm1vdXNlb3V0XCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5ub2RlUG9saWN5RXZlbnQoXCJtb3VzZW91dFwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlb3V0XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlZG93blwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlZG93blwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwibW91c2V1cFwiLCBmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQubm9kZVBvbGljeUV2ZW50KFwibW91c2V1cFwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcIm1vdXNldXBcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5jYWxsKHRoaXNHcmFwaC5kcmFnKTtcblxuICAgICAgICAgICAgICAgIG5ld05vZGVzLmFwcGVuZChcImNpcmNsZVwiKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwiclwiLCBmdW5jdGlvbihkKSB7cmV0dXJuIFN0cmluZyhkLnJhZGl1cyl9KTtcblxuXG4gICAgICAgICAgICAgICAgbmV3Tm9kZXMuZWFjaChmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluc2VydFRpdGxlTGluZWJyZWFrcyhkMy5zZWxlY3QodGhpcyksIGQudGV4dCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUHJldmVudHMgbm9kZXMgZnJvbSBjb2xsaWRpbmdcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgYWxwaGEgICBBZmZlY3RzIGhvdyBtdWNoIGNoYW5nZVxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlIGNvbGxpc2lvbiBjYXVzZXNcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtib29sZWFufSAge1doZXRoZXIgbm9kZXMgYXJlIGNvbGxpZGVkfVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkM0ZvcmNlQ29sbGlkZShhbHBoYSkge1xuICAgICAgICAgICAgXHR2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgIFx0XHRjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzO1xuICAgICAgICAgICAgXHR2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICBcdHZhciBxdWFkdHJlZSA9IGQzLmdlb20ucXVhZHRyZWUobm9kZXMpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgciA9IGQucmFkaXVzICsgY29uc3RzLm1heFJhZGl1cyArIGNvbnN0cy5wYWRkaW5nLFxuICAgICAgICAgICAgICAgICAgICAgICAgbngxID0gZC54IC0gcixcbiAgICAgICAgICAgICAgICAgICAgICAgIG54MiA9IGQueCArIHIsXG4gICAgICAgICAgICAgICAgICAgICAgICBueTEgPSBkLnkgLSByLFxuICAgICAgICAgICAgICAgICAgICAgICAgbnkyID0gZC55ICsgcjtcbiAgICAgICAgICAgICAgICAgICAgcXVhZHRyZWUudmlzaXQoZnVuY3Rpb24ocXVhZCwgeDEsIHkxLCB4MiwgeTIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChxdWFkLnBvaW50ICYmIChxdWFkLnBvaW50ICE9PSBkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4ID0gZC54IC0gcXVhZC5wb2ludC54LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ID0gZC55IC0gcXVhZC5wb2ludC55LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsID0gTWF0aC5zcXJ0KHggKiB4ICsgeSAqIHkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByID0gZC5yYWRpdXMgKyBxdWFkLnBvaW50LnJhZGl1cyArIGNvbnN0cy5wYWRkaW5nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsIDwgcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbCA9IChsIC0gcikgLyBsICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnggLT0geCAqPSBsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55IC09IHkgKj0gbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1YWQucG9pbnQueCArPSB4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVhZC5wb2ludC55ICs9IHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB4MSA+IG54MiB8fCB4MiA8IG54MSB8fCB5MSA+IG55MiB8fCB5MiA8IG55MTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUaWNrIG9mIHRoZSBkMyBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzdGljayBldmVudH0gIGUgICAgRDN0aWNrIGV2ZW50XG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgd2lkdGggIFRoZSB3aWR0aCBvZiB0aGUgc2ltdWxhdGlvblxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge251bWJlcn0gIGhlaWdodCBUaGUgaGVpZ2h0IG9mIHRoZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGQzRm9yY2VUaWNrKGUsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgIFx0dmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICBcdFx0Y29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cztcblxuICAgICAgICAgICAgXHR2YXIgb2Zmc2V0ID0gY29uc3RzLmRpc3BsYXlPZmZzZXQ7XHRcbiAgICAgICAgICAgIFx0dmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgXHR2YXIgcSA9IGQzLmdlb20ucXVhZHRyZWUodGhpc0dyYXBoLm5vZGVzKSxcbiAgICAgICAgICAgICAgICAgICAgICBpID0gMCxcbiAgICAgICAgICAgICAgICAgICAgICBuID0gbm9kZXMubGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgICB3aGlsZSAoKytpIDwgbikge1xuICAgICAgICAgICAgICAgICAgICBxLnZpc2l0KHRoaXMuZDNGb3JjZUNvbGxpZGUobm9kZXNbaV0pKTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2godGhpcy5kM0ZvcmNlQ29sbGlkZSguNSkpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiY3hcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC54ID0gTWF0aC5tYXgoZC5yYWRpdXMgKyBvZmZzZXQsIE1hdGgubWluKHdpZHRoIC0gb2Zmc2V0IC0gZC5yYWRpdXMsIGQueCkpOyB9KVxuICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJjeVwiLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnkgPSBNYXRoLm1heChkLnJhZGl1cyArIG9mZnNldCwgTWF0aC5taW4oaGVpZ2h0IC0gb2Zmc2V0IC0gZC5yYWRpdXMsIGQueSkpOyB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoc1xuICAgICAgICAgICAgICAgICAgICAuYXR0cigneDEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS55OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneDInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC55OyB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTdGFydHMgb24gc3RhcnQgb2YgdGhlIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZVN0YXJ0KCkge1xuICAgICAgICAgICAgXHR2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHNcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueTsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueTsgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIG9uIHRoZSBlbmQgb2YgdGhlIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZUVuZCgpIHtcbiAgICAgICAgICAgIFx0dmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICBcdHRoaXNHcmFwaC5jaXJjbGVzXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjeCcsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2N5JywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC55OyB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocy5hdHRyKCd4MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLnk7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd4MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lnk7IH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGN1bGF0ZXMgdGhlIHdpZHRoIGFuZCBoZWlnaHQgYm91bmRzIGZvciB0aGUgXG4gICAgICAgICAgICAgKiBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHJldHVybiAgICAge09iamVjdH0gIHdpZHRoIGFuZCBoZWlnaHQgYXMgcHJvcGVydGllcyBcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZUJvdW5kcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnV2lkdGggPSAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLndpZHRoKCk7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z0hlaWdodCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykuaGVpZ2h0KCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBzdmdXaWR0aDtcbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gc3ZnSGVpZ2h0O1xuICAgICAgICAgICAgICAgIHJldHVybiB7d2lkdGg6d2lkdGgsIGhlaWdodDpoZWlnaHR9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIERvZXMgYSBkMyBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0Z1bmN0aW9ufSAgY2FsbGJhY2sgIFRoZSBjYWxsYmFja1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzZXRGb3JjZShjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgICAgIHZhciBsaW5rcyA9IHRoaXNHcmFwaC5saW5rcztcbiAgICAgICAgICAgICAgICBpZiAoXy5pc0VtcHR5KG5vZGVzKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGJvdW5kcyA9IHRoaXNHcmFwaC5kM0ZvcmNlQm91bmRzKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgZm9yY2UgPSBkMy5sYXlvdXQuZm9yY2UoKVxuICAgICAgICAgICAgICAgICAgICAuc2l6ZShbYm91bmRzLndpZHRoLCBib3VuZHMuaGVpZ2h0XSlcbiAgICAgICAgICAgICAgICAgICAgLm5vZGVzKG5vZGVzKVxuICAgICAgICAgICAgICAgICAgICAuY2hhcmdlKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtNjAwMDtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmxpbmtzKGxpbmtzKTtcblxuICAgICAgICAgICAgICAgIGZvcmNlLmxpbmtEaXN0YW5jZShib3VuZHMud2lkdGgvMyk7XG4gICAgICAgICAgICAgICAgZm9yY2UubGlua1N0cmVuZ3RoKC4yKTtcbiAgICAgICAgICAgICAgICBmb3JjZS5ncmF2aXR5KC4yKTtcblxuICAgICAgICAgICAgICAgIGZvcmNlLm9uKCd0aWNrJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgIFx0dGhpc0dyYXBoLmQzRm9yY2VUaWNrLmNhbGwodGhpc0dyYXBoLCBcbiAgICAgICAgICAgICAgICBcdFx0XHRlLCBib3VuZHMud2lkdGgsIGJvdW5kcy5oZWlnaHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZm9yY2Uub24oJ3N0YXJ0JywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgXHR0aGlzR3JhcGguZDNGb3JjZVN0YXJ0LmNhbGwodGhpc0dyYXBoKVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZm9yY2Uub24oJ2VuZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIFx0dGhpc0dyYXBoLmQzRm9yY2VFbmQuY2FsbCh0aGlzR3JhcGgpXG4gICAgICAgICAgICAgICAgfSk7IFxuXG5cbiAgICAgICAgICAgICAgICBmb3JjZS5zdGFydCgpO1xuICAgICAgICAgICAgICAgIHZhciBrID0gMDtcbiAgICAgICAgICAgICAgICB3aGlsZSAoKGZvcmNlLmFscGhhKCkgPiAxZS0yKSAmJiAoayA8IDE1MCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yY2UudGljaygpO1xuICAgICAgICAgICAgICAgICAgICBrID0gayArIDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvcmNlLnN0b3AoKTtcblxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjayAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgXHRjYWxsYmFjaygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTZXRzIHRoZSBwb3NpdGlvbnMgdG8gYmUgdGhlIGNlbnRlciBvZiB0aGUgc2NyZWVuIGlmIFxuICAgICAgICAgICAgICogbm90IHByb3ZpZGVkXG4gICAgICAgICAgICAgKiBhbHNvIHNldHMgdGhlIHJhZGl1cyBvZiB0aGUgbm9kZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc2V0UG9zaXRpb25zKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IHRoaXNHcmFwaC5jb25zdHMuZGlzcGxheU9mZnNldDtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnV2lkdGggPSAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLndpZHRoKCk7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z0hlaWdodCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykuaGVpZ2h0KCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBzdmdXaWR0aCAtICgyKm9mZnNldCk7XG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IHN2Z0hlaWdodCAtICgyKm9mZnNldCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVzW2ldLnJhZGl1cyA9IG5vZGVzW2ldLnJhZGl1cyB8fCB0aGlzR3JhcGguY29uc3RzLnN0YXJ0UmFkaXVzO1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZXNbaV0ueCA9PSBudWxsIHx8IG5vZGVzW2ldLnkgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm9kZXNbaV0ueFN0YXJ0ID0gd2lkdGgvMiAgKyBub2Rlc1tpXS5yYWRpdXMgKyBvZmZzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzW2ldLnggPSB3aWR0aC8yICArIG5vZGVzW2ldLnJhZGl1cyArIG9mZnNldDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5vZGVzW2ldLnlTdGFydCA9IGhlaWdodC8yICsgbm9kZXNbaV0ucmFkaXVzICsgb2Zmc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1tpXS55ID0gaGVpZ2h0LzIgKyBub2Rlc1tpXS5yYWRpdXMgKyBvZmZzZXRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgdG8gdXBkYXRlIHRoZSB2aWV3IG9mIHRoZSBncmFwaCB3aGVuXG4gICAgICAgICAgICAgKiBkYXRhIGNoYW5nZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RnVuY3Rpb259ICBjYWxsYmFjayAgVGhlIGNhbGxiYWNrXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHVwZGF0ZUdyYXBoKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlO1xuXG4gICAgICAgICAgICBcdGlmICh0aGlzR3JhcGguc3RhdGUuZGlzYWJsZVVwZGF0ZSkge1xuICAgICAgICAgICAgXHRcdHJldHVybjtcbiAgICAgICAgICAgIFx0fVxuXG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVFeGlzdGluZ05vZGVzKCk7XG4gICAgICAgICAgICAgICAgdmFyIG5ld0dzPSB0aGlzR3JhcGguY2lyY2xlcy5lbnRlcigpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJnXCIpO1xuXG4gICAgICAgICAgICBcdC8vIGNvbnNvbGUubG9nKCd1cGRhdGUnLCBuZXdHcyk7XG4gICAgICAgICAgICAgICAgbmV3R3MuY2xhc3NlZChjb25zdHMuY2lyY2xlR0NsYXNzLCB0cnVlKTtcbiAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIHRoaXMudXBkYXRlTmV3Tm9kZXMobmV3R3MpO1xuXG4gICAgICAgICAgICAgICAgLy8gcmVtb3ZlIG9sZCBub2Rlc1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmV4aXQoKS5yZW1vdmUoKTtcblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5pbml0Rm9yY2UgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNldEZvcmNlKGZ1bmN0aW9uKCkge1xuICAgIFx0ICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVOZXdOb2Rlcy5jYWxsKHRoaXNHcmFwaCwgbmV3R3MpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuaW5pdEZvcmNlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVOZXdOb2RlcyhuZXdHcyk7XG5cdCAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocyA9IHRoaXNHcmFwaC5wYXRocy5kYXRhKHRoaXNHcmFwaC5saW5rcywgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBTdHJpbmcoZC5zb3VyY2UuaWQpICsgXCIrXCIgKyBTdHJpbmcoZC50YXJnZXQuaWQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciBwYXRocyA9IHRoaXNHcmFwaC5wYXRocztcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUV4aXN0aW5nUGF0aHMocGF0aHMpO1xuXG4gICAgICAgICAgICAgICAgdmFyIG5ld3BhdGhzID0gcGF0aHMuZW50ZXIoKVxuICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJwYXRoXCIpXG4gICAgICAgICAgICAgICAgLnN0eWxlKCdtYXJrZXItZW5kJywndXJsKCNlbmQtYXJyb3cpJylcbiAgICAgICAgICAgICAgICAuY2xhc3NlZChcImxpbmtcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVOZXdQYXRocyhuZXdwYXRocyk7XG5cbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgb2xkIGxpbmtzXG4gICAgICAgICAgICAgICAgcGF0aHMuZXhpdCgpLnJlbW92ZSgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBcdGNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgR3JhcGg6IEdyYXBoXG4gICAgICAgIH1cbn1dKTtcblxuXG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubG9naW4nLCBbJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubG9naW4nLCB7XG4gICAgICAgICAgICB1cmw6ICcvJyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2xvZ2luJ1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE5LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm1lbnUnLCBbXSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtwb2xpY2llcycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzJywge1xuICAgICAgICAgICAgdXJsOiAnL25ldHdvcmtwb2xpY2llcycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbicsIHtcbiAgICAgICAgICAgIHVybDogJy9pc29sYXRpb24nLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzx1aS12aWV3Lz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5pc29sYXRpb24uY3JlYXRlJywge1xuICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdpc29sYXRpb25wb2xpY3ljcmVhdGUnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5pc29sYXRpb24uZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnaXNvbGF0aW9ucG9saWN5ZGV0YWlscydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbi5lZGl0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2VkaXQvOmtleScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdpc29sYXRpb25wb2xpY3lkZXRhaWxzJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuYmFuZHdpZHRoJywge1xuICAgICAgICAgICAgdXJsOiAnL2JhbmR3aWR0aCcsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPHVpLXZpZXcvPidcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmJhbmR3aWR0aC5jcmVhdGUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2JhbmR3aWR0aHBvbGljeWNyZWF0ZSdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmJhbmR3aWR0aC5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdiYW5kd2lkdGhwb2xpY3lkZXRhaWxzJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuYmFuZHdpZHRoLmVkaXQnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZWRpdC86a2V5JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2JhbmR3aWR0aHBvbGljeWRldGFpbHMnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5yZWRpcmVjdGlvbicsIHtcbiAgICAgICAgICAgIHVybDogJy9yZWRpcmVjdGlvbicsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPHVpLXZpZXcvPidcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBwYXJhbXM6IHsgcG9saWN5VGFiOiBudWxsIH0sXG4gICAgICAgICAgICBjb21wb25lbnQ6ICduZXR3b3JrcG9saWNpZXN0YWJzJ1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3MnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbmV0d29ya3MnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICduZXR3b3JrTGlzdCdcbiAgICAgICAgfSkuXG4gICAgICAgICAgICBzdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3MuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnbmV0d29ya2RldGFpbHMnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtzLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnbmV0d29ya2NyZWF0ZSdcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbm9kZXMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2Lm9yZ2FuaXphdGlvbnMnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdjb250aXYubWVudS5vcmdhbml6YXRpb25zJywge1xuICAgICAgICAgICAgdXJsOiAnL29yZ2FuaXphdGlvbnMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ29yZ2FuaXphdGlvbmxpc3QnXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc2VydmljZWxicycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2VydmljZWxicycsIHtcbiAgICAgICAgICAgIHVybDogJy9zZXJ2aWNlbGJzJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdzZXJ2aWNlbGJMaXN0J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnc2VydmljZWxiQ3JlYXRlJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ3NlcnZpY2VsYkRldGFpbHMnXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIFRoZSBncmFwaCB0aGF0IGlzIHVzZWQgc3BlY2lmaWNhbGx5IGZvciB0aGUgdmlzdWFsaXphdGlvbiB0YWIuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdWaXN1YWxpemVyR3JhcGgnLCBbJ0dyYXBoJywgZnVuY3Rpb24gKEdyYXBoKSB7XG4gICAgXHRjbGFzcyBWaXN1YWxpemVyR3JhcGggZXh0ZW5kcyBHcmFwaC5HcmFwaCB7XG4gICAgXHRcdC8qKlxuICAgIFx0XHQgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgXHRcdCAqXG4gICAgXHRcdCAqIEBwYXJhbSAgIHtIVE1MIFNWR30gIHN2ZyAgICAgICAgICAgICBUaGUgc3ZnIHRoYXQgd2lsbCBcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob2xkIHRoZSBncmFwaFxuICAgICAgICAgICAgICogQHBhcmFtICAge0FycmF5fSAgbm9kZXMgICBcdFx0ICAgIExpc3Qgb2Ygbm9kZXNcbiAgICAgICAgICAgICAqIEBwYXJhbSAgIHtBcnJheX0gIGxpbmtzICAgXHRcdCAgICBMaXN0IG9mIGxpbmtzXG4gICAgXHRcdCAqIEBwYXJhbSAgIHtEYXRhU291cmNlfSAgZGF0YVNvdXJjZSAgICBUaGUgZGF0YSBzb3VyY2VcbiAgICBcdFx0ICovXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcihzdmcsIG5vZGVzLCBsaW5rcywgZGF0YVNvdXJjZSkge1xuICAgICAgICAgICAgICAgIHN1cGVyKHN2Zywgbm9kZXMsIGxpbmtzKTtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgICAgIC8vaG9sZHMgY3VycmVudCB0cmFuc2l0aW9ucyB0aGF0IGFyZSBvY2N1cmluZ1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZS50cmFuc2l0aW9uID0gW107XG4gICAgICAgICAgICAgICAgLy9NaW4gZGlzdGFuY2UgYmV0d2VlbiBub2RlcyB3aGVuIHNwYXduaW5nIHJhbmRvbWx5XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNvbnN0cy5lZGdlX2J1ZmZlciA9IDIwMDtcbiAgICAgICAgICAgICAgICAvL1NpemUgcmVkdWN0aW9uIGFzIHlvdSBnbyB0aHJvdWdoIGxldmVscyBpbiBub2Rlc1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jb25zdHMucmFkaXVzRGVjYXkgPSAxO1xuICAgICAgICAgICAgICAgIC8vQ3NzIGNsYXNzIGZvciBub2RlcyB0aGF0IGFyZSBjb250YWluZXJzXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNvbnN0cy5jb250YWluZXJDbGFzcyA9ICdjb250YWluZXInO1xuXG4gICAgICAgICAgICAgICAgLy9kYXRhU291cmNlIGhvbGRzIHRoZSBzZXJ2ZXIgZGF0YSBhbmQgbWV0aG9kcyBmb3JcbiAgICAgICAgICAgICAgICAvL2NvbnZlcnRpbmcgaXQgdG8gZGF0YSBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRhdGFTb3VyY2UgPSBkYXRhU291cmNlO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vRHJhZyBiZWhhdmlvciBmb3Igbm9kZXNcbiAgICAgICAgICAgICAgICB2YXIgZHJhZyA9IGQzLmJlaGF2aW9yLmRyYWcoKVxuICAgICAgICAgICAgICAgICAgICAub3JpZ2luKGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge3g6IGQueCwgeTogZC55fTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiZHJhZ3N0YXJ0XCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJkcmFnXCIsIGZ1bmN0aW9uKGFyZ3Mpe1xuICAgICAgICAgICAgICAgICAgICBcdGQzLnNlbGVjdCggdGhpcykuYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbiggZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCArPSBkMy5ldmVudC5keDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gZDMuZXZlbnQuZHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwidHJhbnNsYXRlKFwiICsgWyBkLngsZC55IF0gKyBcIilcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcdFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJkcmFnZW5kXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kcmFnID0gZHJhZztcblxuICAgICAgICAgICAgICAgIC8vUGFuIGFuZCBab29tIGJlaGF2aW9yIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAgICB2YXIgem9vbSA9IGQzLmJlaGF2aW9yLnpvb20oKVxuICAgICAgICAgICAgICAgICAgICAub24oXCJ6b29tXCIsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZDMuZXZlbnQuc291cmNlRXZlbnQgIT0gbnVsbCAmJiBkMy5ldmVudC5zb3VyY2VFdmVudC5jdHJsS2V5KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZC5jYWxsKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiem9vbXN0YXJ0XCIsIGZ1bmN0aW9uKGQsIGkpe1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguZHJhZ1N2ZyA9IHpvb207XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Zy5jYWxsKHpvb20pLm9uKFwiZGJsY2xpY2suem9vbVwiLCBudWxsKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2l0aCBubyBhcmdzIHdoZW4gdGhlIGdyYXBoIGhhcyBhIHpvb20gYWN0aW9uXG4gICAgICAgICAgICAgKiBDYW4gYWxzbyBiZSBjYWxsZWQgd2l0aCBhcmdzIHRvIGZvcmNlIGEgem9vbSBvciBwYW4gXG4gICAgICAgICAgICAgKiBldmVudCBmb3IgdGhlIGdyYXBoLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gICB0cmFuc2xhdGUgIFRoZSBhbW91bnQgdG8gdHJhbnNsYXRlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgc2NhbGUgICAgICBUaGUgYW1vdW50IHRvIHNjYWxlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHpvb21lZCh0cmFuc2xhdGUsIHNjYWxlKXtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLnN0YXRlLnJpZ2h0Q2xpY2sgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuanVzdFNjYWxlVHJhbnNHcmFwaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKHRyYW5zbGF0ZSAhPSBudWxsICYmIHNjYWxlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSB0aGlzR3JhcGguZHJhZ1N2ZztcbiAgICAgICAgICAgICAgICAgICAgem9vbS5zY2FsZShzY2FsZSk7XG4gICAgICAgICAgICAgICAgICAgIHpvb20udHJhbnNsYXRlKHRyYW5zbGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIC8vY3JlYXRpbmcgbmFtZXMgdG8gcHJldmVudCB0cmFuc2l0aW9uIGNvbmZsaWN0c1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbVNldENhbGxiYWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIFx0em9vbS5zY2FsZShzY2FsZSk7XG4gICAgICAgICAgICAgICAgICAgIFx0em9vbS50cmFuc2xhdGUodHJhbnNsYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zbGF0ZV9uYW1lID0gXCJ6b29tXCIgKyB0cmFuc2xhdGU7XG4gICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdChcIi5cIiArIHRoaXMuY29uc3RzLmdyYXBoQ2xhc3MpLnRyYW5zaXRpb24odHJhbnNsYXRlX25hbWUpLmRlbGF5KDEwMCkuZHVyYXRpb24oNzUwKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoJyArIHpvb20udHJhbnNsYXRlKCkgKyAnKSBzY2FsZSgnICsgem9vbS5zY2FsZSgpICsgJyknKS5lYWNoKFwiZW5kXCIsIHpvb21TZXRDYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGguc3RhdGUuY2FuWm9vbSkge1xuICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QoXCIuXCIgKyB0aGlzLmNvbnN0cy5ncmFwaENsYXNzKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKSArIFwiKSBzY2FsZShcIiArdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKSArIFwiKVwiKTsgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgd2luZG93IHJlc2l6ZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBTVkd9ICBzdmcgICAgVGhlIHN2ZyB0byByZXNpemVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgb25XaW5kb3dSZXNpemUoc3ZnKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJvZHlFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF07XG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykub2Zmc2V0KCk7XG4gICAgICAgICAgICAgICAgdmFyIGRpdldpZHRoID0gJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS53aWR0aCgpO1xuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBib2R5RWwuY2xpZW50SGVpZ2h0O1xuICAgICAgICAgICAgICAgIHN2Zy5hdHRyKFwid2lkdGhcIiwgZGl2V2lkdGgpLmF0dHIoXCJoZWlnaHRcIiwgaGVpZ2h0IC0gb2Zmc2V0LnRvcCAtIDIwKTtcblxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgc2VydmVyIHNlbmRzIHVwZGF0ZWQgZGF0YSBmb3IgdGhlIGxpbmtzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHVwZGF0ZUxpbmtEYXRhKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBub2RlX25hbWVzX3NldCA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpc0dyYXBoLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVfbmFtZXNfc2V0LnB1c2godGhpc0dyYXBoLm5vZGVzW2ldLmlkKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcmV0RGF0YSA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmdldEZsb3dCZXR3ZWVuU2V0KG5vZGVfbmFtZXNfc2V0KTtcbiAgICAgICAgICAgICAgICB2YXIgbGlua0RhdGEgPSByZXREYXRhLmxpbmtEYXRhO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YShsaW5rRGF0YSwgdGhpc0dyYXBoLm5vZGVzKTtcbiAgICAgICAgICAgICAgICB0aGlzLmluaXROb2RlcygpO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5pdExpbmtzKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIFxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIEdyYXBoOiBWaXN1YWxpemVyR3JhcGhcbiAgICAgICAgfVxufV0pO1xuXG5cblxuIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zZXR0aW5ncycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZ2xvYmFsJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL3NldHRpbmdzJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2V0dGluZ3Mvc2V0dGluZ3NtZW51Lmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMubG9ncycsIHtcbiAgICAgICAgICAgIHVybDogJy9sb2dzJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICcnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMuYXV0aCcsIHtcbiAgICAgICAgICAgIHVybDogJy9hdXRoJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICcnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMubGljZW5zZScsIHtcbiAgICAgICAgICAgIHVybDogJy9saWNlbnNlJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICcnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMucG9saWNpZXMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvcG9saWNpZXMnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJycsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5uZXR3b3JrcycsIHtcbiAgICAgICAgICAgIHVybDogJy9uZXR3b3JrcycsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICduZXR3b3Jrc2V0dGluZydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy52b2x1bWVzJywge1xuICAgICAgICAgICAgdXJsOiAnL3ZvbHVtZXMnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAndm9sdW1lc2V0dGluZydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5jbHVzdGVyJywge1xuICAgICAgICAgICAgdXJsOiAnL2NsdXN0ZXInLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnY2x1c3RlcnNldHRpbmdzJ1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnN0b3JhZ2Vwb2xpY2llcycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzJywge1xuICAgICAgICAgICAgdXJsOiAnL3N0b3JhZ2Vwb2xpY2llcycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdzdG9yYWdlcG9saWN5bGlzdCdcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIi8qKlxuICogVGhlIGJhc2UgY2xhc3MgZm9yIGxpbmsgb2JqZWN0cyBmb3IgdGhlIGdyYXBoLlxuICogU3VwcG9ydHMgcG9saWNpZXMuXG4gKiBcbiAqIFRvIHdyaXRlIHlvdXIgb3duIGxpbmsgb2JqZWN0LCBjcmVhdGUgYSBuZXcgZmFjdG9yeSB0aGF0IHVzZXMgdGhlIGxpbmtcbiAqIHlvdSB3YW50IHRvIGluaGVyaXQgYXMgYSBkZXBlbmRlbmN5LCBhbmQgZXh0ZW5kIGl0cyBsaW5rIGNsYXNzLiBcbiAqIFJldHVybiB0aGUgY2xhc3Mgb2JqZWN0IHdpdGggTGluayBhcyBrZXlcbiAqIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnTGluaycsIFtmdW5jdGlvbiAoKSB7XG4gICAgXHRjbGFzcyBMaW5rIHtcbiAgICBcdFx0LyoqXG4gICAgXHRcdCAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICBcdFx0ICpcbiAgICBcdFx0ICogQHBhcmFtICAgICAge05vZGV9ICBzb3VyY2VOb2RlICBUaGUgc291cmNlIG5vZGVcbiAgICBcdFx0ICogQHBhcmFtICAgICAge05vZGV9ICB0YXJnZXROb2RlICBUaGUgdGFyZ2V0IG5vZGVcbiAgICBcdFx0ICovXG5cdFx0XHRjb25zdHJ1Y3Rvcihzb3VyY2VOb2RlLCB0YXJnZXROb2RlKSB7XG5cdFx0XHRcdHRoaXMuc291cmNlID0gc291cmNlTm9kZTtcblx0XHRcdFx0dGhpcy50YXJnZXQgPSB0YXJnZXROb2RlO1xuXHRcdFx0XHR0aGlzLmhhc1BvbGljeSA9IGZhbHNlO1xuXHRcdFx0XHR0aGlzLnBhdGhQb2xpY2llcyA9IFtdO1xuXHRcdFx0XHR0aGlzLmdyYXBoID0gbnVsbDtcblx0XHRcdFx0dGhpcy5pbml0aWFsaXplZCA9IGZhbHNlO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCB3aGVuIGEgbGluayBpcyBhZGRlZCB0byB0aGUgZ3JhcGhcblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaCBpdCBpcyBhZGRlZCB0b1xuXHRcdFx0ICovXG5cdFx0XHRpbml0aWFsaXplKGdyYXBoKSB7XG5cdFx0XHRcdGlmICh0aGlzLmluaXRpYWxpemVkID09IGZhbHNlKSB7XG5cdFx0XHRcdFx0dGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG5cdFx0XHRcdFx0dGhpcy5ncmFwaCA9IGdyYXBoO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsbGVkIGR1cmluZyB0aGUgdXBkYXRlIGdyYXBoIGZvciBleGlzdGluZyBsaW5rc1xuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzcGF0aCAgVGhlIGQzIHBhdGhcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtMaW5rfSAgXHQgICBkICAgICAgIE1hdGNoaW5nIExpbmsgT2JqZWN0ICAgICAgIFxuXHRcdFx0ICovXG5cdFx0XHR1cGRhdGVBdHRyKGQzcGF0aCwgZCkge1xuXHRcdFx0XHRkM3BhdGguc3R5bGUoJ21hcmtlci1lbmQnLCAndXJsKCNlbmQtYXJyb3cpJylcblx0XHQgICAgICAgICAgICAuYXR0cihcImRcIiwgYXJyb3dQYXRoKTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxsZWQgZHVyaW5nIHRoZSBmaXJzdCB1cGRhdGUgZ3JhcGggZm9yIGEgbGlua1xuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzcGF0aCAgVGhlIGQzIHBhdGhcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtMaW5rfSAgXHQgICBkICAgICAgIE1hdGNoaW5nIExpbmsgT2JqZWN0ICAgICAgIFxuXHRcdFx0ICovXG5cdFx0XHRuZXdQYXRoQXR0cihkM3BhdGgsIGQpIHtcblx0XHRcdFx0ZDNwYXRoLmF0dHIoJ2QnLCBhcnJvd1BhdGgpO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGN1bGF0ZXMgdGhlIGFycm93IHBhdGhcblx0XHRcdCAqXG5cdFx0XHQgKiBAcmV0dXJuICAgICB7c3RyaW5nfSAgVGhlIHBhdGggdG8gZHJhd1xuXHRcdFx0ICovXG5cdFx0ICAgIGFycm93UGF0aCgpIHtcblx0XHQgICAgXHR2YXIgZCA9IHRoaXM7XG5cdFx0ICAgICAgICB2YXIgZHggPSBkLnRhcmdldC54IC0gZC5zb3VyY2UueCxcblx0XHQgICAgICAgICAgICBkeSA9IGQudGFyZ2V0LnkgLSBkLnNvdXJjZS55LFxuXHRcdCAgICAgICAgICAgIGRyID0gTWF0aC5zcXJ0KGR4ICogZHggKyBkeSAqIGR5KTtcblx0XHQgICAgICAgIHJldHVybiBcIk1cIiArIGQuc291cmNlLnggKyBcIixcIiArIGQuc291cmNlLnkgKyBcIkFcIiArIGRyICsgXCIsXCIgKyBkciArIFwiIDAgMCwxIFwiICsgZC50YXJnZXQueCArIFwiLFwiICsgZC50YXJnZXQueTtcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBVc2VkIHRvIGluc3RhbGwgcG9saWNpZXMgdGhhdCBhcmUgY2FsbGVkIHdoZW4gdGhpc1xuXHRcdCAgICAgKiBsaW5rIGhhcyBhIG1vdXNlIGV2ZW50XG5cdFx0ICAgICAqXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3kgIFRoZSBwb2xpY3kgdG8gaW5zdGFsbFxuXHRcdCAgICAgKi9cblx0XHRcdGluc3RhbGxQYXRoUG9saWN5KHBvbGljeSkge1xuXHRcdFx0XHR0aGlzLmhhc1BvbGljeSA9IHRydWU7XG5cdFx0XHRcdHRoaXMucGF0aFBvbGljaWVzLnB1c2gocG9saWN5KTtcblx0XHRcdFx0cG9saWN5LmluaXRpYWxpemUodGhpcy5ncmFwaCk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogVXNlZCB0byB1bmluc3RhbGwgcG9saWN5IGZvciB0aGlzIGxpbmtcblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7UG9saWN5fSAgcG9saWN5UmVtb3ZlICBUaGUgcG9saWN5IHRvIHJlbW92ZVxuXHRcdFx0ICovXG5cdFx0XHR1bmluc3RhbGxQYXRoUG9saWN5KHBvbGljeVJlbW92ZSkge1xuXHRcdFx0XHR2YXIgcG9saWN5UmVtb3ZlTmFtZTtcblx0XHRcdFx0dmFyIHRoaXNQYXRoID0gdGhpcztcblx0XHRcdFx0aWYgKHR5cGVvZiBwb2xpY3lSZW1vdmUgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0cG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlLnBvbGljeU5hbWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0Xyh0aGlzUGF0aC5wYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5LCBpbmRleCkge1xuXHRcdFx0XHRcdGlmIChwb2xpY3kucG9saWN5TmFtZSA9PT0gcG9saWN5UmVtb3ZlTmFtZSkge1xuXHRcdFx0XHRcdFx0cG9saWN5LmRlc3Ryb3koKTtcblx0XHRcdFx0XHRcdHRoaXNQYXRoLnBhdGhQb2xpY2llcy5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHRcdGlmICh0aGlzUGF0aC5wYXRoUG9saWNpZXMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdFx0dGhpc1BhdGguaGFzUG9saWN5ID0gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxsZWQgd2hlbiB0aGVyZSBpcyBhIG1vdXNlIGV2ZW50IGZvciB0aGlzIHBhdGhcblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgZXZlbnQgICAgIFRoZSBtb3VzZSBldmVudFxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuXHRcdFx0ICogQHBhcmFtICAgICAge09iamVjdH0gIGQgICAgICAgICBUaGUgbWF0Y2hpbmcgbGluayBvYmplY3Rcblx0XHRcdCAqL1xuXHRcdFx0cGF0aFBvbGljeUV2ZW50KGV2ZW50LCBkM3BhdGgsIGQpIHtcblx0XHRcdFx0XyhkLnBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3kpIHtcblx0XHRcdFx0XHRwb2xpY3lbZXZlbnRdKGQzcGF0aCwgZCk7XG5cdFx0XHRcdH0pXG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB7XG5cdFx0XHRMaW5rOiBMaW5rXG5cdFx0fVxufV0pO1xuXG5cblxuXG5cblxuIiwiXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnLCBcblx0J2NvbnRpdi5ncmFwaCddKVxuIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnY29udGl2Lm1lbnUudmlzdWFsaXphdGlvbicsIHtcbiAgICAgICAgICAgIHVybDogJy92aXN1YWxpemF0aW9uJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KVxuICAgIH1dKTtcbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52b2x1bWVzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52b2x1bWVzJywge1xuICAgICAgICAgICAgdXJsOiAnL3ZvbHVtZXMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZvbHVtZXMubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ3ZvbHVtZWxpc3QnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZvbHVtZXMuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29tcG9uZW50OiAndm9sdW1lZGV0YWlscydcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIi8qKlxuICogVGhlIGxpbmsgdGhhdCBpcyB1c2VkIHNwZWNpZmljYWxseSBmb3IgdGhlIHZpc3VhbGl6YXRpb24gdGFiLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnVmlzdWFsaXplckxpbmsnLCBbJ0xpbmsnLCBmdW5jdGlvbiAoTGluaykge1xuXHRcdGNsYXNzIFZpc3VhbGl6ZXJMaW5rIGV4dGVuZHMgTGluay5MaW5rIHtcblx0XHRcdC8qKlxuXHRcdFx0ICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtOb2RlfSAgc291cmNlTm9kZSAgVGhlIHNvdXJjZSBub2RlXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHRhcmdldE5vZGUgIFRoZSB0YXJnZXQgbm9kZVxuXHRcdFx0ICogQHBhcmFtICAgICAge251bWJlcn0gIHdlaWdodCAgICBUaGUgd2VpZ2h0IG9mIHRoZSBsaW5rXG5cdFx0XHQgKi9cblx0XHQgICAgY29uc3RydWN0b3Ioc291cmNlTm9kZSwgdGFyZ2V0Tm9kZSwgd2VpZ2h0KSB7XG5cdFx0ICAgICAgICBzdXBlcihzb3VyY2VOb2RlLCB0YXJnZXROb2RlKTtcblx0XHQgICAgICAgIHRoaXMud2VpZ2h0ID0gd2VpZ2h0O1xuXHRcdCAgICAgICAgLy9Db3VudCBpcyB1c2VkIHRvIGtlZXAgdHJhY2sgb2YgaG93IG1hbnlcblx0XHQgICAgICAgIC8vcGF0aHMgdG8gaXRzIHN1Ym5vZGVzIHRoZXJlIGFyZVxuXHRcdCAgICAgICAgLy9pbiBvcmRlciB0byBjYWxjdWxhdGUgYXZlcmFnZSB0cmFmZmljXG5cdFx0ICAgICAgICB0aGlzLmNvdW50ID0gMTtcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBJbmNyZWFzZXMgdGhlIGNvdW50IG9mIHRoZSBsaW5rXG5cdFx0ICAgICAqIFVTZWQgdG8ga2VlcCB0cmFjayBvZiBob3cgbWFueSBwYXRocyB0byBpdHMgc3Vibm9kZXNcblx0XHQgICAgICogdGhlcmUgYXJlIGluIG9yZGVyIHRvIGNhbGN1bGF0ZSBhdmVyYWdlIHRyYWZmaWNcblx0XHQgICAgICovXG5cdFx0ICAgIGluY3JlYXNlQ291bnQoKSB7XG5cdFx0ICAgICAgICB0aGlzLmNvdW50ICs9IDE7XG5cdFx0ICAgIH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogQ2FsY3VsYXRlcyB3aGVyZSB0byBwbGFjZSBxdGlwIGZvclxuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcmV0dXJuICAgICB7T2JqZWN0fSAgT2JqZWN0IHdpdGggcVRpcCBzZXR0aW5nc1xuXHRcdCAgICAgKi9cblx0XHQgICAgcXRpcEhlbHBlcigpIHtcblx0XHQgICAgXHR2YXIgcmV0O1xuXHRcdCAgICBcdHZhciBkID0gdGhpcztcblx0XHQgICAgXHR2YXIgZHggPSAoZC50YXJnZXQueCAtIGQuc291cmNlLngpIC8gMixcblx0XHQgICAgICAgICAgICBkeSA9IChkLnRhcmdldC55IC0gZC5zb3VyY2UueSkgLyAyO1xuXHRcdCAgICBcdGlmIChkLnNvdXJjZS54IDwgZC50YXJnZXQueCkge1xuXHQgICAgXHRcdFx0cmV0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbXk6ICd0b3AgY2VudGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0OiAnY2VudGVyIGNlbnRlcicsIC8vIGF0IHRoZSBib3R0b20gcmlnaHQgb2YuLi5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogW2R4LCBkeV0sXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGp1c3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFx0eTogMTBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXHRcdCAgICBcdH0gZWxzZSB7XG5cdCAgICBcdFx0XHRyZXQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBteTogJ2JvdHRvbSBjZW50ZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXQ6ICdjZW50ZXIgY2VudGVyJywgLy8gYXQgdGhlIGJvdHRvbSByaWdodCBvZi4uLlxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiBbZHgsIGR5XSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkanVzdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXHR5OiAtMTBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXHRcdCAgICBcdH1cblx0XHQgICAgXHRyZXR1cm4gcmV0O1xuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0XHQgKiBDYWxsZWQgd2hlbiBhIGxpbmsgaXMgYWRkZWQgdG8gdGhlIGdyYXBoXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgYWRkZWQgdG9cblx0XHRcdCAqL1xuXHRcdFx0aW5pdGlhbGl6ZShncmFwaCkge1xuXHRcdFx0XHRpZiAodGhpcy5pbml0aWFsaXplZCA9PSBmYWxzZSkge1xuXHRcdFx0XHRcdHN1cGVyLmluaXRpYWxpemUoZ3JhcGgpO1xuXHRcdFx0XHRcdHZhciBzdGF0ZSA9IGdyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXHRcdFx0XHRcdGlmIChzdGF0ZSA9PSBudWxsKSB7XG5cdFx0XHRcdFx0XHRzdGF0ZSA9IGdyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rID0ge307XG5cdFx0XHRcdFx0XHRzdGF0ZS5tYXhXZWlnaHQgPSBudWxsO1xuXHRcdFx0XHRcdFx0c3RhdGUudXNlQXZnV2VpZ2h0ID0gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0dGhpcy51cGRhdGVNYXhXZWlnaHQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFNldHMgd2hldGhlciB0aGUgZ3JhcGggc2hvdWxkIHVzZSBhdmcgd2VpZ2h0XG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge2Jvb2xlYW59ICB2YWwgICAgIFRoZSB2YWx1ZSB0byBzZXQgdG9cblx0XHRcdCAqL1xuXHRcdFx0c2V0VXNlQXZnV2VpZ2h0KHZhbCkge1xuXHRcdCAgICAgICAgdGhpcy5ncmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluay51c2VBdmdXZWlnaHQgPSAhIXZhbDtcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBTZXRzIHRoZSB3ZWlnaHQgb2YgdGhpcyBsaW5rXG5cdFx0ICAgICAqXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB3ZWlnaHQgIFRoZSB3ZWlnaHQgdG8gc2V0IHRvXG5cdFx0ICAgICAqL1xuXHRcdCAgICBzZXRXZWlnaHQod2VpZ2h0KSB7XG5cdFx0ICAgICAgICB0aGlzLndlaWdodCA9IHdlaWdodDtcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBHZXRzIHRoZSByYXcgd2VpZ2h0LlxuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcmV0dXJuICAgICB7bnVtYmVyfSAgVGhlIHJhdyB3ZWlnaHQuXG5cdFx0ICAgICAqL1xuXHRcdCAgICBnZXRSYXdXZWlnaHQoKSB7XG5cdFx0ICAgICAgICByZXR1cm4gdGhpcy53ZWlnaHQ7IFxuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIEdldHMgdGhlIHdlaWdodCB2YWx1ZSBvZiB0aGUgbGluaywgZGVwZW5kaW5nIG9uIHRoZVxuXHRcdCAgICAgKiB1c2VBdmdXZWlndGggc2V0dGluZ1xuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcmV0dXJuICAgICB7bnVtYmVyfSAgVGhlIHdlaWdodC5cblx0XHQgICAgICovXG5cdFx0ICAgIGdldFdlaWdodCgpIHtcblx0XHQgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuXHRcdCAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXG5cdFx0ICAgICAgICBpZiAoc3RhdGUudXNlQXZnV2VpZ2h0KSB7XG5cdFx0ICAgICAgICAgICAgdmFyIHdlaWdodCA9IHRoaXMud2VpZ2h0IC8gdGhpcy5jb3VudDtcblx0XHQgICAgICAgICAgICByZXR1cm4gd2VpZ2h0O1xuXHRcdCAgICAgICAgfVxuXHRcdCAgICAgICAgcmV0dXJuIHRoaXMud2VpZ2h0O1xuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIFVwZGF0ZXMgdGhlIG1heCB3ZWlnaHQgb2YgdGhlIGdyYXBoXG5cdFx0ICAgICAqL1xuXHRcdCAgICB1cGRhdGVNYXhXZWlnaHQgKCkge1xuXHRcdCAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG5cdFx0ICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuVmlzdWFsaXplckxpbms7XG5cblx0XHQgICAgICAgIHZhciBtYXhMaW5rID0gXy5tYXhCeSh0aGlzR3JhcGgubGlua3MsIGZ1bmN0aW9uKGwpIHtcblx0XHQgICAgICAgIFx0aWYgKGwuZ3JhcGggIT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIGwuZ2V0V2VpZ2h0KCk7XG5cdFx0ICAgICAgICBcdH1cblx0XHQgICAgICAgIFx0cmV0dXJuIDA7XG5cdFx0ICAgICAgICB9KTtcblx0XHQgICAgICAgIHN0YXRlLm1heFdlaWdodCA9IG1heExpbmsuZ2V0V2VpZ2h0KCk7XG5cdFx0ICAgIH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxsZWQgZHVyaW5nIHRoZSB1cGRhdGUgZ3JhcGggZm9yIGV4aXN0aW5nIGxpbmtzXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuXHRcdFx0ICogQHBhcmFtICAgICAge0xpbmt9ICBcdCAgIGQgICAgICAgTWF0Y2hpbmcgTGluayBPYmplY3QgICAgICAgXG5cdFx0XHQgKi9cblx0XHRcdHVwZGF0ZUF0dHIoZDNwYXRoLCBkKSB7XG5cdFx0ICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcblx0XHQgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluaztcblx0XHQgICAgICAgIHRoaXMudXBkYXRlTWF4V2VpZ2h0KCk7XG5cdCAgICAgICAgICAgIHZhciBjb2xvclNjYWxlID0gZDMuc2NhbGUubGluZWFyKClcblx0ICAgICAgICAgICAgICAgIC5kb21haW4oWzAsIHN0YXRlLm1heFdlaWdodF0pXG5cdCAgICAgICAgICAgICAgICAucmFuZ2UoW1wiI2ZmYjM2NlwiLCBcIiNGOTI2MDZcIl0pO1xuXHQgICAgICAgICAgICBzdGF0ZS5jb2xvclNjYWxlID0gY29sb3JTY2FsZTtcblx0XHRcdFx0ZDNwYXRoLnN0eWxlKCdtYXJrZXItZW5kJywgJ3VybCgjZW5kLWFycm93KScpXG5cdFx0ICAgICAgICAgICAgLmNsYXNzZWQodGhpc0dyYXBoLmNvbnN0cy5zZWxlY3RlZENsYXNzLCBmdW5jdGlvbihkKXtcblx0XHQgICAgICAgICAgICAgICAgcmV0dXJuIGQgPT09IHN0YXRlLnNlbGVjdGVkRWRnZTtcblx0XHQgICAgICAgICAgICB9KVxuXHRcdCAgICAgICAgICAgIC5hdHRyKFwiZFwiLCB0aGlzLmFycm93UGF0aC5jYWxsKGQpKVxuXHRcdCAgICAgICAgICAgIC50cmFuc2l0aW9uKFwiZXhpc3RpbmdQYXRoVHJhbnNpdGlvblwiKVxuXHRcdCAgICAgICAgICAgIC5kdXJhdGlvbig3NTApXG5cdFx0ICAgICAgICAgICAgLmF0dHIoXCJzdHJva2VcIiwgZnVuY3Rpb24oZCl7XG5cdFx0ICAgICAgICAgICAgICAgIHZhciBjID0gY29sb3JTY2FsZShkLmdldFdlaWdodCgpKTtcblx0XHQgICAgICAgICAgICAgICAgcmV0dXJuIGM7XG5cdFx0ICAgICAgICAgICAgfSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsbGVkIGR1cmluZyB0aGUgZmlyc3QgdXBkYXRlIGdyYXBoIGZvciB0aGlzIGxpbmtcblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM3BhdGggIFRoZSBkMyBwYXRoXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7TGlua30gIFx0ICAgZCAgICAgICBNYXRjaGluZyBMaW5rIE9iamVjdFxuXHRcdFx0ICovXG5cdFx0XHRuZXdQYXRoQXR0cihkM3BhdGgsIGQpIHtcblx0XHQgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuXHRcdCAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXHQgICAgICAgICAgICB0aGlzLnVwZGF0ZU1heFdlaWdodCgpO1xuXHQgICAgICAgICAgICB2YXIgY29sb3JTY2FsZSA9IGQzLnNjYWxlLmxpbmVhcigpXG5cdCAgICAgICAgICAgICAgICAuZG9tYWluKFswLCBzdGF0ZS5tYXhXZWlnaHRdKVxuXHQgICAgICAgICAgICAgICAgLnJhbmdlKFtcIiNmZmIzNjZcIiwgXCIjRjkyNjA2XCJdKTtcblx0ICAgICAgICAgICAgICAgIFxuXHRcdFx0XHRkM3BhdGgudHJhbnNpdGlvbihcIm5ld1BhdGhUcmFuc2l0aW9uXCIpXG5cdFx0ICAgICAgICAgICAgLmR1cmF0aW9uKDc1MClcblx0XHQgICAgICAgICAgICAuYXR0clR3ZWVuKFwib3BhY2l0eVwiLCBmdW5jdGlvbihkKSB7XG5cdFx0ICAgICAgICAgICAgICAgIHJldHVybiBkMy5pbnRlcnBvbGF0ZVN0cmluZygwLDEpO1xuXHRcdCAgICAgICAgICAgIH0pXG5cdFx0ICAgICAgICAgICAgLmF0dHIoXCJzdHJva2VcIiwgZnVuY3Rpb24oZCl7XG5cdFx0ICAgICAgICAgICAgICAgIHZhciBjID0gY29sb3JTY2FsZShkLmdldFdlaWdodCgpKTtcblx0XHQgICAgICAgICAgICAgICAgcmV0dXJuIGM7XG5cdFx0ICAgICAgICAgICAgfSlcblx0XHQgICAgICAgICAgICAuYXR0cignZCcsIHRoaXMuYXJyb3dQYXRoLmNhbGwoZCkpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB7XG5cdFx0XHRMaW5rIDogVmlzdWFsaXplckxpbmtcblx0XHR9XG59XSk7XG5cblxuXG5cblxuIiwiJ3VzZSBzdHJpY3QnO1xuLy8gRGVjbGFyZSBhcHAgbGV2ZWwgbW9kdWxlIHdoaWNoIGRlcGVuZHMgb24gdmlld3MsIGFuZCBjb21wb25lbnRzXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2QXBwJywgW1xuICAgICd1aS5yb3V0ZXInLFxuICAgICdjb250aXYubG9naW4nLFxuICAgICdjb250aXYubWVudScsXG4gICAgJ2NvbnRpdi5kYXNoYm9hcmQnLFxuICAgICdjb250aXYuYXBwbGljYXRpb25ncm91cHMnLFxuICAgICdjb250aXYubmV0d29ya3MnLFxuICAgICdjb250aXYubmV0d29ya3BvbGljaWVzJyxcbiAgICAnY29udGl2LnN0b3JhZ2Vwb2xpY2llcycsXG4gICAgJ2NvbnRpdi5zZXJ2aWNlbGJzJyxcbiAgICAnY29udGl2LnZvbHVtZXMnLFxuICAgICdjb250aXYubm9kZXMnLFxuICAgICdjb250aXYub3JnYW5pemF0aW9ucycsXG4gICAgJ2NvbnRpdi5zZXR0aW5ncycsXG4gICAgJ2NvbnRpdi52aXN1YWxpemF0aW9uJ1xuXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCAnJHVybFJvdXRlclByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Jywge1xuICAgICAgICAgICAgdXJsOiAnJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBmbHVpZCBjb250YWluZXJcIi8+J1xuICAgICAgICB9KTtcbiAgICAgICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubWVudScpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Jywge1xuICAgICAgICAgICAgdXJsOiAnL20nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdtZW51L21lbnUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTWVudUN0cmwgYXMgbWVudUN0cmwnLFxuICAgICAgICAgICAgcGFyYW1zOiB7IHVzZXJuYW1lOiBudWxsIH1cbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ01lbnVDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zKSB7XG4gICAgICAgIHZhciBtZW51Q3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGxvZ291dCgpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2LmxvZ2luJyk7XG4gICAgICAgIH1cbiAgICAgICAgbWVudUN0cmwudXNlcm5hbWUgPSAkc3RhdGVQYXJhbXMudXNlcm5hbWU7XG4gICAgICAgIG1lbnVDdHJsLmxvZ291dCA9IGxvZ291dDtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tZW51Q3RybC5qcy5tYXAiLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJylcbiAgICAuZmFjdG9yeSgnQmdwU2VydmljZScsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbiAoJGh0dHAsICRxKSB7XG4gICAgICAgIGZ1bmN0aW9uIGdldEJncChjdHJsKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuQkdQU19FTkRQT0lOVCArIGN0cmwua2V5ICsgJy8nO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgY3RybC5uZWlnaGJvciA9IHJlc3VsdC5kYXRhO1xuICAgICAgICAgICAgICAgIGN0cmwubmVpZ2hib3JzLnB1c2goeyAnbmFtZSc6IGN0cmwubmVpZ2hib3JbJ25laWdoYm9yJ10sICd2YWx1ZSc6IGN0cmwubmVpZ2hib3JbJ25laWdoYm9yLWFzJ10gfSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUJncChjdHJsKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5CR1BTX0VORFBPSU5UICsgY3RybC5rZXkgKyAnLyc7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCh1cmwsIGN0cmwubmVpZ2hib3IpO1xuICAgICAgICB9XG4gICAgICAgIDtcbiAgICAgICAgZnVuY3Rpb24gZ2V0QmdwSW5zcGVjdChrZXkpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5CR1BTX0lOU1BFQ1RfRU5EUE9JTlQgKyBrZXkgKyAnLyc7XG4gICAgICAgICAgICAkaHR0cC5nZXQodXJsKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldEJncDogZ2V0QmdwLFxuICAgICAgICAgICAgdXBkYXRlQmdwOiB1cGRhdGVCZ3AsXG4gICAgICAgICAgICBnZXRCZ3BJbnNwZWN0OiBnZXRCZ3BJbnNwZWN0XG4gICAgICAgIH07XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Ymdwc2VydmljZS5qcy5tYXAiLCJhbmd1bGFyLm1vZHVsZShcImNvbnRpdi5ub2Rlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZMb2dzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL2xvZ3MuaHRtbCcsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBsb2c6IFwiPVwiLFxuICAgICAgICAgICAgdGl0bGU6IFwiQFwiXG4gICAgICAgIH1cbiAgICB9O1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1sb2dzZGlyZWN0aXZlLmpzLm1hcCIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5mYWN0b3J5KCdMb2dTZXJ2aWNlJywgWyckaHR0cCcsICckcScsIGZ1bmN0aW9uICgkaHR0cCwgJHEpIHtcbiAgICAgICAgZnVuY3Rpb24gZ2V0QWN0aXZlTG9ncygpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5OT0RFU19BQ1RJVkVfSk9CX0VORFBPSU5UO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdldExhc3RMb2dzKCkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLk5PREVTX0xBU1RfSk9CX0VORFBPSU5UO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRBY3RpdmVMb2dzOiBnZXRBY3RpdmVMb2dzLFxuICAgICAgICAgICAgZ2V0TGFzdExvZ3M6IGdldExhc3RMb2dzXG4gICAgICAgIH07XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bG9nc2VydmljZS5qcy5tYXAiLCIvKipcbiAqIFRoZSBiYXNlIGNsYXNzIGZvciBub2RlIG9iamVjdHMgZm9yIHRoZSBncmFwaC5cbiAqIFN1cHBvcnRzIHBvbGljaWVzLlxuICogXG4gKiBUbyB3cml0ZSB5b3VyIG93biBOb2RlIG9iamVjdCwgY3JlYXRlIGEgbmV3IGZhY3RvcnkgdGhhdCB1c2VzIHRoZSBub2RlXG4gKiB5b3Ugd2FudCB0byBpbmhlcml0IGFzIGEgZGVwZW5kZW5jeSwgYW5kIGV4dGVuZCBpdHMgbm9kZSBjbGFzcy4gXG4gKiBSZXR1cm4gdGhlIGNsYXNzIG9iamVjdCB3aXRoIE5vZGUgYXMga2V5XG4gKiBcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ05vZGUnLCBbZnVuY3Rpb24gKCkge1xuXHRcdGNsYXNzIE5vZGUge1xuXHRcdFx0LyoqXG5cdFx0XHQgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge251bWJlcn0gIHggICAgICAgeCBsb2NhdGlvblxuXHRcdFx0ICogQHBhcmFtICAgICAge251bWJlcn0gIHkgICAgICAgeSBsb2NhdGlvblxuXHRcdFx0ICogQHBhcmFtICAgICAge3N0cmluZ30gIGlkICAgICAgVGhlIGlkZW50aWZpZXJcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICB0ZXh0ICAgIFRoZSB0ZXh0IHRvIGRpc3BsYXlcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICByYWRpdXMgIFRoZSByYWRpdXMgb2YgdGhlIG5vZGVcblx0XHRcdCAqL1xuXHRcdFx0Y29uc3RydWN0b3IoeCwgeSwgaWQsIHRleHQsIHJhZGl1cykge1xuXHRcdFx0XHR0aGlzLnggPSB4O1xuXHRcdFx0XHR0aGlzLnkgPSB5O1xuXHRcdFx0XHR0aGlzLnJhZGl1cyA9IHJhZGl1cztcblx0XHRcdFx0dGhpcy5pZCA9IGlkO1xuXHRcdFx0XHR0aGlzLnRleHQgPSB0ZXh0O1xuXHRcdFx0XHR0aGlzLnJhZGl1cyA9IHJhZGl1cztcblx0XHRcdFx0dGhpcy5oYXNQb2xpY3kgPSBmYWxzZTtcblx0XHRcdFx0dGhpcy5wb2xpY3kgPSBudWxsO1xuXHRcdFx0XHR0aGlzLm5vZGVQb2xpY2llcyA9IFtdO1xuXHRcdFx0XHR0aGlzLmdyYXBoID0gbnVsbDtcblx0XHRcdFx0dGhpcy5pbml0aWFsaXplZCA9IGZhbHNlO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCB3aGVuIGEgbm9kZSBpcyBhZGRlZCB0byB0aGUgZ3JhcGhcblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaCBpdCBpcyBhZGRlZCB0b1xuXHRcdFx0ICovXG5cdFx0XHRpbml0aWFsaXplKGdyYXBoKSB7XG5cdFx0XHRcdGlmICh0aGlzLmluaXRpYWxpemVkID09IGZhbHNlKSB7XG5cdFx0XHRcdFx0dGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG5cdFx0XHRcdFx0dGhpcy5ncmFwaCA9IGdyYXBoO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsbGVkIGR1cmluZyB0aGUgdXBkYXRlIGdyYXBoIGZvciBleGlzdGluZyBsaW5rc1xuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcblx0XHRcdCAqL1xuXHRcdFx0dXBkYXRlQXR0cihkM25vZGUsIGQpIHtcblx0XHRcdFx0ZDNub2RlLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZnVuY3Rpb24oZCl7cmV0dXJuIFwidHJhbnNsYXRlKFwiICsgZC54ICsgXCIsXCIgKyBkLnkgKyBcIilcIjt9KTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxsZWQgZHVyaW5nIHRoZSBmaXJzdCB1cGRhdGUgZ3JhcGggZm9yIGEgbm9kZVxuXHRcdFx0ICogSG9vayBmb3Igc3ViIGNsYXNzZXNcblx0XHRcdCAqIFxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuXHRcdFx0ICogQHBhcmFtICAgICAge05vZGV9ICAgICAgZCAgICAgICBNYXRjaGluZyBOb2RlIE9iamVjdFxuXHRcdFx0ICovXG5cdFx0XHRuZXdOb2RlQXR0cihkM25vZGUsIGQpIHtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBTZXRzIHRoZSByYWRpdXMgb2YgdGhlIG5vZGUuXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge251bWJlcn0gIHJhZGl1cyAgVGhlIHJhZGl1c1xuXHRcdFx0ICovXG5cdFx0XHRzZXRSYWRpdXMocmFkaXVzKSB7XG5cdFx0XHRcdHRoaXMucmFkaXVzID0gcmFkaXVzO1xuXHRcdFx0fVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBVc2VkIHRvIGluc3RhbGwgcG9saWNpZXMgdGhhdCBhcmUgY2FsbGVkIHdoZW4gdGhpc1xuXHRcdCAgICAgKiBub2RlIGhhcyBhIG1vdXNlIGV2ZW50XG5cdFx0ICAgICAqXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3kgIFRoZSBwb2xpY3kgdG8gaW5zdGFsbFxuXHRcdCAgICAgKi9cblx0XHRcdGluc3RhbGxOb2RlUG9saWN5KHBvbGljeSkge1xuXHRcdFx0XHR0aGlzLmhhc1BvbGljeSA9IHRydWU7XG5cdFx0XHRcdHRoaXMubm9kZVBvbGljaWVzLnB1c2gocG9saWN5KTtcblx0XHRcdFx0cG9saWN5LmluaXRpYWxpemUodGhpcy5ncmFwaCk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogVXNlZCB0byB1bmluc3RhbGwgcG9saWN5IGZvciB0aGlzIG5vZGVcblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7UG9saWN5fHN0cmluZ30gIHBvbGljeVJlbW92ZSAgVGhlIHBvbGljeSB0byByZW1vdmVcblx0XHRcdCAqL1x0XHRcdFxuXHRcdFx0dW5pbnN0YWxsTm9kZVBvbGljeShwb2xpY3lSZW1vdmUpIHtcblx0XHRcdFx0dmFyIHBvbGljeVJlbW92ZU5hbWU7XG5cdFx0XHRcdHZhciB0aGlzTm9kZSA9IHRoaXM7XG5cdFx0XHRcdGlmICh0eXBlb2YgcG9saWN5UmVtb3ZlID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRcdHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmU7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZS5wb2xpY3lOYW1lO1xuXHRcdFx0XHR9XG5cdFx0XHRcdF8odGhpc05vZGUubm9kZVBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSwgaW5kZXgpIHtcblx0XHRcdFx0XHRpZiAocG9saWN5LnBvbGljeU5hbWUgPT09IHBvbGljeVJlbW92ZU5hbWUpIHtcblx0XHRcdFx0XHRcdHBvbGljeS5kZXN0cm95KCk7XG5cdFx0XHRcdFx0XHR0aGlzTm9kZS5ub2RlUG9saWNpZXMuc3BsaWNlKGluZGV4LCAxKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRpZiAodGhpc05vZGUubm9kZVBvbGljaWVzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0XHRcdHRoaXNOb2RlLmhhc1BvbGljeSA9IGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsbGVkIHdoZW4gdGhlcmUgaXMgYSBtb3VzZSBldmVudCBmb3IgdGhpcyBub2RlXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge3N0cmluZ30gIGV2ZW50ICAgICBUaGUgbW91c2UgZXZlbnRcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBkICAgICAgICAgVGhlIG1hdGNoaW5nIG5vZGUgb2JqZWN0XG5cdFx0XHQgKi9cblx0XHRcdG5vZGVQb2xpY3lFdmVudChldmVudCwgZDNub2RlLCBkKSB7XG5cdFx0XHRcdF8uZm9yRWFjaCh0aGlzLm5vZGVQb2xpY2llcywgZnVuY3Rpb24ocG9saWN5KSB7XG5cdFx0XHRcdFx0cG9saWN5W2V2ZW50XShkM25vZGUsIGQpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHtcblx0XHRcdE5vZGU6IE5vZGVcblx0XHR9XG59XSk7XG5cblxuXG5cblxuXG5cbiIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5hY3RpdmVsb2cnLCB7XG4gICAgICAgICAgICB1cmw6ICcvYWN0aXZlbG9nJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlQWN0aXZlSm9iTG9nc0N0cmwgYXMgbm9kZUFjdGl2ZUpvYkxvZ3NDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGN0di1sb2dzIHRpdGxlPVwiQWN0aXZlIEpvYlwiIGxvZz1cIm5vZGVBY3RpdmVKb2JMb2dzQ3RybC5hY3RpdmVMb2dzXCI+PC9jdHYtbG9ncz4nXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOb2RlQWN0aXZlSm9iTG9nc0N0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnTG9nU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzY29wZSwgJGludGVydmFsLCBMb2dTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBub2RlQWN0aXZlSm9iTG9nc0N0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBnZXRBY3RpdmVMb2dzKCkge1xuICAgICAgICAgICAgTG9nU2VydmljZS5nZXRBY3RpdmVMb2dzKCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgbm9kZUFjdGl2ZUpvYkxvZ3NDdHJsLmFjdGl2ZUxvZ3MgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vT25jZSB0aGUgam9iIGZpbmlzaGVzLCBlbmRwb2ludCByZXR1cm5zIDUwMCBlcnJvci4gU28gcmVzZXQgdGhlIGFjdGl2ZUxvZ3NcbiAgICAgICAgICAgICAgICBub2RlQWN0aXZlSm9iTG9nc0N0cmwuYWN0aXZlTG9ncyA9IHtcbiAgICAgICAgICAgICAgICAgICAgZGVzYzogJ1RoZXJlIGlzIGN1cnJlbnRseSBubyBhY3RpdmUgam9iLiBDaGVjayBMYXN0IEpvYiBmb3IgYSBqb2IgdGhhdCByZWNlbnRseSBmaW5pc2hlZC4nXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGdldEFjdGl2ZUxvZ3MoKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldEFjdGl2ZUxvZ3MoKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVhY3RpdmVqb2Jsb2dzY3RybC5qcy5tYXAiLCIvKipcbiAqIFRoZSBub2RlIHRoYXQgaXMgdXNlZCBzcGVjaWZpY2FsbHkgZm9yIHRoZSB2aXN1YWxpemF0aW9uIHRhYi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ1Zpc3VhbGl6ZXJOb2RlJywgWydOb2RlJywgZnVuY3Rpb24gKE5vZGUpIHtcblx0XHRjbGFzcyBWaXN1YWxpemVyTm9kZSBleHRlbmRzIE5vZGUuTm9kZSB7XG5cdFx0XHQvKipcblx0XHRcdCAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeCAgICAgICBcdHggbG9jYXRpb25cblx0XHRcdCAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB5ICAgICAgIFx0eSBsb2NhdGlvblxuXHRcdFx0ICogQHBhcmFtICAgICAge3N0cmluZ30gIGlkICAgICAgXHRUaGUgaWRlbnRpZmllclxuXHRcdFx0ICogQHBhcmFtICAgICAge3N0cmluZ30gIHRleHQgICAgXHRUaGUgdGV4dCB0byBkaXNwbGF5XG5cdFx0XHQgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgcmFkaXVzICBcdFRoZSByYWRpdXMgb2YgdGhlIG5vZGVcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBwYXJlbnQgICAgIFRoZSBwYXJlbnQgaWRcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBhbmNlc3RvcnMgIEFycmF5IG9mIGFuY2VzdG9ycyBJZFxuXHRcdFx0ICogQHBhcmFtICAgICAge251bWJlcn0gIHhTdGFydCAgICAgeCBsb2MgdG8gc3RhcnQgYW5pbWF0aW9uXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeVN0YXJ0ICAgICB5IGxvYyB0byBzdGFydCBhbmltYXRpb25cblx0XHRcdCAqL1xuXHRcdCAgICBjb25zdHJ1Y3Rvcih4LCB5LCBpZCwgdGV4dCwgcmFkaXVzLCBwYXJlbnQsIGFuY2VzdG9ycywgXG5cdFx0ICAgIFx0eFN0YXJ0LCB5U3RhcnQpIHtcblx0XHQgICAgICAgIHN1cGVyKHgsIHksIGlkLCB0ZXh0LCByYWRpdXMpO1xuXHRcdCAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG5cdFx0ICAgICAgICB0aGlzLmFuY2VzdG9ycyA9IGFuY2VzdG9ycztcblx0XHQgICAgICAgIGlmICh4U3RhcnQgPT0gbnVsbCkge1xuXHRcdCAgICAgICAgXHR0aGlzLnhTdGFydCA9IHg7XG5cdFx0ICAgICAgICB9IGVsc2Uge1xuXHRcdCAgICAgICAgXHR0aGlzLnhTdGFydCA9IHhTdGFydDtcblx0XHQgICAgICAgIH1cblx0XHQgICAgICAgIGlmICh5U3RhcnQgPT0gbnVsbCkge1xuXHRcdCAgICAgICAgXHR0aGlzLnlTdGFydCA9IHk7XG5cdFx0ICAgICAgICB9IGVsc2Uge1xuXHRcdCAgICAgICAgXHR0aGlzLnlTdGFydCA9IHlTdGFydDtcblx0XHQgICAgICAgIH1cblx0XHQgICAgfVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCBkdXJpbmcgdGhlIGZpcnN0IHVwZGF0ZSBncmFwaCBmb3IgYSBub2RlXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuXHRcdFx0ICogQHBhcmFtICAgICAge05vZGV9ICAgIGQgICAgICAgICBUaGUgbWF0Y2hpbmcgTm9kZVxuXHRcdFx0ICovXG5cdFx0XHRuZXdOb2RlQXR0cihkM25vZGUsIGQpIHtcblx0XHRcdFx0dmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG5cdFx0XHRcdGlmICh0aGlzR3JhcGguY29uc3RzLmNvbnRhaW5lckNsYXNzICE9IG51bGwgJiZcblx0XHRcdFx0XHRcdHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFtkLmlkXSA9PSBudWxsKSB7XG5cdFx0XHRcdFx0ZDNub2RlLmNsYXNzZWQodGhpc0dyYXBoLmNvbnN0cy5jb250YWluZXJDbGFzcywgdHJ1ZSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0ZDNub2RlLnRyYW5zaXRpb24oXCJub2RlUG9zaXRpb25UcmFuc2l0aW9uXCIpXG5cdFx0ICAgICAgICAgICAgICAgIC5kdXJhdGlvbig3NTApXG5cdFx0ICAgICAgICAgICAgICAgIC5hdHRyVHdlZW4oXCJ0cmFuc2Zvcm1cIiwgZnVuY3Rpb24oZCkge1xuXHRcdCAgICAgICAgICAgICAgICAgICAgaWYgKGQueFN0YXJ0ICE9IG51bGwgJiYgZC55U3RhcnQgIT0gbnVsbCkge1xuXHRcdCAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4U3RhcnQgPSBkLnhTdGFydDtcblx0XHQgICAgICAgICAgICAgICAgICAgICAgICB2YXIgeVN0YXJ0ID0gZC55U3RhcnQ7XG5cdFx0ICAgICAgICAgICAgICAgICAgICAgICAgZC54U3RhcnQgPSBkLng7XG5cdFx0ICAgICAgICAgICAgICAgICAgICAgICAgZC55U3RhcnQgPSBkLnk7XG5cdFx0ICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQzLmludGVycG9sYXRlU3RyaW5nKFwidHJhbnNsYXRlKFwiICsgeFN0YXJ0ICsgXCIsXCIgKyB5U3RhcnQgKyBcIilcIiwgXCJ0cmFuc2xhdGUoXCIgKyBkLnggKyBcIixcIiArIGQueSArIFwiKVwiKTtcblx0XHQgICAgICAgICAgICAgICAgICAgIH1cblx0XHQgICAgICAgICAgICAgICAgICAgIHJldHVybiBkMy5pbnRlcnBvbGF0ZVN0cmluZyhcInRyYW5zbGF0ZShcIiArIGQueCArIFwiLFwiICsgZC55ICsgXCIpXCIsIFwidHJhbnNsYXRlKFwiICsgZC54ICsgXCIsXCIgKyBkLnkgKyBcIilcIik7XG5cdFx0ICAgICAgICAgICAgICAgIH0pO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB7XG5cdFx0XHROb2RlOiBWaXN1YWxpemVyTm9kZVxuXHRcdH1cblxufV0pO1xuXG5cblxuXG5cblxuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8yNS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmNvbW1pc3Npb24nLCB7XG4gICAgICAgICAgICB1cmw6ICcvY29tbWlzc2lvbi86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlQ29tbWlzc2lvbkN0cmwgYXMgbm9kZUNvbW1pc3Npb25DdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWNvbW1pc3Npb24uaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVDb21taXNzaW9uQ3RybCcsIFtcbiAgICAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdOb2Rlc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJywgJ05vZGVzU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBOb2Rlc01vZGVsLCBDUlVESGVscGVyU2VydmljZSwgTm9kZXNTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBub2RlQ29tbWlzc2lvbkN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub05vZGVEZXRhaWxzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLmluZm8nLCB7ICdrZXknOiAkc3RhdGVQYXJhbXMua2V5IH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbENvbW1pc3Npb25pbmdOb2RlKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9Ob2RlRGV0YWlscygpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNvbW1pc3Npb24oKSB7XG4gICAgICAgICAgICBpZiAobm9kZUNvbW1pc3Npb25DdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIobm9kZUNvbW1pc3Npb25DdHJsKTtcbiAgICAgICAgICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwubm9kZU9wc09iai5ub2RlcyA9IFskc3RhdGVQYXJhbXMua2V5XTtcbiAgICAgICAgICAgICAgICBOb2Rlc1NlcnZpY2UuY2xlYW51cEV4dHJhVmFycyhub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgICAgICAgICAgICAgIE5vZGVzU2VydmljZS5jcmVhdGVFeHRyYVZhcnMobm9kZUNvbW1pc3Npb25DdHJsKTtcbiAgICAgICAgICAgICAgICBOb2Rlc01vZGVsLmNvbW1pc3Npb24obm9kZUNvbW1pc3Npb25DdHJsLm5vZGVPcHNPYmopLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvTm9kZURldGFpbHMoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihub2RlQ29tbWlzc2lvbkN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLm5vZGVPcHNPYmogPSB7fTtcbiAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLmV4dHJhX3ZhcnMgPSB7fTsgLy9UT0RPIEludGlhbGl6ZSBmcm9tIGdsb2JhbCBzZXR0aW5nc1xuICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuYW5zaWJsZVZhcmlhYmxlcyA9IFtdO1xuICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuZW52VmFyaWFibGVzID0gW107XG4gICAgICAgIE5vZGVzU2VydmljZS5nZXRTZXR0aW5ncyhub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuY2FuY2VsQ29tbWlzc2lvbmluZ05vZGUgPSBjYW5jZWxDb21taXNzaW9uaW5nTm9kZTtcbiAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLmNvbW1pc3Npb24gPSBjb21taXNzaW9uO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVjb21taXNzaW9uY3RybC5qcy5tYXAiLCIvKipcbiAqIFRoaXMgcG9saWN5IGlzIHVzZWQgdG8gYWRkIGEgc2VsZWN0IG5vZGUgZmVhdHVyZS5cbiAqIFN1cHBvcnRzIHNlbGVjdGluZyBtdWx0aXBsZSBub2RlcyBieSB1c2luZyB0aGUgY3RybCBrZXkuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdOb2RlU2VsZWN0aW9uUG9saWN5JywgWydQb2xpY3knLCBmdW5jdGlvbiAoUG9saWN5KSB7XG5cbiAgICBcdGNsYXNzIE5vZGVTZWxlY3Rpb25Qb2xpY3kgZXh0ZW5kcyBQb2xpY3kuUG9saWN5IHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgICAgICBzdXBlcihcIk5vZGVTZWxlY3Rpb25Qb2xpY3lcIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gcG9saWN5IGlzIGluc3RhbGxlZFxuICAgICAgICAgICAgICogT3ZlcndyaXRlcyB0aGUgb24gZHJhZyBldmVudCBvZiB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgXG4gICAgXHRcdCAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFsbGVkIG9uXG4gICAgXHRcdCAqL1xuICAgICAgICAgICAgaW5pdGlhbGl6ZShncmFwaCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3VwZXIuaW5pdGlhbGl6ZShncmFwaCk7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLnNlbGVjdGVkTm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgY29uc3RzID0gZ3JhcGguY29uc3RzLk5vZGVTZWxlY3Rpb25Qb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICBjb25zdHMuc2VsZWN0ZWRDbGFzcyA9IFwic2VsZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAvL292ZXJ3cml0dGluZyBncmFwaCdzIG5vZGUgb24gZHJhZyBldmVudCB0byBzdXBwb3J0XG4gICAgICAgICAgICAgICAgLy9tb3ZpbmcgbXVsdGlwbGUgbm9kZXMgYXQgb25jZVxuICAgICAgICAgICAgICAgIHZhciBkcmFnID0gZ3JhcGguZHJhZztcbiAgICAgICAgICAgICAgICBkcmFnLm9uKCdkcmFnJywgZnVuY3Rpb24oYXJncykge1xuICAgICAgICAgICAgICAgIFx0dmFyIHRoaXNHcmFwaCA9IGdyYXBoO1xuICAgICAgICAgICAgICAgIFx0aWYgKHRoaXNHcmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgXHRcdHZhciBzZWxlY3RlZENsYXNzID0gdGhpc0dyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5LnNlbGVjdGVkQ2xhc3M7XG4gICAgICAgICAgICAgICAgXHRcdHZhciBzZWxlY3Rpb24gPSBkMy5zZWxlY3RBbGwoICcuJyArc2VsZWN0ZWRDbGFzcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBzZWxlY3Rpb25bMF0uaW5kZXhPZiggdGhpcyk9PS0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uLmNsYXNzZWQoc2VsZWN0ZWRDbGFzcywgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGlvbiA9IGQzLnNlbGVjdCggdGhpcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uLmNsYXNzZWQoc2VsZWN0ZWRDbGFzcywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IFxuXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb24uYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbiggZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCArPSBkMy5ldmVudC5keDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gZDMuZXZlbnQuZHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwidHJhbnNsYXRlKFwiICsgWyBkLngsZC55IF0gKyBcIilcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgICAgICBcdH1cblxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQWRkcyB0aGUgZ2l2ZW4gbm9kZSB0byB0aGUgYXJyYXkgb2Ygc2VsZWN0ZWQgbm9kZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM05vZGUgICAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgIG5vZGVEYXRhICBNYXRjaGluZyBOb2RlIG9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBhZGRTZWxlY3ROb2RlKGQzTm9kZSwgbm9kZURhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgZDNOb2RlLmNsYXNzZWQoY29uc3RzLnNlbGVjdGVkQ2xhc3MsIHRydWUpO1xuICAgICAgICAgICAgICAgIHN0YXRlLnNlbGVjdGVkTm9kZXMucHVzaChub2RlRGF0YSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyB0aGUgZ2l2ZW4gbm9kZSBmcm9tIHRoZSBhcnJheSBvZiBzZWxlY3RlZCBub2Rlcy5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM05vZGUgICAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgIG5vZGVEYXRhICBNYXRjaGluZyBub2RlIG9iamVjdCBcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgcmVtb3ZlU2VsZWN0RnJvbU5vZGUoZDNOb2RlLCBub2RlRGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzLk5vZGVTZWxlY3Rpb25Qb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5maWx0ZXIoZnVuY3Rpb24oY2QpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNkLmlkID09PSBub2RlRGF0YS5pZDtcbiAgICAgICAgICAgICAgICB9KS5jbGFzc2VkKGNvbnN0cy5zZWxlY3RlZENsYXNzLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gc3RhdGUuc2VsZWN0ZWROb2Rlcy5pbmRleE9mKG5vZGVEYXRhKTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zZWxlY3RlZE5vZGVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyBhbGwgc2VsZWN0ZWQgbm9kZXMuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHJlbW92ZUFsbFNlbGVjdGVkTm9kZXMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmNsYXNzZWQoY29uc3RzLnNlbGVjdGVkQ2xhc3MsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zZWxlY3RlZE5vZGVzID0gW107XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogT24gTW91c2Vkb3duLCBkZXRlcm1pbmVzIHdoZXRoZXIgdG8gY2hhbmdlIHRoZVxuICAgICAgICAgICAgICogc2VsZWN0ZWQgc3RhdHVzIG9mIHRoZSBjbGlja2VkIG5vZGUuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgZCAgICAgICBNYXRjaGluZyBOb2RlIE9iamVjdCAgICAgICBcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgbW91c2Vkb3duKGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuICAgICAgICAgICAgICAgIGQzLmV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIGlmIChkMy5ldmVudC5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5zZWxlY3RlZE5vZGVzLmluZGV4T2YoZCkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVTZWxlY3RGcm9tTm9kZShkM25vZGUsIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRTZWxlY3ROb2RlKGQzbm9kZSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHN0YXRlLnNlbGVjdGVkTm9kZXMuaW5kZXhPZihkKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIG5vIGNvbnRyb2wga2V5LCBhbmQgY2xpY2tlZCBub3Qgc2VsZWN0ZWQgbm9kZSxcbiAgICAgICAgICAgICAgICAgICAgLy9yZW1vdmUgYWxsIG9mIGN1cnJlbnQgc2VsZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQWxsU2VsZWN0ZWROb2RlcygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBPbiBNb3VzZXVwLCBkZXRlcm1pbmVzIHdoZXRoZXIgdG8gY2hhbmdlIHRoZVxuICAgICAgICAgICAgICogc2VsZWN0ZWQgc3RhdHVzIG9mIHRoZSBjbGlja2VkIG5vZGUuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgZCAgICAgICBNYXRjaGluZyBOb2RlIE9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBtb3VzZXVwKGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuICAgICAgICAgICAgICAgIGlmICghZDMuZXZlbnQuY3RybEtleSkge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIGxlbmd0aCBpcyBncmVhdGVyIHRoYW4gMSwgdGhlbiB3ZSBhcmUgbW92aW5nIG11bHRpcGxlIG5vZGVzXG4gICAgICAgICAgICAgICAgICAgIC8vbGVhdmUgdGhlbSBhbGwgaGlnaGxpZ2h0ZWRcbiAgICAgICAgICAgICAgICAgICAgLy9vdGhlcndpc2Ugd2UgYXJlIGp1c3QgbW92aW5nIG9uZSBub2RlLCBzbyB1bmhpZ2hsaWdodFxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuc2VsZWN0ZWROb2Rlcy5sZW5ndGggPD0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVTZWxlY3RGcm9tTm9kZShkM25vZGUsIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBQb2xpY3k6IE5vZGVTZWxlY3Rpb25Qb2xpY3lcbiAgICAgICAgfVxufV0pO1xuXG5cblxuXG5cblxuXG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMjUvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZURldGFpbHNDdHJsIGFzIG5vZGVEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVkZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMuaW5mbycsIHtcbiAgICAgICAgICAgIHVybDogJy9pbmZvJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGV0YWlsc0N0cmwgYXMgbm9kZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWluZm8uaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMuZGV0YWlscy5zdGF0cycsIHtcbiAgICAgICAgICAgIHVybDogJy9zdGF0cycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZURldGFpbHNDdHJsIGFzIG5vZGVEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVzdGF0cy5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLmxvZ3MnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbG9ncycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZURldGFpbHNDdHJsIGFzIG5vZGVEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVsb2dzLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMuZWRpdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9lZGl0JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGV0YWlsc0N0cmwgYXMgbm9kZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWluZm8uaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVEZXRhaWxzQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICckc2NvcGUnLCAnJGludGVydmFsJywgJ05vZGVzTW9kZWwnLCAnQmdwU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCAkc2NvcGUsICRpbnRlcnZhbCwgTm9kZXNNb2RlbCwgQmdwU2VydmljZSkge1xuICAgICAgICB2YXIgbm9kZURldGFpbHNDdHJsID0gdGhpcztcbiAgICAgICAgbm9kZURldGFpbHNDdHJsLm51bWJlcnBhdHRlcm4gPSBDb250aXZHbG9iYWxzLk5VTUJFUl9SRUdFWDtcbiAgICAgICAgZnVuY3Rpb24gZGVjb21taXNzaW9uKCkge1xuICAgICAgICAgICAgdmFyIG5vZGVPcHNPYmogPSB7XG4gICAgICAgICAgICAgICAgbm9kZXM6IFskc3RhdGVQYXJhbXMua2V5XVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIE5vZGVzTW9kZWwuZGVjb21taXNzaW9uKG5vZGVPcHNPYmopLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vRGlzYWJsZSBhbGwgYnV0dG9ucyBpbml0aWFsbHkuIFBvbGwgd2lsbCBhc3NpZ24gdmFsdWVzIGFwcHJvcHJpYXRlbHkuXG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiB1cGdyYWRlKCkge1xuICAgICAgICAgICAgdmFyIG5vZGVPcHNPYmogPSB7XG4gICAgICAgICAgICAgICAgbm9kZXM6IFskc3RhdGVQYXJhbXMua2V5XVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIE5vZGVzTW9kZWwudXBncmFkZShub2RlT3BzT2JqKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAvL0Rpc2FibGUgYWxsIGJ1dHRvbnMgaW5pdGlhbGx5LiBQb2xsIHdpbGwgYXNzaWduIHZhbHVlcyBhcHByb3ByaWF0ZWx5LlxuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERpc3BsYXkgYnV0dG9ucyBiYXNlZCBvbiBzdGF0dXMgb2Ygbm9kZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gc2V0QnV0dG9uRGlzcGxheSgpIHtcbiAgICAgICAgICAgIHN3aXRjaCAobm9kZURldGFpbHNDdHJsLm5vZGVbJ2ludmVudG9yeV9zdGF0ZSddLnN0YXR1cykge1xuICAgICAgICAgICAgICAgIGNhc2UgJ1VuYWxsb2NhdGVkJzpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0RlY29tbWlzc2lvbmVkJzpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ1Byb3Zpc2lvbmluZyc6XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnQWxsb2NhdGVkJzpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0NhbmNlbGxlZCc6XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ01haW50ZW5hbmNlJzpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdldE5vZGVJbmZvKHJlbG9hZCkge1xuICAgICAgICAgICAgTm9kZXNNb2RlbC5nZXRNb2RlbEJ5S2V5KCRzdGF0ZVBhcmFtcy5rZXksIHJlbG9hZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5ub2RlID0gbm9kZTtcbiAgICAgICAgICAgICAgICBzZXRCdXR0b25EaXNwbGF5KCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBzZXRNb2RlKCkge1xuICAgICAgICAgICAgaWYgKCRzdGF0ZS5pcygnY29udGl2Lm1lbnUubm9kZXMuZGV0YWlscy5lZGl0JykpIHtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubW9kZSA9ICdlZGl0JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5tb2RlID0gJ2RldGFpbHMnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvSW5mbygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubm9kZXMuZGV0YWlscy5pbmZvJyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlQmdwSW5mbygpIHtcbiAgICAgICAgICAgIGlmIChub2RlRGV0YWlsc0N0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3Iua2V5ID0gJHN0YXRlUGFyYW1zLmtleTtcbiAgICAgICAgICAgICAgICAvLyBiYWNrZW5kIG9ubHkgc3VwcG9ydHMgYWRkaW5nIG9uZSBuZWlnaGJvciBjdXJyZW50bHlcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3JzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm5laWdoYm9yWyduZWlnaGJvciddID0gaXRlbS5uYW1lO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3JbJ25laWdoYm9yLWFzJ10gPSBpdGVtLnZhbHVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIEJncFNlcnZpY2UudXBkYXRlQmdwKG5vZGVEZXRhaWxzQ3RybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvciA9IHJlc3VsdC5jb25maWcuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9JbmZvKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnZXRCZ3BJbmZvKCkge1xuICAgICAgICAgICAgQmdwU2VydmljZS5nZXRCZ3Aobm9kZURldGFpbHNDdHJsKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3IgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0QmdwSW5zcGVjdCgpIHtcbiAgICAgICAgICAgIEJncFNlcnZpY2UuZ2V0QmdwSW5zcGVjdCgkc3RhdGVQYXJhbXMua2V5KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuaW5zcGVjdCA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwucm91dGVzID0gcmVzdWx0Lk9wZXIucm91dGVzO1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5maWx0ZXJlZHJvdXRlcyA9IHJlc3VsdC5PcGVyLnJvdXRlcztcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBub2RlRGV0YWlsc0N0cmwuZGVjb21taXNzaW9uID0gZGVjb21taXNzaW9uO1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZSA9IHVwZ3JhZGU7XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zZXRNb2RlID0gc2V0TW9kZTtcbiAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZGF0ZUJncEluZm8gPSB1cGRhdGVCZ3BJbmZvO1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwucmV0dXJuVG9JbmZvID0gcmV0dXJuVG9JbmZvO1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3JzID0gW107XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvciA9IHt9O1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwua2V5ID0gJHN0YXRlUGFyYW1zLmtleTtcbiAgICAgICAgZ2V0QmdwSW5mbygpO1xuICAgICAgICBnZXRCZ3BJbnNwZWN0KCk7XG4gICAgICAgIHNldE1vZGUoKTtcbiAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgIGdldE5vZGVJbmZvKGZhbHNlKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldE5vZGVJbmZvKHRydWUpO1xuICAgICAgICAgICAgfSwgNTAwMCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVkZXRhaWxzY3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDYvMTQvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2Lm5vZGVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dk5vZGVzdGF0dXNcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBub2RlOiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2Rlc3RhdHVzLmh0bWwnXG4gICAgfTtcbn0pXG4gICAgLmRpcmVjdGl2ZShcImN0dk5vZGVzdGF0ZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIG5vZGU6ICc9J1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVzdGF0ZS5odG1sJ1xuICAgIH07XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVkaXJlY3RpdmUuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRpc2NvdmVyJywge1xuICAgICAgICAgICAgdXJsOiAnL2Rpc2NvdmVyJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGlzY292ZXJDdHJsIGFzIG5vZGVEaXNjb3ZlckN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2RlZGlzY292ZXIuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVEaXNjb3ZlckN0cmwnLCBbXG4gICAgJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnTm9kZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsICdOb2Rlc1NlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgTm9kZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UsIE5vZGVzU2VydmljZSkge1xuICAgICAgICB2YXIgbm9kZURpc2NvdmVyQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvTm9kZXMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5vZGVzLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxEaXNjb3ZlcmluZ05vZGUoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub05vZGVzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZGlzY292ZXIoKSB7XG4gICAgICAgICAgICBpZiAobm9kZURpc2NvdmVyQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihub2RlRGlzY292ZXJDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihub2RlRGlzY292ZXJDdHJsKTtcbiAgICAgICAgICAgICAgICBjcmVhdGVJUEFkZHJBcnJheSgpO1xuICAgICAgICAgICAgICAgIE5vZGVzU2VydmljZS5jcmVhdGVFeHRyYVZhcnMobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgICAgICAgICAgICAgTm9kZXNNb2RlbC5kaXNjb3Zlcihub2RlRGlzY292ZXJDdHJsLm5vZGVPcHNPYmopLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub05vZGVzKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihub2RlRGlzY292ZXJDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKG5vZGVEaXNjb3ZlckN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlSVBBZGRyQXJyYXkoKSB7XG4gICAgICAgICAgICBub2RlRGlzY292ZXJDdHJsLm5vZGVPcHNPYmouYWRkcnMgPSBfLndvcmRzKG5vZGVEaXNjb3ZlckN0cmwubm9kZUlQQWRkciwgL1teLCBdKy9nKTtcbiAgICAgICAgfVxuICAgICAgICBub2RlRGlzY292ZXJDdHJsLm5vZGVPcHNPYmogPSB7fTtcbiAgICAgICAgbm9kZURpc2NvdmVyQ3RybC5leHRyYV92YXJzID0ge307IC8vVE9ETyBJbnRpYWxpemUgZnJvbSBnbG9iYWwgc2V0dGluZ3NcbiAgICAgICAgbm9kZURpc2NvdmVyQ3RybC5hbnNpYmxlVmFyaWFibGVzID0gW107XG4gICAgICAgIG5vZGVEaXNjb3ZlckN0cmwuZW52VmFyaWFibGVzID0gW107XG4gICAgICAgIG5vZGVEaXNjb3ZlckN0cmwubm9kZUlQQWRkciA9ICcnOyAvL0lQIGFkZHJlc3Mgb2Ygbm9kZXMgdG8gZGlzY292ZXJcbiAgICAgICAgTm9kZXNTZXJ2aWNlLmdldFNldHRpbmdzKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICBub2RlRGlzY292ZXJDdHJsLmRpc2NvdmVyID0gZGlzY292ZXI7XG4gICAgICAgIG5vZGVEaXNjb3ZlckN0cmwuY2FuY2VsRGlzY292ZXJpbmdOb2RlID0gY2FuY2VsRGlzY292ZXJpbmdOb2RlO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bm9kZWRpc2NvdmVyY3RybC5qcy5tYXAiLCIvKipcbiAqIFRoaXMgcG9saWN5IGNoYW5nZXMgdGhlIHZpZXcgdG8gdGhlIHRpbWVncmFwaCBvZiBsaW5rIGRhdGEgb24gY2xpY2suXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdQYXRoQ2hhbmdlVmlld1BvbGljeScsIFsnUG9saWN5JywgZnVuY3Rpb24gKFBvbGljeSkge1xuICAgIFx0Y2xhc3MgUGF0aENoYW5nZVZpZXdQb2xpY3kgZXh0ZW5kcyBQb2xpY3kuUG9saWN5IHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHRvIGJ1aWxkIHBvbGljeVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgIHtBbmd1bGFyIFN0YXRlfSAgICAkc3RhdGUgICAgVXNlZCB0byBjaGFuZ2Ugdmlld1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcigkc3RhdGUpIHtcbiAgICAgICAgICAgICAgICBzdXBlcignUGF0aENoYW5nZVZpZXdQb2xpY3knKTtcbiAgICAgICAgICAgICAgICB0aGlzLiRzdGF0ZSA9ICRzdGF0ZTtcbiAgICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogR2VuZXJhdGVzIGEgbGlzdCBvZiBhbGwgY2hpbGQgY29udGFpbmVycyBvZiB0aGUgc2VydmljZVxuICAgICAgICAgICAgICogQ2FuIGhhbmRsZSBuZXN0ZWQgc2VydmljZXMuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGlkICAgICAgTm9kZSBJRFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBnZW5lcmF0ZUxpc3QoaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHJldExpc3QgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgZ2VuZXJhdGVMaXN0SGVscGVyID0gZnVuY3Rpb24oaWQsIHJldExpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVJZHMgPSB0aGlzUG9saWN5LmdyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0W2lkXTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2RlSWRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGRJZCA9IG5vZGVJZHNbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpc1BvbGljeS5ncmFwaC5kYXRhU291cmNlLmhhc0NoaWxkKGNoaWxkSWQpID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlJldExpc3QgPSBnZW5lcmF0ZUxpc3RIZWxwZXIoY2hpbGRJZCwgcmV0TGlzdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0TGlzdC5jb25jYXQoc3ViUmV0TGlzdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldExpc3QucHVzaChjaGlsZElkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBnZW5lcmF0ZUxpc3RIZWxwZXIoaWQsIHJldExpc3QpO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXRMaXN0XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byByZXJvdXRlIGFuIGVkZ2Ugd2hlbiBjbGlja2VkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0xpbmt9ICBlZGdlICAgIFRoZSBjbGlja2VkIGVkZ2VcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdmlld0VkZ2UoZWRnZSkge1xuICAgICAgICAgICAgICAgIHZhciBzb3VyY2VMaXN0ID0gW107XG4gICAgICAgICAgICAgICAgdmFyIHRhcmdldExpc3QgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgc291cmNlSWQgPSBlZGdlLnNvdXJjZS5pZDtcbiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0SWQgPSBlZGdlLnRhcmdldC5pZDtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmdyYXBoLmRhdGFTb3VyY2UuaGFzQ2hpbGQoc291cmNlSWQpID09PSB0cnVlKSB7Ly9Ob3QgYSBjb250YWluZXIgbm9kZSwgbmVlZCB0byBhZ2dyZWdhdGVcbiAgICAgICAgICAgICAgICAgICAgc291cmNlTGlzdCA9IHRoaXMuZ2VuZXJhdGVMaXN0KHNvdXJjZUlkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzb3VyY2VMaXN0ID0gW3NvdXJjZUlkXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ncmFwaC5kYXRhU291cmNlLmhhc0NoaWxkKHRhcmdldElkKSA9PT0gdHJ1ZSkgey8vTm90IGEgY29udGFpbmVyIG5vZGUsIG5lZWQgdG8gYWdncmVnYXRlXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldExpc3QgPSB0aGlzLmdlbmVyYXRlTGlzdCh0YXJnZXRJZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TGlzdCA9IFt0YXJnZXRJZF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuJHN0YXRlLmdvKCdjb250aXYubWVudS52aXN1YWxpemF0aW9uLmVkZ2UnLCBcbiAgICAgICAgICAgICAgICAgICAge3NvdXJjZU5hbWU6IHNvdXJjZUlkLCB0YXJnZXROYW1lOiB0YXJnZXRJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZUxpc3Q6IHNvdXJjZUxpc3QsIHRhcmdldExpc3Q6IHRhcmdldExpc3R9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbW91c2Vkb3duKGQzcGF0aCwgZCkge1xuICAgICAgICAgICAgICAgIHRoaXMudmlld0VkZ2UoZCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgUG9saWN5OiBQYXRoQ2hhbmdlVmlld1BvbGljeVxuICAgICAgICB9XG59XSk7XG5cblxuXG5cblxuXG5cblxuXG5cblxuIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmxhc3Rsb2cnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGFzdGxvZycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZUxhc3RKb2JMb2dzQ3RybCBhcyBub2RlTGFzdEpvYkxvZ3NDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGN0di1sb2dzIHRpdGxlPVwiTGFzdCBKb2JcIiBsb2c9XCJub2RlTGFzdEpvYkxvZ3NDdHJsLmxhc3RMb2dzXCI+PC9jdHYtbG9ncz4nXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOb2RlTGFzdEpvYkxvZ3NDdHJsJywgWyckc2NvcGUnLCAnJGludGVydmFsJywgJ0xvZ1NlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc2NvcGUsICRpbnRlcnZhbCwgTG9nU2VydmljZSkge1xuICAgICAgICB2YXIgbm9kZUxhc3RKb2JMb2dzQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGdldExhc3RMb2dzKCkge1xuICAgICAgICAgICAgTG9nU2VydmljZS5nZXRMYXN0TG9ncygpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIG5vZGVMYXN0Sm9iTG9nc0N0cmwubGFzdExvZ3MgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZ2V0TGFzdExvZ3MoKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldExhc3RMb2dzKCk7XG4gICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1ub2RlbGFzdGpvYmxvZ3NjdHJsLmpzLm1hcCIsIi8qKlxuICogQmFzZSBwb2xpY3kgY2xhc3MgZm9yIHRoZSBncmFwaCBvYmplY3RcbiAqIFxuICogUG9saWNpZXMgYXJlIHVzZWQgdG8gaXNvbGF0ZSBmZWF0dXJlcyBmb3IgYSBncmFwaC5cbiAqIFBvbGljaWVzIGNhbiBiZSBpbnN0YWxsZWQgb24gbm9kZXMsIGxpbmtzLCBvciB0aGUgZ3JhcGguXG4gKiBFYWNoIHBvbGljeSBoYXMgaW50ZXJhY3Rpb24gaGFuZGxlcnMgdGhhdCB3aWxsIGJlIGNhbGxlZCBieSB0aGUgZ3JhcGhcbiAqIGlmIGluc3RhbGxlZC4gUG9saWNpZXMgY2FuIGFsc28gbW9kaWZ5IGdyYXBoIGZ1bmN0aW9ucyAoc2VlIFFUaXBQb2xpY3kpLlxuICogTXVsdGlwbGUgcG9saWNpZXMgY2FuIGJlIGluc3RhbGxlZCBmb3IgYSBub2RlIG9yIGxpbmsuIFxuICogXG4gKiBUbyB3cml0ZSB5b3VyIG93biBwb2xpY3ksIGNyZWF0ZSBhIG5ldyBmYWN0b3J5IHRoYXQgdXNlcyB0aGUgcG9saWN5XG4gKiB5b3Ugd2FudCB0byBpbmhlcml0IGFzIGEgZGVwZW5kZW5jeSwgYW5kIGV4dGVuZCBpdHMgcG9saWN5LiBcbiAqIFJldHVybiB0aGUgY2xhc3Mgb2JqZWN0IHdpdGggUG9saWN5IGFzIGtleSwgYW5kIFxuICogYWRkIHRoZSBwb2xpY3kgdG8gdGhlIFBvbGljeVNlcnZpY2UgZmFjdG9yeS5cbiAqIFxuICogRm9yIHNhdmluZyBzdGF0ZSBvciBjb25zdHMgZm9yIHRoZSBwb2xpY3ksIGNyZWF0ZSBhIG5hbWVzcGFjZVxuICogaW4gZ3JhcGguc3RhdGUgYW5kIGdyYXBoLmNvbnN0cy5cbiAqIEV4LiBcbiAqICAgICAgZ3JhcGguc3RhdGUubXlQb2xpY3kgPSB7fTtcbiAqICAgICAgZ3JhcGguY29uc3RzLm15UG9saWN5ID0ge307XG4gKiAgICAgIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnUG9saWN5JywgW2Z1bmN0aW9uICgpIHtcbiAgICAgICAgY2xhc3MgUG9saWN5IHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBwb2xpY3lOYW1lICBUaGUgcG9saWN5IG5hbWVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgY29uc3RydWN0b3IocG9saWN5TmFtZSkge1xuICAgICAgICAgICAgICAgIHRoaXMucG9saWN5TmFtZSA9IHBvbGljeU5hbWU7XG4gICAgICAgICAgICAgICAgdGhpcy5ncmFwaCA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplZCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBwb2xpY3kgaXMgaW5zdGFsbGVkLlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gIHtHcmFwaH0gIGdyYXBoICAgVGhlIEdyYXBoIHRoYXQgdGhlIHBvbGljeSBpc1xuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgIGJlaW5nIGluc3RhbGxlZCBvblxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbml0aWFsaXplKGdyYXBoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOyBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5ncmFwaCA9IGdyYXBoO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEhhbmRsZXIsIG1lYW50IHRvIGJlIG92ZXJyaWRkZW4gaW4gc3ViY2xhc3Nlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAge2QzIG9iamVjdH0gICAgZDNvYmogICAgVGhlIGQzb2JqZWN0XG4gICAgICAgICAgICAgKiBAcGFyYW0gIHtOb2RlL0xpbmsvR3JhcGh9ICBkICAgVGhlIG9iamVjdCBpdCB3YXNcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YWxsZWQgZm9yLiAgICBcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgbW91c2VvdmVyIChkM29iaiwgZCkge31cbiAgICAgICAgICAgIGRibGNsaWNrKGQzb2JqLCBkKSB7fVxuICAgICAgICAgICAgY29udGV4dG1lbnUoZDNvYmosIGQpIHt9XG4gICAgICAgICAgICBtb3VzZW91dChkM29iaiwgZCkge31cbiAgICAgICAgICAgIG1vdXNlZG93bihkM29iaiwgZCkge31cbiAgICAgICAgICAgIG1vdXNldXAoZDNvYmosIGQpIHt9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2lsbCBiZSBjYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgYmVpbmcgZGVzdHJveWVkLlxuICAgICAgICAgICAgICogVXNlZCB0byByZW1vdmUgYW55IGVsZW1lbnRzIG9yIGJpbmRpbmdzIHRoZSBwb2xpY3lcbiAgICAgICAgICAgICAqIGhhcyBhZGRlZC5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZGVzdHJveSgpIHt9XG4gICAgICAgIH1cbiAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBQb2xpY3k6IFBvbGljeVxuICAgICAgICB9XG59XSk7XG5cblxuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8yMi8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZUxpc3RDdHJsIGFzIG5vZGVMaXN0Q3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVsaXN0Lmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOb2RlTGlzdEN0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdOb2Rlc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIE5vZGVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBub2RlTGlzdEN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBnZXROb2RlcyhyZWxvYWQpIHtcbiAgICAgICAgICAgIE5vZGVzTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihub2RlTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgIG5vZGVMaXN0Q3RybC5ub2RlcyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihub2RlTGlzdEN0cmwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgIGdldE5vZGVzKGZhbHNlKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldE5vZGVzKHRydWUpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bm9kZWxpc3RjdHJsLmpzLm1hcCIsIi8qKlxuICogQ29udGFpbnMgYWxsIHRoZSBwb2xpY2llcy5cbiAqIFNlZSBwb2xpY3kuanMgZm9yIGluZm8gb24gaG93IHBvbGljaWVzIHdvcmsuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdQb2xpY3lTZXJ2aWNlJywgWydQb2xpY3knLCdRVGlwUG9saWN5JywgJ1BhdGhDaGFuZ2VWaWV3UG9saWN5JywgXG4gICAgICAgICdOb2RlU2VsZWN0aW9uUG9saWN5JywgJ1NwbGl0Sm9pbk5vZGVQb2xpY3knLCAnU3BsaXRKb2luVmlld1BvbGljeScsXG4gICAgICAgICdTYXZlU3RhdGVQb2xpY3knLFxuICAgICAgICAgICAgZnVuY3Rpb24gKFBvbGljeSwgUVRpcFBvbGljeSwgUGF0aENoYW5nZVZpZXdQb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgICAgICBOb2RlU2VsZWN0aW9uUG9saWN5LCAgU3BsaXRKb2luTm9kZVBvbGljeSwgXG4gICAgICAgICAgICAgICAgICAgICAgICBTcGxpdEpvaW5WaWV3UG9saWN5LCBTYXZlU3RhdGVQb2xpY3kpIHtcblxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIFBvbGljeTogUG9saWN5LlBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgUVRpcFBvbGljeTogUVRpcFBvbGljeS5Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIFBhdGhDaGFuZ2VWaWV3UG9saWN5OiBQYXRoQ2hhbmdlVmlld1BvbGljeS5Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIE5vZGVTZWxlY3Rpb25Qb2xpY3k6IE5vZGVTZWxlY3Rpb25Qb2xpY3kuUG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBTcGxpdEpvaW5Ob2RlUG9saWN5OiBTcGxpdEpvaW5Ob2RlUG9saWN5LlBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgU3BsaXRKb2luVmlld1BvbGljeTogU3BsaXRKb2luVmlld1BvbGljeS5Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIFNhdmVTdGF0ZVBvbGljeTogU2F2ZVN0YXRlUG9saWN5LlBvbGljeVxuICAgICAgICAgICAgICAgIH1cbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2Lm9yZ2FuaXphdGlvbnMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5vcmdhbml6YXRpb25zLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdvcmdhbml6YXRpb25zL29yZ2FuaXphdGlvbmNyZWF0ZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdPcmdhbml6YXRpb25DcmVhdGVDdHJsIGFzIG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdPcmdhbml6YXRpb25DcmVhdGVDdHJsJywgWyckc3RhdGUnLCAnT3JnYW5pemF0aW9uc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCBPcmdhbml6YXRpb25zTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBvcmdhbml6YXRpb25DcmVhdGVDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Pcmdhbml6YXRpb25zKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5vcmdhbml6YXRpb25zLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxDcmVhdGluZygpIHtcbiAgICAgICAgICAgIHJldHVyblRvT3JnYW5pemF0aW9ucygpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZU9yZ2FuaXphdGlvbigpIHtcbiAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgaWYgKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybC5uZXdPcmdhbml6YXRpb24ua2V5ID0gb3JnYW5pemF0aW9uQ3JlYXRlQ3RybC5uZXdPcmdhbml6YXRpb24udGVuYW50TmFtZTtcbiAgICAgICAgICAgICAgICBPcmdhbml6YXRpb25zTW9kZWwuY3JlYXRlKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwubmV3T3JnYW5pemF0aW9uKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25DcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9Pcmdhbml6YXRpb25zKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25DcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmVzZXRGb3JtKCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25DcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25DcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwubmV3T3JnYW5pemF0aW9uID0ge1xuICAgICAgICAgICAgICAgIHRlbmFudE5hbWU6ICcnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwuY3JlYXRlT3JnYW5pemF0aW9uID0gY3JlYXRlT3JnYW5pemF0aW9uO1xuICAgICAgICBvcmdhbml6YXRpb25DcmVhdGVDdHJsLmNhbmNlbENyZWF0aW5nID0gY2FuY2VsQ3JlYXRpbmc7XG4gICAgICAgIHJlc2V0Rm9ybSgpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW9yZ2FuaXphdGlvbmNyZWF0ZWN0cmwuanMubWFwIiwiLyoqXG4gKiBUaGlzIHBvbGljeSBhZGRzIHRvb2x0aXAgZnVuY3Rpb25hbGl0eSB0byBub2RlcyBhbmQgbGlua3MuXG4gKiBXaGVuIGluc3RhbGxpbmcsIGluc3RhbGwgb24gYm90aCBsaW5rcyBhbmQgbm9kZXMuXG4gKiBcbiAqIFVzZXMgdGhlIHFUaXAgalF1ZXJ5IHBsdWdpblxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnUVRpcFBvbGljeScsIFsnUG9saWN5JywgZnVuY3Rpb24gKFBvbGljeSkge1xuICAgICAgICBjbGFzcyBRVGlwUG9saWN5IGV4dGVuZHMgUG9saWN5LlBvbGljeSB7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgICAgICAgICAgc3VwZXIoXCJRVGlwUG9saWN5XCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAgICAgKiBNb2RpZmllcyB0aGUgdXBkYXRlTmV3Tm9kZXMgYW5kIFxuICAgICAgICAgICAgICogdXBkYXRlTmV3UGF0aHMgbWV0aG9kIG9mIHRoZSBncmFwaCB0byBpbnN0YWxsIHF0aXBcbiAgICAgICAgICAgICAqIG9udG8gZWFjaCBub2RlIGFuZCBwYXRoLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoIGl0IGlzIFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YWxsZWQgb25cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5pdGlhbGl6ZShncmFwaCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3VwZXIuaW5pdGlhbGl6ZShncmFwaCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuUVRpcFBvbGljeSA9IHt9O1xuXG4gICAgICAgICAgICAgICAgc3RhdGUubW91c2Vkb3duID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICBncmFwaC5jb25zdHMuUVRpcFBvbGljeSA9IHt9O1xuXG4gICAgICAgICAgICAgICAgLy9UcmFja2luZyBtb3VzZSBjbGljayBzdGF0ZSB0byBtYWtlIHRvb2x0aXBcbiAgICAgICAgICAgICAgICAvL2Rpc2FwcGVhciBpZiB0aGUgbm9kZSBpcyBiZWluZyBkcmFnZ2VkLlxuICAgICAgICAgICAgICAgICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykubW91c2V1cChmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLm1vdXNldXAgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vb3ZlcnJpZGUgdXBkYXRlTmV3Tm9kZXMgYW5kIHVwZGF0ZU5ld1BhdGhzXG4gICAgICAgICAgICAgICAgLy90byBpbnN0YWxsIHF0aXBcbiAgICAgICAgICAgICAgICB2YXIgZ3JhcGhVcGRhdGVOZXdOb2RlcyA9IGdyYXBoLnVwZGF0ZU5ld05vZGVzO1xuICAgICAgICAgICAgICAgIGdyYXBoLnVwZGF0ZU5ld05vZGVzID0gZnVuY3Rpb24obmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGhVcGRhdGVOZXdOb2Rlcy5jYWxsKGdyYXBoLCBuZXdOb2Rlcyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kudXBkYXRlTmV3Tm9kZXMobmV3Tm9kZXMpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB2YXIgZ3JhcGhVcGRhdGVOZXdQYXRocyA9IGdyYXBoLnVwZGF0ZU5ld1BhdGhzO1xuICAgICAgICAgICAgICAgIGdyYXBoLnVwZGF0ZU5ld1BhdGhzID0gZnVuY3Rpb24obmV3UGF0aHMpIHtcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGhVcGRhdGVOZXdQYXRocy5jYWxsKGdyYXBoLCBuZXdQYXRocyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kudXBkYXRlTmV3UGF0aHMobmV3UGF0aHMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmVzIGFsbCBxVGlwcyBmcm9tIHRoZSBET00uXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgcG9saWN5IGlzIHVuaW5zdGFsbGVkIG9yXG4gICAgICAgICAgICAgKiB0aGUgZ3JhcGggaXMgZGVzdHJveWVkLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkZXN0cm95KCkge1xuICAgICAgICAgICAgICAgIC8vcmVtb3ZpbmcgYWxsIHF0aXAgZnJvbSBET01cbiAgICAgICAgICAgICAgICAkKCdbaWRePVwicXRpcFwiXScpLnJlbW92ZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEtlZXBpbmcgdHJhY2sgb2YgbW91c2Vkb3duIHN0YXRlXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzT2JqZWN0fSAgZDNvYmogIFRoZSBkMyBwYmplY3RcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlL0xpbmt9ICBkICAgICBUaGUgbWF0Y2hpbmcgZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgbW91c2Vkb3duKGQzb2JqLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlFUaXBQb2xpY3k7XG4gICAgICAgICAgICAgICAgc3RhdGUubW91c2Vkb3duID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBLZWVwaW5nIHRyYWNrIG9mIG1vdXNlZG93biBzdGF0ZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM09iamVjdH0gIGQzb2JqICBUaGUgZDMgcGJqZWN0XG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZS9MaW5rfSAgZCAgICAgVGhlIG1hdGNoaW5nIGRhdGEgb2JqZWN0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIG1vdXNldXAoZDNvYmosIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuUVRpcFBvbGljeTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5tb3VzZWRvd24gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgd2hlblFUaXBBdmFpbGFibGUoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIGludGVydmFsID0gNTAwOyAvLyBtc1xuICAgICAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJChkb2N1bWVudCkucXRpcCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQodGhpc1BvbGljeS53aGVuUVRpcEF2YWlsYWJsZShjYWxsYmFjayksIGludGVydmFsKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIGludGVydmFsKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiBOZXcgTm9kZXMgYXJlIGFkZGVkIGR1cmluZyB0aGVcbiAgICAgICAgICAgICAqIHVwZGF0ZSBncmFwaCBmdW5jdGlvblxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM05vZGV9ICBuZXdOb2RlcyAgVGhlIG5ldyBub2RlcyB0aGF0IGFyZVxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZWluZyBhZGRlZCB0byB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlTmV3Tm9kZXMobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuUVRpcFBvbGljeTtcblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGF0dGFjaFFUaXAoKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vYXR0YWNoaW5nIHF0aXBcbiAgICAgICAgICAgICAgICAgICAgbmV3Tm9kZXMuZWFjaChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGhpc05vZGUgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy9JZiBub2RlIGhhcyBjaGlsZHJlbiwgdGhlbiBpdCBpcyBhIHNlcnZpY2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbZC5pZF0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSBcIjxiPjx1PlNlbGVjdG9yczo8L2I+PC91PiBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0b3JNYXAgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5zZWxlY3RvcnNbZC5pZF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhhc0tleXMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gc2VsZWN0b3JNYXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzS2V5cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0ga2V5ICsgXCIgOiA8aT5cIisgc2VsZWN0b3JNYXBba2V5XSArIFwiPC9pPixcXG4gXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoYXNLZXlzID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbW1hIHdpbGwgYmUgcmVtb3ZlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gXCJObyBTZWxlY3RvcnMsIFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gXCI8Yj48dT5MYWJlbHM6PC9iPjwvdT4gXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxhYmVsc01hcCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmxhYmVsc1tkLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGFzS2V5cyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBsYWJlbHNNYXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzS2V5cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0ga2V5ICsgXCIgOiA8aT5cIisgbGFiZWxzTWFwW2tleV0gKyBcIjwvaT4sXFxuIFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFzS2V5cyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb21tYSB3aWxsIGJlIHJlbW92ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IFwiTm8gbGFiZWxzLCBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3JlbW92ZSBsYXN0IGNvbW1hXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gdGV4dC5zbGljZSgwLCAtMik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpc05vZGUpLnF0aXAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGQuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRleHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50czogeyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXBpID0gJCh0aGlzTm9kZSkucXRpcCgnYXBpJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gJCgnI2dyYXBoQ29udGFpbmVyJykub2Zmc2V0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9zaXRpb24gPSBbb2Zmc2V0LmxlZnQgKyAoKGQueCAqIHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCkpICsgdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKClbMF0pLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0LnRvcCArICgoZC55ICtkLnJhZGl1cykgKiB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpKSAgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKVsxXV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcGkuc2V0KCdwb3NpdGlvbi50YXJnZXQnLCBwb3NpdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIXN0YXRlLm1vdXNlZG93bjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxheTogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc29sbzogJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NlczogJ3F0aXAtYmx1ZSBxdGlwLXNoYWRvdydcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG15OiAndG9wIGNlbnRlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0OiAnYm90dG9tIGNlbnRlcidcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGFyZ2V0OiBwb3NpdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudDogJ21vdXNlZG93biBtb3VzZWxlYXZlJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL2luY2FzZSBsaWJyYXJ5IGhhc24ndCBsb2FkZWQgeWV0XG4gICAgICAgICAgICAgICAgaWYgKCQoZG9jdW1lbnQpLnF0aXAgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGF0dGFjaFFUaXAoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLndoZW5RVGlwQXZhaWxhYmxlKGF0dGFjaFFUaXApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiBuZXcgcGF0aHMgYXJlIGFkZGVkIGR1cmluZyB0aGVcbiAgICAgICAgICAgICAqIHVwZGF0ZSBncmFwaCBmdW5jdGlvblxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM1BhdGh9ICBuZXdQYXRocyAgVGhlIG5ldyBwYXRocyB0aGF0IGFyZVxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZWluZyBhZGRlZCB0byB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlTmV3UGF0aHMobmV3UGF0aHMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuUVRpcFBvbGljeTtcblxuICAgICAgICAgICAgICAgIC8vaW5jYXNlIGxpYnJhcnkgaGFzbid0IGxvYWRlZCB5ZXRcbiAgICAgICAgICAgICAgICBpZiAoJChkb2N1bWVudCkucXRpcCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9hZGRpbmcgcXRpcFxuICAgICAgICAgICAgICAgICAgICBuZXdQYXRocy5lYWNoKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aGlzUGF0aCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2dldHRpbmcgbWlkcG9pbnQgb2YgcGF0aFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhdGhFbCAgID0gZDMuc2VsZWN0KHRoaXMpLm5vZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtaWRwb2ludCA9IHBhdGhFbC5nZXRQb2ludEF0TGVuZ3RoKHBhdGhFbC5nZXRUb3RhbExlbmd0aCgpLzIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldFJldCA9IGQucXRpcEhlbHBlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSBcIkJ5dGVzOiBcIiArIGQuZ2V0V2VpZ2h0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXNQYXRoKS5xdGlwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRleHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vaWYgbW91c2UgaXMgZG93biwgZG9uJ3QgbGV0IHF0aXAgc2hvd1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICFzdGF0ZS5tb3VzZWRvd247XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3c6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsYXk6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvbG86ICQoJyNncmFwaENvbnRhaW5lcicpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc2VzOiAncXRpcC1ibHVlIHF0aXAtc2hhZG93J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXk6IHRhcmdldFJldC5teSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXQ6ICdjZW50ZXIgY2VudGVyJywgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogJ21vdXNlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRqdXN0OiB0YXJnZXRSZXQuYWRqdXN0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaWRlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50OiAnbW91c2Vkb3duIG1vdXNlbGVhdmUnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9ICAgXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgUG9saWN5OiBRVGlwUG9saWN5XG4gICAgICAgIH1cbn1dKTtcblxuXG5cblxuXG5cblxuXG4iLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2Lm9yZ2FuaXphdGlvbnMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5vcmdhbml6YXRpb25zLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdPcmdhbml6YXRpb25EZXRhaWxzQ3RybCBhcyBvcmdhbml6YXRpb25EZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ29yZ2FuaXphdGlvbnMvb3JnYW5pemF0aW9uZGV0YWlscy5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignT3JnYW5pemF0aW9uRGV0YWlsc0N0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnT3JnYW5pemF0aW9uc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIE9yZ2FuaXphdGlvbnNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Pcmdhbml6YXRpb25zKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5vcmdhbml6YXRpb25zLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBkZWxldGVPcmdhbml6YXRpb24oKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgT3JnYW5pemF0aW9uc01vZGVsLmRlbGV0ZShvcmdhbml6YXRpb25EZXRhaWxzQ3RybC5vcmdhbml6YXRpb24pLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIHJldHVyblRvT3JnYW5pemF0aW9ucygpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Iob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsKTtcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsKTtcbiAgICAgICAgT3JnYW5pemF0aW9uc01vZGVsLmdldE1vZGVsQnlLZXkoJHN0YXRlUGFyYW1zLmtleSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChvcmdhbml6YXRpb24pIHtcbiAgICAgICAgICAgIG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsLm9yZ2FuaXphdGlvbiA9IG9yZ2FuaXphdGlvbjtcbiAgICAgICAgfSk7XG4gICAgICAgIG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsLmRlbGV0ZU9yZ2FuaXphdGlvbiA9IGRlbGV0ZU9yZ2FuaXphdGlvbjtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1vcmdhbml6YXRpb25kZXRhaWxzY3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDYvMS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zdG9yYWdlcG9saWNpZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMuY3JlYXRlJywge1xuICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvc3RvcmFnZXBvbGljeWNyZWF0ZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCBhcyBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1N0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ1N0b3JhZ2VQb2xpY2llc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIFN0b3JhZ2VQb2xpY2llc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1N0b3JhZ2VQb2xpY2llcygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxDcmVhdGluZygpIHtcbiAgICAgICAgICAgIHJldHVyblRvU3RvcmFnZVBvbGljaWVzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlRmlsZXN5c3RlbUNtZHMoKSB7XG4gICAgICAgICAgICBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5maWxlc3lzdGVtY21kcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwubmV3U3RvcmFnZVBvbGljeS5maWxlc3lzdGVtc1tpdGVtLm5hbWVdID0gaXRlbS52YWx1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZVBvbGljeSgpIHtcbiAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgaWYgKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgY3JlYXRlRmlsZXN5c3RlbUNtZHMoKTtcbiAgICAgICAgICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbC5jcmVhdGUoc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwubmV3U3RvcmFnZVBvbGljeSlcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9TdG9yYWdlUG9saWNpZXMoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJlc2V0Rm9ybSgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLm5ld1N0b3JhZ2VQb2xpY3kgPSB7XG4gICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgXCJiYWNrZW5kc1wiOiB7XG4gICAgICAgICAgICAgICAgICAgIFwiY3J1ZFwiOiBcImNlcGhcIixcbiAgICAgICAgICAgICAgICAgICAgXCJtb3VudFwiOiBcImNlcGhcIixcbiAgICAgICAgICAgICAgICAgICAgXCJzbmFwc2hvdFwiOiBcImNlcGhcIlxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXCJ1bmxvY2tlZFwiOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBcImRyaXZlclwiOiB7XG4gICAgICAgICAgICAgICAgICAgIFwicG9vbFwiOiBcInJiZFwiXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBcImNyZWF0ZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgIFwic2l6ZVwiOiBcIjBcIixcbiAgICAgICAgICAgICAgICAgICAgXCJmaWxlc3lzdGVtXCI6IFwiXCJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFwicnVudGltZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgIFwic25hcHNob3RzXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIFwic25hcHNob3RcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJmcmVxdWVuY3lcIjogXCIzMG1cIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwia2VlcFwiOiAyMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBcInJhdGUtbGltaXRcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJ3cml0ZS1pb3BzXCI6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJlYWQtaW9wc1wiOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ3cml0ZS1icHNcIjogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVhZC1icHNcIjogMFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBcImZpbGVzeXN0ZW1zXCI6IHt9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLmNyZWF0ZVBvbGljeSA9IGNyZWF0ZVBvbGljeTtcbiAgICAgICAgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwuY2FuY2VsQ3JlYXRpbmcgPSBjYW5jZWxDcmVhdGluZztcbiAgICAgICAgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwuZmlsZXN5c3RlbWNtZHMgPSBbXTtcbiAgICAgICAgcmVzZXRGb3JtKCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3RvcmFnZXBvbGljeWNyZWF0ZWN0cmwuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzI3LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnN0b3JhZ2Vwb2xpY2llcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU3RvcmFnZVBvbGljeURldGFpbHNDdHJsIGFzIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvc3RvcmFnZXBvbGljeWRldGFpbHMuaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmVkaXQnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwgYXMgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9zdG9yYWdlcG9saWN5ZGV0YWlscy5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignU3RvcmFnZVBvbGljeURldGFpbHNDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdTdG9yYWdlUG9saWNpZXNNb2RlbCcsICdWb2x1bWVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIFN0b3JhZ2VQb2xpY2llc01vZGVsLCBWb2x1bWVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwgPSB0aGlzO1xuICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwuZmlsZXN5c3RlbWNtZHMgPSBbXTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRvIHNob3cgZWRpdCBvciBkZXRhaWxzIHNjcmVlbiBiYXNlZCBvbiB0aGUgcm91dGVcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHNldE1vZGUoKSB7XG4gICAgICAgICAgICBpZiAoJHN0YXRlLmlzKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMuZWRpdCcpKSB7XG4gICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLm1vZGUgPSAnZWRpdCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwubW9kZSA9ICdkZXRhaWxzJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1BvbGljaWVzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMubGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvUG9saWN5RGV0YWlscygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmRldGFpbHMnLCB7ICdrZXknOiBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5Lm5hbWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsRWRpdGluZygpIHtcbiAgICAgICAgICAgIHJldHVyblRvUG9saWN5RGV0YWlscygpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGRlbGV0ZVBvbGljeSgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIFN0b3JhZ2VQb2xpY2llc01vZGVsLmRlbGV0ZVVzaW5nS2V5KHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kubmFtZSwgJ25hbWUnKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9Qb2xpY2llcygpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZXQgdm9sdW1lcyBiZWxvbmdpbmcgdG8gYSBwb2xpY3lcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGdldFZvbHVtZXMocmVsb2FkKSB7XG4gICAgICAgICAgICBWb2x1bWVzTW9kZWwuZ2V0KHJlbG9hZCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnZvbHVtZXMgPSAkZmlsdGVyKCdvcmRlckJ5JykoXy5maWx0ZXIocmVzdWx0LCB7XG4gICAgICAgICAgICAgICAgICAgICdwb2xpY3knOiBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5Lm5hbWVcbiAgICAgICAgICAgICAgICB9KSwgJ25hbWUnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGluaXRpYWxpemVGaWxlc3lzdGVtQ21kc0FycmF5KCkge1xuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kuZmlsZXN5c3RlbXMsIGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wdXNoKHsgbmFtZToga2V5LCB2YWx1ZTogdmFsdWUgfSk7XG4gICAgICAgICAgICB9LCBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwuZmlsZXN5c3RlbWNtZHMpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUZpbGVzeXN0ZW1DbWRzKCkge1xuICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmZpbGVzeXN0ZW1jbWRzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5LmZpbGVzeXN0ZW1zW2l0ZW0ubmFtZV0gPSBpdGVtLnZhbHVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gc2F2ZVBvbGljeSgpIHtcbiAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgaWYgKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgY3JlYXRlRmlsZXN5c3RlbUNtZHMoKTtcbiAgICAgICAgICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbC5zYXZlKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvUG9saWN5RGV0YWlscygpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbC5nZXRNb2RlbEJ5S2V5KCRzdGF0ZVBhcmFtcy5rZXksIGZhbHNlLCAnbmFtZScpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5ID0gcG9saWN5O1xuICAgICAgICAgICAgaW5pdGlhbGl6ZUZpbGVzeXN0ZW1DbWRzQXJyYXkoKTtcbiAgICAgICAgICAgIGdldFZvbHVtZXMoZmFsc2UpO1xuICAgICAgICB9KTtcbiAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmRlbGV0ZVBvbGljeSA9IGRlbGV0ZVBvbGljeTtcbiAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnNhdmVQb2xpY3kgPSBzYXZlUG9saWN5O1xuICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwuY2FuY2VsRWRpdGluZyA9IGNhbmNlbEVkaXRpbmc7XG4gICAgICAgIHNldE1vZGUoKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0b3JlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0Vm9sdW1lcyh0cnVlKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXN0b3JhZ2Vwb2xpY3lkZXRhaWxzY3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDYvMi8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoXCJjb250aXYuc3RvcmFnZXBvbGljaWVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dlN0b3JhZ2Vwb2xpY3liYXNpY3NldHRpbmdzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge307XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZTdG9yYWdlcG9saWN5ZmlsZXN5c3RlbXNldHRpbmdzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgcG9saWN5OiAnPScsXG4gICAgICAgICAgICBmaWxlc3lzdGVtY21kczogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSkge1xuICAgICAgICAgICAgc2NvcGUuZmlsZXN5c3RlbXMgPSBbJ2V4dDQnLCAnYnRyZnMnXTtcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL2ZpbGVzeXN0ZW1zZXR0aW5ncy5odG1sJ1xuICAgIH07XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZTdG9yYWdlcG9saWN5c25hcHNob3RzZXR0aW5nc1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIHBvbGljeTogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9zbmFwc2hvdHNldHRpbmdzLmh0bWwnXG4gICAgfTtcbn0pXG4gICAgLmRpcmVjdGl2ZShcImN0dlN0b3JhZ2Vwb2xpY3lyd29wc3NldHRpbmdzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgcG9saWN5OiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL3J3b3Bzc2V0dGluZ3MuaHRtbCdcbiAgICB9O1xufSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2U3RvcmFnZXBvbGljeWJhY2tlbmRkcml2ZXJzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgcG9saWN5OiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL2JhY2tlbmRkcml2ZXJzLmh0bWwnXG4gICAgfTtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3RvcmFnZXBvbGljeWRpcmVjdGl2ZS5qcy5tYXAiLCIvKipcbiAqIFRoaXMgcG9saWN5IHByb3ZpZGVzIGEgd2F5IGZvciBwcm9wZXJ0aWVzIHRvIGJlIHNhdmVkIFxuICogYmV0d2VlbiB2aWV3IGNoYW5nZXNcbiAqIFxuICogSXQgbW9kaWZpZXMgdGhlIGRlc3Ryb3kgZnVuY3Rpb24gdG8gYWxzbyBwYXNzIGluIGFuIG9iamVjdCB0aGF0XG4gKiB3aWxsIGhhdmUgYWxsIGl0cyBwcm9wZXJ0aWVzIHNhdmVkIGFuZCB3aWxsIGJlIGF2YWlsYWJsZSBcbiAqIG9uIGdyYXBoIGxvYWQuIFdoZW4gc2F2aW5nIHZhcmlhYmxlcyB0byB0aGUgb2JqZWN0LCBuYW1lc3BhY2Ugd2l0aFxuICogdGhlIHBvbGljeSBuYW1lLlxuICogXG4gKiBUaGlzIHBvbGljeSBtdXN0IGJlIGxvYWRlZCBmaXJzdCBpbiBvcmRlciBmb3IgaXQgc2F2ZWQgdmFyaWFibGVzIFxuICogdG8gYmUgbG9hZGVkIHdoZW4gdGhlIHZpZXcgY29tZXMgYmFjayB0byB0aGUgZ3JhcGhcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ1NhdmVTdGF0ZVBvbGljeScsIFsnUG9saWN5JywgZnVuY3Rpb24gKFBvbGljeSkge1xuICAgIFx0Y2xhc3MgU2F2ZVN0YXRlUG9saWN5IGV4dGVuZHMgUG9saWN5LlBvbGljeSB7XG4gICAgXHRcdFxuICAgIFx0XHQvKipcbiAgICBcdFx0ICogVGFrZXMgaW4gdGhlIGFuZ3VsYXIgc2VydmljZSB0byB3aGljaCBpdCB3aWxsXG4gICAgXHRcdCAqIHNhdmUgaXQncyBwcm9wZXJ0aWVzIHRvLlxuICAgIFx0XHQgKlxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgc2F2ZWRTdGF0ZSAgT2JqZWN0IHRvIHNhdmUgXG4gICAgXHRcdCAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzIHRvXG4gICAgXHRcdCAqL1xuICAgIFx0XHRjb25zdHJ1Y3RvcihzYXZlZFN0YXRlKSB7XG4gICAgXHRcdFx0c3VwZXIoJ1NhdmVTdGF0ZVBvbGljeScpO1xuICAgIFx0XHRcdHRoaXMuc2F2ZWRTdGF0ZSA9IHNhdmVkU3RhdGU7XG4gICAgXHRcdH1cblxuICAgIFx0XHQvKipcbiAgICBcdFx0ICogQ2FsbGVkIHdoZW4gdGhlIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICBcdFx0ICogTW9kaWZpZXMgdGhlIGRlc3Ryb3kgbWV0aG9kIFxuICAgIFx0XHQgKiBhbmQgYWRkcyBhIGxvYWQgbWV0aG9kIHRvIHRoZSBncmFwaFxuICAgIFx0XHQgKlxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaCBpdCBpcyBcbiAgICBcdFx0ICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YWxsZWQgb25cbiAgICBcdFx0ICovXG4gICAgXHRcdGluaXRpYWxpemUoZ3JhcGgpIHtcbiAgICBcdFx0XHR0aGlzLmdyYXBoID0gZ3JhcGg7XG4gICAgXHRcdFx0dmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgIFx0XHRcdGdyYXBoLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcbiAgICBcdFx0XHRcdHRoaXNQb2xpY3kuZ3JhcGhEZXN0cm95LmNhbGwoZ3JhcGgsIHRoaXNQb2xpY3kuc2F2ZWRTdGF0ZSk7XG4gICAgXHRcdFx0fTtcblxuICAgIFx0XHRcdGdyYXBoLmxvYWQgPSBmdW5jdGlvbihzYXZlZFN0YXRlKSB7XG4gICAgXHRcdFx0XHR0aGlzUG9saWN5LmdyYXBoTG9hZC5jYWxsKGdyYXBoLCBzYXZlZFN0YXRlKTtcbiAgICBcdFx0XHR9XG4gICAgXHRcdH1cblxuICAgIFx0XHQvKipcbiAgICBcdFx0ICogV2lsbCBvdmVycmlkZSB0aGUgZ3JhcGgncyBkZWZhdWx0IGRlc3Ryb3ksIHdpdGggXG4gICAgXHRcdCAqIHRoaXMgcG9saWN5J3Mgc2F2ZWRTdGF0ZSBwYXNzZWQgaW4uXG4gICAgXHRcdCAqIENhbGxlZCB3aXRoIHRoaXMgYXMgdGhlIGdyYXBoXG4gICAgXHRcdCAqXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBzYXZlZFN0YXRlICBUaGUgc2F2ZWQgc3RhdGVcbiAgICBcdFx0ICovXG4gICAgXHRcdGdyYXBoRGVzdHJveShzYXZlZFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KHNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KHNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzR3JhcGguYmluZGluZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgJCh3aW5kb3cpLm9mZihrZXksIHRoaXNHcmFwaC5iaW5kaW5nc1trZXldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2lsbCBiZSBjYWxsZWQgd2l0aCB0aGUgZ3JhcGggYXMgdGhpc1xuICAgICAgICAgICAgICogVXNlZCB0byBoYXZlIGFsbCBvdGhlciBwb2xpY2llcyB1c2UgdGhlIGxvYWQgc3RhdGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgc2F2ZWRTdGF0ZSAgVGhlIHNhdmVkIHN0YXRlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGdyYXBoTG9hZChzYXZlZFN0YXRlKSB7XG4gICAgICAgICAgICBcdHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICBcdGlmIChwb2xpY3kubG9hZCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIFx0cG9saWN5LmxvYWQoc2F2ZWRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgIFx0fVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgIFx0aWYgKHBvbGljeS5sb2FkICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgXHRwb2xpY3kubG9hZChzYXZlZFN0YXRlKTtcbiAgICAgICAgICAgICAgICAgXHR9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgXHR9XG4gICAgXHRyZXR1cm4ge1xuICAgIFx0XHRQb2xpY3k6IFNhdmVTdGF0ZVBvbGljeVxuICAgIFx0fVxufV0pO1xuXG5cblxuXG5cblxuXG4iLCJcblxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52aXN1YWxpemF0aW9uJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUudmlzdWFsaXphdGlvbi5lZGdlJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9lZGdlL3tzb3VyY2VOYW1lLCB0YXJnZXROYW1lLCBzb3VyY2VMaXN0LCB0YXJnZXRMaXN0fScsXG4gICAgICAgICAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZU5hbWU6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldE5hbWU6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZUxpc3Q6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldExpc3Q6IG51bGxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWaXN1YWxpemF0aW9uRWRnZUN0cmwgYXMgdmlzdWFsaXphdGlvbmVkZ2VDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Zpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbmVkZ2UuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignVmlzdWFsaXphdGlvbkVkZ2VDdHJsJywgW1wiJHNjb3BlXCIsIFwiJGh0dHBcIiwgJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnVmlzdWFsaXphdGlvblNlcnZpY2UnLCAnJGludGVydmFsJyxcbiAgICAgICAgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJHN0YXRlLCAkc3RhdGVQYXJhbXMsIFZpc3VhbGl6YXRpb25TZXJ2aWNlLCAkaW50ZXJ2YWwpIHtcbiAgICAgICAgICAgIHZhciBzb3VyY2VOYW1lID0gJHN0YXRlUGFyYW1zLnNvdXJjZU5hbWU7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0TmFtZSA9ICRzdGF0ZVBhcmFtcy50YXJnZXROYW1lO1xuICAgICAgICAgICAgdmFyIHNvdXJjZUxpc3QgPSAkc3RhdGVQYXJhbXMuc291cmNlTGlzdDtcbiAgICAgICAgICAgIHZhciB0YXJnZXRMaXN0ID0gJHN0YXRlUGFyYW1zLnRhcmdldExpc3Q7XG5cbiAgICAgICAgICAgIC8vSWYgdGhlIHBhZ2UgaXMgcmVsb2FkZWQsIHRoZXNlIHN0YXRlIHBhcmFtcyBhcmUgYWxsIG51bGwsXG4gICAgICAgICAgICAvL3NvIGl0IHdpbGwgcm91dGUgdGhlbSBiYWNrIHRvIHRoZSB2aXN1YWxpemF0aW9uIHRhYiB0b3Agdmlld1xuICAgICAgICAgICAgaWYgKHNvdXJjZUxpc3QgPT0gbnVsbCB8fCB0YXJnZXRMaXN0ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZpc3VhbGl6YXRpb24ubGlzdCcpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgdmFyIHQgPSBkLmdldFNlY29uZHMoKTtcbiAgICAgICAgICAgICRzY29wZS5lZGdlRGF0YUludGVydmFsID0gXG4gICAgICAgICAgICAgICAgJGludGVydmFsKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBWaXN1YWxpemF0aW9uU2VydmljZS5nZXRFZGdlRGF0YShzb3VyY2VMaXN0LCB0YXJnZXRMaXN0LCB0LnRvU3RyaW5nKCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSByZXN1bHQucmVzdWx0cztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHJlc3VsdHMsIGZ1bmN0aW9uKHIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF8uaXNFbXB0eShyKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgKz0gci5zZXJpZXNbMF0udmFsdWVzWzBdWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNvdXJjZU5hbWUgPSBzb3VyY2VOYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS50YXJnZXROYW1lID0gdGFyZ2V0TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZWRnZURhdGEgPSBkYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5lZGdlRGF0YVRpbWUgPSB0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9LCAzMDAwKTtcblxuICAgICAgICAgICAgLy9EZXN0cm95aW5nIHRoZSBpbnRlcnZhbCBmdW5jdGlvbiBvbiByb3V0ZSBjaGFuZ2VcbiAgICAgICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkgeyAkaW50ZXJ2YWwuY2FuY2VsKCRzY29wZS5lZGdlRGF0YUludGVydmFsKTsgfSk7XG5cblxuICAgICAgICAgICAgVmlzdWFsaXphdGlvblNlcnZpY2UuZ2V0T2xkRWRnZURhdGEoc291cmNlTGlzdCwgdGFyZ2V0TGlzdClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHRzID0gcmVzdWx0LnJlc3VsdHM7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlZGdlRGF0YSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAvL3Jlc3VsdHMsIGlmIG5vdCBlbXB0eSwgYXJlIGV4cGVjdGVkIHRvIGhhdmVcbiAgICAgICAgICAgICAgICAgICAgLy82IGRhdGEgZW50cmllc1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2gocmVzdWx0cywgZnVuY3Rpb24ocikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF8uaXNFbXB0eShyKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHIuc2VyaWVzWzBdLnZhbHVlcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoXy5pc0VtcHR5KGVkZ2VEYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goZGF0YSwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRnZURhdGEucHVzaChkWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goZGF0YSwgZnVuY3Rpb24oZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRnZURhdGFbaV0gKz0gZFsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zb3VyY2VOYW1lID0gc291cmNlTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRhcmdldE5hbWUgPSB0YXJnZXROYW1lO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlTGlzdCA9IHNvdXJjZUxpc3Q7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50YXJnZXRMaXN0ID0gdGFyZ2V0TGlzdDtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm9sZEVkZ2VEYXRhID0gZWRnZURhdGE7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICB9XSk7XG5cblxuXG5cbiIsIi8qKlxuICogVGhpcyBwb2xpY3kgaXMgdXNlZCBmb3Igc3BsaXR0aW5nIGEgbm9kZSBpbnRvIGl0cyBjaGlsZHJlbixcbiAqIGFuZCBqb2luaW5nIHRoZW0gYmFjayB0byB0aGVpciBwYXJlbnQuXG4gKiBTcGxpdHMgb24gZG91YmxlIGNsaWNrLCBhbmQgam9pbnMgb24gcmlnaHQgY2xpY2suXG4gKiBJZiBtdWx0aXBsZSBub2RlcyBhcmUgc2VsZWN0ZWQgYXQgdGhlIHRpbWUgb2YgYSBzcGxpdCBvciBqb2luIGV2ZW50LFxuICogaXQgd2lsbCBzcGxpdCBvciBqb2luIGFsbCBvZiB0aGVtLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnU3BsaXRKb2luTm9kZVBvbGljeScsIFsnTm9kZVNlbGVjdGlvblBvbGljeScsICdWaXN1YWxpemVyTm9kZScsIFxuICAgIFx0XHRmdW5jdGlvbiAoTm9kZVNlbGVjdGlvblBvbGljeSwgVmlzdWFsaXplck5vZGUpIHtcblx0XHRjbGFzcyBTcGxpdEpvaW5Ob2RlUG9saWN5IGV4dGVuZHMgTm9kZVNlbGVjdGlvblBvbGljeS5Qb2xpY3kge1xuXHRcdFx0LyoqXG5cdFx0XHQgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG5cdFx0XHQgKi9cbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAgICAgICAgIHN1cGVyKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wb2xpY3lOYW1lID0gXCJTcGxpdEpvaW5Ob2RlUG9saWN5XCI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gcG9saWN5IGlzIGluc3RhbGxlZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluaXRpYWxpemUoZ3JhcGgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHN1cGVyLmluaXRpYWxpemUoZ3JhcGgpO1xuICAgICAgICAgICAgICAgIHZhciBzdGF0ZSA9IGdyYXBoLnN0YXRlLlNwbGl0Sm9pbk5vZGVQb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zcGxpdE5vZGVzID0gW107IFxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRyaWdnZXJpbmcgc3BsaXQgb24gZG91YmxlIGNsaWNrXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGQgICAgICBUaGUgbWF0Y2hpbmcgZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZGJsY2xpY2soZDNub2RlLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN1cGVyU3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luTm9kZVBvbGljeTtcblxuICAgICAgICAgICAgICAgIGlmICghZDMuZXZlbnQuY3RybEtleSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3VwZXJTdGF0ZS5zZWxlY3RlZE5vZGVzLmluZGV4T2YoZCkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGxpdE11bHRpcGxlTm9kZXMoc3VwZXJTdGF0ZS5zZWxlY3RlZE5vZGVzKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQWxsU2VsZWN0ZWROb2RlcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGxpdE5vZGUoZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVHJpZ2dlcmluZyBqb2luIG9uIHJpZ2h0IGNsaWNrXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqfSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGQgICAgICBUaGUgbWF0Y2hpbmcgZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgY29udGV4dG1lbnUoZDNub2RlLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN1cGVyU3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeTtcbiAgICAgICAgICAgICAgICBkMy5ldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIGlmICghZDMuZXZlbnQuY3RybEtleSkge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIHRyeSB0byBqb2luIGEgaGlnaGxpZ2h0ZWQgbm9kZSB3aGlsZSBtdWx0aXBsZSBub2RlcyBhcmUgc2VsZWN0ZWQsXG4gICAgICAgICAgICAgICAgICAgIC8vd2Ugam9pbiBhbGwgaGlnaGxpZ2h0ZWQgbm9kZXNcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGVjdGVkTm9kZXMgPSBzdXBlclN0YXRlLnNlbGVjdGVkTm9kZXM7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZE5vZGVzLmluZGV4T2YoZCkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxlY3RlZE5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5qb2luTm9kZShzZWxlY3RlZE5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vaWYgd2UgdHJ5IHRvIGpvaW4gYSBub2RlIHRoYXQgaXNuJ3QgcGFydCBvZiBhIGhpZ2hsaWdodCxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vd2UgcmVtb3ZlIGFsbCBoaWdobGlnaHRzIGFuZCB0aGVuIGpvaW4gdGhlIGNsaWNrZWQgbm9kZVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVBbGxTZWxlY3RlZE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmpvaW5Ob2RlKGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNwbGl0cyBhIG5vZGUuXG4gICAgICAgICAgICAgKiB1c2VkIHRvIHNoYXJlIGNvZGUgYmV0d2VlbiBzcGxpdE5vZGUgYW5kIHNwbGl0TXVsdGlwbGVOb2Rlc1xuICAgICAgICAgICAgICogd2hpbGUgcHJldmVudGluZyB0aGUgaGFuZGxlcnMgZm9yIHRoZW0gYm90aCBmaXJpbmdcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBub2RlICAgIFRoZSBub2RlIGJlaW5nIHNwbGl0XG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7QXJyYXl9ICBUaGUgbmV3IG5vZGVzIGNyZWF0ZWQgYnkgdGhlIHNwbGl0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIF9fc3BsaXROb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luTm9kZVBvbGljeTtcbiAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IG5vZGUuaWQ7XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICAvL2lmIGl0IGhhcyBubyBjaGlsZHJlbiB0byBzcGxpdCBpbnRvXG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkcmVuX3N0cnVjdFtuYW1lXSA9PT0gdW5kZWZpbmVkIHx8IF8uaXNFbXB0eShjaGlsZHJlbl9zdHJ1Y3RbbmFtZV0pKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3JlbW92aW5nIHRoZSBub2RlIGZyb20gdGhlIGxpc3Qgb2Ygbm9kZXNcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMgPSBfLmZpbHRlcih0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uKGdyYXBoTm9kZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdyYXBoTm9kZXMgIT0gbm9kZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzR3JhcGgubm9kZXMpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zcGxpY2VMaW5rc0Zvck5vZGUobm9kZSk7XG5cbiAgICAgICAgICAgICAgICAvL2dldHRpbmcgYWxsIHRoZSBub2RlIGlkJ3MgZm9yIGZpbmRpbmcgZmxvd1xuICAgICAgICAgICAgICAgIHZhciBub2RlX25hbWVzX3NldCA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpc0dyYXBoLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVfbmFtZXNfc2V0LnB1c2godGhpc0dyYXBoLm5vZGVzW2ldLmlkKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3NldCBvZiBub2RlcyBhZnRlciB0aGUgc3BsaXRcbiAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGVzID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGlsZHJlbl9zdHJ1Y3RbbmFtZV0ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZV9uYW1lc19zZXQucHVzaChjaGlsZHJlbl9zdHJ1Y3RbbmFtZV1baV0pO1xuICAgICAgICAgICAgICAgICAgICBuZXdfbm9kZXMucHVzaChjaGlsZHJlbl9zdHJ1Y3RbbmFtZV1baV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcmV0RGF0YSA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmdldEZsb3dCZXR3ZWVuU2V0KG5vZGVfbmFtZXNfc2V0KTtcblxuICAgICAgICAgICAgICAgIC8vZm9ybWF0dGluZyBkYXRhIGZvciBuZXcgbm9kZXNcbiAgICAgICAgICAgICAgICB2YXIgeExvYyA9IG5vZGUueDtcbiAgICAgICAgICAgICAgICB2YXIgeUxvYyA9IG5vZGUueTtcbiAgICAgICAgICAgICAgICB2YXIgYW5jZXN0b3JzID0gbm9kZS5hbmNlc3RvcnMuc2xpY2UoKTtcbiAgICAgICAgICAgICAgICAvL2tlZXBpbmcgb3JkZXJpbmcgdGhhdCBmaXJzdCBpbiBhbmNlc3RvciBsaXN0IGlzIGNsb3Nlc3QgaW4gcmVsYXRpb25zaGlwXG4gICAgICAgICAgICAgICAgYW5jZXN0b3JzLnNwbGljZSgwLCAwLCBub2RlLmlkKTtcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gbm9kZS5pZDtcbiAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGVfb2JqcyA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciByYWRpdXMgPSBub2RlLnJhZGl1cyAqIHRoaXNHcmFwaC5jb25zdHMucmFkaXVzRGVjYXk7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVEYXRhID0gcmV0RGF0YS5ub2RlRGF0YTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVEYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vY2FsY3VsYXRpbmcgd2hpY2ggb2YgdGhlIG5vZGVzIGluIHJldERhdGFbMF0gYXJlIG5ld1xuICAgICAgICAgICAgICAgICAgICBpZiAobmV3X25vZGVzLmluZGV4T2Yobm9kZURhdGFbaV0uaWQpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZCA9IG5vZGVEYXRhW2ldLmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSBub2RlRGF0YVtpXS50ZXh0O1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlID0gbmV3IFZpc3VhbGl6ZXJOb2RlLk5vZGUobnVsbCwgbnVsbCwgaWQsIHRleHQsIHJhZGl1cywgcGFyZW50LCBhbmNlc3RvcnMsIHhMb2MsIHlMb2MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3X25vZGUuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnB1c2gobmV3X25vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3X25vZGVfb2Jqcy5wdXNoKG5ld19ub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5wcm9jZXNzTGlua0RhdGEocmV0RGF0YS5saW5rRGF0YSwgdGhpc0dyYXBoLm5vZGVzKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXRMaW5rcygpO1xuXG4gICAgICAgICAgICAgICAgc3RhdGUuc3BsaXROb2Rlcy5wdXNoKG5vZGUuaWQpO1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXdfbm9kZV9vYmpzO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNwbGl0cyB0aGUgZ2l2ZSBub2RlXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBub2RlICAgIFRoZSBub2RlIGJlaW5nIHNwbGl0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNwbGl0Tm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlcyA9IHRoaXMuX19zcGxpdE5vZGUobm9kZSk7XG4gICAgICAgICAgICAgICAgaWYgKHJlcyA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5zcGxpdE5vZGVFdmVudChyZXMpO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU3BsaXRzIGFsbCB0aGUgbm9kZXMgcGFzc2VkIGluXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZXMgICBBcnJheSBvZiBub2RlcyB0byBiZSBzcGxpdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzcGxpdE11bHRpcGxlTm9kZXMobm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaDtcbiAgICAgICAgICAgICAgICB2YXIgcmVzTm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSB0aGlzLl9fc3BsaXROb2RlKG5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzTm9kZXMgPSByZXNOb2Rlcy5jb25jYXQocmVzKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLnNwbGl0TXVsdGlwbGVOb2Rlc0V2ZW50KHJlcyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIGFmdGVyIGEgc2luZ2xlIG5vZGUgaXMgc3BsaXRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBuZXdOb2RlcyAgVGhlIG5ldyBub2Rlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzcGxpdE5vZGVFdmVudChuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zZXRQb3NpdGlvbnMoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgYWZ0ZXIgbXVsdGlwbGUgbm9kZXMgYXJlIHNwbGl0IGF0IG9uY2VcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBuZXdOb2RlcyAgVGhlIG5ldyBub2Rlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzcGxpdE11bHRpcGxlTm9kZXNFdmVudChuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zZXRQb3NpdGlvbnMoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiB1c2VkIHRvIHNoYXJlIGNvZGUgYmV0d2VlbiBqb2luTm9kZSBhbmQgam9pbk11bHRpcGxlTm9kZVxuICAgICAgICAgICAgICogd2hpbGUgcHJldmVudGluZyBib3RoIGhhbmRsZXJzIGZpcmluZ1xuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gICAgICAgICAgbm9kZSAgICBUaGUgbm9kZSB0byBqb2luXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7Tm9kZX0gIFRoZSBuZXcgbm9kZSBhZnRlciB0aGUgam9pblxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBfX2pvaW5Ob2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luTm9kZVBvbGljeTtcblxuICAgICAgICAgICAgICAgIC8vY2hlY2sgdGhhdCBub2RlIHN0aWxsIGV4aXN0c1xuICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGgubm9kZXMuaW5kZXhPZihub2RlKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IG5vZGUuaWQ7XG4gICAgICAgICAgICAgICAgLy9pZiBpdCBoYXMgbm8gYW5jZXN0b3IsIG5vdGhpbmcgdG8gam9pblxuICAgICAgICAgICAgICAgIGlmIChjaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwuaW5kZXhPZihuYW1lKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgdG9fYmVfZGVsZXRlZCA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBub2RlX25hbWVzX3NldCA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpc0dyYXBoLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgbm9kZSB3b24ndCBiZSBjb2xsYXBzZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5ub2Rlc1tpXS5hbmNlc3RvcnMuaW5kZXhPZihub2RlLnBhcmVudCkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVfbmFtZXNfc2V0LnB1c2godGhpc0dyYXBoLm5vZGVzW2ldLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvX2JlX2RlbGV0ZWQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZV9pZCA9IG5vZGUucGFyZW50O1xuICAgICAgICAgICAgICAgIG5vZGVfbmFtZXNfc2V0LnB1c2gobm9kZS5wYXJlbnQpO1xuXG4gICAgICAgICAgICAgICAgLy9mb3JtYXR0aW5nIGRhdGFcbiAgICAgICAgICAgICAgICB2YXIgcmFkaXVzID0gbm9kZS5yYWRpdXMgLyB0aGlzR3JhcGguY29uc3RzLnJhZGl1c0RlY2F5OyBcbiAgICAgICAgICAgICAgICB2YXIgeExvYyA9IG5vZGUueDtcbiAgICAgICAgICAgICAgICB2YXIgeUxvYyA9IG5vZGUueTtcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gbm9kZS5hbmNlc3RvcnNbMV07XG4gICAgICAgICAgICAgICAgdmFyIGFuY2VzdG9ycyA9IG5vZGUuYW5jZXN0b3JzLnNsaWNlKDEpO1xuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZSA9IG5ldyBWaXN1YWxpemVyTm9kZS5Ob2RlKHhMb2MsIHlMb2MsIG5ld19ub2RlX2lkLCBuZXdfbm9kZV9pZCwgcmFkaXVzLCBwYXJlbnQsIGFuY2VzdG9ycyk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnB1c2gobmV3X25vZGUpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHJldERhdGEgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5nZXRGbG93QmV0d2VlblNldChub2RlX25hbWVzX3NldCk7XG4gICAgICAgICAgICAgICAgLy9yZW1vdmUgYWxsIG5vZGVzIHRoYXQgd2lsbCBiZSBqb2luZWRcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRvX2JlX2RlbGV0ZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVfdG9fZGVsZXRlID0gdG9fYmVfZGVsZXRlZFtpXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnNwbGljZSh0aGlzR3JhcGgubm9kZXMuaW5kZXhPZihub2RlX3RvX2RlbGV0ZSksIDEpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3BsaWNlTGlua3NGb3JOb2RlKG5vZGVfdG9fZGVsZXRlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UucHJvY2Vzc0xpbmtEYXRhKHJldERhdGEubGlua0RhdGEsIHRoaXNHcmFwaC5ub2Rlcyk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXROb2RlcygpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0TGlua3MoKTtcblxuICAgICAgICAgICAgICAgIHN0YXRlLnNwbGl0Tm9kZXMuc3BsaWNlKHN0YXRlLnNwbGl0Tm9kZXMuaW5kZXhPZihuZXdfbm9kZS5pZCksIDEpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ld19ub2RlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEpvaW5zIHRoZSBnaXZlbiBub2RlXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBub2RlICAgIFRoZSBub2RlIHRvIGpvaW5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgam9pbk5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciBuZXdOb2RlID0gdGhpcy5fX2pvaW5Ob2RlKG5vZGUpO1xuICAgICAgICAgICAgICAgIGlmIChuZXdOb2RlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBcdHRoaXMuam9pbk5vZGVFdmVudChuZXdOb2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogSm9pbnMgYWxsIHRoZSBnaXZlbiBub2Rlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVzICAgVGhlIG5vZGVzIHRvIGpvaW5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgam9pbk11bHRpcGxlTm9kZShub2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSB0aGlzLl9fam9pbk5vZGUobm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICBuZXdfbm9kZXMucHVzaChyZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmpvaW5NdWx0aXBsZU5vZGVzRXZlbnQobmV3X25vZGVzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgYWZ0ZXIgYSBzaW5nbGUgbm9kZSBpcyBqb2luZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5ld05vZGUgIFRoZSBuZXcgbm9kZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBqb2luTm9kZUV2ZW50KG5ld05vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaDtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgYWZ0ZXIgbXVsdGlwbGUgbm9kZXMgYXJlIGpvaW5lZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5ld05vZGVzICBUaGUgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGpvaW5NdWx0aXBsZU5vZGVzRXZlbnQobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaDtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBQb2xpY3k6IFNwbGl0Sm9pbk5vZGVQb2xpY3lcbiAgICAgICAgfVxufV0pO1xuXG5cblxuXG4iLCJcblxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52aXN1YWxpemF0aW9uJylcbiAgICAuZGlyZWN0aXZlKFwidmlzdWFsaXphdGlvbkVkZ2VcIiwgWyckd2luZG93JyxcbiAgICAgICAgZnVuY3Rpb24oJHdpbmRvdykge1xuICAgICAgICAgICAgZnVuY3Rpb24gdmlzdWFsaXphdGlvbkVkZ2VEMyhzY29wZSwgZDMpIHtcbiAgICAgICAgICAgICAgICB2YXIgYm9keUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gYm9keUVsLmNsaWVudFdpZHRoIC0gNDAwLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSAgYm9keUVsLmNsaWVudEhlaWdodCAtIDQwMDtcblxuXG4gICAgICAgICAgICAgICAgLy90YWtlbiBmcm9tIGh0dHA6Ly9ibC5vY2tzLm9yZy9zaW1lbmJyZWtrZW4vNjYzNDA3MFxuICAgICAgICAgICAgICAgIC8vIC8qKiBNQUlOIFNWRyAqKi9cbiAgICAgICAgICAgICAgICB2YXIgbGltaXQgPSA1OSxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbiA9IDc1MCxcbiAgICAgICAgICAgICAgICBub3cgPSBuZXcgRGF0ZShEYXRlLm5vdygpIC0gZHVyYXRpb24pO1xuXG4gICAgICAgICAgICAgICAgdmFyIGdyb3VwcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJ29yYW5nZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkMy5yYW5nZShsaW1pdCkubWFwKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2NvcGUub2xkRWRnZURhdGFbTWF0aC5mbG9vcihkLzEwKV0gfHwgMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciB4ID0gZDMudGltZS5zY2FsZSgpXG4gICAgICAgICAgICAgICAgICAgIC5kb21haW4oW25vdyAtIChsaW1pdCAtIDIpLCBub3cgLSBkdXJhdGlvbl0pXG4gICAgICAgICAgICAgICAgICAgIC5yYW5nZShbMCwgd2lkdGhdKTtcblxuICAgICAgICAgICAgICAgIHZhciB5ID0gZDMuc2NhbGUubGluZWFyKClcbiAgICAgICAgICAgICAgICAgICAgLmRvbWFpbihbMCwgZDMubWF4KGdyb3Vwcy5jdXJyZW50LmRhdGEsIGZ1bmN0aW9uIChkKSB7IHJldHVybiBkICsgMTA7IH0pXSlcbiAgICAgICAgICAgICAgICAgICAgLnJhbmdlKFtoZWlnaHQsIDBdKTtcblxuICAgICAgICAgICAgICAgIHZhciBsaW5lID0gZDMuc3ZnLmxpbmUoKVxuICAgICAgICAgICAgICAgICAgICAuaW50ZXJwb2xhdGUoJ2Jhc2lzJylcbiAgICAgICAgICAgICAgICAgICAgLngoZnVuY3Rpb24oZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHgobm93IC0gKGxpbWl0IC0gMSAtIGkpICogZHVyYXRpb24pXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC55KGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB5KGQpXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIHhTdmcgPSBkMy5zZWxlY3QoJy5ncmFwaCcpLmFwcGVuZCgnc3ZnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgMjUpXG4gICAgICAgICAgICAgICAgICAgIC5zdHlsZSgnb3ZlcmZsb3cnLCAndmlzaWJsZScpXG4gICAgICAgICAgICAgICAgICAgIC5zdHlsZSgncG9zaXRpb24nLCAnZml4ZWQnKTtcblxuICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgdmFyIHlBeGlzID0geFN2Zy5hcHBlbmQoJ2cnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAneSBheGlzJylcbiAgICAgICAgICAgICAgICAgICAgLy8gLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoMCwnICsgd2lkdGggKyAnKScpXG4gICAgICAgICAgICAgICAgICAgIC5jYWxsKHkuYXhpcyA9IGQzLnN2Zy5heGlzKCkuc2NhbGUoeSkub3JpZW50KCdsZWZ0JykpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciBzdmc9IGQzLnNlbGVjdCgnLmdyYXBoJykuYXBwZW5kKCdzdmcnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnY2hhcnQnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignd2lkdGgnLCB3aWR0aCAtIDUwKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignaGVpZ2h0JywgaGVpZ2h0ICsgNTApO1xuICAgICAgICAgICAgICAgICAgICAvLyAuc3R5bGUoJ292ZXJmbG93JywgXCJ2aXNpYmxlXCIpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGF4aXMgPSBzdmcuYXBwZW5kKCdnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ3ggYXhpcycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDAsJyArIGhlaWdodCArICcpJylcbiAgICAgICAgICAgICAgICAgICAgLmNhbGwoeC5heGlzID0gZDMuc3ZnLmF4aXMoKS5zY2FsZSh4KS5vcmllbnQoJ2JvdHRvbScpKTtcblxuICAgICAgICAgICAgICAgIHZhciBwYXRocyA9IHN2Zy5hcHBlbmQoJ2cnKTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIG5hbWUgaW4gZ3JvdXBzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBncm91cCA9IGdyb3Vwc1tuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXAucGF0aCA9IHBhdGhzLmFwcGVuZCgncGF0aCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZGF0YShbZ3JvdXAuZGF0YV0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCBuYW1lICsgJyBncm91cCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ3N0cm9rZScsIGdyb3VwLmNvbG9yKVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHRpY2soKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vdyA9IG5ldyBEYXRlKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQWRkIG5ldyB2YWx1ZXNcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBncm91cHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBncm91cCA9IGdyb3Vwc1tuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLmRhdGEucHVzaChzY29wZS5lZGdlRGF0YSB8fCAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLnBhdGguYXR0cignZCcsIGxpbmUpXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBTaGlmdCBkb21haW5cbiAgICAgICAgICAgICAgICAgICAgeC5kb21haW4oW25vdyAtIChsaW1pdCAtIDIpICogZHVyYXRpb24sIG5vdyAtIGR1cmF0aW9uXSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2xpZGUgeC1heGlzIGxlZnRcbiAgICAgICAgICAgICAgICAgICAgYXhpcy50cmFuc2l0aW9uKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kdXJhdGlvbihkdXJhdGlvbilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lYXNlKCdsaW5lYXInKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhbGwoeC5heGlzKTtcblxuICAgICAgICAgICAgICAgICAgICB5QXhpcy50cmFuc2l0aW9uKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kdXJhdGlvbihkdXJhdGlvbilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lYXNlKCdsaW5lYXInKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhbGwoeS5heGlzKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBTbGlkZSBwYXRocyBsZWZ0XG4gICAgICAgICAgICAgICAgICAgIHBhdGhzLmF0dHIoJ3RyYW5zZm9ybScsIG51bGwpXG4gICAgICAgICAgICAgICAgICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZHVyYXRpb24oZHVyYXRpb24pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZWFzZSgnbGluZWFyJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKCcgKyB4KG5vdyAtIChsaW1pdCAtIDEpICogZHVyYXRpb24pICsgJyknKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVhY2goJ2VuZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpY2soKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIG9sZGVzdCBkYXRhIHBvaW50IGZyb20gZWFjaCBncm91cFxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBuYW1lIGluIGdyb3Vwcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdyb3VwID0gZ3JvdXBzW25hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXAuZGF0YS5zaGlmdCgpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGljaygpXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybntcbiAgICAgICAgICAgICAgICByZXN0cmljdDonRUEnLFxuICAgICAgICAgICAgICAgIHJlcGxhY2U6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9uZWRnZXRlbXBsYXRlLmh0bWwnLFxuICAgICAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlKXtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJHdhdGNoR3JvdXAoWydlZGdlRGF0YScsICdvbGRFZGdlRGF0YSddLFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNjb3BlLmVkZ2VEYXRhICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLm9sZEVkZ2VEYXRhICE9IG51bGwgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2NvcGUuaW5pdGlhbGl6ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuaW5pdGlhbGl6ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZDMgPSAkd2luZG93LmQzOyAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXN1YWxpemF0aW9uRWRnZUQzKHNjb3BlLCBkMyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICB9XG4gICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICBdXG4pO1xuIiwiXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nKVxuICAgIC5zZXJ2aWNlKCdTdGF0ZVNhdmUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2F2ZWRTdGF0ZXMgPSB7fTtcbiAgICB9KVxuICAgIC5kaXJlY3RpdmUoXCJ2aXN1YWxpemF0aW9uR3JhcGhcIiwgWyckd2luZG93JywgJyRzdGF0ZScsICdWaXN1YWxpemVyR3JhcGgnLCAnUG9saWN5U2VydmljZScsICdWaXN1YWxpemVyRGF0YVNvdXJjZScsICdTdGF0ZVNhdmUnLFxuICAgICAgICBmdW5jdGlvbigkd2luZG93LCAkc3RhdGUsIFZpc3VhbGl6ZXJHcmFwaCwgUG9saWN5U2VydmljZSwgVmlzdWFsaXplckRhdGFTb3VyY2UsIFN0YXRlU2F2ZSkge1xuICAgICAgICAgICAgZnVuY3Rpb24gdmlzdWFsaXphdGlvbmxpc3RkMyhzY29wZSwgZWxlbSwgVmlzdWFsaXplckdyYXBoLCBQb2xpY3lTZXJ2aWNlLCBWaXN1YWxpemVyRGF0YVNvdXJjZSwgU3RhdGVTYXZlKSB7XG4gICAgICAgICAgICAgICAgLy9kb24ndCBydW4gdW50aWwgYWxsIGluaXRpYWxpemF0aW9uIGNhbGxzIGhhdmUgcmV0dXJuZWRcbiAgICAgICAgICAgICAgICBpZiAoc2NvcGUubm9kZXMgPT09IHVuZGVmaW5lZCB8fCBzY29wZS5saW5rcyA9PT0gdW5kZWZpbmVkIHx8IHNjb3BlLmNoaWxkcmVuX3N0cnVjdCA9PT0gdW5kZWZpbmVkIHx8XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLmFuY2VzdG9yc19zdHJ1Y3QgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9jcmVhdGluZyBEYXRhU291cmNlXG4gICAgICAgICAgICAgICAgdmFyIGRhdGFTb3VyY2UgPSBuZXcgVmlzdWFsaXplckRhdGFTb3VyY2UuRGF0YVNvdXJjZShzY29wZS5ub2Rlcywgc2NvcGUubGlua3MsIHNjb3BlLmNoaWxkcmVuX3N0cnVjdCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5hbmNlc3RvcnNfc3RydWN0LCBzY29wZS5sYWJlbHMsIHNjb3BlLnNlcnZpY2VTZWxlY3RvcnMpO1xuICAgICAgICAgICAgICAgIGRhdGFTb3VyY2Uuc2V0QW5jZXN0b3JzKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMsIGxpbmtzO1xuXG4gICAgICAgICAgICAgICAgdmFyIHRvcERhdGEgPSBkYXRhU291cmNlLmdldFRvcExldmVsRmxvdygpO1xuICAgICAgICAgICAgICAgIG5vZGVzID0gZGF0YVNvdXJjZS5wcm9jZXNzTm9kZURhdGEodG9wRGF0YS5ub2RlRGF0YSk7XG4gICAgICAgICAgICAgICAgbGlua3MgPSBkYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YSh0b3BEYXRhLmxpbmtEYXRhLCBub2Rlcyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgYm9keUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gYm9keUVsLmNsaWVudFdpZHRoLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSAgYm9keUVsLmNsaWVudEhlaWdodDtcblxuICAgICAgICAgICAgICAgIC8qKiBNQUlOIFNWRyAqKi9cbiAgICAgICAgICAgICAgICB2YXIgcmF3U3ZnPWVsZW0uZmluZCgnc3ZnJyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gJChyYXdTdmcucGFyZW50KCkpLm9mZnNldCgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGRpdldpZHRoID0gJChyYXdTdmcucGFyZW50KCkpLndpZHRoKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3ZnID0gZDMuc2VsZWN0KHJhd1N2Z1swXSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCBkaXZXaWR0aClcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJoZWlnaHRcIiwgaGVpZ2h0IC0gb2Zmc2V0LnRvcCAtIDIwKTtcblxuICAgICAgICAgICAgICAgIC8vaW5zdGFsbGluZyBwb2xpY2llc1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaCA9IG5ldyBWaXN1YWxpemVyR3JhcGguR3JhcGgoc3ZnLCBub2RlcywgbGlua3MsIGRhdGFTb3VyY2UsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmNoaWxkcmVuX3N0cnVjdCwgc2NvcGUuYW5jZXN0b3JzX3N0cnVjdCk7XG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmluc3RhbGxEZWZhdWx0UGF0aFBvbGljeShuZXcgUG9saWN5U2VydmljZS5TYXZlU3RhdGVQb2xpY3koU3RhdGVTYXZlLnNhdmVkU3RhdGVzKSk7XG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmluc3RhbGxEZWZhdWx0UGF0aFBvbGljeShuZXcgUG9saWN5U2VydmljZS5QYXRoQ2hhbmdlVmlld1BvbGljeSgkc3RhdGUpKTtcbiAgICAgICAgICAgICAgICAvL1FUaXBQb2xpY3kgaXMgZm9yIGJvdGggTm9kZXMgYW5kIFBhdGhzLCBpbnN0YWxsIHNhbWUgb25lIG9uIGJvdGhcbiAgICAgICAgICAgICAgICB2YXIgcVRpcFBvbGljeSA9IG5ldyBQb2xpY3lTZXJ2aWNlLlFUaXBQb2xpY3koKTtcbiAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGguaW5zdGFsbERlZmF1bHROb2RlUG9saWN5KHFUaXBQb2xpY3kpO1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5pbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3kocVRpcFBvbGljeSk7XG4gICAgICAgICAgICAgICAgdmFyIHNwbGl0Sm9pblZpZXdQb2xpY3kgPSBuZXcgUG9saWN5U2VydmljZS5TcGxpdEpvaW5WaWV3UG9saWN5KCk7XG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmluc3RhbGxEZWZhdWx0Tm9kZVBvbGljeShzcGxpdEpvaW5WaWV3UG9saWN5KTtcbiAgICAgICAgICAgICAgICBzcGxpdEpvaW5WaWV3UG9saWN5Lmluc3RhbGxCYWNrQnV0dG9uKCQoJyNiYWNrQnV0dG9uJykpO1xuICAgICAgICAgICAgICAgIHNwbGl0Sm9pblZpZXdQb2xpY3kuaW5zdGFsbFRpdGxlKCQoJyNncmFwaC10aXRsZScpKTtcblxuICAgICAgICAgICAgICAgIC8vbG9hZCBvbGQgdmlldyBpZiBpdCBleGlzdHMuXG4gICAgICAgICAgICAgICAgaWYgKF8uaXNFbXB0eShTdGF0ZVNhdmUuc2F2ZWRTdGF0ZXMpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBncmFwaCA9IHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaDtcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGgubG9hZChTdGF0ZVNhdmUuc2F2ZWRTdGF0ZXMpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJue1xuICAgICAgICAgICAgICAgIHJlc3RyaWN0OidFQScsXG4gICAgICAgICAgICAgICAgcmVwbGFjZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb250ZW1wbGF0ZS5odG1sJyxcbiAgICAgICAgICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbSl7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS51bmJpbmQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5kZXN0cm95KCk7fSk7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiR3YXRjaEdyb3VwKFsnbm9kZXMnLCAnbGlua3MnLCAnY2hpbGRyZW5fc3RydWN0JywgJ2FuY2VzdG9yc19zdHJ1Y3QnXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzY29wZS5ub2RlcyAhPSBudWxsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmxpbmtzICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuY2hpbGRyZW5fc3RydWN0ICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuYW5jZXN0b3JzX3N0cnVjdCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzY29wZS5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5pbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc3VhbGl6YXRpb25saXN0ZDMoc2NvcGUsIGVsZW0sIFZpc3VhbGl6ZXJHcmFwaCwgUG9saWN5U2VydmljZSwgVmlzdWFsaXplckRhdGFTb3VyY2UsIFN0YXRlU2F2ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmRhdGFTb3VyY2UubGlua3MgPSBzY29wZS5saW5rcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLnVwZGF0ZUxpbmtEYXRhKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIF1cbik7XG5cblxuXG5cblxuXG5cblxuXG5cblxuXG4iLCIvKipcbiAqIFRoaXMgcG9saWN5IGlzIHVzZWQgdG8gY2hhbmdlIHRoZSB2aWV3IHRvIGZvY3VzIG9uIHNwbGl0dGluZyBhbmQgXG4gKiBqb2luaW5nIGV2ZW50cy5cbiAqIE92ZXJyaWRlcyB0aGUgY2VydGFpbiBmb3JjZSBsYXlvdXQgZnVuY3Rpb25zIG9mIHRoZSBncmFwaCB0byBwYXJ0aXRpb24gYSBzcGxpdFxuICogaW50byB0aGUgZm9jdXNlZCBub2RlcyBhbmQgdGhlIGNvbm5lY3RlZCBub2Rlcy5cbiAqIFxuICogSGFzIHNhdmUvbG9hZCBtZXRob2RzIGZvciB0aGUgc2F2ZSBzdGF0ZSBwb2xpY3kuXG4gKiBIYXMgYmFjayBidXR0b24gc3VwcG9ydC5cbiAqIENhbiBhdXRvIGNoYW5nZSB0aGUgdGl0bGUgb2YgdGhlIGdyYXBoLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnU3BsaXRKb2luVmlld1BvbGljeScsIFsnU3BsaXRKb2luTm9kZVBvbGljeScsICdWaXN1YWxpemVyTm9kZScsIGZ1bmN0aW9uIChTcGxpdEpvaW5Ob2RlUG9saWN5LCBWaXN1YWxpemVyTm9kZSkgeyBcbiAgICAgICAgY2xhc3MgU3BsaXRKb2luVmlld1BvbGljeSBleHRlbmRzIFNwbGl0Sm9pbk5vZGVQb2xpY3kuUG9saWN5e1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAgICAgICAgIHN1cGVyKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wb2xpY3lOYW1lID0gXCJTcGxpdEpvaW5WaWV3UG9saWN5XCI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gcG9saWN5IGlzIGluc3RhbGxlZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluaXRpYWxpemUoZ3JhcGgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHN1cGVyLmluaXRpYWxpemUoZ3JhcGgpO1xuICAgICAgICAgICAgICAgIHZhciBzdGF0ZSA9IGdyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zYXZlZFN0YXRlcyA9IFtdO1xuICAgICAgICAgICAgICAgIC8vIHN0YXRlLmZvY3VzR3JvdXAgPSBudWxsO1xuICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeSA9IFtdO1xuICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzID0gW107XG4gICAgICAgICAgICAgICAgc3RhdGUuZm9jaSA9IFtdO1xuICAgICAgICAgICAgICAgIHN0YXRlLnpvb21zID0ge307XG4gICAgICAgICAgICAgICAgc3RhdGUubGF5b3V0ID0ge307XG4gICAgICAgICAgICAgICAgc3RhdGUubGF5b3V0RGVmYXVsdCA9IG51bGw7XG4gICAgICAgICAgICAgICAgc3RhdGUuem9vbURlZmF1bHQgPSBudWxsO1xuICAgICAgICAgICAgICAgIHN0YXRlLm5vZGVJZHNUb1Jlc2hvdyA9IG51bGw7XG4gICAgICAgICAgICAgICAgc3RhdGUuYmFja0J1dHRvbkVsZW0gPSBudWxsO1xuICAgICAgICAgICAgICAgIHN0YXRlLnRpdGxlRWxlbSA9IG51bGw7XG5cbiAgICAgICAgICAgICAgICB2YXIgY29uc3RzID0gZ3JhcGguY29uc3RzLlNwbGl0Sm9pblZpZXdQb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICBjb25zdHMuYm91bmRhcnkgPSAwLjg7XG5cbiAgICAgICAgICAgICAgICAvL292ZXJyaWRpbmcgZDNmb3JjZSBtZXRob2RzIG9mIHRoZSBncmFwaC5cbiAgICAgICAgICAgICAgICBncmFwaC5kM0ZvcmNlQm91bmRzID0gdGhpcy5kM0ZvcmNlQm91bmRzO1xuICAgICAgICAgICAgICAgIGdyYXBoLmQzRm9yY2VUaWNrID0gdGhpcy5kM0ZvcmNlVGljaztcbiAgICAgICAgICAgICAgICBncmFwaC5kM0ZvcmNlU3RhcnQgPSB0aGlzLmQzRm9yY2VTdGFydDtcbiAgICAgICAgICAgICAgICBncmFwaC5kM0ZvcmNlRW5kID0gdGhpcy5kM0ZvcmNlRW5kO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIExpbmtzIHRoZSBwcm92aWRlZCBlbGVtZW50IGEgYmFjayBidXR0b24gZmVhdHVyZVxuICAgICAgICAgICAgICogRG9lc24ndCB0cmlnZ2VyIHRoZSBvbi1jbGljayBldmVudFxuICAgICAgICAgICAgICogVGhhdCBzaG91bGQgYmUgZG9uZSB0aHJvdWdoIGFuZ3VsYXIgbmctY2xpY2suXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2pRdWVyeX0gIGVsZW0gICAgVGhlIGpxdWVyeSBzZWxlY3RlZCBlbGVtZW50XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluc3RhbGxCYWNrQnV0dG9uKGVsZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeSA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uRWxlbSA9IGVsZW07XG4gICAgICAgICAgICAgICAgc3RhdGUuYmFja0J1dHRvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kudW5kb0xhc3RFdmVudC5jYWxsKHRoaXNQb2xpY3kpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgYWxsb3cgdGhpcyBwb2xpY3kgdG8gY2hhbmdlIHRoZSB0aXRsZSBvZiB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqIGFzIHNwbGl0IGFuZCBqb2luIGV2ZW50cyBvY2N1ci5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7alF1ZXJ5fSAgZWxlbSAgICBUaGUganF1ZXJ5IHNlbGVjdGVkIGVsZW1lbnRcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5zdGFsbFRpdGxlKGVsZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIHN0YXRlLnRpdGxlRWxlbSA9IGVsZW07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIGJlaW5nIGRlc3Ryb3llZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBzYXZlZFN0YXRlICBBbnkgcHJvcGVydHkgb24gdGhpc1xuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdCB3aWxsIGJlIGFjY2Vzc2libGVcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGVuIHRoZSB2aWV3IHJlbG9hZHNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZGVzdHJveShzYXZlZFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgLy9Pbmx5IGlmIHRoZSBzYXZlIHN0YXRlIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICAgICAgICBpZiAoc2F2ZWRTdGF0ZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2F2ZShzYXZlZFN0YXRlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2lsbCBzYXZlIHRoZSBjdXJyZW50IHN0YXRlLCBhbmQgYWxsIGhpc3RvcnkuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIHNhdmVkU3RhdGUgIEFueSBwcm9wZXJ0eSBvbiB0aGlzXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0IHdpbGwgYmUgYWNjZXNzaWJsZVxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gdGhlIHZpZXcgcmVsb2Fkc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzYXZlKHNhdmVkU3RhdGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXNHcmFwaC5ub2RlcztcbiAgICAgICAgICAgICAgICB2YXIgbGlua3MgPSB0aGlzR3JhcGgubGlua3M7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJUaXRsZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLnRpdGxlRWxlbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJUaXRsZSA9IHN0YXRlLnRpdGxlRWxlbS50ZXh0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBmb2N1c0dyb3VwcyA9IHN0YXRlLmZvY3VzR3JvdXBzO1xuICAgICAgICAgICAgICAgIHZhciBldmVudEhpc3RvcnkgPSBzdGF0ZS5ldmVudEhpc3Rvcnk7XG4gICAgICAgICAgICAgICAgdmFyIHpvb21zID0gc3RhdGUuem9vbXM7XG4gICAgICAgICAgICAgICAgdmFyIGxheW91dCA9IHN0YXRlLmxheW91dDtcblxuICAgICAgICAgICAgICAgIHZhciBsYXlvdXREZWZhdWx0ID0gc3RhdGUubGF5b3V0RGVmYXVsdDtcbiAgICAgICAgICAgICAgICB2YXIgem9vbURlZmF1bHQgPSBzdGF0ZS56b29tRGVmYXVsdDtcbiAgICAgICAgICAgICAgICB2YXIgcmV0ID0ge25vZGVzOm5vZGVzLCBsaW5rczpsaW5rcywgXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlczpzdGF0ZS5zYXZlZFN0YXRlcywgY3VyclRpdGxlOmN1cnJUaXRsZSwgXG4gICAgICAgICAgICAgICAgICAgIGZvY3VzR3JvdXBzOiBmb2N1c0dyb3VwcyxcbiAgICAgICAgICAgICAgICAgICAgZXZlbnRIaXN0b3J5OmV2ZW50SGlzdG9yeSwgem9vbXM6em9vbXMsXG4gICAgICAgICAgICAgICAgICAgIGxheW91dDpsYXlvdXQsIGxheW91dERlZmF1bHQ6bGF5b3V0RGVmYXVsdCxcbiAgICAgICAgICAgICAgICAgICAgem9vbURlZmF1bHQ6em9vbURlZmF1bHR9O1xuICAgICAgICAgICAgICAgIHNhdmVkU3RhdGUuU3BsaXRKb2luVmlld1BvbGljeSA9IHJldDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBXaWxsIGJlIGNhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyByZWxvYWRlZCwgYXNzdW1pbmdcbiAgICAgICAgICAgICAqIHNhdmUgc3RhdGUgcG9saWN5IGlzIGluc3RhbGxlZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBsb2FkU3RhdGUgIENvbnRhaW5zIGFsbCB0aGUgc2F2ZWRcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhYmxlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBsb2FkKGxvYWRTdGF0ZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIGxvYWRTdGF0ZSA9IGxvYWRTdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuICAgICAgICAgICAgICAgIHN0YXRlLnNhdmVkU3RhdGVzID0gbG9hZFN0YXRlLnN0YXRlcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MgPSBsb2FkU3RhdGUubGlua3M7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzID0gbG9hZFN0YXRlLm5vZGVzO1xuXG4gICAgICAgICAgICAgICAgdmFyIGN1cnJUaXRsZSA9IGxvYWRTdGF0ZS5jdXJyVGl0bGU7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLnRpdGxlRWxlbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLnRpdGxlRWxlbS50ZXh0KGN1cnJUaXRsZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeSA9IGxvYWRTdGF0ZS5ldmVudEhpc3Rvcnk7XG4gICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMgPSBsb2FkU3RhdGUuZm9jdXNHcm91cHM7XG4gICAgICAgICAgICAgICAgc3RhdGUuem9vbXMgPSBsb2FkU3RhdGUuem9vbXM7XG4gICAgICAgICAgICAgICAgc3RhdGUubGF5b3V0ID0gbG9hZFN0YXRlLmxheW91dDtcbiAgICAgICAgICAgICAgICBzdGF0ZS5sYXlvdXREZWZhdWx0ID0gbG9hZFN0YXRlLmxheW91dERlZmF1bHQ7XG4gICAgICAgICAgICAgICAgc3RhdGUuem9vbURlZmF1bHQgPSBsb2FkU3RhdGUuem9vbURlZmF1bHQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuYmFja0J1dHRvbkVsZW0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLmJhY2tCdXR0b25FbGVtLmZhZGVUbygnc2xvdycsIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcblxuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV0sIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiZm9jdXNcIjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy9sb2FkaW5nIGEgcHJldmlvdXMgbGF5b3V0XG4gICAgICAgICAgICAgICAgdmFyIGxheW91dDtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGxheW91dCA9IHN0YXRlLmxheW91dERlZmF1bHQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciB6b29tID0gc3RhdGUuem9vbURlZmF1bHQ7IFxuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguem9vbWVkKHpvb21bMF0sIHpvb21bMV0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB6b29tID0gc3RhdGUuem9vbXNbc3RhdGUuZm9jdXNHcm91cHNdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoem9vbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguem9vbWVkKHpvb21bMF0sIHpvb21bMV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGxheW91dCA9IHN0YXRlLmxheW91dFtzdGF0ZS5mb2N1c0dyb3Vwc107XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9sYXlvdXQgY2FuJ3QgYmUgbnVsbFxuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBvcyA9IGxheW91dFtuLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvcyA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhsYXlvdXQsIG4pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG4ueCA9IHBvcy54O1xuICAgICAgICAgICAgICAgICAgICBuLnkgPSBwb3MueTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3RhdGUuaW5pdEZvcmNlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGguY2FsbCh0aGlzR3JhcGgsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnVwZGF0ZUdyYXBoQ2FsbGJhY2suY2FsbCh0aGlzUG9saWN5KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUcmlnZ2VyaW5nIHNwbGl0IG9uIGRvdWJsZSBjbGlja1xuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBGb2N1cyBncm91cCBzdG9yZXMgdGhlIG5vZGUgdGhhdCBpcyBhYm91dCB0byBiZSBzcGxpdC5cbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogV2hlbiBmb2N1cyBncm91cCBoYXMgbGVuZ3RoIDAsIHRoZSBmaXJzdCBzcGxpdCBcbiAgICAgICAgICAgICAqIHdpbGwganVzdCBiZSBwdXNoZWQgb24uXG4gICAgICAgICAgICAgKiBUaGUgbm9kZSB3aWxsIGJlIHNwbGl0IGFuZCBwdXNoZWQgdG8gdGhlIHRvcCBoYWxmIFxuICAgICAgICAgICAgICogb2YgdGhlIHNjcmVlbiwgYW5kIHRoZSBib3R0b20gaGFsZiB3aWxsIGNvbnRhaW4gYW55XG4gICAgICAgICAgICAgKiBub2RlcyBpdCBoYXMgY29ubmVjdGlvbnMgdG8uXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIFdoZW4gYSBmb2N1cyBncm91cCBsZW5ndGggaXMgPj0gMSwgaWYgdGhlIG5vZGUgdG8gYmVcbiAgICAgICAgICAgICAqIHNwbGl0IGlzIGEgZm9jdXMgbm9kZSwgaXQgd2lsbCByZXBsYWNlIGZvY3VzR3JvdXBzWzBdIGFuZFxuICAgICAgICAgICAgICogdGhlIHRvcCBoYWxmIHdpbGwgYmUgaXRzIGNoaWxkcmVuLCBhbmQgYm90dG9tIGhhbGYgd2lsbFxuICAgICAgICAgICAgICogYmUgdGhlIG5vZGVzIGl0IGhhcyBjb25uZWN0aW9ucyB0by5cbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogSWYgdGhlIHNwbGl0IGlzIGluIHRoZSBib3R0b20gaGFsZiwgdGhlbiB0aGUgYm90dG9tIGhhbGZcbiAgICAgICAgICAgICAqIHdpbGwgZGlzcGxheSBpdCdzIGNoaWxkcmVuIGFuZCB3aWxsIG9ubHkgc2hvdyBjb25uZWN0aW9ucyBiZXR3ZWVuXG4gICAgICAgICAgICAgKiB0aGUgdHdvIGdyb3VwcywgYW5kIHdpbGwgcmVwbGFjZSBmb2N1c0dyb3Vwc1sxXS5cbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqfSAgIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBkICAgICAgIFRoZSBtYXRjaGluZyBkYXRhIG9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkYmxjbGljayhkM25vZGUsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIC8vY2hlY2sgaWYgY2FuIHNwbGl0XG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBkLmlkO1xuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkcmVuX3N0cnVjdFtuYW1lXSA9PT0gdW5kZWZpbmVkIHx8IF8uaXNFbXB0eShjaGlsZHJlbl9zdHJ1Y3RbbmFtZV0pKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwcy5zbGljZSgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMCkgeyAvL3RvcGxldmVsIHNwbGl0XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzLnB1c2goZC5pZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChfLmluY2x1ZGVzKGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV0sIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLmlkKSkgeyAvL3NwbGl0dGluZyBhIGZvY3VzIG5vZGVcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHNbMF0gPSBkLmlkO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAxKSB7Ly9zcGxpdHRpbmcgYVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25uZWN0ZWQgbm9kZVxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwcy5wdXNoKGQuaWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXy5pbmNsdWRlcyhjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMV1dLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLmlkKSkgey8vc3BsaXR0aW5nIGFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2Nvbm5lY3RlZCBub2RlXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzWzFdID0gZC5pZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDIgJiYgXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwc1sxXSA9PT0gZC5pZCkge1xuICAgICAgICAgICAgICAgICAgICAvL1NwbGl0dGluZyBhIGNvbm5lY3RlZCBub2RlLCBrZWVwIGFsbCBmb2N1cyBub2Rlc1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZXNUb0tlZXAgPSBbZF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlSWRzVG9SZXNob3cgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdyb3VwT25lTm9kZXMgPSBjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dO1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoXy5pbmNsdWRlcyhncm91cE9uZU5vZGVzLCBub2RlLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHNUb1Jlc2hvdy5wdXNoKG5vZGUuaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzVG9LZWVwLnB1c2gobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vTWFrZSBzcGxpdCBub2RlcyB0aGUgZm9jdXMgYW5kIGtlZXAgbm9kZXMgdGhhdCBhcmUgY29ubmVjdGVkXG4gICAgICAgICAgICAgICAgICAgIHZhciBub2Rlc1RvS2VlcCA9IFtkXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVJZHNUb1Jlc2hvdyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLmxpbmtzLCBmdW5jdGlvbihsaW5rKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobGluay5zb3VyY2UgPT09IGQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlkc1RvUmVzaG93LmluZGV4T2YobGluay50YXJnZXQuaWQpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluay50YXJnZXQuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsudGFyZ2V0LlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiY29ubmVjdGVkXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlkc1RvUmVzaG93LnB1c2gobGluay50YXJnZXQuaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzVG9LZWVwLnB1c2gobGluay50YXJnZXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChsaW5rLnRhcmdldCA9PT0gZCAmJiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlkc1RvUmVzaG93LmluZGV4T2YobGluay5zb3VyY2UuaWQpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluay5zb3VyY2UuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsuc291cmNlLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiY29ubmVjdGVkXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlkc1RvUmVzaG93LnB1c2gobGluay5zb3VyY2UuaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzVG9LZWVwLnB1c2gobGluay5zb3VyY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL1JlbW92aW5nIGxpbmtzIGZyb20gdGhlIG5vZGUgdG8gYmUgc3BsaXRcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5lYWNoKGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuaWQgIT09IGQuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zcGxpY2VMaW5rc0Zvck5vZGUobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcblxuICAgICAgICAgICAgICAgIC8vZGlzYWJsaW5nIHVwZGF0ZSBncmFwaCB0byBwcmV2ZW50IG5ldyBkYXRhIGZyb21cbiAgICAgICAgICAgICAgICAvL3JlZHJhd2luZyBsaW5rcyB3aGlsZSB0aGVyZSBhcmUgYW5pbWF0aW9ucyBnb2luZyBvblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZS5kaXNhYmxlVXBkYXRlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5lYWNoKGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuaWQgIT09IGQuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS50cmFuc2l0aW9uKCkuZGVsYXkoMjAwKS5kdXJhdGlvbig0MDApLnN0eWxlKFwib3BhY2l0eVwiLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vZGlzYWJsaW5nIHF0aXAgaWYgaW5zdGFsbGVkXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJCh0aGlzKS5xdGlwICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnF0aXAoJ2Rpc2FibGUnLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIHRyYW5zbGF0ZSA9IHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpO1xuICAgICAgICAgICAgICAgIHZhciBzY2FsZSA9IHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCk7XG4gICAgICAgICAgICAgICAgdmFyIHhMb2MgPSAocGFyc2VGbG9hdCh0aGlzR3JhcGguc3ZnLnN0eWxlKFwid2lkdGhcIikpIC8gc2NhbGUpIC8gMiAgKyB0cmFuc2xhdGVbMF07XG4gICAgICAgICAgICAgICAgdmFyIHlMb2MgPSAocGFyc2VGbG9hdCh0aGlzR3JhcGguc3ZnLnN0eWxlKFwiaGVpZ2h0XCIpKSAvIHNjYWxlKS8gMiAgKyB0cmFuc2xhdGVbMV07XG4gICAgICAgICAgICAgICAgZC54U3RhcnQgPSBkLng7XG4gICAgICAgICAgICAgICAgZC55U3RhcnQgPSBkLnk7XG4gICAgICAgICAgICAgICAgZC54ID0geExvYztcbiAgICAgICAgICAgICAgICBkLnkgPSB5TG9jO1xuICAgICAgICAgICAgICAgIGQzbm9kZS50cmFuc2l0aW9uKFwibm9kZVBvc2l0aW9uVHJhbnNpdGlvblwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmR1cmF0aW9uKDc1MClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyVHdlZW4oXCJ0cmFuc2Zvcm1cIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4U3RhcnQgPSBkLnhTdGFydDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgeVN0YXJ0ID0gZC55U3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC54U3RhcnQgPSBkLng7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55U3RhcnQgPSBkLnk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQzLmludGVycG9sYXRlU3RyaW5nKFwidHJhbnNsYXRlKFwiICsgeFN0YXJ0ICsgXCIsXCIgKyB5U3RhcnQgKyBcIilcIiwgXCJ0cmFuc2xhdGUoXCIgKyBkLnggKyBcIixcIiArIGQueSArIFwiKVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIHNwbGl0Tm9kZUZ1bmMgPSBzdXBlci5zcGxpdE5vZGU7XG4gICAgICAgICAgICAgICAgc3RhdGUubm9kZUlkc1RvUmVzaG93ID0gbm9kZUlkc1RvUmVzaG93O1xuICAgICAgICAgICAgICAgIC8vd2FpdGluZyBmb3Igbm9kZSB0cmFuc2l0aW9uXG4gICAgICAgICAgICAgICAgdmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlcyA9IG5vZGVzVG9LZWVwO1xuICAgICAgICAgICAgICAgICAgICBzcGxpdE5vZGVGdW5jLmNhbGwodGhpc1BvbGljeSwgZCk7XG4gICAgICAgICAgICAgICAgfSwgNzUwKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUbyBiZSBjYWxsZWQgYWZ0ZXIgdGhlIGdyYXBoIGlzIHNwbGl0LlxuICAgICAgICAgICAgICogQnJpbmdzIGFsbCBub2RlcyBiYWNrIGludG8gdmlldyBhbmQgc2V0cyB0aGVpciBhdHRyaWJ1dGVzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHVwZGF0ZUdyYXBoQ2FsbGJhY2soKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZWFjaChmdW5jdGlvbihub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykudHJhbnNpdGlvbigpLmR1cmF0aW9uKDQwMCkuc3R5bGUoXCJvcGFjaXR5XCIsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLmNsYXNzZWQoXCJmb2N1c1wiLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykuY2xhc3NlZChcImNvbm5lY3RlZFwiLCBmYWxzZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlLlNwbGl0Sm9pblZpZXdQb2xpY3kgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9PT0gXCJmb2N1c1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5jbGFzc2VkKFwiZm9jdXNcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChub2RlLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9PT0gXCJjb25uZWN0ZWRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykuY2xhc3NlZChcImNvbm5lY3RlZFwiLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLm5vZGVJZHNUb1Jlc2hvdyA9IG51bGw7XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmFuZG9tbHkgc2V0cyB0aGUgcG9zaXRpb25zIG9mIGFueSB1bnNldCBub2RlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNldFBvc2l0aW9ucygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeSA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIGdyYXBoQ29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cztcblxuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSBncmFwaENvbnN0cy5kaXNwbGF5T2Zmc2V0O1xuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXNHcmFwaC5ub2RlcztcbiAgICAgICAgICAgICAgICB2YXIgcmV0ID0gdGhpc1BvbGljeS5kM0ZvcmNlQm91bmRzLmNhbGwodGhpc0dyYXBoKTtcblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdldFJhbmRvbUludChtaW4sIG1heCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbiArIDEpKSArIG1pbjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfLmZvckVhY2gobm9kZXMsIGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUueCA9PSBudWxsIHx8IG5vZGUueSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IGdldFJhbmRvbUludChub2RlLnJhZGl1cyArIG9mZnNldCwgcmV0LndpZHRoIC0gbm9kZS5yYWRpdXMgLSBvZmZzZXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHkgPSBnZXRSYW5kb21JbnQobm9kZS5yYWRpdXMgKyBvZmZzZXQsIHJldC5oZWlnaHQgLSBub2RlLnJhZGl1cyAtIG9mZnNldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLnggPSB4O1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS55ID0geTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIG9uIHRoZSBzdGFydCBvZiB0aGUgZDMgZm9yY2Ugc2ltdWxhdGlvblxuICAgICAgICAgICAgICogV2lsbCBvdmVycmlkZSB0aGUgbWV0aG9kIG9mIHRoZSBncmFwaFxuICAgICAgICAgICAgICogXCJ0aGlzXCIgcG9pbnRzIHRvIHRoZSBncmFwaFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkM0ZvcmNlU3RhcnQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXNcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2N4JywgZnVuY3Rpb24oZCkgeyBcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLnhTdGFydCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC54U3RhcnQgPSAoZC54U3RhcnQgKiB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpKSArIHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueDtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2N5JywgZnVuY3Rpb24oZCkgeyBcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLnlTdGFydCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55U3RhcnQgPSAoZC55U3RhcnQgKnRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCkpICsgdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKClbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55O1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoc1xuICAgICAgICAgICAgICAgICAgICAuYXR0cigneDEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS55OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneDInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC55OyB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgb24gdGhlIHN0YXJ0IG9mIHRoZSBkMyBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKiBXaWxsIG92ZXJyaWRlIHRoZSBtZXRob2Qgb2YgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKiBcInRoaXNcIiBwb2ludHMgdG8gdGhlIGdyYXBoXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGQzRm9yY2VFbmQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZVBvbGljeSA9IHN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlUG9saWN5LmxheW91dERlZmF1bHQgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmYXVsdExheW91dCA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbihuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0TGF5b3V0W24uaWRdID0ge3g6bi54LCB5Om4ueX07XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZVBvbGljeS5sYXlvdXREZWZhdWx0ID0gZGVmYXVsdExheW91dDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zbGF0ZSA9IHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZVBvbGljeS56b29tRGVmYXVsdCA9IFt0cmFuc2xhdGUsIHNjYWxlXTsgXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXNcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2N4JywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY3knLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnk7IH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzLmF0dHIoJ3gxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueTsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueTsgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2lsbCBiZSBjYWxsZWQgZHVyaW5nIEQzIGZvcmNlIHNpbXVsYXRpb25zXG4gICAgICAgICAgICAgKiBieSB0aGUgZ3JhcGgsIHNvIFwidGhpc1wiIHdpbGwgcG9pbnQgdG8gdGhlIGdyYXBoIG9iamVjdFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB3aWR0aCAgIEQzIExheW91dCBXaWR0aFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge251bWJlcn0gIGhlaWdodCAgRDMgTGF5b3V0IEhlaWdodFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkM0ZvcmNlVGljayhlLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZVBvbGljeSA9IHN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gY29uc3RzLmRpc3BsYXlPZmZzZXQ7XG4gICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKTtcblxuICAgICAgICAgICAgICAgIC8vIE1vdmUgbm9kZXMgdG93YXJkIGNsdXN0ZXIgZm9jdXMuXG4gICAgICAgICAgICAgICAgdmFyIGZvY2kgPSBzdGF0ZVBvbGljeS5mb2NpO1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdyYXZpdHkoYWxwaGEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb2NpLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9PT0gXCJmb2N1c1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSArPSAoZm9jaVswXSAtIGQueSkgKiBhbHBoYTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gKGZvY2lbMV0gLSBkLnkpICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCArPSAod2lkdGgvMiAtIGQueCkgKiBhbHBoYTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55ICs9IChoZWlnaHQvMiAtIGQueSkgKiBhbHBoYTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnggKz0gKHdpZHRoLzIgLSBkLngpICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gTWFrZSBzdXJlIG5vZGVzIGFyZSB3aXRoaW4gYm91bmRzXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXNcbiAgICAgICAgICAgICAgICAgICAgLmVhY2godGhpcy5kM0ZvcmNlQ29sbGlkZSguNSkpXG4gICAgICAgICAgICAgICAgICAgIC5lYWNoKGdyYXZpdHkoLjIgKiBlLmFscGhhKSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJjeFwiLCBmdW5jdGlvbihkKSB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueCA9IE1hdGgubWF4KChkLnJhZGl1cyArIG9mZnNldCkvc2NhbGUsIE1hdGgubWluKHdpZHRoICsgKCgtb2Zmc2V0LSBkLnJhZGl1cykgLyBzY2FsZSksIGQueCkpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcImN5XCIsIGZ1bmN0aW9uKGQpIHsgXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5TcGxpdEpvaW5WaWV3UG9saWN5ID09IG51bGwgfHwgZC5TcGxpdEpvaW5WaWV3UG9saWN5ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgPSBNYXRoLm1heCgoZC5yYWRpdXMgKyBvZmZzZXQpL3NjYWxlLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgubWluKGhlaWdodCArICgoLW9mZnNldCAtIGQucmFkaXVzKS9zY2FsZSksIGQueSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID09PSBcImZvY3VzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgPSBNYXRoLm1heChkLnJhZGl1cyArIG9mZnNldCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLm1pbigoaGVpZ2h0ICsgKCgtb2Zmc2V0IC0gZC5yYWRpdXMpL3NjYWxlKSkqY29uc3RzLlNwbGl0Sm9pblZpZXdQb2xpY3kuYm91bmRhcnksIGQueSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID09PSBcImNvbm5lY3RlZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55ID0gTWF0aC5tYXgoKGhlaWdodCArICgob2Zmc2V0IC0gZC5yYWRpdXMpL3NjYWxlKSkgKmNvbnN0cy5TcGxpdEpvaW5WaWV3UG9saWN5LmJvdW5kYXJ5LCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgubWluKGhlaWdodCArICgoLW9mZnNldCAtIGQucmFkaXVzKS9zY2FsZSksIGQueSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd4MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLnk7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd4MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lnk7IH0pO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsY3VsYXRlcyB0aGUgYm91bmRhcmllcyBvZiB0aGUgc2ltdWxhdGlvblxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBXaWxsIGJlIGNhbGxlZCBkdXJpbmcgRDMgZm9yY2Ugc2ltdWxhdGlvbnNcbiAgICAgICAgICAgICAqIGJ5IHRoZSBncmFwaCwgc28gXCJ0aGlzXCIgd2lsbCBwb2ludCB0byB0aGUgZ3JhcGggb2JqZWN0XG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtPYmplY3R9ICAgICAgICAgIFJldHVybnMgYW4gb2JqZWN0XG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGF0IGhhcyB0aGUgd2lkdGhcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZCBoZWlnaHQgYXMgXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzIFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkM0ZvcmNlQm91bmRzKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cyxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzUG9saWN5ID0gY29uc3RzLlNwbGl0Sm9pblZpZXdQb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5ID0gc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gY2FsY01heE5vZGVzKHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZWEgPSB3aWR0aCAqIGhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJhZGl1cyA9IHRoaXNHcmFwaC5jb25zdHMuc3RhcnRSYWRpdXM7XG4gICAgICAgICAgICAgICAgICAgIC8vdHJlYXRpbmcgdGhlbSBhcyBhIHNxdWFyZSBmb3IgYXBwcm94XG4gICAgICAgICAgICAgICAgICAgIHZhciBsZW5ndGggPSAocmFkaXVzICozLjUpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYW1vdW50ID0gYXJlYSAvKGxlbmd0aCAqbGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFtb3VudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9UaGUgb2Zmc2V0IGlzIHRoZSBidWZmZXIgZnJvbSB0aGUgZWRnZXNcbiAgICAgICAgICAgICAgICAvL09yaWdpbmFsIFdpZHRoIGFuZCBIZWlnaHQgYXJlIGdpdmVuIHRvIHRoZSBmb3JjZSBsYXlvdXRcbiAgICAgICAgICAgICAgICAvL3NvIHRoYXQgaXQgaXMgY2VudGVyZWQsIGJ1dCBub2RlcyB3aWxsIGJlIGZvcmNlZCB0byBiZVxuICAgICAgICAgICAgICAgIC8vd2l0aGluIHRoZSBvZmZzZXQgYm91bmRzXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IGNvbnN0cy5kaXNwbGF5T2Zmc2V0O1xuICAgICAgICAgICAgICAgIHZhciBzdmdXaWR0aCA9IHBhcnNlRmxvYXQodGhpc0dyYXBoLnN2Zy5zdHlsZShcIndpZHRoXCIpKTtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnSGVpZ2h0ID0gcGFyc2VGbG9hdCh0aGlzR3JhcGguc3ZnLnN0eWxlKFwiaGVpZ2h0XCIpKTtcblxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IHN2Z1dpZHRoO1xuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBzdmdIZWlnaHQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgYW1vdW50ID0gY2FsY01heE5vZGVzKHdpZHRoIC0gKDIqb2Zmc2V0KSwgaGVpZ2h0IC0gKDIqb2Zmc2V0KSk7XG4gICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gMTtcbiAgICAgICAgICAgICAgICBpZiAobm9kZXMubGVuZ3RoID4gYW1vdW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHNjYWxlID0gYW1vdW50IC8gbm9kZXMubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguem9vbWVkKHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpLCBzY2FsZSk7XG4gICAgICAgICAgICAgICAgICAgIHdpZHRoIC89IHNjYWxlO1xuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgLz0gc2NhbGU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKSwgc2NhbGUpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vY2FsY3VsYXRpbmcgZm9jaSBmb3Igc2ltdWxhdGlvblxuICAgICAgICAgICAgICAgIHZhciBmb2N1c0dyb3VwcyA9IHN0YXRlUG9saWN5LmZvY3VzR3JvdXBzO1xuICAgICAgICAgICAgICAgIHZhciBmb2NpO1xuICAgICAgICAgICAgICAgIGlmIChmb2N1c0dyb3Vwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZm9jaSA9IFtoZWlnaHQvMl07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy9zZXR0aW5nIGZvY2kgaGVpZ2h0IHBvc2l0aW9uIGJhc2VkIG9uIHBlcmNlbnRhZ2VcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZvY3VzTm9kZXMgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbZm9jdXNHcm91cHNbMF1dO1xuICAgICAgICAgICAgICAgICAgICBjb25zdHNQb2xpY3kuYm91bmRhcnkgPSBmb2N1c05vZGVzLmxlbmd0aCAvIG5vZGVzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRvcCA9IGhlaWdodCAqIGNvbnN0c1BvbGljeS5ib3VuZGFyeTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJvdCA9IGhlaWdodCAtIHRvcDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRvcCA8IDIqdGhpc0dyYXBoLmNvbnN0cy5tYXhSYWRpdXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0c1BvbGljeS5ib3VuZGFyeSA9ICgyLjUgKiB0aGlzR3JhcGguY29uc3RzLm1heFJhZGl1cykgLyBoZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3AgPSBoZWlnaHQgKiBjb25zdHNQb2xpY3kuYm91bmRhcnk7XG4gICAgICAgICAgICAgICAgICAgICAgICBib3QgPSBoZWlnaHQgLSB0b3A7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoYm90IDwgMiogdGhpc0dyYXBoLmNvbnN0cy5tYXhSYWRpdXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0c1BvbGljeS5ib3VuZGFyeSA9IDEgLSAoKDIuNSAqIHRoaXNHcmFwaC5jb25zdHMubWF4UmFkaXVzKSAvIGhlaWdodCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3AgPSBoZWlnaHQgKiBjb25zdHNQb2xpY3kuYm91bmRhcnk7XG4gICAgICAgICAgICAgICAgICAgICAgICBib3QgPSBoZWlnaHQgLSB0b3A7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZm9jaSA9IFt0b3AvMiwgdG9wICsgYm90IC8gMl07XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kuZm9jaSA9IGZvY2k7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHt3aWR0aDp3aWR0aCwgaGVpZ2h0OmhlaWdodH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIGFmdGVyIGEgc2luZ2xlIG5vZGUgaXMgc3BsaXRcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbmV3Tm9kZXMgIFRoZSBuZXcgbm9kZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc3BsaXROb2RlRXZlbnQobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaChuZXdOb2RlcywgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoXy5pbmNsdWRlcyhjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImZvY3VzXCI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiY29ubmVjdGVkXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHZhciB0aXRsZSA9IG5ld05vZGVzWzBdLnBhcmVudDtcbiAgICAgICAgICAgICAgICAvLyBzdGF0ZS5mb2N1c0dyb3VwID0gdGl0bGU7XG5cbiAgICAgICAgICAgICAgICAvL2lmIHRoZSBsYXN0IGV2ZW50IGhhcyB0aGUgc2FtZSBpZCwgaXQgbXVzdCBiZSB0aGVcbiAgICAgICAgICAgICAgICAvL29wcHBvc2l0ZSBvZiB0aGlzIGV2ZW50LCBzbyB3ZSByZW1vdmUgdGhhdCBldmVudCBmcm9tXG4gICAgICAgICAgICAgICAgLy90aGUgZXZlbnQgc3RhY2suXG4gICAgICAgICAgICAgICAgLy9PdGhlcndpc2UsIHdlIGFkZCB0aGUgZXZlbnQgb3QgdGhlIHN0YWNrXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggIT09IDAgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeVtzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoIC0gMV0uaWQgPT09IHRpdGxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeS5wb3AoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkucHVzaCh7aWQ6dGl0bGUsIGV2ZW50OidzcGxpdCd9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuYmFja0J1dHRvbkVsZW0gIT0gbnVsbCAmJiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmJhY2tCdXR0b25FbGVtLmZhZGVUbygnc2xvdycsIDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUudGl0bGVFbGVtICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSBzdGF0ZS5mb2N1c0dyb3Vwc1swXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ICs9ICcgJiAnICsgc3RhdGUuZm9jdXNHcm91cHNbMV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc3RhdGUudGl0bGVFbGVtLnRleHQodGV4dCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9yZS1lbmFibGUgZ3JhcGggdXBkYXRlXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN0YXRlLmRpc2FibGVVcGRhdGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnNldExheW91dCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNldHMgdGhlIGxheW91dCBvZiB0aGUgbm9kZXMuIFxuICAgICAgICAgICAgICogSWYgdGhlcmUgaXMgYSBwcmV2aW91cyBsYXlvdXQsIGl0IHdpbGwgYmUgbG9hZGVkLlxuICAgICAgICAgICAgICogRWxzZSwgaXQgd2lsbCBydW4gYSBEMyBGb3JjZSBzaW11bGF0aW9uIGFuZCBjcmVhdGUgb25lLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzZXRMYXlvdXQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuICAgICAgICAgICAgICAgIHZhciBsYXlvdXQ7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBsYXlvdXQgPSBzdGF0ZS5sYXlvdXREZWZhdWx0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbSA9IHN0YXRlLnpvb21EZWZhdWx0O1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguem9vbWVkKHpvb21bMF0sIHpvb21bMV0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB6b29tID0gc3RhdGUuem9vbXNbc3RhdGUuZm9jdXNHcm91cHNdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoem9vbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguem9vbWVkKHpvb21bMF0sIHpvb21bMV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGxheW91dCA9IHN0YXRlLmxheW91dFtzdGF0ZS5mb2N1c0dyb3Vwc107XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGxheW91dCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb3MgPSBsYXlvdXRbbi5pZF07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocG9zID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhsYXlvdXQsIG4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgbi54ID0gcG9zLng7XG4gICAgICAgICAgICAgICAgICAgICAgICBuLnkgPSBwb3MueTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaC5jYWxsKHRoaXNHcmFwaCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnVwZGF0ZUdyYXBoQ2FsbGJhY2suY2FsbCh0aGlzUG9saWN5KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy9OZWVkIHRvIHJ1biBhIGZvcmNlIHNpbXVsYXRpb24gYXMgdGhpcyBsYXlvdXRcbiAgICAgICAgICAgICAgICAgICAgLy9oYXNuJ3QgYmVlbiBkb25lIGJlZm9yZVxuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3RhdGUuaW5pdEZvcmNlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRoaXNQb2xpY3kuc2V0UG9zaXRpb25zKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kudXBkYXRlR3JhcGhDYWxsYmFjay5jYWxsKHRoaXNQb2xpY3kpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuem9vbXNbc3RhdGUuZm9jdXNHcm91cHNdID0gW3RoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxheW91dCA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbihuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYXlvdXRbbi5pZF0gPSB7eDpuLngsIHk6bi55fTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmxheW91dFtzdGF0ZS5mb2N1c0dyb3Vwc10gPSBsYXlvdXQ7XG4gICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBPdmVycmlkaW5nIGZyb20gc3VwZXIgY2xhc3Mgc28gdGhhdCB3ZSBjYW4gaGF2ZVxuICAgICAgICAgICAgICogdG9wIGxldmVsIG5vZGVzIHJlYXBwZWFyIHdoZW4gdGhleSBhcmUgaGlkZGVuXG4gICAgICAgICAgICAgKiBkdWUgdG8gdGhlcmUgYmVpbmcgdHdvIGZvY3VzIGdyb3Vwcy5cbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgICAgIG5vZGUgICAgVGhlIG5vZGUgdG8gam9pblxuICAgICAgICAgICAgICogQHJldHVybiAgICAge05vZGV9ICBUaGUgbmV3IG5vZGUgYWZ0ZXIgdGhlIGpvaW5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgX19qb2luTm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlU3VwZXIgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luTm9kZVBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIC8vY2hlY2sgdGhhdCBub2RlIHN0aWxsIGV4aXN0c1xuICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGgubm9kZXMuaW5kZXhPZihub2RlKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IG5vZGUuaWQ7XG4gICAgICAgICAgICAgICAgLy9pZiBpdCBoYXMgbm8gYW5jZXN0b3IsIG5vdGhpbmcgdG8gam9pblxuICAgICAgICAgICAgICAgIGlmIChjaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwuaW5kZXhPZihuYW1lKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gbm9kZS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgdmFyIHRvX2JlX2RlbGV0ZWQgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZU5hbWVTZXQgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXNHcmFwaC5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIG5vZGUgd29uJ3QgYmUgY29sbGFwc2VkXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGgubm9kZXNbaV0uYW5jZXN0b3JzLmluZGV4T2Yobm9kZS5wYXJlbnQpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlTmFtZVNldC5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXS5pZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b19iZV9kZWxldGVkLnB1c2godGhpc0dyYXBoLm5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGVfaWQgPSBub2RlLnBhcmVudDtcbiAgICAgICAgICAgICAgICBub2RlTmFtZVNldC5wdXNoKG5vZGUucGFyZW50KTtcblxuICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnNfc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuYW5jZXN0b3JzX3N0cnVjdDtcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIC8vIC0gc2V0dGluZyBmb2N1c0dyb3VwcyAtXG4gICAgICAgICAgICAgICAgLy9laXRoZXIgcmVwbGFjaW5nIG9uZSBvZiB0aGUgZ3JvdXBzLFxuICAgICAgICAgICAgICAgIC8vb3Igam9pbmluZyBiYWNrIGludG8gYSB0b3AgbGV2ZWwsIHNvIHRoZXJlIGlzIG9ubHlcbiAgICAgICAgICAgICAgICAvL29uZSBmb2N1c1xuICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IHN0YXRlLmZvY3VzR3JvdXBzLmluZGV4T2YocGFyZW50KTtcbiAgICAgICAgICAgICAgICBpZiAoYW5jZXN0b3JzX3N0cnVjdFtwYXJlbnRdICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHNbaW5kZXhdID0gYW5jZXN0b3JzX3N0cnVjdFtwYXJlbnRdO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9uYW1lVG9BZGQgYXJlIHRvcCBsZXZlbCBub2RlcyB0aGF0IGFyZSB0byBiZSBhZGRlZFxuICAgICAgICAgICAgICAgIC8vdG8gdGhlIGdyYXBoLlxuICAgICAgICAgICAgICAgIHZhciBuYW1lVG9BZGQgPSBbXTtcbiAgICAgICAgICAgICAgICAvL3dpbGwgb25seSBuZWVkIHRvIGFkZCBhIHRvcCBsZXZlbCBub2RlIGlmIHRoZXJlIGlzXG4gICAgICAgICAgICAgICAgLy9vbmx5IG9uZSBmb2N1c1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9BZGQgb25seSB0aG9zdCB0aGF0IGFyZW4ndCBhbiBhbmNlc3RvciBvZiB0aGUgbm9kZVxuICAgICAgICAgICAgICAgICAgICAvL3RvIGpvaW4sIHRoZSBmb2N1cyBncm91cCBvciBhbiBhbmNlc3RvciBvZiBpdCxcbiAgICAgICAgICAgICAgICAgICAgLy9hbmQgYXJlbid0IGFscmVhZHkgaW4gbm9kZU5hbWVTZXQuXG4gICAgICAgICAgICAgICAgICAgIC8vZ2V0IGZsb3cgYmV0d2VlbiB0b3AgbGV2ZWwgYXMgbG9uZyBhc1xuICAgICAgICAgICAgICAgICAgICAvL3RoZSB0b3AgbGV2ZWwgaXNuJ3QgYW4gYW5jZXN0b3Igb2YgdGhlXG4gICAgICAgICAgICAgICAgICAgIC8vZm9jdXMgZ3JvdXAsIGFuZCBpc24ndCBhbHJlYWR5IHBhcnQgb2YgdGhlXG4gICAgICAgICAgICAgICAgICAgIC8vbm9kZSBzZXQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnMgPSBhbmNlc3RvcnNfc3RydWN0W25vZGUuaWRdO1xuICAgICAgICAgICAgICAgICAgICBhbmNlc3RvcnMucHVzaChzdGF0ZS5mb2N1c0dyb3Vwc1swXSk7XG4gICAgICAgICAgICAgICAgICAgIC8vdGhlIG9yIGVtcHR5IGFycmF5IGlzIHRvIHByZXZlbnQgY29uY2F0ZW5hdGluZyBhIG51bGxcbiAgICAgICAgICAgICAgICAgICAgLy9vciB1bmRlZmluZWQgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3JzID0gYW5jZXN0b3JzLmNvbmNhdChhbmNlc3RvcnNfc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzBdXSB8fCBbXSk7XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChjaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwsIGZ1bmN0aW9uKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhbmNlc3RvcnMuaW5kZXhPZihuKSA9PT0gLTEgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZU5hbWVTZXQuaW5kZXhPZihuKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVUb0FkZC5wdXNoKG4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZU5hbWVTZXQgPSBub2RlTmFtZVNldC5jb25jYXQobmFtZVRvQWRkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAvL25vIGZvY3VzIGdyb3VwcyBtZWFucyB3ZSBhcmUgYXQgdG9wIGxldmVsXG4gICAgICAgICAgICAgICAgICAgIC8vU2hvdWxkIGFkZCBhbnkgdG9wIGxldmVsIG5vZGVzIHRoYXQgYXJlbid0XG4gICAgICAgICAgICAgICAgICAgIC8vYWxyZWFkeSB0aGVyZVxuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goY2hpbGRyZW5fc3RydWN0LnRvcExldmVsLCBmdW5jdGlvbihuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZU5hbWVTZXQuaW5kZXhPZihuKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVUb0FkZC5wdXNoKG4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZU5hbWVTZXQgPSBub2RlTmFtZVNldC5jb25jYXQobmFtZVRvQWRkKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL2Zvcm1hdHRpbmcgZGF0YVxuICAgICAgICAgICAgICAgIHZhciByYWRpdXMgPSBub2RlLnJhZGl1cyAvIHRoaXNHcmFwaC5jb25zdHMucmFkaXVzRGVjYXk7IFxuICAgICAgICAgICAgICAgIHZhciB4TG9jID0gbm9kZS54O1xuICAgICAgICAgICAgICAgIHZhciB5TG9jID0gbm9kZS55O1xuICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBub2RlLmFuY2VzdG9yc1sxXTtcbiAgICAgICAgICAgICAgICB2YXIgYW5jZXN0b3JzID0gbm9kZS5hbmNlc3RvcnMuc2xpY2UoMSk7XG4gICAgICAgICAgICAgICAgdmFyIG5ld05vZGUgPSBuZXcgVmlzdWFsaXplck5vZGUuTm9kZSh4TG9jLCB5TG9jLCBuZXdfbm9kZV9pZCwgbmV3X25vZGVfaWQsIHJhZGl1cywgcGFyZW50LCBhbmNlc3RvcnMpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5wdXNoKG5ld05vZGUpO1xuXG4gICAgICAgICAgICAgICAgLy9yZW1vdmUgYWxsIG5vZGVzIHRoYXQgd2lsbCBiZSBqb2luZWRcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRvX2JlX2RlbGV0ZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVfdG9fZGVsZXRlID0gdG9fYmVfZGVsZXRlZFtpXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnNwbGljZSh0aGlzR3JhcGgubm9kZXMuaW5kZXhPZihub2RlX3RvX2RlbGV0ZSksIDEpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3BsaWNlTGlua3NGb3JOb2RlKG5vZGVfdG9fZGVsZXRlKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgcmV0RGF0YSA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmdldEZsb3dCZXR3ZWVuU2V0KG5vZGVOYW1lU2V0KTtcbiAgICAgICAgICAgICAgICAvL2hvbGRzIHRoZSBub2RlRGF0YSB3aGljaCB3aWxsIGJlIHByb2Nlc3NlZFxuICAgICAgICAgICAgICAgIHZhciBub2Rlc1RvUHJvY2VzcyA9IFtdO1xuICAgICAgICAgICAgICAgIC8vZmluZGluZyB0aGUgbm9kZSBkYXRhIHRoYXQgY29ycmVzcG9uZHMgdG8gdGhlIHRvcCBsZXZlbFxuICAgICAgICAgICAgICAgIC8vbm9kZXMgdG8gYWRkIC0gbmFtZVRvQWRkLlxuICAgICAgICAgICAgICAgIHZhciBub2RlRGF0YSA9IHJldERhdGEubm9kZURhdGE7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2RlRGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAobmFtZVRvQWRkLmluZGV4T2Yobm9kZURhdGFbaV0uaWQpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNUb1Byb2Nlc3MucHVzaChub2RlRGF0YVtpXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL1RoZSB0b3AgbGV2ZWwgbm9kZXMgdGhhdCBhcmUgYWRkZWRcbiAgICAgICAgICAgICAgICB2YXIgbmV3Tm9kZXMgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5wcm9jZXNzTm9kZURhdGEobm9kZXNUb1Byb2Nlc3MpO1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaChuZXdOb2RlcywgZnVuY3Rpb24obikge1xuICAgICAgICAgICAgICAgICAgICBuLnJhZGl1cyA9IG4ucmFkaXVzIHx8IHRoaXNHcmFwaC5jb25zdHMuc3RhcnRSYWRpdXM7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzID0gdGhpc0dyYXBoLm5vZGVzLmNvbmNhdChuZXdOb2Rlcyk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5wcm9jZXNzTGlua0RhdGEocmV0RGF0YS5saW5rRGF0YSwgdGhpc0dyYXBoLm5vZGVzKTtcbiAgICAgICAgICAgICAgICAvL09ubHkga2VlcCB0b3AgbGV2ZWwgbm9kZXMgdGhhdCBoYXZlIGNvbm5lY3Rpb25zIHRvXG4gICAgICAgICAgICAgICAgLy90aGUgY3VycmVudCBmb2N1cyBncm91cFxuICAgICAgICAgICAgICAgIC8vd2UgcmVtb3ZlIHRoZSBub2RlIG5hbWUgZnJvbSBuYW1lVG9BZGQgaWYgd2UgYXJlXG4gICAgICAgICAgICAgICAgLy9rZWVwaW5nIGl0XG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLmxpbmtzLCBmdW5jdGlvbihsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2NoZWNraW5nIGlmIHRoZXJlIGV4aXN0cyBhIGxpbmsgdG91Y2hpbmcgZWFjaCBvZiBuYW1lVG9BZGRcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuYW1lVG9BZGQuaW5kZXhPZihsLnNvdXJjZS5pZCkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzWzBdID09PSBsLnRhcmdldC5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkLnNwbGljZShuYW1lVG9BZGQuaW5kZXhPZihsLnNvdXJjZS5pZCksIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobmFtZVRvQWRkLmluZGV4T2YobC50YXJnZXQuaWQpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwc1swXSA9PT0gbC5zb3VyY2UucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVUb0FkZC5zcGxpY2UobmFtZVRvQWRkLmluZGV4T2YobC50YXJnZXQuaWQpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy9XZSB3YW50IHRvIGtlZXAgdGhlbSBhbGxcbiAgICAgICAgICAgICAgICAgICAgLy9zaW5jZSBhbnkgbGVmdCBpbiBuYW1lVG9BZGQgd2lsbCBiZSByZW1vdmVkLFxuICAgICAgICAgICAgICAgICAgICAvL3dlIHJlc2V0IG5hbWVUb0FkZCBoZXJlLlxuICAgICAgICAgICAgICAgICAgICBuYW1lVG9BZGQgPSBbXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy93aGF0ZXZlciBpcyByZW1haW5pbmcgaW4gbmFtZVRvQWRkIGlzbid0IGNvbm5lY3RlZFxuICAgICAgICAgICAgICAgIC8vdG8gdGhlIGZvY3VzIGdyb3VwLCBzbyB3ZSBzaG91bGQgcmVtb3ZlIGl0LlxuICAgICAgICAgICAgICAgIHZhciBub2RlVG9SZW1vdmUgPSBbXTtcbiAgICAgICAgICAgICAgICBpZiAobmFtZVRvQWRkLmxlbmd0aCAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXNHcmFwaC5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWVUb0FkZC5pbmRleE9mKHRoaXNHcmFwaC5ub2Rlc1tpXS5pZCkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkLnNwbGljZShuYW1lVG9BZGQuaW5kZXhPZih0aGlzR3JhcGgubm9kZXNbaV0uaWQpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3BsaWNlTGlua3NGb3JOb2RlKHRoaXNHcmFwaC5ub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZVRvUmVtb3ZlLnB1c2godGhpc0dyYXBoLm5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobmFtZVRvQWRkLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKG5vZGVUb1JlbW92ZSwgZnVuY3Rpb24obikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMuc3BsaWNlKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG4pLCAxKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0Tm9kZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdExpbmtzKCk7XG5cbiAgICAgICAgICAgICAgICBzdGF0ZVN1cGVyLnNwbGl0Tm9kZXMuc3BsaWNlKHN0YXRlU3VwZXIuc3BsaXROb2Rlcy5pbmRleE9mKG5ld05vZGUuaWQpLCAxKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBuZXdOb2RlOyBcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgYWZ0ZXIgYSBzaW5nbGUgbm9kZSBpcyBqb2luZWRcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogSWYgdGhlIGZvY3VzIGdyb3VwIGhhcyBiZWVuIHNlZW4gYmVmb3JlLCBpdCB3aWxsXG4gICAgICAgICAgICAgKiBsb2FkIHRoYXQgbGF5b3V0LiBPdGhlcndpc2UsIGl0IHdpbGwgcnVuIGEgZDMgZm9yY2VcbiAgICAgICAgICAgICAqIHNpbXVsYXRpb24gdG8gZ2VuZXJhdGUgb25lLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbmV3Tm9kZSAgVGhlIG5ldyBub2RlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGpvaW5Ob2RlRXZlbnQobmV3Tm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5ID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIC8vaWYgdGhlIGxhc3QgZXZlbnQgaGFzIHRoZSBzYW1lIGlkLCBpdCBtdXN0IGJlIHRoZVxuICAgICAgICAgICAgICAgIC8vb3BwcG9zaXRlIG9mIHRoaXMgZXZlbnQsIHNvIHdlIHJlbW92ZSB0aGF0IGV2ZW50IGZyb21cbiAgICAgICAgICAgICAgICAvL3RoZSBldmVudCBzdGFjay5cbiAgICAgICAgICAgICAgICAvL090aGVyd2lzZSwgd2UgYWRkIHRoZSBldmVudCB0byB0aGUgc3RhY2tcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCAhPT0gMCAmJlxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3Rvcnlbc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCAtIDFdLmlkID09PSBuZXdOb2RlLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeS5wb3AoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkucHVzaCh7aWQ6bmV3Tm9kZS5pZCwgZXZlbnQ6J2pvaW4nfSlcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuXG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF8uaW5jbHVkZXMoY2hpbGRyZW5fc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzBdXSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5pZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJmb2N1c1wiO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImNvbm5lY3RlZFwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvL3NldHRpbmcgYmFjayBidXR0b25cbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuYmFja0J1dHRvbkVsZW0gIT0gbnVsbCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuYmFja0J1dHRvbkVsZW0uZmFkZVRvKCdzbG93JywgMCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9zZXR0aW5nIHRpdGxlXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLnRpdGxlRWxlbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0gc3RhdGUuZm9jdXNHcm91cHNbMF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSAnICYgJyArIHN0YXRlLmZvY3VzR3JvdXBzWzFdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLnRpdGxlRWxlbS50ZXh0KHRleHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnNldExheW91dCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVuZG9lcyB0aGUgbGFzdCBzcGxpdCBvciBqb2luIGV2ZW50LlxuICAgICAgICAgICAgICogTWVhbnQgdG8gYmUgY2FsbGVkIGJ5IHRoZSBiYWNrIGJ1dHRvbi5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdW5kb0xhc3RFdmVudCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeSA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB2YXIgbGFzdCA9IHN0YXRlLmV2ZW50SGlzdG9yeVtzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgdmFyIGlkID0gbGFzdC5pZDtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZTtcbiAgICAgICAgICAgICAgICBpZiAobGFzdC5ldmVudCA9PT0gJ2pvaW4nKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUgPSB0aGlzR3JhcGguZmluZE5vZGVCeUlkKGlkKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQzbm9kZSA9IHRoaXNHcmFwaC5maW5kRDNOb2RlKGlkKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS5kYmxjbGljayhkM25vZGUsIG5vZGUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlSWQgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbaWRdWzBdO1xuICAgICAgICAgICAgICAgICAgICBub2RlID0gdGhpc0dyYXBoLmZpbmROb2RlQnlJZChub2RlSWQpO1xuICAgICAgICAgICAgICAgICAgICBzdXBlci5qb2luTm9kZS5jYWxsKHRoaXNQb2xpY3ksIG5vZGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBQb2xpY3k6IFNwbGl0Sm9pblZpZXdQb2xpY3lcbiAgICAgICAgfVxufV0pO1xuXG5cblxuXG5cblxuXG4iLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52aXN1YWxpemF0aW9uLmxpc3QnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWaXN1YWxpemF0aW9uTGlzdEN0cmwgYXMgdmlzdWFsaXphdGlvbkxpc3RDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Zpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbmxpc3QuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignVmlzdWFsaXphdGlvbkxpc3RDdHJsJywgW1wiJHNjb3BlXCIsIFwiJGh0dHBcIiwgJ1Zpc3VhbGl6YXRpb25TZXJ2aWNlJywgJyRpbnRlcnZhbCcsIFxuICAgICAgICBmdW5jdGlvbigkc2NvcGUsICRodHRwLCBWaXN1YWxpemF0aW9uU2VydmljZSwgJGludGVydmFsKSB7XG4gICAgICAgICAgICAvL3RvIHNlZSB0aGUgZXhwZWN0ZWQgZm9ybWF0IHRvIGJlIHJldHVybmVkIGZyb20gdGhlc2UgY2FsbHMsXG4gICAgICAgICAgICAvL2xvb2sgYXQgYXBwL2NvbXBvbmVudHMvZ3JhcGhvYmplY3RzL2RhdGFzb3VyY2UvdmlzdWFsaXplcmRhdGFzb3VyY2UuanNcbiAgICAgICAgICAgIHZhciBzdWNjZXNzR3JhcGhEYXRhQ2FsbGJhY2sgPSBmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgbGlua3MgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZUlkcyA9IFtdO1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaChyZXN1bHQucmVzdWx0c1swXS5zZXJpZXMsIGZ1bmN0aW9uKHNlcmllcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZW5kcG9pbnQgPSBzZXJpZXMudGFncy5FbmRwb2ludElQO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJvdmlkZXIgPSBzZXJpZXMudGFncy5Qcm92aWRlcklQO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZTtcbiAgICAgICAgICAgICAgICAgICAgLy9jcmVhdGluZyBub2Rlc1xuICAgICAgICAgICAgICAgICAgICBpZiAoXy5pbmNsdWRlcyhub2RlSWRzLCBlbmRwb2ludCkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogZW5kcG9pbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGVuZHBvaW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNlc3RvcnM6IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlkcy5wdXNoKGVuZHBvaW50KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoXy5pbmNsdWRlcyhub2RlSWRzLCBwcm92aWRlcikgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogcHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHByb3ZpZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNlc3RvcnM6IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlkcy5wdXNoKHByb3ZpZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvL2NyZWF0aW5nIGxpbmtzXG4gICAgICAgICAgICAgICAgICAgIHZhciBsaW5rT3V0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiBlbmRwb2ludCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogcHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ6IHNlcmllcy52YWx1ZXNbMF1bMl1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgbGlua3MucHVzaChsaW5rT3V0KTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxpbmtJbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogcHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IGVuZHBvaW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0OiBzZXJpZXMudmFsdWVzWzBdWzFdXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGxpbmtzLnB1c2gobGlua0luKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAkc2NvcGUubm9kZXMgPSBub2RlcztcbiAgICAgICAgICAgICAgICAkc2NvcGUubGlua3MgPSBsaW5rcztcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAvL2luaXRpYWwgY2FsbFxuICAgICAgICAgICAgVmlzdWFsaXphdGlvblNlcnZpY2UuZ2V0R3JhcGhEYXRhKCkudGhlbihzdWNjZXNzR3JhcGhEYXRhQ2FsbGJhY2ssIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy93aWxsIGZhaWwgc2lsZW50bHksIGdyYXBoIHdvbid0IGJlIGRpc3BsYXllZFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkgeyAkaW50ZXJ2YWwuY2FuY2VsKCRzY29wZS5ncmFwaERhdGFJbnRlcnZhbCk7IH0pO1xuXG4gICAgICAgICAgICBWaXN1YWxpemF0aW9uU2VydmljZS5nZXRTdHJ1Y3R1cmVEYXRhKCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy90byBzZWUgdGhlIGV4cGVjdGVkIGZvcm0gb2YgYW5jZXN0b3Jfc3RydWN0IGFuZCBjaGlsZHJlbl9zdHJ1Y3QsIFxuICAgICAgICAgICAgICAgIC8vbG9vayBhdCBhcHAvY29tcG9uZW50cy9ncmFwaG9iamVjdHMvZGF0YXNvdXJjZS92aXN1YWxpemVyZGF0YXNvdXJjZS5qc1xuICAgICAgICAgICAgICAgICRzY29wZS5hbmNlc3RvcnNfc3RydWN0ID0gcmVzdWx0LmFuY2VzdG9yc19zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoaWxkcmVuX3N0cnVjdCA9IHJlc3VsdC5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxhYmVscyA9IHJlc3VsdC5sYWJlbHM7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlcnZpY2VTZWxlY3RvcnMgPSByZXN1bHQuc2VydmljZVNlbGVjdG9ycztcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy93aWxsIGZhaWwgc2lsZW50bHksIGdyYXBoIHdvbid0IGJlIGRpc3BsYXllZFxuICAgICAgICAgICAgfSk7XG4gICAgfV0pO1xuXG5cblxuXG5cblxuXG5cblxuXG5cbiIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicpXG4gICAgLmZhY3RvcnkoJ1Zpc3VhbGl6YXRpb25TZXJ2aWNlJywgWyckaHR0cCcsICckcScsIGZ1bmN0aW9uICgkaHR0cCwgJHEpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1ha2VzIGEgZ2V0IHJlcXVlc3Qgd2l0aCB0aGUgdXJsIGFuZCBjb25maWcuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICB1cmwgICAgIFRoZSB1cmxcbiAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGNvbmZpZyAgVGhlIGNvbmZpZ3VyYXRpb25zXG4gICAgICAgICAqIEByZXR1cm4gICAgIHskSHR0cCBQcm9taXNlfSAgIFByb21pc2Ugb2YgdGhlIHJlcXVlc3RcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIG1ha2VHZXQodXJsLCBjb25maWcpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAkaHR0cC5nZXQodXJsLCBjb25maWcpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYWtlcyBhIHBvc3QgcmVxdWVzdCB3aXRoIHRoZSB1cmwgYW5kIGRhdGFcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHVybCAgICAgVGhlIHVybFxuICAgICAgICAgKiBAcGFyYW0gICAgICB7SlNPTn0gICAgZGF0YSAgICBUaGUgZGF0YVxuICAgICAgICAgKiBAcmV0dXJuICAgICB7JEh0dHAgUHJvbWlzZX0gICBQcm9taXNlIG9mIHRoZSByZXF1ZXN0XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBtYWtlUG9zdCh1cmwsIGRhdGEpIHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogY29udmVydHMgdGhlIGRhdGEgaW50byB4LXd3dy1mcm9tLXVybGVuY29kZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SlNPTn0gIG9iaiAgICAgSlNPTiBkYXRhIG9iamVjdFxuICAgICAgICAgICAgICogQHJldHVybiAgICAge3N0cmluZ30gIHgtd3d3LWZvcm0tdXJsZW5jb2RlZCBzdHJpbmdcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdmFyIHBhcmFtID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gJycsIG5hbWUsIHZhbHVlLCBmdWxsU3ViTmFtZSwgc3ViTmFtZSwgc3ViVmFsdWUsIGlubmVyT2JqLCBpO1xuICAgICAgICAgICAgICAgIGZvciAobmFtZSBpbiBvYmopIHtcbiAgICAgICAgICAgICAgICAgIHZhbHVlID0gb2JqW25hbWVdO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGk9MDsgaTx2YWx1ZS5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlZhbHVlID0gdmFsdWVbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVsbFN1Yk5hbWUgPSBuYW1lICsgJ1snICsgaSArICddJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbm5lck9iaiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlubmVyT2JqW2Z1bGxTdWJOYW1lXSA9IHN1YlZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ICs9IHBhcmFtKGlubmVyT2JqKSArICcmJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIE9iamVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChzdWJOYW1lIGluIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViVmFsdWUgPSB2YWx1ZVtzdWJOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdWxsU3ViTmFtZSA9IG5hbWUgKyAnWycgKyBzdWJOYW1lICsgJ10nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlubmVyT2JqID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5uZXJPYmpbZnVsbFN1Yk5hbWVdID0gc3ViVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkgKz0gcGFyYW0oaW5uZXJPYmopICsgJyYnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYodmFsdWUgIT09IHVuZGVmaW5lZCAmJiB2YWx1ZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkgKz0gZW5jb2RlVVJJQ29tcG9uZW50KG5hbWUpICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKSArICcmJztcbiAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHF1ZXJ5Lmxlbmd0aCA/IHF1ZXJ5LnN1YnN0cigwLCBxdWVyeS5sZW5ndGggLSAxKSA6IHF1ZXJ5O1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICB1cmw6dXJsLFxuICAgICAgICAgICAgICAgIG1ldGhvZDonUE9TVCcsXG4gICAgICAgICAgICAgICAgZGF0YTogZGF0YSxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCdcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHRyYW5zZm9ybVJlcXVlc3Q6IFtmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhbmd1bGFyLmlzT2JqZWN0KGRhdGEpICYmIFN0cmluZyhkYXRhKSAhPT0gJ1tvYmplY3QgRmlsZV0nID8gcGFyYW0oZGF0YSkgOiBkYXRhO1xuICAgICAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0R3JhcGhEYXRhKCkge1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuVklTVUFMSVpBVElPTl9FTkRQT0lOVDtcbiAgICAgICAgICAgIHVybCArPSAnaW5mbHV4L3F1ZXJ5JztcbiAgICAgICAgICAgIHZhciBjb25maWcgPSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgICAgICAgICAgIGRiOlwidGVsZWdyYWZcIixcbiAgICAgICAgICAgICAgICAgICAgcTpcIlNFTEVDVCBCeXRlc0luLCBCeXRlc091dCwgRW5kcG9pbnRJUCwgUHJvdmlkZXJJUCBGUk9NIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDFtIEdST1VQIEJZICogTElNSVQgMVwiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBtYWtlR2V0KHVybCwgY29uZmlnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldFN0cnVjdHVyZURhdGEoKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WSVNVQUxJWkFUSU9OX0VORFBPSU5UO1xuICAgICAgICAgICAgdXJsICs9ICdzZXJ2aWNlcyc7XG4gICAgICAgICAgICByZXR1cm4gbWFrZUdldCh1cmwpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gYnVpbGRXaGVyZVF1ZXJ5KHBvaW50cywgdHlwZSkge1xuICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gXCIoXCI7XG4gICAgICAgICAgICBxdWVyeSArPSB0eXBlICsgXCI9XCI7XG4gICAgICAgICAgICBxdWVyeSArPSBcIidcIiArIHBvaW50c1swXSArIFwiJyBcIjtcbiAgICAgICAgICAgIC8vc3RhcnRzIGF0IDEsIHNvIHdpbGwgbm90IHJ1biBpZiBsZW5ndGggaXMgMVxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBwb2ludHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBxdWVyeSArPSAnT1IgJztcbiAgICAgICAgICAgICAgICBxdWVyeSArPSB0eXBlICsgXCI9XCI7XG4gICAgICAgICAgICAgICAgcXVlcnkgKz0gXCInXCIgKyBwb2ludHNbaV0gKyBcIicgXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBxdWVyeSArPSBcIilcIjtcbiAgICAgICAgICAgIHJldHVybiBxdWVyeTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldEVkZ2VEYXRhKHNvdXJjZUxpc3QsIHRhcmdldExpc3QsIHRpbWUpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLlZJU1VBTElaQVRJT05fRU5EUE9JTlQ7XG4gICAgICAgICAgICB1cmwgKz0gJ2luZmx1eC9xdWVyeSc7XG5cbiAgICAgICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICBkYiA6IFwidGVsZWdyYWZcIixcbiAgICAgICAgICAgICAgICAgICAgcTogXCJTRUxFQ1Qgc3VtKFwiICsgJ0J5dGVzT3V0JyArIFwiKSBmcm9tIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDE1cyBBTkQgXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeShzb3VyY2VMaXN0LCBcIkVuZHBvaW50SVBcIikgK1wiIEFORCBcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeSh0YXJnZXRMaXN0LCAnUHJvdmlkZXJJUCcpIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgXCJHUk9VUCBCWSB0aW1lKDIwcykgTElNSVQgMTsgU0VMRUNUIHN1bShcIiArICdCeXRlc0luJyArIFwiKSBmcm9tIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDE1cyBBTkQgXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeShzb3VyY2VMaXN0LCAnUHJvdmlkZXJJUCcpICtcIiBBTkQgXCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkodGFyZ2V0TGlzdCwgJ0VuZHBvaW50SVAnKSBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIFwiR1JPVVAgQlkgdGltZSgyMHMpIGZpbGwoMCkgTElNSVQgMVwiXG4gICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIG1ha2VQb3N0KHVybCwgZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICBcblxuICAgICAgICBmdW5jdGlvbiBnZXRPbGRFZGdlRGF0YShzb3VyY2VMaXN0LCB0YXJnZXRMaXN0KSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WSVNVQUxJWkFUSU9OX0VORFBPSU5UO1xuICAgICAgICAgICAgdXJsICs9ICdpbmZsdXgvcXVlcnknO1xuICAgICAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgICAgIGRiIDogXCJ0ZWxlZ3JhZlwiLFxuICAgICAgICAgICAgICAgICAgICBxOiBcIlNFTEVDVCBzdW0oXCIgKyAnQnl0ZXNPdXQnICsgXCIpIEZST00gaHR0cGpzb25fc3Zjc3RhdHMgV0hFUkUgdGltZSA+IG5vdygpIC0gMW0gQU5EIFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkoc291cmNlTGlzdCwgXCJFbmRwb2ludElQXCIpICtcIiBBTkQgXCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkodGFyZ2V0TGlzdCwgXCJQcm92aWRlcklQXCIpIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgXCIgR1JPVVAgQlkgdGltZSgxMHMpIGZpbGwoMCkgTElNSVQgNjsgU0VMRUNUIHN1bShcIiArICdCeXRlc0luJyArIFwiKSBGUk9NIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDFtIEFORCBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHNvdXJjZUxpc3QsIFwiUHJvdmlkZXJJUFwiKSArXCIgQU5EIFwiIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHRhcmdldExpc3QsIFwiRW5kcG9pbnRJUFwiKSBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIFwiIEdST1VQIEJZIHRpbWUoMTBzKSBmaWxsKDApIExJTUlUIDZcIlxuICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBtYWtlUG9zdCh1cmwsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldEdyYXBoRGF0YTogZ2V0R3JhcGhEYXRhLFxuICAgICAgICAgICAgZ2V0U3RydWN0dXJlRGF0YTogZ2V0U3RydWN0dXJlRGF0YSxcbiAgICAgICAgICAgIGdldEVkZ2VEYXRhOiBnZXRFZGdlRGF0YSxcbiAgICAgICAgICAgIGdldE9sZEVkZ2VEYXRhOiBnZXRPbGRFZGdlRGF0YVxuICAgICAgICB9XG4gICAgfV0pO1xuXG5cblxuXG5cblxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA2LzMvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudm9sdW1lcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZvbHVtZXMuY3JlYXRlJywge1xuICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZvbHVtZXMvdm9sdW1lY3JlYXRlLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1ZvbHVtZUNyZWF0ZUN0cmwgYXMgdm9sdW1lQ3JlYXRlQ3RybCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1ZvbHVtZUNyZWF0ZUN0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnVm9sdW1lc01vZGVsJywgJ1N0b3JhZ2VQb2xpY2llc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIFZvbHVtZXNNb2RlbCwgU3RvcmFnZVBvbGljaWVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2b2x1bWVDcmVhdGVDdHJsID0gdGhpcztcbiAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5maWxlc3lzdGVtcyA9IFsnZXh0NCcsICdidHJmcyddO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1ZvbHVtZXNNb2RlbCgpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUudm9sdW1lcy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub1ZvbHVtZXNNb2RlbCgpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZXQgc3RvcmFnZSBwb2xpY2llcy5cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGdldFN0b3JhZ2VQb2xpY2llcygpIHtcbiAgICAgICAgICAgIFN0b3JhZ2VQb2xpY2llc01vZGVsLmdldCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwucG9saWNpZXMgPSByZXN1bHQ7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBhcHBseVBvbGljeVNldHRpbmdzKCkge1xuICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUucG9saWN5ID0gdm9sdW1lQ3JlYXRlQ3RybC5zZWxlY3RlZFBvbGljeS5uYW1lO1xuICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUuYmFja2VuZHMgPSB2b2x1bWVDcmVhdGVDdHJsLnNlbGVjdGVkUG9saWN5LmJhY2tlbmRzO1xuICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUuZHJpdmVyID0gdm9sdW1lQ3JlYXRlQ3RybC5zZWxlY3RlZFBvbGljeS5kcml2ZXI7XG4gICAgICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLm5ld1ZvbHVtZS5jcmVhdGUgPSB2b2x1bWVDcmVhdGVDdHJsLnNlbGVjdGVkUG9saWN5LmNyZWF0ZTtcbiAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwubmV3Vm9sdW1lLnJ1bnRpbWUgPSB2b2x1bWVDcmVhdGVDdHJsLnNlbGVjdGVkUG9saWN5LnJ1bnRpbWU7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlVm9sdW1lKCkge1xuICAgICAgICAgICAgLy9mb3JtIGNvbnRyb2xsZXIgaXMgaW5qZWN0ZWQgYnkgdGhlIGh0bWwgdGVtcGxhdGVcbiAgICAgICAgICAgIC8vY2hlY2tpbmcgaWYgYWxsIHZhbGlkYXRpb25zIGhhdmUgcGFzc2VkXG4gICAgICAgICAgICBpZiAodm9sdW1lQ3JlYXRlQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcih2b2x1bWVDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcih2b2x1bWVDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBhcHBseVBvbGljeVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgVm9sdW1lc01vZGVsLmNyZWF0ZSh2b2x1bWVDcmVhdGVDdHJsLm5ld1ZvbHVtZSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvVm9sdW1lc01vZGVsKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHZvbHVtZUNyZWF0ZUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmVzZXRGb3JtKCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcih2b2x1bWVDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwubmV3Vm9sdW1lID0ge1xuICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgIFwiYmFja2VuZHNcIjoge30sXG4gICAgICAgICAgICAgICAgXCJkcml2ZXJcIjoge30sXG4gICAgICAgICAgICAgICAgXCJjcmVhdGVcIjoge30sXG4gICAgICAgICAgICAgICAgXCJydW50aW1lXCI6IHt9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwuY3JlYXRlVm9sdW1lID0gY3JlYXRlVm9sdW1lO1xuICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLmNhbmNlbENyZWF0aW5nID0gY2FuY2VsQ3JlYXRpbmc7XG4gICAgICAgIGdldFN0b3JhZ2VQb2xpY2llcygpO1xuICAgICAgICByZXNldEZvcm0oKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD12b2x1bWVjcmVhdGVjdHJsLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSBjc2hhbXB1ciBvbiA4LzkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudm9sdW1lcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZvbHVtZXMuY29weScsIHtcbiAgICAgICAgICAgIHVybDogJy9jb3B5LycsXG4gICAgICAgICAgICBwYXJhbXM6IHsgc25hcHNob3Q6IG51bGwsIHBvbGljeTogbnVsbCwgdm9sdW1lOiBudWxsIH0sXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVm9sdW1lU25hcHNob3RDb3B5Q3RybCBhcyB2b2x1bWVTbmFwc2hvdENvcHlDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndm9sdW1lcy92b2x1bWVzbmFwc2hvdGNvcHkuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1ZvbHVtZVNuYXBzaG90Q29weUN0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckaHR0cCcsICdWb2x1bWVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgJHNjb3BlLCAkaW50ZXJ2YWwsICRodHRwLCBWb2x1bWVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2b2x1bWVTbmFwc2hvdENvcHlDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ29weSgpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUudm9sdW1lcy5kZXRhaWxzJywgeyBrZXk6ICRzdGF0ZVBhcmFtcy5wb2xpY3kgKyAnLycgKyAkc3RhdGVQYXJhbXMudm9sdW1lIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdvVG9OZXdWb2x1bWUoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZvbHVtZXMuZGV0YWlscycsIHsga2V5OiAkc3RhdGVQYXJhbXMucG9saWN5ICsgJy8nICsgdm9sdW1lU25hcHNob3RDb3B5Q3RybC5uZXd2b2x1bWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY29weVNuYXBzaG90KCkge1xuICAgICAgICAgICAgaWYgKHZvbHVtZVNuYXBzaG90Q29weUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iodm9sdW1lU25hcHNob3RDb3B5Q3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIodm9sdW1lU25hcHNob3RDb3B5Q3RybCk7XG4gICAgICAgICAgICAgICAgdmFyIG1vZGVsID0ge307XG4gICAgICAgICAgICAgICAgbW9kZWwucG9saWN5ID0gJHN0YXRlUGFyYW1zLnBvbGljeTtcbiAgICAgICAgICAgICAgICBtb2RlbC5uYW1lID0gJHN0YXRlUGFyYW1zLnZvbHVtZTtcbiAgICAgICAgICAgICAgICBWb2x1bWVzTW9kZWwuY29weShtb2RlbCwgJHN0YXRlUGFyYW1zLnNuYXBzaG90LCB2b2x1bWVTbmFwc2hvdENvcHlDdHJsLm5ld3ZvbHVtZSlcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZVNuYXBzaG90Q29weUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBnb1RvTmV3Vm9sdW1lKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVTbmFwc2hvdENvcHlDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHZvbHVtZVNuYXBzaG90Q29weUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdm9sdW1lU25hcHNob3RDb3B5Q3RybC5wb2xpY3kgPSAkc3RhdGVQYXJhbXMucG9saWN5O1xuICAgICAgICB2b2x1bWVTbmFwc2hvdENvcHlDdHJsLnZvbHVtZSA9ICRzdGF0ZVBhcmFtcy52b2x1bWU7XG4gICAgICAgIHZvbHVtZVNuYXBzaG90Q29weUN0cmwuc25hcHNob3QgPSAkc3RhdGVQYXJhbXMuc25hcHNob3Q7XG4gICAgICAgIHZvbHVtZVNuYXBzaG90Q29weUN0cmwuY29weVNuYXBzaG90ID0gY29weVNuYXBzaG90O1xuICAgICAgICB2b2x1bWVTbmFwc2hvdENvcHlDdHJsLmNhbmNlbENvcHkgPSBjYW5jZWxDb3B5O1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXZvbHVtZXNuYXBzaG90Y29weWN0cmwuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZBY2l2YWxpZFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvbm9kZXMvYWNpdmFsaWQuaHRtbCcsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIGZvcm06IFwiPVwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7IiwiYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZDb250cm9saW50ZXJmYWNlXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy9ub2Rlcy9jb250cm9saW50ZXJmYWNlLmh0bWwnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBleHRyYXZhcnM6IFwiPVwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7IiwiYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZOZXR3b3JrbW9kZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvbm9kZXMvbmV0d29ya21vZGUuaHRtbCcsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIGV4dHJhdmFyczogXCI9XCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTsiLCJhbmd1bGFyLm1vZHVsZShcImNvbnRpdi5kaXJlY3RpdmVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dlNjaGVkdWxlclwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvbm9kZXMvc2NoZWR1bGVyLmh0bWwnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBleHRyYXZhcnM6IFwiPVwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
>>>>>>> Stashed changes
