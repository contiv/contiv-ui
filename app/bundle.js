"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function BaseCollection(e,t,n){this.models=[],this.$http=e,this.$q=t,this.url=n}function Collection(e,t,n){BaseCollection.call(this,e,t,n),this.inspectStats={}}angular.module("contiv.graph",[]),angular.module("contiv.directives",[]);var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();angular.module("contiv.graph").factory("DataSource",["Node","Link",function(e,t){var n=function(){function n(e,t){_classCallCheck(this,n),this.nodes=e,this.links=t}return _createClass(n,[{key:"updateNodes",value:function(e){this.nodes=e}},{key:"updateLinks",value:function(e){this.links=e}},{key:"nodeIdToName",value:function(e){for(var t=this.nodes,n=0;n<t.length;n++)if(t[n].id==e)return t[n].name}},{key:"processNodeData",value:function(t){var n=[];return _.forEach(t,function(t){var o=new e.Node(null,null,t.id,t.text,null);n.push(o)}),n}},{key:"processLinkData",value:function(e,n){function o(e,t){for(var n=0;n<t.length;n++)if(e==t[n].id)return t[n]}for(var i=[],r=0;r<e.length;r++)if(e[r].source!=e[r].target){var a=o(e[r].source,n),l=o(e[r].target,n);if(null==a||null==l)continue;var s=new t.Link(a,l);i.push(s)}return i}}]),n}();return{DataSource:n}}]),angular.module("contiv.models",[]);var ContivGlobals=function(){return{NETWORKS_ENDPOINT:"/netmaster/api/v1/networks/",NETWORKS_INSPECT_ENDPOINT:"/netmaster/api/v1/inspect/networks/",SERVICELBS_INSPECT_ENDPOINT:"/netmaster/api/v1/inspect/serviceLBs/",POLICIES_ENDPOINT:"/netmaster/api/v1/policys/",RULES_ENDPOINT:"/netmaster/api/v1/rules/",APPLICATIONGROUPS_ENDPOINT:"/netmaster/api/v1/endpointGroups/",SERVICELBS_ENDPOINT:"/netmaster/api/v1/serviceLBs/",ORGANIZATIONS_ENDPOINT:"/netmaster/api/v1/tenants/",NETWORK_SETTINGS_ENDPOINT:"/netmaster/api/v1/globals/",NETPROFILES_ENDPOINT:"/netmaster/api/v1/netprofiles/",BGPS_ENDPOINT:"/netmaster/api/v1/Bgps/",BGPS_INSPECT_ENDPOINT:"/netmaster/api/v1/inspect/Bgps/",VISUALIZATION_ENDPOINT:"/visualization/",VOLUMES_ENDPOINT:"/volmaster/volumes/",VOLUMES_CREATE_ENDPOINT:"/volmaster/volumes/create/",VOLUMES_DELETE_ENDPOINT:"/volmaster/volumes/remove/",VOLUMES_COPYSNAPSHOTS_ENDPOINT:"/volmaster/volumes/copy",VOLUMES_USES_ENDPOINT:"/volmaster/uses/mounts/",VOLUMES_SNAPSHOTS_ENDPOINT:"/volmaster/snapshots/",STORAGEPOLICIES_ENDPOINT:"/volmaster/policies/",VOLUMES_GLOBAL_ENDPOINT:"/volmaster/global/",NODES_LIST_ENDPOINT:"/info/nodes",NODES_DISCOVER_ENDPOINT:"/discover/nodes",NODES_COMMISSION_ENDPOINT:"/commission/nodes",NODES_DECOMMISSION_ENDPOINT:"/decommission/nodes",NODES_MAINTENANCE_ENDPOINT:"/maintenance/nodes",NODES_LAST_JOB_ENDPOINT:"/info/job/last",NODES_ACTIVE_JOB_ENDPOINT:"/info/job/active",NODES_SETTINGS_SET_ENDPOINT:"/globals",NODES_SETTINGS_GET_ENDPOINT:"/info/globals",REFRESH_INTERVAL:5e3,CIDR_REGEX:"^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]).){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(/([0-9]|[1-2][0-9]|3[0-2]))$",VLAN_REGEX:"^([0-9]{1,4}?-[0-9]{1,4}?)$",VXLAN_REGEX:"^([0-9]{1,8}?-[0-9]{1,8}?)$",NUMBER_REGEX:"^[0-9]*$"}}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();angular.module("contiv.graph").factory("VisualizerDataSource",["DataSource","VisualizerNode","VisualizerLink",function(e,t,n){var o=function(e){function o(e,t,n,i,r,a){_classCallCheck(this,o);var l=_possibleConstructorReturn(this,Object.getPrototypeOf(o).call(this,e,t));return l.children_struct=n,l.ancestors_struct=i,l.labels=r,l.selectors=a,l}return _inherits(o,e),_createClass(o,[{key:"hasChild",value:function(e){return null!=this.children_struct[e]}},{key:"setAncestors",value:function(){var e=this,t=!1;_.forEach(e.nodes,function(n){n.ancestors=e.ancestors_struct[n.id]||[],_.isEmpty(n.ancestors)===!1?n.parent=n.ancestors[0]:0==_.includes(e.children_struct.topLevel,n.id)&&(n.ancestors.push("client"),e.ancestors_struct[n.id]=["client"],t===!1&&(t=!0,e.children_struct.topLevel.push("client"),e.children_struct.client=[]),e.children_struct.client.push(n.id))})}},{key:"getTopLevelFlow",value:function(){return this.getFlowBetweenSet(this.children_struct.topLevel)}},{key:"getFlowBetweenSet",value:function(e){for(var t=this.nodes,n={},o=0;o<t.length;o++){var i=t[o];if(null===i.ancestors)n[i.id]=i.name;else for(var r=0;r<e.length;r++)if(i.ancestors.indexOf(e[r])>-1){n[i.id]=e[r];break}}for(var a=this.links,l=[],o=0;o<a.length;o++){var s=[];s.source=n[a[o].source]||a[o].source,s.target=n[a[o].target]||a[o].target,s.weight=a[o].weight,l.push(s)}for(var c=[],o=0;o<e.length;o++){var u=[];u.id=e[o],u.text=this.nodeIdToName(e[o])||e[o],u.ancestors=this.ancestors_struct[e[o]]||this.ancestors_struct[u.text]||[],_.isEmpty(u.ancestors)===!1?u.parent=u.ancestors[0]:u.parent=null,c.push(u)}return{nodeData:c,linkData:l}}},{key:"processNodeData",value:function(e){var n=[];return _.forEach(e,function(e){var o=new t.Node(null,null,e.id,e.text,null,e.parent,e.ancestors,null,null);n.push(o)}),n}},{key:"processLinkData",value:function(e,t){function o(e,t){for(var n=0;n<t.length;n++)if(e==t[n].id)return t[n]}for(var i=[],r={},a=0;a<e.length;a++)if(e[a].source!=e[a].target){var l=o(e[a].source,t),s=o(e[a].target,t),c=e[a].weight;if(null==l||null==s)continue;if(void 0===r[l.id+"-"+s.id]){var u=new n.Link(l,s,c);r[l.id+"-"+s.id]=u,i.push(u)}else{var d=r[l.id+"-"+s.id];d.setWeight(d.getRawWeight()+c),d.increaseCount()}}return i}}]),o}(e.DataSource);return{DataSource:o}}]),angular.module("contiv.utils",[]);var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();angular.module("contiv.graph").factory("Graph",["PolicyService",function(e){var t=function(){function t(n,o,i){_classCallCheck(this,t);var r=this;r.nodes=o||[],r.links=i||[],r.defaultNodePolicies=[],r.defaultPathPolicies=[],r.svgPolicy=new e.Policy,r.state={canZoom:!0,canPan:!0,initForce:!1,disableUpdate:!1},r.consts={circleGClass:"conceptG",graphClass:"graph",pathClass:"path",nodeClass:"circle",nodeText:"nodeText",startRadius:50,maxRadius:60,padding:5,displayOffset:60},n.on("mouseover",function(e){r.svgPolicy.mouseover.call(this,e)}).on("dblclick",function(e){r.svgPolicy.dblclick.call(this,e)}).on("contextmenu",function(e){r.svgPolicy.contextmenu.call(this,e)}).on("mouseout",function(e){r.svgPolicy.mouseout.call(this,e)}).on("mousedown",function(e){r.svgPolicy.mousedown.call(this,e)}).on("mouseup",function(e){r.svgPolicy.mouseup.call(this,e)});var a=n.append("svg:defs");a.append("svg:marker").attr("id","end-arrow").attr("viewBox","0 -5 10 10").attr("refX",20).attr("refY",-1).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5"),a.append("svg:marker").attr("id","mark-end-arrow").attr("viewBox","0 -5 10 10").attr("refX",7).attr("markerWidth",3.5).attr("markerHeight",3.5).attr("orient","auto").append("svg:path").attr("d","M0,-5L10,0L0,5"),r.svg=n,r.svgG=n.append("g").classed(r.consts.graphClass,!0);var l=r.svgG;r.paths=l.append("g").selectAll("g"),r.circles=l.append("g").selectAll("g"),r.initNodes(),r.initLinks(),r.setPositions();var s=function(){r.onWindowResize(n)};r.bindings={resize:s},$(window).resize(s)}return _createClass(t,[{key:"destroy",value:function(){var e=this;_(e.defaultNodePolicies).forEach(function(e){e.destroy()}),_(e.defaultPathPolicies).forEach(function(e){e.destroy()}),e.svgPolicy.destroy();for(var t in e.bindings)$(window).off(t,e.bindings[t])}},{key:"initNodes",value:function(){var e=this;_.forEach(e.nodes,function(t){t.initialize(e)})}},{key:"initLinks",value:function(){var e=this;_.forEach(e.links,function(t){t.initialize(e)})}},{key:"findNodeById",value:function(e){for(var t=this,n=0;n<t.nodes.length;n++)if(e===t.nodes[n].id)return t.nodes[n]}},{key:"findD3Node",value:function(e){var t,n=this;return n.circles.each(function(n){n.id===e&&(t=d3.select(this))}),t}},{key:"installDragPolicy",value:function(e){this.drag=e}},{key:"installSvgPolicy",value:function(e){this.svgPolicy=e}},{key:"installDefaultNodePolicy",value:function(e){var t=this;t.defaultNodePolicies.push(e),e.initialize(t)}},{key:"uninstallDefaultNodePolicy",value:function(e){var t;t="string"==typeof e?e:e.policyName,_(thisGraph.defaultNodePolicies).forEach(function(e,n){e.policyName===t&&(e.destroy(),thisGraph.defaultNodePolicies.splice(n,1))})}},{key:"getNodePolicy",value:function(e){var t=this;_(t.defaultNodePolicies).forEach(function(t,n){return t.policyName===e?t:void 0})}},{key:"installDefaultPathPolicy",value:function(e){var t=this;t.defaultPathPolicies.push(e),e.initialize(t)}},{key:"uninstallDefaultPathPolicy",value:function(e){var t,n=this;t="string"==typeof e?e:e.policyName,_(n.defaultPathPolicies).forEach(function(e,o){e.policyName===t&&(e.destroy(),n.defaultPathPolicies.splice(o,1))})}},{key:"pathPolicyEvent",value:function(e,t,n){var o=this;_(o.defaultPathPolicies).forEach(function(o){o[e](t,n)})}},{key:"nodePolicyEvent",value:function(e,t,n){var o=this;_.forEach(o.defaultNodePolicies,function(o){o[e](t,n)})}},{key:"installZoomPolicy",value:function(e){this.dragSvg=e,this.svg.call(this.dragSvg)}},{key:"onWindowResize",value:function(e){}},{key:"insertTitleLinebreaks",value:function(e,t){for(var n=this,o=t.split(/\s+/g),i=o.length,r=e.append("text").attr("class",n.consts.nodeText).attr("text-anchor","middle").attr("dy","-"+7.5*(i-1)),a=0;a<o.length;a++){var l=r.append("tspan").text(o[a]);a>0&&l.attr("x",0).attr("dy","15")}}},{key:"spliceLinksForNode",value:function(e){var t=this,n=t.links.filter(function(t){return t.source===e||t.target===e});n.map(function(e){t.links.splice(t.links.indexOf(e),1)})}},{key:"addNode",value:function(e){var t=this;t.nodes.push(e),e.initialize(t),t.updateGraph()}},{key:"removeNode",value:function(e){var t=this;t.nodes.splice(t.nodes.indexOf(e),1),t.spliceLinksForNode(e),t.updateGraph()}},{key:"addLink",value:function(e){var t=this;t.links.push(e),e.initialize(t),t.updateGraph()}},{key:"removeLink",value:function(e){var t=this;t.links.splice(t.links.indexOf(e),1),e.initialize(t),t.updateGraph()}},{key:"updateExistingPaths",value:function(e){e.each(function(e){e.updateAttr(d3.select(this),e)})}},{key:"updateNewPaths",value:function(e){var t=this;t.initLinks(),e.each(function(e){e.newPathAttr(d3.select(this),e)}),e.on("mouseover",function(e){e.hasPolicy?e.pathPolicyEvent("mouseover",d3.select(this),e):t.pathPolicyEvent("mouseover",d3.select(this),e)}).on("dblclick",function(e){e.hasPolicy?e.pathPolicyEvent("dblclick",d3.select(this),e):t.pathPolicyEvent("dblclick",d3.select(this),e)}).on("contextmenu",function(e){e.hasPolicy?e.pathPolicyEvent("contextmenu",d3.select(this),e):t.pathPolicyEvent("contextmenu",d3.select(this),e)}).on("mouseout",function(e){e.hasPolicy?e.pathPolicyEvent("mouseout",d3.select(this),e):t.pathPolicyEvent("mouseout",d3.select(this),e)}).on("mousedown",function(e){e.hasPolicy?e.pathPolicyEvent("mousedown",d3.select(this),e):t.pathPolicyEvent("mousedown",d3.select(this),e)}).on("mouseup",function(e){e.hasPolicy?e.pathPolicyEvent("mouseup",d3.select(this),e):t.pathPolicyEvent("mouseup",d3.select(this),e)}).call(t.drag)}},{key:"updateExistingNodes",value:function(){var e=this;e.circles=this.circles.data(e.nodes,function(e){return e.id}).each(function(e){e.updateAttr(d3.select(this),e)})}},{key:"updateNewNodes",value:function(e){var t=this;e.each(function(e){null==e.graph&&e.initialize(t),e.newNodeAttr(d3.select(this),e)}),e.on("mouseover",function(e){e.hasPolicy?e.nodePolicyEvent("mouseover",d3.select(this),e):t.nodePolicyEvent("mouseover",d3.select(this),e)}).on("dblclick",function(e){e.hasPolicy?e.nodePolicyEvent("dblclick",d3.select(this),e):t.nodePolicyEvent("dblclick",d3.select(this),e)}).on("contextmenu",function(e){e.hasPolicy?e.nodePolicyEvent("contextmenu",d3.select(this),e):t.nodePolicyEvent("contextmenu",d3.select(this),e)}).on("mouseout",function(e){e.hasPolicy?e.nodePolicyEvent("mouseout",d3.select(this),e):t.nodePolicyEvent("mouseout",d3.select(this),e)}).on("mousedown",function(e){e.hasPolicy?e.nodePolicyEvent("mousedown",d3.select(this),e):t.nodePolicyEvent("mousedown",d3.select(this),e)}).on("mouseup",function(e){e.hasPolicy?e.nodePolicyEvent("mouseup",d3.select(this),e):t.nodePolicyEvent("mouseup",d3.select(this),e)}).call(t.drag),e.append("circle").attr("r",function(e){return String(e.radius)}),e.each(function(e){t.insertTitleLinebreaks(d3.select(this),e.text)})}},{key:"d3ForceCollide",value:function(e){var t=this,n=t.consts,o=t.nodes,i=d3.geom.quadtree(o);return function(t){var o=t.radius+n.maxRadius+n.padding,r=t.x-o,a=t.x+o,l=t.y-o,s=t.y+o;i.visit(function(o,i,c,u,d){if(o.point&&o.point!==t){var p=t.x-o.point.x,v=t.y-o.point.y,f=Math.sqrt(p*p+v*v),h=t.radius+o.point.radius+n.padding;h>f&&(f=(f-h)/f*e,t.x-=p*=f,t.y-=v*=f,o.point.x+=p,o.point.y+=v)}return i>a||r>u||c>s||l>d})}}},{key:"d3ForceTick",value:function(e,t,n){for(var o=this,i=o.consts,r=i.displayOffset,a=o.nodes,l=d3.geom.quadtree(o.nodes),s=0,c=a.length;++s<c;)l.visit(this.d3ForceCollide(a[s]));o.circles.each(this.d3ForceCollide(.5)).attr("cx",function(e){return e.x=Math.max(e.radius+r,Math.min(t-r-e.radius,e.x))}).attr("cy",function(e){return e.y=Math.max(e.radius+r,Math.min(n-r-e.radius,e.y))}),o.paths.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y})}},{key:"d3ForceStart",value:function(){var e=this;e.paths.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y})}},{key:"d3ForceEnd",value:function(){var e=this;e.circles.attr("cx",function(e){return e.x}).attr("cy",function(e){return e.y}),e.paths.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y})}},{key:"d3ForceBounds",value:function(){var e=$("#visualization-graph").width(),t=$("#visualization-graph").height(),n=e,o=t;return{width:n,height:o}}},{key:"setForce",value:function(e){var t=this,n=t.nodes,o=t.links;if(!_.isEmpty(n)){var i=t.d3ForceBounds(),r=d3.layout.force().size([i.width,i.height]).nodes(n).charge(function(e){return-6e3}).links(o);r.linkDistance(i.width/3),r.linkStrength(.2),r.gravity(.2),r.on("tick",function(e){t.d3ForceTick.call(t,e,i.width,i.height)}),r.on("start",function(){t.d3ForceStart.call(t)}),r.on("end",function(){t.d3ForceEnd.call(t)}),r.start();for(var a=0;r.alpha()>.01&&150>a;)r.tick(),a+=1;r.stop(),null!=e&&e()}}},{key:"setPositions",value:function(){for(var e=this,t=e.consts.displayOffset,n=$("#visualization-graph").width(),o=$("#visualization-graph").height(),i=n-2*t,r=o-2*t,a=e.nodes,l=0;l<a.length;l++)a[l].radius=a[l].radius||e.consts.startRadius,null!=a[l].x&&null!=a[l].y||(a[l].x=i/2+a[l].radius+t,a[l].y=r/2+a[l].radius+t)}},{key:"updateGraph",value:function(e){var t=this,n=t.consts,o=t.state;if(!t.state.disableUpdate){this.updateExistingNodes();var i=t.circles.enter().append("g");i.classed(n.circleGClass,!0),t.circles.exit().remove(),0==o.initForce?(t.setForce(function(){t.updateNewNodes.call(t,i)}),o.initForce=!0):this.updateNewNodes(i),t.paths=t.paths.data(t.links,function(e){return String(e.source.id)+"+"+String(e.target.id)});var r=t.paths;this.updateExistingPaths(r);var a=r.enter().append("path").style("marker-end","url(#end-arrow)").classed("link",!0);this.updateNewPaths(a),r.exit().remove(),null!=e&&e()}}}]),t}();return{Graph:t}}]);var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();angular.module("contiv.graph").factory("VisualizerGraph",["Graph",function(e){var t=function(e){function t(e,n,o,i){_classCallCheck(this,t);var r=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,e,n,o)),a=r;a.state.transition=[],a.consts.edge_buffer=200,a.consts.radiusDecay=1,a.consts.containerClass="container",a.dataSource=i;var l=d3.behavior.drag().origin(function(e){return{x:e.x,y:e.y}}).on("dragstart",function(){}).on("drag",function(e){d3.select(this).attr("transform",function(e,t){return e.x+=d3.event.dx,e.y+=d3.event.dy,"translate("+[e.x,e.y]+")"}),a.updateGraph()}).on("dragend",function(){});a.drag=l;var s=d3.behavior.zoom().on("zoom",function(){return null!=d3.event.sourceEvent&&d3.event.sourceEvent.ctrlKey?!1:(a.zoomed.call(a),!0)}).on("zoomstart",function(e,t){});return a.dragSvg=s,a.svg.call(s).on("dblclick.zoom",null),r}return _inherits(t,e),_createClass(t,[{key:"zoomed",value:function(e,t){var n=this;if(1!=n.state.rightClick){if(this.state.justScaleTransGraph=!0,null!=e&&null!=t){var o=n.dragSvg;o.scale(t),o.translate(e);var i=function(){o.scale(t),o.translate(e)},r="zoom"+e;return void d3.select("."+this.consts.graphClass).transition(r).delay(100).duration(750).attr("transform","translate("+o.translate()+") scale("+o.scale()+")").each("end",i)}n.state.canZoom&&d3.select("."+this.consts.graphClass).attr("transform","translate("+n.dragSvg.translate()+") scale("+n.dragSvg.scale()+")")}}},{key:"onWindowResize",value:function(e){var t=document.getElementsByTagName("body")[0],n=$("#visualization-graph").offset(),o=$("#visualization-graph").width(),i=t.clientHeight;e.attr("width",o).attr("height",i-n.top-20)}},{key:"updateLinkData",value:function(){for(var e=this,t=[],n=0;n<e.nodes.length;n++)t.push(e.nodes[n].id);var o=e.dataSource.getFlowBetweenSet(t),i=o.linkData;e.links=e.dataSource.processLinkData(i,e.nodes),this.initNodes(),this.initLinks(),e.updateGraph()}}]),t}(e.Graph);return{Graph:t}}]);var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();angular.module("contiv.graph").factory("Link",[function(){var e=function(){function e(t,n){_classCallCheck(this,e),this.source=t,this.target=n,this.hasPolicy=!1,this.pathPolicies=[],this.graph=null,this.initialized=!1}return _createClass(e,[{key:"initialize",value:function(e){0==this.initialized&&(this.initialized=!0,this.graph=e)}},{key:"updateAttr",value:function(e,t){e.style("marker-end","url(#end-arrow)").attr("d",arrowPath)}},{key:"newPathAttr",value:function(e,t){e.attr("d",arrowPath)}},{key:"arrowPath",value:function(){var e=this,t=e.target.x-e.source.x,n=e.target.y-e.source.y,o=Math.sqrt(t*t+n*n);return"M"+e.source.x+","+e.source.y+"A"+o+","+o+" 0 0,1 "+e.target.x+","+e.target.y}},{key:"installPathPolicy",value:function(e){this.hasPolicy=!0,this.pathPolicies.push(e),e.initialize(this.graph)}},{key:"uninstallPathPolicy",value:function(e){var t,n=this;t="string"==typeof e?e:e.policyName,_(n.pathPolicies).forEach(function(e,o){e.policyName===t&&(e.destroy(),n.pathPolicies.splice(o,1))}),0===n.pathPolicies.length&&(n.hasPolicy=!1)}},{key:"pathPolicyEvent",value:function(e,t,n){_(n.pathPolicies).forEach(function(o){o[e](t,n)})}}]),e}();return{Link:e}}]);var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),_get=function e(t,n,o){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,n,o)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(o)};angular.module("contiv.graph").factory("VisualizerLink",["Link",function(e){var t=function(e){function t(e,n,o){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,e,n));return i.weight=o,i.count=1,i}return _inherits(t,e),_createClass(t,[{key:"increaseCount",value:function(){this.count+=1}},{key:"qtipHelper",value:function(){var e,t=this,n=(t.target.x-t.source.x)/2,o=(t.target.y-t.source.y)/2;return e=t.source.x<t.target.x?{my:"top center",at:"center center",target:[n,o],adjust:{y:10}}:{my:"bottom center",at:"center center",target:[n,o],adjust:{y:-10}}}},{key:"initialize",value:function(e){if(0==this.initialized){_get(Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e);var n=e.state.VisualizerLink;null==n&&(n=e.state.VisualizerLink={},n.maxWeight=null,n.useAvgWeight=!0),this.updateMaxWeight()}}},{key:"setUseAvgWeight",value:function(e){this.graph.state.VisualizerLink.useAvgWeight=!!e}},{key:"setWeight",value:function(e){this.weight=e}},{key:"getRawWeight",value:function(){return this.weight}},{key:"getWeight",value:function(){var e=this.graph,t=e.state.VisualizerLink;if(t.useAvgWeight){var n=this.weight/this.count;return n}return this.weight}},{key:"updateMaxWeight",value:function(){var e=this.graph,t=e.state.VisualizerLink,n=_.maxBy(e.links,function(e){return null!=e.graph?e.getWeight():0});t.maxWeight=n.getWeight()}},{key:"updateAttr",value:function(e,t){var n=this.graph,o=n.state.VisualizerLink;this.updateMaxWeight();var i=d3.scale.linear().domain([0,o.maxWeight]).range(["#ffb366","#F92606"]);o.colorScale=i,e.style("marker-end","url(#end-arrow)").classed(n.consts.selectedClass,function(e){return e===o.selectedEdge}).attr("d",this.arrowPath.call(t)).transition("existingPathTransition").duration(750).attr("stroke",function(e){var t=i(e.getWeight());return t})}},{key:"newPathAttr",value:function(e,t){var n=this.graph,o=n.state.VisualizerLink;this.updateMaxWeight();var i=d3.scale.linear().domain([0,o.maxWeight]).range(["#ffb366","#F92606"]);e.transition("newPathTransition").duration(750).attrTween("opacity",function(e){return d3.interpolateString(0,1)}).attr("stroke",function(e){var t=i(e.getWeight());return t}).attr("d",this.arrowPath.call(t))}}]),t}(e.Link);return{Link:t}}]);var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();angular.module("contiv.graph").factory("Node",[function(){var e=function(){function e(t,n,o,i,r){_classCallCheck(this,e),this.x=t,this.y=n,this.radius=r,this.id=o,this.text=i,this.radius=r,this.hasPolicy=!1,this.policy=null,this.nodePolicies=[],this.graph=null,this.initialized=!1}return _createClass(e,[{key:"initialize",value:function(e){0==this.initialized&&(this.initialized=!0,this.graph=e)}},{key:"updateAttr",value:function(e,t){e.attr("transform",function(e){return"translate("+e.x+","+e.y+")"})}},{key:"newNodeAttr",value:function(e,t){}},{key:"setRadius",value:function(e){this.radius=e}},{key:"installNodePolicy",value:function(e){this.hasPolicy=!0,this.nodePolicies.push(e),e.initialize(this.graph)}},{key:"uninstallNodePolicy",value:function(e){var t,n=this;t="string"==typeof e?e:e.policyName,_(n.nodePolicies).forEach(function(e,o){e.policyName===t&&(e.destroy(),n.nodePolicies.splice(o,1))}),0===n.nodePolicies.length&&(n.hasPolicy=!1)}},{key:"nodePolicyEvent",value:function(e,t,n){_.forEach(this.nodePolicies,function(o){o[e](t,n)})}}]),e}();return{Node:e}}]);var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();angular.module("contiv.graph").factory("VisualizerNode",["Node",function(e){var t=function(e){function t(e,n,o,i,r,a,l,s,c){_classCallCheck(this,t);var u=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,e,n,o,i,r));return u.parent=a,u.ancestors=l,null==s?u.xStart=e:u.xStart=s,null==c?u.yStart=n:u.yStart=c,u}return _inherits(t,e),_createClass(t,[{key:"newNodeAttr",value:function(e,t){var n=this.graph;null!=n.consts.containerClass&&null==n.dataSource.children_struct[t.id]&&e.classed(n.consts.containerClass,!0),e.transition("nodePositionTransition").duration(750).attrTween("transform",function(e){if(null!=e.xStart&&null!=e.yStart){var t=e.xStart,n=e.yStart;return e.xStart=e.x,e.yStart=e.y,d3.interpolateString("translate("+t+","+n+")","translate("+e.x+","+e.y+")")}return d3.interpolateString("translate("+e.x+","+e.y+")","translate("+e.x+","+e.y+")")})}}]),t}(e.Node);return{Node:t}}]);var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),_get=function t(e,n,o){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var r=Object.getPrototypeOf(e);
return null===r?void 0:t(r,n,o)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(o)};angular.module("contiv.graph").factory("NodeSelectionPolicy",["Policy",function(e){var t=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,"NodeSelectionPolicy"))}return _inherits(t,e),_createClass(t,[{key:"initialize",value:function(e){if(!this.initialized){_get(Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e);var n=e.state.NodeSelectionPolicy={};n.selectedNodes=[];var o=e.consts.NodeSelectionPolicy={};o.selectedClass="selected";var i=e.drag;i.on("drag",function(t){var n=e;if(null!=n.consts.NodeSelectionPolicy){var o=n.consts.NodeSelectionPolicy.selectedClass,i=d3.selectAll("."+o);-1==i[0].indexOf(this)&&(i.classed(o,!1),i=d3.select(this),i.classed(o,!0)),i.attr("transform",function(e,t){return e.x+=d3.event.dx,e.y+=d3.event.dy,"translate("+[e.x,e.y]+")"}),n.updateGraph()}})}}},{key:"addSelectNode",value:function(e,t){var n=this.graph,o=n.state.NodeSelectionPolicy,i=n.consts.NodeSelectionPolicy;e.classed(i.selectedClass,!0),o.selectedNodes.push(t)}},{key:"removeSelectFromNode",value:function(e,t){var n=this.graph,o=n.state.NodeSelectionPolicy,i=n.consts.NodeSelectionPolicy;n.circles.filter(function(e){return e.id===t.id}).classed(i.selectedClass,!1);var r=o.selectedNodes.indexOf(t);o.selectedNodes.splice(r,1)}},{key:"removeAllSelectedNodes",value:function(){var e=this.graph,t=e.state.NodeSelectionPolicy,n=e.consts.NodeSelectionPolicy;e.circles.classed(n.selectedClass,!1),t.selectedNodes=[]}},{key:"mousedown",value:function(e,t){var n=this.graph,o=n.state.NodeSelectionPolicy;d3.event.stopPropagation(),d3.event.ctrlKey?o.selectedNodes.indexOf(t)>-1?this.removeSelectFromNode(e,t):this.addSelectNode(e,t):-1==o.selectedNodes.indexOf(t)&&this.removeAllSelectedNodes()}},{key:"mouseup",value:function(e,t){var n=this.graph,o=n.state.NodeSelectionPolicy;d3.event.ctrlKey||o.selectedNodes.length<=1&&this.removeSelectFromNode(e,t)}}]),t}(e.Policy);return{Policy:t}}]);var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();angular.module("contiv.graph").factory("PathChangeViewPolicy",["Policy",function(e){var t=function(e){function t(e){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,"PathChangeViewPolicy"));return n.$state=e,n}return _inherits(t,e),_createClass(t,[{key:"generateList",value:function(e){var t=this,n=[],o=this.graph.dataSource.children_struct[e];return _.forEach(o,function(e){t.graph.dataSource.hasChild(e)===!0?n.concat(t.generateList(e)):n.push(e)}),n}},{key:"viewEdge",value:function(e){var t=[],n=[],o=e.source.id,i=e.target.id;t=this.graph.dataSource.hasChild(o)===!0?this.generateList(o):[o],n=this.graph.dataSource.hasChild(i)===!0?this.generateList(i):[i],this.$state.go("contiv.menu.visualization.edge",{sourceName:o,targetName:i,sourceList:t,targetList:n})}},{key:"mousedown",value:function(e,t){this.viewEdge(t)}}]),t}(e.Policy);return{Policy:t}}]);var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();angular.module("contiv.graph").factory("Policy",[function(){var e=function(){function e(t){_classCallCheck(this,e),this.policyName=t,this.graph=null,this.initialized=!1}return _createClass(e,[{key:"initialize",value:function(e){this.initialized||(this.initialized=!0,this.graph=e)}},{key:"mouseover",value:function(e,t){}},{key:"dblclick",value:function(e,t){}},{key:"contextmenu",value:function(e,t){}},{key:"mouseout",value:function(e,t){}},{key:"mousedown",value:function(e,t){}},{key:"mouseup",value:function(e,t){}},{key:"destroy",value:function(){}}]),e}();return{Policy:e}}]),angular.module("contiv.applicationgroups",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.applicationgroups",{url:"/applicationgroups","abstract":!0,template:'<div ui-view class="ui container"/>'})}]),angular.module("contiv.graph").factory("PolicyService",["Policy","QTipPolicy","PathChangeViewPolicy","NodeSelectionPolicy","SplitJoinNodePolicy","SplitJoinViewPolicy","SaveStatePolicy",function(e,t,n,o,i,r,a){return{Policy:e.Policy,QTipPolicy:t.Policy,PathChangeViewPolicy:n.Policy,NodeSelectionPolicy:o.Policy,SplitJoinNodePolicy:i.Policy,SplitJoinViewPolicy:r.Policy,SaveStatePolicy:a.Policy}}]),angular.module("contiv.dashboard",["contiv.models"]);var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),_get=function n(e,t,o){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(void 0===i){var r=Object.getPrototypeOf(e);return null===r?void 0:n(r,t,o)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(o)};angular.module("contiv.graph").factory("QTipPolicy",["Policy",function(e){var t=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,"QTipPolicy"))}return _inherits(t,e),_createClass(t,[{key:"initialize",value:function(e){if(!this.initialized){_get(Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e);var n=this,o=e.state.QTipPolicy={};o.mousedown=!1,e.consts.QTipPolicy={},$("#visualization-graph").mouseup(function(e){o.mouseup=!1});var i=e.updateNewNodes;e.updateNewNodes=function(t){i.call(e,t),n.updateNewNodes(t)};var r=e.updateNewPaths;e.updateNewPaths=function(t){r.call(e,t),n.updateNewPaths(t)}}}},{key:"destroy",value:function(){$('[id^="qtip"]').remove()}},{key:"mousedown",value:function(e,t){var n=this.graph,o=n.state.QTipPolicy;o.mousedown=!0}},{key:"mouseup",value:function(e,t){var n=this.graph,o=n.state.QTipPolicy;o.mousedown=!1}},{key:"whenQTipAvailable",value:function(e){var t=this,n=500;window.setTimeout(function(){null!=$(document).qtip?e():window.setTimeout(t.whenQTipAvailable(e),n)},n)}},{key:"updateNewNodes",value:function(e){function t(){e.each(function(e){var t,i=this;if(null!=n.dataSource.children_struct[e.id]){t="<b><u>Selectors:</b></u> ";var r=n.dataSource.selectors[e.id],a=!1;for(var l in r)a=!0,t+=l+" : <i>"+r[l]+"</i>,\n ";a===!1&&(t="No Selectors, ")}else{t="<b><u>Labels:</b></u> ";var s=n.dataSource.labels[e.id],a=!1;for(var l in s)a=!0,t+=l+" : <i>"+s[l]+"</i>,\n ";a===!1&&(t="No labels, ")}t=t.slice(0,-2),$(i).qtip({content:{title:e.id,text:t},events:{show:function(){var t=$(i).qtip("api"),r=$("#graphContainer").offset(),a=[r.left+(e.x*n.dragSvg.scale()+n.dragSvg.translate()[0]),r.top+(e.y+e.radius)*n.dragSvg.scale()+n.dragSvg.translate()[1]];return t.set("position.target",a),!o.mousedown}},show:{delay:0,solo:$("#visualization-graph")},style:{classes:"qtip-blue qtip-shadow"},position:{my:"top center",at:"bottom center"},hide:{event:"mousedown mouseleave"}})})}var n=this.graph,o=n.state.QTipPolicy;void 0!=$(document).qtip?t():this.whenQTipAvailable(t)}},{key:"updateNewPaths",value:function(e){var t=this.graph,n=t.state.QTipPolicy;void 0!=$(document).qtip&&e.each(function(e){var t=this,o=d3.select(this).node(),i=(o.getPointAtLength(o.getTotalLength()/2),e.qtipHelper()),r="Bytes: "+e.getWeight();$(t).qtip({content:{text:r},events:{show:function(){return!n.mousedown}},show:{delay:0,solo:$("#graphContainer")},style:{classes:"qtip-blue qtip-shadow"},position:{my:i.my,at:"center center",target:"mouse",adjust:i.adjust},hide:{event:"mousedown mouseleave"}})})}}]),t}(e.Policy);return{Policy:t}}]),angular.module("contiv.login",["contiv.utils"]);var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();angular.module("contiv.graph").factory("SaveStatePolicy",["Policy",function(e){var t=function(e){function t(e){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,"SaveStatePolicy"));return n.savedState=e,n}return _inherits(t,e),_createClass(t,[{key:"initialize",value:function(e){this.graph=e;var t=this;e.destroy=function(){t.graphDestroy.call(e,t.savedState)},e.load=function(n){t.graphLoad.call(e,n)}}},{key:"graphDestroy",value:function(e){var t=this;_(t.defaultNodePolicies).forEach(function(t){t.destroy(e)}),_(t.defaultPathPolicies).forEach(function(t){t.destroy(e)});for(var n in t.bindings)$(window).off(n,t.bindings[n])}},{key:"graphLoad",value:function(e){var t=this;_(t.defaultNodePolicies).forEach(function(t){null!=t.load&&t.load(e)}),_(t.defaultPathPolicies).forEach(function(t){null!=t.load&&t.load(e)})}}]),t}(e.Policy);return{Policy:t}}]),angular.module("contiv.menu",[]);var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),_get=function o(e,t,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(void 0===i){var r=Object.getPrototypeOf(e);return null===r?void 0:o(r,t,n)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(n)};angular.module("contiv.graph").factory("SplitJoinNodePolicy",["NodeSelectionPolicy","VisualizerNode",function(e,t){var n=function(e){function n(){_classCallCheck(this,n);var e=_possibleConstructorReturn(this,Object.getPrototypeOf(n).call(this));return e.policyName="SplitJoinNodePolicy",e}return _inherits(n,e),_createClass(n,[{key:"initialize",value:function(e){if(!this.initialized){_get(Object.getPrototypeOf(n.prototype),"initialize",this).call(this,e);var t=e.state.SplitJoinNodePolicy={};t.splitNodes=[]}}},{key:"dblclick",value:function(e,t){var n=this.graph,o=n.state.SplitJoinNodePolicy;d3.event.ctrlKey||(o.selectedNodes.indexOf(t)>-1?this.splitMultipleNodes(o.selectedNodes):(this.removeAllSelectedNodes(),this.splitNode(t)))}},{key:"contextmenu",value:function(e,t){var n=this.graph,o=n.state.NodeSelectionPolicy;if(d3.event.preventDefault(),!d3.event.ctrlKey){var i=o.selectedNodes;if(i.indexOf(t)>-1)for(var r=0;r<i.length;r++)this.joinNode(i[r]);else this.removeAllSelectedNodes(),this.joinNode(t)}}},{key:"__splitNode",value:function(e){var n=this.graph,o=n.state.SplitJoinNodePolicy,i=e.id,r=n.dataSource.children_struct;if(void 0!==r[i]&&!_.isEmpty(r[i])){n.nodes=_.filter(n.nodes,function(t){return t!=e}),n.spliceLinksForNode(e);for(var a=[],l=0;l<n.nodes.length;l++)a.push(n.nodes[l].id);for(var s=[],l=0;l<r[i].length;l++)a.push(r[i][l]),s.push(r[i][l]);var c=n.dataSource.getFlowBetweenSet(a),u=e.x,d=e.y,p=e.ancestors.slice();p.splice(0,0,e.id);for(var v=e.id,f=[],h=e.radius*n.consts.radiusDecay,g=c.nodeData,l=0;l<g.length;l++)if(s.indexOf(g[l].id)>-1){var m=g[l].id,y=g[l].text,b=new t.Node(null,null,m,y,h,v,p,u,d);b.initialize(n),n.nodes.push(b),f.push(b)}return n.links=n.dataSource.processLinkData(c.linkData,n.nodes),n.initNodes(),n.initLinks(),o.splitNodes.push(e.id),f}}},{key:"splitNode",value:function(e){var t=this.__splitNode(e);null!=t&&this.splitNodeEvent(t)}},{key:"splitMultipleNodes",value:function(e){for(var t=(this.graph,[]),n=0;n<e.length;n++){var o=this.__splitNode(e[n]);t=t.concat(o)}this.splitMultipleNodesEvent(o)}},{key:"splitNodeEvent",value:function(e){var t=this.graph;t.setPositions(),t.updateGraph()}},{key:"splitMultipleNodesEvent",value:function(e){var t=this.graph;t.setPositions(),t.updateGraph()}},{key:"__joinNode",value:function(e){var n=this.graph,o=n.state.SplitJoinNodePolicy;if(-1!=n.nodes.indexOf(e)){var i=n.dataSource.children_struct,r=e.id;if(!(i.topLevel.indexOf(r)>-1)){for(var a=[],l=[],s=0;s<n.nodes.length;s++)-1==n.nodes[s].ancestors.indexOf(e.parent)?l.push(n.nodes[s].id):a.push(n.nodes[s]);var c=e.parent;l.push(e.parent);var u=e.radius/n.consts.radiusDecay,d=e.x,p=e.y,v=e.ancestors[1],f=e.ancestors.slice(1),h=new t.Node(d,p,c,c,u,v,f);n.nodes.push(h);for(var g=n.dataSource.getFlowBetweenSet(l),s=0;s<a.length;s++){var m=a[s];n.nodes.splice(n.nodes.indexOf(m),1),n.spliceLinksForNode(m)}return n.links=n.dataSource.processLinkData(g.linkData,n.nodes),n.initNodes(),n.initLinks(),o.splitNodes.splice(o.splitNodes.indexOf(h.id),1),h}}}},{key:"joinNode",value:function(e){var t=this.__joinNode(e);null!=t&&this.joinNodeEvent(t)}},{key:"joinMultipleNode",value:function(e){for(var t=[],n=0;n<e.length;n++){var o=this.__joinNode(e[n]);t.push(o)}this.joinMultipleNodesEvent(t)}},{key:"joinNodeEvent",value:function(e){var t=this.graph;t.updateGraph()}},{key:"joinMultipleNodesEvent",value:function(e){var t=this.graph;t.updateGraph()}}]),n}(e.Policy);return{Policy:n}}]),angular.module("contiv.networkpolicies",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies",{url:"/networkpolicies","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.networkpolicies.isolation",{url:"/isolation","abstract":!0,template:"<ui-view/>"}).state("contiv.menu.networkpolicies.bandwidth",{url:"/bandwidth","abstract":!0,template:"<ui-view/>"}).state("contiv.menu.networkpolicies.redirection",{url:"/redirection","abstract":!0,template:"<ui-view/>"})}]);var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),_get=function i(e,t,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,t);if(void 0===o){var r=Object.getPrototypeOf(e);return null===r?void 0:i(r,t,n)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(n)};angular.module("contiv.graph").factory("SplitJoinViewPolicy",["SplitJoinNodePolicy","VisualizerNode",function(e,t){var n=function(e){function n(){_classCallCheck(this,n);var e=_possibleConstructorReturn(this,Object.getPrototypeOf(n).call(this));return e.policyName="SplitJoinViewPolicy",e}return _inherits(n,e),_createClass(n,[{key:"initialize",value:function(e){if(!this.initialized){_get(Object.getPrototypeOf(n.prototype),"initialize",this).call(this,e);var t=e.state.SplitJoinViewPolicy={};t.savedStates=[],t.eventHistory=[],t.focusGroups=[],t.foci=[],t.zooms={},t.layout={},t.layoutDefault=null,t.zoomDefault=null,t.nodeIdsToReshow=null,t.backButtonElem=null,t.titleElem=null;var o=e.consts.SplitJoinViewPolicy={};o.boundary=.8,e.d3ForceBounds=this.d3ForceBounds,e.d3ForceTick=this.d3ForceTick,e.d3ForceStart=this.d3ForceStart,e.d3ForceEnd=this.d3ForceEnd}}},{key:"installBackButton",value:function(e){var t=this.graph,n=this,o=t.state.SplitJoinViewPolicy;o.backButtonElem=e,o.backButton=function(){o.eventHistory.length>0&&n.undoLastEvent.call(n)}}},{key:"installTitle",value:function(e){var t=this.graph,n=t.state.SplitJoinViewPolicy;n.titleElem=e}},{key:"destroy",value:function(e){null!=e&&this.save(e)}},{key:"save",value:function(e){var t=this.graph,n=t.state.SplitJoinViewPolicy,o=t.nodes,i=t.links,r=null;null!=n.titleElem&&(r=n.titleElem.text());var a=n.focusGroups,l=n.eventHistory,s=n.zooms,c=n.layout,u=n.layoutDefault,d=n.zoomDefault,p={nodes:o,links:i,states:n.savedStates,currTitle:r,focusGroups:a,eventHistory:l,zooms:s,layout:c,layoutDefault:u,zoomDefault:d};e.SplitJoinViewPolicy=p}},{key:"load",value:function(e){var t=this,n=this.graph,o=n.state.SplitJoinViewPolicy;e=e.SplitJoinViewPolicy,o.savedStates=e.states,n.links=e.links,n.nodes=e.nodes;var i=e.currTitle;null!=o.titleElem&&o.titleElem.text(i),o.eventHistory=e.eventHistory,o.focusGroups=e.focusGroups,o.zooms=e.zooms,o.layout=e.layout,o.layoutDefault=e.layoutDefault,o.zoomDefault=e.zoomDefault,null!=o.backButtonElem&&o.eventHistory.length>0&&o.backButtonElem.fadeTo("slow",1);var r=n.dataSource.children_struct;_.forEach(n.nodes,function(e){e.SplitJoinViewPolicy={},_.includes(r[o.focusGroups[0]],e.id)?e.SplitJoinViewPolicy.type="focus":e.SplitJoinViewPolicy.type="connected"});var a;if(0===o.focusGroups.length){a=o.layoutDefault;var l=o.zoomDefault;n.zoomed(l[0],l[1])}else{var l=o.zooms[o.focusGroups];null!=l&&n.zoomed(l[0],l[1]),a=o.layout[o.focusGroups]}_.forEach(n.nodes,function(e){var t=a[e.id];null==t&&console.log(a,e),e.x=t.x,e.y=t.y}),n.state.initForce=!0,n.updateGraph.call(n,function(){t.updateGraphCallback.call(t)})}},{key:"dblclick",value:function(e,t){var o=this.graph,i=o.state.SplitJoinViewPolicy,r=t.id,a=o.dataSource.children_struct;if(void 0!==a[r]&&!_.isEmpty(a[r])){if(i.focusGroups.slice(),0===i.focusGroups.length?i.focusGroups.push(t.id):_.includes(a[i.focusGroups[0]],t.id)?i.focusGroups[0]=t.id:1===i.focusGroups.length?i.focusGroups.push(t.id):_.includes(a[i.focusGroups[1]],t.id)&&(i.focusGroups[1]=t.id),2===i.focusGroups.length&&i.focusGroups[1]===t.id){var l=[t],s=[],c=a[i.focusGroups[0]];_.forEach(o.nodes,function(e){_.includes(c,e.id)&&(s.push(e.id),l.push(e))})}else{var l=[t],s=[];_.forEach(o.links,function(e){e.source===t&&-1==s.indexOf(e.target.id)?(e.target.SplitJoinViewPolicy={},e.target.SplitJoinViewPolicy.type="connected",s.push(e.target.id),l.push(e.target)):e.target===t&&-1==s.indexOf(e.source.id)&&(e.source.SplitJoinViewPolicy={},e.source.SplitJoinViewPolicy.type="connected",s.push(e.source.id),l.push(e.source))})}o.circles.each(function(e){e.id!==t.id&&o.spliceLinksForNode(e)}),o.updateGraph(),o.state.disableUpdate=!0,o.circles.each(function(e){e.id!==t.id?d3.select(this).transition().delay(200).duration(400).style("opacity",0):null!=$(this).qtip&&$(this).qtip("disable",!0)});var u=o.dragSvg.translate(),d=o.dragSvg.scale(),p=parseFloat(o.svg.style("width"))/d/2+u[0],v=parseFloat(o.svg.style("height"))/d/2+u[1];t.xStart=t.x,t.yStart=t.y,t.x=p,t.y=v,e.transition("nodePositionTransition").duration(750).attrTween("transform",function(e){var t=e.xStart,n=e.yStart;return e.xStart=e.x,e.yStart=e.y,d3.interpolateString("translate("+t+","+n+")","translate("+e.x+","+e.y+")")});var f=_get(Object.getPrototypeOf(n.prototype),"splitNode",this);i.nodeIdsToReshow=s;var h=this;setTimeout(function(){o.nodes=l,f.call(h,t)},750)}}},{key:"updateGraphCallback",value:function(){var e=this.graph,t=e.state.SplitJoinViewPolicy;e.circles.each(function(e){d3.select(this).transition().duration(400).style("opacity",1),d3.select(this).classed("focus",!1),d3.select(this).classed("connected",!1),null!=e.SplitJoinViewPolicy&&("focus"===e.SplitJoinViewPolicy.type?d3.select(this).classed("focus",!0):"connected"===e.SplitJoinViewPolicy.type&&d3.select(this).classed("connected",!0))}),t.nodeIdsToReshow=null,e.updateGraph()}},{key:"setPositions",value:function(){function e(e,t){return Math.floor(Math.random()*(t-e+1))+e}var t=this.graph,n=this,o=t.consts,i=o.displayOffset,r=t.nodes,a=n.d3ForceBounds.call(t);_.forEach(r,function(t){if(null==t.x||null==t.y){var n=e(t.radius+i,a.width-t.radius-i),o=e(t.radius+i,a.height-t.radius-i);t.x=n,t.y=o}})}},{key:"d3ForceStart",value:function(){var e=this;e.circles.attr("cx",function(t){return null!=t.xStart&&(t.xStart=t.xStart*e.dragSvg.scale()+e.dragSvg.translate()[0]),t.x}).attr("cy",function(t){return null!=t.yStart&&(t.yStart=t.yStart*e.dragSvg.scale()+e.dragSvg.translate()[1]),t.y}),e.paths.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y})}},{key:"d3ForceEnd",value:function(){var e=this,t=e.state,n=t.SplitJoinViewPolicy;if(null==n.layoutDefault){var o={};_.forEach(e.nodes,function(e){o[e.id]={x:e.x,y:e.y}}),n.layoutDefault=o;var i=e.dragSvg.scale(),r=e.dragSvg.translate();n.zoomDefault=[r,i]}e.circles.attr("cx",function(e){return e.x}).attr("cy",function(e){return e.y}),e.paths.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y})}},{key:"d3ForceTick",value:function(e,t,n){function o(e){return function(o){2===u.length?("focus"===o.SplitJoinViewPolicy.type?o.y+=(u[0]-o.y)*e:o.y+=(u[1]-o.y)*e,o.x+=(t/2-o.x)*e):(o.y+=(n/2-o.y)*e,o.x+=(t/2-o.x)*e)}}var i=this,r=i.state,a=i.consts,l=r.SplitJoinViewPolicy,s=a.displayOffset,c=i.dragSvg.scale(),u=l.foci;i.circles.each(this.d3ForceCollide(.5)).each(o(.2*e.alpha)).attr("cx",function(e){return e.x=Math.max((e.radius+s)/c,Math.min(t+(-s-e.radius)/c,e.x))}).attr("cy",function(e){return null==e.SplitJoinViewPolicy||null==e.SplitJoinViewPolicy?(e.y=Math.max((e.radius+s)/c,Math.min(n+(-s-e.radius)/c,e.y)),e.y):"focus"===e.SplitJoinViewPolicy.type?(e.y=Math.max(e.radius+s,Math.min((n+(-s-e.radius)/c)*a.SplitJoinViewPolicy.boundary,e.y)),e.y):"connected"===e.SplitJoinViewPolicy.type?(e.y=Math.max((n+(s-e.radius)/c)*a.SplitJoinViewPolicy.boundary,Math.min(n+(-s-e.radius)/c,e.y)),e.y):void 0}),i.paths.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y})}},{key:"d3ForceBounds",value:function(){function e(e,n){var o=e*n,i=t.consts.startRadius,r=3.5*i,a=o/(r*r);return a}var t=this,n=t.state,o=t.consts,i=o.SplitJoinViewPolicy,r=n.SplitJoinViewPolicy,a=t.nodes,l=o.displayOffset,s=parseFloat(t.svg.style("width")),c=parseFloat(t.svg.style("height")),u=s,d=c,p=e(u-2*l,d-2*l),v=1;a.length>p?(v=p/a.length,t.zoomed(t.dragSvg.translate(),v),u/=v,d/=v):t.zoomed(t.dragSvg.translate(),v);var f,h=r.focusGroups;if(0===h.length)f=[d/2];else{var g=t.dataSource.children_struct[h[0]];i.boundary=g.length/a.length;var m=d*i.boundary,y=d-m;m<2*t.consts.maxRadius&&(i.boundary=2.5*t.consts.maxRadius/d,m=d*i.boundary,y=d-m),y<2*t.consts.maxRadius&&(i.boundary=1-2.5*t.consts.maxRadius/d,m=d*i.boundary,y=d-m),f=[m/2,m+y/2]}return r.foci=f,{width:u,height:d}}},{key:"splitNodeEvent",value:function(e){var t=this,n=this.graph,o=n.state.SplitJoinViewPolicy,i=n.dataSource.children_struct;_.forEach(e,function(e){e.SplitJoinViewPolicy={},_.includes(i[o.focusGroups[0]],e.id)?e.SplitJoinViewPolicy.type="focus":e.SplitJoinViewPolicy.type="connected"});var r=e[0].parent;if(0!==o.eventHistory.length&&o.eventHistory[o.eventHistory.length-1].id===r?o.eventHistory.pop():o.eventHistory.push({id:r,event:"split"}),null!=o.backButtonElem&&0!==o.eventHistory.length&&o.backButtonElem.fadeTo("slow",1),null!=o.titleElem){var a="";o.focusGroups.length>0&&(a+=o.focusGroups[0]),2===o.focusGroups.length&&(a+=" & "+o.focusGroups[1]),o.titleElem.text(a)}n.state.disableUpdate=!1,t.setLayout()}},{key:"setLayout",value:function(){var e,t=this,n=this.graph,o=n.state.SplitJoinViewPolicy;if(0===o.focusGroups.length){e=o.layoutDefault;var i=o.zoomDefault;n.zoomed(i[0],i[1])}else{var i=o.zooms[o.focusGroups];null!=i&&n.zoomed(i[0],i[1]),e=o.layout[o.focusGroups]}if(null!=e)_.forEach(n.nodes,function(t){var n=e[t.id];null==n&&console.log(e,t),t.x=n.x,t.y=n.y}),n.updateGraph.call(n,function(){t.updateGraphCallback.call(t)});else{n.state.initForce=!1,n.updateGraph(function(){t.updateGraphCallback.call(t)}),o.zooms[o.focusGroups]=[n.dragSvg.translate(),n.dragSvg.scale()];var e={};_.forEach(n.nodes,function(t){e[t.id]={x:t.x,y:t.y}}),o.layout[o.focusGroups]=e}}},{key:"__joinNode",value:function(e){var n=this.graph,o=n.state.SplitJoinNodePolicy,i=n.state.SplitJoinViewPolicy;if(-1!=n.nodes.indexOf(e)){var r=n.dataSource.children_struct,a=e.id;if(!(r.topLevel.indexOf(a)>-1)){for(var l=e.parent,s=[],c=[],u=0;u<n.nodes.length;u++)-1==n.nodes[u].ancestors.indexOf(e.parent)?c.push(n.nodes[u].id):s.push(n.nodes[u]);var d=e.parent;c.push(e.parent);var p=n.dataSource.ancestors_struct,r=n.dataSource.children_struct,v=i.focusGroups.indexOf(l);null!=p[l]?i.focusGroups[v]=p[l]:i.focusGroups.splice(v,1);var f=[];if(1===i.focusGroups.length){var h=p[e.id];h.push(i.focusGroups[0]),h=h.concat(p[i.focusGroups[0]]||[]),_.forEach(r.topLevel,function(e){-1===h.indexOf(e)&&-1==c.indexOf(e)&&f.push(e)}),c=c.concat(f)}else 0===i.focusGroups.length&&(_.forEach(r.topLevel,function(e){-1==c.indexOf(e)&&f.push(e)}),c=c.concat(f));var g=e.radius/n.consts.radiusDecay,m=e.x,y=e.y,l=e.ancestors[1],h=e.ancestors.slice(1),b=new t.Node(m,y,d,d,g,l,h);n.nodes.push(b);for(var u=0;u<s.length;u++){var w=s[u];n.nodes.splice(n.nodes.indexOf(w),1),n.spliceLinksForNode(w)}for(var P=n.dataSource.getFlowBetweenSet(c),S=[],E=P.nodeData,u=0;u<E.length;u++)-1!==f.indexOf(E[u].id)&&S.push(E[u]);var N=n.dataSource.processNodeData(S);_.forEach(N,function(e){e.radius=e.radius||n.consts.startRadius}),n.nodes=n.nodes.concat(N),n.links=n.dataSource.processLinkData(P.linkData,n.nodes),1===i.focusGroups.length?_.forEach(n.links,function(e){-1!==f.indexOf(e.source.id)?i.focusGroups[0]===e.target.parent&&f.splice(f.indexOf(e.source.id),1):-1!==f.indexOf(e.target.id)&&i.focusGroups[0]===e.source.parent&&f.splice(f.indexOf(e.target.id),1)}):f=[];var C=[];if(0!==f.length)for(var u=0;u<n.nodes.length&&(-1===f.indexOf(n.nodes[u].id)||(f.splice(f.indexOf(n.nodes[u].id),1),n.spliceLinksForNode(n.nodes[u]),C.push(n.nodes[u]),0!==f.length));u++);return _.forEach(C,function(e){n.nodes.splice(n.nodes.indexOf(e),1)}),n.initNodes(),n.initLinks(),o.splitNodes.splice(o.splitNodes.indexOf(b.id),1),b}}}},{key:"joinNodeEvent",value:function(e){var t=this.graph,n=this,o=t.state.SplitJoinViewPolicy;0!==o.eventHistory.length&&o.eventHistory[o.eventHistory.length-1].id===e.id?o.eventHistory.pop():o.eventHistory.push({id:e.id,event:"join"});var i=t.dataSource.children_struct;if(_.forEach(t.nodes,function(e){e.SplitJoinViewPolicy={},_.includes(i[o.focusGroups[0]],e.id)?e.SplitJoinViewPolicy.type="focus":e.SplitJoinViewPolicy.type="connected"}),null!=o.backButtonElem&&0===o.eventHistory.length&&o.backButtonElem.fadeTo("slow",0),null!=o.titleElem){var r="";o.focusGroups.length>0&&(r+=o.focusGroups[0]),2===o.focusGroups.length&&(r+=" & "+o.focusGroups[1]),o.titleElem.text(r)}n.setLayout()}},{key:"undoLastEvent",value:function(){var e,t=this.graph,o=this,i=t.state.SplitJoinViewPolicy,r=i.eventHistory[i.eventHistory.length-1],a=r.id;if("join"===r.event){e=t.findNodeById(a);var l=t.findD3Node(a);o.dblclick(l,e)}else{var s=t.dataSource.children_struct[a][0];e=t.findNodeById(s),_get(Object.getPrototypeOf(n.prototype),"joinNode",this).call(o,e)}}}]),n}(e.Policy);return{Policy:n}}]),angular.module("contiv.networks",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.networks",{url:"/networks","abstract":!0,template:'<div ui-view class="ui container"/>'})}]),angular.module("contiv.nodes",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.nodes",{url:"/nodes","abstract":!0,template:'<div ui-view class="ui container"/>'})}]),angular.module("contiv.organizations",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.organizations",{url:"/organizations","abstract":!0,template:'<div ui-view class="ui container"/>'})}]),angular.module("contiv.servicelbs",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.servicelbs",{url:"/servicelbs","abstract":!0,template:'<div ui-view class="ui container"/>'})}]),angular.module("contiv.settings",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.settings",{url:"/global","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.settings.details",{url:"/settings",templateUrl:"settings/settingsmenu.html"}).state("contiv.menu.settings.details.logs",{url:"/logs",controller:"",templateUrl:""}).state("contiv.menu.settings.details.auth",{url:"/auth",controller:"",templateUrl:""}).state("contiv.menu.settings.details.license",{url:"/license",controller:"",templateUrl:""}).state("contiv.menu.settings.details.policies",{url:"/policies",controller:"",templateUrl:""})}]),angular.module("contiv.storagepolicies",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.storagepolicies",{url:"/storagepolicies","abstract":!0,template:'<div ui-view class="ui container"/>'})}]),angular.module("contiv.visualization",["contiv.models","contiv.directives","contiv.utils","contiv.graph"]).config(["$stateProvider",function(e){e.state("contiv.menu.visualization",{url:"/visualization","abstract":!0,template:'<div ui-view class="ui container"/>'})}]),angular.module("contiv.volumes",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.volumes",{url:"/volumes","abstract":!0,template:'<div ui-view class="ui container"/>'})}]),angular.module("contivApp",["ui.router","contiv.login","contiv.menu","contiv.dashboard","contiv.applicationgroups","contiv.networks","contiv.networkpolicies","contiv.storagepolicies","contiv.servicelbs","contiv.volumes","contiv.nodes","contiv.organizations","contiv.settings","contiv.visualization"]).config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("contiv",{url:"","abstract":!0,template:'<div ui-view class="ui fluid container"/>'}),t.otherwise("/")}]),angular.module("contiv.applicationgroups").config(["$stateProvider",function(e){e.state("contiv.menu.applicationgroups.create",{url:"/create",controller:"ApplicationGroupCreateCtrl as applicationGroupCreateCtrl",templateUrl:"applicationgroups/applicationgroupcreate.html"})}]).controller("ApplicationGroupCreateCtrl",["$state","$stateParams","ApplicationGroupsModel","NetworksModel","CRUDHelperService",function(e,t,n,o,i){function r(){e.go("contiv.menu.applicationgroups.list")}function a(){r()}function l(){o.get().then(function(e){u.networks=_.filter(e,{tenantName:"default"})})}function s(){u.form.$valid&&(i.hideServerError(u),i.startLoader(u),u.applicationGroup.networkName=u.selectedNetwork.networkName,u.applicationGroup.key=n.generateKey(u.applicationGroup),n.create(u.applicationGroup).then(function(e){i.stopLoader(u),r()},function(e){i.stopLoader(u),i.showServerError(u,e)}))}function c(){i.stopLoader(u),i.hideServerError(u),u.applicationGroup={groupName:"",networkName:"",policies:[],netProfile:"",tenantName:"default"}}var u=this;u.networks=[],u.applicationGroup={},u.selectedNetwork={},u.mode="edit",l(),u.createApplicationGroup=s,u.cancelCreating=a,c()}]),angular.module("contiv.applicationgroups").config(["$stateProvider",function(e){e.state("contiv.menu.applicationgroups.details",{url:"/details/:key",controller:"ApplicationGroupDetailsCtrl as applicationGroupDetailsCtrl",templateUrl:"applicationgroups/applicationgroupdetails.html"}).state("contiv.menu.applicationgroups.edit",{url:"/edit/:key",controller:"ApplicationGroupDetailsCtrl as applicationGroupDetailsCtrl",templateUrl:"applicationgroups/applicationgroupdetails.html"})}]).controller("ApplicationGroupDetailsCtrl",["$state","$stateParams","ApplicationGroupsModel","CRUDHelperService",function(e,t,n,o){function i(){e.is("contiv.menu.applicationgroups.edit")?u.mode="edit":u.mode="details"}function r(){e.go("contiv.menu.applicationgroups.list")}function a(){e.go("contiv.menu.applicationgroups.details",{key:u.applicationGroup.key})}function l(){a()}function s(){o.hideServerError(u),o.startLoader(u),n["delete"](u.applicationGroup).then(function(e){o.stopLoader(u),r()},function(e){o.stopLoader(u),o.showServerError(u,e)})}function c(){o.hideServerError(u),o.startLoader(u),n.save(u.applicationGroup).then(function(e){o.stopLoader(u),a()},function(e){o.stopLoader(u),
o.showServerError(u,e)})}var u=this;u.applicationGroup={},u.selectedNetwork={},o.stopLoader(u),o.hideServerError(u),n.getModelByKey(t.key).then(function(e){u.applicationGroup=e}),u.saveApplicationGroup=c,u.cancelEditing=l,u.deleteApplicationGroup=s,i()}]),angular.module("contiv.applicationgroups").config(["$stateProvider",function(e){e.state("contiv.menu.applicationgroups.list",{url:"/list",controller:"ApplicationGroupListCtrl as applicationGroupListCtrl",templateUrl:"applicationgroups/applicationgrouplist.html"})}]).controller("ApplicationGroupListCtrl",["$scope","$interval","$filter","ApplicationGroupsModel","CRUDHelperService",function(e,t,n,o,i){function r(e){o.get(e).then(function(e){i.stopLoader(a),a.groups=e},function(e){i.stopLoader(a)})}var a=this;r(!1);var l;angular.isDefined(l)||(l=t(function(){r(!0)},5e3)),e.$on("$destroy",function(){t.cancel(l)})}]),angular.module("contiv.applicationgroups").directive("ctvBandwidthpolicy",function(){return{restrict:"E",scope:{mode:"=",applicationgroup:"="},controller:["$scope","NetprofilesModel",function(e,t){function n(){t.get().then(function(t){e.netProfiles=_.filter(t,{tenantName:"default"}),""!==e.applicationgroup.netProfile&&(e.selectedNetprofile.policy=_.find(e.netProfiles,function(t){return t.profileName===e.applicationgroup.netProfile}))})}e.netProfiles=[],e.selectedNetprofile={policy:{}},e.updateApplicationgroup=function(){null===e.selectedNetprofile.policy?e.applicationgroup.netProfile="":e.applicationgroup.netProfile=e.selectedNetprofile.policy.profileName},n()}],templateUrl:"applicationgroups/bandwidthpolicy.html"}}),angular.module("contiv.applicationgroups").directive("ctvIsolationpolicy",function(){return{restrict:"E",scope:{mode:"=",applicationgroup:"="},controller:["$scope","$stateParams","ApplicationGroupsModel","PoliciesModel","RulesModel",function(e,t,n,o,i){function r(){e.applicationgroup.policies.forEach(function(t){i.getIncomingRules(t,"default").then(function(t){Array.prototype.push.apply(e.incomingRules,t)}),i.getOutgoingRules(t,"default").then(function(t){Array.prototype.push.apply(e.outgoingRules,t)})})}function a(){o.get().then(function(t){e.isolationPolicies=_.filter(t,{tenantName:"default"})})}e.incomingRules=[],e.outgoingRules=[],e.selectedPolicy={policy:{}},e.selectedPolicies=[],e.isolationPolicies=[],e.addIsolationPolicy=function(){var t=e.selectedPolicy.policy.policyName;void 0!==t&&0==_.includes(e.selectedPolicies,t)&&(e.selectedPolicies.push(t),i.getIncomingRules(t,"default").then(function(t){Array.prototype.push.apply(e.incomingRules,t)}),i.getOutgoingRules(t,"default").then(function(t){Array.prototype.push.apply(e.outgoingRules,t)}),e.applicationgroup.policies.push(t))},e.removeIsolationPolicy=function(t){_.remove(e.selectedPolicies,function(e){return e===t}),_.remove(e.applicationgroup.policies,function(e){return e===t}),_.remove(e.incomingRules,function(e){return e.policyName===t}),_.remove(e.outgoingRules,function(e){return e.policyName===t})},("details"==e.mode||"edit"==e.mode&&""!=e.applicationgroup.groupName)&&(void 0===e.applicationgroup.policies&&(e.applicationgroup.policies=[]),r()),a()}],templateUrl:"applicationgroups/isolationpolicy.html"}}),angular.module("contiv.dashboard").config(["$stateProvider",function(e){e.state("contiv.menu.dashboard",{url:"/dashboard",controller:"DashboardCtrl as dashboardCtrl",templateUrl:"dashboard/dashboard.html"})}]).controller("DashboardCtrl",["$scope","$interval","NodesModel","NetworksModel","VolumesModel","ApplicationGroupsModel","PoliciesModel","StoragePoliciesModel",function(e,t,n,o,i,r,a,l){function s(e){n.get(e).then(function(e){c.nodes=e.length}),o.get(e).then(function(e){c.networks=e.length}),i.get(e).then(function(e){c.volumes=e.length}),r.get(e).then(function(e){c.groups=e.length}),a.get(e).then(function(e){c.networkpolicies=e.length}),l.get(e).then(function(e){c.storagepolicies=e.length})}var c=this;c.nodes=0,c.networks=0,c.volumes=0,c.groups=0,c.networkpolicies=0,c.storagepolicies=0,s(!1);var u=t(function(){s(!0)},5e3);e.$on("$destroy",function(){t.cancel(u)})}]),angular.module("contiv.login").config(["$stateProvider",function(e){e.state("contiv.login",{url:"/",templateUrl:"login/login.html",controller:"LoginCtrl as loginCtrl"})}]).controller("LoginCtrl",["$state","CRUDHelperService",function(e,t){function n(){e.go("contiv.menu.dashboard",{username:i.username})}function o(){n()}var i=this;t.stopLoader(i),t.hideServerError(i),i.login=o}]),angular.module("contiv.menu").config(["$stateProvider",function(e){e.state("contiv.menu",{url:"/m",templateUrl:"menu/menu.html",controller:"MenuCtrl as menuCtrl",params:{username:null}})}]).controller("MenuCtrl",["$state","$stateParams",function(e,t){function n(){e.go("contiv.login")}var o=this;o.username=t.username,o.logout=n}]),angular.module("contiv.networkpolicies").directive("ctvBandwidth",function(){return{restrict:"E",scope:{bandwidthPolicy:"=",mode:"@"},link:function(e){if(""!=e.bandwidthPolicy.bandwidth){var t=e.bandwidthPolicy.bandwidth.split(" ");e.bandwidthPolicy.bandwidthNumber=Number(t[0]),e.bandwidthPolicy.bandwidthUnit=t[1]}},templateUrl:"network_policies/bandwidth.html"}}),angular.module("contiv.networkpolicies").config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies.bandwidth.create",{url:"/create",controller:"BandwidthPolicyCreateCtrl as bandwidthPolicyCreateCtrl",templateUrl:"network_policies/bandwidthpolicycreate.html"})}]).controller("BandwidthPolicyCreateCtrl",["$state","$stateParams","NetprofilesModel","CRUDHelperService",function(e,t,n,o){function i(){e.go("contiv.menu.networkpolicies.list.bandwidth")}function r(){i()}function a(){s.form.$valid&&(o.hideServerError(s),o.startLoader(s),s.newPolicy.key=n.generateKey(s.newPolicy),s.newPolicy.bandwidth=s.newPolicy.bandwidthNumber+" "+s.newPolicy.bandwidthUnit,n.create(s.newPolicy).then(function(e){o.stopLoader(s),i()},function(e){o.stopLoader(s),o.showServerError(s,e)}))}function l(){o.stopLoader(s),o.hideServerError(s),s.newPolicy={profileName:"",tenantName:"default",bandwidth:"",DSCP:""}}var s=this;s.createPolicy=a,s.cancelCreating=r,l()}]),angular.module("contiv.networkpolicies").config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies.bandwidth.details",{url:"/details/:key",controller:"BandwidthPolicyDetailsCtrl as bandwidthPolicyDetailsCtrl",templateUrl:"network_policies/bandwidthpolicydetails.html"})}]).config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies.bandwidth.edit",{url:"/edit/:key",controller:"BandwidthPolicyDetailsCtrl as bandwidthPolicyDetailsCtrl",templateUrl:"network_policies/bandwidthpolicydetails.html"})}]).controller("BandwidthPolicyDetailsCtrl",["$state","$stateParams","NetprofilesModel","CRUDHelperService",function(e,t,n,o){function i(){e.is("contiv.menu.networkpolicies.bandwidth.edit")?u.mode="edit":u.mode="details"}function r(){o.hideServerError(u),o.startLoader(u),n.deleteUsingKey(u.policy.key,"name").then(function(e){o.stopLoader(u),a()},function(e){o.stopLoader(u),o.showServerError(u,e)})}function a(){e.go("contiv.menu.networkpolicies.list.bandwidth")}function l(){e.go("contiv.menu.networkpolicies.bandwidth.details",{key:u.policy.key})}function s(){l()}function c(){u.form.$valid&&(o.hideServerError(u),o.startLoader(u),u.policy.bandwidth=u.policy.bandwidthNumber+" "+u.policy.bandwidthUnit,n.save(u.policy).then(function(e){o.stopLoader(u),l()},function(e){o.stopLoader(u),o.showServerError(u,e)}))}var u=this;u.bandwidthProfiles=[],n.getModelByKey(t.key).then(function(e){u.policy=e}),o.stopLoader(u),o.hideServerError(u),i(),u.deletePolicy=r,u.savePolicy=c,u.cancelEditing=s}]),angular.module("contiv.networkpolicies").config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies.list.bandwidth",{url:"/bandwidth",controller:"BandwidthPolicyListCtrl as bandwidthPolicyListCtrl",templateUrl:"network_policies/bandwidthpolicylist.html"})}]).controller("BandwidthPolicyListCtrl",["$scope","$interval","$filter","NetprofilesModel","CRUDHelperService",function(e,t,n,o,i){function r(e){o.get(e).then(function(e){i.stopLoader(a),a.policies=n("orderBy")(e,"profileName")},function(e){i.stopLoader(a)})}var a=this;r(!0);var l;angular.isDefined(l)||(l=t(function(){r(!0)},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(l)})}]),angular.module("contiv.networkpolicies").config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies.isolation.create",{url:"/create",controller:"IsolationPolicyCreateCtrl as isolationPolicyCreateCtrl",templateUrl:"network_policies/isolationpolicycreate.html"})}]).controller("IsolationPolicyCreateCtrl",["$state","PoliciesModel","CRUDHelperService",function(e,t,n){function o(){e.go("contiv.menu.networkpolicies.list.isolation")}function i(){o()}function r(){l.form.$valid&&(n.hideServerError(l),n.startLoader(l),l.newPolicy.key=t.generateKey(l.newPolicy),t.create(l.newPolicy).then(function(e){n.stopLoader(l),o()},function(e){n.stopLoader(l),n.showServerError(l,e)}))}function a(){n.stopLoader(l),n.hideServerError(l),l.newPolicy={policyName:"",tenantName:"default"}}var l=this;l.createPolicy=r,l.cancelCreating=i,a()}]),angular.module("contiv.networkpolicies").config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies.isolation.details",{url:"/details/:key",controller:"IsolationPolicyDetailsCtrl as isolationPolicyDetailsCtrl",templateUrl:"network_policies/isolationpolicydetails.html"})}]).config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies.isolation.edit",{url:"/edit/:key",controller:"IsolationPolicyDetailsCtrl as isolationPolicyDetailsCtrl",templateUrl:"network_policies/isolationpolicydetails.html"})}]).controller("IsolationPolicyDetailsCtrl",["$state","$stateParams","PoliciesModel","RulesModel","NetworksModel","ApplicationGroupsModel","CRUDHelperService",function(e,t,n,o,i,r,a){function l(){e.go("contiv.menu.networkpolicies.list.isolation")}function s(){e.go("contiv.menu.networkpolicies.isolation.details",{key:I.policy.key})}function c(){s()}function u(){s()}function d(){a.hideServerError(I),a.startLoader(I),n["delete"](I.policy).then(function(e){a.stopLoader(I),l()},function(e){a.stopLoader(I),a.showServerError(I,e)})}function p(){e.is("contiv.menu.networkpolicies.isolation.edit")?I.mode="edit":I.mode="details"}function v(){I.newIncomingRule={ruleId:"",priority:1,action:"allow",fromEndpointGroup:"",fromNetwork:"",fromIpAddress:"",protocol:"tcp",port:0,direction:"in",tenantName:"default",policyName:I.policy.policyName},I.newIncomingSelectedApplicationGroup="",I.newIncomingSelectedNetwork="",I.disableIncomingNetworkSelection=!1,I.disableIncomingApplicationGroupSelection=!1,I.disableIncomingIPAddressSelection=!1,I.incorrectCIDR=!1,I.validateCIDRFlag=!1}function f(){I.newOutgoingRule={ruleId:"",priority:1,action:"allow",toEndpointGroup:"",toNetwork:"",toIpAddress:"",protocol:"tcp",port:0,direction:"out",tenantName:"default",policyName:I.policy.policyName},I.newOutgoingSelectedApplicationGroup="",I.newOutgoingSelectedNetwork="",I.disableOutgoingNetworkSelection=!1,I.disableOutgoingApplicationGroupSelection=!1,I.disableOutgoingIPAddressSelection=!1,I.incorrectCIDR=!1,I.validateCIDRFlag=!1}function h(){i.get().then(function(e){I.networks=_.filter(e,{tenantName:"default"})})}function g(){r.get().then(function(e){I.applicationGroups=_.filter(e,{tenantName:"default"})})}function m(){null!=I.newOutgoingSelectedApplicationGroup?(I.newOutgoingRule.toEndpointGroup=I.newOutgoingSelectedApplicationGroup.groupName,I.newOutgoingRule.toNetwork="",I.disableOutgoingNetworkSelection=!0):(I.newOutgoingRule.toEndpointGroup="",I.disableOutgoingNetworkSelection=!1)}function y(){null!=I.newIncomingSelectedApplicationGroup?(I.newIncomingRule.fromEndpointGroup=I.newIncomingSelectedApplicationGroup.groupName,I.newIncomingRule.fromNetwork="",I.disableIncomingNetworkSelection=!0):(I.newIncomingRule.fromEndpointGroup="",I.disableOutgoingApplicationGroupSelection=!1,I.disableIncomingNetworkSelection=!1)}function b(){null!=I.newOutgoingSelectedNetwork?(I.newOutgoingRule.toNetwork=I.newOutgoingSelectedNetwork,I.newOutgoingRule.ToEndpointGroup="",I.disableOutgoingApplicationGroupSelection=!0,I.disableOutgoingIPAddressSelection=!0):(I.newOutgoingRule.toIpAddress="",I.disableOutgoingApplicationGroupSelection=!1,I.disableOutgoingIPAddressSelection=!1)}function w(){null!=I.newIncomingSelectedNetwork?(I.newIncomingRule.fromNetwork=I.newIncomingSelectedNetwork,I.newIncomingRule.fromEndpointGroup="",I.disableIncomingApplicationGroupSelection=!0,I.disableIncomingIPAddressSelection=!0):(I.newIncomingRule.fromNetwork="",I.disableIncomingApplicationGroupSelection=!1,I.disableIncomingIPAddressSelection=!1)}function P(e){e.ruleId=(I.incomingRules.length+I.outgoingRules.length+1).toString()+"-"+Date.now().toString()}function S(){C(I.newIncomingRule.fromIpAddress)&&(a.hideServerError(I),a.startLoader(I),P(I.newIncomingRule),I.newIncomingRule.key=o.generateKey(I.newIncomingRule),o.create(I.newIncomingRule).then(function(e){a.stopLoader(I),I.incomingRules.push(e),v()},function(e){a.stopLoader(I),a.showServerError(I,e)}))}function E(){""==I.newIncomingRule.fromIpAddress?(I.incorrectCIDR=!1,I.disableIncomingNetworkSelection=!1):I.disableIncomingNetworkSelection=!0,I.validateCIDRFlag&&I.incorrectCIDR&&C(I.newIncomingRule.fromIpAddress)}function N(){""==I.newOutgoingRule.toIpAddress?(I.incorrectCIDR=!1,I.disableOutgoingNetworkSelection=!1):I.disableOutgoingNetworkSelection=!0,I.validateCIDRFlag&&I.incorrectCIDR&&C(I.newOutgoingRule.toIpAddress)}function C(e){var t=new RegExp(ContivGlobals.CIDR_REGEX);return""==e?!0:t.test(e)?(I.incorrectCIDR=!1,!0):(I.incorrectCIDR=!0,I.validateCIDRFlag=!0,!1)}function k(){C(I.newOutgoingRule.toIpAddress)&&(a.hideServerError(I),a.startLoader(I),P(I.newOutgoingRule),I.newOutgoingRule.key=o.generateKey(I.newOutgoingRule),o.create(I.newOutgoingRule).then(function(e){a.stopLoader(I),I.outgoingRules.push(e),f()},function(e){a.stopLoader(I),a.showServerError(I,e)}))}function O(e){a.hideServerError(I),a.startLoader(I),o.deleteUsingKey(e).then(function(t){a.stopLoader(I),_.remove(I.incomingRules,function(t){return t.key==e})},function(e){a.stopLoader(I),a.showServerError(I,e)})}function D(e){a.hideServerError(I),a.startLoader(I),o.deleteUsingKey(e).then(function(t){a.stopLoader(I),_.remove(I.outgoingRules,function(t){return t.key==e})},function(e){a.stopLoader(I),a.showServerError(I,e)})}var I=this;I.networks=[],I.applicationGroups=[],I.disableOutgoingNetworkSelection=!1,I.disableIncomingNetworkSelection=!1,I.disableOutgoingApplicationGroupSelection=!1,I.disableIncomingApplicationGroupSelection=!1,I.disableIncomingIPAddressSelection=!1,I.disableOutgoingIPAddressSelection=!1,I.newIncomingSelectedApplicationGroup="",I.newOutgoingSelectedApplicationGroup="",I.newIncomingSelectedNetwork="",I.newOutgoingSelectedNetwork="",I.incorrectCIDR=!1,I.validateCIDRFlag=!1,a.stopLoader(I),a.hideServerError(I),n.getModelByKey(t.key).then(function(e){I.policy=e,o.getIncomingRules(e.policyName,"default").then(function(e){I.incomingRules=e,v()}),o.getOutgoingRules(e.policyName,"default").then(function(e){I.outgoingRules=e,f()})}),h(),g(),I.deletePolicy=d,I.deleteIncomingRule=O,I.deleteOutgoingRule=D,I.addIncomingRule=S,I.addOutgoingRule=k,I.doneEditing=u,I.cancelEditing=c,I.onChangeOutgoingApplicationGroupSelection=m,I.onChangeIncomingApplicationGroupSelection=y,I.onChangeOutgoingNetworkSelection=b,I.onChangeIncomingNetworkSelection=w,I.onChangeIncomingIPAddress=E,I.onChangeOutgoingIPAddress=N,p()}]),angular.module("contiv.networkpolicies").config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies.list.isolation",{url:"/isolation",controller:"IsolationPolicyListCtrl as isolationPolicyListCtrl",templateUrl:"network_policies/isolationpolicylist.html"})}]).controller("IsolationPolicyListCtrl",["$scope","$interval","$filter","PoliciesModel","CRUDHelperService",function(e,t,n,o,i){function r(e){o.get(e).then(function(e){i.stopLoader(a),a.policies=n("orderBy")(e,"policyName")},function(e){i.stopLoader(a)})}var a=this;r(!1);var l;angular.isDefined(l)||(l=t(function(){r(!0)},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(l)})}]),angular.module("contiv.networkpolicies").config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies.list",{url:"/list","abstract":!0,controller:"NetworkPoliciesTabsCtrl as networkPoliciesTabsCtrl",templateUrl:"network_policies/networkpoliciestabs.html"}).state("contiv.menu.networkpolicies.list.redirection",{url:"/redirection",template:""})}]).controller("NetworkPoliciesTabsCtrl",["$state",function(e){function t(){e.$current.includes["contiv.menu.networkpolicies.list.isolation"]&&e.go("contiv.menu.networkpolicies.isolation.create"),e.$current.includes["contiv.menu.networkpolicies.list.bandwidth"]&&e.go("contiv.menu.networkpolicies.bandwidth.create")}var n=this;n.createNetworkPolicy=t}]),angular.module("contiv.networks").config(["$stateProvider",function(e){e.state("contiv.menu.networks.create",{url:"/create",templateUrl:"networks/networkcreate.html",controller:"NetworkCreateCtrl as networkCreateCtrl"})}]).controller("NetworkCreateCtrl",["$state","$stateParams","NetworksModel","CRUDHelperService",function(e,t,n,o){function i(){e.go("contiv.menu.networks.list")}function r(){i()}function a(){s.form.$valid&&(o.hideServerError(s),o.startLoader(s),s.newNetwork.key=s.newNetwork.tenantName+":"+s.newNetwork.networkName,n.create(s.newNetwork).then(function(e){o.stopLoader(s),i()},function(e){o.stopLoader(s),o.showServerError(s,e)}))}function l(){o.stopLoader(s),o.hideServerError(s),s.newNetwork={networkName:"",encap:"vxlan",subnet:"",gateway:"",tenantName:"default"}}var s=this;s.cidrPattern=ContivGlobals.CIDR_REGEX,s.createNetwork=a,s.cancelCreating=r,l()}]),angular.module("contiv.networks").config(["$stateProvider",function(e){e.state("contiv.menu.networks.details",{url:"/details/:key",controller:"NetworkDetailsCtrl as networkDetailsCtrl",templateUrl:"networks/networkdetails.html"}).state("contiv.menu.networks.details.info",{url:"/info",templateUrl:"networks/networkinfo.html"})}]).controller("NetworkDetailsCtrl",["$state","$stateParams","$scope","$interval","$filter","NetworksModel","ApplicationGroupsModel","CRUDHelperService",function(e,t,n,o,i,r,a,l){function s(){e.go("contiv.menu.networks.list")}function c(){l.hideServerError(d),l.startLoader(d),r["delete"](d.network).then(function(e){l.stopLoader(d),s()},function(e){l.stopLoader(d),l.showServerError(d,e)})}function u(e){a.get(e).then(function(e){d.applicationGroups=i("orderBy")(_.filter(e,{networkName:d.network.networkName}),"groupName")})}var d=this;l.stopLoader(d),l.hideServerError(d),r.getModelByKey(t.key).then(function(e){d.network=e,u(!1)}),d.deleteNetwork=c;var p;angular.isDefined(p)||(p=o(function(){u(!0)},ContivGlobals.REFRESH_INTERVAL)),n.$on("$destroy",function(){o.cancel(p)})}]),angular.module("contiv.networks").config(["$stateProvider",function(e){e.state("contiv.menu.networks.list",{url:"/list",controller:"NetworksListCtrl as networksListCtrl",templateUrl:"networks/networklist.html"})}]).controller("NetworksListCtrl",["$scope","$interval","$filter","NetworksModel","CRUDHelperService",function(e,t,n,o,i){function r(e){o.get(e).then(function(e){i.stopLoader(a),a.networks=e},function(e){i.stopLoader(a)})}var a=this;r(!1);var l;angular.isDefined(l)||(l=t(function(){r(!0)},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(l)})}]),angular.module("contiv.networks").config(["$stateProvider",function(e){e.state("contiv.menu.networks.details.stats",{url:"/stats",controller:"NetworkStatsCtrl as networkStatsCtrl",templateUrl:"networks/networkstats.html"})}]).controller("NetworkStatsCtrl",["$state","$stateParams","$scope","$interval","$filter","NetworksModel","InspectService",function(e,t,n,o,i,r,a){function l(e){r.getInspectByKey(t.key,ContivGlobals.NETWORKS_INSPECT_ENDPOINT,e).then(function(e){if(s.networkInspectStats=e.Oper,s.config=e.Config,void 0!=e.Oper.endpoints){var t=a.buildEndPoints(e.Oper.endpoints);a.checkContainerChanged(s.containerDetails,t)&&(s.endpoints=e.Oper.endpoints,s.containerDetails=t)}else s.endpoints=[],s.containerDetails={}})}var s=this;l(!1);var c;angular.isDefined(c)||(c=o(function(){l(!0)},ContivGlobals.REFRESH_INTERVAL)),n.$on("$destroy",function(){o.cancel(c)})}]),angular.module("contiv.nodes").factory("BgpService",["$http","$q",function(e,t){function n(n){var o=t.defer(),i=ContivGlobals.BGPS_ENDPOINT+n.key+"/";return e.get(i).then(function(e){o.resolve(e.data),n.neighbor=e.data,n.neighbors.push({name:n.neighbor.neighbor,value:n.neighbor["neighbor-as"]})},function(e){o.reject(e.data)}),o.promise}function o(t){var n=ContivGlobals.BGPS_ENDPOINT+t.key+"/";return e.post(n,t.neighbor)}function i(n){var o=t.defer(),i=ContivGlobals.BGPS_INSPECT_ENDPOINT+n+"/";return e.get(i).then(function(e){o.resolve(e.data)},function(e){o.reject(e.data)}),o.promise}return{getBgp:n,updateBgp:o,getBgpInspect:i}}]),angular.module("contiv.nodes").directive("ctvLogs",function(){return{restrict:"E",templateUrl:"nodes/logs.html",scope:{log:"=",title:"@"}}}),angular.module("contiv.nodes").factory("LogService",["$http","$q",function(e,t){function n(){var n=t.defer(),o=ContivGlobals.NODES_ACTIVE_JOB_ENDPOINT;return e.get(o).then(function(e){n.resolve(e.data)},function(e){n.reject(e.data)}),n.promise}function o(){var n=t.defer(),o=ContivGlobals.NODES_LAST_JOB_ENDPOINT;return e.get(o).then(function(e){n.resolve(e.data)},function(e){n.reject(e.data)}),n.promise}return{getActiveLogs:n,getLastLogs:o}}]),angular.module("contiv.nodes").config(["$stateProvider",function(e){e.state("contiv.menu.nodes.activelog",{url:"/activelog",controller:"NodeActiveJobLogsCtrl as nodeActiveJobLogsCtrl",template:'<ctv-logs title="Active Job" log="nodeActiveJobLogsCtrl.activeLogs"></ctv-logs>'})}]).controller("NodeActiveJobLogsCtrl",["$scope","$interval","LogService",function(e,t,n){function o(){n.getActiveLogs().then(function(e){i.activeLogs=e},function(e){i.activeLogs={desc:"There is currently no active job. Check Last Job for a job that recently finished."}})}var i=this;o();var r;angular.isDefined(r)||(r=t(function(){o()},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(r)})}]),angular.module("contiv.nodes").config(["$stateProvider",function(e){e.state("contiv.menu.nodes.commission",{url:"/commission/:key",controller:"NodeCommissionCtrl as nodeCommissionCtrl",templateUrl:"nodes/nodecommission.html"})}]).controller("NodeCommissionCtrl",["$state","$stateParams","NodesModel","CRUDHelperService","NodesService",function(e,t,n,o,i){function r(){e.go("contiv.menu.nodes.details.info",{key:t.key})}function a(){r()}function l(){s.form.$valid&&(o.hideServerError(s),o.startLoader(s),s.nodeOpsObj.nodes=[t.key],i.cleanupExtraVars(s),i.createExtraVars(s),n.commission(s.nodeOpsObj).then(function(e){o.stopLoader(s),r()},function(e){o.stopLoader(s),o.showServerError(s,e)}))}var s=this;s.nodeOpsObj={},s.extra_vars={},s.ansibleVariables=[],s.envVariables=[],i.getSettings(s),s.cancelCommissioningNode=a,s.commission=l,o.stopLoader(s),o.hideServerError(s)}]),angular.module("contiv.nodes").config(["$stateProvider",function(e){e.state("contiv.menu.nodes.details",{url:"/details/:key",controller:"NodeDetailsCtrl as nodeDetailsCtrl",templateUrl:"nodes/nodedetails.html"}).state("contiv.menu.nodes.details.info",{url:"/info",controller:"NodeDetailsCtrl as nodeDetailsCtrl",templateUrl:"nodes/nodeinfo.html"}).state("contiv.menu.nodes.details.stats",{url:"/stats",controller:"NodeDetailsCtrl as nodeDetailsCtrl",templateUrl:"nodes/nodestats.html"}).state("contiv.menu.nodes.details.logs",{url:"/logs",controller:"NodeDetailsCtrl as nodeDetailsCtrl",templateUrl:"nodes/nodelogs.html"}).state("contiv.menu.nodes.details.edit",{url:"/edit",controller:"NodeDetailsCtrl as nodeDetailsCtrl",templateUrl:"nodes/nodeinfo.html"})}]).controller("NodeDetailsCtrl",["$state","$stateParams","$scope","$interval","NodesModel","BgpService",function(e,t,n,o,i,r){function a(){var e={nodes:[t.key]};i.decommission(e).then(function(e){h.showCommissionButton=!1,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1})}function l(){var e={nodes:[t.key]};i.upgrade(e).then(function(e){h.showCommissionButton=!1,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1})}function s(){switch(h.node.inventory_state.status){case"Unallocated":h.showCommissionButton=!0,h.commissionButtonEnabled=!0,h.upgradeButtonEnabled=!1;break;case"Decommissioned":h.showCommissionButton=!0,h.commissionButtonEnabled=!0,h.upgradeButtonEnabled=!1;break;case"Provisioning":h.showCommissionButton=!0,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1;break;case"Allocated":h.showCommissionButton=!1,h.commissionButtonEnabled=!0,h.upgradeButtonEnabled=!0;break;case"Cancelled":h.showCommissionButton=!1,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1;break;case"Maintenance":h.showCommissionButton=!0,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1;break;default:h.showCommissionButton=!0,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1}}function c(e){i.getModelByKey(t.key,e).then(function(e){h.node=e,s()})}function u(){e.is("contiv.menu.nodes.details.edit")?h.mode="edit":h.mode="details"}function d(){e.go("contiv.menu.nodes.details.info")}function p(){h.form.$valid&&(h.neighbor.key=t.key,h.neighbors.forEach(function(e){h.neighbor.neighbor=e.name,h.neighbor["neighbor-as"]=e.value}),r.updateBgp(h).then(function(e){h.neighbor=e.config.data,d()},function(e){}))}function v(){r.getBgp(h).then(function(e){h.neighbor=e},function(e){})}function f(){r.getBgpInspect(t.key).then(function(e){h.inspect=e,h.routes=e.Oper.routes,h.filteredroutes=e.Oper.routes},function(e){})}var h=this;h.numberpattern=ContivGlobals.NUMBER_REGEX,h.decommission=a,h.upgrade=l,h.setMode=u,h.updateBgpInfo=p,h.returnToInfo=d,h.neighbors=[],h.neighbor={},h.key=t.key,v(),f(),u(),c(!1);var g;angular.isDefined(g)||(g=o(function(){c(!0)},5e3)),n.$on("$destroy",function(){o.cancel(g)})}]),angular.module("contiv.nodes").directive("ctvNodestatus",function(){return{restrict:"E",scope:{node:"="},templateUrl:"nodes/nodestatus.html"}}).directive("ctvNodestate",function(){return{restrict:"E",scope:{node:"="},templateUrl:"nodes/nodestate.html"}}),angular.module("contiv.nodes").config(["$stateProvider",function(e){e.state("contiv.menu.nodes.discover",{url:"/discover",controller:"NodeDiscoverCtrl as nodeDiscoverCtrl",templateUrl:"nodes/nodediscover.html"})}]).controller("NodeDiscoverCtrl",["$state","$stateParams","NodesModel","CRUDHelperService","NodesService",function(e,t,n,o,i){function r(){e.go("contiv.menu.nodes.list")}function a(){r()}function l(){c.form.$valid&&(o.hideServerError(c),o.startLoader(c),s(),i.createExtraVars(c),n.discover(c.nodeOpsObj).then(function(e){o.stopLoader(c),r()},function(e){o.stopLoader(c),o.showServerError(c,e)}))}function s(){c.nodeOpsObj.addrs=_.words(c.nodeIPAddr,/[^, ]+/g)}var c=this;c.nodeOpsObj={},c.extra_vars={},c.ansibleVariables=[],c.envVariables=[],c.nodeIPAddr="",i.getSettings(c),c.discover=l,c.cancelDiscoveringNode=a,o.stopLoader(c),o.hideServerError(c)}]),angular.module("contiv.nodes").config(["$stateProvider",function(e){e.state("contiv.menu.nodes.lastlog",{url:"/lastlog",controller:"NodeLastJobLogsCtrl as nodeLastJobLogsCtrl",template:'<ctv-logs title="Last Job" log="nodeLastJobLogsCtrl.lastLogs"></ctv-logs>'})}]).controller("NodeLastJobLogsCtrl",["$scope","$interval","LogService",function(e,t,n){function o(){n.getLastLogs().then(function(e){i.lastLogs=e},function(e){})}var i=this;o();var r;angular.isDefined(r)||(r=t(function(){o()},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(r)})}]),angular.module("contiv.nodes").config(["$stateProvider",function(e){e.state("contiv.menu.nodes.list",{url:"/list",controller:"NodeListCtrl as nodeListCtrl",templateUrl:"nodes/nodelist.html"})}]).controller("NodeListCtrl",["$scope","$interval","$filter","NodesModel","CRUDHelperService",function(e,t,n,o,i){function r(e){o.get(e).then(function(e){i.stopLoader(a),a.nodes=e},function(e){i.stopLoader(a)})}var a=this;r(!1);var l;angular.isDefined(l)||(l=t(function(){r(!0)},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(l)})}]),angular.module("contiv.organizations").config(["$stateProvider",function(e){e.state("contiv.menu.organizations.create",{url:"/create",templateUrl:"organizations/organizationcreate.html",controller:"OrganizationCreateCtrl as organizationCreateCtrl"})}]).controller("OrganizationCreateCtrl",["$state","OrganizationsModel","CRUDHelperService",function(e,t,n){function o(){e.go("contiv.menu.organizations.list")}function i(){o()}function r(){l.form.$valid&&(n.hideServerError(l),n.startLoader(l),l.newOrganization.key=l.newOrganization.tenantName,t.create(l.newOrganization).then(function(e){n.stopLoader(l),o()},function(e){n.stopLoader(l),n.showServerError(l,e)}))}function a(){n.stopLoader(l),n.hideServerError(l),l.newOrganization={tenantName:""}}var l=this;l.createOrganization=r,l.cancelCreating=i,a()}]),angular.module("contiv.organizations").config(["$stateProvider",function(e){e.state("contiv.menu.organizations.details",{url:"/details/:key",controller:"OrganizationDetailsCtrl as organizationDetailsCtrl",templateUrl:"organizations/organizationdetails.html"})}]).controller("OrganizationDetailsCtrl",["$state","$stateParams","OrganizationsModel","CRUDHelperService",function(e,t,n,o){function i(){e.go("contiv.menu.organizations.list")}function r(){o.hideServerError(a),o.startLoader(a),n["delete"](a.organization).then(function(e){o.stopLoader(a),i()},function(e){o.stopLoader(a),o.showServerError(a,e)})}var a=this;o.stopLoader(a),o.hideServerError(a),n.getModelByKey(t.key).then(function(e){a.organization=e}),a.deleteOrganization=r}]),angular.module("contiv.organizations").config(["$stateProvider",function(e){e.state("contiv.menu.organizations.list",{url:"/list",controller:"OrganizationsListCtrl as organizationsListCtrl",templateUrl:"organizations/organizationlist.html"})}]).controller("OrganizationsListCtrl",["$scope","$interval","$filter","OrganizationsModel","CRUDHelperService",function(e,t,n,o,i){function r(e){o.get(e).then(function(e){i.stopLoader(a),a.organizations=e},function(e){i.stopLoader(a)})}var a=this;r(!1);var l;angular.isDefined(l)||(l=t(function(){r(!0)},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(l)})}]),angular.module("contiv.servicelbs").config(["$stateProvider",function(e){e.state("contiv.menu.servicelbs.create",{url:"/create",templateUrl:"service_lbs/servicelbcreate.html",controller:"ServicelbCreateCtrl as servicelbCreateCtrl"})}]).controller("ServicelbCreateCtrl",["$state","$stateParams","ServicelbsModel","NetworksModel","CRUDHelperService",function(e,t,n,o,i){function r(){e.go("contiv.menu.servicelbs.list")}function a(){r()}function l(){o.get().then(function(e){d.networks=_.filter(e,{tenantName:"default"})})}function s(){d.servicelb.selectors=[],angular.forEach(d.labelSelectors,function(e){var t=e.name+"="+e.value;d.servicelb.selectors.push(t)})}function c(){s(),d.form.$valid&&(i.hideServerError(d),i.startLoader(d),d.servicelb.key=d.servicelb.tenantName+":"+d.servicelb.serviceName,n.create(d.servicelb).then(function(e){i.stopLoader(d),r()},function(e){i.stopLoader(d),i.showServerError(d,e)}))}function u(){i.stopLoader(d),i.hideServerError(d),d.servicelb={serviceName:"",networkName:"",ipAddress:"",selectors:[],ports:[],tenantName:"default"}}var d=this;d.labelSelectors=[],d.networks=[],d.createServicelb=c,d.cancelCreating=a,l(),u()}]),angular.module("contiv.servicelbs").config(["$stateProvider",function(e){e.state("contiv.menu.servicelbs.details",{url:"/details/:key",params:{state:null},controller:"ServicelbDetailsCtrl as servicelbDetailsCtrl",templateUrl:"service_lbs/servicelbdetails.html"}).state("contiv.menu.servicelbs.details.info",{url:"/info",controller:"ServicelbDetailsCtrl as servicelbDetailsCtrl",templateUrl:"service_lbs/servicelbinfo.html"
}).state("contiv.menu.servicelbs.details.edit",{url:"/edit/:key",controller:"ServicelbDetailsCtrl as servicelbDetailsCtrl",templateUrl:"service_lbs/servicelbinfo.html"})}]).controller("ServicelbDetailsCtrl",["$state","$stateParams","ServicelbsModel","CRUDHelperService",function(e,t,n,o){function i(){e.is("contiv.menu.servicelbs.details.edit")?p.mode="edit":p.mode="details"}function r(){e.go("contiv.menu.servicelbs.list")}function a(){e.go("contiv.menu.servicelbs.details.info",{key:p.servicelb.key,state:"details"})}function l(){a()}function s(){o.hideServerError(p),o.startLoader(p),n["delete"](p.servicelb).then(function(e){o.stopLoader(p),r()},function(e){o.stopLoader(p),o.showServerError(p,e)})}function c(){o.hideServerError(p),o.startLoader(p);var e=p.servicelb.selectors;d(),n.save(p.servicelb).then(function(e){o.stopLoader(p),a()},function(t){p.servicelb.selectors=e,u(),o.stopLoader(p),o.showServerError(p,t)})}function u(){angular.forEach(p.servicelb.selectors,function(e){var t={name:e.split("=")[0],value:e.split("=")[1]};p.labelSelectors.push(t)})}function d(){p.servicelb.selectors=[],angular.forEach(p.labelSelectors,function(e){var t=e.name+"="+e.value;p.servicelb.selectors.push(t)})}var p=this;p.labelSelectors=[],o.stopLoader(p),o.hideServerError(p),n.getModelByKey(t.key).then(function(e){p.servicelb=e,u()}),p.saveServicelb=c,p.cancelEditing=l,p.deleteServicelb=s,i()}]),angular.module("contiv.servicelbs").config(["$stateProvider",function(e){e.state("contiv.menu.servicelbs.list",{url:"/list",controller:"ServicelbListCtrl as servicelbListCtrl",templateUrl:"service_lbs/servicelblist.html"})}]).controller("ServicelbListCtrl",["$scope","$interval","$filter","ServicelbsModel","CRUDHelperService",function(e,t,n,o,i){function r(e){o.get(e).then(function(e){i.stopLoader(a),a.servicelbs=e},function(e){i.stopLoader(a)})}var a=this;r(!1);var l;angular.isDefined(l)||(l=t(function(){r(!0)},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(l)})}]),angular.module("contiv.servicelbs").directive("ctvServicelbports",function(){return{restrict:"E",scope:{items:"="},link:function(e){function t(e,t){return e===t}function n(){e.newItem={servicePort:"",providerPort:"",protocol:""}}function o(e){return""===e.servicePort&&""===e.providerPort&&""===e.protocol}e.add=function(){if(!o(e.newItem)){void 0===e.items&&(e.items=[]);var i=e.newItem.servicePort+":"+e.newItem.providerPort+":"+e.newItem.protocol;_.pullAllWith(e.items,[i],t),e.items.push(i),n()}},e.remove=function(n){_.remove(e.items,function(e){return t(e,n)})},n()},templateUrl:"service_lbs/servicelbports.html"}}),angular.module("contiv.servicelbs").config(["$stateProvider",function(e){e.state("contiv.menu.servicelbs.details.stats",{url:"/stats",controller:"ServicelbStatsCtrl as servicelbStatsCtrl",templateUrl:"service_lbs/servicelbstats.html"})}]).controller("ServicelbStatsCtrl",["$state","$stateParams","$scope","$interval","$filter","ServicelbsModel","InspectService",function(e,t,n,o,i,r,a){function l(e){r.getInspectByKey(t.key,ContivGlobals.SERVICELBS_INSPECT_ENDPOINT,e).then(function(e){if(s.servicelbInspectStats=e.Oper,s.config=e.Config,void 0!=e.Oper.providers){var t=a.buildEndPoints(e.Oper.providers);a.checkContainerChanged(s.providerDetails,t)&&(s.providers=e.Oper.providers,s.providerDetails=t)}else s.providers=[],s.providerDetails={}})}var s=this;l(!1);var c;angular.isDefined(c)||(c=o(function(){l(!0)},ContivGlobals.REFRESH_INTERVAL)),n.$on("$destroy",function(){o.cancel(c)})}]),angular.module("contiv.settings").config(["$stateProvider",function(e){e.state("contiv.menu.settings.details.cluster",{url:"/cluster",controller:"ClusterSettingCtrl as clusterSettingCtrl",templateUrl:"settings/clustersettings.html"})}]).controller("ClusterSettingCtrl",["$stateParams","CRUDHelperService","NodesService",function(e,t,n){function o(){i.form.$valid&&(t.hideServerError(i),t.startLoader(i),i.nodeOpsObj.nodes=[e.key],n.cleanupExtraVars(i),n.createExtraVars(i),n.updateSettings(i.nodeOpsObj).then(function(e){t.stopLoader(i)},function(e){t.stopLoader(i),t.showServerError(i,e)}))}var i=this;i.nodeOpsObj={},i.extra_vars={},i.ansibleVariables=[],i.envVariables=[],n.getSettings(i),i.updateClusterSettings=o,t.stopLoader(i),t.hideServerError(i)}]),angular.module("contiv.settings").config(["$stateProvider",function(e){e.state("contiv.menu.settings.details.networks",{url:"/networks",controller:"NetworkSettingCtrl as networkSettingCtrl",templateUrl:"settings/networksettings.html"})}]).controller("NetworkSettingCtrl",["CRUDHelperService","NetworkService",function(e,t){function n(){i.form.$valid&&(e.hideServerError(i),e.startLoader(i),t.updateSettings(i.setting).then(function(t){e.stopLoader(i)},function(t){e.stopLoader(i),e.showServerError(i,t)}))}function o(){t.getSettings().then(function(e){i.setting=e},function(e){})}var i=this;i.vlanPattern=ContivGlobals.VLAN_REGEX,i.vxlanPattern=ContivGlobals.VXLAN_REGEX,o(),i.updateNetworkSettings=n,e.stopLoader(i),e.hideServerError(i)}]),angular.module("contiv.settings").config(["$stateProvider",function(e){e.state("contiv.menu.settings.details.volumes",{url:"/volumes",controller:"VolumeSettingCtrl as volumeSettingCtrl",templateUrl:"/settings/volumesettings.html"})}]).controller("VolumeSettingCtrl",["CRUDHelperService","VolumeSettingService",function(e,t){function n(){i.form.$valid&&(e.hideServerError(i),e.startLoader(i),t.updateSettings(i.setting).then(function(t){e.stopLoader(i)},function(t){e.stopLoader(i),e.showServerError(i,t)}))}function o(){t.getSettings().then(function(e){i.setting=e},function(e){})}var i=this;o(),i.updateVolumeSettings=n,e.stopLoader(i),e.hideServerError(i)}]),angular.module("contiv.storagepolicies").config(["$stateProvider",function(e){e.state("contiv.menu.storagepolicies.create",{url:"/create",templateUrl:"storage_policies/storagepolicycreate.html",controller:"StoragePolicyCreateCtrl as storagePolicyCreateCtrl"})}]).controller("StoragePolicyCreateCtrl",["$state","$stateParams","StoragePoliciesModel","CRUDHelperService",function(e,t,n,o){function i(){e.go("contiv.menu.storagepolicies.list")}function r(){i()}function a(){c.filesystemcmds.forEach(function(e){c.newStoragePolicy.filesystems[e.name]=e.value})}function l(){c.form.$valid&&(o.hideServerError(c),o.startLoader(c),a(),n.create(c.newStoragePolicy).then(function(e){o.stopLoader(c),i()},function(e){o.stopLoader(c),o.showServerError(c,e)}))}function s(){o.stopLoader(c),o.hideServerError(c),c.newStoragePolicy={name:"",backends:{crud:"ceph",mount:"ceph",snapshot:"ceph"},unlocked:!1,driver:{pool:"rbd"},create:{size:"0",filesystem:""},runtime:{snapshots:!0,snapshot:{frequency:"30m",keep:20},"rate-limit":{"write-iops":0,"read-iops":0,"write-bps":0,"read-bps":0}},filesystems:{}}}var c=this;c.createPolicy=l,c.cancelCreating=r,c.filesystemcmds=[],s()}]),angular.module("contiv.storagepolicies").config(["$stateProvider",function(e){e.state("contiv.menu.storagepolicies.details",{url:"/details/:key",controller:"StoragePolicyDetailsCtrl as storagePolicyDetailsCtrl",templateUrl:"storage_policies/storagepolicydetails.html"}).state("contiv.menu.storagepolicies.edit",{url:"/details/:key",controller:"StoragePolicyDetailsCtrl as storagePolicyDetailsCtrl",templateUrl:"storage_policies/storagepolicydetails.html"})}]).controller("StoragePolicyDetailsCtrl",["$state","$stateParams","$scope","$interval","$filter","StoragePoliciesModel","VolumesModel","CRUDHelperService",function(e,t,n,o,i,r,a,l){function s(){e.is("contiv.menu.storagepolicies.edit")?m.mode="edit":m.mode="details"}function c(){e.go("contiv.menu.storagepolicies.list")}function u(){e.go("contiv.menu.storagepolicies.details",{key:m.policy.name})}function d(){u()}function p(){l.hideServerError(m),l.startLoader(m),r.deleteUsingKey(m.policy.name,"name").then(function(e){l.stopLoader(m),c()},function(e){l.stopLoader(m),l.showServerError(m,e)})}function v(e){a.get(e).then(function(e){m.volumes=i("orderBy")(_.filter(e,{policy:m.policy.name}),"name")})}function f(){angular.forEach(m.policy.filesystems,function(e,t){this.push({name:t,value:e})},m.filesystemcmds)}function h(){m.filesystemcmds.forEach(function(e){m.policy.filesystems[e.name]=e.value})}function g(){m.form.$valid&&(l.hideServerError(m),l.startLoader(m),h(),r.save(m.policy).then(function(e){l.stopLoader(m),u()},function(e){l.stopLoader(m),l.showServerError(m,e)}))}var m=this;m.filesystemcmds=[],l.stopLoader(m),l.hideServerError(m),r.getModelByKey(t.key,!1,"name").then(function(e){m.policy=e,f(),v(!1)}),m.deletePolicy=p,m.savePolicy=g,m.cancelEditing=d,s();var y;angular.isDefined(y)||(y=o(function(){v(!0)},ContivGlobals.REFRESH_INTERVAL)),n.$on("$destroy",function(){o.cancel(y)})}]),angular.module("contiv.storagepolicies").directive("ctvStoragepolicybasicsettings",function(){return{}}).directive("ctvStoragepolicyfilesystemsettings",function(){return{restrict:"E",scope:{policy:"=",filesystemcmds:"="},link:function(e){e.filesystems=["ext4","btrfs"]},templateUrl:"storage_policies/filesystemsettings.html"}}).directive("ctvStoragepolicysnapshotsettings",function(){return{restrict:"E",scope:{policy:"="},templateUrl:"storage_policies/snapshotsettings.html"}}).directive("ctvStoragepolicyrwopssettings",function(){return{restrict:"E",scope:{policy:"="},templateUrl:"storage_policies/rwopssettings.html"}}).directive("ctvStoragepolicybackenddrivers",function(){return{restrict:"E",scope:{policy:"="},templateUrl:"storage_policies/backenddrivers.html"}}),angular.module("contiv.storagepolicies").config(["$stateProvider",function(e){e.state("contiv.menu.storagepolicies.list",{url:"/list",controller:"StoragePolicyListCtrl as storagePolicyListCtrl",templateUrl:"storage_policies/storagepolicylist.html"})}]).controller("StoragePolicyListCtrl",["$scope","$interval","$filter","StoragePoliciesModel","CRUDHelperService",function(e,t,n,o,i){function r(e){o.get(e).then(function(e){i.stopLoader(a),a.policies=e},function(e){i.stopLoader(a)})}var a=this;r(!1);var l;angular.isDefined(l)||(l=t(function(){r(!0)},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(l)})}]),angular.module("contiv.visualization").config(["$stateProvider",function(e){e.state("contiv.menu.visualization.edge",{url:"/edge/{sourceName, targetName, sourceList, targetList}",params:{sourceName:null,targetName:null,sourceList:null,targetList:null},controller:"VisualizationEdgeCtrl as visualizationedgeCtrl",templateUrl:"visualization/visualizationedge.html"})}]).controller("VisualizationEdgeCtrl",["$scope","$http","$state","$stateParams","VisualizationService","$interval",function(e,t,n,o,i,r){var a=o.sourceName,l=o.targetName,s=o.sourceList,c=o.targetList;if(null==s||null==c)return void n.go("contiv.menu.visualization.list");var u=new Date,d=u.getSeconds();e.edgeDataInterval=r(function(){i.getEdgeData(s,c,d.toString()).then(function(t){var n=t.results,o=0;_.forEach(n,function(e){_.isEmpty(e)===!1&&(o+=e.series[0].values[0][1])}),e.sourceName=a,e.targetName=l,e.edgeData=o,e.edgeDataTime=d},function(e){})},3e3),e.$on("$destroy",function(){r.cancel(e.edgeDataInterval)}),i.getOldEdgeData(s,c).then(function(t){var n=t.results,o=[];_.forEach(n,function(e){if(_.isEmpty(e)===!1){var t=e.series[0].values;_.isEmpty(o)?_.forEach(t,function(e){o.push(e[1])}):_.forEach(t,function(e,t){o[t]+=e[1]})}}),e.sourceName=a,e.targetName=l,e.sourceList=s,e.targetList=c,e.oldEdgeData=o},function(e){})}]),angular.module("contiv.visualization").directive("visualizationEdge",["$window",function(e){function t(e,t){function n(){s=new Date;for(var t in c){var o=c[t];o.data.push(e.edgeData||0),o.path.attr("d",p)}u.domain([s-(a-2)*l,s-l]),g.transition().duration(l).ease("linear").call(u.axis),f.transition().duration(l).ease("linear").call(d.axis),m.attr("transform",null).transition().duration(l).ease("linear").attr("transform","translate("+u(s-(a-1)*l)+")").each("end",function(){n()});for(var t in c){var o=c[t];o.data.shift()}}var o=document.getElementsByTagName("body")[0],i=o.clientWidth-400,r=o.clientHeight-400,a=59,l=750,s=new Date(Date.now()-l),c={current:{value:0,color:"orange",data:t.range(a).map(function(t){return e.oldEdgeData[Math.floor(t/10)]||0})}},u=t.time.scale().domain([s-(a-2),s-l]).range([0,i]),d=t.scale.linear().domain([0,t.max(c.current.data,function(e){return e+10})]).range([r,0]),p=t.svg.line().interpolate("basis").x(function(e,t){return u(s-(a-1-t)*l)}).y(function(e){return d(e)}),v=t.select(".graph").append("svg").attr("width",25).style("overflow","visible").style("position","fixed"),f=v.append("g").attr("class","y axis").call(d.axis=t.svg.axis().scale(d).orient("left")),h=t.select(".graph").append("svg").attr("class","chart").attr("width",i-50).attr("height",r+50),g=h.append("g").attr("class","x axis").attr("transform","translate(0,"+r+")").call(u.axis=t.svg.axis().scale(u).orient("bottom")),m=h.append("g");for(var y in c){var b=c[y];b.path=m.append("path").data([b.data]).attr("class",y+" group").style("stroke",b.color)}n()}return{restrict:"EA",replace:!1,templateUrl:"visualization/visualizationedgetemplate.html",link:function(n){n.$watchGroup(["edgeData","oldEdgeData"],function(){if(null!=n.edgeData&&null!=n.oldEdgeData&&!n.initialize){n.initialize=!0;var o=e.d3;t(n,o)}})}}}]),angular.module("contiv.visualization").service("StateSave",function(){this.savedStates={}}).directive("visualizationGraph",["$window","$state","VisualizerGraph","PolicyService","VisualizerDataSource","StateSave",function(e,t,n,o,i,r){function a(e,n,o,i,r,a){if(void 0!==e.nodes&&void 0!==e.links&&void 0!==e.children_struct&&void 0!==e.ancestors_struct){var l=new r.DataSource(e.nodes,e.links,e.children_struct,e.ancestors_struct,e.labels,e.serviceSelectors);l.setAncestors();var s,c,u=l.getTopLevelFlow();s=l.processNodeData(u.nodeData),c=l.processLinkData(u.linkData,s);var d=document.getElementsByTagName("body")[0],p=(d.clientWidth,d.clientHeight),v=n.find("svg"),f=$(v.parent()).offset(),h=$(v.parent()).width(),g=d3.select(v[0]).attr("width",h).attr("height",p-f.top-20);e.visualizationGraph=new o.Graph(g,s,c,l,e.children_struct,e.ancestors_struct),e.visualizationGraph.installDefaultPathPolicy(new i.SaveStatePolicy(a.savedStates)),e.visualizationGraph.installDefaultPathPolicy(new i.PathChangeViewPolicy(t));var m=new i.QTipPolicy;e.visualizationGraph.installDefaultNodePolicy(m),e.visualizationGraph.installDefaultPathPolicy(m);var y=new i.SplitJoinViewPolicy;if(e.visualizationGraph.installDefaultNodePolicy(y),y.installBackButton($("#backButton")),y.installTitle($("#graph-title")),0==_.isEmpty(a.savedStates)){var b=e.visualizationGraph;b.load(a.savedStates)}else e.visualizationGraph.updateGraph()}}return{restrict:"EA",replace:!1,templateUrl:"visualization/visualizationtemplate.html",link:function(e,t){e.$on("$destroy",function(){$("#visualization-graph").unbind(),e.visualizationGraph.destroy()}),e.$watchGroup(["nodes","links","children_struct","ancestors_struct"],function(){null!=e.nodes&&null!=e.links&&null!=e.children_struct&&null!=e.ancestors_struct&&(e.initialized?(e.visualizationGraph.dataSource.links=e.links,e.visualizationGraph.updateLinkData()):(e.initialized=!0,a(e,t,n,o,i,r)))})}}}]),angular.module("contiv.visualization").config(["$stateProvider",function(e){e.state("contiv.menu.visualization.list",{url:"/list",controller:"VisualizationListCtrl as visualizationListCtrl",templateUrl:"visualization/visualizationlist.html"})}]).controller("VisualizationListCtrl",["$scope","$http","VisualizationService","$interval",function(e,t,n,o){var i=function(){var e=[],t=[];return e.push({name:"11.1.1.2",id:"11.1.1.2",parent:null,ancestors:null}),e.push({name:"11.1.1.3",id:"11.1.1.3",parent:null,ancestors:null}),e.push({name:"11.1.1.4",id:"11.1.1.4",parent:null,ancestors:null}),e.push({name:"11.1.1.5",id:"11.1.1.5",parent:null,ancestors:null}),e.push({name:"11.1.1.6",id:"11.1.1.6",parent:null,ancestors:null}),e.push({name:"11.1.1.7",id:"11.1.1.7",parent:null,ancestors:null}),e.push({name:"11.1.1.8",id:"11.1.1.8",parent:null,ancestors:null}),e.push({name:"10.1.1.1",id:"10.1.1.1",parent:null,ancestors:null}),e.push({name:"10.1.1.2",id:"10.1.1.2",parent:null,ancestors:null}),e.push({name:"10.1.1.3",id:"10.1.1.3",parent:null,ancestors:null}),e.push({name:"10.1.1.4",id:"10.1.1.4",parent:null,ancestors:null}),e.push({name:"10.1.1.5",id:"10.1.1.5",parent:null,ancestors:null}),e.push({name:"10.1.1.6",id:"10.1.1.6",parent:null,ancestors:null}),e.push({name:"10.1.1.7",id:"10.1.1.7",parent:null,ancestors:null}),e.push({name:"10.1.1.8",id:"10.1.1.8",parent:null,ancestors:null}),e.push({name:"10.1.1.9",id:"10.1.1.9",parent:null,ancestors:null}),e.push({name:"10.1.1.10",id:"10.1.1.10",parent:null,ancestors:null}),e.push({name:"10.1.1.11",id:"10.1.1.11",parent:null,ancestors:null}),e.push({name:"10.1.1.12",id:"10.1.1.12",parent:null,ancestors:null}),t.push({source:"11.1.1.2",target:"10.1.1.1",weight:54}),t.push({source:"10.1.1.1",target:"11.1.1.2",weight:95}),t.push({source:"11.1.1.3",target:"10.1.1.1",weight:80}),t.push({source:"10.1.1.1",target:"11.1.1.3",weight:54}),t.push({source:"11.1.1.4",target:"10.1.1.3",weight:48}),t.push({source:"10.1.1.3",target:"11.1.1.4",weight:24}),t.push({source:"11.1.1.5",target:"10.1.1.6",weight:23}),t.push({source:"10.1.1.6",target:"11.1.1.5",weight:54}),t.push({source:"11.1.1.6",target:"10.1.1.7",weight:65}),t.push({source:"10.1.1.7",target:"11.1.1.6",weight:43}),t.push({source:"11.1.1.7",target:"10.1.1.8",weight:90}),t.push({source:"10.1.1.8",target:"11.1.1.7",weight:48}),t.push({source:"11.1.1.8",target:"10.1.1.9",weight:54}),t.push({source:"10.1.1.9",target:"11.1.1.8",weight:54}),t.push({source:"11.1.1.8",target:"10.1.1.10",weight:54}),t.push({source:"10.1.1.10",target:"11.1.1.8",weight:78}),{nodes:e,links:t}},r=function(){var e={"10.1.1.10":{environment:"prod",release:"stable",version:"1.0",tier:"db"},"10.1.1.11":{environment:"prod",release:"stable",version:"1.0",tier:"db"},"10.1.1.12":{environment:"prod",release:"stable",version:"1.0",tier:"db"},"10.1.1.1":{environment:"prod",release:"stable",version:"1.0",tier:"web"},"10.1.1.9":{environment:"prod",release:"stable",version:"1.0",tier:"web"},"10.1.1.8":{environment:"prod",release:"stable",version:"1.0",tier:"web"},"10.1.1.3":{environment:"prod",release:"stable",version:"1.0",tier:"web"},"10.1.1.2":{environment:"prod",release:"stable",version:"1.0",tier:"web"},"10.1.1.5":{environment:"prod",release:"stable",version:"1.0",tier:"web"},"10.1.1.4":{environment:"prod",release:"stable",version:"1.0",tier:"web"},"10.1.1.7":{environment:"prod",release:"stable",version:"1.0",tier:"web"},"10.1.1.6":{release:"stable",tier:"web",version:"1.0",environment:"prod"}},t={"app-db":{tier:"db",release:"stable",environment:"prod"},"app-svc":{tier:"web",release:"stable",environment:"prod"}},n={topLevel:["app-svc","app-db","app0-svc","app0-db","app1-svc","app1-db","app2-svc","app2-db","app3-svc","app3-db","app4-svc","app4-db","app5-svc","app5-db","app6-svc","app6-db","app7-svc","app7-db","app8-svc","app8-db","app9-svc","app9-db","app10-svc","app10-db","app11-svc","app11-db","app01-svc","app02-db","app03-svc","app03-db","app20-svc","app20-db","app30-svc","app30-db","app40-svc","app40-db","app50-svc","app50-db","app60-svc","app60-db","app70-svc","app70-db","app80-svc","app80-db","app90-svc","app90-db","app100-svc","app100-db","app110-svc","app110-db"],"app-svc":["10.1.1.1","10.1.1.2","10.1.1.3","10.1.1.4","10.1.1.5","10.1.1.6","10.1.1.7","10.1.1.8","10.1.1.9"],"app-db":["10.1.1.10","10.1.1.11","10.1.1.12"]};_.forEach(n.topLevel,function(e){null==n[e]&&(n[e]=[])});var o={};return _.forEach(n["app-svc"],function(e){o[e]=["app-svc"]}),_.forEach(n["app-db"],function(e){o[e]=["app-db"]}),{children_struct:n,ancestors_struct:o,labels:e,serviceSelectors:t}};n.getGraphData().then(function(t){var n=i();e.nodes=n.nodes,e.links=n.links},function(t){var n=i();e.nodes=n.nodes,e.links=n.links}),e.graphDataInterval=o(function(){n.getGraphData().then(function(t){var n=i();e.nodes=n.nodes,e.links=n.links},function(t){var n=i();e.nodes=n.nodes,e.links=n.links})},3e3),e.$on("$destroy",function(){o.cancel(e.graphDataInterval)}),n.getStructureData().then(function(t){var n=r();e.ancestors_struct=n.ancestors_struct,e.children_struct=n.children_struct,e.labels=n.labels,e.serviceSelectors=n.serviceSelectors},function(t){var n=r();e.ancestors_struct=n.ancestors_struct,e.children_struct=n.children_struct,e.labels=n.labels,e.serviceSelectors=n.serviceSelectors})}]),angular.module("contiv.visualization").factory("VisualizationService",["$http","$q",function(e,t){function n(n,o){var i=t.defer();return e.get(n,o).then(function(e){i.resolve(e.data)},function(e){i.reject(e.data)}),i.promise}function o(n,o){var i=function(e){var t,n,o,r,a,l,s,c="";for(t in e)if(n=e[t],n instanceof Array)for(s=0;s<n.length;++s)a=n[s],o=t+"["+s+"]",l={},l[o]=a,c+=i(l)+"&";else if(n instanceof Object)for(r in n)a=n[r],o=t+"["+r+"]",l={},l[o]=a,c+=i(l)+"&";else void 0!==n&&null!==n&&(c+=encodeURIComponent(t)+"="+encodeURIComponent(n)+"&");return c.length?c.substr(0,c.length-1):c},r=t.defer();return e({url:n,method:"POST",data:o,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(e){return angular.isObject(e)&&"[object File]"!==String(e)?i(e):e}]}).then(function(e){r.resolve(e.data)},function(e){r.reject(e.data)}),r.promise}function i(){var e=ContivGlobals.VISUALIZATION_ENDPOINT;e+="influx/query";var t={params:{db:"telegraf",q:"SELECT BytesIn, BytesOut, EndpointIP, ProviderIP FROM httpjson_svcstats WHERE time > now() - 1m GROUP BY * LIMIT 1"}};return n(e,t)}function r(){var e=ContivGlobals.VISUALIZATION_ENDPOINT;return e+="services",n(e)}function a(e,t){var n="(";n+=t+"=",n+="'"+e[0]+"' ";for(var o=1;o<e.length;o++)n+="OR ",n+=t+"=",n+="'"+e[o]+"' ";return n+=")"}function l(e,t,n){var i=ContivGlobals.VISUALIZATION_ENDPOINT;i+="influx/query";var r={db:"telegraf",q:"SELECT sum(BytesOut) from httpjson_svcstats WHERE time > now() - 15s AND "+a(e,"EndpointIP")+" AND "+a(t,"ProviderIP")+"GROUP BY time(20s) LIMIT 1; SELECT sum(BytesIn) from httpjson_svcstats WHERE time > now() - 15s AND "+a(e,"ProviderIP")+" AND "+a(t,"EndpointIP")+"GROUP BY time(20s) fill(0) LIMIT 1"};return o(i,r)}function s(e,t){var n=ContivGlobals.VISUALIZATION_ENDPOINT;n+="influx/query";var i={db:"telegraf",q:"SELECT sum(BytesOut) FROM httpjson_svcstats WHERE time > now() - 1m AND "+a(e,"EndpointIP")+" AND "+a(t,"ProviderIP")+" GROUP BY time(10s) fill(0) LIMIT 6; SELECT sum(BytesIn) FROM httpjson_svcstats WHERE time > now() - 1m AND "+a(e,"ProviderIP")+" AND "+a(t,"EndpointIP")+" GROUP BY time(10s) fill(0) LIMIT 6"};return o(n,i)}return{getGraphData:i,getStructureData:r,getEdgeData:l,getOldEdgeData:s}}]),angular.module("contiv.volumes").config(["$stateProvider",function(e){e.state("contiv.menu.volumes.create",{url:"/create",templateUrl:"volumes/volumecreate.html",controller:"VolumeCreateCtrl as volumeCreateCtrl"})}]).controller("VolumeCreateCtrl",["$state","$stateParams","VolumesModel","StoragePoliciesModel","CRUDHelperService",function(e,t,n,o,i){function r(){e.go("contiv.menu.volumes.list")}function a(){r()}function l(){o.get().then(function(e){d.policies=e})}function s(){d.newVolume.policy=d.selectedPolicy.name,d.newVolume.backends=d.selectedPolicy.backends,d.newVolume.driver=d.selectedPolicy.driver,d.newVolume.create=d.selectedPolicy.create,d.newVolume.runtime=d.selectedPolicy.runtime}function c(){d.form.$valid&&(i.hideServerError(d),i.startLoader(d),s(),n.create(d.newVolume).then(function(e){i.stopLoader(d),r()},function(e){i.stopLoader(d),i.showServerError(d,e)}))}function u(){i.stopLoader(d),i.hideServerError(d),d.newVolume={name:"",backends:{},driver:{},create:{},runtime:{}}}var d=this;d.filesystems=["ext4","btrfs"],d.createVolume=c,d.cancelCreating=a,l(),u()}]),angular.module("contiv.volumes").config(["$stateProvider",function(e){e.state("contiv.menu.volumes.details",{url:"/details/:key",controller:"VolumeDetailsCtrl as volumeDetailsCtrl",templateUrl:"volumes/volumedetails.html"})}]).controller("VolumeDetailsCtrl",["$state","$stateParams","$scope","$interval","$http","VolumesModel","VolumeService","CRUDHelperService",function(e,t,n,o,i,r,a,l){function s(){e.go("contiv.menu.volumes.list")}function c(){l.hideServerError(f),l.startLoader(f),r["delete"](f.volume).then(function(e){l.stopLoader(f),s()})}function u(e){var n=t.key.split("/"),o={};o.policy=n[0],o.name=n[1],r.getModel(o,e).then(function(e){f.volume=e,d(),p()})}function d(){a.getVolumeUseInfo(f.volume).then(function(e){f.volumeUse=e},function(e){})}function p(){a.getVolumeSnapshots(f.volume).then(function(e){f.snapshots=e},function(e){})}function v(){f.snapshotSuccess=!1,l.hideServerError(f),l.startLoader(f),a.triggerSnapshot(f.volume).then(function(e){l.stopLoader(f),f.snapshotSuccess=!0},function(e){l.stopLoader(f),l.showServerError(f,e)})}var f=this;f.deleteVolume=c,f.triggerVolumeSnapshot=v,u(!1);var h;angular.isDefined(h)||(h=o(function(){u(!0)},ContivGlobals.REFRESH_INTERVAL)),n.$on("$destroy",function(){o.cancel(h)})}]),angular.module("contiv.volumes").config(["$stateProvider",function(e){e.state("contiv.menu.volumes.list",{url:"/list",controller:"VolumeListCtrl as volumeListCtrl",templateUrl:"volumes/volumelist.html"})}]).controller("VolumeListCtrl",["$scope","$interval","$filter","VolumesModel","CRUDHelperService",function(e,t,n,o,i){function r(e){o.get(e).then(function(e){i.stopLoader(a),a.volumes=e},function(e){i.stopLoader(a)})}var a=this;r(!1);var l;angular.isDefined(l)||(l=t(function(){r(!0)},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(l)})}]),angular.module("contiv.volumes").factory("VolumeService",["$http","$q",function(e,t){function n(n){var o=t.defer(),i=ContivGlobals.VOLUMES_USES_ENDPOINT+n.policy+"/"+n.name;return e.get(i).then(function(e){o.resolve(e.data)},function(e){o.reject(e.data)}),o.promise}function o(n){var o=t.defer(),i=ContivGlobals.VOLUMES_SNAPSHOTS_ENDPOINT+n.policy+"/"+n.name;return e.get(i).then(function(e){o.resolve(e.data)},function(e){o.reject(e.data)}),o.promise}function i(n){var o=t.defer(),i=ContivGlobals.VOLUMES_SNAPSHOTS_ENDPOINT+"take/"+n.policy+"/"+n.name;return e.post(i).then(function(e){o.resolve(e.data)},function(e){o.reject(e.data)}),o.promise}return{getVolumeUseInfo:n,getVolumeSnapshots:o,triggerSnapshot:i}}]),angular.module("contiv.volumes").config(["$stateProvider",function(e){e.state("contiv.menu.volumes.copy",{url:"/copy/",params:{snapshot:null,policy:null,volume:null},controller:"VolumeSnapshotCopyCtrl as volumeSnapshotCopyCtrl",templateUrl:"volumes/volumesnapshotcopy.html"})}]).controller("VolumeSnapshotCopyCtrl",["$state","$stateParams","$scope","$interval","$http","VolumesModel","CRUDHelperService",function(e,t,n,o,i,r,a){function l(){e.go("contiv.menu.volumes.details",{key:t.policy+"/"+t.volume})}function s(){e.go("contiv.menu.volumes.details",{key:t.policy+"/"+u.newvolume})}function c(){if(u.form.$valid){a.hideServerError(u),a.startLoader(u);var e={};e.policy=t.policy,e.name=t.volume,r.copy(e,t.snapshot,u.newvolume).then(function(e){a.stopLoader(u),s()},function(e){a.stopLoader(u),a.showServerError(u,e)})}}var u=this;u.policy=t.policy,u.volume=t.volume,u.snapshot=t.snapshot,u.copySnapshot=c,u.cancelCopy=l}]),angular.module("contiv.directives").directive("ctvAccordion",function(){return{restrict:"E",transclude:!0,scope:{items:"="},link:function(e,t){"function"==typeof t.find(".ui.accordion").accordion&&t.find(".ui.accordion").accordion()},templateUrl:"components/directives/accordion.html"}}),angular.module("contiv.directives").directive("ctvCollapsible",function(){return{restrict:"E",scope:{title:"@",collapsed:"@"},transclude:!0,link:function(e){void 0===e.collapsed&&(e.collapsed=!0)},templateUrl:"components/directives/collapsible.html"}}),angular.module("contiv.directives").directive("ctvError",function(){return{restrict:"E",scope:{header:"@",error:"="},link:function(e,t,n){t.find("i").on("click",function(){t.addClass("ng-hide")})},templateUrl:"components/directives/errormessage.html"}}),angular.module("contiv.directives").directive("ctvNamevalue",function(){return{restrict:"E",scope:{items:"=",nameheader:"@",valueheader:"@",type:"@",options:"="},link:function(e){function t(e,t){return e.name==t.name}function n(){e.newItem={name:"",value:""}}function o(e){return""===e.name&&""===e.value}e.add=function(){o(e.newItem)||(void 0===e.item&&(e.item=[]),_.pullAllWith(e.items,[e.newItem],t),e.items.push(e.newItem),n())},e.remove=function(t){_.remove(e.items,function(e){return e.name==t.name})},n(),void 0===e.nameheader&&(e.nameheader="Name"),void 0===e.valueheader&&(e.valueheader="Value"),void 0===e.type&&(e.type="text")},templateUrl:"components/directives/namevalue.html"}}),angular.module("contiv.directives").directive("ctvTable",["filterFilter","limitToFilter",function(e,t){return{restrict:"E",transclude:!0,scope:{items:"=",filtereditems:"=",size:"@",defaultsortcolumn:"@"},controller:["$scope","$element","$attrs","$filter",function(n,o,i,r){function a(o,i){if(p.searchText=i,(void 0===o||0>o)&&(o=0),p.pageNo=o,void 0!==n.items){var a=e(n.items,p.searchText);a=r("orderBy")(a,p.sortObj.field,p.sortObj.reverse);var l=Math.ceil(a.length/p.size);0==l&&(l=1),p.chunks=[];for(var s=0;l>s;s++)p.chunks.push({selected:!1,pageNo:s});if(o>=p.chunks.length&&(p.pageNo=0),p.chunks[p.pageNo].selected=!0,p.chunks.length>5){var c,u;c=p.pageNo-2,u=p.pageNo+3,0>c&&(u-=c,c=0),u>p.chunks.length&&(c-=u-p.chunks.length,u=p.chunks.length),n.paginationMenu.chunks=p.chunks.slice(c,u)}else n.paginationMenu.chunks=p.chunks;p.filteredItems=t(a,p.size,p.pageNo*p.size),n.filtereditems=p.filteredItems}return!1}function l(){var e;return e=p.pageNo<=0?0:p.pageNo-1,a(e)}function s(){var e;return e=p.pageNo+1,e>p.chunks.length-1&&(e=p.chunks.length-1),a(e)}function c(e){n.paginationMenu=e}function u(e){return{field:e,reverse:!1,iconDirection:{"angle down icon":!0,"angle up icon":!1}}}function d(e){e==p.sortObj.field?(p.sortObj.field=e,p.sortObj.reverse=!p.sortObj.reverse,p.sortObj.iconDirection={"angle down icon":!p.sortObj.reverse,"angle up icon":p.sortObj.reverse}):p.sortObj=u(e),p.showChunk(p.pageNo,p.searchText),n.$apply()}var p=this;p.chunks=[],p.pageNo=0,p.sortObj=u(n.defaultsortcolumn),p.size=parseInt(n.size,10),isNaN(p.size)&&(p.size=12),p.showChunk=a,p.showNextChunk=s,p.showPrevChunk=l,p.addPaginationMenu=c,p.sort=d}],link:function(e,t,n,o){e.$parent.$watch(n.items,function(){o.showChunk(o.pageNo,o.searchText)})},templateUrl:"components/directives/table.html"}}]).directive("ctvThead",function(){return{restrict:"E",transclude:!0,replace:!0,template:"<thead ng-transclude></thead>"}}).directive("ctvTh",function(){return{restrict:"E",transclude:!0,replace:!0,require:"^^ctvTable",scope:{"class":"@",sortfield:"="},link:function(e,t,n,o){e.tablectrl=o,void 0!=e.sortfield&&null!=e.sortfield&&t.bind("click",function(){o.sort(e.sortfield)})},templateUrl:"components/directives/tableheader.html"}}).directive("ctvTbody",function(){return{restrict:"E",scope:{},transclude:!0,replace:!0,template:"<tbody ng-transclude></tbody>"}}).directive("ctvTfoot",function(){return{restrict:"E",scope:{},transclude:!0,replace:!0,template:"<tfoot ng-transclude></tfoot>"}}).directive("ctvTsearch",function(){return{restrict:"E",require:"^^ctvTable",scope:{placeholder:"@",size:"@"},link:function(e,t,n,o){e.showChunk=function(){o.showChunk(o.pageNo,e.searchText)}},templateUrl:"components/directives/searchinput.html"}}).directive("ctvTr",function(){return{restrict:"E",transclude:"true",replace:!0,scope:{},template:"<tr ng-transclude></tr>"}}).directive("ctvTd",function(){return{restrict:"E",transclude:!0,replace:!0,scope:!0,template:"<td ng-transclude></td>"}}).directive("ctvTpagination",function(){return{restrict:"E",require:"^^ctvTable",scope:{colspan:"@"},replace:!0,link:function(e,t,n,o){o.addPaginationMenu(e),o.showChunk(o.pageNo,o.searchText),e.showChunk=function(e){o.showChunk(e,o.searchText)},e.showPrevChunk=o.showPrevChunk,e.showNextChunk=o.showNextChunk;
},templateUrl:"components/directives/paginationmenu.html"}}),angular.module("contiv.models").factory("ApplicationGroupsModel",["$http","$q",function(e,t){var n=new Collection(e,t,ContivGlobals.APPLICATIONGROUPS_ENDPOINT);return n.generateKey=function(e){return e.tenantName+":"+e.groupName},n}]),BaseCollection.prototype.extract=function(e){return e.data},BaseCollection.prototype.get=function(e){var t=this;return void 0===e&&(e=!1),!e&&t.models.length>0?t.$q.when(t.models):t.$http.get(t.url).then(function(e){return t.models=t.extract(e),t.models})},BaseCollection.prototype.getModelByKey=function(e,t,n){function o(){return _.find(i.models,function(t){return t[n]==e})}var i=this;void 0===t&&(t=!1),void 0===n&&(n="key");var r=i.$q.defer();return!t&&i.models.length>0?r.resolve(o()):i.get(t).then(function(){r.resolve(o())}),r.promise},BaseCollection.prototype.getModel=function(e,t){function n(){return _.find(o.models,e)}var o=this;void 0===t&&(t=!1);var i=o.$q.defer();return!t&&o.models.length>0?i.resolve(n()):o.get(t).then(function(){i.resolve(n())}),i.promise},Collection.prototype=Object.create(BaseCollection.prototype),Collection.prototype.create=function(e,t){var n=this,o=n.$q.defer();return void 0===t&&(t=n.url+e.key+"/"),n.$http.post(t,e).then(function(t){var i=n.extract(t);void 0!==i&&""!==i||(i=e),n.models.push(i),o.resolve(n.extract(t))},function(e){o.reject(n.extract(e))}),o.promise},Collection.prototype.save=function(e){var t=this,n=t.$q.defer(),o=t.url+e.key+"/";return t.$http.put(o,e).then(function(o){_.remove(t.models,function(t){return t.key==e.key}),t.models.push(t.extract(o)),n.resolve(t.extract(o))},function(e){n.reject(t.extract(e))}),n.promise},Collection.prototype["delete"]=function(e){var t=this,n=t.$q.defer(),o=t.url+e.key+"/";return t.$http["delete"](o).then(function(o){_.remove(t.models,function(t){return t.key==e.key}),n.resolve(t.extract(o))},function(e){n.reject(t.extract(e))}),n.promise},Collection.prototype.deleteUsingKey=function(e,t,n){var o=this;void 0===t&&(t="key");var i=o.$q.defer();return void 0===n&&(n=o.url+e+"/"),o.$http["delete"](n).then(function(n){_.remove(o.models,function(n){return n[t]==e}),i.resolve(o.extract(n))},function(e){i.reject(o.extract(e))}),i.promise},Collection.prototype.getInspectByKey=function(e,t,n){var o=this,i=o.$q.defer();return e in o.inspectStats&&0==n?i.resolve(o.inspectStats[e]):o.$http.get(t+e+"/").then(function(t){var n=o.extract(t);o.inspectStats[e]=n,i.resolve(n)},function(e){i.reject(e)}),i.promise},angular.module("contiv.models").factory("NetprofilesModel",["$http","$q",function(e,t){var n=new Collection(e,t,ContivGlobals.NETPROFILES_ENDPOINT);return n.generateKey=function(e){return e.tenantName+":"+e.profileName},n}]),angular.module("contiv.models").factory("NetworksModel",["$http","$q",function(e,t){return new Collection(e,t,ContivGlobals.NETWORKS_ENDPOINT)}]),angular.module("contiv.models").factory("NodesModel",["$http","$q",function(e,t){function n(e,t){BaseCollection.call(this,e,t,ContivGlobals.NODES_LIST_ENDPOINT)}n.prototype=Object.create(BaseCollection.prototype),n.prototype.extract=function(e){return _.map(e.data,function(e,t){return e.key=t,e})},n.prototype.commission=function(e){var t=this,n=t.$q.defer(),o=ContivGlobals.NODES_COMMISSION_ENDPOINT;return t.$http.post(o,e,{headers:{"Content-Type":"application/json"}}).then(function(e){n.resolve()},function(e){n.reject(e)}),n.promise},n.prototype.decommission=function(e){var t=this,n=t.$q.defer(),o=ContivGlobals.NODES_DECOMMISSION_ENDPOINT;return t.$http.post(o,e,{headers:{"Content-Type":"application/json"}}).then(function(e){n.resolve()},function(e){n.reject(e)}),n.promise},n.prototype.upgrade=function(e){var t=this,n=t.$q.defer(),o=ContivGlobals.NODES_MAINTENANCE_ENDPOINT;return t.$http.post(o,e,{headers:{"Content-Type":"application/json"}}).then(function(e){n.resolve()},function(e){n.reject(e)}),n.promise},n.prototype.discover=function(e){var t=this,n=t.$q.defer(),o=ContivGlobals.NODES_DISCOVER_ENDPOINT;return t.$http.post(o,e,{headers:{"Content-Type":"application/json"}}).then(function(e){n.resolve()},function(e){n.reject(e)}),n.promise};var o=new n(e,t);return o}]),angular.module("contiv.models").factory("OrganizationsModel",["$http","$q",function(e,t){return new Collection(e,t,ContivGlobals.ORGANIZATIONS_ENDPOINT)}]),angular.module("contiv.models").factory("PoliciesModel",["$http","$q",function(e,t){var n=new Collection(e,t,ContivGlobals.POLICIES_ENDPOINT);return n.generateKey=function(e){return e.tenantName+":"+e.policyName},n}]),angular.module("contiv.models").factory("RulesModel",["$http","$q",function(e,t){var n=new Collection(e,t,ContivGlobals.RULES_ENDPOINT);return n.getIncomingRules=function(e,t){return n.get().then(function(n){return _.filter(n,{policyName:e,direction:"in",tenantName:t})})},n.getOutgoingRules=function(e,t){return n.get().then(function(n){return _.filter(n,{policyName:e,direction:"out",tenantName:t})})},n.generateKey=function(e){return e.tenantName+":"+e.policyName+":"+e.ruleId},n}]),angular.module("contiv.models").factory("ServicelbsModel",["$http","$q",function(e,t){return new Collection(e,t,ContivGlobals.SERVICELBS_ENDPOINT)}]),angular.module("contiv.models").factory("StoragePoliciesModel",["$http","$q",function(e,t){function n(e,t){Collection.call(this,e,t,ContivGlobals.STORAGEPOLICIES_ENDPOINT)}n.prototype=Object.create(Collection.prototype),n.prototype.create=function(e){var t=this,n=t.url+e.name;return Collection.prototype.create.call(t,e,n)},n.prototype.save=function(e){var t=this,n=t.$q.defer(),o=t.url+e.name;return t.$http.post(o,e).then(function(o){_.remove(t.models,function(t){return t.name==e.name}),t.models.push(e),n.resolve(t.extract(o))},function(e){n.reject(t.extract(e))}),n.promise};var o=new n(e,t);return o}]),angular.module("contiv.models").factory("VolumesModel",["$http","$q",function(e,t){function n(e,t){Collection.call(this,e,t,ContivGlobals.VOLUMES_ENDPOINT)}n.prototype=Object.create(Collection.prototype),n.prototype["delete"]=function(e){var t=this,n=t.$q.defer(),o=ContivGlobals.VOLUMES_DELETE_ENDPOINT;e.volume=e.name;var i={data:e};return t.$http["delete"](o,i).then(function(o){_.remove(t.models,function(t){return t.name==e.name&&t.policy==e.policy}),n.resolve(t.extract(o))},function(e){n.reject(t.extract(e))}),n.promise},n.prototype.create=function(e){var t=this,n=ContivGlobals.VOLUMES_CREATE_ENDPOINT;return Collection.prototype.create.call(t,e,n)},n.prototype.copy=function(e,t,n){var o=this,i=o.$q.defer(),r=ContivGlobals.VOLUMES_COPYSNAPSHOTS_ENDPOINT,a={name:e.name,policy:e.policy,Options:{target:n,snapshot:t}};return o.$http.post(r,a).then(function(e){o.models.push(o.extract(e)),i.resolve(o.extract(e))},function(e){i.reject(o.extract(e))}),i.promise};var o=new n(e,t);return o}]),angular.module("contiv.utils").factory("CRUDHelperService",function(){function e(e){e.showLoader=!0}function t(e){e.showLoader=!1}function n(e,t){e.showServerError=!0,e.serverErrorMessage=t}function o(e){e.showServerError=!1}return{startLoader:e,stopLoader:t,showServerError:n,hideServerError:o}}),angular.module("contiv.utils").factory("InspectService",function(){function e(e){var t={};for(var n in e){var o=[];for(var i in e[n]){var r={};switch(r.name=i,r.format="none",r.type="string",i){case"ipAddress":r.value=e[n][i].filter(function(e){return e.length>0}).join();break;case"labels":r.value=e[n][i].replace(/(map\[|\])/gi,"").replace(/(:)/gi,"=").split(" ").filter(function(e){return e.length>0}),r.format="label",r.type="array";break;default:r.value=e[n][i]}o.push(r)}t[e[n].containerID]=o}return t}function t(e,t){if(void 0==e)return!0;if(Object.keys(e).length!=Object.keys(t).length)return!0;for(var n in t)if(!(n in e))return!0;return!1}return{buildEndPoints:e,checkContainerChanged:t}}),angular.module("contiv.utils").factory("NetworkService",["$http","$q",function(e,t){function n(){var n=t.defer(),o=ContivGlobals.NETWORK_SETTINGS_ENDPOINT;return e.get(o).then(function(e){n.resolve(e.data[0])},function(e){n.reject(e.data)}),n.promise}function o(t){return e.post(ContivGlobals.NETWORK_SETTINGS_ENDPOINT+"global/",t)}return{getSettings:n,updateSettings:o}}]),angular.module("contiv.utils").factory("NodesService",["$http","$q",function(e,t){function n(n){var r=t.defer(),a=ContivGlobals.NODES_SETTINGS_GET_ENDPOINT;return e.get(a).then(function(e){r.resolve(e.data),n.setting=e.data;var t=n.setting.extra_vars,a=t[s.SCHED_PROVIDER],l=t[s.CONTIV_NET_MODE];t[s.CONTROL_INTERFACE]&&(n.extra_vars[s.CONTROL_INTERFACE]=t[s.CONTROL_INTERFACE]),t[s.DATA_INTERFACE]&&(n.extra_vars[s.DATA_INTERFACE]=t[s.DATA_INTERFACE]),t[s.VIP_ADDR]&&(n.extra_vars[s.VIP_ADDR]=t[s.VIP_ADDR]),a&&(n.extra_vars[s.SCHED_PROVIDER]=a,"ucp-swarm"===a&&(n.extra_vars[s.UCP_BOOTSTRAP_NODE]=t[s.UCP_BOOTSTRAP_NODE])),l&&(n.extra_vars[s.CONTIV_NET_MODE]=l,"standalone"===l?n.extra_vars[s.FWD_MODE]=t[s.FWD_MODE]:"aci"===l&&(n.extra_vars[s.APIC_CONTR_UNRESTRICT_MODE]=t[s.APIC_CONTR_UNRESTRICT_MODE],n.extra_vars[s.APIC_EPG_BRIDGE_DOMAIN]=t[s.APIC_EPG_BRIDGE_DOMAIN],n.extra_vars[s.APIC_LEAF_NODES]=t[s.APIC_LEAF_NODES],n.extra_vars[s.APIC_PASSWORD]=t[s.APIC_PASSWORD],n.extra_vars[s.APIC_PHYS_DOMAIN]=t[s.APIC_PHYS_DOMAIN],n.extra_vars[s.APIC_URL]=t[s.APIC_URL],n.extra_vars[s.APIC_USERNAME]=t[s.APIC_USERNAME])),t[s.CLUSTER_NAME]&&(n.extra_vars[s.CLUSTER_NAME]=t[s.CLUSTER_NAME]),o(t[s.ENV],n.envVariables),i(t,n.ansibleVariables)},function(e){r.reject(e.data)}),r.promise}function o(e,t){var n;for(n in e)t.push({name:n,value:e[n]})}function i(e,t){var n,o=[s.APIC_CONTR_UNRESTRICT_MODE,s.APIC_EPG_BRIDGE_DOMAIN,s.APIC_LEAF_NODES,s.APIC_PASSWORD,s.APIC_PHYS_DOMAIN,s.APIC_URL,s.APIC_USERNAME,s.CONTIV_NET_MODE,s.CONTROL_INTERFACE,s.ENV,s.FWD_MODE,s.DATA_INTERFACE,s.SCHED_PROVIDER,s.VIP_ADDR,s.UCP_BOOTSTRAP_NODE,s.CLUSTER_NAME];for(n in e)-1===o.indexOf(n)&&t.push({name:n,value:e[n]})}function r(t){return e.post(ContivGlobals.NODES_SETTINGS_SET_ENDPOINT,t,{headers:{"Content-Type":"application/json"}})}function a(e){e.ansibleVariables.forEach(function(t){e.extra_vars[t.name]=t.value});var t={};e.envVariables.forEach(function(e){t[e.name]=e.value}),e.extra_vars[s.ENV]=t,e.nodeOpsObj.extra_vars=JSON.stringify(e.extra_vars)}function l(e){"aci"==e.extra_vars[s.CONTIV_NET_MODE]?delete e.extra_vars[s.FWD_MODE]:(delete e.extra_vars[s.APIC_URL],delete e.extra_vars[s.APIC_USERNAME],delete e.extra_vars[s.APIC_PASSWORD],delete e.extra_vars[s.APIC_LEAF_NODES],delete e.extra_vars[s.APIC_PHYS_DOMAIN],delete e.extra_vars[s.APIC_EPG_BRIDGE_DOMAIN],delete e.extra_vars[s.APIC_CONTR_UNRESTRICT_MODE]),"native-swarm"==e.extra_vars[s.SCHED_PROVIDER]&&delete e.extra_vars[s.UCP_BOOTSTRAP_NODE]}var s={APIC_CONTR_UNRESTRICT_MODE:"apic_contracts_unrestricted_mode",APIC_EPG_BRIDGE_DOMAIN:"apic_epg_bridge_domain",APIC_LEAF_NODES:"apic_leaf_nodes",APIC_PASSWORD:"apic_password",APIC_PHYS_DOMAIN:"apic_phys_domain",APIC_URL:"apic_url",APIC_USERNAME:"apic_username",CONTIV_NET_MODE:"contiv_network_mode",CONTROL_INTERFACE:"control_interface",ENV:"env",FWD_MODE:"fwd_mode",DATA_INTERFACE:"netplugin_if",SCHED_PROVIDER:"scheduler_provider",VIP_ADDR:"service_vip",UCP_BOOTSTRAP_NODE:"ucp_bootstrap_node_name",CLUSTER_NAME:"cluster_name"};return{getSettings:n,createEnvVariables:o,createAnsibleVariables:i,updateSettings:r,createExtraVars:a,cleanupExtraVars:l}}]),angular.module("contiv.utils").factory("VolumeSettingService",["$http","$q",function(e,t){function n(){var n=t.defer(),o=ContivGlobals.VOLUMES_GLOBAL_ENDPOINT;return e.get(o).then(function(e){n.resolve(e.data)},function(e){n.reject(e.data)}),n.promise}function o(t){return e.post(ContivGlobals.VOLUMES_GLOBAL_ENDPOINT,t)}return{getSettings:n,updateSettings:o}}]),angular.module("contiv.directives").directive("ctvAcivalid",function(){return{restrict:"E",templateUrl:"components/directives/nodes/acivalid.html",scope:{form:"="}}}),angular.module("contiv.directives").directive("ctvControlinterface",function(){return{restrict:"E",templateUrl:"components/directives/nodes/controlinterface.html",scope:{extravars:"="}}}),angular.module("contiv.directives").directive("ctvNetworkmode",function(){return{restrict:"E",templateUrl:"components/directives/nodes/networkmode.html",scope:{extravars:"="}}}),angular.module("contiv.directives").directive("ctvScheduler",function(){return{restrict:"E",templateUrl:"components/directives/nodes/scheduler.html",scope:{extravars:"="}}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9idW5kbGUuanMiLCJjb21wb25lbnRzL21vZGVscy9jb2xsZWN0aW9uLmpzIiwibW9kdWxlLmpzIiwiZGlyZWN0aXZlcy9tb2R1bGUuanMiLCJkYXRhc291cmNlL2RhdGFzb3VyY2UuanMiLCJtb2RlbHMvbW9kdWxlLmpzIiwiZGF0YXNvdXJjZS92aXN1YWxpemVyZGF0YXNvdXJjZS5qcyIsInV0aWxzL21vZHVsZS5qcyIsImdyYXBoL2dyYXBoLmpzIiwiZ3JhcGgvdmlzdWFsaXplcmdyYXBoLmpzIiwibGluay9saW5rLmpzIiwibGluay92aXN1YWxpemVybGluay5qcyIsIm5vZGUvbm9kZS5qcyIsIm5vZGUvdmlzdWFsaXplcm5vZGUuanMiLCJwb2xpY3kvbm9kZXNlbGVjdGlvbnBvbGljeS5qcyIsInBvbGljeS9wYXRoY2hhbmdldmlld3BvbGljeS5qcyIsInBvbGljeS9wb2xpY3kuanMiLCJhcHBsaWNhdGlvbmdyb3Vwcy9tb2R1bGUuanMiLCJwb2xpY3kvcG9saWN5c2VydmljZS5qcyIsImRhc2hib2FyZC9tb2R1bGUuanMiLCJwb2xpY3kvcXRpcHBvbGljeS5qcyIsImxvZ2luL21vZHVsZS5qcyIsInBvbGljeS9zYXZlc3RhdGVwb2xpY3kuanMiLCJtZW51L21vZHVsZS5qcyIsInBvbGljeS9zcGxpdGpvaW5ub2RlcG9saWN5LmpzIiwibmV0d29ya19wb2xpY2llcy9tb2R1bGUuanMiLCJwb2xpY3kvc3BsaXRqb2ludmlld3BvbGljeS5qcyIsIm5ldHdvcmtzL21vZHVsZS5qcyIsIm5vZGVzL21vZHVsZS5qcyIsIm9yZ2FuaXphdGlvbnMvbW9kdWxlLmpzIiwic2VydmljZV9sYnMvbW9kdWxlLmpzIiwic2V0dGluZ3MvbW9kdWxlLmpzIiwic3RvcmFnZV9wb2xpY2llcy9tb2R1bGUuanMiLCJ2aXN1YWxpemF0aW9uL21vZHVsZS5qcyIsInZvbHVtZXMvbW9kdWxlLmpzIiwiYXBwLmpzIiwiYXBwbGljYXRpb25ncm91cHMvYXBwbGljYXRpb25ncm91cGNyZWF0ZWN0cmwuanMiLCJhcHBsaWNhdGlvbmdyb3Vwcy9hcHBsaWNhdGlvbmdyb3VwZGV0YWlsc2N0cmwuanMiLCJhcHBsaWNhdGlvbmdyb3Vwcy9hcHBsaWNhdGlvbmdyb3VwbGlzdGN0cmwuanMiLCJhcHBsaWNhdGlvbmdyb3Vwcy9iYW5kd2lkdGhwb2xpY3lkaXJlY3RpdmUuanMiLCJhcHBsaWNhdGlvbmdyb3Vwcy9pc29sYXRpb25wb2xpY3lkaXJlY3RpdmUuanMiLCJkYXNoYm9hcmQvZGFzaGJvYXJkY3RybC5qcyIsImxvZ2luL2xvZ2luY3RybC5qcyIsIm1lbnUvbWVudUN0cmwuanMiLCJuZXR3b3JrX3BvbGljaWVzL2JhbmR3aWR0aGRpcmVjdGl2ZS5qcyIsIm5ldHdvcmtfcG9saWNpZXMvYmFuZHdpZHRocG9saWN5Y3JlYXRlY3RybC5qcyIsIm5ldHdvcmtfcG9saWNpZXMvYmFuZHdpZHRocG9saWN5ZGV0YWlsc2N0cmwuanMiLCJuZXR3b3JrX3BvbGljaWVzL2JhbmR3aWR0aHBvbGljeWxpc3RjdHJsLmpzIiwibmV0d29ya19wb2xpY2llcy9pc29sYXRpb25wb2xpY3ljcmVhdGVjdHJsLmpzIiwibmV0d29ya19wb2xpY2llcy9pc29sYXRpb25wb2xpY3lkZXRhaWxzY3RybC5qcyIsIm5ldHdvcmtfcG9saWNpZXMvaXNvbGF0aW9ucG9saWN5bGlzdGN0cmwuanMiLCJuZXR3b3JrX3BvbGljaWVzL25ldHdvcmtwb2xpY2llc3RhYnNjdHJsLmpzIiwibmV0d29ya3MvbmV0d29ya2NyZWF0ZWN0cmwuanMiLCJuZXR3b3Jrcy9uZXR3b3JrZGV0YWlsc2N0cmwuanMiLCJuZXR3b3Jrcy9uZXR3b3JrbGlzdGN0cmwuanMiLCJuZXR3b3Jrcy9uZXR3b3Jrc3RhdHNjdHJsLmpzIiwibm9kZXMvYmdwc2VydmljZS5qcyIsIm5vZGVzL2xvZ3NkaXJlY3RpdmUuanMiLCJub2Rlcy9sb2dzZXJ2aWNlLmpzIiwibm9kZXMvbm9kZWFjdGl2ZWpvYmxvZ3NjdHJsLmpzIiwibm9kZXMvbm9kZWNvbW1pc3Npb25jdHJsLmpzIiwibm9kZXMvbm9kZWRldGFpbHNjdHJsLmpzIiwibm9kZXMvbm9kZWRpcmVjdGl2ZS5qcyIsIm5vZGVzL25vZGVkaXNjb3ZlcmN0cmwuanMiLCJub2Rlcy9ub2RlbGFzdGpvYmxvZ3NjdHJsLmpzIiwibm9kZXMvbm9kZWxpc3RjdHJsLmpzIiwib3JnYW5pemF0aW9ucy9vcmdhbml6YXRpb25jcmVhdGVjdHJsLmpzIiwib3JnYW5pemF0aW9ucy9vcmdhbml6YXRpb25kZXRhaWxzY3RybC5qcyIsIm9yZ2FuaXphdGlvbnMvb3JnYW5pemF0aW9ubGlzdGN0cmwuanMiLCJzZXJ2aWNlX2xicy9zZXJ2aWNlbGJjcmVhdGVjdHJsLmpzIiwic2VydmljZV9sYnMvc2VydmljZWxiZGV0YWlsc2N0cmwuanMiLCJzZXJ2aWNlX2xicy9zZXJ2aWNlbGJsaXN0Y3RybC5qcyIsInNlcnZpY2VfbGJzL3NlcnZpY2VsYnBvcnRzZGlyZWN0aXZlLmpzIiwic2VydmljZV9sYnMvc2VydmljZWxic3RhdHNjdHJsLmpzIiwic2V0dGluZ3MvY2x1c3RlcnNldHRpbmdjdHJsLmpzIiwic2V0dGluZ3MvbmV0d29ya3NldHRpbmdjdHJsLmpzIiwic2V0dGluZ3Mvdm9sdW1lc2V0dGluZ2N0cmwuanMiLCJzdG9yYWdlX3BvbGljaWVzL3N0b3JhZ2Vwb2xpY3ljcmVhdGVjdHJsLmpzIiwic3RvcmFnZV9wb2xpY2llcy9zdG9yYWdlcG9saWN5ZGV0YWlsc2N0cmwuanMiLCJzdG9yYWdlX3BvbGljaWVzL3N0b3JhZ2Vwb2xpY3lkaXJlY3RpdmUuanMiLCJzdG9yYWdlX3BvbGljaWVzL3N0b3JhZ2Vwb2xpY3lsaXN0Y3RybC5qcyIsInZpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbmVkZ2VjdHJsLmpzIiwidmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9uZWRnZWRpcmVjdGl2ZS5qcyIsInZpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbmdyYXBoZGlyZWN0aXZlLmpzIiwidmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9ubGlzdGN0cmwuanMiLCJ2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb25zZXJ2aWNlLmpzIiwidm9sdW1lcy92b2x1bWVjcmVhdGVjdHJsLmpzIiwidm9sdW1lcy92b2x1bWVkZXRhaWxzY3RybC5qcyIsInZvbHVtZXMvdm9sdW1lbGlzdGN0cmwuanMiLCJ2b2x1bWVzL3ZvbHVtZXNlcnZpY2UuanMiLCJ2b2x1bWVzL3ZvbHVtZXNuYXBzaG90Y29weWN0cmwuanMiLCJjb21wb25lbnRzL2RpcmVjdGl2ZXMvYWNjb2Rpb25kaXJlY3RpdmUuanMiLCJjb21wb25lbnRzL2RpcmVjdGl2ZXMvY29sbGFwc2libGVkaXJlY3RpdmUuanMiLCJjb21wb25lbnRzL2RpcmVjdGl2ZXMvZXJyb3JtZXNzYWdlZGlyZWN0aXZlLmpzIiwiY29tcG9uZW50cy9kaXJlY3RpdmVzL25hbWV2YWx1ZWRpcmVjdGl2ZS5qcyIsImNvbXBvbmVudHMvZGlyZWN0aXZlcy90YWJsZWRpcmVjdGl2ZS5qcyIsImNvbXBvbmVudHMvbW9kZWxzL2FwcGxpY2F0aW9uZ3JvdXBzbW9kZWwuanMiLCJjb21wb25lbnRzL21vZGVscy9uZXRwcm9maWxlc21vZGVsLmpzIiwiY29tcG9uZW50cy9tb2RlbHMvbmV0d29ya3Ntb2RlbC5qcyIsImNvbXBvbmVudHMvbW9kZWxzL25vZGVzbW9kZWwuanMiLCJjb21wb25lbnRzL21vZGVscy9vcmdhbml6YXRpb25zbW9kZWwuanMiLCJjb21wb25lbnRzL21vZGVscy9wb2xpY2llc21vZGVsLmpzIiwiY29tcG9uZW50cy9tb2RlbHMvcnVsZXNtb2RlbC5qcyIsImNvbXBvbmVudHMvbW9kZWxzL3NlcnZpY2VsYnNtb2RlbC5qcyIsImNvbXBvbmVudHMvbW9kZWxzL3N0b3JhZ2Vwb2xpY2llc21vZGVsLmpzIiwiY29tcG9uZW50cy9tb2RlbHMvdm9sdW1lc21vZGVsLmpzIiwiY29tcG9uZW50cy91dGlscy9jcnVkaGVscGVyc2VydmljZS5qcyIsImNvbXBvbmVudHMvdXRpbHMvaW5zcGVjdHNlcnZpY2UuanMiLCJjb21wb25lbnRzL3V0aWxzL25ldHdvcmtzZXJ2aWNlLmpzIiwiY29tcG9uZW50cy91dGlscy9ub2Rlc3NlcnZpY2UuanMiLCJjb21wb25lbnRzL3V0aWxzL3ZvbHVtZXNldHRpbmdzZXJ2aWNlLmpzIiwiY29tcG9uZW50cy9kaXJlY3RpdmVzL25vZGVzL2FjaXZhbGlkZGlyZWN0aXZlLmpzIiwiY29tcG9uZW50cy9kaXJlY3RpdmVzL25vZGVzL2NvbnRyb2xpbnRlcmZhY2VkaXJlY3RpdmUuanMiLCJjb21wb25lbnRzL2RpcmVjdGl2ZXMvbm9kZXMvbmV0d29ya21vZGVkaXJlY3RpdmUuanMiLCJjb21wb25lbnRzL2RpcmVjdGl2ZXMvbm9kZXMvc2NoZWR1bGVyZGlyZWN0aXZlLmpzIl0sIm5hbWVzIjpbIl9jbGFzc0NhbGxDaGVjayIsImluc3RhbmNlIiwiQ29uc3RydWN0b3IiLCJUeXBlRXJyb3IiLCJfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiIsInNlbGYiLCJjYWxsIiwiUmVmZXJlbmNlRXJyb3IiLCJfaW5oZXJpdHMiLCJzdWJDbGFzcyIsInN1cGVyQ2xhc3MiLCJwcm90b3R5cGUiLCJPYmplY3QiLCJjcmVhdGUiLCJjb25zdHJ1Y3RvciIsInZhbHVlIiwiZW51bWVyYWJsZSIsIndyaXRhYmxlIiwiY29uZmlndXJhYmxlIiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJCYXNlQ29sbGVjdGlvbiIsIiRodHRwIiwiJHEiLCJ1cmwiLCJ0aGlzIiwibW9kZWxzIiwiQ29sbGVjdGlvbiIsImluc3BlY3RTdGF0cyIsImFuZ3VsYXIiLCJtb2R1bGUiLCJfY3JlYXRlQ2xhc3MiLCJkZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJpIiwibGVuZ3RoIiwiZGVzY3JpcHRvciIsImRlZmluZVByb3BlcnR5Iiwia2V5IiwicHJvdG9Qcm9wcyIsInN0YXRpY1Byb3BzIiwiZmFjdG9yeSIsIk5vZGUiLCJMaW5rIiwiRGF0YVNvdXJjZSIsIm5vZGVzIiwibGlua3MiLCJpZCIsIm5hbWUiLCJub2RlRGF0YSIsIl8iLCJmb3JFYWNoIiwiZGF0YSIsIm5ld05vZGUiLCJ0ZXh0IiwicHVzaCIsImxpbmtEYXRhIiwiZmluZE5vZGVCeUlkIiwic291cmNlIiwibGluayIsIkNvbnRpdkdsb2JhbHMiLCJORVRXT1JLU19FTkRQT0lOVCIsIk5FVFdPUktTX0lOU1BFQ1RfRU5EUE9JTlQiLCJTRVJWSUNFTEJTX0lOU1BFQ1RfRU5EUE9JTlQiLCJQT0xJQ0lFU19FTkRQT0lOVCIsIlJVTEVTX0VORFBPSU5UIiwiQVBQTElDQVRJT05HUk9VUFNfRU5EUE9JTlQiLCJTRVJWSUNFTEJTX0VORFBPSU5UIiwiT1JHQU5JWkFUSU9OU19FTkRQT0lOVCIsIk5FVFdPUktfU0VUVElOR1NfRU5EUE9JTlQiLCJORVRQUk9GSUxFU19FTkRQT0lOVCIsIkJHUFNfRU5EUE9JTlQiLCJCR1BTX0lOU1BFQ1RfRU5EUE9JTlQiLCJWSVNVQUxJWkFUSU9OX0VORFBPSU5UIiwiVk9MVU1FU19FTkRQT0lOVCIsIlZPTFVNRVNfQ1JFQVRFX0VORFBPSU5UIiwiVk9MVU1FU19ERUxFVEVfRU5EUE9JTlQiLCJWT0xVTUVTX0NPUFlTTkFQU0hPVFNfRU5EUE9JTlQiLCJWT0xVTUVTX1VTRVNfRU5EUE9JTlQiLCJWT0xVTUVTX1NOQVBTSE9UU19FTkRQT0lOVCIsIlNUT1JBR0VQT0xJQ0lFU19FTkRQT0lOVCIsIlZPTFVNRVNfR0xPQkFMX0VORFBPSU5UIiwiTk9ERVNfTElTVF9FTkRQT0lOVCIsIk5PREVTX0RJU0NPVkVSX0VORFBPSU5UIiwiTk9ERVNfQ09NTUlTU0lPTl9FTkRQT0lOVCIsIk5PREVTX0RFQ09NTUlTU0lPTl9FTkRQT0lOVCIsIk5PREVTX01BSU5URU5BTkNFX0VORFBPSU5UIiwiTk9ERVNfTEFTVF9KT0JfRU5EUE9JTlQiLCJOT0RFU19BQ1RJVkVfSk9CX0VORFBPSU5UIiwiTk9ERVNfU0VUVElOR1NfU0VUX0VORFBPSU5UIiwiTk9ERVNfU0VUVElOR1NfR0VUX0VORFBPSU5UIiwiUkVGUkVTSF9JTlRFUlZBTCIsIkNJRFJfUkVHRVgiLCJWTEFOX1JFR0VYIiwiVlhMQU5fUkVHRVgiLCJOVU1CRVJfUkVHRVgiLCJWaXN1YWxpemVyTm9kZSIsIlZpc3VhbGl6ZXJMaW5rIiwiVmlzdWFsaXplckRhdGFTb3VyY2UiLCJfRGF0YVNvdXJjZSREYXRhU291cmMiLCJjaGlsZHJlbl9zdHJ1Y3QiLCJhbmNlc3RvcnNfc3RydWN0IiwibGFiZWxzIiwic2VsZWN0b3JzIiwiX3RoaXMiLCJnZXRQcm90b3R5cGVPZiIsInRoaXNEYXRhU291cmNlIiwiYWRkZWRDbGllbnQiLCJub2RlIiwiYW5jZXN0b3JzIiwiaXNFbXB0eSIsInBhcmVudCIsImluY2x1ZGVzIiwidG9wTGV2ZWwiLCJnZXRGbG93QmV0d2VlblNldCIsIm5vZGVfbmFtZXMiLCJsb2NhbF9ub2RlcyIsImlkTWFwcGluZyIsImoiLCJpbmRleE9mIiwid2VpZ2h0Iiwibm9kZV90b19hZGQiLCJub2RlSWRUb05hbWUiLCJhZGRlZF9saW5rcyIsInVuZGVmaW5lZCIsImV4aXN0aW5nX2xpbmsiLCJzZXRXZWlnaHQiLCJnZXRSYXdXZWlnaHQiLCJpbmNyZWFzZUNvdW50IiwiUG9saWN5U2VydmljZSIsIkdyYXBoIiwic3ZnIiwidGhpc0dyYXBoIiwiZGVmYXVsdE5vZGVQb2xpY2llcyIsImRlZmF1bHRQYXRoUG9saWNpZXMiLCJzdmdQb2xpY3kiLCJQb2xpY3kiLCJzdGF0ZSIsImNhblpvb20iLCJjYW5QYW4iLCJpbml0Rm9yY2UiLCJkaXNhYmxlVXBkYXRlIiwiY29uc3RzIiwiY2lyY2xlR0NsYXNzIiwiZ3JhcGhDbGFzcyIsInBhdGhDbGFzcyIsIm5vZGVDbGFzcyIsIm5vZGVUZXh0Iiwic3RhcnRSYWRpdXMiLCJtYXhSYWRpdXMiLCJwYWRkaW5nIiwiZGlzcGxheU9mZnNldCIsIm9uIiwiZCIsImRlZnMiLCJhcHBlbmQiLCJhdHRyIiwic3ZnRyIsImNsYXNzZWQiLCJwYXRocyIsInNlbGVjdEFsbCIsImNpcmNsZXMiLCJpbml0Tm9kZXMiLCJpbml0TGlua3MiLCJzZXRQb3NpdGlvbnMiLCJyZXNpemVGdW5jIiwib25XaW5kb3dSZXNpemUiLCJiaW5kaW5ncyIsInJlc2l6ZSIsIiQiLCJ3aW5kb3ciLCJwb2xpY3kiLCJkZXN0cm95Iiwib2ZmIiwiaW5pdGlhbGl6ZSIsImQzTm9kZSIsImVhY2giLCJkMyIsInNlbGVjdCIsImQzZHJhZyIsImRyYWciLCJwb2xpY3lSZW1vdmUiLCJwb2xpY3lSZW1vdmVOYW1lIiwicG9saWN5TmFtZSIsImluZGV4Iiwic3BsaWNlIiwiZXZlbnQiLCJkM3BhdGgiLCJkM25vZGUiLCJkM3pvb20iLCJkcmFnU3ZnIiwiZ0VsIiwidGl0bGUiLCJ3b3JkcyIsInNwbGl0IiwibndvcmRzIiwiZWwiLCJ0c3BhbiIsInRvU3BsaWNlIiwiZmlsdGVyIiwibCIsIm1hcCIsInVwZGF0ZUdyYXBoIiwic3BsaWNlTGlua3NGb3JOb2RlIiwidXBkYXRlQXR0ciIsIm5ld1BhdGhzIiwibmV3UGF0aEF0dHIiLCJoYXNQb2xpY3kiLCJwYXRoUG9saWN5RXZlbnQiLCJuZXdOb2RlcyIsImdyYXBoIiwibmV3Tm9kZUF0dHIiLCJub2RlUG9saWN5RXZlbnQiLCJTdHJpbmciLCJyYWRpdXMiLCJpbnNlcnRUaXRsZUxpbmVicmVha3MiLCJhbHBoYSIsInF1YWR0cmVlIiwiZ2VvbSIsInIiLCJueDEiLCJ4IiwibngyIiwibnkxIiwieSIsIm55MiIsInZpc2l0IiwicXVhZCIsIngxIiwieTEiLCJ4MiIsInkyIiwicG9pbnQiLCJNYXRoIiwic3FydCIsImUiLCJ3aWR0aCIsImhlaWdodCIsIm9mZnNldCIsInEiLCJuIiwiZDNGb3JjZUNvbGxpZGUiLCJtYXgiLCJtaW4iLCJzdmdXaWR0aCIsInN2Z0hlaWdodCIsImNhbGxiYWNrIiwiYm91bmRzIiwiZDNGb3JjZUJvdW5kcyIsImZvcmNlIiwibGF5b3V0Iiwic2l6ZSIsImNoYXJnZSIsImxpbmtEaXN0YW5jZSIsImxpbmtTdHJlbmd0aCIsImdyYXZpdHkiLCJkM0ZvcmNlVGljayIsImQzRm9yY2VTdGFydCIsImQzRm9yY2VFbmQiLCJzdGFydCIsImsiLCJ0aWNrIiwic3RvcCIsInVwZGF0ZUV4aXN0aW5nTm9kZXMiLCJuZXdHcyIsImVudGVyIiwiZXhpdCIsInJlbW92ZSIsInNldEZvcmNlIiwidXBkYXRlTmV3Tm9kZXMiLCJ1cGRhdGVFeGlzdGluZ1BhdGhzIiwibmV3cGF0aHMiLCJzdHlsZSIsInVwZGF0ZU5ld1BhdGhzIiwiVmlzdWFsaXplckdyYXBoIiwiX0dyYXBoJEdyYXBoIiwiZGF0YVNvdXJjZSIsInRyYW5zaXRpb24iLCJlZGdlX2J1ZmZlciIsInJhZGl1c0RlY2F5IiwiY29udGFpbmVyQ2xhc3MiLCJiZWhhdmlvciIsIm9yaWdpbiIsImFyZ3MiLCJkeCIsImR5Iiwiem9vbSIsInNvdXJjZUV2ZW50IiwiY3RybEtleSIsInpvb21lZCIsInRyYW5zbGF0ZSIsInNjYWxlIiwicmlnaHRDbGljayIsImp1c3RTY2FsZVRyYW5zR3JhcGgiLCJ6b29tU2V0Q2FsbGJhY2siLCJ0cmFuc2xhdGVfbmFtZSIsImRlbGF5IiwiZHVyYXRpb24iLCJib2R5RWwiLCJkb2N1bWVudCIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwiZGl2V2lkdGgiLCJjbGllbnRIZWlnaHQiLCJ0b3AiLCJub2RlX25hbWVzX3NldCIsInJldERhdGEiLCJwcm9jZXNzTGlua0RhdGEiLCJzb3VyY2VOb2RlIiwidGFyZ2V0Tm9kZSIsInBhdGhQb2xpY2llcyIsImluaXRpYWxpemVkIiwiYXJyb3dQYXRoIiwiZHIiLCJ0aGlzUGF0aCIsIl9nZXQiLCJnZXQiLCJvYmplY3QiLCJwcm9wZXJ0eSIsInJlY2VpdmVyIiwiRnVuY3Rpb24iLCJkZXNjIiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwiZ2V0dGVyIiwiX0xpbmskTGluayIsImNvdW50IiwicmV0IiwibXkiLCJhdCIsImFkanVzdCIsIm1heFdlaWdodCIsInVzZUF2Z1dlaWdodCIsInVwZGF0ZU1heFdlaWdodCIsInZhbCIsIm1heExpbmsiLCJtYXhCeSIsImdldFdlaWdodCIsImNvbG9yU2NhbGUiLCJsaW5lYXIiLCJkb21haW4iLCJyYW5nZSIsInNlbGVjdGVkQ2xhc3MiLCJzZWxlY3RlZEVkZ2UiLCJjIiwiYXR0clR3ZWVuIiwiaW50ZXJwb2xhdGVTdHJpbmciLCJub2RlUG9saWNpZXMiLCJ0aGlzTm9kZSIsIl9Ob2RlJE5vZGUiLCJ4U3RhcnQiLCJ5U3RhcnQiLCJOb2RlU2VsZWN0aW9uUG9saWN5IiwiX1BvbGljeSRQb2xpY3kiLCJzZWxlY3RlZE5vZGVzIiwic2VsZWN0aW9uIiwiY2QiLCJzdG9wUHJvcGFnYXRpb24iLCJyZW1vdmVTZWxlY3RGcm9tTm9kZSIsImFkZFNlbGVjdE5vZGUiLCJyZW1vdmVBbGxTZWxlY3RlZE5vZGVzIiwiUGF0aENoYW5nZVZpZXdQb2xpY3kiLCIkc3RhdGUiLCJ0aGlzUG9saWN5IiwicmV0TGlzdCIsIm5vZGVJZHMiLCJjaGlsZElkIiwiaGFzQ2hpbGQiLCJjb25jYXQiLCJnZW5lcmF0ZUxpc3QiLCJlZGdlIiwic291cmNlTGlzdCIsInRhcmdldExpc3QiLCJzb3VyY2VJZCIsInRhcmdldElkIiwiZ28iLCJzb3VyY2VOYW1lIiwidGFyZ2V0TmFtZSIsInZpZXdFZGdlIiwiZDNvYmoiLCJjb25maWciLCIkc3RhdGVQcm92aWRlciIsImFic3RyYWN0IiwidGVtcGxhdGUiLCJRVGlwUG9saWN5IiwiU3BsaXRKb2luTm9kZVBvbGljeSIsIlNwbGl0Sm9pblZpZXdQb2xpY3kiLCJTYXZlU3RhdGVQb2xpY3kiLCJtb3VzZWRvd24iLCJtb3VzZXVwIiwiZ3JhcGhVcGRhdGVOZXdOb2RlcyIsImdyYXBoVXBkYXRlTmV3UGF0aHMiLCJpbnRlcnZhbCIsInNldFRpbWVvdXQiLCJxdGlwIiwid2hlblFUaXBBdmFpbGFibGUiLCJhdHRhY2hRVGlwIiwic2VsZWN0b3JNYXAiLCJoYXNLZXlzIiwibGFiZWxzTWFwIiwic2xpY2UiLCJjb250ZW50IiwiZXZlbnRzIiwic2hvdyIsImFwaSIsInBvc2l0aW9uIiwibGVmdCIsInNldCIsInNvbG8iLCJjbGFzc2VzIiwiaGlkZSIsInBhdGhFbCIsInRhcmdldFJldCIsImdldFBvaW50QXRMZW5ndGgiLCJnZXRUb3RhbExlbmd0aCIsInF0aXBIZWxwZXIiLCJzYXZlZFN0YXRlIiwiZ3JhcGhEZXN0cm95IiwibG9hZCIsImdyYXBoTG9hZCIsIl9Ob2RlU2VsZWN0aW9uUG9saWN5JCIsInNwbGl0Tm9kZXMiLCJzdXBlclN0YXRlIiwic3BsaXRNdWx0aXBsZU5vZGVzIiwic3BsaXROb2RlIiwicHJldmVudERlZmF1bHQiLCJqb2luTm9kZSIsImdyYXBoTm9kZXMiLCJuZXdfbm9kZXMiLCJ4TG9jIiwieUxvYyIsIm5ld19ub2RlX29ianMiLCJuZXdfbm9kZSIsInJlcyIsIl9fc3BsaXROb2RlIiwic3BsaXROb2RlRXZlbnQiLCJyZXNOb2RlcyIsInNwbGl0TXVsdGlwbGVOb2Rlc0V2ZW50IiwidG9fYmVfZGVsZXRlZCIsIm5ld19ub2RlX2lkIiwibm9kZV90b19kZWxldGUiLCJfX2pvaW5Ob2RlIiwiam9pbk5vZGVFdmVudCIsImpvaW5NdWx0aXBsZU5vZGVzRXZlbnQiLCJfU3BsaXRKb2luTm9kZVBvbGljeSQiLCJzYXZlZFN0YXRlcyIsImV2ZW50SGlzdG9yeSIsImZvY3VzR3JvdXBzIiwiZm9jaSIsInpvb21zIiwibGF5b3V0RGVmYXVsdCIsInpvb21EZWZhdWx0Iiwibm9kZUlkc1RvUmVzaG93IiwiYmFja0J1dHRvbkVsZW0iLCJ0aXRsZUVsZW0iLCJib3VuZGFyeSIsImVsZW0iLCJiYWNrQnV0dG9uIiwidW5kb0xhc3RFdmVudCIsInNhdmUiLCJjdXJyVGl0bGUiLCJzdGF0ZXMiLCJsb2FkU3RhdGUiLCJmYWRlVG8iLCJ0eXBlIiwicG9zIiwiY29uc29sZSIsImxvZyIsInVwZGF0ZUdyYXBoQ2FsbGJhY2siLCJub2Rlc1RvS2VlcCIsImdyb3VwT25lTm9kZXMiLCJwYXJzZUZsb2F0Iiwic3BsaXROb2RlRnVuYyIsImdldFJhbmRvbUludCIsImZsb29yIiwicmFuZG9tIiwiZ3JhcGhDb25zdHMiLCJzdGF0ZVBvbGljeSIsImRlZmF1bHRMYXlvdXQiLCJjYWxjTWF4Tm9kZXMiLCJhcmVhIiwiYW1vdW50IiwiY29uc3RzUG9saWN5IiwiZm9jdXNOb2RlcyIsImJvdCIsInBvcCIsInNldExheW91dCIsInN0YXRlU3VwZXIiLCJub2RlTmFtZVNldCIsIm5hbWVUb0FkZCIsIm5vZGVzVG9Qcm9jZXNzIiwicHJvY2Vzc05vZGVEYXRhIiwibm9kZVRvUmVtb3ZlIiwibGFzdCIsImZpbmREM05vZGUiLCJkYmxjbGljayIsIm5vZGVJZCIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsIiR1cmxSb3V0ZXJQcm92aWRlciIsIm90aGVyd2lzZSIsIiRzdGF0ZVBhcmFtcyIsIkFwcGxpY2F0aW9uR3JvdXBzTW9kZWwiLCJOZXR3b3Jrc01vZGVsIiwiQ1JVREhlbHBlclNlcnZpY2UiLCJyZXR1cm5Ub0FwcGxpY2F0aW9uR3JvdXAiLCJjYW5jZWxDcmVhdGluZyIsImdldE5ldHdvcmtzIiwidGhlbiIsInJlc3VsdCIsImFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsIiwibmV0d29ya3MiLCJ0ZW5hbnROYW1lIiwiY3JlYXRlQXBwbGljYXRpb25Hcm91cCIsImZvcm0iLCIkdmFsaWQiLCJoaWRlU2VydmVyRXJyb3IiLCJzdGFydExvYWRlciIsImFwcGxpY2F0aW9uR3JvdXAiLCJuZXR3b3JrTmFtZSIsInNlbGVjdGVkTmV0d29yayIsImdlbmVyYXRlS2V5Iiwic3RvcExvYWRlciIsInNob3dTZXJ2ZXJFcnJvciIsInJlc2V0Rm9ybSIsImdyb3VwTmFtZSIsInBvbGljaWVzIiwibmV0UHJvZmlsZSIsIm1vZGUiLCJzZXRNb2RlIiwiaXMiLCJhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwiLCJyZXR1cm5Ub0FwcGxpY2F0aW9uR3JvdXBEZXRhaWxzIiwiY2FuY2VsRWRpdGluZyIsImRlbGV0ZUFwcGxpY2F0aW9uR3JvdXAiLCJzYXZlQXBwbGljYXRpb25Hcm91cCIsImdldE1vZGVsQnlLZXkiLCJncm91cCIsIiRzY29wZSIsIiRpbnRlcnZhbCIsIiRmaWx0ZXIiLCJnZXRBcHBsaWNhdGlvbkdyb3VwcyIsInJlbG9hZCIsImFwcGxpY2F0aW9uR3JvdXBMaXN0Q3RybCIsImdyb3VwcyIsInByb21pc2UiLCJpc0RlZmluZWQiLCIkb24iLCJjYW5jZWwiLCJkaXJlY3RpdmUiLCJyZXN0cmljdCIsInNjb3BlIiwiYXBwbGljYXRpb25ncm91cCIsIk5ldHByb2ZpbGVzTW9kZWwiLCJnZXROZXRwcm9maWxlcyIsIm5ldFByb2ZpbGVzIiwic2VsZWN0ZWROZXRwcm9maWxlIiwiZmluZCIsInByb2ZpbGVOYW1lIiwidXBkYXRlQXBwbGljYXRpb25ncm91cCIsIlBvbGljaWVzTW9kZWwiLCJSdWxlc01vZGVsIiwiZ2V0UnVsZXMiLCJnZXRJbmNvbWluZ1J1bGVzIiwicnVsZXMiLCJBcnJheSIsImFwcGx5IiwiaW5jb21pbmdSdWxlcyIsImdldE91dGdvaW5nUnVsZXMiLCJvdXRnb2luZ1J1bGVzIiwiZ2V0SXNvbGF0aW9uUG9saWNpZXMiLCJpc29sYXRpb25Qb2xpY2llcyIsInNlbGVjdGVkUG9saWN5Iiwic2VsZWN0ZWRQb2xpY2llcyIsImFkZElzb2xhdGlvblBvbGljeSIsImN1cnJlbnRQb2xpY3lOYW1lIiwicmVtb3ZlSXNvbGF0aW9uUG9saWN5IiwicnVsZSIsIk5vZGVzTW9kZWwiLCJWb2x1bWVzTW9kZWwiLCJTdG9yYWdlUG9saWNpZXNNb2RlbCIsImdldERhc2hib2FyZEluZm8iLCJkYXNoYm9hcmRDdHJsIiwidm9sdW1lcyIsIm5ldHdvcmtwb2xpY2llcyIsInN0b3JhZ2Vwb2xpY2llcyIsInJldHVyblRvRGFzaGJvYXJkIiwidXNlcm5hbWUiLCJsb2dpbkN0cmwiLCJsb2dpbiIsInBhcmFtcyIsImxvZ291dCIsIm1lbnVDdHJsIiwiYmFuZHdpZHRoUG9saWN5IiwiYmFuZHdpZHRoIiwiYmFuZHdpZHRoQXJyYXkiLCJiYW5kd2lkdGhOdW1iZXIiLCJOdW1iZXIiLCJiYW5kd2lkdGhVbml0IiwicmV0dXJuVG9Qb2xpY2llcyIsImNyZWF0ZVBvbGljeSIsImJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwiLCJuZXdQb2xpY3kiLCJEU0NQIiwiYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwiLCJkZWxldGVQb2xpY3kiLCJkZWxldGVVc2luZ0tleSIsInJldHVyblRvUG9saWN5RGV0YWlscyIsInNhdmVQb2xpY3kiLCJiYW5kd2lkdGhQcm9maWxlcyIsImdldFBvbGljaWVzIiwicG9saWNpZXNMaXN0Q3RybCIsImlzb2xhdGlvblBvbGljeUNyZWF0ZUN0cmwiLCJpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCIsImRvbmVFZGl0aW5nIiwicmVzZXROZXdJbmNvbWluZ1J1bGUiLCJuZXdJbmNvbWluZ1J1bGUiLCJydWxlSWQiLCJwcmlvcml0eSIsImFjdGlvbiIsImZyb21FbmRwb2ludEdyb3VwIiwiZnJvbU5ldHdvcmsiLCJmcm9tSXBBZGRyZXNzIiwicHJvdG9jb2wiLCJwb3J0IiwiZGlyZWN0aW9uIiwibmV3SW5jb21pbmdTZWxlY3RlZEFwcGxpY2F0aW9uR3JvdXAiLCJuZXdJbmNvbWluZ1NlbGVjdGVkTmV0d29yayIsImRpc2FibGVJbmNvbWluZ05ldHdvcmtTZWxlY3Rpb24iLCJkaXNhYmxlSW5jb21pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uIiwiZGlzYWJsZUluY29taW5nSVBBZGRyZXNzU2VsZWN0aW9uIiwiaW5jb3JyZWN0Q0lEUiIsInZhbGlkYXRlQ0lEUkZsYWciLCJyZXNldE5ld091dGdvaW5nUnVsZSIsIm5ld091dGdvaW5nUnVsZSIsInRvRW5kcG9pbnRHcm91cCIsInRvTmV0d29yayIsInRvSXBBZGRyZXNzIiwibmV3T3V0Z29pbmdTZWxlY3RlZEFwcGxpY2F0aW9uR3JvdXAiLCJuZXdPdXRnb2luZ1NlbGVjdGVkTmV0d29yayIsImRpc2FibGVPdXRnb2luZ05ldHdvcmtTZWxlY3Rpb24iLCJkaXNhYmxlT3V0Z29pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uIiwiZGlzYWJsZU91dGdvaW5nSVBBZGRyZXNzU2VsZWN0aW9uIiwiYXBwbGljYXRpb25Hcm91cHMiLCJvbkNoYW5nZU91dGdvaW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiIsIm9uQ2hhbmdlSW5jb21pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uIiwib25DaGFuZ2VPdXRnb2luZ05ldHdvcmtTZWxlY3Rpb24iLCJUb0VuZHBvaW50R3JvdXAiLCJvbkNoYW5nZUluY29taW5nTmV0d29ya1NlbGVjdGlvbiIsImdlbmVyYXRlUnVsZUlkIiwidG9TdHJpbmciLCJEYXRlIiwibm93IiwiYWRkSW5jb21pbmdSdWxlIiwidmFsaWRhdGVDSURSIiwib25DaGFuZ2VJbmNvbWluZ0lQQWRkcmVzcyIsIm9uQ2hhbmdlT3V0Z29pbmdJUEFkZHJlc3MiLCJpcGFkZHJlc3MiLCJjaWRyUGF0dGVybiIsIlJlZ0V4cCIsInRlc3QiLCJhZGRPdXRnb2luZ1J1bGUiLCJkZWxldGVJbmNvbWluZ1J1bGUiLCJkZWxldGVPdXRnb2luZ1J1bGUiLCJjcmVhdGVOZXR3b3JrUG9saWN5IiwiJGN1cnJlbnQiLCJuZXR3b3JrUG9saWNpZXNUYWJzQ3RybCIsInJldHVyblRvTmV0d29ya3MiLCJjcmVhdGVOZXR3b3JrIiwibmV0d29ya0NyZWF0ZUN0cmwiLCJuZXdOZXR3b3JrIiwiZW5jYXAiLCJzdWJuZXQiLCJnYXRld2F5IiwiZGVsZXRlTmV0d29yayIsIm5ldHdvcmtEZXRhaWxzQ3RybCIsIm5ldHdvcmsiLCJuZXR3b3Jrc0xpc3RDdHJsIiwiSW5zcGVjdFNlcnZpY2UiLCJnZXROZXR3b3JrSW5zcGVjdCIsInJlZnJlc2giLCJnZXRJbnNwZWN0QnlLZXkiLCJuZXR3b3JrU3RhdHNDdHJsIiwibmV0d29ya0luc3BlY3RTdGF0cyIsIk9wZXIiLCJDb25maWciLCJlbmRwb2ludHMiLCJjb250YWluZXJEZXRhaWxzIiwiYnVpbGRFbmRQb2ludHMiLCJjaGVja0NvbnRhaW5lckNoYW5nZWQiLCJnZXRCZ3AiLCJjdHJsIiwiZGVmZXJyZWQiLCJkZWZlciIsInJlc29sdmUiLCJuZWlnaGJvciIsIm5laWdoYm9ycyIsInJlamVjdCIsInVwZGF0ZUJncCIsInBvc3QiLCJnZXRCZ3BJbnNwZWN0IiwiZ2V0QWN0aXZlTG9ncyIsImdldExhc3RMb2dzIiwiTG9nU2VydmljZSIsIm5vZGVBY3RpdmVKb2JMb2dzQ3RybCIsImFjdGl2ZUxvZ3MiLCJOb2Rlc1NlcnZpY2UiLCJyZXR1cm5Ub05vZGVEZXRhaWxzIiwiY2FuY2VsQ29tbWlzc2lvbmluZ05vZGUiLCJjb21taXNzaW9uIiwibm9kZUNvbW1pc3Npb25DdHJsIiwibm9kZU9wc09iaiIsImNsZWFudXBFeHRyYVZhcnMiLCJjcmVhdGVFeHRyYVZhcnMiLCJleHRyYV92YXJzIiwiYW5zaWJsZVZhcmlhYmxlcyIsImVudlZhcmlhYmxlcyIsImdldFNldHRpbmdzIiwiQmdwU2VydmljZSIsImRlY29tbWlzc2lvbiIsIm5vZGVEZXRhaWxzQ3RybCIsInNob3dDb21taXNzaW9uQnV0dG9uIiwiY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQiLCJ1cGdyYWRlQnV0dG9uRW5hYmxlZCIsInVwZ3JhZGUiLCJzZXRCdXR0b25EaXNwbGF5Iiwic3RhdHVzIiwiZ2V0Tm9kZUluZm8iLCJyZXR1cm5Ub0luZm8iLCJ1cGRhdGVCZ3BJbmZvIiwiaXRlbSIsImdldEJncEluZm8iLCJpbnNwZWN0Iiwicm91dGVzIiwiZmlsdGVyZWRyb3V0ZXMiLCJudW1iZXJwYXR0ZXJuIiwicmV0dXJuVG9Ob2RlcyIsImNhbmNlbERpc2NvdmVyaW5nTm9kZSIsImRpc2NvdmVyIiwibm9kZURpc2NvdmVyQ3RybCIsImNyZWF0ZUlQQWRkckFycmF5IiwiYWRkcnMiLCJub2RlSVBBZGRyIiwibm9kZUxhc3RKb2JMb2dzQ3RybCIsImxhc3RMb2dzIiwiZ2V0Tm9kZXMiLCJub2RlTGlzdEN0cmwiLCJPcmdhbml6YXRpb25zTW9kZWwiLCJyZXR1cm5Ub09yZ2FuaXphdGlvbnMiLCJjcmVhdGVPcmdhbml6YXRpb24iLCJvcmdhbml6YXRpb25DcmVhdGVDdHJsIiwibmV3T3JnYW5pemF0aW9uIiwiZGVsZXRlT3JnYW5pemF0aW9uIiwib3JnYW5pemF0aW9uRGV0YWlsc0N0cmwiLCJvcmdhbml6YXRpb24iLCJnZXRPcmdhbml6YXRpb25zIiwib3JnYW5pemF0aW9uc0xpc3RDdHJsIiwib3JnYW5pemF0aW9ucyIsIlNlcnZpY2VsYnNNb2RlbCIsInJldHVyblRvU2VydmljZWxicyIsInNlcnZpY2VsYkNyZWF0ZUN0cmwiLCJjcmVhdGVMYWJlbFNlbGVjdG9yU3RyaW5ncyIsInNlcnZpY2VsYiIsImxhYmVsU2VsZWN0b3JzIiwibGFiZWxTZWxlY3RvciIsInNlbGVjdG9yU3RyaW5nIiwiY3JlYXRlU2VydmljZWxiIiwic2VydmljZU5hbWUiLCJpcEFkZHJlc3MiLCJwb3J0cyIsInNlcnZpY2VsYkRldGFpbHNDdHJsIiwicmV0dXJuVG9TZXJ2aWNlbGJEZXRhaWxzIiwiZGVsZXRlU2VydmljZWxiIiwic2F2ZVNlcnZpY2VsYiIsImV4aXN0aW5nTGFiZWxzIiwiY3JlYXRlTGFiZWxTZWxlY3RvcnMiLCJzZWxlY3RvclN0ciIsInNlbGVjdG9yIiwiZ2V0U2VydmljZWxicyIsInNlcnZpY2VsYkxpc3RDdHJsIiwic2VydmljZWxicyIsIml0ZW1zIiwiY29tcGFyZSIsInZhbDEiLCJ2YWwyIiwicmVzZXROZXdJdGVtIiwibmV3SXRlbSIsInNlcnZpY2VQb3J0IiwicHJvdmlkZXJQb3J0IiwiaXNFbXB0eUl0ZW0iLCJhZGQiLCJuZXdJdGVtU3RyIiwicHVsbEFsbFdpdGgiLCJwYXNzZWRJdGVtIiwiZ2V0U2VydmljZWxiSW5zcGVjdCIsInNlcnZpY2VsYlN0YXRzQ3RybCIsInNlcnZpY2VsYkluc3BlY3RTdGF0cyIsInByb3ZpZGVycyIsInByb3ZpZGVyRGV0YWlscyIsInVwZGF0ZUNsdXN0ZXJTZXR0aW5ncyIsImNsdXN0ZXJTZXR0aW5nQ3RybCIsInVwZGF0ZVNldHRpbmdzIiwiTmV0d29ya1NlcnZpY2UiLCJ1cGRhdGVOZXR3b3JrU2V0dGluZ3MiLCJuZXR3b3JrU2V0dGluZ0N0cmwiLCJzZXR0aW5nIiwiZ2V0TmV0d29ya1NldHRpbmdzIiwidmxhblBhdHRlcm4iLCJ2eGxhblBhdHRlcm4iLCJWb2x1bWVTZXR0aW5nU2VydmljZSIsInVwZGF0ZVZvbHVtZVNldHRpbmdzIiwidm9sdW1lU2V0dGluZ0N0cmwiLCJnZXRWb2x1bWVTZXR0aW5ncyIsInJldHVyblRvU3RvcmFnZVBvbGljaWVzIiwiY3JlYXRlRmlsZXN5c3RlbUNtZHMiLCJzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCIsImZpbGVzeXN0ZW1jbWRzIiwibmV3U3RvcmFnZVBvbGljeSIsImZpbGVzeXN0ZW1zIiwiYmFja2VuZHMiLCJjcnVkIiwibW91bnQiLCJzbmFwc2hvdCIsInVubG9ja2VkIiwiZHJpdmVyIiwicG9vbCIsImZpbGVzeXN0ZW0iLCJydW50aW1lIiwic25hcHNob3RzIiwiZnJlcXVlbmN5Iiwia2VlcCIsInJhdGUtbGltaXQiLCJ3cml0ZS1pb3BzIiwicmVhZC1pb3BzIiwid3JpdGUtYnBzIiwicmVhZC1icHMiLCJzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwiLCJnZXRWb2x1bWVzIiwiaW5pdGlhbGl6ZUZpbGVzeXN0ZW1DbWRzQXJyYXkiLCJzdG9yYWdlUG9saWN5TGlzdEN0cmwiLCJWaXN1YWxpemF0aW9uU2VydmljZSIsInQiLCJnZXRTZWNvbmRzIiwiZWRnZURhdGFJbnRlcnZhbCIsImdldEVkZ2VEYXRhIiwicmVzdWx0cyIsInNlcmllcyIsInZhbHVlcyIsImVkZ2VEYXRhIiwiZWRnZURhdGFUaW1lIiwiZ2V0T2xkRWRnZURhdGEiLCJvbGRFZGdlRGF0YSIsIiR3aW5kb3ciLCJ2aXN1YWxpemF0aW9uRWRnZUQzIiwicGF0aCIsImxpbmUiLCJsaW1pdCIsImF4aXMiLCJlYXNlIiwieUF4aXMiLCJzaGlmdCIsImNsaWVudFdpZHRoIiwiY3VycmVudCIsImNvbG9yIiwidGltZSIsImludGVycG9sYXRlIiwieFN2ZyIsIm9yaWVudCIsInJlcGxhY2UiLCIkd2F0Y2hHcm91cCIsInNlcnZpY2UiLCJTdGF0ZVNhdmUiLCJ2aXN1YWxpemF0aW9ubGlzdGQzIiwic2VydmljZVNlbGVjdG9ycyIsInNldEFuY2VzdG9ycyIsInRvcERhdGEiLCJnZXRUb3BMZXZlbEZsb3ciLCJyYXdTdmciLCJ2aXN1YWxpemF0aW9uR3JhcGgiLCJpbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3kiLCJxVGlwUG9saWN5IiwiaW5zdGFsbERlZmF1bHROb2RlUG9saWN5Iiwic3BsaXRKb2luVmlld1BvbGljeSIsImluc3RhbGxCYWNrQnV0dG9uIiwiaW5zdGFsbFRpdGxlIiwidW5iaW5kIiwidXBkYXRlTGlua0RhdGEiLCJncmFwaERhdGEiLCJzdHJ1Y3R1cmVEYXRhIiwiMTAuMS4xLjEwIiwiZW52aXJvbm1lbnQiLCJyZWxlYXNlIiwidmVyc2lvbiIsInRpZXIiLCIxMC4xLjEuMTEiLCIxMC4xLjEuMTIiLCIxMC4xLjEuMSIsIjEwLjEuMS45IiwiMTAuMS4xLjgiLCIxMC4xLjEuMyIsIjEwLjEuMS4yIiwiMTAuMS4xLjUiLCIxMC4xLjEuNCIsIjEwLjEuMS43IiwiMTAuMS4xLjYiLCJhcHAtZGIiLCJhcHAtc3ZjIiwicyIsImdldEdyYXBoRGF0YSIsImdyYXBoRGF0YUludGVydmFsIiwiZ2V0U3RydWN0dXJlRGF0YSIsIm1ha2VHZXQiLCJtYWtlUG9zdCIsInBhcmFtIiwib2JqIiwiZnVsbFN1Yk5hbWUiLCJzdWJOYW1lIiwic3ViVmFsdWUiLCJpbm5lck9iaiIsInF1ZXJ5IiwiZW5jb2RlVVJJQ29tcG9uZW50Iiwic3Vic3RyIiwibWV0aG9kIiwiaGVhZGVycyIsIkNvbnRlbnQtVHlwZSIsInRyYW5zZm9ybVJlcXVlc3QiLCJpc09iamVjdCIsImRiIiwiYnVpbGRXaGVyZVF1ZXJ5IiwicG9pbnRzIiwicmV0dXJuVG9Wb2x1bWVzTW9kZWwiLCJnZXRTdG9yYWdlUG9saWNpZXMiLCJ2b2x1bWVDcmVhdGVDdHJsIiwiYXBwbHlQb2xpY3lTZXR0aW5ncyIsIm5ld1ZvbHVtZSIsImNyZWF0ZVZvbHVtZSIsIlZvbHVtZVNlcnZpY2UiLCJyZXR1cm5Ub1ZvbHVtZXMiLCJkZWxldGVWb2x1bWUiLCJ2b2x1bWVEZXRhaWxzQ3RybCIsInZvbHVtZSIsImdldFZvbHVtZUluZm8iLCJ0b2tlbnMiLCJtb2RlbCIsImdldE1vZGVsIiwiZ2V0Vm9sdW1lVXNlSW5mbyIsImdldFZvbHVtZVNuYXBzaG90cyIsInZvbHVtZVVzZSIsInRyaWdnZXJWb2x1bWVTbmFwc2hvdCIsInNuYXBzaG90U3VjY2VzcyIsInRyaWdnZXJTbmFwc2hvdCIsInZvbHVtZUxpc3RDdHJsIiwiY2FuY2VsQ29weSIsImdvVG9OZXdWb2x1bWUiLCJ2b2x1bWVTbmFwc2hvdENvcHlDdHJsIiwibmV3dm9sdW1lIiwiY29weVNuYXBzaG90IiwiY29weSIsInRyYW5zY2x1ZGUiLCJlbGVtZW50IiwiYWNjb3JkaW9uIiwiY29sbGFwc2VkIiwiaGVhZGVyIiwiZXJyb3IiLCJhZGRDbGFzcyIsIm5hbWVoZWFkZXIiLCJ2YWx1ZWhlYWRlciIsIm9wdGlvbnMiLCJmaWx0ZXJGaWx0ZXIiLCJsaW1pdFRvRmlsdGVyIiwiZmlsdGVyZWRpdGVtcyIsImRlZmF1bHRzb3J0Y29sdW1uIiwiJGVsZW1lbnQiLCIkYXR0cnMiLCJzaG93Q2h1bmsiLCJwYWdlTm8iLCJzZWFyY2hUZXh0IiwidGFibGVDdHJsIiwic2VhcmNoVGV4dEZpbHRlcmVkSXRlbXMiLCJzb3J0T2JqIiwiZmllbGQiLCJyZXZlcnNlIiwibm9PZkNodW5rcyIsImNlaWwiLCJjaHVua3MiLCJzZWxlY3RlZCIsInNsaWNlU3RhcnQiLCJzbGljZUVuZCIsInBhZ2luYXRpb25NZW51IiwiZmlsdGVyZWRJdGVtcyIsInNob3dQcmV2Q2h1bmsiLCJwcmV2Q2h1bmsiLCJzaG93TmV4dENodW5rIiwibmV4dENodW5rIiwiYWRkUGFnaW5hdGlvbk1lbnUiLCJtZW51IiwiaW5pdGlhbGl6ZVNvcnQiLCJzb3J0ZmllbGQiLCJpY29uRGlyZWN0aW9uIiwiYW5nbGUgZG93biBpY29uIiwiYW5nbGUgdXAgaWNvbiIsInNvcnQiLCIkYXBwbHkiLCJwYXJzZUludCIsImlzTmFOIiwiYXR0cnMiLCIkcGFyZW50IiwiJHdhdGNoIiwicmVxdWlyZSIsImNsYXNzIiwidGFibGVjdHJsIiwiYmluZCIsInBsYWNlaG9sZGVyIiwiY29sc3BhbiIsImdyb3Vwc21vZGVsIiwiZXh0cmFjdCIsImNvbGxlY3Rpb24iLCJ3aGVuIiwia2V5bmFtZSIsImZpbmRNb2RlbCIsInJlc3BvbnNlIiwicmVzcG9uc2VEYXRhIiwicHV0IiwicmVzcG9uc2VTdGF0cyIsIm5ldHByb2ZpbGVzTW9kZWwiLCJOb2Rlc0NvbGxlY3Rpb24iLCJub2Rlc2NvbGxlY3Rpb24iLCJub2Rlc21vZGVsIiwicG9saWNpZXNtb2RlbCIsInJ1bGVzbW9kZWwiLCJTdG9yYWdlUG9saWNpZXNDb2xsZWN0aW9uIiwiVm9sdW1lc0NvbGxlY3Rpb24iLCJ2b2x1bWVzY29sbGVjdGlvbiIsInZvbGNvcHltb2RlbCIsIk9wdGlvbnMiLCJ2b2x1bWVzbW9kZWwiLCJzaG93TG9hZGVyIiwibWVzc2FnZSIsInNlcnZlckVycm9yTWVzc2FnZSIsImNvbnRhaW5lckF0dHJpYnV0ZXMiLCJlbmRwb2ludEF0dHJpYnV0ZSIsImZvcm1hdCIsImpvaW4iLCJ2IiwiY29udGFpbmVySUQiLCJjb250RGV0YWlsc0EiLCJjb250RGV0YWlsc0IiLCJrZXlzIiwiZXh0cmFWYXJzIiwic2NoZWRfcHJvdmlkZXIiLCJub2RlX2NvbnN0YW50cyIsIlNDSEVEX1BST1ZJREVSIiwibmV0d29ya19tb2RlIiwiQ09OVElWX05FVF9NT0RFIiwiQ09OVFJPTF9JTlRFUkZBQ0UiLCJEQVRBX0lOVEVSRkFDRSIsIlZJUF9BRERSIiwiVUNQX0JPT1RTVFJBUF9OT0RFIiwiRldEX01PREUiLCJBUElDX0NPTlRSX1VOUkVTVFJJQ1RfTU9ERSIsIkFQSUNfRVBHX0JSSURHRV9ET01BSU4iLCJBUElDX0xFQUZfTk9ERVMiLCJBUElDX1BBU1NXT1JEIiwiQVBJQ19QSFlTX0RPTUFJTiIsIkFQSUNfVVJMIiwiQVBJQ19VU0VSTkFNRSIsIkNMVVNURVJfTkFNRSIsImNyZWF0ZUVudlZhcmlhYmxlcyIsIkVOViIsImNyZWF0ZUFuc2libGVWYXJpYWJsZXMiLCJlbnZWYXJzIiwic2V0dGluZ19maWx0ZXIiLCJKU09OIiwic3RyaW5naWZ5IiwiZXh0cmF2YXJzIl0sIm1hcHBpbmdzIjoiQUFBQSxZQVlBLFNBQVNBLGlCQUFnQkMsRUFBVUMsR0FBZSxLQUFNRCxZQUFvQkMsSUFBZ0IsS0FBTSxJQUFJQyxXQUFVLHFDQThNaEgsUUFBU0gsaUJBQWdCQyxFQUFVQyxHQUFlLEtBQU1ELFlBQW9CQyxJQUFnQixLQUFNLElBQUlDLFdBQVUscUNBRWhILFFBQVNDLDRCQUEyQkMsRUFBTUMsR0FBUSxJQUFLRCxFQUFRLEtBQU0sSUFBSUUsZ0JBQWUsNERBQWdFLFFBQU9ELEdBQXlCLGdCQUFUQSxJQUFxQyxrQkFBVEEsR0FBOEJELEVBQVBDLEVBRWxPLFFBQVNFLFdBQVVDLEVBQVVDLEdBQWMsR0FBMEIsa0JBQWZBLElBQTRDLE9BQWZBLEVBQXVCLEtBQU0sSUFBSVAsV0FBVSxpRUFBb0VPLEdBQWVELEdBQVNFLFVBQVlDLE9BQU9DLE9BQU9ILEdBQWNBLEVBQVdDLFdBQWFHLGFBQWVDLE1BQU9OLEVBQVVPLFlBQVksRUFBT0MsVUFBVSxFQUFNQyxjQUFjLEtBQWVSLElBQVlFLE9BQU9PLGVBQWlCUCxPQUFPTyxlQUFlVixFQUFVQyxHQUFjRCxFQUFTVyxVQUFZVixHQStQamUsUUFBU1YsaUJBQWdCQyxFQUFVQyxHQUFlLEtBQU1ELFlBQW9CQyxJQUFnQixLQUFNLElBQUlDLFdBQVUscUNBKzRCaEgsUUFBU0gsaUJBQWdCQyxFQUFVQyxHQUFlLEtBQU1ELFlBQW9CQyxJQUFnQixLQUFNLElBQUlDLFdBQVUscUNBRWhILFFBQVNDLDRCQUEyQkMsRUFBTUMsR0FBUSxJQUFLRCxFQUFRLEtBQU0sSUFBSUUsZ0JBQWUsNERBQWdFLFFBQU9ELEdBQXlCLGdCQUFUQSxJQUFxQyxrQkFBVEEsR0FBOEJELEVBQVBDLEVBRWxPLFFBQVNFLFdBQVVDLEVBQVVDLEdBQWMsR0FBMEIsa0JBQWZBLElBQTRDLE9BQWZBLEVBQXVC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LE9BQUEsS0FBQUYsVUFBQSxPQUNBaEUsRUFBQVUsTUFBQVAsS0FBQSxXQUFBRCxHQUFBLFdBQUFnRSxPQUFBLEtBQUFGLFVBQUEsT0FDQWhFLEVBQUFVLE1BQUFQLEtBQUEsV0FBQUQsR0FBQSxXQUFBZ0UsT0FBQSxLQUFBRixVQUFBLE9BQ0FoRSxFQUFBVSxNQUFBUCxLQUFBLFdBQUFELEdBQUEsV0FBQWdFLE9BQUEsS0FBQUYsVUFBQSxPQUdBaEUsRUFBQVUsTUFBQVAsS0FBQSxXQUFBRCxHQUFBLFdBQUFnRSxPQUFBLEtBQUFGLFVBQUEsT0FDQWhFLEVBQUFVLE1BQUFQLEtBQUEsV0FBQUQsR0FBQSxXQUFBZ0UsT0FBQSxLQUFBRixVQUFBLE9BQ0FoRSxFQUFBVSxNQUFBUCxLQUFBLFdBQUFELEdBQUEsV0FBQWdFLE9BQUEsS0FBQUYsVUFBQSxPQUNBaEUsRUFBQVUsTUFBQVAsS0FBQSxXQUFBRCxHQUFBLFdBQUFnRSxPQUFBLEtBQUFGLFVBQUEsT0FDQWhFLEVBQUFVLE1BQUFQLEtBQUEsV0FBQUQsR0FBQSxXQUFBZ0UsT0FBQSxLQUFBRixVQUFBLE9BQ0FoRSxFQUFBVSxNQUFBUCxLQUFBLFdBQUFELEdBQUEsV0FBQWdFLE9BQUEsS0FBQUYsVUFBQSxPQUNBaEUsRUFBQVUsTUFBQVAsS0FBQSxXQUFBRCxHQUFBLFdBQUFnRSxPQUFBLEtBQUFGLFVBQUEsT0FDQWhFLEVBQUFVLE1BQUFQLEtBQUEsV0FBQUQsR0FBQSxXQUFBZ0UsT0FBQSxLQUFBRixVQUFBLE9BQ0FoRSxFQUFBVSxNQUFBUCxLQUFBLFdBQUFELEdBQUEsV0FBQWdFLE9BQUEsS0FBQUYsVUFBQSxPQUdBaEUsRUFBQVUsTUFBQVAsS0FBQSxZQUFBRCxHQUFBLFlBQUFnRSxPQUFBLEtBQUFGLFVBQUEsT0FDQWhFLEVBQUFVLE1BQUFQLEtBQUEsWUFBQUQsR0FBQSxZQUFBZ0UsT0FBQSxLQUFBRixVQUFBLE9BQ0FoRSxFQUFBVSxNQUFBUCxLQUFBLFlBQUFELEdBQUEsWUFBQWdFLE9BQUEsS0FBQUYsVUFBQSxPQUdBL0QsRUFBQVMsTUFBQUcsT0FBQSxXQUFBMUIsT0FBQSxXQUFBd0YsT0FBQSxLQUNBMUUsRUFBQVMsTUFBQUcsT0FBQSxXQUFBMUIsT0FBQSxXQUFBd0YsT0FBQSxLQUNBMUUsRUFBQVMsTUFBQUcsT0FBQSxXQUFBMUIsT0FBQSxXQUFBd0YsT0FBQSxLQUNBMUUsRUFBQVMsTUFBQUcsT0FBQSxXQUFBMUIsT0FBQSxXQUFBd0YsT0FBQSxLQUNBMUUsRUFBQVMsTUFBQUcsT0FBQSxXQUFBMUIsT0FBQSxXQUFBd0YsT0FBQSxLQUNBMUUsRUFBQVMsTUFBQUcsT0FBQSxXQUFBMUIsT0FBQSxXQUFBd0YsT0FBQSxLQUNBMUUsRUFBQVMsTUFBQUcsT0FBQSxXQUFBMUIsT0FBQSxXQUFBd0YsT0FBQSxLQUNBMUUsRUFBQVMsTUFBQUcsT0FBQSxXQUFBMUIsT0FBQSxXQUFBd0YsT0FBQSxLQUNBMUUsRUFBQVMsTUFBQUcsT0FBQSxXQUFBMUIsT0FBQSxXQUFBd0YsT0FBQSxLQUNBMUUsRUFBQVMsTUFBQUcsT0FBQSxXQUFBMUIsT0FBQSxXQUFBd0YsT0FBQSxLQUNBMUUsRUFBQVMsTUFBQUcsT0FBQSxXQUFBMUIsT0FBQSxXQUFBd0YsT0FBQSxLQUNBMUUsRUFBQVMsTUFBQUcsT0FBQSxXQUFBMUIsT0FBQSxXQUFBd0YsT0FBQSxLQUNBMUUsRUFBQVMsTUFBQUcsT0FBQSxXQUFBMUIsT0FBQSxXQUFBd0YsT0FBQSxLQUNBMUUsRUFBQVMsTUFBQUcsT0FBQSxXQUFBMUIsT0FBQSxXQUFBd0YsT0FBQSxLQUdBMUUsRUFBQVMsTUFBQUcsT0FBQSxXQUFBMUIsT0FBQSxZQUFBd0YsT0FBQSxLQUNBMUUsRUFBQVMsTUFBQUcsT0FBQSxZQUFBMUIsT0FBQSxXQUFBd0YsT0FBQSxNQUNBM0UsTUFBQUEsRUFBQUMsTUFBQUEsSUFHQXcwQixFQUFBLFdBQ0EsR0FBQWh4QixJQUNBaXhCLGFBQ0FDLFlBQUEsT0FDQUMsUUFBQSxTQUNBQyxRQUFBLE1BQ0FDLEtBQUEsTUFFQUMsYUFDQUosWUFBQSxPQUNBQyxRQUFBLFNBQ0FDLFFBQUEsTUFD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U0FBQSxJQUNBckQsWUFBQSw2Q0FDQXNELE9BQ0EyZ0IsVUFBQSIsImZpbGUiOiJhcHAvYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIERlZmluaW5nIHRoZSBHcmFwaCBNb2R1bGUuXG4gKiBTZWUgREVTSUdOLm1kIGZvciBpbmZvIG9uIEdyYXBoIE9iamVjdHMuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnLCBbXSk7XG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5kaXJlY3RpdmVzXCIsIFtdKTtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLyoqXG4gKiBUaGUgYmFzZSBjbGFzcyB0aGUgRGF0YVNvdXJjZSBvYmplY3QuXG4gKiBcbiAqIFRoZSBEYXRhU291cmNlIG9iamVjdCB0YWtlcyBpbiBub2RlIGFuZCBsaW5rIGRhdGEgZnJvbSB0aGUgc2VydmVyLCBcbiAqIGFuZCBwcm92aWRlcyBtZXRob2RzIGZvciBjb252ZXJ0aW5nIGFuZCBtYW5pcHVsYXRpbmcgdGhlIGRhdGEgZm9yXG4gKiB0aGUgZ3JhcGggb2JqZWN0LlxuICogXG4gKiBUbyB3cml0ZSB5b3VyIG93biBEYXRhU291cmNlIG9iamVjdCwgY3JlYXRlIGEgbmV3IGZhY3RvcnkgdGhhdCB1c2VzIHRoZSBcbiAqIERhdGFTb3VyY2UgeW91IHdhbnQgdG8gaW5oZXJpdCBhcyBhIGRlcGVuZGVuY3ksIGFuZCBleHRlbmQgXG4gKiBpdHMgRGF0YVNvdXJjZSBjbGFzcy4gXG4gKiBSZXR1cm4gdGhlIGNsYXNzIG9iamVjdCB3aXRoIERhdGFTb3VyY2UgYXMga2V5LlxuICogXG4gKiBOb2RlIGRhdGEgaXMgZXhwZWN0ZWQgdG8gYmUgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6XG4gKiB7aWQ6bm9kZV9pZCwgdGV4dDpub2RlX3RleHR9XG4gKiBcbiAqIExpbmsgZGF0YSBpcyBleHBlY3RlZCB0byBiZSBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDpcbiAqIHtzb3VyY2U6IHNvdXJjZU5vZGVJZCwgdGFyZ2V0OiB0YXJnZXROb2RlSWR9XG4gKiBcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ0RhdGFTb3VyY2UnLCBbJ05vZGUnLCAnTGluaycsIGZ1bmN0aW9uIChOb2RlLCBMaW5rKSB7XG5cdHZhciBEYXRhU291cmNlID0gZnVuY3Rpb24gKCkge1xuXHRcdC8qKlxuICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAqXG4gICAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBub2RlcyAgICAgICAgICAgICAgVGhlIG5vZGUgZGF0YSBcbiAgICogQHBhcmFtICAgICAge0FycmF5fSAgIGxpbmtzICAgICAgICAgICAgICBUaGUgbGluayBkYXRhXG4gICAqL1xuXHRcdGZ1bmN0aW9uIERhdGFTb3VyY2Uobm9kZXMsIGxpbmtzKSB7XG5cdFx0XHRfY2xhc3NDYWxsQ2hlY2sodGhpcywgRGF0YVNvdXJjZSk7XG5cblx0XHRcdHRoaXMubm9kZXMgPSBub2Rlcztcblx0XHRcdHRoaXMubGlua3MgPSBsaW5rcztcblx0XHR9XG5cblx0XHQvKipcbiAgICogUmVwbGFjZXMgdGhlIG5vZGUgZGF0YVxuICAgKlxuICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGVzICAgVGhlIG5vZGVzXG4gICAqL1xuXG5cblx0XHRfY3JlYXRlQ2xhc3MoRGF0YVNvdXJjZSwgW3tcblx0XHRcdGtleTogJ3VwZGF0ZU5vZGVzJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVOb2Rlcyhub2Rlcykge1xuXHRcdFx0XHR0aGlzLm5vZGVzID0gbm9kZXM7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogUmVwbGFjZXMgdGhlIGxpbmsgZGF0YVxuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtMaW5rfSAgbGlua3MgICBUaGUgbGlua3NcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAndXBkYXRlTGlua3MnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUxpbmtzKGxpbmtzKSB7XG5cdFx0XHRcdHRoaXMubGlua3MgPSBsaW5rcztcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBSZXR1cm5zIHRoZSBOYW1lIGF0dHJpYnV0ZSBvZiB0aGUgTm9kZSB3aXRoIHRoZSBcbiAgICAqIG1hdGNoaW5nIGlkXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGlkICAgICAgVGhlIGlkZW50aWZpZXJcbiAgICAqIEByZXR1cm4gICAgIHtzdHJpbmd9ICBuYW1lIG9mIHRoZSBtYXRjaGluZyBub2RlXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ25vZGVJZFRvTmFtZScsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gbm9kZUlkVG9OYW1lKGlkKSB7XG5cdFx0XHRcdHZhciBub2RlcyA9IHRoaXMubm9kZXM7XG5cdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRpZiAobm9kZXNbaV0uaWQgPT0gaWQpIHtcblx0XHRcdFx0XHRcdHJldHVybiBub2Rlc1tpXS5uYW1lO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIHByb2Nlc3MgdGhlIG5vZGVEYXRhIHRvIGNyZWF0ZSBOb2RlIG9iamVjdHNcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlRGF0YSAgTm9kZURhdGEgdG8gY29udmVydCBcbiAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0byBub2RlIG9iamVjdHNcbiAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIE5vZGUgb2JqZWN0c1xuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdwcm9jZXNzTm9kZURhdGEnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHByb2Nlc3NOb2RlRGF0YShub2RlRGF0YSkge1xuXHRcdFx0XHR2YXIgbm9kZXMgPSBbXTtcblx0XHRcdFx0Xy5mb3JFYWNoKG5vZGVEYXRhLCBmdW5jdGlvbiAoZGF0YSkge1xuXHRcdFx0XHRcdHZhciBuZXdOb2RlID0gbmV3IE5vZGUuTm9kZShudWxsLCBudWxsLCBkYXRhLmlkLCBkYXRhLnRleHQsIG51bGwpO1xuXHRcdFx0XHRcdG5vZGVzLnB1c2gobmV3Tm9kZSk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRyZXR1cm4gbm9kZXM7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogcHJvY2VzcyB0aGUgbGlua0RhdGFcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBsaW5rRGF0YSAgVGhlIGxpbmsgZGF0YVxuICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZXMgICAgIFRoZSBub2RlcyBmcm9tIHByb2Nlc3NOb2RlRGF0YVxuICAgICogQHJldHVybiAgICAge0FycmF5fSAgTGluayBvYmplY3RzXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3Byb2Nlc3NMaW5rRGF0YScsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gcHJvY2Vzc0xpbmtEYXRhKGxpbmtEYXRhLCBub2Rlcykge1xuXHRcdFx0XHQvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBub2RlIHRoYXQgbWF0Y2hlcyB0aGUgaWRcbiAgICAgKlxuICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9IGlkICAgICAgVGhlIGlkZW50aWZpZXJcbiAgICAgKiBAcmV0dXJuICAgICB7Tm9kZX0gICBUaGUgbm9kZSB3aXRoIHRoZSBtYXRjaGluZyBpZFxuICAgICAqL1xuXHRcdFx0XHRmdW5jdGlvbiBmaW5kTm9kZUJ5SWQoaWQsIG5vZGVzKSB7XG5cdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0aWYgKGlkID09IG5vZGVzW2ldLmlkKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBub2Rlc1tpXTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR2YXIgbGlua3MgPSBbXTtcblx0XHRcdFx0Ly90cmFuc2Zvcm1pbmcgbGluayBkYXRhXG5cdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbGlua0RhdGEubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRpZiAobGlua0RhdGFbaV0uc291cmNlICE9IGxpbmtEYXRhW2ldLnRhcmdldCkge1xuXHRcdFx0XHRcdFx0dmFyIHNvdXJjZSA9IGZpbmROb2RlQnlJZChsaW5rRGF0YVtpXS5zb3VyY2UsIG5vZGVzKTtcblx0XHRcdFx0XHRcdHZhciB0YXJnZXQgPSBmaW5kTm9kZUJ5SWQobGlua0RhdGFbaV0udGFyZ2V0LCBub2Rlcyk7XG5cdFx0XHRcdFx0XHRpZiAoc291cmNlID09IG51bGwgfHwgdGFyZ2V0ID09IG51bGwpIHtcblx0XHRcdFx0XHRcdFx0Y29udGludWU7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR2YXIgbGluayA9IG5ldyBMaW5rLkxpbmsoc291cmNlLCB0YXJnZXQpO1xuXHRcdFx0XHRcdFx0bGlua3MucHVzaChsaW5rKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIGxpbmtzO1xuXHRcdFx0fVxuXHRcdH1dKTtcblxuXHRcdHJldHVybiBEYXRhU291cmNlO1xuXHR9KCk7XG5cblx0cmV0dXJuIHtcblx0XHREYXRhU291cmNlOiBEYXRhU291cmNlXG5cdH07XG59XSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMTQvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubW9kZWxzJywgW10pO1xudmFyIENvbnRpdkdsb2JhbHMgPSAoZnVuY3Rpb24gKCkge1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgLy9SRVNUIGVuZHBvaW50cyBmb3IgTkVUTUFTVEVSXG4gICAgICAgICdORVRXT1JLU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9uZXR3b3Jrcy8nLFxuICAgICAgICAnTkVUV09SS1NfSU5TUEVDVF9FTkRQT0lOVCc6Jy9uZXRtYXN0ZXIvYXBpL3YxL2luc3BlY3QvbmV0d29ya3MvJyxcbiAgICAgICAgJ1NFUlZJQ0VMQlNfSU5TUEVDVF9FTkRQT0lOVCc6Jy9uZXRtYXN0ZXIvYXBpL3YxL2luc3BlY3Qvc2VydmljZUxCcy8nLFxuICAgICAgICAnUE9MSUNJRVNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvcG9saWN5cy8nLFxuICAgICAgICAnUlVMRVNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvcnVsZXMvJyxcbiAgICAgICAgJ0FQUExJQ0FUSU9OR1JPVVBTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL2VuZHBvaW50R3JvdXBzLycsXG4gICAgICAgICdTRVJWSUNFTEJTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL3NlcnZpY2VMQnMvJyxcbiAgICAgICAgJ09SR0FOSVpBVElPTlNfRU5EUE9JTlQnOicvbmV0bWFzdGVyL2FwaS92MS90ZW5hbnRzLycsXG4gICAgICAgICdORVRXT1JLX1NFVFRJTkdTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL2dsb2JhbHMvJyxcbiAgICAgICAgJ05FVFBST0ZJTEVTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL25ldHByb2ZpbGVzLycsXG4gICAgICAgICdCR1BTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL0JncHMvJyxcbiAgICAgICAgJ0JHUFNfSU5TUEVDVF9FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9pbnNwZWN0L0JncHMvJyxcbiAgICAgICAgJ1ZJU1VBTElaQVRJT05fRU5EUE9JTlQnOiAnL3Zpc3VhbGl6YXRpb24vJyxcblxuICAgICAgICAvL1JFU1QgZW5kcG9pbnRzIGZvciBWT0xNQVNURVJcbiAgICAgICAgJ1ZPTFVNRVNfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci92b2x1bWVzLycsXG4gICAgICAgICdWT0xVTUVTX0NSRUFURV9FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3ZvbHVtZXMvY3JlYXRlLycsXG4gICAgICAgICdWT0xVTUVTX0RFTEVURV9FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3ZvbHVtZXMvcmVtb3ZlLycsXG4gICAgICAgICdWT0xVTUVTX0NPUFlTTkFQU0hPVFNfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci92b2x1bWVzL2NvcHknLFxuICAgICAgICAnVk9MVU1FU19VU0VTX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvdXNlcy9tb3VudHMvJyxcbiAgICAgICAgJ1ZPTFVNRVNfU05BUFNIT1RTX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvc25hcHNob3RzLycsXG4gICAgICAgICdTVE9SQUdFUE9MSUNJRVNfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci9wb2xpY2llcy8nLFxuICAgICAgICAnVk9MVU1FU19HTE9CQUxfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci9nbG9iYWwvJyxcblxuICAgICAgICAvL1JFU1QgZW5kcG9pbnRzIGZvciBDTFVTVEVSXG4gICAgICAgICdOT0RFU19MSVNUX0VORFBPSU5UJzogJy9pbmZvL25vZGVzJyxcbiAgICAgICAgJ05PREVTX0RJU0NPVkVSX0VORFBPSU5UJzogJy9kaXNjb3Zlci9ub2RlcycsXG4gICAgICAgICdOT0RFU19DT01NSVNTSU9OX0VORFBPSU5UJzogJy9jb21taXNzaW9uL25vZGVzJyxcbiAgICAgICAgJ05PREVTX0RFQ09NTUlTU0lPTl9FTkRQT0lOVCc6ICcvZGVjb21taXNzaW9uL25vZGVzJyxcbiAgICAgICAgJ05PREVTX01BSU5URU5BTkNFX0VORFBPSU5UJzogJy9tYWludGVuYW5jZS9ub2RlcycsXG4gICAgICAgICdOT0RFU19MQVNUX0pPQl9FTkRQT0lOVCc6ICcvaW5mby9qb2IvbGFzdCcsXG4gICAgICAgICdOT0RFU19BQ1RJVkVfSk9CX0VORFBPSU5UJzogJy9pbmZvL2pvYi9hY3RpdmUnLFxuICAgICAgICAnTk9ERVNfU0VUVElOR1NfU0VUX0VORFBPSU5UJzogJy9nbG9iYWxzJyxcbiAgICAgICAgJ05PREVTX1NFVFRJTkdTX0dFVF9FTkRQT0lOVCc6ICcvaW5mby9nbG9iYWxzJyxcblxuICAgICAgICAvL1JlZnJlc2ggaW50ZXJ2YWwgaW4gbWlsbGlzZWNvbmRzXG4gICAgICAgICdSRUZSRVNIX0lOVEVSVkFMJzogNTAwMCxcblxuICAgICAgICAvL1JlZ0V4IGZvciB2YWxpZGF0aW9uXG4gICAgICAgICdDSURSX1JFR0VYJyA6ICdeKChbMC05XXxbMS05XVswLTldfDFbMC05XXsyfXwyWzAtNF1bMC05XXwyNVswLTVdKVxcLil7M30oWzAtOV18WzEtOV1bMC05XXwxWzAtOV17Mn18MlswLTRdWzAtOV18MjVbMC01XSkoXFwvKFswLTldfFsxLTJdWzAtOV18M1swLTJdKSkkJyxcbiAgICAgICAgJ1ZMQU5fUkVHRVgnIDogJ14oWzAtOV17MSw0fT8tWzAtOV17MSw0fT8pJCcsXG4gICAgICAgICdWWExBTl9SRUdFWCcgOiAnXihbMC05XXsxLDh9Py1bMC05XXsxLDh9PykkJyxcbiAgICAgICAgJ05VTUJFUl9SRUdFWCcgOiAnXlswLTldKiQnXG4gICAgfVxufSkoKTtcblxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbi8qKlxuICogVGhlIERhdGFTb3VyY2UgdXNlZCBmb3IgdGhlIHZpc3VhbGl6YXRpb24gdGFiLlxuICogXG4gKiBOb2RlIERhdGEgZnJvbSB0aGUgc2VydmVyIGlzIGV4cGVjdGVkIHRvIGJlIGluIHRoZSBmb2xsb3dpbmcgZm9ybWF0OlxuICoge2lkOiBub2RlX2lkLCB0ZXh0OiBub2RlX3RleHR9XG4gKiBQYXJlbnQgYW5kIEFuY2VzdG9yIGF0dHJpYnV0ZXMgY2FuIGJlIHNldCBieSBjYWxsaW5nIHNldEFuY2VzdG9yc1xuICogXG4gKiBMaW5rIERhdGEgZnJvbSB0aGUgc2VydmVyIGlzIGV4cGVjdGVkIHRvIGJlIGluIHRoZSBmb2xsb3dpbmcgZm9ybWF0OlxuICoge3NvdXJjZTogc291cmNlTm9kZUlkLCB0YXJnZXQ6IHRhcmdldE5vZGVJZCwgd2VpZ2h0OiBsaW5rV2VpZ2h0fVxuICogXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdWaXN1YWxpemVyRGF0YVNvdXJjZScsIFsnRGF0YVNvdXJjZScsICdWaXN1YWxpemVyTm9kZScsICdWaXN1YWxpemVyTGluaycsIGZ1bmN0aW9uIChEYXRhU291cmNlLCBWaXN1YWxpemVyTm9kZSwgVmlzdWFsaXplckxpbmspIHtcblx0dmFyIFZpc3VhbGl6ZXJEYXRhU291cmNlID0gZnVuY3Rpb24gKF9EYXRhU291cmNlJERhdGFTb3VyYykge1xuXHRcdF9pbmhlcml0cyhWaXN1YWxpemVyRGF0YVNvdXJjZSwgX0RhdGFTb3VyY2UkRGF0YVNvdXJjKTtcblxuXHRcdC8qKlxuICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAqIFxuICAgKiBDaGlsZHJlbiBTdHJ1Y3QgYW5kIGFuY2VzdG9yc19zdHJ1Y3QgYXJlIEpTT04gb2JqZWN0cyxcbiAgICogbWFwcGluZyBhIG5vZGUgSWQgdG8gYSBsaXN0IG9mIGl0J3MgY2hpbGRyZW4gb3IgYW5jZXN0b3JzLlxuICAgKiBDaGlsZHJlbiBTdHJ1Y3QgaXMgYWxzbyBleHBlY3RlZCB0byBoYXZlIGEgZmllbGQgY2FsbGVkXG4gICAqIHRvcExldmVsLCB0aGF0IG1hcHMgdG8gYSBsaXN0IG9mIGFsbCB0aGUgbm9kZXMgdGhhdCBkb24ndFxuICAgKiBoYXZlIGFueSBwYXJlbnRzLlxuICAgKlxuICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgbm9kZXMgICAgICAgICAgICAgIFRoZSBub2RlIGRhdGEgXG4gICAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBsaW5rcyAgICAgICAgICAgICAgVGhlIGxpbmsgZGF0YVxuICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgY2hpbGRyZW5fc3RydWN0ICAgIFRoZSBjaGlsZHJlbiBzdHJ1Y3R1cmVcbiAgICogQHBhcmFtICAgICAge09iamVjdH0gIGFuY2VzdG9yc19zdHJ1Y3QgICBUaGUgYW5jZXN0b3JzIHN0cnVjdHVyZVxuICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgbGFiZWxzICAgICAgICAgICAgIFRoZSBsYWJlbHNcbiAgICogQHBhcmFtICAgICAge0FycmF5fSAgIHNlbGVjdG9ycyAgICAgICAgICBUaGUgc2VsZWN0b3JzXG4gICAqL1xuXHRcdGZ1bmN0aW9uIFZpc3VhbGl6ZXJEYXRhU291cmNlKG5vZGVzLCBsaW5rcywgY2hpbGRyZW5fc3RydWN0LCBhbmNlc3RvcnNfc3RydWN0LCBsYWJlbHMsIHNlbGVjdG9ycykge1xuXHRcdFx0X2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZpc3VhbGl6ZXJEYXRhU291cmNlKTtcblxuXHRcdFx0dmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgT2JqZWN0LmdldFByb3RvdHlwZU9mKFZpc3VhbGl6ZXJEYXRhU291cmNlKS5jYWxsKHRoaXMsIG5vZGVzLCBsaW5rcykpO1xuXG5cdFx0XHRfdGhpcy5jaGlsZHJlbl9zdHJ1Y3QgPSBjaGlsZHJlbl9zdHJ1Y3Q7XG5cdFx0XHRfdGhpcy5hbmNlc3RvcnNfc3RydWN0ID0gYW5jZXN0b3JzX3N0cnVjdDtcblx0XHRcdF90aGlzLmxhYmVscyA9IGxhYmVscztcblx0XHRcdF90aGlzLnNlbGVjdG9ycyA9IHNlbGVjdG9ycztcblx0XHRcdHJldHVybiBfdGhpcztcblx0XHR9XG5cblx0XHQvKipcbiAgICogRGV0ZXJtaW5lcyBpZiBpdCBoYXMgY2hpbGQuXG4gICAqXG4gICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICAgaWQgICAgICBUaGUgaWRlbnRpZmllclxuICAgKiBAcmV0dXJuICAgICB7Ym9vbGVhbn0gIFRydWUgaWYgaGFzIGNoaWxkLCBGYWxzZSBvdGhlcndpc2UuXG4gICAqL1xuXG5cblx0XHRfY3JlYXRlQ2xhc3MoVmlzdWFsaXplckRhdGFTb3VyY2UsIFt7XG5cdFx0XHRrZXk6ICdoYXNDaGlsZCcsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gaGFzQ2hpbGQoaWQpIHtcblx0XHRcdFx0aWYgKHRoaXMuY2hpbGRyZW5fc3RydWN0W2lkXSA9PSBudWxsKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIFNldHMgdGhlIHBhcmVudCBhbmQgYW5jZXN0b3JzIGF0dHJpYnV0ZSB1c2luZyBcbiAgICAqIGFuY2VzdG9yc19zdHJ1Y3QgZm9yIGFsbCB0aGUgbm9kZXNcbiAgICAqIEFsc28gYWRkcyBhbnkgbm9kZXMgd2l0aG91dCBhbmNlc3RvcnMsIHRoYXQgYXJlbid0IFxuICAgICogdG9wbGV2ZWwgdG8gdGhlIGNsaWVudCBzZXJ2aWNlLlxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdzZXRBbmNlc3RvcnMnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHNldEFuY2VzdG9ycygpIHtcblx0XHRcdFx0dmFyIHRoaXNEYXRhU291cmNlID0gdGhpcztcblx0XHRcdFx0dmFyIGFkZGVkQ2xpZW50ID0gZmFsc2U7XG5cdFx0XHRcdF8uZm9yRWFjaCh0aGlzRGF0YVNvdXJjZS5ub2RlcywgZnVuY3Rpb24gKG5vZGUpIHtcblx0XHRcdFx0XHRub2RlLmFuY2VzdG9ycyA9IHRoaXNEYXRhU291cmNlLmFuY2VzdG9yc19zdHJ1Y3Rbbm9kZS5pZF0gfHwgW107XG5cdFx0XHRcdFx0aWYgKF8uaXNFbXB0eShub2RlLmFuY2VzdG9ycykgPT09IGZhbHNlKSB7XG5cdFx0XHRcdFx0XHRub2RlLnBhcmVudCA9IG5vZGUuYW5jZXN0b3JzWzBdO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRpZiAoXy5pbmNsdWRlcyh0aGlzRGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwsIG5vZGUuaWQpID09IGZhbHNlKSB7XG5cdFx0XHRcdFx0XHRcdC8vY29udGFpbmVyIGhhcyBubyBwYXJlbnRcblx0XHRcdFx0XHRcdFx0Ly9hZGRpbmcgdG8gY2xpZW50XG5cdFx0XHRcdFx0XHRcdG5vZGUuYW5jZXN0b3JzLnB1c2goXCJjbGllbnRcIik7XG5cdFx0XHRcdFx0XHRcdHRoaXNEYXRhU291cmNlLmFuY2VzdG9yc19zdHJ1Y3Rbbm9kZS5pZF0gPSBbXCJjbGllbnRcIl07XG5cdFx0XHRcdFx0XHRcdGlmIChhZGRlZENsaWVudCA9PT0gZmFsc2UpIHtcblx0XHRcdFx0XHRcdFx0XHRhZGRlZENsaWVudCA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdFx0dGhpc0RhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0LnRvcExldmVsLnB1c2goXCJjbGllbnRcIik7XG5cdFx0XHRcdFx0XHRcdFx0dGhpc0RhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0WydjbGllbnQnXSA9IFtdO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdHRoaXNEYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFsnY2xpZW50J10ucHVzaChub2RlLmlkKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIFJldHVybnMgdGhlIGZsb3cgYmV0d2VlbiB0aGUgaGlnaGVzdCBsZXZlbCBncm91cGluZ1xuICAgICpcbiAgICAqIEByZXR1cm4gICAgIHtPYmplY3R9ICBUaGUgdG9wIGxldmVsIGZsb3cuXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ2dldFRvcExldmVsRmxvdycsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gZ2V0VG9wTGV2ZWxGbG93KCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5nZXRGbG93QmV0d2VlblNldCh0aGlzLmNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbCk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogR2V0cyB0aGUgZmxvdyBiZXR3ZWVuIGFueSBzZXQgb2Ygbm9kZSBsZXZlbHNcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlX25hbWVzICBUaGUgbm9kZSBuYW1lcyBpbiB0aGUgc2V0XG4gICAgKiBAcmV0dXJuICAgICB7T2JqZWN0fSAgVGhlIGZsb3cgYmV0d2VlbiBzZXQuXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ2dldEZsb3dCZXR3ZWVuU2V0Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBnZXRGbG93QmV0d2VlblNldChub2RlX25hbWVzKSB7XG5cdFx0XHRcdHZhciBsb2NhbF9ub2RlcyA9IHRoaXMubm9kZXM7XG5cdFx0XHRcdHZhciBpZE1hcHBpbmcgPSB7fTtcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBsb2NhbF9ub2Rlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdHZhciBub2RlID0gbG9jYWxfbm9kZXNbaV07XG5cblx0XHRcdFx0XHQvL2lmIG5vZGUgaXMgYWxyZWFkeSBhdCBpdHMgaGlnaGVzdCBsZXZlbFxuXHRcdFx0XHRcdGlmIChub2RlLmFuY2VzdG9ycyA9PT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0aWRNYXBwaW5nW25vZGUuaWRdID0gbm9kZS5uYW1lO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHQvL2NoZWNrIHRvIHNlZSB3aGljaCB0YWdzIGFyZSBwcmVzZW50IGluIHRoZSBhbmNlc3RvciBsaXN0XG5cdFx0XHRcdFx0XHRmb3IgKHZhciBqID0gMDsgaiA8IG5vZGVfbmFtZXMubGVuZ3RoOyBqKyspIHtcblx0XHRcdFx0XHRcdFx0aWYgKG5vZGUuYW5jZXN0b3JzLmluZGV4T2Yobm9kZV9uYW1lc1tqXSkgPiAtMSkge1xuXHRcdFx0XHRcdFx0XHRcdGlkTWFwcGluZ1tub2RlLmlkXSA9IG5vZGVfbmFtZXNbal07XG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0Ly9tb2RpZnkgbGlua3Ncblx0XHRcdFx0dmFyIGxpbmtzID0gdGhpcy5saW5rcztcblx0XHRcdFx0dmFyIGxpbmtEYXRhID0gW107XG5cblx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBsaW5rcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdHZhciBsaW5rID0gW107XG5cdFx0XHRcdFx0bGluay5zb3VyY2UgPSBpZE1hcHBpbmdbbGlua3NbaV0uc291cmNlXSB8fCBsaW5rc1tpXS5zb3VyY2U7XG5cdFx0XHRcdFx0bGluay50YXJnZXQgPSBpZE1hcHBpbmdbbGlua3NbaV0udGFyZ2V0XSB8fCBsaW5rc1tpXS50YXJnZXQ7XG5cdFx0XHRcdFx0bGluay53ZWlnaHQgPSBsaW5rc1tpXS53ZWlnaHQ7XG5cdFx0XHRcdFx0bGlua0RhdGEucHVzaChsaW5rKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vY3JlYXRpbmcgdGhlIG5vZGVEYXRhXG5cdFx0XHRcdHZhciBub2RlRGF0YSA9IFtdO1xuXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVfbmFtZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHR2YXIgbm9kZV90b19hZGQgPSBbXTtcblx0XHRcdFx0XHRub2RlX3RvX2FkZC5pZCA9IG5vZGVfbmFtZXNbaV07XG5cdFx0XHRcdFx0bm9kZV90b19hZGQudGV4dCA9IHRoaXMubm9kZUlkVG9OYW1lKG5vZGVfbmFtZXNbaV0pIHx8IG5vZGVfbmFtZXNbaV07XG5cblx0XHRcdFx0XHRub2RlX3RvX2FkZC5hbmNlc3RvcnMgPSB0aGlzLmFuY2VzdG9yc19zdHJ1Y3Rbbm9kZV9uYW1lc1tpXV0gfHwgdGhpcy5hbmNlc3RvcnNfc3RydWN0W25vZGVfdG9fYWRkLnRleHRdIHx8IFtdO1xuXHRcdFx0XHRcdGlmIChfLmlzRW1wdHkobm9kZV90b19hZGQuYW5jZXN0b3JzKSA9PT0gZmFsc2UpIHtcblx0XHRcdFx0XHRcdG5vZGVfdG9fYWRkLnBhcmVudCA9IG5vZGVfdG9fYWRkLmFuY2VzdG9yc1swXTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0bm9kZV90b19hZGQucGFyZW50ID0gbnVsbDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0bm9kZURhdGEucHVzaChub2RlX3RvX2FkZCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4geyBub2RlRGF0YTogbm9kZURhdGEsIGxpbmtEYXRhOiBsaW5rRGF0YSB9O1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIHByb2Nlc3MgdGhlIG5vZGVEYXRhIG91dHB1dCBvZiBnZXRGbG93QmV0d2VlblNldFxuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVEYXRhICBOb2RlRGF0YSB0byBjb252ZXJ0IFxuICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIG5vZGUgb2JqZWN0c1xuICAgICogQHJldHVybiAgICAge0FycmF5fSAgTm9kZSBvYmplY3RzXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3Byb2Nlc3NOb2RlRGF0YScsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gcHJvY2Vzc05vZGVEYXRhKG5vZGVEYXRhKSB7XG5cdFx0XHRcdHZhciBub2RlcyA9IFtdO1xuXHRcdFx0XHRfLmZvckVhY2gobm9kZURhdGEsIGZ1bmN0aW9uIChkYXRhKSB7XG5cdFx0XHRcdFx0dmFyIG5ld05vZGUgPSBuZXcgVmlzdWFsaXplck5vZGUuTm9kZShudWxsLCBudWxsLCBkYXRhLmlkLCBkYXRhLnRleHQsIG51bGwsIGRhdGEucGFyZW50LCBkYXRhLmFuY2VzdG9ycywgbnVsbCwgbnVsbCk7XG5cdFx0XHRcdFx0bm9kZXMucHVzaChuZXdOb2RlKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdHJldHVybiBub2Rlcztcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBwcm9jZXNzIHRoZSBsaW5rRGF0YSBvdXRwdXQgb2YgZ2V0Rmxvd0JldHdlZW5TZXRcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBsaW5rRGF0YSAgVGhlIGxpbmsgZGF0YVxuICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZXMgICAgIFRoZSBub2Rlc1xuICAgICogQHJldHVybiAgICAge0FycmF5fSAgTGluayBvYmplY3RzXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3Byb2Nlc3NMaW5rRGF0YScsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gcHJvY2Vzc0xpbmtEYXRhKGxpbmtEYXRhLCBub2Rlcykge1xuXHRcdFx0XHQvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBub2RlIHRoYXQgbWF0Y2hlcyB0aGUgaWRcbiAgICAgKlxuICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9IGlkICAgICAgVGhlIGlkZW50aWZpZXJcbiAgICAgKiBAcmV0dXJuICAgICB7Tm9kZX0gICBUaGUgbm9kZSB3aXRoIHRoZSBtYXRjaGluZyBpZFxuICAgICAqL1xuXHRcdFx0XHRmdW5jdGlvbiBmaW5kTm9kZUJ5SWQoaWQsIG5vZGVzKSB7XG5cdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0aWYgKGlkID09IG5vZGVzW2ldLmlkKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBub2Rlc1tpXTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR2YXIgbGlua3MgPSBbXTtcblx0XHRcdFx0Ly9hIG1hcHBpbmcgZnJvbSBzb3VyY2UuaWQtdGFyZ2V0LmlkIHRvIHRoZSBsaW5rIGFkZGVkXG5cdFx0XHRcdHZhciBhZGRlZF9saW5rcyA9IHt9O1xuXHRcdFx0XHQvL3RyYW5zZm9ybWluZyBsaW5rIGRhdGFcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBsaW5rRGF0YS5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdGlmIChsaW5rRGF0YVtpXS5zb3VyY2UgIT0gbGlua0RhdGFbaV0udGFyZ2V0KSB7XG5cdFx0XHRcdFx0XHR2YXIgc291cmNlID0gZmluZE5vZGVCeUlkKGxpbmtEYXRhW2ldLnNvdXJjZSwgbm9kZXMpO1xuXHRcdFx0XHRcdFx0dmFyIHRhcmdldCA9IGZpbmROb2RlQnlJZChsaW5rRGF0YVtpXS50YXJnZXQsIG5vZGVzKTtcblx0XHRcdFx0XHRcdHZhciB3ZWlnaHQgPSBsaW5rRGF0YVtpXS53ZWlnaHQ7XG5cdFx0XHRcdFx0XHQvL2luIG9yZGVyIHRvIHN1bSBhbGwgdGhlIHdlaWdodHMgb2YgdGhlIGxpbmtzIG9mIHRoZSBzdWItbm9kZXMsXG5cdFx0XHRcdFx0XHQvL3dlIHVzZSBhZGRlZF9saW5rcyB0byBrZWVwIHRyYWNrIGlmIGFuIGxpbmsgd2FzIGFkZGVkXG5cdFx0XHRcdFx0XHQvL2lmIGl0IGlzLCB3ZSBtb2RpZnkgaXRzIHdlaWdodFxuXHRcdFx0XHRcdFx0aWYgKHNvdXJjZSA9PSBudWxsIHx8IHRhcmdldCA9PSBudWxsKSB7XG5cdFx0XHRcdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0aWYgKGFkZGVkX2xpbmtzW3NvdXJjZS5pZCArICctJyArIHRhcmdldC5pZF0gPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdFx0XHR2YXIgbGluayA9IG5ldyBWaXN1YWxpemVyTGluay5MaW5rKHNvdXJjZSwgdGFyZ2V0LCB3ZWlnaHQpO1xuXHRcdFx0XHRcdFx0XHRhZGRlZF9saW5rc1tzb3VyY2UuaWQgKyAnLScgKyB0YXJnZXQuaWRdID0gbGluaztcblx0XHRcdFx0XHRcdFx0bGlua3MucHVzaChsaW5rKTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdHZhciBleGlzdGluZ19saW5rID0gYWRkZWRfbGlua3Nbc291cmNlLmlkICsgJy0nICsgdGFyZ2V0LmlkXTtcblx0XHRcdFx0XHRcdFx0ZXhpc3RpbmdfbGluay5zZXRXZWlnaHQoZXhpc3RpbmdfbGluay5nZXRSYXdXZWlnaHQoKSArIHdlaWdodCk7XG5cdFx0XHRcdFx0XHRcdGV4aXN0aW5nX2xpbmsuaW5jcmVhc2VDb3VudCgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gbGlua3M7XG5cdFx0XHR9XG5cdFx0fV0pO1xuXG5cdFx0cmV0dXJuIFZpc3VhbGl6ZXJEYXRhU291cmNlO1xuXHR9KERhdGFTb3VyY2UuRGF0YVNvdXJjZSk7XG5cblx0cmV0dXJuIHtcblx0XHREYXRhU291cmNlOiBWaXN1YWxpemVyRGF0YVNvdXJjZVxuXHR9O1xufV0pO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnV0aWxzJywgW10pO1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4vKipcbiAqIFRoZSBiYXNlIGNsYXNzIHRoZSBncmFwaCBvYmplY3QuIEFueSBub2RlcyBvciBsaW5rcyB0aGF0IGFyZSBjb250YWluZWQgaW5cbiAqIGl0cyBub2RlcyBvciBsaW5rcyBwcm9wZXJ0eSB3aWxsIGJlIGRyYXduIG9uIHVwZGF0ZUdyYXBoLlxuICogU3VwcG9ydHMgcG9saWNpZXMuXG4gKiBcbiAqIFRvIHdyaXRlIHlvdXIgb3duIGdyYXBoIG9iamVjdCwgY3JlYXRlIGEgbmV3IGZhY3RvcnkgdGhhdCB1c2VzIHRoZSBncmFwaFxuICogeW91IHdhbnQgdG8gaW5oZXJpdCBhcyBhIGRlcGVuZGVuY3ksIGFuZCBleHRlbmQgaXRzIGdyYXBoIGNsYXNzLiBcbiAqIFJldHVybiB0aGUgY2xhc3Mgb2JqZWN0IHdpdGggR3JhcGggYXMga2V5LlxuICogXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdHcmFwaCcsIFsnUG9saWN5U2VydmljZScsIGZ1bmN0aW9uIChQb2xpY3lTZXJ2aWNlKSB7XG4gICAgdmFyIEdyYXBoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvKipcbiAgICAgICAgICogY29uc3RydWN0b3IgZm9yIHRoZSBncmFwaFxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBTVkd9ICBzdmcgICAgIFRoZSBzdmcgdGhhdCB3aWxsIFxuICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvbGQgdGhlIGdyYXBoXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVzICAgICAgTGlzdCBvZiBub2RlcyBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIGxpbmtzICAgICAgTGlzdCBvZiBsaW5rcyBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBHcmFwaChzdmcsIG5vZGVzLCBsaW5rcykge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEdyYXBoKTtcblxuICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlcyA9IG5vZGVzIHx8IFtdO1xuICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzID0gbGlua3MgfHwgW107XG5cbiAgICAgICAgICAgIHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzID0gW107XG4gICAgICAgICAgICB0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcyA9IFtdO1xuXG4gICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5ID0gbmV3IFBvbGljeVNlcnZpY2UuUG9saWN5KCk7XG5cbiAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZSA9IHtcbiAgICAgICAgICAgICAgICBjYW5ab29tOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNhblBhbjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpbml0Rm9yY2U6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGRpc2FibGVVcGRhdGU6IGZhbHNlXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0aGlzR3JhcGguY29uc3RzID0ge1xuICAgICAgICAgICAgICAgIGNpcmNsZUdDbGFzczogXCJjb25jZXB0R1wiLFxuICAgICAgICAgICAgICAgIGdyYXBoQ2xhc3M6IFwiZ3JhcGhcIixcbiAgICAgICAgICAgICAgICBwYXRoQ2xhc3M6IFwicGF0aFwiLFxuICAgICAgICAgICAgICAgIG5vZGVDbGFzczogXCJjaXJjbGVcIixcbiAgICAgICAgICAgICAgICBub2RlVGV4dDogXCJub2RlVGV4dFwiLFxuICAgICAgICAgICAgICAgIHN0YXJ0UmFkaXVzOiA1MCxcbiAgICAgICAgICAgICAgICBtYXhSYWRpdXM6IDYwLFxuICAgICAgICAgICAgICAgIHBhZGRpbmc6IDUsXG4gICAgICAgICAgICAgICAgZGlzcGxheU9mZnNldDogNjBcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHN2Zy5vbihcIm1vdXNlb3ZlclwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3lbXCJtb3VzZW92ZXJcIl0uY2FsbCh0aGlzLCBkKTtcbiAgICAgICAgICAgIH0pLm9uKFwiZGJsY2xpY2tcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wiZGJsY2xpY2tcIl0uY2FsbCh0aGlzLCBkKTtcbiAgICAgICAgICAgIH0pLm9uKFwiY29udGV4dG1lbnVcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wiY29udGV4dG1lbnVcIl0uY2FsbCh0aGlzLCBkKTtcbiAgICAgICAgICAgIH0pLm9uKFwibW91c2VvdXRcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wibW91c2VvdXRcIl0uY2FsbCh0aGlzLCBkKTtcbiAgICAgICAgICAgIH0pLm9uKFwibW91c2Vkb3duXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcIm1vdXNlZG93blwiXS5jYWxsKHRoaXMsIGQpO1xuICAgICAgICAgICAgfSkub24oXCJtb3VzZXVwXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcIm1vdXNldXBcIl0uY2FsbCh0aGlzLCBkKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBkZWZpbmUgYXJyb3cgbWFya2VycyBmb3IgZ3JhcGggbGlua3NcbiAgICAgICAgICAgIHZhciBkZWZzID0gc3ZnLmFwcGVuZCgnc3ZnOmRlZnMnKTtcbiAgICAgICAgICAgIGRlZnMuYXBwZW5kKCdzdmc6bWFya2VyJykuYXR0cignaWQnLCAnZW5kLWFycm93JykuYXR0cihcInZpZXdCb3hcIiwgXCIwIC01IDEwIDEwXCIpLmF0dHIoXCJyZWZYXCIsIDIwKS5hdHRyKFwicmVmWVwiLCAtMSkuYXR0cihcIm1hcmtlcldpZHRoXCIsIDYpLmF0dHIoXCJtYXJrZXJIZWlnaHRcIiwgNikuYXR0cihcIm9yaWVudFwiLCBcImF1dG9cIikuYXBwZW5kKFwicGF0aFwiKS5hdHRyKFwiZFwiLCBcIk0wLC01TDEwLDBMMCw1XCIpO1xuXG4gICAgICAgICAgICAvLyBkZWZpbmUgYXJyb3cgbWFya2VycyBmb3IgbGVhZGluZyBhcnJvd1xuICAgICAgICAgICAgZGVmcy5hcHBlbmQoJ3N2ZzptYXJrZXInKS5hdHRyKCdpZCcsICdtYXJrLWVuZC1hcnJvdycpLmF0dHIoJ3ZpZXdCb3gnLCAnMCAtNSAxMCAxMCcpLmF0dHIoJ3JlZlgnLCA3KS5hdHRyKCdtYXJrZXJXaWR0aCcsIDMuNSkuYXR0cignbWFya2VySGVpZ2h0JywgMy41KS5hdHRyKCdvcmllbnQnLCAnYXV0bycpLmFwcGVuZCgnc3ZnOnBhdGgnKS5hdHRyKCdkJywgJ00wLC01TDEwLDBMMCw1Jyk7XG5cbiAgICAgICAgICAgIHRoaXNHcmFwaC5zdmcgPSBzdmc7XG4gICAgICAgICAgICB0aGlzR3JhcGguc3ZnRyA9IHN2Zy5hcHBlbmQoXCJnXCIpLmNsYXNzZWQodGhpc0dyYXBoLmNvbnN0cy5ncmFwaENsYXNzLCB0cnVlKTtcbiAgICAgICAgICAgIHZhciBzdmdHID0gdGhpc0dyYXBoLnN2Z0c7XG5cbiAgICAgICAgICAgIC8vIHN2ZyBub2RlcyBhbmQgbGlua3MgXG4gICAgICAgICAgICB0aGlzR3JhcGgucGF0aHMgPSBzdmdHLmFwcGVuZChcImdcIikuc2VsZWN0QWxsKFwiZ1wiKTtcbiAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzID0gc3ZnRy5hcHBlbmQoXCJnXCIpLnNlbGVjdEFsbChcImdcIik7XG4gICAgICAgICAgICB0aGlzR3JhcGguaW5pdE5vZGVzKCk7XG4gICAgICAgICAgICB0aGlzR3JhcGguaW5pdExpbmtzKCk7XG5cbiAgICAgICAgICAgIHRoaXNHcmFwaC5zZXRQb3NpdGlvbnMoKTtcbiAgICAgICAgICAgIHZhciByZXNpemVGdW5jID0gZnVuY3Rpb24gcmVzaXplRnVuYygpIHtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgub25XaW5kb3dSZXNpemUoc3ZnKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHRoaXNHcmFwaC5iaW5kaW5ncyA9IHtcbiAgICAgICAgICAgICAgICByZXNpemU6IHJlc2l6ZUZ1bmNcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAkKHdpbmRvdykucmVzaXplKHJlc2l6ZUZ1bmMpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIGNhbGxzIHRoZSBkZXN0cm95IG1ldGhvZCBmb3IgYWxsIHBvbGljaWVzXG4gICAgICAgICAqL1xuXG5cbiAgICAgICAgX2NyZWF0ZUNsYXNzKEdyYXBoLCBbe1xuICAgICAgICAgICAga2V5OiAnZGVzdHJveScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5LmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5LmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5LmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gdGhpc0dyYXBoLmJpbmRpbmdzKSB7XG4gICAgICAgICAgICAgICAgICAgICQod2luZG93KS5vZmYoa2V5LCB0aGlzR3JhcGguYmluZGluZ3Nba2V5XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJ1bnMgdGhlIGluaXQgZnVuY3Rpb24gZm9yIGFsbCB0aGUgbm9kZXNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2luaXROb2RlcycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdE5vZGVzKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJ1bnMgdGhlIGluaXQgZnVuY3Rpb24gZm9yIGFsbCB0aGUgbGlua3NcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2luaXRMaW5rcycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdExpbmtzKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubGlua3MsIGZ1bmN0aW9uIChsaW5rKSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmsuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIHJldHVybnMgdGhlIG5vZGUgbWF0Y2hpbmcgdGhlIGlkLCBcbiAgICAgICAgICAgICAqIG9yIHVuZGVmaW5lZCBpZiB0aGVyZSBpcyBub25lXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGlkICAgICAgVGhlIGlkZW50aWZpZXJcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtOb2RlfSAgeyBtYXRjaGluZyBub2RlIH1cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2ZpbmROb2RlQnlJZCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZmluZE5vZGVCeUlkKGlkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSB0aGlzR3JhcGgubm9kZXNbaV0uaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzR3JhcGgubm9kZXNbaV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2ZpbmREM05vZGUnLFxuXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmV0dXJucyB0aGUgZDNOb2RlIG9iamVjdCB0aGF0IG1hdGNoZXMgdGhlIGlkLFxuICAgICAgICAgICAgICogb3IgdW5kZWZpbmVkIGlmIHRoZXJlIGlzIG5vbmVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgaWQgICAgICBUaGUgaWRlbnRpZmllclxuICAgICAgICAgICAgICogQHJldHVybiAgICAge0QzTm9kZX0gVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmREM05vZGUoaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgZDNOb2RlO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2goZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuaWQgPT09IGlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkM05vZGUgPSBkMy5zZWxlY3QodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZDNOb2RlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVzZWQgdG8gaW5zdGFsbCBhIGRyYWcgcG9saWN5IHRoYXQgd2lsbCBiZSBjYWxsZWRcbiAgICAgICAgICAgICAqIHdoZW4gbm9kZXMgYXJlIGRyYWdnZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7ZDMuYmVoYXZpb3IuZHJhZ30gIGQzZHJhZyAgRDMgZHJhZyBvYmplY3RcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2luc3RhbGxEcmFnUG9saWN5JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbnN0YWxsRHJhZ1BvbGljeShkM2RyYWcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRyYWcgPSBkM2RyYWc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byBpbnN0YWxsIGEgcG9saWN5IHRoYXQgd2lsbCBiZSBjYWxsZWQgXG4gICAgICAgICAgICAgKiB3aGVuIHRoZXJlIGlzIG1vdXNlIGludGVyYWN0aW9ucyB3aXRoIHRoZSBncmFwaCdzIHN2Z1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3kgIFRoZSBwb2xpY3kgdG8gaW5zdGFsbFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnaW5zdGFsbFN2Z1BvbGljeScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5zdGFsbFN2Z1BvbGljeShwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN2Z1BvbGljeSA9IHBvbGljeTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIGluc3RhbGwgcG9saWNpZXMgdGhhdCBhcmUgY2FsbGVkIHdoZW4gdGhlcmUgaXNcbiAgICAgICAgICAgICAqIG1vdXNlIGludGVyYWN0aW9uIHdpdGggYSBub2RlXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeSAgVGhlIHBvbGljeSB0byBpbnN0YWxsXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdpbnN0YWxsRGVmYXVsdE5vZGVQb2xpY3knLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluc3RhbGxEZWZhdWx0Tm9kZVBvbGljeShwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcy5wdXNoKHBvbGljeSk7XG4gICAgICAgICAgICAgICAgcG9saWN5LmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIHJlbW92ZSBhbiBpbnN0YWxsZWQgcG9saWN5IGZvciBub2Rlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgcG9saWN5UmVtb3ZlICBUaGUgcG9saWN5IHRvIHJlbW92ZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAndW5pbnN0YWxsRGVmYXVsdE5vZGVQb2xpY3knLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVuaW5zdGFsbERlZmF1bHROb2RlUG9saWN5KHBvbGljeVJlbW92ZSkge1xuICAgICAgICAgICAgICAgIHZhciBwb2xpY3lSZW1vdmVOYW1lO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcG9saWN5UmVtb3ZlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmUucG9saWN5TmFtZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5LCBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9saWN5LnBvbGljeU5hbWUgPT09IHBvbGljeVJlbW92ZU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmV0dXJucyB0aGUgbm9kZSBwb2xpY3kgb2JqZWN0IHdpdGggdGhlIGdpdmVuIG5hbWVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgcG9saWN5TmFtZSAgVGhlIHBvbGljeSBuYW1lXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7UG9saWN5fSAgcG9saWN5ICAgICAgVGhlIG1hdGNoaW5nIHBvbGljeVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZ2V0Tm9kZVBvbGljeScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Tm9kZVBvbGljeShwb2xpY3lOYW1lKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3ksIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb2xpY3kucG9saWN5TmFtZSA9PT0gcG9saWN5TmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBvbGljeTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVzZWQgdG8gaW5zdGFsbCBwb2xpY2llcyB0aGF0IGFyZSBjYWxsZWQgd2hlbiB0aGVyZSBpcyBhXG4gICAgICAgICAgICAgKiBtb3VzZSBpbnRlcmFjdGlvbiB3aXRoIGEgcGF0aFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3kgIFRoZSBwb2xpY3kgdG8gaW5zdGFsbFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnaW5zdGFsbERlZmF1bHRQYXRoUG9saWN5JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3kocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMucHVzaChwb2xpY3kpO1xuICAgICAgICAgICAgICAgIHBvbGljeS5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byByZW1vdmUgYW4gaW5zdGFsbGVkIHBvbGljeSBmb3IgbGlua3NcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UG9saWN5fSAgcG9saWN5UmVtb3ZlICBUaGUgcG9saWN5IHRvIHJlbW92ZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAndW5pbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3knLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVuaW5zdGFsbERlZmF1bHRQYXRoUG9saWN5KHBvbGljeVJlbW92ZSkge1xuICAgICAgICAgICAgICAgIHZhciBwb2xpY3lSZW1vdmVOYW1lO1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcG9saWN5UmVtb3ZlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmUucG9saWN5TmFtZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5LCBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9saWN5LnBvbGljeU5hbWUgPT09IHBvbGljeVJlbW92ZU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlcmUgaXMgYSBtb3VzZSBpbnRlcmFjdGlvbiB3aXRoIGEgcGF0aFxuICAgICAgICAgICAgICogUHJvcG9nYXRlcyB0aGUgZXZlbnQgdG8gYWxsIGluc3RhbGxlZCBwYXRoIHBvbGljaWVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGV2ZW50ICAgVGhlIGV2ZW50IHR5cGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM29iamVjdH0gIGQzcGF0aCAgVGhlIGQzIHBhdGhcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQYXRofSAgZCAgICAgICBUaGUgbWF0Y2hpbmcgTGluayBvYmplY3RcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3BhdGhQb2xpY3lFdmVudCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcGF0aFBvbGljeUV2ZW50KGV2ZW50LCBkM3BhdGgsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5W2V2ZW50XShkM3BhdGgsIGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZXJlIGlzIGEgbW91c2UgaW50ZXJhY3Rpb24gd2l0aCBhIG5vZGVcbiAgICAgICAgICAgICAqIFByb3BvZ2F0ZXMgdGhlIGV2ZW50IHRvIGFsbCBpbnN0YWxsZWQgbm9kZSBwb2xpY2llc1xuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgZXZlbnQgICBUaGUgZXZlbnQgdHlwZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2Qzb2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BhdGh9ICBkICAgICAgIFRoZSBtYXRjaGluZyBOb2RlIG9iamVjdFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnbm9kZVBvbGljeUV2ZW50JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBub2RlUG9saWN5RXZlbnQoZXZlbnQsIGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcywgZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lbZXZlbnRdKGQzbm9kZSwgZCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU2V0cyBwYW4gYW5kIHpvb20gcnVsZXMgZm9yIHRoZSBncmFwaFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkMy5iZWhhdmlvci56b29tfSAgZDN6b29tICBEMyB6b29tIG9ialxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnaW5zdGFsbFpvb21Qb2xpY3knLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluc3RhbGxab29tUG9saWN5KGQzem9vbSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZHJhZ1N2ZyA9IGQzem9vbTtcbiAgICAgICAgICAgICAgICB0aGlzLnN2Zy5jYWxsKHRoaXMuZHJhZ1N2Zyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIHdpbmRvdyBpcyByZXNpemVkXG4gICAgICAgICAgICAgKiBIb29rIGZvciBvdmVycmlkaW5nIGluIHN1YmNsYXNzZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBTVkd9ICBzdmcgICAgIFRoZSBzdmcgdGhhdCB0aGUgaGFuZGxlclxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpcyBhdHRhY2hlZCB0b1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnb25XaW5kb3dSZXNpemUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uV2luZG93UmVzaXplKHN2Zykge31cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBJbnNlcnRzIGxpbmUgYnJlYWtzIGluIG5vZGUgdGV4dFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtIVE1MIEVsZW19ICBnRWwgICAgVGhlIGVsZW0gdG8gYWRkIHRleHQgdG9cbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICB0aXRsZSAgIFRoZSB0aXRsZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnaW5zZXJ0VGl0bGVMaW5lYnJlYWtzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbnNlcnRUaXRsZUxpbmVicmVha3MoZ0VsLCB0aXRsZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciB3b3JkcyA9IHRpdGxlLnNwbGl0KC9cXHMrL2cpLFxuICAgICAgICAgICAgICAgICAgICBud29yZHMgPSB3b3Jkcy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgdmFyIGVsID0gZ0VsLmFwcGVuZChcInRleHRcIikuYXR0cignY2xhc3MnLCB0aGlzR3JhcGguY29uc3RzLm5vZGVUZXh0KS5hdHRyKFwidGV4dC1hbmNob3JcIiwgXCJtaWRkbGVcIikuYXR0cihcImR5XCIsIFwiLVwiICsgKG53b3JkcyAtIDEpICogNy41KTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgd29yZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRzcGFuID0gZWwuYXBwZW5kKCd0c3BhbicpLnRleHQod29yZHNbaV0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaSA+IDApIHRzcGFuLmF0dHIoJ3gnLCAwKS5hdHRyKCdkeScsICcxNScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmVzIGFsbCBsaW5rcyBmcm9tIHRoZSBnaXZlbiBub2RlXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBub2RlICAgIFRoZSBub2RlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdzcGxpY2VMaW5rc0Zvck5vZGUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNwbGljZUxpbmtzRm9yTm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHRvU3BsaWNlID0gdGhpc0dyYXBoLmxpbmtzLmZpbHRlcihmdW5jdGlvbiAobCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbC5zb3VyY2UgPT09IG5vZGUgfHwgbC50YXJnZXQgPT09IG5vZGU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdG9TcGxpY2UubWFwKGZ1bmN0aW9uIChsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcy5zcGxpY2UodGhpc0dyYXBoLmxpbmtzLmluZGV4T2YobCksIDEpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEFkZHMgdGhlIG5vZGUgdG8gdGhlIGdyYXBoIGFuZCB1cGRhdGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBub2RlICAgIFRoZSBub2RlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdhZGROb2RlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGROb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICBub2RlLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAncmVtb3ZlTm9kZScsXG5cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmVzIHRoZSBub2RlIHRvIHRoZSBncmFwaCBhbmQgdXBkYXRlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlTm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnNwbGljZSh0aGlzR3JhcGgubm9kZXMuaW5kZXhPZihub2RlKSwgMSk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlKTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdhZGRMaW5rJyxcblxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEFkZHMgdGhlIGxpbmsgdG8gdGhlIGdyYXBoIGFuZCB1cGRhdGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2xpbmt9ICBsaW5rICAgIFRoZSBsaW5rXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRMaW5rKGxpbmspIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MucHVzaChsaW5rKTtcbiAgICAgICAgICAgICAgICBsaW5rLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAncmVtb3ZlTGluaycsXG5cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmVzIHRoZSBsaW5rIHRvIHRoZSBncmFwaCBhbmQgdXBkYXRlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtsaW5rfSAgbGluayAgICBUaGUgbGlua1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlTGluayhsaW5rKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzLnNwbGljZSh0aGlzR3JhcGgubGlua3MuaW5kZXhPZihsaW5rKSwgMSk7XG4gICAgICAgICAgICAgICAgbGluay5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIHVwZGF0aW5nIGV4aXN0aW5nIHBhdGhzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BhdGh9ICBwYXRocyAgIExpc3Qgb2YgcGF0aHNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3VwZGF0ZUV4aXN0aW5nUGF0aHMnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUV4aXN0aW5nUGF0aHMocGF0aHMpIHtcbiAgICAgICAgICAgICAgICBwYXRocy5lYWNoKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGQudXBkYXRlQXR0cihkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyBhZGRpbmcgbmV3IHBhdGhzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BhdGh9ICBuZXdQYXRocyAgTGlzdCBvZiBuZXcgcGF0aHNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3VwZGF0ZU5ld1BhdGhzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVOZXdQYXRocyhuZXdQYXRocykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXRMaW5rcygpO1xuXG4gICAgICAgICAgICAgICAgbmV3UGF0aHMuZWFjaChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBkLm5ld1BhdGhBdHRyKGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvL2lmIG5vZGUgZG9lc24ndCBoYXZlIGl0cyBvd24gcG9saWN5LCB1c2UgZGVmYXVsdCBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgICAgbmV3UGF0aHMub24oXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlb3ZlclwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlb3ZlclwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkub24oXCJkYmxjbGlja1wiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQucGF0aFBvbGljeUV2ZW50KFwiZGJsY2xpY2tcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJkYmxjbGlja1wiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkub24oXCJjb250ZXh0bWVudVwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQucGF0aFBvbGljeUV2ZW50KFwiY29udGV4dG1lbnVcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJjb250ZXh0bWVudVwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkub24oXCJtb3VzZW91dFwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQucGF0aFBvbGljeUV2ZW50KFwibW91c2VvdXRcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZW91dFwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkub24oXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlZG93blwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlZG93blwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkub24oXCJtb3VzZXVwXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZXVwXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aFBvbGljeUV2ZW50KFwibW91c2V1cFwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzR3JhcGguZHJhZyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIHVwZGF0aW5nIGV4aXN0aW5nIG5vZGVzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd1cGRhdGVFeGlzdGluZ05vZGVzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVFeGlzdGluZ05vZGVzKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzID0gdGhpcy5jaXJjbGVzLmRhdGEodGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5pZDtcbiAgICAgICAgICAgICAgICB9KS5lYWNoKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGQudXBkYXRlQXR0cihkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyBhZGRpbmcgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBuZXdOb2RlcyAgTGlzdCBvZiBuZXcgbm9kZXNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3VwZGF0ZU5ld05vZGVzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVOZXdOb2RlcyhuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgbmV3Tm9kZXMuZWFjaChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5ncmFwaCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBkLm5ld05vZGVBdHRyKGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvL2lmIG5vZGUgZG9lc24ndCBoYXZlIGl0cyBvd24gcG9saWN5LCB1c2UgZGVmYXVsdCBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgICAgbmV3Tm9kZXMub24oXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlb3ZlclwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlb3ZlclwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkub24oXCJkYmxjbGlja1wiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQubm9kZVBvbGljeUV2ZW50KFwiZGJsY2xpY2tcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlUG9saWN5RXZlbnQoXCJkYmxjbGlja1wiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkub24oXCJjb250ZXh0bWVudVwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQubm9kZVBvbGljeUV2ZW50KFwiY29udGV4dG1lbnVcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlUG9saWN5RXZlbnQoXCJjb250ZXh0bWVudVwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkub24oXCJtb3VzZW91dFwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQubm9kZVBvbGljeUV2ZW50KFwibW91c2VvdXRcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlUG9saWN5RXZlbnQoXCJtb3VzZW91dFwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkub24oXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlZG93blwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlZG93blwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkub24oXCJtb3VzZXVwXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5ub2RlUG9saWN5RXZlbnQoXCJtb3VzZXVwXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwibW91c2V1cFwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzR3JhcGguZHJhZyk7XG5cbiAgICAgICAgICAgICAgICBuZXdOb2Rlcy5hcHBlbmQoXCJjaXJjbGVcIikuYXR0cihcInJcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFN0cmluZyhkLnJhZGl1cyk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBuZXdOb2Rlcy5lYWNoKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbnNlcnRUaXRsZUxpbmVicmVha3MoZDMuc2VsZWN0KHRoaXMpLCBkLnRleHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFByZXZlbnRzIG5vZGVzIGZyb20gY29sbGlkaW5nXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge251bWJlcn0gIGFscGhhICAgQWZmZWN0cyBob3cgbXVjaCBjaGFuZ2VcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZSBjb2xsaXNpb24gY2F1c2VzXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7Ym9vbGVhbn0gIHtXaGV0aGVyIG5vZGVzIGFyZSBjb2xsaWRlZH1cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2QzRm9yY2VDb2xsaWRlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkM0ZvcmNlQ29sbGlkZShhbHBoYSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzO1xuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXNHcmFwaC5ub2RlcztcbiAgICAgICAgICAgICAgICB2YXIgcXVhZHRyZWUgPSBkMy5nZW9tLnF1YWR0cmVlKG5vZGVzKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSBkLnJhZGl1cyArIGNvbnN0cy5tYXhSYWRpdXMgKyBjb25zdHMucGFkZGluZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG54MSA9IGQueCAtIHIsXG4gICAgICAgICAgICAgICAgICAgICAgICBueDIgPSBkLnggKyByLFxuICAgICAgICAgICAgICAgICAgICAgICAgbnkxID0gZC55IC0gcixcbiAgICAgICAgICAgICAgICAgICAgICAgIG55MiA9IGQueSArIHI7XG4gICAgICAgICAgICAgICAgICAgIHF1YWR0cmVlLnZpc2l0KGZ1bmN0aW9uIChxdWFkLCB4MSwgeTEsIHgyLCB5Mikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHF1YWQucG9pbnQgJiYgcXVhZC5wb2ludCAhPT0gZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4ID0gZC54IC0gcXVhZC5wb2ludC54LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ID0gZC55IC0gcXVhZC5wb2ludC55LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsID0gTWF0aC5zcXJ0KHggKiB4ICsgeSAqIHkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByID0gZC5yYWRpdXMgKyBxdWFkLnBvaW50LnJhZGl1cyArIGNvbnN0cy5wYWRkaW5nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsIDwgcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsID0gKGwgLSByKSAvIGwgKiBhbHBoYTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC54IC09IHggKj0gbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55IC09IHkgKj0gbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVhZC5wb2ludC54ICs9IHg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1YWQucG9pbnQueSArPSB5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB4MSA+IG54MiB8fCB4MiA8IG54MSB8fCB5MSA+IG55MiB8fCB5MiA8IG55MTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUaWNrIG9mIHRoZSBkMyBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzdGljayBldmVudH0gIGUgICAgRDN0aWNrIGV2ZW50XG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgd2lkdGggIFRoZSB3aWR0aCBvZiB0aGUgc2ltdWxhdGlvblxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge251bWJlcn0gIGhlaWdodCBUaGUgaGVpZ2h0IG9mIHRoZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkM0ZvcmNlVGljaycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZDNGb3JjZVRpY2soZSwgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzO1xuXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IGNvbnN0cy5kaXNwbGF5T2Zmc2V0O1xuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXNHcmFwaC5ub2RlcztcbiAgICAgICAgICAgICAgICB2YXIgcSA9IGQzLmdlb20ucXVhZHRyZWUodGhpc0dyYXBoLm5vZGVzKSxcbiAgICAgICAgICAgICAgICAgICAgaSA9IDAsXG4gICAgICAgICAgICAgICAgICAgIG4gPSBub2Rlcy5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICB3aGlsZSAoKytpIDwgbikge1xuICAgICAgICAgICAgICAgICAgICBxLnZpc2l0KHRoaXMuZDNGb3JjZUNvbGxpZGUobm9kZXNbaV0pKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5lYWNoKHRoaXMuZDNGb3JjZUNvbGxpZGUoLjUpKS5hdHRyKFwiY3hcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueCA9IE1hdGgubWF4KGQucmFkaXVzICsgb2Zmc2V0LCBNYXRoLm1pbih3aWR0aCAtIG9mZnNldCAtIGQucmFkaXVzLCBkLngpKTtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKFwiY3lcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueSA9IE1hdGgubWF4KGQucmFkaXVzICsgb2Zmc2V0LCBNYXRoLm1pbihoZWlnaHQgLSBvZmZzZXQgLSBkLnJhZGl1cywgZC55KSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHMuYXR0cigneDEnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5zb3VyY2UueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd5MScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnNvdXJjZS55O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3gyJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQudGFyZ2V0Lng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneTInLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC50YXJnZXQueTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTdGFydHMgb24gc3RhcnQgb2YgdGhlIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2QzRm9yY2VTdGFydCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZDNGb3JjZVN0YXJ0KCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocy5hdHRyKCd4MScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnNvdXJjZS54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3kxJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuc291cmNlLnk7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneDInLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC50YXJnZXQueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd5MicsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnRhcmdldC55O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBvbiB0aGUgZW5kIG9mIHRoZSBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkM0ZvcmNlRW5kJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkM0ZvcmNlRW5kKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmF0dHIoJ2N4JywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCdjeScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHMuYXR0cigneDEnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5zb3VyY2UueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd5MScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnNvdXJjZS55O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3gyJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQudGFyZ2V0Lng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneTInLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC50YXJnZXQueTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxjdWxhdGVzIHRoZSB3aWR0aCBhbmQgaGVpZ2h0IGJvdW5kcyBmb3IgdGhlIFxuICAgICAgICAgICAgICogZm9yY2Ugc2ltdWxhdGlvblxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtPYmplY3R9ICB3aWR0aCBhbmQgaGVpZ2h0IGFzIHByb3BlcnRpZXMgXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkM0ZvcmNlQm91bmRzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkM0ZvcmNlQm91bmRzKCkge1xuICAgICAgICAgICAgICAgIHZhciBzdmdXaWR0aCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykud2lkdGgoKTtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnSGVpZ2h0ID0gJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS5oZWlnaHQoKTtcblxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IHN2Z1dpZHRoO1xuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBzdmdIZWlnaHQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgd2lkdGg6IHdpZHRoLCBoZWlnaHQ6IGhlaWdodCB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIERvZXMgYSBkMyBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0Z1bmN0aW9ufSAgY2FsbGJhY2sgIFRoZSBjYWxsYmFja1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnc2V0Rm9yY2UnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldEZvcmNlKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICAgICAgdmFyIGxpbmtzID0gdGhpc0dyYXBoLmxpbmtzO1xuICAgICAgICAgICAgICAgIGlmIChfLmlzRW1wdHkobm9kZXMpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgYm91bmRzID0gdGhpc0dyYXBoLmQzRm9yY2VCb3VuZHMoKTtcblxuICAgICAgICAgICAgICAgIHZhciBmb3JjZSA9IGQzLmxheW91dC5mb3JjZSgpLnNpemUoW2JvdW5kcy53aWR0aCwgYm91bmRzLmhlaWdodF0pLm5vZGVzKG5vZGVzKS5jaGFyZ2UoZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC02MDAwO1xuICAgICAgICAgICAgICAgIH0pLmxpbmtzKGxpbmtzKTtcblxuICAgICAgICAgICAgICAgIGZvcmNlLmxpbmtEaXN0YW5jZShib3VuZHMud2lkdGggLyAzKTtcbiAgICAgICAgICAgICAgICBmb3JjZS5saW5rU3RyZW5ndGgoLjIpO1xuICAgICAgICAgICAgICAgIGZvcmNlLmdyYXZpdHkoLjIpO1xuXG4gICAgICAgICAgICAgICAgZm9yY2Uub24oJ3RpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguZDNGb3JjZVRpY2suY2FsbCh0aGlzR3JhcGgsIGUsIGJvdW5kcy53aWR0aCwgYm91bmRzLmhlaWdodCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBmb3JjZS5vbignc3RhcnQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kM0ZvcmNlU3RhcnQuY2FsbCh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZm9yY2Uub24oJ2VuZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLmQzRm9yY2VFbmQuY2FsbCh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZm9yY2Uuc3RhcnQoKTtcbiAgICAgICAgICAgICAgICB2YXIgayA9IDA7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGZvcmNlLmFscGhhKCkgPiAxZS0yICYmIGsgPCAxNTApIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yY2UudGljaygpO1xuICAgICAgICAgICAgICAgICAgICBrID0gayArIDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvcmNlLnN0b3AoKTtcblxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjayAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNldHMgdGhlIHBvc2l0aW9ucyB0byBiZSB0aGUgY2VudGVyIG9mIHRoZSBzY3JlZW4gaWYgXG4gICAgICAgICAgICAgKiBub3QgcHJvdmlkZWRcbiAgICAgICAgICAgICAqIGFsc28gc2V0cyB0aGUgcmFkaXVzIG9mIHRoZSBub2Rlc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnc2V0UG9zaXRpb25zJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRQb3NpdGlvbnMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gdGhpc0dyYXBoLmNvbnN0cy5kaXNwbGF5T2Zmc2V0O1xuICAgICAgICAgICAgICAgIHZhciBzdmdXaWR0aCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykud2lkdGgoKTtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnSGVpZ2h0ID0gJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS5oZWlnaHQoKTtcblxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IHN2Z1dpZHRoIC0gMiAqIG9mZnNldDtcbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gc3ZnSGVpZ2h0IC0gMiAqIG9mZnNldDtcblxuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXNHcmFwaC5ub2RlcztcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZXNbaV0ucmFkaXVzID0gbm9kZXNbaV0ucmFkaXVzIHx8IHRoaXNHcmFwaC5jb25zdHMuc3RhcnRSYWRpdXM7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2Rlc1tpXS54ID09IG51bGwgfHwgbm9kZXNbaV0ueSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBub2Rlc1tpXS54U3RhcnQgPSB3aWR0aC8yICArIG5vZGVzW2ldLnJhZGl1cyArIG9mZnNldFxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNbaV0ueCA9IHdpZHRoIC8gMiArIG5vZGVzW2ldLnJhZGl1cyArIG9mZnNldDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5vZGVzW2ldLnlTdGFydCA9IGhlaWdodC8yICsgbm9kZXNbaV0ucmFkaXVzICsgb2Zmc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1tpXS55ID0gaGVpZ2h0IC8gMiArIG5vZGVzW2ldLnJhZGl1cyArIG9mZnNldDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgdG8gdXBkYXRlIHRoZSB2aWV3IG9mIHRoZSBncmFwaCB3aGVuXG4gICAgICAgICAgICAgKiBkYXRhIGNoYW5nZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RnVuY3Rpb259ICBjYWxsYmFjayAgVGhlIGNhbGxiYWNrXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd1cGRhdGVHcmFwaCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlR3JhcGgoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGU7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLnN0YXRlLmRpc2FibGVVcGRhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRXhpc3RpbmdOb2RlcygpO1xuICAgICAgICAgICAgICAgIHZhciBuZXdHcyA9IHRoaXNHcmFwaC5jaXJjbGVzLmVudGVyKCkuYXBwZW5kKFwiZ1wiKTtcblxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCd1cGRhdGUnLCBuZXdHcyk7XG4gICAgICAgICAgICAgICAgbmV3R3MuY2xhc3NlZChjb25zdHMuY2lyY2xlR0NsYXNzLCB0cnVlKTtcblxuICAgICAgICAgICAgICAgIC8vIHRoaXMudXBkYXRlTmV3Tm9kZXMobmV3R3MpO1xuXG4gICAgICAgICAgICAgICAgLy8gcmVtb3ZlIG9sZCBub2Rlc1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmV4aXQoKS5yZW1vdmUoKTtcblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5pbml0Rm9yY2UgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNldEZvcmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVOZXdOb2Rlcy5jYWxsKHRoaXNHcmFwaCwgbmV3R3MpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuaW5pdEZvcmNlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZU5ld05vZGVzKG5ld0dzKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHMgPSB0aGlzR3JhcGgucGF0aHMuZGF0YSh0aGlzR3JhcGgubGlua3MsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBTdHJpbmcoZC5zb3VyY2UuaWQpICsgXCIrXCIgKyBTdHJpbmcoZC50YXJnZXQuaWQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciBwYXRocyA9IHRoaXNHcmFwaC5wYXRocztcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUV4aXN0aW5nUGF0aHMocGF0aHMpO1xuXG4gICAgICAgICAgICAgICAgdmFyIG5ld3BhdGhzID0gcGF0aHMuZW50ZXIoKS5hcHBlbmQoXCJwYXRoXCIpLnN0eWxlKCdtYXJrZXItZW5kJywgJ3VybCgjZW5kLWFycm93KScpLmNsYXNzZWQoXCJsaW5rXCIsIHRydWUpO1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlTmV3UGF0aHMobmV3cGF0aHMpO1xuXG4gICAgICAgICAgICAgICAgLy8gcmVtb3ZlIG9sZCBsaW5rc1xuICAgICAgICAgICAgICAgIHBhdGhzLmV4aXQoKS5yZW1vdmUoKTtcblxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjayAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIEdyYXBoO1xuICAgIH0oKTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIEdyYXBoOiBHcmFwaFxuICAgIH07XG59XSk7XG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuLyoqXG4gKiBUaGUgZ3JhcGggdGhhdCBpcyB1c2VkIHNwZWNpZmljYWxseSBmb3IgdGhlIHZpc3VhbGl6YXRpb24gdGFiLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnVmlzdWFsaXplckdyYXBoJywgWydHcmFwaCcsIGZ1bmN0aW9uIChHcmFwaCkge1xuICAgIHZhciBWaXN1YWxpemVyR3JhcGggPSBmdW5jdGlvbiAoX0dyYXBoJEdyYXBoKSB7XG4gICAgICAgIF9pbmhlcml0cyhWaXN1YWxpemVyR3JhcGgsIF9HcmFwaCRHcmFwaCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAge0hUTUwgU1ZHfSAgc3ZnICAgICAgICAgICAgIFRoZSBzdmcgdGhhdCB3aWxsIFxuICAgICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9sZCB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAgICogQHBhcmFtICAge0FycmF5fSAgbm9kZXMgICBcdFx0ICAgIExpc3Qgb2Ygbm9kZXNcbiAgICAgICAgICAgICAgICogQHBhcmFtICAge0FycmF5fSAgbGlua3MgICBcdFx0ICAgIExpc3Qgb2YgbGlua3NcbiAgICAgICAgICogQHBhcmFtICAge0RhdGFTb3VyY2V9ICBkYXRhU291cmNlICAgIFRoZSBkYXRhIHNvdXJjZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gVmlzdWFsaXplckdyYXBoKHN2Zywgbm9kZXMsIGxpbmtzLCBkYXRhU291cmNlKSB7XG4gICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVmlzdWFsaXplckdyYXBoKTtcblxuICAgICAgICAgICAgdmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgT2JqZWN0LmdldFByb3RvdHlwZU9mKFZpc3VhbGl6ZXJHcmFwaCkuY2FsbCh0aGlzLCBzdmcsIG5vZGVzLCBsaW5rcykpO1xuXG4gICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gX3RoaXM7XG5cbiAgICAgICAgICAgIC8vaG9sZHMgY3VycmVudCB0cmFuc2l0aW9ucyB0aGF0IGFyZSBvY2N1cmluZ1xuICAgICAgICAgICAgdGhpc0dyYXBoLnN0YXRlLnRyYW5zaXRpb24gPSBbXTtcbiAgICAgICAgICAgIC8vTWluIGRpc3RhbmNlIGJldHdlZW4gbm9kZXMgd2hlbiBzcGF3bmluZyByYW5kb21seVxuICAgICAgICAgICAgdGhpc0dyYXBoLmNvbnN0cy5lZGdlX2J1ZmZlciA9IDIwMDtcbiAgICAgICAgICAgIC8vU2l6ZSByZWR1Y3Rpb24gYXMgeW91IGdvIHRocm91Z2ggbGV2ZWxzIGluIG5vZGVzXG4gICAgICAgICAgICB0aGlzR3JhcGguY29uc3RzLnJhZGl1c0RlY2F5ID0gMTtcbiAgICAgICAgICAgIC8vQ3NzIGNsYXNzIGZvciBub2RlcyB0aGF0IGFyZSBjb250YWluZXJzXG4gICAgICAgICAgICB0aGlzR3JhcGguY29uc3RzLmNvbnRhaW5lckNsYXNzID0gJ2NvbnRhaW5lcic7XG5cbiAgICAgICAgICAgIC8vZGF0YVNvdXJjZSBob2xkcyB0aGUgc2VydmVyIGRhdGEgYW5kIG1ldGhvZHMgZm9yXG4gICAgICAgICAgICAvL2NvbnZlcnRpbmcgaXQgdG8gZGF0YSBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICB0aGlzR3JhcGguZGF0YVNvdXJjZSA9IGRhdGFTb3VyY2U7XG5cbiAgICAgICAgICAgIC8vRHJhZyBiZWhhdmlvciBmb3Igbm9kZXNcbiAgICAgICAgICAgIHZhciBkcmFnID0gZDMuYmVoYXZpb3IuZHJhZygpLm9yaWdpbihmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHg6IGQueCwgeTogZC55IH07XG4gICAgICAgICAgICB9KS5vbihcImRyYWdzdGFydFwiLCBmdW5jdGlvbiAoKSB7fSkub24oXCJkcmFnXCIsIGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZnVuY3Rpb24gKGQsIGkpIHtcbiAgICAgICAgICAgICAgICAgICAgZC54ICs9IGQzLmV2ZW50LmR4O1xuICAgICAgICAgICAgICAgICAgICBkLnkgKz0gZDMuZXZlbnQuZHk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcInRyYW5zbGF0ZShcIiArIFtkLngsIGQueV0gKyBcIilcIjtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH0pLm9uKFwiZHJhZ2VuZFwiLCBmdW5jdGlvbiAoKSB7fSk7XG5cbiAgICAgICAgICAgIHRoaXNHcmFwaC5kcmFnID0gZHJhZztcblxuICAgICAgICAgICAgLy9QYW4gYW5kIFpvb20gYmVoYXZpb3IgZm9yIHRoZSBncmFwaFxuICAgICAgICAgICAgdmFyIHpvb20gPSBkMy5iZWhhdmlvci56b29tKCkub24oXCJ6b29tXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoZDMuZXZlbnQuc291cmNlRXZlbnQgIT0gbnVsbCAmJiBkMy5ldmVudC5zb3VyY2VFdmVudC5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguem9vbWVkLmNhbGwodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9KS5vbihcInpvb21zdGFydFwiLCBmdW5jdGlvbiAoZCwgaSkge30pO1xuICAgICAgICAgICAgdGhpc0dyYXBoLmRyYWdTdmcgPSB6b29tO1xuICAgICAgICAgICAgdGhpc0dyYXBoLnN2Zy5jYWxsKHpvb20pLm9uKFwiZGJsY2xpY2suem9vbVwiLCBudWxsKTtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYWxsZWQgd2l0aCBubyBhcmdzIHdoZW4gdGhlIGdyYXBoIGhhcyBhIHpvb20gYWN0aW9uXG4gICAgICAgICAqIENhbiBhbHNvIGJlIGNhbGxlZCB3aXRoIGFyZ3MgdG8gZm9yY2UgYSB6b29tIG9yIHBhbiBcbiAgICAgICAgICogZXZlbnQgZm9yIHRoZSBncmFwaC5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgIHRyYW5zbGF0ZSAgVGhlIGFtb3VudCB0byB0cmFuc2xhdGVcbiAgICAgICAgICogQHBhcmFtICAgICAge251bWJlcn0gIHNjYWxlICAgICAgVGhlIGFtb3VudCB0byBzY2FsZVxuICAgICAgICAgKi9cblxuXG4gICAgICAgIF9jcmVhdGVDbGFzcyhWaXN1YWxpemVyR3JhcGgsIFt7XG4gICAgICAgICAgICBrZXk6ICd6b29tZWQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHpvb21lZCh0cmFuc2xhdGUsIHNjYWxlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5zdGF0ZS5yaWdodENsaWNrID09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmp1c3RTY2FsZVRyYW5zR3JhcGggPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmICh0cmFuc2xhdGUgIT0gbnVsbCAmJiBzY2FsZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB6b29tID0gdGhpc0dyYXBoLmRyYWdTdmc7XG4gICAgICAgICAgICAgICAgICAgIHpvb20uc2NhbGUoc2NhbGUpO1xuICAgICAgICAgICAgICAgICAgICB6b29tLnRyYW5zbGF0ZSh0cmFuc2xhdGUpO1xuICAgICAgICAgICAgICAgICAgICAvL2NyZWF0aW5nIG5hbWVzIHRvIHByZXZlbnQgdHJhbnNpdGlvbiBjb25mbGljdHNcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb21TZXRDYWxsYmFjayA9IGZ1bmN0aW9uIHpvb21TZXRDYWxsYmFjaygpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHpvb20uc2NhbGUoc2NhbGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgem9vbS50cmFuc2xhdGUodHJhbnNsYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zbGF0ZV9uYW1lID0gXCJ6b29tXCIgKyB0cmFuc2xhdGU7XG4gICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdChcIi5cIiArIHRoaXMuY29uc3RzLmdyYXBoQ2xhc3MpLnRyYW5zaXRpb24odHJhbnNsYXRlX25hbWUpLmRlbGF5KDEwMCkuZHVyYXRpb24oNzUwKS5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKCcgKyB6b29tLnRyYW5zbGF0ZSgpICsgJykgc2NhbGUoJyArIHpvb20uc2NhbGUoKSArICcpJykuZWFjaChcImVuZFwiLCB6b29tU2V0Q2FsbGJhY2spO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGguc3RhdGUuY2FuWm9vbSkge1xuICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QoXCIuXCIgKyB0aGlzLmNvbnN0cy5ncmFwaENsYXNzKS5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKCkgKyBcIikgc2NhbGUoXCIgKyB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpICsgXCIpXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnb25XaW5kb3dSZXNpemUnLFxuXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIHdpbmRvdyByZXNpemVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0hUTUwgU1ZHfSAgc3ZnICAgIFRoZSBzdmcgdG8gcmVzaXplXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvbldpbmRvd1Jlc2l6ZShzdmcpIHtcbiAgICAgICAgICAgICAgICB2YXIgYm9keUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXTtcbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS5vZmZzZXQoKTtcbiAgICAgICAgICAgICAgICB2YXIgZGl2V2lkdGggPSAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLndpZHRoKCk7XG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IGJvZHlFbC5jbGllbnRIZWlnaHQ7XG4gICAgICAgICAgICAgICAgc3ZnLmF0dHIoXCJ3aWR0aFwiLCBkaXZXaWR0aCkuYXR0cihcImhlaWdodFwiLCBoZWlnaHQgLSBvZmZzZXQudG9wIC0gMjApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd1cGRhdGVMaW5rRGF0YScsXG5cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgc2VydmVyIHNlbmRzIHVwZGF0ZWQgZGF0YSBmb3IgdGhlIGxpbmtzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVMaW5rRGF0YSgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgbm9kZV9uYW1lc19zZXQgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXNHcmFwaC5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBub2RlX25hbWVzX3NldC5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXS5pZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciByZXREYXRhID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuZ2V0Rmxvd0JldHdlZW5TZXQobm9kZV9uYW1lc19zZXQpO1xuICAgICAgICAgICAgICAgIHZhciBsaW5rRGF0YSA9IHJldERhdGEubGlua0RhdGE7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UucHJvY2Vzc0xpbmtEYXRhKGxpbmtEYXRhLCB0aGlzR3JhcGgubm9kZXMpO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5pdE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5pbml0TGlua3MoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfV0pO1xuXG4gICAgICAgIHJldHVybiBWaXN1YWxpemVyR3JhcGg7XG4gICAgfShHcmFwaC5HcmFwaCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBHcmFwaDogVmlzdWFsaXplckdyYXBoXG4gICAgfTtcbn1dKTtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLyoqXG4gKiBUaGUgYmFzZSBjbGFzcyBmb3IgbGluayBvYmplY3RzIGZvciB0aGUgZ3JhcGguXG4gKiBTdXBwb3J0cyBwb2xpY2llcy5cbiAqIFxuICogVG8gd3JpdGUgeW91ciBvd24gbGluayBvYmplY3QsIGNyZWF0ZSBhIG5ldyBmYWN0b3J5IHRoYXQgdXNlcyB0aGUgbGlua1xuICogeW91IHdhbnQgdG8gaW5oZXJpdCBhcyBhIGRlcGVuZGVuY3ksIGFuZCBleHRlbmQgaXRzIGxpbmsgY2xhc3MuIFxuICogUmV0dXJuIHRoZSBjbGFzcyBvYmplY3Qgd2l0aCBMaW5rIGFzIGtleVxuICogXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdMaW5rJywgW2Z1bmN0aW9uICgpIHtcblx0dmFyIExpbmsgPSBmdW5jdGlvbiAoKSB7XG5cdFx0LyoqXG4gICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICpcbiAgICogQHBhcmFtICAgICAge05vZGV9ICBzb3VyY2VOb2RlICBUaGUgc291cmNlIG5vZGVcbiAgICogQHBhcmFtICAgICAge05vZGV9ICB0YXJnZXROb2RlICBUaGUgdGFyZ2V0IG5vZGVcbiAgICovXG5cdFx0ZnVuY3Rpb24gTGluayhzb3VyY2VOb2RlLCB0YXJnZXROb2RlKSB7XG5cdFx0XHRfY2xhc3NDYWxsQ2hlY2sodGhpcywgTGluayk7XG5cblx0XHRcdHRoaXMuc291cmNlID0gc291cmNlTm9kZTtcblx0XHRcdHRoaXMudGFyZ2V0ID0gdGFyZ2V0Tm9kZTtcblx0XHRcdHRoaXMuaGFzUG9saWN5ID0gZmFsc2U7XG5cdFx0XHR0aGlzLnBhdGhQb2xpY2llcyA9IFtdO1xuXHRcdFx0dGhpcy5ncmFwaCA9IG51bGw7XG5cdFx0XHR0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqIENhbGxlZCB3aGVuIGEgbGluayBpcyBhZGRlZCB0byB0aGUgZ3JhcGhcbiAgICpcbiAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgYWRkZWQgdG9cbiAgICovXG5cblxuXHRcdF9jcmVhdGVDbGFzcyhMaW5rLCBbe1xuXHRcdFx0a2V5OiAnaW5pdGlhbGl6ZScsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gaW5pdGlhbGl6ZShncmFwaCkge1xuXHRcdFx0XHRpZiAodGhpcy5pbml0aWFsaXplZCA9PSBmYWxzZSkge1xuXHRcdFx0XHRcdHRoaXMuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuXHRcdFx0XHRcdHRoaXMuZ3JhcGggPSBncmFwaDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIENhbGxlZCBkdXJpbmcgdGhlIHVwZGF0ZSBncmFwaCBmb3IgZXhpc3RpbmcgbGlua3NcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM3BhdGggIFRoZSBkMyBwYXRoXG4gICAgKiBAcGFyYW0gICAgICB7TGlua30gIFx0ICAgZCAgICAgICBNYXRjaGluZyBMaW5rIE9iamVjdCAgICAgICBcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAndXBkYXRlQXR0cicsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gdXBkYXRlQXR0cihkM3BhdGgsIGQpIHtcblx0XHRcdFx0ZDNwYXRoLnN0eWxlKCdtYXJrZXItZW5kJywgJ3VybCgjZW5kLWFycm93KScpLmF0dHIoXCJkXCIsIGFycm93UGF0aCk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogQ2FsbGVkIGR1cmluZyB0aGUgZmlyc3QgdXBkYXRlIGdyYXBoIGZvciBhIGxpbmtcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM3BhdGggIFRoZSBkMyBwYXRoXG4gICAgKiBAcGFyYW0gICAgICB7TGlua30gIFx0ICAgZCAgICAgICBNYXRjaGluZyBMaW5rIE9iamVjdCAgICAgICBcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnbmV3UGF0aEF0dHInLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIG5ld1BhdGhBdHRyKGQzcGF0aCwgZCkge1xuXHRcdFx0XHRkM3BhdGguYXR0cignZCcsIGFycm93UGF0aCk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogQ2FsY3VsYXRlcyB0aGUgYXJyb3cgcGF0aFxuICAgICpcbiAgICAqIEByZXR1cm4gICAgIHtzdHJpbmd9ICBUaGUgcGF0aCB0byBkcmF3XG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ2Fycm93UGF0aCcsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gYXJyb3dQYXRoKCkge1xuXHRcdFx0XHR2YXIgZCA9IHRoaXM7XG5cdFx0XHRcdHZhciBkeCA9IGQudGFyZ2V0LnggLSBkLnNvdXJjZS54LFxuXHRcdFx0XHQgICAgZHkgPSBkLnRhcmdldC55IC0gZC5zb3VyY2UueSxcblx0XHRcdFx0ICAgIGRyID0gTWF0aC5zcXJ0KGR4ICogZHggKyBkeSAqIGR5KTtcblx0XHRcdFx0cmV0dXJuIFwiTVwiICsgZC5zb3VyY2UueCArIFwiLFwiICsgZC5zb3VyY2UueSArIFwiQVwiICsgZHIgKyBcIixcIiArIGRyICsgXCIgMCAwLDEgXCIgKyBkLnRhcmdldC54ICsgXCIsXCIgKyBkLnRhcmdldC55O1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIFVzZWQgdG8gaW5zdGFsbCBwb2xpY2llcyB0aGF0IGFyZSBjYWxsZWQgd2hlbiB0aGlzXG4gICAgKiBsaW5rIGhhcyBhIG1vdXNlIGV2ZW50XG4gICAgKlxuICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeSAgVGhlIHBvbGljeSB0byBpbnN0YWxsXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ2luc3RhbGxQYXRoUG9saWN5Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBpbnN0YWxsUGF0aFBvbGljeShwb2xpY3kpIHtcblx0XHRcdFx0dGhpcy5oYXNQb2xpY3kgPSB0cnVlO1xuXHRcdFx0XHR0aGlzLnBhdGhQb2xpY2llcy5wdXNoKHBvbGljeSk7XG5cdFx0XHRcdHBvbGljeS5pbml0aWFsaXplKHRoaXMuZ3JhcGgpO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIFVzZWQgdG8gdW5pbnN0YWxsIHBvbGljeSBmb3IgdGhpcyBsaW5rXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeVJlbW92ZSAgVGhlIHBvbGljeSB0byByZW1vdmVcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAndW5pbnN0YWxsUGF0aFBvbGljeScsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gdW5pbnN0YWxsUGF0aFBvbGljeShwb2xpY3lSZW1vdmUpIHtcblx0XHRcdFx0dmFyIHBvbGljeVJlbW92ZU5hbWU7XG5cdFx0XHRcdHZhciB0aGlzUGF0aCA9IHRoaXM7XG5cdFx0XHRcdGlmICh0eXBlb2YgcG9saWN5UmVtb3ZlID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRcdHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmU7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZS5wb2xpY3lOYW1lO1xuXHRcdFx0XHR9XG5cdFx0XHRcdF8odGhpc1BhdGgucGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3ksIGluZGV4KSB7XG5cdFx0XHRcdFx0aWYgKHBvbGljeS5wb2xpY3lOYW1lID09PSBwb2xpY3lSZW1vdmVOYW1lKSB7XG5cdFx0XHRcdFx0XHRwb2xpY3kuZGVzdHJveSgpO1xuXHRcdFx0XHRcdFx0dGhpc1BhdGgucGF0aFBvbGljaWVzLnNwbGljZShpbmRleCwgMSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdFx0aWYgKHRoaXNQYXRoLnBhdGhQb2xpY2llcy5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0XHR0aGlzUGF0aC5oYXNQb2xpY3kgPSBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIENhbGxlZCB3aGVuIHRoZXJlIGlzIGEgbW91c2UgZXZlbnQgZm9yIHRoaXMgcGF0aFxuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBldmVudCAgICAgVGhlIG1vdXNlIGV2ZW50XG4gICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM3BhdGggIFRoZSBkMyBwYXRoXG4gICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgZCAgICAgICAgIFRoZSBtYXRjaGluZyBsaW5rIG9iamVjdFxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdwYXRoUG9saWN5RXZlbnQnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHBhdGhQb2xpY3lFdmVudChldmVudCwgZDNwYXRoLCBkKSB7XG5cdFx0XHRcdF8oZC5wYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24gKHBvbGljeSkge1xuXHRcdFx0XHRcdHBvbGljeVtldmVudF0oZDNwYXRoLCBkKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fV0pO1xuXG5cdFx0cmV0dXJuIExpbms7XG5cdH0oKTtcblxuXHRyZXR1cm4ge1xuXHRcdExpbms6IExpbmtcblx0fTtcbn1dKTtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxudmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQob2JqZWN0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IHJldHVybiBnZXQocGFyZW50LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpOyB9IH0gZWxzZSBpZiAoXCJ2YWx1ZVwiIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9O1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbi8qKlxuICogVGhlIGxpbmsgdGhhdCBpcyB1c2VkIHNwZWNpZmljYWxseSBmb3IgdGhlIHZpc3VhbGl6YXRpb24gdGFiLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnVmlzdWFsaXplckxpbmsnLCBbJ0xpbmsnLCBmdW5jdGlvbiAoTGluaykge1xuXHR2YXIgVmlzdWFsaXplckxpbmsgPSBmdW5jdGlvbiAoX0xpbmskTGluaykge1xuXHRcdF9pbmhlcml0cyhWaXN1YWxpemVyTGluaywgX0xpbmskTGluayk7XG5cblx0XHQvKipcbiAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgKlxuICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHNvdXJjZU5vZGUgIFRoZSBzb3VyY2Ugbm9kZVxuICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHRhcmdldE5vZGUgIFRoZSB0YXJnZXQgbm9kZVxuICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgd2VpZ2h0ICAgIFRoZSB3ZWlnaHQgb2YgdGhlIGxpbmtcbiAgICovXG5cdFx0ZnVuY3Rpb24gVmlzdWFsaXplckxpbmsoc291cmNlTm9kZSwgdGFyZ2V0Tm9kZSwgd2VpZ2h0KSB7XG5cdFx0XHRfY2xhc3NDYWxsQ2hlY2sodGhpcywgVmlzdWFsaXplckxpbmspO1xuXG5cdFx0XHR2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoVmlzdWFsaXplckxpbmspLmNhbGwodGhpcywgc291cmNlTm9kZSwgdGFyZ2V0Tm9kZSkpO1xuXG5cdFx0XHRfdGhpcy53ZWlnaHQgPSB3ZWlnaHQ7XG5cdFx0XHQvL0NvdW50IGlzIHVzZWQgdG8ga2VlcCB0cmFjayBvZiBob3cgbWFueVxuXHRcdFx0Ly9wYXRocyB0byBpdHMgc3Vibm9kZXMgdGhlcmUgYXJlXG5cdFx0XHQvL2luIG9yZGVyIHRvIGNhbGN1bGF0ZSBhdmVyYWdlIHRyYWZmaWNcblx0XHRcdF90aGlzLmNvdW50ID0gMTtcblx0XHRcdHJldHVybiBfdGhpcztcblx0XHR9XG5cblx0XHQvKipcbiAgICogSW5jcmVhc2VzIHRoZSBjb3VudCBvZiB0aGUgbGlua1xuICAgKiBVU2VkIHRvIGtlZXAgdHJhY2sgb2YgaG93IG1hbnkgcGF0aHMgdG8gaXRzIHN1Ym5vZGVzXG4gICAqIHRoZXJlIGFyZSBpbiBvcmRlciB0byBjYWxjdWxhdGUgYXZlcmFnZSB0cmFmZmljXG4gICAqL1xuXG5cblx0XHRfY3JlYXRlQ2xhc3MoVmlzdWFsaXplckxpbmssIFt7XG5cdFx0XHRrZXk6ICdpbmNyZWFzZUNvdW50Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBpbmNyZWFzZUNvdW50KCkge1xuXHRcdFx0XHR0aGlzLmNvdW50ICs9IDE7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogQ2FsY3VsYXRlcyB3aGVyZSB0byBwbGFjZSBxdGlwIGZvclxuICAgICpcbiAgICAqIEByZXR1cm4gICAgIHtPYmplY3R9ICBPYmplY3Qgd2l0aCBxVGlwIHNldHRpbmdzXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3F0aXBIZWxwZXInLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHF0aXBIZWxwZXIoKSB7XG5cdFx0XHRcdHZhciByZXQ7XG5cdFx0XHRcdHZhciBkID0gdGhpcztcblx0XHRcdFx0dmFyIGR4ID0gKGQudGFyZ2V0LnggLSBkLnNvdXJjZS54KSAvIDIsXG5cdFx0XHRcdCAgICBkeSA9IChkLnRhcmdldC55IC0gZC5zb3VyY2UueSkgLyAyO1xuXHRcdFx0XHRpZiAoZC5zb3VyY2UueCA8IGQudGFyZ2V0LngpIHtcblx0XHRcdFx0XHRyZXQgPSB7XG5cdFx0XHRcdFx0XHRteTogJ3RvcCBjZW50ZXInLFxuXHRcdFx0XHRcdFx0YXQ6ICdjZW50ZXIgY2VudGVyJywgLy8gYXQgdGhlIGJvdHRvbSByaWdodCBvZi4uLlxuXHRcdFx0XHRcdFx0dGFyZ2V0OiBbZHgsIGR5XSxcblx0XHRcdFx0XHRcdGFkanVzdDoge1xuXHRcdFx0XHRcdFx0XHR5OiAxMFxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cmV0ID0ge1xuXHRcdFx0XHRcdFx0bXk6ICdib3R0b20gY2VudGVyJyxcblx0XHRcdFx0XHRcdGF0OiAnY2VudGVyIGNlbnRlcicsIC8vIGF0IHRoZSBib3R0b20gcmlnaHQgb2YuLi5cblx0XHRcdFx0XHRcdHRhcmdldDogW2R4LCBkeV0sXG5cdFx0XHRcdFx0XHRhZGp1c3Q6IHtcblx0XHRcdFx0XHRcdFx0eTogLTEwXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gcmV0O1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICogQ2FsbGVkIHdoZW4gYSBsaW5rIGlzIGFkZGVkIHRvIHRoZSBncmFwaFxuICAgKlxuICAgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaCBpdCBpcyBhZGRlZCB0b1xuICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ2luaXRpYWxpemUnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemUoZ3JhcGgpIHtcblx0XHRcdFx0aWYgKHRoaXMuaW5pdGlhbGl6ZWQgPT0gZmFsc2UpIHtcblx0XHRcdFx0XHRfZ2V0KE9iamVjdC5nZXRQcm90b3R5cGVPZihWaXN1YWxpemVyTGluay5wcm90b3R5cGUpLCAnaW5pdGlhbGl6ZScsIHRoaXMpLmNhbGwodGhpcywgZ3JhcGgpO1xuXHRcdFx0XHRcdHZhciBzdGF0ZSA9IGdyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXHRcdFx0XHRcdGlmIChzdGF0ZSA9PSBudWxsKSB7XG5cdFx0XHRcdFx0XHRzdGF0ZSA9IGdyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rID0ge307XG5cdFx0XHRcdFx0XHRzdGF0ZS5tYXhXZWlnaHQgPSBudWxsO1xuXHRcdFx0XHRcdFx0c3RhdGUudXNlQXZnV2VpZ2h0ID0gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0dGhpcy51cGRhdGVNYXhXZWlnaHQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIFNldHMgd2hldGhlciB0aGUgZ3JhcGggc2hvdWxkIHVzZSBhdmcgd2VpZ2h0XG4gICAgKlxuICAgICogQHBhcmFtICAgICAge2Jvb2xlYW59ICB2YWwgICAgIFRoZSB2YWx1ZSB0byBzZXQgdG9cbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnc2V0VXNlQXZnV2VpZ2h0Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBzZXRVc2VBdmdXZWlnaHQodmFsKSB7XG5cdFx0XHRcdHRoaXMuZ3JhcGguc3RhdGUuVmlzdWFsaXplckxpbmsudXNlQXZnV2VpZ2h0ID0gISF2YWw7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogU2V0cyB0aGUgd2VpZ2h0IG9mIHRoaXMgbGlua1xuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB3ZWlnaHQgIFRoZSB3ZWlnaHQgdG8gc2V0IHRvXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3NldFdlaWdodCcsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gc2V0V2VpZ2h0KHdlaWdodCkge1xuXHRcdFx0XHR0aGlzLndlaWdodCA9IHdlaWdodDtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBHZXRzIHRoZSByYXcgd2VpZ2h0LlxuICAgICpcbiAgICAqIEByZXR1cm4gICAgIHtudW1iZXJ9ICBUaGUgcmF3IHdlaWdodC5cbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnZ2V0UmF3V2VpZ2h0Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBnZXRSYXdXZWlnaHQoKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLndlaWdodDtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBHZXRzIHRoZSB3ZWlnaHQgdmFsdWUgb2YgdGhlIGxpbmssIGRlcGVuZGluZyBvbiB0aGVcbiAgICAqIHVzZUF2Z1dlaWd0aCBzZXR0aW5nXG4gICAgKlxuICAgICogQHJldHVybiAgICAge251bWJlcn0gIFRoZSB3ZWlnaHQuXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ2dldFdlaWdodCcsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gZ2V0V2VpZ2h0KCkge1xuXHRcdFx0XHR2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcblx0XHRcdFx0ICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXG5cdFx0XHRcdGlmIChzdGF0ZS51c2VBdmdXZWlnaHQpIHtcblx0XHRcdFx0XHR2YXIgd2VpZ2h0ID0gdGhpcy53ZWlnaHQgLyB0aGlzLmNvdW50O1xuXHRcdFx0XHRcdHJldHVybiB3ZWlnaHQ7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHRoaXMud2VpZ2h0O1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIFVwZGF0ZXMgdGhlIG1heCB3ZWlnaHQgb2YgdGhlIGdyYXBoXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3VwZGF0ZU1heFdlaWdodCcsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gdXBkYXRlTWF4V2VpZ2h0KCkge1xuXHRcdFx0XHR2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcblx0XHRcdFx0ICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXG5cdFx0XHRcdHZhciBtYXhMaW5rID0gXy5tYXhCeSh0aGlzR3JhcGgubGlua3MsIGZ1bmN0aW9uIChsKSB7XG5cdFx0XHRcdFx0aWYgKGwuZ3JhcGggIT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIGwuZ2V0V2VpZ2h0KCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiAwO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0c3RhdGUubWF4V2VpZ2h0ID0gbWF4TGluay5nZXRXZWlnaHQoKTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBDYWxsZWQgZHVyaW5nIHRoZSB1cGRhdGUgZ3JhcGggZm9yIGV4aXN0aW5nIGxpbmtzXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuICAgICogQHBhcmFtICAgICAge0xpbmt9ICBcdCAgIGQgICAgICAgTWF0Y2hpbmcgTGluayBPYmplY3QgICAgICAgXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3VwZGF0ZUF0dHInLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUF0dHIoZDNwYXRoLCBkKSB7XG5cdFx0XHRcdHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuXHRcdFx0XHQgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuVmlzdWFsaXplckxpbms7XG5cdFx0XHRcdHRoaXMudXBkYXRlTWF4V2VpZ2h0KCk7XG5cdFx0XHRcdHZhciBjb2xvclNjYWxlID0gZDMuc2NhbGUubGluZWFyKCkuZG9tYWluKFswLCBzdGF0ZS5tYXhXZWlnaHRdKS5yYW5nZShbXCIjZmZiMzY2XCIsIFwiI0Y5MjYwNlwiXSk7XG5cdFx0XHRcdHN0YXRlLmNvbG9yU2NhbGUgPSBjb2xvclNjYWxlO1xuXHRcdFx0XHRkM3BhdGguc3R5bGUoJ21hcmtlci1lbmQnLCAndXJsKCNlbmQtYXJyb3cpJykuY2xhc3NlZCh0aGlzR3JhcGguY29uc3RzLnNlbGVjdGVkQ2xhc3MsIGZ1bmN0aW9uIChkKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGQgPT09IHN0YXRlLnNlbGVjdGVkRWRnZTtcblx0XHRcdFx0fSkuYXR0cihcImRcIiwgdGhpcy5hcnJvd1BhdGguY2FsbChkKSkudHJhbnNpdGlvbihcImV4aXN0aW5nUGF0aFRyYW5zaXRpb25cIikuZHVyYXRpb24oNzUwKS5hdHRyKFwic3Ryb2tlXCIsIGZ1bmN0aW9uIChkKSB7XG5cdFx0XHRcdFx0dmFyIGMgPSBjb2xvclNjYWxlKGQuZ2V0V2VpZ2h0KCkpO1xuXHRcdFx0XHRcdHJldHVybiBjO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBDYWxsZWQgZHVyaW5nIHRoZSBmaXJzdCB1cGRhdGUgZ3JhcGggZm9yIHRoaXMgbGlua1xuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzcGF0aCAgVGhlIGQzIHBhdGhcbiAgICAqIEBwYXJhbSAgICAgIHtMaW5rfSAgXHQgICBkICAgICAgIE1hdGNoaW5nIExpbmsgT2JqZWN0XG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ25ld1BhdGhBdHRyJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBuZXdQYXRoQXR0cihkM3BhdGgsIGQpIHtcblx0XHRcdFx0dmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG5cdFx0XHRcdCAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluaztcblx0XHRcdFx0dGhpcy51cGRhdGVNYXhXZWlnaHQoKTtcblx0XHRcdFx0dmFyIGNvbG9yU2NhbGUgPSBkMy5zY2FsZS5saW5lYXIoKS5kb21haW4oWzAsIHN0YXRlLm1heFdlaWdodF0pLnJhbmdlKFtcIiNmZmIzNjZcIiwgXCIjRjkyNjA2XCJdKTtcblxuXHRcdFx0XHRkM3BhdGgudHJhbnNpdGlvbihcIm5ld1BhdGhUcmFuc2l0aW9uXCIpLmR1cmF0aW9uKDc1MCkuYXR0clR3ZWVuKFwib3BhY2l0eVwiLCBmdW5jdGlvbiAoZCkge1xuXHRcdFx0XHRcdHJldHVybiBkMy5pbnRlcnBvbGF0ZVN0cmluZygwLCAxKTtcblx0XHRcdFx0fSkuYXR0cihcInN0cm9rZVwiLCBmdW5jdGlvbiAoZCkge1xuXHRcdFx0XHRcdHZhciBjID0gY29sb3JTY2FsZShkLmdldFdlaWdodCgpKTtcblx0XHRcdFx0XHRyZXR1cm4gYztcblx0XHRcdFx0fSkuYXR0cignZCcsIHRoaXMuYXJyb3dQYXRoLmNhbGwoZCkpO1xuXHRcdFx0fVxuXHRcdH1dKTtcblxuXHRcdHJldHVybiBWaXN1YWxpemVyTGluaztcblx0fShMaW5rLkxpbmspO1xuXG5cdHJldHVybiB7XG5cdFx0TGluazogVmlzdWFsaXplckxpbmtcblx0fTtcbn1dKTtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLyoqXG4gKiBUaGUgYmFzZSBjbGFzcyBmb3Igbm9kZSBvYmplY3RzIGZvciB0aGUgZ3JhcGguXG4gKiBTdXBwb3J0cyBwb2xpY2llcy5cbiAqIFxuICogVG8gd3JpdGUgeW91ciBvd24gTm9kZSBvYmplY3QsIGNyZWF0ZSBhIG5ldyBmYWN0b3J5IHRoYXQgdXNlcyB0aGUgbm9kZVxuICogeW91IHdhbnQgdG8gaW5oZXJpdCBhcyBhIGRlcGVuZGVuY3ksIGFuZCBleHRlbmQgaXRzIG5vZGUgY2xhc3MuIFxuICogUmV0dXJuIHRoZSBjbGFzcyBvYmplY3Qgd2l0aCBOb2RlIGFzIGtleVxuICogXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdOb2RlJywgW2Z1bmN0aW9uICgpIHtcblx0dmFyIE5vZGUgPSBmdW5jdGlvbiAoKSB7XG5cdFx0LyoqXG4gICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICpcbiAgICogQHBhcmFtICAgICAge251bWJlcn0gIHggICAgICAgeCBsb2NhdGlvblxuICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeSAgICAgICB5IGxvY2F0aW9uXG4gICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG4gICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICB0ZXh0ICAgIFRoZSB0ZXh0IHRvIGRpc3BsYXlcbiAgICogQHBhcmFtICAgICAge251bWJlcn0gIHJhZGl1cyAgVGhlIHJhZGl1cyBvZiB0aGUgbm9kZVxuICAgKi9cblx0XHRmdW5jdGlvbiBOb2RlKHgsIHksIGlkLCB0ZXh0LCByYWRpdXMpIHtcblx0XHRcdF9jbGFzc0NhbGxDaGVjayh0aGlzLCBOb2RlKTtcblxuXHRcdFx0dGhpcy54ID0geDtcblx0XHRcdHRoaXMueSA9IHk7XG5cdFx0XHR0aGlzLnJhZGl1cyA9IHJhZGl1cztcblx0XHRcdHRoaXMuaWQgPSBpZDtcblx0XHRcdHRoaXMudGV4dCA9IHRleHQ7XG5cdFx0XHR0aGlzLnJhZGl1cyA9IHJhZGl1cztcblx0XHRcdHRoaXMuaGFzUG9saWN5ID0gZmFsc2U7XG5cdFx0XHR0aGlzLnBvbGljeSA9IG51bGw7XG5cdFx0XHR0aGlzLm5vZGVQb2xpY2llcyA9IFtdO1xuXHRcdFx0dGhpcy5ncmFwaCA9IG51bGw7XG5cdFx0XHR0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqIENhbGxlZCB3aGVuIGEgbm9kZSBpcyBhZGRlZCB0byB0aGUgZ3JhcGhcbiAgICpcbiAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgYWRkZWQgdG9cbiAgICovXG5cblxuXHRcdF9jcmVhdGVDbGFzcyhOb2RlLCBbe1xuXHRcdFx0a2V5OiAnaW5pdGlhbGl6ZScsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gaW5pdGlhbGl6ZShncmFwaCkge1xuXHRcdFx0XHRpZiAodGhpcy5pbml0aWFsaXplZCA9PSBmYWxzZSkge1xuXHRcdFx0XHRcdHRoaXMuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuXHRcdFx0XHRcdHRoaXMuZ3JhcGggPSBncmFwaDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIENhbGxlZCBkdXJpbmcgdGhlIHVwZGF0ZSBncmFwaCBmb3IgZXhpc3RpbmcgbGlua3NcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3VwZGF0ZUF0dHInLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUF0dHIoZDNub2RlLCBkKSB7XG5cdFx0XHRcdGQzbm9kZS5hdHRyKFwidHJhbnNmb3JtXCIsIGZ1bmN0aW9uIChkKSB7XG5cdFx0XHRcdFx0cmV0dXJuIFwidHJhbnNsYXRlKFwiICsgZC54ICsgXCIsXCIgKyBkLnkgKyBcIilcIjtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogQ2FsbGVkIGR1cmluZyB0aGUgZmlyc3QgdXBkYXRlIGdyYXBoIGZvciBhIG5vZGVcbiAgICAqIEhvb2sgZm9yIHN1YiBjbGFzc2VzXG4gICAgKiBcbiAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgIGQgICAgICAgTWF0Y2hpbmcgTm9kZSBPYmplY3RcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnbmV3Tm9kZUF0dHInLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIG5ld05vZGVBdHRyKGQzbm9kZSwgZCkge31cblxuXHRcdFx0LyoqXG4gICAgKiBTZXRzIHRoZSByYWRpdXMgb2YgdGhlIG5vZGUuXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge251bWJlcn0gIHJhZGl1cyAgVGhlIHJhZGl1c1xuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdzZXRSYWRpdXMnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHNldFJhZGl1cyhyYWRpdXMpIHtcblx0XHRcdFx0dGhpcy5yYWRpdXMgPSByYWRpdXM7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogVXNlZCB0byBpbnN0YWxsIHBvbGljaWVzIHRoYXQgYXJlIGNhbGxlZCB3aGVuIHRoaXNcbiAgICAqIG5vZGUgaGFzIGEgbW91c2UgZXZlbnRcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7UG9saWN5fSAgcG9saWN5ICBUaGUgcG9saWN5IHRvIGluc3RhbGxcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnaW5zdGFsbE5vZGVQb2xpY3knLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGluc3RhbGxOb2RlUG9saWN5KHBvbGljeSkge1xuXHRcdFx0XHR0aGlzLmhhc1BvbGljeSA9IHRydWU7XG5cdFx0XHRcdHRoaXMubm9kZVBvbGljaWVzLnB1c2gocG9saWN5KTtcblx0XHRcdFx0cG9saWN5LmluaXRpYWxpemUodGhpcy5ncmFwaCk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogVXNlZCB0byB1bmluc3RhbGwgcG9saWN5IGZvciB0aGlzIG5vZGVcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7UG9saWN5fHN0cmluZ30gIHBvbGljeVJlbW92ZSAgVGhlIHBvbGljeSB0byByZW1vdmVcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAndW5pbnN0YWxsTm9kZVBvbGljeScsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gdW5pbnN0YWxsTm9kZVBvbGljeShwb2xpY3lSZW1vdmUpIHtcblx0XHRcdFx0dmFyIHBvbGljeVJlbW92ZU5hbWU7XG5cdFx0XHRcdHZhciB0aGlzTm9kZSA9IHRoaXM7XG5cdFx0XHRcdGlmICh0eXBlb2YgcG9saWN5UmVtb3ZlID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRcdHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmU7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZS5wb2xpY3lOYW1lO1xuXHRcdFx0XHR9XG5cdFx0XHRcdF8odGhpc05vZGUubm9kZVBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3ksIGluZGV4KSB7XG5cdFx0XHRcdFx0aWYgKHBvbGljeS5wb2xpY3lOYW1lID09PSBwb2xpY3lSZW1vdmVOYW1lKSB7XG5cdFx0XHRcdFx0XHRwb2xpY3kuZGVzdHJveSgpO1xuXHRcdFx0XHRcdFx0dGhpc05vZGUubm9kZVBvbGljaWVzLnNwbGljZShpbmRleCwgMSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdFx0aWYgKHRoaXNOb2RlLm5vZGVQb2xpY2llcy5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0XHR0aGlzTm9kZS5oYXNQb2xpY3kgPSBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIENhbGxlZCB3aGVuIHRoZXJlIGlzIGEgbW91c2UgZXZlbnQgZm9yIHRoaXMgbm9kZVxuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBldmVudCAgICAgVGhlIG1vdXNlIGV2ZW50XG4gICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgZCAgICAgICAgIFRoZSBtYXRjaGluZyBub2RlIG9iamVjdFxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdub2RlUG9saWN5RXZlbnQnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIG5vZGVQb2xpY3lFdmVudChldmVudCwgZDNub2RlLCBkKSB7XG5cdFx0XHRcdF8uZm9yRWFjaCh0aGlzLm5vZGVQb2xpY2llcywgZnVuY3Rpb24gKHBvbGljeSkge1xuXHRcdFx0XHRcdHBvbGljeVtldmVudF0oZDNub2RlLCBkKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fV0pO1xuXG5cdFx0cmV0dXJuIE5vZGU7XG5cdH0oKTtcblxuXHRyZXR1cm4ge1xuXHRcdE5vZGU6IE5vZGVcblx0fTtcbn1dKTtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG4vKipcbiAqIFRoZSBub2RlIHRoYXQgaXMgdXNlZCBzcGVjaWZpY2FsbHkgZm9yIHRoZSB2aXN1YWxpemF0aW9uIHRhYi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ1Zpc3VhbGl6ZXJOb2RlJywgWydOb2RlJywgZnVuY3Rpb24gKE5vZGUpIHtcblx0dmFyIFZpc3VhbGl6ZXJOb2RlID0gZnVuY3Rpb24gKF9Ob2RlJE5vZGUpIHtcblx0XHRfaW5oZXJpdHMoVmlzdWFsaXplck5vZGUsIF9Ob2RlJE5vZGUpO1xuXG5cdFx0LyoqXG4gICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICpcbiAgICogQHBhcmFtICAgICAge251bWJlcn0gIHggICAgICAgXHR4IGxvY2F0aW9uXG4gICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB5ICAgICAgIFx0eSBsb2NhdGlvblxuICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgaWQgICAgICBcdFRoZSBpZGVudGlmaWVyXG4gICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICB0ZXh0ICAgIFx0VGhlIHRleHQgdG8gZGlzcGxheVxuICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgcmFkaXVzICBcdFRoZSByYWRpdXMgb2YgdGhlIG5vZGVcbiAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHBhcmVudCAgICAgVGhlIHBhcmVudCBpZFxuICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgYW5jZXN0b3JzICBBcnJheSBvZiBhbmNlc3RvcnMgSWRcbiAgICogQHBhcmFtICAgICAge251bWJlcn0gIHhTdGFydCAgICAgeCBsb2MgdG8gc3RhcnQgYW5pbWF0aW9uXG4gICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB5U3RhcnQgICAgIHkgbG9jIHRvIHN0YXJ0IGFuaW1hdGlvblxuICAgKi9cblx0XHRmdW5jdGlvbiBWaXN1YWxpemVyTm9kZSh4LCB5LCBpZCwgdGV4dCwgcmFkaXVzLCBwYXJlbnQsIGFuY2VzdG9ycywgeFN0YXJ0LCB5U3RhcnQpIHtcblx0XHRcdF9jbGFzc0NhbGxDaGVjayh0aGlzLCBWaXN1YWxpemVyTm9kZSk7XG5cblx0XHRcdHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIE9iamVjdC5nZXRQcm90b3R5cGVPZihWaXN1YWxpemVyTm9kZSkuY2FsbCh0aGlzLCB4LCB5LCBpZCwgdGV4dCwgcmFkaXVzKSk7XG5cblx0XHRcdF90aGlzLnBhcmVudCA9IHBhcmVudDtcblx0XHRcdF90aGlzLmFuY2VzdG9ycyA9IGFuY2VzdG9ycztcblx0XHRcdGlmICh4U3RhcnQgPT0gbnVsbCkge1xuXHRcdFx0XHRfdGhpcy54U3RhcnQgPSB4O1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0X3RoaXMueFN0YXJ0ID0geFN0YXJ0O1xuXHRcdFx0fVxuXHRcdFx0aWYgKHlTdGFydCA9PSBudWxsKSB7XG5cdFx0XHRcdF90aGlzLnlTdGFydCA9IHk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRfdGhpcy55U3RhcnQgPSB5U3RhcnQ7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gX3RoaXM7XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqIENhbGxlZCBkdXJpbmcgdGhlIGZpcnN0IHVwZGF0ZSBncmFwaCBmb3IgYSBub2RlXG4gICAqXG4gICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICogQHBhcmFtICAgICAge05vZGV9ICAgIGQgICAgICAgICBUaGUgbWF0Y2hpbmcgTm9kZVxuICAgKi9cblxuXG5cdFx0X2NyZWF0ZUNsYXNzKFZpc3VhbGl6ZXJOb2RlLCBbe1xuXHRcdFx0a2V5OiAnbmV3Tm9kZUF0dHInLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIG5ld05vZGVBdHRyKGQzbm9kZSwgZCkge1xuXHRcdFx0XHR2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaDtcblx0XHRcdFx0aWYgKHRoaXNHcmFwaC5jb25zdHMuY29udGFpbmVyQ2xhc3MgIT0gbnVsbCAmJiB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbZC5pZF0gPT0gbnVsbCkge1xuXHRcdFx0XHRcdGQzbm9kZS5jbGFzc2VkKHRoaXNHcmFwaC5jb25zdHMuY29udGFpbmVyQ2xhc3MsIHRydWUpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGQzbm9kZS50cmFuc2l0aW9uKFwibm9kZVBvc2l0aW9uVHJhbnNpdGlvblwiKS5kdXJhdGlvbig3NTApLmF0dHJUd2VlbihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbiAoZCkge1xuXHRcdFx0XHRcdGlmIChkLnhTdGFydCAhPSBudWxsICYmIGQueVN0YXJ0ICE9IG51bGwpIHtcblx0XHRcdFx0XHRcdHZhciB4U3RhcnQgPSBkLnhTdGFydDtcblx0XHRcdFx0XHRcdHZhciB5U3RhcnQgPSBkLnlTdGFydDtcblx0XHRcdFx0XHRcdGQueFN0YXJ0ID0gZC54O1xuXHRcdFx0XHRcdFx0ZC55U3RhcnQgPSBkLnk7XG5cdFx0XHRcdFx0XHRyZXR1cm4gZDMuaW50ZXJwb2xhdGVTdHJpbmcoXCJ0cmFuc2xhdGUoXCIgKyB4U3RhcnQgKyBcIixcIiArIHlTdGFydCArIFwiKVwiLCBcInRyYW5zbGF0ZShcIiArIGQueCArIFwiLFwiICsgZC55ICsgXCIpXCIpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm4gZDMuaW50ZXJwb2xhdGVTdHJpbmcoXCJ0cmFuc2xhdGUoXCIgKyBkLnggKyBcIixcIiArIGQueSArIFwiKVwiLCBcInRyYW5zbGF0ZShcIiArIGQueCArIFwiLFwiICsgZC55ICsgXCIpXCIpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XSk7XG5cblx0XHRyZXR1cm4gVmlzdWFsaXplck5vZGU7XG5cdH0oTm9kZS5Ob2RlKTtcblxuXHRyZXR1cm4ge1xuXHRcdE5vZGU6IFZpc3VhbGl6ZXJOb2RlXG5cdH07XG59XSk7XG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KG9iamVjdCwgcHJvcGVydHksIHJlY2VpdmVyKSB7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyByZXR1cm4gZ2V0KHBhcmVudCwgcHJvcGVydHksIHJlY2VpdmVyKTsgfSB9IGVsc2UgaWYgKFwidmFsdWVcIiBpbiBkZXNjKSB7IHJldHVybiBkZXNjLnZhbHVlOyB9IGVsc2UgeyB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7IGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7IH0gfTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG4vKipcbiAqIFRoaXMgcG9saWN5IGlzIHVzZWQgdG8gYWRkIGEgc2VsZWN0IG5vZGUgZmVhdHVyZS5cbiAqIFN1cHBvcnRzIHNlbGVjdGluZyBtdWx0aXBsZSBub2RlcyBieSB1c2luZyB0aGUgY3RybCBrZXkuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdOb2RlU2VsZWN0aW9uUG9saWN5JywgWydQb2xpY3knLCBmdW5jdGlvbiAoUG9saWN5KSB7XG4gICAgdmFyIE5vZGVTZWxlY3Rpb25Qb2xpY3kgPSBmdW5jdGlvbiAoX1BvbGljeSRQb2xpY3kpIHtcbiAgICAgICAgX2luaGVyaXRzKE5vZGVTZWxlY3Rpb25Qb2xpY3ksIF9Qb2xpY3kkUG9saWN5KTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gTm9kZVNlbGVjdGlvblBvbGljeSgpIHtcbiAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBOb2RlU2VsZWN0aW9uUG9saWN5KTtcblxuICAgICAgICAgICAgcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIE9iamVjdC5nZXRQcm90b3R5cGVPZihOb2RlU2VsZWN0aW9uUG9saWN5KS5jYWxsKHRoaXMsIFwiTm9kZVNlbGVjdGlvblBvbGljeVwiKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2FsbGVkIHdoZW4gcG9saWN5IGlzIGluc3RhbGxlZFxuICAgICAgICAgKiBPdmVyd3JpdGVzIHRoZSBvbiBkcmFnIGV2ZW50IG9mIHRoZSBncmFwaFxuICAgICAgICAgKiBcbiAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgXG4gICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YWxsZWQgb25cbiAgICAgICAgKi9cblxuXG4gICAgICAgIF9jcmVhdGVDbGFzcyhOb2RlU2VsZWN0aW9uUG9saWN5LCBbe1xuICAgICAgICAgICAga2V5OiAnaW5pdGlhbGl6ZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdGlhbGl6ZShncmFwaCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgX2dldChPYmplY3QuZ2V0UHJvdG90eXBlT2YoTm9kZVNlbGVjdGlvblBvbGljeS5wcm90b3R5cGUpLCAnaW5pdGlhbGl6ZScsIHRoaXMpLmNhbGwodGhpcywgZ3JhcGgpO1xuICAgICAgICAgICAgICAgIHZhciBzdGF0ZSA9IGdyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zZWxlY3RlZE5vZGVzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIGNvbnN0cyA9IGdyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgY29uc3RzLnNlbGVjdGVkQ2xhc3MgPSBcInNlbGVjdGVkXCI7XG4gICAgICAgICAgICAgICAgLy9vdmVyd3JpdHRpbmcgZ3JhcGgncyBub2RlIG9uIGRyYWcgZXZlbnQgdG8gc3VwcG9ydFxuICAgICAgICAgICAgICAgIC8vbW92aW5nIG11bHRpcGxlIG5vZGVzIGF0IG9uY2VcbiAgICAgICAgICAgICAgICB2YXIgZHJhZyA9IGdyYXBoLmRyYWc7XG4gICAgICAgICAgICAgICAgZHJhZy5vbignZHJhZycsIGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSBncmFwaDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWRDbGFzcyA9IHRoaXNHcmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeS5zZWxlY3RlZENsYXNzO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGVjdGlvbiA9IGQzLnNlbGVjdEFsbCgnLicgKyBzZWxlY3RlZENsYXNzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGlvblswXS5pbmRleE9mKHRoaXMpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uLmNsYXNzZWQoc2VsZWN0ZWRDbGFzcywgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGlvbiA9IGQzLnNlbGVjdCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb24uY2xhc3NlZChzZWxlY3RlZENsYXNzLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZnVuY3Rpb24gKGQsIGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnggKz0gZDMuZXZlbnQuZHg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55ICs9IGQzLmV2ZW50LmR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcInRyYW5zbGF0ZShcIiArIFtkLngsIGQueV0gKyBcIilcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBBZGRzIHRoZSBnaXZlbiBub2RlIHRvIHRoZSBhcnJheSBvZiBzZWxlY3RlZCBub2Rlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzTm9kZSAgICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgbm9kZURhdGEgIE1hdGNoaW5nIE5vZGUgb2JqZWN0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdhZGRTZWxlY3ROb2RlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRTZWxlY3ROb2RlKGQzTm9kZSwgbm9kZURhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgZDNOb2RlLmNsYXNzZWQoY29uc3RzLnNlbGVjdGVkQ2xhc3MsIHRydWUpO1xuICAgICAgICAgICAgICAgIHN0YXRlLnNlbGVjdGVkTm9kZXMucHVzaChub2RlRGF0YSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyB0aGUgZ2l2ZW4gbm9kZSBmcm9tIHRoZSBhcnJheSBvZiBzZWxlY3RlZCBub2Rlcy5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM05vZGUgICAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgIG5vZGVEYXRhICBNYXRjaGluZyBub2RlIG9iamVjdCBcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3JlbW92ZVNlbGVjdEZyb21Ob2RlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVTZWxlY3RGcm9tTm9kZShkM05vZGUsIG5vZGVEYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmZpbHRlcihmdW5jdGlvbiAoY2QpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNkLmlkID09PSBub2RlRGF0YS5pZDtcbiAgICAgICAgICAgICAgICB9KS5jbGFzc2VkKGNvbnN0cy5zZWxlY3RlZENsYXNzLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gc3RhdGUuc2VsZWN0ZWROb2Rlcy5pbmRleE9mKG5vZGVEYXRhKTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zZWxlY3RlZE5vZGVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyBhbGwgc2VsZWN0ZWQgbm9kZXMuXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdyZW1vdmVBbGxTZWxlY3RlZE5vZGVzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVBbGxTZWxlY3RlZE5vZGVzKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzLk5vZGVTZWxlY3Rpb25Qb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5jbGFzc2VkKGNvbnN0cy5zZWxlY3RlZENsYXNzLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgc3RhdGUuc2VsZWN0ZWROb2RlcyA9IFtdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIE9uIE1vdXNlZG93biwgZGV0ZXJtaW5lcyB3aGV0aGVyIHRvIGNoYW5nZSB0aGVcbiAgICAgICAgICAgICAqIHNlbGVjdGVkIHN0YXR1cyBvZiB0aGUgY2xpY2tlZCBub2RlLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgIGQgICAgICAgTWF0Y2hpbmcgTm9kZSBPYmplY3QgICAgICAgXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdtb3VzZWRvd24nLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdXNlZG93bihkM25vZGUsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeTtcbiAgICAgICAgICAgICAgICBkMy5ldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICBpZiAoZDMuZXZlbnQuY3RybEtleSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuc2VsZWN0ZWROb2Rlcy5pbmRleE9mKGQpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlU2VsZWN0RnJvbU5vZGUoZDNub2RlLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkU2VsZWN0Tm9kZShkM25vZGUsIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdGF0ZS5zZWxlY3RlZE5vZGVzLmluZGV4T2YoZCkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9pZiBubyBjb250cm9sIGtleSwgYW5kIGNsaWNrZWQgbm90IHNlbGVjdGVkIG5vZGUsXG4gICAgICAgICAgICAgICAgICAgIC8vcmVtb3ZlIGFsbCBvZiBjdXJyZW50IHNlbGVjdGlvblxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUFsbFNlbGVjdGVkTm9kZXMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogT24gTW91c2V1cCwgZGV0ZXJtaW5lcyB3aGV0aGVyIHRvIGNoYW5nZSB0aGVcbiAgICAgICAgICAgICAqIHNlbGVjdGVkIHN0YXR1cyBvZiB0aGUgY2xpY2tlZCBub2RlLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgIGQgICAgICAgTWF0Y2hpbmcgTm9kZSBPYmplY3RcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ21vdXNldXAnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdXNldXAoZDNub2RlLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3k7XG4gICAgICAgICAgICAgICAgaWYgKCFkMy5ldmVudC5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgbGVuZ3RoIGlzIGdyZWF0ZXIgdGhhbiAxLCB0aGVuIHdlIGFyZSBtb3ZpbmcgbXVsdGlwbGUgbm9kZXNcbiAgICAgICAgICAgICAgICAgICAgLy9sZWF2ZSB0aGVtIGFsbCBoaWdobGlnaHRlZFxuICAgICAgICAgICAgICAgICAgICAvL290aGVyd2lzZSB3ZSBhcmUganVzdCBtb3Zpbmcgb25lIG5vZGUsIHNvIHVuaGlnaGxpZ2h0XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5zZWxlY3RlZE5vZGVzLmxlbmd0aCA8PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVNlbGVjdEZyb21Ob2RlKGQzbm9kZSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1dKTtcblxuICAgICAgICByZXR1cm4gTm9kZVNlbGVjdGlvblBvbGljeTtcbiAgICB9KFBvbGljeS5Qb2xpY3kpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgUG9saWN5OiBOb2RlU2VsZWN0aW9uUG9saWN5XG4gICAgfTtcbn1dKTtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG4vKipcbiAqIFRoaXMgcG9saWN5IGNoYW5nZXMgdGhlIHZpZXcgdG8gdGhlIHRpbWVncmFwaCBvZiBsaW5rIGRhdGEgb24gY2xpY2suXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdQYXRoQ2hhbmdlVmlld1BvbGljeScsIFsnUG9saWN5JywgZnVuY3Rpb24gKFBvbGljeSkge1xuICAgIHZhciBQYXRoQ2hhbmdlVmlld1BvbGljeSA9IGZ1bmN0aW9uIChfUG9saWN5JFBvbGljeSkge1xuICAgICAgICBfaW5oZXJpdHMoUGF0aENoYW5nZVZpZXdQb2xpY3ksIF9Qb2xpY3kkUG9saWN5KTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2FsbGVkIHRvIGJ1aWxkIHBvbGljeVxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gICB7QW5ndWxhciBTdGF0ZX0gICAgJHN0YXRlICAgIFVzZWQgdG8gY2hhbmdlIHZpZXdcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIFBhdGhDaGFuZ2VWaWV3UG9saWN5KCRzdGF0ZSkge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFBhdGhDaGFuZ2VWaWV3UG9saWN5KTtcblxuICAgICAgICAgICAgdmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgT2JqZWN0LmdldFByb3RvdHlwZU9mKFBhdGhDaGFuZ2VWaWV3UG9saWN5KS5jYWxsKHRoaXMsICdQYXRoQ2hhbmdlVmlld1BvbGljeScpKTtcblxuICAgICAgICAgICAgX3RoaXMuJHN0YXRlID0gJHN0YXRlO1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdlbmVyYXRlcyBhIGxpc3Qgb2YgYWxsIGNoaWxkIGNvbnRhaW5lcnMgb2YgdGhlIHNlcnZpY2VcbiAgICAgICAgICogQ2FuIGhhbmRsZSBuZXN0ZWQgc2VydmljZXMuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBpZCAgICAgIE5vZGUgSURcbiAgICAgICAgICovXG5cblxuICAgICAgICBfY3JlYXRlQ2xhc3MoUGF0aENoYW5nZVZpZXdQb2xpY3ksIFt7XG4gICAgICAgICAgICBrZXk6ICdnZW5lcmF0ZUxpc3QnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdlbmVyYXRlTGlzdChpZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgcmV0TGlzdCA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBub2RlSWRzID0gdGhpcy5ncmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFtpZF07XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKG5vZGVJZHMsIGZ1bmN0aW9uIChjaGlsZElkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzUG9saWN5LmdyYXBoLmRhdGFTb3VyY2UuaGFzQ2hpbGQoY2hpbGRJZCkgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldExpc3QuY29uY2F0KHRoaXNQb2xpY3kuZ2VuZXJhdGVMaXN0KGNoaWxkSWQpKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldExpc3QucHVzaChjaGlsZElkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXRMaXN0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVzZWQgdG8gcmVyb3V0ZSBhbiBlZGdlIHdoZW4gY2xpY2tlZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtMaW5rfSAgZWRnZSAgICBUaGUgY2xpY2tlZCBlZGdlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd2aWV3RWRnZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmlld0VkZ2UoZWRnZSkge1xuICAgICAgICAgICAgICAgIHZhciBzb3VyY2VMaXN0ID0gW107XG4gICAgICAgICAgICAgICAgdmFyIHRhcmdldExpc3QgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgc291cmNlSWQgPSBlZGdlLnNvdXJjZS5pZDtcbiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0SWQgPSBlZGdlLnRhcmdldC5pZDtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmdyYXBoLmRhdGFTb3VyY2UuaGFzQ2hpbGQoc291cmNlSWQpID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vTm90IGEgY29udGFpbmVyIG5vZGUsIG5lZWQgdG8gYWdncmVnYXRlXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZUxpc3QgPSB0aGlzLmdlbmVyYXRlTGlzdChzb3VyY2VJZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlTGlzdCA9IFtzb3VyY2VJZF07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZ3JhcGguZGF0YVNvdXJjZS5oYXNDaGlsZCh0YXJnZXRJZCkgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9Ob3QgYSBjb250YWluZXIgbm9kZSwgbmVlZCB0byBhZ2dyZWdhdGVcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TGlzdCA9IHRoaXMuZ2VuZXJhdGVMaXN0KHRhcmdldElkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRMaXN0ID0gW3RhcmdldElkXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy4kc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZpc3VhbGl6YXRpb24uZWRnZScsIHsgc291cmNlTmFtZTogc291cmNlSWQsIHRhcmdldE5hbWU6IHRhcmdldElkLFxuICAgICAgICAgICAgICAgICAgICBzb3VyY2VMaXN0OiBzb3VyY2VMaXN0LCB0YXJnZXRMaXN0OiB0YXJnZXRMaXN0IH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdtb3VzZWRvd24nLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdXNlZG93bihkM3BhdGgsIGQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdFZGdlKGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIFBhdGhDaGFuZ2VWaWV3UG9saWN5O1xuICAgIH0oUG9saWN5LlBvbGljeSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBQb2xpY3k6IFBhdGhDaGFuZ2VWaWV3UG9saWN5XG4gICAgfTtcbn1dKTtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLyoqXG4gKiBCYXNlIHBvbGljeSBjbGFzcyBmb3IgdGhlIGdyYXBoIG9iamVjdFxuICogXG4gKiBQb2xpY2llcyBhcmUgdXNlZCB0byBpc29sYXRlIGZlYXR1cmVzIGZvciBhIGdyYXBoLlxuICogUG9saWNpZXMgY2FuIGJlIGluc3RhbGxlZCBvbiBub2RlcywgbGlua3MsIG9yIHRoZSBncmFwaC5cbiAqIEVhY2ggcG9saWN5IGhhcyBpbnRlcmFjdGlvbiBoYW5kbGVycyB0aGF0IHdpbGwgYmUgY2FsbGVkIGJ5IHRoZSBncmFwaFxuICogaWYgaW5zdGFsbGVkLiBQb2xpY2llcyBjYW4gYWxzbyBtb2RpZnkgZ3JhcGggZnVuY3Rpb25zIChzZWUgUVRpcFBvbGljeSkuXG4gKiBNdWx0aXBsZSBwb2xpY2llcyBjYW4gYmUgaW5zdGFsbGVkIGZvciBhIG5vZGUgb3IgbGluay4gXG4gKiBcbiAqIFRvIHdyaXRlIHlvdXIgb3duIHBvbGljeSwgY3JlYXRlIGEgbmV3IGZhY3RvcnkgdGhhdCB1c2VzIHRoZSBwb2xpY3lcbiAqIHlvdSB3YW50IHRvIGluaGVyaXQgYXMgYSBkZXBlbmRlbmN5LCBhbmQgZXh0ZW5kIGl0cyBwb2xpY3kuIFxuICogUmV0dXJuIHRoZSBjbGFzcyBvYmplY3Qgd2l0aCBQb2xpY3kgYXMga2V5LCBhbmQgXG4gKiBhZGQgdGhlIHBvbGljeSB0byB0aGUgUG9saWN5U2VydmljZSBmYWN0b3J5LlxuICogXG4gKiBGb3Igc2F2aW5nIHN0YXRlIG9yIGNvbnN0cyBmb3IgdGhlIHBvbGljeSwgY3JlYXRlIGEgbmFtZXNwYWNlXG4gKiBpbiBncmFwaC5zdGF0ZSBhbmQgZ3JhcGguY29uc3RzLlxuICogRXguIFxuICogICAgICBncmFwaC5zdGF0ZS5teVBvbGljeSA9IHt9O1xuICogICAgICBncmFwaC5jb25zdHMubXlQb2xpY3kgPSB7fTtcbiAqICAgICAgXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdQb2xpY3knLCBbZnVuY3Rpb24gKCkge1xuICB2YXIgUG9saWN5ID0gZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBwb2xpY3lOYW1lICBUaGUgcG9saWN5IG5hbWVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBQb2xpY3kocG9saWN5TmFtZSkge1xuICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFBvbGljeSk7XG5cbiAgICAgIHRoaXMucG9saWN5TmFtZSA9IHBvbGljeU5hbWU7XG4gICAgICB0aGlzLmdyYXBoID0gbnVsbDtcbiAgICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgd2hlbiB0aGUgcG9saWN5IGlzIGluc3RhbGxlZC5cbiAgICAgKiBcbiAgICAgKiBAcGFyYW0gIHtHcmFwaH0gIGdyYXBoICAgVGhlIEdyYXBoIHRoYXQgdGhlIHBvbGljeSBpc1xuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICBiZWluZyBpbnN0YWxsZWQgb25cbiAgICAgKi9cblxuXG4gICAgX2NyZWF0ZUNsYXNzKFBvbGljeSwgW3tcbiAgICAgIGtleTogJ2luaXRpYWxpemUnLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemUoZ3JhcGgpIHtcbiAgICAgICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgIHRoaXMuZ3JhcGggPSBncmFwaDtcbiAgICAgIH1cblxuICAgICAgLyoqXG4gICAgICAgKiBIYW5kbGVyLCBtZWFudCB0byBiZSBvdmVycmlkZGVuIGluIHN1YmNsYXNzZXNcbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0gIHtkMyBvYmplY3R9ICAgIGQzb2JqICAgIFRoZSBkM29iamVjdFxuICAgICAgICogQHBhcmFtICB7Tm9kZS9MaW5rL0dyYXBofSAgZCAgIFRoZSBvYmplY3QgaXQgd2FzXG4gICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFsbGVkIGZvci4gICAgXG4gICAgICAgKi9cblxuICAgIH0sIHtcbiAgICAgIGtleTogJ21vdXNlb3ZlcicsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gbW91c2VvdmVyKGQzb2JqLCBkKSB7fVxuICAgIH0sIHtcbiAgICAgIGtleTogJ2RibGNsaWNrJyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBkYmxjbGljayhkM29iaiwgZCkge31cbiAgICB9LCB7XG4gICAgICBrZXk6ICdjb250ZXh0bWVudScsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gY29udGV4dG1lbnUoZDNvYmosIGQpIHt9XG4gICAgfSwge1xuICAgICAga2V5OiAnbW91c2VvdXQnLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdXNlb3V0KGQzb2JqLCBkKSB7fVxuICAgIH0sIHtcbiAgICAgIGtleTogJ21vdXNlZG93bicsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gbW91c2Vkb3duKGQzb2JqLCBkKSB7fVxuICAgIH0sIHtcbiAgICAgIGtleTogJ21vdXNldXAnLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdXNldXAoZDNvYmosIGQpIHt9XG5cbiAgICAgIC8qKlxuICAgICAgICogV2lsbCBiZSBjYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgYmVpbmcgZGVzdHJveWVkLlxuICAgICAgICogVXNlZCB0byByZW1vdmUgYW55IGVsZW1lbnRzIG9yIGJpbmRpbmdzIHRoZSBwb2xpY3lcbiAgICAgICAqIGhhcyBhZGRlZC5cbiAgICAgICAqL1xuXG4gICAgfSwge1xuICAgICAga2V5OiAnZGVzdHJveScsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHt9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIFBvbGljeTtcbiAgfSgpO1xuXG4gIHJldHVybiB7XG4gICAgUG9saWN5OiBQb2xpY3lcbiAgfTtcbn1dKTtcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5hcHBsaWNhdGlvbmdyb3VwcycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2FwcGxpY2F0aW9uZ3JvdXBzJyxcbiAgICAgICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgICAgICB9KVxuICAgIH1dKTtcblxuJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIENvbnRhaW5zIGFsbCB0aGUgcG9saWNpZXMuXG4gKiBTZWUgcG9saWN5LmpzIGZvciBpbmZvIG9uIGhvdyBwb2xpY2llcyB3b3JrLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnUG9saWN5U2VydmljZScsIFsnUG9saWN5JywgJ1FUaXBQb2xpY3knLCAnUGF0aENoYW5nZVZpZXdQb2xpY3knLCAnTm9kZVNlbGVjdGlvblBvbGljeScsICdTcGxpdEpvaW5Ob2RlUG9saWN5JywgJ1NwbGl0Sm9pblZpZXdQb2xpY3knLCAnU2F2ZVN0YXRlUG9saWN5JywgZnVuY3Rpb24gKFBvbGljeSwgUVRpcFBvbGljeSwgUGF0aENoYW5nZVZpZXdQb2xpY3ksIE5vZGVTZWxlY3Rpb25Qb2xpY3ksIFNwbGl0Sm9pbk5vZGVQb2xpY3ksIFNwbGl0Sm9pblZpZXdQb2xpY3ksIFNhdmVTdGF0ZVBvbGljeSkge1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgUG9saWN5OiBQb2xpY3kuUG9saWN5LFxuICAgICAgICBRVGlwUG9saWN5OiBRVGlwUG9saWN5LlBvbGljeSxcbiAgICAgICAgUGF0aENoYW5nZVZpZXdQb2xpY3k6IFBhdGhDaGFuZ2VWaWV3UG9saWN5LlBvbGljeSxcbiAgICAgICAgTm9kZVNlbGVjdGlvblBvbGljeTogTm9kZVNlbGVjdGlvblBvbGljeS5Qb2xpY3ksXG4gICAgICAgIFNwbGl0Sm9pbk5vZGVQb2xpY3k6IFNwbGl0Sm9pbk5vZGVQb2xpY3kuUG9saWN5LFxuICAgICAgICBTcGxpdEpvaW5WaWV3UG9saWN5OiBTcGxpdEpvaW5WaWV3UG9saWN5LlBvbGljeSxcbiAgICAgICAgU2F2ZVN0YXRlUG9saWN5OiBTYXZlU3RhdGVQb2xpY3kuUG9saWN5XG4gICAgfTtcbn1dKTtcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5kYXNoYm9hcmQnLCBbJ2NvbnRpdi5tb2RlbHMnXSk7XG5cbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxudmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQob2JqZWN0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IHJldHVybiBnZXQocGFyZW50LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpOyB9IH0gZWxzZSBpZiAoXCJ2YWx1ZVwiIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9O1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbi8qKlxuICogVGhpcyBwb2xpY3kgYWRkcyB0b29sdGlwIGZ1bmN0aW9uYWxpdHkgdG8gbm9kZXMgYW5kIGxpbmtzLlxuICogV2hlbiBpbnN0YWxsaW5nLCBpbnN0YWxsIG9uIGJvdGggbGlua3MgYW5kIG5vZGVzLlxuICogXG4gKiBVc2VzIHRoZSBxVGlwIGpRdWVyeSBwbHVnaW5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ1FUaXBQb2xpY3knLCBbJ1BvbGljeScsIGZ1bmN0aW9uIChQb2xpY3kpIHtcbiAgICB2YXIgUVRpcFBvbGljeSA9IGZ1bmN0aW9uIChfUG9saWN5JFBvbGljeSkge1xuICAgICAgICBfaW5oZXJpdHMoUVRpcFBvbGljeSwgX1BvbGljeSRQb2xpY3kpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBRVGlwUG9saWN5KCkge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFFUaXBQb2xpY3kpO1xuXG4gICAgICAgICAgICByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgT2JqZWN0LmdldFByb3RvdHlwZU9mKFFUaXBQb2xpY3kpLmNhbGwodGhpcywgXCJRVGlwUG9saWN5XCIpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgcG9saWN5IGlzIGluc3RhbGxlZFxuICAgICAgICAgKiBNb2RpZmllcyB0aGUgdXBkYXRlTmV3Tm9kZXMgYW5kIFxuICAgICAgICAgKiB1cGRhdGVOZXdQYXRocyBtZXRob2Qgb2YgdGhlIGdyYXBoIHRvIGluc3RhbGwgcXRpcFxuICAgICAgICAgKiBvbnRvIGVhY2ggbm9kZSBhbmQgcGF0aC5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgXG4gICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFsbGVkIG9uXG4gICAgICAgICAqL1xuXG5cbiAgICAgICAgX2NyZWF0ZUNsYXNzKFFUaXBQb2xpY3ksIFt7XG4gICAgICAgICAgICBrZXk6ICdpbml0aWFsaXplJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0aWFsaXplKGdyYXBoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfZ2V0KE9iamVjdC5nZXRQcm90b3R5cGVPZihRVGlwUG9saWN5LnByb3RvdHlwZSksICdpbml0aWFsaXplJywgdGhpcykuY2FsbCh0aGlzLCBncmFwaCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuUVRpcFBvbGljeSA9IHt9O1xuXG4gICAgICAgICAgICAgICAgc3RhdGUubW91c2Vkb3duID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICBncmFwaC5jb25zdHMuUVRpcFBvbGljeSA9IHt9O1xuXG4gICAgICAgICAgICAgICAgLy9UcmFja2luZyBtb3VzZSBjbGljayBzdGF0ZSB0byBtYWtlIHRvb2x0aXBcbiAgICAgICAgICAgICAgICAvL2Rpc2FwcGVhciBpZiB0aGUgbm9kZSBpcyBiZWluZyBkcmFnZ2VkLlxuICAgICAgICAgICAgICAgICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykubW91c2V1cChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5tb3VzZXVwID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvL292ZXJyaWRlIHVwZGF0ZU5ld05vZGVzIGFuZCB1cGRhdGVOZXdQYXRoc1xuICAgICAgICAgICAgICAgIC8vdG8gaW5zdGFsbCBxdGlwXG4gICAgICAgICAgICAgICAgdmFyIGdyYXBoVXBkYXRlTmV3Tm9kZXMgPSBncmFwaC51cGRhdGVOZXdOb2RlcztcbiAgICAgICAgICAgICAgICBncmFwaC51cGRhdGVOZXdOb2RlcyA9IGZ1bmN0aW9uIChuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgICAgICBncmFwaFVwZGF0ZU5ld05vZGVzLmNhbGwoZ3JhcGgsIG5ld05vZGVzKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51cGRhdGVOZXdOb2RlcyhuZXdOb2Rlcyk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHZhciBncmFwaFVwZGF0ZU5ld1BhdGhzID0gZ3JhcGgudXBkYXRlTmV3UGF0aHM7XG4gICAgICAgICAgICAgICAgZ3JhcGgudXBkYXRlTmV3UGF0aHMgPSBmdW5jdGlvbiAobmV3UGF0aHMpIHtcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGhVcGRhdGVOZXdQYXRocy5jYWxsKGdyYXBoLCBuZXdQYXRocyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kudXBkYXRlTmV3UGF0aHMobmV3UGF0aHMpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyBhbGwgcVRpcHMgZnJvbSB0aGUgRE9NLlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIHBvbGljeSBpcyB1bmluc3RhbGxlZCBvclxuICAgICAgICAgICAgICogdGhlIGdyYXBoIGlzIGRlc3Ryb3llZC5cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICAgICAgLy9yZW1vdmluZyBhbGwgcXRpcCBmcm9tIERPTVxuICAgICAgICAgICAgICAgICQoJ1tpZF49XCJxdGlwXCJdJykucmVtb3ZlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogS2VlcGluZyB0cmFjayBvZiBtb3VzZWRvd24gc3RhdGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7ZDNPYmplY3R9ICBkM29iaiAgVGhlIGQzIHBiamVjdFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGUvTGlua30gIGQgICAgIFRoZSBtYXRjaGluZyBkYXRhIG9iamVjdFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnbW91c2Vkb3duJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtb3VzZWRvd24oZDNvYmosIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuUVRpcFBvbGljeTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5tb3VzZWRvd24gPSB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEtlZXBpbmcgdHJhY2sgb2YgbW91c2Vkb3duIHN0YXRlXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzT2JqZWN0fSAgZDNvYmogIFRoZSBkMyBwYmplY3RcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlL0xpbmt9ICBkICAgICBUaGUgbWF0Y2hpbmcgZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ21vdXNldXAnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdXNldXAoZDNvYmosIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuUVRpcFBvbGljeTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5tb3VzZWRvd24gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnd2hlblFUaXBBdmFpbGFibGUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHdoZW5RVGlwQXZhaWxhYmxlKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBpbnRlcnZhbCA9IDUwMDsgLy8gbXNcbiAgICAgICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkKGRvY3VtZW50KS5xdGlwICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dCh0aGlzUG9saWN5LndoZW5RVGlwQXZhaWxhYmxlKGNhbGxiYWNrKSwgaW50ZXJ2YWwpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgaW50ZXJ2YWwpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIE5ldyBOb2RlcyBhcmUgYWRkZWQgZHVyaW5nIHRoZVxuICAgICAgICAgICAgICogdXBkYXRlIGdyYXBoIGZ1bmN0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzTm9kZX0gIG5ld05vZGVzICBUaGUgbmV3IG5vZGVzIHRoYXQgYXJlXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlaW5nIGFkZGVkIHRvIHRoZSBncmFwaFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAndXBkYXRlTmV3Tm9kZXMnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZU5ld05vZGVzKG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlFUaXBQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhdHRhY2hRVGlwKCkge1xuICAgICAgICAgICAgICAgICAgICAvL2F0dGFjaGluZyBxdGlwXG4gICAgICAgICAgICAgICAgICAgIG5ld05vZGVzLmVhY2goZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aGlzTm9kZSA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL0lmIG5vZGUgaGFzIGNoaWxkcmVuLCB0aGVuIGl0IGlzIGEgc2VydmljZVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFtkLmlkXSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IFwiPGI+PHU+U2VsZWN0b3JzOjwvYj48L3U+IFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZWxlY3Rvck1hcCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnNlbGVjdG9yc1tkLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGFzS2V5cyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBzZWxlY3Rvck1hcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNLZXlzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSBrZXkgKyBcIiA6IDxpPlwiICsgc2VsZWN0b3JNYXBba2V5XSArIFwiPC9pPixcXG4gXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoYXNLZXlzID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbW1hIHdpbGwgYmUgcmVtb3ZlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gXCJObyBTZWxlY3RvcnMsIFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IFwiPGI+PHU+TGFiZWxzOjwvYj48L3U+IFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsYWJlbHNNYXAgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5sYWJlbHNbZC5pZF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhhc0tleXMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gbGFiZWxzTWFwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc0tleXMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ICs9IGtleSArIFwiIDogPGk+XCIgKyBsYWJlbHNNYXBba2V5XSArIFwiPC9pPixcXG4gXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoYXNLZXlzID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbW1hIHdpbGwgYmUgcmVtb3ZlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gXCJObyBsYWJlbHMsIFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vcmVtb3ZlIGxhc3QgY29tbWFcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSB0ZXh0LnNsaWNlKDAsIC0yKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzTm9kZSkucXRpcCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogZC5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3c6IGZ1bmN0aW9uIHNob3coKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXBpID0gJCh0aGlzTm9kZSkucXRpcCgnYXBpJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gJCgnI2dyYXBoQ29udGFpbmVyJykub2Zmc2V0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9zaXRpb24gPSBbb2Zmc2V0LmxlZnQgKyAoZC54ICogdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKSArIHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpWzBdKSwgb2Zmc2V0LnRvcCArIChkLnkgKyBkLnJhZGl1cykgKiB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpICsgdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKClbMV1dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBpLnNldCgncG9zaXRpb24udGFyZ2V0JywgcG9zaXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICFzdGF0ZS5tb3VzZWRvd247XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3c6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsYXk6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvbG86ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzZXM6ICdxdGlwLWJsdWUgcXRpcC1zaGFkb3cnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBteTogJ3RvcCBjZW50ZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdDogJ2JvdHRvbSBjZW50ZXInXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRhcmdldDogcG9zaXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQ6ICdtb3VzZWRvd24gbW91c2VsZWF2ZSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vaW5jYXNlIGxpYnJhcnkgaGFzbid0IGxvYWRlZCB5ZXRcbiAgICAgICAgICAgICAgICBpZiAoJChkb2N1bWVudCkucXRpcCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgYXR0YWNoUVRpcCgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMud2hlblFUaXBBdmFpbGFibGUoYXR0YWNoUVRpcCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIG5ldyBwYXRocyBhcmUgYWRkZWQgZHVyaW5nIHRoZVxuICAgICAgICAgICAgICogdXBkYXRlIGdyYXBoIGZ1bmN0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzUGF0aH0gIG5ld1BhdGhzICBUaGUgbmV3IHBhdGhzIHRoYXQgYXJlXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlaW5nIGFkZGVkIHRvIHRoZSBncmFwaFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAndXBkYXRlTmV3UGF0aHMnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZU5ld1BhdGhzKG5ld1BhdGhzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlFUaXBQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICAvL2luY2FzZSBsaWJyYXJ5IGhhc24ndCBsb2FkZWQgeWV0XG4gICAgICAgICAgICAgICAgaWYgKCQoZG9jdW1lbnQpLnF0aXAgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vYWRkaW5nIHF0aXBcbiAgICAgICAgICAgICAgICAgICAgbmV3UGF0aHMuZWFjaChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRoaXNQYXRoID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vZ2V0dGluZyBtaWRwb2ludCBvZiBwYXRoXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aEVsID0gZDMuc2VsZWN0KHRoaXMpLm5vZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtaWRwb2ludCA9IHBhdGhFbC5nZXRQb2ludEF0TGVuZ3RoKHBhdGhFbC5nZXRUb3RhbExlbmd0aCgpIC8gMik7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0UmV0ID0gZC5xdGlwSGVscGVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IFwiQnl0ZXM6IFwiICsgZC5nZXRXZWlnaHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpc1BhdGgpLnF0aXAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3c6IGZ1bmN0aW9uIHNob3coKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2lmIG1vdXNlIGlzIGRvd24sIGRvbid0IGxldCBxdGlwIHNob3dcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhc3RhdGUubW91c2Vkb3duO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGF5OiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb2xvOiAkKCcjZ3JhcGhDb250YWluZXInKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NlczogJ3F0aXAtYmx1ZSBxdGlwLXNoYWRvdydcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG15OiB0YXJnZXRSZXQubXksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0OiAnY2VudGVyIGNlbnRlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogJ21vdXNlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRqdXN0OiB0YXJnZXRSZXQuYWRqdXN0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaWRlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50OiAnbW91c2Vkb3duIG1vdXNlbGVhdmUnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIFFUaXBQb2xpY3k7XG4gICAgfShQb2xpY3kuUG9saWN5KTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIFBvbGljeTogUVRpcFBvbGljeVxuICAgIH07XG59XSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubG9naW4nLCBbJ2NvbnRpdi51dGlscyddKTtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG4vKipcbiAqIFRoaXMgcG9saWN5IHByb3ZpZGVzIGEgd2F5IGZvciBwcm9wZXJ0aWVzIHRvIGJlIHNhdmVkIFxuICogYmV0d2VlbiB2aWV3IGNoYW5nZXNcbiAqIFxuICogSXQgbW9kaWZpZXMgdGhlIGRlc3Ryb3kgZnVuY3Rpb24gdG8gYWxzbyBwYXNzIGluIGFuIG9iamVjdCB0aGF0XG4gKiB3aWxsIGhhdmUgYWxsIGl0cyBwcm9wZXJ0aWVzIHNhdmVkIGFuZCB3aWxsIGJlIGF2YWlsYWJsZSBcbiAqIG9uIGdyYXBoIGxvYWQuIFdoZW4gc2F2aW5nIHZhcmlhYmxlcyB0byB0aGUgb2JqZWN0LCBuYW1lc3BhY2Ugd2l0aFxuICogdGhlIHBvbGljeSBuYW1lLlxuICogXG4gKiBUaGlzIHBvbGljeSBtdXN0IGJlIGxvYWRlZCBmaXJzdCBpbiBvcmRlciBmb3IgaXQgc2F2ZWQgdmFyaWFibGVzIFxuICogdG8gYmUgbG9hZGVkIHdoZW4gdGhlIHZpZXcgY29tZXMgYmFjayB0byB0aGUgZ3JhcGhcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ1NhdmVTdGF0ZVBvbGljeScsIFsnUG9saWN5JywgZnVuY3Rpb24gKFBvbGljeSkge1xuICAgIHZhciBTYXZlU3RhdGVQb2xpY3kgPSBmdW5jdGlvbiAoX1BvbGljeSRQb2xpY3kpIHtcbiAgICAgICAgX2luaGVyaXRzKFNhdmVTdGF0ZVBvbGljeSwgX1BvbGljeSRQb2xpY3kpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUYWtlcyBpbiB0aGUgYW5ndWxhciBzZXJ2aWNlIHRvIHdoaWNoIGl0IHdpbGxcbiAgICAgICAgICogc2F2ZSBpdCdzIHByb3BlcnRpZXMgdG8uXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBzYXZlZFN0YXRlICBPYmplY3QgdG8gc2F2ZSBcbiAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXMgdG9cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIFNhdmVTdGF0ZVBvbGljeShzYXZlZFN0YXRlKSB7XG4gICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU2F2ZVN0YXRlUG9saWN5KTtcblxuICAgICAgICAgICAgdmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgT2JqZWN0LmdldFByb3RvdHlwZU9mKFNhdmVTdGF0ZVBvbGljeSkuY2FsbCh0aGlzLCAnU2F2ZVN0YXRlUG9saWN5JykpO1xuXG4gICAgICAgICAgICBfdGhpcy5zYXZlZFN0YXRlID0gc2F2ZWRTdGF0ZTtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgcG9saWN5IGlzIGluc3RhbGxlZFxuICAgICAgICAgKiBNb2RpZmllcyB0aGUgZGVzdHJveSBtZXRob2QgXG4gICAgICAgICAqIGFuZCBhZGRzIGEgbG9hZCBtZXRob2QgdG8gdGhlIGdyYXBoXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoIGl0IGlzIFxuICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbGxlZCBvblxuICAgICAgICAgKi9cblxuXG4gICAgICAgIF9jcmVhdGVDbGFzcyhTYXZlU3RhdGVQb2xpY3ksIFt7XG4gICAgICAgICAgICBrZXk6ICdpbml0aWFsaXplJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0aWFsaXplKGdyYXBoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5ncmFwaCA9IGdyYXBoO1xuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICBncmFwaC5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LmdyYXBoRGVzdHJveS5jYWxsKGdyYXBoLCB0aGlzUG9saWN5LnNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBncmFwaC5sb2FkID0gZnVuY3Rpb24gKHNhdmVkU3RhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS5ncmFwaExvYWQuY2FsbChncmFwaCwgc2F2ZWRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBXaWxsIG92ZXJyaWRlIHRoZSBncmFwaCdzIGRlZmF1bHQgZGVzdHJveSwgd2l0aCBcbiAgICAgICAgICAgICAqIHRoaXMgcG9saWN5J3Mgc2F2ZWRTdGF0ZSBwYXNzZWQgaW4uXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2l0aCB0aGlzIGFzIHRoZSBncmFwaFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBzYXZlZFN0YXRlICBUaGUgc2F2ZWQgc3RhdGVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2dyYXBoRGVzdHJveScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ3JhcGhEZXN0cm95KHNhdmVkU3RhdGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5LmRlc3Ryb3koc2F2ZWRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KHNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzR3JhcGguYmluZGluZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgJCh3aW5kb3cpLm9mZihrZXksIHRoaXNHcmFwaC5iaW5kaW5nc1trZXldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2lsbCBiZSBjYWxsZWQgd2l0aCB0aGUgZ3JhcGggYXMgdGhpc1xuICAgICAgICAgICAgICogVXNlZCB0byBoYXZlIGFsbCBvdGhlciBwb2xpY2llcyB1c2UgdGhlIGxvYWQgc3RhdGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgc2F2ZWRTdGF0ZSAgVGhlIHNhdmVkIHN0YXRlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdncmFwaExvYWQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdyYXBoTG9hZChzYXZlZFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb2xpY3kubG9hZCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2xpY3kubG9hZChzYXZlZFN0YXRlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9saWN5LmxvYWQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9saWN5LmxvYWQoc2F2ZWRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfV0pO1xuXG4gICAgICAgIHJldHVybiBTYXZlU3RhdGVQb2xpY3k7XG4gICAgfShQb2xpY3kuUG9saWN5KTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIFBvbGljeTogU2F2ZVN0YXRlUG9saWN5XG4gICAgfTtcbn1dKTtcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5tZW51JywgW10pO1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG52YXIgX2dldCA9IGZ1bmN0aW9uIGdldChvYmplY3QsIHByb3BlcnR5LCByZWNlaXZlcikgeyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7IH0gfSBlbHNlIGlmIChcInZhbHVlXCIgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH07XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuLyoqXG4gKiBUaGlzIHBvbGljeSBpcyB1c2VkIGZvciBzcGxpdHRpbmcgYSBub2RlIGludG8gaXRzIGNoaWxkcmVuLFxuICogYW5kIGpvaW5pbmcgdGhlbSBiYWNrIHRvIHRoZWlyIHBhcmVudC5cbiAqIFNwbGl0cyBvbiBkb3VibGUgY2xpY2ssIGFuZCBqb2lucyBvbiByaWdodCBjbGljay5cbiAqIElmIG11bHRpcGxlIG5vZGVzIGFyZSBzZWxlY3RlZCBhdCB0aGUgdGltZSBvZiBhIHNwbGl0IG9yIGpvaW4gZXZlbnQsXG4gKiBpdCB3aWxsIHNwbGl0IG9yIGpvaW4gYWxsIG9mIHRoZW0uXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdTcGxpdEpvaW5Ob2RlUG9saWN5JywgWydOb2RlU2VsZWN0aW9uUG9saWN5JywgJ1Zpc3VhbGl6ZXJOb2RlJywgZnVuY3Rpb24gKE5vZGVTZWxlY3Rpb25Qb2xpY3ksIFZpc3VhbGl6ZXJOb2RlKSB7XG4gICAgdmFyIFNwbGl0Sm9pbk5vZGVQb2xpY3kgPSBmdW5jdGlvbiAoX05vZGVTZWxlY3Rpb25Qb2xpY3kkKSB7XG4gICAgICAgIF9pbmhlcml0cyhTcGxpdEpvaW5Ob2RlUG9saWN5LCBfTm9kZVNlbGVjdGlvblBvbGljeSQpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBTcGxpdEpvaW5Ob2RlUG9saWN5KCkge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNwbGl0Sm9pbk5vZGVQb2xpY3kpO1xuXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoU3BsaXRKb2luTm9kZVBvbGljeSkuY2FsbCh0aGlzKSk7XG5cbiAgICAgICAgICAgIF90aGlzLnBvbGljeU5hbWUgPSBcIlNwbGl0Sm9pbk5vZGVQb2xpY3lcIjtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYWxsZWQgd2hlbiBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoXG4gICAgICAgICAqL1xuXG5cbiAgICAgICAgX2NyZWF0ZUNsYXNzKFNwbGl0Sm9pbk5vZGVQb2xpY3ksIFt7XG4gICAgICAgICAgICBrZXk6ICdpbml0aWFsaXplJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0aWFsaXplKGdyYXBoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfZ2V0KE9iamVjdC5nZXRQcm90b3R5cGVPZihTcGxpdEpvaW5Ob2RlUG9saWN5LnByb3RvdHlwZSksICdpbml0aWFsaXplJywgdGhpcykuY2FsbCh0aGlzLCBncmFwaCk7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuU3BsaXRKb2luTm9kZVBvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLnNwbGl0Tm9kZXMgPSBbXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUcmlnZ2VyaW5nIHNwbGl0IG9uIGRvdWJsZSBjbGlja1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBkICAgICAgVGhlIG1hdGNoaW5nIGRhdGEgb2JqZWN0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkYmxjbGljaycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGJsY2xpY2soZDNub2RlLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN1cGVyU3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luTm9kZVBvbGljeTtcblxuICAgICAgICAgICAgICAgIGlmICghZDMuZXZlbnQuY3RybEtleSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3VwZXJTdGF0ZS5zZWxlY3RlZE5vZGVzLmluZGV4T2YoZCkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGxpdE11bHRpcGxlTm9kZXMoc3VwZXJTdGF0ZS5zZWxlY3RlZE5vZGVzKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQWxsU2VsZWN0ZWROb2RlcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGxpdE5vZGUoZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVHJpZ2dlcmluZyBqb2luIG9uIHJpZ2h0IGNsaWNrXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqfSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGQgICAgICBUaGUgbWF0Y2hpbmcgZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2NvbnRleHRtZW51JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb250ZXh0bWVudShkM25vZGUsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3VwZXJTdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuICAgICAgICAgICAgICAgIGQzLmV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgaWYgKCFkMy5ldmVudC5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgdHJ5IHRvIGpvaW4gYSBoaWdobGlnaHRlZCBub2RlIHdoaWxlIG11bHRpcGxlIG5vZGVzIGFyZSBzZWxlY3RlZCxcbiAgICAgICAgICAgICAgICAgICAgLy93ZSBqb2luIGFsbCBoaWdobGlnaHRlZCBub2Rlc1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWROb2RlcyA9IHN1cGVyU3RhdGUuc2VsZWN0ZWROb2RlcztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkTm9kZXMuaW5kZXhPZihkKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGVjdGVkTm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmpvaW5Ob2RlKHNlbGVjdGVkTm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9pZiB3ZSB0cnkgdG8gam9pbiBhIG5vZGUgdGhhdCBpc24ndCBwYXJ0IG9mIGEgaGlnaGxpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAgICAgLy93ZSByZW1vdmUgYWxsIGhpZ2hsaWdodHMgYW5kIHRoZW4gam9pbiB0aGUgY2xpY2tlZCBub2RlXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUFsbFNlbGVjdGVkTm9kZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuam9pbk5vZGUoZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU3BsaXRzIGEgbm9kZS5cbiAgICAgICAgICAgICAqIHVzZWQgdG8gc2hhcmUgY29kZSBiZXR3ZWVuIHNwbGl0Tm9kZSBhbmQgc3BsaXRNdWx0aXBsZU5vZGVzXG4gICAgICAgICAgICAgKiB3aGlsZSBwcmV2ZW50aW5nIHRoZSBoYW5kbGVycyBmb3IgdGhlbSBib3RoIGZpcmluZ1xuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGUgYmVpbmcgc3BsaXRcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIFRoZSBuZXcgbm9kZXMgY3JlYXRlZCBieSB0aGUgc3BsaXRcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ19fc3BsaXROb2RlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfX3NwbGl0Tm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pbk5vZGVQb2xpY3k7XG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBub2RlLmlkO1xuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgLy9pZiBpdCBoYXMgbm8gY2hpbGRyZW4gdG8gc3BsaXQgaW50b1xuICAgICAgICAgICAgICAgIGlmIChjaGlsZHJlbl9zdHJ1Y3RbbmFtZV0gPT09IHVuZGVmaW5lZCB8fCBfLmlzRW1wdHkoY2hpbGRyZW5fc3RydWN0W25hbWVdKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9yZW1vdmluZyB0aGUgbm9kZSBmcm9tIHRoZSBsaXN0IG9mIG5vZGVzXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzID0gXy5maWx0ZXIodGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbiAoZ3JhcGhOb2Rlcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ3JhcGhOb2RlcyAhPSBub2RlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXNHcmFwaC5ub2Rlcyk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlKTtcblxuICAgICAgICAgICAgICAgIC8vZ2V0dGluZyBhbGwgdGhlIG5vZGUgaWQncyBmb3IgZmluZGluZyBmbG93XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVfbmFtZXNfc2V0ID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZV9uYW1lc19zZXQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0uaWQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vc2V0IG9mIG5vZGVzIGFmdGVyIHRoZSBzcGxpdFxuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoaWxkcmVuX3N0cnVjdFtuYW1lXS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBub2RlX25hbWVzX3NldC5wdXNoKGNoaWxkcmVuX3N0cnVjdFtuYW1lXVtpXSk7XG4gICAgICAgICAgICAgICAgICAgIG5ld19ub2Rlcy5wdXNoKGNoaWxkcmVuX3N0cnVjdFtuYW1lXVtpXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciByZXREYXRhID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuZ2V0Rmxvd0JldHdlZW5TZXQobm9kZV9uYW1lc19zZXQpO1xuXG4gICAgICAgICAgICAgICAgLy9mb3JtYXR0aW5nIGRhdGEgZm9yIG5ldyBub2Rlc1xuICAgICAgICAgICAgICAgIHZhciB4TG9jID0gbm9kZS54O1xuICAgICAgICAgICAgICAgIHZhciB5TG9jID0gbm9kZS55O1xuICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnMgPSBub2RlLmFuY2VzdG9ycy5zbGljZSgpO1xuICAgICAgICAgICAgICAgIC8va2VlcGluZyBvcmRlcmluZyB0aGF0IGZpcnN0IGluIGFuY2VzdG9yIGxpc3QgaXMgY2xvc2VzdCBpbiByZWxhdGlvbnNoaXBcbiAgICAgICAgICAgICAgICBhbmNlc3RvcnMuc3BsaWNlKDAsIDAsIG5vZGUuaWQpO1xuICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBub2RlLmlkO1xuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZV9vYmpzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIHJhZGl1cyA9IG5vZGUucmFkaXVzICogdGhpc0dyYXBoLmNvbnN0cy5yYWRpdXNEZWNheTtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZURhdGEgPSByZXREYXRhLm5vZGVEYXRhO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZURhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgLy9jYWxjdWxhdGluZyB3aGljaCBvZiB0aGUgbm9kZXMgaW4gcmV0RGF0YVswXSBhcmUgbmV3XG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXdfbm9kZXMuaW5kZXhPZihub2RlRGF0YVtpXS5pZCkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkID0gbm9kZURhdGFbaV0uaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IG5vZGVEYXRhW2ldLnRleHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGUgPSBuZXcgVmlzdWFsaXplck5vZGUuTm9kZShudWxsLCBudWxsLCBpZCwgdGV4dCwgcmFkaXVzLCBwYXJlbnQsIGFuY2VzdG9ycywgeExvYywgeUxvYyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdfbm9kZS5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMucHVzaChuZXdfbm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdfbm9kZV9vYmpzLnB1c2gobmV3X25vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YShyZXREYXRhLmxpbmtEYXRhLCB0aGlzR3JhcGgubm9kZXMpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0Tm9kZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdExpbmtzKCk7XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS5zcGxpdE5vZGVzLnB1c2gobm9kZS5pZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ld19ub2RlX29ianM7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU3BsaXRzIHRoZSBnaXZlIG5vZGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGUgYmVpbmcgc3BsaXRcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3NwbGl0Tm9kZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3BsaXROb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzID0gdGhpcy5fX3NwbGl0Tm9kZShub2RlKTtcbiAgICAgICAgICAgICAgICBpZiAocmVzID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnNwbGl0Tm9kZUV2ZW50KHJlcyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU3BsaXRzIGFsbCB0aGUgbm9kZXMgcGFzc2VkIGluXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZXMgICBBcnJheSBvZiBub2RlcyB0byBiZSBzcGxpdFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnc3BsaXRNdWx0aXBsZU5vZGVzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzcGxpdE11bHRpcGxlTm9kZXMobm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaDtcbiAgICAgICAgICAgICAgICB2YXIgcmVzTm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSB0aGlzLl9fc3BsaXROb2RlKG5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzTm9kZXMgPSByZXNOb2Rlcy5jb25jYXQocmVzKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLnNwbGl0TXVsdGlwbGVOb2Rlc0V2ZW50KHJlcyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIGFmdGVyIGEgc2luZ2xlIG5vZGUgaXMgc3BsaXRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBuZXdOb2RlcyAgVGhlIG5ldyBub2Rlc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnc3BsaXROb2RlRXZlbnQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNwbGl0Tm9kZUV2ZW50KG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNldFBvc2l0aW9ucygpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBtdWx0aXBsZSBub2RlcyBhcmUgc3BsaXQgYXQgb25jZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5ld05vZGVzICBUaGUgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdzcGxpdE11bHRpcGxlTm9kZXNFdmVudCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3BsaXRNdWx0aXBsZU5vZGVzRXZlbnQobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaDtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc2V0UG9zaXRpb25zKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogdXNlZCB0byBzaGFyZSBjb2RlIGJldHdlZW4gam9pbk5vZGUgYW5kIGpvaW5NdWx0aXBsZU5vZGVcbiAgICAgICAgICAgICAqIHdoaWxlIHByZXZlbnRpbmcgYm90aCBoYW5kbGVycyBmaXJpbmdcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgICAgIG5vZGUgICAgVGhlIG5vZGUgdG8gam9pblxuICAgICAgICAgICAgICogQHJldHVybiAgICAge05vZGV9ICBUaGUgbmV3IG5vZGUgYWZ0ZXIgdGhlIGpvaW5cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ19fam9pbk5vZGUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9fam9pbk5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5Ob2RlUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgLy9jaGVjayB0aGF0IG5vZGUgc3RpbGwgZXhpc3RzXG4gICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG5vZGUpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gbm9kZS5pZDtcbiAgICAgICAgICAgICAgICAvL2lmIGl0IGhhcyBubyBhbmNlc3Rvciwgbm90aGluZyB0byBqb2luXG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbC5pbmRleE9mKG5hbWUpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciB0b19iZV9kZWxldGVkID0gW107XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVfbmFtZXNfc2V0ID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgLy9pZiBub2RlIHdvbid0IGJlIGNvbGxhcHNlZFxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLm5vZGVzW2ldLmFuY2VzdG9ycy5pbmRleE9mKG5vZGUucGFyZW50KSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZV9uYW1lc19zZXQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0uaWQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9fYmVfZGVsZXRlZC5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlX2lkID0gbm9kZS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgbm9kZV9uYW1lc19zZXQucHVzaChub2RlLnBhcmVudCk7XG5cbiAgICAgICAgICAgICAgICAvL2Zvcm1hdHRpbmcgZGF0YVxuICAgICAgICAgICAgICAgIHZhciByYWRpdXMgPSBub2RlLnJhZGl1cyAvIHRoaXNHcmFwaC5jb25zdHMucmFkaXVzRGVjYXk7XG4gICAgICAgICAgICAgICAgdmFyIHhMb2MgPSBub2RlLng7XG4gICAgICAgICAgICAgICAgdmFyIHlMb2MgPSBub2RlLnk7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IG5vZGUuYW5jZXN0b3JzWzFdO1xuICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnMgPSBub2RlLmFuY2VzdG9ycy5zbGljZSgxKTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGUgPSBuZXcgVmlzdWFsaXplck5vZGUuTm9kZSh4TG9jLCB5TG9jLCBuZXdfbm9kZV9pZCwgbmV3X25vZGVfaWQsIHJhZGl1cywgcGFyZW50LCBhbmNlc3RvcnMpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5wdXNoKG5ld19ub2RlKTtcblxuICAgICAgICAgICAgICAgIHZhciByZXREYXRhID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuZ2V0Rmxvd0JldHdlZW5TZXQobm9kZV9uYW1lc19zZXQpO1xuICAgICAgICAgICAgICAgIC8vcmVtb3ZlIGFsbCBub2RlcyB0aGF0IHdpbGwgYmUgam9pbmVkXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b19iZV9kZWxldGVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlX3RvX2RlbGV0ZSA9IHRvX2JlX2RlbGV0ZWRbaV07XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5zcGxpY2UodGhpc0dyYXBoLm5vZGVzLmluZGV4T2Yobm9kZV90b19kZWxldGUpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlX3RvX2RlbGV0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YShyZXREYXRhLmxpbmtEYXRhLCB0aGlzR3JhcGgubm9kZXMpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0Tm9kZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdExpbmtzKCk7XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS5zcGxpdE5vZGVzLnNwbGljZShzdGF0ZS5zcGxpdE5vZGVzLmluZGV4T2YobmV3X25vZGUuaWQpLCAxKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBuZXdfbm9kZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBKb2lucyB0aGUgZ2l2ZW4gbm9kZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZSB0byBqb2luXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdqb2luTm9kZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gam9pbk5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciBuZXdOb2RlID0gdGhpcy5fX2pvaW5Ob2RlKG5vZGUpO1xuICAgICAgICAgICAgICAgIGlmIChuZXdOb2RlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5qb2luTm9kZUV2ZW50KG5ld05vZGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBKb2lucyBhbGwgdGhlIGdpdmVuIG5vZGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZXMgICBUaGUgbm9kZXMgdG8gam9pblxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnam9pbk11bHRpcGxlTm9kZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gam9pbk11bHRpcGxlTm9kZShub2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSB0aGlzLl9fam9pbk5vZGUobm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICBuZXdfbm9kZXMucHVzaChyZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmpvaW5NdWx0aXBsZU5vZGVzRXZlbnQobmV3X25vZGVzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgYWZ0ZXIgYSBzaW5nbGUgbm9kZSBpcyBqb2luZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5ld05vZGUgIFRoZSBuZXcgbm9kZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnam9pbk5vZGVFdmVudCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gam9pbk5vZGVFdmVudChuZXdOb2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIGFmdGVyIG11bHRpcGxlIG5vZGVzIGFyZSBqb2luZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBuZXdOb2RlcyAgVGhlIG5ldyBub2Rlc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnam9pbk11bHRpcGxlTm9kZXNFdmVudCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gam9pbk11bHRpcGxlTm9kZXNFdmVudChuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIFNwbGl0Sm9pbk5vZGVQb2xpY3k7XG4gICAgfShOb2RlU2VsZWN0aW9uUG9saWN5LlBvbGljeSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBQb2xpY3k6IFNwbGl0Sm9pbk5vZGVQb2xpY3lcbiAgICB9O1xufV0pO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3BvbGljaWVzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL25ldHdvcmtwb2xpY2llcycsXG4gICAgICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbicsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvaXNvbGF0aW9uJyxcbiAgICAgICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogJzx1aS12aWV3Lz4nXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuYmFuZHdpZHRoJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9iYW5kd2lkdGgnLFxuICAgICAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAnPHVpLXZpZXcvPidcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5yZWRpcmVjdGlvbicsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvcmVkaXJlY3Rpb24nLFxuICAgICAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAnPHVpLXZpZXcvPidcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSk7XG5cbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxudmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQob2JqZWN0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IHJldHVybiBnZXQocGFyZW50LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpOyB9IH0gZWxzZSBpZiAoXCJ2YWx1ZVwiIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9O1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbi8qKlxuICogVGhpcyBwb2xpY3kgaXMgdXNlZCB0byBjaGFuZ2UgdGhlIHZpZXcgdG8gZm9jdXMgb24gc3BsaXR0aW5nIGFuZCBcbiAqIGpvaW5pbmcgZXZlbnRzLlxuICogT3ZlcnJpZGVzIHRoZSBjZXJ0YWluIGZvcmNlIGxheW91dCBmdW5jdGlvbnMgb2YgdGhlIGdyYXBoIHRvIHBhcnRpdGlvbiBhIHNwbGl0XG4gKiBpbnRvIHRoZSBmb2N1c2VkIG5vZGVzIGFuZCB0aGUgY29ubmVjdGVkIG5vZGVzLlxuICogXG4gKiBIYXMgc2F2ZS9sb2FkIG1ldGhvZHMgZm9yIHRoZSBzYXZlIHN0YXRlIHBvbGljeS5cbiAqIEhhcyBiYWNrIGJ1dHRvbiBzdXBwb3J0LlxuICogQ2FuIGF1dG8gY2hhbmdlIHRoZSB0aXRsZSBvZiB0aGUgZ3JhcGguXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdTcGxpdEpvaW5WaWV3UG9saWN5JywgWydTcGxpdEpvaW5Ob2RlUG9saWN5JywgJ1Zpc3VhbGl6ZXJOb2RlJywgZnVuY3Rpb24gKFNwbGl0Sm9pbk5vZGVQb2xpY3ksIFZpc3VhbGl6ZXJOb2RlKSB7XG4gICAgdmFyIFNwbGl0Sm9pblZpZXdQb2xpY3kgPSBmdW5jdGlvbiAoX1NwbGl0Sm9pbk5vZGVQb2xpY3kkKSB7XG4gICAgICAgIF9pbmhlcml0cyhTcGxpdEpvaW5WaWV3UG9saWN5LCBfU3BsaXRKb2luTm9kZVBvbGljeSQpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBTcGxpdEpvaW5WaWV3UG9saWN5KCkge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNwbGl0Sm9pblZpZXdQb2xpY3kpO1xuXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoU3BsaXRKb2luVmlld1BvbGljeSkuY2FsbCh0aGlzKSk7XG5cbiAgICAgICAgICAgIF90aGlzLnBvbGljeU5hbWUgPSBcIlNwbGl0Sm9pblZpZXdQb2xpY3lcIjtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYWxsZWQgd2hlbiBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoXG4gICAgICAgICAqL1xuXG5cbiAgICAgICAgX2NyZWF0ZUNsYXNzKFNwbGl0Sm9pblZpZXdQb2xpY3ksIFt7XG4gICAgICAgICAgICBrZXk6ICdpbml0aWFsaXplJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0aWFsaXplKGdyYXBoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfZ2V0KE9iamVjdC5nZXRQcm90b3R5cGVPZihTcGxpdEpvaW5WaWV3UG9saWN5LnByb3RvdHlwZSksICdpbml0aWFsaXplJywgdGhpcykuY2FsbCh0aGlzLCBncmFwaCk7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLnNhdmVkU3RhdGVzID0gW107XG4gICAgICAgICAgICAgICAgLy8gc3RhdGUuZm9jdXNHcm91cCA9IG51bGw7XG4gICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5ID0gW107XG4gICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMgPSBbXTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5mb2NpID0gW107XG4gICAgICAgICAgICAgICAgc3RhdGUuem9vbXMgPSB7fTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5sYXlvdXQgPSB7fTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5sYXlvdXREZWZhdWx0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS56b29tRGVmYXVsdCA9IG51bGw7XG4gICAgICAgICAgICAgICAgc3RhdGUubm9kZUlkc1RvUmVzaG93ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uRWxlbSA9IG51bGw7XG4gICAgICAgICAgICAgICAgc3RhdGUudGl0bGVFbGVtID0gbnVsbDtcblxuICAgICAgICAgICAgICAgIHZhciBjb25zdHMgPSBncmFwaC5jb25zdHMuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIGNvbnN0cy5ib3VuZGFyeSA9IDAuODtcblxuICAgICAgICAgICAgICAgIC8vb3ZlcnJpZGluZyBkM2ZvcmNlIG1ldGhvZHMgb2YgdGhlIGdyYXBoLlxuICAgICAgICAgICAgICAgIGdyYXBoLmQzRm9yY2VCb3VuZHMgPSB0aGlzLmQzRm9yY2VCb3VuZHM7XG4gICAgICAgICAgICAgICAgZ3JhcGguZDNGb3JjZVRpY2sgPSB0aGlzLmQzRm9yY2VUaWNrO1xuICAgICAgICAgICAgICAgIGdyYXBoLmQzRm9yY2VTdGFydCA9IHRoaXMuZDNGb3JjZVN0YXJ0O1xuICAgICAgICAgICAgICAgIGdyYXBoLmQzRm9yY2VFbmQgPSB0aGlzLmQzRm9yY2VFbmQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogTGlua3MgdGhlIHByb3ZpZGVkIGVsZW1lbnQgYSBiYWNrIGJ1dHRvbiBmZWF0dXJlXG4gICAgICAgICAgICAgKiBEb2Vzbid0IHRyaWdnZXIgdGhlIG9uLWNsaWNrIGV2ZW50XG4gICAgICAgICAgICAgKiBUaGF0IHNob3VsZCBiZSBkb25lIHRocm91Z2ggYW5ndWxhciBuZy1jbGljay5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7alF1ZXJ5fSAgZWxlbSAgICBUaGUganF1ZXJ5IHNlbGVjdGVkIGVsZW1lbnRcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2luc3RhbGxCYWNrQnV0dG9uJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbnN0YWxsQmFja0J1dHRvbihlbGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kgPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgc3RhdGUuYmFja0J1dHRvbkVsZW0gPSBlbGVtO1xuICAgICAgICAgICAgICAgIHN0YXRlLmJhY2tCdXR0b24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51bmRvTGFzdEV2ZW50LmNhbGwodGhpc1BvbGljeSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgYWxsb3cgdGhpcyBwb2xpY3kgdG8gY2hhbmdlIHRoZSB0aXRsZSBvZiB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqIGFzIHNwbGl0IGFuZCBqb2luIGV2ZW50cyBvY2N1ci5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7alF1ZXJ5fSAgZWxlbSAgICBUaGUganF1ZXJ5IHNlbGVjdGVkIGVsZW1lbnRcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2luc3RhbGxUaXRsZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5zdGFsbFRpdGxlKGVsZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIHN0YXRlLnRpdGxlRWxlbSA9IGVsZW07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIGJlaW5nIGRlc3Ryb3llZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBzYXZlZFN0YXRlICBBbnkgcHJvcGVydHkgb24gdGhpc1xuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdCB3aWxsIGJlIGFjY2Vzc2libGVcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGVuIHRoZSB2aWV3IHJlbG9hZHNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koc2F2ZWRTdGF0ZSkge1xuICAgICAgICAgICAgICAgIC8vT25seSBpZiB0aGUgc2F2ZSBzdGF0ZSBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAgICAgICAgaWYgKHNhdmVkU3RhdGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNhdmUoc2F2ZWRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgc2F2ZSB0aGUgY3VycmVudCBzdGF0ZSwgYW5kIGFsbCBoaXN0b3J5LlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBzYXZlZFN0YXRlICBBbnkgcHJvcGVydHkgb24gdGhpc1xuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdCB3aWxsIGJlIGFjY2Vzc2libGVcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGVuIHRoZSB2aWV3IHJlbG9hZHNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3NhdmUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNhdmUoc2F2ZWRTdGF0ZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgICAgIHZhciBsaW5rcyA9IHRoaXNHcmFwaC5saW5rcztcbiAgICAgICAgICAgICAgICB2YXIgY3VyclRpdGxlID0gbnVsbDtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUudGl0bGVFbGVtICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgY3VyclRpdGxlID0gc3RhdGUudGl0bGVFbGVtLnRleHQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGZvY3VzR3JvdXBzID0gc3RhdGUuZm9jdXNHcm91cHM7XG4gICAgICAgICAgICAgICAgdmFyIGV2ZW50SGlzdG9yeSA9IHN0YXRlLmV2ZW50SGlzdG9yeTtcbiAgICAgICAgICAgICAgICB2YXIgem9vbXMgPSBzdGF0ZS56b29tcztcbiAgICAgICAgICAgICAgICB2YXIgbGF5b3V0ID0gc3RhdGUubGF5b3V0O1xuXG4gICAgICAgICAgICAgICAgdmFyIGxheW91dERlZmF1bHQgPSBzdGF0ZS5sYXlvdXREZWZhdWx0O1xuICAgICAgICAgICAgICAgIHZhciB6b29tRGVmYXVsdCA9IHN0YXRlLnpvb21EZWZhdWx0O1xuICAgICAgICAgICAgICAgIHZhciByZXQgPSB7IG5vZGVzOiBub2RlcywgbGlua3M6IGxpbmtzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZXM6IHN0YXRlLnNhdmVkU3RhdGVzLCBjdXJyVGl0bGU6IGN1cnJUaXRsZSxcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNHcm91cHM6IGZvY3VzR3JvdXBzLFxuICAgICAgICAgICAgICAgICAgICBldmVudEhpc3Rvcnk6IGV2ZW50SGlzdG9yeSwgem9vbXM6IHpvb21zLFxuICAgICAgICAgICAgICAgICAgICBsYXlvdXQ6IGxheW91dCwgbGF5b3V0RGVmYXVsdDogbGF5b3V0RGVmYXVsdCxcbiAgICAgICAgICAgICAgICAgICAgem9vbURlZmF1bHQ6IHpvb21EZWZhdWx0IH07XG4gICAgICAgICAgICAgICAgc2F2ZWRTdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5ID0gcmV0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgYmUgY2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIHJlbG9hZGVkLCBhc3N1bWluZ1xuICAgICAgICAgICAgICogc2F2ZSBzdGF0ZSBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGxvYWRTdGF0ZSAgQ29udGFpbnMgYWxsIHRoZSBzYXZlZFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFibGVzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdsb2FkJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBsb2FkKGxvYWRTdGF0ZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIGxvYWRTdGF0ZSA9IGxvYWRTdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuICAgICAgICAgICAgICAgIHN0YXRlLnNhdmVkU3RhdGVzID0gbG9hZFN0YXRlLnN0YXRlcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MgPSBsb2FkU3RhdGUubGlua3M7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzID0gbG9hZFN0YXRlLm5vZGVzO1xuXG4gICAgICAgICAgICAgICAgdmFyIGN1cnJUaXRsZSA9IGxvYWRTdGF0ZS5jdXJyVGl0bGU7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLnRpdGxlRWxlbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLnRpdGxlRWxlbS50ZXh0KGN1cnJUaXRsZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeSA9IGxvYWRTdGF0ZS5ldmVudEhpc3Rvcnk7XG4gICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMgPSBsb2FkU3RhdGUuZm9jdXNHcm91cHM7XG4gICAgICAgICAgICAgICAgc3RhdGUuem9vbXMgPSBsb2FkU3RhdGUuem9vbXM7XG4gICAgICAgICAgICAgICAgc3RhdGUubGF5b3V0ID0gbG9hZFN0YXRlLmxheW91dDtcbiAgICAgICAgICAgICAgICBzdGF0ZS5sYXlvdXREZWZhdWx0ID0gbG9hZFN0YXRlLmxheW91dERlZmF1bHQ7XG4gICAgICAgICAgICAgICAgc3RhdGUuem9vbURlZmF1bHQgPSBsb2FkU3RhdGUuem9vbURlZmF1bHQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuYmFja0J1dHRvbkVsZW0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLmJhY2tCdXR0b25FbGVtLmZhZGVUbygnc2xvdycsIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcblxuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoXy5pbmNsdWRlcyhjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dLCBkLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImZvY3VzXCI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiY29ubmVjdGVkXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vbG9hZGluZyBhIHByZXZpb3VzIGxheW91dFxuICAgICAgICAgICAgICAgIHZhciBsYXlvdXQ7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBsYXlvdXQgPSBzdGF0ZS5sYXlvdXREZWZhdWx0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbSA9IHN0YXRlLnpvb21EZWZhdWx0O1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguem9vbWVkKHpvb21bMF0sIHpvb21bMV0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB6b29tID0gc3RhdGUuem9vbXNbc3RhdGUuZm9jdXNHcm91cHNdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoem9vbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguem9vbWVkKHpvb21bMF0sIHpvb21bMV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGxheW91dCA9IHN0YXRlLmxheW91dFtzdGF0ZS5mb2N1c0dyb3Vwc107XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9sYXlvdXQgY2FuJ3QgYmUgbnVsbFxuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwb3MgPSBsYXlvdXRbbi5pZF07XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb3MgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cobGF5b3V0LCBuKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBuLnggPSBwb3MueDtcbiAgICAgICAgICAgICAgICAgICAgbi55ID0gcG9zLnk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN0YXRlLmluaXRGb3JjZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoLmNhbGwodGhpc0dyYXBoLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kudXBkYXRlR3JhcGhDYWxsYmFjay5jYWxsKHRoaXNQb2xpY3kpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRyaWdnZXJpbmcgc3BsaXQgb24gZG91YmxlIGNsaWNrXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEZvY3VzIGdyb3VwIHN0b3JlcyB0aGUgbm9kZSB0aGF0IGlzIGFib3V0IHRvIGJlIHNwbGl0LlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBXaGVuIGZvY3VzIGdyb3VwIGhhcyBsZW5ndGggMCwgdGhlIGZpcnN0IHNwbGl0IFxuICAgICAgICAgICAgICogd2lsbCBqdXN0IGJlIHB1c2hlZCBvbi5cbiAgICAgICAgICAgICAqIFRoZSBub2RlIHdpbGwgYmUgc3BsaXQgYW5kIHB1c2hlZCB0byB0aGUgdG9wIGhhbGYgXG4gICAgICAgICAgICAgKiBvZiB0aGUgc2NyZWVuLCBhbmQgdGhlIGJvdHRvbSBoYWxmIHdpbGwgY29udGFpbiBhbnlcbiAgICAgICAgICAgICAqIG5vZGVzIGl0IGhhcyBjb25uZWN0aW9ucyB0by5cbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogV2hlbiBhIGZvY3VzIGdyb3VwIGxlbmd0aCBpcyA+PSAxLCBpZiB0aGUgbm9kZSB0byBiZVxuICAgICAgICAgICAgICogc3BsaXQgaXMgYSBmb2N1cyBub2RlLCBpdCB3aWxsIHJlcGxhY2UgZm9jdXNHcm91cHNbMF0gYW5kXG4gICAgICAgICAgICAgKiB0aGUgdG9wIGhhbGYgd2lsbCBiZSBpdHMgY2hpbGRyZW4sIGFuZCBib3R0b20gaGFsZiB3aWxsXG4gICAgICAgICAgICAgKiBiZSB0aGUgbm9kZXMgaXQgaGFzIGNvbm5lY3Rpb25zIHRvLlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBJZiB0aGUgc3BsaXQgaXMgaW4gdGhlIGJvdHRvbSBoYWxmLCB0aGVuIHRoZSBib3R0b20gaGFsZlxuICAgICAgICAgICAgICogd2lsbCBkaXNwbGF5IGl0J3MgY2hpbGRyZW4gYW5kIHdpbGwgb25seSBzaG93IGNvbm5lY3Rpb25zIGJldHdlZW5cbiAgICAgICAgICAgICAqIHRoZSB0d28gZ3JvdXBzLCBhbmQgd2lsbCByZXBsYWNlIGZvY3VzR3JvdXBzWzFdLlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmp9ICAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGQgICAgICAgVGhlIG1hdGNoaW5nIGRhdGEgb2JqZWN0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkYmxjbGljaycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGJsY2xpY2soZDNub2RlLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICAvL2NoZWNrIGlmIGNhbiBzcGxpdFxuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gZC5pZDtcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIGlmIChjaGlsZHJlbl9zdHJ1Y3RbbmFtZV0gPT09IHVuZGVmaW5lZCB8fCBfLmlzRW1wdHkoY2hpbGRyZW5fc3RydWN0W25hbWVdKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMuc2xpY2UoKTtcblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy90b3BsZXZlbCBzcGxpdFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwcy5wdXNoKGQuaWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXy5pbmNsdWRlcyhjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dLCBkLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICAvL3NwbGl0dGluZyBhIGZvY3VzIG5vZGVcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHNbMF0gPSBkLmlkO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vc3BsaXR0aW5nIGFcbiAgICAgICAgICAgICAgICAgICAgLy9jb25uZWN0ZWQgbm9kZVxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwcy5wdXNoKGQuaWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXy5pbmNsdWRlcyhjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMV1dLCBkLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICAvL3NwbGl0dGluZyBhXG4gICAgICAgICAgICAgICAgICAgIC8vY29ubmVjdGVkIG5vZGVcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHNbMV0gPSBkLmlkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDIgJiYgc3RhdGUuZm9jdXNHcm91cHNbMV0gPT09IGQuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9TcGxpdHRpbmcgYSBjb25uZWN0ZWQgbm9kZSwga2VlcCBhbGwgZm9jdXMgbm9kZXNcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVzVG9LZWVwID0gW2RdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZUlkc1RvUmVzaG93ID0gW107XG4gICAgICAgICAgICAgICAgICAgIHZhciBncm91cE9uZU5vZGVzID0gY2hpbGRyZW5fc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzBdXTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKGdyb3VwT25lTm9kZXMsIG5vZGUuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlkc1RvUmVzaG93LnB1c2gobm9kZS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNUb0tlZXAucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy9NYWtlIHNwbGl0IG5vZGVzIHRoZSBmb2N1cyBhbmQga2VlcCBub2RlcyB0aGF0IGFyZSBjb25uZWN0ZWRcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVzVG9LZWVwID0gW2RdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZUlkc1RvUmVzaG93ID0gW107XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubGlua3MsIGZ1bmN0aW9uIChsaW5rKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobGluay5zb3VyY2UgPT09IGQgJiYgbm9kZUlkc1RvUmVzaG93LmluZGV4T2YobGluay50YXJnZXQuaWQpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluay50YXJnZXQuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsudGFyZ2V0LlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiY29ubmVjdGVkXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlkc1RvUmVzaG93LnB1c2gobGluay50YXJnZXQuaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzVG9LZWVwLnB1c2gobGluay50YXJnZXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChsaW5rLnRhcmdldCA9PT0gZCAmJiBub2RlSWRzVG9SZXNob3cuaW5kZXhPZihsaW5rLnNvdXJjZS5pZCkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rLnNvdXJjZS5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluay5zb3VyY2UuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzVG9SZXNob3cucHVzaChsaW5rLnNvdXJjZS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNUb0tlZXAucHVzaChsaW5rLnNvdXJjZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vUmVtb3ZpbmcgbGlua3MgZnJvbSB0aGUgbm9kZSB0byBiZSBzcGxpdFxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2goZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuaWQgIT09IGQuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zcGxpY2VMaW5rc0Zvck5vZGUobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcblxuICAgICAgICAgICAgICAgIC8vZGlzYWJsaW5nIHVwZGF0ZSBncmFwaCB0byBwcmV2ZW50IG5ldyBkYXRhIGZyb21cbiAgICAgICAgICAgICAgICAvL3JlZHJhd2luZyBsaW5rcyB3aGlsZSB0aGVyZSBhcmUgYW5pbWF0aW9ucyBnb2luZyBvblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZS5kaXNhYmxlVXBkYXRlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5lYWNoKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLmlkICE9PSBkLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykudHJhbnNpdGlvbigpLmRlbGF5KDIwMCkuZHVyYXRpb24oNDAwKS5zdHlsZShcIm9wYWNpdHlcIiwgMCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2Rpc2FibGluZyBxdGlwIGlmIGluc3RhbGxlZFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQodGhpcykucXRpcCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5xdGlwKCdkaXNhYmxlJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHZhciB0cmFuc2xhdGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKTtcbiAgICAgICAgICAgICAgICB2YXIgc2NhbGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpO1xuICAgICAgICAgICAgICAgIHZhciB4TG9jID0gcGFyc2VGbG9hdCh0aGlzR3JhcGguc3ZnLnN0eWxlKFwid2lkdGhcIikpIC8gc2NhbGUgLyAyICsgdHJhbnNsYXRlWzBdO1xuICAgICAgICAgICAgICAgIHZhciB5TG9jID0gcGFyc2VGbG9hdCh0aGlzR3JhcGguc3ZnLnN0eWxlKFwiaGVpZ2h0XCIpKSAvIHNjYWxlIC8gMiArIHRyYW5zbGF0ZVsxXTtcbiAgICAgICAgICAgICAgICBkLnhTdGFydCA9IGQueDtcbiAgICAgICAgICAgICAgICBkLnlTdGFydCA9IGQueTtcbiAgICAgICAgICAgICAgICBkLnggPSB4TG9jO1xuICAgICAgICAgICAgICAgIGQueSA9IHlMb2M7XG4gICAgICAgICAgICAgICAgZDNub2RlLnRyYW5zaXRpb24oXCJub2RlUG9zaXRpb25UcmFuc2l0aW9uXCIpLmR1cmF0aW9uKDc1MCkuYXR0clR3ZWVuKFwidHJhbnNmb3JtXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB4U3RhcnQgPSBkLnhTdGFydDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHlTdGFydCA9IGQueVN0YXJ0O1xuICAgICAgICAgICAgICAgICAgICBkLnhTdGFydCA9IGQueDtcbiAgICAgICAgICAgICAgICAgICAgZC55U3RhcnQgPSBkLnk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkMy5pbnRlcnBvbGF0ZVN0cmluZyhcInRyYW5zbGF0ZShcIiArIHhTdGFydCArIFwiLFwiICsgeVN0YXJ0ICsgXCIpXCIsIFwidHJhbnNsYXRlKFwiICsgZC54ICsgXCIsXCIgKyBkLnkgKyBcIilcIik7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3BsaXROb2RlRnVuYyA9IF9nZXQoT2JqZWN0LmdldFByb3RvdHlwZU9mKFNwbGl0Sm9pblZpZXdQb2xpY3kucHJvdG90eXBlKSwgJ3NwbGl0Tm9kZScsIHRoaXMpO1xuICAgICAgICAgICAgICAgIHN0YXRlLm5vZGVJZHNUb1Jlc2hvdyA9IG5vZGVJZHNUb1Jlc2hvdztcbiAgICAgICAgICAgICAgICAvL3dhaXRpbmcgZm9yIG5vZGUgdHJhbnNpdGlvblxuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzID0gbm9kZXNUb0tlZXA7XG4gICAgICAgICAgICAgICAgICAgIHNwbGl0Tm9kZUZ1bmMuY2FsbCh0aGlzUG9saWN5LCBkKTtcbiAgICAgICAgICAgICAgICB9LCA3NTApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRvIGJlIGNhbGxlZCBhZnRlciB0aGUgZ3JhcGggaXMgc3BsaXQuXG4gICAgICAgICAgICAgKiBCcmluZ3MgYWxsIG5vZGVzIGJhY2sgaW50byB2aWV3IGFuZCBzZXRzIHRoZWlyIGF0dHJpYnV0ZXNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3VwZGF0ZUdyYXBoQ2FsbGJhY2snLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUdyYXBoQ2FsbGJhY2soKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5lYWNoKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS50cmFuc2l0aW9uKCkuZHVyYXRpb24oNDAwKS5zdHlsZShcIm9wYWNpdHlcIiwgMSk7XG4gICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5jbGFzc2VkKFwiZm9jdXNcIiwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykuY2xhc3NlZChcImNvbm5lY3RlZFwiLCBmYWxzZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuU3BsaXRKb2luVmlld1BvbGljeSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPT09IFwiZm9jdXNcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5jbGFzc2VkKFwiZm9jdXNcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vZGUuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID09PSBcImNvbm5lY3RlZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLmNsYXNzZWQoXCJjb25uZWN0ZWRcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHN0YXRlLm5vZGVJZHNUb1Jlc2hvdyA9IG51bGw7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSYW5kb21seSBzZXRzIHRoZSBwb3NpdGlvbnMgb2YgYW55IHVuc2V0IG5vZGVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3NldFBvc2l0aW9ucycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0UG9zaXRpb25zKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5ID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGhDb25zdHMgPSB0aGlzR3JhcGguY29uc3RzO1xuXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IGdyYXBoQ29uc3RzLmRpc3BsYXlPZmZzZXQ7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgICAgIHZhciByZXQgPSB0aGlzUG9saWN5LmQzRm9yY2VCb3VuZHMuY2FsbCh0aGlzR3JhcGgpO1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0UmFuZG9tSW50KG1pbiwgbWF4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluICsgMSkpICsgbWluO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIF8uZm9yRWFjaChub2RlcywgZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUueCA9PSBudWxsIHx8IG5vZGUueSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IGdldFJhbmRvbUludChub2RlLnJhZGl1cyArIG9mZnNldCwgcmV0LndpZHRoIC0gbm9kZS5yYWRpdXMgLSBvZmZzZXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHkgPSBnZXRSYW5kb21JbnQobm9kZS5yYWRpdXMgKyBvZmZzZXQsIHJldC5oZWlnaHQgLSBub2RlLnJhZGl1cyAtIG9mZnNldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLnggPSB4O1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS55ID0geTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBvbiB0aGUgc3RhcnQgb2YgdGhlIGQzIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqIFdpbGwgb3ZlcnJpZGUgdGhlIG1ldGhvZCBvZiB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqIFwidGhpc1wiIHBvaW50cyB0byB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2QzRm9yY2VTdGFydCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZDNGb3JjZVN0YXJ0KCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmF0dHIoJ2N4JywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQueFN0YXJ0ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQueFN0YXJ0ID0gZC54U3RhcnQgKiB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpICsgdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKClbMF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCdjeScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLnlTdGFydCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLnlTdGFydCA9IGQueVN0YXJ0ICogdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKSArIHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpWzFdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHMuYXR0cigneDEnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5zb3VyY2UueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd5MScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnNvdXJjZS55O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3gyJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQudGFyZ2V0Lng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneTInLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC50YXJnZXQueTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgb24gdGhlIHN0YXJ0IG9mIHRoZSBkMyBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKiBXaWxsIG92ZXJyaWRlIHRoZSBtZXRob2Qgb2YgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKiBcInRoaXNcIiBwb2ludHMgdG8gdGhlIGdyYXBoXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkM0ZvcmNlRW5kJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkM0ZvcmNlRW5kKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kgPSBzdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZVBvbGljeS5sYXlvdXREZWZhdWx0ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZmF1bHRMYXlvdXQgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRMYXlvdXRbbi5pZF0gPSB7IHg6IG4ueCwgeTogbi55IH07XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZVBvbGljeS5sYXlvdXREZWZhdWx0ID0gZGVmYXVsdExheW91dDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zbGF0ZSA9IHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZVBvbGljeS56b29tRGVmYXVsdCA9IFt0cmFuc2xhdGUsIHNjYWxlXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5hdHRyKCdjeCcsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cignY3knLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55O1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzLmF0dHIoJ3gxJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuc291cmNlLng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneTEnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5zb3VyY2UueTtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd4MicsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnRhcmdldC54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3kyJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQudGFyZ2V0Lnk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2lsbCBiZSBjYWxsZWQgZHVyaW5nIEQzIGZvcmNlIHNpbXVsYXRpb25zXG4gICAgICAgICAgICAgKiBieSB0aGUgZ3JhcGgsIHNvIFwidGhpc1wiIHdpbGwgcG9pbnQgdG8gdGhlIGdyYXBoIG9iamVjdFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB3aWR0aCAgIEQzIExheW91dCBXaWR0aFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge251bWJlcn0gIGhlaWdodCAgRDMgTGF5b3V0IEhlaWdodFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZDNGb3JjZVRpY2snLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGQzRm9yY2VUaWNrKGUsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5ID0gc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSBjb25zdHMuZGlzcGxheU9mZnNldDtcbiAgICAgICAgICAgICAgICB2YXIgc2NhbGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpO1xuXG4gICAgICAgICAgICAgICAgLy8gTW92ZSBub2RlcyB0b3dhcmQgY2x1c3RlciBmb2N1cy5cbiAgICAgICAgICAgICAgICB2YXIgZm9jaSA9IHN0YXRlUG9saWN5LmZvY2k7XG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ3Jhdml0eShhbHBoYSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb2NpLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9PT0gXCJmb2N1c1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSArPSAoZm9jaVswXSAtIGQueSkgKiBhbHBoYTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gKGZvY2lbMV0gLSBkLnkpICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCArPSAod2lkdGggLyAyIC0gZC54KSAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gKGhlaWdodCAvIDIgLSBkLnkpICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC54ICs9ICh3aWR0aCAvIDIgLSBkLngpICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gTWFrZSBzdXJlIG5vZGVzIGFyZSB3aXRoaW4gYm91bmRzXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZWFjaCh0aGlzLmQzRm9yY2VDb2xsaWRlKC41KSkuZWFjaChncmF2aXR5KC4yICogZS5hbHBoYSkpLmF0dHIoXCJjeFwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC54ID0gTWF0aC5tYXgoKGQucmFkaXVzICsgb2Zmc2V0KSAvIHNjYWxlLCBNYXRoLm1pbih3aWR0aCArICgtb2Zmc2V0IC0gZC5yYWRpdXMpIC8gc2NhbGUsIGQueCkpO1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoXCJjeVwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5TcGxpdEpvaW5WaWV3UG9saWN5ID09IG51bGwgfHwgZC5TcGxpdEpvaW5WaWV3UG9saWN5ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQueSA9IE1hdGgubWF4KChkLnJhZGl1cyArIG9mZnNldCkgLyBzY2FsZSwgTWF0aC5taW4oaGVpZ2h0ICsgKC1vZmZzZXQgLSBkLnJhZGl1cykgLyBzY2FsZSwgZC55KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID09PSBcImZvY3VzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQueSA9IE1hdGgubWF4KGQucmFkaXVzICsgb2Zmc2V0LCBNYXRoLm1pbigoaGVpZ2h0ICsgKC1vZmZzZXQgLSBkLnJhZGl1cykgLyBzY2FsZSkgKiBjb25zdHMuU3BsaXRKb2luVmlld1BvbGljeS5ib3VuZGFyeSwgZC55KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID09PSBcImNvbm5lY3RlZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLnkgPSBNYXRoLm1heCgoaGVpZ2h0ICsgKG9mZnNldCAtIGQucmFkaXVzKSAvIHNjYWxlKSAqIGNvbnN0cy5TcGxpdEpvaW5WaWV3UG9saWN5LmJvdW5kYXJ5LCBNYXRoLm1pbihoZWlnaHQgKyAoLW9mZnNldCAtIGQucmFkaXVzKSAvIHNjYWxlLCBkLnkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocy5hdHRyKCd4MScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnNvdXJjZS54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3kxJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuc291cmNlLnk7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneDInLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC50YXJnZXQueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd5MicsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnRhcmdldC55O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGN1bGF0ZXMgdGhlIGJvdW5kYXJpZXMgb2YgdGhlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogV2lsbCBiZSBjYWxsZWQgZHVyaW5nIEQzIGZvcmNlIHNpbXVsYXRpb25zXG4gICAgICAgICAgICAgKiBieSB0aGUgZ3JhcGgsIHNvIFwidGhpc1wiIHdpbGwgcG9pbnQgdG8gdGhlIGdyYXBoIG9iamVjdFxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7T2JqZWN0fSAgICAgICAgICBSZXR1cm5zIGFuIG9iamVjdFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdCBoYXMgdGhlIHdpZHRoXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmQgaGVpZ2h0IGFzIFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllcyBcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2QzRm9yY2VCb3VuZHMnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGQzRm9yY2VCb3VuZHMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzLFxuICAgICAgICAgICAgICAgICAgICBjb25zdHNQb2xpY3kgPSBjb25zdHMuU3BsaXRKb2luVmlld1BvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kgPSBzdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXNHcmFwaC5ub2RlcztcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjYWxjTWF4Tm9kZXMod2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYXJlYSA9IHdpZHRoICogaGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmFkaXVzID0gdGhpc0dyYXBoLmNvbnN0cy5zdGFydFJhZGl1cztcbiAgICAgICAgICAgICAgICAgICAgLy90cmVhdGluZyB0aGVtIGFzIGEgc3F1YXJlIGZvciBhcHByb3hcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxlbmd0aCA9IHJhZGl1cyAqIDMuNTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFtb3VudCA9IGFyZWEgLyAobGVuZ3RoICogbGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFtb3VudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9UaGUgb2Zmc2V0IGlzIHRoZSBidWZmZXIgZnJvbSB0aGUgZWRnZXNcbiAgICAgICAgICAgICAgICAvL09yaWdpbmFsIFdpZHRoIGFuZCBIZWlnaHQgYXJlIGdpdmVuIHRvIHRoZSBmb3JjZSBsYXlvdXRcbiAgICAgICAgICAgICAgICAvL3NvIHRoYXQgaXQgaXMgY2VudGVyZWQsIGJ1dCBub2RlcyB3aWxsIGJlIGZvcmNlZCB0byBiZVxuICAgICAgICAgICAgICAgIC8vd2l0aGluIHRoZSBvZmZzZXQgYm91bmRzXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IGNvbnN0cy5kaXNwbGF5T2Zmc2V0O1xuICAgICAgICAgICAgICAgIHZhciBzdmdXaWR0aCA9IHBhcnNlRmxvYXQodGhpc0dyYXBoLnN2Zy5zdHlsZShcIndpZHRoXCIpKTtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnSGVpZ2h0ID0gcGFyc2VGbG9hdCh0aGlzR3JhcGguc3ZnLnN0eWxlKFwiaGVpZ2h0XCIpKTtcblxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IHN2Z1dpZHRoO1xuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBzdmdIZWlnaHQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgYW1vdW50ID0gY2FsY01heE5vZGVzKHdpZHRoIC0gMiAqIG9mZnNldCwgaGVpZ2h0IC0gMiAqIG9mZnNldCk7XG4gICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gMTtcbiAgICAgICAgICAgICAgICBpZiAobm9kZXMubGVuZ3RoID4gYW1vdW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHNjYWxlID0gYW1vdW50IC8gbm9kZXMubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguem9vbWVkKHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpLCBzY2FsZSk7XG4gICAgICAgICAgICAgICAgICAgIHdpZHRoIC89IHNjYWxlO1xuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgLz0gc2NhbGU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKSwgc2NhbGUpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vY2FsY3VsYXRpbmcgZm9jaSBmb3Igc2ltdWxhdGlvblxuICAgICAgICAgICAgICAgIHZhciBmb2N1c0dyb3VwcyA9IHN0YXRlUG9saWN5LmZvY3VzR3JvdXBzO1xuICAgICAgICAgICAgICAgIHZhciBmb2NpO1xuICAgICAgICAgICAgICAgIGlmIChmb2N1c0dyb3Vwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZm9jaSA9IFtoZWlnaHQgLyAyXTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL3NldHRpbmcgZm9jaSBoZWlnaHQgcG9zaXRpb24gYmFzZWQgb24gcGVyY2VudGFnZVxuICAgICAgICAgICAgICAgICAgICB2YXIgZm9jdXNOb2RlcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFtmb2N1c0dyb3Vwc1swXV07XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0c1BvbGljeS5ib3VuZGFyeSA9IGZvY3VzTm9kZXMubGVuZ3RoIC8gbm9kZXMubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdG9wID0gaGVpZ2h0ICogY29uc3RzUG9saWN5LmJvdW5kYXJ5O1xuICAgICAgICAgICAgICAgICAgICB2YXIgYm90ID0gaGVpZ2h0IC0gdG9wO1xuICAgICAgICAgICAgICAgICAgICBpZiAodG9wIDwgMiAqIHRoaXNHcmFwaC5jb25zdHMubWF4UmFkaXVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdHNQb2xpY3kuYm91bmRhcnkgPSAyLjUgKiB0aGlzR3JhcGguY29uc3RzLm1heFJhZGl1cyAvIGhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvcCA9IGhlaWdodCAqIGNvbnN0c1BvbGljeS5ib3VuZGFyeTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvdCA9IGhlaWdodCAtIHRvcDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoYm90IDwgMiAqIHRoaXNHcmFwaC5jb25zdHMubWF4UmFkaXVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdHNQb2xpY3kuYm91bmRhcnkgPSAxIC0gMi41ICogdGhpc0dyYXBoLmNvbnN0cy5tYXhSYWRpdXMgLyBoZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3AgPSBoZWlnaHQgKiBjb25zdHNQb2xpY3kuYm91bmRhcnk7XG4gICAgICAgICAgICAgICAgICAgICAgICBib3QgPSBoZWlnaHQgLSB0b3A7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZm9jaSA9IFt0b3AgLyAyLCB0b3AgKyBib3QgLyAyXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kuZm9jaSA9IGZvY2k7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgd2lkdGg6IHdpZHRoLCBoZWlnaHQ6IGhlaWdodCB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBhIHNpbmdsZSBub2RlIGlzIHNwbGl0XG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5ld05vZGVzICBUaGUgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdzcGxpdE5vZGVFdmVudCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3BsaXROb2RlRXZlbnQobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaChuZXdOb2RlcywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV0sIGQuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiZm9jdXNcIjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIHRpdGxlID0gbmV3Tm9kZXNbMF0ucGFyZW50O1xuICAgICAgICAgICAgICAgIC8vIHN0YXRlLmZvY3VzR3JvdXAgPSB0aXRsZTtcblxuICAgICAgICAgICAgICAgIC8vaWYgdGhlIGxhc3QgZXZlbnQgaGFzIHRoZSBzYW1lIGlkLCBpdCBtdXN0IGJlIHRoZVxuICAgICAgICAgICAgICAgIC8vb3BwcG9zaXRlIG9mIHRoaXMgZXZlbnQsIHNvIHdlIHJlbW92ZSB0aGF0IGV2ZW50IGZyb21cbiAgICAgICAgICAgICAgICAvL3RoZSBldmVudCBzdGFjay5cbiAgICAgICAgICAgICAgICAvL090aGVyd2lzZSwgd2UgYWRkIHRoZSBldmVudCBvdCB0aGUgc3RhY2tcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCAhPT0gMCAmJiBzdGF0ZS5ldmVudEhpc3Rvcnlbc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCAtIDFdLmlkID09PSB0aXRsZSkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkucG9wKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5LnB1c2goeyBpZDogdGl0bGUsIGV2ZW50OiAnc3BsaXQnIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5iYWNrQnV0dG9uRWxlbSAhPSBudWxsICYmIHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuYmFja0J1dHRvbkVsZW0uZmFkZVRvKCdzbG93JywgMSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLnRpdGxlRWxlbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0gc3RhdGUuZm9jdXNHcm91cHNbMF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSAnICYgJyArIHN0YXRlLmZvY3VzR3JvdXBzWzFdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLnRpdGxlRWxlbS50ZXh0KHRleHQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vcmUtZW5hYmxlIGdyYXBoIHVwZGF0ZVxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZS5kaXNhYmxlVXBkYXRlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpc1BvbGljeS5zZXRMYXlvdXQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTZXRzIHRoZSBsYXlvdXQgb2YgdGhlIG5vZGVzLiBcbiAgICAgICAgICAgICAqIElmIHRoZXJlIGlzIGEgcHJldmlvdXMgbGF5b3V0LCBpdCB3aWxsIGJlIGxvYWRlZC5cbiAgICAgICAgICAgICAqIEVsc2UsIGl0IHdpbGwgcnVuIGEgRDMgRm9yY2Ugc2ltdWxhdGlvbiBhbmQgY3JlYXRlIG9uZS5cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3NldExheW91dCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0TGF5b3V0KCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcbiAgICAgICAgICAgICAgICB2YXIgbGF5b3V0O1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ID0gc3RhdGUubGF5b3V0RGVmYXVsdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSBzdGF0ZS56b29tRGVmYXVsdDtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh6b29tWzBdLCB6b29tWzFdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbSA9IHN0YXRlLnpvb21zW3N0YXRlLmZvY3VzR3JvdXBzXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHpvb20gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh6b29tWzBdLCB6b29tWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBsYXlvdXQgPSBzdGF0ZS5sYXlvdXRbc3RhdGUuZm9jdXNHcm91cHNdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChsYXlvdXQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvcyA9IGxheW91dFtuLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwb3MgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGxheW91dCwgbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBuLnggPSBwb3MueDtcbiAgICAgICAgICAgICAgICAgICAgICAgIG4ueSA9IHBvcy55O1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoLmNhbGwodGhpc0dyYXBoLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnVwZGF0ZUdyYXBoQ2FsbGJhY2suY2FsbCh0aGlzUG9saWN5KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy9OZWVkIHRvIHJ1biBhIGZvcmNlIHNpbXVsYXRpb24gYXMgdGhpcyBsYXlvdXRcbiAgICAgICAgICAgICAgICAgICAgLy9oYXNuJ3QgYmVlbiBkb25lIGJlZm9yZVxuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3RhdGUuaW5pdEZvcmNlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRoaXNQb2xpY3kuc2V0UG9zaXRpb25zKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnVwZGF0ZUdyYXBoQ2FsbGJhY2suY2FsbCh0aGlzUG9saWN5KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLnpvb21zW3N0YXRlLmZvY3VzR3JvdXBzXSA9IFt0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKSwgdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKV07XG4gICAgICAgICAgICAgICAgICAgIHZhciBsYXlvdXQgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dFtuLmlkXSA9IHsgeDogbi54LCB5OiBuLnkgfTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmxheW91dFtzdGF0ZS5mb2N1c0dyb3Vwc10gPSBsYXlvdXQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIE92ZXJyaWRpbmcgZnJvbSBzdXBlciBjbGFzcyBzbyB0aGF0IHdlIGNhbiBoYXZlXG4gICAgICAgICAgICAgKiB0b3AgbGV2ZWwgbm9kZXMgcmVhcHBlYXIgd2hlbiB0aGV5IGFyZSBoaWRkZW5cbiAgICAgICAgICAgICAqIGR1ZSB0byB0aGVyZSBiZWluZyB0d28gZm9jdXMgZ3JvdXBzLlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gICAgICAgICAgbm9kZSAgICBUaGUgbm9kZSB0byBqb2luXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7Tm9kZX0gIFRoZSBuZXcgbm9kZSBhZnRlciB0aGUgam9pblxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnX19qb2luTm9kZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX19qb2luTm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlU3VwZXIgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luTm9kZVBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIC8vY2hlY2sgdGhhdCBub2RlIHN0aWxsIGV4aXN0c1xuICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGgubm9kZXMuaW5kZXhPZihub2RlKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IG5vZGUuaWQ7XG4gICAgICAgICAgICAgICAgLy9pZiBpdCBoYXMgbm8gYW5jZXN0b3IsIG5vdGhpbmcgdG8gam9pblxuICAgICAgICAgICAgICAgIGlmIChjaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwuaW5kZXhPZihuYW1lKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gbm9kZS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgdmFyIHRvX2JlX2RlbGV0ZWQgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZU5hbWVTZXQgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXNHcmFwaC5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIG5vZGUgd29uJ3QgYmUgY29sbGFwc2VkXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGgubm9kZXNbaV0uYW5jZXN0b3JzLmluZGV4T2Yobm9kZS5wYXJlbnQpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlTmFtZVNldC5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXS5pZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b19iZV9kZWxldGVkLnB1c2godGhpc0dyYXBoLm5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGVfaWQgPSBub2RlLnBhcmVudDtcbiAgICAgICAgICAgICAgICBub2RlTmFtZVNldC5wdXNoKG5vZGUucGFyZW50KTtcblxuICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnNfc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuYW5jZXN0b3JzX3N0cnVjdDtcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIC8vIC0gc2V0dGluZyBmb2N1c0dyb3VwcyAtXG4gICAgICAgICAgICAgICAgLy9laXRoZXIgcmVwbGFjaW5nIG9uZSBvZiB0aGUgZ3JvdXBzLFxuICAgICAgICAgICAgICAgIC8vb3Igam9pbmluZyBiYWNrIGludG8gYSB0b3AgbGV2ZWwsIHNvIHRoZXJlIGlzIG9ubHlcbiAgICAgICAgICAgICAgICAvL29uZSBmb2N1c1xuICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IHN0YXRlLmZvY3VzR3JvdXBzLmluZGV4T2YocGFyZW50KTtcbiAgICAgICAgICAgICAgICBpZiAoYW5jZXN0b3JzX3N0cnVjdFtwYXJlbnRdICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHNbaW5kZXhdID0gYW5jZXN0b3JzX3N0cnVjdFtwYXJlbnRdO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9uYW1lVG9BZGQgYXJlIHRvcCBsZXZlbCBub2RlcyB0aGF0IGFyZSB0byBiZSBhZGRlZFxuICAgICAgICAgICAgICAgIC8vdG8gdGhlIGdyYXBoLlxuICAgICAgICAgICAgICAgIHZhciBuYW1lVG9BZGQgPSBbXTtcbiAgICAgICAgICAgICAgICAvL3dpbGwgb25seSBuZWVkIHRvIGFkZCBhIHRvcCBsZXZlbCBub2RlIGlmIHRoZXJlIGlzXG4gICAgICAgICAgICAgICAgLy9vbmx5IG9uZSBmb2N1c1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9BZGQgb25seSB0aG9zdCB0aGF0IGFyZW4ndCBhbiBhbmNlc3RvciBvZiB0aGUgbm9kZVxuICAgICAgICAgICAgICAgICAgICAvL3RvIGpvaW4sIHRoZSBmb2N1cyBncm91cCBvciBhbiBhbmNlc3RvciBvZiBpdCxcbiAgICAgICAgICAgICAgICAgICAgLy9hbmQgYXJlbid0IGFscmVhZHkgaW4gbm9kZU5hbWVTZXQuXG4gICAgICAgICAgICAgICAgICAgIC8vZ2V0IGZsb3cgYmV0d2VlbiB0b3AgbGV2ZWwgYXMgbG9uZyBhc1xuICAgICAgICAgICAgICAgICAgICAvL3RoZSB0b3AgbGV2ZWwgaXNuJ3QgYW4gYW5jZXN0b3Igb2YgdGhlXG4gICAgICAgICAgICAgICAgICAgIC8vZm9jdXMgZ3JvdXAsIGFuZCBpc24ndCBhbHJlYWR5IHBhcnQgb2YgdGhlXG4gICAgICAgICAgICAgICAgICAgIC8vbm9kZSBzZXQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnMgPSBhbmNlc3RvcnNfc3RydWN0W25vZGUuaWRdO1xuICAgICAgICAgICAgICAgICAgICBhbmNlc3RvcnMucHVzaChzdGF0ZS5mb2N1c0dyb3Vwc1swXSk7XG4gICAgICAgICAgICAgICAgICAgIC8vdGhlIG9yIGVtcHR5IGFycmF5IGlzIHRvIHByZXZlbnQgY29uY2F0ZW5hdGluZyBhIG51bGxcbiAgICAgICAgICAgICAgICAgICAgLy9vciB1bmRlZmluZWQgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3JzID0gYW5jZXN0b3JzLmNvbmNhdChhbmNlc3RvcnNfc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzBdXSB8fCBbXSk7XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChjaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW5jZXN0b3JzLmluZGV4T2YobikgPT09IC0xICYmIG5vZGVOYW1lU2V0LmluZGV4T2YobikgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lVG9BZGQucHVzaChuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVOYW1lU2V0ID0gbm9kZU5hbWVTZXQuY29uY2F0KG5hbWVUb0FkZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy9ubyBmb2N1cyBncm91cHMgbWVhbnMgd2UgYXJlIGF0IHRvcCBsZXZlbFxuICAgICAgICAgICAgICAgICAgICAvL1Nob3VsZCBhZGQgYW55IHRvcCBsZXZlbCBub2RlcyB0aGF0IGFyZW4ndFxuICAgICAgICAgICAgICAgICAgICAvL2FscmVhZHkgdGhlcmVcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKGNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbCwgZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlTmFtZVNldC5pbmRleE9mKG4pID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkLnB1c2gobik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBub2RlTmFtZVNldCA9IG5vZGVOYW1lU2V0LmNvbmNhdChuYW1lVG9BZGQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vZm9ybWF0dGluZyBkYXRhXG4gICAgICAgICAgICAgICAgdmFyIHJhZGl1cyA9IG5vZGUucmFkaXVzIC8gdGhpc0dyYXBoLmNvbnN0cy5yYWRpdXNEZWNheTtcbiAgICAgICAgICAgICAgICB2YXIgeExvYyA9IG5vZGUueDtcbiAgICAgICAgICAgICAgICB2YXIgeUxvYyA9IG5vZGUueTtcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gbm9kZS5hbmNlc3RvcnNbMV07XG4gICAgICAgICAgICAgICAgdmFyIGFuY2VzdG9ycyA9IG5vZGUuYW5jZXN0b3JzLnNsaWNlKDEpO1xuICAgICAgICAgICAgICAgIHZhciBuZXdOb2RlID0gbmV3IFZpc3VhbGl6ZXJOb2RlLk5vZGUoeExvYywgeUxvYywgbmV3X25vZGVfaWQsIG5ld19ub2RlX2lkLCByYWRpdXMsIHBhcmVudCwgYW5jZXN0b3JzKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMucHVzaChuZXdOb2RlKTtcblxuICAgICAgICAgICAgICAgIC8vcmVtb3ZlIGFsbCBub2RlcyB0aGF0IHdpbGwgYmUgam9pbmVkXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b19iZV9kZWxldGVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlX3RvX2RlbGV0ZSA9IHRvX2JlX2RlbGV0ZWRbaV07XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5zcGxpY2UodGhpc0dyYXBoLm5vZGVzLmluZGV4T2Yobm9kZV90b19kZWxldGUpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlX3RvX2RlbGV0ZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHJldERhdGEgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5nZXRGbG93QmV0d2VlblNldChub2RlTmFtZVNldCk7XG4gICAgICAgICAgICAgICAgLy9ob2xkcyB0aGUgbm9kZURhdGEgd2hpY2ggd2lsbCBiZSBwcm9jZXNzZWRcbiAgICAgICAgICAgICAgICB2YXIgbm9kZXNUb1Byb2Nlc3MgPSBbXTtcbiAgICAgICAgICAgICAgICAvL2ZpbmRpbmcgdGhlIG5vZGUgZGF0YSB0aGF0IGNvcnJlc3BvbmRzIHRvIHRoZSB0b3AgbGV2ZWxcbiAgICAgICAgICAgICAgICAvL25vZGVzIHRvIGFkZCAtIG5hbWVUb0FkZC5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZURhdGEgPSByZXREYXRhLm5vZGVEYXRhO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZURhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWVUb0FkZC5pbmRleE9mKG5vZGVEYXRhW2ldLmlkKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzVG9Qcm9jZXNzLnB1c2gobm9kZURhdGFbaV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9UaGUgdG9wIGxldmVsIG5vZGVzIHRoYXQgYXJlIGFkZGVkXG4gICAgICAgICAgICAgICAgdmFyIG5ld05vZGVzID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UucHJvY2Vzc05vZGVEYXRhKG5vZGVzVG9Qcm9jZXNzKTtcbiAgICAgICAgICAgICAgICBfLmZvckVhY2gobmV3Tm9kZXMsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgICAgIG4ucmFkaXVzID0gbi5yYWRpdXMgfHwgdGhpc0dyYXBoLmNvbnN0cy5zdGFydFJhZGl1cztcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMgPSB0aGlzR3JhcGgubm9kZXMuY29uY2F0KG5ld05vZGVzKTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YShyZXREYXRhLmxpbmtEYXRhLCB0aGlzR3JhcGgubm9kZXMpO1xuICAgICAgICAgICAgICAgIC8vT25seSBrZWVwIHRvcCBsZXZlbCBub2RlcyB0aGF0IGhhdmUgY29ubmVjdGlvbnMgdG9cbiAgICAgICAgICAgICAgICAvL3RoZSBjdXJyZW50IGZvY3VzIGdyb3VwXG4gICAgICAgICAgICAgICAgLy93ZSByZW1vdmUgdGhlIG5vZGUgbmFtZSBmcm9tIG5hbWVUb0FkZCBpZiB3ZSBhcmVcbiAgICAgICAgICAgICAgICAvL2tlZXBpbmcgaXRcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubGlua3MsIGZ1bmN0aW9uIChsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2NoZWNraW5nIGlmIHRoZXJlIGV4aXN0cyBhIGxpbmsgdG91Y2hpbmcgZWFjaCBvZiBuYW1lVG9BZGRcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuYW1lVG9BZGQuaW5kZXhPZihsLnNvdXJjZS5pZCkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzWzBdID09PSBsLnRhcmdldC5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkLnNwbGljZShuYW1lVG9BZGQuaW5kZXhPZihsLnNvdXJjZS5pZCksIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobmFtZVRvQWRkLmluZGV4T2YobC50YXJnZXQuaWQpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwc1swXSA9PT0gbC5zb3VyY2UucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVUb0FkZC5zcGxpY2UobmFtZVRvQWRkLmluZGV4T2YobC50YXJnZXQuaWQpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vV2Ugd2FudCB0byBrZWVwIHRoZW0gYWxsXG4gICAgICAgICAgICAgICAgICAgIC8vc2luY2UgYW55IGxlZnQgaW4gbmFtZVRvQWRkIHdpbGwgYmUgcmVtb3ZlZCxcbiAgICAgICAgICAgICAgICAgICAgLy93ZSByZXNldCBuYW1lVG9BZGQgaGVyZS5cbiAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkID0gW107XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy93aGF0ZXZlciBpcyByZW1haW5pbmcgaW4gbmFtZVRvQWRkIGlzbid0IGNvbm5lY3RlZFxuICAgICAgICAgICAgICAgIC8vdG8gdGhlIGZvY3VzIGdyb3VwLCBzbyB3ZSBzaG91bGQgcmVtb3ZlIGl0LlxuICAgICAgICAgICAgICAgIHZhciBub2RlVG9SZW1vdmUgPSBbXTtcbiAgICAgICAgICAgICAgICBpZiAobmFtZVRvQWRkLmxlbmd0aCAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXNHcmFwaC5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWVUb0FkZC5pbmRleE9mKHRoaXNHcmFwaC5ub2Rlc1tpXS5pZCkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkLnNwbGljZShuYW1lVG9BZGQuaW5kZXhPZih0aGlzR3JhcGgubm9kZXNbaV0uaWQpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3BsaWNlTGlua3NGb3JOb2RlKHRoaXNHcmFwaC5ub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZVRvUmVtb3ZlLnB1c2godGhpc0dyYXBoLm5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobmFtZVRvQWRkLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKG5vZGVUb1JlbW92ZSwgZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnNwbGljZSh0aGlzR3JhcGgubm9kZXMuaW5kZXhPZihuKSwgMSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXRMaW5rcygpO1xuXG4gICAgICAgICAgICAgICAgc3RhdGVTdXBlci5zcGxpdE5vZGVzLnNwbGljZShzdGF0ZVN1cGVyLnNwbGl0Tm9kZXMuaW5kZXhPZihuZXdOb2RlLmlkKSwgMSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3Tm9kZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgYWZ0ZXIgYSBzaW5nbGUgbm9kZSBpcyBqb2luZWRcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogSWYgdGhlIGZvY3VzIGdyb3VwIGhhcyBiZWVuIHNlZW4gYmVmb3JlLCBpdCB3aWxsXG4gICAgICAgICAgICAgKiBsb2FkIHRoYXQgbGF5b3V0LiBPdGhlcndpc2UsIGl0IHdpbGwgcnVuIGEgZDMgZm9yY2VcbiAgICAgICAgICAgICAqIHNpbXVsYXRpb24gdG8gZ2VuZXJhdGUgb25lLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbmV3Tm9kZSAgVGhlIG5ldyBub2RlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdqb2luTm9kZUV2ZW50JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBqb2luTm9kZUV2ZW50KG5ld05vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeSA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICAvL2lmIHRoZSBsYXN0IGV2ZW50IGhhcyB0aGUgc2FtZSBpZCwgaXQgbXVzdCBiZSB0aGVcbiAgICAgICAgICAgICAgICAvL29wcHBvc2l0ZSBvZiB0aGlzIGV2ZW50LCBzbyB3ZSByZW1vdmUgdGhhdCBldmVudCBmcm9tXG4gICAgICAgICAgICAgICAgLy90aGUgZXZlbnQgc3RhY2suXG4gICAgICAgICAgICAgICAgLy9PdGhlcndpc2UsIHdlIGFkZCB0aGUgZXZlbnQgdG8gdGhlIHN0YWNrXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggIT09IDAgJiYgc3RhdGUuZXZlbnRIaXN0b3J5W3N0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggLSAxXS5pZCA9PT0gbmV3Tm9kZS5pZCkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkucG9wKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5LnB1c2goeyBpZDogbmV3Tm9kZS5pZCwgZXZlbnQ6ICdqb2luJyB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuXG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV0sIGQuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiZm9jdXNcIjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy9zZXR0aW5nIGJhY2sgYnV0dG9uXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmJhY2tCdXR0b25FbGVtICE9IG51bGwgJiYgc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uRWxlbS5mYWRlVG8oJ3Nsb3cnLCAwKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3NldHRpbmcgdGl0bGVcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUudGl0bGVFbGVtICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSBzdGF0ZS5mb2N1c0dyb3Vwc1swXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ICs9ICcgJiAnICsgc3RhdGUuZm9jdXNHcm91cHNbMV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc3RhdGUudGl0bGVFbGVtLnRleHQodGV4dCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kuc2V0TGF5b3V0KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVW5kb2VzIHRoZSBsYXN0IHNwbGl0IG9yIGpvaW4gZXZlbnQuXG4gICAgICAgICAgICAgKiBNZWFudCB0byBiZSBjYWxsZWQgYnkgdGhlIGJhY2sgYnV0dG9uLlxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAndW5kb0xhc3RFdmVudCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdW5kb0xhc3RFdmVudCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeSA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB2YXIgbGFzdCA9IHN0YXRlLmV2ZW50SGlzdG9yeVtzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgdmFyIGlkID0gbGFzdC5pZDtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZTtcbiAgICAgICAgICAgICAgICBpZiAobGFzdC5ldmVudCA9PT0gJ2pvaW4nKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUgPSB0aGlzR3JhcGguZmluZE5vZGVCeUlkKGlkKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQzbm9kZSA9IHRoaXNHcmFwaC5maW5kRDNOb2RlKGlkKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS5kYmxjbGljayhkM25vZGUsIG5vZGUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlSWQgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbaWRdWzBdO1xuICAgICAgICAgICAgICAgICAgICBub2RlID0gdGhpc0dyYXBoLmZpbmROb2RlQnlJZChub2RlSWQpO1xuICAgICAgICAgICAgICAgICAgICBfZ2V0KE9iamVjdC5nZXRQcm90b3R5cGVPZihTcGxpdEpvaW5WaWV3UG9saWN5LnByb3RvdHlwZSksICdqb2luTm9kZScsIHRoaXMpLmNhbGwodGhpc1BvbGljeSwgbm9kZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIFNwbGl0Sm9pblZpZXdQb2xpY3k7XG4gICAgfShTcGxpdEpvaW5Ob2RlUG9saWN5LlBvbGljeSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBQb2xpY3k6IFNwbGl0Sm9pblZpZXdQb2xpY3lcbiAgICB9O1xufV0pO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3MnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbmV0d29ya3MnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgfV0pO1xuXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9ub2RlcycsXG4gICAgICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICAgICAgfSlcbiAgICB9XSk7XG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYub3JnYW5pemF0aW9ucycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvb3JnYW5pemF0aW9ucycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSlcbiAgICB9XSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc2VydmljZWxicycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2VydmljZWxicycsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvc2VydmljZWxicycsXG4gICAgICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICAgICAgfSlcbiAgICB9XSk7XG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc2V0dGluZ3MnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXHJcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcclxuICAgICAgICAkc3RhdGVQcm92aWRlclxyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzJywge1xyXG4gICAgICAgICAgICAgICAgdXJsOiAnL2dsb2JhbCcsXHJcbiAgICAgICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzJywge1xyXG4gICAgICAgICAgICAgICAgdXJsOiAnL3NldHRpbmdzJyxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2V0dGluZ3Mvc2V0dGluZ3NtZW51Lmh0bWwnXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5sb2dzJywge1xyXG4gICAgICAgICAgICAgICAgdXJsOiAnL2xvZ3MnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJycsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJydcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLmF1dGgnLCB7XHJcbiAgICAgICAgICAgICAgICB1cmw6ICcvYXV0aCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnJyxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnJ1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMubGljZW5zZScsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9saWNlbnNlJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICcnLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcnXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5wb2xpY2llcycsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9wb2xpY2llcycsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnJyxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnJ1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgfV0pO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnN0b3JhZ2Vwb2xpY2llcycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9zdG9yYWdlcG9saWNpZXMnLFxuICAgICAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgICAgIH0pXG4gICAgfV0pO1xuXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnLCBcblx0J2NvbnRpdi5ncmFwaCddKVxuIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnY29udGl2Lm1lbnUudmlzdWFsaXphdGlvbicsIHtcbiAgICAgICAgICAgIHVybDogJy92aXN1YWxpemF0aW9uJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KVxuICAgIH1dKTtcblxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZvbHVtZXMnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZvbHVtZXMnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL3ZvbHVtZXMnLFxuICAgICAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgICAgIH0pXG4gICAgfV0pO1xuXG4ndXNlIHN0cmljdCc7XG5cblxuLy8gRGVjbGFyZSBhcHAgbGV2ZWwgbW9kdWxlIHdoaWNoIGRlcGVuZHMgb24gdmlld3MsIGFuZCBjb21wb25lbnRzXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2QXBwJywgW1xuICAgICAgICAndWkucm91dGVyJyxcbiAgICAgICAgJ2NvbnRpdi5sb2dpbicsXG4gICAgICAgICdjb250aXYubWVudScsXG4gICAgICAgICdjb250aXYuZGFzaGJvYXJkJyxcbiAgICAgICAgJ2NvbnRpdi5hcHBsaWNhdGlvbmdyb3VwcycsXG4gICAgICAgICdjb250aXYubmV0d29ya3MnLFxuICAgICAgICAnY29udGl2Lm5ldHdvcmtwb2xpY2llcycsXG4gICAgICAgICdjb250aXYuc3RvcmFnZXBvbGljaWVzJyxcbiAgICAgICAgJ2NvbnRpdi5zZXJ2aWNlbGJzJyxcbiAgICAgICAgJ2NvbnRpdi52b2x1bWVzJyxcbiAgICAgICAgJ2NvbnRpdi5ub2RlcycsXG4gICAgICAgICdjb250aXYub3JnYW5pemF0aW9ucycsXG4gICAgICAgICdjb250aXYuc2V0dGluZ3MnLFxuICAgICAgICAnY29udGl2LnZpc3VhbGl6YXRpb24nXG4gICAgXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCAnJHVybFJvdXRlclByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgLy9hYnN0cmFjdCBzdGF0ZSBzZXJ2ZXMgYXMgYSBQTEFDRUhPTERFUiBvciBOQU1FU1BBQ0UgZm9yIGFwcGxpY2F0aW9uIHN0YXRlc1xuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnJyxcbiAgICAgICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGZsdWlkIGNvbnRhaW5lclwiLz4nXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xuICAgIH1dKTtcblxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzExLzE2LlxuICovXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMTAvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuYXBwbGljYXRpb25ncm91cHMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3Vwcy5jcmVhdGUnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0FwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsIGFzIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcGxpY2F0aW9uZ3JvdXBzL2FwcGxpY2F0aW9uZ3JvdXBjcmVhdGUuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignQXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwnLCBbXG4gICAgICAgICckc3RhdGUnLFxuICAgICAgICAnJHN0YXRlUGFyYW1zJyxcbiAgICAgICAgJ0FwcGxpY2F0aW9uR3JvdXBzTW9kZWwnLFxuICAgICAgICAnTmV0d29ya3NNb2RlbCcsXG4gICAgICAgICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsXG4gICAgICAgICAgICAgICAgICAkc3RhdGVQYXJhbXMsXG4gICAgICAgICAgICAgICAgICBBcHBsaWNhdGlvbkdyb3Vwc01vZGVsLFxuICAgICAgICAgICAgICAgICAgTmV0d29ya3NNb2RlbCxcbiAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgICAgICB2YXIgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwgPSB0aGlzO1xuICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwubmV0d29ya3MgPSBbXTtcbiAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLmFwcGxpY2F0aW9uR3JvdXAgPSB7fTtcbiAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLnNlbGVjdGVkTmV0d29yayA9IHt9O1xuICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwubW9kZSA9IFwiZWRpdFwiO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub0FwcGxpY2F0aW9uR3JvdXAoKSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3Vwcy5saXN0Jyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNhbmNlbENyZWF0aW5nKCkge1xuICAgICAgICAgICAgICAgIHJldHVyblRvQXBwbGljYXRpb25Hcm91cCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEdldCBuZXR3b3JrcyBmb3IgdGhlIGdpdmVuIHRlbmFudC5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0TmV0d29ya3MoKSB7XG4gICAgICAgICAgICAgICAgTmV0d29ya3NNb2RlbC5nZXQoKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwubmV0d29ya3MgPSBfLmZpbHRlcihyZXN1bHQsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICd0ZW5hbnROYW1lJzogJ2RlZmF1bHQnLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUFwcGxpY2F0aW9uR3JvdXAoKSB7XG4gICAgICAgICAgICAgICAgLy9mb3JtIGNvbnRyb2xsZXIgaXMgaW5qZWN0ZWQgYnkgdGhlIGh0bWwgdGVtcGxhdGVcbiAgICAgICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgICAgIGlmIChhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLmFwcGxpY2F0aW9uR3JvdXAubmV0d29ya05hbWUgPVxuICAgICAgICAgICAgICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwuc2VsZWN0ZWROZXR3b3JrLm5ldHdvcmtOYW1lO1xuXG4gICAgICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLmFwcGxpY2F0aW9uR3JvdXAua2V5ID1cbiAgICAgICAgICAgICAgICAgICAgICAgIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwuZ2VuZXJhdGVLZXkoYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwuYXBwbGljYXRpb25Hcm91cCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAqIGFwcGxpY2F0aW9uR3JvdXAgY29uc2lzdCBvZiBHcm91cCBOYW1lLCBOZXR3b3JrIE5hbWUsIElzb2xhdGlvbiBQb2xpY2llcywgQmFuZHdpZHRoIFBvbGljeVxuICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwuY3JlYXRlKGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLmFwcGxpY2F0aW9uR3JvdXApLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9BcHBsaWNhdGlvbkdyb3VwKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZnVuY3Rpb24gcmVzZXRGb3JtKCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwuYXBwbGljYXRpb25Hcm91cCA9IHtcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXBOYW1lOiAnJywgICAgICAgICAgLy8gRm9yIEdyb3VwIE5hbWVcbiAgICAgICAgICAgICAgICAgICAgbmV0d29ya05hbWU6ICcnLCAgICAgICAgLy8gRm9yIE5ldHdvcmsgTmFtZVxuICAgICAgICAgICAgICAgICAgICBwb2xpY2llczogW10sICAgICAgICAgICAvLyBGb3IgSXNvbGF0aW9uIHBvbGljaWVzXG4gICAgICAgICAgICAgICAgICAgIG5ldFByb2ZpbGU6ICcnLCAgICAgICAgIC8vIEZvciBCYW5kd2lkdGggcG9saWN5IE5hbWVcbiAgICAgICAgICAgICAgICAgICAgdGVuYW50TmFtZTogJ2RlZmF1bHQnLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBnZXROZXR3b3JrcygpO1xuXG4gICAgICAgICAgICBhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybC5jcmVhdGVBcHBsaWNhdGlvbkdyb3VwID0gY3JlYXRlQXBwbGljYXRpb25Hcm91cDtcbiAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLmNhbmNlbENyZWF0aW5nID0gY2FuY2VsQ3JlYXRpbmc7XG5cbiAgICAgICAgICAgIHJlc2V0Rm9ybSgpO1xuICAgICAgICB9XSk7XG4gLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzE1LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmFwcGxpY2F0aW9uZ3JvdXBzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMuZGV0YWlscycsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnQXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsIGFzIGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHBsaWNhdGlvbmdyb3Vwcy9hcHBsaWNhdGlvbmdyb3VwZGV0YWlscy5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMuZWRpdCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvZWRpdC86a2V5JyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnQXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsIGFzIGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHBsaWNhdGlvbmdyb3Vwcy9hcHBsaWNhdGlvbmdyb3VwZGV0YWlscy5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdBcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwnLCBbXG4gICAgICAgICckc3RhdGUnLFxuICAgICAgICAnJHN0YXRlUGFyYW1zJyxcbiAgICAgICAgJ0FwcGxpY2F0aW9uR3JvdXBzTW9kZWwnLFxuICAgICAgICAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgICAgICBmdW5jdGlvbiAoJHN0YXRlLFxuICAgICAgICAgICAgICAgICAgJHN0YXRlUGFyYW1zLFxuICAgICAgICAgICAgICAgICAgQXBwbGljYXRpb25Hcm91cHNNb2RlbCxcbiAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgICAgICB2YXIgYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsID0gdGhpcztcblxuICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLmFwcGxpY2F0aW9uR3JvdXAgPSB7fTtcbiAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybC5zZWxlY3RlZE5ldHdvcmsgPSB7fTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUbyBzaG93IGVkaXQgb3IgZGV0YWlscyBzY3JlZW4gYmFzZWQgb24gdGhlIHJvdXRlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZ1bmN0aW9uIHNldE1vZGUoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCRzdGF0ZS5pcygnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMuZWRpdCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybC5tb2RlID0gJ2VkaXQnO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybC5tb2RlID0gJ2RldGFpbHMnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9BcHBsaWNhdGlvbkdyb3VwKCkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMubGlzdCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub0FwcGxpY2F0aW9uR3JvdXBEZXRhaWxzKCkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMuZGV0YWlscycsIHsna2V5JzogYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLmFwcGxpY2F0aW9uR3JvdXAua2V5fSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNhbmNlbEVkaXRpbmcoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9BcHBsaWNhdGlvbkdyb3VwRGV0YWlscygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBkZWxldGVBcHBsaWNhdGlvbkdyb3VwKCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQXBwbGljYXRpb25Hcm91cHNNb2RlbC5kZWxldGUoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLmFwcGxpY2F0aW9uR3JvdXApLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblRvQXBwbGljYXRpb25Hcm91cCgpO1xuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHNhdmVBcHBsaWNhdGlvbkdyb3VwKCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCk7XG5cbiAgICAgICAgICAgICAgICBBcHBsaWNhdGlvbkdyb3Vwc01vZGVsLnNhdmUoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLmFwcGxpY2F0aW9uR3JvdXApLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvQXBwbGljYXRpb25Hcm91cERldGFpbHMoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwpO1xuXG4gICAgICAgICAgICBBcHBsaWNhdGlvbkdyb3Vwc01vZGVsLmdldE1vZGVsQnlLZXkoJHN0YXRlUGFyYW1zLmtleSlcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZ3JvdXApIHtcbiAgICAgICAgICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLmFwcGxpY2F0aW9uR3JvdXAgPSBncm91cDtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLnNhdmVBcHBsaWNhdGlvbkdyb3VwID0gc2F2ZUFwcGxpY2F0aW9uR3JvdXA7XG4gICAgICAgICAgICBhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwuY2FuY2VsRWRpdGluZyA9IGNhbmNlbEVkaXRpbmc7XG4gICAgICAgICAgICBhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwuZGVsZXRlQXBwbGljYXRpb25Hcm91cCA9IGRlbGV0ZUFwcGxpY2F0aW9uR3JvdXA7XG5cbiAgICAgICAgICAgIHNldE1vZGUoKTtcblxuICAgICAgICB9XSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMTEvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuYXBwbGljYXRpb25ncm91cHMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3Vwcy5saXN0Jywge1xuICAgICAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnQXBwbGljYXRpb25Hcm91cExpc3RDdHJsIGFzIGFwcGxpY2F0aW9uR3JvdXBMaXN0Q3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHBsaWNhdGlvbmdyb3Vwcy9hcHBsaWNhdGlvbmdyb3VwbGlzdC5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdBcHBsaWNhdGlvbkdyb3VwTGlzdEN0cmwnLFxuICAgICAgICBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdBcHBsaWNhdGlvbkdyb3Vwc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICAgICAgICAgIGZ1bmN0aW9uICgkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgQXBwbGljYXRpb25Hcm91cHNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgYXBwbGljYXRpb25Hcm91cExpc3RDdHJsID0gdGhpcztcblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdldEFwcGxpY2F0aW9uR3JvdXBzKHJlbG9hZCkge1xuICAgICAgICAgICAgICAgICAgICBBcHBsaWNhdGlvbkdyb3Vwc01vZGVsLmdldChyZWxvYWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihhcHBsaWNhdGlvbkdyb3VwTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBMaXN0Q3RybC5ncm91cHMgPSByZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYXBwbGljYXRpb25Hcm91cExpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vTG9hZCBmcm9tIGNhY2hlIGZvciBxdWljayBkaXNwbGF5IGluaXRpYWxseVxuICAgICAgICAgICAgICAgIGdldEFwcGxpY2F0aW9uR3JvdXBzKGZhbHNlKTtcblxuICAgICAgICAgICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAgICAgICAgIC8vRG9uJ3Qgc3RhcnQgYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgICAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdldEFwcGxpY2F0aW9uR3JvdXBzKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB9LCA1MDAwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAgICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfV0pO1xuXG4vKipcbiAqIENyZWF0ZWQgYnkgaGFyZGlrIGdhbmRoaSBvbiA2LzI4LzE2LlxuICovXG5cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmFwcGxpY2F0aW9uZ3JvdXBzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dkJhbmR3aWR0aHBvbGljeVwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIG1vZGU6XCI9XCIsXG4gICAgICAgICAgICAgICAgYXBwbGljYXRpb25ncm91cDonPSdcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFtcbiAgICAgICAgICAgICAgICAnJHNjb3BlJyxcbiAgICAgICAgICAgICAgICAnTmV0cHJvZmlsZXNNb2RlbCcsXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKCRzY29wZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgTmV0cHJvZmlsZXNNb2RlbCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubmV0UHJvZmlsZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkTmV0cHJvZmlsZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljeTp7fVxuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgKiBHZXQgcHJvZmlsZXMgZm9yIHRoZSBnaXZlbiB0ZW5hbnQuXG4gICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZXROZXRwcm9maWxlcygpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIE5ldHByb2ZpbGVzTW9kZWwuZ2V0KCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm5ldFByb2ZpbGVzID0gXy5maWx0ZXIocmVzdWx0LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0ZW5hbnROYW1lJzogJ2RlZmF1bHQnICAgICAgICAvL1RPRE86IFJlbW92ZSBoYXJkY29kZWQgdGVuYW50LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRzY29wZS5hcHBsaWNhdGlvbmdyb3VwLm5ldFByb2ZpbGUgIT09ICcnKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkTmV0cHJvZmlsZS5wb2xpY3kgPSBfLmZpbmQoJHNjb3BlLm5ldFByb2ZpbGVzLGZ1bmN0aW9uKHBvbGljeSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcG9saWN5LnByb2ZpbGVOYW1lID09PSAkc2NvcGUuYXBwbGljYXRpb25ncm91cC5uZXRQcm9maWxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgKiBBc3NpZ24gcHJvZmlsZU5hbWUgdG8gYXBwbGljYXRpb25ncm91cCB3aGljaGV2ZXIgdXNlciBoYXMgZ2l2ZW4gXG4gICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudXBkYXRlQXBwbGljYXRpb25ncm91cCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZigkc2NvcGUuc2VsZWN0ZWROZXRwcm9maWxlLnBvbGljeSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hcHBsaWNhdGlvbmdyb3VwLm5ldFByb2ZpbGUgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hcHBsaWNhdGlvbmdyb3VwLm5ldFByb2ZpbGUgPSAkc2NvcGUuc2VsZWN0ZWROZXRwcm9maWxlLnBvbGljeS5wcm9maWxlTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgZ2V0TmV0cHJvZmlsZXMoKTtcbiAgICAgICAgICAgIH1dLFxuXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcGxpY2F0aW9uZ3JvdXBzL2JhbmR3aWR0aHBvbGljeS5odG1sJ1xuICAgICAgICB9XG4gICAgfSk7XG5cblxuXG5cbi8qKlxuICogQ3JlYXRlZCBieSBoYXJkaWsgZ2FuZGhpIG9uIDcvOC8xNi5cbiAqL1xuXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5hcHBsaWNhdGlvbmdyb3Vwc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZJc29sYXRpb25wb2xpY3lcIixmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm57XG4gICAgICAgICAgICByZXN0cmljdDonRScsXG4gICAgICAgICAgICBzY29wZTp7XG4gICAgICAgICAgICAgICAgbW9kZTonPScsXG4gICAgICAgICAgICAgICAgYXBwbGljYXRpb25ncm91cDonPSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjb250cm9sbGVyOiBbXG4gICAgICAgICAgICAgICAgJyRzY29wZScsXG4gICAgICAgICAgICAgICAgJyRzdGF0ZVBhcmFtcycsXG4gICAgICAgICAgICAgICAgJ0FwcGxpY2F0aW9uR3JvdXBzTW9kZWwnLFxuICAgICAgICAgICAgICAgICdQb2xpY2llc01vZGVsJyxcbiAgICAgICAgICAgICAgICAnUnVsZXNNb2RlbCcsXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24oJHNjb3BlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICRzdGF0ZVBhcmFtcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICBBcHBsaWNhdGlvbkdyb3Vwc01vZGVsLFxuICAgICAgICAgICAgICAgICAgICAgICAgIFBvbGljaWVzTW9kZWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgUnVsZXNNb2RlbCl7XG5cbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmluY29taW5nUnVsZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm91dGdvaW5nUnVsZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkUG9saWN5ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9saWN5Ont9XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZFBvbGljaWVzID0gW107ICAgICAgICAgICAvLyBUbyBTdG9yZSBwb2xpY2llcyBzZWxlY3RlZCBieSB1c2VyIHRvIGRpc3BsYXlcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmlzb2xhdGlvblBvbGljaWVzID0gW107ICAgICAgICAgIC8vIFRvIEdldCBhbGwgaXNvbGF0aW9uIHBvbGljaWVzIG9mIHRlbmFudFxuXG5cbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAqIEdldCBpbmNvbWluZyBhbmQgb3V0Z29pbmcgcnVsZXMgZm9yIGVhY2ggcG9saWN5IHByZXNlbnQgaW4gYXBwbGljYXRpb25ncm91cFxuICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0UnVsZXMoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXBwbGljYXRpb25ncm91cC5wb2xpY2llcy5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1RvIGRpc3BsYXkgcnVsZXMgb2Ygc2VsZWN0ZWQgcG9saWNpZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSdWxlc01vZGVsLmdldEluY29taW5nUnVsZXMocG9saWN5LCAnZGVmYXVsdCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChydWxlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoJHNjb3BlLmluY29taW5nUnVsZXMsIHJ1bGVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUnVsZXNNb2RlbC5nZXRPdXRnb2luZ1J1bGVzKHBvbGljeSwgJ2RlZmF1bHQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocnVsZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KCRzY29wZS5vdXRnb2luZ1J1bGVzLCBydWxlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICogR2V0IHBvbGljaWVzIGZvciB0aGUgZ2l2ZW4gdGVuYW50LlxuICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0SXNvbGF0aW9uUG9saWNpZXMoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBQb2xpY2llc01vZGVsLmdldCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5pc29sYXRpb25Qb2xpY2llcyA9IF8uZmlsdGVyKHJlc3VsdCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndGVuYW50TmFtZSc6ICdkZWZhdWx0Jy8vVE9ETzogUmVtb3ZlIGhhcmRjb2RlZCB0ZW5hbnQuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgKiBBZGQgcG9saWN5IHRvIGFwcGxpY2F0aW9uIGdyb3VwXG4gICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYWRkSXNvbGF0aW9uUG9saWN5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudFBvbGljeU5hbWUgPSAkc2NvcGUuc2VsZWN0ZWRQb2xpY3kucG9saWN5LnBvbGljeU5hbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50UG9saWN5TmFtZSAhPT0gdW5kZWZpbmVkICYmIF8uaW5jbHVkZXMoJHNjb3BlLnNlbGVjdGVkUG9saWNpZXMsIGN1cnJlbnRQb2xpY3lOYW1lKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vVG8gZGlzcGxheSBzZWxlY3RlZCBwb2xpY2llc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZFBvbGljaWVzLnB1c2goY3VycmVudFBvbGljeU5hbWUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9UbyBkaXNwbGF5IHJ1bGVzIG9mIHNlbGVjdGVkIHBvbGljaWVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUnVsZXNNb2RlbC5nZXRJbmNvbWluZ1J1bGVzKGN1cnJlbnRQb2xpY3lOYW1lLCAnZGVmYXVsdCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChydWxlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoJHNjb3BlLmluY29taW5nUnVsZXMsIHJ1bGVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUnVsZXNNb2RlbC5nZXRPdXRnb2luZ1J1bGVzKGN1cnJlbnRQb2xpY3lOYW1lLCAnZGVmYXVsdCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChydWxlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoJHNjb3BlLm91dGdvaW5nUnVsZXMsIHJ1bGVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1RvIGJlIGFkZGVkIHRvIGFwcGxpY2F0aW9uIGdyb3VwIGFuZCBzYXZlZCB0byB0aGUgc2VydmVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFwcGxpY2F0aW9uZ3JvdXAucG9saWNpZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnB1c2goY3VycmVudFBvbGljeU5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgKiBSZW1vdmUgcG9saWN5IGZyb20gYXBwbGljYXRpb24gZ3JvdXBcbiAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5yZW1vdmVJc29sYXRpb25Qb2xpY3kgPSBmdW5jdGlvbihwb2xpY3lOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfLnJlbW92ZSgkc2NvcGUuc2VsZWN0ZWRQb2xpY2llcyxmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBvbGljeSA9PT0gcG9saWN5TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgXy5yZW1vdmUoJHNjb3BlLmFwcGxpY2F0aW9uZ3JvdXAucG9saWNpZXMsIGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcG9saWN5ID09PSBwb2xpY3lOYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfLnJlbW92ZSgkc2NvcGUuaW5jb21pbmdSdWxlcywgZnVuY3Rpb24gKHJ1bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcnVsZS5wb2xpY3lOYW1lID09PSBwb2xpY3lOYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfLnJlbW92ZSgkc2NvcGUub3V0Z29pbmdSdWxlcywgZnVuY3Rpb24gKHJ1bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcnVsZS5wb2xpY3lOYW1lID09PSBwb2xpY3lOYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAqICBUbyBjaGVjayAnZGV0YWlscycgb3IgJ2VkaXQnIG1vZGUgKG5vdCBjcmVhdGUgbW9kZSlcbiAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIGlmKCRzY29wZS5tb2RlID09ICdkZXRhaWxzJyB8fCAoJHNjb3BlLm1vZGUgPT0gJ2VkaXQnICYmICRzY29wZS5hcHBsaWNhdGlvbmdyb3VwLmdyb3VwTmFtZSAhPSBcIlwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9BcHBsaWNhdGlvbiBHcm91cHMgbWlnaHQgbm90IGhhdmUgYW55IHBvbGljaWVzIGFzc29jaWF0ZWQgd2l0aCB0aGVtIHNvIGRlZmluZSBhbiBlbXB0eSBhcnJheVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5hcHBsaWNhdGlvbmdyb3VwLnBvbGljaWVzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXBwbGljYXRpb25ncm91cC5wb2xpY2llcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0UnVsZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBnZXRJc29sYXRpb25Qb2xpY2llcygpO1xuICAgICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6J2FwcGxpY2F0aW9uZ3JvdXBzL2lzb2xhdGlvbnBvbGljeS5odG1sJ1xuICAgICAgICB9XG4gICAgfSk7XG5cblxuXG5cbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8xMS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5kYXNoYm9hcmQnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5kYXNoYm9hcmQnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2Rhc2hib2FyZCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0Rhc2hib2FyZEN0cmwgYXMgZGFzaGJvYXJkQ3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdkYXNoYm9hcmQvZGFzaGJvYXJkLmh0bWwnXG4gICAgICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignRGFzaGJvYXJkQ3RybCcsXG4gICAgICAgIFtcbiAgICAgICAgICAgICckc2NvcGUnLFxuICAgICAgICAgICAgJyRpbnRlcnZhbCcsXG4gICAgICAgICAgICAnTm9kZXNNb2RlbCcsXG4gICAgICAgICAgICAnTmV0d29ya3NNb2RlbCcsXG4gICAgICAgICAgICAnVm9sdW1lc01vZGVsJyxcbiAgICAgICAgICAgICdBcHBsaWNhdGlvbkdyb3Vwc01vZGVsJyxcbiAgICAgICAgICAgICdQb2xpY2llc01vZGVsJyxcbiAgICAgICAgICAgICdTdG9yYWdlUG9saWNpZXNNb2RlbCcsXG4gICAgICAgICAgICBmdW5jdGlvbiAoJHNjb3BlLFxuICAgICAgICAgICAgICAgICAgICAgICRpbnRlcnZhbCxcbiAgICAgICAgICAgICAgICAgICAgICBOb2Rlc01vZGVsLFxuICAgICAgICAgICAgICAgICAgICAgIE5ldHdvcmtzTW9kZWwsXG4gICAgICAgICAgICAgICAgICAgICAgVm9sdW1lc01vZGVsLFxuICAgICAgICAgICAgICAgICAgICAgIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwsXG4gICAgICAgICAgICAgICAgICAgICAgUG9saWNpZXNNb2RlbCxcbiAgICAgICAgICAgICAgICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbCkge1xuICAgICAgICAgICAgICAgIHZhciBkYXNoYm9hcmRDdHJsID0gdGhpcztcblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdldERhc2hib2FyZEluZm8ocmVsb2FkKSB7XG4gICAgICAgICAgICAgICAgICAgIE5vZGVzTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXNoYm9hcmRDdHJsLm5vZGVzID0gcmVzdWx0Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBOZXR3b3Jrc01vZGVsLmdldChyZWxvYWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFzaGJvYXJkQ3RybC5uZXR3b3JrcyA9IHJlc3VsdC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgVm9sdW1lc01vZGVsLmdldChyZWxvYWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFzaGJvYXJkQ3RybC52b2x1bWVzID0gcmVzdWx0Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBBcHBsaWNhdGlvbkdyb3Vwc01vZGVsLmdldChyZWxvYWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFzaGJvYXJkQ3RybC5ncm91cHMgPSByZXN1bHQubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIFBvbGljaWVzTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXNoYm9hcmRDdHJsLm5ldHdvcmtwb2xpY2llcyA9IHJlc3VsdC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgU3RvcmFnZVBvbGljaWVzTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXNoYm9hcmRDdHJsLnN0b3JhZ2Vwb2xpY2llcyA9IHJlc3VsdC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL1dpbGwgZGlzcGxheSAwIGlmIHRoZXJlIGlzIGVycm9yIGZldGNoaW5nIGRhdGFcbiAgICAgICAgICAgICAgICBkYXNoYm9hcmRDdHJsLm5vZGVzID0gMDtcbiAgICAgICAgICAgICAgICBkYXNoYm9hcmRDdHJsLm5ldHdvcmtzID0gMDtcbiAgICAgICAgICAgICAgICBkYXNoYm9hcmRDdHJsLnZvbHVtZXMgPSAwO1xuICAgICAgICAgICAgICAgIGRhc2hib2FyZEN0cmwuZ3JvdXBzID0gMDtcbiAgICAgICAgICAgICAgICBkYXNoYm9hcmRDdHJsLm5ldHdvcmtwb2xpY2llcyA9IDA7XG4gICAgICAgICAgICAgICAgZGFzaGJvYXJkQ3RybC5zdG9yYWdlcG9saWNpZXMgPSAwO1xuXG4gICAgICAgICAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgICAgICAgICAgZ2V0RGFzaGJvYXJkSW5mbyhmYWxzZSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGdldERhc2hib2FyZEluZm8odHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSwgNTAwMCk7XG5cbiAgICAgICAgICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XSk7XG5cbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5sb2dpbicpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5sb2dpbicsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2xvZ2luL2xvZ2luLmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdMb2dpbkN0cmwgYXMgbG9naW5DdHJsJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdMb2dpbkN0cmwnLCBbJyRzdGF0ZScsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgICAgICB2YXIgbG9naW5DdHJsID0gdGhpcztcblxuICAgICAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9EYXNoYm9hcmQoKSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5kYXNoYm9hcmQnLCB7dXNlcm5hbWU6IGxvZ2luQ3RybC51c2VybmFtZX0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBsb2dpbigpIHtcbiAgICAgICAgICAgICAgICByZXR1cm5Ub0Rhc2hib2FyZCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGxvZ2luQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IobG9naW5DdHJsKTtcbiAgICAgICAgICAgIGxvZ2luQ3RybC5sb2dpbiA9IGxvZ2luO1xuXG4gICAgICAgIH1dKTtcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5tZW51JylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL20nLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbWVudS9tZW51Lmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdNZW51Q3RybCBhcyBtZW51Q3RybCcsXG4gICAgICAgICAgICAgICAgcGFyYW1zOiB7dXNlcm5hbWU6IG51bGx9XG4gICAgICAgICAgICB9KVxuICAgICAgICA7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ01lbnVDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zKSB7XG4gICAgICAgIHZhciBtZW51Q3RybCA9IHRoaXM7XG5cbiAgICAgICAgZnVuY3Rpb24gbG9nb3V0KCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubG9naW4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIG1lbnVDdHJsLnVzZXJuYW1lID0gJHN0YXRlUGFyYW1zLnVzZXJuYW1lO1xuICAgICAgICBtZW51Q3RybC5sb2dvdXQgPSBsb2dvdXQ7XG5cbiAgICB9XSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgaGFyZGlrIGdhbmRoaSBvbiA2LzI0LzE2LlxuICovXG5cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2Lm5ldHdvcmtwb2xpY2llc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZCYW5kd2lkdGhcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgYmFuZHdpZHRoUG9saWN5Oic9JyxcbiAgICAgICAgICAgICAgICBtb2RlOlwiQFwiXG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBsaW5rOmZ1bmN0aW9uKHNjb3BlKSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoc2NvcGUuYmFuZHdpZHRoUG9saWN5LmJhbmR3aWR0aCAhPSAnJyl7XG4gICAgICAgICAgICAgICAgICAgIHZhciBiYW5kd2lkdGhBcnJheSA9IHNjb3BlLmJhbmR3aWR0aFBvbGljeS5iYW5kd2lkdGguc3BsaXQoJyAnKTtcbiAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLmJhbmR3aWR0aFBvbGljeS5iYW5kd2lkdGhOdW1iZXIgPSBOdW1iZXIoYmFuZHdpZHRoQXJyYXlbMF0pO1xuICAgICAgICAgICAgICAgICAgICBzY29wZS5iYW5kd2lkdGhQb2xpY3kuYmFuZHdpZHRoVW5pdCA9IGJhbmR3aWR0aEFycmF5WzFdO1xuXG4gICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3JrX3BvbGljaWVzL2JhbmR3aWR0aC5odG1sJ1xuICAgICAgICB9XG4gICAgfSk7XG5cbi8qXG4vKipcbiAqIENyZWF0ZWQgYnkgaGFyZGlrIGdhbmRoaSBvbiA2LzE0LzE2LlxuICovXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3BvbGljaWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmJhbmR3aWR0aC5jcmVhdGUnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0JhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwgYXMgYmFuZHdpZHRoUG9saWN5Q3JlYXRlQ3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3JrX3BvbGljaWVzL2JhbmR3aWR0aHBvbGljeWNyZWF0ZS5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdCYW5kd2lkdGhQb2xpY3lDcmVhdGVDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywnTmV0cHJvZmlsZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgTmV0cHJvZmlsZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgICAgIHZhciBiYW5kd2lkdGhQb2xpY3lDcmVhdGVDdHJsID0gdGhpcztcblxuICAgICAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Qb2xpY2llcygpIHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5saXN0LmJhbmR3aWR0aCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBjYW5jZWxDcmVhdGluZygpIHtcbiAgICAgICAgICAgICAgICByZXR1cm5Ub1BvbGljaWVzKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNyZWF0ZVBvbGljeSgpIHtcbiAgICAgICAgICAgICAgICBpZiAoYmFuZHdpZHRoUG9saWN5Q3JlYXRlQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoYmFuZHdpZHRoUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwpO1xuXG4gICAgICAgICAgICAgICAgICAgIGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwubmV3UG9saWN5LmtleSA9XG4gICAgICAgICAgICAgICAgICAgICAgICBOZXRwcm9maWxlc01vZGVsLmdlbmVyYXRlS2V5KGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwubmV3UG9saWN5KTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwubmV3UG9saWN5LmJhbmR3aWR0aCA9IGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwubmV3UG9saWN5LmJhbmR3aWR0aE51bWJlclxuICAgICAgICAgICAgICAgICAgICAgICAgKyBcIiBcIisgYmFuZHdpZHRoUG9saWN5Q3JlYXRlQ3RybC5uZXdQb2xpY3kuYmFuZHdpZHRoVW5pdDtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIE5ldHByb2ZpbGVzTW9kZWwuY3JlYXRlKGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwubmV3UG9saWN5KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYmFuZHdpZHRoUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1BvbGljaWVzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gcmVzZXRGb3JtKCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYmFuZHdpZHRoUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwubmV3UG9saWN5ID0ge1xuICAgICAgICAgICAgICAgICAgICBwcm9maWxlTmFtZTogJycsXG4gICAgICAgICAgICAgICAgICAgIHRlbmFudE5hbWU6ICdkZWZhdWx0JywgLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgICAgICAgICAgYmFuZHdpZHRoOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgRFNDUDogJydcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBiYW5kd2lkdGhQb2xpY3lDcmVhdGVDdHJsLmNyZWF0ZVBvbGljeSA9IGNyZWF0ZVBvbGljeTtcbiAgICAgICAgICAgIGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwuY2FuY2VsQ3JlYXRpbmcgPSBjYW5jZWxDcmVhdGluZztcblxuICAgICAgICAgICAgcmVzZXRGb3JtKCk7XG4gICAgICAgIH1dKTtcblxuXG5cbi8qKlxuICogQ3JlYXRlZCBieSBoYXJkaWsgZ2FuZGhpIG9uIDYvMTYvMTYuXG4gKi9cblxuXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtwb2xpY2llcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGguZGV0YWlscycsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnQmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwgYXMgYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmV0d29ya19wb2xpY2llcy9iYW5kd2lkdGhwb2xpY3lkZXRhaWxzLmh0bWwnXG4gICAgICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmJhbmR3aWR0aC5lZGl0Jywge1xuICAgICAgICAgICAgICAgIHVybDogJy9lZGl0LzprZXknLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdCYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCBhcyBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3JrX3BvbGljaWVzL2JhbmR3aWR0aHBvbGljeWRldGFpbHMuaHRtbCdcbiAgICAgICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdCYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCcsIFtcbiAgICAgICAgJyRzdGF0ZScsXG4gICAgICAgICckc3RhdGVQYXJhbXMnLFxuICAgICAgICAnTmV0cHJvZmlsZXNNb2RlbCcsXG4gICAgICAgICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgTmV0cHJvZmlsZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgICAgIHZhciBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCA9IHRoaXM7XG5cbiAgICAgICAgICAgIGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLmJhbmR3aWR0aFByb2ZpbGVzID0gW107XG5cbiAgICAgICAgICAgIC8qIEdldCBwYXJ0aWN1bGFyIFByb2ZpbGUgZm9yIGJhc2VkIG9uIGtleSovXG4gICAgICAgICAgICBOZXRwcm9maWxlc01vZGVsLmdldE1vZGVsQnlLZXkoJHN0YXRlUGFyYW1zLmtleSlcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLnBvbGljeSA9IHBvbGljeTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUbyBzaG93IGVkaXQgb3IgZGV0YWlscyBzY3JlZW4gYmFzZWQgb24gdGhlIHJvdXRlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZ1bmN0aW9uIHNldE1vZGUoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCRzdGF0ZS5pcygnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmJhbmR3aWR0aC5lZGl0JykpIHtcbiAgICAgICAgICAgICAgICAgICAgYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwubW9kZSA9ICdlZGl0JztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybC5tb2RlID0gJ2RldGFpbHMnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gZGVsZXRlUG9saWN5KCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIE5ldHByb2ZpbGVzTW9kZWwuZGVsZXRlVXNpbmdLZXkoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwucG9saWN5LmtleSwgJ25hbWUnKS50aGVuKFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblRvUG9saWNpZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1BvbGljaWVzKCkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmxpc3QuYmFuZHdpZHRoJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHJldHVyblRvUG9saWN5RGV0YWlscygpIHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGguZGV0YWlscycsIHsna2V5JzogYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwucG9saWN5LmtleX0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBjYW5jZWxFZGl0aW5nKCkge1xuICAgICAgICAgICAgICAgIHJldHVyblRvUG9saWN5RGV0YWlscygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBzYXZlUG9saWN5KCkge1xuICAgICAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAgICAgLy9jaGVja2luZyBpZiBhbGwgdmFsaWRhdGlvbnMgaGF2ZSBwYXNzZWRcbiAgICAgICAgICAgICAgICBpZiAoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kuYmFuZHdpZHRoID0gYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwucG9saWN5LmJhbmR3aWR0aE51bWJlciArIFwiIFwiICsgYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwucG9saWN5LmJhbmR3aWR0aFVuaXQ7XG4gICAgICAgICAgICAgICAgICAgIE5ldHByb2ZpbGVzTW9kZWwuc2F2ZShiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1BvbGljeURldGFpbHMoKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwpO1xuXG4gICAgICAgICAgICBzZXRNb2RlKCk7XG5cbiAgICAgICAgICAgIGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLmRlbGV0ZVBvbGljeSA9IGRlbGV0ZVBvbGljeTtcbiAgICAgICAgICAgIGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLnNhdmVQb2xpY3kgPSBzYXZlUG9saWN5O1xuICAgICAgICAgICAgYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwuY2FuY2VsRWRpdGluZyA9IGNhbmNlbEVkaXRpbmc7XG5cbiAgICAgICAgfV0pO1xuXG4vKipcbiAqIENyZWF0ZWQgYnkgaGFyZGlrIGdhbmRoaSBvbiA2LzE0LzE2LlxuICovXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3BvbGljaWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmxpc3QuYmFuZHdpZHRoJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9iYW5kd2lkdGgnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdCYW5kd2lkdGhQb2xpY3lMaXN0Q3RybCBhcyBiYW5kd2lkdGhQb2xpY3lMaXN0Q3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3JrX3BvbGljaWVzL2JhbmR3aWR0aHBvbGljeWxpc3QuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignQmFuZHdpZHRoUG9saWN5TGlzdEN0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdOZXRwcm9maWxlc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICAgICAgZnVuY3Rpb24gKCRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBOZXRwcm9maWxlc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICAgICAgdmFyIHBvbGljaWVzTGlzdEN0cmwgPSB0aGlzO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRQb2xpY2llcyhyZWxvYWQpIHtcbiAgICAgICAgICAgICAgICBOZXRwcm9maWxlc01vZGVsLmdldChyZWxvYWQpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIocG9saWNpZXNMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2xpY2llc0xpc3RDdHJsLnBvbGljaWVzID0gJGZpbHRlcignb3JkZXJCeScpKHJlc3VsdCwgJ3Byb2ZpbGVOYW1lJyk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHBvbGljaWVzTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgICAgICBnZXRQb2xpY2llcyh0cnVlKTtcblxuICAgICAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgICAgICAvL0Rvbid0IHN0YXJ0IGF1dG8tcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBnZXRQb2xpY2llcyh0cnVlKTtcbiAgICAgICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgfV0pO1xuXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMTAvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3BvbGljaWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbi5jcmVhdGUnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0lzb2xhdGlvblBvbGljeUNyZWF0ZUN0cmwgYXMgaXNvbGF0aW9uUG9saWN5Q3JlYXRlQ3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3JrX3BvbGljaWVzL2lzb2xhdGlvbnBvbGljeWNyZWF0ZS5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdJc29sYXRpb25Qb2xpY3lDcmVhdGVDdHJsJywgWyckc3RhdGUnLCAnUG9saWNpZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsIFBvbGljaWVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBpc29sYXRpb25Qb2xpY3lDcmVhdGVDdHJsID0gdGhpcztcblxuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1BvbGljaWVzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMubGlzdC5pc29sYXRpb24nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbENyZWF0aW5nKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9Qb2xpY2llcygpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlUG9saWN5KCkge1xuICAgICAgICAgICAgaWYgKGlzb2xhdGlvblBvbGljeUNyZWF0ZUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoaXNvbGF0aW9uUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5Q3JlYXRlQ3RybC5uZXdQb2xpY3kua2V5ID1cbiAgICAgICAgICAgICAgICAgICAgUG9saWNpZXNNb2RlbC5nZW5lcmF0ZUtleShpc29sYXRpb25Qb2xpY3lDcmVhdGVDdHJsLm5ld1BvbGljeSk7XG4gICAgICAgICAgICAgICAgUG9saWNpZXNNb2RlbC5jcmVhdGUoaXNvbGF0aW9uUG9saWN5Q3JlYXRlQ3RybC5uZXdQb2xpY3kpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGlzb2xhdGlvblBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1BvbGljaWVzKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihpc29sYXRpb25Qb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeUNyZWF0ZUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZXNldEZvcm0oKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGlzb2xhdGlvblBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5Q3JlYXRlQ3RybC5uZXdQb2xpY3kgPSB7XG4gICAgICAgICAgICAgICAgcG9saWN5TmFtZTogJycsXG4gICAgICAgICAgICAgICAgdGVuYW50TmFtZTogJ2RlZmF1bHQnLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBpc29sYXRpb25Qb2xpY3lDcmVhdGVDdHJsLmNyZWF0ZVBvbGljeSA9IGNyZWF0ZVBvbGljeTtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5Q3JlYXRlQ3RybC5jYW5jZWxDcmVhdGluZyA9IGNhbmNlbENyZWF0aW5nO1xuXG4gICAgICAgIHJlc2V0Rm9ybSgpO1xuICAgIH1dKTtcblxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3BvbGljaWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbi5kZXRhaWxzJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdJc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCBhcyBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3JrX3BvbGljaWVzL2lzb2xhdGlvbnBvbGljeWRldGFpbHMuaHRtbCdcbiAgICAgICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuaXNvbGF0aW9uLmVkaXQnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2VkaXQvOmtleScsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0lzb2xhdGlvblBvbGljeURldGFpbHNDdHJsIGFzIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtfcG9saWNpZXMvaXNvbGF0aW9ucG9saWN5ZGV0YWlscy5odG1sJ1xuICAgICAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ0lzb2xhdGlvblBvbGljeURldGFpbHNDdHJsJywgW1xuICAgICAgICAnJHN0YXRlJyxcbiAgICAgICAgJyRzdGF0ZVBhcmFtcycsXG4gICAgICAgICdQb2xpY2llc01vZGVsJyxcbiAgICAgICAgJ1J1bGVzTW9kZWwnLFxuICAgICAgICAnTmV0d29ya3NNb2RlbCcsXG4gICAgICAgICdBcHBsaWNhdGlvbkdyb3Vwc01vZGVsJyxcbiAgICAgICAgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICAgICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBQb2xpY2llc01vZGVsLCBSdWxlc01vZGVsLCBOZXR3b3Jrc01vZGVsLCBBcHBsaWNhdGlvbkdyb3Vwc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICAgICAgdmFyIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsID0gdGhpcztcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ldHdvcmtzID0gW107XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5hcHBsaWNhdGlvbkdyb3VwcyA9IFtdO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nTmV0d29ya1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nTmV0d29ya1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nSVBBZGRyZXNzU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlT3V0Z29pbmdJUEFkZHJlc3NTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nU2VsZWN0ZWRBcHBsaWNhdGlvbkdyb3VwID0gJyc7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1NlbGVjdGVkQXBwbGljYXRpb25Hcm91cCA9ICcnO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdTZWxlY3RlZE5ldHdvcmsgPSAnJztcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nU2VsZWN0ZWROZXR3b3JrID0gJyc7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvcnJlY3RDSURSID0gZmFsc2U7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC52YWxpZGF0ZUNJRFJGbGFnID0gZmFsc2U7XG5cblxuICAgICAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Qb2xpY2llcygpIHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5saXN0Lmlzb2xhdGlvbicpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1BvbGljeURldGFpbHMoKSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuaXNvbGF0aW9uLmRldGFpbHMnLCB7a2V5OiBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kua2V5fSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNhbmNlbEVkaXRpbmcoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9Qb2xpY3lEZXRhaWxzKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogR28gYmFjayB0byBwb2xpY3kgZGV0YWlscyBhZnRlciBkb25lIGVkaXRpbmdcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gZG9uZUVkaXRpbmcoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9Qb2xpY3lEZXRhaWxzKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGRlbGV0ZVBvbGljeSgpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBQb2xpY2llc01vZGVsLmRlbGV0ZShpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9Qb2xpY2llcygpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVG8gc2hvdyBlZGl0IG9yIGRldGFpbHMgc2NyZWVuIGJhc2VkIG9uIHRoZSByb3V0ZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmdW5jdGlvbiBzZXRNb2RlKCkge1xuICAgICAgICAgICAgICAgIGlmICgkc3RhdGUuaXMoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5pc29sYXRpb24uZWRpdCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm1vZGUgPSAnZWRpdCc7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubW9kZSA9ICdkZXRhaWxzJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlc2V0TmV3SW5jb21pbmdSdWxlKCkge1xuICAgICAgICAgICAgICAgIC8vUnVsZSBvYmplY3QgdG8gYmUgY3JlYXRlZCBvbiBzZXJ2ZXJcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUgPSB7XG4gICAgICAgICAgICAgICAgICAgIHJ1bGVJZDogJycsXG4gICAgICAgICAgICAgICAgICAgIHByaW9yaXR5OiAxLFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdhbGxvdycsLy90byBtYWtlIGl0IGRlZmF1bHQgc2VsZWN0ZWQgb3B0aW9uIGluIFVJXG4gICAgICAgICAgICAgICAgICAgIGZyb21FbmRwb2ludEdyb3VwOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgZnJvbU5ldHdvcms6ICcnLFxuICAgICAgICAgICAgICAgICAgICBmcm9tSXBBZGRyZXNzOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgcHJvdG9jb2w6ICd0Y3AnLC8vdG8gbWFrZSBpdCBkZWZhdWx0IHNlbGVjdGVkIG9wdGlvbiBpbiBVSVxuICAgICAgICAgICAgICAgICAgICBwb3J0OiAwLFxuICAgICAgICAgICAgICAgICAgICBkaXJlY3Rpb246ICdpbicsXG4gICAgICAgICAgICAgICAgICAgIHRlbmFudE5hbWU6ICdkZWZhdWx0JyxcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5TmFtZTogaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwucG9saWN5LnBvbGljeU5hbWVcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nU2VsZWN0ZWRBcHBsaWNhdGlvbkdyb3VwID0gJyc7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdTZWxlY3RlZE5ldHdvcmsgPSAnJztcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdOZXR3b3JrU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVJbmNvbWluZ0lQQWRkcmVzc1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29ycmVjdENJRFIgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC52YWxpZGF0ZUNJRFJGbGFnID0gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlc2V0TmV3T3V0Z29pbmdSdWxlKCkge1xuICAgICAgICAgICAgICAgIC8vUnVsZSBvYmplY3QgdG8gYmUgY3JlYXRlZCBvbiBzZXJ2ZXJcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1J1bGUgPSB7XG4gICAgICAgICAgICAgICAgICAgIHJ1bGVJZDogJycsXG4gICAgICAgICAgICAgICAgICAgIHByaW9yaXR5OiAxLFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdhbGxvdycsLy90byBtYWtlIGl0IGRlZmF1bHQgc2VsZWN0ZWQgb3B0aW9uIGluIFVJXG4gICAgICAgICAgICAgICAgICAgIHRvRW5kcG9pbnRHcm91cDogJycsXG4gICAgICAgICAgICAgICAgICAgIHRvTmV0d29yazogJycsXG4gICAgICAgICAgICAgICAgICAgIHRvSXBBZGRyZXNzOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgcHJvdG9jb2w6ICd0Y3AnLC8vdG8gbWFrZSBpdCBkZWZhdWx0IHNlbGVjdGVkIG9wdGlvbiBpbiBVSVxuICAgICAgICAgICAgICAgICAgICBwb3J0OiAwLFxuICAgICAgICAgICAgICAgICAgICBkaXJlY3Rpb246ICdvdXQnLFxuICAgICAgICAgICAgICAgICAgICB0ZW5hbnROYW1lOiAnZGVmYXVsdCcsXG4gICAgICAgICAgICAgICAgICAgIHBvbGljeU5hbWU6IGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLnBvbGljeS5wb2xpY3lOYW1lXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1NlbGVjdGVkQXBwbGljYXRpb25Hcm91cCA9ICcnO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nU2VsZWN0ZWROZXR3b3JrID0gJyc7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nTmV0d29ya1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlT3V0Z29pbmdJUEFkZHJlc3NTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvcnJlY3RDSURSID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwudmFsaWRhdGVDSURSRmxhZyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEdldCBuZXR3b3JrIG5hbWVzIGZvciB0aGUgZ2l2ZW4gdGVuYW50LlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXROZXR3b3JrcygpIHtcbiAgICAgICAgICAgICAgICBOZXR3b3Jrc01vZGVsLmdldCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAvL18uZmlsdGVyKCkgcmV0dXJucyBhIG5ldyBhcnJheVxuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXR3b3JrcyA9IF8uZmlsdGVyKHJlc3VsdCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ3RlbmFudE5hbWUnOiAnZGVmYXVsdCcvL1RPRE86IFJlbW92ZSBoYXJkY29kZWQgdGVuYW50LlxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBHZXQgYXBwbGljYXRpb24gZ3JvdXAgbmFtZXMgZm9yIHRoZSBnaXZlbiB0ZW5hbnQuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldEFwcGxpY2F0aW9uR3JvdXBzKCkge1xuICAgICAgICAgICAgICAgIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwuZ2V0KClcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9fLmZpbHRlcigpIHJldHVybnMgYSBuZXcgYXJyYXlcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmFwcGxpY2F0aW9uR3JvdXBzID0gXy5maWx0ZXIocmVzdWx0LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RlbmFudE5hbWUnOiAnZGVmYXVsdCcvL1RPRE86IFJlbW92ZSBoYXJkY29kZWQgdGVuYW50LlxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEV2ZW50IGhhbmRsZXIgdG8gZGlzYWJsZSBuZXR3b3JrIHNlbGVjdGlvbiBib3ggb25jZSBhcHBsaWNhdGlvbiBncm91cCBpcyBzZWxlY3RlZCB3aGlsZSBjcmVhdGluZyBhIG5ld1xuICAgICAgICAgICAgICogcnVsZS5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gb25DaGFuZ2VPdXRnb2luZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nU2VsZWN0ZWRBcHBsaWNhdGlvbkdyb3VwICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9JZiBhcHBsaWNhdGlvbiBncm91cCBoYXMgYmVlbiBzZWxlY3RlZFxuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1J1bGUudG9FbmRwb2ludEdyb3VwID1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nU2VsZWN0ZWRBcHBsaWNhdGlvbkdyb3VwLmdyb3VwTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlLnRvTmV0d29yayA9ICcnO1xuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlT3V0Z29pbmdOZXR3b3JrU2VsZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL1doZW4gJ25vbmUnIGlzIHNlbGVjdGVkXG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZS50b0VuZHBvaW50R3JvdXAgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nTmV0d29ya1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBFdmVudCBoYW5kbGVyIHRvIGRpc2FibGUgbmV0d29yayBzZWxlY3Rpb24gYm94IG9uY2UgYXBwbGljYXRpb24gZ3JvdXAgaXMgc2VsZWN0ZWQgd2hpbGUgY3JlYXRpbmcgYSBuZXdcbiAgICAgICAgICAgICAqIHJ1bGUuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZ1bmN0aW9uIG9uQ2hhbmdlSW5jb21pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmIChpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1NlbGVjdGVkQXBwbGljYXRpb25Hcm91cCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vSWYgYXBwbGljYXRpb24gZ3JvdXAgaGFzIGJlZW4gc2VsZWN0ZWRcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlLmZyb21FbmRwb2ludEdyb3VwID1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nU2VsZWN0ZWRBcHBsaWNhdGlvbkdyb3VwLmdyb3VwTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlLmZyb21OZXR3b3JrID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVJbmNvbWluZ05ldHdvcmtTZWxlY3Rpb24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vV2hlbiAnbm9uZScgaXMgc2VsZWN0ZWRcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlLmZyb21FbmRwb2ludEdyb3VwID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nTmV0d29ya1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEV2ZW50IGhhbmRsZXIgdG8gZGlzYWJsZSBhcHBsaWNhdGlvbiBncm91cCBzZWxlY3Rpb24gYm94IG9uY2UgbmV0d29yayBpcyBzZWxlY3RlZCB3aGlsZSBjcmVhdGluZyBhIG5ld1xuICAgICAgICAgICAgICogcnVsZS5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gb25DaGFuZ2VPdXRnb2luZ05ldHdvcmtTZWxlY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nU2VsZWN0ZWROZXR3b3JrIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAvL0lmIG5ldHdvcmsgaGFzIGJlZW4gc2VsZWN0ZWRcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlLnRvTmV0d29yayA9XG4gICAgICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1NlbGVjdGVkTmV0d29yaztcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlLlRvRW5kcG9pbnRHcm91cCA9ICcnO1xuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlT3V0Z29pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nSVBBZGRyZXNzU2VsZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1J1bGUudG9JcEFkZHJlc3MgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlT3V0Z29pbmdJUEFkZHJlc3NTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogRXZlbnQgaGFuZGxlciB0byBkaXNhYmxlIGFwcGxpY2F0aW9uIGdyb3VwIHNlbGVjdGlvbiBib3ggb25jZSBuZXR3b3JrIGlzIHNlbGVjdGVkIHdoaWxlIGNyZWF0aW5nIGEgbmV3XG4gICAgICAgICAgICAgKiBydWxlLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmdW5jdGlvbiBvbkNoYW5nZUluY29taW5nTmV0d29ya1NlbGVjdGlvbigpIHtcbiAgICAgICAgICAgICAgICBpZiAoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdTZWxlY3RlZE5ldHdvcmsgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAvL0lmIG5ldHdvcmsgaGFzIGJlZW4gc2VsZWN0ZWRcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlLmZyb21OZXR3b3JrID1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nU2VsZWN0ZWROZXR3b3JrO1xuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUuZnJvbUVuZHBvaW50R3JvdXAgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVJbmNvbWluZ0lQQWRkcmVzc1NlbGVjdGlvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlLmZyb21OZXR3b3JrID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVJbmNvbWluZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nSVBBZGRyZXNzU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEdlbmVyYXRlcyBydWxlIGlkXG4gICAgICAgICAgICAgKiBUT0RPIE1ha2UgaXQgY3J5cHRvZ3JhcGhpY2FsbHkgc3Ryb25nZXIgb25jZSB3ZSBoYXZlIG11bHRpcGxlIHVzZXJzIHVwZGF0aW5nIHNhbWUgcG9saWN5XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdlbmVyYXRlUnVsZUlkKHJ1bGUpIHtcbiAgICAgICAgICAgICAgICBydWxlLnJ1bGVJZCA9XG4gICAgICAgICAgICAgICAgICAgIChpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvbWluZ1J1bGVzLmxlbmd0aCArIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm91dGdvaW5nUnVsZXMubGVuZ3RoICsgMSkudG9TdHJpbmcoKSArICctJyArXG4gICAgICAgICAgICAgICAgICAgIERhdGUubm93KCkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSdWxlIGlzIHNhdmVkIHRvIHNlcnZlclxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmdW5jdGlvbiBhZGRJbmNvbWluZ1J1bGUoKSB7XG4gICAgICAgICAgICAgICAgaWYodmFsaWRhdGVDSURSKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nUnVsZS5mcm9tSXBBZGRyZXNzKSkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIGdlbmVyYXRlUnVsZUlkKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nUnVsZSk7XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nUnVsZS5rZXkgPSBSdWxlc01vZGVsLmdlbmVyYXRlS2V5KGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nUnVsZSk7XG4gICAgICAgICAgICAgICAgICAgIFJ1bGVzTW9kZWwuY3JlYXRlKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nUnVsZSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29taW5nUnVsZXMucHVzaChyZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzZXROZXdJbmNvbWluZ1J1bGUoKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIG9uQ2hhbmdlSW5jb21pbmdJUEFkZHJlc3MoKXtcbiAgICAgICAgICAgICAgICBpZihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUuZnJvbUlwQWRkcmVzcyA9PSAnJyl7XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29ycmVjdENJRFIgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nTmV0d29ya1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdOZXR3b3JrU2VsZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC52YWxpZGF0ZUNJRFJGbGFnICYmXG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29ycmVjdENJRFIpe1xuICAgICAgICAgICAgICAgICAgICB2YWxpZGF0ZUNJRFIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlLmZyb21JcEFkZHJlc3MpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZnVuY3Rpb24gb25DaGFuZ2VPdXRnb2luZ0lQQWRkcmVzcygpe1xuICAgICAgICAgICAgICAgIGlmKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZS50b0lwQWRkcmVzcyA9PSAnJyl7XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29ycmVjdENJRFIgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nTmV0d29ya1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlT3V0Z29pbmdOZXR3b3JrU2VsZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC52YWxpZGF0ZUNJRFJGbGFnICYmXG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29ycmVjdENJRFIpe1xuICAgICAgICAgICAgICAgICAgICB2YWxpZGF0ZUNJRFIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlLnRvSXBBZGRyZXNzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHZhbGlkYXRlQ0lEUihpcGFkZHJlc3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgY2lkclBhdHRlcm4gPSBuZXcgUmVnRXhwKENvbnRpdkdsb2JhbHMuQ0lEUl9SRUdFWCk7XG5cbiAgICAgICAgICAgICAgICBpZihpcGFkZHJlc3MgPT0gJycpe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoY2lkclBhdHRlcm4udGVzdChpcGFkZHJlc3MpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29ycmVjdENJRFIgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29ycmVjdENJRFIgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLnZhbGlkYXRlQ0lEUkZsYWcgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSdWxlIGlzIHNhdmVkIHRvIHNlcnZlclxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmdW5jdGlvbiBhZGRPdXRnb2luZ1J1bGUoKSB7XG4gICAgICAgICAgICAgICAgaWYodmFsaWRhdGVDSURSKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZS50b0lwQWRkcmVzcykpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBnZW5lcmF0ZVJ1bGVJZChpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1J1bGUpO1xuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1J1bGUua2V5ID0gUnVsZXNNb2RlbC5nZW5lcmF0ZUtleShpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1J1bGUpO1xuICAgICAgICAgICAgICAgICAgICBSdWxlc01vZGVsLmNyZWF0ZShpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1J1bGUpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5vdXRnb2luZ1J1bGVzLnB1c2gocmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc2V0TmV3T3V0Z29pbmdSdWxlKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIERlbGV0ZSBpbmNvbWluZyBydWxlIGZyb20gc2VydmVyXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZ1bmN0aW9uIGRlbGV0ZUluY29taW5nUnVsZShrZXkpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBSdWxlc01vZGVsLmRlbGV0ZVVzaW5nS2V5KGtleSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBfLnJlbW92ZShpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvbWluZ1J1bGVzLCBmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG4ua2V5ID09IGtleTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBEZWxldGUgb3V0Z29pbmcgcnVsZSBmcm9tIHNlcnZlclxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmdW5jdGlvbiBkZWxldGVPdXRnb2luZ1J1bGUoa2V5KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgUnVsZXNNb2RlbC5kZWxldGVVc2luZ0tleShrZXkpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgXy5yZW1vdmUoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwub3V0Z29pbmdSdWxlcywgZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuLmtleSA9PSBrZXk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcblxuICAgICAgICAgICAgUG9saWNpZXNNb2RlbC5nZXRNb2RlbEJ5S2V5KCRzdGF0ZVBhcmFtcy5rZXkpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kgPSBwb2xpY3k7XG4gICAgICAgICAgICAgICAgICAgIFJ1bGVzTW9kZWwuZ2V0SW5jb21pbmdSdWxlcyhwb2xpY3kucG9saWN5TmFtZSwgJ2RlZmF1bHQnKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29taW5nUnVsZXMgPSByZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNldE5ld0luY29taW5nUnVsZSgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgUnVsZXNNb2RlbC5nZXRPdXRnb2luZ1J1bGVzKHBvbGljeS5wb2xpY3lOYW1lLCAnZGVmYXVsdCcpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwub3V0Z29pbmdSdWxlcyA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc2V0TmV3T3V0Z29pbmdSdWxlKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBnZXROZXR3b3JrcygpO1xuICAgICAgICAgICAgZ2V0QXBwbGljYXRpb25Hcm91cHMoKTtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRlbGV0ZVBvbGljeSA9IGRlbGV0ZVBvbGljeTtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRlbGV0ZUluY29taW5nUnVsZSA9IGRlbGV0ZUluY29taW5nUnVsZTtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRlbGV0ZU91dGdvaW5nUnVsZSA9IGRlbGV0ZU91dGdvaW5nUnVsZTtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmFkZEluY29taW5nUnVsZSA9IGFkZEluY29taW5nUnVsZTtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmFkZE91dGdvaW5nUnVsZSA9IGFkZE91dGdvaW5nUnVsZTtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRvbmVFZGl0aW5nID0gZG9uZUVkaXRpbmc7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5jYW5jZWxFZGl0aW5nID0gY2FuY2VsRWRpdGluZztcbiAgICAgICAgICAgIC8vRXZlbnQgSGFuZGxlcnNcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm9uQ2hhbmdlT3V0Z29pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uID0gb25DaGFuZ2VPdXRnb2luZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb247XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5vbkNoYW5nZUluY29taW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IG9uQ2hhbmdlSW5jb21pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwub25DaGFuZ2VPdXRnb2luZ05ldHdvcmtTZWxlY3Rpb24gPSBvbkNoYW5nZU91dGdvaW5nTmV0d29ya1NlbGVjdGlvbjtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm9uQ2hhbmdlSW5jb21pbmdOZXR3b3JrU2VsZWN0aW9uID0gb25DaGFuZ2VJbmNvbWluZ05ldHdvcmtTZWxlY3Rpb247XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5vbkNoYW5nZUluY29taW5nSVBBZGRyZXNzID0gb25DaGFuZ2VJbmNvbWluZ0lQQWRkcmVzcztcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm9uQ2hhbmdlT3V0Z29pbmdJUEFkZHJlc3MgPSBvbkNoYW5nZU91dGdvaW5nSVBBZGRyZXNzO1xuXG4gICAgICAgICAgICBzZXRNb2RlKCk7XG5cbiAgICAgICAgfV0pO1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcG9saWNpZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMubGlzdC5pc29sYXRpb24nLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2lzb2xhdGlvbicsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0lzb2xhdGlvblBvbGljeUxpc3RDdHJsIGFzIGlzb2xhdGlvblBvbGljeUxpc3RDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtfcG9saWNpZXMvaXNvbGF0aW9ucG9saWN5bGlzdC5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdJc29sYXRpb25Qb2xpY3lMaXN0Q3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ1BvbGljaWVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgICAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIFBvbGljaWVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgICAgICB2YXIgcG9saWNpZXNMaXN0Q3RybCA9IHRoaXM7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldFBvbGljaWVzKHJlbG9hZCkge1xuICAgICAgICAgICAgICAgIFBvbGljaWVzTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHBvbGljaWVzTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9saWNpZXNMaXN0Q3RybC5wb2xpY2llcyA9ICRmaWx0ZXIoJ29yZGVyQnknKShyZXN1bHQsICdwb2xpY3lOYW1lJyk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHBvbGljaWVzTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgICAgICBnZXRQb2xpY2llcyhmYWxzZSk7XG5cbiAgICAgICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAgICAgLy9Eb24ndCBzdGFydCBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2V0UG9saWNpZXModHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfV0pO1xuXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvOS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcG9saWNpZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMubGlzdCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ05ldHdvcmtQb2xpY2llc1RhYnNDdHJsIGFzIG5ldHdvcmtQb2xpY2llc1RhYnNDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtfcG9saWNpZXMvbmV0d29ya3BvbGljaWVzdGFicy5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmxpc3QucmVkaXJlY3Rpb24nLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL3JlZGlyZWN0aW9uJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogJydcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTmV0d29ya1BvbGljaWVzVGFic0N0cmwnLCBbJyRzdGF0ZScsZnVuY3Rpb24gKCRzdGF0ZSkge1xuICAgICAgICB2YXIgbmV0d29ya1BvbGljaWVzVGFic0N0cmwgPSB0aGlzO1xuICAgICAgICBcbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlTmV0d29ya1BvbGljeSgpIHtcbiAgICAgICAgICAgIGlmKCRzdGF0ZS4kY3VycmVudC5pbmNsdWRlc1snY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmxpc3QuaXNvbGF0aW9uJ10pe1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbi5jcmVhdGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKCRzdGF0ZS4kY3VycmVudC5pbmNsdWRlc1snY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmxpc3QuYmFuZHdpZHRoJ10pIHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGguY3JlYXRlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBuZXR3b3JrUG9saWNpZXNUYWJzQ3RybC5jcmVhdGVOZXR3b3JrUG9saWN5ID0gY3JlYXRlTmV0d29ya1BvbGljeTtcbiAgICB9XSk7XG5cbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMi8xOS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtzLmNyZWF0ZScsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtzL25ldHdvcmtjcmVhdGUuaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ05ldHdvcmtDcmVhdGVDdHJsIGFzIG5ldHdvcmtDcmVhdGVDdHJsJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOZXR3b3JrQ3JlYXRlQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdOZXR3b3Jrc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICAgICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBOZXR3b3Jrc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICAgICAgdmFyIG5ldHdvcmtDcmVhdGVDdHJsID0gdGhpcztcbiAgICAgICAgICAgIG5ldHdvcmtDcmVhdGVDdHJsLmNpZHJQYXR0ZXJuID0gQ29udGl2R2xvYmFscy5DSURSX1JFR0VYO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub05ldHdvcmtzKCkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubmV0d29ya3MubGlzdCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBjYW5jZWxDcmVhdGluZygpIHtcbiAgICAgICAgICAgICAgICByZXR1cm5Ub05ldHdvcmtzKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNyZWF0ZU5ldHdvcmsoKSB7XG4gICAgICAgICAgICAgICAgLy9mb3JtIGNvbnRyb2xsZXIgaXMgaW5qZWN0ZWQgYnkgdGhlIGh0bWwgdGVtcGxhdGVcbiAgICAgICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgICAgIGlmIChuZXR3b3JrQ3JlYXRlQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IobmV0d29ya0NyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihuZXR3b3JrQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIG5ldHdvcmtDcmVhdGVDdHJsLm5ld05ldHdvcmsua2V5ID1cbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldHdvcmtDcmVhdGVDdHJsLm5ld05ldHdvcmsudGVuYW50TmFtZSArICc6JyArIG5ldHdvcmtDcmVhdGVDdHJsLm5ld05ldHdvcmsubmV0d29ya05hbWU7XG4gICAgICAgICAgICAgICAgICAgIE5ldHdvcmtzTW9kZWwuY3JlYXRlKG5ldHdvcmtDcmVhdGVDdHJsLm5ld05ldHdvcmspLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3JrQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub05ldHdvcmtzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihuZXR3b3JrQ3JlYXRlQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlc2V0Rm9ybSgpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IobmV0d29ya0NyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIG5ldHdvcmtDcmVhdGVDdHJsLm5ld05ldHdvcmsgPSB7XG4gICAgICAgICAgICAgICAgICAgIG5ldHdvcmtOYW1lOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgZW5jYXA6ICd2eGxhbicsXG4gICAgICAgICAgICAgICAgICAgIHN1Ym5ldDogJycsXG4gICAgICAgICAgICAgICAgICAgIGdhdGV3YXk6ICcnLFxuICAgICAgICAgICAgICAgICAgICB0ZW5hbnROYW1lOiAnZGVmYXVsdCcvL1RPRE86IFJlbW92ZSBoYXJkY29kZWQgdGVuYW50LlxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG5ldHdvcmtDcmVhdGVDdHJsLmNyZWF0ZU5ldHdvcmsgPSBjcmVhdGVOZXR3b3JrO1xuICAgICAgICAgICAgbmV0d29ya0NyZWF0ZUN0cmwuY2FuY2VsQ3JlYXRpbmcgPSBjYW5jZWxDcmVhdGluZztcblxuICAgICAgICAgICAgcmVzZXRGb3JtKCk7XG4gICAgICAgIH1dKTtcblxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ05ldHdvcmtEZXRhaWxzQ3RybCBhcyBuZXR3b3JrRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmV0d29ya3MvbmV0d29ya2RldGFpbHMuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtzLmRldGFpbHMuaW5mbycsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvaW5mbycsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3Jrcy9uZXR3b3JraW5mby5odG1sJ1xuICAgICAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05ldHdvcmtEZXRhaWxzQ3RybCcsXG4gICAgICAgIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnTmV0d29ya3NNb2RlbCcsICdBcHBsaWNhdGlvbkdyb3Vwc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICAgICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIE5ldHdvcmtzTW9kZWwsIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5ldHdvcmtEZXRhaWxzQ3RybCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub05ldHdvcmtzKCkge1xuICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5ldHdvcmtzLmxpc3QnKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBkZWxldGVOZXR3b3JrKCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IobmV0d29ya0RldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIobmV0d29ya0RldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgTmV0d29ya3NNb2RlbC5kZWxldGUobmV0d29ya0RldGFpbHNDdHJsLm5ldHdvcmspLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3JrRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9OZXR3b3JrcygpO1xuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3JrRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKG5ldHdvcmtEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogR2V0IGFwcGxpY2F0aW9uIGdyb3VwcyBiZWxvbmdpbmcgdG8gYSBuZXR3b3JrXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0QXBwbGljYXRpb25Hcm91cHMocmVsb2FkKSB7XG4gICAgICAgICAgICAgICAgICAgIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwuZ2V0KHJlbG9hZCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXR3b3JrRGV0YWlsc0N0cmwuYXBwbGljYXRpb25Hcm91cHMgPSAkZmlsdGVyKCdvcmRlckJ5JykoXy5maWx0ZXIocmVzdWx0LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ25ldHdvcmtOYW1lJzogbmV0d29ya0RldGFpbHNDdHJsLm5ldHdvcmsubmV0d29ya05hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLCAnZ3JvdXBOYW1lJyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobmV0d29ya0RldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IobmV0d29ya0RldGFpbHNDdHJsKTtcblxuICAgICAgICAgICAgICAgIE5ldHdvcmtzTW9kZWwuZ2V0TW9kZWxCeUtleSgkc3RhdGVQYXJhbXMua2V5KVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAobmV0d29yaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV0d29ya0RldGFpbHNDdHJsLm5ldHdvcmsgPSBuZXR3b3JrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0QXBwbGljYXRpb25Hcm91cHMoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIG5ldHdvcmtEZXRhaWxzQ3RybC5kZWxldGVOZXR3b3JrID0gZGVsZXRlTmV0d29yaztcblxuICAgICAgICAgICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAgICAgICAgIC8vRG9uJ3QgZG8gYXV0b3JlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0QXBwbGljYXRpb25Hcm91cHModHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAgICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfV0pO1xuXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3MubGlzdCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ05ldHdvcmtzTGlzdEN0cmwgYXMgbmV0d29ya3NMaXN0Q3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3Jrcy9uZXR3b3JrbGlzdC5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOZXR3b3Jrc0xpc3RDdHJsJywgWyckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnTmV0d29ya3NNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgTmV0d29ya3NNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgICAgIHZhciBuZXR3b3Jrc0xpc3RDdHJsID0gdGhpcztcblxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0TmV0d29ya3MocmVsb2FkKSB7XG4gICAgICAgICAgICAgICAgTmV0d29ya3NNb2RlbC5nZXQocmVsb2FkKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3Jrc0xpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXR3b3Jrc0xpc3RDdHJsLm5ldHdvcmtzID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3Jrc0xpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgICAgIGdldE5ldHdvcmtzKGZhbHNlKTtcblxuICAgICAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgICAgICAvL0Rvbid0IGRvIGF1dG9yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGdldE5ldHdvcmtzKHRydWUpO1xuICAgICAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfV0pO1xuXG4vKipcbiAqIENyZWF0ZWQgYnkgY3NoYW1wdXIgb24gNi8yMy8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtzLmRldGFpbHMuc3RhdHMnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL3N0YXRzJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnTmV0d29ya1N0YXRzQ3RybCBhcyBuZXR3b3JrU3RhdHNDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtzL25ldHdvcmtzdGF0cy5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOZXR3b3JrU3RhdHNDdHJsJyxcbiAgICAgICAgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdOZXR3b3Jrc01vZGVsJywgJ0luc3BlY3RTZXJ2aWNlJyxcbiAgICAgICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIE5ldHdvcmtzTW9kZWwsIEluc3BlY3RTZXJ2aWNlKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgbmV0d29ya1N0YXRzQ3RybCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICAvKiBHZXRzIHRoZSBOZXR3b3JrIE9wZXJhdGlvbmFsIHN0YXRlIGZyb20gdGhlIHNlcnZlciAqL1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdldE5ldHdvcmtJbnNwZWN0KHJlZnJlc2gpe1xuICAgICAgICAgICAgICAgICAgICBOZXR3b3Jrc01vZGVsLmdldEluc3BlY3RCeUtleSgkc3RhdGVQYXJhbXMua2V5LCBDb250aXZHbG9iYWxzLk5FVFdPUktTX0lOU1BFQ1RfRU5EUE9JTlQsIHJlZnJlc2gpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV0d29ya1N0YXRzQ3RybC5uZXR3b3JrSW5zcGVjdFN0YXRzID0gcmVzdWx0Lk9wZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV0d29ya1N0YXRzQ3RybC5jb25maWcgPSByZXN1bHQuQ29uZmlnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHJlc3VsdC5PcGVyLmVuZHBvaW50cyE9dW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRhaW5lckRldGFpbHMgPSBJbnNwZWN0U2VydmljZS5idWlsZEVuZFBvaW50cyhyZXN1bHQuT3Blci5lbmRwb2ludHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihJbnNwZWN0U2VydmljZS5jaGVja0NvbnRhaW5lckNoYW5nZWQobmV0d29ya1N0YXRzQ3RybC5jb250YWluZXJEZXRhaWxzLGNvbnRhaW5lckRldGFpbHMpKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldHdvcmtTdGF0c0N0cmwuZW5kcG9pbnRzID0gcmVzdWx0Lk9wZXIuZW5kcG9pbnRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV0d29ya1N0YXRzQ3RybC5jb250YWluZXJEZXRhaWxzID0gY29udGFpbmVyRGV0YWlscztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXR3b3JrU3RhdHNDdHJsLmVuZHBvaW50cyA9IFtdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldHdvcmtTdGF0c0N0cmwuY29udGFpbmVyRGV0YWlscyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGdldE5ldHdvcmtJbnNwZWN0KGZhbHNlKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvL0Rvbid0IGRvIGF1dG9yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgICAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdldE5ldHdvcmtJbnNwZWN0KHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1dKTtcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5mYWN0b3J5KCdCZ3BTZXJ2aWNlJywgWyckaHR0cCcsICckcScsIGZ1bmN0aW9uICgkaHR0cCwgJHEpIHtcblxuICAgICAgICBmdW5jdGlvbiBnZXRCZ3AoY3RybCkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLkJHUFNfRU5EUE9JTlQgKyBjdHJsLmtleSArICcvJztcbiAgICAgICAgICAgICRodHRwLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgIGN0cmwubmVpZ2hib3IgPSByZXN1bHQuZGF0YTtcbiAgICAgICAgICAgICAgICBjdHJsLm5laWdoYm9ycy5wdXNoKHsnbmFtZSc6IGN0cmwubmVpZ2hib3JbJ25laWdoYm9yJ10sICd2YWx1ZSc6IGN0cmwubmVpZ2hib3JbJ25laWdoYm9yLWFzJ119KTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVCZ3AoY3RybCkge1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuQkdQU19FTkRQT0lOVCArIGN0cmwua2V5ICsgJy8nO1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QodXJsLCBjdHJsLm5laWdoYm9yKTtcbiAgICAgICAgfTtcblxuICAgICAgICBmdW5jdGlvbiBnZXRCZ3BJbnNwZWN0KGtleSkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLkJHUFNfSU5TUEVDVF9FTkRQT0lOVCArIGtleSArICcvJztcbiAgICAgICAgICAgICRodHRwLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0QmdwOiBnZXRCZ3AsXG4gICAgICAgICAgICB1cGRhdGVCZ3A6IHVwZGF0ZUJncCxcbiAgICAgICAgICAgIGdldEJncEluc3BlY3Q6IGdldEJncEluc3BlY3RcbiAgICAgICAgfVxuICAgIH1dKTtcbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2Lm5vZGVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dkxvZ3NcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbG9ncy5odG1sJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgbG9nOiBcIj1cIixcbiAgICAgICAgICAgICAgICB0aXRsZTogXCJAXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTtcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5mYWN0b3J5KCdMb2dTZXJ2aWNlJywgWyckaHR0cCcsICckcScsIGZ1bmN0aW9uICgkaHR0cCwgJHEpIHtcbiAgICAgICAgZnVuY3Rpb24gZ2V0QWN0aXZlTG9ncygpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5OT0RFU19BQ1RJVkVfSk9CX0VORFBPSU5UO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0TGFzdExvZ3MoKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuTk9ERVNfTEFTVF9KT0JfRU5EUE9JTlQ7XG4gICAgICAgICAgICAkaHR0cC5nZXQodXJsKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0QWN0aXZlTG9nczogZ2V0QWN0aXZlTG9ncyxcbiAgICAgICAgICAgIGdldExhc3RMb2dzOiBnZXRMYXN0TG9nc1xuICAgICAgICB9XG4gICAgfV0pO1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmFjdGl2ZWxvZycsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvYWN0aXZlbG9nJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZUFjdGl2ZUpvYkxvZ3NDdHJsIGFzIG5vZGVBY3RpdmVKb2JMb2dzQ3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6ICc8Y3R2LWxvZ3MgdGl0bGU9XCJBY3RpdmUgSm9iXCIgbG9nPVwibm9kZUFjdGl2ZUpvYkxvZ3NDdHJsLmFjdGl2ZUxvZ3NcIj48L2N0di1sb2dzPidcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTm9kZUFjdGl2ZUpvYkxvZ3NDdHJsJywgWyckc2NvcGUnLCAnJGludGVydmFsJywgJ0xvZ1NlcnZpY2UnLFxuICAgICAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsIExvZ1NlcnZpY2UpIHtcbiAgICAgICAgdmFyIG5vZGVBY3RpdmVKb2JMb2dzQ3RybCA9IHRoaXM7XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0QWN0aXZlTG9ncygpIHtcbiAgICAgICAgICAgIExvZ1NlcnZpY2UuZ2V0QWN0aXZlTG9ncygpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIG5vZGVBY3RpdmVKb2JMb2dzQ3RybC5hY3RpdmVMb2dzID0gcmVzdWx0O1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAvL09uY2UgdGhlIGpvYiBmaW5pc2hlcywgZW5kcG9pbnQgcmV0dXJucyA1MDAgZXJyb3IuIFNvIHJlc2V0IHRoZSBhY3RpdmVMb2dzXG4gICAgICAgICAgICAgICAgbm9kZUFjdGl2ZUpvYkxvZ3NDdHJsLmFjdGl2ZUxvZ3MgPSB7XG4gICAgICAgICAgICAgICAgICAgIGRlc2M6ICdUaGVyZSBpcyBjdXJyZW50bHkgbm8gYWN0aXZlIGpvYi4gQ2hlY2sgTGFzdCBKb2IgZm9yIGEgam9iIHRoYXQgcmVjZW50bHkgZmluaXNoZWQuJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBnZXRBY3RpdmVMb2dzKCk7XG5cbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldEFjdGl2ZUxvZ3MoKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8yNS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmNvbW1pc3Npb24nLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2NvbW1pc3Npb24vOmtleScsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVDb21taXNzaW9uQ3RybCBhcyBub2RlQ29tbWlzc2lvbkN0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWNvbW1pc3Npb24uaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTm9kZUNvbW1pc3Npb25DdHJsJywgW1xuICAgICAgICAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdOb2Rlc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJywgJ05vZGVzU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgTm9kZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UsIE5vZGVzU2VydmljZSkge1xuICAgICAgICAgICAgdmFyIG5vZGVDb21taXNzaW9uQ3RybCA9IHRoaXM7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHJldHVyblRvTm9kZURldGFpbHMoKSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLmluZm8nLCB7J2tleSc6ICRzdGF0ZVBhcmFtcy5rZXl9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ29tbWlzc2lvbmluZ05vZGUoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9Ob2RlRGV0YWlscygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBjb21taXNzaW9uKCkge1xuICAgICAgICAgICAgICAgIGlmIChub2RlQ29tbWlzc2lvbkN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVDb21taXNzaW9uQ3RybC5ub2RlT3BzT2JqLm5vZGVzID0gWyRzdGF0ZVBhcmFtcy5rZXldO1xuICAgICAgICAgICAgICAgICAgICBOb2Rlc1NlcnZpY2UuY2xlYW51cEV4dHJhVmFycyhub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBOb2Rlc1NlcnZpY2UuY3JlYXRlRXh0cmFWYXJzKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIE5vZGVzTW9kZWwuY29tbWlzc2lvbihub2RlQ29tbWlzc2lvbkN0cmwubm9kZU9wc09iaikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub05vZGVEZXRhaWxzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Iobm9kZUNvbW1pc3Npb25DdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG5vZGVDb21taXNzaW9uQ3RybC5ub2RlT3BzT2JqID0ge307XG4gICAgICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuZXh0cmFfdmFycyA9IHt9OyAvL1RPRE8gSW50aWFsaXplIGZyb20gZ2xvYmFsIHNldHRpbmdzXG4gICAgICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuYW5zaWJsZVZhcmlhYmxlcyA9IFtdO1xuICAgICAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLmVudlZhcmlhYmxlcyA9IFtdO1xuXG4gICAgICAgICAgICBOb2Rlc1NlcnZpY2UuZ2V0U2V0dGluZ3Mobm9kZUNvbW1pc3Npb25DdHJsKTtcblxuICAgICAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLmNhbmNlbENvbW1pc3Npb25pbmdOb2RlID0gY2FuY2VsQ29tbWlzc2lvbmluZ05vZGU7XG4gICAgICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuY29tbWlzc2lvbiA9IGNvbW1pc3Npb247XG5cbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobm9kZUNvbW1pc3Npb25DdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgICAgICB9XSk7XG5cbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8yNS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVEZXRhaWxzQ3RybCBhcyBub2RlRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWRldGFpbHMuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMuaW5mbycsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvaW5mbycsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVEZXRhaWxzQ3RybCBhcyBub2RlRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWluZm8uaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMuc3RhdHMnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL3N0YXRzJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZURldGFpbHNDdHJsIGFzIG5vZGVEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2Rlc3RhdHMuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMubG9ncycsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvbG9ncycsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVEZXRhaWxzQ3RybCBhcyBub2RlRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWxvZ3MuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMuZWRpdCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvZWRpdCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVEZXRhaWxzQ3RybCBhcyBub2RlRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWluZm8uaHRtbCdcbiAgICAgICAgICAgIH0pO1xuXG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVEZXRhaWxzQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICckc2NvcGUnLCAnJGludGVydmFsJywgJ05vZGVzTW9kZWwnLCAnQmdwU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgJHNjb3BlLCAkaW50ZXJ2YWwsIE5vZGVzTW9kZWwsIEJncFNlcnZpY2UpIHtcbiAgICAgICAgICAgIHZhciBub2RlRGV0YWlsc0N0cmwgPSB0aGlzO1xuICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm51bWJlcnBhdHRlcm4gPSBDb250aXZHbG9iYWxzLk5VTUJFUl9SRUdFWDtcblxuICAgICAgICAgICAgZnVuY3Rpb24gZGVjb21taXNzaW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciBub2RlT3BzT2JqID0ge1xuICAgICAgICAgICAgICAgICAgbm9kZXM6IFskc3RhdGVQYXJhbXMua2V5XVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgTm9kZXNNb2RlbC5kZWNvbW1pc3Npb24obm9kZU9wc09iaikudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vRGlzYWJsZSBhbGwgYnV0dG9ucyBpbml0aWFsbHkuIFBvbGwgd2lsbCBhc3NpZ24gdmFsdWVzIGFwcHJvcHJpYXRlbHkuXG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHVwZ3JhZGUoKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVPcHNPYmogPSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVzOiBbJHN0YXRlUGFyYW1zLmtleV1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIE5vZGVzTW9kZWwudXBncmFkZShub2RlT3BzT2JqKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9EaXNhYmxlIGFsbCBidXR0b25zIGluaXRpYWxseS4gUG9sbCB3aWxsIGFzc2lnbiB2YWx1ZXMgYXBwcm9wcmlhdGVseS5cbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBEaXNwbGF5IGJ1dHRvbnMgYmFzZWQgb24gc3RhdHVzIG9mIG5vZGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gc2V0QnV0dG9uRGlzcGxheSgpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG5vZGVEZXRhaWxzQ3RybC5ub2RlWydpbnZlbnRvcnlfc3RhdGUnXS5zdGF0dXMpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnVW5hbGxvY2F0ZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdEZWNvbW1pc3Npb25lZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ1Byb3Zpc2lvbmluZyc6XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdBbGxvY2F0ZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdDYW5jZWxsZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ01haW50ZW5hbmNlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6Ly9DbHVzdGVyIHNob3VsZCBub3QgYmUgaW4gdGhpcyBzdGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldE5vZGVJbmZvKHJlbG9hZCkge1xuICAgICAgICAgICAgICAgIE5vZGVzTW9kZWwuZ2V0TW9kZWxCeUtleSgkc3RhdGVQYXJhbXMua2V5LCByZWxvYWQpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubm9kZSA9IG5vZGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRCdXR0b25EaXNwbGF5KCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBzZXRNb2RlKCkge1xuICAgICAgICAgICAgICAgIGlmICgkc3RhdGUuaXMoJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMuZWRpdCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5tb2RlID0gJ2VkaXQnO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5tb2RlID0gJ2RldGFpbHMnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9JbmZvKCkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubm9kZXMuZGV0YWlscy5pbmZvJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUJncEluZm8oKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5vZGVEZXRhaWxzQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3Iua2V5ID0gJHN0YXRlUGFyYW1zLmtleTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBiYWNrZW5kIG9ubHkgc3VwcG9ydHMgYWRkaW5nIG9uZSBuZWlnaGJvciBjdXJyZW50bHlcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm5laWdoYm9ycy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3JbJ25laWdoYm9yJ10gPSBpdGVtLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3JbJ25laWdoYm9yLWFzJ10gPSBpdGVtLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBCZ3BTZXJ2aWNlLnVwZGF0ZUJncChub2RlRGV0YWlsc0N0cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm5laWdoYm9yID0gcmVzdWx0LmNvbmZpZy5kYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9JbmZvKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRCZ3BJbmZvKCkge1xuICAgICAgICAgICAgICAgIEJncFNlcnZpY2UuZ2V0QmdwKG5vZGVEZXRhaWxzQ3RybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvciA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRCZ3BJbnNwZWN0KCkge1xuICAgICAgICAgICAgICAgIEJncFNlcnZpY2UuZ2V0QmdwSW5zcGVjdCgkc3RhdGVQYXJhbXMua2V5KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmluc3BlY3QgPSByZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5yb3V0ZXMgPSByZXN1bHQuT3Blci5yb3V0ZXM7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5maWx0ZXJlZHJvdXRlcyA9IHJlc3VsdC5PcGVyLnJvdXRlcztcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuZGVjb21taXNzaW9uID0gZGVjb21taXNzaW9uO1xuICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGUgPSB1cGdyYWRlO1xuXG4gICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2V0TW9kZSA9IHNldE1vZGU7XG4gICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBkYXRlQmdwSW5mbyA9IHVwZGF0ZUJncEluZm87XG4gICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwucmV0dXJuVG9JbmZvID0gcmV0dXJuVG9JbmZvO1xuICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm5laWdoYm9ycyA9IFtdO1xuICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm5laWdoYm9yID0ge307XG4gICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwua2V5ID0gJHN0YXRlUGFyYW1zLmtleTtcbiAgICAgICAgICAgIGdldEJncEluZm8oKTtcbiAgICAgICAgICAgIGdldEJncEluc3BlY3QoKTtcbiAgICAgICAgICAgIHNldE1vZGUoKTtcblxuICAgICAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgICAgICBnZXROb2RlSW5mbyhmYWxzZSk7XG5cbiAgICAgICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAgICAgLy9Eb24ndCBkbyBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2V0Tm9kZUluZm8odHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSwgNTAwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfV0pO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA2LzE0LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5ub2Rlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZOb2Rlc3RhdHVzXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgbm9kZTogJz0nXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2Rlc3RhdHVzLmh0bWwnXG4gICAgICAgIH1cbiAgICB9KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZOb2Rlc3RhdGVcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBub2RlOiAnPSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVzdGF0ZS5odG1sJ1xuICAgICAgICB9XG4gICAgfSk7XG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMuZGlzY292ZXInLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2Rpc2NvdmVyJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZURpc2NvdmVyQ3RybCBhcyBub2RlRGlzY292ZXJDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVkaXNjb3Zlci5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOb2RlRGlzY292ZXJDdHJsJywgW1xuICAgICAgICAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdOb2Rlc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJywgJ05vZGVzU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgTm9kZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UsIE5vZGVzU2VydmljZSkge1xuICAgICAgICAgICAgdmFyIG5vZGVEaXNjb3ZlckN0cmwgPSB0aGlzO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub05vZGVzKCkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubm9kZXMubGlzdCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBjYW5jZWxEaXNjb3ZlcmluZ05vZGUoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9Ob2RlcygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBkaXNjb3ZlcigpIHtcbiAgICAgICAgICAgICAgICBpZiAobm9kZURpc2NvdmVyQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBjcmVhdGVJUEFkZHJBcnJheSgpO1xuICAgICAgICAgICAgICAgICAgICBOb2Rlc1NlcnZpY2UuY3JlYXRlRXh0cmFWYXJzKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBOb2Rlc01vZGVsLmRpc2NvdmVyKG5vZGVEaXNjb3ZlckN0cmwubm9kZU9wc09iaikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9Ob2RlcygpO1xuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihub2RlRGlzY292ZXJDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihub2RlRGlzY292ZXJDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUlQQWRkckFycmF5KCkge1xuICAgICAgICAgICAgICAgIG5vZGVEaXNjb3ZlckN0cmwubm9kZU9wc09iai5hZGRycyA9IF8ud29yZHMobm9kZURpc2NvdmVyQ3RybC5ub2RlSVBBZGRyLCAvW14sIF0rL2cpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBub2RlRGlzY292ZXJDdHJsLm5vZGVPcHNPYmogPSB7fTtcbiAgICAgICAgICAgIG5vZGVEaXNjb3ZlckN0cmwuZXh0cmFfdmFycyA9IHt9OyAvL1RPRE8gSW50aWFsaXplIGZyb20gZ2xvYmFsIHNldHRpbmdzXG4gICAgICAgICAgICBub2RlRGlzY292ZXJDdHJsLmFuc2libGVWYXJpYWJsZXMgPSBbXTtcbiAgICAgICAgICAgIG5vZGVEaXNjb3ZlckN0cmwuZW52VmFyaWFibGVzID0gW107XG4gICAgICAgICAgICBub2RlRGlzY292ZXJDdHJsLm5vZGVJUEFkZHIgPSAnJzsgLy9JUCBhZGRyZXNzIG9mIG5vZGVzIHRvIGRpc2NvdmVyXG5cbiAgICAgICAgICAgIE5vZGVzU2VydmljZS5nZXRTZXR0aW5ncyhub2RlRGlzY292ZXJDdHJsKTtcblxuICAgICAgICAgICAgbm9kZURpc2NvdmVyQ3RybC5kaXNjb3ZlciA9IGRpc2NvdmVyO1xuICAgICAgICAgICAgbm9kZURpc2NvdmVyQ3RybC5jYW5jZWxEaXNjb3ZlcmluZ05vZGUgPSBjYW5jZWxEaXNjb3ZlcmluZ05vZGU7XG5cbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgICAgIH1dKTtcblxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmxhc3Rsb2cnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2xhc3Rsb2cnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlTGFzdEpvYkxvZ3NDdHJsIGFzIG5vZGVMYXN0Sm9iTG9nc0N0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAnPGN0di1sb2dzIHRpdGxlPVwiTGFzdCBKb2JcIiBsb2c9XCJub2RlTGFzdEpvYkxvZ3NDdHJsLmxhc3RMb2dzXCI+PC9jdHYtbG9ncz4nXG4gICAgICAgICAgICB9KVxuICAgICAgICA7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVMYXN0Sm9iTG9nc0N0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnTG9nU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc2NvcGUsICRpbnRlcnZhbCwgTG9nU2VydmljZSkge1xuICAgICAgICB2YXIgbm9kZUxhc3RKb2JMb2dzQ3RybCA9IHRoaXM7XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0TGFzdExvZ3MoKSB7XG4gICAgICAgICAgICBMb2dTZXJ2aWNlLmdldExhc3RMb2dzKCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgbm9kZUxhc3RKb2JMb2dzQ3RybC5sYXN0TG9ncyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBnZXRMYXN0TG9ncygpO1xuXG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG8tcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXRMYXN0TG9ncygpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzIyLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMubGlzdCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVMaXN0Q3RybCBhcyBub2RlTGlzdEN0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWxpc3QuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTm9kZUxpc3RDdHJsJywgWyckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnTm9kZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgTm9kZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIG5vZGVMaXN0Q3RybCA9IHRoaXM7XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0Tm9kZXMocmVsb2FkKSB7XG4gICAgICAgICAgICBOb2Rlc01vZGVsLmdldChyZWxvYWQpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVMaXN0Q3RybC5ub2RlcyA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgZ2V0Tm9kZXMoZmFsc2UpO1xuXG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG8tcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXROb2Rlcyh0cnVlKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYub3JnYW5pemF0aW9ucycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMuY3JlYXRlJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnb3JnYW5pemF0aW9ucy9vcmdhbml6YXRpb25jcmVhdGUuaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ09yZ2FuaXphdGlvbkNyZWF0ZUN0cmwgYXMgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignT3JnYW5pemF0aW9uQ3JlYXRlQ3RybCcsIFsnJHN0YXRlJywgJ09yZ2FuaXphdGlvbnNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsIE9yZ2FuaXphdGlvbnNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgICAgIHZhciBvcmdhbml6YXRpb25DcmVhdGVDdHJsID0gdGhpcztcblxuICAgICAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Pcmdhbml6YXRpb25zKCkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5saXN0Jyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNhbmNlbENyZWF0aW5nKCkge1xuICAgICAgICAgICAgICAgIHJldHVyblRvT3JnYW5pemF0aW9ucygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBjcmVhdGVPcmdhbml6YXRpb24oKSB7XG4gICAgICAgICAgICAgICAgLy9mb3JtIGNvbnRyb2xsZXIgaXMgaW5qZWN0ZWQgYnkgdGhlIGh0bWwgdGVtcGxhdGVcbiAgICAgICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgICAgIGlmIChvcmdhbml6YXRpb25DcmVhdGVDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25DcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwubmV3T3JnYW5pemF0aW9uLmtleSA9IG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwubmV3T3JnYW5pemF0aW9uLnRlbmFudE5hbWU7IFxuICAgICAgICAgICAgICAgICAgICBPcmdhbml6YXRpb25zTW9kZWwuY3JlYXRlKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwubmV3T3JnYW5pemF0aW9uKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub09yZ2FuaXphdGlvbnMoKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Iob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiByZXNldEZvcm0oKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25DcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybC5uZXdPcmdhbml6YXRpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIHRlbmFudE5hbWU6ICcnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybC5jcmVhdGVPcmdhbml6YXRpb24gPSBjcmVhdGVPcmdhbml6YXRpb247XG4gICAgICAgICAgICBvcmdhbml6YXRpb25DcmVhdGVDdHJsLmNhbmNlbENyZWF0aW5nID0gY2FuY2VsQ3JlYXRpbmc7XG5cbiAgICAgICAgICAgIHJlc2V0Rm9ybSgpO1xuICAgICAgICB9XSk7XG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYub3JnYW5pemF0aW9ucycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMuZGV0YWlscycsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnT3JnYW5pemF0aW9uRGV0YWlsc0N0cmwgYXMgb3JnYW5pemF0aW9uRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnb3JnYW5pemF0aW9ucy9vcmdhbml6YXRpb25kZXRhaWxzLmh0bWwnXG4gICAgICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignT3JnYW5pemF0aW9uRGV0YWlsc0N0cmwnLFxuICAgICAgICBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnT3JnYW5pemF0aW9uc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICAgICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgT3JnYW5pemF0aW9uc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICAgICAgICAgIHZhciBvcmdhbml6YXRpb25EZXRhaWxzQ3RybCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub09yZ2FuaXphdGlvbnMoKSB7XG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5saXN0Jyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZGVsZXRlT3JnYW5pemF0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIE9yZ2FuaXphdGlvbnNNb2RlbC5kZWxldGUob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwub3JnYW5pemF0aW9uKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9Pcmdhbml6YXRpb25zKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsKTtcblxuICAgICAgICAgICAgICAgIE9yZ2FuaXphdGlvbnNNb2RlbC5nZXRNb2RlbEJ5S2V5KCRzdGF0ZVBhcmFtcy5rZXkpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChvcmdhbml6YXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsLm9yZ2FuaXphdGlvbiA9IG9yZ2FuaXphdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBvcmdhbml6YXRpb25EZXRhaWxzQ3RybC5kZWxldGVPcmdhbml6YXRpb24gPSBkZWxldGVPcmdhbml6YXRpb247XG4gICAgICAgICAgICB9XSk7XG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm9yZ2FuaXphdGlvbnMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5vcmdhbml6YXRpb25zLmxpc3QnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdPcmdhbml6YXRpb25zTGlzdEN0cmwgYXMgb3JnYW5pemF0aW9uc0xpc3RDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ29yZ2FuaXphdGlvbnMvb3JnYW5pemF0aW9ubGlzdC5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdPcmdhbml6YXRpb25zTGlzdEN0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdPcmdhbml6YXRpb25zTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgICAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIE9yZ2FuaXphdGlvbnNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgICAgIHZhciBvcmdhbml6YXRpb25zTGlzdEN0cmwgPSB0aGlzO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRPcmdhbml6YXRpb25zKHJlbG9hZCkge1xuICAgICAgICAgICAgICAgIE9yZ2FuaXphdGlvbnNNb2RlbC5nZXQocmVsb2FkKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25zTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yZ2FuaXphdGlvbnNMaXN0Q3RybC5vcmdhbml6YXRpb25zID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25zTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vTG9hZCBmcm9tIGNhY2hlIGZvciBxdWljayBkaXNwbGF5IGluaXRpYWxseVxuICAgICAgICAgICAgZ2V0T3JnYW5pemF0aW9ucyhmYWxzZSk7XG5cbiAgICAgICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAgICAgLy9Eb24ndCBkbyBhdXRvcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBnZXRPcmdhbml6YXRpb25zKHRydWUpO1xuICAgICAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfV0pO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzEyLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnNlcnZpY2VsYnMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmNyZWF0ZScsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NlcnZpY2VfbGJzL3NlcnZpY2VsYmNyZWF0ZS5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnU2VydmljZWxiQ3JlYXRlQ3RybCBhcyBzZXJ2aWNlbGJDcmVhdGVDdHJsJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdTZXJ2aWNlbGJDcmVhdGVDdHJsJywgW1xuICAgICAgICAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdTZXJ2aWNlbGJzTW9kZWwnLCAnTmV0d29ya3NNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgU2VydmljZWxic01vZGVsLCBOZXR3b3Jrc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICAgICAgdmFyIHNlcnZpY2VsYkNyZWF0ZUN0cmwgPSB0aGlzO1xuICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5sYWJlbFNlbGVjdG9ycyA9IFtdO1xuICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5uZXR3b3JrcyA9IFtdO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1NlcnZpY2VsYnMoKSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmxpc3QnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9TZXJ2aWNlbGJzKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogR2V0IG5ldHdvcmtzIGZvciB0aGUgZ2l2ZW4gdGVuYW50LlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXROZXR3b3JrcygpIHtcbiAgICAgICAgICAgICAgICBOZXR3b3Jrc01vZGVsLmdldCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLm5ldHdvcmtzID0gXy5maWx0ZXIocmVzdWx0LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAndGVuYW50TmFtZSc6ICdkZWZhdWx0Jy8vVE9ETzogUmVtb3ZlIGhhcmRjb2RlZCB0ZW5hbnQuXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBjcmVhdGVMYWJlbFNlbGVjdG9yU3RyaW5ncygpIHtcbiAgICAgICAgICAgICAgICAvL0VtcHR5IG91dCB0aGUgc2VsZWN0b3JzLiBJbiBjYXNlIG9mIHNlcnZlciBlcnJvcnMgdGhpcyBuZWVkcyB0byBiZSByZXNldC5cbiAgICAgICAgICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLnNlcnZpY2VsYi5zZWxlY3RvcnMgPSBbXTtcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goc2VydmljZWxiQ3JlYXRlQ3RybC5sYWJlbFNlbGVjdG9ycywgZnVuY3Rpb24obGFiZWxTZWxlY3Rvcikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0b3JTdHJpbmcgPSBsYWJlbFNlbGVjdG9yLm5hbWUgKyAnPScgKyBsYWJlbFNlbGVjdG9yLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLnNlcnZpY2VsYi5zZWxlY3RvcnMucHVzaChzZWxlY3RvclN0cmluZyk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNyZWF0ZVNlcnZpY2VsYigpIHtcbiAgICAgICAgICAgICAgICBjcmVhdGVMYWJlbFNlbGVjdG9yU3RyaW5ncygpO1xuICAgICAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAgICAgLy9jaGVja2luZyBpZiBhbGwgdmFsaWRhdGlvbnMgaGF2ZSBwYXNzZWRcbiAgICAgICAgICAgICAgICBpZiAoc2VydmljZWxiQ3JlYXRlQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc2VydmljZWxiQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKHNlcnZpY2VsYkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLnNlcnZpY2VsYi5rZXkgPVxuICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIudGVuYW50TmFtZSArICc6JyArIHNlcnZpY2VsYkNyZWF0ZUN0cmwuc2VydmljZWxiLnNlcnZpY2VOYW1lO1xuICAgICAgICAgICAgICAgICAgICBTZXJ2aWNlbGJzTW9kZWwuY3JlYXRlKHNlcnZpY2VsYkNyZWF0ZUN0cmwuc2VydmljZWxiKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc2VydmljZWxiQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1NlcnZpY2VsYnMoKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc2VydmljZWxiQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Ioc2VydmljZWxiQ3JlYXRlQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlc2V0Rm9ybSgpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzZXJ2aWNlbGJDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLnNlcnZpY2VsYiA9IHtcbiAgICAgICAgICAgICAgICAgICAgc2VydmljZU5hbWU6ICcnLFxuICAgICAgICAgICAgICAgICAgICBuZXR3b3JrTmFtZTogJycsXG4gICAgICAgICAgICAgICAgICAgIGlwQWRkcmVzczogJycsXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdG9yczogW10sXG4gICAgICAgICAgICAgICAgICAgIHBvcnRzOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgdGVuYW50TmFtZTogJ2RlZmF1bHQnLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5jcmVhdGVTZXJ2aWNlbGIgPSBjcmVhdGVTZXJ2aWNlbGI7XG4gICAgICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLmNhbmNlbENyZWF0aW5nID0gY2FuY2VsQ3JlYXRpbmc7XG5cbiAgICAgICAgICAgIGdldE5ldHdvcmtzKCk7XG4gICAgICAgICAgICByZXNldEZvcm0oKTtcbiAgICAgICAgfV0pO1xuXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTEvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc2VydmljZWxicycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMuZGV0YWlscycsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHtzdGF0ZTpudWxsfSwgICAgICAgLy8gVG8gcmVsb2FkIHBhcmVudCB2aWV3IFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTZXJ2aWNlbGJEZXRhaWxzQ3RybCBhcyBzZXJ2aWNlbGJEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXJ2aWNlX2xicy9zZXJ2aWNlbGJkZXRhaWxzLmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmRldGFpbHMuaW5mbycsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvaW5mbycsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1NlcnZpY2VsYkRldGFpbHNDdHJsIGFzIHNlcnZpY2VsYkRldGFpbHNDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NlcnZpY2VfbGJzL3NlcnZpY2VsYmluZm8uaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMuZGV0YWlscy5lZGl0Jywge1xuICAgICAgICAgICAgICAgIHVybDogJy9lZGl0LzprZXknLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTZXJ2aWNlbGJEZXRhaWxzQ3RybCBhcyBzZXJ2aWNlbGJEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXJ2aWNlX2xicy9zZXJ2aWNlbGJpbmZvLmh0bWwnXG4gICAgICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignU2VydmljZWxiRGV0YWlsc0N0cmwnLFxuICAgICAgICBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnU2VydmljZWxic01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICAgICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgU2VydmljZWxic01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICAgICAgICAgIHZhciBzZXJ2aWNlbGJEZXRhaWxzQ3RybCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwubGFiZWxTZWxlY3RvcnMgPSBbXTtcblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIFRvIHNob3cgZWRpdCBvciBkZXRhaWxzIHNjcmVlbiBiYXNlZCBvbiB0aGUgcm91dGVcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBzZXRNb2RlKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHN0YXRlLmlzKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmRldGFpbHMuZWRpdCcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5tb2RlID0gJ2VkaXQnO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwubW9kZSA9ICdkZXRhaWxzJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHJldHVyblRvU2VydmljZWxicygpIHtcbiAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmxpc3QnKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1NlcnZpY2VsYkRldGFpbHMoKSB7XG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuc2VydmljZWxicy5kZXRhaWxzLmluZm8nLCB7J2tleSc6IHNlcnZpY2VsYkRldGFpbHNDdHJsLnNlcnZpY2VsYi5rZXksJ3N0YXRlJzonZGV0YWlscyd9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjYW5jZWxFZGl0aW5nKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1NlcnZpY2VsYkRldGFpbHMoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBkZWxldGVTZXJ2aWNlbGIoKSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKHNlcnZpY2VsYkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgU2VydmljZWxic01vZGVsLmRlbGV0ZShzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1NlcnZpY2VsYnMoKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHNlcnZpY2VsYkRldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBzYXZlU2VydmljZWxiKCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBleGlzdGluZ0xhYmVscyA9IHNlcnZpY2VsYkRldGFpbHNDdHJsLnNlcnZpY2VsYi5zZWxlY3RvcnM7XG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZUxhYmVsU2VsZWN0b3JTdHJpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIFNlcnZpY2VsYnNNb2RlbC5zYXZlKHNlcnZpY2VsYkRldGFpbHNDdHJsLnNlcnZpY2VsYikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblRvU2VydmljZWxiRGV0YWlscygpO1xuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwuc2VydmljZWxiLnNlbGVjdG9ycyA9IGV4aXN0aW5nTGFiZWxzO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlTGFiZWxTZWxlY3RvcnMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHNlcnZpY2VsYkRldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjcmVhdGVMYWJlbFNlbGVjdG9ycygpIHtcbiAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHNlcnZpY2VsYkRldGFpbHNDdHJsLnNlcnZpY2VsYi5zZWxlY3RvcnMsIGZ1bmN0aW9uKHNlbGVjdG9yU3RyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0b3IgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogc2VsZWN0b3JTdHIuc3BsaXQoJz0nKVswXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogc2VsZWN0b3JTdHIuc3BsaXQoJz0nKVsxXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2VsYkRldGFpbHNDdHJsLmxhYmVsU2VsZWN0b3JzLnB1c2goc2VsZWN0b3IpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjcmVhdGVMYWJlbFNlbGVjdG9yU3RyaW5ncygpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwuc2VydmljZWxiLnNlbGVjdG9ycyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goc2VydmljZWxiRGV0YWlsc0N0cmwubGFiZWxTZWxlY3RvcnMsIGZ1bmN0aW9uKGxhYmVsU2VsZWN0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZWxlY3RvclN0cmluZyA9IGxhYmVsU2VsZWN0b3IubmFtZSArICc9JyArIGxhYmVsU2VsZWN0b3IudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIuc2VsZWN0b3JzLnB1c2goc2VsZWN0b3JTdHJpbmcpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG5cbiAgICAgICAgICAgICAgICBTZXJ2aWNlbGJzTW9kZWwuZ2V0TW9kZWxCeUtleSgkc3RhdGVQYXJhbXMua2V5KVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2soc2VydmljZWxiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIgPSBzZXJ2aWNlbGI7XG4gICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVMYWJlbFNlbGVjdG9ycygpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHNlcnZpY2VsYkRldGFpbHNDdHJsLnNhdmVTZXJ2aWNlbGIgPSBzYXZlU2VydmljZWxiO1xuICAgICAgICAgICAgICAgIHNlcnZpY2VsYkRldGFpbHNDdHJsLmNhbmNlbEVkaXRpbmcgPSBjYW5jZWxFZGl0aW5nO1xuICAgICAgICAgICAgICAgIHNlcnZpY2VsYkRldGFpbHNDdHJsLmRlbGV0ZVNlcnZpY2VsYiA9IGRlbGV0ZVNlcnZpY2VsYjtcbiAgICAgICAgICAgICAgICBzZXRNb2RlKCk7XG5cbiAgICAgICAgICAgIH1dKTtcblxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzExLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnNlcnZpY2VsYnMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmxpc3QnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTZXJ2aWNlbGJMaXN0Q3RybCBhcyBzZXJ2aWNlbGJMaXN0Q3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXJ2aWNlX2xicy9zZXJ2aWNlbGJsaXN0Lmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICA7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1NlcnZpY2VsYkxpc3RDdHJsJywgWyckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnU2VydmljZWxic01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICAgICAgZnVuY3Rpb24gKCRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBTZXJ2aWNlbGJzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgICAgICB2YXIgc2VydmljZWxiTGlzdEN0cmwgPSB0aGlzO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRTZXJ2aWNlbGJzKHJlbG9hZCkge1xuICAgICAgICAgICAgICAgIFNlcnZpY2VsYnNNb2RlbC5nZXQocmVsb2FkKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzZXJ2aWNlbGJMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZWxiTGlzdEN0cmwuc2VydmljZWxicyA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc2VydmljZWxiTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vTG9hZCBmcm9tIGNhY2hlIGZvciBxdWljayBkaXNwbGF5IGluaXRpYWxseVxuICAgICAgICAgICAgZ2V0U2VydmljZWxicyhmYWxzZSk7XG5cbiAgICAgICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAgICAgLy9Eb24ndCBkbyBhdXRvcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBnZXRTZXJ2aWNlbGJzKHRydWUpO1xuICAgICAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfV0pO1xuXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTMvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LnNlcnZpY2VsYnNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2U2VydmljZWxicG9ydHNcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICBpdGVtczogJz0nXG4gICAgICAgICAgIH0sXG4gICAgICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlKSB7XG4gICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIENvbXBhcmUgaWYgdHdvIGl0ZW1zIGhhdmUgc2FtZSBwb3J0cyBhbmQgcHJvdG9jb2xzXG4gICAgICAgICAgICAgICAgKiBAcGFyYW0gdmFsMVxuICAgICAgICAgICAgICAgICogQHBhcmFtIHZhbDJcbiAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICBmdW5jdGlvbiBjb21wYXJlKHZhbDEsIHZhbDIpIHtcbiAgICAgICAgICAgICAgICAgICByZXR1cm4gKHZhbDEgPT09IHZhbDIpO1xuICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICBmdW5jdGlvbiByZXNldE5ld0l0ZW0oKSB7XG4gICAgICAgICAgICAgICAgICAgc2NvcGUubmV3SXRlbSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZVBvcnQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlclBvcnQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICBwcm90b2NvbDogJydcbiAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICBmdW5jdGlvbiBpc0VtcHR5SXRlbShpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgcmV0dXJuIChpdGVtLnNlcnZpY2VQb3J0ID09PSAnJyAmJiBpdGVtLnByb3ZpZGVyUG9ydCA9PT0gJycgJiYgaXRlbS5wcm90b2NvbCA9PT0gJycpO1xuICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICBzY29wZS5hZGQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICBpZiAoaXNFbXB0eUl0ZW0oc2NvcGUubmV3SXRlbSkpIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICBpZiAoc2NvcGUuaXRlbXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5pdGVtcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICB2YXIgbmV3SXRlbVN0ciA9IHNjb3BlLm5ld0l0ZW0uc2VydmljZVBvcnQgKyAnOidcbiAgICAgICAgICAgICAgICAgICAgICAgKyBzY29wZS5uZXdJdGVtLnByb3ZpZGVyUG9ydCArICc6J1xuICAgICAgICAgICAgICAgICAgICAgICArIHNjb3BlLm5ld0l0ZW0ucHJvdG9jb2w7XG4gICAgICAgICAgICAgICAgICAgLy9SZW1vdmVzIGV4aXN0aW5nIGl0ZW0gd2l0aCB0aGUgc2FtZSB2YWx1ZSBmaXJzdCBpZiBpdCBleGlzdHMuXG4gICAgICAgICAgICAgICAgICAgXy5wdWxsQWxsV2l0aChzY29wZS5pdGVtcywgW25ld0l0ZW1TdHJdLCBjb21wYXJlKTtcbiAgICAgICAgICAgICAgICAgICBzY29wZS5pdGVtcy5wdXNoKG5ld0l0ZW1TdHIpO1xuICAgICAgICAgICAgICAgICAgIHJlc2V0TmV3SXRlbSgpO1xuICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgc2NvcGUucmVtb3ZlID0gZnVuY3Rpb24ocGFzc2VkSXRlbSkge1xuICAgICAgICAgICAgICAgICAgIF8ucmVtb3ZlKHNjb3BlLml0ZW1zLCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcGFyZShpdGVtLCBwYXNzZWRJdGVtKTtcbiAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICByZXNldE5ld0l0ZW0oKTtcbiAgICAgICAgICAgfSxcbiAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXJ2aWNlX2xicy9zZXJ2aWNlbGJwb3J0cy5odG1sJ1xuICAgICAgIH1cbiAgICB9KTtcblxuLyoqXG4gKiBDcmVhdGVkIGJ5IGNzaGFtcHVyIG9uIDcvMTcvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc2VydmljZWxicycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMuZGV0YWlscy5zdGF0cycsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvc3RhdHMnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTZXJ2aWNlbGJTdGF0c0N0cmwgYXMgc2VydmljZWxiU3RhdHNDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NlcnZpY2VfbGJzL3NlcnZpY2VsYnN0YXRzLmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICA7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1NlcnZpY2VsYlN0YXRzQ3RybCcsXG4gICAgICAgIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnU2VydmljZWxic01vZGVsJywgJ0luc3BlY3RTZXJ2aWNlJyxcbiAgICAgICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIFNlcnZpY2VsYnNNb2RlbCwgSW5zcGVjdFNlcnZpY2UpIHtcblxuICAgICAgICAgICAgICAgIHZhciBzZXJ2aWNlbGJTdGF0c0N0cmwgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgLyogR2V0cyB0aGUgTmV0d29yayBPcGVyYXRpb25hbCBzdGF0ZSBmcm9tIHRoZSBzZXJ2ZXIgKi9cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZXRTZXJ2aWNlbGJJbnNwZWN0KHJlZnJlc2gpe1xuICAgICAgICAgICAgICAgICAgICBTZXJ2aWNlbGJzTW9kZWwuZ2V0SW5zcGVjdEJ5S2V5KCRzdGF0ZVBhcmFtcy5rZXksIENvbnRpdkdsb2JhbHMuU0VSVklDRUxCU19JTlNQRUNUX0VORFBPSU5ULCByZWZyZXNoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2VsYlN0YXRzQ3RybC5zZXJ2aWNlbGJJbnNwZWN0U3RhdHMgPSByZXN1bHQuT3BlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlbGJTdGF0c0N0cmwuY29uZmlnID0gcmVzdWx0LkNvbmZpZztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihyZXN1bHQuT3Blci5wcm92aWRlcnMhPXVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJvdmlkZXJEZXRhaWxzID0gSW5zcGVjdFNlcnZpY2UuYnVpbGRFbmRQb2ludHMocmVzdWx0Lk9wZXIucHJvdmlkZXJzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEluc3BlY3RTZXJ2aWNlLmNoZWNrQ29udGFpbmVyQ2hhbmdlZChzZXJ2aWNlbGJTdGF0c0N0cmwucHJvdmlkZXJEZXRhaWxzLCBwcm92aWRlckRldGFpbHMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlbGJTdGF0c0N0cmwucHJvdmlkZXJzID0gcmVzdWx0Lk9wZXIucHJvdmlkZXJzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZWxiU3RhdHNDdHJsLnByb3ZpZGVyRGV0YWlscyA9IHByb3ZpZGVyRGV0YWlscztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlbGJTdGF0c0N0cmwucHJvdmlkZXJzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2VsYlN0YXRzQ3RybC5wcm92aWRlckRldGFpbHMgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBnZXRTZXJ2aWNlbGJJbnNwZWN0KGZhbHNlKTtcblxuICAgICAgICAgICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAgICAgICAgIC8vRG9uJ3QgZG8gYXV0b3JlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0U2VydmljZWxiSW5zcGVjdCh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XSk7XG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnNldHRpbmdzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5jbHVzdGVyJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9jbHVzdGVyJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnQ2x1c3RlclNldHRpbmdDdHJsIGFzIGNsdXN0ZXJTZXR0aW5nQ3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXR0aW5ncy9jbHVzdGVyc2V0dGluZ3MuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignQ2x1c3RlclNldHRpbmdDdHJsJywgWyckc3RhdGVQYXJhbXMnLCAnQ1JVREhlbHBlclNlcnZpY2UnLCAnTm9kZXNTZXJ2aWNlJyxcbiAgICAgICAgZnVuY3Rpb24gKCRzdGF0ZVBhcmFtcywgQ1JVREhlbHBlclNlcnZpY2UsIE5vZGVzU2VydmljZSkge1xuICAgICAgICAgICAgdmFyIGNsdXN0ZXJTZXR0aW5nQ3RybCA9IHRoaXM7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUNsdXN0ZXJTZXR0aW5ncygpIHtcbiAgICAgICAgICAgICAgICBpZiAoY2x1c3RlclNldHRpbmdDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBjbHVzdGVyU2V0dGluZ0N0cmwubm9kZU9wc09iai5ub2RlcyA9IFskc3RhdGVQYXJhbXMua2V5XTtcbiAgICAgICAgICAgICAgICAgICAgTm9kZXNTZXJ2aWNlLmNsZWFudXBFeHRyYVZhcnMoY2x1c3RlclNldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgTm9kZXNTZXJ2aWNlLmNyZWF0ZUV4dHJhVmFycyhjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBOb2Rlc1NlcnZpY2UudXBkYXRlU2V0dGluZ3MoY2x1c3RlclNldHRpbmdDdHJsLm5vZGVPcHNPYmopLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKGNsdXN0ZXJTZXR0aW5nQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjbHVzdGVyU2V0dGluZ0N0cmwubm9kZU9wc09iaiA9IHt9O1xuICAgICAgICAgICAgY2x1c3RlclNldHRpbmdDdHJsLmV4dHJhX3ZhcnMgPSB7fTsgLy9UT0RPIEludGlhbGl6ZSBmcm9tIGdsb2JhbCBzZXR0aW5nc1xuICAgICAgICAgICAgY2x1c3RlclNldHRpbmdDdHJsLmFuc2libGVWYXJpYWJsZXMgPSBbXTtcbiAgICAgICAgICAgIGNsdXN0ZXJTZXR0aW5nQ3RybC5lbnZWYXJpYWJsZXMgPSBbXTtcblxuICAgICAgICAgICAgTm9kZXNTZXJ2aWNlLmdldFNldHRpbmdzKGNsdXN0ZXJTZXR0aW5nQ3RybCk7XG5cbiAgICAgICAgICAgIGNsdXN0ZXJTZXR0aW5nQ3RybC51cGRhdGVDbHVzdGVyU2V0dGluZ3MgPSB1cGRhdGVDbHVzdGVyU2V0dGluZ3M7XG5cbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoY2x1c3RlclNldHRpbmdDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgICAgICB9XSk7XG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc2V0dGluZ3MnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLm5ldHdvcmtzJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9uZXR3b3JrcycsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ05ldHdvcmtTZXR0aW5nQ3RybCBhcyBuZXR3b3JrU2V0dGluZ0N0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2V0dGluZ3MvbmV0d29ya3NldHRpbmdzLmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICA7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05ldHdvcmtTZXR0aW5nQ3RybCcsIFsnQ1JVREhlbHBlclNlcnZpY2UnLCAnTmV0d29ya1NlcnZpY2UnLFxuICAgICAgICBmdW5jdGlvbiAoQ1JVREhlbHBlclNlcnZpY2UsIE5ldHdvcmtTZXJ2aWNlKSB7XG4gICAgICAgICAgICB2YXIgbmV0d29ya1NldHRpbmdDdHJsID0gdGhpcztcbiAgICAgICAgICAgIG5ldHdvcmtTZXR0aW5nQ3RybC52bGFuUGF0dGVybiA9IENvbnRpdkdsb2JhbHMuVkxBTl9SRUdFWDtcbiAgICAgICAgICAgIG5ldHdvcmtTZXR0aW5nQ3RybC52eGxhblBhdHRlcm4gPSBDb250aXZHbG9iYWxzLlZYTEFOX1JFR0VYO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiB1cGRhdGVOZXR3b3JrU2V0dGluZ3MoKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5ldHdvcmtTZXR0aW5nQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IobmV0d29ya1NldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIobmV0d29ya1NldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgTmV0d29ya1NlcnZpY2UudXBkYXRlU2V0dGluZ3MobmV0d29ya1NldHRpbmdDdHJsLnNldHRpbmcpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3JrU2V0dGluZ0N0cmwpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IobmV0d29ya1NldHRpbmdDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldE5ldHdvcmtTZXR0aW5ncygpIHtcbiAgICAgICAgICAgICAgICBOZXR3b3JrU2VydmljZS5nZXRTZXR0aW5ncygpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBuZXR3b3JrU2V0dGluZ0N0cmwuc2V0dGluZyA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2V0TmV0d29ya1NldHRpbmdzKCk7XG4gICAgICAgICAgICBuZXR3b3JrU2V0dGluZ0N0cmwudXBkYXRlTmV0d29ya1NldHRpbmdzID0gdXBkYXRlTmV0d29ya1NldHRpbmdzO1xuXG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IobmV0d29ya1NldHRpbmdDdHJsKTtcbiAgICAgICAgfV0pO1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zZXR0aW5ncycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMudm9sdW1lcycsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvdm9sdW1lcycsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1ZvbHVtZVNldHRpbmdDdHJsIGFzIHZvbHVtZVNldHRpbmdDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9zZXR0aW5ncy92b2x1bWVzZXR0aW5ncy5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdWb2x1bWVTZXR0aW5nQ3RybCcsIFsnQ1JVREhlbHBlclNlcnZpY2UnLCAnVm9sdW1lU2V0dGluZ1NlcnZpY2UnLFxuICAgICAgICBmdW5jdGlvbiAoQ1JVREhlbHBlclNlcnZpY2UsIFZvbHVtZVNldHRpbmdTZXJ2aWNlKSB7XG4gICAgICAgICAgICB2YXIgdm9sdW1lU2V0dGluZ0N0cmwgPSB0aGlzO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiB1cGRhdGVWb2x1bWVTZXR0aW5ncygpIHtcbiAgICAgICAgICAgICAgICBpZiAodm9sdW1lU2V0dGluZ0N0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHZvbHVtZVNldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIodm9sdW1lU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBWb2x1bWVTZXR0aW5nU2VydmljZS51cGRhdGVTZXR0aW5ncyh2b2x1bWVTZXR0aW5nQ3RybC5zZXR0aW5nKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lU2V0dGluZ0N0cmwpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZVNldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcih2b2x1bWVTZXR0aW5nQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRWb2x1bWVTZXR0aW5ncygpIHtcbiAgICAgICAgICAgICAgICBWb2x1bWVTZXR0aW5nU2VydmljZS5nZXRTZXR0aW5ncygpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICB2b2x1bWVTZXR0aW5nQ3RybC5zZXR0aW5nID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBnZXRWb2x1bWVTZXR0aW5ncygpO1xuICAgICAgICAgICAgdm9sdW1lU2V0dGluZ0N0cmwudXBkYXRlVm9sdW1lU2V0dGluZ3MgPSB1cGRhdGVWb2x1bWVTZXR0aW5ncztcblxuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iodm9sdW1lU2V0dGluZ0N0cmwpO1xuICAgICAgICB9XSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDYvMS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zdG9yYWdlcG9saWNpZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMuY3JlYXRlJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9zdG9yYWdlcG9saWN5Y3JlYXRlLmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCBhcyBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignU3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnU3RvcmFnZVBvbGljaWVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgICAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIFN0b3JhZ2VQb2xpY2llc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICAgICAgdmFyIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsID0gdGhpcztcblxuICAgICAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9TdG9yYWdlUG9saWNpZXMoKSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMubGlzdCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBjYW5jZWxDcmVhdGluZygpIHtcbiAgICAgICAgICAgICAgICByZXR1cm5Ub1N0b3JhZ2VQb2xpY2llcygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBjcmVhdGVGaWxlc3lzdGVtQ21kcygpIHtcbiAgICAgICAgICAgICAgICBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5maWxlc3lzdGVtY21kcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLm5ld1N0b3JhZ2VQb2xpY3kuZmlsZXN5c3RlbXNbaXRlbS5uYW1lXSA9IGl0ZW0udmFsdWU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNyZWF0ZVBvbGljeSgpIHtcbiAgICAgICAgICAgICAgICAvL2Zvcm0gY29udHJvbGxlciBpcyBpbmplY3RlZCBieSB0aGUgaHRtbCB0ZW1wbGF0ZVxuICAgICAgICAgICAgICAgIC8vY2hlY2tpbmcgaWYgYWxsIHZhbGlkYXRpb25zIGhhdmUgcGFzc2VkXG4gICAgICAgICAgICAgICAgaWYgKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlRmlsZXN5c3RlbUNtZHMoKTtcbiAgICAgICAgICAgICAgICAgICAgU3RvcmFnZVBvbGljaWVzTW9kZWwuY3JlYXRlKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLm5ld1N0b3JhZ2VQb2xpY3kpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9TdG9yYWdlUG9saWNpZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlc2V0Rm9ybSgpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLm5ld1N0b3JhZ2VQb2xpY3kgPSB7XG4gICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICBcImJhY2tlbmRzXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY3J1ZFwiOiBcImNlcGhcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibW91bnRcIjogXCJjZXBoXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNuYXBzaG90XCI6IFwiY2VwaFwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFwidW5sb2NrZWRcIjogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIFwiZHJpdmVyXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicG9vbFwiOiBcInJiZFwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFwiY3JlYXRlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic2l6ZVwiOiBcIjBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZmlsZXN5c3RlbVwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFwicnVudGltZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInNuYXBzaG90c1wiOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzbmFwc2hvdFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJmcmVxdWVuY3lcIjogXCIzMG1cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImtlZXBcIjogMjBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJhdGUtbGltaXRcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwid3JpdGUtaW9wc1wiOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicmVhZC1pb3BzXCI6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ3cml0ZS1icHNcIjogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInJlYWQtYnBzXCI6IDAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFwiZmlsZXN5c3RlbXNcIjoge31cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5jcmVhdGVQb2xpY3kgPSBjcmVhdGVQb2xpY3k7XG4gICAgICAgICAgICBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5jYW5jZWxDcmVhdGluZyA9IGNhbmNlbENyZWF0aW5nO1xuICAgICAgICAgICAgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwuZmlsZXN5c3RlbWNtZHMgPSBbXTtcblxuICAgICAgICAgICAgcmVzZXRGb3JtKCk7XG4gICAgICAgIH1dKTtcblxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzI3LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnN0b3JhZ2Vwb2xpY2llcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5kZXRhaWxzJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwgYXMgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvc3RvcmFnZXBvbGljeWRldGFpbHMuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5lZGl0Jywge1xuICAgICAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwgYXMgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvc3RvcmFnZXBvbGljeWRldGFpbHMuaHRtbCdcbiAgICAgICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdTdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwnLFxuICAgICAgICBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ1N0b3JhZ2VQb2xpY2llc01vZGVsJywgJ1ZvbHVtZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgICAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBTdG9yYWdlUG9saWNpZXNNb2RlbCwgVm9sdW1lc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICAgICAgICAgIHZhciBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5maWxlc3lzdGVtY21kcyA9IFtdO1xuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogVG8gc2hvdyBlZGl0IG9yIGRldGFpbHMgc2NyZWVuIGJhc2VkIG9uIHRoZSByb3V0ZVxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNldE1vZGUoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkc3RhdGUuaXMoJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5lZGl0JykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5tb2RlID0gJ2VkaXQnO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLm1vZGUgPSAnZGV0YWlscyc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1BvbGljaWVzKCkge1xuICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5saXN0Jyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Qb2xpY3lEZXRhaWxzKCkge1xuICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5kZXRhaWxzJywgeydrZXknOiBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5Lm5hbWV9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjYW5jZWxFZGl0aW5nKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1BvbGljeURldGFpbHMoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBkZWxldGVQb2xpY3koKSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbC5kZWxldGVVc2luZ0tleShzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5Lm5hbWUsICduYW1lJykudGhlbihcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9Qb2xpY2llcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIEdldCB2b2x1bWVzIGJlbG9uZ2luZyB0byBhIHBvbGljeVxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdldFZvbHVtZXMocmVsb2FkKSB7XG4gICAgICAgICAgICAgICAgICAgIFZvbHVtZXNNb2RlbC5nZXQocmVsb2FkKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC52b2x1bWVzID0gJGZpbHRlcignb3JkZXJCeScpKF8uZmlsdGVyKHJlc3VsdCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdwb2xpY3knOiBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5Lm5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLCAnbmFtZScpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBpbml0aWFsaXplRmlsZXN5c3RlbUNtZHNBcnJheSgpIHtcbiAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kuZmlsZXN5c3RlbXMsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHVzaCh7bmFtZToga2V5LCB2YWx1ZTogdmFsdWV9KTtcbiAgICAgICAgICAgICAgICAgICAgfSwgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmZpbGVzeXN0ZW1jbWRzKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjcmVhdGVGaWxlc3lzdGVtQ21kcygpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmZpbGVzeXN0ZW1jbWRzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kuZmlsZXN5c3RlbXNbaXRlbS5uYW1lXSA9IGl0ZW0udmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNhdmVQb2xpY3koKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAgICAgICAgIC8vY2hlY2tpbmcgaWYgYWxsIHZhbGlkYXRpb25zIGhhdmUgcGFzc2VkXG4gICAgICAgICAgICAgICAgICAgIGlmIChzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZUZpbGVzeXN0ZW1DbWRzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbC5zYXZlKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1BvbGljeURldGFpbHMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcblxuICAgICAgICAgICAgICAgIFN0b3JhZ2VQb2xpY2llc01vZGVsLmdldE1vZGVsQnlLZXkoJHN0YXRlUGFyYW1zLmtleSwgZmFsc2UsICduYW1lJylcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnBvbGljeSA9IHBvbGljeTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluaXRpYWxpemVGaWxlc3lzdGVtQ21kc0FycmF5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBnZXRWb2x1bWVzKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmRlbGV0ZVBvbGljeSA9IGRlbGV0ZVBvbGljeTtcbiAgICAgICAgICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwuc2F2ZVBvbGljeSA9IHNhdmVQb2xpY3k7XG4gICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmNhbmNlbEVkaXRpbmcgPSBjYW5jZWxFZGl0aW5nO1xuXG4gICAgICAgICAgICAgICAgc2V0TW9kZSgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgICAgICAgICAgLy9Eb24ndCBkbyBhdXRvcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICAgICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBnZXRWb2x1bWVzKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1dKTtcblxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA2LzIvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LnN0b3JhZ2Vwb2xpY2llc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZTdG9yYWdlcG9saWN5YmFzaWNzZXR0aW5nc1wiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcblxuICAgICAgICB9XG4gICAgfSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2U3RvcmFnZXBvbGljeWZpbGVzeXN0ZW1zZXR0aW5nc1wiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIHBvbGljeTogJz0nLFxuICAgICAgICAgICAgICAgIGZpbGVzeXN0ZW1jbWRzOiAnPSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSkge1xuICAgICAgICAgICAgICAgIHNjb3BlLmZpbGVzeXN0ZW1zID0gWydleHQ0JywgJ2J0cmZzJ107XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL2ZpbGVzeXN0ZW1zZXR0aW5ncy5odG1sJ1xuICAgICAgICB9XG4gICAgfSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2U3RvcmFnZXBvbGljeXNuYXBzaG90c2V0dGluZ3NcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBwb2xpY3k6ICc9J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9zbmFwc2hvdHNldHRpbmdzLmh0bWwnXG4gICAgICAgIH1cbiAgICB9KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZTdG9yYWdlcG9saWN5cndvcHNzZXR0aW5nc1wiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIHBvbGljeTogJz0nXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL3J3b3Bzc2V0dGluZ3MuaHRtbCdcbiAgICAgICAgfVxuICAgIH0pXG4gICAgLmRpcmVjdGl2ZShcImN0dlN0b3JhZ2Vwb2xpY3liYWNrZW5kZHJpdmVyc1wiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIHBvbGljeTogJz0nXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL2JhY2tlbmRkcml2ZXJzLmh0bWwnXG4gICAgICAgIH1cbiAgICB9KTtcblxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA0LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnN0b3JhZ2Vwb2xpY2llcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5saXN0Jywge1xuICAgICAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnU3RvcmFnZVBvbGljeUxpc3RDdHJsIGFzIHN0b3JhZ2VQb2xpY3lMaXN0Q3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL3N0b3JhZ2Vwb2xpY3lsaXN0Lmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICA7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1N0b3JhZ2VQb2xpY3lMaXN0Q3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ1N0b3JhZ2VQb2xpY2llc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICAgICAgZnVuY3Rpb24gKCRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBTdG9yYWdlUG9saWNpZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgICAgIHZhciBzdG9yYWdlUG9saWN5TGlzdEN0cmwgPSB0aGlzO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRQb2xpY2llcyhyZWxvYWQpIHtcbiAgICAgICAgICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbC5nZXQocmVsb2FkKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdG9yYWdlUG9saWN5TGlzdEN0cmwucG9saWNpZXMgPSByZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgICAgIGdldFBvbGljaWVzKGZhbHNlKTtcblxuICAgICAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgICAgICAvL0Rvbid0IGRvIGF1dG8tcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBnZXRQb2xpY2llcyh0cnVlKTtcbiAgICAgICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XSk7XG5cblxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52aXN1YWxpemF0aW9uJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUudmlzdWFsaXphdGlvbi5lZGdlJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9lZGdlL3tzb3VyY2VOYW1lLCB0YXJnZXROYW1lLCBzb3VyY2VMaXN0LCB0YXJnZXRMaXN0fScsXG4gICAgICAgICAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZU5hbWU6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldE5hbWU6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZUxpc3Q6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldExpc3Q6IG51bGxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWaXN1YWxpemF0aW9uRWRnZUN0cmwgYXMgdmlzdWFsaXphdGlvbmVkZ2VDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Zpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbmVkZ2UuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignVmlzdWFsaXphdGlvbkVkZ2VDdHJsJywgW1wiJHNjb3BlXCIsIFwiJGh0dHBcIiwgJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnVmlzdWFsaXphdGlvblNlcnZpY2UnLCAnJGludGVydmFsJyxcbiAgICAgICAgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJHN0YXRlLCAkc3RhdGVQYXJhbXMsIFZpc3VhbGl6YXRpb25TZXJ2aWNlLCAkaW50ZXJ2YWwpIHtcbiAgICAgICAgICAgIHZhciBzb3VyY2VOYW1lID0gJHN0YXRlUGFyYW1zLnNvdXJjZU5hbWU7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0TmFtZSA9ICRzdGF0ZVBhcmFtcy50YXJnZXROYW1lO1xuICAgICAgICAgICAgdmFyIHNvdXJjZUxpc3QgPSAkc3RhdGVQYXJhbXMuc291cmNlTGlzdDtcbiAgICAgICAgICAgIHZhciB0YXJnZXRMaXN0ID0gJHN0YXRlUGFyYW1zLnRhcmdldExpc3Q7XG5cbiAgICAgICAgICAgIC8vSWYgdGhlIHBhZ2UgaXMgcmVsb2FkZWQsIHRoZXNlIHN0YXRlIHBhcmFtcyBhcmUgYWxsIG51bGwsXG4gICAgICAgICAgICAvL3NvIGl0IHdpbGwgcm91dGUgdGhlbSBiYWNrIHRvIHRoZSB2aXN1YWxpemF0aW9uIHRhYiB0b3Agdmlld1xuICAgICAgICAgICAgaWYgKHNvdXJjZUxpc3QgPT0gbnVsbCB8fCB0YXJnZXRMaXN0ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZpc3VhbGl6YXRpb24ubGlzdCcpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgdmFyIHQgPSBkLmdldFNlY29uZHMoKTtcbiAgICAgICAgICAgICRzY29wZS5lZGdlRGF0YUludGVydmFsID0gXG4gICAgICAgICAgICAgICAgJGludGVydmFsKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBWaXN1YWxpemF0aW9uU2VydmljZS5nZXRFZGdlRGF0YShzb3VyY2VMaXN0LCB0YXJnZXRMaXN0LCB0LnRvU3RyaW5nKCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSByZXN1bHQucmVzdWx0cztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHJlc3VsdHMsIGZ1bmN0aW9uKHIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF8uaXNFbXB0eShyKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgKz0gci5zZXJpZXNbMF0udmFsdWVzWzBdWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNvdXJjZU5hbWUgPSBzb3VyY2VOYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS50YXJnZXROYW1lID0gdGFyZ2V0TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZWRnZURhdGEgPSBkYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5lZGdlRGF0YVRpbWUgPSB0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9LCAzMDAwKTtcblxuICAgICAgICAgICAgLy9EZXN0cm95aW5nIHRoZSBpbnRlcnZhbCBmdW5jdGlvbiBvbiByb3V0ZSBjaGFuZ2VcbiAgICAgICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkgeyAkaW50ZXJ2YWwuY2FuY2VsKCRzY29wZS5lZGdlRGF0YUludGVydmFsKTsgfSk7XG5cblxuICAgICAgICAgICAgVmlzdWFsaXphdGlvblNlcnZpY2UuZ2V0T2xkRWRnZURhdGEoc291cmNlTGlzdCwgdGFyZ2V0TGlzdClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHRzID0gcmVzdWx0LnJlc3VsdHM7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlZGdlRGF0YSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAvL3Jlc3VsdHMsIGlmIG5vdCBlbXB0eSwgYXJlIGV4cGVjdGVkIHRvIGhhdmVcbiAgICAgICAgICAgICAgICAgICAgLy82IGRhdGEgZW50cmllc1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2gocmVzdWx0cywgZnVuY3Rpb24ocikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF8uaXNFbXB0eShyKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHIuc2VyaWVzWzBdLnZhbHVlcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoXy5pc0VtcHR5KGVkZ2VEYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goZGF0YSwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRnZURhdGEucHVzaChkWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goZGF0YSwgZnVuY3Rpb24oZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRnZURhdGFbaV0gKz0gZFsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zb3VyY2VOYW1lID0gc291cmNlTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRhcmdldE5hbWUgPSB0YXJnZXROYW1lO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlTGlzdCA9IHNvdXJjZUxpc3Q7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50YXJnZXRMaXN0ID0gdGFyZ2V0TGlzdDtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm9sZEVkZ2VEYXRhID0gZWRnZURhdGE7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICB9XSk7XG5cblxuXG5cblxuXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicpXG4gICAgLmRpcmVjdGl2ZShcInZpc3VhbGl6YXRpb25FZGdlXCIsIFsnJHdpbmRvdycsXG4gICAgICAgIGZ1bmN0aW9uKCR3aW5kb3cpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIHZpc3VhbGl6YXRpb25FZGdlRDMoc2NvcGUsIGQzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJvZHlFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF07XG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IGJvZHlFbC5jbGllbnRXaWR0aCAtIDQwMCxcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gIGJvZHlFbC5jbGllbnRIZWlnaHQgLSA0MDA7XG5cblxuICAgICAgICAgICAgICAgIC8vdGFrZW4gZnJvbSBodHRwOi8vYmwub2Nrcy5vcmcvc2ltZW5icmVra2VuLzY2MzQwNzBcbiAgICAgICAgICAgICAgICAvLyAvKiogTUFJTiBTVkcgKiovXG4gICAgICAgICAgICAgICAgdmFyIGxpbWl0ID0gNTksXG4gICAgICAgICAgICAgICAgZHVyYXRpb24gPSA3NTAsXG4gICAgICAgICAgICAgICAgbm93ID0gbmV3IERhdGUoRGF0ZS5ub3coKSAtIGR1cmF0aW9uKTtcblxuICAgICAgICAgICAgICAgIHZhciBncm91cHMgPSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdvcmFuZ2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZDMucmFuZ2UobGltaXQpLm1hcChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNjb3BlLm9sZEVkZ2VEYXRhW01hdGguZmxvb3IoZC8xMCldIHx8IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgeCA9IGQzLnRpbWUuc2NhbGUoKVxuICAgICAgICAgICAgICAgICAgICAuZG9tYWluKFtub3cgLSAobGltaXQgLSAyKSwgbm93IC0gZHVyYXRpb25dKVxuICAgICAgICAgICAgICAgICAgICAucmFuZ2UoWzAsIHdpZHRoXSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgeSA9IGQzLnNjYWxlLmxpbmVhcigpXG4gICAgICAgICAgICAgICAgICAgIC5kb21haW4oWzAsIGQzLm1heChncm91cHMuY3VycmVudC5kYXRhLCBmdW5jdGlvbiAoZCkgeyByZXR1cm4gZCArIDEwOyB9KV0pXG4gICAgICAgICAgICAgICAgICAgIC5yYW5nZShbaGVpZ2h0LCAwXSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbGluZSA9IGQzLnN2Zy5saW5lKClcbiAgICAgICAgICAgICAgICAgICAgLmludGVycG9sYXRlKCdiYXNpcycpXG4gICAgICAgICAgICAgICAgICAgIC54KGZ1bmN0aW9uKGQsIGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB4KG5vdyAtIChsaW1pdCAtIDEgLSBpKSAqIGR1cmF0aW9uKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAueShmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geShkKVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHZhciB4U3ZnID0gZDMuc2VsZWN0KCcuZ3JhcGgnKS5hcHBlbmQoJ3N2ZycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd3aWR0aCcsIDI1KVxuICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ292ZXJmbG93JywgJ3Zpc2libGUnKVxuICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ3Bvc2l0aW9uJywgJ2ZpeGVkJyk7XG5cbiAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgIHZhciB5QXhpcyA9IHhTdmcuYXBwZW5kKCdnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ3kgYXhpcycpXG4gICAgICAgICAgICAgICAgICAgIC8vIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDAsJyArIHdpZHRoICsgJyknKVxuICAgICAgICAgICAgICAgICAgICAuY2FsbCh5LmF4aXMgPSBkMy5zdmcuYXhpcygpLnNjYWxlKHkpLm9yaWVudCgnbGVmdCcpKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgc3ZnPSBkMy5zZWxlY3QoJy5ncmFwaCcpLmFwcGVuZCgnc3ZnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2NoYXJ0JylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgd2lkdGggLSA1MClcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2hlaWdodCcsIGhlaWdodCArIDUwKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gLnN0eWxlKCdvdmVyZmxvdycsIFwidmlzaWJsZVwiKTtcblxuICAgICAgICAgICAgICAgIHZhciBheGlzID0gc3ZnLmFwcGVuZCgnZycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICd4IGF4aXMnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZSgwLCcgKyBoZWlnaHQgKyAnKScpXG4gICAgICAgICAgICAgICAgICAgIC5jYWxsKHguYXhpcyA9IGQzLnN2Zy5heGlzKCkuc2NhbGUoeCkub3JpZW50KCdib3R0b20nKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgcGF0aHMgPSBzdmcuYXBwZW5kKCdnJyk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBuYW1lIGluIGdyb3Vwcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ3JvdXAgPSBncm91cHNbbmFtZV07XG4gICAgICAgICAgICAgICAgICAgIGdyb3VwLnBhdGggPSBwYXRocy5hcHBlbmQoJ3BhdGgnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmRhdGEoW2dyb3VwLmRhdGFdKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgbmFtZSArICcgZ3JvdXAnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN0eWxlKCdzdHJva2UnLCBncm91cC5jb2xvcilcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiB0aWNrKCkge1xuICAgICAgICAgICAgICAgICAgICBub3cgPSBuZXcgRGF0ZSgpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCBuZXcgdmFsdWVzXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIG5hbWUgaW4gZ3JvdXBzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ3JvdXAgPSBncm91cHNbbmFtZV07XG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cC5kYXRhLnB1c2goc2NvcGUuZWRnZURhdGEgfHwgMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cC5wYXRoLmF0dHIoJ2QnLCBsaW5lKVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2hpZnQgZG9tYWluXG4gICAgICAgICAgICAgICAgICAgIHguZG9tYWluKFtub3cgLSAobGltaXQgLSAyKSAqIGR1cmF0aW9uLCBub3cgLSBkdXJhdGlvbl0pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFNsaWRlIHgtYXhpcyBsZWZ0XG4gICAgICAgICAgICAgICAgICAgIGF4aXMudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZHVyYXRpb24oZHVyYXRpb24pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZWFzZSgnbGluZWFyJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYWxsKHguYXhpcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgeUF4aXMudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZHVyYXRpb24oZHVyYXRpb24pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZWFzZSgnbGluZWFyJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYWxsKHkuYXhpcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2xpZGUgcGF0aHMgbGVmdFxuICAgICAgICAgICAgICAgICAgICBwYXRocy5hdHRyKCd0cmFuc2Zvcm0nLCBudWxsKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmR1cmF0aW9uKGR1cmF0aW9uKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVhc2UoJ2xpbmVhcicpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZSgnICsgeChub3cgLSAobGltaXQgLSAxKSAqIGR1cmF0aW9uKSArICcpJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lYWNoKCdlbmQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aWNrKClcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBvbGRlc3QgZGF0YSBwb2ludCBmcm9tIGVhY2ggZ3JvdXBcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBncm91cHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBncm91cCA9IGdyb3Vwc1tuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLmRhdGEuc2hpZnQoKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRpY2soKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm57XG4gICAgICAgICAgICAgICAgcmVzdHJpY3Q6J0VBJyxcbiAgICAgICAgICAgICAgICByZXBsYWNlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Zpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbmVkZ2V0ZW1wbGF0ZS5odG1sJyxcbiAgICAgICAgICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSl7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiR3YXRjaEdyb3VwKFsnZWRnZURhdGEnLCAnb2xkRWRnZURhdGEnXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzY29wZS5lZGdlRGF0YSAhPSBudWxsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5vbGRFZGdlRGF0YSAhPSBudWxsICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNjb3BlLmluaXRpYWxpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmluaXRpYWxpemUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQzID0gJHdpbmRvdy5kMzsgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzdWFsaXphdGlvbkVkZ2VEMyhzY29wZSwgZDMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgXVxuKTtcblxuXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nKVxuICAgIC5zZXJ2aWNlKCdTdGF0ZVNhdmUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2F2ZWRTdGF0ZXMgPSB7fTtcbiAgICB9KVxuICAgIC5kaXJlY3RpdmUoXCJ2aXN1YWxpemF0aW9uR3JhcGhcIiwgWyckd2luZG93JywgJyRzdGF0ZScsICdWaXN1YWxpemVyR3JhcGgnLCAnUG9saWN5U2VydmljZScsICdWaXN1YWxpemVyRGF0YVNvdXJjZScsICdTdGF0ZVNhdmUnLFxuICAgICAgICBmdW5jdGlvbigkd2luZG93LCAkc3RhdGUsIFZpc3VhbGl6ZXJHcmFwaCwgUG9saWN5U2VydmljZSwgVmlzdWFsaXplckRhdGFTb3VyY2UsIFN0YXRlU2F2ZSkge1xuICAgICAgICAgICAgZnVuY3Rpb24gdmlzdWFsaXphdGlvbmxpc3RkMyhzY29wZSwgZWxlbSwgVmlzdWFsaXplckdyYXBoLCBQb2xpY3lTZXJ2aWNlLCBWaXN1YWxpemVyRGF0YVNvdXJjZSwgU3RhdGVTYXZlKSB7XG4gICAgICAgICAgICAgICAgLy9kb24ndCBydW4gdW50aWwgYWxsIGluaXRpYWxpemF0aW9uIGNhbGxzIGhhdmUgcmV0dXJuZWRcbiAgICAgICAgICAgICAgICBpZiAoc2NvcGUubm9kZXMgPT09IHVuZGVmaW5lZCB8fCBzY29wZS5saW5rcyA9PT0gdW5kZWZpbmVkIHx8IHNjb3BlLmNoaWxkcmVuX3N0cnVjdCA9PT0gdW5kZWZpbmVkIHx8XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLmFuY2VzdG9yc19zdHJ1Y3QgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9jcmVhdGluZyBEYXRhU291cmNlXG4gICAgICAgICAgICAgICAgdmFyIGRhdGFTb3VyY2UgPSBuZXcgVmlzdWFsaXplckRhdGFTb3VyY2UuRGF0YVNvdXJjZShzY29wZS5ub2Rlcywgc2NvcGUubGlua3MsIHNjb3BlLmNoaWxkcmVuX3N0cnVjdCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5hbmNlc3RvcnNfc3RydWN0LCBzY29wZS5sYWJlbHMsIHNjb3BlLnNlcnZpY2VTZWxlY3RvcnMpO1xuICAgICAgICAgICAgICAgIGRhdGFTb3VyY2Uuc2V0QW5jZXN0b3JzKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMsIGxpbmtzO1xuXG4gICAgICAgICAgICAgICAgdmFyIHRvcERhdGEgPSBkYXRhU291cmNlLmdldFRvcExldmVsRmxvdygpO1xuICAgICAgICAgICAgICAgIG5vZGVzID0gZGF0YVNvdXJjZS5wcm9jZXNzTm9kZURhdGEodG9wRGF0YS5ub2RlRGF0YSk7XG4gICAgICAgICAgICAgICAgbGlua3MgPSBkYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YSh0b3BEYXRhLmxpbmtEYXRhLCBub2Rlcyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgYm9keUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gYm9keUVsLmNsaWVudFdpZHRoLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSAgYm9keUVsLmNsaWVudEhlaWdodDtcblxuICAgICAgICAgICAgICAgIC8qKiBNQUlOIFNWRyAqKi9cbiAgICAgICAgICAgICAgICB2YXIgcmF3U3ZnPWVsZW0uZmluZCgnc3ZnJyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gJChyYXdTdmcucGFyZW50KCkpLm9mZnNldCgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGRpdldpZHRoID0gJChyYXdTdmcucGFyZW50KCkpLndpZHRoKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3ZnID0gZDMuc2VsZWN0KHJhd1N2Z1swXSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCBkaXZXaWR0aClcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJoZWlnaHRcIiwgaGVpZ2h0IC0gb2Zmc2V0LnRvcCAtIDIwKTtcblxuICAgICAgICAgICAgICAgIC8vaW5zdGFsbGluZyBwb2xpY2llc1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaCA9IG5ldyBWaXN1YWxpemVyR3JhcGguR3JhcGgoc3ZnLCBub2RlcywgbGlua3MsIGRhdGFTb3VyY2UsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmNoaWxkcmVuX3N0cnVjdCwgc2NvcGUuYW5jZXN0b3JzX3N0cnVjdCk7XG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmluc3RhbGxEZWZhdWx0UGF0aFBvbGljeShuZXcgUG9saWN5U2VydmljZS5TYXZlU3RhdGVQb2xpY3koU3RhdGVTYXZlLnNhdmVkU3RhdGVzKSk7XG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmluc3RhbGxEZWZhdWx0UGF0aFBvbGljeShuZXcgUG9saWN5U2VydmljZS5QYXRoQ2hhbmdlVmlld1BvbGljeSgkc3RhdGUpKTtcbiAgICAgICAgICAgICAgICAvL1FUaXBQb2xpY3kgaXMgZm9yIGJvdGggTm9kZXMgYW5kIFBhdGhzLCBpbnN0YWxsIHNhbWUgb25lIG9uIGJvdGhcbiAgICAgICAgICAgICAgICB2YXIgcVRpcFBvbGljeSA9IG5ldyBQb2xpY3lTZXJ2aWNlLlFUaXBQb2xpY3koKTtcbiAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGguaW5zdGFsbERlZmF1bHROb2RlUG9saWN5KHFUaXBQb2xpY3kpO1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5pbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3kocVRpcFBvbGljeSk7XG4gICAgICAgICAgICAgICAgdmFyIHNwbGl0Sm9pblZpZXdQb2xpY3kgPSBuZXcgUG9saWN5U2VydmljZS5TcGxpdEpvaW5WaWV3UG9saWN5KCk7XG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmluc3RhbGxEZWZhdWx0Tm9kZVBvbGljeShzcGxpdEpvaW5WaWV3UG9saWN5KTtcbiAgICAgICAgICAgICAgICBzcGxpdEpvaW5WaWV3UG9saWN5Lmluc3RhbGxCYWNrQnV0dG9uKCQoJyNiYWNrQnV0dG9uJykpO1xuICAgICAgICAgICAgICAgIHNwbGl0Sm9pblZpZXdQb2xpY3kuaW5zdGFsbFRpdGxlKCQoJyNncmFwaC10aXRsZScpKTtcblxuICAgICAgICAgICAgICAgIC8vbG9hZCBvbGQgdmlldyBpZiBpdCBleGlzdHMuXG4gICAgICAgICAgICAgICAgaWYgKF8uaXNFbXB0eShTdGF0ZVNhdmUuc2F2ZWRTdGF0ZXMpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBncmFwaCA9IHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaDtcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGgubG9hZChTdGF0ZVNhdmUuc2F2ZWRTdGF0ZXMpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJue1xuICAgICAgICAgICAgICAgIHJlc3RyaWN0OidFQScsXG4gICAgICAgICAgICAgICAgcmVwbGFjZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb250ZW1wbGF0ZS5odG1sJyxcbiAgICAgICAgICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbSl7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS51bmJpbmQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5kZXN0cm95KCk7fSk7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiR3YXRjaEdyb3VwKFsnbm9kZXMnLCAnbGlua3MnLCAnY2hpbGRyZW5fc3RydWN0JywgJ2FuY2VzdG9yc19zdHJ1Y3QnXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzY29wZS5ub2RlcyAhPSBudWxsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmxpbmtzICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuY2hpbGRyZW5fc3RydWN0ICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuYW5jZXN0b3JzX3N0cnVjdCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzY29wZS5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5pbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc3VhbGl6YXRpb25saXN0ZDMoc2NvcGUsIGVsZW0sIFZpc3VhbGl6ZXJHcmFwaCwgUG9saWN5U2VydmljZSwgVmlzdWFsaXplckRhdGFTb3VyY2UsIFN0YXRlU2F2ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmRhdGFTb3VyY2UubGlua3MgPSBzY29wZS5saW5rcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLnVwZGF0ZUxpbmtEYXRhKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIF1cbik7XG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZpc3VhbGl6YXRpb24ubGlzdCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1Zpc3VhbGl6YXRpb25MaXN0Q3RybCBhcyB2aXN1YWxpemF0aW9uTGlzdEN0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9ubGlzdC5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdWaXN1YWxpemF0aW9uTGlzdEN0cmwnLCBbXCIkc2NvcGVcIiwgXCIkaHR0cFwiLCAnVmlzdWFsaXphdGlvblNlcnZpY2UnLCAnJGludGVydmFsJyxcbiAgICAgICAgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgVmlzdWFsaXphdGlvblNlcnZpY2UsICRpbnRlcnZhbCkge1xuICAgICAgICAgICAgdmFyIGdyYXBoRGF0YSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBsaW5rcyA9IFtdO1xuICAgICAgICAgICAgICAgIC8vZW5kcG9pbnQgaXBcbiAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKHtuYW1lOiAnMTEuMS4xLjInLCBpZDonMTEuMS4xLjInLCBwYXJlbnQ6bnVsbCwgYW5jZXN0b3JzOm51bGx9KTtcbiAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKHtuYW1lOiAnMTEuMS4xLjMnLCBpZDonMTEuMS4xLjMnLCBwYXJlbnQ6bnVsbCwgYW5jZXN0b3JzOm51bGx9KTtcbiAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKHtuYW1lOiAnMTEuMS4xLjQnLCBpZDonMTEuMS4xLjQnLCBwYXJlbnQ6bnVsbCwgYW5jZXN0b3JzOm51bGx9KTtcbiAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKHtuYW1lOiAnMTEuMS4xLjUnLCBpZDonMTEuMS4xLjUnLCBwYXJlbnQ6bnVsbCwgYW5jZXN0b3JzOm51bGx9KTtcbiAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKHtuYW1lOiAnMTEuMS4xLjYnLCBpZDonMTEuMS4xLjYnLCBwYXJlbnQ6bnVsbCwgYW5jZXN0b3JzOm51bGx9KTtcbiAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKHtuYW1lOiAnMTEuMS4xLjcnLCBpZDonMTEuMS4xLjcnLCBwYXJlbnQ6bnVsbCwgYW5jZXN0b3JzOm51bGx9KTtcbiAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKHtuYW1lOiAnMTEuMS4xLjgnLCBpZDonMTEuMS4xLjgnLCBwYXJlbnQ6bnVsbCwgYW5jZXN0b3JzOm51bGx9KTtcblxuICAgICAgICAgICAgICAgIC8vYXBwLXN2YyBwcm92aWRlciBpcFxuICAgICAgICAgICAgICAgIG5vZGVzLnB1c2goe25hbWU6ICcxMC4xLjEuMScsIGlkOicxMC4xLjEuMScsIHBhcmVudDpudWxsLCBhbmNlc3RvcnM6bnVsbH0pO1xuICAgICAgICAgICAgICAgIG5vZGVzLnB1c2goe25hbWU6ICcxMC4xLjEuMicsIGlkOicxMC4xLjEuMicsIHBhcmVudDpudWxsLCBhbmNlc3RvcnM6bnVsbH0pO1xuICAgICAgICAgICAgICAgIG5vZGVzLnB1c2goe25hbWU6ICcxMC4xLjEuMycsIGlkOicxMC4xLjEuMycsIHBhcmVudDpudWxsLCBhbmNlc3RvcnM6bnVsbH0pO1xuICAgICAgICAgICAgICAgIG5vZGVzLnB1c2goe25hbWU6ICcxMC4xLjEuNCcsIGlkOicxMC4xLjEuNCcsIHBhcmVudDpudWxsLCBhbmNlc3RvcnM6bnVsbH0pO1xuICAgICAgICAgICAgICAgIG5vZGVzLnB1c2goe25hbWU6ICcxMC4xLjEuNScsIGlkOicxMC4xLjEuNScsIHBhcmVudDpudWxsLCBhbmNlc3RvcnM6bnVsbH0pO1xuICAgICAgICAgICAgICAgIG5vZGVzLnB1c2goe25hbWU6ICcxMC4xLjEuNicsIGlkOicxMC4xLjEuNicsIHBhcmVudDpudWxsLCBhbmNlc3RvcnM6bnVsbH0pO1xuICAgICAgICAgICAgICAgIG5vZGVzLnB1c2goe25hbWU6ICcxMC4xLjEuNycsIGlkOicxMC4xLjEuNycsIHBhcmVudDpudWxsLCBhbmNlc3RvcnM6bnVsbH0pO1xuICAgICAgICAgICAgICAgIG5vZGVzLnB1c2goe25hbWU6ICcxMC4xLjEuOCcsIGlkOicxMC4xLjEuOCcsIHBhcmVudDpudWxsLCBhbmNlc3RvcnM6bnVsbH0pO1xuICAgICAgICAgICAgICAgIG5vZGVzLnB1c2goe25hbWU6ICcxMC4xLjEuOScsIGlkOicxMC4xLjEuOScsIHBhcmVudDpudWxsLCBhbmNlc3RvcnM6bnVsbH0pO1xuXG4gICAgICAgICAgICAgICAgLy9hcHAtZGIgcHJvdmlkZXIgaXBcbiAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKHtuYW1lOiAnMTAuMS4xLjEwJywgaWQ6JzEwLjEuMS4xMCcsIHBhcmVudDpudWxsLCBhbmNlc3RvcnM6bnVsbH0pO1xuICAgICAgICAgICAgICAgIG5vZGVzLnB1c2goe25hbWU6ICcxMC4xLjEuMTEnLCBpZDonMTAuMS4xLjExJywgcGFyZW50Om51bGwsIGFuY2VzdG9yczpudWxsfSk7XG4gICAgICAgICAgICAgICAgbm9kZXMucHVzaCh7bmFtZTogJzEwLjEuMS4xMicsIGlkOicxMC4xLjEuMTInLCBwYXJlbnQ6bnVsbCwgYW5jZXN0b3JzOm51bGx9KTtcblxuICAgICAgICAgICAgICAgIC8vYXBwLXN2YyBsaW5rc1xuICAgICAgICAgICAgICAgIGxpbmtzLnB1c2goe3NvdXJjZTogJzExLjEuMS4yJywgdGFyZ2V0OiAnMTAuMS4xLjEnLCB3ZWlnaHQ6NTR9KTtcbiAgICAgICAgICAgICAgICBsaW5rcy5wdXNoKHtzb3VyY2U6ICcxMC4xLjEuMScsIHRhcmdldDogJzExLjEuMS4yJywgd2VpZ2h0Ojk1fSk7XG4gICAgICAgICAgICAgICAgbGlua3MucHVzaCh7c291cmNlOiAnMTEuMS4xLjMnLCB0YXJnZXQ6ICcxMC4xLjEuMScsIHdlaWdodDo4MH0pO1xuICAgICAgICAgICAgICAgIGxpbmtzLnB1c2goe3NvdXJjZTogJzEwLjEuMS4xJywgdGFyZ2V0OiAnMTEuMS4xLjMnLCB3ZWlnaHQ6NTR9KTtcbiAgICAgICAgICAgICAgICBsaW5rcy5wdXNoKHtzb3VyY2U6ICcxMS4xLjEuNCcsIHRhcmdldDogJzEwLjEuMS4zJywgd2VpZ2h0OjQ4fSk7XG4gICAgICAgICAgICAgICAgbGlua3MucHVzaCh7c291cmNlOiAnMTAuMS4xLjMnLCB0YXJnZXQ6ICcxMS4xLjEuNCcsIHdlaWdodDoyNH0pO1xuICAgICAgICAgICAgICAgIGxpbmtzLnB1c2goe3NvdXJjZTogJzExLjEuMS41JywgdGFyZ2V0OiAnMTAuMS4xLjYnLCB3ZWlnaHQ6MjN9KTtcbiAgICAgICAgICAgICAgICBsaW5rcy5wdXNoKHtzb3VyY2U6ICcxMC4xLjEuNicsIHRhcmdldDogJzExLjEuMS41Jywgd2VpZ2h0OjU0fSk7XG4gICAgICAgICAgICAgICAgbGlua3MucHVzaCh7c291cmNlOiAnMTEuMS4xLjYnLCB0YXJnZXQ6ICcxMC4xLjEuNycsIHdlaWdodDo2NX0pO1xuICAgICAgICAgICAgICAgIGxpbmtzLnB1c2goe3NvdXJjZTogJzEwLjEuMS43JywgdGFyZ2V0OiAnMTEuMS4xLjYnLCB3ZWlnaHQ6NDN9KTtcbiAgICAgICAgICAgICAgICBsaW5rcy5wdXNoKHtzb3VyY2U6ICcxMS4xLjEuNycsIHRhcmdldDogJzEwLjEuMS44Jywgd2VpZ2h0OjkwfSk7XG4gICAgICAgICAgICAgICAgbGlua3MucHVzaCh7c291cmNlOiAnMTAuMS4xLjgnLCB0YXJnZXQ6ICcxMS4xLjEuNycsIHdlaWdodDo0OH0pO1xuICAgICAgICAgICAgICAgIGxpbmtzLnB1c2goe3NvdXJjZTogJzExLjEuMS44JywgdGFyZ2V0OiAnMTAuMS4xLjknLCB3ZWlnaHQ6NTR9KTtcbiAgICAgICAgICAgICAgICBsaW5rcy5wdXNoKHtzb3VyY2U6ICcxMC4xLjEuOScsIHRhcmdldDogJzExLjEuMS44Jywgd2VpZ2h0OjU0fSk7XG5cbiAgICAgICAgICAgICAgICAvL2FwcC1kYiBsaW5rc1xuICAgICAgICAgICAgICAgIGxpbmtzLnB1c2goe3NvdXJjZTogJzExLjEuMS44JywgdGFyZ2V0OiAnMTAuMS4xLjEwJywgd2VpZ2h0OjU0fSk7XG4gICAgICAgICAgICAgICAgbGlua3MucHVzaCh7c291cmNlOiAnMTAuMS4xLjEwJywgdGFyZ2V0OiAnMTEuMS4xLjgnLCB3ZWlnaHQ6Nzh9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge25vZGVzOm5vZGVzLCBsaW5rczpsaW5rc307XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzdHJ1Y3R1cmVEYXRhID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxhYmVscyA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCIxMC4xLjEuMTBcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJlbnZpcm9ubWVudFwiOiBcInByb2RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVsZWFzZVwiOiBcInN0YWJsZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ2ZXJzaW9uXCI6IFwiMS4wXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRpZXJcIjogXCJkYlwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjExXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZW52aXJvbm1lbnRcIjogXCJwcm9kXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJlbGVhc2VcIjogXCJzdGFibGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidmVyc2lvblwiOiBcIjEuMFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aWVyXCI6IFwiZGJcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBcIjEwLjEuMS4xMlwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImVudmlyb25tZW50XCI6IFwicHJvZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWxlYXNlXCI6IFwic3RhYmxlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInZlcnNpb25cIjogXCIxLjBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidGllclwiOiBcImRiXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXCIxMC4xLjEuMVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImVudmlyb25tZW50XCI6IFwicHJvZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWxlYXNlXCI6IFwic3RhYmxlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInZlcnNpb25cIjogXCIxLjBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidGllclwiOiBcIndlYlwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjlcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJlbnZpcm9ubWVudFwiOiBcInByb2RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVsZWFzZVwiOiBcInN0YWJsZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ2ZXJzaW9uXCI6IFwiMS4wXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRpZXJcIjogXCJ3ZWJcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBcIjEwLjEuMS44XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZW52aXJvbm1lbnRcIjogXCJwcm9kXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJlbGVhc2VcIjogXCJzdGFibGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidmVyc2lvblwiOiBcIjEuMFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aWVyXCI6IFwid2ViXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXCIxMC4xLjEuM1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImVudmlyb25tZW50XCI6IFwicHJvZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWxlYXNlXCI6IFwic3RhYmxlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInZlcnNpb25cIjogXCIxLjBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidGllclwiOiBcIndlYlwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjJcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJlbnZpcm9ubWVudFwiOiBcInByb2RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVsZWFzZVwiOiBcInN0YWJsZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ2ZXJzaW9uXCI6IFwiMS4wXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRpZXJcIjogXCJ3ZWJcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBcIjEwLjEuMS41XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZW52aXJvbm1lbnRcIjogXCJwcm9kXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJlbGVhc2VcIjogXCJzdGFibGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidmVyc2lvblwiOiBcIjEuMFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aWVyXCI6IFwid2ViXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXCIxMC4xLjEuNFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImVudmlyb25tZW50XCI6IFwicHJvZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWxlYXNlXCI6IFwic3RhYmxlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInZlcnNpb25cIjogXCIxLjBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidGllclwiOiBcIndlYlwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjdcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJlbnZpcm9ubWVudFwiOiBcInByb2RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVsZWFzZVwiOiBcInN0YWJsZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ2ZXJzaW9uXCI6IFwiMS4wXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRpZXJcIjogXCJ3ZWJcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBcIjEwLjEuMS42XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVsZWFzZVwiOiBcInN0YWJsZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aWVyXCI6IFwid2ViXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInZlcnNpb25cIjogXCIxLjBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZW52aXJvbm1lbnRcIjogXCJwcm9kXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIHNlcnZpY2VTZWxlY3RvcnMgPSB7XG4gICAgICAgICAgICAgICAgICAgIFwiYXBwLWRiXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidGllclwiOiBcImRiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJlbGVhc2VcIjogXCJzdGFibGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZW52aXJvbm1lbnRcIjogXCJwcm9kXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXCJhcHAtc3ZjXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidGllclwiOiBcIndlYlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWxlYXNlXCI6IFwic3RhYmxlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImVudmlyb25tZW50XCI6IFwicHJvZFwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJ0b3BMZXZlbFwiOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcC1zdmNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwLWRiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDAtc3ZjXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDAtZGJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwMS1zdmNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwMS1kYlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHAyLXN2Y1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHAyLWRiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDMtc3ZjXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDMtZGJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwNC1zdmNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwNC1kYlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHA1LXN2Y1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHA1LWRiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDYtc3ZjXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDYtZGJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwNy1zdmNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwNy1kYlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHA4LXN2Y1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHA4LWRiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDktc3ZjXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDktZGJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwMTAtc3ZjXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDEwLWRiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDExLXN2Y1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHAxMS1kYlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHAwMS1zdmNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwMDItZGJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwMDMtc3ZjXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDAzLWRiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDIwLXN2Y1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHAyMC1kYlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHAzMC1zdmNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwMzAtZGJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwNDAtc3ZjXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDQwLWRiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDUwLXN2Y1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHA1MC1kYlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHA2MC1zdmNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwNjAtZGJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwNzAtc3ZjXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDcwLWRiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDgwLXN2Y1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHA4MC1kYlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHA5MC1zdmNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwOTAtZGJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwMTAwLXN2Y1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHAxMDAtZGJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwMTEwLXN2Y1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHAxMTAtZGJcIlxuXG4gICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgIC8vIFwiYXBwMC1zdmNcIjogW10sXG4gICAgICAgICAgICAgICAgICAgIC8vIFwiYXBwMC1kYlwiOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgXCJhcHAtc3ZjXCI6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjFcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjZcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjhcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjlcIlxuICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICBcImFwcC1kYlwiOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBcIjEwLjEuMS4xMFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCIxMC4xLjEuMTFcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjEyXCJcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBfLmZvckVhY2goY2hpbGRyZW5fc3RydWN0Wyd0b3BMZXZlbCddLCBmdW5jdGlvbihzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGlsZHJlbl9zdHJ1Y3Rbc10gPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW5fc3RydWN0W3NdID0gW107XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnNfc3RydWN0ID0ge307XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKGNoaWxkcmVuX3N0cnVjdFsnYXBwLXN2YyddLCBmdW5jdGlvbihzKSB7XG4gICAgICAgICAgICAgICAgICAgIGFuY2VzdG9yc19zdHJ1Y3Rbc10gPSBbJ2FwcC1zdmMnXTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfLmZvckVhY2goY2hpbGRyZW5fc3RydWN0WydhcHAtZGInXSwgZnVuY3Rpb24ocykge1xuICAgICAgICAgICAgICAgICAgICBhbmNlc3RvcnNfc3RydWN0W3NdID0gWydhcHAtZGInXTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiB7Y2hpbGRyZW5fc3RydWN0OmNoaWxkcmVuX3N0cnVjdCwgYW5jZXN0b3JzX3N0cnVjdDphbmNlc3RvcnNfc3RydWN0LFxuICAgICAgICAgICAgICAgICAgICBsYWJlbHM6bGFiZWxzLCBzZXJ2aWNlU2VsZWN0b3JzOnNlcnZpY2VTZWxlY3RvcnN9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgVmlzdWFsaXphdGlvblNlcnZpY2UuZ2V0R3JhcGhEYXRhKCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBncmFwaERhdGEoKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUubm9kZXMgPSBkYXRhLm5vZGVzO1xuICAgICAgICAgICAgICAgICRzY29wZS5saW5rcyA9IGRhdGEubGlua3M7XG4gICAgICAgICAgICAgICAgLy8gJHNjb3BlLmVuZHBvaW50cyA9IGVuZHBvaW50cztcbiAgICAgICAgICAgICAgICAvLyAkc2NvcGUucHJvdmlkZXJzID0gcHJvdmlkZXJzO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcIkNvdWxkbid0IGxvYWQgZ3JhcGggZGF0YVwiKTtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IGdyYXBoRGF0YSgpO1xuICAgICAgICAgICAgICAgICRzY29wZS5ub2RlcyA9IGRhdGEubm9kZXM7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxpbmtzID0gZGF0YS5saW5rcztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJHNjb3BlLmdyYXBoRGF0YUludGVydmFsID0gJGludGVydmFsKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIFZpc3VhbGl6YXRpb25TZXJ2aWNlLmdldEdyYXBoRGF0YSgpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IGdyYXBoRGF0YSgpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubm9kZXMgPSBkYXRhLm5vZGVzO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubGlua3MgPSBkYXRhLmxpbmtzO1xuICAgICAgICAgICAgICAgICAgICAvLyAkc2NvcGUuZW5kcG9pbnRzID0gZW5kcG9pbnRzO1xuICAgICAgICAgICAgICAgICAgICAvLyAkc2NvcGUucHJvdmlkZXJzID0gcHJvdmlkZXJzO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiQ291bGRuJ3QgbG9hZCBncmFwaCBkYXRhXCIpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IGdyYXBoRGF0YSgpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubm9kZXMgPSBkYXRhLm5vZGVzO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubGlua3MgPSBkYXRhLmxpbmtzO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSwgMzAwMCk7XG5cbiAgICAgICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkgeyAkaW50ZXJ2YWwuY2FuY2VsKCRzY29wZS5ncmFwaERhdGFJbnRlcnZhbCk7IH0pO1xuXG5cbiAgICAgICAgICAgIFZpc3VhbGl6YXRpb25TZXJ2aWNlLmdldFN0cnVjdHVyZURhdGEoKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcblxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gc3RydWN0dXJlRGF0YSgpO1xuICAgICAgICAgICAgICAgICRzY29wZS5hbmNlc3RvcnNfc3RydWN0ID0gZGF0YS5hbmNlc3RvcnNfc3RydWN0O1xuICAgICAgICAgICAgICAgICRzY29wZS5jaGlsZHJlbl9zdHJ1Y3QgPSBkYXRhLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICAkc2NvcGUubGFiZWxzID0gZGF0YS5sYWJlbHM7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlcnZpY2VTZWxlY3RvcnMgPSBkYXRhLnNlcnZpY2VTZWxlY3RvcnM7XG5cbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJDb3VsZG4ndCBsb2FkIHN0cnVjdHVyZSBkYXRhXCIpO1xuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gc3RydWN0dXJlRGF0YSgpO1xuICAgICAgICAgICAgICAgICRzY29wZS5hbmNlc3RvcnNfc3RydWN0ID0gZGF0YS5hbmNlc3RvcnNfc3RydWN0O1xuICAgICAgICAgICAgICAgICRzY29wZS5jaGlsZHJlbl9zdHJ1Y3QgPSBkYXRhLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICAkc2NvcGUubGFiZWxzID0gZGF0YS5sYWJlbHM7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlcnZpY2VTZWxlY3RvcnMgPSBkYXRhLnNlcnZpY2VTZWxlY3RvcnM7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfV0pO1xuXG4vKmFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZpc3VhbGl6YXRpb24ubGlzdCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1Zpc3VhbGl6YXRpb25MaXN0Q3RybCBhcyB2aXN1YWxpemF0aW9uTGlzdEN0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9ubGlzdC5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdWaXN1YWxpemF0aW9uTGlzdEN0cmwnLCBbXCIkc2NvcGVcIiwgXCIkaHR0cFwiLCAnVmlzdWFsaXphdGlvblNlcnZpY2UnLCAnJGludGVydmFsJywgXG4gICAgICAgIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsIFZpc3VhbGl6YXRpb25TZXJ2aWNlLCAkaW50ZXJ2YWwpIHtcbiAgICAgICAgICAgIC8vdG8gc2VlIHRoZSBleHBlY3RlZCBmb3JtYXQgdG8gYmUgcmV0dXJuZWQgZnJvbSB0aGVzZSBjYWxscyxcbiAgICAgICAgICAgIC8vbG9vayBhdCBhcHAvY29tcG9uZW50cy9ncmFwaG9iamVjdHMvZGF0YXNvdXJjZS92aXN1YWxpemVyZGF0YXNvdXJjZS5qc1xuICAgICAgICAgICAgdmFyIHN1Y2Nlc3NHcmFwaERhdGFDYWxsYmFjayA9IGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBsaW5rcyA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBub2RlSWRzID0gW107XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHJlc3VsdC5yZXN1bHRzWzBdLnNlcmllcywgZnVuY3Rpb24oc2VyaWVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbmRwb2ludCA9IHNlcmllcy50YWdzLkVuZHBvaW50SVA7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwcm92aWRlciA9IHNlcmllcy50YWdzLlByb3ZpZGVySVA7XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlO1xuICAgICAgICAgICAgICAgICAgICAvL2NyZWF0aW5nIG5vZGVzXG4gICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKG5vZGVJZHMsIGVuZHBvaW50KSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBlbmRwb2ludCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogZW5kcG9pbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50OiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2VzdG9yczogbnVsbFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzLnB1c2gobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzLnB1c2goZW5kcG9pbnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKG5vZGVJZHMsIHByb3ZpZGVyKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBwcm92aWRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogcHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50OiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2VzdG9yczogbnVsbFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzLnB1c2gobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzLnB1c2gocHJvdmlkZXIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vY3JlYXRpbmcgbGlua3NcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxpbmtPdXQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6IGVuZHBvaW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiBwcm92aWRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIHdlaWdodDogc2VyaWVzLnZhbHVlc1swXVsyXVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBsaW5rcy5wdXNoKGxpbmtPdXQpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGlua0luID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiBwcm92aWRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogZW5kcG9pbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ6IHNlcmllcy52YWx1ZXNbMF1bMV1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgbGlua3MucHVzaChsaW5rSW4pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICRzY29wZS5ub2RlcyA9IG5vZGVzO1xuICAgICAgICAgICAgICAgICRzY29wZS5saW5rcyA9IGxpbmtzO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIC8vaW5pdGlhbCBjYWxsXG4gICAgICAgICAgICBWaXN1YWxpemF0aW9uU2VydmljZS5nZXRHcmFwaERhdGEoKS50aGVuKHN1Y2Nlc3NHcmFwaERhdGFDYWxsYmFjaywgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAvL3dpbGwgZmFpbCBzaWxlbnRseSwgZ3JhcGggd29uJ3QgYmUgZGlzcGxheWVkXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7ICRpbnRlcnZhbC5jYW5jZWwoJHNjb3BlLmdyYXBoRGF0YUludGVydmFsKTsgfSk7XG5cbiAgICAgICAgICAgIFZpc3VhbGl6YXRpb25TZXJ2aWNlLmdldFN0cnVjdHVyZURhdGEoKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAvL3RvIHNlZSB0aGUgZXhwZWN0ZWQgZm9ybSBvZiBhbmNlc3Rvcl9zdHJ1Y3QgYW5kIGNoaWxkcmVuX3N0cnVjdCwgXG4gICAgICAgICAgICAgICAgLy9sb29rIGF0IGFwcC9jb21wb25lbnRzL2dyYXBob2JqZWN0cy9kYXRhc291cmNlL3Zpc3VhbGl6ZXJkYXRhc291cmNlLmpzXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFuY2VzdG9yc19zdHJ1Y3QgPSByZXN1bHQuYW5jZXN0b3JzX3N0cnVjdDtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2hpbGRyZW5fc3RydWN0ID0gcmVzdWx0LmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICAkc2NvcGUubGFiZWxzID0gcmVzdWx0LmxhYmVscztcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VydmljZVNlbGVjdG9ycyA9IHJlc3VsdC5zZXJ2aWNlU2VsZWN0b3JzO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAvL3dpbGwgZmFpbCBzaWxlbnRseSwgZ3JhcGggd29uJ3QgYmUgZGlzcGxheWVkXG4gICAgICAgICAgICB9KTtcbiAgICB9XSk7Ki9cblxuXG5cblxuXG5cblxuXG5cblxuXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicpXG4gICAgLmZhY3RvcnkoJ1Zpc3VhbGl6YXRpb25TZXJ2aWNlJywgWyckaHR0cCcsICckcScsIGZ1bmN0aW9uICgkaHR0cCwgJHEpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1ha2VzIGEgZ2V0IHJlcXVlc3Qgd2l0aCB0aGUgdXJsIGFuZCBjb25maWcuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICB1cmwgICAgIFRoZSB1cmxcbiAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGNvbmZpZyAgVGhlIGNvbmZpZ3VyYXRpb25zXG4gICAgICAgICAqIEByZXR1cm4gICAgIHskSHR0cCBQcm9taXNlfSAgIFByb21pc2Ugb2YgdGhlIHJlcXVlc3RcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIG1ha2VHZXQodXJsLCBjb25maWcpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAkaHR0cC5nZXQodXJsLCBjb25maWcpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYWtlcyBhIHBvc3QgcmVxdWVzdCB3aXRoIHRoZSB1cmwgYW5kIGRhdGFcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHVybCAgICAgVGhlIHVybFxuICAgICAgICAgKiBAcGFyYW0gICAgICB7SlNPTn0gICAgZGF0YSAgICBUaGUgZGF0YVxuICAgICAgICAgKiBAcmV0dXJuICAgICB7JEh0dHAgUHJvbWlzZX0gICBQcm9taXNlIG9mIHRoZSByZXF1ZXN0XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBtYWtlUG9zdCh1cmwsIGRhdGEpIHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogY29udmVydHMgdGhlIGRhdGEgaW50byB4LXd3dy1mcm9tLXVybGVuY29kZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SlNPTn0gIG9iaiAgICAgSlNPTiBkYXRhIG9iamVjdFxuICAgICAgICAgICAgICogQHJldHVybiAgICAge3N0cmluZ30gIHgtd3d3LWZvcm0tdXJsZW5jb2RlZCBzdHJpbmdcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdmFyIHBhcmFtID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gJycsIG5hbWUsIHZhbHVlLCBmdWxsU3ViTmFtZSwgc3ViTmFtZSwgc3ViVmFsdWUsIGlubmVyT2JqLCBpO1xuICAgICAgICAgICAgICAgIGZvciAobmFtZSBpbiBvYmopIHtcbiAgICAgICAgICAgICAgICAgIHZhbHVlID0gb2JqW25hbWVdO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGk9MDsgaTx2YWx1ZS5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlZhbHVlID0gdmFsdWVbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVsbFN1Yk5hbWUgPSBuYW1lICsgJ1snICsgaSArICddJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbm5lck9iaiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlubmVyT2JqW2Z1bGxTdWJOYW1lXSA9IHN1YlZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ICs9IHBhcmFtKGlubmVyT2JqKSArICcmJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIE9iamVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChzdWJOYW1lIGluIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViVmFsdWUgPSB2YWx1ZVtzdWJOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdWxsU3ViTmFtZSA9IG5hbWUgKyAnWycgKyBzdWJOYW1lICsgJ10nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlubmVyT2JqID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5uZXJPYmpbZnVsbFN1Yk5hbWVdID0gc3ViVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkgKz0gcGFyYW0oaW5uZXJPYmopICsgJyYnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYodmFsdWUgIT09IHVuZGVmaW5lZCAmJiB2YWx1ZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkgKz0gZW5jb2RlVVJJQ29tcG9uZW50KG5hbWUpICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKSArICcmJztcbiAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHF1ZXJ5Lmxlbmd0aCA/IHF1ZXJ5LnN1YnN0cigwLCBxdWVyeS5sZW5ndGggLSAxKSA6IHF1ZXJ5O1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICB1cmw6dXJsLFxuICAgICAgICAgICAgICAgIG1ldGhvZDonUE9TVCcsXG4gICAgICAgICAgICAgICAgZGF0YTogZGF0YSxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCdcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHRyYW5zZm9ybVJlcXVlc3Q6IFtmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhbmd1bGFyLmlzT2JqZWN0KGRhdGEpICYmIFN0cmluZyhkYXRhKSAhPT0gJ1tvYmplY3QgRmlsZV0nID8gcGFyYW0oZGF0YSkgOiBkYXRhO1xuICAgICAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0R3JhcGhEYXRhKCkge1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuVklTVUFMSVpBVElPTl9FTkRQT0lOVDtcbiAgICAgICAgICAgIHVybCArPSAnaW5mbHV4L3F1ZXJ5JztcbiAgICAgICAgICAgIHZhciBjb25maWcgPSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgICAgICAgICAgIGRiOlwidGVsZWdyYWZcIixcbiAgICAgICAgICAgICAgICAgICAgcTpcIlNFTEVDVCBCeXRlc0luLCBCeXRlc091dCwgRW5kcG9pbnRJUCwgUHJvdmlkZXJJUCBGUk9NIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDFtIEdST1VQIEJZICogTElNSVQgMVwiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBtYWtlR2V0KHVybCwgY29uZmlnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldFN0cnVjdHVyZURhdGEoKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WSVNVQUxJWkFUSU9OX0VORFBPSU5UO1xuICAgICAgICAgICAgdXJsICs9ICdzZXJ2aWNlcyc7XG4gICAgICAgICAgICByZXR1cm4gbWFrZUdldCh1cmwpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gYnVpbGRXaGVyZVF1ZXJ5KHBvaW50cywgdHlwZSkge1xuICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gXCIoXCI7XG4gICAgICAgICAgICBxdWVyeSArPSB0eXBlICsgXCI9XCI7XG4gICAgICAgICAgICBxdWVyeSArPSBcIidcIiArIHBvaW50c1swXSArIFwiJyBcIjtcbiAgICAgICAgICAgIC8vc3RhcnRzIGF0IDEsIHNvIHdpbGwgbm90IHJ1biBpZiBsZW5ndGggaXMgMVxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBwb2ludHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBxdWVyeSArPSAnT1IgJztcbiAgICAgICAgICAgICAgICBxdWVyeSArPSB0eXBlICsgXCI9XCI7XG4gICAgICAgICAgICAgICAgcXVlcnkgKz0gXCInXCIgKyBwb2ludHNbaV0gKyBcIicgXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBxdWVyeSArPSBcIilcIjtcbiAgICAgICAgICAgIHJldHVybiBxdWVyeTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldEVkZ2VEYXRhKHNvdXJjZUxpc3QsIHRhcmdldExpc3QsIHRpbWUpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLlZJU1VBTElaQVRJT05fRU5EUE9JTlQ7XG4gICAgICAgICAgICB1cmwgKz0gJ2luZmx1eC9xdWVyeSc7XG5cbiAgICAgICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICBkYiA6IFwidGVsZWdyYWZcIixcbiAgICAgICAgICAgICAgICAgICAgcTogXCJTRUxFQ1Qgc3VtKFwiICsgJ0J5dGVzT3V0JyArIFwiKSBmcm9tIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDE1cyBBTkQgXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeShzb3VyY2VMaXN0LCBcIkVuZHBvaW50SVBcIikgK1wiIEFORCBcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeSh0YXJnZXRMaXN0LCAnUHJvdmlkZXJJUCcpIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgXCJHUk9VUCBCWSB0aW1lKDIwcykgTElNSVQgMTsgU0VMRUNUIHN1bShcIiArICdCeXRlc0luJyArIFwiKSBmcm9tIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDE1cyBBTkQgXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeShzb3VyY2VMaXN0LCAnUHJvdmlkZXJJUCcpICtcIiBBTkQgXCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkodGFyZ2V0TGlzdCwgJ0VuZHBvaW50SVAnKSBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIFwiR1JPVVAgQlkgdGltZSgyMHMpIGZpbGwoMCkgTElNSVQgMVwiXG4gICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIG1ha2VQb3N0KHVybCwgZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICBcblxuICAgICAgICBmdW5jdGlvbiBnZXRPbGRFZGdlRGF0YShzb3VyY2VMaXN0LCB0YXJnZXRMaXN0KSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WSVNVQUxJWkFUSU9OX0VORFBPSU5UO1xuICAgICAgICAgICAgdXJsICs9ICdpbmZsdXgvcXVlcnknO1xuICAgICAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgICAgIGRiIDogXCJ0ZWxlZ3JhZlwiLFxuICAgICAgICAgICAgICAgICAgICBxOiBcIlNFTEVDVCBzdW0oXCIgKyAnQnl0ZXNPdXQnICsgXCIpIEZST00gaHR0cGpzb25fc3Zjc3RhdHMgV0hFUkUgdGltZSA+IG5vdygpIC0gMW0gQU5EIFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkoc291cmNlTGlzdCwgXCJFbmRwb2ludElQXCIpICtcIiBBTkQgXCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkodGFyZ2V0TGlzdCwgXCJQcm92aWRlcklQXCIpIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgXCIgR1JPVVAgQlkgdGltZSgxMHMpIGZpbGwoMCkgTElNSVQgNjsgU0VMRUNUIHN1bShcIiArICdCeXRlc0luJyArIFwiKSBGUk9NIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDFtIEFORCBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHNvdXJjZUxpc3QsIFwiUHJvdmlkZXJJUFwiKSArXCIgQU5EIFwiIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHRhcmdldExpc3QsIFwiRW5kcG9pbnRJUFwiKSBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIFwiIEdST1VQIEJZIHRpbWUoMTBzKSBmaWxsKDApIExJTUlUIDZcIlxuICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBtYWtlUG9zdCh1cmwsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldEdyYXBoRGF0YTogZ2V0R3JhcGhEYXRhLFxuICAgICAgICAgICAgZ2V0U3RydWN0dXJlRGF0YTogZ2V0U3RydWN0dXJlRGF0YSxcbiAgICAgICAgICAgIGdldEVkZ2VEYXRhOiBnZXRFZGdlRGF0YSxcbiAgICAgICAgICAgIGdldE9sZEVkZ2VEYXRhOiBnZXRPbGRFZGdlRGF0YVxuICAgICAgICB9XG4gICAgfV0pO1xuXG5cblxuXG5cblxuXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDYvMy8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52b2x1bWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUudm9sdW1lcy5jcmVhdGUnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2b2x1bWVzL3ZvbHVtZWNyZWF0ZS5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnVm9sdW1lQ3JlYXRlQ3RybCBhcyB2b2x1bWVDcmVhdGVDdHJsJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdWb2x1bWVDcmVhdGVDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ1ZvbHVtZXNNb2RlbCcsICdTdG9yYWdlUG9saWNpZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgVm9sdW1lc01vZGVsLCBTdG9yYWdlUG9saWNpZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgICAgIHZhciB2b2x1bWVDcmVhdGVDdHJsID0gdGhpcztcbiAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwuZmlsZXN5c3RlbXMgPSBbJ2V4dDQnLCAnYnRyZnMnXTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Wb2x1bWVzTW9kZWwoKSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS52b2x1bWVzLmxpc3QnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9Wb2x1bWVzTW9kZWwoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBHZXQgc3RvcmFnZSBwb2xpY2llcy5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0U3RvcmFnZVBvbGljaWVzKCkge1xuICAgICAgICAgICAgICAgIFN0b3JhZ2VQb2xpY2llc01vZGVsLmdldCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLnBvbGljaWVzID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBhcHBseVBvbGljeVNldHRpbmdzKCkge1xuICAgICAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwubmV3Vm9sdW1lLnBvbGljeSA9IHZvbHVtZUNyZWF0ZUN0cmwuc2VsZWN0ZWRQb2xpY3kubmFtZTtcbiAgICAgICAgICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLm5ld1ZvbHVtZS5iYWNrZW5kcyA9IHZvbHVtZUNyZWF0ZUN0cmwuc2VsZWN0ZWRQb2xpY3kuYmFja2VuZHM7XG4gICAgICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUuZHJpdmVyID0gdm9sdW1lQ3JlYXRlQ3RybC5zZWxlY3RlZFBvbGljeS5kcml2ZXI7XG4gICAgICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUuY3JlYXRlID0gdm9sdW1lQ3JlYXRlQ3RybC5zZWxlY3RlZFBvbGljeS5jcmVhdGU7XG4gICAgICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUucnVudGltZSA9IHZvbHVtZUNyZWF0ZUN0cmwuc2VsZWN0ZWRQb2xpY3kucnVudGltZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gY3JlYXRlVm9sdW1lKCkge1xuICAgICAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAgICAgLy9jaGVja2luZyBpZiBhbGwgdmFsaWRhdGlvbnMgaGF2ZSBwYXNzZWRcbiAgICAgICAgICAgICAgICBpZiAodm9sdW1lQ3JlYXRlQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKHZvbHVtZUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBhcHBseVBvbGljeVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIFZvbHVtZXNNb2RlbC5jcmVhdGUodm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblRvVm9sdW1lc01vZGVsKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHZvbHVtZUNyZWF0ZUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiByZXNldEZvcm0oKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUgPSB7XG4gICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICBcImJhY2tlbmRzXCI6IHt9LFxuICAgICAgICAgICAgICAgICAgICBcImRyaXZlclwiOiB7fSxcbiAgICAgICAgICAgICAgICAgICAgXCJjcmVhdGVcIjoge30sXG4gICAgICAgICAgICAgICAgICAgIFwicnVudGltZVwiOiB7fVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwuY3JlYXRlVm9sdW1lID0gY3JlYXRlVm9sdW1lO1xuICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5jYW5jZWxDcmVhdGluZyA9IGNhbmNlbENyZWF0aW5nO1xuXG4gICAgICAgICAgICBnZXRTdG9yYWdlUG9saWNpZXMoKTtcblxuICAgICAgICAgICAgcmVzZXRGb3JtKCk7XG4gICAgICAgIH1dKTtcblxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA0LzE1LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZvbHVtZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52b2x1bWVzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1ZvbHVtZURldGFpbHNDdHJsIGFzIHZvbHVtZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZvbHVtZXMvdm9sdW1lZGV0YWlscy5odG1sJ1xuICAgICAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1ZvbHVtZURldGFpbHNDdHJsJyxcbiAgICAgICAgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGh0dHAnLCAnVm9sdW1lc01vZGVsJywgJ1ZvbHVtZVNlcnZpY2UnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgICAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRzY29wZSwgJGludGVydmFsLCAkaHR0cCwgVm9sdW1lc01vZGVsLCBWb2x1bWVTZXJ2aWNlLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICAgICAgdmFyIHZvbHVtZURldGFpbHNDdHJsID0gdGhpcztcblxuICAgICAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Wb2x1bWVzKCkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUudm9sdW1lcy5saXN0Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmdW5jdGlvbiBkZWxldGVWb2x1bWUoKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHZvbHVtZURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcih2b2x1bWVEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgVm9sdW1lc01vZGVsLmRlbGV0ZSh2b2x1bWVEZXRhaWxzQ3RybC52b2x1bWUpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9Wb2x1bWVzKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldFZvbHVtZUluZm8ocmVsb2FkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRva2VucyA9ICRzdGF0ZVBhcmFtcy5rZXkuc3BsaXQoJy8nKTtcbiAgICAgICAgICAgICAgICB2YXIgbW9kZWwgPXt9O1xuICAgICAgICAgICAgICAgIG1vZGVsLnBvbGljeSA9IHRva2Vuc1swXTtcbiAgICAgICAgICAgICAgICBtb2RlbC5uYW1lID0gdG9rZW5zWzFdO1xuICAgICAgICAgICAgICAgIFZvbHVtZXNNb2RlbC5nZXRNb2RlbChtb2RlbCwgcmVsb2FkKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAodm9sdW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2b2x1bWVEZXRhaWxzQ3RybC52b2x1bWUgPSB2b2x1bWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBnZXRWb2x1bWVVc2VJbmZvKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBnZXRWb2x1bWVTbmFwc2hvdHMoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldFZvbHVtZVVzZUluZm8oKSB7XG4gICAgICAgICAgICAgICAgVm9sdW1lU2VydmljZS5nZXRWb2x1bWVVc2VJbmZvKHZvbHVtZURldGFpbHNDdHJsLnZvbHVtZSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZvbHVtZURldGFpbHNDdHJsLnZvbHVtZVVzZSA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAvL1JldHVybnMgZXJyb3IgaWYgdm9sdW1lIGlzIG5vdCBtb3VudGVkIGJ5IGFueSBjb250YWluZXJcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0Vm9sdW1lU25hcHNob3RzKCkge1xuICAgICAgICAgICAgICAgIFZvbHVtZVNlcnZpY2UuZ2V0Vm9sdW1lU25hcHNob3RzKHZvbHVtZURldGFpbHNDdHJsLnZvbHVtZSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZvbHVtZURldGFpbHNDdHJsLnNuYXBzaG90cyA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiB0cmlnZ2VyVm9sdW1lU25hcHNob3QoKXtcbiAgICAgICAgICAgICAgICB2b2x1bWVEZXRhaWxzQ3RybC5zbmFwc2hvdFN1Y2Nlc3M9ZmFsc2U7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHZvbHVtZURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcih2b2x1bWVEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgVm9sdW1lU2VydmljZS50cmlnZ2VyU25hcHNob3Qodm9sdW1lRGV0YWlsc0N0cmwudm9sdW1lKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHZvbHVtZURldGFpbHNDdHJsLnNuYXBzaG90U3VjY2Vzcz10cnVlO1xuICAgICAgICAgICAgICAgIH0sICBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCl7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Iodm9sdW1lRGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZvbHVtZURldGFpbHNDdHJsLmRlbGV0ZVZvbHVtZSA9IGRlbGV0ZVZvbHVtZTtcbiAgICAgICAgICAgIHZvbHVtZURldGFpbHNDdHJsLnRyaWdnZXJWb2x1bWVTbmFwc2hvdCA9IHRyaWdnZXJWb2x1bWVTbmFwc2hvdDtcblxuICAgICAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgICAgICBnZXRWb2x1bWVJbmZvKGZhbHNlKTtcblxuXG4gICAgICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgICAgIC8vRG9uJ3QgZG8gYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGdldFZvbHVtZUluZm8odHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9XSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMjIvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudm9sdW1lcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZvbHVtZXMubGlzdCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1ZvbHVtZUxpc3RDdHJsIGFzIHZvbHVtZUxpc3RDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZvbHVtZXMvdm9sdW1lbGlzdC5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdWb2x1bWVMaXN0Q3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ1ZvbHVtZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgVm9sdW1lc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICAgICAgdmFyIHZvbHVtZUxpc3RDdHJsID0gdGhpcztcblxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0Vm9sdW1lcyhyZWxvYWQpIHtcbiAgICAgICAgICAgICAgICBWb2x1bWVzTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2b2x1bWVMaXN0Q3RybC52b2x1bWVzID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgICAgIGdldFZvbHVtZXMoZmFsc2UpO1xuXG4gICAgICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgICAgIC8vRG9uJ3QgZG8gYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGdldFZvbHVtZXModHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfV0pO1xuXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDYvNS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52b2x1bWVzJylcbiAgICAuZmFjdG9yeSgnVm9sdW1lU2VydmljZScsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbiAoJGh0dHAsICRxKSB7XG4gICAgICAgIGZ1bmN0aW9uIGdldFZvbHVtZVVzZUluZm8odm9sdW1lKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuVk9MVU1FU19VU0VTX0VORFBPSU5UXG4gICAgICAgICAgICAgICAgKyB2b2x1bWUucG9saWN5XG4gICAgICAgICAgICAgICAgKyAnLycgKyB2b2x1bWUubmFtZTtcbiAgICAgICAgICAgICRodHRwLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAvL1JldHVybnMgZXJyb3IgaWYgdm9sdW1lIGlzIG5vdCBtb3VudGVkIGJ5IGFueSBjb250YWluZXJcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldFZvbHVtZVNuYXBzaG90cyh2b2x1bWUpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WT0xVTUVTX1NOQVBTSE9UU19FTkRQT0lOVFxuICAgICAgICAgICAgICAgICsgdm9sdW1lLnBvbGljeVxuICAgICAgICAgICAgICAgICsgJy8nICsgdm9sdW1lLm5hbWU7XG4gICAgICAgICAgICAkaHR0cC5nZXQodXJsKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB0cmlnZ2VyU25hcHNob3Qodm9sdW1lKXtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WT0xVTUVTX1NOQVBTSE9UU19FTkRQT0lOVCArIFwidGFrZS9cIiBcbiAgICAgICAgICAgICAgICArIHZvbHVtZS5wb2xpY3lcbiAgICAgICAgICAgICAgICArICcvJyArIHZvbHVtZS5uYW1lO1xuICAgICAgICAgICAgJGh0dHAucG9zdCh1cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCl7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCl7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3VsdC5kYXRhKTsgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldFZvbHVtZVVzZUluZm86IGdldFZvbHVtZVVzZUluZm8sXG4gICAgICAgICAgICBnZXRWb2x1bWVTbmFwc2hvdHM6IGdldFZvbHVtZVNuYXBzaG90cyxcbiAgICAgICAgICAgIHRyaWdnZXJTbmFwc2hvdDogdHJpZ2dlclNuYXBzaG90XG4gICAgICAgIH1cbiAgICB9XSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgY3NoYW1wdXIgb24gOC85LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZvbHVtZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52b2x1bWVzLmNvcHknLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2NvcHkvJyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHtzbmFwc2hvdDpudWxsLCBwb2xpY3k6bnVsbCwgdm9sdW1lOm51bGx9LFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWb2x1bWVTbmFwc2hvdENvcHlDdHJsIGFzIHZvbHVtZVNuYXBzaG90Q29weUN0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndm9sdW1lcy92b2x1bWVzbmFwc2hvdGNvcHkuaHRtbCdcbiAgICAgICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdWb2x1bWVTbmFwc2hvdENvcHlDdHJsJyxcbiAgICAgICAgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGh0dHAnLCAnVm9sdW1lc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICAgICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgJHNjb3BlLCAkaW50ZXJ2YWwsICRodHRwLCBWb2x1bWVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHZvbHVtZVNuYXBzaG90Q29weUN0cmwgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ29weSgpIHtcbiAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS52b2x1bWVzLmRldGFpbHMnLCB7a2V5OiRzdGF0ZVBhcmFtcy5wb2xpY3krJy8nKyRzdGF0ZVBhcmFtcy52b2x1bWV9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnb1RvTmV3Vm9sdW1lKCkge1xuICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZvbHVtZXMuZGV0YWlscycsIHtrZXk6JHN0YXRlUGFyYW1zLnBvbGljeSsnLycrdm9sdW1lU25hcHNob3RDb3B5Q3RybC5uZXd2b2x1bWV9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjb3B5U25hcHNob3QoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKHZvbHVtZVNuYXBzaG90Q29weUN0cmwuZm9ybS4kdmFsaWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHZvbHVtZVNuYXBzaG90Q29weUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIodm9sdW1lU25hcHNob3RDb3B5Q3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9kZWwgPXt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwucG9saWN5ID0gJHN0YXRlUGFyYW1zLnBvbGljeTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLm5hbWUgPSAkc3RhdGVQYXJhbXMudm9sdW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgVm9sdW1lc01vZGVsLmNvcHkobW9kZWwsICRzdGF0ZVBhcmFtcy5zbmFwc2hvdCwgdm9sdW1lU25hcHNob3RDb3B5Q3RybC5uZXd2b2x1bWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZVNuYXBzaG90Q29weUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb1RvTmV3Vm9sdW1lKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVTbmFwc2hvdENvcHlDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHZvbHVtZVNuYXBzaG90Q29weUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2b2x1bWVTbmFwc2hvdENvcHlDdHJsLnBvbGljeSA9ICRzdGF0ZVBhcmFtcy5wb2xpY3k7XG4gICAgICAgICAgICAgICAgdm9sdW1lU25hcHNob3RDb3B5Q3RybC52b2x1bWUgPSAkc3RhdGVQYXJhbXMudm9sdW1lO1xuICAgICAgICAgICAgICAgIHZvbHVtZVNuYXBzaG90Q29weUN0cmwuc25hcHNob3QgPSAkc3RhdGVQYXJhbXMuc25hcHNob3Q7XG4gICAgICAgICAgICAgICAgdm9sdW1lU25hcHNob3RDb3B5Q3RybC5jb3B5U25hcHNob3QgPSBjb3B5U25hcHNob3Q7XG4gICAgICAgICAgICAgICAgdm9sdW1lU25hcHNob3RDb3B5Q3RybC5jYW5jZWxDb3B5ID0gY2FuY2VsQ29weTtcbiAgICAgICAgICAgIH1dKTtcbi8qKlxuICogQ3JlYXRlZCBieSBjc2hhbXB1ciBvbiA3LzEvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2QWNjb3JkaW9uXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBpdGVtczogJz0nLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxpbms6ZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQpe1xuICAgICAgICAgICAgICAgIGlmKHR5cGVvZiBlbGVtZW50LmZpbmQoJy51aS5hY2NvcmRpb24nKS5hY2NvcmRpb24gPT0gJ2Z1bmN0aW9uJylcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5maW5kKCcudWkuYWNjb3JkaW9uJykuYWNjb3JkaW9uKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvYWNjb3JkaW9uLmh0bWwnXG4gICAgICAgIH1cbiAgICB9KTtcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNi8yLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5kaXJlY3RpdmVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dkNvbGxhcHNpYmxlXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIHRpdGxlOiAnQCcsXG4gICAgICAgICAgICAgICAgY29sbGFwc2VkOiAnQCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNjb3BlLmNvbGxhcHNlZCA9PT0gdW5kZWZpbmVkKSBzY29wZS5jb2xsYXBzZWQgPSB0cnVlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9kaXJlY3RpdmVzL2NvbGxhcHNpYmxlLmh0bWwnXG4gICAgICAgIH1cbiAgICB9KTtcblxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA0LzI4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5kaXJlY3RpdmVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dkVycm9yXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIGhlYWRlcjogJ0AnLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnPSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LmZpbmQoJ2knKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnbmctaGlkZScpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvZXJyb3JtZXNzYWdlLmh0bWwnXG4gICAgICAgIH1cbiAgICB9KTtcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xMS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZOYW1ldmFsdWVcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgIGl0ZW1zOiAnPScsXG4gICAgICAgICAgICAgICBuYW1laGVhZGVyOiAnQCcsLy9GaWVsZCBuYW1lIHRvIGRpc3BsYXkgZm9yIGtleVxuICAgICAgICAgICAgICAgdmFsdWVoZWFkZXI6ICdAJywvL0ZpZWxkIG5hbWUgdG8gZGlzcGxheSBmb3IgdmFsdWVcbiAgICAgICAgICAgICAgIHR5cGU6ICdAJywvLyd0ZXh0JyBvciAnc2VsZWN0JyB0byBjaG9vc2UgaW5wdXQgb3Igc2VsZWN0IGh0bWwgdGFnIGZvciBrZXlcbiAgICAgICAgICAgICAgIG9wdGlvbnM6ICc9Jy8vVG8gYmUgdXNlZCB3aGVuIHR5cGUgaXMgJ3NlbGVjdCdcbiAgICAgICAgICAgfSxcbiAgICAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUpIHtcbiAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogQ29tcGFyZSBpZiB0d28gaXRlbXMgaGF2ZSBzYW1lIG5hbWVcbiAgICAgICAgICAgICAgICAqIEBwYXJhbSB2YWwxXG4gICAgICAgICAgICAgICAgKiBAcGFyYW0gdmFsMlxuICAgICAgICAgICAgICAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNvbXBhcmUodmFsMSwgdmFsMikge1xuICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWwxLm5hbWUgPT0gdmFsMi5uYW1lO1xuICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICBmdW5jdGlvbiByZXNldE5ld0l0ZW0oKSB7XG4gICAgICAgICAgICAgICAgICAgc2NvcGUubmV3SXRlbSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJycsXG4gICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAnJ1xuICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgIGZ1bmN0aW9uIGlzRW1wdHlJdGVtKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICByZXR1cm4gKGl0ZW0ubmFtZSA9PT0gJycgJiYgaXRlbS52YWx1ZSA9PT0gJycpO1xuICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICBzY29wZS5hZGQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICBpZiAoaXNFbXB0eUl0ZW0oc2NvcGUubmV3SXRlbSkpIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICBpZiAoc2NvcGUuaXRlbSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLml0ZW0gPSBbXTtcbiAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgLy9SZW1vdmVzIGV4aXN0aW5nIGl0ZW0gd2l0aCB0aGUgc2FtZSBuYW1lIGZpcnN0IGlmIGl0IGV4aXN0cy5cbiAgICAgICAgICAgICAgICAgICBfLnB1bGxBbGxXaXRoKHNjb3BlLml0ZW1zLCBbc2NvcGUubmV3SXRlbV0sIGNvbXBhcmUpO1xuICAgICAgICAgICAgICAgICAgIHNjb3BlLml0ZW1zLnB1c2goc2NvcGUubmV3SXRlbSk7XG4gICAgICAgICAgICAgICAgICAgcmVzZXROZXdJdGVtKCk7XG4gICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICBzY29wZS5yZW1vdmUgPSBmdW5jdGlvbihwYXNzZWRJdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgXy5yZW1vdmUoc2NvcGUuaXRlbXMsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLm5hbWUgPT0gcGFzc2VkSXRlbS5uYW1lO1xuICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgIHJlc2V0TmV3SXRlbSgpO1xuXG4gICAgICAgICAgICAgICBpZiAoc2NvcGUubmFtZWhlYWRlciA9PT0gdW5kZWZpbmVkKSBzY29wZS5uYW1laGVhZGVyID0gJ05hbWUnO1xuICAgICAgICAgICAgICAgaWYgKHNjb3BlLnZhbHVlaGVhZGVyID09PSB1bmRlZmluZWQpIHNjb3BlLnZhbHVlaGVhZGVyID0gJ1ZhbHVlJztcbiAgICAgICAgICAgICAgIGlmIChzY29wZS50eXBlID09PSB1bmRlZmluZWQpIHNjb3BlLnR5cGUgPSAndGV4dCc7XG4gICAgICAgICAgIH0sXG4gICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9kaXJlY3RpdmVzL25hbWV2YWx1ZS5odG1sJ1xuICAgICAgIH1cbiAgICB9KTtcblxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzQvMTYuXG4gKi9cblxuLypcbkRpcmVjdGl2ZSBVc2FnZSA6XG5cbmEpIGN0dlRhYmxlIC1cbiAgIHVzYWdlIDogPGN0di10YWJsZSBkZWZhdWx0c29ydGNvbHVtbj0nbmFtZScgaXRlbXM9J3RhYmxlSXRlbXMnIGZpbHRlcmVkaXRlbXM9J2ZpbHRJdGVtcycgc2l6ZT0nc2l6ZSc+PC9jdHYtdGFibGU+XG4gICBhdHRyaWJ1dGUgZGV0YWlscyA6ICBkZWZhdWx0c29ydGNvbHVtbiAtIFRoZSBkZWZhdWx0IGNvbHVtbiBuYW1lKGNvcnJlc3BvbmRpbmcga2V5IGluc2lkZSB0aGUgb2JqZWN0IG9mIGl0ZW1zIGFycmF5KSBvbiB3aGljaCB0aGUgdGFibGUgd2lsbCBiZSBzb3J0ZWQgd2hlbiBpdCBpcyBsb2FkZWQuXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtcyAtIEFuIGFycmF5IG9mIG9iamVjdHMgd2hpY2ggd2lsbCBiZSBkaXNwbGF5ZWQgYnkgdGhlIGN0di10YWJsZSBkaXJlY3RpdmUuXG4gICAgICAgICAgICAgICAgICAgICAgICBzaXplIC0gbnVtYmVyIG9mIHJvd3MgdG8gYmUgZGlzcGxheWVkIGluc2lkZSB0aGUgdGFibGUuIElmIGl0ZW1zLmxlbmd0aCA+IHNpemUgdGhlbiByZW1haW5pbmcgaXRlbXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWxsIGJlIGRpc3BsYXllZCBpbiBuZXh0IHBhZ2UuXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJlZGl0ZW1zIC0gVGhpcyBpcyBhbiBvdXRwdXQgZmllbGQgd2hpY2ggcHJvZHVjZXMgYSBmaWx0ZXJlZCBzdWJzZXQgb2YgaXRlbXMgc3BlY2VmaWVkIGJ5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlIHByZXZpb3VzIGF0dHJpYnV0ZSwgSXRlbXMgYXJlIGZpbHRlcmVkIGJhc2VkIG9uIHNlYXJjaCB0ZXh0IGRlZmluZWQgaW5zaWRlIGN0di1zZWFyY2gsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5kIGJ5IHRoZSBzaXplIG1lbnRpb25lZCBpbiB0aGUgY3R2LXRhYmxlIGF0dHJpYnV0ZVxuYikgY3R2VEggLVxuICAgdXNhZ2UgOiA8Y3R2LXRoIHNvcnRmaWVsZD0nbmFtZSc+bmFtZTwvY3R2LXRoPlxuICAgYXR0cmlidXRlIGRldGFpbHMgOiBzb3J0ZmllbGQgLSBUaGlzIGlzIHRoZSBrZXkgb2YgdGhlIG9iamVjdCBwcmVzZW50IGluc2lkZSBpdGVtcyBhcnJheSBzcGVjZWZpZWQgaW4gY3R2VGFibGUsIGZvciBlZyA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHRoZSBhcnJheSBvYmplY3QgaXMgOiBbe2lwOiBcIjIwLjEuMi4zXCIsIGhvc3Q6IFwiY2x1c3Rlci0xXCJ9LHtpcDogXCIyMC4xLjIuNFwiLCBob3N0OiBcImNsdXN0ZXItMlwifV1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlbiBkaXJlY3RpdmUgd2lsbCBiZSA8Y3R2LXRoIHNvcnRmaWVsZD1cIidpcCdcIj4gSXAgQWRkcmVzcyA8L2N0di10aD5cbiAgIFRhYmxlIGNhbiBvbmx5IGJlIHNvcnRlZCBvbiBjb2x1bW5zIHdoaWNoIGhhcyBzb3J0ZmllbGQgYXR0cmlidXRlIHNwZWNlZmllZC5cblxuYykgY3R2VHNlYXJjaCAtXG4gICB1c2FnZSA6IDxjdHYtdHNlYXJjaCBwbGFjZWhvbGRlcj0nU2VhcmNoJyBzaXplPSczMCc+PC9jdHYtdHNlYXJjaD5cbiAgIGF0dHJpYnV0ZSBkZXRhaWxzIDogcGxhY2Vob2xkZXIgLSBzcGVjaWZ5IHRoZSBwbGFjZWhvbGRlciBmb3IgdGhlIGlucHV0IHRleHQgZmllbGRcbiAgICAgICAgICAgICAgICAgICAgICAgc2l6ZSAtIHNwZWNpZnkgdGhlIG1heGltdW0gbGVuZ3RoIG9mIHRoZSBzZWFyY2ggc3RyaW5nXG4gICBPbmx5IGl0ZW1zIG1hdGNoaW5nIHRoZSBzZWFyY2ggc3RyaW5nIGFyZSBkaXNwbGF5ZWQgaW5zaWRlIHRoZSB0YWJsZS5cblxuZCkgY3R2VHBhZ2luYXRpb24gLVxuICAgdXNhZ2UgOiA8Y3R2LXRwYWdpbmF0aW9uPjwvY3R2LXRwYWdpbmF0aW9uPlxuICAgUHJvdmlkZXMgbGluayBmb3IgbW92aW5nIGJhY2sgYW5kIGZvcnRoIG9mIHRoZSByZXN1bHQgcGFnZS5cblxuICovXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5kaXJlY3RpdmVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dlRhYmxlXCIsIFsnZmlsdGVyRmlsdGVyJywgJ2xpbWl0VG9GaWx0ZXInLCBmdW5jdGlvbiAoZmlsdGVyRmlsdGVyLCBsaW1pdFRvRmlsdGVyKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgaXRlbXM6ICc9JyxcbiAgICAgICAgICAgICAgICBmaWx0ZXJlZGl0ZW1zOiAnPScsXG4gICAgICAgICAgICAgICAgc2l6ZTogJ0AnLFxuICAgICAgICAgICAgICAgIGRlZmF1bHRzb3J0Y29sdW1uOiAnQCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjb250cm9sbGVyOiBbJyRzY29wZScsICckZWxlbWVudCcsICckYXR0cnMnLCAnJGZpbHRlcicsIGZ1bmN0aW9uICgkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMsICRmaWx0ZXIpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGFibGVDdHJsID0gdGhpcztcbiAgICAgICAgICAgICAgICB0YWJsZUN0cmwuY2h1bmtzID0gW107XG4gICAgICAgICAgICAgICAgdGFibGVDdHJsLnBhZ2VObyA9IDA7XG4gICAgICAgICAgICAgICAgdGFibGVDdHJsLnNvcnRPYmo9aW5pdGlhbGl6ZVNvcnQoJHNjb3BlLmRlZmF1bHRzb3J0Y29sdW1uKTtcblxuICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zaXplID0gcGFyc2VJbnQoJHNjb3BlLnNpemUsIDEwKTtcbiAgICAgICAgICAgICAgICBpZiAoaXNOYU4odGFibGVDdHJsLnNpemUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zaXplID0gMTI7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogQWx3YXlzIGNhbGwgc2hvd0NodW5rIHdpdGggYm90aCBwYXJhbWV0ZXJzLlxuICAgICAgICAgICAgICAgICAqIEBwYXJhbSBwYWdlTm9cbiAgICAgICAgICAgICAgICAgKiBAcGFyYW0gc2VhcmNoVGV4dFxuICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNob3dDaHVuayhwYWdlTm8sIHNlYXJjaFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNlYXJjaFRleHQgPSBzZWFyY2hUZXh0O1xuICAgICAgICAgICAgICAgICAgICBpZiAocGFnZU5vID09PSB1bmRlZmluZWQgfHwgcGFnZU5vIDwgMCkgcGFnZU5vID0gMDtcbiAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnBhZ2VObyA9IHBhZ2VObztcblxuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLml0ZW1zICE9PSB1bmRlZmluZWQpIHsvL1RPRE86IENoZWNrIHdoeSBpdGVtcyBhcmUgdW5kZWZpbmVkIGR1cmluZyBpbml0aWFsaXphdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlYXJjaFRleHRGaWx0ZXJlZEl0ZW1zID0gZmlsdGVyRmlsdGVyKCRzY29wZS5pdGVtcywgdGFibGVDdHJsLnNlYXJjaFRleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoVGV4dEZpbHRlcmVkSXRlbXMgPSAkZmlsdGVyKCdvcmRlckJ5Jykoc2VhcmNoVGV4dEZpbHRlcmVkSXRlbXMsIHRhYmxlQ3RybC5zb3J0T2JqLmZpZWxkLCB0YWJsZUN0cmwuc29ydE9iai5yZXZlcnNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBub09mQ2h1bmtzID0gTWF0aC5jZWlsKHNlYXJjaFRleHRGaWx0ZXJlZEl0ZW1zLmxlbmd0aCAvIHRhYmxlQ3RybC5zaXplKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub09mQ2h1bmtzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub09mQ2h1bmtzID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5jaHVua3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9PZkNodW5rczsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLmNodW5rcy5wdXNoKHtzZWxlY3RlZDogZmFsc2UsIHBhZ2VObzogaX0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL0FmdGVyIGZpbHRlcmluZyBudW1iZXIgb2YgY2h1bmtzIGNvdWxkIGNoYW5nZSBzbyByZXNldCBwYWdlIG5vIGlmIGl0IGlzIGdyZWF0ZXIgdGhhbiBubyBvZiBjaHVua3NcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYWdlTm8gPj0gdGFibGVDdHJsLmNodW5rcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwucGFnZU5vID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5jaHVua3NbdGFibGVDdHJsLnBhZ2VOb10uc2VsZWN0ZWQgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL1VwZGF0ZSBudW1iZXIgb2YgY2h1bmtzIGZvciBwYWdpbmF0aW9uIG1lbnVcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YWJsZUN0cmwuY2h1bmtzLmxlbmd0aCA+IDUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2xpY2VTdGFydCwgc2xpY2VFbmQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xpY2VTdGFydCA9IHRhYmxlQ3RybC5wYWdlTm8gLSAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsaWNlRW5kID0gdGFibGVDdHJsLnBhZ2VObyArIDM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNsaWNlU3RhcnQgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsaWNlRW5kID0gc2xpY2VFbmQgLSBzbGljZVN0YXJ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbGljZVN0YXJ0ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNsaWNlRW5kID4gdGFibGVDdHJsLmNodW5rcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xpY2VTdGFydCA9IHNsaWNlU3RhcnQgLSAoc2xpY2VFbmQgLSB0YWJsZUN0cmwuY2h1bmtzLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsaWNlRW5kID0gdGFibGVDdHJsLmNodW5rcy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5wYWdpbmF0aW9uTWVudS5jaHVua3MgPSB0YWJsZUN0cmwuY2h1bmtzLnNsaWNlKHNsaWNlU3RhcnQsIHNsaWNlRW5kKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2luYXRpb25NZW51LmNodW5rcyA9IHRhYmxlQ3RybC5jaHVua3M7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5maWx0ZXJlZEl0ZW1zID0gbGltaXRUb0ZpbHRlcihzZWFyY2hUZXh0RmlsdGVyZWRJdGVtcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc2l6ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwucGFnZU5vICogdGFibGVDdHJsLnNpemUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmZpbHRlcmVkaXRlbXM9dGFibGVDdHJsLmZpbHRlcmVkSXRlbXM7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNob3dQcmV2Q2h1bmsoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwcmV2Q2h1bms7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0YWJsZUN0cmwucGFnZU5vIDw9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZDaHVuayA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2Q2h1bmsgPSB0YWJsZUN0cmwucGFnZU5vIC0gMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2hvd0NodW5rKHByZXZDaHVuayk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gc2hvd05leHRDaHVuaygpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5leHRDaHVuaztcbiAgICAgICAgICAgICAgICAgICAgbmV4dENodW5rID0gdGFibGVDdHJsLnBhZ2VObyArIDE7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXh0Q2h1bmsgPiB0YWJsZUN0cmwuY2h1bmtzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHRDaHVuayA9IHRhYmxlQ3RybC5jaHVua3MubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2hvd0NodW5rKG5leHRDaHVuayk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogU2F2ZSBwYWdpbmF0aW9uIHNjb3BlIHRvIHByb3ZpZGUgY2h1bmsgaW5mb3JtYXRpb24gdG8gcGFnaW5hdGlvbiBtZW51LlxuICAgICAgICAgICAgICAgICAqIEBwYXJhbSBtZW51XG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gYWRkUGFnaW5hdGlvbk1lbnUobWVudSkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGFnaW5hdGlvbk1lbnUgPSBtZW51O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGluaXRpYWxpemVTb3J0KHNvcnRmaWVsZCl7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWVsZDpzb3J0ZmllbGQsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXZlcnNlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGljb25EaXJlY3Rpb246IHtcImFuZ2xlIGRvd24gaWNvblwiOiB0cnVlLCBcImFuZ2xlIHVwIGljb25cIjogZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBzb3J0KHNvcnRmaWVsZCl7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzb3J0ZmllbGQgPT0gdGFibGVDdHJsLnNvcnRPYmouZmllbGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNvcnRPYmouZmllbGQgPSBzb3J0ZmllbGQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc29ydE9iai5yZXZlcnNlID0gIXRhYmxlQ3RybC5zb3J0T2JqLnJldmVyc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc29ydE9iai5pY29uRGlyZWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYW5nbGUgZG93biBpY29uXCI6ICF0YWJsZUN0cmwuc29ydE9iai5yZXZlcnNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYW5nbGUgdXAgaWNvblwiOiB0YWJsZUN0cmwuc29ydE9iai5yZXZlcnNlXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zb3J0T2JqID0gaW5pdGlhbGl6ZVNvcnQoc29ydGZpZWxkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc2hvd0NodW5rKHRhYmxlQ3RybC5wYWdlTm8sIHRhYmxlQ3RybC5zZWFyY2hUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseSgpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zaG93Q2h1bmsgPSBzaG93Q2h1bms7XG4gICAgICAgICAgICAgICAgdGFibGVDdHJsLnNob3dOZXh0Q2h1bmsgPSBzaG93TmV4dENodW5rO1xuICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zaG93UHJldkNodW5rID0gc2hvd1ByZXZDaHVuaztcbiAgICAgICAgICAgICAgICB0YWJsZUN0cmwuYWRkUGFnaW5hdGlvbk1lbnUgPSBhZGRQYWdpbmF0aW9uTWVudTtcbiAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc29ydCA9IHNvcnQ7XG4gICAgICAgICAgICB9XSxcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cnMsIHRhYmxlQ3RybCkge1xuICAgICAgICAgICAgICAgIC8vV2F0Y2ggZm9yIGl0ZW1zIGFzIHRoZXkgd2lsbCBiZSBhdXRvIHJlZnJlc2hlZFxuICAgICAgICAgICAgICAgIHNjb3BlLiRwYXJlbnQuJHdhdGNoKGF0dHJzLml0ZW1zLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zaG93Q2h1bmsodGFibGVDdHJsLnBhZ2VObywgdGFibGVDdHJsLnNlYXJjaFRleHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvdGFibGUuaHRtbCdcbiAgICAgICAgfVxuICAgIH1dKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZUaGVhZFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICAgICAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzx0aGVhZCBuZy10cmFuc2NsdWRlPjwvdGhlYWQ+J1xuICAgICAgICB9XG4gICAgfSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2VGhcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXG4gICAgICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICAgICAgcmVxdWlyZTogJ15eY3R2VGFibGUnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBjbGFzczogJ0AnLFxuICAgICAgICAgICAgICAgIHNvcnRmaWVsZDogJz0nXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbGluazpmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMsIHRhYmxlQ3RybCl7XG4gICAgICAgICAgICAgICAgc2NvcGUudGFibGVjdHJsID0gdGFibGVDdHJsO1xuICAgICAgICAgICAgICAgIGlmKHNjb3BlLnNvcnRmaWVsZCAhPSB1bmRlZmluZWQgJiYgc2NvcGUuc29ydGZpZWxkICE9IG51bGwpe1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zb3J0KHNjb3BlLnNvcnRmaWVsZCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy90YWJsZWhlYWRlci5odG1sJ1xuICAgICAgICB9XG4gICAgfSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2VGJvZHlcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHNjb3BlOiB7fSxcbiAgICAgICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXG4gICAgICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8dGJvZHkgbmctdHJhbnNjbHVkZT48L3Rib2R5PidcbiAgICAgICAgfVxuICAgIH0pXG4gICAgLmRpcmVjdGl2ZShcImN0dlRmb290XCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICBzY29wZToge30sXG4gICAgICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPHRmb290IG5nLXRyYW5zY2x1ZGU+PC90Zm9vdD4nXG4gICAgICAgIH1cbiAgICB9KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZUc2VhcmNoXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICByZXF1aXJlOiAnXl5jdHZUYWJsZScsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiAnQCcsXG4gICAgICAgICAgICAgICAgc2l6ZTogJ0AnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRyLCB0YWJsZUN0cmwpIHtcbiAgICAgICAgICAgICAgICBzY29wZS5zaG93Q2h1bmsgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zaG93Q2h1bmsodGFibGVDdHJsLnBhZ2VObywgc2NvcGUuc2VhcmNoVGV4dCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9kaXJlY3RpdmVzL3NlYXJjaGlucHV0Lmh0bWwnXG4gICAgICAgIH1cbiAgICB9KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZUclwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdHJhbnNjbHVkZTogJ3RydWUnLFxuICAgICAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgICAgIHNjb3BlOiB7fSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPHRyIG5nLXRyYW5zY2x1ZGU+PC90cj4nXG4gICAgICAgIH1cbiAgICB9KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZUZFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICAgICAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICAgICAgICBzY29wZTogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPHRkIG5nLXRyYW5zY2x1ZGU+PC90ZD4nXG4gICAgICAgIH1cbiAgICB9KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZUcGFnaW5hdGlvblwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgcmVxdWlyZTogJ15eY3R2VGFibGUnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBjb2xzcGFuOiAnQCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXBsYWNlOnRydWUsXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIHRhYmxlQ3RybCkge1xuICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5hZGRQYWdpbmF0aW9uTWVudShzY29wZSk7XG4gICAgICAgICAgICAgICAgLy9zaG93Q2h1bmsoKSB3aWxsIGNhbGN1bGF0ZSBhbmQgc2V0IGNodW5rcyBpbiBzY29wZVxuICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zaG93Q2h1bmsodGFibGVDdHJsLnBhZ2VObywgdGFibGVDdHJsLnNlYXJjaFRleHQpO1xuICAgICAgICAgICAgICAgIHNjb3BlLnNob3dDaHVuayA9IGZ1bmN0aW9uIChwYWdlTm8pIHtcbiAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNob3dDaHVuayhwYWdlTm8sIHRhYmxlQ3RybC5zZWFyY2hUZXh0KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHNjb3BlLnNob3dQcmV2Q2h1bmsgPSB0YWJsZUN0cmwuc2hvd1ByZXZDaHVuaztcbiAgICAgICAgICAgICAgICBzY29wZS5zaG93TmV4dENodW5rID0gdGFibGVDdHJsLnNob3dOZXh0Q2h1bms7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvcGFnaW5hdGlvbm1lbnUuaHRtbCdcbiAgICAgICAgfVxuICAgIH0pO1xuXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMTEvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubW9kZWxzJylcbiAgICAuZmFjdG9yeSgnQXBwbGljYXRpb25Hcm91cHNNb2RlbCcsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbiAoJGh0dHAsICRxKSB7XG4gICAgICAgIHZhciBncm91cHNtb2RlbCA9IG5ldyBDb2xsZWN0aW9uKCRodHRwLCAkcSwgQ29udGl2R2xvYmFscy5BUFBMSUNBVElPTkdST1VQU19FTkRQT0lOVCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdlbmVyYXRlIGtleSBmb3IgYXBwbGljYXRpb24gZ3JvdXBcbiAgICAgICAgICogQHBhcmFtIGdyb3VwXG4gICAgICAgICAqL1xuICAgICAgICBncm91cHNtb2RlbC5nZW5lcmF0ZUtleSA9IGZ1bmN0aW9uIChncm91cCkge1xuICAgICAgICAgICAgcmV0dXJuIGdyb3VwLnRlbmFudE5hbWUgKyAnOicgKyBncm91cC5ncm91cE5hbWU7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGdyb3Vwc21vZGVsO1xuICAgIH1dKTtcbi8qKlxuICogQmFzZUNvbGxlY3Rpb24gY2xhc3MgdGhhdCBkb2VzIGp1c3QgZmV0Y2ggb2YgdGhlIG9iamVjdHMuXG4gKiBAcGFyYW0gJGh0dHBcbiAqIEBwYXJhbSAkcVxuICogQHBhcmFtIHVybCBVc2VkIGZvciBkb2luZyBIVFRQIEdFVCBhbmQgZmV0Y2ggb2JqZWN0cyBmcm9tIHNlcnZlclxuICogQGNvbnN0cnVjdG9yXG4gKi9cbmZ1bmN0aW9uIEJhc2VDb2xsZWN0aW9uKCRodHRwLCAkcSwgdXJsKSB7XG4gICAgdGhpcy5tb2RlbHMgPSBbXTtcbiAgICB0aGlzLiRodHRwID0gJGh0dHA7XG4gICAgdGhpcy4kcSA9ICRxO1xuICAgIHRoaXMudXJsID0gdXJsO1xufVxuXG5CYXNlQ29sbGVjdGlvbi5wcm90b3R5cGUuZXh0cmFjdCA9IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICByZXR1cm4gcmVzdWx0LmRhdGE7XG59O1xuXG4vKipcbiAqXG4gKiBAcGFyYW0gcmVsb2FkIE9wdGlvbmFsLiBEZWZhdWx0IGlzIGZhbHNlXG4gKiBAcmV0dXJucyB7Kn1cbiAqL1xuQmFzZUNvbGxlY3Rpb24ucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChyZWxvYWQpIHtcbiAgICB2YXIgY29sbGVjdGlvbiA9IHRoaXM7XG4gICAgaWYgKHJlbG9hZCA9PT0gdW5kZWZpbmVkKSByZWxvYWQgPSBmYWxzZTtcbiAgICByZXR1cm4gKCFyZWxvYWQgJiYgY29sbGVjdGlvbi5tb2RlbHMubGVuZ3RoID4gMCkgP1xuICAgICAgICBjb2xsZWN0aW9uLiRxLndoZW4oY29sbGVjdGlvbi5tb2RlbHMpIDogY29sbGVjdGlvbi4kaHR0cC5nZXQoY29sbGVjdGlvbi51cmwpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgIGNvbGxlY3Rpb24ubW9kZWxzID0gY29sbGVjdGlvbi5leHRyYWN0KHJlc3VsdCk7XG4gICAgICAgICAgICByZXR1cm4gY29sbGVjdGlvbi5tb2RlbHM7XG4gICAgICAgIH0pO1xufTtcblxuLyoqXG4gKlxuICogQHBhcmFtIGtleVxuICogQHBhcmFtIHJlbG9hZCBPcHRpb25hbC4gRGVmYXVsdCBpcyBmYWxzZVxuICogQHBhcmFtIGtleW5hbWVcbiAqIEByZXR1cm5zIHsqfVxuICovXG5CYXNlQ29sbGVjdGlvbi5wcm90b3R5cGUuZ2V0TW9kZWxCeUtleSA9IGZ1bmN0aW9uIChrZXksIHJlbG9hZCwga2V5bmFtZSkge1xuICAgIHZhciBjb2xsZWN0aW9uID0gdGhpcztcbiAgICBpZiAocmVsb2FkID09PSB1bmRlZmluZWQpIHJlbG9hZCA9IGZhbHNlO1xuICAgIGlmIChrZXluYW1lID09PSB1bmRlZmluZWQpIGtleW5hbWUgPSAna2V5JztcblxuICAgIHZhciBkZWZlcnJlZCA9IGNvbGxlY3Rpb24uJHEuZGVmZXIoKTtcblxuICAgIGZ1bmN0aW9uIGZpbmRNb2RlbCgpIHtcbiAgICAgICAgcmV0dXJuIF8uZmluZChjb2xsZWN0aW9uLm1vZGVscywgZnVuY3Rpb24gKGMpIHtcbiAgICAgICAgICAgIHJldHVybiBjW2tleW5hbWVdID09IGtleTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBpZiAoIXJlbG9hZCAmJiBjb2xsZWN0aW9uLm1vZGVscy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGRlZmVycmVkLnJlc29sdmUoZmluZE1vZGVsKCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbGxlY3Rpb24uZ2V0KHJlbG9hZClcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGZpbmRNb2RlbCgpKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xufTtcblxuLyoqXG4gKlxuICogQHBhcmFtIG1vZGVsXG4gKiBAcGFyYW0gcmVsb2FkIE9wdGlvbmFsLiBEZWZhdWx0IGlzIGZhbHNlXG4gKiBAcmV0dXJucyB7Kn1cbiAqL1xuQmFzZUNvbGxlY3Rpb24ucHJvdG90eXBlLmdldE1vZGVsID0gZnVuY3Rpb24gKG1vZGVsLCByZWxvYWQpIHtcbiAgICB2YXIgY29sbGVjdGlvbiA9IHRoaXM7XG4gICAgaWYgKHJlbG9hZCA9PT0gdW5kZWZpbmVkKSByZWxvYWQgPSBmYWxzZTtcblxuICAgIHZhciBkZWZlcnJlZCA9IGNvbGxlY3Rpb24uJHEuZGVmZXIoKTtcblxuICAgIGZ1bmN0aW9uIGZpbmRNb2RlbCgpIHtcbiAgICAgICAgcmV0dXJuIF8uZmluZChjb2xsZWN0aW9uLm1vZGVscywgbW9kZWwpXG4gICAgfVxuXG4gICAgaWYgKCFyZWxvYWQgJiYgY29sbGVjdGlvbi5tb2RlbHMubGVuZ3RoID4gMCkge1xuICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGZpbmRNb2RlbCgpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb2xsZWN0aW9uLmdldChyZWxvYWQpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShmaW5kTW9kZWwoKSk7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbn07XG5cblxuLyoqXG4gKiBFeHRlbmRzIEJhc2VDb2xsZWN0aW9uIGNsYXNzIHRvIGRvIGNyZWF0ZSwgdXBkYXRlIGFuZCBkZWxldGUgdXNpbmcgUE9TVCwgUFVUIGFuZCBERUxFVEUgdmVyYnMuXG4gKiBAcGFyYW0gJGh0dHBcbiAqIEBwYXJhbSAkcVxuICogQHBhcmFtIHVybCBVc2VkIGZvciBkb2luZyBIVFRQIEdFVCBhbmQgZmV0Y2ggb2JqZWN0cyBmcm9tIHNlcnZlclxuICogQGNvbnN0cnVjdG9yXG4gKi9cbmZ1bmN0aW9uIENvbGxlY3Rpb24oJGh0dHAsICRxLCB1cmwpIHtcbiAgICBCYXNlQ29sbGVjdGlvbi5jYWxsKHRoaXMsICRodHRwLCAkcSwgdXJsKTtcbiAgICB0aGlzLmluc3BlY3RTdGF0cyA9IHt9O1xufVxuXG5Db2xsZWN0aW9uLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoQmFzZUNvbGxlY3Rpb24ucHJvdG90eXBlKTtcblxuLyoqXG4gKlxuICogQHBhcmFtIG1vZGVsXG4gKiBAcGFyYW0gdXJsIE9wdGlvbmFsIGlmIG5vdCBwYXNzZWQgaXQgaXMgY29uc3RydWN0ZWQgdXNpbmcga2V5IGFuZCB1cmwgcGFzc2VkIGluIGNvbnN0cnVjdG9yXG4gKiBAcmV0dXJucyB7Kn1cbiAqL1xuQ29sbGVjdGlvbi5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24gKG1vZGVsLCB1cmwpIHtcbiAgICB2YXIgY29sbGVjdGlvbiA9IHRoaXM7XG4gICAgdmFyIGRlZmVycmVkID0gY29sbGVjdGlvbi4kcS5kZWZlcigpO1xuICAgIFxuICAgIGlmICh1cmwgPT09IHVuZGVmaW5lZCkgdXJsID0gY29sbGVjdGlvbi51cmwgKyBtb2RlbC5rZXkgKyAnLyc7XG4gICAgY29sbGVjdGlvbi4kaHR0cC5wb3N0KHVybCwgbW9kZWwpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgICAgdmFyIHJlc3BvbnNlRGF0YSA9IGNvbGxlY3Rpb24uZXh0cmFjdChyZXNwb25zZSk7XG4gICAgICAgICAgICAvL0ZvciByZXN0IGVuZHBvaW50cyB0aGF0IGRvIG5vdCByZXR1cm4gY3JlYXRlZCBqc29uIG9iamVjdCBpbiByZXNwb25zZVxuICAgICAgICAgICAgaWYgKChyZXNwb25zZURhdGEgPT09IHVuZGVmaW5lZCkgfHwgKHJlc3BvbnNlRGF0YSA9PT0gJycpKSB7XG4gICAgICAgICAgICAgICAgcmVzcG9uc2VEYXRhID0gbW9kZWw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL2NvbGxlY3Rpb24ubW9kZWxzLnB1c2goY29sbGVjdGlvbi5leHRyYWN0KHJlc3BvbnNlKSk7XG4gICAgICAgICAgICBjb2xsZWN0aW9uLm1vZGVscy5wdXNoKHJlc3BvbnNlRGF0YSk7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGNvbGxlY3Rpb24uZXh0cmFjdChyZXNwb25zZSkpO1xuICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoY29sbGVjdGlvbi5leHRyYWN0KHJlc3BvbnNlKSk7XG4gICAgICAgIH0pO1xuICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xufTtcblxuLyoqXG4gKiBUaGlzIGlzIGZvciBuZXRtYXN0ZXIgc3BlY2lmaWMgZW5kcG9pbnRzIGFuZCB1c2VkIGJ5IG5ldG1hc3RlciBvYmplY3RzIG9ubHkuXG4gKiBUT0RPOiBHZW5lcmFsaXplXG4gKiBAcGFyYW0gbW9kZWxcbiAqIEBwYXJhbSB1cmwgT3B0aW9uYWxcbiAqIEByZXR1cm5zIHsqfVxuICovXG5Db2xsZWN0aW9uLnByb3RvdHlwZS5zYXZlID0gZnVuY3Rpb24gKG1vZGVsKSB7XG4gICAgdmFyIGNvbGxlY3Rpb24gPSB0aGlzO1xuICAgIHZhciBkZWZlcnJlZCA9IGNvbGxlY3Rpb24uJHEuZGVmZXIoKTtcbiAgICB2YXIgdXJsID0gY29sbGVjdGlvbi51cmwgKyBtb2RlbC5rZXkgKyAnLyc7XG4gICAgY29sbGVjdGlvbi4kaHR0cC5wdXQodXJsLCBtb2RlbClcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBfLnJlbW92ZShjb2xsZWN0aW9uLm1vZGVscywgZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbi5rZXkgPT0gbW9kZWwua2V5O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb2xsZWN0aW9uLm1vZGVscy5wdXNoKGNvbGxlY3Rpb24uZXh0cmFjdChyZXNwb25zZSkpO1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShjb2xsZWN0aW9uLmV4dHJhY3QocmVzcG9uc2UpKTtcbiAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGNvbGxlY3Rpb24uZXh0cmFjdChyZXNwb25zZSkpO1xuICAgICAgICB9KTtcbiAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbn07XG5cbi8qKlxuICogVGhpcyBpcyBmb3IgbmV0bWFzdGVyIHNwZWNpZmljIGVuZHBvaW50cyBhbmQgdXNlZCBieSBuZXRtYXN0ZXIgb2JqZWN0cyBvbmx5LlxuICogVE9ETzogR2VuZXJhbGl6ZVxuICogQHBhcmFtIG1vZGVsXG4gKiBAcmV0dXJucyB7Kn1cbiAqL1xuQ29sbGVjdGlvbi5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKG1vZGVsKSB7XG4gICAgdmFyIGNvbGxlY3Rpb24gPSB0aGlzO1xuICAgIHZhciBkZWZlcnJlZCA9IGNvbGxlY3Rpb24uJHEuZGVmZXIoKTtcbiAgICB2YXIgdXJsID0gY29sbGVjdGlvbi51cmwgKyBtb2RlbC5rZXkgKyAnLyc7XG4gICAgY29sbGVjdGlvbi4kaHR0cC5kZWxldGUodXJsKVxuICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgICAgIF8ucmVtb3ZlKGNvbGxlY3Rpb24ubW9kZWxzLCBmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgICAgIHJldHVybiBuLmtleSA9PSBtb2RlbC5rZXk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoY29sbGVjdGlvbi5leHRyYWN0KHJlc3BvbnNlKSk7XG4gICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChjb2xsZWN0aW9uLmV4dHJhY3QocmVzcG9uc2UpKTtcbiAgICAgICAgfSk7XG4gICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG59O1xuXG4vKipcbiAqXG4gKiBAcGFyYW0ga2V5XG4gKiBAcGFyYW0ga2V5bmFtZVxuICogQHBhcmFtIHVybCBPcHRpb25hbCBpZiBub3QgcGFzc2VkIGl0IGlzIGNvbnN0cnVjdGVkIHVzaW5nIGtleSBhbmQgdXJsIHBhc3NlZCBpbiBjb25zdHJ1Y3RvclxuICogQHJldHVybnMgeyp9XG4gKi9cbkNvbGxlY3Rpb24ucHJvdG90eXBlLmRlbGV0ZVVzaW5nS2V5ID0gZnVuY3Rpb24gKGtleSwga2V5bmFtZSwgdXJsKSB7XG4gICAgdmFyIGNvbGxlY3Rpb24gPSB0aGlzO1xuICAgIGlmIChrZXluYW1lID09PSB1bmRlZmluZWQpIGtleW5hbWUgPSAna2V5JztcblxuICAgIHZhciBkZWZlcnJlZCA9IGNvbGxlY3Rpb24uJHEuZGVmZXIoKTtcbiAgICBpZiAodXJsID09PSB1bmRlZmluZWQpIHVybCA9IGNvbGxlY3Rpb24udXJsICsga2V5ICsgJy8nO1xuICAgIGNvbGxlY3Rpb24uJGh0dHAuZGVsZXRlKHVybClcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBfLnJlbW92ZShjb2xsZWN0aW9uLm1vZGVscywgZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbltrZXluYW1lXSA9PSBrZXk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoY29sbGVjdGlvbi5leHRyYWN0KHJlc3BvbnNlKSk7XG4gICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChjb2xsZWN0aW9uLmV4dHJhY3QocmVzcG9uc2UpKTtcbiAgICAgICAgfSk7XG4gICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG59O1xuXG5cbkNvbGxlY3Rpb24ucHJvdG90eXBlLmdldEluc3BlY3RCeUtleSA9IGZ1bmN0aW9uKGtleSwgdXJsLCByZWZyZXNoKXtcbiAgICB2YXIgY29sbGVjdGlvbiA9IHRoaXM7XG4gICAgdmFyIGRlZmVycmVkID0gY29sbGVjdGlvbi4kcS5kZWZlcigpO1xuICAgIGlmKGtleSBpbiBjb2xsZWN0aW9uLmluc3BlY3RTdGF0cyAmJiByZWZyZXNoID09IGZhbHNlKXtcbiAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShjb2xsZWN0aW9uLmluc3BlY3RTdGF0c1trZXldKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGNvbGxlY3Rpb24uJGh0dHAuZ2V0KHVybCArIGtleSArICcvJylcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcG9uc2VTdGF0cyA9IGNvbGxlY3Rpb24uZXh0cmFjdChyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24uaW5zcGVjdFN0YXRzW2tleV0gPSByZXNwb25zZVN0YXRzXG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzcG9uc2VTdGF0cyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbn07XG4vKipcbiAqIENyZWF0ZWQgYnkgaGFyZGlrIGdhbmRoaSBvbiA2LzE1LzE2LlxuICovXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubW9kZWxzJylcbiAgICAuZmFjdG9yeSgnTmV0cHJvZmlsZXNNb2RlbCcsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbiAoJGh0dHAsICRxKSB7XG4gICAgICAgIHZhciBuZXRwcm9maWxlc01vZGVsID0gbmV3IENvbGxlY3Rpb24oJGh0dHAsICRxLCBDb250aXZHbG9iYWxzLk5FVFBST0ZJTEVTX0VORFBPSU5UKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogR2VuZXJhdGUgcG9saWN5IGtleSB0byBzYXZlIHBvbGljeSBvbiBzZXJ2ZXJcbiAgICAgICAgICogQHBhcmFtIHBvbGljeVxuICAgICAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgICAgICAgKi9cbiAgICAgICAgbmV0cHJvZmlsZXNNb2RlbC5nZW5lcmF0ZUtleSA9IGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgIHJldHVybiBwb2xpY3kudGVuYW50TmFtZSArICc6JyArIHBvbGljeS5wcm9maWxlTmFtZTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gbmV0cHJvZmlsZXNNb2RlbDtcbiAgICB9XSk7XG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubW9kZWxzJylcbiAgICAuZmFjdG9yeSgnTmV0d29ya3NNb2RlbCcsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbiAoJGh0dHAsICRxKSB7XG4gICAgICAgIHJldHVybiBuZXcgQ29sbGVjdGlvbigkaHR0cCwgJHEsIENvbnRpdkdsb2JhbHMuTkVUV09SS1NfRU5EUE9JTlQpO1xuICAgIH1dKTtcblxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzIyLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm1vZGVscycpXG4gICAgLmZhY3RvcnkoJ05vZGVzTW9kZWwnLCBbJyRodHRwJywgJyRxJywgZnVuY3Rpb24gKCRodHRwLCAkcSkge1xuICAgICAgICAvKipcbiAgICAgICAgICogTm9kZXNDb2xsZWN0aW9uIGV4dGVuZHMgZnJvbSBCYXNlQ29sbGVjdGlvbi4gSXQgb3ZlcnJpZGVzIGV4dHJhY3QoKSBhbmQgYWRkcyBjb21taXNzaW9uLCBkZWNvbW1pc3Npb24sIHVwZ3JhZGUgYW5kXG4gICAgICAgICAqIGRpc2NvdmVyIG1ldGhvZHNcbiAgICAgICAgICogQHBhcmFtICRodHRwXG4gICAgICAgICAqIEBwYXJhbSAkcVxuICAgICAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIE5vZGVzQ29sbGVjdGlvbigkaHR0cCwgJHEpIHtcbiAgICAgICAgICAgIEJhc2VDb2xsZWN0aW9uLmNhbGwodGhpcywgJGh0dHAsICRxLCBDb250aXZHbG9iYWxzLk5PREVTX0xJU1RfRU5EUE9JTlQpO1xuICAgICAgICB9XG5cbiAgICAgICAgTm9kZXNDb2xsZWN0aW9uLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoQmFzZUNvbGxlY3Rpb24ucHJvdG90eXBlKTtcblxuICAgICAgICBOb2Rlc0NvbGxlY3Rpb24ucHJvdG90eXBlLmV4dHJhY3QgPSBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAvL0NvbnZlcnQgdG8gYXJyYXkgaWYgdGhlIHJldHVybmVkIGNvbGxlY3Rpb24gaXMgbm90IGFuIGFycmF5XG4gICAgICAgICAgICByZXR1cm4gXy5tYXAocmVzdWx0LmRhdGEsIGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7XG4gICAgICAgICAgICAgICAgdmFsdWUua2V5ID0ga2V5O1xuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSBrZXlcbiAgICAgICAgICogQHBhcmFtIGV4dHJhVmFycyBKU09OIG9iamVjdCBvZiBleHRyYSBhbnNpYmxlIGFuZCBlbnZpcm9ubWVudCB2YXJpYWJsZXMgdG8gYmUgcGFzc2VkIHdoaWxlIGNvbW1pc3Npb25pbmcgYSBub2RlXG4gICAgICAgICAqIHtcbiAgICAgICAgICAgICAqIFwiZW52XCI6e1wiaHR0cF9wcm94eVwiOlwiaHR0cDovL3Byb3h5LmVzbC5jaXNjby5jb206ODA4MFwiLCBcImh0dHBzX3Byb3h5XCI6XCJodHRwOi8vcHJveHkuZXNsLmNpc2NvLmNvbTo4MDgwXCJ9LFxuICAgICAgICAgICAgICogXCJjb250cm9sX2ludGVyZmFjZVwiOiBcImV0aDFcIiwgXCJzZXJ2aWNlX3ZpcFwiOiBcIjE5Mi4xNjguMi4yNTJcIiwgXCJ2YWxpZGF0ZV9jZXJ0c1wiOiBcImZhbHNlXCIsIFwibmV0cGx1Z2luX2lmXCIgOiBcImV0aDJcIlxuICAgICAgICAgICAgICogfVxuICAgICAgICAgKiBAcmV0dXJucyB7Kn1cbiAgICAgICAgICovXG4gICAgICAgIE5vZGVzQ29sbGVjdGlvbi5wcm90b3R5cGUuY29tbWlzc2lvbiA9IGZ1bmN0aW9uIChub2RlT3BzT2JqKSB7XG4gICAgICAgICAgICB2YXIgbm9kZXNjb2xsZWN0aW9uID0gdGhpcztcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9IG5vZGVzY29sbGVjdGlvbi4kcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuTk9ERVNfQ09NTUlTU0lPTl9FTkRQT0lOVDtcbiAgICAgICAgICAgIG5vZGVzY29sbGVjdGlvbi4kaHR0cC5wb3N0KHVybCwgbm9kZU9wc09iaiwge1xuICAgICAgICAgICAgICAgICAgICAnaGVhZGVycyc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vU2VydmVyIGRvZXNuJ3QgcmV0dXJuIGFueSBqc29uIGluIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfTtcblxuICAgICAgICBOb2Rlc0NvbGxlY3Rpb24ucHJvdG90eXBlLmRlY29tbWlzc2lvbiA9IGZ1bmN0aW9uIChub2RlT3BzT2JqKSB7XG4gICAgICAgICAgICB2YXIgbm9kZXNjb2xsZWN0aW9uID0gdGhpcztcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9IG5vZGVzY29sbGVjdGlvbi4kcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuTk9ERVNfREVDT01NSVNTSU9OX0VORFBPSU5UO1xuICAgICAgICAgICAgbm9kZXNjb2xsZWN0aW9uLiRodHRwLnBvc3QodXJsLCBub2RlT3BzT2JqLCB7XG4gICAgICAgICAgICAgICAgICAgICdoZWFkZXJzJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9O1xuXG4gICAgICAgIE5vZGVzQ29sbGVjdGlvbi5wcm90b3R5cGUudXBncmFkZSA9IGZ1bmN0aW9uIChub2RlT3BzT2JqKSB7XG4gICAgICAgICAgICB2YXIgbm9kZXNjb2xsZWN0aW9uID0gdGhpcztcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9IG5vZGVzY29sbGVjdGlvbi4kcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuTk9ERVNfTUFJTlRFTkFOQ0VfRU5EUE9JTlQ7XG4gICAgICAgICAgICBub2Rlc2NvbGxlY3Rpb24uJGh0dHAucG9zdCh1cmwsIG5vZGVPcHNPYmosIHtcbiAgICAgICAgICAgICAgICAgICAgJ2hlYWRlcnMnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSBpcFxuICAgICAgICAgKiBAcGFyYW0gZXh0cmFWYXJzIEpTT04gb2JqZWN0IG9mIGV4dHJhIGFuc2libGUgYW5kIGVudmlyb25tZW50IHZhcmlhYmxlcyB0byBiZSBwYXNzZWQgd2hpbGUgZGlzY292ZXJpbmcgYSBub2RlXG4gICAgICAgICAqIHtcbiAgICAgICAgICAgICAqIFwiZW52XCI6e1wiaHR0cF9wcm94eVwiOlwiaHR0cDovL3Byb3h5LmVzbC5jaXNjby5jb206ODA4MFwiLCBcImh0dHBzX3Byb3h5XCI6XCJodHRwOi8vcHJveHkuZXNsLmNpc2NvLmNvbTo4MDgwXCJ9LFxuICAgICAgICAgICAgICogXCJjb250cm9sX2ludGVyZmFjZVwiOiBcImV0aDFcIiwgXCJzZXJ2aWNlX3ZpcFwiOiBcIjE5Mi4xNjguMi4yNTJcIiwgXCJjbHVzdGVyLW5hbWVcIjogXCJjb250aXZcIiwgXCJub2RlLWxhYmVsXCIgOiBcIm5vZGUxXCJcbiAgICAgICAgICAgICAqIH1cbiAgICAgICAgICogQHJldHVybnMgeyp9XG4gICAgICAgICAqL1xuICAgICAgICBOb2Rlc0NvbGxlY3Rpb24ucHJvdG90eXBlLmRpc2NvdmVyID0gZnVuY3Rpb24gKG5vZGVPcHNPYmopIHtcbiAgICAgICAgICAgIHZhciBub2Rlc2NvbGxlY3Rpb24gPSB0aGlzO1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gbm9kZXNjb2xsZWN0aW9uLiRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5OT0RFU19ESVNDT1ZFUl9FTkRQT0lOVDtcbiAgICAgICAgICAgIG5vZGVzY29sbGVjdGlvbi4kaHR0cC5wb3N0KHVybCwgbm9kZU9wc09iaiwge1xuICAgICAgICAgICAgICAgICAgICAnaGVhZGVycyc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIG5vZGVzbW9kZWwgPSBuZXcgTm9kZXNDb2xsZWN0aW9uKCRodHRwLCAkcSk7XG4gICAgICAgIHJldHVybiBub2Rlc21vZGVsO1xuICAgIH1dKTtcblxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5tb2RlbHMnKVxuICAgIC5mYWN0b3J5KCdPcmdhbml6YXRpb25zTW9kZWwnLCBbJyRodHRwJywgJyRxJywgZnVuY3Rpb24gKCRodHRwLCAkcSkge1xuICAgICAgICByZXR1cm4gbmV3IENvbGxlY3Rpb24oJGh0dHAsICRxLCBDb250aXZHbG9iYWxzLk9SR0FOSVpBVElPTlNfRU5EUE9JTlQpO1xuICAgIH1dKTtcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubW9kZWxzJylcbiAgICAuZmFjdG9yeSgnUG9saWNpZXNNb2RlbCcsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbiAoJGh0dHAsICRxKSB7XG4gICAgICAgIHZhciBwb2xpY2llc21vZGVsID0gbmV3IENvbGxlY3Rpb24oJGh0dHAsICRxLCBDb250aXZHbG9iYWxzLlBPTElDSUVTX0VORFBPSU5UKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogR2VuZXJhdGUgcG9saWN5IGtleSB0byBzYXZlIHBvbGljeSBvbiBzZXJ2ZXJcbiAgICAgICAgICogQHBhcmFtIHBvbGljeVxuICAgICAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgICAgICAgKi9cbiAgICAgICAgcG9saWNpZXNtb2RlbC5nZW5lcmF0ZUtleSA9IGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgIHJldHVybiBwb2xpY3kudGVuYW50TmFtZSArICc6JyArIHBvbGljeS5wb2xpY3lOYW1lO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBwb2xpY2llc21vZGVsO1xuICAgIH1dKTtcblxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubW9kZWxzJylcbiAgICAuZmFjdG9yeSgnUnVsZXNNb2RlbCcsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbiAoJGh0dHAsICRxKSB7XG4gICAgICAgIHZhciBydWxlc21vZGVsID0gbmV3IENvbGxlY3Rpb24oJGh0dHAsICRxLCBDb250aXZHbG9iYWxzLlJVTEVTX0VORFBPSU5UKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IGluY29taW5nIHJ1bGVzIGZvciBhIGdpdmVuIHBvbGljeSBhbmQgYSB0ZW5hbnRcbiAgICAgICAgICogQHBhcmFtIHBvbGljeU5hbWVcbiAgICAgICAgICogQHBhcmFtIHRlbmFudE5hbWVcbiAgICAgICAgICogQHJldHVybnMgeyp8d2ViZHJpdmVyLnByb21pc2UuUHJvbWlzZX1cbiAgICAgICAgICovXG4gICAgICAgIHJ1bGVzbW9kZWwuZ2V0SW5jb21pbmdSdWxlcyA9IGZ1bmN0aW9uIChwb2xpY3lOYW1lLCB0ZW5hbnROYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gcnVsZXNtb2RlbC5nZXQoKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5maWx0ZXIocmVzdWx0LCB7XG4gICAgICAgICAgICAgICAgICAgICdwb2xpY3lOYW1lJzogcG9saWN5TmFtZSxcbiAgICAgICAgICAgICAgICAgICAgJ2RpcmVjdGlvbic6ICdpbicsXG4gICAgICAgICAgICAgICAgICAgICd0ZW5hbnROYW1lJzogdGVuYW50TmFtZVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IG91dGdvaW5nIHJ1bGVzIGZvciBhIGdpdmVuIHBvbGljeSBhbmQgYSB0ZW5hbnRcbiAgICAgICAgICogQHBhcmFtIHBvbGljeU5hbWVcbiAgICAgICAgICogQHBhcmFtIHRlbmFudE5hbWVcbiAgICAgICAgICogQHJldHVybnMgeyp8d2ViZHJpdmVyLnByb21pc2UuUHJvbWlzZX1cbiAgICAgICAgICovXG4gICAgICAgIHJ1bGVzbW9kZWwuZ2V0T3V0Z29pbmdSdWxlcyA9IGZ1bmN0aW9uIChwb2xpY3lOYW1lLCB0ZW5hbnROYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gcnVsZXNtb2RlbC5nZXQoKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5maWx0ZXIocmVzdWx0LCB7XG4gICAgICAgICAgICAgICAgICAgICdwb2xpY3lOYW1lJzogcG9saWN5TmFtZSxcbiAgICAgICAgICAgICAgICAgICAgJ2RpcmVjdGlvbic6ICdvdXQnLFxuICAgICAgICAgICAgICAgICAgICAndGVuYW50TmFtZSc6IHRlbmFudE5hbWVcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdlbmVyYXRlIHJ1bGUga2V5IHRvIHNhdmUgcnVsZSBvbiBzZXJ2ZXJcbiAgICAgICAgICogQHBhcmFtIHJ1bGVcbiAgICAgICAgICogQHJldHVybnMge3N0cmluZ31cbiAgICAgICAgICovXG4gICAgICAgIHJ1bGVzbW9kZWwuZ2VuZXJhdGVLZXkgPSBmdW5jdGlvbiAocnVsZSkge1xuICAgICAgICAgICAgcmV0dXJuIHJ1bGUudGVuYW50TmFtZSArICc6JyArIHJ1bGUucG9saWN5TmFtZSArICc6JyArIHJ1bGUucnVsZUlkO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBydWxlc21vZGVsO1xuICAgIH1dKTtcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xMS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5tb2RlbHMnKVxuICAgIC5mYWN0b3J5KCdTZXJ2aWNlbGJzTW9kZWwnLCBbJyRodHRwJywgJyRxJywgZnVuY3Rpb24gKCRodHRwLCAkcSkge1xuICAgICAgICByZXR1cm4gbmV3IENvbGxlY3Rpb24oJGh0dHAsICRxLCBDb250aXZHbG9iYWxzLlNFUlZJQ0VMQlNfRU5EUE9JTlQpO1xuICAgIH1dKTtcblxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA0LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm1vZGVscycpXG4gICAgLmZhY3RvcnkoJ1N0b3JhZ2VQb2xpY2llc01vZGVsJywgWyckaHR0cCcsICckcScsIGZ1bmN0aW9uICgkaHR0cCwgJHEpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFN0b3JhZ2VQb2xpY2llc0NvbGxlY3Rpb24gZXh0ZW5kcyBmcm9tIEJhc2VDb2xsZWN0aW9uXG4gICAgICAgICAqIEBwYXJhbSAkaHR0cFxuICAgICAgICAgKiBAcGFyYW0gJHFcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBTdG9yYWdlUG9saWNpZXNDb2xsZWN0aW9uKCRodHRwLCAkcSkge1xuICAgICAgICAgICAgQ29sbGVjdGlvbi5jYWxsKHRoaXMsICRodHRwLCAkcSwgQ29udGl2R2xvYmFscy5TVE9SQUdFUE9MSUNJRVNfRU5EUE9JTlQpO1xuICAgICAgICB9XG5cbiAgICAgICAgU3RvcmFnZVBvbGljaWVzQ29sbGVjdGlvbi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKENvbGxlY3Rpb24ucHJvdG90eXBlKTtcblxuICAgICAgICBTdG9yYWdlUG9saWNpZXNDb2xsZWN0aW9uLnByb3RvdHlwZS5jcmVhdGUgPSBmdW5jdGlvbiAobW9kZWwpIHtcbiAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gdGhpcztcbiAgICAgICAgICAgIHZhciB1cmwgPSBjb2xsZWN0aW9uLnVybCArIG1vZGVsLm5hbWU7XG4gICAgICAgICAgICByZXR1cm4gQ29sbGVjdGlvbi5wcm90b3R5cGUuY3JlYXRlLmNhbGwoY29sbGVjdGlvbiwgbW9kZWwsIHVybCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgU3RvcmFnZVBvbGljaWVzQ29sbGVjdGlvbi5wcm90b3R5cGUuc2F2ZSA9IGZ1bmN0aW9uIChtb2RlbCkge1xuICAgICAgICAgICAgdmFyIGNvbGxlY3Rpb24gPSB0aGlzO1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gY29sbGVjdGlvbi4kcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IGNvbGxlY3Rpb24udXJsICsgbW9kZWwubmFtZTtcbiAgICAgICAgICAgIGNvbGxlY3Rpb24uJGh0dHAucG9zdCh1cmwsIG1vZGVsKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICBfLnJlbW92ZShjb2xsZWN0aW9uLm1vZGVscywgZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuLm5hbWUgPT0gbW9kZWwubmFtZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24ubW9kZWxzLnB1c2gobW9kZWwpO1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGNvbGxlY3Rpb24uZXh0cmFjdChyZXNwb25zZSkpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGNvbGxlY3Rpb24uZXh0cmFjdChyZXNwb25zZSkpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBwb2xpY2llc21vZGVsID0gbmV3IFN0b3JhZ2VQb2xpY2llc0NvbGxlY3Rpb24oJGh0dHAsICRxKTtcbiAgICAgICAgcmV0dXJuIHBvbGljaWVzbW9kZWw7XG4gICAgfV0pO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzIyLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm1vZGVscycpXG4gICAgLmZhY3RvcnkoJ1ZvbHVtZXNNb2RlbCcsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbiAoJGh0dHAsICRxKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBWb2x1bWVzQ29sbGVjdGlvbiBleHRlbmRzIGZyb20gQmFzZUNvbGxlY3Rpb25cbiAgICAgICAgICogQHBhcmFtICRodHRwXG4gICAgICAgICAqIEBwYXJhbSAkcVxuICAgICAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIFZvbHVtZXNDb2xsZWN0aW9uKCRodHRwLCAkcSkge1xuICAgICAgICAgICAgQ29sbGVjdGlvbi5jYWxsKHRoaXMsICRodHRwLCAkcSwgQ29udGl2R2xvYmFscy5WT0xVTUVTX0VORFBPSU5UKTtcbiAgICAgICAgfVxuXG4gICAgICAgIFZvbHVtZXNDb2xsZWN0aW9uLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoQ29sbGVjdGlvbi5wcm90b3R5cGUpO1xuXG4gICAgICAgIFZvbHVtZXNDb2xsZWN0aW9uLnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiAobW9kZWwpIHtcbiAgICAgICAgICAgIHZhciB2b2x1bWVzY29sbGVjdGlvbiA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSB2b2x1bWVzY29sbGVjdGlvbi4kcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuVk9MVU1FU19ERUxFVEVfRU5EUE9JTlQ7XG4gICAgICAgICAgICAvL2RlbGV0ZSBlbmRwb2ludCBleHBlY3RzIHZvbHVtZSBwcm9wZXJ0eSBpbiBhZGRpdGlvbiB0byBwb2xpY3kuIFRPRE8gYXNrIHRvIGJlIGZpeGVkXG4gICAgICAgICAgICBtb2RlbC52b2x1bWUgPSBtb2RlbC5uYW1lO1xuICAgICAgICAgICAgdmFyIGNvbmZpZyA9IHtcbiAgICAgICAgICAgICAgICBkYXRhOiBtb2RlbFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZvbHVtZXNjb2xsZWN0aW9uLiRodHRwLmRlbGV0ZSh1cmwsIGNvbmZpZylcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgXy5yZW1vdmUodm9sdW1lc2NvbGxlY3Rpb24ubW9kZWxzLCBmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChuLm5hbWUgPT0gbW9kZWwubmFtZSAmJiBuLnBvbGljeSA9PSBtb2RlbC5wb2xpY3kpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSh2b2x1bWVzY29sbGVjdGlvbi5leHRyYWN0KHJlc3BvbnNlKSk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3Qodm9sdW1lc2NvbGxlY3Rpb24uZXh0cmFjdChyZXNwb25zZSkpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH07XG5cbiAgICAgICAgVm9sdW1lc0NvbGxlY3Rpb24ucHJvdG90eXBlLmNyZWF0ZSA9IGZ1bmN0aW9uIChtb2RlbCkge1xuICAgICAgICAgICAgdmFyIGNvbGxlY3Rpb24gPSB0aGlzO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuVk9MVU1FU19DUkVBVEVfRU5EUE9JTlQ7XG4gICAgICAgICAgICByZXR1cm4gQ29sbGVjdGlvbi5wcm90b3R5cGUuY3JlYXRlLmNhbGwoY29sbGVjdGlvbiwgbW9kZWwsIHVybCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgVm9sdW1lc0NvbGxlY3Rpb24ucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiAobW9kZWwsIHNuYXBzaG90LCBuZXdWb2x1bWUpIHtcbiAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gdGhpcztcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9IGNvbGxlY3Rpb24uJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLlZPTFVNRVNfQ09QWVNOQVBTSE9UU19FTkRQT0lOVDtcbiAgICAgICAgICAgIHZhciB2b2xjb3B5bW9kZWwgPSB7XG4gICAgICAgICAgICAgICAgbmFtZTogbW9kZWwubmFtZSxcbiAgICAgICAgICAgICAgICBwb2xpY3k6IG1vZGVsLnBvbGljeSxcbiAgICAgICAgICAgICAgICBPcHRpb25zOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldDogbmV3Vm9sdW1lLFxuICAgICAgICAgICAgICAgICAgICBzbmFwc2hvdDogc25hcHNob3RcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY29sbGVjdGlvbi4kaHR0cC5wb3N0KHVybCwgdm9sY29weW1vZGVsKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICBjb2xsZWN0aW9uLm1vZGVscy5wdXNoKGNvbGxlY3Rpb24uZXh0cmFjdChyZXNwb25zZSkpO1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGNvbGxlY3Rpb24uZXh0cmFjdChyZXNwb25zZSkpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGNvbGxlY3Rpb24uZXh0cmFjdChyZXNwb25zZSkpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIHZvbHVtZXNtb2RlbCA9IG5ldyBWb2x1bWVzQ29sbGVjdGlvbigkaHR0cCwgJHEpO1xuICAgICAgICByZXR1cm4gdm9sdW1lc21vZGVsO1xuICAgIH1dKTtcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNC8yOS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi51dGlscycpXG4gICAgLmZhY3RvcnkoJ0NSVURIZWxwZXJTZXJ2aWNlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gc3RhcnRMb2FkZXIoY29udHJvbGxlcikge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuc2hvd0xvYWRlciA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHN0b3BMb2FkZXIoY29udHJvbGxlcikge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuc2hvd0xvYWRlciA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBzaG93U2VydmVyRXJyb3IoY29udHJvbGxlciwgbWVzc2FnZSkge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuc2hvd1NlcnZlckVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLnNlcnZlckVycm9yTWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGhpZGVTZXJ2ZXJFcnJvcihjb250cm9sbGVyKSB7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5zaG93U2VydmVyRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdGFydExvYWRlcjogc3RhcnRMb2FkZXIsXG4gICAgICAgICAgICAgICAgc3RvcExvYWRlcjogc3RvcExvYWRlcixcbiAgICAgICAgICAgICAgICBzaG93U2VydmVyRXJyb3I6IHNob3dTZXJ2ZXJFcnJvcixcbiAgICAgICAgICAgICAgICBoaWRlU2VydmVyRXJyb3I6IGhpZGVTZXJ2ZXJFcnJvclxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgKTtcblxuLyoqXG4gKiBDcmVhdGVkIGJ5IGNzaGFtcHVyIG9uIDcvMTcvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LnV0aWxzXCIpXG4gICAgLmZhY3RvcnkoXCJJbnNwZWN0U2VydmljZVwiLCBmdW5jdGlvbigpe1xuXG4gICAgICAgIC8qIFRoaXMgZnVuY3Rpb24gd291bGQgYnVpbGQgdGhlIGNvbnRhaW5lckRldGFpbHMgb2JqZWN0LlxuICAgICAgICAgZWcgOlxuICAgICAgICAgY29udGFpbmVyRGV0YWlscz17XG4gICAgICAgICBDb250YWluZXJJZDEgOiBbe25hbWU6IFwiaG9taW5nSG9zdFwiLCB2YWx1ZTogXCJjbHVzdGVyLW5vZGUxXCIsIHR5cGU6IFwic3RyaW5nXCIsIGZvcm1hdDogXCJub25lXCJ9LFxuICAgICAgICAge25hbWU6IG1hY0FkZHJlc3MsIHZhbHVlOiBcIjAyOjAyXCIsIHR5cGU6XCJzdHJpbmdcIiwgZm9ybWF0Olwibm9uZVwifVxuICAgICAgICAgXSxcbiAgICAgICAgIENvbnRhaW5lcklkMiA6IFt7bmFtZTogXCJob21pbmdIb3N0XCIsIHZhbHVlOiBcImNsdXN0ZXItbm9kZTFcIiB0eXBlOiBcInN0cmluZ1wiLCBmb3JtYXQ6IFwibm9uZVwifSxcbiAgICAgICAgIHtuYW1lOiBtYWNBZGRyZXNzLCB2YWx1ZTogXCIwMjowNFwiLCB0eXBlOiBcInN0cmluZ1wiLCBmb3JtYXQ6IFwibm9uZVwifVxuICAgICAgICAgXVxuICAgICAgICAgfVxuICAgICAgICAgLS1Vc2VkIGluIGRpc3BsYXlpbmcgdGhlIGNvbnRhaW5lciBkZXRhaWwgaW5zaWRlIGFuIGFjY29yZGlvbi5cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGJ1aWxkRW5kUG9pbnRzKGVuZHBvaW50cyl7XG4gICAgICAgICAgICB2YXIgY29udGFpbmVyRGV0YWlscyA9IHt9O1xuICAgICAgICAgICAgZm9yKHZhciBpIGluIGVuZHBvaW50cyApe1xuICAgICAgICAgICAgICAgIHZhciBjb250YWluZXJBdHRyaWJ1dGVzID0gW107XG4gICAgICAgICAgICAgICAgZm9yKHZhciBrZXkgaW4gZW5kcG9pbnRzW2ldKXtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVuZHBvaW50QXR0cmlidXRlID0ge307XG4gICAgICAgICAgICAgICAgICAgIGVuZHBvaW50QXR0cmlidXRlLm5hbWUgPSBrZXk7XG4gICAgICAgICAgICAgICAgICAgIGVuZHBvaW50QXR0cmlidXRlLmZvcm1hdCA9ICdub25lJztcbiAgICAgICAgICAgICAgICAgICAgZW5kcG9pbnRBdHRyaWJ1dGUudHlwZSA9ICdzdHJpbmcnO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGtleSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiaXBBZGRyZXNzXCIgOiAgZW5kcG9pbnRBdHRyaWJ1dGUudmFsdWUgPSBlbmRwb2ludHNbaV1ba2V5XS5maWx0ZXIoZnVuY3Rpb24oaXBBZGRyZXNzKXtyZXR1cm4gaXBBZGRyZXNzLmxlbmd0aCA+IDA7fSkuam9pbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImxhYmVsc1wiIDogICAgIGVuZHBvaW50QXR0cmlidXRlLnZhbHVlID0gZW5kcG9pbnRzW2ldW2tleV0ucmVwbGFjZSgvKG1hcFxcW3xcXF0pL2dpLCcnKS5yZXBsYWNlKC8oOikvZ2ksICc9Jykuc3BsaXQoJyAnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24odil7cmV0dXJuIHYubGVuZ3RoID4gMH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZHBvaW50QXR0cmlidXRlLmZvcm1hdCA9ICdsYWJlbCc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kcG9pbnRBdHRyaWJ1dGUudHlwZSA9ICdhcnJheSc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0IDogICAgICAgICAgIGVuZHBvaW50QXR0cmlidXRlLnZhbHVlID0gZW5kcG9pbnRzW2ldW2tleV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyQXR0cmlidXRlcy5wdXNoKGVuZHBvaW50QXR0cmlidXRlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29udGFpbmVyRGV0YWlsc1tlbmRwb2ludHNbaV0uY29udGFpbmVySURdID0gY29udGFpbmVyQXR0cmlidXRlcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjb250YWluZXJEZXRhaWxzXG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8qICBUaGlzIGZ1bmN0aW9uIGNoZWNrcyB3aGV0aGVyIGFueSBuZXcgY29udGFpbmVycyB3ZXJlIGFkZGVkIG9yIG5vdFxuICAgICAgICAgVmlldyBpcyB1cGRhdGVkIG9ubHkgd2hlbiB0aGVyZSBpcyBhIGNoYW5nZSBpbiBjb250YWluZXIgY29uZmlndXJhdGlvblxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gY2hlY2tDb250YWluZXJDaGFuZ2VkKGNvbnREZXRhaWxzQSwgY29udERldGFpbHNCKXtcbiAgICAgICAgICAgIGlmKGNvbnREZXRhaWxzQSA9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgIGlmKE9iamVjdC5rZXlzKGNvbnREZXRhaWxzQSkubGVuZ3RoICE9IE9iamVjdC5rZXlzKGNvbnREZXRhaWxzQikubGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICBmb3IodmFyIGtleSBpbiBjb250RGV0YWlsc0Ipe1xuICAgICAgICAgICAgICAgICAgICBpZighKGtleSBpbiBjb250RGV0YWlsc0EpKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGJ1aWxkRW5kUG9pbnRzIDogYnVpbGRFbmRQb2ludHMsXG4gICAgICAgICAgICBjaGVja0NvbnRhaW5lckNoYW5nZWQgOiBjaGVja0NvbnRhaW5lckNoYW5nZWRcbiAgICAgICAgfVxuICAgIH0pO1xuXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnV0aWxzJylcbiAgICAuZmFjdG9yeSgnTmV0d29ya1NlcnZpY2UnLCBbJyRodHRwJywgJyRxJywgZnVuY3Rpb24gKCRodHRwLCAkcSkge1xuXG4gICAgICAgIGZ1bmN0aW9uIGdldFNldHRpbmdzKCkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLk5FVFdPUktfU0VUVElOR1NfRU5EUE9JTlQ7XG4gICAgICAgICAgICAkaHR0cC5nZXQodXJsKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdC5kYXRhWzBdKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVTZXR0aW5ncyhzZXR0aW5nKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdChDb250aXZHbG9iYWxzLk5FVFdPUktfU0VUVElOR1NfRU5EUE9JTlQgXG4gICAgICAgICAgICAgICAgKyAnZ2xvYmFsLycsIHNldHRpbmcpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRTZXR0aW5nczogZ2V0U2V0dGluZ3MsXG4gICAgICAgICAgICB1cGRhdGVTZXR0aW5nczogdXBkYXRlU2V0dGluZ3NcbiAgICAgICAgfVxuICAgIH1dKTtcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudXRpbHMnKVxuICAgIC5mYWN0b3J5KCdOb2Rlc1NlcnZpY2UnLCBbJyRodHRwJywgJyRxJyxcbiAgICAgICAgZnVuY3Rpb24gKCRodHRwLCAkcSkge1xuICAgICAgICAgICAgdmFyIG5vZGVfY29uc3RhbnRzID0ge1xuICAgICAgICAgICAgICAgIEFQSUNfQ09OVFJfVU5SRVNUUklDVF9NT0RFOiAnYXBpY19jb250cmFjdHNfdW5yZXN0cmljdGVkX21vZGUnLFxuICAgICAgICAgICAgICAgIEFQSUNfRVBHX0JSSURHRV9ET01BSU46ICdhcGljX2VwZ19icmlkZ2VfZG9tYWluJyxcbiAgICAgICAgICAgICAgICBBUElDX0xFQUZfTk9ERVM6ICdhcGljX2xlYWZfbm9kZXMnLFxuICAgICAgICAgICAgICAgIEFQSUNfUEFTU1dPUkQ6ICdhcGljX3Bhc3N3b3JkJyxcbiAgICAgICAgICAgICAgICBBUElDX1BIWVNfRE9NQUlOOiAnYXBpY19waHlzX2RvbWFpbicsXG4gICAgICAgICAgICAgICAgQVBJQ19VUkw6ICdhcGljX3VybCcsXG4gICAgICAgICAgICAgICAgQVBJQ19VU0VSTkFNRTogJ2FwaWNfdXNlcm5hbWUnLFxuICAgICAgICAgICAgICAgIENPTlRJVl9ORVRfTU9ERTogJ2NvbnRpdl9uZXR3b3JrX21vZGUnLFxuICAgICAgICAgICAgICAgIENPTlRST0xfSU5URVJGQUNFOiAnY29udHJvbF9pbnRlcmZhY2UnLFxuICAgICAgICAgICAgICAgIEVOVjogJ2VudicsXG4gICAgICAgICAgICAgICAgRldEX01PREU6ICdmd2RfbW9kZScsXG4gICAgICAgICAgICAgICAgREFUQV9JTlRFUkZBQ0U6ICduZXRwbHVnaW5faWYnLFxuICAgICAgICAgICAgICAgIFNDSEVEX1BST1ZJREVSOiAnc2NoZWR1bGVyX3Byb3ZpZGVyJyxcbiAgICAgICAgICAgICAgICBWSVBfQUREUjogJ3NlcnZpY2VfdmlwJyxcbiAgICAgICAgICAgICAgICBVQ1BfQk9PVFNUUkFQX05PREU6ICd1Y3BfYm9vdHN0cmFwX25vZGVfbmFtZScsXG4gICAgICAgICAgICAgICAgQ0xVU1RFUl9OQU1FOiAnY2x1c3Rlcl9uYW1lJ307XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldFNldHRpbmdzKGN0cmwpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLk5PREVTX1NFVFRJTkdTX0dFVF9FTkRQT0lOVDtcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQodXJsKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIGN0cmwuc2V0dGluZyA9IHJlc3VsdC5kYXRhO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXh0cmFWYXJzID0gY3RybC5zZXR0aW5nLmV4dHJhX3ZhcnM7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzY2hlZF9wcm92aWRlciA9IGV4dHJhVmFyc1tub2RlX2NvbnN0YW50cy5TQ0hFRF9QUk9WSURFUl07XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXR3b3JrX21vZGUgPSBleHRyYVZhcnNbbm9kZV9jb25zdGFudHMuQ09OVElWX05FVF9NT0RFXTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoZXh0cmFWYXJzW25vZGVfY29uc3RhbnRzLkNPTlRST0xfSU5URVJGQUNFXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3RybC5leHRyYV92YXJzW25vZGVfY29uc3RhbnRzLkNPTlRST0xfSU5URVJGQUNFXSA9IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhVmFyc1tub2RlX2NvbnN0YW50cy5DT05UUk9MX0lOVEVSRkFDRV07IFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChleHRyYVZhcnNbbm9kZV9jb25zdGFudHMuREFUQV9JTlRFUkZBQ0VdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdHJsLmV4dHJhX3ZhcnNbbm9kZV9jb25zdGFudHMuREFUQV9JTlRFUkZBQ0VdID0gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmFWYXJzW25vZGVfY29uc3RhbnRzLkRBVEFfSU5URVJGQUNFXTsgXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4dHJhVmFyc1tub2RlX2NvbnN0YW50cy5WSVBfQUREUl0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0cmwuZXh0cmFfdmFyc1tub2RlX2NvbnN0YW50cy5WSVBfQUREUl0gPSBleHRyYVZhcnNbbm9kZV9jb25zdGFudHMuVklQX0FERFJdOyBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoc2NoZWRfcHJvdmlkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0cmwuZXh0cmFfdmFyc1tub2RlX2NvbnN0YW50cy5TQ0hFRF9QUk9WSURFUl0gPSBzY2hlZF9wcm92aWRlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzY2hlZF9wcm92aWRlciA9PT0gJ3VjcC1zd2FybScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHJsLmV4dHJhX3ZhcnNbbm9kZV9jb25zdGFudHMuVUNQX0JPT1RTVFJBUF9OT0RFXSA9IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHRyYVZhcnNbbm9kZV9jb25zdGFudHMuVUNQX0JPT1RTVFJBUF9OT0RFXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAobmV0d29ya19tb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdHJsLmV4dHJhX3ZhcnNbbm9kZV9jb25zdGFudHMuQ09OVElWX05FVF9NT0RFXSA9IG5ldHdvcmtfbW9kZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXR3b3JrX21vZGUgPT09ICdzdGFuZGFsb25lJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0cmwuZXh0cmFfdmFyc1tub2RlX2NvbnN0YW50cy5GV0RfTU9ERV0gPSBleHRyYVZhcnNbbm9kZV9jb25zdGFudHMuRldEX01PREVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAobmV0d29ya19tb2RlID09PSAnYWNpJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0cmwuZXh0cmFfdmFyc1tub2RlX2NvbnN0YW50cy5BUElDX0NPTlRSX1VOUkVTVFJJQ1RfTU9ERV0gPSBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmFWYXJzW25vZGVfY29uc3RhbnRzLkFQSUNfQ09OVFJfVU5SRVNUUklDVF9NT0RFXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHJsLmV4dHJhX3ZhcnNbbm9kZV9jb25zdGFudHMuQVBJQ19FUEdfQlJJREdFX0RPTUFJTl0gPSBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmFWYXJzW25vZGVfY29uc3RhbnRzLkFQSUNfRVBHX0JSSURHRV9ET01BSU5dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0cmwuZXh0cmFfdmFyc1tub2RlX2NvbnN0YW50cy5BUElDX0xFQUZfTk9ERVNdID0gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhVmFyc1tub2RlX2NvbnN0YW50cy5BUElDX0xFQUZfTk9ERVNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0cmwuZXh0cmFfdmFyc1tub2RlX2NvbnN0YW50cy5BUElDX1BBU1NXT1JEXSA9IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHRyYVZhcnNbbm9kZV9jb25zdGFudHMuQVBJQ19QQVNTV09SRF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3RybC5leHRyYV92YXJzW25vZGVfY29uc3RhbnRzLkFQSUNfUEhZU19ET01BSU5dID0gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhVmFyc1tub2RlX2NvbnN0YW50cy5BUElDX1BIWVNfRE9NQUlOXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHJsLmV4dHJhX3ZhcnNbbm9kZV9jb25zdGFudHMuQVBJQ19VUkxdID0gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhVmFyc1tub2RlX2NvbnN0YW50cy5BUElDX1VSTF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3RybC5leHRyYV92YXJzW25vZGVfY29uc3RhbnRzLkFQSUNfVVNFUk5BTUVdID0gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhVmFyc1tub2RlX2NvbnN0YW50cy5BUElDX1VTRVJOQU1FXTsgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoZXh0cmFWYXJzW25vZGVfY29uc3RhbnRzLkNMVVNURVJfTkFNRV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0cmwuZXh0cmFfdmFyc1tub2RlX2NvbnN0YW50cy5DTFVTVEVSX05BTUVdID1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHRyYVZhcnNbbm9kZV9jb25zdGFudHMuQ0xVU1RFUl9OQU1FXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVFbnZWYXJpYWJsZXMoZXh0cmFWYXJzW25vZGVfY29uc3RhbnRzLkVOVl0sIGN0cmwuZW52VmFyaWFibGVzKTtcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlQW5zaWJsZVZhcmlhYmxlcyhleHRyYVZhcnMsIGN0cmwuYW5zaWJsZVZhcmlhYmxlcyk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUVudlZhcmlhYmxlcyhlbnZWYXJzLCBlbnZWYXJpYWJsZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgaTtcbiAgICAgICAgICAgICAgICBmb3IgKGkgaW4gZW52VmFycykge1xuICAgICAgICAgICAgICAgICAgICBlbnZWYXJpYWJsZXMucHVzaCh7J25hbWUnOiBpLCAndmFsdWUnOiBlbnZWYXJzW2ldfSk7XG4gICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUFuc2libGVWYXJpYWJsZXMoZXh0cmFWYXJzLCBhbnNpYmxlVmFyaWFibGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNldHRpbmdfZmlsdGVyID0gW25vZGVfY29uc3RhbnRzLkFQSUNfQ09OVFJfVU5SRVNUUklDVF9NT0RFLFxuICAgICAgICAgICAgICAgICAgICBub2RlX2NvbnN0YW50cy5BUElDX0VQR19CUklER0VfRE9NQUlOLCBub2RlX2NvbnN0YW50cy5BUElDX0xFQUZfTk9ERVMsIFxuICAgICAgICAgICAgICAgICAgICBub2RlX2NvbnN0YW50cy5BUElDX1BBU1NXT1JELCBub2RlX2NvbnN0YW50cy5BUElDX1BIWVNfRE9NQUlOLCBcbiAgICAgICAgICAgICAgICAgICAgbm9kZV9jb25zdGFudHMuQVBJQ19VUkwsIG5vZGVfY29uc3RhbnRzLkFQSUNfVVNFUk5BTUUsIFxuICAgICAgICAgICAgICAgICAgICBub2RlX2NvbnN0YW50cy5DT05USVZfTkVUX01PREUsIG5vZGVfY29uc3RhbnRzLkNPTlRST0xfSU5URVJGQUNFLCBcbiAgICAgICAgICAgICAgICAgICAgbm9kZV9jb25zdGFudHMuRU5WLCBub2RlX2NvbnN0YW50cy5GV0RfTU9ERSwgbm9kZV9jb25zdGFudHMuREFUQV9JTlRFUkZBQ0UsIFxuICAgICAgICAgICAgICAgICAgICBub2RlX2NvbnN0YW50cy5TQ0hFRF9QUk9WSURFUiwgbm9kZV9jb25zdGFudHMuVklQX0FERFIsIFxuICAgICAgICAgICAgICAgICAgICBub2RlX2NvbnN0YW50cy5VQ1BfQk9PVFNUUkFQX05PREUsIG5vZGVfY29uc3RhbnRzLkNMVVNURVJfTkFNRV07XG4gICAgICAgICAgICAgICAgdmFyIGk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKGkgaW4gZXh0cmFWYXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZXR0aW5nX2ZpbHRlci5pbmRleE9mKGkpID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW5zaWJsZVZhcmlhYmxlcy5wdXNoKHsnbmFtZSc6IGksICd2YWx1ZSc6IGV4dHJhVmFyc1tpXX0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gdXBkYXRlU2V0dGluZ3Mobm9kZU9wc09iaikge1xuICAgICAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KENvbnRpdkdsb2JhbHMuTk9ERVNfU0VUVElOR1NfU0VUX0VORFBPSU5ULCBub2RlT3BzT2JqLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnaGVhZGVycyc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gY3JlYXRlRXh0cmFWYXJzKGN0cmwpIHtcbiAgICAgICAgICAgICAgICAvL0FkZCBhbnNpYmxlIHZhcmlhYmxlcyB0byBleHRyYV92YXJzXG4gICAgICAgICAgICAgICAgY3RybC5hbnNpYmxlVmFyaWFibGVzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgY3RybC5leHRyYV92YXJzW2l0ZW0ubmFtZV0gPSBpdGVtLnZhbHVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgLy9BZGQgZW52aXJvbm1lbnQgdmFyaWFibGVzIHRvIGV4dHJhX3ZhcnNcbiAgICAgICAgICAgICAgICB2YXIgZW52VmFycyA9IHt9O1xuICAgICAgICAgICAgICAgIGN0cmwuZW52VmFyaWFibGVzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgZW52VmFyc1tpdGVtLm5hbWVdID0gaXRlbS52YWx1ZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBjdHJsLmV4dHJhX3ZhcnNbbm9kZV9jb25zdGFudHMuRU5WXSA9IGVudlZhcnM7XG4gICAgICAgICAgICAgICAgY3RybC5ub2RlT3BzT2JqLmV4dHJhX3ZhcnMgPSBKU09OLnN0cmluZ2lmeShjdHJsLmV4dHJhX3ZhcnMpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDbGVhbnVwIGFuc2libGUgdmFyaWFibGVzIGZvciBuZXR3b3JrIG1vZGUgYW5kIHNjaGVkdWxlci4gbmctaWYgcmVtb3ZlcyBpdCBmcm9tIHRoZSB2aWV3IChET00pIGJ1dCBub3QgZnJvbVxuICAgICAgICAgICAgICogdGhlIG1vZGVsLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmdW5jdGlvbiBjbGVhbnVwRXh0cmFWYXJzKGN0cmwpIHtcbiAgICAgICAgICAgICAgICAvL0NsZWFudXAgZm9yIG5ldHdvcmsgbW9kZVxuICAgICAgICAgICAgICAgIGlmIChjdHJsLmV4dHJhX3ZhcnNbbm9kZV9jb25zdGFudHMuQ09OVElWX05FVF9NT0RFXSA9PSAnYWNpJykge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgY3RybC5leHRyYV92YXJzW25vZGVfY29uc3RhbnRzLkZXRF9NT0RFXTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgY3RybC5leHRyYV92YXJzW25vZGVfY29uc3RhbnRzLkFQSUNfVVJMXTtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGN0cmwuZXh0cmFfdmFyc1tub2RlX2NvbnN0YW50cy5BUElDX1VTRVJOQU1FXTtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGN0cmwuZXh0cmFfdmFyc1tub2RlX2NvbnN0YW50cy5BUElDX1BBU1NXT1JEXTtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGN0cmwuZXh0cmFfdmFyc1tub2RlX2NvbnN0YW50cy5BUElDX0xFQUZfTk9ERVNdO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgY3RybC5leHRyYV92YXJzW25vZGVfY29uc3RhbnRzLkFQSUNfUEhZU19ET01BSU5dO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgY3RybC5leHRyYV92YXJzW25vZGVfY29uc3RhbnRzLkFQSUNfRVBHX0JSSURHRV9ET01BSU5dO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgY3RybC5leHRyYV92YXJzW25vZGVfY29uc3RhbnRzLkFQSUNfQ09OVFJfVU5SRVNUUklDVF9NT0RFXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9DbGVhbnVwIGZvciBzY2hlZHVsZXJcbiAgICAgICAgICAgICAgICBpZiAoY3RybC5leHRyYV92YXJzW25vZGVfY29uc3RhbnRzLlNDSEVEX1BST1ZJREVSXSA9PSAnbmF0aXZlLXN3YXJtJykge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgY3RybC5leHRyYV92YXJzW25vZGVfY29uc3RhbnRzLlVDUF9CT09UU1RSQVBfTk9ERV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0U2V0dGluZ3M6IGdldFNldHRpbmdzLFxuICAgICAgICAgICAgY3JlYXRlRW52VmFyaWFibGVzOiBjcmVhdGVFbnZWYXJpYWJsZXMsXG4gICAgICAgICAgICBjcmVhdGVBbnNpYmxlVmFyaWFibGVzOiBjcmVhdGVBbnNpYmxlVmFyaWFibGVzLFxuICAgICAgICAgICAgdXBkYXRlU2V0dGluZ3M6IHVwZGF0ZVNldHRpbmdzLFxuICAgICAgICAgICAgY3JlYXRlRXh0cmFWYXJzOiBjcmVhdGVFeHRyYVZhcnMsXG4gICAgICAgICAgICBjbGVhbnVwRXh0cmFWYXJzOiBjbGVhbnVwRXh0cmFWYXJzXG4gICAgICAgIH1cbiAgICB9XSk7XG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnV0aWxzJylcbiAgICAuZmFjdG9yeSgnVm9sdW1lU2V0dGluZ1NlcnZpY2UnLCBbJyRodHRwJywgJyRxJywgZnVuY3Rpb24gKCRodHRwLCAkcSkge1xuXG4gICAgICAgIGZ1bmN0aW9uIGdldFNldHRpbmdzKCkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLlZPTFVNRVNfR0xPQkFMX0VORFBPSU5UO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlU2V0dGluZ3Moc2V0dGluZykge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoQ29udGl2R2xvYmFscy5WT0xVTUVTX0dMT0JBTF9FTkRQT0lOVCwgc2V0dGluZyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0U2V0dGluZ3M6IGdldFNldHRpbmdzLFxuICAgICAgICAgICAgdXBkYXRlU2V0dGluZ3M6IHVwZGF0ZVNldHRpbmdzXG4gICAgICAgIH1cbiAgICB9XSk7XG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5kaXJlY3RpdmVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dkFjaXZhbGlkXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy9ub2Rlcy9hY2l2YWxpZC5odG1sJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgZm9ybTogXCI9XCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTtcbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2Q29udHJvbGludGVyZmFjZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvbm9kZXMvY29udHJvbGludGVyZmFjZS5odG1sJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgZXh0cmF2YXJzOiBcIj1cIlxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pO1xuYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZOZXR3b3JrbW9kZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvbm9kZXMvbmV0d29ya21vZGUuaHRtbCcsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIGV4dHJhdmFyczogXCI9XCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTtcbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2U2NoZWR1bGVyXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy9ub2Rlcy9zY2hlZHVsZXIuaHRtbCcsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIGV4dHJhdmFyczogXCI9XCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTsiLCIvKipcbiAqIEJhc2VDb2xsZWN0aW9uIGNsYXNzIHRoYXQgZG9lcyBqdXN0IGZldGNoIG9mIHRoZSBvYmplY3RzLlxuICogQHBhcmFtICRodHRwXG4gKiBAcGFyYW0gJHFcbiAqIEBwYXJhbSB1cmwgVXNlZCBmb3IgZG9pbmcgSFRUUCBHRVQgYW5kIGZldGNoIG9iamVjdHMgZnJvbSBzZXJ2ZXJcbiAqIEBjb25zdHJ1Y3RvclxuICovXG5mdW5jdGlvbiBCYXNlQ29sbGVjdGlvbigkaHR0cCwgJHEsIHVybCkge1xuICAgIHRoaXMubW9kZWxzID0gW107XG4gICAgdGhpcy4kaHR0cCA9ICRodHRwO1xuICAgIHRoaXMuJHEgPSAkcTtcbiAgICB0aGlzLnVybCA9IHVybDtcbn1cblxuQmFzZUNvbGxlY3Rpb24ucHJvdG90eXBlLmV4dHJhY3QgPSBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgcmV0dXJuIHJlc3VsdC5kYXRhO1xufTtcblxuLyoqXG4gKlxuICogQHBhcmFtIHJlbG9hZCBPcHRpb25hbC4gRGVmYXVsdCBpcyBmYWxzZVxuICogQHJldHVybnMgeyp9XG4gKi9cbkJhc2VDb2xsZWN0aW9uLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAocmVsb2FkKSB7XG4gICAgdmFyIGNvbGxlY3Rpb24gPSB0aGlzO1xuICAgIGlmIChyZWxvYWQgPT09IHVuZGVmaW5lZCkgcmVsb2FkID0gZmFsc2U7XG4gICAgcmV0dXJuICghcmVsb2FkICYmIGNvbGxlY3Rpb24ubW9kZWxzLmxlbmd0aCA+IDApID9cbiAgICAgICAgY29sbGVjdGlvbi4kcS53aGVuKGNvbGxlY3Rpb24ubW9kZWxzKSA6IGNvbGxlY3Rpb24uJGh0dHAuZ2V0KGNvbGxlY3Rpb24udXJsKVxuICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICBjb2xsZWN0aW9uLm1vZGVscyA9IGNvbGxlY3Rpb24uZXh0cmFjdChyZXN1bHQpO1xuICAgICAgICAgICAgcmV0dXJuIGNvbGxlY3Rpb24ubW9kZWxzO1xuICAgICAgICB9KTtcbn07XG5cbi8qKlxuICpcbiAqIEBwYXJhbSBrZXlcbiAqIEBwYXJhbSByZWxvYWQgT3B0aW9uYWwuIERlZmF1bHQgaXMgZmFsc2VcbiAqIEBwYXJhbSBrZXluYW1lXG4gKiBAcmV0dXJucyB7Kn1cbiAqL1xuQmFzZUNvbGxlY3Rpb24ucHJvdG90eXBlLmdldE1vZGVsQnlLZXkgPSBmdW5jdGlvbiAoa2V5LCByZWxvYWQsIGtleW5hbWUpIHtcbiAgICB2YXIgY29sbGVjdGlvbiA9IHRoaXM7XG4gICAgaWYgKHJlbG9hZCA9PT0gdW5kZWZpbmVkKSByZWxvYWQgPSBmYWxzZTtcbiAgICBpZiAoa2V5bmFtZSA9PT0gdW5kZWZpbmVkKSBrZXluYW1lID0gJ2tleSc7XG5cbiAgICB2YXIgZGVmZXJyZWQgPSBjb2xsZWN0aW9uLiRxLmRlZmVyKCk7XG5cbiAgICBmdW5jdGlvbiBmaW5kTW9kZWwoKSB7XG4gICAgICAgIHJldHVybiBfLmZpbmQoY29sbGVjdGlvbi5tb2RlbHMsIGZ1bmN0aW9uIChjKSB7XG4gICAgICAgICAgICByZXR1cm4gY1trZXluYW1lXSA9PSBrZXk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgaWYgKCFyZWxvYWQgJiYgY29sbGVjdGlvbi5tb2RlbHMubGVuZ3RoID4gMCkge1xuICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGZpbmRNb2RlbCgpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb2xsZWN0aW9uLmdldChyZWxvYWQpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShmaW5kTW9kZWwoKSk7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbn07XG5cbi8qKlxuICpcbiAqIEBwYXJhbSBtb2RlbFxuICogQHBhcmFtIHJlbG9hZCBPcHRpb25hbC4gRGVmYXVsdCBpcyBmYWxzZVxuICogQHJldHVybnMgeyp9XG4gKi9cbkJhc2VDb2xsZWN0aW9uLnByb3RvdHlwZS5nZXRNb2RlbCA9IGZ1bmN0aW9uIChtb2RlbCwgcmVsb2FkKSB7XG4gICAgdmFyIGNvbGxlY3Rpb24gPSB0aGlzO1xuICAgIGlmIChyZWxvYWQgPT09IHVuZGVmaW5lZCkgcmVsb2FkID0gZmFsc2U7XG5cbiAgICB2YXIgZGVmZXJyZWQgPSBjb2xsZWN0aW9uLiRxLmRlZmVyKCk7XG5cbiAgICBmdW5jdGlvbiBmaW5kTW9kZWwoKSB7XG4gICAgICAgIHJldHVybiBfLmZpbmQoY29sbGVjdGlvbi5tb2RlbHMsIG1vZGVsKVxuICAgIH1cblxuICAgIGlmICghcmVsb2FkICYmIGNvbGxlY3Rpb24ubW9kZWxzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShmaW5kTW9kZWwoKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29sbGVjdGlvbi5nZXQocmVsb2FkKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoZmluZE1vZGVsKCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG59O1xuXG5cbi8qKlxuICogRXh0ZW5kcyBCYXNlQ29sbGVjdGlvbiBjbGFzcyB0byBkbyBjcmVhdGUsIHVwZGF0ZSBhbmQgZGVsZXRlIHVzaW5nIFBPU1QsIFBVVCBhbmQgREVMRVRFIHZlcmJzLlxuICogQHBhcmFtICRodHRwXG4gKiBAcGFyYW0gJHFcbiAqIEBwYXJhbSB1cmwgVXNlZCBmb3IgZG9pbmcgSFRUUCBHRVQgYW5kIGZldGNoIG9iamVjdHMgZnJvbSBzZXJ2ZXJcbiAqIEBjb25zdHJ1Y3RvclxuICovXG5mdW5jdGlvbiBDb2xsZWN0aW9uKCRodHRwLCAkcSwgdXJsKSB7XG4gICAgQmFzZUNvbGxlY3Rpb24uY2FsbCh0aGlzLCAkaHR0cCwgJHEsIHVybCk7XG4gICAgdGhpcy5pbnNwZWN0U3RhdHMgPSB7fTtcbn1cblxuQ29sbGVjdGlvbi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEJhc2VDb2xsZWN0aW9uLnByb3RvdHlwZSk7XG5cbi8qKlxuICpcbiAqIEBwYXJhbSBtb2RlbFxuICogQHBhcmFtIHVybCBPcHRpb25hbCBpZiBub3QgcGFzc2VkIGl0IGlzIGNvbnN0cnVjdGVkIHVzaW5nIGtleSBhbmQgdXJsIHBhc3NlZCBpbiBjb25zdHJ1Y3RvclxuICogQHJldHVybnMgeyp9XG4gKi9cbkNvbGxlY3Rpb24ucHJvdG90eXBlLmNyZWF0ZSA9IGZ1bmN0aW9uIChtb2RlbCwgdXJsKSB7XG4gICAgdmFyIGNvbGxlY3Rpb24gPSB0aGlzO1xuICAgIHZhciBkZWZlcnJlZCA9IGNvbGxlY3Rpb24uJHEuZGVmZXIoKTtcbiAgICBcbiAgICBpZiAodXJsID09PSB1bmRlZmluZWQpIHVybCA9IGNvbGxlY3Rpb24udXJsICsgbW9kZWwua2V5ICsgJy8nO1xuICAgIGNvbGxlY3Rpb24uJGh0dHAucG9zdCh1cmwsIG1vZGVsKVxuICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHZhciByZXNwb25zZURhdGEgPSBjb2xsZWN0aW9uLmV4dHJhY3QocmVzcG9uc2UpO1xuICAgICAgICAgICAgLy9Gb3IgcmVzdCBlbmRwb2ludHMgdGhhdCBkbyBub3QgcmV0dXJuIGNyZWF0ZWQganNvbiBvYmplY3QgaW4gcmVzcG9uc2VcbiAgICAgICAgICAgIGlmICgocmVzcG9uc2VEYXRhID09PSB1bmRlZmluZWQpIHx8IChyZXNwb25zZURhdGEgPT09ICcnKSkge1xuICAgICAgICAgICAgICAgIHJlc3BvbnNlRGF0YSA9IG1vZGVsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9jb2xsZWN0aW9uLm1vZGVscy5wdXNoKGNvbGxlY3Rpb24uZXh0cmFjdChyZXNwb25zZSkpO1xuICAgICAgICAgICAgY29sbGVjdGlvbi5tb2RlbHMucHVzaChyZXNwb25zZURhdGEpO1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShjb2xsZWN0aW9uLmV4dHJhY3QocmVzcG9uc2UpKTtcbiAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGNvbGxlY3Rpb24uZXh0cmFjdChyZXNwb25zZSkpO1xuICAgICAgICB9KTtcbiAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbn07XG5cbi8qKlxuICogVGhpcyBpcyBmb3IgbmV0bWFzdGVyIHNwZWNpZmljIGVuZHBvaW50cyBhbmQgdXNlZCBieSBuZXRtYXN0ZXIgb2JqZWN0cyBvbmx5LlxuICogVE9ETzogR2VuZXJhbGl6ZVxuICogQHBhcmFtIG1vZGVsXG4gKiBAcGFyYW0gdXJsIE9wdGlvbmFsXG4gKiBAcmV0dXJucyB7Kn1cbiAqL1xuQ29sbGVjdGlvbi5wcm90b3R5cGUuc2F2ZSA9IGZ1bmN0aW9uIChtb2RlbCkge1xuICAgIHZhciBjb2xsZWN0aW9uID0gdGhpcztcbiAgICB2YXIgZGVmZXJyZWQgPSBjb2xsZWN0aW9uLiRxLmRlZmVyKCk7XG4gICAgdmFyIHVybCA9IGNvbGxlY3Rpb24udXJsICsgbW9kZWwua2V5ICsgJy8nO1xuICAgIGNvbGxlY3Rpb24uJGh0dHAucHV0KHVybCwgbW9kZWwpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgICAgXy5yZW1vdmUoY29sbGVjdGlvbi5tb2RlbHMsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG4ua2V5ID09IG1vZGVsLmtleTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29sbGVjdGlvbi5tb2RlbHMucHVzaChjb2xsZWN0aW9uLmV4dHJhY3QocmVzcG9uc2UpKTtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoY29sbGVjdGlvbi5leHRyYWN0KHJlc3BvbnNlKSk7XG4gICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChjb2xsZWN0aW9uLmV4dHJhY3QocmVzcG9uc2UpKTtcbiAgICAgICAgfSk7XG4gICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG59O1xuXG4vKipcbiAqIFRoaXMgaXMgZm9yIG5ldG1hc3RlciBzcGVjaWZpYyBlbmRwb2ludHMgYW5kIHVzZWQgYnkgbmV0bWFzdGVyIG9iamVjdHMgb25seS5cbiAqIFRPRE86IEdlbmVyYWxpemVcbiAqIEBwYXJhbSBtb2RlbFxuICogQHJldHVybnMgeyp9XG4gKi9cbkNvbGxlY3Rpb24ucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uIChtb2RlbCkge1xuICAgIHZhciBjb2xsZWN0aW9uID0gdGhpcztcbiAgICB2YXIgZGVmZXJyZWQgPSBjb2xsZWN0aW9uLiRxLmRlZmVyKCk7XG4gICAgdmFyIHVybCA9IGNvbGxlY3Rpb24udXJsICsgbW9kZWwua2V5ICsgJy8nO1xuICAgIGNvbGxlY3Rpb24uJGh0dHAuZGVsZXRlKHVybClcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBfLnJlbW92ZShjb2xsZWN0aW9uLm1vZGVscywgZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbi5rZXkgPT0gbW9kZWwua2V5O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGNvbGxlY3Rpb24uZXh0cmFjdChyZXNwb25zZSkpO1xuICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoY29sbGVjdGlvbi5leHRyYWN0KHJlc3BvbnNlKSk7XG4gICAgICAgIH0pO1xuICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xufTtcblxuLyoqXG4gKlxuICogQHBhcmFtIGtleVxuICogQHBhcmFtIGtleW5hbWVcbiAqIEBwYXJhbSB1cmwgT3B0aW9uYWwgaWYgbm90IHBhc3NlZCBpdCBpcyBjb25zdHJ1Y3RlZCB1c2luZyBrZXkgYW5kIHVybCBwYXNzZWQgaW4gY29uc3RydWN0b3JcbiAqIEByZXR1cm5zIHsqfVxuICovXG5Db2xsZWN0aW9uLnByb3RvdHlwZS5kZWxldGVVc2luZ0tleSA9IGZ1bmN0aW9uIChrZXksIGtleW5hbWUsIHVybCkge1xuICAgIHZhciBjb2xsZWN0aW9uID0gdGhpcztcbiAgICBpZiAoa2V5bmFtZSA9PT0gdW5kZWZpbmVkKSBrZXluYW1lID0gJ2tleSc7XG5cbiAgICB2YXIgZGVmZXJyZWQgPSBjb2xsZWN0aW9uLiRxLmRlZmVyKCk7XG4gICAgaWYgKHVybCA9PT0gdW5kZWZpbmVkKSB1cmwgPSBjb2xsZWN0aW9uLnVybCArIGtleSArICcvJztcbiAgICBjb2xsZWN0aW9uLiRodHRwLmRlbGV0ZSh1cmwpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgICAgXy5yZW1vdmUoY29sbGVjdGlvbi5tb2RlbHMsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ba2V5bmFtZV0gPT0ga2V5O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGNvbGxlY3Rpb24uZXh0cmFjdChyZXNwb25zZSkpO1xuICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoY29sbGVjdGlvbi5leHRyYWN0KHJlc3BvbnNlKSk7XG4gICAgICAgIH0pO1xuICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xufTtcblxuXG5Db2xsZWN0aW9uLnByb3RvdHlwZS5nZXRJbnNwZWN0QnlLZXkgPSBmdW5jdGlvbihrZXksIHVybCwgcmVmcmVzaCl7XG4gICAgdmFyIGNvbGxlY3Rpb24gPSB0aGlzO1xuICAgIHZhciBkZWZlcnJlZCA9IGNvbGxlY3Rpb24uJHEuZGVmZXIoKTtcbiAgICBpZihrZXkgaW4gY29sbGVjdGlvbi5pbnNwZWN0U3RhdHMgJiYgcmVmcmVzaCA9PSBmYWxzZSl7XG4gICAgICAgIGRlZmVycmVkLnJlc29sdmUoY29sbGVjdGlvbi5pbnNwZWN0U3RhdHNba2V5XSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBjb2xsZWN0aW9uLiRodHRwLmdldCh1cmwgKyBrZXkgKyAnLycpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlU3RhdHMgPSBjb2xsZWN0aW9uLmV4dHJhY3QocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICBjb2xsZWN0aW9uLmluc3BlY3RTdGF0c1trZXldID0gcmVzcG9uc2VTdGF0c1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3BvbnNlU3RhdHMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAsIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2soZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG59OyIsIi8qKlxuICogRGVmaW5pbmcgdGhlIEdyYXBoIE1vZHVsZS5cbiAqIFNlZSBERVNJR04ubWQgZm9yIGluZm8gb24gR3JhcGggT2JqZWN0cy5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcsIFtdKTtcblxuXG5cblxuIiwiYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiLCBbXSk7IiwiLyoqXG4gKiBUaGUgYmFzZSBjbGFzcyB0aGUgRGF0YVNvdXJjZSBvYmplY3QuXG4gKiBcbiAqIFRoZSBEYXRhU291cmNlIG9iamVjdCB0YWtlcyBpbiBub2RlIGFuZCBsaW5rIGRhdGEgZnJvbSB0aGUgc2VydmVyLCBcbiAqIGFuZCBwcm92aWRlcyBtZXRob2RzIGZvciBjb252ZXJ0aW5nIGFuZCBtYW5pcHVsYXRpbmcgdGhlIGRhdGEgZm9yXG4gKiB0aGUgZ3JhcGggb2JqZWN0LlxuICogXG4gKiBUbyB3cml0ZSB5b3VyIG93biBEYXRhU291cmNlIG9iamVjdCwgY3JlYXRlIGEgbmV3IGZhY3RvcnkgdGhhdCB1c2VzIHRoZSBcbiAqIERhdGFTb3VyY2UgeW91IHdhbnQgdG8gaW5oZXJpdCBhcyBhIGRlcGVuZGVuY3ksIGFuZCBleHRlbmQgXG4gKiBpdHMgRGF0YVNvdXJjZSBjbGFzcy4gXG4gKiBSZXR1cm4gdGhlIGNsYXNzIG9iamVjdCB3aXRoIERhdGFTb3VyY2UgYXMga2V5LlxuICogXG4gKiBOb2RlIGRhdGEgaXMgZXhwZWN0ZWQgdG8gYmUgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6XG4gKiB7aWQ6bm9kZV9pZCwgdGV4dDpub2RlX3RleHR9XG4gKiBcbiAqIExpbmsgZGF0YSBpcyBleHBlY3RlZCB0byBiZSBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDpcbiAqIHtzb3VyY2U6IHNvdXJjZU5vZGVJZCwgdGFyZ2V0OiB0YXJnZXROb2RlSWR9XG4gKiBcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ0RhdGFTb3VyY2UnLCBbJ05vZGUnLCAnTGluaycsIFxuICAgIFx0ZnVuY3Rpb24gKE5vZGUsIExpbmspIHtcblxuICAgIFx0Y2xhc3MgRGF0YVNvdXJjZSB7XG4gICAgXHRcdC8qKlxuICAgIFx0XHQgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgXHRcdCAqXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBub2RlcyAgICAgICAgICAgICAgVGhlIG5vZGUgZGF0YSBcbiAgICBcdFx0ICogQHBhcmFtICAgICAge0FycmF5fSAgIGxpbmtzICAgICAgICAgICAgICBUaGUgbGluayBkYXRhXG4gICAgXHRcdCAqL1xuXHRcdFx0Y29uc3RydWN0b3Iobm9kZXMsIGxpbmtzKSB7XG5cdFx0XHRcdHRoaXMubm9kZXMgPSBub2Rlcztcblx0XHRcdFx0dGhpcy5saW5rcyA9IGxpbmtzO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFJlcGxhY2VzIHRoZSBub2RlIGRhdGFcblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGVzICAgVGhlIG5vZGVzXG5cdFx0XHQgKi9cblx0XHRcdHVwZGF0ZU5vZGVzKG5vZGVzKSB7XG5cdFx0XHRcdHRoaXMubm9kZXMgPSBub2Rlcztcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBSZXBsYWNlcyB0aGUgbGluayBkYXRhXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0xpbmt9ICBsaW5rcyAgIFRoZSBsaW5rc1xuXHRcdFx0ICovXG5cdFx0XHR1cGRhdGVMaW5rcyhsaW5rcykge1xuXHRcdFx0XHR0aGlzLmxpbmtzID0gbGlua3M7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogUmV0dXJucyB0aGUgTmFtZSBhdHRyaWJ1dGUgb2YgdGhlIE5vZGUgd2l0aCB0aGUgXG5cdFx0XHQgKiBtYXRjaGluZyBpZFxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG5cdFx0XHQgKiBAcmV0dXJuICAgICB7c3RyaW5nfSAgbmFtZSBvZiB0aGUgbWF0Y2hpbmcgbm9kZVxuXHRcdFx0ICovXG5cdFx0XHRub2RlSWRUb05hbWUoaWQpIHtcblx0XHQgICAgICAgIHZhciBub2RlcyA9IHRoaXMubm9kZXM7XG5cdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0ICAgICAgICAgICAgaWYgKG5vZGVzW2ldLmlkID09IGlkKSB7XG5cdFx0ICAgICAgICAgICAgICAgIHJldHVybiBub2Rlc1tpXS5uYW1lO1xuXHRcdCAgICAgICAgICAgIH1cblx0XHQgICAgICAgIH1cblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBwcm9jZXNzIHRoZSBub2RlRGF0YSB0byBjcmVhdGUgTm9kZSBvYmplY3RzXG5cdFx0ICAgICAqXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVEYXRhICBOb2RlRGF0YSB0byBjb252ZXJ0IFxuXHRcdCAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gbm9kZSBvYmplY3RzXG5cdFx0ICAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIE5vZGUgb2JqZWN0c1xuXHRcdCAgICAgKi9cblx0XHQgICAgcHJvY2Vzc05vZGVEYXRhKG5vZGVEYXRhKSB7XG5cdFx0ICAgICAgICB2YXIgbm9kZXMgPSBbXTtcblx0XHQgICAgICAgIF8uZm9yRWFjaChub2RlRGF0YSwgZnVuY3Rpb24oZGF0YSkge1xuXHRcdCAgICAgICAgICAgIHZhciBuZXdOb2RlID0gbmV3IE5vZGUuTm9kZShudWxsLCBudWxsLCBkYXRhLmlkLCBkYXRhLnRleHQsIG51bGwpO1xuXHRcdCAgICAgICAgICAgIG5vZGVzLnB1c2gobmV3Tm9kZSk7XG5cdFx0ICAgICAgICB9KTtcblx0XHQgICAgICAgIHJldHVybiBub2Rlcztcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBwcm9jZXNzIHRoZSBsaW5rRGF0YVxuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBsaW5rRGF0YSAgVGhlIGxpbmsgZGF0YVxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlcyAgICAgVGhlIG5vZGVzIGZyb20gcHJvY2Vzc05vZGVEYXRhXG5cdFx0ICAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIExpbmsgb2JqZWN0c1xuXHRcdCAgICAgKi9cblx0XHQgICAgcHJvY2Vzc0xpbmtEYXRhKGxpbmtEYXRhLCBub2Rlcykge1xuXHRcdCAgICBcdC8qKlxuXHRcdFx0ICAgICAqIFJldHVybnMgdGhlIG5vZGUgdGhhdCBtYXRjaGVzIHRoZSBpZFxuXHRcdFx0ICAgICAqXG5cdFx0XHQgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gaWQgICAgICBUaGUgaWRlbnRpZmllclxuXHRcdFx0ICAgICAqIEByZXR1cm4gICAgIHtOb2RlfSAgIFRoZSBub2RlIHdpdGggdGhlIG1hdGNoaW5nIGlkXG5cdFx0XHQgICAgICovXG5cdFx0XHQgICAgZnVuY3Rpb24gZmluZE5vZGVCeUlkKGlkLCBub2Rlcykge1xuXHRcdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHQgICAgICAgICAgICBpZiAoaWQgPT0gbm9kZXNbaV0uaWQpIHtcblx0XHRcdCAgICAgICAgICAgICAgICByZXR1cm4gbm9kZXNbaV07XG5cdFx0XHQgICAgICAgICAgICB9XG5cdFx0XHQgICAgICAgIH1cblx0XHRcdCAgICB9XG5cblx0XHQgICAgICAgIHZhciBsaW5rcyA9IFtdO1xuXHRcdCAgICAgICAgLy90cmFuc2Zvcm1pbmcgbGluayBkYXRhXG5cdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpbmtEYXRhLmxlbmd0aDsgaSsrKSB7XG5cdFx0ICAgICAgICAgICAgaWYgKGxpbmtEYXRhW2ldLnNvdXJjZSAhPSBsaW5rRGF0YVtpXS50YXJnZXQpIHtcblx0XHQgICAgICAgICAgICAgICAgdmFyIHNvdXJjZSA9IGZpbmROb2RlQnlJZChsaW5rRGF0YVtpXS5zb3VyY2UsIG5vZGVzKTtcblx0XHQgICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IGZpbmROb2RlQnlJZChsaW5rRGF0YVtpXS50YXJnZXQsIG5vZGVzKTtcblx0XHQgICAgICAgICAgICAgICAgaWYgKHNvdXJjZSA9PSBudWxsIHx8IHRhcmdldCA9PSBudWxsKSB7XG5cdFx0ICAgICAgICAgICAgICAgIFx0Y29udGludWU7XG5cdFx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICB2YXIgbGluayA9IG5ldyBMaW5rLkxpbmsoc291cmNlLCB0YXJnZXQpO1xuXHQgICAgICAgICAgICAgICAgICAgIGxpbmtzLnB1c2gobGluayk7XG5cdFx0ICAgICAgICAgICAgfSAgXG5cdFx0ICAgICAgICB9XG5cdFx0ICAgICAgICByZXR1cm4gbGlua3M7XG5cdFx0ICAgIH1cblx0XHR9XG5cdFx0cmV0dXJuIHtcblx0XHRcdERhdGFTb3VyY2U6RGF0YVNvdXJjZVxuXHRcdH1cbn1dKTtcblxuXG5cblxuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8xNC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5tb2RlbHMnLCBbXSk7XG52YXIgQ29udGl2R2xvYmFscyA9IChmdW5jdGlvbiAoKSB7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICAvL1JFU1QgZW5kcG9pbnRzIGZvciBORVRNQVNURVJcbiAgICAgICAgJ05FVFdPUktTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL25ldHdvcmtzLycsXG4gICAgICAgICdORVRXT1JLU19JTlNQRUNUX0VORFBPSU5UJzonL25ldG1hc3Rlci9hcGkvdjEvaW5zcGVjdC9uZXR3b3Jrcy8nLFxuICAgICAgICAnU0VSVklDRUxCU19JTlNQRUNUX0VORFBPSU5UJzonL25ldG1hc3Rlci9hcGkvdjEvaW5zcGVjdC9zZXJ2aWNlTEJzLycsXG4gICAgICAgICdQT0xJQ0lFU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9wb2xpY3lzLycsXG4gICAgICAgICdSVUxFU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9ydWxlcy8nLFxuICAgICAgICAnQVBQTElDQVRJT05HUk9VUFNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvZW5kcG9pbnRHcm91cHMvJyxcbiAgICAgICAgJ1NFUlZJQ0VMQlNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvc2VydmljZUxCcy8nLFxuICAgICAgICAnT1JHQU5JWkFUSU9OU19FTkRQT0lOVCc6Jy9uZXRtYXN0ZXIvYXBpL3YxL3RlbmFudHMvJyxcbiAgICAgICAgJ05FVFdPUktfU0VUVElOR1NfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvZ2xvYmFscy8nLFxuICAgICAgICAnTkVUUFJPRklMRVNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvbmV0cHJvZmlsZXMvJyxcbiAgICAgICAgJ0JHUFNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvQmdwcy8nLFxuICAgICAgICAnQkdQU19JTlNQRUNUX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL2luc3BlY3QvQmdwcy8nLFxuICAgICAgICAnVklTVUFMSVpBVElPTl9FTkRQT0lOVCc6ICcvdmlzdWFsaXphdGlvbi8nLFxuXG4gICAgICAgIC8vUkVTVCBlbmRwb2ludHMgZm9yIFZPTE1BU1RFUlxuICAgICAgICAnVk9MVU1FU19FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3ZvbHVtZXMvJyxcbiAgICAgICAgJ1ZPTFVNRVNfQ1JFQVRFX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvdm9sdW1lcy9jcmVhdGUvJyxcbiAgICAgICAgJ1ZPTFVNRVNfREVMRVRFX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvdm9sdW1lcy9yZW1vdmUvJyxcbiAgICAgICAgJ1ZPTFVNRVNfQ09QWVNOQVBTSE9UU19FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3ZvbHVtZXMvY29weScsXG4gICAgICAgICdWT0xVTUVTX1VTRVNfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci91c2VzL21vdW50cy8nLFxuICAgICAgICAnVk9MVU1FU19TTkFQU0hPVFNfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci9zbmFwc2hvdHMvJyxcbiAgICAgICAgJ1NUT1JBR0VQT0xJQ0lFU19FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3BvbGljaWVzLycsXG4gICAgICAgICdWT0xVTUVTX0dMT0JBTF9FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL2dsb2JhbC8nLFxuXG4gICAgICAgIC8vUkVTVCBlbmRwb2ludHMgZm9yIENMVVNURVJcbiAgICAgICAgJ05PREVTX0xJU1RfRU5EUE9JTlQnOiAnL2luZm8vbm9kZXMnLFxuICAgICAgICAnTk9ERVNfRElTQ09WRVJfRU5EUE9JTlQnOiAnL2Rpc2NvdmVyL25vZGVzJyxcbiAgICAgICAgJ05PREVTX0NPTU1JU1NJT05fRU5EUE9JTlQnOiAnL2NvbW1pc3Npb24vbm9kZXMnLFxuICAgICAgICAnTk9ERVNfREVDT01NSVNTSU9OX0VORFBPSU5UJzogJy9kZWNvbW1pc3Npb24vbm9kZXMnLFxuICAgICAgICAnTk9ERVNfTUFJTlRFTkFOQ0VfRU5EUE9JTlQnOiAnL21haW50ZW5hbmNlL25vZGVzJyxcbiAgICAgICAgJ05PREVTX0xBU1RfSk9CX0VORFBPSU5UJzogJy9pbmZvL2pvYi9sYXN0JyxcbiAgICAgICAgJ05PREVTX0FDVElWRV9KT0JfRU5EUE9JTlQnOiAnL2luZm8vam9iL2FjdGl2ZScsXG4gICAgICAgICdOT0RFU19TRVRUSU5HU19TRVRfRU5EUE9JTlQnOiAnL2dsb2JhbHMnLFxuICAgICAgICAnTk9ERVNfU0VUVElOR1NfR0VUX0VORFBPSU5UJzogJy9pbmZvL2dsb2JhbHMnLFxuXG4gICAgICAgIC8vUmVmcmVzaCBpbnRlcnZhbCBpbiBtaWxsaXNlY29uZHNcbiAgICAgICAgJ1JFRlJFU0hfSU5URVJWQUwnOiA1MDAwLFxuXG4gICAgICAgIC8vUmVnRXggZm9yIHZhbGlkYXRpb25cbiAgICAgICAgJ0NJRFJfUkVHRVgnIDogJ14oKFswLTldfFsxLTldWzAtOV18MVswLTldezJ9fDJbMC00XVswLTldfDI1WzAtNV0pXFwuKXszfShbMC05XXxbMS05XVswLTldfDFbMC05XXsyfXwyWzAtNF1bMC05XXwyNVswLTVdKShcXC8oWzAtOV18WzEtMl1bMC05XXwzWzAtMl0pKSQnLFxuICAgICAgICAnVkxBTl9SRUdFWCcgOiAnXihbMC05XXsxLDR9Py1bMC05XXsxLDR9PykkJyxcbiAgICAgICAgJ1ZYTEFOX1JFR0VYJyA6ICdeKFswLTldezEsOH0/LVswLTldezEsOH0/KSQnLFxuICAgICAgICAnTlVNQkVSX1JFR0VYJyA6ICdeWzAtOV0qJCdcbiAgICB9XG59KSgpO1xuIiwiLyoqXG4gKiBUaGUgRGF0YVNvdXJjZSB1c2VkIGZvciB0aGUgdmlzdWFsaXphdGlvbiB0YWIuXG4gKiBcbiAqIE5vZGUgRGF0YSBmcm9tIHRoZSBzZXJ2ZXIgaXMgZXhwZWN0ZWQgdG8gYmUgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6XG4gKiB7aWQ6IG5vZGVfaWQsIHRleHQ6IG5vZGVfdGV4dH1cbiAqIFBhcmVudCBhbmQgQW5jZXN0b3IgYXR0cmlidXRlcyBjYW4gYmUgc2V0IGJ5IGNhbGxpbmcgc2V0QW5jZXN0b3JzXG4gKiBcbiAqIExpbmsgRGF0YSBmcm9tIHRoZSBzZXJ2ZXIgaXMgZXhwZWN0ZWQgdG8gYmUgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6XG4gKiB7c291cmNlOiBzb3VyY2VOb2RlSWQsIHRhcmdldDogdGFyZ2V0Tm9kZUlkLCB3ZWlnaHQ6IGxpbmtXZWlnaHR9XG4gKiBcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ1Zpc3VhbGl6ZXJEYXRhU291cmNlJywgWydEYXRhU291cmNlJywgJ1Zpc3VhbGl6ZXJOb2RlJywgJ1Zpc3VhbGl6ZXJMaW5rJywgXG4gICAgXHRmdW5jdGlvbiAoRGF0YVNvdXJjZSwgVmlzdWFsaXplck5vZGUsIFZpc3VhbGl6ZXJMaW5rKSB7XG5cbiAgICBcdGNsYXNzIFZpc3VhbGl6ZXJEYXRhU291cmNlIGV4dGVuZHMgRGF0YVNvdXJjZS5EYXRhU291cmNlIHtcbiAgICBcdFx0LyoqXG4gICAgXHRcdCAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICBcdFx0ICogXG4gICAgXHRcdCAqIENoaWxkcmVuIFN0cnVjdCBhbmQgYW5jZXN0b3JzX3N0cnVjdCBhcmUgSlNPTiBvYmplY3RzLFxuICAgIFx0XHQgKiBtYXBwaW5nIGEgbm9kZSBJZCB0byBhIGxpc3Qgb2YgaXQncyBjaGlsZHJlbiBvciBhbmNlc3RvcnMuXG4gICAgXHRcdCAqIENoaWxkcmVuIFN0cnVjdCBpcyBhbHNvIGV4cGVjdGVkIHRvIGhhdmUgYSBmaWVsZCBjYWxsZWRcbiAgICBcdFx0ICogdG9wTGV2ZWwsIHRoYXQgbWFwcyB0byBhIGxpc3Qgb2YgYWxsIHRoZSBub2RlcyB0aGF0IGRvbid0XG4gICAgXHRcdCAqIGhhdmUgYW55IHBhcmVudHMuXG4gICAgXHRcdCAqXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBub2RlcyAgICAgICAgICAgICAgVGhlIG5vZGUgZGF0YSBcbiAgICBcdFx0ICogQHBhcmFtICAgICAge0FycmF5fSAgIGxpbmtzICAgICAgICAgICAgICBUaGUgbGluayBkYXRhXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBjaGlsZHJlbl9zdHJ1Y3QgICAgVGhlIGNoaWxkcmVuIHN0cnVjdHVyZVxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgYW5jZXN0b3JzX3N0cnVjdCAgIFRoZSBhbmNlc3RvcnMgc3RydWN0dXJlXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBsYWJlbHMgICAgICAgICAgICAgVGhlIGxhYmVsc1xuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgc2VsZWN0b3JzICAgICAgICAgIFRoZSBzZWxlY3RvcnNcbiAgICBcdFx0ICovXG5cdFx0XHRjb25zdHJ1Y3Rvcihub2RlcywgbGlua3MsIGNoaWxkcmVuX3N0cnVjdCwgYW5jZXN0b3JzX3N0cnVjdCwgXG5cdFx0XHRcdFx0bGFiZWxzLCBzZWxlY3RvcnMpIHtcblx0XHRcdFx0c3VwZXIobm9kZXMsbGlua3MpO1xuXHRcdFx0XHR0aGlzLmNoaWxkcmVuX3N0cnVjdCA9IGNoaWxkcmVuX3N0cnVjdDtcblx0XHRcdFx0dGhpcy5hbmNlc3RvcnNfc3RydWN0ID0gYW5jZXN0b3JzX3N0cnVjdDtcblx0XHRcdFx0dGhpcy5sYWJlbHMgPSBsYWJlbHM7XG5cdFx0XHRcdHRoaXMuc2VsZWN0b3JzID0gc2VsZWN0b3JzO1xuXHRcdFx0fVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBEZXRlcm1pbmVzIGlmIGl0IGhhcyBjaGlsZC5cblx0XHQgICAgICpcblx0XHQgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gICBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG5cdFx0ICAgICAqIEByZXR1cm4gICAgIHtib29sZWFufSAgVHJ1ZSBpZiBoYXMgY2hpbGQsIEZhbHNlIG90aGVyd2lzZS5cblx0XHQgICAgICovXG5cdFx0ICAgIGhhc0NoaWxkKGlkKSB7XG5cdFx0ICAgIFx0aWYgKHRoaXMuY2hpbGRyZW5fc3RydWN0W2lkXSA9PSBudWxsKSB7XG4gICAgICAgICAgICBcdFx0cmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgXHR9XG4gICAgICAgICAgICBcdHJldHVybiB0cnVlO1x0XG5cdFx0ICAgIH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogU2V0cyB0aGUgcGFyZW50IGFuZCBhbmNlc3RvcnMgYXR0cmlidXRlIHVzaW5nIFxuXHRcdCAgICAgKiBhbmNlc3RvcnNfc3RydWN0IGZvciBhbGwgdGhlIG5vZGVzXG5cdFx0ICAgICAqIEFsc28gYWRkcyBhbnkgbm9kZXMgd2l0aG91dCBhbmNlc3RvcnMsIHRoYXQgYXJlbid0IFxuXHRcdCAgICAgKiB0b3BsZXZlbCB0byB0aGUgY2xpZW50IHNlcnZpY2UuXG5cdFx0ICAgICAqL1xuXHRcdCAgICBzZXRBbmNlc3RvcnMoKSB7XG5cdFx0ICAgIFx0dmFyIHRoaXNEYXRhU291cmNlID0gdGhpcztcblx0XHQgICAgXHR2YXIgYWRkZWRDbGllbnQgPSBmYWxzZTtcblx0XHQgICAgXHRfLmZvckVhY2godGhpc0RhdGFTb3VyY2Uubm9kZXMsIGZ1bmN0aW9uKG5vZGUpIHtcblx0XHQgICAgXHRcdG5vZGUuYW5jZXN0b3JzID0gdGhpc0RhdGFTb3VyY2UuYW5jZXN0b3JzX3N0cnVjdFtub2RlLmlkXSB8fCBbXTtcblx0XHQgICAgXHRcdGlmIChfLmlzRW1wdHkobm9kZS5hbmNlc3RvcnMpID09PSBmYWxzZSkge1xuXHRcdCAgICBcdFx0XHRub2RlLnBhcmVudCA9IG5vZGUuYW5jZXN0b3JzWzBdO1xuXHRcdCAgICBcdFx0fSBlbHNlIHtcblx0XHQgICAgXHRcdFx0aWYgKF8uaW5jbHVkZXModGhpc0RhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0LnRvcExldmVsLCBub2RlLmlkKSA9PSBmYWxzZSkge1xuXHRcdCAgICBcdFx0XHRcdC8vY29udGFpbmVyIGhhcyBubyBwYXJlbnRcblx0XHQgICAgXHRcdFx0XHQvL2FkZGluZyB0byBjbGllbnRcblx0XHQgICAgXHRcdFx0XHRub2RlLmFuY2VzdG9ycy5wdXNoKFwiY2xpZW50XCIpO1xuXHRcdCAgICBcdFx0XHRcdHRoaXNEYXRhU291cmNlLmFuY2VzdG9yc19zdHJ1Y3Rbbm9kZS5pZF0gPSBbXCJjbGllbnRcIl07XG5cdFx0ICAgIFx0XHRcdFx0aWYgKGFkZGVkQ2xpZW50ID09PSBmYWxzZSkge1xuXHRcdCAgICBcdFx0XHRcdFx0YWRkZWRDbGllbnQgPSB0cnVlO1xuXHRcdFx0ICAgIFx0XHRcdFx0dGhpc0RhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0LnRvcExldmVsLnB1c2goXCJjbGllbnRcIik7XG5cdFx0ICAgIFx0XHRcdFx0XHR0aGlzRGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbJ2NsaWVudCddID0gW107XG5cdFx0ICAgIFx0XHRcdFx0fVxuXHRcdCAgICBcdFx0XHRcdHRoaXNEYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFsnY2xpZW50J10ucHVzaChub2RlLmlkKTtcblx0XHRcdCAgICBcdFx0fVxuXHRcdCAgICBcdFx0fVxuXHRcdCAgICBcdH0pXG5cdFx0ICAgIH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogUmV0dXJucyB0aGUgZmxvdyBiZXR3ZWVuIHRoZSBoaWdoZXN0IGxldmVsIGdyb3VwaW5nXG5cdFx0ICAgICAqXG5cdFx0ICAgICAqIEByZXR1cm4gICAgIHtPYmplY3R9ICBUaGUgdG9wIGxldmVsIGZsb3cuXG5cdFx0ICAgICAqL1xuXHRcdCAgICBnZXRUb3BMZXZlbEZsb3coKSB7XG5cdFx0ICAgICAgICByZXR1cm4gdGhpcy5nZXRGbG93QmV0d2VlblNldCh0aGlzLmNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbCk7XG5cdFx0ICAgIH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogR2V0cyB0aGUgZmxvdyBiZXR3ZWVuIGFueSBzZXQgb2Ygbm9kZSBsZXZlbHNcblx0XHQgICAgICpcblx0XHQgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZV9uYW1lcyAgVGhlIG5vZGUgbmFtZXMgaW4gdGhlIHNldFxuXHRcdCAgICAgKiBAcmV0dXJuICAgICB7T2JqZWN0fSAgVGhlIGZsb3cgYmV0d2VlbiBzZXQuXG5cdFx0ICAgICAqL1xuXHRcdCAgICBnZXRGbG93QmV0d2VlblNldChub2RlX25hbWVzKSB7XG5cdFx0ICAgICAgICB2YXIgbG9jYWxfbm9kZXMgPSB0aGlzLm5vZGVzO1xuXHRcdCAgICAgICAgdmFyIGlkTWFwcGluZyA9IHt9O1xuXHRcdCAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsb2NhbF9ub2Rlcy5sZW5ndGg7IGkrKykge1xuXHRcdCAgICAgICAgICAgIHZhciBub2RlID0gbG9jYWxfbm9kZXNbaV07XG5cblx0XHQgICAgICAgICAgICAvL2lmIG5vZGUgaXMgYWxyZWFkeSBhdCBpdHMgaGlnaGVzdCBsZXZlbFxuXHRcdCAgICAgICAgICAgIGlmIChub2RlLmFuY2VzdG9ycyA9PT0gbnVsbCkge1xuXHRcdCAgICAgICAgICAgICAgICBpZE1hcHBpbmdbbm9kZS5pZF0gPSBub2RlLm5hbWU7XG5cdFx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0XHQgICAgICAgICAgICAgICAgLy9jaGVjayB0byBzZWUgd2hpY2ggdGFncyBhcmUgcHJlc2VudCBpbiB0aGUgYW5jZXN0b3IgbGlzdFxuXHRcdCAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG5vZGVfbmFtZXMubGVuZ3RoOyBqKyspIHtcblx0XHQgICAgICAgICAgICAgICAgICAgIGlmIChub2RlLmFuY2VzdG9ycy5pbmRleE9mKG5vZGVfbmFtZXNbal0pID4gLTEpIHtcblx0XHQgICAgICAgICAgICAgICAgICAgICAgICBpZE1hcHBpbmdbbm9kZS5pZF0gPSBub2RlX25hbWVzW2pdO1xuXHRcdCAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXHRcdCAgICAgICAgICAgICAgICAgICAgfVxuXHRcdCAgICAgICAgICAgICAgICB9XG5cdFx0ICAgICAgICAgICAgfVxuXHRcdCAgICAgICAgfSAgIFxuXHRcdCAgICAgICAgLy9tb2RpZnkgbGlua3Ncblx0XHQgICAgICAgIHZhciBsaW5rcyA9IHRoaXMubGlua3M7XG5cdFx0ICAgICAgICB2YXIgbGlua0RhdGEgPSBbXTtcblx0XHQgICAgICAgIFxuXHRcdCAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5rcy5sZW5ndGg7IGkrKykge1xuXHRcdCAgICAgICAgICAgIHZhciBsaW5rID0gW107XG5cdFx0ICAgICAgICAgICAgbGluay5zb3VyY2UgPSBpZE1hcHBpbmdbbGlua3NbaV0uc291cmNlXSB8fCBsaW5rc1tpXS5zb3VyY2U7XG5cdFx0ICAgICAgICAgICAgbGluay50YXJnZXQgPSBpZE1hcHBpbmdbbGlua3NbaV0udGFyZ2V0XSB8fCBsaW5rc1tpXS50YXJnZXQ7XG5cdFx0ICAgICAgICAgICAgbGluay53ZWlnaHQgPSBsaW5rc1tpXS53ZWlnaHQ7XG5cdFx0ICAgICAgICAgICAgbGlua0RhdGEucHVzaChsaW5rKTtcblx0XHQgICAgICAgIH1cblxuXHRcdCAgICAgICAgLy9jcmVhdGluZyB0aGUgbm9kZURhdGFcblx0XHQgICAgICAgIHZhciBub2RlRGF0YSA9IFtdO1xuXHRcdCAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2RlX25hbWVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0ICAgICAgICAgICAgdmFyIG5vZGVfdG9fYWRkID0gW107XG5cdFx0ICAgICAgICAgICAgbm9kZV90b19hZGQuaWQgPSBub2RlX25hbWVzW2ldO1xuXHRcdCAgICAgICAgICAgIG5vZGVfdG9fYWRkLnRleHQgPSB0aGlzLm5vZGVJZFRvTmFtZShub2RlX25hbWVzW2ldKSB8fCBub2RlX25hbWVzW2ldO1xuXG5cblx0XHQgICAgICAgICAgICBub2RlX3RvX2FkZC5hbmNlc3RvcnMgPSB0aGlzLmFuY2VzdG9yc19zdHJ1Y3Rbbm9kZV9uYW1lc1tpXV0gfHwgdGhpcy5hbmNlc3RvcnNfc3RydWN0W25vZGVfdG9fYWRkLnRleHRdIHx8IFtdO1xuXHRcdCAgICAgICAgICAgIGlmIChfLmlzRW1wdHkobm9kZV90b19hZGQuYW5jZXN0b3JzKSA9PT0gZmFsc2UpIHtcblx0XHQgICAgICAgICAgICAgICAgbm9kZV90b19hZGQucGFyZW50ID0gbm9kZV90b19hZGQuYW5jZXN0b3JzWzBdO1xuXHRcdCAgICAgICAgICAgIH0gZWxzZSB7XG5cdFx0ICAgICAgICAgICAgICAgIG5vZGVfdG9fYWRkLnBhcmVudCA9IG51bGw7XG5cdFx0ICAgICAgICAgICAgfVxuXHRcdCAgICAgICAgICAgIG5vZGVEYXRhLnB1c2gobm9kZV90b19hZGQpO1xuXHRcdCAgICAgICAgfVxuXG5cdFx0ICAgICAgICByZXR1cm4ge25vZGVEYXRhOm5vZGVEYXRhLCBsaW5rRGF0YTpsaW5rRGF0YX07XG5cdFx0ICAgIH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogcHJvY2VzcyB0aGUgbm9kZURhdGEgb3V0cHV0IG9mIGdldEZsb3dCZXR3ZWVuU2V0XG5cdFx0ICAgICAqXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVEYXRhICBOb2RlRGF0YSB0byBjb252ZXJ0IFxuXHRcdCAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gbm9kZSBvYmplY3RzXG5cdFx0ICAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIE5vZGUgb2JqZWN0c1xuXHRcdCAgICAgKi9cblx0XHQgICAgcHJvY2Vzc05vZGVEYXRhKG5vZGVEYXRhKSB7XG5cdFx0ICAgICAgICB2YXIgbm9kZXMgPSBbXTtcblx0XHQgICAgICAgIF8uZm9yRWFjaChub2RlRGF0YSwgZnVuY3Rpb24oZGF0YSkge1xuXHRcdCAgICAgICAgICAgIHZhciBuZXdOb2RlID0gbmV3IFZpc3VhbGl6ZXJOb2RlLk5vZGUobnVsbCwgbnVsbCwgZGF0YS5pZCwgZGF0YS50ZXh0LFxuXHRcdCAgICAgICAgICAgICAgICBudWxsLCBkYXRhLnBhcmVudCwgZGF0YS5hbmNlc3RvcnMsIG51bGwsIG51bGwpO1xuXHRcdCAgICAgICAgICAgIG5vZGVzLnB1c2gobmV3Tm9kZSk7XG5cdFx0ICAgICAgICB9KTtcblx0XHQgICAgICAgIHJldHVybiBub2Rlcztcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBwcm9jZXNzIHRoZSBsaW5rRGF0YSBvdXRwdXQgb2YgZ2V0Rmxvd0JldHdlZW5TZXRcblx0XHQgICAgICpcblx0XHQgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbGlua0RhdGEgIFRoZSBsaW5rIGRhdGFcblx0XHQgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZXMgICAgIFRoZSBub2Rlc1xuXHRcdCAgICAgKiBAcmV0dXJuICAgICB7QXJyYXl9ICBMaW5rIG9iamVjdHNcblx0XHQgICAgICovXG5cdFx0ICAgIHByb2Nlc3NMaW5rRGF0YShsaW5rRGF0YSwgbm9kZXMpIHtcblx0XHQgICAgXHQvKipcblx0XHRcdCAgICAgKiBSZXR1cm5zIHRoZSBub2RlIHRoYXQgbWF0Y2hlcyB0aGUgaWRcblx0XHRcdCAgICAgKlxuXHRcdFx0ICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9IGlkICAgICAgVGhlIGlkZW50aWZpZXJcblx0XHRcdCAgICAgKiBAcmV0dXJuICAgICB7Tm9kZX0gICBUaGUgbm9kZSB3aXRoIHRoZSBtYXRjaGluZyBpZFxuXHRcdFx0ICAgICAqL1xuXHRcdFx0ICAgIGZ1bmN0aW9uIGZpbmROb2RlQnlJZChpZCwgbm9kZXMpIHtcblx0XHRcdCAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0ICAgICAgICAgICAgaWYgKGlkID09IG5vZGVzW2ldLmlkKSB7XG5cdFx0XHQgICAgICAgICAgICAgICAgcmV0dXJuIG5vZGVzW2ldO1xuXHRcdFx0ICAgICAgICAgICAgfVxuXHRcdFx0ICAgICAgICB9XG5cdFx0XHQgICAgfVxuXG5cdFx0ICAgICAgICB2YXIgbGlua3MgPSBbXTtcblx0XHQgICAgICAgIC8vYSBtYXBwaW5nIGZyb20gc291cmNlLmlkLXRhcmdldC5pZCB0byB0aGUgbGluayBhZGRlZFxuXHRcdCAgICAgICAgdmFyIGFkZGVkX2xpbmtzID0ge307XG5cdFx0ICAgICAgICAvL3RyYW5zZm9ybWluZyBsaW5rIGRhdGFcblx0XHQgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGlua0RhdGEubGVuZ3RoOyBpKyspIHtcblx0XHQgICAgICAgICAgICBpZiAobGlua0RhdGFbaV0uc291cmNlICE9IGxpbmtEYXRhW2ldLnRhcmdldCkge1xuXHRcdCAgICAgICAgICAgICAgICB2YXIgc291cmNlID0gZmluZE5vZGVCeUlkKGxpbmtEYXRhW2ldLnNvdXJjZSwgbm9kZXMpO1xuXHRcdCAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0ID0gZmluZE5vZGVCeUlkKGxpbmtEYXRhW2ldLnRhcmdldCwgbm9kZXMpO1xuXHRcdCAgICAgICAgICAgICAgICB2YXIgd2VpZ2h0ID0gbGlua0RhdGFbaV0ud2VpZ2h0O1xuXHRcdCAgICAgICAgICAgICAgICAvL2luIG9yZGVyIHRvIHN1bSBhbGwgdGhlIHdlaWdodHMgb2YgdGhlIGxpbmtzIG9mIHRoZSBzdWItbm9kZXMsXG5cdFx0ICAgICAgICAgICAgICAgIC8vd2UgdXNlIGFkZGVkX2xpbmtzIHRvIGtlZXAgdHJhY2sgaWYgYW4gbGluayB3YXMgYWRkZWRcblx0XHQgICAgICAgICAgICAgICAgLy9pZiBpdCBpcywgd2UgbW9kaWZ5IGl0cyB3ZWlnaHRcblx0XHQgICAgICAgICAgICAgICAgaWYgKHNvdXJjZSA9PSBudWxsIHx8IHRhcmdldCA9PSBudWxsKSB7XG5cdFx0ICAgICAgICAgICAgICAgIFx0Y29udGludWU7XG5cdFx0ICAgICAgICAgICAgICAgIH1cblx0XHQgICAgICAgICAgICAgICAgaWYgKGFkZGVkX2xpbmtzW3NvdXJjZS5pZCArICctJyArIHRhcmdldC5pZF0gPT09IHVuZGVmaW5lZCkge1xuXHRcdCAgICAgICAgICAgICAgICAgICAgdmFyIGxpbmsgPSBuZXcgVmlzdWFsaXplckxpbmsuTGluayhzb3VyY2UsIHRhcmdldCwgd2VpZ2h0KTtcblx0XHQgICAgICAgICAgICAgICAgICAgIGFkZGVkX2xpbmtzW3NvdXJjZS5pZCArICctJyArIHRhcmdldC5pZF0gPSBsaW5rO1xuXHRcdCAgICAgICAgICAgICAgICAgICAgbGlua3MucHVzaChsaW5rKTtcblx0XHQgICAgICAgICAgICAgICAgfSBlbHNlIHtcblx0XHQgICAgICAgICAgICAgICAgICAgIHZhciBleGlzdGluZ19saW5rID0gYWRkZWRfbGlua3Nbc291cmNlLmlkICsgJy0nICsgdGFyZ2V0LmlkXTtcblx0XHQgICAgICAgICAgICAgICAgICAgIGV4aXN0aW5nX2xpbmsuc2V0V2VpZ2h0KGV4aXN0aW5nX2xpbmsuZ2V0UmF3V2VpZ2h0KCkgKyB3ZWlnaHQpO1xuXHRcdCAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdfbGluay5pbmNyZWFzZUNvdW50KCk7XG5cdFx0ICAgICAgICAgICAgICAgIH1cblx0XHQgICAgICAgICAgICB9ICBcblx0XHQgICAgICAgIH1cblx0XHQgICAgICAgIHJldHVybiBsaW5rcztcblx0XHQgICAgfVxuXHRcdH1cblx0XHRyZXR1cm4ge1xuXHRcdFx0RGF0YVNvdXJjZTogVmlzdWFsaXplckRhdGFTb3VyY2Vcblx0XHR9XG59XSk7XG5cblxuXG5cblxuXG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudXRpbHMnLCBbXSk7IiwiLyoqXG4gKiBUaGUgYmFzZSBjbGFzcyB0aGUgZ3JhcGggb2JqZWN0LiBBbnkgbm9kZXMgb3IgbGlua3MgdGhhdCBhcmUgY29udGFpbmVkIGluXG4gKiBpdHMgbm9kZXMgb3IgbGlua3MgcHJvcGVydHkgd2lsbCBiZSBkcmF3biBvbiB1cGRhdGVHcmFwaC5cbiAqIFN1cHBvcnRzIHBvbGljaWVzLlxuICogXG4gKiBUbyB3cml0ZSB5b3VyIG93biBncmFwaCBvYmplY3QsIGNyZWF0ZSBhIG5ldyBmYWN0b3J5IHRoYXQgdXNlcyB0aGUgZ3JhcGhcbiAqIHlvdSB3YW50IHRvIGluaGVyaXQgYXMgYSBkZXBlbmRlbmN5LCBhbmQgZXh0ZW5kIGl0cyBncmFwaCBjbGFzcy4gXG4gKiBSZXR1cm4gdGhlIGNsYXNzIG9iamVjdCB3aXRoIEdyYXBoIGFzIGtleS5cbiAqIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnR3JhcGgnLCBbJ1BvbGljeVNlcnZpY2UnLCBmdW5jdGlvbiAoUG9saWN5U2VydmljZSkge1xuICAgICAgICBjbGFzcyBHcmFwaCB7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIGNvbnN0cnVjdG9yIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBTVkd9ICBzdmcgICAgIFRoZSBzdmcgdGhhdCB3aWxsIFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob2xkIHRoZSBncmFwaFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZXMgICAgICBMaXN0IG9mIG5vZGVzIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIGxpbmtzICAgICAgTGlzdCBvZiBsaW5rcyBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHN2Zywgbm9kZXMsIGxpbmtzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMgPSBub2RlcyB8fCBbXTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MgPSBsaW5rcyB8fCBbXTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzID0gW107XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMgPSBbXTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3kgPSBuZXcgUG9saWN5U2VydmljZS5Qb2xpY3koKTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgY2FuWm9vbTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgY2FuUGFuOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpbml0Rm9yY2U6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlVXBkYXRlOiBmYWxzZVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY29uc3RzID0ge1xuICAgICAgICAgICAgICAgICAgICBjaXJjbGVHQ2xhc3M6IFwiY29uY2VwdEdcIixcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGhDbGFzczogXCJncmFwaFwiLFxuICAgICAgICAgICAgICAgICAgICBwYXRoQ2xhc3M6IFwicGF0aFwiLFxuICAgICAgICAgICAgICAgICAgICBub2RlQ2xhc3M6IFwiY2lyY2xlXCIsXG4gICAgICAgICAgICAgICAgICAgIG5vZGVUZXh0OiBcIm5vZGVUZXh0XCIsXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0UmFkaXVzOiA1MCxcbiAgICAgICAgICAgICAgICAgICAgbWF4UmFkaXVzOiA2MCxcbiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogNSxcbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheU9mZnNldDogNjBcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgc3ZnLm9uKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcIm1vdXNlb3ZlclwiXS5jYWxsKHRoaXMsIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiZGJsY2xpY2tcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcImRibGNsaWNrXCJdLmNhbGwodGhpcywgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJjb250ZXh0bWVudVwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wiY29udGV4dG1lbnVcIl0uY2FsbCh0aGlzLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcIm1vdXNlb3V0XCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcIm1vdXNlb3V0XCJdLmNhbGwodGhpcywgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wibW91c2Vkb3duXCJdLmNhbGwodGhpcywgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZXVwXCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcIm1vdXNldXBcIl0uY2FsbCh0aGlzLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8gZGVmaW5lIGFycm93IG1hcmtlcnMgZm9yIGdyYXBoIGxpbmtzXG4gICAgICAgICAgICAgICAgdmFyIGRlZnMgPSBzdmcuYXBwZW5kKCdzdmc6ZGVmcycpO1xuICAgICAgICAgICAgICAgIGRlZnMuYXBwZW5kKCdzdmc6bWFya2VyJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2lkJywgJ2VuZC1hcnJvdycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwidmlld0JveFwiLCBcIjAgLTUgMTAgMTBcIilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJyZWZYXCIsIDIwKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcInJlZllcIiwgLTEpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwibWFya2VyV2lkdGhcIiwgNilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJtYXJrZXJIZWlnaHRcIiwgNilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJvcmllbnRcIiwgXCJhdXRvXCIpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJwYXRoXCIpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiZFwiLCBcIk0wLC01TDEwLDBMMCw1XCIpO1xuXG4gICAgICAgICAgICAgICAgLy8gZGVmaW5lIGFycm93IG1hcmtlcnMgZm9yIGxlYWRpbmcgYXJyb3dcbiAgICAgICAgICAgICAgICBkZWZzLmFwcGVuZCgnc3ZnOm1hcmtlcicpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdpZCcsICdtYXJrLWVuZC1hcnJvdycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd2aWV3Qm94JywgJzAgLTUgMTAgMTAnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigncmVmWCcsIDcpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdtYXJrZXJXaWR0aCcsIDMuNSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ21hcmtlckhlaWdodCcsIDMuNSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ29yaWVudCcsICdhdXRvJylcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgnc3ZnOnBhdGgnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignZCcsICdNMCwtNUwxMCwwTDAsNScpO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2ZyA9IHN2ZztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnRyA9IHN2Zy5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAgICAgICAgIC5jbGFzc2VkKHRoaXNHcmFwaC5jb25zdHMuZ3JhcGhDbGFzcywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z0cgPSB0aGlzR3JhcGguc3ZnRztcblxuICAgICAgICAgICAgICAgIC8vIHN2ZyBub2RlcyBhbmQgbGlua3MgXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzID0gc3ZnRy5hcHBlbmQoXCJnXCIpLnNlbGVjdEFsbChcImdcIik7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMgPSBzdmdHLmFwcGVuZChcImdcIikuc2VsZWN0QWxsKFwiZ1wiKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXRMaW5rcygpO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNldFBvc2l0aW9ucygpO1xuICAgICAgICAgICAgICAgIHZhciByZXNpemVGdW5jID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5vbldpbmRvd1Jlc2l6ZShzdmcpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguYmluZGluZ3MgPSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc2l6ZTpyZXNpemVGdW5jXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAkKHdpbmRvdykucmVzaXplKHJlc2l6ZUZ1bmMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIGNhbGxzIHRoZSBkZXN0cm95IG1ldGhvZCBmb3IgYWxsIHBvbGljaWVzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5LmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5LmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gdGhpc0dyYXBoLmJpbmRpbmdzKSB7XG4gICAgICAgICAgICAgICAgICAgICQod2luZG93KS5vZmYoa2V5LCB0aGlzR3JhcGguYmluZGluZ3Nba2V5XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJ1bnMgdGhlIGluaXQgZnVuY3Rpb24gZm9yIGFsbCB0aGUgbm9kZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5pdE5vZGVzKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUnVucyB0aGUgaW5pdCBmdW5jdGlvbiBmb3IgYWxsIHRoZSBsaW5rc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbml0TGlua3MoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5saW5rcywgZnVuY3Rpb24obGluaykge1xuICAgICAgICAgICAgICAgICAgICBsaW5rLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiByZXR1cm5zIHRoZSBub2RlIG1hdGNoaW5nIHRoZSBpZCwgXG4gICAgICAgICAgICAgKiBvciB1bmRlZmluZWQgaWYgdGhlcmUgaXMgbm9uZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7Tm9kZX0gIHsgbWF0Y2hpbmcgbm9kZSB9XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZpbmROb2RlQnlJZChpZCl7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSB0aGlzR3JhcGgubm9kZXNbaV0uaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzR3JhcGgubm9kZXNbaV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJldHVybnMgdGhlIGQzTm9kZSBvYmplY3QgdGhhdCBtYXRjaGVzIHRoZSBpZCxcbiAgICAgICAgICAgICAqIG9yIHVuZGVmaW5lZCBpZiB0aGVyZSBpcyBub25lXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGlkICAgICAgVGhlIGlkZW50aWZpZXJcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtEM05vZGV9IFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZpbmREM05vZGUoaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgZDNOb2RlO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2goZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5pZCA9PT0gaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQzTm9kZSA9IGQzLnNlbGVjdCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkM05vZGU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byBpbnN0YWxsIGEgZHJhZyBwb2xpY3kgdGhhdCB3aWxsIGJlIGNhbGxlZFxuICAgICAgICAgICAgICogd2hlbiBub2RlcyBhcmUgZHJhZ2dlZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkMy5iZWhhdmlvci5kcmFnfSAgZDNkcmFnICBEMyBkcmFnIG9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbnN0YWxsRHJhZ1BvbGljeShkM2RyYWcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRyYWcgPSBkM2RyYWc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byBpbnN0YWxsIGEgcG9saWN5IHRoYXQgd2lsbCBiZSBjYWxsZWQgXG4gICAgICAgICAgICAgKiB3aGVuIHRoZXJlIGlzIG1vdXNlIGludGVyYWN0aW9ucyB3aXRoIHRoZSBncmFwaCdzIHN2Z1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3kgIFRoZSBwb2xpY3kgdG8gaW5zdGFsbFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbnN0YWxsU3ZnUG9saWN5KHBvbGljeSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3ZnUG9saWN5ID0gcG9saWN5O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVzZWQgdG8gaW5zdGFsbCBwb2xpY2llcyB0aGF0IGFyZSBjYWxsZWQgd2hlbiB0aGVyZSBpc1xuICAgICAgICAgICAgICogbW91c2UgaW50ZXJhY3Rpb24gd2l0aCBhIG5vZGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UG9saWN5fSAgcG9saWN5ICBUaGUgcG9saWN5IHRvIGluc3RhbGxcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5zdGFsbERlZmF1bHROb2RlUG9saWN5KHBvbGljeSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzLnB1c2gocG9saWN5KTtcbiAgICAgICAgICAgICAgICBwb2xpY3kuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byByZW1vdmUgYW4gaW5zdGFsbGVkIHBvbGljeSBmb3Igbm9kZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHBvbGljeVJlbW92ZSAgVGhlIHBvbGljeSB0byByZW1vdmVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdW5pbnN0YWxsRGVmYXVsdE5vZGVQb2xpY3kocG9saWN5UmVtb3ZlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBvbGljeVJlbW92ZU5hbWU7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBwb2xpY3lSZW1vdmUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZS5wb2xpY3lOYW1lO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvbGljeS5wb2xpY3lOYW1lID09PSBwb2xpY3lSZW1vdmVOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2xpY3kuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJldHVybnMgdGhlIG5vZGUgcG9saWN5IG9iamVjdCB3aXRoIHRoZSBnaXZlbiBuYW1lXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHBvbGljeU5hbWUgIFRoZSBwb2xpY3kgbmFtZVxuICAgICAgICAgICAgICogQHJldHVybiAgICAge1BvbGljeX0gIHBvbGljeSAgICAgIFRoZSBtYXRjaGluZyBwb2xpY3lcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZ2V0Tm9kZVBvbGljeShwb2xpY3lOYW1lKSB7XG4gICAgICAgICAgICBcdHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3ksIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb2xpY3kucG9saWN5TmFtZSA9PT0gcG9saWN5TmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBvbGljeTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVzZWQgdG8gaW5zdGFsbCBwb2xpY2llcyB0aGF0IGFyZSBjYWxsZWQgd2hlbiB0aGVyZSBpcyBhXG4gICAgICAgICAgICAgKiBtb3VzZSBpbnRlcmFjdGlvbiB3aXRoIGEgcGF0aFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3kgIFRoZSBwb2xpY3kgdG8gaW5zdGFsbFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3kocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMucHVzaChwb2xpY3kpO1xuICAgICAgICAgICAgICAgIHBvbGljeS5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byByZW1vdmUgYW4gaW5zdGFsbGVkIHBvbGljeSBmb3IgbGlua3NcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UG9saWN5fSAgcG9saWN5UmVtb3ZlICBUaGUgcG9saWN5IHRvIHJlbW92ZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1bmluc3RhbGxEZWZhdWx0UGF0aFBvbGljeShwb2xpY3lSZW1vdmUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcG9saWN5UmVtb3ZlTmFtZTtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHBvbGljeVJlbW92ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlLnBvbGljeU5hbWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5LCBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9saWN5LnBvbGljeU5hbWUgPT09IHBvbGljeVJlbW92ZU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlcmUgaXMgYSBtb3VzZSBpbnRlcmFjdGlvbiB3aXRoIGEgcGF0aFxuICAgICAgICAgICAgICogUHJvcG9nYXRlcyB0aGUgZXZlbnQgdG8gYWxsIGluc3RhbGxlZCBwYXRoIHBvbGljaWVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGV2ZW50ICAgVGhlIGV2ZW50IHR5cGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM29iamVjdH0gIGQzcGF0aCAgVGhlIGQzIHBhdGhcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQYXRofSAgZCAgICAgICBUaGUgbWF0Y2hpbmcgTGluayBvYmplY3RcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgcGF0aFBvbGljeUV2ZW50KGV2ZW50LCBkM3BhdGgsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lbZXZlbnRdKGQzcGF0aCwgZCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGVyZSBpcyBhIG1vdXNlIGludGVyYWN0aW9uIHdpdGggYSBub2RlXG4gICAgICAgICAgICAgKiBQcm9wb2dhdGVzIHRoZSBldmVudCB0byBhbGwgaW5zdGFsbGVkIG5vZGUgcG9saWNpZXNcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGV2ZW50ICAgVGhlIGV2ZW50IHR5cGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM29iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQYXRofSAgZCAgICAgICBUaGUgbWF0Y2hpbmcgTm9kZSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgbm9kZVBvbGljeUV2ZW50KGV2ZW50LCBkM25vZGUsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMsIGZ1bmN0aW9uKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lbZXZlbnRdKGQzbm9kZSwgZCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTZXRzIHBhbiBhbmQgem9vbSBydWxlcyBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzLmJlaGF2aW9yLnpvb219ICBkM3pvb20gIEQzIHpvb20gb2JqXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluc3RhbGxab29tUG9saWN5KGQzem9vbSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZHJhZ1N2ZyA9IGQzem9vbTtcbiAgICAgICAgICAgICAgICB0aGlzLnN2Zy5jYWxsKHRoaXMuZHJhZ1N2Zyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIHdpbmRvdyBpcyByZXNpemVkXG4gICAgICAgICAgICAgKiBIb29rIGZvciBvdmVycmlkaW5nIGluIHN1YmNsYXNzZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBTVkd9ICBzdmcgICAgIFRoZSBzdmcgdGhhdCB0aGUgaGFuZGxlclxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpcyBhdHRhY2hlZCB0b1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBvbldpbmRvd1Jlc2l6ZShzdmcpIHt9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogSW5zZXJ0cyBsaW5lIGJyZWFrcyBpbiBub2RlIHRleHRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBFbGVtfSAgZ0VsICAgIFRoZSBlbGVtIHRvIGFkZCB0ZXh0IHRvXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgdGl0bGUgICBUaGUgdGl0bGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5zZXJ0VGl0bGVMaW5lYnJlYWtzIChnRWwsIHRpdGxlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHdvcmRzID0gdGl0bGUuc3BsaXQoL1xccysvZyksXG4gICAgICAgICAgICAgICAgICAgIG53b3JkcyA9IHdvcmRzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB2YXIgZWwgPSBnRWwuYXBwZW5kKFwidGV4dFwiKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCB0aGlzR3JhcGguY29uc3RzLm5vZGVUZXh0KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcInRleHQtYW5jaG9yXCIsXCJtaWRkbGVcIilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJkeVwiLCBcIi1cIiArIChud29yZHMtMSkqNy41KTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgd29yZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRzcGFuID0gZWwuYXBwZW5kKCd0c3BhbicpLnRleHQod29yZHNbaV0pO1xuICAgICAgICAgICAgICAgIGlmIChpID4gMClcbiAgICAgICAgICAgICAgICAgICAgdHNwYW4uYXR0cigneCcsIDApLmF0dHIoJ2R5JywgJzE1Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJlbW92ZXMgYWxsIGxpbmtzIGZyb20gdGhlIGdpdmVuIG5vZGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc3BsaWNlTGlua3NGb3JOb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgdG9TcGxpY2UgPSB0aGlzR3JhcGgubGlua3MuZmlsdGVyKGZ1bmN0aW9uKGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobC5zb3VyY2UgPT09IG5vZGUgfHwgbC50YXJnZXQgPT09IG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0b1NwbGljZS5tYXAoZnVuY3Rpb24obCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3Muc3BsaWNlKHRoaXNHcmFwaC5saW5rcy5pbmRleE9mKGwpLCAxKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBBZGRzIHRoZSBub2RlIHRvIHRoZSBncmFwaCBhbmQgdXBkYXRlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBhZGROb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICBub2RlLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyB0aGUgbm9kZSB0byB0aGUgZ3JhcGggYW5kIHVwZGF0ZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgcmVtb3ZlTm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnNwbGljZSh0aGlzR3JhcGgubm9kZXMuaW5kZXhPZihub2RlKSwgMSk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlKTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBBZGRzIHRoZSBsaW5rIHRvIHRoZSBncmFwaCBhbmQgdXBkYXRlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtsaW5rfSAgbGluayAgICBUaGUgbGlua1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBhZGRMaW5rKGxpbmspIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MucHVzaChsaW5rKTtcbiAgICAgICAgICAgICAgICBsaW5rLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyB0aGUgbGluayB0byB0aGUgZ3JhcGggYW5kIHVwZGF0ZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bGlua30gIGxpbmsgICAgVGhlIGxpbmtcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgcmVtb3ZlTGluayhsaW5rKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzLnNwbGljZSh0aGlzR3JhcGgubGlua3MuaW5kZXhPZihsaW5rKSwgMSk7XG4gICAgICAgICAgICAgICAgbGluay5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIHVwZGF0aW5nIGV4aXN0aW5nIHBhdGhzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BhdGh9ICBwYXRocyAgIExpc3Qgb2YgcGF0aHNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlRXhpc3RpbmdQYXRocyhwYXRocykge1xuICAgICAgICAgICAgICAgIHBhdGhzLmVhY2goZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICBkLnVwZGF0ZUF0dHIoZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgYWRkaW5nIG5ldyBwYXRoc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQYXRofSAgbmV3UGF0aHMgIExpc3Qgb2YgbmV3IHBhdGhzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHVwZGF0ZU5ld1BhdGhzKG5ld1BhdGhzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdExpbmtzKCk7XG5cbiAgICAgICAgICAgICAgICBuZXdQYXRocy5lYWNoKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5uZXdQYXRoQXR0cihkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy9pZiBub2RlIGRvZXNuJ3QgaGF2ZSBpdHMgb3duIHBvbGljeSwgdXNlIGRlZmF1bHQgZm9yIHRoZSBncmFwaFxuICAgICAgICAgICAgICAgIG5ld1BhdGhzLm9uKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZW92ZXJcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZW92ZXJcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcImRibGNsaWNrXCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQucGF0aFBvbGljeUV2ZW50KFwiZGJsY2xpY2tcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJkYmxjbGlja1wiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiY29udGV4dG1lbnVcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJjb250ZXh0bWVudVwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcImNvbnRleHRtZW51XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZW91dFwiLCBmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQucGF0aFBvbGljeUV2ZW50KFwibW91c2VvdXRcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZW91dFwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwibW91c2Vkb3duXCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZWRvd25cIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZWRvd25cIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcIm1vdXNldXBcIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnBhdGhQb2xpY3lFdmVudChcIm1vdXNldXBcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZXVwXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuY2FsbCh0aGlzR3JhcGguZHJhZyk7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgdXBkYXRpbmcgZXhpc3Rpbmcgbm9kZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlRXhpc3RpbmdOb2RlcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcyA9IHRoaXMuY2lyY2xlcy5kYXRhKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24oZCl7IHJldHVybiBkLmlkO30pXG4gICAgICAgICAgICAgICAgICAgIC5lYWNoKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQudXBkYXRlQXR0cihkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyBhZGRpbmcgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBuZXdOb2RlcyAgTGlzdCBvZiBuZXcgbm9kZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlTmV3Tm9kZXMobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgICAgIG5ld05vZGVzLmVhY2goZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5ncmFwaCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBkLm5ld05vZGVBdHRyKGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvL2lmIG5vZGUgZG9lc24ndCBoYXZlIGl0cyBvd24gcG9saWN5LCB1c2UgZGVmYXVsdCBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgICAgbmV3Tm9kZXMub24oXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlb3ZlclwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlb3ZlclwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiZGJsY2xpY2tcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5ub2RlUG9saWN5RXZlbnQoXCJkYmxjbGlja1wiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcImRibGNsaWNrXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJjb250ZXh0bWVudVwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcImNvbnRleHRtZW51XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwiY29udGV4dG1lbnVcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcIm1vdXNlb3V0XCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5ub2RlUG9saWN5RXZlbnQoXCJtb3VzZW91dFwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlb3V0XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlZG93blwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlZG93blwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwibW91c2V1cFwiLCBmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQubm9kZVBvbGljeUV2ZW50KFwibW91c2V1cFwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcIm1vdXNldXBcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5jYWxsKHRoaXNHcmFwaC5kcmFnKTtcblxuICAgICAgICAgICAgICAgIG5ld05vZGVzLmFwcGVuZChcImNpcmNsZVwiKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwiclwiLCBmdW5jdGlvbihkKSB7cmV0dXJuIFN0cmluZyhkLnJhZGl1cyl9KTtcblxuXG4gICAgICAgICAgICAgICAgbmV3Tm9kZXMuZWFjaChmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluc2VydFRpdGxlTGluZWJyZWFrcyhkMy5zZWxlY3QodGhpcyksIGQudGV4dCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUHJldmVudHMgbm9kZXMgZnJvbSBjb2xsaWRpbmdcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgYWxwaGEgICBBZmZlY3RzIGhvdyBtdWNoIGNoYW5nZVxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlIGNvbGxpc2lvbiBjYXVzZXNcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtib29sZWFufSAge1doZXRoZXIgbm9kZXMgYXJlIGNvbGxpZGVkfVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkM0ZvcmNlQ29sbGlkZShhbHBoYSkge1xuICAgICAgICAgICAgXHR2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgIFx0XHRjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzO1xuICAgICAgICAgICAgXHR2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICBcdHZhciBxdWFkdHJlZSA9IGQzLmdlb20ucXVhZHRyZWUobm9kZXMpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgciA9IGQucmFkaXVzICsgY29uc3RzLm1heFJhZGl1cyArIGNvbnN0cy5wYWRkaW5nLFxuICAgICAgICAgICAgICAgICAgICAgICAgbngxID0gZC54IC0gcixcbiAgICAgICAgICAgICAgICAgICAgICAgIG54MiA9IGQueCArIHIsXG4gICAgICAgICAgICAgICAgICAgICAgICBueTEgPSBkLnkgLSByLFxuICAgICAgICAgICAgICAgICAgICAgICAgbnkyID0gZC55ICsgcjtcbiAgICAgICAgICAgICAgICAgICAgcXVhZHRyZWUudmlzaXQoZnVuY3Rpb24ocXVhZCwgeDEsIHkxLCB4MiwgeTIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChxdWFkLnBvaW50ICYmIChxdWFkLnBvaW50ICE9PSBkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4ID0gZC54IC0gcXVhZC5wb2ludC54LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ID0gZC55IC0gcXVhZC5wb2ludC55LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsID0gTWF0aC5zcXJ0KHggKiB4ICsgeSAqIHkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByID0gZC5yYWRpdXMgKyBxdWFkLnBvaW50LnJhZGl1cyArIGNvbnN0cy5wYWRkaW5nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsIDwgcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbCA9IChsIC0gcikgLyBsICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnggLT0geCAqPSBsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55IC09IHkgKj0gbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1YWQucG9pbnQueCArPSB4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVhZC5wb2ludC55ICs9IHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB4MSA+IG54MiB8fCB4MiA8IG54MSB8fCB5MSA+IG55MiB8fCB5MiA8IG55MTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUaWNrIG9mIHRoZSBkMyBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzdGljayBldmVudH0gIGUgICAgRDN0aWNrIGV2ZW50XG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgd2lkdGggIFRoZSB3aWR0aCBvZiB0aGUgc2ltdWxhdGlvblxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge251bWJlcn0gIGhlaWdodCBUaGUgaGVpZ2h0IG9mIHRoZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGQzRm9yY2VUaWNrKGUsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgIFx0dmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICBcdFx0Y29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cztcblxuICAgICAgICAgICAgXHR2YXIgb2Zmc2V0ID0gY29uc3RzLmRpc3BsYXlPZmZzZXQ7XHRcbiAgICAgICAgICAgIFx0dmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgXHR2YXIgcSA9IGQzLmdlb20ucXVhZHRyZWUodGhpc0dyYXBoLm5vZGVzKSxcbiAgICAgICAgICAgICAgICAgICAgICBpID0gMCxcbiAgICAgICAgICAgICAgICAgICAgICBuID0gbm9kZXMubGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgICB3aGlsZSAoKytpIDwgbikge1xuICAgICAgICAgICAgICAgICAgICBxLnZpc2l0KHRoaXMuZDNGb3JjZUNvbGxpZGUobm9kZXNbaV0pKTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2godGhpcy5kM0ZvcmNlQ29sbGlkZSguNSkpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiY3hcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC54ID0gTWF0aC5tYXgoZC5yYWRpdXMgKyBvZmZzZXQsIE1hdGgubWluKHdpZHRoIC0gb2Zmc2V0IC0gZC5yYWRpdXMsIGQueCkpOyB9KVxuICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJjeVwiLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnkgPSBNYXRoLm1heChkLnJhZGl1cyArIG9mZnNldCwgTWF0aC5taW4oaGVpZ2h0IC0gb2Zmc2V0IC0gZC5yYWRpdXMsIGQueSkpOyB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoc1xuICAgICAgICAgICAgICAgICAgICAuYXR0cigneDEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS55OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneDInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC55OyB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTdGFydHMgb24gc3RhcnQgb2YgdGhlIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZVN0YXJ0KCkge1xuICAgICAgICAgICAgXHR2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHNcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueTsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueTsgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIG9uIHRoZSBlbmQgb2YgdGhlIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZUVuZCgpIHtcbiAgICAgICAgICAgIFx0dmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICBcdHRoaXNHcmFwaC5jaXJjbGVzXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjeCcsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2N5JywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC55OyB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocy5hdHRyKCd4MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLnk7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd4MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lnk7IH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGN1bGF0ZXMgdGhlIHdpZHRoIGFuZCBoZWlnaHQgYm91bmRzIGZvciB0aGUgXG4gICAgICAgICAgICAgKiBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHJldHVybiAgICAge09iamVjdH0gIHdpZHRoIGFuZCBoZWlnaHQgYXMgcHJvcGVydGllcyBcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZUJvdW5kcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnV2lkdGggPSAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLndpZHRoKCk7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z0hlaWdodCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykuaGVpZ2h0KCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBzdmdXaWR0aDtcbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gc3ZnSGVpZ2h0O1xuICAgICAgICAgICAgICAgIHJldHVybiB7d2lkdGg6d2lkdGgsIGhlaWdodDpoZWlnaHR9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIERvZXMgYSBkMyBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0Z1bmN0aW9ufSAgY2FsbGJhY2sgIFRoZSBjYWxsYmFja1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzZXRGb3JjZShjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgICAgIHZhciBsaW5rcyA9IHRoaXNHcmFwaC5saW5rcztcbiAgICAgICAgICAgICAgICBpZiAoXy5pc0VtcHR5KG5vZGVzKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGJvdW5kcyA9IHRoaXNHcmFwaC5kM0ZvcmNlQm91bmRzKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgZm9yY2UgPSBkMy5sYXlvdXQuZm9yY2UoKVxuICAgICAgICAgICAgICAgICAgICAuc2l6ZShbYm91bmRzLndpZHRoLCBib3VuZHMuaGVpZ2h0XSlcbiAgICAgICAgICAgICAgICAgICAgLm5vZGVzKG5vZGVzKVxuICAgICAgICAgICAgICAgICAgICAuY2hhcmdlKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtNjAwMDtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmxpbmtzKGxpbmtzKTtcblxuICAgICAgICAgICAgICAgIGZvcmNlLmxpbmtEaXN0YW5jZShib3VuZHMud2lkdGgvMyk7XG4gICAgICAgICAgICAgICAgZm9yY2UubGlua1N0cmVuZ3RoKC4yKTtcbiAgICAgICAgICAgICAgICBmb3JjZS5ncmF2aXR5KC4yKTtcblxuICAgICAgICAgICAgICAgIGZvcmNlLm9uKCd0aWNrJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgIFx0dGhpc0dyYXBoLmQzRm9yY2VUaWNrLmNhbGwodGhpc0dyYXBoLCBcbiAgICAgICAgICAgICAgICBcdFx0XHRlLCBib3VuZHMud2lkdGgsIGJvdW5kcy5oZWlnaHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZm9yY2Uub24oJ3N0YXJ0JywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgXHR0aGlzR3JhcGguZDNGb3JjZVN0YXJ0LmNhbGwodGhpc0dyYXBoKVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZm9yY2Uub24oJ2VuZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIFx0dGhpc0dyYXBoLmQzRm9yY2VFbmQuY2FsbCh0aGlzR3JhcGgpXG4gICAgICAgICAgICAgICAgfSk7IFxuXG5cbiAgICAgICAgICAgICAgICBmb3JjZS5zdGFydCgpO1xuICAgICAgICAgICAgICAgIHZhciBrID0gMDtcbiAgICAgICAgICAgICAgICB3aGlsZSAoKGZvcmNlLmFscGhhKCkgPiAxZS0yKSAmJiAoayA8IDE1MCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yY2UudGljaygpO1xuICAgICAgICAgICAgICAgICAgICBrID0gayArIDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvcmNlLnN0b3AoKTtcblxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjayAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgXHRjYWxsYmFjaygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTZXRzIHRoZSBwb3NpdGlvbnMgdG8gYmUgdGhlIGNlbnRlciBvZiB0aGUgc2NyZWVuIGlmIFxuICAgICAgICAgICAgICogbm90IHByb3ZpZGVkXG4gICAgICAgICAgICAgKiBhbHNvIHNldHMgdGhlIHJhZGl1cyBvZiB0aGUgbm9kZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc2V0UG9zaXRpb25zKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IHRoaXNHcmFwaC5jb25zdHMuZGlzcGxheU9mZnNldDtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnV2lkdGggPSAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLndpZHRoKCk7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z0hlaWdodCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykuaGVpZ2h0KCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBzdmdXaWR0aCAtICgyKm9mZnNldCk7XG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IHN2Z0hlaWdodCAtICgyKm9mZnNldCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVzW2ldLnJhZGl1cyA9IG5vZGVzW2ldLnJhZGl1cyB8fCB0aGlzR3JhcGguY29uc3RzLnN0YXJ0UmFkaXVzO1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZXNbaV0ueCA9PSBudWxsIHx8IG5vZGVzW2ldLnkgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm9kZXNbaV0ueFN0YXJ0ID0gd2lkdGgvMiAgKyBub2Rlc1tpXS5yYWRpdXMgKyBvZmZzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzW2ldLnggPSB3aWR0aC8yICArIG5vZGVzW2ldLnJhZGl1cyArIG9mZnNldDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5vZGVzW2ldLnlTdGFydCA9IGhlaWdodC8yICsgbm9kZXNbaV0ucmFkaXVzICsgb2Zmc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1tpXS55ID0gaGVpZ2h0LzIgKyBub2Rlc1tpXS5yYWRpdXMgKyBvZmZzZXRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgdG8gdXBkYXRlIHRoZSB2aWV3IG9mIHRoZSBncmFwaCB3aGVuXG4gICAgICAgICAgICAgKiBkYXRhIGNoYW5nZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RnVuY3Rpb259ICBjYWxsYmFjayAgVGhlIGNhbGxiYWNrXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHVwZGF0ZUdyYXBoKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlO1xuXG4gICAgICAgICAgICBcdGlmICh0aGlzR3JhcGguc3RhdGUuZGlzYWJsZVVwZGF0ZSkge1xuICAgICAgICAgICAgXHRcdHJldHVybjtcbiAgICAgICAgICAgIFx0fVxuXG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVFeGlzdGluZ05vZGVzKCk7XG4gICAgICAgICAgICAgICAgdmFyIG5ld0dzPSB0aGlzR3JhcGguY2lyY2xlcy5lbnRlcigpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJnXCIpO1xuXG4gICAgICAgICAgICBcdC8vIGNvbnNvbGUubG9nKCd1cGRhdGUnLCBuZXdHcyk7XG4gICAgICAgICAgICAgICAgbmV3R3MuY2xhc3NlZChjb25zdHMuY2lyY2xlR0NsYXNzLCB0cnVlKTtcbiAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIHRoaXMudXBkYXRlTmV3Tm9kZXMobmV3R3MpO1xuXG4gICAgICAgICAgICAgICAgLy8gcmVtb3ZlIG9sZCBub2Rlc1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmV4aXQoKS5yZW1vdmUoKTtcblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5pbml0Rm9yY2UgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNldEZvcmNlKGZ1bmN0aW9uKCkge1xuICAgIFx0ICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVOZXdOb2Rlcy5jYWxsKHRoaXNHcmFwaCwgbmV3R3MpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuaW5pdEZvcmNlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVOZXdOb2RlcyhuZXdHcyk7XG5cdCAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocyA9IHRoaXNHcmFwaC5wYXRocy5kYXRhKHRoaXNHcmFwaC5saW5rcywgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBTdHJpbmcoZC5zb3VyY2UuaWQpICsgXCIrXCIgKyBTdHJpbmcoZC50YXJnZXQuaWQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciBwYXRocyA9IHRoaXNHcmFwaC5wYXRocztcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUV4aXN0aW5nUGF0aHMocGF0aHMpO1xuXG4gICAgICAgICAgICAgICAgdmFyIG5ld3BhdGhzID0gcGF0aHMuZW50ZXIoKVxuICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJwYXRoXCIpXG4gICAgICAgICAgICAgICAgLnN0eWxlKCdtYXJrZXItZW5kJywndXJsKCNlbmQtYXJyb3cpJylcbiAgICAgICAgICAgICAgICAuY2xhc3NlZChcImxpbmtcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVOZXdQYXRocyhuZXdwYXRocyk7XG5cbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgb2xkIGxpbmtzXG4gICAgICAgICAgICAgICAgcGF0aHMuZXhpdCgpLnJlbW92ZSgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBcdGNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgR3JhcGg6IEdyYXBoXG4gICAgICAgIH1cbn1dKTtcblxuXG4iLCIvKipcbiAqIFRoZSBncmFwaCB0aGF0IGlzIHVzZWQgc3BlY2lmaWNhbGx5IGZvciB0aGUgdmlzdWFsaXphdGlvbiB0YWIuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdWaXN1YWxpemVyR3JhcGgnLCBbJ0dyYXBoJywgZnVuY3Rpb24gKEdyYXBoKSB7XG4gICAgXHRjbGFzcyBWaXN1YWxpemVyR3JhcGggZXh0ZW5kcyBHcmFwaC5HcmFwaCB7XG4gICAgXHRcdC8qKlxuICAgIFx0XHQgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgXHRcdCAqXG4gICAgXHRcdCAqIEBwYXJhbSAgIHtIVE1MIFNWR30gIHN2ZyAgICAgICAgICAgICBUaGUgc3ZnIHRoYXQgd2lsbCBcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob2xkIHRoZSBncmFwaFxuICAgICAgICAgICAgICogQHBhcmFtICAge0FycmF5fSAgbm9kZXMgICBcdFx0ICAgIExpc3Qgb2Ygbm9kZXNcbiAgICAgICAgICAgICAqIEBwYXJhbSAgIHtBcnJheX0gIGxpbmtzICAgXHRcdCAgICBMaXN0IG9mIGxpbmtzXG4gICAgXHRcdCAqIEBwYXJhbSAgIHtEYXRhU291cmNlfSAgZGF0YVNvdXJjZSAgICBUaGUgZGF0YSBzb3VyY2VcbiAgICBcdFx0ICovXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcihzdmcsIG5vZGVzLCBsaW5rcywgZGF0YVNvdXJjZSkge1xuICAgICAgICAgICAgICAgIHN1cGVyKHN2Zywgbm9kZXMsIGxpbmtzKTtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgICAgIC8vaG9sZHMgY3VycmVudCB0cmFuc2l0aW9ucyB0aGF0IGFyZSBvY2N1cmluZ1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZS50cmFuc2l0aW9uID0gW107XG4gICAgICAgICAgICAgICAgLy9NaW4gZGlzdGFuY2UgYmV0d2VlbiBub2RlcyB3aGVuIHNwYXduaW5nIHJhbmRvbWx5XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNvbnN0cy5lZGdlX2J1ZmZlciA9IDIwMDtcbiAgICAgICAgICAgICAgICAvL1NpemUgcmVkdWN0aW9uIGFzIHlvdSBnbyB0aHJvdWdoIGxldmVscyBpbiBub2Rlc1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jb25zdHMucmFkaXVzRGVjYXkgPSAxO1xuICAgICAgICAgICAgICAgIC8vQ3NzIGNsYXNzIGZvciBub2RlcyB0aGF0IGFyZSBjb250YWluZXJzXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNvbnN0cy5jb250YWluZXJDbGFzcyA9ICdjb250YWluZXInO1xuXG4gICAgICAgICAgICAgICAgLy9kYXRhU291cmNlIGhvbGRzIHRoZSBzZXJ2ZXIgZGF0YSBhbmQgbWV0aG9kcyBmb3JcbiAgICAgICAgICAgICAgICAvL2NvbnZlcnRpbmcgaXQgdG8gZGF0YSBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRhdGFTb3VyY2UgPSBkYXRhU291cmNlO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vRHJhZyBiZWhhdmlvciBmb3Igbm9kZXNcbiAgICAgICAgICAgICAgICB2YXIgZHJhZyA9IGQzLmJlaGF2aW9yLmRyYWcoKVxuICAgICAgICAgICAgICAgICAgICAub3JpZ2luKGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge3g6IGQueCwgeTogZC55fTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiZHJhZ3N0YXJ0XCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJkcmFnXCIsIGZ1bmN0aW9uKGFyZ3Mpe1xuICAgICAgICAgICAgICAgICAgICBcdGQzLnNlbGVjdCggdGhpcykuYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbiggZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCArPSBkMy5ldmVudC5keDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gZDMuZXZlbnQuZHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwidHJhbnNsYXRlKFwiICsgWyBkLngsZC55IF0gKyBcIilcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcdFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJkcmFnZW5kXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kcmFnID0gZHJhZztcblxuICAgICAgICAgICAgICAgIC8vUGFuIGFuZCBab29tIGJlaGF2aW9yIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAgICB2YXIgem9vbSA9IGQzLmJlaGF2aW9yLnpvb20oKVxuICAgICAgICAgICAgICAgICAgICAub24oXCJ6b29tXCIsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZDMuZXZlbnQuc291cmNlRXZlbnQgIT0gbnVsbCAmJiBkMy5ldmVudC5zb3VyY2VFdmVudC5jdHJsS2V5KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZC5jYWxsKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiem9vbXN0YXJ0XCIsIGZ1bmN0aW9uKGQsIGkpe1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguZHJhZ1N2ZyA9IHpvb207XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Zy5jYWxsKHpvb20pLm9uKFwiZGJsY2xpY2suem9vbVwiLCBudWxsKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2l0aCBubyBhcmdzIHdoZW4gdGhlIGdyYXBoIGhhcyBhIHpvb20gYWN0aW9uXG4gICAgICAgICAgICAgKiBDYW4gYWxzbyBiZSBjYWxsZWQgd2l0aCBhcmdzIHRvIGZvcmNlIGEgem9vbSBvciBwYW4gXG4gICAgICAgICAgICAgKiBldmVudCBmb3IgdGhlIGdyYXBoLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gICB0cmFuc2xhdGUgIFRoZSBhbW91bnQgdG8gdHJhbnNsYXRlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgc2NhbGUgICAgICBUaGUgYW1vdW50IHRvIHNjYWxlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHpvb21lZCh0cmFuc2xhdGUsIHNjYWxlKXtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLnN0YXRlLnJpZ2h0Q2xpY2sgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuanVzdFNjYWxlVHJhbnNHcmFwaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKHRyYW5zbGF0ZSAhPSBudWxsICYmIHNjYWxlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSB0aGlzR3JhcGguZHJhZ1N2ZztcbiAgICAgICAgICAgICAgICAgICAgem9vbS5zY2FsZShzY2FsZSk7XG4gICAgICAgICAgICAgICAgICAgIHpvb20udHJhbnNsYXRlKHRyYW5zbGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIC8vY3JlYXRpbmcgbmFtZXMgdG8gcHJldmVudCB0cmFuc2l0aW9uIGNvbmZsaWN0c1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbVNldENhbGxiYWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIFx0em9vbS5zY2FsZShzY2FsZSk7XG4gICAgICAgICAgICAgICAgICAgIFx0em9vbS50cmFuc2xhdGUodHJhbnNsYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zbGF0ZV9uYW1lID0gXCJ6b29tXCIgKyB0cmFuc2xhdGU7XG4gICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdChcIi5cIiArIHRoaXMuY29uc3RzLmdyYXBoQ2xhc3MpLnRyYW5zaXRpb24odHJhbnNsYXRlX25hbWUpLmRlbGF5KDEwMCkuZHVyYXRpb24oNzUwKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoJyArIHpvb20udHJhbnNsYXRlKCkgKyAnKSBzY2FsZSgnICsgem9vbS5zY2FsZSgpICsgJyknKS5lYWNoKFwiZW5kXCIsIHpvb21TZXRDYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGguc3RhdGUuY2FuWm9vbSkge1xuICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QoXCIuXCIgKyB0aGlzLmNvbnN0cy5ncmFwaENsYXNzKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKSArIFwiKSBzY2FsZShcIiArdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKSArIFwiKVwiKTsgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgd2luZG93IHJlc2l6ZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBTVkd9ICBzdmcgICAgVGhlIHN2ZyB0byByZXNpemVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgb25XaW5kb3dSZXNpemUoc3ZnKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJvZHlFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF07XG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykub2Zmc2V0KCk7XG4gICAgICAgICAgICAgICAgdmFyIGRpdldpZHRoID0gJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS53aWR0aCgpO1xuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBib2R5RWwuY2xpZW50SGVpZ2h0O1xuICAgICAgICAgICAgICAgIHN2Zy5hdHRyKFwid2lkdGhcIiwgZGl2V2lkdGgpLmF0dHIoXCJoZWlnaHRcIiwgaGVpZ2h0IC0gb2Zmc2V0LnRvcCAtIDIwKTtcblxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgc2VydmVyIHNlbmRzIHVwZGF0ZWQgZGF0YSBmb3IgdGhlIGxpbmtzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHVwZGF0ZUxpbmtEYXRhKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBub2RlX25hbWVzX3NldCA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpc0dyYXBoLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVfbmFtZXNfc2V0LnB1c2godGhpc0dyYXBoLm5vZGVzW2ldLmlkKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcmV0RGF0YSA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmdldEZsb3dCZXR3ZWVuU2V0KG5vZGVfbmFtZXNfc2V0KTtcbiAgICAgICAgICAgICAgICB2YXIgbGlua0RhdGEgPSByZXREYXRhLmxpbmtEYXRhO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YShsaW5rRGF0YSwgdGhpc0dyYXBoLm5vZGVzKTtcbiAgICAgICAgICAgICAgICB0aGlzLmluaXROb2RlcygpO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5pdExpbmtzKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIFxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIEdyYXBoOiBWaXN1YWxpemVyR3JhcGhcbiAgICAgICAgfVxufV0pO1xuXG5cblxuIiwiLyoqXG4gKiBUaGUgYmFzZSBjbGFzcyBmb3IgbGluayBvYmplY3RzIGZvciB0aGUgZ3JhcGguXG4gKiBTdXBwb3J0cyBwb2xpY2llcy5cbiAqIFxuICogVG8gd3JpdGUgeW91ciBvd24gbGluayBvYmplY3QsIGNyZWF0ZSBhIG5ldyBmYWN0b3J5IHRoYXQgdXNlcyB0aGUgbGlua1xuICogeW91IHdhbnQgdG8gaW5oZXJpdCBhcyBhIGRlcGVuZGVuY3ksIGFuZCBleHRlbmQgaXRzIGxpbmsgY2xhc3MuIFxuICogUmV0dXJuIHRoZSBjbGFzcyBvYmplY3Qgd2l0aCBMaW5rIGFzIGtleVxuICogXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdMaW5rJywgW2Z1bmN0aW9uICgpIHtcbiAgICBcdGNsYXNzIExpbmsge1xuICAgIFx0XHQvKipcbiAgICBcdFx0ICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgIFx0XHQgKlxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHNvdXJjZU5vZGUgIFRoZSBzb3VyY2Ugbm9kZVxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHRhcmdldE5vZGUgIFRoZSB0YXJnZXQgbm9kZVxuICAgIFx0XHQgKi9cblx0XHRcdGNvbnN0cnVjdG9yKHNvdXJjZU5vZGUsIHRhcmdldE5vZGUpIHtcblx0XHRcdFx0dGhpcy5zb3VyY2UgPSBzb3VyY2VOb2RlO1xuXHRcdFx0XHR0aGlzLnRhcmdldCA9IHRhcmdldE5vZGU7XG5cdFx0XHRcdHRoaXMuaGFzUG9saWN5ID0gZmFsc2U7XG5cdFx0XHRcdHRoaXMucGF0aFBvbGljaWVzID0gW107XG5cdFx0XHRcdHRoaXMuZ3JhcGggPSBudWxsO1xuXHRcdFx0XHR0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsbGVkIHdoZW4gYSBsaW5rIGlzIGFkZGVkIHRvIHRoZSBncmFwaFxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoIGl0IGlzIGFkZGVkIHRvXG5cdFx0XHQgKi9cblx0XHRcdGluaXRpYWxpemUoZ3JhcGgpIHtcblx0XHRcdFx0aWYgKHRoaXMuaW5pdGlhbGl6ZWQgPT0gZmFsc2UpIHtcblx0XHRcdFx0XHR0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcblx0XHRcdFx0XHR0aGlzLmdyYXBoID0gZ3JhcGg7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxsZWQgZHVyaW5nIHRoZSB1cGRhdGUgZ3JhcGggZm9yIGV4aXN0aW5nIGxpbmtzXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuXHRcdFx0ICogQHBhcmFtICAgICAge0xpbmt9ICBcdCAgIGQgICAgICAgTWF0Y2hpbmcgTGluayBPYmplY3QgICAgICAgXG5cdFx0XHQgKi9cblx0XHRcdHVwZGF0ZUF0dHIoZDNwYXRoLCBkKSB7XG5cdFx0XHRcdGQzcGF0aC5zdHlsZSgnbWFya2VyLWVuZCcsICd1cmwoI2VuZC1hcnJvdyknKVxuXHRcdCAgICAgICAgICAgIC5hdHRyKFwiZFwiLCBhcnJvd1BhdGgpO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCBkdXJpbmcgdGhlIGZpcnN0IHVwZGF0ZSBncmFwaCBmb3IgYSBsaW5rXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuXHRcdFx0ICogQHBhcmFtICAgICAge0xpbmt9ICBcdCAgIGQgICAgICAgTWF0Y2hpbmcgTGluayBPYmplY3QgICAgICAgXG5cdFx0XHQgKi9cblx0XHRcdG5ld1BhdGhBdHRyKGQzcGF0aCwgZCkge1xuXHRcdFx0XHRkM3BhdGguYXR0cignZCcsIGFycm93UGF0aCk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsY3VsYXRlcyB0aGUgYXJyb3cgcGF0aFxuXHRcdFx0ICpcblx0XHRcdCAqIEByZXR1cm4gICAgIHtzdHJpbmd9ICBUaGUgcGF0aCB0byBkcmF3XG5cdFx0XHQgKi9cblx0XHQgICAgYXJyb3dQYXRoKCkge1xuXHRcdCAgICBcdHZhciBkID0gdGhpcztcblx0XHQgICAgICAgIHZhciBkeCA9IGQudGFyZ2V0LnggLSBkLnNvdXJjZS54LFxuXHRcdCAgICAgICAgICAgIGR5ID0gZC50YXJnZXQueSAtIGQuc291cmNlLnksXG5cdFx0ICAgICAgICAgICAgZHIgPSBNYXRoLnNxcnQoZHggKiBkeCArIGR5ICogZHkpO1xuXHRcdCAgICAgICAgcmV0dXJuIFwiTVwiICsgZC5zb3VyY2UueCArIFwiLFwiICsgZC5zb3VyY2UueSArIFwiQVwiICsgZHIgKyBcIixcIiArIGRyICsgXCIgMCAwLDEgXCIgKyBkLnRhcmdldC54ICsgXCIsXCIgKyBkLnRhcmdldC55O1xuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIFVzZWQgdG8gaW5zdGFsbCBwb2xpY2llcyB0aGF0IGFyZSBjYWxsZWQgd2hlbiB0aGlzXG5cdFx0ICAgICAqIGxpbmsgaGFzIGEgbW91c2UgZXZlbnRcblx0XHQgICAgICpcblx0XHQgICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeSAgVGhlIHBvbGljeSB0byBpbnN0YWxsXG5cdFx0ICAgICAqL1xuXHRcdFx0aW5zdGFsbFBhdGhQb2xpY3kocG9saWN5KSB7XG5cdFx0XHRcdHRoaXMuaGFzUG9saWN5ID0gdHJ1ZTtcblx0XHRcdFx0dGhpcy5wYXRoUG9saWNpZXMucHVzaChwb2xpY3kpO1xuXHRcdFx0XHRwb2xpY3kuaW5pdGlhbGl6ZSh0aGlzLmdyYXBoKTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBVc2VkIHRvIHVuaW5zdGFsbCBwb2xpY3kgZm9yIHRoaXMgbGlua1xuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3lSZW1vdmUgIFRoZSBwb2xpY3kgdG8gcmVtb3ZlXG5cdFx0XHQgKi9cblx0XHRcdHVuaW5zdGFsbFBhdGhQb2xpY3kocG9saWN5UmVtb3ZlKSB7XG5cdFx0XHRcdHZhciBwb2xpY3lSZW1vdmVOYW1lO1xuXHRcdFx0XHR2YXIgdGhpc1BhdGggPSB0aGlzO1xuXHRcdFx0XHRpZiAodHlwZW9mIHBvbGljeVJlbW92ZSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHRwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmUucG9saWN5TmFtZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRfKHRoaXNQYXRoLnBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3ksIGluZGV4KSB7XG5cdFx0XHRcdFx0aWYgKHBvbGljeS5wb2xpY3lOYW1lID09PSBwb2xpY3lSZW1vdmVOYW1lKSB7XG5cdFx0XHRcdFx0XHRwb2xpY3kuZGVzdHJveSgpO1xuXHRcdFx0XHRcdFx0dGhpc1BhdGgucGF0aFBvbGljaWVzLnNwbGljZShpbmRleCwgMSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdFx0aWYgKHRoaXNQYXRoLnBhdGhQb2xpY2llcy5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0XHR0aGlzUGF0aC5oYXNQb2xpY3kgPSBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCB3aGVuIHRoZXJlIGlzIGEgbW91c2UgZXZlbnQgZm9yIHRoaXMgcGF0aFxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBldmVudCAgICAgVGhlIG1vdXNlIGV2ZW50XG5cdFx0XHQgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM3BhdGggIFRoZSBkMyBwYXRoXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgZCAgICAgICAgIFRoZSBtYXRjaGluZyBsaW5rIG9iamVjdFxuXHRcdFx0ICovXG5cdFx0XHRwYXRoUG9saWN5RXZlbnQoZXZlbnQsIGQzcGF0aCwgZCkge1xuXHRcdFx0XHRfKGQucGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSkge1xuXHRcdFx0XHRcdHBvbGljeVtldmVudF0oZDNwYXRoLCBkKTtcblx0XHRcdFx0fSlcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHtcblx0XHRcdExpbms6IExpbmtcblx0XHR9XG59XSk7XG5cblxuXG5cblxuXG4iLCIvKipcbiAqIFRoZSBsaW5rIHRoYXQgaXMgdXNlZCBzcGVjaWZpY2FsbHkgZm9yIHRoZSB2aXN1YWxpemF0aW9uIHRhYi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ1Zpc3VhbGl6ZXJMaW5rJywgWydMaW5rJywgZnVuY3Rpb24gKExpbmspIHtcblx0XHRjbGFzcyBWaXN1YWxpemVyTGluayBleHRlbmRzIExpbmsuTGluayB7XG5cdFx0XHQvKipcblx0XHRcdCAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHNvdXJjZU5vZGUgIFRoZSBzb3VyY2Ugbm9kZVxuXHRcdFx0ICogQHBhcmFtICAgICAge05vZGV9ICB0YXJnZXROb2RlICBUaGUgdGFyZ2V0IG5vZGVcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB3ZWlnaHQgICAgVGhlIHdlaWdodCBvZiB0aGUgbGlua1xuXHRcdFx0ICovXG5cdFx0ICAgIGNvbnN0cnVjdG9yKHNvdXJjZU5vZGUsIHRhcmdldE5vZGUsIHdlaWdodCkge1xuXHRcdCAgICAgICAgc3VwZXIoc291cmNlTm9kZSwgdGFyZ2V0Tm9kZSk7XG5cdFx0ICAgICAgICB0aGlzLndlaWdodCA9IHdlaWdodDtcblx0XHQgICAgICAgIC8vQ291bnQgaXMgdXNlZCB0byBrZWVwIHRyYWNrIG9mIGhvdyBtYW55XG5cdFx0ICAgICAgICAvL3BhdGhzIHRvIGl0cyBzdWJub2RlcyB0aGVyZSBhcmVcblx0XHQgICAgICAgIC8vaW4gb3JkZXIgdG8gY2FsY3VsYXRlIGF2ZXJhZ2UgdHJhZmZpY1xuXHRcdCAgICAgICAgdGhpcy5jb3VudCA9IDE7XG5cdFx0ICAgIH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogSW5jcmVhc2VzIHRoZSBjb3VudCBvZiB0aGUgbGlua1xuXHRcdCAgICAgKiBVU2VkIHRvIGtlZXAgdHJhY2sgb2YgaG93IG1hbnkgcGF0aHMgdG8gaXRzIHN1Ym5vZGVzXG5cdFx0ICAgICAqIHRoZXJlIGFyZSBpbiBvcmRlciB0byBjYWxjdWxhdGUgYXZlcmFnZSB0cmFmZmljXG5cdFx0ICAgICAqL1xuXHRcdCAgICBpbmNyZWFzZUNvdW50KCkge1xuXHRcdCAgICAgICAgdGhpcy5jb3VudCArPSAxO1xuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIENhbGN1bGF0ZXMgd2hlcmUgdG8gcGxhY2UgcXRpcCBmb3Jcblx0XHQgICAgICpcblx0XHQgICAgICogQHJldHVybiAgICAge09iamVjdH0gIE9iamVjdCB3aXRoIHFUaXAgc2V0dGluZ3Ncblx0XHQgICAgICovXG5cdFx0ICAgIHF0aXBIZWxwZXIoKSB7XG5cdFx0ICAgIFx0dmFyIHJldDtcblx0XHQgICAgXHR2YXIgZCA9IHRoaXM7XG5cdFx0ICAgIFx0dmFyIGR4ID0gKGQudGFyZ2V0LnggLSBkLnNvdXJjZS54KSAvIDIsXG5cdFx0ICAgICAgICAgICAgZHkgPSAoZC50YXJnZXQueSAtIGQuc291cmNlLnkpIC8gMjtcblx0XHQgICAgXHRpZiAoZC5zb3VyY2UueCA8IGQudGFyZ2V0LngpIHtcblx0ICAgIFx0XHRcdHJldCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG15OiAndG9wIGNlbnRlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICBhdDogJ2NlbnRlciBjZW50ZXInLCAvLyBhdCB0aGUgYm90dG9tIHJpZ2h0IG9mLi4uXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IFtkeCwgZHldLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWRqdXN0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcdHk6IDEwXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblx0XHQgICAgXHR9IGVsc2Uge1xuXHQgICAgXHRcdFx0cmV0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbXk6ICdib3R0b20gY2VudGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0OiAnY2VudGVyIGNlbnRlcicsIC8vIGF0IHRoZSBib3R0b20gcmlnaHQgb2YuLi5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogW2R4LCBkeV0sXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGp1c3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFx0eTogLTEwXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblx0XHQgICAgXHR9XG5cdFx0ICAgIFx0cmV0dXJuIHJldDtcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdFx0ICogQ2FsbGVkIHdoZW4gYSBsaW5rIGlzIGFkZGVkIHRvIHRoZSBncmFwaFxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoIGl0IGlzIGFkZGVkIHRvXG5cdFx0XHQgKi9cblx0XHRcdGluaXRpYWxpemUoZ3JhcGgpIHtcblx0XHRcdFx0aWYgKHRoaXMuaW5pdGlhbGl6ZWQgPT0gZmFsc2UpIHtcblx0XHRcdFx0XHRzdXBlci5pbml0aWFsaXplKGdyYXBoKTtcblx0XHRcdFx0XHR2YXIgc3RhdGUgPSBncmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluaztcblx0XHRcdFx0XHRpZiAoc3RhdGUgPT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0c3RhdGUgPSBncmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluayA9IHt9O1xuXHRcdFx0XHRcdFx0c3RhdGUubWF4V2VpZ2h0ID0gbnVsbDtcblx0XHRcdFx0XHRcdHN0YXRlLnVzZUF2Z1dlaWdodCA9IHRydWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHRoaXMudXBkYXRlTWF4V2VpZ2h0KCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBTZXRzIHdoZXRoZXIgdGhlIGdyYXBoIHNob3VsZCB1c2UgYXZnIHdlaWdodFxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtib29sZWFufSAgdmFsICAgICBUaGUgdmFsdWUgdG8gc2V0IHRvXG5cdFx0XHQgKi9cblx0XHRcdHNldFVzZUF2Z1dlaWdodCh2YWwpIHtcblx0XHQgICAgICAgIHRoaXMuZ3JhcGguc3RhdGUuVmlzdWFsaXplckxpbmsudXNlQXZnV2VpZ2h0ID0gISF2YWw7XG5cdFx0ICAgIH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogU2V0cyB0aGUgd2VpZ2h0IG9mIHRoaXMgbGlua1xuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgd2VpZ2h0ICBUaGUgd2VpZ2h0IHRvIHNldCB0b1xuXHRcdCAgICAgKi9cblx0XHQgICAgc2V0V2VpZ2h0KHdlaWdodCkge1xuXHRcdCAgICAgICAgdGhpcy53ZWlnaHQgPSB3ZWlnaHQ7XG5cdFx0ICAgIH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogR2V0cyB0aGUgcmF3IHdlaWdodC5cblx0XHQgICAgICpcblx0XHQgICAgICogQHJldHVybiAgICAge251bWJlcn0gIFRoZSByYXcgd2VpZ2h0LlxuXHRcdCAgICAgKi9cblx0XHQgICAgZ2V0UmF3V2VpZ2h0KCkge1xuXHRcdCAgICAgICAgcmV0dXJuIHRoaXMud2VpZ2h0OyBcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBHZXRzIHRoZSB3ZWlnaHQgdmFsdWUgb2YgdGhlIGxpbmssIGRlcGVuZGluZyBvbiB0aGVcblx0XHQgICAgICogdXNlQXZnV2VpZ3RoIHNldHRpbmdcblx0XHQgICAgICpcblx0XHQgICAgICogQHJldHVybiAgICAge251bWJlcn0gIFRoZSB3ZWlnaHQuXG5cdFx0ICAgICAqL1xuXHRcdCAgICBnZXRXZWlnaHQoKSB7XG5cdFx0ICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcblx0XHQgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluaztcblxuXHRcdCAgICAgICAgaWYgKHN0YXRlLnVzZUF2Z1dlaWdodCkge1xuXHRcdCAgICAgICAgICAgIHZhciB3ZWlnaHQgPSB0aGlzLndlaWdodCAvIHRoaXMuY291bnQ7XG5cdFx0ICAgICAgICAgICAgcmV0dXJuIHdlaWdodDtcblx0XHQgICAgICAgIH1cblx0XHQgICAgICAgIHJldHVybiB0aGlzLndlaWdodDtcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBVcGRhdGVzIHRoZSBtYXggd2VpZ2h0IG9mIHRoZSBncmFwaFxuXHRcdCAgICAgKi9cblx0XHQgICAgdXBkYXRlTWF4V2VpZ2h0ICgpIHtcblx0XHQgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuXHRcdCAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXG5cdFx0ICAgICAgICB2YXIgbWF4TGluayA9IF8ubWF4QnkodGhpc0dyYXBoLmxpbmtzLCBmdW5jdGlvbihsKSB7XG5cdFx0ICAgICAgICBcdGlmIChsLmdyYXBoICE9IG51bGwpIHtcblx0XHRcdFx0XHRcdHJldHVybiBsLmdldFdlaWdodCgpO1xuXHRcdCAgICAgICAgXHR9XG5cdFx0ICAgICAgICBcdHJldHVybiAwO1xuXHRcdCAgICAgICAgfSk7XG5cdFx0ICAgICAgICBzdGF0ZS5tYXhXZWlnaHQgPSBtYXhMaW5rLmdldFdlaWdodCgpO1xuXHRcdCAgICB9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsbGVkIGR1cmluZyB0aGUgdXBkYXRlIGdyYXBoIGZvciBleGlzdGluZyBsaW5rc1xuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzcGF0aCAgVGhlIGQzIHBhdGhcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtMaW5rfSAgXHQgICBkICAgICAgIE1hdGNoaW5nIExpbmsgT2JqZWN0ICAgICAgIFxuXHRcdFx0ICovXG5cdFx0XHR1cGRhdGVBdHRyKGQzcGF0aCwgZCkge1xuXHRcdCAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG5cdFx0ICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuVmlzdWFsaXplckxpbms7XG5cdFx0ICAgICAgICB0aGlzLnVwZGF0ZU1heFdlaWdodCgpO1xuXHQgICAgICAgICAgICB2YXIgY29sb3JTY2FsZSA9IGQzLnNjYWxlLmxpbmVhcigpXG5cdCAgICAgICAgICAgICAgICAuZG9tYWluKFswLCBzdGF0ZS5tYXhXZWlnaHRdKVxuXHQgICAgICAgICAgICAgICAgLnJhbmdlKFtcIiNmZmIzNjZcIiwgXCIjRjkyNjA2XCJdKTtcblx0ICAgICAgICAgICAgc3RhdGUuY29sb3JTY2FsZSA9IGNvbG9yU2NhbGU7XG5cdFx0XHRcdGQzcGF0aC5zdHlsZSgnbWFya2VyLWVuZCcsICd1cmwoI2VuZC1hcnJvdyknKVxuXHRcdCAgICAgICAgICAgIC5jbGFzc2VkKHRoaXNHcmFwaC5jb25zdHMuc2VsZWN0ZWRDbGFzcywgZnVuY3Rpb24oZCl7XG5cdFx0ICAgICAgICAgICAgICAgIHJldHVybiBkID09PSBzdGF0ZS5zZWxlY3RlZEVkZ2U7XG5cdFx0ICAgICAgICAgICAgfSlcblx0XHQgICAgICAgICAgICAuYXR0cihcImRcIiwgdGhpcy5hcnJvd1BhdGguY2FsbChkKSlcblx0XHQgICAgICAgICAgICAudHJhbnNpdGlvbihcImV4aXN0aW5nUGF0aFRyYW5zaXRpb25cIilcblx0XHQgICAgICAgICAgICAuZHVyYXRpb24oNzUwKVxuXHRcdCAgICAgICAgICAgIC5hdHRyKFwic3Ryb2tlXCIsIGZ1bmN0aW9uKGQpe1xuXHRcdCAgICAgICAgICAgICAgICB2YXIgYyA9IGNvbG9yU2NhbGUoZC5nZXRXZWlnaHQoKSk7XG5cdFx0ICAgICAgICAgICAgICAgIHJldHVybiBjO1xuXHRcdCAgICAgICAgICAgIH0pO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCBkdXJpbmcgdGhlIGZpcnN0IHVwZGF0ZSBncmFwaCBmb3IgdGhpcyBsaW5rXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuXHRcdFx0ICogQHBhcmFtICAgICAge0xpbmt9ICBcdCAgIGQgICAgICAgTWF0Y2hpbmcgTGluayBPYmplY3Rcblx0XHRcdCAqL1xuXHRcdFx0bmV3UGF0aEF0dHIoZDNwYXRoLCBkKSB7XG5cdFx0ICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcblx0XHQgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluaztcblx0ICAgICAgICAgICAgdGhpcy51cGRhdGVNYXhXZWlnaHQoKTtcblx0ICAgICAgICAgICAgdmFyIGNvbG9yU2NhbGUgPSBkMy5zY2FsZS5saW5lYXIoKVxuXHQgICAgICAgICAgICAgICAgLmRvbWFpbihbMCwgc3RhdGUubWF4V2VpZ2h0XSlcblx0ICAgICAgICAgICAgICAgIC5yYW5nZShbXCIjZmZiMzY2XCIsIFwiI0Y5MjYwNlwiXSk7XG5cdCAgICAgICAgICAgICAgICBcblx0XHRcdFx0ZDNwYXRoLnRyYW5zaXRpb24oXCJuZXdQYXRoVHJhbnNpdGlvblwiKVxuXHRcdCAgICAgICAgICAgIC5kdXJhdGlvbig3NTApXG5cdFx0ICAgICAgICAgICAgLmF0dHJUd2VlbihcIm9wYWNpdHlcIiwgZnVuY3Rpb24oZCkge1xuXHRcdCAgICAgICAgICAgICAgICByZXR1cm4gZDMuaW50ZXJwb2xhdGVTdHJpbmcoMCwxKTtcblx0XHQgICAgICAgICAgICB9KVxuXHRcdCAgICAgICAgICAgIC5hdHRyKFwic3Ryb2tlXCIsIGZ1bmN0aW9uKGQpe1xuXHRcdCAgICAgICAgICAgICAgICB2YXIgYyA9IGNvbG9yU2NhbGUoZC5nZXRXZWlnaHQoKSk7XG5cdFx0ICAgICAgICAgICAgICAgIHJldHVybiBjO1xuXHRcdCAgICAgICAgICAgIH0pXG5cdFx0ICAgICAgICAgICAgLmF0dHIoJ2QnLCB0aGlzLmFycm93UGF0aC5jYWxsKGQpKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0TGluayA6IFZpc3VhbGl6ZXJMaW5rXG5cdFx0fVxufV0pO1xuXG5cblxuXG5cbiIsIi8qKlxuICogVGhlIGJhc2UgY2xhc3MgZm9yIG5vZGUgb2JqZWN0cyBmb3IgdGhlIGdyYXBoLlxuICogU3VwcG9ydHMgcG9saWNpZXMuXG4gKiBcbiAqIFRvIHdyaXRlIHlvdXIgb3duIE5vZGUgb2JqZWN0LCBjcmVhdGUgYSBuZXcgZmFjdG9yeSB0aGF0IHVzZXMgdGhlIG5vZGVcbiAqIHlvdSB3YW50IHRvIGluaGVyaXQgYXMgYSBkZXBlbmRlbmN5LCBhbmQgZXh0ZW5kIGl0cyBub2RlIGNsYXNzLiBcbiAqIFJldHVybiB0aGUgY2xhc3Mgb2JqZWN0IHdpdGggTm9kZSBhcyBrZXlcbiAqIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnTm9kZScsIFtmdW5jdGlvbiAoKSB7XG5cdFx0Y2xhc3MgTm9kZSB7XG5cdFx0XHQvKipcblx0XHRcdCAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeCAgICAgICB4IGxvY2F0aW9uXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeSAgICAgICB5IGxvY2F0aW9uXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgaWQgICAgICBUaGUgaWRlbnRpZmllclxuXHRcdFx0ICogQHBhcmFtICAgICAge3N0cmluZ30gIHRleHQgICAgVGhlIHRleHQgdG8gZGlzcGxheVxuXHRcdFx0ICogQHBhcmFtICAgICAge251bWJlcn0gIHJhZGl1cyAgVGhlIHJhZGl1cyBvZiB0aGUgbm9kZVxuXHRcdFx0ICovXG5cdFx0XHRjb25zdHJ1Y3Rvcih4LCB5LCBpZCwgdGV4dCwgcmFkaXVzKSB7XG5cdFx0XHRcdHRoaXMueCA9IHg7XG5cdFx0XHRcdHRoaXMueSA9IHk7XG5cdFx0XHRcdHRoaXMucmFkaXVzID0gcmFkaXVzO1xuXHRcdFx0XHR0aGlzLmlkID0gaWQ7XG5cdFx0XHRcdHRoaXMudGV4dCA9IHRleHQ7XG5cdFx0XHRcdHRoaXMucmFkaXVzID0gcmFkaXVzO1xuXHRcdFx0XHR0aGlzLmhhc1BvbGljeSA9IGZhbHNlO1xuXHRcdFx0XHR0aGlzLnBvbGljeSA9IG51bGw7XG5cdFx0XHRcdHRoaXMubm9kZVBvbGljaWVzID0gW107XG5cdFx0XHRcdHRoaXMuZ3JhcGggPSBudWxsO1xuXHRcdFx0XHR0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsbGVkIHdoZW4gYSBub2RlIGlzIGFkZGVkIHRvIHRoZSBncmFwaFxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoIGl0IGlzIGFkZGVkIHRvXG5cdFx0XHQgKi9cblx0XHRcdGluaXRpYWxpemUoZ3JhcGgpIHtcblx0XHRcdFx0aWYgKHRoaXMuaW5pdGlhbGl6ZWQgPT0gZmFsc2UpIHtcblx0XHRcdFx0XHR0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcblx0XHRcdFx0XHR0aGlzLmdyYXBoID0gZ3JhcGg7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxsZWQgZHVyaW5nIHRoZSB1cGRhdGUgZ3JhcGggZm9yIGV4aXN0aW5nIGxpbmtzXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuXHRcdFx0ICovXG5cdFx0XHR1cGRhdGVBdHRyKGQzbm9kZSwgZCkge1xuXHRcdFx0XHRkM25vZGUuYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbihkKXtyZXR1cm4gXCJ0cmFuc2xhdGUoXCIgKyBkLnggKyBcIixcIiArIGQueSArIFwiKVwiO30pO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCBkdXJpbmcgdGhlIGZpcnN0IHVwZGF0ZSBncmFwaCBmb3IgYSBub2RlXG5cdFx0XHQgKiBIb29rIGZvciBzdWIgY2xhc3Nlc1xuXHRcdFx0ICogXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7Tm9kZX0gICAgICBkICAgICAgIE1hdGNoaW5nIE5vZGUgT2JqZWN0XG5cdFx0XHQgKi9cblx0XHRcdG5ld05vZGVBdHRyKGQzbm9kZSwgZCkge1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFNldHMgdGhlIHJhZGl1cyBvZiB0aGUgbm9kZS5cblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgcmFkaXVzICBUaGUgcmFkaXVzXG5cdFx0XHQgKi9cblx0XHRcdHNldFJhZGl1cyhyYWRpdXMpIHtcblx0XHRcdFx0dGhpcy5yYWRpdXMgPSByYWRpdXM7XG5cdFx0XHR9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIFVzZWQgdG8gaW5zdGFsbCBwb2xpY2llcyB0aGF0IGFyZSBjYWxsZWQgd2hlbiB0aGlzXG5cdFx0ICAgICAqIG5vZGUgaGFzIGEgbW91c2UgZXZlbnRcblx0XHQgICAgICpcblx0XHQgICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeSAgVGhlIHBvbGljeSB0byBpbnN0YWxsXG5cdFx0ICAgICAqL1xuXHRcdFx0aW5zdGFsbE5vZGVQb2xpY3kocG9saWN5KSB7XG5cdFx0XHRcdHRoaXMuaGFzUG9saWN5ID0gdHJ1ZTtcblx0XHRcdFx0dGhpcy5ub2RlUG9saWNpZXMucHVzaChwb2xpY3kpO1xuXHRcdFx0XHRwb2xpY3kuaW5pdGlhbGl6ZSh0aGlzLmdyYXBoKTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBVc2VkIHRvIHVuaW5zdGFsbCBwb2xpY3kgZm9yIHRoaXMgbm9kZVxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtQb2xpY3l8c3RyaW5nfSAgcG9saWN5UmVtb3ZlICBUaGUgcG9saWN5IHRvIHJlbW92ZVxuXHRcdFx0ICovXHRcdFx0XG5cdFx0XHR1bmluc3RhbGxOb2RlUG9saWN5KHBvbGljeVJlbW92ZSkge1xuXHRcdFx0XHR2YXIgcG9saWN5UmVtb3ZlTmFtZTtcblx0XHRcdFx0dmFyIHRoaXNOb2RlID0gdGhpcztcblx0XHRcdFx0aWYgKHR5cGVvZiBwb2xpY3lSZW1vdmUgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0cG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlLnBvbGljeU5hbWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0Xyh0aGlzTm9kZS5ub2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5LCBpbmRleCkge1xuXHRcdFx0XHRcdGlmIChwb2xpY3kucG9saWN5TmFtZSA9PT0gcG9saWN5UmVtb3ZlTmFtZSkge1xuXHRcdFx0XHRcdFx0cG9saWN5LmRlc3Ryb3koKTtcblx0XHRcdFx0XHRcdHRoaXNOb2RlLm5vZGVQb2xpY2llcy5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHRcdGlmICh0aGlzTm9kZS5ub2RlUG9saWNpZXMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdFx0dGhpc05vZGUuaGFzUG9saWN5ID0gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxsZWQgd2hlbiB0aGVyZSBpcyBhIG1vdXNlIGV2ZW50IGZvciB0aGlzIG5vZGVcblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgZXZlbnQgICAgIFRoZSBtb3VzZSBldmVudFxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuXHRcdFx0ICogQHBhcmFtICAgICAge09iamVjdH0gIGQgICAgICAgICBUaGUgbWF0Y2hpbmcgbm9kZSBvYmplY3Rcblx0XHRcdCAqL1xuXHRcdFx0bm9kZVBvbGljeUV2ZW50KGV2ZW50LCBkM25vZGUsIGQpIHtcblx0XHRcdFx0Xy5mb3JFYWNoKHRoaXMubm9kZVBvbGljaWVzLCBmdW5jdGlvbihwb2xpY3kpIHtcblx0XHRcdFx0XHRwb2xpY3lbZXZlbnRdKGQzbm9kZSwgZCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4ge1xuXHRcdFx0Tm9kZTogTm9kZVxuXHRcdH1cbn1dKTtcblxuXG5cblxuXG5cblxuIiwiLyoqXG4gKiBUaGUgbm9kZSB0aGF0IGlzIHVzZWQgc3BlY2lmaWNhbGx5IGZvciB0aGUgdmlzdWFsaXphdGlvbiB0YWIuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdWaXN1YWxpemVyTm9kZScsIFsnTm9kZScsIGZ1bmN0aW9uIChOb2RlKSB7XG5cdFx0Y2xhc3MgVmlzdWFsaXplck5vZGUgZXh0ZW5kcyBOb2RlLk5vZGUge1xuXHRcdFx0LyoqXG5cdFx0XHQgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge251bWJlcn0gIHggICAgICAgXHR4IGxvY2F0aW9uXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeSAgICAgICBcdHkgbG9jYXRpb25cblx0XHRcdCAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBpZCAgICAgIFx0VGhlIGlkZW50aWZpZXJcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICB0ZXh0ICAgIFx0VGhlIHRleHQgdG8gZGlzcGxheVxuXHRcdFx0ICogQHBhcmFtICAgICAge251bWJlcn0gIHJhZGl1cyAgXHRUaGUgcmFkaXVzIG9mIHRoZSBub2RlXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgcGFyZW50ICAgICBUaGUgcGFyZW50IGlkXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgYW5jZXN0b3JzICBBcnJheSBvZiBhbmNlc3RvcnMgSWRcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB4U3RhcnQgICAgIHggbG9jIHRvIHN0YXJ0IGFuaW1hdGlvblxuXHRcdFx0ICogQHBhcmFtICAgICAge251bWJlcn0gIHlTdGFydCAgICAgeSBsb2MgdG8gc3RhcnQgYW5pbWF0aW9uXG5cdFx0XHQgKi9cblx0XHQgICAgY29uc3RydWN0b3IoeCwgeSwgaWQsIHRleHQsIHJhZGl1cywgcGFyZW50LCBhbmNlc3RvcnMsIFxuXHRcdCAgICBcdHhTdGFydCwgeVN0YXJ0KSB7XG5cdFx0ICAgICAgICBzdXBlcih4LCB5LCBpZCwgdGV4dCwgcmFkaXVzKTtcblx0XHQgICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuXHRcdCAgICAgICAgdGhpcy5hbmNlc3RvcnMgPSBhbmNlc3RvcnM7XG5cdFx0ICAgICAgICBpZiAoeFN0YXJ0ID09IG51bGwpIHtcblx0XHQgICAgICAgIFx0dGhpcy54U3RhcnQgPSB4O1xuXHRcdCAgICAgICAgfSBlbHNlIHtcblx0XHQgICAgICAgIFx0dGhpcy54U3RhcnQgPSB4U3RhcnQ7XG5cdFx0ICAgICAgICB9XG5cdFx0ICAgICAgICBpZiAoeVN0YXJ0ID09IG51bGwpIHtcblx0XHQgICAgICAgIFx0dGhpcy55U3RhcnQgPSB5O1xuXHRcdCAgICAgICAgfSBlbHNlIHtcblx0XHQgICAgICAgIFx0dGhpcy55U3RhcnQgPSB5U3RhcnQ7XG5cdFx0ICAgICAgICB9XG5cdFx0ICAgIH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxsZWQgZHVyaW5nIHRoZSBmaXJzdCB1cGRhdGUgZ3JhcGggZm9yIGEgbm9kZVxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICBkICAgICAgICAgVGhlIG1hdGNoaW5nIE5vZGVcblx0XHRcdCAqL1xuXHRcdFx0bmV3Tm9kZUF0dHIoZDNub2RlLCBkKSB7XG5cdFx0XHRcdHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoO1xuXHRcdFx0XHRpZiAodGhpc0dyYXBoLmNvbnN0cy5jb250YWluZXJDbGFzcyAhPSBudWxsICYmXG5cdFx0XHRcdFx0XHR0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbZC5pZF0gPT0gbnVsbCkge1xuXHRcdFx0XHRcdGQzbm9kZS5jbGFzc2VkKHRoaXNHcmFwaC5jb25zdHMuY29udGFpbmVyQ2xhc3MsIHRydWUpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGQzbm9kZS50cmFuc2l0aW9uKFwibm9kZVBvc2l0aW9uVHJhbnNpdGlvblwiKVxuXHRcdCAgICAgICAgICAgICAgICAuZHVyYXRpb24oNzUwKVxuXHRcdCAgICAgICAgICAgICAgICAuYXR0clR3ZWVuKFwidHJhbnNmb3JtXCIsIGZ1bmN0aW9uKGQpIHtcblx0XHQgICAgICAgICAgICAgICAgICAgIGlmIChkLnhTdGFydCAhPSBudWxsICYmIGQueVN0YXJ0ICE9IG51bGwpIHtcblx0XHQgICAgICAgICAgICAgICAgICAgICAgICB2YXIgeFN0YXJ0ID0gZC54U3RhcnQ7XG5cdFx0ICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHlTdGFydCA9IGQueVN0YXJ0O1xuXHRcdCAgICAgICAgICAgICAgICAgICAgICAgIGQueFN0YXJ0ID0gZC54O1xuXHRcdCAgICAgICAgICAgICAgICAgICAgICAgIGQueVN0YXJ0ID0gZC55O1xuXHRcdCAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkMy5pbnRlcnBvbGF0ZVN0cmluZyhcInRyYW5zbGF0ZShcIiArIHhTdGFydCArIFwiLFwiICsgeVN0YXJ0ICsgXCIpXCIsIFwidHJhbnNsYXRlKFwiICsgZC54ICsgXCIsXCIgKyBkLnkgKyBcIilcIik7XG5cdFx0ICAgICAgICAgICAgICAgICAgICB9XG5cdFx0ICAgICAgICAgICAgICAgICAgICByZXR1cm4gZDMuaW50ZXJwb2xhdGVTdHJpbmcoXCJ0cmFuc2xhdGUoXCIgKyBkLnggKyBcIixcIiArIGQueSArIFwiKVwiLCBcInRyYW5zbGF0ZShcIiArIGQueCArIFwiLFwiICsgZC55ICsgXCIpXCIpO1xuXHRcdCAgICAgICAgICAgICAgICB9KTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0Tm9kZTogVmlzdWFsaXplck5vZGVcblx0XHR9XG5cbn1dKTtcblxuXG5cblxuXG5cblxuXG4iLCIvKipcbiAqIFRoaXMgcG9saWN5IGlzIHVzZWQgdG8gYWRkIGEgc2VsZWN0IG5vZGUgZmVhdHVyZS5cbiAqIFN1cHBvcnRzIHNlbGVjdGluZyBtdWx0aXBsZSBub2RlcyBieSB1c2luZyB0aGUgY3RybCBrZXkuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdOb2RlU2VsZWN0aW9uUG9saWN5JywgWydQb2xpY3knLCBmdW5jdGlvbiAoUG9saWN5KSB7XG5cbiAgICBcdGNsYXNzIE5vZGVTZWxlY3Rpb25Qb2xpY3kgZXh0ZW5kcyBQb2xpY3kuUG9saWN5IHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgICAgICBzdXBlcihcIk5vZGVTZWxlY3Rpb25Qb2xpY3lcIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gcG9saWN5IGlzIGluc3RhbGxlZFxuICAgICAgICAgICAgICogT3ZlcndyaXRlcyB0aGUgb24gZHJhZyBldmVudCBvZiB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgXG4gICAgXHRcdCAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFsbGVkIG9uXG4gICAgXHRcdCAqL1xuICAgICAgICAgICAgaW5pdGlhbGl6ZShncmFwaCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3VwZXIuaW5pdGlhbGl6ZShncmFwaCk7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLnNlbGVjdGVkTm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgY29uc3RzID0gZ3JhcGguY29uc3RzLk5vZGVTZWxlY3Rpb25Qb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICBjb25zdHMuc2VsZWN0ZWRDbGFzcyA9IFwic2VsZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAvL292ZXJ3cml0dGluZyBncmFwaCdzIG5vZGUgb24gZHJhZyBldmVudCB0byBzdXBwb3J0XG4gICAgICAgICAgICAgICAgLy9tb3ZpbmcgbXVsdGlwbGUgbm9kZXMgYXQgb25jZVxuICAgICAgICAgICAgICAgIHZhciBkcmFnID0gZ3JhcGguZHJhZztcbiAgICAgICAgICAgICAgICBkcmFnLm9uKCdkcmFnJywgZnVuY3Rpb24oYXJncykge1xuICAgICAgICAgICAgICAgIFx0dmFyIHRoaXNHcmFwaCA9IGdyYXBoO1xuICAgICAgICAgICAgICAgIFx0aWYgKHRoaXNHcmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgXHRcdHZhciBzZWxlY3RlZENsYXNzID0gdGhpc0dyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5LnNlbGVjdGVkQ2xhc3M7XG4gICAgICAgICAgICAgICAgXHRcdHZhciBzZWxlY3Rpb24gPSBkMy5zZWxlY3RBbGwoICcuJyArc2VsZWN0ZWRDbGFzcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBzZWxlY3Rpb25bMF0uaW5kZXhPZiggdGhpcyk9PS0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uLmNsYXNzZWQoc2VsZWN0ZWRDbGFzcywgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGlvbiA9IGQzLnNlbGVjdCggdGhpcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uLmNsYXNzZWQoc2VsZWN0ZWRDbGFzcywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IFxuXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb24uYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbiggZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCArPSBkMy5ldmVudC5keDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gZDMuZXZlbnQuZHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwidHJhbnNsYXRlKFwiICsgWyBkLngsZC55IF0gKyBcIilcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgICAgICBcdH1cblxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQWRkcyB0aGUgZ2l2ZW4gbm9kZSB0byB0aGUgYXJyYXkgb2Ygc2VsZWN0ZWQgbm9kZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM05vZGUgICAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgIG5vZGVEYXRhICBNYXRjaGluZyBOb2RlIG9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBhZGRTZWxlY3ROb2RlKGQzTm9kZSwgbm9kZURhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgZDNOb2RlLmNsYXNzZWQoY29uc3RzLnNlbGVjdGVkQ2xhc3MsIHRydWUpO1xuICAgICAgICAgICAgICAgIHN0YXRlLnNlbGVjdGVkTm9kZXMucHVzaChub2RlRGF0YSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyB0aGUgZ2l2ZW4gbm9kZSBmcm9tIHRoZSBhcnJheSBvZiBzZWxlY3RlZCBub2Rlcy5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM05vZGUgICAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgIG5vZGVEYXRhICBNYXRjaGluZyBub2RlIG9iamVjdCBcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgcmVtb3ZlU2VsZWN0RnJvbU5vZGUoZDNOb2RlLCBub2RlRGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzLk5vZGVTZWxlY3Rpb25Qb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5maWx0ZXIoZnVuY3Rpb24oY2QpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNkLmlkID09PSBub2RlRGF0YS5pZDtcbiAgICAgICAgICAgICAgICB9KS5jbGFzc2VkKGNvbnN0cy5zZWxlY3RlZENsYXNzLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gc3RhdGUuc2VsZWN0ZWROb2Rlcy5pbmRleE9mKG5vZGVEYXRhKTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zZWxlY3RlZE5vZGVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyBhbGwgc2VsZWN0ZWQgbm9kZXMuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHJlbW92ZUFsbFNlbGVjdGVkTm9kZXMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmNsYXNzZWQoY29uc3RzLnNlbGVjdGVkQ2xhc3MsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zZWxlY3RlZE5vZGVzID0gW107XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogT24gTW91c2Vkb3duLCBkZXRlcm1pbmVzIHdoZXRoZXIgdG8gY2hhbmdlIHRoZVxuICAgICAgICAgICAgICogc2VsZWN0ZWQgc3RhdHVzIG9mIHRoZSBjbGlja2VkIG5vZGUuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgZCAgICAgICBNYXRjaGluZyBOb2RlIE9iamVjdCAgICAgICBcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgbW91c2Vkb3duKGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuICAgICAgICAgICAgICAgIGQzLmV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIGlmIChkMy5ldmVudC5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5zZWxlY3RlZE5vZGVzLmluZGV4T2YoZCkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVTZWxlY3RGcm9tTm9kZShkM25vZGUsIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRTZWxlY3ROb2RlKGQzbm9kZSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHN0YXRlLnNlbGVjdGVkTm9kZXMuaW5kZXhPZihkKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIG5vIGNvbnRyb2wga2V5LCBhbmQgY2xpY2tlZCBub3Qgc2VsZWN0ZWQgbm9kZSxcbiAgICAgICAgICAgICAgICAgICAgLy9yZW1vdmUgYWxsIG9mIGN1cnJlbnQgc2VsZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQWxsU2VsZWN0ZWROb2RlcygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBPbiBNb3VzZXVwLCBkZXRlcm1pbmVzIHdoZXRoZXIgdG8gY2hhbmdlIHRoZVxuICAgICAgICAgICAgICogc2VsZWN0ZWQgc3RhdHVzIG9mIHRoZSBjbGlja2VkIG5vZGUuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgZCAgICAgICBNYXRjaGluZyBOb2RlIE9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBtb3VzZXVwKGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuICAgICAgICAgICAgICAgIGlmICghZDMuZXZlbnQuY3RybEtleSkge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIGxlbmd0aCBpcyBncmVhdGVyIHRoYW4gMSwgdGhlbiB3ZSBhcmUgbW92aW5nIG11bHRpcGxlIG5vZGVzXG4gICAgICAgICAgICAgICAgICAgIC8vbGVhdmUgdGhlbSBhbGwgaGlnaGxpZ2h0ZWRcbiAgICAgICAgICAgICAgICAgICAgLy9vdGhlcndpc2Ugd2UgYXJlIGp1c3QgbW92aW5nIG9uZSBub2RlLCBzbyB1bmhpZ2hsaWdodFxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuc2VsZWN0ZWROb2Rlcy5sZW5ndGggPD0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVTZWxlY3RGcm9tTm9kZShkM25vZGUsIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBQb2xpY3k6IE5vZGVTZWxlY3Rpb25Qb2xpY3lcbiAgICAgICAgfVxufV0pO1xuXG5cblxuXG5cblxuXG4iLCIvKipcbiAqIFRoaXMgcG9saWN5IGNoYW5nZXMgdGhlIHZpZXcgdG8gdGhlIHRpbWVncmFwaCBvZiBsaW5rIGRhdGEgb24gY2xpY2suXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdQYXRoQ2hhbmdlVmlld1BvbGljeScsIFsnUG9saWN5JywgZnVuY3Rpb24gKFBvbGljeSkge1xuICAgIFx0Y2xhc3MgUGF0aENoYW5nZVZpZXdQb2xpY3kgZXh0ZW5kcyBQb2xpY3kuUG9saWN5IHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHRvIGJ1aWxkIHBvbGljeVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgIHtBbmd1bGFyIFN0YXRlfSAgICAkc3RhdGUgICAgVXNlZCB0byBjaGFuZ2Ugdmlld1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcigkc3RhdGUpIHtcbiAgICAgICAgICAgICAgICBzdXBlcignUGF0aENoYW5nZVZpZXdQb2xpY3knKTtcbiAgICAgICAgICAgICAgICB0aGlzLiRzdGF0ZSA9ICRzdGF0ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBHZW5lcmF0ZXMgYSBsaXN0IG9mIGFsbCBjaGlsZCBjb250YWluZXJzIG9mIHRoZSBzZXJ2aWNlXG4gICAgICAgICAgICAgKiBDYW4gaGFuZGxlIG5lc3RlZCBzZXJ2aWNlcy5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgaWQgICAgICBOb2RlIElEXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGdlbmVyYXRlTGlzdChpZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgcmV0TGlzdCA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBub2RlSWRzID0gdGhpcy5ncmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFtpZF07XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKG5vZGVJZHMsIGZ1bmN0aW9uKGNoaWxkSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNQb2xpY3kuZ3JhcGguZGF0YVNvdXJjZS5oYXNDaGlsZChjaGlsZElkKSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0TGlzdC5jb25jYXQodGhpc1BvbGljeS5nZW5lcmF0ZUxpc3QoY2hpbGRJZCkpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0TGlzdC5wdXNoKGNoaWxkSWQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJldExpc3RcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIHJlcm91dGUgYW4gZWRnZSB3aGVuIGNsaWNrZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7TGlua30gIGVkZ2UgICAgVGhlIGNsaWNrZWQgZWRnZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB2aWV3RWRnZShlZGdlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNvdXJjZUxpc3QgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0TGlzdCA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBzb3VyY2VJZCA9IGVkZ2Uuc291cmNlLmlkO1xuICAgICAgICAgICAgICAgIHZhciB0YXJnZXRJZCA9IGVkZ2UudGFyZ2V0LmlkO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZ3JhcGguZGF0YVNvdXJjZS5oYXNDaGlsZChzb3VyY2VJZCkgPT09IHRydWUpIHsvL05vdCBhIGNvbnRhaW5lciBub2RlLCBuZWVkIHRvIGFnZ3JlZ2F0ZVxuICAgICAgICAgICAgICAgICAgICBzb3VyY2VMaXN0ID0gdGhpcy5nZW5lcmF0ZUxpc3Qoc291cmNlSWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZUxpc3QgPSBbc291cmNlSWRdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmdyYXBoLmRhdGFTb3VyY2UuaGFzQ2hpbGQodGFyZ2V0SWQpID09PSB0cnVlKSB7Ly9Ob3QgYSBjb250YWluZXIgbm9kZSwgbmVlZCB0byBhZ2dyZWdhdGVcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TGlzdCA9IHRoaXMuZ2VuZXJhdGVMaXN0KHRhcmdldElkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRMaXN0ID0gW3RhcmdldElkXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy4kc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZpc3VhbGl6YXRpb24uZWRnZScsIFxuICAgICAgICAgICAgICAgICAgICB7c291cmNlTmFtZTogc291cmNlSWQsIHRhcmdldE5hbWU6IHRhcmdldElkLFxuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlTGlzdDogc291cmNlTGlzdCwgdGFyZ2V0TGlzdDogdGFyZ2V0TGlzdH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBtb3VzZWRvd24oZDNwYXRoLCBkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52aWV3RWRnZShkKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBQb2xpY3k6IFBhdGhDaGFuZ2VWaWV3UG9saWN5XG4gICAgICAgIH1cbn1dKTtcblxuXG5cblxuXG5cblxuXG5cblxuXG4iLCIvKipcbiAqIEJhc2UgcG9saWN5IGNsYXNzIGZvciB0aGUgZ3JhcGggb2JqZWN0XG4gKiBcbiAqIFBvbGljaWVzIGFyZSB1c2VkIHRvIGlzb2xhdGUgZmVhdHVyZXMgZm9yIGEgZ3JhcGguXG4gKiBQb2xpY2llcyBjYW4gYmUgaW5zdGFsbGVkIG9uIG5vZGVzLCBsaW5rcywgb3IgdGhlIGdyYXBoLlxuICogRWFjaCBwb2xpY3kgaGFzIGludGVyYWN0aW9uIGhhbmRsZXJzIHRoYXQgd2lsbCBiZSBjYWxsZWQgYnkgdGhlIGdyYXBoXG4gKiBpZiBpbnN0YWxsZWQuIFBvbGljaWVzIGNhbiBhbHNvIG1vZGlmeSBncmFwaCBmdW5jdGlvbnMgKHNlZSBRVGlwUG9saWN5KS5cbiAqIE11bHRpcGxlIHBvbGljaWVzIGNhbiBiZSBpbnN0YWxsZWQgZm9yIGEgbm9kZSBvciBsaW5rLiBcbiAqIFxuICogVG8gd3JpdGUgeW91ciBvd24gcG9saWN5LCBjcmVhdGUgYSBuZXcgZmFjdG9yeSB0aGF0IHVzZXMgdGhlIHBvbGljeVxuICogeW91IHdhbnQgdG8gaW5oZXJpdCBhcyBhIGRlcGVuZGVuY3ksIGFuZCBleHRlbmQgaXRzIHBvbGljeS4gXG4gKiBSZXR1cm4gdGhlIGNsYXNzIG9iamVjdCB3aXRoIFBvbGljeSBhcyBrZXksIGFuZCBcbiAqIGFkZCB0aGUgcG9saWN5IHRvIHRoZSBQb2xpY3lTZXJ2aWNlIGZhY3RvcnkuXG4gKiBcbiAqIEZvciBzYXZpbmcgc3RhdGUgb3IgY29uc3RzIGZvciB0aGUgcG9saWN5LCBjcmVhdGUgYSBuYW1lc3BhY2VcbiAqIGluIGdyYXBoLnN0YXRlIGFuZCBncmFwaC5jb25zdHMuXG4gKiBFeC4gXG4gKiAgICAgIGdyYXBoLnN0YXRlLm15UG9saWN5ID0ge307XG4gKiAgICAgIGdyYXBoLmNvbnN0cy5teVBvbGljeSA9IHt9O1xuICogICAgICBcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ1BvbGljeScsIFtmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNsYXNzIFBvbGljeSB7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgcG9saWN5TmFtZSAgVGhlIHBvbGljeSBuYW1lXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHBvbGljeU5hbWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBvbGljeU5hbWUgPSBwb2xpY3lOYW1lO1xuICAgICAgICAgICAgICAgIHRoaXMuZ3JhcGggPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgcG9saWN5IGlzIGluc3RhbGxlZC5cbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICB7R3JhcGh9ICBncmFwaCAgIFRoZSBHcmFwaCB0aGF0IHRoZSBwb2xpY3kgaXNcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICBiZWluZyBpbnN0YWxsZWQgb25cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5pdGlhbGl6ZShncmFwaCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjsgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuZ3JhcGggPSBncmFwaDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBIYW5kbGVyLCBtZWFudCB0byBiZSBvdmVycmlkZGVuIGluIHN1YmNsYXNzZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gIHtkMyBvYmplY3R9ICAgIGQzb2JqICAgIFRoZSBkM29iamVjdFxuICAgICAgICAgICAgICogQHBhcmFtICB7Tm9kZS9MaW5rL0dyYXBofSAgZCAgIFRoZSBvYmplY3QgaXQgd2FzXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFsbGVkIGZvci4gICAgXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIG1vdXNlb3ZlciAoZDNvYmosIGQpIHt9XG4gICAgICAgICAgICBkYmxjbGljayhkM29iaiwgZCkge31cbiAgICAgICAgICAgIGNvbnRleHRtZW51KGQzb2JqLCBkKSB7fVxuICAgICAgICAgICAgbW91c2VvdXQoZDNvYmosIGQpIHt9XG4gICAgICAgICAgICBtb3VzZWRvd24oZDNvYmosIGQpIHt9XG4gICAgICAgICAgICBtb3VzZXVwKGQzb2JqLCBkKSB7fVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgYmUgY2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIGJlaW5nIGRlc3Ryb3llZC5cbiAgICAgICAgICAgICAqIFVzZWQgdG8gcmVtb3ZlIGFueSBlbGVtZW50cyBvciBiaW5kaW5ncyB0aGUgcG9saWN5XG4gICAgICAgICAgICAgKiBoYXMgYWRkZWQuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGRlc3Ryb3koKSB7fVxuICAgICAgICB9XG4gICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgUG9saWN5OiBQb2xpY3lcbiAgICAgICAgfVxufV0pO1xuXG5cblxuXG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuYXBwbGljYXRpb25ncm91cHMnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9hcHBsaWNhdGlvbmdyb3VwcycsXG4gICAgICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICAgICAgfSlcbiAgICB9XSk7XG4iLCIvKipcbiAqIENvbnRhaW5zIGFsbCB0aGUgcG9saWNpZXMuXG4gKiBTZWUgcG9saWN5LmpzIGZvciBpbmZvIG9uIGhvdyBwb2xpY2llcyB3b3JrLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnUG9saWN5U2VydmljZScsIFsnUG9saWN5JywnUVRpcFBvbGljeScsICdQYXRoQ2hhbmdlVmlld1BvbGljeScsIFxuICAgICAgICAnTm9kZVNlbGVjdGlvblBvbGljeScsICdTcGxpdEpvaW5Ob2RlUG9saWN5JywgJ1NwbGl0Sm9pblZpZXdQb2xpY3knLFxuICAgICAgICAnU2F2ZVN0YXRlUG9saWN5JyxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChQb2xpY3ksIFFUaXBQb2xpY3ksIFBhdGhDaGFuZ2VWaWV3UG9saWN5LFxuICAgICAgICAgICAgICAgICAgICAgICAgTm9kZVNlbGVjdGlvblBvbGljeSwgIFNwbGl0Sm9pbk5vZGVQb2xpY3ksIFxuICAgICAgICAgICAgICAgICAgICAgICAgU3BsaXRKb2luVmlld1BvbGljeSwgU2F2ZVN0YXRlUG9saWN5KSB7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBQb2xpY3k6IFBvbGljeS5Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIFFUaXBQb2xpY3k6IFFUaXBQb2xpY3kuUG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBQYXRoQ2hhbmdlVmlld1BvbGljeTogUGF0aENoYW5nZVZpZXdQb2xpY3kuUG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBOb2RlU2VsZWN0aW9uUG9saWN5OiBOb2RlU2VsZWN0aW9uUG9saWN5LlBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgU3BsaXRKb2luTm9kZVBvbGljeTogU3BsaXRKb2luTm9kZVBvbGljeS5Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIFNwbGl0Sm9pblZpZXdQb2xpY3k6IFNwbGl0Sm9pblZpZXdQb2xpY3kuUG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBTYXZlU3RhdGVQb2xpY3k6IFNhdmVTdGF0ZVBvbGljeS5Qb2xpY3lcbiAgICAgICAgICAgICAgICB9XG59XSk7IiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmRhc2hib2FyZCcsIFsnY29udGl2Lm1vZGVscyddKTtcbiIsIi8qKlxuICogVGhpcyBwb2xpY3kgYWRkcyB0b29sdGlwIGZ1bmN0aW9uYWxpdHkgdG8gbm9kZXMgYW5kIGxpbmtzLlxuICogV2hlbiBpbnN0YWxsaW5nLCBpbnN0YWxsIG9uIGJvdGggbGlua3MgYW5kIG5vZGVzLlxuICogXG4gKiBVc2VzIHRoZSBxVGlwIGpRdWVyeSBwbHVnaW5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ1FUaXBQb2xpY3knLCBbJ1BvbGljeScsIGZ1bmN0aW9uIChQb2xpY3kpIHtcbiAgICAgICAgY2xhc3MgUVRpcFBvbGljeSBleHRlbmRzIFBvbGljeS5Qb2xpY3kge1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAgICAgICAgIHN1cGVyKFwiUVRpcFBvbGljeVwiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgcG9saWN5IGlzIGluc3RhbGxlZFxuICAgICAgICAgICAgICogTW9kaWZpZXMgdGhlIHVwZGF0ZU5ld05vZGVzIGFuZCBcbiAgICAgICAgICAgICAqIHVwZGF0ZU5ld1BhdGhzIG1ldGhvZCBvZiB0aGUgZ3JhcGggdG8gaW5zdGFsbCBxdGlwXG4gICAgICAgICAgICAgKiBvbnRvIGVhY2ggbm9kZSBhbmQgcGF0aC5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaCBpdCBpcyBcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFsbGVkIG9uXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluaXRpYWxpemUoZ3JhcGgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHN1cGVyLmluaXRpYWxpemUoZ3JhcGgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBzdGF0ZSA9IGdyYXBoLnN0YXRlLlFUaXBQb2xpY3kgPSB7fTtcblxuICAgICAgICAgICAgICAgIHN0YXRlLm1vdXNlZG93biA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgZ3JhcGguY29uc3RzLlFUaXBQb2xpY3kgPSB7fTtcblxuICAgICAgICAgICAgICAgIC8vVHJhY2tpbmcgbW91c2UgY2xpY2sgc3RhdGUgdG8gbWFrZSB0b29sdGlwXG4gICAgICAgICAgICAgICAgLy9kaXNhcHBlYXIgaWYgdGhlIG5vZGUgaXMgYmVpbmcgZHJhZ2dlZC5cbiAgICAgICAgICAgICAgICAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLm1vdXNldXAoZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5tb3VzZXVwID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvL292ZXJyaWRlIHVwZGF0ZU5ld05vZGVzIGFuZCB1cGRhdGVOZXdQYXRoc1xuICAgICAgICAgICAgICAgIC8vdG8gaW5zdGFsbCBxdGlwXG4gICAgICAgICAgICAgICAgdmFyIGdyYXBoVXBkYXRlTmV3Tm9kZXMgPSBncmFwaC51cGRhdGVOZXdOb2RlcztcbiAgICAgICAgICAgICAgICBncmFwaC51cGRhdGVOZXdOb2RlcyA9IGZ1bmN0aW9uKG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGdyYXBoVXBkYXRlTmV3Tm9kZXMuY2FsbChncmFwaCwgbmV3Tm9kZXMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnVwZGF0ZU5ld05vZGVzKG5ld05vZGVzKTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdmFyIGdyYXBoVXBkYXRlTmV3UGF0aHMgPSBncmFwaC51cGRhdGVOZXdQYXRocztcbiAgICAgICAgICAgICAgICBncmFwaC51cGRhdGVOZXdQYXRocyA9IGZ1bmN0aW9uKG5ld1BhdGhzKSB7XG4gICAgICAgICAgICAgICAgICAgIGdyYXBoVXBkYXRlTmV3UGF0aHMuY2FsbChncmFwaCwgbmV3UGF0aHMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnVwZGF0ZU5ld1BhdGhzKG5ld1BhdGhzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyBhbGwgcVRpcHMgZnJvbSB0aGUgRE9NLlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIHBvbGljeSBpcyB1bmluc3RhbGxlZCBvclxuICAgICAgICAgICAgICogdGhlIGdyYXBoIGlzIGRlc3Ryb3llZC5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZGVzdHJveSgpIHtcbiAgICAgICAgICAgICAgICAvL3JlbW92aW5nIGFsbCBxdGlwIGZyb20gRE9NXG4gICAgICAgICAgICAgICAgJCgnW2lkXj1cInF0aXBcIl0nKS5yZW1vdmUoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBLZWVwaW5nIHRyYWNrIG9mIG1vdXNlZG93biBzdGF0ZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM09iamVjdH0gIGQzb2JqICBUaGUgZDMgcGJqZWN0XG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZS9MaW5rfSAgZCAgICAgVGhlIG1hdGNoaW5nIGRhdGEgb2JqZWN0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIG1vdXNlZG93bihkM29iaiwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5RVGlwUG9saWN5O1xuICAgICAgICAgICAgICAgIHN0YXRlLm1vdXNlZG93biA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogS2VlcGluZyB0cmFjayBvZiBtb3VzZWRvd24gc3RhdGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7ZDNPYmplY3R9ICBkM29iaiAgVGhlIGQzIHBiamVjdFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGUvTGlua30gIGQgICAgIFRoZSBtYXRjaGluZyBkYXRhIG9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBtb3VzZXVwKGQzb2JqLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlFUaXBQb2xpY3k7XG4gICAgICAgICAgICAgICAgc3RhdGUubW91c2Vkb3duID0gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHdoZW5RVGlwQXZhaWxhYmxlKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBpbnRlcnZhbCA9IDUwMDsgLy8gbXNcbiAgICAgICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCQoZG9jdW1lbnQpLnF0aXAgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KHRoaXNQb2xpY3kud2hlblFUaXBBdmFpbGFibGUoY2FsbGJhY2spLCBpbnRlcnZhbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCBpbnRlcnZhbCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gTmV3IE5vZGVzIGFyZSBhZGRlZCBkdXJpbmcgdGhlXG4gICAgICAgICAgICAgKiB1cGRhdGUgZ3JhcGggZnVuY3Rpb25cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7ZDNOb2RlfSAgbmV3Tm9kZXMgIFRoZSBuZXcgbm9kZXMgdGhhdCBhcmVcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmVpbmcgYWRkZWQgdG8gdGhlIGdyYXBoXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHVwZGF0ZU5ld05vZGVzKG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlFUaXBQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhdHRhY2hRVGlwKCkge1xuICAgICAgICAgICAgICAgICAgICAvL2F0dGFjaGluZyBxdGlwXG4gICAgICAgICAgICAgICAgICAgIG5ld05vZGVzLmVhY2goZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRoaXNOb2RlID0gdGhpcztcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vSWYgbm9kZSBoYXMgY2hpbGRyZW4sIHRoZW4gaXQgaXMgYSBzZXJ2aWNlXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0W2QuaWRdICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gXCI8Yj48dT5TZWxlY3RvcnM6PC9iPjwvdT4gXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGVjdG9yTWFwID0gdGhpc0dyYXBoLmRhdGFTb3VyY2Uuc2VsZWN0b3JzW2QuaWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoYXNLZXlzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHNlbGVjdG9yTWFwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc0tleXMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ICs9IGtleSArIFwiIDogPGk+XCIrIHNlbGVjdG9yTWFwW2tleV0gKyBcIjwvaT4sXFxuIFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFzS2V5cyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb21tYSB3aWxsIGJlIHJlbW92ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IFwiTm8gU2VsZWN0b3JzLCBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IFwiPGI+PHU+TGFiZWxzOjwvYj48L3U+IFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsYWJlbHNNYXAgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5sYWJlbHNbZC5pZF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhhc0tleXMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gbGFiZWxzTWFwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc0tleXMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ICs9IGtleSArIFwiIDogPGk+XCIrIGxhYmVsc01hcFtrZXldICsgXCI8L2k+LFxcbiBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhhc0tleXMgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29tbWEgd2lsbCBiZSByZW1vdmVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSBcIk5vIGxhYmVscywgXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy9yZW1vdmUgbGFzdCBjb21tYVxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IHRleHQuc2xpY2UoMCwgLTIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXNOb2RlKS5xdGlwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBkLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0ZXh0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudHM6IHsgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3c6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFwaSA9ICQodGhpc05vZGUpLnF0aXAoJ2FwaScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9ICQoJyNncmFwaENvbnRhaW5lcicpLm9mZnNldCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvc2l0aW9uID0gW29mZnNldC5sZWZ0ICsgKChkLnggKiB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpKSArIHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpWzBdKSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldC50b3AgKyAoKGQueSArZC5yYWRpdXMpICogdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKSkgICsgdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKClbMV1dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBpLnNldCgncG9zaXRpb24udGFyZ2V0JywgcG9zaXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICFzdGF0ZS5tb3VzZWRvd247XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3c6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsYXk6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvbG86ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzZXM6ICdxdGlwLWJsdWUgcXRpcC1zaGFkb3cnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBteTogJ3RvcCBjZW50ZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdDogJ2JvdHRvbSBjZW50ZXInXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRhcmdldDogcG9zaXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQ6ICdtb3VzZWRvd24gbW91c2VsZWF2ZSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9pbmNhc2UgbGlicmFyeSBoYXNuJ3QgbG9hZGVkIHlldFxuICAgICAgICAgICAgICAgIGlmICgkKGRvY3VtZW50KS5xdGlwICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBhdHRhY2hRVGlwKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy53aGVuUVRpcEF2YWlsYWJsZShhdHRhY2hRVGlwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gbmV3IHBhdGhzIGFyZSBhZGRlZCBkdXJpbmcgdGhlXG4gICAgICAgICAgICAgKiB1cGRhdGUgZ3JhcGggZnVuY3Rpb25cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7ZDNQYXRofSAgbmV3UGF0aHMgIFRoZSBuZXcgcGF0aHMgdGhhdCBhcmVcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmVpbmcgYWRkZWQgdG8gdGhlIGdyYXBoXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHVwZGF0ZU5ld1BhdGhzKG5ld1BhdGhzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlFUaXBQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICAvL2luY2FzZSBsaWJyYXJ5IGhhc24ndCBsb2FkZWQgeWV0XG4gICAgICAgICAgICAgICAgaWYgKCQoZG9jdW1lbnQpLnF0aXAgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vYWRkaW5nIHF0aXBcbiAgICAgICAgICAgICAgICAgICAgbmV3UGF0aHMuZWFjaChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGhpc1BhdGggPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9nZXR0aW5nIG1pZHBvaW50IG9mIHBhdGhcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXRoRWwgICA9IGQzLnNlbGVjdCh0aGlzKS5ub2RlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWlkcG9pbnQgPSBwYXRoRWwuZ2V0UG9pbnRBdExlbmd0aChwYXRoRWwuZ2V0VG90YWxMZW5ndGgoKS8yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRSZXQgPSBkLnF0aXBIZWxwZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gXCJCeXRlczogXCIgKyBkLmdldFdlaWdodCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzUGF0aCkucXRpcCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0ZXh0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2lmIG1vdXNlIGlzIGRvd24sIGRvbid0IGxldCBxdGlwIHNob3dcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhc3RhdGUubW91c2Vkb3duO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGF5OiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb2xvOiAkKCcjZ3JhcGhDb250YWluZXInKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NlczogJ3F0aXAtYmx1ZSBxdGlwLXNoYWRvdydcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG15OiB0YXJnZXRSZXQubXksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0OiAnY2VudGVyIGNlbnRlcicsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6ICdtb3VzZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkanVzdDogdGFyZ2V0UmV0LmFkanVzdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudDogJ21vdXNlZG93biBtb3VzZWxlYXZlJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSAgIFxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIFBvbGljeTogUVRpcFBvbGljeVxuICAgICAgICB9XG59XSk7XG5cblxuXG5cblxuXG5cblxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE5LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmxvZ2luJywgWydjb250aXYudXRpbHMnXSk7IiwiLyoqXG4gKiBUaGlzIHBvbGljeSBwcm92aWRlcyBhIHdheSBmb3IgcHJvcGVydGllcyB0byBiZSBzYXZlZCBcbiAqIGJldHdlZW4gdmlldyBjaGFuZ2VzXG4gKiBcbiAqIEl0IG1vZGlmaWVzIHRoZSBkZXN0cm95IGZ1bmN0aW9uIHRvIGFsc28gcGFzcyBpbiBhbiBvYmplY3QgdGhhdFxuICogd2lsbCBoYXZlIGFsbCBpdHMgcHJvcGVydGllcyBzYXZlZCBhbmQgd2lsbCBiZSBhdmFpbGFibGUgXG4gKiBvbiBncmFwaCBsb2FkLiBXaGVuIHNhdmluZyB2YXJpYWJsZXMgdG8gdGhlIG9iamVjdCwgbmFtZXNwYWNlIHdpdGhcbiAqIHRoZSBwb2xpY3kgbmFtZS5cbiAqIFxuICogVGhpcyBwb2xpY3kgbXVzdCBiZSBsb2FkZWQgZmlyc3QgaW4gb3JkZXIgZm9yIGl0IHNhdmVkIHZhcmlhYmxlcyBcbiAqIHRvIGJlIGxvYWRlZCB3aGVuIHRoZSB2aWV3IGNvbWVzIGJhY2sgdG8gdGhlIGdyYXBoXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdTYXZlU3RhdGVQb2xpY3knLCBbJ1BvbGljeScsIGZ1bmN0aW9uIChQb2xpY3kpIHtcbiAgICBcdGNsYXNzIFNhdmVTdGF0ZVBvbGljeSBleHRlbmRzIFBvbGljeS5Qb2xpY3kge1xuICAgIFx0XHRcbiAgICBcdFx0LyoqXG4gICAgXHRcdCAqIFRha2VzIGluIHRoZSBhbmd1bGFyIHNlcnZpY2UgdG8gd2hpY2ggaXQgd2lsbFxuICAgIFx0XHQgKiBzYXZlIGl0J3MgcHJvcGVydGllcyB0by5cbiAgICBcdFx0ICpcbiAgICBcdFx0ICogQHBhcmFtICAgICAge09iamVjdH0gIHNhdmVkU3RhdGUgIE9iamVjdCB0byBzYXZlIFxuICAgIFx0XHQgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllcyB0b1xuICAgIFx0XHQgKi9cbiAgICBcdFx0Y29uc3RydWN0b3Ioc2F2ZWRTdGF0ZSkge1xuICAgIFx0XHRcdHN1cGVyKCdTYXZlU3RhdGVQb2xpY3knKTtcbiAgICBcdFx0XHR0aGlzLnNhdmVkU3RhdGUgPSBzYXZlZFN0YXRlO1xuICAgIFx0XHR9XG5cbiAgICBcdFx0LyoqXG4gICAgXHRcdCAqIENhbGxlZCB3aGVuIHRoZSBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgXHRcdCAqIE1vZGlmaWVzIHRoZSBkZXN0cm95IG1ldGhvZCBcbiAgICBcdFx0ICogYW5kIGFkZHMgYSBsb2FkIG1ldGhvZCB0byB0aGUgZ3JhcGhcbiAgICBcdFx0ICpcbiAgICBcdFx0ICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgXG4gICAgXHRcdCAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFsbGVkIG9uXG4gICAgXHRcdCAqL1xuICAgIFx0XHRpbml0aWFsaXplKGdyYXBoKSB7XG4gICAgXHRcdFx0dGhpcy5ncmFwaCA9IGdyYXBoO1xuICAgIFx0XHRcdHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICBcdFx0XHRncmFwaC5kZXN0cm95ID0gZnVuY3Rpb24oKSB7XG4gICAgXHRcdFx0XHR0aGlzUG9saWN5LmdyYXBoRGVzdHJveS5jYWxsKGdyYXBoLCB0aGlzUG9saWN5LnNhdmVkU3RhdGUpO1xuICAgIFx0XHRcdH07XG5cbiAgICBcdFx0XHRncmFwaC5sb2FkID0gZnVuY3Rpb24oc2F2ZWRTdGF0ZSkge1xuICAgIFx0XHRcdFx0dGhpc1BvbGljeS5ncmFwaExvYWQuY2FsbChncmFwaCwgc2F2ZWRTdGF0ZSk7XG4gICAgXHRcdFx0fVxuICAgIFx0XHR9XG5cbiAgICBcdFx0LyoqXG4gICAgXHRcdCAqIFdpbGwgb3ZlcnJpZGUgdGhlIGdyYXBoJ3MgZGVmYXVsdCBkZXN0cm95LCB3aXRoIFxuICAgIFx0XHQgKiB0aGlzIHBvbGljeSdzIHNhdmVkU3RhdGUgcGFzc2VkIGluLlxuICAgIFx0XHQgKiBDYWxsZWQgd2l0aCB0aGlzIGFzIHRoZSBncmFwaFxuICAgIFx0XHQgKlxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgc2F2ZWRTdGF0ZSAgVGhlIHNhdmVkIHN0YXRlXG4gICAgXHRcdCAqL1xuICAgIFx0XHRncmFwaERlc3Ryb3koc2F2ZWRTdGF0ZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3kuZGVzdHJveShzYXZlZFN0YXRlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3kuZGVzdHJveShzYXZlZFN0YXRlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gdGhpc0dyYXBoLmJpbmRpbmdzKSB7XG4gICAgICAgICAgICAgICAgICAgICQod2luZG93KS5vZmYoa2V5LCB0aGlzR3JhcGguYmluZGluZ3Nba2V5XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgYmUgY2FsbGVkIHdpdGggdGhlIGdyYXBoIGFzIHRoaXNcbiAgICAgICAgICAgICAqIFVzZWQgdG8gaGF2ZSBhbGwgb3RoZXIgcG9saWNpZXMgdXNlIHRoZSBsb2FkIHN0YXRlXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIHNhdmVkU3RhdGUgIFRoZSBzYXZlZCBzdGF0ZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBncmFwaExvYWQoc2F2ZWRTdGF0ZSkge1xuICAgICAgICAgICAgXHR2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgXHRpZiAocG9saWN5LmxvYWQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBcdHBvbGljeS5sb2FkKHNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgICAgICBcdH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICBcdGlmIChwb2xpY3kubG9hZCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIFx0cG9saWN5LmxvYWQoc2F2ZWRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgIFx0fVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgIFx0fVxuICAgIFx0cmV0dXJuIHtcbiAgICBcdFx0UG9saWN5OiBTYXZlU3RhdGVQb2xpY3lcbiAgICBcdH1cbn1dKTtcblxuXG5cblxuXG5cblxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE5LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm1lbnUnLCBbXSk7IiwiLyoqXG4gKiBUaGlzIHBvbGljeSBpcyB1c2VkIGZvciBzcGxpdHRpbmcgYSBub2RlIGludG8gaXRzIGNoaWxkcmVuLFxuICogYW5kIGpvaW5pbmcgdGhlbSBiYWNrIHRvIHRoZWlyIHBhcmVudC5cbiAqIFNwbGl0cyBvbiBkb3VibGUgY2xpY2ssIGFuZCBqb2lucyBvbiByaWdodCBjbGljay5cbiAqIElmIG11bHRpcGxlIG5vZGVzIGFyZSBzZWxlY3RlZCBhdCB0aGUgdGltZSBvZiBhIHNwbGl0IG9yIGpvaW4gZXZlbnQsXG4gKiBpdCB3aWxsIHNwbGl0IG9yIGpvaW4gYWxsIG9mIHRoZW0uXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdTcGxpdEpvaW5Ob2RlUG9saWN5JywgWydOb2RlU2VsZWN0aW9uUG9saWN5JywgJ1Zpc3VhbGl6ZXJOb2RlJywgXG4gICAgXHRcdGZ1bmN0aW9uIChOb2RlU2VsZWN0aW9uUG9saWN5LCBWaXN1YWxpemVyTm9kZSkge1xuXHRcdGNsYXNzIFNwbGl0Sm9pbk5vZGVQb2xpY3kgZXh0ZW5kcyBOb2RlU2VsZWN0aW9uUG9saWN5LlBvbGljeSB7XG5cdFx0XHQvKipcblx0XHRcdCAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cblx0XHRcdCAqL1xuICAgICAgICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgICAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBvbGljeU5hbWUgPSBcIlNwbGl0Sm9pbk5vZGVQb2xpY3lcIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5pdGlhbGl6ZShncmFwaCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3VwZXIuaW5pdGlhbGl6ZShncmFwaCk7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuU3BsaXRKb2luTm9kZVBvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLnNwbGl0Tm9kZXMgPSBbXTsgXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVHJpZ2dlcmluZyBzcGxpdCBvbiBkb3VibGUgY2xpY2tcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgZCAgICAgIFRoZSBtYXRjaGluZyBkYXRhIG9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkYmxjbGljayhkM25vZGUsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3VwZXJTdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5Ob2RlUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgaWYgKCFkMy5ldmVudC5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdXBlclN0YXRlLnNlbGVjdGVkTm9kZXMuaW5kZXhPZihkKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNwbGl0TXVsdGlwbGVOb2RlcyhzdXBlclN0YXRlLnNlbGVjdGVkTm9kZXMpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVBbGxTZWxlY3RlZE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNwbGl0Tm9kZShkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUcmlnZ2VyaW5nIGpvaW4gb24gcmlnaHQgY2xpY2tcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmp9ICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgZCAgICAgIFRoZSBtYXRjaGluZyBkYXRhIG9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb250ZXh0bWVudShkM25vZGUsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3VwZXJTdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuICAgICAgICAgICAgICAgIGQzLmV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgaWYgKCFkMy5ldmVudC5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgdHJ5IHRvIGpvaW4gYSBoaWdobGlnaHRlZCBub2RlIHdoaWxlIG11bHRpcGxlIG5vZGVzIGFyZSBzZWxlY3RlZCxcbiAgICAgICAgICAgICAgICAgICAgLy93ZSBqb2luIGFsbCBoaWdobGlnaHRlZCBub2Rlc1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWROb2RlcyA9IHN1cGVyU3RhdGUuc2VsZWN0ZWROb2RlcztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkTm9kZXMuaW5kZXhPZihkKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGVjdGVkTm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmpvaW5Ob2RlKHNlbGVjdGVkTm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9pZiB3ZSB0cnkgdG8gam9pbiBhIG5vZGUgdGhhdCBpc24ndCBwYXJ0IG9mIGEgaGlnaGxpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAgICAgLy93ZSByZW1vdmUgYWxsIGhpZ2hsaWdodHMgYW5kIHRoZW4gam9pbiB0aGUgY2xpY2tlZCBub2RlXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUFsbFNlbGVjdGVkTm9kZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuam9pbk5vZGUoZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU3BsaXRzIGEgbm9kZS5cbiAgICAgICAgICAgICAqIHVzZWQgdG8gc2hhcmUgY29kZSBiZXR3ZWVuIHNwbGl0Tm9kZSBhbmQgc3BsaXRNdWx0aXBsZU5vZGVzXG4gICAgICAgICAgICAgKiB3aGlsZSBwcmV2ZW50aW5nIHRoZSBoYW5kbGVycyBmb3IgdGhlbSBib3RoIGZpcmluZ1xuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGUgYmVpbmcgc3BsaXRcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIFRoZSBuZXcgbm9kZXMgY3JlYXRlZCBieSB0aGUgc3BsaXRcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgX19zcGxpdE5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5Ob2RlUG9saWN5O1xuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gbm9kZS5pZDtcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIC8vaWYgaXQgaGFzIG5vIGNoaWxkcmVuIHRvIHNwbGl0IGludG9cbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRyZW5fc3RydWN0W25hbWVdID09PSB1bmRlZmluZWQgfHwgXy5pc0VtcHR5KGNoaWxkcmVuX3N0cnVjdFtuYW1lXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vcmVtb3ZpbmcgdGhlIG5vZGUgZnJvbSB0aGUgbGlzdCBvZiBub2Rlc1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlcyA9IF8uZmlsdGVyKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24oZ3JhcGhOb2Rlcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ3JhcGhOb2RlcyAhPSBub2RlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXNHcmFwaC5ub2Rlcyk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlKTtcblxuICAgICAgICAgICAgICAgIC8vZ2V0dGluZyBhbGwgdGhlIG5vZGUgaWQncyBmb3IgZmluZGluZyBmbG93XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVfbmFtZXNfc2V0ID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZV9uYW1lc19zZXQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0uaWQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vc2V0IG9mIG5vZGVzIGFmdGVyIHRoZSBzcGxpdFxuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoaWxkcmVuX3N0cnVjdFtuYW1lXS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBub2RlX25hbWVzX3NldC5wdXNoKGNoaWxkcmVuX3N0cnVjdFtuYW1lXVtpXSk7XG4gICAgICAgICAgICAgICAgICAgIG5ld19ub2Rlcy5wdXNoKGNoaWxkcmVuX3N0cnVjdFtuYW1lXVtpXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciByZXREYXRhID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuZ2V0Rmxvd0JldHdlZW5TZXQobm9kZV9uYW1lc19zZXQpO1xuXG4gICAgICAgICAgICAgICAgLy9mb3JtYXR0aW5nIGRhdGEgZm9yIG5ldyBub2Rlc1xuICAgICAgICAgICAgICAgIHZhciB4TG9jID0gbm9kZS54O1xuICAgICAgICAgICAgICAgIHZhciB5TG9jID0gbm9kZS55O1xuICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnMgPSBub2RlLmFuY2VzdG9ycy5zbGljZSgpO1xuICAgICAgICAgICAgICAgIC8va2VlcGluZyBvcmRlcmluZyB0aGF0IGZpcnN0IGluIGFuY2VzdG9yIGxpc3QgaXMgY2xvc2VzdCBpbiByZWxhdGlvbnNoaXBcbiAgICAgICAgICAgICAgICBhbmNlc3RvcnMuc3BsaWNlKDAsIDAsIG5vZGUuaWQpO1xuICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBub2RlLmlkO1xuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZV9vYmpzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIHJhZGl1cyA9IG5vZGUucmFkaXVzICogdGhpc0dyYXBoLmNvbnN0cy5yYWRpdXNEZWNheTtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZURhdGEgPSByZXREYXRhLm5vZGVEYXRhO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZURhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgLy9jYWxjdWxhdGluZyB3aGljaCBvZiB0aGUgbm9kZXMgaW4gcmV0RGF0YVswXSBhcmUgbmV3XG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXdfbm9kZXMuaW5kZXhPZihub2RlRGF0YVtpXS5pZCkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkID0gbm9kZURhdGFbaV0uaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IG5vZGVEYXRhW2ldLnRleHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGUgPSBuZXcgVmlzdWFsaXplck5vZGUuTm9kZShudWxsLCBudWxsLCBpZCwgdGV4dCwgcmFkaXVzLCBwYXJlbnQsIGFuY2VzdG9ycywgeExvYywgeUxvYyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdfbm9kZS5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMucHVzaChuZXdfbm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdfbm9kZV9vYmpzLnB1c2gobmV3X25vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YShyZXREYXRhLmxpbmtEYXRhLCB0aGlzR3JhcGgubm9kZXMpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0Tm9kZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdExpbmtzKCk7XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS5zcGxpdE5vZGVzLnB1c2gobm9kZS5pZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ld19ub2RlX29ianM7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU3BsaXRzIHRoZSBnaXZlIG5vZGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGUgYmVpbmcgc3BsaXRcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc3BsaXROb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzID0gdGhpcy5fX3NwbGl0Tm9kZShub2RlKTtcbiAgICAgICAgICAgICAgICBpZiAocmVzID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnNwbGl0Tm9kZUV2ZW50KHJlcyk7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTcGxpdHMgYWxsIHRoZSBub2RlcyBwYXNzZWQgaW5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlcyAgIEFycmF5IG9mIG5vZGVzIHRvIGJlIHNwbGl0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNwbGl0TXVsdGlwbGVOb2Rlcyhub2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoO1xuICAgICAgICAgICAgICAgIHZhciByZXNOb2RlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IHRoaXMuX19zcGxpdE5vZGUobm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICByZXNOb2RlcyA9IHJlc05vZGVzLmNvbmNhdChyZXMpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuc3BsaXRNdWx0aXBsZU5vZGVzRXZlbnQocmVzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgYWZ0ZXIgYSBzaW5nbGUgbm9kZSBpcyBzcGxpdFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5ld05vZGVzICBUaGUgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNwbGl0Tm9kZUV2ZW50KG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNldFBvc2l0aW9ucygpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBtdWx0aXBsZSBub2RlcyBhcmUgc3BsaXQgYXQgb25jZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5ld05vZGVzICBUaGUgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNwbGl0TXVsdGlwbGVOb2Rlc0V2ZW50KG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNldFBvc2l0aW9ucygpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIHVzZWQgdG8gc2hhcmUgY29kZSBiZXR3ZWVuIGpvaW5Ob2RlIGFuZCBqb2luTXVsdGlwbGVOb2RlXG4gICAgICAgICAgICAgKiB3aGlsZSBwcmV2ZW50aW5nIGJvdGggaGFuZGxlcnMgZmlyaW5nXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgICAgICBub2RlICAgIFRoZSBub2RlIHRvIGpvaW5cbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtOb2RlfSAgVGhlIG5ldyBub2RlIGFmdGVyIHRoZSBqb2luXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIF9fam9pbk5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5Ob2RlUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgLy9jaGVjayB0aGF0IG5vZGUgc3RpbGwgZXhpc3RzXG4gICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG5vZGUpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gbm9kZS5pZDtcbiAgICAgICAgICAgICAgICAvL2lmIGl0IGhhcyBubyBhbmNlc3Rvciwgbm90aGluZyB0byBqb2luXG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbC5pbmRleE9mKG5hbWUpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciB0b19iZV9kZWxldGVkID0gW107XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVfbmFtZXNfc2V0ID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgLy9pZiBub2RlIHdvbid0IGJlIGNvbGxhcHNlZFxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLm5vZGVzW2ldLmFuY2VzdG9ycy5pbmRleE9mKG5vZGUucGFyZW50KSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZV9uYW1lc19zZXQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0uaWQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9fYmVfZGVsZXRlZC5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlX2lkID0gbm9kZS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgbm9kZV9uYW1lc19zZXQucHVzaChub2RlLnBhcmVudCk7XG5cbiAgICAgICAgICAgICAgICAvL2Zvcm1hdHRpbmcgZGF0YVxuICAgICAgICAgICAgICAgIHZhciByYWRpdXMgPSBub2RlLnJhZGl1cyAvIHRoaXNHcmFwaC5jb25zdHMucmFkaXVzRGVjYXk7IFxuICAgICAgICAgICAgICAgIHZhciB4TG9jID0gbm9kZS54O1xuICAgICAgICAgICAgICAgIHZhciB5TG9jID0gbm9kZS55O1xuICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBub2RlLmFuY2VzdG9yc1sxXTtcbiAgICAgICAgICAgICAgICB2YXIgYW5jZXN0b3JzID0gbm9kZS5hbmNlc3RvcnMuc2xpY2UoMSk7XG4gICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlID0gbmV3IFZpc3VhbGl6ZXJOb2RlLk5vZGUoeExvYywgeUxvYywgbmV3X25vZGVfaWQsIG5ld19ub2RlX2lkLCByYWRpdXMsIHBhcmVudCwgYW5jZXN0b3JzKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMucHVzaChuZXdfbm9kZSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgcmV0RGF0YSA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmdldEZsb3dCZXR3ZWVuU2V0KG5vZGVfbmFtZXNfc2V0KTtcbiAgICAgICAgICAgICAgICAvL3JlbW92ZSBhbGwgbm9kZXMgdGhhdCB3aWxsIGJlIGpvaW5lZFxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdG9fYmVfZGVsZXRlZC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZV90b19kZWxldGUgPSB0b19iZV9kZWxldGVkW2ldO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMuc3BsaWNlKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG5vZGVfdG9fZGVsZXRlKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zcGxpY2VMaW5rc0Zvck5vZGUobm9kZV90b19kZWxldGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5wcm9jZXNzTGlua0RhdGEocmV0RGF0YS5saW5rRGF0YSwgdGhpc0dyYXBoLm5vZGVzKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXRMaW5rcygpO1xuXG4gICAgICAgICAgICAgICAgc3RhdGUuc3BsaXROb2Rlcy5zcGxpY2Uoc3RhdGUuc3BsaXROb2Rlcy5pbmRleE9mKG5ld19ub2RlLmlkKSwgMSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3X25vZGU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogSm9pbnMgdGhlIGdpdmVuIG5vZGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGUgdG8gam9pblxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBqb2luTm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5ld05vZGUgPSB0aGlzLl9fam9pbk5vZGUobm9kZSk7XG4gICAgICAgICAgICAgICAgaWYgKG5ld05vZGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIFx0dGhpcy5qb2luTm9kZUV2ZW50KG5ld05vZGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBKb2lucyBhbGwgdGhlIGdpdmVuIG5vZGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZXMgICBUaGUgbm9kZXMgdG8gam9pblxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBqb2luTXVsdGlwbGVOb2RlKG5vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IHRoaXMuX19qb2luTm9kZShub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIG5ld19ub2Rlcy5wdXNoKHJlcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuam9pbk11bHRpcGxlTm9kZXNFdmVudChuZXdfbm9kZXMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBhIHNpbmdsZSBub2RlIGlzIGpvaW5lZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbmV3Tm9kZSAgVGhlIG5ldyBub2RlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGpvaW5Ob2RlRXZlbnQobmV3Tm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBtdWx0aXBsZSBub2RlcyBhcmUgam9pbmVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbmV3Tm9kZXMgIFRoZSBuZXcgbm9kZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgam9pbk11bHRpcGxlTm9kZXNFdmVudChuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIFBvbGljeTogU3BsaXRKb2luTm9kZVBvbGljeVxuICAgICAgICB9XG59XSk7XG5cblxuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtwb2xpY2llcycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9uZXR3b3JrcG9saWNpZXMnLFxuICAgICAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5pc29sYXRpb24nLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2lzb2xhdGlvbicsXG4gICAgICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6ICc8dWktdmlldy8+J1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmJhbmR3aWR0aCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvYmFuZHdpZHRoJyxcbiAgICAgICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogJzx1aS12aWV3Lz4nXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMucmVkaXJlY3Rpb24nLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL3JlZGlyZWN0aW9uJyxcbiAgICAgICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogJzx1aS12aWV3Lz4nXG4gICAgICAgICAgICB9KVxuICAgICAgICA7XG4gICAgfV0pO1xuIiwiLyoqXG4gKiBUaGlzIHBvbGljeSBpcyB1c2VkIHRvIGNoYW5nZSB0aGUgdmlldyB0byBmb2N1cyBvbiBzcGxpdHRpbmcgYW5kIFxuICogam9pbmluZyBldmVudHMuXG4gKiBPdmVycmlkZXMgdGhlIGNlcnRhaW4gZm9yY2UgbGF5b3V0IGZ1bmN0aW9ucyBvZiB0aGUgZ3JhcGggdG8gcGFydGl0aW9uIGEgc3BsaXRcbiAqIGludG8gdGhlIGZvY3VzZWQgbm9kZXMgYW5kIHRoZSBjb25uZWN0ZWQgbm9kZXMuXG4gKiBcbiAqIEhhcyBzYXZlL2xvYWQgbWV0aG9kcyBmb3IgdGhlIHNhdmUgc3RhdGUgcG9saWN5LlxuICogSGFzIGJhY2sgYnV0dG9uIHN1cHBvcnQuXG4gKiBDYW4gYXV0byBjaGFuZ2UgdGhlIHRpdGxlIG9mIHRoZSBncmFwaC5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ1NwbGl0Sm9pblZpZXdQb2xpY3knLCBbJ1NwbGl0Sm9pbk5vZGVQb2xpY3knLCAnVmlzdWFsaXplck5vZGUnLCBmdW5jdGlvbiAoU3BsaXRKb2luTm9kZVBvbGljeSwgVmlzdWFsaXplck5vZGUpIHsgXG4gICAgICAgIGNsYXNzIFNwbGl0Sm9pblZpZXdQb2xpY3kgZXh0ZW5kcyBTcGxpdEpvaW5Ob2RlUG9saWN5LlBvbGljeXtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgICAgICBzdXBlcigpO1xuICAgICAgICAgICAgICAgIHRoaXMucG9saWN5TmFtZSA9IFwiU3BsaXRKb2luVmlld1BvbGljeVwiO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbml0aWFsaXplKGdyYXBoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdXBlci5pbml0aWFsaXplKGdyYXBoKTtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBncmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgc3RhdGUuc2F2ZWRTdGF0ZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAvLyBzdGF0ZS5mb2N1c0dyb3VwID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkgPSBbXTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3VwcyA9IFtdO1xuICAgICAgICAgICAgICAgIHN0YXRlLmZvY2kgPSBbXTtcbiAgICAgICAgICAgICAgICBzdGF0ZS56b29tcyA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLmxheW91dCA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLmxheW91dERlZmF1bHQgPSBudWxsO1xuICAgICAgICAgICAgICAgIHN0YXRlLnpvb21EZWZhdWx0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS5ub2RlSWRzVG9SZXNob3cgPSBudWxsO1xuICAgICAgICAgICAgICAgIHN0YXRlLmJhY2tCdXR0b25FbGVtID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS50aXRsZUVsZW0gPSBudWxsO1xuXG4gICAgICAgICAgICAgICAgdmFyIGNvbnN0cyA9IGdyYXBoLmNvbnN0cy5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgY29uc3RzLmJvdW5kYXJ5ID0gMC44O1xuXG4gICAgICAgICAgICAgICAgLy9vdmVycmlkaW5nIGQzZm9yY2UgbWV0aG9kcyBvZiB0aGUgZ3JhcGguXG4gICAgICAgICAgICAgICAgZ3JhcGguZDNGb3JjZUJvdW5kcyA9IHRoaXMuZDNGb3JjZUJvdW5kcztcbiAgICAgICAgICAgICAgICBncmFwaC5kM0ZvcmNlVGljayA9IHRoaXMuZDNGb3JjZVRpY2s7XG4gICAgICAgICAgICAgICAgZ3JhcGguZDNGb3JjZVN0YXJ0ID0gdGhpcy5kM0ZvcmNlU3RhcnQ7XG4gICAgICAgICAgICAgICAgZ3JhcGguZDNGb3JjZUVuZCA9IHRoaXMuZDNGb3JjZUVuZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBMaW5rcyB0aGUgcHJvdmlkZWQgZWxlbWVudCBhIGJhY2sgYnV0dG9uIGZlYXR1cmVcbiAgICAgICAgICAgICAqIERvZXNuJ3QgdHJpZ2dlciB0aGUgb24tY2xpY2sgZXZlbnRcbiAgICAgICAgICAgICAqIFRoYXQgc2hvdWxkIGJlIGRvbmUgdGhyb3VnaCBhbmd1bGFyIG5nLWNsaWNrLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtqUXVlcnl9ICBlbGVtICAgIFRoZSBqcXVlcnkgc2VsZWN0ZWQgZWxlbWVudFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbnN0YWxsQmFja0J1dHRvbihlbGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kgPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgc3RhdGUuYmFja0J1dHRvbkVsZW0gPSBlbGVtO1xuICAgICAgICAgICAgICAgIHN0YXRlLmJhY2tCdXR0b24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnVuZG9MYXN0RXZlbnQuY2FsbCh0aGlzUG9saWN5KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBXaWxsIGFsbG93IHRoaXMgcG9saWN5IHRvIGNoYW5nZSB0aGUgdGl0bGUgb2YgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKiBhcyBzcGxpdCBhbmQgam9pbiBldmVudHMgb2NjdXIuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2pRdWVyeX0gIGVsZW0gICAgVGhlIGpxdWVyeSBzZWxlY3RlZCBlbGVtZW50XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluc3RhbGxUaXRsZShlbGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS50aXRsZUVsZW0gPSBlbGVtO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyBiZWluZyBkZXN0cm95ZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgc2F2ZWRTdGF0ZSAgQW55IHByb3BlcnR5IG9uIHRoaXNcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3Qgd2lsbCBiZSBhY2Nlc3NpYmxlXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiB0aGUgdmlldyByZWxvYWRzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGRlc3Ryb3koc2F2ZWRTdGF0ZSkge1xuICAgICAgICAgICAgICAgIC8vT25seSBpZiB0aGUgc2F2ZSBzdGF0ZSBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAgICAgICAgaWYgKHNhdmVkU3RhdGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNhdmUoc2F2ZWRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgc2F2ZSB0aGUgY3VycmVudCBzdGF0ZSwgYW5kIGFsbCBoaXN0b3J5LlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBzYXZlZFN0YXRlICBBbnkgcHJvcGVydHkgb24gdGhpc1xuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdCB3aWxsIGJlIGFjY2Vzc2libGVcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGVuIHRoZSB2aWV3IHJlbG9hZHNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc2F2ZShzYXZlZFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICAgICAgdmFyIGxpbmtzID0gdGhpc0dyYXBoLmxpbmtzO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyVGl0bGUgPSBudWxsO1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS50aXRsZUVsZW0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBjdXJyVGl0bGUgPSBzdGF0ZS50aXRsZUVsZW0udGV4dCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZm9jdXNHcm91cHMgPSBzdGF0ZS5mb2N1c0dyb3VwcztcbiAgICAgICAgICAgICAgICB2YXIgZXZlbnRIaXN0b3J5ID0gc3RhdGUuZXZlbnRIaXN0b3J5O1xuICAgICAgICAgICAgICAgIHZhciB6b29tcyA9IHN0YXRlLnpvb21zO1xuICAgICAgICAgICAgICAgIHZhciBsYXlvdXQgPSBzdGF0ZS5sYXlvdXQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgbGF5b3V0RGVmYXVsdCA9IHN0YXRlLmxheW91dERlZmF1bHQ7XG4gICAgICAgICAgICAgICAgdmFyIHpvb21EZWZhdWx0ID0gc3RhdGUuem9vbURlZmF1bHQ7XG4gICAgICAgICAgICAgICAgdmFyIHJldCA9IHtub2Rlczpub2RlcywgbGlua3M6bGlua3MsIFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZXM6c3RhdGUuc2F2ZWRTdGF0ZXMsIGN1cnJUaXRsZTpjdXJyVGl0bGUsIFxuICAgICAgICAgICAgICAgICAgICBmb2N1c0dyb3VwczogZm9jdXNHcm91cHMsXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50SGlzdG9yeTpldmVudEhpc3RvcnksIHpvb21zOnpvb21zLFxuICAgICAgICAgICAgICAgICAgICBsYXlvdXQ6bGF5b3V0LCBsYXlvdXREZWZhdWx0OmxheW91dERlZmF1bHQsXG4gICAgICAgICAgICAgICAgICAgIHpvb21EZWZhdWx0Onpvb21EZWZhdWx0fTtcbiAgICAgICAgICAgICAgICBzYXZlZFN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3kgPSByZXQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2lsbCBiZSBjYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgcmVsb2FkZWQsIGFzc3VtaW5nXG4gICAgICAgICAgICAgKiBzYXZlIHN0YXRlIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgbG9hZFN0YXRlICBDb250YWlucyBhbGwgdGhlIHNhdmVkXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJpYWJsZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgbG9hZChsb2FkU3RhdGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICBsb2FkU3RhdGUgPSBsb2FkU3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zYXZlZFN0YXRlcyA9IGxvYWRTdGF0ZS5zdGF0ZXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzID0gbG9hZFN0YXRlLmxpbmtzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlcyA9IGxvYWRTdGF0ZS5ub2RlcztcblxuICAgICAgICAgICAgICAgIHZhciBjdXJyVGl0bGUgPSBsb2FkU3RhdGUuY3VyclRpdGxlO1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS50aXRsZUVsZW0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS50aXRsZUVsZW0udGV4dChjdXJyVGl0bGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkgPSBsb2FkU3RhdGUuZXZlbnRIaXN0b3J5O1xuICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzID0gbG9hZFN0YXRlLmZvY3VzR3JvdXBzO1xuICAgICAgICAgICAgICAgIHN0YXRlLnpvb21zID0gbG9hZFN0YXRlLnpvb21zO1xuICAgICAgICAgICAgICAgIHN0YXRlLmxheW91dCA9IGxvYWRTdGF0ZS5sYXlvdXQ7XG4gICAgICAgICAgICAgICAgc3RhdGUubGF5b3V0RGVmYXVsdCA9IGxvYWRTdGF0ZS5sYXlvdXREZWZhdWx0O1xuICAgICAgICAgICAgICAgIHN0YXRlLnpvb21EZWZhdWx0ID0gbG9hZFN0YXRlLnpvb21EZWZhdWx0O1xuXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmJhY2tCdXR0b25FbGVtICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uRWxlbS5mYWRlVG8oJ3Nsb3cnLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG5cbiAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoXy5pbmNsdWRlcyhjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImZvY3VzXCI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiY29ubmVjdGVkXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vbG9hZGluZyBhIHByZXZpb3VzIGxheW91dFxuICAgICAgICAgICAgICAgIHZhciBsYXlvdXQ7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBsYXlvdXQgPSBzdGF0ZS5sYXlvdXREZWZhdWx0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbSA9IHN0YXRlLnpvb21EZWZhdWx0OyBcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh6b29tWzBdLCB6b29tWzFdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbSA9IHN0YXRlLnpvb21zW3N0YXRlLmZvY3VzR3JvdXBzXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHpvb20gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh6b29tWzBdLCB6b29tWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBsYXlvdXQgPSBzdGF0ZS5sYXlvdXRbc3RhdGUuZm9jdXNHcm91cHNdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vbGF5b3V0IGNhbid0IGJlIG51bGxcbiAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbihuKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwb3MgPSBsYXlvdXRbbi5pZF07XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb3MgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cobGF5b3V0LCBuKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBuLnggPSBwb3MueDtcbiAgICAgICAgICAgICAgICAgICAgbi55ID0gcG9zLnk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN0YXRlLmluaXRGb3JjZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoLmNhbGwodGhpc0dyYXBoLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51cGRhdGVHcmFwaENhbGxiYWNrLmNhbGwodGhpc1BvbGljeSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVHJpZ2dlcmluZyBzcGxpdCBvbiBkb3VibGUgY2xpY2tcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogRm9jdXMgZ3JvdXAgc3RvcmVzIHRoZSBub2RlIHRoYXQgaXMgYWJvdXQgdG8gYmUgc3BsaXQuXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIFdoZW4gZm9jdXMgZ3JvdXAgaGFzIGxlbmd0aCAwLCB0aGUgZmlyc3Qgc3BsaXQgXG4gICAgICAgICAgICAgKiB3aWxsIGp1c3QgYmUgcHVzaGVkIG9uLlxuICAgICAgICAgICAgICogVGhlIG5vZGUgd2lsbCBiZSBzcGxpdCBhbmQgcHVzaGVkIHRvIHRoZSB0b3AgaGFsZiBcbiAgICAgICAgICAgICAqIG9mIHRoZSBzY3JlZW4sIGFuZCB0aGUgYm90dG9tIGhhbGYgd2lsbCBjb250YWluIGFueVxuICAgICAgICAgICAgICogbm9kZXMgaXQgaGFzIGNvbm5lY3Rpb25zIHRvLlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBXaGVuIGEgZm9jdXMgZ3JvdXAgbGVuZ3RoIGlzID49IDEsIGlmIHRoZSBub2RlIHRvIGJlXG4gICAgICAgICAgICAgKiBzcGxpdCBpcyBhIGZvY3VzIG5vZGUsIGl0IHdpbGwgcmVwbGFjZSBmb2N1c0dyb3Vwc1swXSBhbmRcbiAgICAgICAgICAgICAqIHRoZSB0b3AgaGFsZiB3aWxsIGJlIGl0cyBjaGlsZHJlbiwgYW5kIGJvdHRvbSBoYWxmIHdpbGxcbiAgICAgICAgICAgICAqIGJlIHRoZSBub2RlcyBpdCBoYXMgY29ubmVjdGlvbnMgdG8uXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIElmIHRoZSBzcGxpdCBpcyBpbiB0aGUgYm90dG9tIGhhbGYsIHRoZW4gdGhlIGJvdHRvbSBoYWxmXG4gICAgICAgICAgICAgKiB3aWxsIGRpc3BsYXkgaXQncyBjaGlsZHJlbiBhbmQgd2lsbCBvbmx5IHNob3cgY29ubmVjdGlvbnMgYmV0d2VlblxuICAgICAgICAgICAgICogdGhlIHR3byBncm91cHMsIGFuZCB3aWxsIHJlcGxhY2UgZm9jdXNHcm91cHNbMV0uXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09ian0gICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgZCAgICAgICBUaGUgbWF0Y2hpbmcgZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZGJsY2xpY2soZDNub2RlLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICAvL2NoZWNrIGlmIGNhbiBzcGxpdFxuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gZC5pZDtcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIGlmIChjaGlsZHJlbl9zdHJ1Y3RbbmFtZV0gPT09IHVuZGVmaW5lZCB8fCBfLmlzRW1wdHkoY2hpbGRyZW5fc3RydWN0W25hbWVdKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMuc2xpY2UoKTtcblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDApIHsgLy90b3BsZXZlbCBzcGxpdFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwcy5wdXNoKGQuaWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXy5pbmNsdWRlcyhjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5pZCkpIHsgLy9zcGxpdHRpbmcgYSBmb2N1cyBub2RlXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzWzBdID0gZC5pZDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMSkgey8vc3BsaXR0aW5nIGFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29ubmVjdGVkIG5vZGVcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMucHVzaChkLmlkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKF8uaW5jbHVkZXMoY2hpbGRyZW5fc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzFdXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5pZCkpIHsvL3NwbGl0dGluZyBhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25uZWN0ZWQgbm9kZVxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwc1sxXSA9IGQuaWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAyICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHNbMV0gPT09IGQuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9TcGxpdHRpbmcgYSBjb25uZWN0ZWQgbm9kZSwga2VlcCBhbGwgZm9jdXMgbm9kZXNcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVzVG9LZWVwID0gW2RdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZUlkc1RvUmVzaG93ID0gW107XG4gICAgICAgICAgICAgICAgICAgIHZhciBncm91cE9uZU5vZGVzID0gY2hpbGRyZW5fc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzBdXTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF8uaW5jbHVkZXMoZ3JvdXBPbmVOb2Rlcywgbm9kZS5pZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzVG9SZXNob3cucHVzaChub2RlLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1RvS2VlcC5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL01ha2Ugc3BsaXQgbm9kZXMgdGhlIGZvY3VzIGFuZCBrZWVwIG5vZGVzIHRoYXQgYXJlIGNvbm5lY3RlZFxuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZXNUb0tlZXAgPSBbZF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlSWRzVG9SZXNob3cgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5saW5rcywgZnVuY3Rpb24obGluaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmsuc291cmNlID09PSBkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHNUb1Jlc2hvdy5pbmRleE9mKGxpbmsudGFyZ2V0LmlkKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsudGFyZ2V0LlNwbGl0Sm9pblZpZXdQb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rLnRhcmdldC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImNvbm5lY3RlZFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHNUb1Jlc2hvdy5wdXNoKGxpbmsudGFyZ2V0LmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1RvS2VlcC5wdXNoKGxpbmsudGFyZ2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobGluay50YXJnZXQgPT09IGQgJiYgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHNUb1Jlc2hvdy5pbmRleE9mKGxpbmsuc291cmNlLmlkKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsuc291cmNlLlNwbGl0Sm9pblZpZXdQb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rLnNvdXJjZS5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImNvbm5lY3RlZFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHNUb1Jlc2hvdy5wdXNoKGxpbmsuc291cmNlLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1RvS2VlcC5wdXNoKGxpbmsuc291cmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9SZW1vdmluZyBsaW5rcyBmcm9tIHRoZSBub2RlIHRvIGJlIHNwbGl0XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZWFjaChmdW5jdGlvbihub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLmlkICE9PSBkLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3BsaWNlTGlua3NGb3JOb2RlKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG5cbiAgICAgICAgICAgICAgICAvL2Rpc2FibGluZyB1cGRhdGUgZ3JhcGggdG8gcHJldmVudCBuZXcgZGF0YSBmcm9tXG4gICAgICAgICAgICAgICAgLy9yZWRyYXdpbmcgbGlua3Mgd2hpbGUgdGhlcmUgYXJlIGFuaW1hdGlvbnMgZ29pbmcgb25cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3RhdGUuZGlzYWJsZVVwZGF0ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZWFjaChmdW5jdGlvbihub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLmlkICE9PSBkLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykudHJhbnNpdGlvbigpLmRlbGF5KDIwMCkuZHVyYXRpb24oNDAwKS5zdHlsZShcIm9wYWNpdHlcIiwgMCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2Rpc2FibGluZyBxdGlwIGlmIGluc3RhbGxlZFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQodGhpcykucXRpcCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5xdGlwKCdkaXNhYmxlJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHZhciB0cmFuc2xhdGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKTtcbiAgICAgICAgICAgICAgICB2YXIgc2NhbGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpO1xuICAgICAgICAgICAgICAgIHZhciB4TG9jID0gKHBhcnNlRmxvYXQodGhpc0dyYXBoLnN2Zy5zdHlsZShcIndpZHRoXCIpKSAvIHNjYWxlKSAvIDIgICsgdHJhbnNsYXRlWzBdO1xuICAgICAgICAgICAgICAgIHZhciB5TG9jID0gKHBhcnNlRmxvYXQodGhpc0dyYXBoLnN2Zy5zdHlsZShcImhlaWdodFwiKSkgLyBzY2FsZSkvIDIgICsgdHJhbnNsYXRlWzFdO1xuICAgICAgICAgICAgICAgIGQueFN0YXJ0ID0gZC54O1xuICAgICAgICAgICAgICAgIGQueVN0YXJ0ID0gZC55O1xuICAgICAgICAgICAgICAgIGQueCA9IHhMb2M7XG4gICAgICAgICAgICAgICAgZC55ID0geUxvYztcbiAgICAgICAgICAgICAgICBkM25vZGUudHJhbnNpdGlvbihcIm5vZGVQb3NpdGlvblRyYW5zaXRpb25cIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kdXJhdGlvbig3NTApXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0clR3ZWVuKFwidHJhbnNmb3JtXCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgeFN0YXJ0ID0gZC54U3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHlTdGFydCA9IGQueVN0YXJ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueFN0YXJ0ID0gZC54O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueVN0YXJ0ID0gZC55O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkMy5pbnRlcnBvbGF0ZVN0cmluZyhcInRyYW5zbGF0ZShcIiArIHhTdGFydCArIFwiLFwiICsgeVN0YXJ0ICsgXCIpXCIsIFwidHJhbnNsYXRlKFwiICsgZC54ICsgXCIsXCIgKyBkLnkgKyBcIilcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHZhciBzcGxpdE5vZGVGdW5jID0gc3VwZXIuc3BsaXROb2RlO1xuICAgICAgICAgICAgICAgIHN0YXRlLm5vZGVJZHNUb1Jlc2hvdyA9IG5vZGVJZHNUb1Jlc2hvdztcbiAgICAgICAgICAgICAgICAvL3dhaXRpbmcgZm9yIG5vZGUgdHJhbnNpdGlvblxuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMgPSBub2Rlc1RvS2VlcDtcbiAgICAgICAgICAgICAgICAgICAgc3BsaXROb2RlRnVuYy5jYWxsKHRoaXNQb2xpY3ksIGQpO1xuICAgICAgICAgICAgICAgIH0sIDc1MCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVG8gYmUgY2FsbGVkIGFmdGVyIHRoZSBncmFwaCBpcyBzcGxpdC5cbiAgICAgICAgICAgICAqIEJyaW5ncyBhbGwgbm9kZXMgYmFjayBpbnRvIHZpZXcgYW5kIHNldHMgdGhlaXIgYXR0cmlidXRlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1cGRhdGVHcmFwaENhbGxiYWNrKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2goZnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLnRyYW5zaXRpb24oKS5kdXJhdGlvbig0MDApLnN0eWxlKFwib3BhY2l0eVwiLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5jbGFzc2VkKFwiZm9jdXNcIiwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLmNsYXNzZWQoXCJjb25uZWN0ZWRcIiwgZmFsc2UpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5TcGxpdEpvaW5WaWV3UG9saWN5ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPT09IFwiZm9jdXNcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykuY2xhc3NlZChcImZvY3VzXCIsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobm9kZS5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPT09IFwiY29ubmVjdGVkXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLmNsYXNzZWQoXCJjb25uZWN0ZWRcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ub2RlSWRzVG9SZXNob3cgPSBudWxsO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJhbmRvbWx5IHNldHMgdGhlIHBvc2l0aW9ucyBvZiBhbnkgdW5zZXQgbm9kZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzZXRQb3NpdGlvbnMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kgPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBncmFwaENvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHM7XG5cbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gZ3JhcGhDb25zdHMuZGlzcGxheU9mZnNldDtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICAgICAgdmFyIHJldCA9IHRoaXNQb2xpY3kuZDNGb3JjZUJvdW5kcy5jYWxsKHRoaXNHcmFwaCk7XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZXRSYW5kb21JbnQobWluLCBtYXgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4gKyAxKSkgKyBtaW47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKG5vZGVzLCBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLnggPT0gbnVsbCB8fCBub2RlLnkgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHggPSBnZXRSYW5kb21JbnQobm9kZS5yYWRpdXMgKyBvZmZzZXQsIHJldC53aWR0aCAtIG5vZGUucmFkaXVzIC0gb2Zmc2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB5ID0gZ2V0UmFuZG9tSW50KG5vZGUucmFkaXVzICsgb2Zmc2V0LCByZXQuaGVpZ2h0IC0gbm9kZS5yYWRpdXMgLSBvZmZzZXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS54ID0geDtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUueSA9IHk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBvbiB0aGUgc3RhcnQgb2YgdGhlIGQzIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqIFdpbGwgb3ZlcnJpZGUgdGhlIG1ldGhvZCBvZiB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqIFwidGhpc1wiIHBvaW50cyB0byB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZVN0YXJ0KCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjeCcsIGZ1bmN0aW9uKGQpIHsgXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC54U3RhcnQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueFN0YXJ0ID0gKGQueFN0YXJ0ICogdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKSkgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkLng7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjeScsIGZ1bmN0aW9uKGQpIHsgXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC55U3RhcnQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueVN0YXJ0ID0gKGQueVN0YXJ0ICp0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpKSArIHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHNcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueTsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueTsgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIG9uIHRoZSBzdGFydCBvZiB0aGUgZDMgZm9yY2Ugc2ltdWxhdGlvblxuICAgICAgICAgICAgICogV2lsbCBvdmVycmlkZSB0aGUgbWV0aG9kIG9mIHRoZSBncmFwaFxuICAgICAgICAgICAgICogXCJ0aGlzXCIgcG9pbnRzIHRvIHRoZSBncmFwaFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkM0ZvcmNlRW5kKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kgPSBzdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZVBvbGljeS5sYXlvdXREZWZhdWx0ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZmF1bHRMYXlvdXQgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24obikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdExheW91dFtuLmlkXSA9IHt4Om4ueCwgeTpuLnl9O1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kubGF5b3V0RGVmYXVsdCA9IGRlZmF1bHRMYXlvdXQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzY2FsZSA9IHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0cmFuc2xhdGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kuem9vbURlZmF1bHQgPSBbdHJhbnNsYXRlLCBzY2FsZV07IFxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjeCcsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2N5JywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC55OyB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocy5hdHRyKCd4MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLnk7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd4MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lnk7IH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgYmUgY2FsbGVkIGR1cmluZyBEMyBmb3JjZSBzaW11bGF0aW9uc1xuICAgICAgICAgICAgICogYnkgdGhlIGdyYXBoLCBzbyBcInRoaXNcIiB3aWxsIHBvaW50IHRvIHRoZSBncmFwaCBvYmplY3RcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgd2lkdGggICBEMyBMYXlvdXQgV2lkdGhcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICBoZWlnaHQgIEQzIExheW91dCBIZWlnaHRcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZVRpY2soZSwgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kgPSBzdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IGNvbnN0cy5kaXNwbGF5T2Zmc2V0O1xuICAgICAgICAgICAgICAgIHZhciBzY2FsZSA9IHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCk7XG5cbiAgICAgICAgICAgICAgICAvLyBNb3ZlIG5vZGVzIHRvd2FyZCBjbHVzdGVyIGZvY3VzLlxuICAgICAgICAgICAgICAgIHZhciBmb2NpID0gc3RhdGVQb2xpY3kuZm9jaTtcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBncmF2aXR5KGFscGhhKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm9jaS5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPT09IFwiZm9jdXNcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gKGZvY2lbMF0gLSBkLnkpICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55ICs9IChmb2NpWzFdIC0gZC55KSAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnggKz0gKHdpZHRoLzIgLSBkLngpICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSArPSAoaGVpZ2h0LzIgLSBkLnkpICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC54ICs9ICh3aWR0aC8yIC0gZC54KSAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIE1ha2Ugc3VyZSBub2RlcyBhcmUgd2l0aGluIGJvdW5kc1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzXG4gICAgICAgICAgICAgICAgICAgIC5lYWNoKHRoaXMuZDNGb3JjZUNvbGxpZGUoLjUpKVxuICAgICAgICAgICAgICAgICAgICAuZWFjaChncmF2aXR5KC4yICogZS5hbHBoYSkpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiY3hcIiwgZnVuY3Rpb24oZCkgeyBcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnggPSBNYXRoLm1heCgoZC5yYWRpdXMgKyBvZmZzZXQpL3NjYWxlLCBNYXRoLm1pbih3aWR0aCArICgoLW9mZnNldC0gZC5yYWRpdXMpIC8gc2NhbGUpLCBkLngpKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJjeVwiLCBmdW5jdGlvbihkKSB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuU3BsaXRKb2luVmlld1BvbGljeSA9PSBudWxsIHx8IGQuU3BsaXRKb2luVmlld1BvbGljeSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55ID0gTWF0aC5tYXgoKGQucmFkaXVzICsgb2Zmc2V0KS9zY2FsZSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLm1pbihoZWlnaHQgKyAoKC1vZmZzZXQgLSBkLnJhZGl1cykvc2NhbGUpLCBkLnkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9PT0gXCJmb2N1c1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55ID0gTWF0aC5tYXgoZC5yYWRpdXMgKyBvZmZzZXQsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5taW4oKGhlaWdodCArICgoLW9mZnNldCAtIGQucmFkaXVzKS9zY2FsZSkpKmNvbnN0cy5TcGxpdEpvaW5WaWV3UG9saWN5LmJvdW5kYXJ5LCBkLnkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9PT0gXCJjb25uZWN0ZWRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSA9IE1hdGgubWF4KChoZWlnaHQgKyAoKG9mZnNldCAtIGQucmFkaXVzKS9zY2FsZSkpICpjb25zdHMuU3BsaXRKb2luVmlld1BvbGljeS5ib3VuZGFyeSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLm1pbihoZWlnaHQgKyAoKC1vZmZzZXQgLSBkLnJhZGl1cykvc2NhbGUpLCBkLnkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoc1xuICAgICAgICAgICAgICAgICAgICAuYXR0cigneDEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS55OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneDInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC55OyB9KTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGN1bGF0ZXMgdGhlIGJvdW5kYXJpZXMgb2YgdGhlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogV2lsbCBiZSBjYWxsZWQgZHVyaW5nIEQzIGZvcmNlIHNpbXVsYXRpb25zXG4gICAgICAgICAgICAgKiBieSB0aGUgZ3JhcGgsIHNvIFwidGhpc1wiIHdpbGwgcG9pbnQgdG8gdGhlIGdyYXBoIG9iamVjdFxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7T2JqZWN0fSAgICAgICAgICBSZXR1cm5zIGFuIG9iamVjdFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdCBoYXMgdGhlIHdpZHRoXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmQgaGVpZ2h0IGFzIFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllcyBcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZUJvdW5kcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0c1BvbGljeSA9IGNvbnN0cy5TcGxpdEpvaW5WaWV3UG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZVBvbGljeSA9IHN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNhbGNNYXhOb2Rlcyh3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhcmVhID0gd2lkdGggKiBoZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciByYWRpdXMgPSB0aGlzR3JhcGguY29uc3RzLnN0YXJ0UmFkaXVzO1xuICAgICAgICAgICAgICAgICAgICAvL3RyZWF0aW5nIHRoZW0gYXMgYSBzcXVhcmUgZm9yIGFwcHJveFxuICAgICAgICAgICAgICAgICAgICB2YXIgbGVuZ3RoID0gKHJhZGl1cyAqMy41KTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFtb3VudCA9IGFyZWEgLyhsZW5ndGggKmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhbW91bnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vVGhlIG9mZnNldCBpcyB0aGUgYnVmZmVyIGZyb20gdGhlIGVkZ2VzXG4gICAgICAgICAgICAgICAgLy9PcmlnaW5hbCBXaWR0aCBhbmQgSGVpZ2h0IGFyZSBnaXZlbiB0byB0aGUgZm9yY2UgbGF5b3V0XG4gICAgICAgICAgICAgICAgLy9zbyB0aGF0IGl0IGlzIGNlbnRlcmVkLCBidXQgbm9kZXMgd2lsbCBiZSBmb3JjZWQgdG8gYmVcbiAgICAgICAgICAgICAgICAvL3dpdGhpbiB0aGUgb2Zmc2V0IGJvdW5kc1xuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSBjb25zdHMuZGlzcGxheU9mZnNldDtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnV2lkdGggPSBwYXJzZUZsb2F0KHRoaXNHcmFwaC5zdmcuc3R5bGUoXCJ3aWR0aFwiKSk7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z0hlaWdodCA9IHBhcnNlRmxvYXQodGhpc0dyYXBoLnN2Zy5zdHlsZShcImhlaWdodFwiKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBzdmdXaWR0aDtcbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gc3ZnSGVpZ2h0O1xuXG4gICAgICAgICAgICAgICAgdmFyIGFtb3VudCA9IGNhbGNNYXhOb2Rlcyh3aWR0aCAtICgyKm9mZnNldCksIGhlaWdodCAtICgyKm9mZnNldCkpO1xuICAgICAgICAgICAgICAgIHZhciBzY2FsZSA9IDE7XG4gICAgICAgICAgICAgICAgaWYgKG5vZGVzLmxlbmd0aCA+IGFtb3VudCkge1xuICAgICAgICAgICAgICAgICAgICBzY2FsZSA9IGFtb3VudCAvIG5vZGVzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKSwgc2NhbGUpO1xuICAgICAgICAgICAgICAgICAgICB3aWR0aCAvPSBzY2FsZTtcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0IC89IHNjYWxlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQodGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKCksIHNjYWxlKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL2NhbGN1bGF0aW5nIGZvY2kgZm9yIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAgICB2YXIgZm9jdXNHcm91cHMgPSBzdGF0ZVBvbGljeS5mb2N1c0dyb3VwcztcbiAgICAgICAgICAgICAgICB2YXIgZm9jaTtcbiAgICAgICAgICAgICAgICBpZiAoZm9jdXNHcm91cHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvY2kgPSBbaGVpZ2h0LzJdO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vc2V0dGluZyBmb2NpIGhlaWdodCBwb3NpdGlvbiBiYXNlZCBvbiBwZXJjZW50YWdlXG4gICAgICAgICAgICAgICAgICAgIHZhciBmb2N1c05vZGVzID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0W2ZvY3VzR3JvdXBzWzBdXTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzUG9saWN5LmJvdW5kYXJ5ID0gZm9jdXNOb2Rlcy5sZW5ndGggLyBub2Rlcy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0b3AgPSBoZWlnaHQgKiBjb25zdHNQb2xpY3kuYm91bmRhcnk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBib3QgPSBoZWlnaHQgLSB0b3A7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0b3AgPCAyKnRoaXNHcmFwaC5jb25zdHMubWF4UmFkaXVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdHNQb2xpY3kuYm91bmRhcnkgPSAoMi41ICogdGhpc0dyYXBoLmNvbnN0cy5tYXhSYWRpdXMpIC8gaGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9wID0gaGVpZ2h0ICogY29uc3RzUG9saWN5LmJvdW5kYXJ5O1xuICAgICAgICAgICAgICAgICAgICAgICAgYm90ID0gaGVpZ2h0IC0gdG9wO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGJvdCA8IDIqIHRoaXNHcmFwaC5jb25zdHMubWF4UmFkaXVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdHNQb2xpY3kuYm91bmRhcnkgPSAxIC0gKCgyLjUgKiB0aGlzR3JhcGguY29uc3RzLm1heFJhZGl1cykgLyBoZWlnaHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9wID0gaGVpZ2h0ICogY29uc3RzUG9saWN5LmJvdW5kYXJ5O1xuICAgICAgICAgICAgICAgICAgICAgICAgYm90ID0gaGVpZ2h0IC0gdG9wO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZvY2kgPSBbdG9wLzIsIHRvcCArIGJvdCAvIDJdO1xuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5LmZvY2kgPSBmb2NpO1xuICAgICAgICAgICAgICAgIHJldHVybiB7d2lkdGg6d2lkdGgsIGhlaWdodDpoZWlnaHR9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBhIHNpbmdsZSBub2RlIGlzIHNwbGl0XG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5ld05vZGVzICBUaGUgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNwbGl0Tm9kZUV2ZW50KG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICBfLmZvckVhY2gobmV3Tm9kZXMsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF8uaW5jbHVkZXMoY2hpbGRyZW5fc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzBdXSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5pZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJmb2N1c1wiO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImNvbm5lY3RlZFwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSBuZXdOb2Rlc1swXS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgLy8gc3RhdGUuZm9jdXNHcm91cCA9IHRpdGxlO1xuXG4gICAgICAgICAgICAgICAgLy9pZiB0aGUgbGFzdCBldmVudCBoYXMgdGhlIHNhbWUgaWQsIGl0IG11c3QgYmUgdGhlXG4gICAgICAgICAgICAgICAgLy9vcHBwb3NpdGUgb2YgdGhpcyBldmVudCwgc28gd2UgcmVtb3ZlIHRoYXQgZXZlbnQgZnJvbVxuICAgICAgICAgICAgICAgIC8vdGhlIGV2ZW50IHN0YWNrLlxuICAgICAgICAgICAgICAgIC8vT3RoZXJ3aXNlLCB3ZSBhZGQgdGhlIGV2ZW50IG90IHRoZSBzdGFja1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoICE9PSAwICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3Rvcnlbc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCAtIDFdLmlkID09PSB0aXRsZSkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkucG9wKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5LnB1c2goe2lkOnRpdGxlLCBldmVudDonc3BsaXQnfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmJhY2tCdXR0b25FbGVtICE9IG51bGwgJiYgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uRWxlbS5mYWRlVG8oJ3Nsb3cnLCAxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLnRpdGxlRWxlbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0gc3RhdGUuZm9jdXNHcm91cHNbMF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSAnICYgJyArIHN0YXRlLmZvY3VzR3JvdXBzWzFdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLnRpdGxlRWxlbS50ZXh0KHRleHQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vcmUtZW5hYmxlIGdyYXBoIHVwZGF0ZVxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZS5kaXNhYmxlVXBkYXRlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpc1BvbGljeS5zZXRMYXlvdXQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTZXRzIHRoZSBsYXlvdXQgb2YgdGhlIG5vZGVzLiBcbiAgICAgICAgICAgICAqIElmIHRoZXJlIGlzIGEgcHJldmlvdXMgbGF5b3V0LCBpdCB3aWxsIGJlIGxvYWRlZC5cbiAgICAgICAgICAgICAqIEVsc2UsIGl0IHdpbGwgcnVuIGEgRDMgRm9yY2Ugc2ltdWxhdGlvbiBhbmQgY3JlYXRlIG9uZS5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc2V0TGF5b3V0KCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcbiAgICAgICAgICAgICAgICB2YXIgbGF5b3V0O1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ID0gc3RhdGUubGF5b3V0RGVmYXVsdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSBzdGF0ZS56b29tRGVmYXVsdDtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh6b29tWzBdLCB6b29tWzFdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbSA9IHN0YXRlLnpvb21zW3N0YXRlLmZvY3VzR3JvdXBzXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHpvb20gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh6b29tWzBdLCB6b29tWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBsYXlvdXQgPSBzdGF0ZS5sYXlvdXRbc3RhdGUuZm9jdXNHcm91cHNdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChsYXlvdXQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbihuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9zID0gbGF5b3V0W24uaWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBvcyA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cobGF5b3V0LCBuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG4ueCA9IHBvcy54O1xuICAgICAgICAgICAgICAgICAgICAgICAgbi55ID0gcG9zLnk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGguY2FsbCh0aGlzR3JhcGgsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51cGRhdGVHcmFwaENhbGxiYWNrLmNhbGwodGhpc1BvbGljeSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vTmVlZCB0byBydW4gYSBmb3JjZSBzaW11bGF0aW9uIGFzIHRoaXMgbGF5b3V0XG4gICAgICAgICAgICAgICAgICAgIC8vaGFzbid0IGJlZW4gZG9uZSBiZWZvcmVcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN0YXRlLmluaXRGb3JjZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAvLyB0aGlzUG9saWN5LnNldFBvc2l0aW9ucygpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnVwZGF0ZUdyYXBoQ2FsbGJhY2suY2FsbCh0aGlzUG9saWN5KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLnpvb21zW3N0YXRlLmZvY3VzR3JvdXBzXSA9IFt0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKV07XG4gICAgICAgICAgICAgICAgICAgIHZhciBsYXlvdXQgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24obikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0W24uaWRdID0ge3g6bi54LCB5Om4ueX07XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5sYXlvdXRbc3RhdGUuZm9jdXNHcm91cHNdID0gbGF5b3V0O1xuICAgICAgICAgICAgICAgIH0gXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogT3ZlcnJpZGluZyBmcm9tIHN1cGVyIGNsYXNzIHNvIHRoYXQgd2UgY2FuIGhhdmVcbiAgICAgICAgICAgICAqIHRvcCBsZXZlbCBub2RlcyByZWFwcGVhciB3aGVuIHRoZXkgYXJlIGhpZGRlblxuICAgICAgICAgICAgICogZHVlIHRvIHRoZXJlIGJlaW5nIHR3byBmb2N1cyBncm91cHMuXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgICAgICBub2RlICAgIFRoZSBub2RlIHRvIGpvaW5cbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtOb2RlfSAgVGhlIG5ldyBub2RlIGFmdGVyIHRoZSBqb2luXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIF9fam9pbk5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZVN1cGVyID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pbk5vZGVQb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICAvL2NoZWNrIHRoYXQgbm9kZSBzdGlsbCBleGlzdHNcbiAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLm5vZGVzLmluZGV4T2Yobm9kZSkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBub2RlLmlkO1xuICAgICAgICAgICAgICAgIC8vaWYgaXQgaGFzIG5vIGFuY2VzdG9yLCBub3RoaW5nIHRvIGpvaW5cbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRyZW5fc3RydWN0LnRvcExldmVsLmluZGV4T2YobmFtZSkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IG5vZGUucGFyZW50O1xuICAgICAgICAgICAgICAgIHZhciB0b19iZV9kZWxldGVkID0gW107XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVOYW1lU2V0ID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgLy9pZiBub2RlIHdvbid0IGJlIGNvbGxhcHNlZFxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLm5vZGVzW2ldLmFuY2VzdG9ycy5pbmRleE9mKG5vZGUucGFyZW50KSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZU5hbWVTZXQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0uaWQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9fYmVfZGVsZXRlZC5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlX2lkID0gbm9kZS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgbm9kZU5hbWVTZXQucHVzaChub2RlLnBhcmVudCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgYW5jZXN0b3JzX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmFuY2VzdG9yc19zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICAvLyAtIHNldHRpbmcgZm9jdXNHcm91cHMgLVxuICAgICAgICAgICAgICAgIC8vZWl0aGVyIHJlcGxhY2luZyBvbmUgb2YgdGhlIGdyb3VwcyxcbiAgICAgICAgICAgICAgICAvL29yIGpvaW5pbmcgYmFjayBpbnRvIGEgdG9wIGxldmVsLCBzbyB0aGVyZSBpcyBvbmx5XG4gICAgICAgICAgICAgICAgLy9vbmUgZm9jdXNcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBzdGF0ZS5mb2N1c0dyb3Vwcy5pbmRleE9mKHBhcmVudCk7XG4gICAgICAgICAgICAgICAgaWYgKGFuY2VzdG9yc19zdHJ1Y3RbcGFyZW50XSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzW2luZGV4XSA9IGFuY2VzdG9yc19zdHJ1Y3RbcGFyZW50XTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vbmFtZVRvQWRkIGFyZSB0b3AgbGV2ZWwgbm9kZXMgdGhhdCBhcmUgdG8gYmUgYWRkZWRcbiAgICAgICAgICAgICAgICAvL3RvIHRoZSBncmFwaC5cbiAgICAgICAgICAgICAgICB2YXIgbmFtZVRvQWRkID0gW107XG4gICAgICAgICAgICAgICAgLy93aWxsIG9ubHkgbmVlZCB0byBhZGQgYSB0b3AgbGV2ZWwgbm9kZSBpZiB0aGVyZSBpc1xuICAgICAgICAgICAgICAgIC8vb25seSBvbmUgZm9jdXNcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vQWRkIG9ubHkgdGhvc3QgdGhhdCBhcmVuJ3QgYW4gYW5jZXN0b3Igb2YgdGhlIG5vZGVcbiAgICAgICAgICAgICAgICAgICAgLy90byBqb2luLCB0aGUgZm9jdXMgZ3JvdXAgb3IgYW4gYW5jZXN0b3Igb2YgaXQsXG4gICAgICAgICAgICAgICAgICAgIC8vYW5kIGFyZW4ndCBhbHJlYWR5IGluIG5vZGVOYW1lU2V0LlxuICAgICAgICAgICAgICAgICAgICAvL2dldCBmbG93IGJldHdlZW4gdG9wIGxldmVsIGFzIGxvbmcgYXNcbiAgICAgICAgICAgICAgICAgICAgLy90aGUgdG9wIGxldmVsIGlzbid0IGFuIGFuY2VzdG9yIG9mIHRoZVxuICAgICAgICAgICAgICAgICAgICAvL2ZvY3VzIGdyb3VwLCBhbmQgaXNuJ3QgYWxyZWFkeSBwYXJ0IG9mIHRoZVxuICAgICAgICAgICAgICAgICAgICAvL25vZGUgc2V0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgYW5jZXN0b3JzID0gYW5jZXN0b3JzX3N0cnVjdFtub2RlLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3JzLnB1c2goc3RhdGUuZm9jdXNHcm91cHNbMF0pO1xuICAgICAgICAgICAgICAgICAgICAvL3RoZSBvciBlbXB0eSBhcnJheSBpcyB0byBwcmV2ZW50IGNvbmNhdGVuYXRpbmcgYSBudWxsXG4gICAgICAgICAgICAgICAgICAgIC8vb3IgdW5kZWZpbmVkIHZhbHVlXG4gICAgICAgICAgICAgICAgICAgIGFuY2VzdG9ycyA9IGFuY2VzdG9ycy5jb25jYXQoYW5jZXN0b3JzX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV0gfHwgW10pO1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goY2hpbGRyZW5fc3RydWN0LnRvcExldmVsLCBmdW5jdGlvbihuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW5jZXN0b3JzLmluZGV4T2YobikgPT09IC0xICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVOYW1lU2V0LmluZGV4T2YobikgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lVG9BZGQucHVzaChuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVOYW1lU2V0ID0gbm9kZU5hbWVTZXQuY29uY2F0KG5hbWVUb0FkZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy9ubyBmb2N1cyBncm91cHMgbWVhbnMgd2UgYXJlIGF0IHRvcCBsZXZlbFxuICAgICAgICAgICAgICAgICAgICAvL1Nob3VsZCBhZGQgYW55IHRvcCBsZXZlbCBub2RlcyB0aGF0IGFyZW4ndFxuICAgICAgICAgICAgICAgICAgICAvL2FscmVhZHkgdGhlcmVcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKGNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbCwgZnVuY3Rpb24obikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGVOYW1lU2V0LmluZGV4T2YobikgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lVG9BZGQucHVzaChuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVOYW1lU2V0ID0gbm9kZU5hbWVTZXQuY29uY2F0KG5hbWVUb0FkZCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9mb3JtYXR0aW5nIGRhdGFcbiAgICAgICAgICAgICAgICB2YXIgcmFkaXVzID0gbm9kZS5yYWRpdXMgLyB0aGlzR3JhcGguY29uc3RzLnJhZGl1c0RlY2F5OyBcbiAgICAgICAgICAgICAgICB2YXIgeExvYyA9IG5vZGUueDtcbiAgICAgICAgICAgICAgICB2YXIgeUxvYyA9IG5vZGUueTtcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gbm9kZS5hbmNlc3RvcnNbMV07XG4gICAgICAgICAgICAgICAgdmFyIGFuY2VzdG9ycyA9IG5vZGUuYW5jZXN0b3JzLnNsaWNlKDEpO1xuICAgICAgICAgICAgICAgIHZhciBuZXdOb2RlID0gbmV3IFZpc3VhbGl6ZXJOb2RlLk5vZGUoeExvYywgeUxvYywgbmV3X25vZGVfaWQsIG5ld19ub2RlX2lkLCByYWRpdXMsIHBhcmVudCwgYW5jZXN0b3JzKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMucHVzaChuZXdOb2RlKTtcblxuICAgICAgICAgICAgICAgIC8vcmVtb3ZlIGFsbCBub2RlcyB0aGF0IHdpbGwgYmUgam9pbmVkXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b19iZV9kZWxldGVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlX3RvX2RlbGV0ZSA9IHRvX2JlX2RlbGV0ZWRbaV07XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5zcGxpY2UodGhpc0dyYXBoLm5vZGVzLmluZGV4T2Yobm9kZV90b19kZWxldGUpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlX3RvX2RlbGV0ZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHJldERhdGEgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5nZXRGbG93QmV0d2VlblNldChub2RlTmFtZVNldCk7XG4gICAgICAgICAgICAgICAgLy9ob2xkcyB0aGUgbm9kZURhdGEgd2hpY2ggd2lsbCBiZSBwcm9jZXNzZWRcbiAgICAgICAgICAgICAgICB2YXIgbm9kZXNUb1Byb2Nlc3MgPSBbXTtcbiAgICAgICAgICAgICAgICAvL2ZpbmRpbmcgdGhlIG5vZGUgZGF0YSB0aGF0IGNvcnJlc3BvbmRzIHRvIHRoZSB0b3AgbGV2ZWxcbiAgICAgICAgICAgICAgICAvL25vZGVzIHRvIGFkZCAtIG5hbWVUb0FkZC5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZURhdGEgPSByZXREYXRhLm5vZGVEYXRhO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZURhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWVUb0FkZC5pbmRleE9mKG5vZGVEYXRhW2ldLmlkKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzVG9Qcm9jZXNzLnB1c2gobm9kZURhdGFbaV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9UaGUgdG9wIGxldmVsIG5vZGVzIHRoYXQgYXJlIGFkZGVkXG4gICAgICAgICAgICAgICAgdmFyIG5ld05vZGVzID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UucHJvY2Vzc05vZGVEYXRhKG5vZGVzVG9Qcm9jZXNzKTtcbiAgICAgICAgICAgICAgICBfLmZvckVhY2gobmV3Tm9kZXMsIGZ1bmN0aW9uKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgbi5yYWRpdXMgPSBuLnJhZGl1cyB8fCB0aGlzR3JhcGguY29uc3RzLnN0YXJ0UmFkaXVzO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlcyA9IHRoaXNHcmFwaC5ub2Rlcy5jb25jYXQobmV3Tm9kZXMpO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UucHJvY2Vzc0xpbmtEYXRhKHJldERhdGEubGlua0RhdGEsIHRoaXNHcmFwaC5ub2Rlcyk7XG4gICAgICAgICAgICAgICAgLy9Pbmx5IGtlZXAgdG9wIGxldmVsIG5vZGVzIHRoYXQgaGF2ZSBjb25uZWN0aW9ucyB0b1xuICAgICAgICAgICAgICAgIC8vdGhlIGN1cnJlbnQgZm9jdXMgZ3JvdXBcbiAgICAgICAgICAgICAgICAvL3dlIHJlbW92ZSB0aGUgbm9kZSBuYW1lIGZyb20gbmFtZVRvQWRkIGlmIHdlIGFyZVxuICAgICAgICAgICAgICAgIC8va2VlcGluZyBpdFxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5saW5rcywgZnVuY3Rpb24obCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9jaGVja2luZyBpZiB0aGVyZSBleGlzdHMgYSBsaW5rIHRvdWNoaW5nIGVhY2ggb2YgbmFtZVRvQWRkXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmFtZVRvQWRkLmluZGV4T2YobC5zb3VyY2UuaWQpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwc1swXSA9PT0gbC50YXJnZXQucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVUb0FkZC5zcGxpY2UobmFtZVRvQWRkLmluZGV4T2YobC5zb3VyY2UuaWQpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5hbWVUb0FkZC5pbmRleE9mKGwudGFyZ2V0LmlkKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHNbMF0gPT09IGwuc291cmNlLnBhcmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lVG9BZGQuc3BsaWNlKG5hbWVUb0FkZC5pbmRleE9mKGwudGFyZ2V0LmlkKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vV2Ugd2FudCB0byBrZWVwIHRoZW0gYWxsXG4gICAgICAgICAgICAgICAgICAgIC8vc2luY2UgYW55IGxlZnQgaW4gbmFtZVRvQWRkIHdpbGwgYmUgcmVtb3ZlZCxcbiAgICAgICAgICAgICAgICAgICAgLy93ZSByZXNldCBuYW1lVG9BZGQgaGVyZS5cbiAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkID0gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vd2hhdGV2ZXIgaXMgcmVtYWluaW5nIGluIG5hbWVUb0FkZCBpc24ndCBjb25uZWN0ZWRcbiAgICAgICAgICAgICAgICAvL3RvIHRoZSBmb2N1cyBncm91cCwgc28gd2Ugc2hvdWxkIHJlbW92ZSBpdC5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZVRvUmVtb3ZlID0gW107XG4gICAgICAgICAgICAgICAgaWYgKG5hbWVUb0FkZC5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuYW1lVG9BZGQuaW5kZXhPZih0aGlzR3JhcGgubm9kZXNbaV0uaWQpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVUb0FkZC5zcGxpY2UobmFtZVRvQWRkLmluZGV4T2YodGhpc0dyYXBoLm5vZGVzW2ldLmlkKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZSh0aGlzR3JhcGgubm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVUb1JlbW92ZS5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWVUb0FkZC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF8uZm9yRWFjaChub2RlVG9SZW1vdmUsIGZ1bmN0aW9uKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnNwbGljZSh0aGlzR3JhcGgubm9kZXMuaW5kZXhPZihuKSwgMSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXRMaW5rcygpO1xuXG4gICAgICAgICAgICAgICAgc3RhdGVTdXBlci5zcGxpdE5vZGVzLnNwbGljZShzdGF0ZVN1cGVyLnNwbGl0Tm9kZXMuaW5kZXhPZihuZXdOb2RlLmlkKSwgMSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3Tm9kZTsgXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIGFmdGVyIGEgc2luZ2xlIG5vZGUgaXMgam9pbmVkXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIElmIHRoZSBmb2N1cyBncm91cCBoYXMgYmVlbiBzZWVuIGJlZm9yZSwgaXQgd2lsbFxuICAgICAgICAgICAgICogbG9hZCB0aGF0IGxheW91dC4gT3RoZXJ3aXNlLCBpdCB3aWxsIHJ1biBhIGQzIGZvcmNlXG4gICAgICAgICAgICAgKiBzaW11bGF0aW9uIHRvIGdlbmVyYXRlIG9uZS5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5ld05vZGUgIFRoZSBuZXcgbm9kZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBqb2luTm9kZUV2ZW50KG5ld05vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeSA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICAvL2lmIHRoZSBsYXN0IGV2ZW50IGhhcyB0aGUgc2FtZSBpZCwgaXQgbXVzdCBiZSB0aGVcbiAgICAgICAgICAgICAgICAvL29wcHBvc2l0ZSBvZiB0aGlzIGV2ZW50LCBzbyB3ZSByZW1vdmUgdGhhdCBldmVudCBmcm9tXG4gICAgICAgICAgICAgICAgLy90aGUgZXZlbnQgc3RhY2suXG4gICAgICAgICAgICAgICAgLy9PdGhlcndpc2UsIHdlIGFkZCB0aGUgZXZlbnQgdG8gdGhlIHN0YWNrXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggIT09IDAgJiZcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5W3N0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggLSAxXS5pZCA9PT0gbmV3Tm9kZS5pZCkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkucG9wKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5LnB1c2goe2lkOm5ld05vZGUuaWQsIGV2ZW50Oidqb2luJ30pXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcblxuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV0sIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiZm9jdXNcIjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy9zZXR0aW5nIGJhY2sgYnV0dG9uXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmJhY2tCdXR0b25FbGVtICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmJhY2tCdXR0b25FbGVtLmZhZGVUbygnc2xvdycsIDApO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vc2V0dGluZyB0aXRsZVxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS50aXRsZUVsZW0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ICs9IHN0YXRlLmZvY3VzR3JvdXBzWzBdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0gJyAmICcgKyBzdGF0ZS5mb2N1c0dyb3Vwc1sxXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS50aXRsZUVsZW0udGV4dCh0ZXh0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpc1BvbGljeS5zZXRMYXlvdXQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVbmRvZXMgdGhlIGxhc3Qgc3BsaXQgb3Igam9pbiBldmVudC5cbiAgICAgICAgICAgICAqIE1lYW50IHRvIGJlIGNhbGxlZCBieSB0aGUgYmFjayBidXR0b24uXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHVuZG9MYXN0RXZlbnQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kgPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdmFyIGxhc3QgPSBzdGF0ZS5ldmVudEhpc3Rvcnlbc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgIHZhciBpZCA9IGxhc3QuaWQ7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGU7XG4gICAgICAgICAgICAgICAgaWYgKGxhc3QuZXZlbnQgPT09ICdqb2luJykge1xuICAgICAgICAgICAgICAgICAgICBub2RlID0gdGhpc0dyYXBoLmZpbmROb2RlQnlJZChpZCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkM25vZGUgPSB0aGlzR3JhcGguZmluZEQzTm9kZShpZCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kuZGJsY2xpY2soZDNub2RlLCBub2RlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZUlkID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0W2lkXVswXTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZSA9IHRoaXNHcmFwaC5maW5kTm9kZUJ5SWQobm9kZUlkKTtcbiAgICAgICAgICAgICAgICAgICAgc3VwZXIuam9pbk5vZGUuY2FsbCh0aGlzUG9saWN5LCBub2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgUG9saWN5OiBTcGxpdEpvaW5WaWV3UG9saWN5XG4gICAgICAgIH1cbn1dKTtcblxuXG5cblxuXG5cblxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3MnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbmV0d29ya3MnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgfV0pO1xuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2RlcycsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvbm9kZXMnLFxuICAgICAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgICAgIH0pXG4gICAgfV0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5vcmdhbml6YXRpb25zJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucycsIHtcbiAgICAgICAgICAgIHVybDogJy9vcmdhbml6YXRpb25zJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KVxuICAgIH1dKTsiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc2VydmljZWxicycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2VydmljZWxicycsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvc2VydmljZWxicycsXG4gICAgICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICAgICAgfSlcbiAgICB9XSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2LnNldHRpbmdzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxyXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XHJcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncycsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9nbG9iYWwnLFxyXG4gICAgICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscycsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9zZXR0aW5ncycsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NldHRpbmdzL3NldHRpbmdzbWVudS5odG1sJ1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMubG9ncycsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9sb2dzJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICcnLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcnXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5hdXRoJywge1xyXG4gICAgICAgICAgICAgICAgdXJsOiAnL2F1dGgnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJycsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJydcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLmxpY2Vuc2UnLCB7XHJcbiAgICAgICAgICAgICAgICB1cmw6ICcvbGljZW5zZScsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnJyxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnJ1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMucG9saWNpZXMnLCB7XHJcbiAgICAgICAgICAgICAgICB1cmw6ICcvcG9saWNpZXMnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJycsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJydcclxuICAgICAgICAgICAgfSlcclxuICAgIH1dKTsiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc3RvcmFnZXBvbGljaWVzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL3N0b3JhZ2Vwb2xpY2llcycsXG4gICAgICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICAgICAgfSlcbiAgICB9XSk7IiwiXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnLCBcblx0J2NvbnRpdi5ncmFwaCddKVxuIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnY29udGl2Lm1lbnUudmlzdWFsaXphdGlvbicsIHtcbiAgICAgICAgICAgIHVybDogJy92aXN1YWxpemF0aW9uJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KVxuICAgIH1dKTtcbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52b2x1bWVzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52b2x1bWVzJywge1xuICAgICAgICAgICAgICAgIHVybDogJy92b2x1bWVzJyxcbiAgICAgICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgICAgICB9KVxuICAgIH1dKTtcbiIsIid1c2Ugc3RyaWN0JztcblxuXG4vLyBEZWNsYXJlIGFwcCBsZXZlbCBtb2R1bGUgd2hpY2ggZGVwZW5kcyBvbiB2aWV3cywgYW5kIGNvbXBvbmVudHNcbmFuZ3VsYXIubW9kdWxlKCdjb250aXZBcHAnLCBbXG4gICAgICAgICd1aS5yb3V0ZXInLFxuICAgICAgICAnY29udGl2LmxvZ2luJyxcbiAgICAgICAgJ2NvbnRpdi5tZW51JyxcbiAgICAgICAgJ2NvbnRpdi5kYXNoYm9hcmQnLFxuICAgICAgICAnY29udGl2LmFwcGxpY2F0aW9uZ3JvdXBzJyxcbiAgICAgICAgJ2NvbnRpdi5uZXR3b3JrcycsXG4gICAgICAgICdjb250aXYubmV0d29ya3BvbGljaWVzJyxcbiAgICAgICAgJ2NvbnRpdi5zdG9yYWdlcG9saWNpZXMnLFxuICAgICAgICAnY29udGl2LnNlcnZpY2VsYnMnLFxuICAgICAgICAnY29udGl2LnZvbHVtZXMnLFxuICAgICAgICAnY29udGl2Lm5vZGVzJyxcbiAgICAgICAgJ2NvbnRpdi5vcmdhbml6YXRpb25zJyxcbiAgICAgICAgJ2NvbnRpdi5zZXR0aW5ncycsXG4gICAgICAgICdjb250aXYudmlzdWFsaXphdGlvbidcbiAgICBdKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsICckdXJsUm91dGVyUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAvL2Fic3RyYWN0IHN0YXRlIHNlcnZlcyBhcyBhIFBMQUNFSE9MREVSIG9yIE5BTUVTUEFDRSBmb3IgYXBwbGljYXRpb24gc3RhdGVzXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdicsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcnLFxuICAgICAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgZmx1aWQgY29udGFpbmVyXCIvPidcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvJyk7XG4gICAgfV0pO1xuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzExLzE2LlxuICovXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMTAvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuYXBwbGljYXRpb25ncm91cHMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3Vwcy5jcmVhdGUnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0FwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsIGFzIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcGxpY2F0aW9uZ3JvdXBzL2FwcGxpY2F0aW9uZ3JvdXBjcmVhdGUuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignQXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwnLCBbXG4gICAgICAgICckc3RhdGUnLFxuICAgICAgICAnJHN0YXRlUGFyYW1zJyxcbiAgICAgICAgJ0FwcGxpY2F0aW9uR3JvdXBzTW9kZWwnLFxuICAgICAgICAnTmV0d29ya3NNb2RlbCcsXG4gICAgICAgICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsXG4gICAgICAgICAgICAgICAgICAkc3RhdGVQYXJhbXMsXG4gICAgICAgICAgICAgICAgICBBcHBsaWNhdGlvbkdyb3Vwc01vZGVsLFxuICAgICAgICAgICAgICAgICAgTmV0d29ya3NNb2RlbCxcbiAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgICAgICB2YXIgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwgPSB0aGlzO1xuICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwubmV0d29ya3MgPSBbXTtcbiAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLmFwcGxpY2F0aW9uR3JvdXAgPSB7fTtcbiAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLnNlbGVjdGVkTmV0d29yayA9IHt9O1xuICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwubW9kZSA9IFwiZWRpdFwiO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub0FwcGxpY2F0aW9uR3JvdXAoKSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3Vwcy5saXN0Jyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNhbmNlbENyZWF0aW5nKCkge1xuICAgICAgICAgICAgICAgIHJldHVyblRvQXBwbGljYXRpb25Hcm91cCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEdldCBuZXR3b3JrcyBmb3IgdGhlIGdpdmVuIHRlbmFudC5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0TmV0d29ya3MoKSB7XG4gICAgICAgICAgICAgICAgTmV0d29ya3NNb2RlbC5nZXQoKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwubmV0d29ya3MgPSBfLmZpbHRlcihyZXN1bHQsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICd0ZW5hbnROYW1lJzogJ2RlZmF1bHQnLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUFwcGxpY2F0aW9uR3JvdXAoKSB7XG4gICAgICAgICAgICAgICAgLy9mb3JtIGNvbnRyb2xsZXIgaXMgaW5qZWN0ZWQgYnkgdGhlIGh0bWwgdGVtcGxhdGVcbiAgICAgICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgICAgIGlmIChhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLmFwcGxpY2F0aW9uR3JvdXAubmV0d29ya05hbWUgPVxuICAgICAgICAgICAgICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwuc2VsZWN0ZWROZXR3b3JrLm5ldHdvcmtOYW1lO1xuXG4gICAgICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLmFwcGxpY2F0aW9uR3JvdXAua2V5ID1cbiAgICAgICAgICAgICAgICAgICAgICAgIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwuZ2VuZXJhdGVLZXkoYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwuYXBwbGljYXRpb25Hcm91cCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAqIGFwcGxpY2F0aW9uR3JvdXAgY29uc2lzdCBvZiBHcm91cCBOYW1lLCBOZXR3b3JrIE5hbWUsIElzb2xhdGlvbiBQb2xpY2llcywgQmFuZHdpZHRoIFBvbGljeVxuICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwuY3JlYXRlKGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLmFwcGxpY2F0aW9uR3JvdXApLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9BcHBsaWNhdGlvbkdyb3VwKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZnVuY3Rpb24gcmVzZXRGb3JtKCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwuYXBwbGljYXRpb25Hcm91cCA9IHtcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXBOYW1lOiAnJywgICAgICAgICAgLy8gRm9yIEdyb3VwIE5hbWVcbiAgICAgICAgICAgICAgICAgICAgbmV0d29ya05hbWU6ICcnLCAgICAgICAgLy8gRm9yIE5ldHdvcmsgTmFtZVxuICAgICAgICAgICAgICAgICAgICBwb2xpY2llczogW10sICAgICAgICAgICAvLyBGb3IgSXNvbGF0aW9uIHBvbGljaWVzXG4gICAgICAgICAgICAgICAgICAgIG5ldFByb2ZpbGU6ICcnLCAgICAgICAgIC8vIEZvciBCYW5kd2lkdGggcG9saWN5IE5hbWVcbiAgICAgICAgICAgICAgICAgICAgdGVuYW50TmFtZTogJ2RlZmF1bHQnLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBnZXROZXR3b3JrcygpO1xuXG4gICAgICAgICAgICBhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybC5jcmVhdGVBcHBsaWNhdGlvbkdyb3VwID0gY3JlYXRlQXBwbGljYXRpb25Hcm91cDtcbiAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLmNhbmNlbENyZWF0aW5nID0gY2FuY2VsQ3JlYXRpbmc7XG5cbiAgICAgICAgICAgIHJlc2V0Rm9ybSgpO1xuICAgICAgICB9XSk7IiwiIC8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8xNS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5hcHBsaWNhdGlvbmdyb3VwcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0FwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCBhcyBhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwbGljYXRpb25ncm91cHMvYXBwbGljYXRpb25ncm91cGRldGFpbHMuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmVkaXQnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2VkaXQvOmtleScsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0FwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCBhcyBhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwbGljYXRpb25ncm91cHMvYXBwbGljYXRpb25ncm91cGRldGFpbHMuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignQXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsJywgW1xuICAgICAgICAnJHN0YXRlJyxcbiAgICAgICAgJyRzdGF0ZVBhcmFtcycsXG4gICAgICAgICdBcHBsaWNhdGlvbkdyb3Vwc01vZGVsJyxcbiAgICAgICAgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICAgICAgZnVuY3Rpb24gKCRzdGF0ZSxcbiAgICAgICAgICAgICAgICAgICRzdGF0ZVBhcmFtcyxcbiAgICAgICAgICAgICAgICAgIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwsXG4gICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICAgICAgdmFyIGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCA9IHRoaXM7XG5cbiAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybC5hcHBsaWNhdGlvbkdyb3VwID0ge307XG4gICAgICAgICAgICBhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwuc2VsZWN0ZWROZXR3b3JrID0ge307XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVG8gc2hvdyBlZGl0IG9yIGRldGFpbHMgc2NyZWVuIGJhc2VkIG9uIHRoZSByb3V0ZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmdW5jdGlvbiBzZXRNb2RlKCkge1xuICAgICAgICAgICAgICAgIGlmICgkc3RhdGUuaXMoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmVkaXQnKSkge1xuICAgICAgICAgICAgICAgICAgICBhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwubW9kZSA9ICdlZGl0JztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwubW9kZSA9ICdkZXRhaWxzJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHJldHVyblRvQXBwbGljYXRpb25Hcm91cCgpIHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmxpc3QnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9BcHBsaWNhdGlvbkdyb3VwRGV0YWlscygpIHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmRldGFpbHMnLCB7J2tleSc6IGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybC5hcHBsaWNhdGlvbkdyb3VwLmtleX0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBjYW5jZWxFZGl0aW5nKCkge1xuICAgICAgICAgICAgICAgIHJldHVyblRvQXBwbGljYXRpb25Hcm91cERldGFpbHMoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gZGVsZXRlQXBwbGljYXRpb25Hcm91cCgpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwuZGVsZXRlKGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybC5hcHBsaWNhdGlvbkdyb3VwKS50aGVuKFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub0FwcGxpY2F0aW9uR3JvdXAoKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBzYXZlQXBwbGljYXRpb25Hcm91cCgpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwpO1xuXG4gICAgICAgICAgICAgICAgQXBwbGljYXRpb25Hcm91cHNNb2RlbC5zYXZlKGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybC5hcHBsaWNhdGlvbkdyb3VwKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub0FwcGxpY2F0aW9uR3JvdXBEZXRhaWxzKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsKTtcblxuICAgICAgICAgICAgQXBwbGljYXRpb25Hcm91cHNNb2RlbC5nZXRNb2RlbEJ5S2V5KCRzdGF0ZVBhcmFtcy5rZXkpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGdyb3VwKSB7XG4gICAgICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybC5hcHBsaWNhdGlvbkdyb3VwID0gZ3JvdXA7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybC5zYXZlQXBwbGljYXRpb25Hcm91cCA9IHNhdmVBcHBsaWNhdGlvbkdyb3VwO1xuICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLmNhbmNlbEVkaXRpbmcgPSBjYW5jZWxFZGl0aW5nO1xuICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLmRlbGV0ZUFwcGxpY2F0aW9uR3JvdXAgPSBkZWxldGVBcHBsaWNhdGlvbkdyb3VwO1xuXG4gICAgICAgICAgICBzZXRNb2RlKCk7XG5cbiAgICAgICAgfV0pOyIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8xMS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5hcHBsaWNhdGlvbmdyb3VwcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmxpc3QnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBcHBsaWNhdGlvbkdyb3VwTGlzdEN0cmwgYXMgYXBwbGljYXRpb25Hcm91cExpc3RDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcGxpY2F0aW9uZ3JvdXBzL2FwcGxpY2F0aW9uZ3JvdXBsaXN0Lmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICA7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ0FwcGxpY2F0aW9uR3JvdXBMaXN0Q3RybCcsXG4gICAgICAgIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ0FwcGxpY2F0aW9uR3JvdXBzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgICAgICAgICAgZnVuY3Rpb24gKCRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBBcHBsaWNhdGlvbkdyb3Vwc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICAgICAgICAgIHZhciBhcHBsaWNhdGlvbkdyb3VwTGlzdEN0cmwgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0QXBwbGljYXRpb25Hcm91cHMocmVsb2FkKSB7XG4gICAgICAgICAgICAgICAgICAgIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGFwcGxpY2F0aW9uR3JvdXBMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cExpc3RDdHJsLmdyb3VwcyA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihhcHBsaWNhdGlvbkdyb3VwTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgICAgICAgICAgZ2V0QXBwbGljYXRpb25Hcm91cHMoZmFsc2UpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgICAgICAgICAgLy9Eb24ndCBzdGFydCBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0QXBwbGljYXRpb25Hcm91cHModHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0sIDUwMDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XSk7XG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgaGFyZGlrIGdhbmRoaSBvbiA2LzI4LzE2LlxuICovXG5cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmFwcGxpY2F0aW9uZ3JvdXBzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dkJhbmR3aWR0aHBvbGljeVwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIG1vZGU6XCI9XCIsXG4gICAgICAgICAgICAgICAgYXBwbGljYXRpb25ncm91cDonPSdcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFtcbiAgICAgICAgICAgICAgICAnJHNjb3BlJyxcbiAgICAgICAgICAgICAgICAnTmV0cHJvZmlsZXNNb2RlbCcsXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKCRzY29wZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgTmV0cHJvZmlsZXNNb2RlbCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubmV0UHJvZmlsZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkTmV0cHJvZmlsZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljeTp7fVxuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgKiBHZXQgcHJvZmlsZXMgZm9yIHRoZSBnaXZlbiB0ZW5hbnQuXG4gICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZXROZXRwcm9maWxlcygpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIE5ldHByb2ZpbGVzTW9kZWwuZ2V0KCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm5ldFByb2ZpbGVzID0gXy5maWx0ZXIocmVzdWx0LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0ZW5hbnROYW1lJzogJ2RlZmF1bHQnICAgICAgICAvL1RPRE86IFJlbW92ZSBoYXJkY29kZWQgdGVuYW50LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRzY29wZS5hcHBsaWNhdGlvbmdyb3VwLm5ldFByb2ZpbGUgIT09ICcnKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkTmV0cHJvZmlsZS5wb2xpY3kgPSBfLmZpbmQoJHNjb3BlLm5ldFByb2ZpbGVzLGZ1bmN0aW9uKHBvbGljeSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcG9saWN5LnByb2ZpbGVOYW1lID09PSAkc2NvcGUuYXBwbGljYXRpb25ncm91cC5uZXRQcm9maWxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgKiBBc3NpZ24gcHJvZmlsZU5hbWUgdG8gYXBwbGljYXRpb25ncm91cCB3aGljaGV2ZXIgdXNlciBoYXMgZ2l2ZW4gXG4gICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudXBkYXRlQXBwbGljYXRpb25ncm91cCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZigkc2NvcGUuc2VsZWN0ZWROZXRwcm9maWxlLnBvbGljeSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hcHBsaWNhdGlvbmdyb3VwLm5ldFByb2ZpbGUgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hcHBsaWNhdGlvbmdyb3VwLm5ldFByb2ZpbGUgPSAkc2NvcGUuc2VsZWN0ZWROZXRwcm9maWxlLnBvbGljeS5wcm9maWxlTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgZ2V0TmV0cHJvZmlsZXMoKTtcbiAgICAgICAgICAgIH1dLFxuXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcGxpY2F0aW9uZ3JvdXBzL2JhbmR3aWR0aHBvbGljeS5odG1sJ1xuICAgICAgICB9XG4gICAgfSk7XG5cblxuXG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgaGFyZGlrIGdhbmRoaSBvbiA3LzgvMTYuXG4gKi9cblxuYW5ndWxhci5tb2R1bGUoXCJjb250aXYuYXBwbGljYXRpb25ncm91cHNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2SXNvbGF0aW9ucG9saWN5XCIsZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJue1xuICAgICAgICAgICAgcmVzdHJpY3Q6J0UnLFxuICAgICAgICAgICAgc2NvcGU6e1xuICAgICAgICAgICAgICAgIG1vZGU6Jz0nLFxuICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uZ3JvdXA6Jz0nXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY29udHJvbGxlcjogW1xuICAgICAgICAgICAgICAgICckc2NvcGUnLFxuICAgICAgICAgICAgICAgICckc3RhdGVQYXJhbXMnLFxuICAgICAgICAgICAgICAgICdBcHBsaWNhdGlvbkdyb3Vwc01vZGVsJyxcbiAgICAgICAgICAgICAgICAnUG9saWNpZXNNb2RlbCcsXG4gICAgICAgICAgICAgICAgJ1J1bGVzTW9kZWwnLFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCRzY29wZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAkc3RhdGVQYXJhbXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgQXBwbGljYXRpb25Hcm91cHNNb2RlbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICBQb2xpY2llc01vZGVsLFxuICAgICAgICAgICAgICAgICAgICAgICAgIFJ1bGVzTW9kZWwpe1xuXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pbmNvbWluZ1J1bGVzID0gW107XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5vdXRnb2luZ1J1bGVzID0gW107XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZFBvbGljeSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljeTp7fVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWRQb2xpY2llcyA9IFtdOyAgICAgICAgICAgLy8gVG8gU3RvcmUgcG9saWNpZXMgc2VsZWN0ZWQgYnkgdXNlciB0byBkaXNwbGF5XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pc29sYXRpb25Qb2xpY2llcyA9IFtdOyAgICAgICAgICAvLyBUbyBHZXQgYWxsIGlzb2xhdGlvbiBwb2xpY2llcyBvZiB0ZW5hbnRcblxuXG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgKiBHZXQgaW5jb21pbmcgYW5kIG91dGdvaW5nIHJ1bGVzIGZvciBlYWNoIHBvbGljeSBwcmVzZW50IGluIGFwcGxpY2F0aW9uZ3JvdXBcbiAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdldFJ1bGVzKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFwcGxpY2F0aW9uZ3JvdXAucG9saWNpZXMuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9UbyBkaXNwbGF5IHJ1bGVzIG9mIHNlbGVjdGVkIHBvbGljaWVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUnVsZXNNb2RlbC5nZXRJbmNvbWluZ1J1bGVzKHBvbGljeSwgJ2RlZmF1bHQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocnVsZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KCRzY29wZS5pbmNvbWluZ1J1bGVzLCBydWxlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJ1bGVzTW9kZWwuZ2V0T3V0Z29pbmdSdWxlcyhwb2xpY3ksICdkZWZhdWx0JylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJ1bGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseSgkc2NvcGUub3V0Z29pbmdSdWxlcywgcnVsZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAqIEdldCBwb2xpY2llcyBmb3IgdGhlIGdpdmVuIHRlbmFudC5cbiAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdldElzb2xhdGlvblBvbGljaWVzKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgUG9saWNpZXNNb2RlbC5nZXQoKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXNvbGF0aW9uUG9saWNpZXMgPSBfLmZpbHRlcihyZXN1bHQsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RlbmFudE5hbWUnOiAnZGVmYXVsdCcvL1RPRE86IFJlbW92ZSBoYXJkY29kZWQgdGVuYW50LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICogQWRkIHBvbGljeSB0byBhcHBsaWNhdGlvbiBncm91cFxuICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFkZElzb2xhdGlvblBvbGljeSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRQb2xpY3lOYW1lID0gJHNjb3BlLnNlbGVjdGVkUG9saWN5LnBvbGljeS5wb2xpY3lOYW1lO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFBvbGljeU5hbWUgIT09IHVuZGVmaW5lZCAmJiBfLmluY2x1ZGVzKCRzY29wZS5zZWxlY3RlZFBvbGljaWVzLCBjdXJyZW50UG9saWN5TmFtZSkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1RvIGRpc3BsYXkgc2VsZWN0ZWQgcG9saWNpZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWRQb2xpY2llcy5wdXNoKGN1cnJlbnRQb2xpY3lOYW1lKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vVG8gZGlzcGxheSBydWxlcyBvZiBzZWxlY3RlZCBwb2xpY2llc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJ1bGVzTW9kZWwuZ2V0SW5jb21pbmdSdWxlcyhjdXJyZW50UG9saWN5TmFtZSwgJ2RlZmF1bHQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocnVsZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KCRzY29wZS5pbmNvbWluZ1J1bGVzLCBydWxlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJ1bGVzTW9kZWwuZ2V0T3V0Z29pbmdSdWxlcyhjdXJyZW50UG9saWN5TmFtZSwgJ2RlZmF1bHQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocnVsZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KCRzY29wZS5vdXRnb2luZ1J1bGVzLCBydWxlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9UbyBiZSBhZGRlZCB0byBhcHBsaWNhdGlvbiBncm91cCBhbmQgc2F2ZWQgdG8gdGhlIHNlcnZlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hcHBsaWNhdGlvbmdyb3VwLnBvbGljaWVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5wdXNoKGN1cnJlbnRQb2xpY3lOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICogUmVtb3ZlIHBvbGljeSBmcm9tIGFwcGxpY2F0aW9uIGdyb3VwXG4gICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVtb3ZlSXNvbGF0aW9uUG9saWN5ID0gZnVuY3Rpb24ocG9saWN5TmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgXy5yZW1vdmUoJHNjb3BlLnNlbGVjdGVkUG9saWNpZXMsZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwb2xpY3kgPT09IHBvbGljeU5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF8ucmVtb3ZlKCRzY29wZS5hcHBsaWNhdGlvbmdyb3VwLnBvbGljaWVzLCBmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBvbGljeSA9PT0gcG9saWN5TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgXy5yZW1vdmUoJHNjb3BlLmluY29taW5nUnVsZXMsIGZ1bmN0aW9uIChydWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJ1bGUucG9saWN5TmFtZSA9PT0gcG9saWN5TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgXy5yZW1vdmUoJHNjb3BlLm91dGdvaW5nUnVsZXMsIGZ1bmN0aW9uIChydWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJ1bGUucG9saWN5TmFtZSA9PT0gcG9saWN5TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgKiAgVG8gY2hlY2sgJ2RldGFpbHMnIG9yICdlZGl0JyBtb2RlIChub3QgY3JlYXRlIG1vZGUpXG4gICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICBpZigkc2NvcGUubW9kZSA9PSAnZGV0YWlscycgfHwgKCRzY29wZS5tb2RlID09ICdlZGl0JyAmJiAkc2NvcGUuYXBwbGljYXRpb25ncm91cC5ncm91cE5hbWUgIT0gXCJcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vQXBwbGljYXRpb24gR3JvdXBzIG1pZ2h0IG5vdCBoYXZlIGFueSBwb2xpY2llcyBhc3NvY2lhdGVkIHdpdGggdGhlbSBzbyBkZWZpbmUgYW4gZW1wdHkgYXJyYXlcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuYXBwbGljYXRpb25ncm91cC5wb2xpY2llcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFwcGxpY2F0aW9uZ3JvdXAucG9saWNpZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGdldFJ1bGVzKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZ2V0SXNvbGF0aW9uUG9saWNpZXMoKTtcbiAgICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOidhcHBsaWNhdGlvbmdyb3Vwcy9pc29sYXRpb25wb2xpY3kuaHRtbCdcbiAgICAgICAgfVxuICAgIH0pO1xuXG5cblxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzExLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmRhc2hib2FyZCcpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmRhc2hib2FyZCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvZGFzaGJvYXJkJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnRGFzaGJvYXJkQ3RybCBhcyBkYXNoYm9hcmRDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2Rhc2hib2FyZC9kYXNoYm9hcmQuaHRtbCdcbiAgICAgICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdEYXNoYm9hcmRDdHJsJyxcbiAgICAgICAgW1xuICAgICAgICAgICAgJyRzY29wZScsXG4gICAgICAgICAgICAnJGludGVydmFsJyxcbiAgICAgICAgICAgICdOb2Rlc01vZGVsJyxcbiAgICAgICAgICAgICdOZXR3b3Jrc01vZGVsJyxcbiAgICAgICAgICAgICdWb2x1bWVzTW9kZWwnLFxuICAgICAgICAgICAgJ0FwcGxpY2F0aW9uR3JvdXBzTW9kZWwnLFxuICAgICAgICAgICAgJ1BvbGljaWVzTW9kZWwnLFxuICAgICAgICAgICAgJ1N0b3JhZ2VQb2xpY2llc01vZGVsJyxcbiAgICAgICAgICAgIGZ1bmN0aW9uICgkc2NvcGUsXG4gICAgICAgICAgICAgICAgICAgICAgJGludGVydmFsLFxuICAgICAgICAgICAgICAgICAgICAgIE5vZGVzTW9kZWwsXG4gICAgICAgICAgICAgICAgICAgICAgTmV0d29ya3NNb2RlbCxcbiAgICAgICAgICAgICAgICAgICAgICBWb2x1bWVzTW9kZWwsXG4gICAgICAgICAgICAgICAgICAgICAgQXBwbGljYXRpb25Hcm91cHNNb2RlbCxcbiAgICAgICAgICAgICAgICAgICAgICBQb2xpY2llc01vZGVsLFxuICAgICAgICAgICAgICAgICAgICAgIFN0b3JhZ2VQb2xpY2llc01vZGVsKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRhc2hib2FyZEN0cmwgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0RGFzaGJvYXJkSW5mbyhyZWxvYWQpIHtcbiAgICAgICAgICAgICAgICAgICAgTm9kZXNNb2RlbC5nZXQocmVsb2FkKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhc2hib2FyZEN0cmwubm9kZXMgPSByZXN1bHQubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIE5ldHdvcmtzTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXNoYm9hcmRDdHJsLm5ldHdvcmtzID0gcmVzdWx0Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBWb2x1bWVzTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXNoYm9hcmRDdHJsLnZvbHVtZXMgPSByZXN1bHQubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXNoYm9hcmRDdHJsLmdyb3VwcyA9IHJlc3VsdC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgUG9saWNpZXNNb2RlbC5nZXQocmVsb2FkKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhc2hib2FyZEN0cmwubmV0d29ya3BvbGljaWVzID0gcmVzdWx0Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbC5nZXQocmVsb2FkKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhc2hib2FyZEN0cmwuc3RvcmFnZXBvbGljaWVzID0gcmVzdWx0Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vV2lsbCBkaXNwbGF5IDAgaWYgdGhlcmUgaXMgZXJyb3IgZmV0Y2hpbmcgZGF0YVxuICAgICAgICAgICAgICAgIGRhc2hib2FyZEN0cmwubm9kZXMgPSAwO1xuICAgICAgICAgICAgICAgIGRhc2hib2FyZEN0cmwubmV0d29ya3MgPSAwO1xuICAgICAgICAgICAgICAgIGRhc2hib2FyZEN0cmwudm9sdW1lcyA9IDA7XG4gICAgICAgICAgICAgICAgZGFzaGJvYXJkQ3RybC5ncm91cHMgPSAwO1xuICAgICAgICAgICAgICAgIGRhc2hib2FyZEN0cmwubmV0d29ya3BvbGljaWVzID0gMDtcbiAgICAgICAgICAgICAgICBkYXNoYm9hcmRDdHJsLnN0b3JhZ2Vwb2xpY2llcyA9IDA7XG5cbiAgICAgICAgICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgICAgICAgICBnZXREYXNoYm9hcmRJbmZvKGZhbHNlKTtcblxuICAgICAgICAgICAgICAgIHZhciBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2V0RGFzaGJvYXJkSW5mbyh0cnVlKTtcbiAgICAgICAgICAgICAgICB9LCA1MDAwKTtcblxuICAgICAgICAgICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1dKTtcbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5sb2dpbicpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5sb2dpbicsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2xvZ2luL2xvZ2luLmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdMb2dpbkN0cmwgYXMgbG9naW5DdHJsJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdMb2dpbkN0cmwnLCBbJyRzdGF0ZScsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgICAgICB2YXIgbG9naW5DdHJsID0gdGhpcztcblxuICAgICAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9EYXNoYm9hcmQoKSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5kYXNoYm9hcmQnLCB7dXNlcm5hbWU6IGxvZ2luQ3RybC51c2VybmFtZX0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBsb2dpbigpIHtcbiAgICAgICAgICAgICAgICByZXR1cm5Ub0Rhc2hib2FyZCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGxvZ2luQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IobG9naW5DdHJsKTtcbiAgICAgICAgICAgIGxvZ2luQ3RybC5sb2dpbiA9IGxvZ2luO1xuXG4gICAgICAgIH1dKTsiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubWVudScpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Jywge1xuICAgICAgICAgICAgICAgIHVybDogJy9tJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ21lbnUvbWVudS5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnTWVudUN0cmwgYXMgbWVudUN0cmwnLFxuICAgICAgICAgICAgICAgIHBhcmFtczoge3VzZXJuYW1lOiBudWxsfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdNZW51Q3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcykge1xuICAgICAgICB2YXIgbWVudUN0cmwgPSB0aGlzO1xuXG4gICAgICAgIGZ1bmN0aW9uIGxvZ291dCgpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2LmxvZ2luJyk7XG4gICAgICAgIH1cblxuICAgICAgICBtZW51Q3RybC51c2VybmFtZSA9ICRzdGF0ZVBhcmFtcy51c2VybmFtZTtcbiAgICAgICAgbWVudUN0cmwubG9nb3V0ID0gbG9nb3V0O1xuXG4gICAgfV0pOyIsIi8qKlxuICogQ3JlYXRlZCBieSBoYXJkaWsgZ2FuZGhpIG9uIDYvMjQvMTYuXG4gKi9cblxuYW5ndWxhci5tb2R1bGUoXCJjb250aXYubmV0d29ya3BvbGljaWVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dkJhbmR3aWR0aFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBiYW5kd2lkdGhQb2xpY3k6Jz0nLFxuICAgICAgICAgICAgICAgIG1vZGU6XCJAXCJcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGxpbms6ZnVuY3Rpb24oc2NvcGUpIHtcblxuICAgICAgICAgICAgICAgIGlmIChzY29wZS5iYW5kd2lkdGhQb2xpY3kuYmFuZHdpZHRoICE9ICcnKXtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJhbmR3aWR0aEFycmF5ID0gc2NvcGUuYmFuZHdpZHRoUG9saWN5LmJhbmR3aWR0aC5zcGxpdCgnICcpO1xuICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuYmFuZHdpZHRoUG9saWN5LmJhbmR3aWR0aE51bWJlciA9IE51bWJlcihiYW5kd2lkdGhBcnJheVswXSk7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLmJhbmR3aWR0aFBvbGljeS5iYW5kd2lkdGhVbml0ID0gYmFuZHdpZHRoQXJyYXlbMV07XG5cbiAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtfcG9saWNpZXMvYmFuZHdpZHRoLmh0bWwnXG4gICAgICAgIH1cbiAgICB9KTtcbiIsIi8qXG4vKipcbiAqIENyZWF0ZWQgYnkgaGFyZGlrIGdhbmRoaSBvbiA2LzE0LzE2LlxuICovXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3BvbGljaWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmJhbmR3aWR0aC5jcmVhdGUnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0JhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwgYXMgYmFuZHdpZHRoUG9saWN5Q3JlYXRlQ3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3JrX3BvbGljaWVzL2JhbmR3aWR0aHBvbGljeWNyZWF0ZS5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdCYW5kd2lkdGhQb2xpY3lDcmVhdGVDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywnTmV0cHJvZmlsZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgTmV0cHJvZmlsZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgICAgIHZhciBiYW5kd2lkdGhQb2xpY3lDcmVhdGVDdHJsID0gdGhpcztcblxuICAgICAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Qb2xpY2llcygpIHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5saXN0LmJhbmR3aWR0aCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBjYW5jZWxDcmVhdGluZygpIHtcbiAgICAgICAgICAgICAgICByZXR1cm5Ub1BvbGljaWVzKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNyZWF0ZVBvbGljeSgpIHtcbiAgICAgICAgICAgICAgICBpZiAoYmFuZHdpZHRoUG9saWN5Q3JlYXRlQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoYmFuZHdpZHRoUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwpO1xuXG4gICAgICAgICAgICAgICAgICAgIGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwubmV3UG9saWN5LmtleSA9XG4gICAgICAgICAgICAgICAgICAgICAgICBOZXRwcm9maWxlc01vZGVsLmdlbmVyYXRlS2V5KGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwubmV3UG9saWN5KTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwubmV3UG9saWN5LmJhbmR3aWR0aCA9IGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwubmV3UG9saWN5LmJhbmR3aWR0aE51bWJlclxuICAgICAgICAgICAgICAgICAgICAgICAgKyBcIiBcIisgYmFuZHdpZHRoUG9saWN5Q3JlYXRlQ3RybC5uZXdQb2xpY3kuYmFuZHdpZHRoVW5pdDtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIE5ldHByb2ZpbGVzTW9kZWwuY3JlYXRlKGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwubmV3UG9saWN5KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYmFuZHdpZHRoUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1BvbGljaWVzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gcmVzZXRGb3JtKCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYmFuZHdpZHRoUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwubmV3UG9saWN5ID0ge1xuICAgICAgICAgICAgICAgICAgICBwcm9maWxlTmFtZTogJycsXG4gICAgICAgICAgICAgICAgICAgIHRlbmFudE5hbWU6ICdkZWZhdWx0JywgLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgICAgICAgICAgYmFuZHdpZHRoOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgRFNDUDogJydcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBiYW5kd2lkdGhQb2xpY3lDcmVhdGVDdHJsLmNyZWF0ZVBvbGljeSA9IGNyZWF0ZVBvbGljeTtcbiAgICAgICAgICAgIGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwuY2FuY2VsQ3JlYXRpbmcgPSBjYW5jZWxDcmVhdGluZztcblxuICAgICAgICAgICAgcmVzZXRGb3JtKCk7XG4gICAgICAgIH1dKTtcblxuXG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgaGFyZGlrIGdhbmRoaSBvbiA2LzE2LzE2LlxuICovXG5cblxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcG9saWNpZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuYmFuZHdpZHRoLmRldGFpbHMnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0JhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsIGFzIGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtfcG9saWNpZXMvYmFuZHdpZHRocG9saWN5ZGV0YWlscy5odG1sJ1xuICAgICAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGguZWRpdCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvZWRpdC86a2V5JyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnQmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwgYXMgYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmV0d29ya19wb2xpY2llcy9iYW5kd2lkdGhwb2xpY3lkZXRhaWxzLmh0bWwnXG4gICAgICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignQmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwnLCBbXG4gICAgICAgICckc3RhdGUnLFxuICAgICAgICAnJHN0YXRlUGFyYW1zJyxcbiAgICAgICAgJ05ldHByb2ZpbGVzTW9kZWwnLFxuICAgICAgICAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgICAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIE5ldHByb2ZpbGVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgICAgICB2YXIgYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwgPSB0aGlzO1xuXG4gICAgICAgICAgICBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybC5iYW5kd2lkdGhQcm9maWxlcyA9IFtdO1xuXG4gICAgICAgICAgICAvKiBHZXQgcGFydGljdWxhciBQcm9maWxlIGZvciBiYXNlZCBvbiBrZXkqL1xuICAgICAgICAgICAgTmV0cHJvZmlsZXNNb2RlbC5nZXRNb2RlbEJ5S2V5KCRzdGF0ZVBhcmFtcy5rZXkpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kgPSBwb2xpY3k7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVG8gc2hvdyBlZGl0IG9yIGRldGFpbHMgc2NyZWVuIGJhc2VkIG9uIHRoZSByb3V0ZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmdW5jdGlvbiBzZXRNb2RlKCkge1xuICAgICAgICAgICAgICAgIGlmICgkc3RhdGUuaXMoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGguZWRpdCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLm1vZGUgPSAnZWRpdCc7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwubW9kZSA9ICdkZXRhaWxzJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGRlbGV0ZVBvbGljeSgpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBOZXRwcm9maWxlc01vZGVsLmRlbGV0ZVVzaW5nS2V5KGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLnBvbGljeS5rZXksICduYW1lJykudGhlbihcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1BvbGljaWVzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Qb2xpY2llcygpIHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5saXN0LmJhbmR3aWR0aCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1BvbGljeURldGFpbHMoKSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuYmFuZHdpZHRoLmRldGFpbHMnLCB7J2tleSc6IGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLnBvbGljeS5rZXl9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gY2FuY2VsRWRpdGluZygpIHtcbiAgICAgICAgICAgICAgICByZXR1cm5Ub1BvbGljeURldGFpbHMoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gc2F2ZVBvbGljeSgpIHtcbiAgICAgICAgICAgICAgICAvL2Zvcm0gY29udHJvbGxlciBpcyBpbmplY3RlZCBieSB0aGUgaHRtbCB0ZW1wbGF0ZVxuICAgICAgICAgICAgICAgIC8vY2hlY2tpbmcgaWYgYWxsIHZhbGlkYXRpb25zIGhhdmUgcGFzc2VkXG4gICAgICAgICAgICAgICAgaWYgKGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwucG9saWN5LmJhbmR3aWR0aCA9IGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLnBvbGljeS5iYW5kd2lkdGhOdW1iZXIgKyBcIiBcIiArIGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLnBvbGljeS5iYW5kd2lkdGhVbml0O1xuICAgICAgICAgICAgICAgICAgICBOZXRwcm9maWxlc01vZGVsLnNhdmUoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwucG9saWN5KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9Qb2xpY3lEZXRhaWxzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsKTtcblxuICAgICAgICAgICAgc2V0TW9kZSgpO1xuXG4gICAgICAgICAgICBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybC5kZWxldGVQb2xpY3kgPSBkZWxldGVQb2xpY3k7XG4gICAgICAgICAgICBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybC5zYXZlUG9saWN5ID0gc2F2ZVBvbGljeTtcbiAgICAgICAgICAgIGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLmNhbmNlbEVkaXRpbmcgPSBjYW5jZWxFZGl0aW5nO1xuXG4gICAgICAgIH1dKTtcbiIsIi8qKlxuICogQ3JlYXRlZCBieSBoYXJkaWsgZ2FuZGhpIG9uIDYvMTQvMTYuXG4gKi9cblxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcG9saWNpZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMubGlzdC5iYW5kd2lkdGgnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2JhbmR3aWR0aCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0JhbmR3aWR0aFBvbGljeUxpc3RDdHJsIGFzIGJhbmR3aWR0aFBvbGljeUxpc3RDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtfcG9saWNpZXMvYmFuZHdpZHRocG9saWN5bGlzdC5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdCYW5kd2lkdGhQb2xpY3lMaXN0Q3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ05ldHByb2ZpbGVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgICAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIE5ldHByb2ZpbGVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgICAgICB2YXIgcG9saWNpZXNMaXN0Q3RybCA9IHRoaXM7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldFBvbGljaWVzKHJlbG9hZCkge1xuICAgICAgICAgICAgICAgIE5ldHByb2ZpbGVzTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihwb2xpY2llc0xpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljaWVzTGlzdEN0cmwucG9saWNpZXMgPSAkZmlsdGVyKCdvcmRlckJ5JykocmVzdWx0LCAncHJvZmlsZU5hbWUnKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIocG9saWNpZXNMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgICAgIGdldFBvbGljaWVzKHRydWUpO1xuXG4gICAgICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgICAgIC8vRG9uJ3Qgc3RhcnQgYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGdldFBvbGljaWVzKHRydWUpO1xuICAgICAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICB9XSk7XG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMTAvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3BvbGljaWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbi5jcmVhdGUnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0lzb2xhdGlvblBvbGljeUNyZWF0ZUN0cmwgYXMgaXNvbGF0aW9uUG9saWN5Q3JlYXRlQ3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3JrX3BvbGljaWVzL2lzb2xhdGlvbnBvbGljeWNyZWF0ZS5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdJc29sYXRpb25Qb2xpY3lDcmVhdGVDdHJsJywgWyckc3RhdGUnLCAnUG9saWNpZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsIFBvbGljaWVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBpc29sYXRpb25Qb2xpY3lDcmVhdGVDdHJsID0gdGhpcztcblxuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1BvbGljaWVzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMubGlzdC5pc29sYXRpb24nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbENyZWF0aW5nKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9Qb2xpY2llcygpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlUG9saWN5KCkge1xuICAgICAgICAgICAgaWYgKGlzb2xhdGlvblBvbGljeUNyZWF0ZUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoaXNvbGF0aW9uUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5Q3JlYXRlQ3RybC5uZXdQb2xpY3kua2V5ID1cbiAgICAgICAgICAgICAgICAgICAgUG9saWNpZXNNb2RlbC5nZW5lcmF0ZUtleShpc29sYXRpb25Qb2xpY3lDcmVhdGVDdHJsLm5ld1BvbGljeSk7XG4gICAgICAgICAgICAgICAgUG9saWNpZXNNb2RlbC5jcmVhdGUoaXNvbGF0aW9uUG9saWN5Q3JlYXRlQ3RybC5uZXdQb2xpY3kpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGlzb2xhdGlvblBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1BvbGljaWVzKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihpc29sYXRpb25Qb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeUNyZWF0ZUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZXNldEZvcm0oKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGlzb2xhdGlvblBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5Q3JlYXRlQ3RybC5uZXdQb2xpY3kgPSB7XG4gICAgICAgICAgICAgICAgcG9saWN5TmFtZTogJycsXG4gICAgICAgICAgICAgICAgdGVuYW50TmFtZTogJ2RlZmF1bHQnLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBpc29sYXRpb25Qb2xpY3lDcmVhdGVDdHJsLmNyZWF0ZVBvbGljeSA9IGNyZWF0ZVBvbGljeTtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5Q3JlYXRlQ3RybC5jYW5jZWxDcmVhdGluZyA9IGNhbmNlbENyZWF0aW5nO1xuXG4gICAgICAgIHJlc2V0Rm9ybSgpO1xuICAgIH1dKTtcbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy84LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtwb2xpY2llcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5pc29sYXRpb24uZGV0YWlscycsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnSXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwgYXMgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmV0d29ya19wb2xpY2llcy9pc29sYXRpb25wb2xpY3lkZXRhaWxzLmh0bWwnXG4gICAgICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbi5lZGl0Jywge1xuICAgICAgICAgICAgICAgIHVybDogJy9lZGl0LzprZXknLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdJc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCBhcyBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3JrX3BvbGljaWVzL2lzb2xhdGlvbnBvbGljeWRldGFpbHMuaHRtbCdcbiAgICAgICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdJc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCcsIFtcbiAgICAgICAgJyRzdGF0ZScsXG4gICAgICAgICckc3RhdGVQYXJhbXMnLFxuICAgICAgICAnUG9saWNpZXNNb2RlbCcsXG4gICAgICAgICdSdWxlc01vZGVsJyxcbiAgICAgICAgJ05ldHdvcmtzTW9kZWwnLFxuICAgICAgICAnQXBwbGljYXRpb25Hcm91cHNNb2RlbCcsXG4gICAgICAgICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgUG9saWNpZXNNb2RlbCwgUnVsZXNNb2RlbCwgTmV0d29ya3NNb2RlbCwgQXBwbGljYXRpb25Hcm91cHNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgICAgIHZhciBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCA9IHRoaXM7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXR3b3JrcyA9IFtdO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuYXBwbGljYXRpb25Hcm91cHMgPSBbXTtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ05ldHdvcmtTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVJbmNvbWluZ05ldHdvcmtTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVJbmNvbWluZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVJbmNvbWluZ0lQQWRkcmVzc1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nSVBBZGRyZXNzU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1NlbGVjdGVkQXBwbGljYXRpb25Hcm91cCA9ICcnO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdTZWxlY3RlZEFwcGxpY2F0aW9uR3JvdXAgPSAnJztcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nU2VsZWN0ZWROZXR3b3JrID0gJyc7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1NlbGVjdGVkTmV0d29yayA9ICcnO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuaW5jb3JyZWN0Q0lEUiA9IGZhbHNlO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwudmFsaWRhdGVDSURSRmxhZyA9IGZhbHNlO1xuXG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHJldHVyblRvUG9saWNpZXMoKSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMubGlzdC5pc29sYXRpb24nKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Qb2xpY3lEZXRhaWxzKCkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbi5kZXRhaWxzJywge2tleTogaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwucG9saWN5LmtleX0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBjYW5jZWxFZGl0aW5nKCkge1xuICAgICAgICAgICAgICAgIHJldHVyblRvUG9saWN5RGV0YWlscygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEdvIGJhY2sgdG8gcG9saWN5IGRldGFpbHMgYWZ0ZXIgZG9uZSBlZGl0aW5nXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZ1bmN0aW9uIGRvbmVFZGl0aW5nKCkge1xuICAgICAgICAgICAgICAgIHJldHVyblRvUG9saWN5RGV0YWlscygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBkZWxldGVQb2xpY3koKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgUG9saWNpZXNNb2RlbC5kZWxldGUoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwucG9saWN5KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvUG9saWNpZXMoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRvIHNob3cgZWRpdCBvciBkZXRhaWxzIHNjcmVlbiBiYXNlZCBvbiB0aGUgcm91dGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gc2V0TW9kZSgpIHtcbiAgICAgICAgICAgICAgICBpZiAoJHN0YXRlLmlzKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuaXNvbGF0aW9uLmVkaXQnKSkge1xuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5tb2RlID0gJ2VkaXQnO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm1vZGUgPSAnZGV0YWlscyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiByZXNldE5ld0luY29taW5nUnVsZSgpIHtcbiAgICAgICAgICAgICAgICAvL1J1bGUgb2JqZWN0IHRvIGJlIGNyZWF0ZWQgb24gc2VydmVyXG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlID0ge1xuICAgICAgICAgICAgICAgICAgICBydWxlSWQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICBwcmlvcml0eTogMSxcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAnYWxsb3cnLC8vdG8gbWFrZSBpdCBkZWZhdWx0IHNlbGVjdGVkIG9wdGlvbiBpbiBVSVxuICAgICAgICAgICAgICAgICAgICBmcm9tRW5kcG9pbnRHcm91cDogJycsXG4gICAgICAgICAgICAgICAgICAgIGZyb21OZXR3b3JrOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgZnJvbUlwQWRkcmVzczogJycsXG4gICAgICAgICAgICAgICAgICAgIHByb3RvY29sOiAndGNwJywvL3RvIG1ha2UgaXQgZGVmYXVsdCBzZWxlY3RlZCBvcHRpb24gaW4gVUlcbiAgICAgICAgICAgICAgICAgICAgcG9ydDogMCxcbiAgICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uOiAnaW4nLFxuICAgICAgICAgICAgICAgICAgICB0ZW5hbnROYW1lOiAnZGVmYXVsdCcsXG4gICAgICAgICAgICAgICAgICAgIHBvbGljeU5hbWU6IGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLnBvbGljeS5wb2xpY3lOYW1lXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1NlbGVjdGVkQXBwbGljYXRpb25Hcm91cCA9ICcnO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nU2VsZWN0ZWROZXR3b3JrID0gJyc7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nTmV0d29ya1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVJbmNvbWluZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdJUEFkZHJlc3NTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvcnJlY3RDSURSID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwudmFsaWRhdGVDSURSRmxhZyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiByZXNldE5ld091dGdvaW5nUnVsZSgpIHtcbiAgICAgICAgICAgICAgICAvL1J1bGUgb2JqZWN0IHRvIGJlIGNyZWF0ZWQgb24gc2VydmVyXG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlID0ge1xuICAgICAgICAgICAgICAgICAgICBydWxlSWQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICBwcmlvcml0eTogMSxcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAnYWxsb3cnLC8vdG8gbWFrZSBpdCBkZWZhdWx0IHNlbGVjdGVkIG9wdGlvbiBpbiBVSVxuICAgICAgICAgICAgICAgICAgICB0b0VuZHBvaW50R3JvdXA6ICcnLFxuICAgICAgICAgICAgICAgICAgICB0b05ldHdvcms6ICcnLFxuICAgICAgICAgICAgICAgICAgICB0b0lwQWRkcmVzczogJycsXG4gICAgICAgICAgICAgICAgICAgIHByb3RvY29sOiAndGNwJywvL3RvIG1ha2UgaXQgZGVmYXVsdCBzZWxlY3RlZCBvcHRpb24gaW4gVUlcbiAgICAgICAgICAgICAgICAgICAgcG9ydDogMCxcbiAgICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uOiAnb3V0JyxcbiAgICAgICAgICAgICAgICAgICAgdGVuYW50TmFtZTogJ2RlZmF1bHQnLFxuICAgICAgICAgICAgICAgICAgICBwb2xpY3lOYW1lOiBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kucG9saWN5TmFtZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdTZWxlY3RlZEFwcGxpY2F0aW9uR3JvdXAgPSAnJztcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1NlbGVjdGVkTmV0d29yayA9ICcnO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ05ldHdvcmtTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlT3V0Z29pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nSVBBZGRyZXNzU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuaW5jb3JyZWN0Q0lEUiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLnZhbGlkYXRlQ0lEUkZsYWcgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBHZXQgbmV0d29yayBuYW1lcyBmb3IgdGhlIGdpdmVuIHRlbmFudC5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0TmV0d29ya3MoKSB7XG4gICAgICAgICAgICAgICAgTmV0d29ya3NNb2RlbC5nZXQoKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9fLmZpbHRlcigpIHJldHVybnMgYSBuZXcgYXJyYXlcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV0d29ya3MgPSBfLmZpbHRlcihyZXN1bHQsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICd0ZW5hbnROYW1lJzogJ2RlZmF1bHQnLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogR2V0IGFwcGxpY2F0aW9uIGdyb3VwIG5hbWVzIGZvciB0aGUgZ2l2ZW4gdGVuYW50LlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRBcHBsaWNhdGlvbkdyb3VwcygpIHtcbiAgICAgICAgICAgICAgICBBcHBsaWNhdGlvbkdyb3Vwc01vZGVsLmdldCgpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vXy5maWx0ZXIoKSByZXR1cm5zIGEgbmV3IGFycmF5XG4gICAgICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5hcHBsaWNhdGlvbkdyb3VwcyA9IF8uZmlsdGVyKHJlc3VsdCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0ZW5hbnROYW1lJzogJ2RlZmF1bHQnLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBFdmVudCBoYW5kbGVyIHRvIGRpc2FibGUgbmV0d29yayBzZWxlY3Rpb24gYm94IG9uY2UgYXBwbGljYXRpb24gZ3JvdXAgaXMgc2VsZWN0ZWQgd2hpbGUgY3JlYXRpbmcgYSBuZXdcbiAgICAgICAgICAgICAqIHJ1bGUuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZ1bmN0aW9uIG9uQ2hhbmdlT3V0Z29pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmIChpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1NlbGVjdGVkQXBwbGljYXRpb25Hcm91cCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vSWYgYXBwbGljYXRpb24gZ3JvdXAgaGFzIGJlZW4gc2VsZWN0ZWRcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlLnRvRW5kcG9pbnRHcm91cCA9XG4gICAgICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1NlbGVjdGVkQXBwbGljYXRpb25Hcm91cC5ncm91cE5hbWU7XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZS50b05ldHdvcmsgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nTmV0d29ya1NlbGVjdGlvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy9XaGVuICdub25lJyBpcyBzZWxlY3RlZFxuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1J1bGUudG9FbmRwb2ludEdyb3VwID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ05ldHdvcmtTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogRXZlbnQgaGFuZGxlciB0byBkaXNhYmxlIG5ldHdvcmsgc2VsZWN0aW9uIGJveCBvbmNlIGFwcGxpY2F0aW9uIGdyb3VwIGlzIHNlbGVjdGVkIHdoaWxlIGNyZWF0aW5nIGEgbmV3XG4gICAgICAgICAgICAgKiBydWxlLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmdW5jdGlvbiBvbkNoYW5nZUluY29taW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbigpIHtcbiAgICAgICAgICAgICAgICBpZiAoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdTZWxlY3RlZEFwcGxpY2F0aW9uR3JvdXAgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAvL0lmIGFwcGxpY2F0aW9uIGdyb3VwIGhhcyBiZWVuIHNlbGVjdGVkXG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nUnVsZS5mcm9tRW5kcG9pbnRHcm91cCA9XG4gICAgICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1NlbGVjdGVkQXBwbGljYXRpb25Hcm91cC5ncm91cE5hbWU7XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nUnVsZS5mcm9tTmV0d29yayA9ICcnO1xuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdOZXR3b3JrU2VsZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL1doZW4gJ25vbmUnIGlzIHNlbGVjdGVkXG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nUnVsZS5mcm9tRW5kcG9pbnRHcm91cCA9ICcnO1xuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlT3V0Z29pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVJbmNvbWluZ05ldHdvcmtTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBFdmVudCBoYW5kbGVyIHRvIGRpc2FibGUgYXBwbGljYXRpb24gZ3JvdXAgc2VsZWN0aW9uIGJveCBvbmNlIG5ldHdvcmsgaXMgc2VsZWN0ZWQgd2hpbGUgY3JlYXRpbmcgYSBuZXdcbiAgICAgICAgICAgICAqIHJ1bGUuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZ1bmN0aW9uIG9uQ2hhbmdlT3V0Z29pbmdOZXR3b3JrU2VsZWN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmIChpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1NlbGVjdGVkTmV0d29yayE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9JZiBuZXR3b3JrIGhhcyBiZWVuIHNlbGVjdGVkXG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZS50b05ldHdvcmsgPVxuICAgICAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdTZWxlY3RlZE5ldHdvcms7XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZS5Ub0VuZHBvaW50R3JvdXAgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ0lQQWRkcmVzc1NlbGVjdGlvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlLnRvSXBBZGRyZXNzID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nSVBBZGRyZXNzU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEV2ZW50IGhhbmRsZXIgdG8gZGlzYWJsZSBhcHBsaWNhdGlvbiBncm91cCBzZWxlY3Rpb24gYm94IG9uY2UgbmV0d29yayBpcyBzZWxlY3RlZCB3aGlsZSBjcmVhdGluZyBhIG5ld1xuICAgICAgICAgICAgICogcnVsZS5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gb25DaGFuZ2VJbmNvbWluZ05ldHdvcmtTZWxlY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nU2VsZWN0ZWROZXR3b3JrICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9JZiBuZXR3b3JrIGhhcyBiZWVuIHNlbGVjdGVkXG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nUnVsZS5mcm9tTmV0d29yayA9XG4gICAgICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1NlbGVjdGVkTmV0d29yaztcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlLmZyb21FbmRwb2ludEdyb3VwID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVJbmNvbWluZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdJUEFkZHJlc3NTZWxlY3Rpb24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nUnVsZS5mcm9tTmV0d29yayA9ICcnO1xuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVJbmNvbWluZ0lQQWRkcmVzc1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBHZW5lcmF0ZXMgcnVsZSBpZFxuICAgICAgICAgICAgICogVE9ETyBNYWtlIGl0IGNyeXB0b2dyYXBoaWNhbGx5IHN0cm9uZ2VyIG9uY2Ugd2UgaGF2ZSBtdWx0aXBsZSB1c2VycyB1cGRhdGluZyBzYW1lIHBvbGljeVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmdW5jdGlvbiBnZW5lcmF0ZVJ1bGVJZChydWxlKSB7XG4gICAgICAgICAgICAgICAgcnVsZS5ydWxlSWQgPVxuICAgICAgICAgICAgICAgICAgICAoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuaW5jb21pbmdSdWxlcy5sZW5ndGggKyBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5vdXRnb2luZ1J1bGVzLmxlbmd0aCArIDEpLnRvU3RyaW5nKCkgKyAnLScgK1xuICAgICAgICAgICAgICAgICAgICBEYXRlLm5vdygpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUnVsZSBpcyBzYXZlZCB0byBzZXJ2ZXJcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gYWRkSW5jb21pbmdSdWxlKCkge1xuICAgICAgICAgICAgICAgIGlmKHZhbGlkYXRlQ0lEUihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUuZnJvbUlwQWRkcmVzcykpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBnZW5lcmF0ZVJ1bGVJZChpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUpO1xuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUua2V5ID0gUnVsZXNNb2RlbC5nZW5lcmF0ZUtleShpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUpO1xuICAgICAgICAgICAgICAgICAgICBSdWxlc01vZGVsLmNyZWF0ZShpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvbWluZ1J1bGVzLnB1c2gocmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc2V0TmV3SW5jb21pbmdSdWxlKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBvbkNoYW5nZUluY29taW5nSVBBZGRyZXNzKCl7XG4gICAgICAgICAgICAgICAgaWYoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlLmZyb21JcEFkZHJlc3MgPT0gJycpe1xuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvcnJlY3RDSURSID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVJbmNvbWluZ05ldHdvcmtTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nTmV0d29ya1NlbGVjdGlvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwudmFsaWRhdGVDSURSRmxhZyAmJlxuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvcnJlY3RDSURSKXtcbiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGVDSURSKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nUnVsZS5mcm9tSXBBZGRyZXNzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGZ1bmN0aW9uIG9uQ2hhbmdlT3V0Z29pbmdJUEFkZHJlc3MoKXtcbiAgICAgICAgICAgICAgICBpZihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1J1bGUudG9JcEFkZHJlc3MgPT0gJycpe1xuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvcnJlY3RDSURSID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ05ldHdvcmtTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nTmV0d29ya1NlbGVjdGlvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwudmFsaWRhdGVDSURSRmxhZyAmJlxuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvcnJlY3RDSURSKXtcbiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGVDSURSKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZS50b0lwQWRkcmVzcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiB2YWxpZGF0ZUNJRFIoaXBhZGRyZXNzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNpZHJQYXR0ZXJuID0gbmV3IFJlZ0V4cChDb250aXZHbG9iYWxzLkNJRFJfUkVHRVgpO1xuXG4gICAgICAgICAgICAgICAgaWYoaXBhZGRyZXNzID09ICcnKXtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGNpZHJQYXR0ZXJuLnRlc3QoaXBhZGRyZXNzKSkge1xuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvcnJlY3RDSURSID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvcnJlY3RDSURSID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC52YWxpZGF0ZUNJRFJGbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUnVsZSBpcyBzYXZlZCB0byBzZXJ2ZXJcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gYWRkT3V0Z29pbmdSdWxlKCkge1xuICAgICAgICAgICAgICAgIGlmKHZhbGlkYXRlQ0lEUihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1J1bGUudG9JcEFkZHJlc3MpKSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgZ2VuZXJhdGVSdWxlSWQoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlKTtcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlLmtleSA9IFJ1bGVzTW9kZWwuZ2VuZXJhdGVLZXkoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlKTtcbiAgICAgICAgICAgICAgICAgICAgUnVsZXNNb2RlbC5jcmVhdGUoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwub3V0Z29pbmdSdWxlcy5wdXNoKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNldE5ld091dGdvaW5nUnVsZSgpO1xuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBEZWxldGUgaW5jb21pbmcgcnVsZSBmcm9tIHNlcnZlclxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmdW5jdGlvbiBkZWxldGVJbmNvbWluZ1J1bGUoa2V5KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgUnVsZXNNb2RlbC5kZWxldGVVc2luZ0tleShrZXkpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgXy5yZW1vdmUoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuaW5jb21pbmdSdWxlcywgZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuLmtleSA9PSBrZXk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogRGVsZXRlIG91dGdvaW5nIHJ1bGUgZnJvbSBzZXJ2ZXJcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gZGVsZXRlT3V0Z29pbmdSdWxlKGtleSkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIFJ1bGVzTW9kZWwuZGVsZXRlVXNpbmdLZXkoa2V5KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIF8ucmVtb3ZlKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm91dGdvaW5nUnVsZXMsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbi5rZXkgPT0ga2V5O1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG5cbiAgICAgICAgICAgIFBvbGljaWVzTW9kZWwuZ2V0TW9kZWxCeUtleSgkc3RhdGVQYXJhbXMua2V5KVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwucG9saWN5ID0gcG9saWN5O1xuICAgICAgICAgICAgICAgICAgICBSdWxlc01vZGVsLmdldEluY29taW5nUnVsZXMocG9saWN5LnBvbGljeU5hbWUsICdkZWZhdWx0JykudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvbWluZ1J1bGVzID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzZXROZXdJbmNvbWluZ1J1bGUoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIFJ1bGVzTW9kZWwuZ2V0T3V0Z29pbmdSdWxlcyhwb2xpY3kucG9saWN5TmFtZSwgJ2RlZmF1bHQnKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm91dGdvaW5nUnVsZXMgPSByZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNldE5ld091dGdvaW5nUnVsZSgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZ2V0TmV0d29ya3MoKTtcbiAgICAgICAgICAgIGdldEFwcGxpY2F0aW9uR3JvdXBzKCk7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kZWxldGVQb2xpY3kgPSBkZWxldGVQb2xpY3k7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kZWxldGVJbmNvbWluZ1J1bGUgPSBkZWxldGVJbmNvbWluZ1J1bGU7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kZWxldGVPdXRnb2luZ1J1bGUgPSBkZWxldGVPdXRnb2luZ1J1bGU7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5hZGRJbmNvbWluZ1J1bGUgPSBhZGRJbmNvbWluZ1J1bGU7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5hZGRPdXRnb2luZ1J1bGUgPSBhZGRPdXRnb2luZ1J1bGU7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kb25lRWRpdGluZyA9IGRvbmVFZGl0aW5nO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuY2FuY2VsRWRpdGluZyA9IGNhbmNlbEVkaXRpbmc7XG4gICAgICAgICAgICAvL0V2ZW50IEhhbmRsZXJzXG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5vbkNoYW5nZU91dGdvaW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IG9uQ2hhbmdlT3V0Z29pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwub25DaGFuZ2VJbmNvbWluZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24gPSBvbkNoYW5nZUluY29taW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbjtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm9uQ2hhbmdlT3V0Z29pbmdOZXR3b3JrU2VsZWN0aW9uID0gb25DaGFuZ2VPdXRnb2luZ05ldHdvcmtTZWxlY3Rpb247XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5vbkNoYW5nZUluY29taW5nTmV0d29ya1NlbGVjdGlvbiA9IG9uQ2hhbmdlSW5jb21pbmdOZXR3b3JrU2VsZWN0aW9uO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwub25DaGFuZ2VJbmNvbWluZ0lQQWRkcmVzcyA9IG9uQ2hhbmdlSW5jb21pbmdJUEFkZHJlc3M7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5vbkNoYW5nZU91dGdvaW5nSVBBZGRyZXNzID0gb25DaGFuZ2VPdXRnb2luZ0lQQWRkcmVzcztcblxuICAgICAgICAgICAgc2V0TW9kZSgpO1xuXG4gICAgICAgIH1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtwb2xpY2llcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5saXN0Lmlzb2xhdGlvbicsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvaXNvbGF0aW9uJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnSXNvbGF0aW9uUG9saWN5TGlzdEN0cmwgYXMgaXNvbGF0aW9uUG9saWN5TGlzdEN0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmV0d29ya19wb2xpY2llcy9pc29sYXRpb25wb2xpY3lsaXN0Lmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICA7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ0lzb2xhdGlvblBvbGljeUxpc3RDdHJsJywgWyckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnUG9saWNpZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgUG9saWNpZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgICAgIHZhciBwb2xpY2llc0xpc3RDdHJsID0gdGhpcztcblxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0UG9saWNpZXMocmVsb2FkKSB7XG4gICAgICAgICAgICAgICAgUG9saWNpZXNNb2RlbC5nZXQocmVsb2FkKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIocG9saWNpZXNMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2xpY2llc0xpc3RDdHJsLnBvbGljaWVzID0gJGZpbHRlcignb3JkZXJCeScpKHJlc3VsdCwgJ3BvbGljeU5hbWUnKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIocG9saWNpZXNMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgICAgIGdldFBvbGljaWVzKGZhbHNlKTtcblxuICAgICAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgICAgICAvL0Rvbid0IHN0YXJ0IGF1dG8tcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBnZXRQb2xpY2llcyh0cnVlKTtcbiAgICAgICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XSk7XG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvOS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcG9saWNpZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMubGlzdCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ05ldHdvcmtQb2xpY2llc1RhYnNDdHJsIGFzIG5ldHdvcmtQb2xpY2llc1RhYnNDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtfcG9saWNpZXMvbmV0d29ya3BvbGljaWVzdGFicy5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmxpc3QucmVkaXJlY3Rpb24nLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL3JlZGlyZWN0aW9uJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogJydcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTmV0d29ya1BvbGljaWVzVGFic0N0cmwnLCBbJyRzdGF0ZScsZnVuY3Rpb24gKCRzdGF0ZSkge1xuICAgICAgICB2YXIgbmV0d29ya1BvbGljaWVzVGFic0N0cmwgPSB0aGlzO1xuICAgICAgICBcbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlTmV0d29ya1BvbGljeSgpIHtcbiAgICAgICAgICAgIGlmKCRzdGF0ZS4kY3VycmVudC5pbmNsdWRlc1snY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmxpc3QuaXNvbGF0aW9uJ10pe1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbi5jcmVhdGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKCRzdGF0ZS4kY3VycmVudC5pbmNsdWRlc1snY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmxpc3QuYmFuZHdpZHRoJ10pIHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGguY3JlYXRlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBuZXR3b3JrUG9saWNpZXNUYWJzQ3RybC5jcmVhdGVOZXR3b3JrUG9saWN5ID0gY3JlYXRlTmV0d29ya1BvbGljeTtcbiAgICB9XSk7XG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDIvMTkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3MnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3Jrcy5jcmVhdGUnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3Jrcy9uZXR3b3JrY3JlYXRlLmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOZXR3b3JrQ3JlYXRlQ3RybCBhcyBuZXR3b3JrQ3JlYXRlQ3RybCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTmV0d29ya0NyZWF0ZUN0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnTmV0d29ya3NNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgTmV0d29ya3NNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgICAgIHZhciBuZXR3b3JrQ3JlYXRlQ3RybCA9IHRoaXM7XG4gICAgICAgICAgICBuZXR3b3JrQ3JlYXRlQ3RybC5jaWRyUGF0dGVybiA9IENvbnRpdkdsb2JhbHMuQ0lEUl9SRUdFWDtcblxuICAgICAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9OZXR3b3JrcygpIHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5ldHdvcmtzLmxpc3QnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9OZXR3b3JrcygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBjcmVhdGVOZXR3b3JrKCkge1xuICAgICAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAgICAgLy9jaGVja2luZyBpZiBhbGwgdmFsaWRhdGlvbnMgaGF2ZSBwYXNzZWRcbiAgICAgICAgICAgICAgICBpZiAobmV0d29ya0NyZWF0ZUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG5ldHdvcmtDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIobmV0d29ya0NyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBuZXR3b3JrQ3JlYXRlQ3RybC5uZXdOZXR3b3JrLmtleSA9XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXR3b3JrQ3JlYXRlQ3RybC5uZXdOZXR3b3JrLnRlbmFudE5hbWUgKyAnOicgKyBuZXR3b3JrQ3JlYXRlQ3RybC5uZXdOZXR3b3JrLm5ldHdvcmtOYW1lO1xuICAgICAgICAgICAgICAgICAgICBOZXR3b3Jrc01vZGVsLmNyZWF0ZShuZXR3b3JrQ3JlYXRlQ3RybC5uZXdOZXR3b3JrKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobmV0d29ya0NyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9OZXR3b3JrcygpO1xuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3JrQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IobmV0d29ya0NyZWF0ZUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiByZXNldEZvcm0oKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3JrQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG5ldHdvcmtDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBuZXR3b3JrQ3JlYXRlQ3RybC5uZXdOZXR3b3JrID0ge1xuICAgICAgICAgICAgICAgICAgICBuZXR3b3JrTmFtZTogJycsXG4gICAgICAgICAgICAgICAgICAgIGVuY2FwOiAndnhsYW4nLFxuICAgICAgICAgICAgICAgICAgICBzdWJuZXQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICBnYXRld2F5OiAnJyxcbiAgICAgICAgICAgICAgICAgICAgdGVuYW50TmFtZTogJ2RlZmF1bHQnLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBuZXR3b3JrQ3JlYXRlQ3RybC5jcmVhdGVOZXR3b3JrID0gY3JlYXRlTmV0d29yaztcbiAgICAgICAgICAgIG5ldHdvcmtDcmVhdGVDdHJsLmNhbmNlbENyZWF0aW5nID0gY2FuY2VsQ3JlYXRpbmc7XG5cbiAgICAgICAgICAgIHJlc2V0Rm9ybSgpO1xuICAgICAgICB9XSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3MuZGV0YWlscycsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnTmV0d29ya0RldGFpbHNDdHJsIGFzIG5ldHdvcmtEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3Jrcy9uZXR3b3JrZGV0YWlscy5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3MuZGV0YWlscy5pbmZvJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9pbmZvJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtzL25ldHdvcmtpbmZvLmh0bWwnXG4gICAgICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTmV0d29ya0RldGFpbHNDdHJsJyxcbiAgICAgICAgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdOZXR3b3Jrc01vZGVsJywgJ0FwcGxpY2F0aW9uR3JvdXBzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgICAgICAgICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCAkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgTmV0d29ya3NNb2RlbCwgQXBwbGljYXRpb25Hcm91cHNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV0d29ya0RldGFpbHNDdHJsID0gdGhpcztcblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHJldHVyblRvTmV0d29ya3MoKSB7XG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubmV0d29ya3MubGlzdCcpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGRlbGV0ZU5ldHdvcmsoKSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihuZXR3b3JrRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihuZXR3b3JrRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBOZXR3b3Jrc01vZGVsLmRlbGV0ZShuZXR3b3JrRGV0YWlsc0N0cmwubmV0d29yaykudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub05ldHdvcmtzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IobmV0d29ya0RldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBHZXQgYXBwbGljYXRpb24gZ3JvdXBzIGJlbG9uZ2luZyB0byBhIG5ldHdvcmtcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZXRBcHBsaWNhdGlvbkdyb3VwcyhyZWxvYWQpIHtcbiAgICAgICAgICAgICAgICAgICAgQXBwbGljYXRpb25Hcm91cHNNb2RlbC5nZXQocmVsb2FkKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldHdvcmtEZXRhaWxzQ3RybC5hcHBsaWNhdGlvbkdyb3VwcyA9ICRmaWx0ZXIoJ29yZGVyQnknKShfLmZpbHRlcihyZXN1bHQsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbmV0d29ya05hbWUnOiBuZXR3b3JrRGV0YWlsc0N0cmwubmV0d29yay5uZXR3b3JrTmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSksICdncm91cE5hbWUnKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3JrRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihuZXR3b3JrRGV0YWlsc0N0cmwpO1xuXG4gICAgICAgICAgICAgICAgTmV0d29ya3NNb2RlbC5nZXRNb2RlbEJ5S2V5KCRzdGF0ZVBhcmFtcy5rZXkpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChuZXR3b3JrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXR3b3JrRGV0YWlsc0N0cmwubmV0d29yayA9IG5ldHdvcms7XG4gICAgICAgICAgICAgICAgICAgICAgICBnZXRBcHBsaWNhdGlvbkdyb3VwcyhmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgbmV0d29ya0RldGFpbHNDdHJsLmRlbGV0ZU5ldHdvcmsgPSBkZWxldGVOZXR3b3JrO1xuXG4gICAgICAgICAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgICAgICAgICAgLy9Eb24ndCBkbyBhdXRvcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICAgICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBnZXRBcHBsaWNhdGlvbkdyb3Vwcyh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3MubGlzdCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ05ldHdvcmtzTGlzdEN0cmwgYXMgbmV0d29ya3NMaXN0Q3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3Jrcy9uZXR3b3JrbGlzdC5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOZXR3b3Jrc0xpc3RDdHJsJywgWyckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnTmV0d29ya3NNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgTmV0d29ya3NNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgICAgIHZhciBuZXR3b3Jrc0xpc3RDdHJsID0gdGhpcztcblxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0TmV0d29ya3MocmVsb2FkKSB7XG4gICAgICAgICAgICAgICAgTmV0d29ya3NNb2RlbC5nZXQocmVsb2FkKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3Jrc0xpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXR3b3Jrc0xpc3RDdHJsLm5ldHdvcmtzID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3Jrc0xpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgICAgIGdldE5ldHdvcmtzKGZhbHNlKTtcblxuICAgICAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgICAgICAvL0Rvbid0IGRvIGF1dG9yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGdldE5ldHdvcmtzKHRydWUpO1xuICAgICAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfV0pO1xuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGNzaGFtcHVyIG9uIDYvMjMvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3MnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3Jrcy5kZXRhaWxzLnN0YXRzJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9zdGF0cycsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ05ldHdvcmtTdGF0c0N0cmwgYXMgbmV0d29ya1N0YXRzQ3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3Jrcy9uZXR3b3Jrc3RhdHMuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTmV0d29ya1N0YXRzQ3RybCcsXG4gICAgICAgIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnTmV0d29ya3NNb2RlbCcsICdJbnNwZWN0U2VydmljZScsXG4gICAgICAgICAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBOZXR3b3Jrc01vZGVsLCBJbnNwZWN0U2VydmljZSkge1xuXG4gICAgICAgICAgICAgICAgdmFyIG5ldHdvcmtTdGF0c0N0cmwgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgLyogR2V0cyB0aGUgTmV0d29yayBPcGVyYXRpb25hbCBzdGF0ZSBmcm9tIHRoZSBzZXJ2ZXIgKi9cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZXROZXR3b3JrSW5zcGVjdChyZWZyZXNoKXtcbiAgICAgICAgICAgICAgICAgICAgTmV0d29ya3NNb2RlbC5nZXRJbnNwZWN0QnlLZXkoJHN0YXRlUGFyYW1zLmtleSwgQ29udGl2R2xvYmFscy5ORVRXT1JLU19JTlNQRUNUX0VORFBPSU5ULCByZWZyZXNoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldHdvcmtTdGF0c0N0cmwubmV0d29ya0luc3BlY3RTdGF0cyA9IHJlc3VsdC5PcGVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldHdvcmtTdGF0c0N0cmwuY29uZmlnID0gcmVzdWx0LkNvbmZpZztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihyZXN1bHQuT3Blci5lbmRwb2ludHMhPXVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250YWluZXJEZXRhaWxzID0gSW5zcGVjdFNlcnZpY2UuYnVpbGRFbmRQb2ludHMocmVzdWx0Lk9wZXIuZW5kcG9pbnRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoSW5zcGVjdFNlcnZpY2UuY2hlY2tDb250YWluZXJDaGFuZ2VkKG5ldHdvcmtTdGF0c0N0cmwuY29udGFpbmVyRGV0YWlscyxjb250YWluZXJEZXRhaWxzKSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXR3b3JrU3RhdHNDdHJsLmVuZHBvaW50cyA9IHJlc3VsdC5PcGVyLmVuZHBvaW50cztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldHdvcmtTdGF0c0N0cmwuY29udGFpbmVyRGV0YWlscyA9IGNvbnRhaW5lckRldGFpbHM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV0d29ya1N0YXRzQ3RybC5lbmRwb2ludHMgPSBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXR3b3JrU3RhdHNDdHJsLmNvbnRhaW5lckRldGFpbHMgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBnZXROZXR3b3JrSW5zcGVjdChmYWxzZSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgICAgICAgICAgLy9Eb24ndCBkbyBhdXRvcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICAgICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBnZXROZXR3b3JrSW5zcGVjdCh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XSk7IiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmZhY3RvcnkoJ0JncFNlcnZpY2UnLCBbJyRodHRwJywgJyRxJywgZnVuY3Rpb24gKCRodHRwLCAkcSkge1xuXG4gICAgICAgIGZ1bmN0aW9uIGdldEJncChjdHJsKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuQkdQU19FTkRQT0lOVCArIGN0cmwua2V5ICsgJy8nO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgY3RybC5uZWlnaGJvciA9IHJlc3VsdC5kYXRhO1xuICAgICAgICAgICAgICAgIGN0cmwubmVpZ2hib3JzLnB1c2goeyduYW1lJzogY3RybC5uZWlnaGJvclsnbmVpZ2hib3InXSwgJ3ZhbHVlJzogY3RybC5uZWlnaGJvclsnbmVpZ2hib3ItYXMnXX0pO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUJncChjdHJsKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5CR1BTX0VORFBPSU5UICsgY3RybC5rZXkgKyAnLyc7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCh1cmwsIGN0cmwubmVpZ2hib3IpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGZ1bmN0aW9uIGdldEJncEluc3BlY3Qoa2V5KSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuQkdQU19JTlNQRUNUX0VORFBPSU5UICsga2V5ICsgJy8nO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRCZ3A6IGdldEJncCxcbiAgICAgICAgICAgIHVwZGF0ZUJncDogdXBkYXRlQmdwLFxuICAgICAgICAgICAgZ2V0QmdwSW5zcGVjdDogZ2V0QmdwSW5zcGVjdFxuICAgICAgICB9XG4gICAgfV0pOyIsImFuZ3VsYXIubW9kdWxlKFwiY29udGl2Lm5vZGVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dkxvZ3NcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbG9ncy5odG1sJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgbG9nOiBcIj1cIixcbiAgICAgICAgICAgICAgICB0aXRsZTogXCJAXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTsiLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJylcbiAgICAuZmFjdG9yeSgnTG9nU2VydmljZScsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbiAoJGh0dHAsICRxKSB7XG4gICAgICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUxvZ3MoKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuTk9ERVNfQUNUSVZFX0pPQl9FTkRQT0lOVDtcbiAgICAgICAgICAgICRodHRwLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldExhc3RMb2dzKCkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLk5PREVTX0xBU1RfSk9CX0VORFBPSU5UO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldEFjdGl2ZUxvZ3M6IGdldEFjdGl2ZUxvZ3MsXG4gICAgICAgICAgICBnZXRMYXN0TG9nczogZ2V0TGFzdExvZ3NcbiAgICAgICAgfVxuICAgIH1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMuYWN0aXZlbG9nJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9hY3RpdmVsb2cnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlQWN0aXZlSm9iTG9nc0N0cmwgYXMgbm9kZUFjdGl2ZUpvYkxvZ3NDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogJzxjdHYtbG9ncyB0aXRsZT1cIkFjdGl2ZSBKb2JcIiBsb2c9XCJub2RlQWN0aXZlSm9iTG9nc0N0cmwuYWN0aXZlTG9nc1wiPjwvY3R2LWxvZ3M+J1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOb2RlQWN0aXZlSm9iTG9nc0N0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnTG9nU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc2NvcGUsICRpbnRlcnZhbCwgTG9nU2VydmljZSkge1xuICAgICAgICB2YXIgbm9kZUFjdGl2ZUpvYkxvZ3NDdHJsID0gdGhpcztcblxuICAgICAgICBmdW5jdGlvbiBnZXRBY3RpdmVMb2dzKCkge1xuICAgICAgICAgICAgTG9nU2VydmljZS5nZXRBY3RpdmVMb2dzKCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgbm9kZUFjdGl2ZUpvYkxvZ3NDdHJsLmFjdGl2ZUxvZ3MgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vT25jZSB0aGUgam9iIGZpbmlzaGVzLCBlbmRwb2ludCByZXR1cm5zIDUwMCBlcnJvci4gU28gcmVzZXQgdGhlIGFjdGl2ZUxvZ3NcbiAgICAgICAgICAgICAgICBub2RlQWN0aXZlSm9iTG9nc0N0cmwuYWN0aXZlTG9ncyA9IHtcbiAgICAgICAgICAgICAgICAgICAgZGVzYzogJ1RoZXJlIGlzIGN1cnJlbnRseSBubyBhY3RpdmUgam9iLiBDaGVjayBMYXN0IEpvYiBmb3IgYSBqb2IgdGhhdCByZWNlbnRseSBmaW5pc2hlZC4nXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGdldEFjdGl2ZUxvZ3MoKTtcblxuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0QWN0aXZlTG9ncygpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pOyIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8yNS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmNvbW1pc3Npb24nLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2NvbW1pc3Npb24vOmtleScsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVDb21taXNzaW9uQ3RybCBhcyBub2RlQ29tbWlzc2lvbkN0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWNvbW1pc3Npb24uaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTm9kZUNvbW1pc3Npb25DdHJsJywgW1xuICAgICAgICAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdOb2Rlc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJywgJ05vZGVzU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgTm9kZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UsIE5vZGVzU2VydmljZSkge1xuICAgICAgICAgICAgdmFyIG5vZGVDb21taXNzaW9uQ3RybCA9IHRoaXM7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHJldHVyblRvTm9kZURldGFpbHMoKSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLmluZm8nLCB7J2tleSc6ICRzdGF0ZVBhcmFtcy5rZXl9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ29tbWlzc2lvbmluZ05vZGUoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9Ob2RlRGV0YWlscygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBjb21taXNzaW9uKCkge1xuICAgICAgICAgICAgICAgIGlmIChub2RlQ29tbWlzc2lvbkN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVDb21taXNzaW9uQ3RybC5ub2RlT3BzT2JqLm5vZGVzID0gWyRzdGF0ZVBhcmFtcy5rZXldO1xuICAgICAgICAgICAgICAgICAgICBOb2Rlc1NlcnZpY2UuY2xlYW51cEV4dHJhVmFycyhub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBOb2Rlc1NlcnZpY2UuY3JlYXRlRXh0cmFWYXJzKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIE5vZGVzTW9kZWwuY29tbWlzc2lvbihub2RlQ29tbWlzc2lvbkN0cmwubm9kZU9wc09iaikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub05vZGVEZXRhaWxzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Iobm9kZUNvbW1pc3Npb25DdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG5vZGVDb21taXNzaW9uQ3RybC5ub2RlT3BzT2JqID0ge307XG4gICAgICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuZXh0cmFfdmFycyA9IHt9OyAvL1RPRE8gSW50aWFsaXplIGZyb20gZ2xvYmFsIHNldHRpbmdzXG4gICAgICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuYW5zaWJsZVZhcmlhYmxlcyA9IFtdO1xuICAgICAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLmVudlZhcmlhYmxlcyA9IFtdO1xuXG4gICAgICAgICAgICBOb2Rlc1NlcnZpY2UuZ2V0U2V0dGluZ3Mobm9kZUNvbW1pc3Npb25DdHJsKTtcblxuICAgICAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLmNhbmNlbENvbW1pc3Npb25pbmdOb2RlID0gY2FuY2VsQ29tbWlzc2lvbmluZ05vZGU7XG4gICAgICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuY29tbWlzc2lvbiA9IGNvbW1pc3Npb247XG5cbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobm9kZUNvbW1pc3Npb25DdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgICAgICB9XSk7XG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMjUvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGV0YWlsc0N0cmwgYXMgbm9kZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVkZXRhaWxzLmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLmluZm8nLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2luZm8nLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGV0YWlsc0N0cmwgYXMgbm9kZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVpbmZvLmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLnN0YXRzJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9zdGF0cycsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVEZXRhaWxzQ3RybCBhcyBub2RlRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZXN0YXRzLmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLmxvZ3MnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2xvZ3MnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGV0YWlsc0N0cmwgYXMgbm9kZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVsb2dzLmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLmVkaXQnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2VkaXQnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGV0YWlsc0N0cmwgYXMgbm9kZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVpbmZvLmh0bWwnXG4gICAgICAgICAgICB9KTtcblxuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOb2RlRGV0YWlsc0N0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnJHNjb3BlJywgJyRpbnRlcnZhbCcsICdOb2Rlc01vZGVsJywgJ0JncFNlcnZpY2UnLFxuICAgICAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRzY29wZSwgJGludGVydmFsLCBOb2Rlc01vZGVsLCBCZ3BTZXJ2aWNlKSB7XG4gICAgICAgICAgICB2YXIgbm9kZURldGFpbHNDdHJsID0gdGhpcztcbiAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5udW1iZXJwYXR0ZXJuID0gQ29udGl2R2xvYmFscy5OVU1CRVJfUkVHRVg7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGRlY29tbWlzc2lvbigpIHtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZU9wc09iaiA9IHtcbiAgICAgICAgICAgICAgICAgIG5vZGVzOiBbJHN0YXRlUGFyYW1zLmtleV1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIE5vZGVzTW9kZWwuZGVjb21taXNzaW9uKG5vZGVPcHNPYmopLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAvL0Rpc2FibGUgYWxsIGJ1dHRvbnMgaW5pdGlhbGx5LiBQb2xsIHdpbGwgYXNzaWduIHZhbHVlcyBhcHByb3ByaWF0ZWx5LlxuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiB1cGdyYWRlKCkge1xuICAgICAgICAgICAgICAgIHZhciBub2RlT3BzT2JqID0ge1xuICAgICAgICAgICAgICAgICAgICBub2RlczogWyRzdGF0ZVBhcmFtcy5rZXldXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBOb2Rlc01vZGVsLnVwZ3JhZGUobm9kZU9wc09iaikudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vRGlzYWJsZSBhbGwgYnV0dG9ucyBpbml0aWFsbHkuIFBvbGwgd2lsbCBhc3NpZ24gdmFsdWVzIGFwcHJvcHJpYXRlbHkuXG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogRGlzcGxheSBidXR0b25zIGJhc2VkIG9uIHN0YXR1cyBvZiBub2RlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZ1bmN0aW9uIHNldEJ1dHRvbkRpc3BsYXkoKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChub2RlRGV0YWlsc0N0cmwubm9kZVsnaW52ZW50b3J5X3N0YXRlJ10uc3RhdHVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ1VuYWxsb2NhdGVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnRGVjb21taXNzaW9uZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdQcm92aXNpb25pbmcnOlxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnQWxsb2NhdGVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnQ2FuY2VsbGVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdNYWludGVuYW5jZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0Oi8vQ2x1c3RlciBzaG91bGQgbm90IGJlIGluIHRoaXMgc3RhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXROb2RlSW5mbyhyZWxvYWQpIHtcbiAgICAgICAgICAgICAgICBOb2Rlc01vZGVsLmdldE1vZGVsQnlLZXkoJHN0YXRlUGFyYW1zLmtleSwgcmVsb2FkKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm5vZGUgPSBub2RlO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0QnV0dG9uRGlzcGxheSgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gc2V0TW9kZSgpIHtcbiAgICAgICAgICAgICAgICBpZiAoJHN0YXRlLmlzKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLmVkaXQnKSkge1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubW9kZSA9ICdlZGl0JztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubW9kZSA9ICdkZXRhaWxzJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHJldHVyblRvSW5mbygpIHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMuaW5mbycpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiB1cGRhdGVCZ3BJbmZvKCkge1xuICAgICAgICAgICAgICAgIGlmIChub2RlRGV0YWlsc0N0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm5laWdoYm9yLmtleSA9ICRzdGF0ZVBhcmFtcy5rZXk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gYmFja2VuZCBvbmx5IHN1cHBvcnRzIGFkZGluZyBvbmUgbmVpZ2hib3IgY3VycmVudGx5XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvcnMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm5laWdoYm9yWyduZWlnaGJvciddID0gaXRlbS5uYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm5laWdoYm9yWyduZWlnaGJvci1hcyddID0gaXRlbS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgQmdwU2VydmljZS51cGRhdGVCZ3Aobm9kZURldGFpbHNDdHJsKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvciA9IHJlc3VsdC5jb25maWcuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblRvSW5mbygpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0QmdwSW5mbygpIHtcbiAgICAgICAgICAgICAgICBCZ3BTZXJ2aWNlLmdldEJncChub2RlRGV0YWlsc0N0cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3IgPSByZXN1bHQ7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0QmdwSW5zcGVjdCgpIHtcbiAgICAgICAgICAgICAgICBCZ3BTZXJ2aWNlLmdldEJncEluc3BlY3QoJHN0YXRlUGFyYW1zLmtleSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5pbnNwZWN0ID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwucm91dGVzID0gcmVzdWx0Lk9wZXIucm91dGVzO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuZmlsdGVyZWRyb3V0ZXMgPSByZXN1bHQuT3Blci5yb3V0ZXM7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmRlY29tbWlzc2lvbiA9IGRlY29tbWlzc2lvbjtcbiAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlID0gdXBncmFkZTtcblxuICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNldE1vZGUgPSBzZXRNb2RlO1xuICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZGF0ZUJncEluZm8gPSB1cGRhdGVCZ3BJbmZvO1xuICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnJldHVyblRvSW5mbyA9IHJldHVyblRvSW5mbztcbiAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvcnMgPSBbXTtcbiAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvciA9IHt9O1xuICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmtleSA9ICRzdGF0ZVBhcmFtcy5rZXk7XG4gICAgICAgICAgICBnZXRCZ3BJbmZvKCk7XG4gICAgICAgICAgICBnZXRCZ3BJbnNwZWN0KCk7XG4gICAgICAgICAgICBzZXRNb2RlKCk7XG5cbiAgICAgICAgICAgIC8vTG9hZCBmcm9tIGNhY2hlIGZvciBxdWljayBkaXNwbGF5IGluaXRpYWxseVxuICAgICAgICAgICAgZ2V0Tm9kZUluZm8oZmFsc2UpO1xuXG4gICAgICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgICAgIC8vRG9uJ3QgZG8gYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGdldE5vZGVJbmZvKHRydWUpO1xuICAgICAgICAgICAgICAgIH0sIDUwMDApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1dKTsiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDYvMTQvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2Lm5vZGVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dk5vZGVzdGF0dXNcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBub2RlOiAnPSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVzdGF0dXMuaHRtbCdcbiAgICAgICAgfVxuICAgIH0pXG4gICAgLmRpcmVjdGl2ZShcImN0dk5vZGVzdGF0ZVwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIG5vZGU6ICc9J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZXN0YXRlLmh0bWwnXG4gICAgICAgIH1cbiAgICB9KTsiLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMuZGlzY292ZXInLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2Rpc2NvdmVyJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZURpc2NvdmVyQ3RybCBhcyBub2RlRGlzY292ZXJDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVkaXNjb3Zlci5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOb2RlRGlzY292ZXJDdHJsJywgW1xuICAgICAgICAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdOb2Rlc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJywgJ05vZGVzU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgTm9kZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UsIE5vZGVzU2VydmljZSkge1xuICAgICAgICAgICAgdmFyIG5vZGVEaXNjb3ZlckN0cmwgPSB0aGlzO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub05vZGVzKCkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubm9kZXMubGlzdCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBjYW5jZWxEaXNjb3ZlcmluZ05vZGUoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9Ob2RlcygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBkaXNjb3ZlcigpIHtcbiAgICAgICAgICAgICAgICBpZiAobm9kZURpc2NvdmVyQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBjcmVhdGVJUEFkZHJBcnJheSgpO1xuICAgICAgICAgICAgICAgICAgICBOb2Rlc1NlcnZpY2UuY3JlYXRlRXh0cmFWYXJzKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBOb2Rlc01vZGVsLmRpc2NvdmVyKG5vZGVEaXNjb3ZlckN0cmwubm9kZU9wc09iaikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9Ob2RlcygpO1xuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihub2RlRGlzY292ZXJDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihub2RlRGlzY292ZXJDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUlQQWRkckFycmF5KCkge1xuICAgICAgICAgICAgICAgIG5vZGVEaXNjb3ZlckN0cmwubm9kZU9wc09iai5hZGRycyA9IF8ud29yZHMobm9kZURpc2NvdmVyQ3RybC5ub2RlSVBBZGRyLCAvW14sIF0rL2cpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBub2RlRGlzY292ZXJDdHJsLm5vZGVPcHNPYmogPSB7fTtcbiAgICAgICAgICAgIG5vZGVEaXNjb3ZlckN0cmwuZXh0cmFfdmFycyA9IHt9OyAvL1RPRE8gSW50aWFsaXplIGZyb20gZ2xvYmFsIHNldHRpbmdzXG4gICAgICAgICAgICBub2RlRGlzY292ZXJDdHJsLmFuc2libGVWYXJpYWJsZXMgPSBbXTtcbiAgICAgICAgICAgIG5vZGVEaXNjb3ZlckN0cmwuZW52VmFyaWFibGVzID0gW107XG4gICAgICAgICAgICBub2RlRGlzY292ZXJDdHJsLm5vZGVJUEFkZHIgPSAnJzsgLy9JUCBhZGRyZXNzIG9mIG5vZGVzIHRvIGRpc2NvdmVyXG5cbiAgICAgICAgICAgIE5vZGVzU2VydmljZS5nZXRTZXR0aW5ncyhub2RlRGlzY292ZXJDdHJsKTtcblxuICAgICAgICAgICAgbm9kZURpc2NvdmVyQ3RybC5kaXNjb3ZlciA9IGRpc2NvdmVyO1xuICAgICAgICAgICAgbm9kZURpc2NvdmVyQ3RybC5jYW5jZWxEaXNjb3ZlcmluZ05vZGUgPSBjYW5jZWxEaXNjb3ZlcmluZ05vZGU7XG5cbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgICAgIH1dKTtcbiIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5sYXN0bG9nJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9sYXN0bG9nJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZUxhc3RKb2JMb2dzQ3RybCBhcyBub2RlTGFzdEpvYkxvZ3NDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogJzxjdHYtbG9ncyB0aXRsZT1cIkxhc3QgSm9iXCIgbG9nPVwibm9kZUxhc3RKb2JMb2dzQ3RybC5sYXN0TG9nc1wiPjwvY3R2LWxvZ3M+J1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOb2RlTGFzdEpvYkxvZ3NDdHJsJywgWyckc2NvcGUnLCAnJGludGVydmFsJywgJ0xvZ1NlcnZpY2UnLFxuICAgICAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsIExvZ1NlcnZpY2UpIHtcbiAgICAgICAgdmFyIG5vZGVMYXN0Sm9iTG9nc0N0cmwgPSB0aGlzO1xuXG4gICAgICAgIGZ1bmN0aW9uIGdldExhc3RMb2dzKCkge1xuICAgICAgICAgICAgTG9nU2VydmljZS5nZXRMYXN0TG9ncygpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIG5vZGVMYXN0Sm9iTG9nc0N0cmwubGFzdExvZ3MgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZ2V0TGFzdExvZ3MoKTtcblxuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0TGFzdExvZ3MoKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTsiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMjIvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5saXN0Jywge1xuICAgICAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZUxpc3RDdHJsIGFzIG5vZGVMaXN0Q3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2RlbGlzdC5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOb2RlTGlzdEN0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdOb2Rlc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICAgICAgZnVuY3Rpb24gKCRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBOb2Rlc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgbm9kZUxpc3RDdHJsID0gdGhpcztcblxuICAgICAgICBmdW5jdGlvbiBnZXROb2RlcyhyZWxvYWQpIHtcbiAgICAgICAgICAgIE5vZGVzTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobm9kZUxpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZUxpc3RDdHJsLm5vZGVzID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobm9kZUxpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vTG9hZCBmcm9tIGNhY2hlIGZvciBxdWljayBkaXNwbGF5IGluaXRpYWxseVxuICAgICAgICBnZXROb2RlcyhmYWxzZSk7XG5cbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldE5vZGVzKHRydWUpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pOyIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYub3JnYW5pemF0aW9ucycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMuY3JlYXRlJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnb3JnYW5pemF0aW9ucy9vcmdhbml6YXRpb25jcmVhdGUuaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ09yZ2FuaXphdGlvbkNyZWF0ZUN0cmwgYXMgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignT3JnYW5pemF0aW9uQ3JlYXRlQ3RybCcsIFsnJHN0YXRlJywgJ09yZ2FuaXphdGlvbnNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsIE9yZ2FuaXphdGlvbnNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgICAgIHZhciBvcmdhbml6YXRpb25DcmVhdGVDdHJsID0gdGhpcztcblxuICAgICAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Pcmdhbml6YXRpb25zKCkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5saXN0Jyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNhbmNlbENyZWF0aW5nKCkge1xuICAgICAgICAgICAgICAgIHJldHVyblRvT3JnYW5pemF0aW9ucygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBjcmVhdGVPcmdhbml6YXRpb24oKSB7XG4gICAgICAgICAgICAgICAgLy9mb3JtIGNvbnRyb2xsZXIgaXMgaW5qZWN0ZWQgYnkgdGhlIGh0bWwgdGVtcGxhdGVcbiAgICAgICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgICAgIGlmIChvcmdhbml6YXRpb25DcmVhdGVDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25DcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwubmV3T3JnYW5pemF0aW9uLmtleSA9IG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwubmV3T3JnYW5pemF0aW9uLnRlbmFudE5hbWU7IFxuICAgICAgICAgICAgICAgICAgICBPcmdhbml6YXRpb25zTW9kZWwuY3JlYXRlKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwubmV3T3JnYW5pemF0aW9uKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub09yZ2FuaXphdGlvbnMoKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Iob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiByZXNldEZvcm0oKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25DcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybC5uZXdPcmdhbml6YXRpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIHRlbmFudE5hbWU6ICcnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybC5jcmVhdGVPcmdhbml6YXRpb24gPSBjcmVhdGVPcmdhbml6YXRpb247XG4gICAgICAgICAgICBvcmdhbml6YXRpb25DcmVhdGVDdHJsLmNhbmNlbENyZWF0aW5nID0gY2FuY2VsQ3JlYXRpbmc7XG5cbiAgICAgICAgICAgIHJlc2V0Rm9ybSgpO1xuICAgICAgICB9XSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2Lm9yZ2FuaXphdGlvbnMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5vcmdhbml6YXRpb25zLmRldGFpbHMnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ09yZ2FuaXphdGlvbkRldGFpbHNDdHJsIGFzIG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ29yZ2FuaXphdGlvbnMvb3JnYW5pemF0aW9uZGV0YWlscy5odG1sJ1xuICAgICAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ09yZ2FuaXphdGlvbkRldGFpbHNDdHJsJyxcbiAgICAgICAgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ09yZ2FuaXphdGlvbnNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgICAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIE9yZ2FuaXphdGlvbnNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgb3JnYW5pemF0aW9uRGV0YWlsc0N0cmwgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Pcmdhbml6YXRpb25zKCkge1xuICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMubGlzdCcpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGRlbGV0ZU9yZ2FuaXphdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBPcmdhbml6YXRpb25zTW9kZWwuZGVsZXRlKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsLm9yZ2FuaXphdGlvbikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblRvT3JnYW5pemF0aW9ucygpO1xuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Iob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG5cbiAgICAgICAgICAgICAgICBPcmdhbml6YXRpb25zTW9kZWwuZ2V0TW9kZWxCeUtleSgkc3RhdGVQYXJhbXMua2V5KVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAob3JnYW5pemF0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcmdhbml6YXRpb25EZXRhaWxzQ3RybC5vcmdhbml6YXRpb24gPSBvcmdhbml6YXRpb247XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgb3JnYW5pemF0aW9uRGV0YWlsc0N0cmwuZGVsZXRlT3JnYW5pemF0aW9uID0gZGVsZXRlT3JnYW5pemF0aW9uO1xuICAgICAgICAgICAgfV0pOyIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYub3JnYW5pemF0aW9ucycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMubGlzdCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ09yZ2FuaXphdGlvbnNMaXN0Q3RybCBhcyBvcmdhbml6YXRpb25zTGlzdEN0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnb3JnYW5pemF0aW9ucy9vcmdhbml6YXRpb25saXN0Lmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICA7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ09yZ2FuaXphdGlvbnNMaXN0Q3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ09yZ2FuaXphdGlvbnNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgT3JnYW5pemF0aW9uc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICAgICAgdmFyIG9yZ2FuaXphdGlvbnNMaXN0Q3RybCA9IHRoaXM7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldE9yZ2FuaXphdGlvbnMocmVsb2FkKSB7XG4gICAgICAgICAgICAgICAgT3JnYW5pemF0aW9uc01vZGVsLmdldChyZWxvYWQpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG9yZ2FuaXphdGlvbnNMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JnYW5pemF0aW9uc0xpc3RDdHJsLm9yZ2FuaXphdGlvbnMgPSByZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG9yZ2FuaXphdGlvbnNMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgICAgICBnZXRPcmdhbml6YXRpb25zKGZhbHNlKTtcblxuICAgICAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgICAgICAvL0Rvbid0IGRvIGF1dG9yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGdldE9yZ2FuaXphdGlvbnModHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XSk7IiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzEyLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnNlcnZpY2VsYnMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmNyZWF0ZScsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NlcnZpY2VfbGJzL3NlcnZpY2VsYmNyZWF0ZS5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnU2VydmljZWxiQ3JlYXRlQ3RybCBhcyBzZXJ2aWNlbGJDcmVhdGVDdHJsJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdTZXJ2aWNlbGJDcmVhdGVDdHJsJywgW1xuICAgICAgICAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdTZXJ2aWNlbGJzTW9kZWwnLCAnTmV0d29ya3NNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgU2VydmljZWxic01vZGVsLCBOZXR3b3Jrc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICAgICAgdmFyIHNlcnZpY2VsYkNyZWF0ZUN0cmwgPSB0aGlzO1xuICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5sYWJlbFNlbGVjdG9ycyA9IFtdO1xuICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5uZXR3b3JrcyA9IFtdO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1NlcnZpY2VsYnMoKSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmxpc3QnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9TZXJ2aWNlbGJzKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogR2V0IG5ldHdvcmtzIGZvciB0aGUgZ2l2ZW4gdGVuYW50LlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXROZXR3b3JrcygpIHtcbiAgICAgICAgICAgICAgICBOZXR3b3Jrc01vZGVsLmdldCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLm5ldHdvcmtzID0gXy5maWx0ZXIocmVzdWx0LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAndGVuYW50TmFtZSc6ICdkZWZhdWx0Jy8vVE9ETzogUmVtb3ZlIGhhcmRjb2RlZCB0ZW5hbnQuXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBjcmVhdGVMYWJlbFNlbGVjdG9yU3RyaW5ncygpIHtcbiAgICAgICAgICAgICAgICAvL0VtcHR5IG91dCB0aGUgc2VsZWN0b3JzLiBJbiBjYXNlIG9mIHNlcnZlciBlcnJvcnMgdGhpcyBuZWVkcyB0byBiZSByZXNldC5cbiAgICAgICAgICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLnNlcnZpY2VsYi5zZWxlY3RvcnMgPSBbXTtcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goc2VydmljZWxiQ3JlYXRlQ3RybC5sYWJlbFNlbGVjdG9ycywgZnVuY3Rpb24obGFiZWxTZWxlY3Rvcikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0b3JTdHJpbmcgPSBsYWJlbFNlbGVjdG9yLm5hbWUgKyAnPScgKyBsYWJlbFNlbGVjdG9yLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLnNlcnZpY2VsYi5zZWxlY3RvcnMucHVzaChzZWxlY3RvclN0cmluZyk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNyZWF0ZVNlcnZpY2VsYigpIHtcbiAgICAgICAgICAgICAgICBjcmVhdGVMYWJlbFNlbGVjdG9yU3RyaW5ncygpO1xuICAgICAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAgICAgLy9jaGVja2luZyBpZiBhbGwgdmFsaWRhdGlvbnMgaGF2ZSBwYXNzZWRcbiAgICAgICAgICAgICAgICBpZiAoc2VydmljZWxiQ3JlYXRlQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc2VydmljZWxiQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKHNlcnZpY2VsYkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLnNlcnZpY2VsYi5rZXkgPVxuICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIudGVuYW50TmFtZSArICc6JyArIHNlcnZpY2VsYkNyZWF0ZUN0cmwuc2VydmljZWxiLnNlcnZpY2VOYW1lO1xuICAgICAgICAgICAgICAgICAgICBTZXJ2aWNlbGJzTW9kZWwuY3JlYXRlKHNlcnZpY2VsYkNyZWF0ZUN0cmwuc2VydmljZWxiKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc2VydmljZWxiQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1NlcnZpY2VsYnMoKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc2VydmljZWxiQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Ioc2VydmljZWxiQ3JlYXRlQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlc2V0Rm9ybSgpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzZXJ2aWNlbGJDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLnNlcnZpY2VsYiA9IHtcbiAgICAgICAgICAgICAgICAgICAgc2VydmljZU5hbWU6ICcnLFxuICAgICAgICAgICAgICAgICAgICBuZXR3b3JrTmFtZTogJycsXG4gICAgICAgICAgICAgICAgICAgIGlwQWRkcmVzczogJycsXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdG9yczogW10sXG4gICAgICAgICAgICAgICAgICAgIHBvcnRzOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgdGVuYW50TmFtZTogJ2RlZmF1bHQnLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5jcmVhdGVTZXJ2aWNlbGIgPSBjcmVhdGVTZXJ2aWNlbGI7XG4gICAgICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLmNhbmNlbENyZWF0aW5nID0gY2FuY2VsQ3JlYXRpbmc7XG5cbiAgICAgICAgICAgIGdldE5ldHdvcmtzKCk7XG4gICAgICAgICAgICByZXNldEZvcm0oKTtcbiAgICAgICAgfV0pO1xuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzExLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnNlcnZpY2VsYnMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICAgICAgcGFyYW1zOiB7c3RhdGU6bnVsbH0sICAgICAgIC8vIFRvIHJlbG9hZCBwYXJlbnQgdmlldyBcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnU2VydmljZWxiRGV0YWlsc0N0cmwgYXMgc2VydmljZWxiRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2VydmljZV9sYnMvc2VydmljZWxiZGV0YWlscy5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2VydmljZWxicy5kZXRhaWxzLmluZm8nLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2luZm8nLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTZXJ2aWNlbGJEZXRhaWxzQ3RybCBhcyBzZXJ2aWNlbGJEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXJ2aWNlX2xicy9zZXJ2aWNlbGJpbmZvLmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmRldGFpbHMuZWRpdCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvZWRpdC86a2V5JyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnU2VydmljZWxiRGV0YWlsc0N0cmwgYXMgc2VydmljZWxiRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2VydmljZV9sYnMvc2VydmljZWxiaW5mby5odG1sJ1xuICAgICAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1NlcnZpY2VsYkRldGFpbHNDdHJsJyxcbiAgICAgICAgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ1NlcnZpY2VsYnNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgICAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIFNlcnZpY2VsYnNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2VydmljZWxiRGV0YWlsc0N0cmwgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHNlcnZpY2VsYkRldGFpbHNDdHJsLmxhYmVsU2VsZWN0b3JzID0gW107XG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBUbyBzaG93IGVkaXQgb3IgZGV0YWlscyBzY3JlZW4gYmFzZWQgb24gdGhlIHJvdXRlXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gc2V0TW9kZSgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzdGF0ZS5pcygnY29udGl2Lm1lbnUuc2VydmljZWxicy5kZXRhaWxzLmVkaXQnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwubW9kZSA9ICdlZGl0JztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2VsYkRldGFpbHNDdHJsLm1vZGUgPSAnZGV0YWlscyc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1NlcnZpY2VsYnMoKSB7XG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuc2VydmljZWxicy5saXN0Jyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9TZXJ2aWNlbGJEZXRhaWxzKCkge1xuICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMuZGV0YWlscy5pbmZvJywgeydrZXknOiBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIua2V5LCdzdGF0ZSc6J2RldGFpbHMnfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gY2FuY2VsRWRpdGluZygpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9TZXJ2aWNlbGJEZXRhaWxzKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZGVsZXRlU2VydmljZWxiKCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIFNlcnZpY2VsYnNNb2RlbC5kZWxldGUoc2VydmljZWxiRGV0YWlsc0N0cmwuc2VydmljZWxiKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9TZXJ2aWNlbGJzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gc2F2ZVNlcnZpY2VsYigpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHNlcnZpY2VsYkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXhpc3RpbmdMYWJlbHMgPSBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIuc2VsZWN0b3JzO1xuICAgICAgICAgICAgICAgICAgICBjcmVhdGVMYWJlbFNlbGVjdG9yU3RyaW5ncygpO1xuICAgICAgICAgICAgICAgICAgICBTZXJ2aWNlbGJzTW9kZWwuc2F2ZShzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1NlcnZpY2VsYkRldGFpbHMoKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2VsYkRldGFpbHNDdHJsLnNlcnZpY2VsYi5zZWxlY3RvcnMgPSBleGlzdGluZ0xhYmVscztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZUxhYmVsU2VsZWN0b3JzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gY3JlYXRlTGFiZWxTZWxlY3RvcnMoKSB7XG4gICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIuc2VsZWN0b3JzLCBmdW5jdGlvbihzZWxlY3RvclN0cikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGVjdG9yID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHNlbGVjdG9yU3RyLnNwbGl0KCc9JylbMF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHNlbGVjdG9yU3RyLnNwbGl0KCc9JylbMV1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5sYWJlbFNlbGVjdG9ycy5wdXNoKHNlbGVjdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gY3JlYXRlTGFiZWxTZWxlY3RvclN0cmluZ3MoKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlcnZpY2VsYkRldGFpbHNDdHJsLnNlcnZpY2VsYi5zZWxlY3RvcnMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHNlcnZpY2VsYkRldGFpbHNDdHJsLmxhYmVsU2VsZWN0b3JzLCBmdW5jdGlvbihsYWJlbFNlbGVjdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0b3JTdHJpbmcgPSBsYWJlbFNlbGVjdG9yLm5hbWUgKyAnPScgKyBsYWJlbFNlbGVjdG9yLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwuc2VydmljZWxiLnNlbGVjdG9ycy5wdXNoKHNlbGVjdG9yU3RyaW5nKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuXG4gICAgICAgICAgICAgICAgU2VydmljZWxic01vZGVsLmdldE1vZGVsQnlLZXkoJHN0YXRlUGFyYW1zLmtleSlcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHNlcnZpY2VsYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwuc2VydmljZWxiID0gc2VydmljZWxiO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlTGFiZWxTZWxlY3RvcnMoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zYXZlU2VydmljZWxiID0gc2F2ZVNlcnZpY2VsYjtcbiAgICAgICAgICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5jYW5jZWxFZGl0aW5nID0gY2FuY2VsRWRpdGluZztcbiAgICAgICAgICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5kZWxldGVTZXJ2aWNlbGIgPSBkZWxldGVTZXJ2aWNlbGI7XG4gICAgICAgICAgICAgICAgc2V0TW9kZSgpO1xuXG4gICAgICAgICAgICB9XSk7XG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTEvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc2VydmljZWxicycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMubGlzdCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1NlcnZpY2VsYkxpc3RDdHJsIGFzIHNlcnZpY2VsYkxpc3RDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NlcnZpY2VfbGJzL3NlcnZpY2VsYmxpc3QuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignU2VydmljZWxiTGlzdEN0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdTZXJ2aWNlbGJzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgICAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIFNlcnZpY2VsYnNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgICAgIHZhciBzZXJ2aWNlbGJMaXN0Q3RybCA9IHRoaXM7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldFNlcnZpY2VsYnMocmVsb2FkKSB7XG4gICAgICAgICAgICAgICAgU2VydmljZWxic01vZGVsLmdldChyZWxvYWQpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkxpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlbGJMaXN0Q3RybC5zZXJ2aWNlbGJzID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzZXJ2aWNlbGJMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgICAgICBnZXRTZXJ2aWNlbGJzKGZhbHNlKTtcblxuICAgICAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgICAgICAvL0Rvbid0IGRvIGF1dG9yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGdldFNlcnZpY2VsYnModHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XSk7XG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTMvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LnNlcnZpY2VsYnNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2U2VydmljZWxicG9ydHNcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICBpdGVtczogJz0nXG4gICAgICAgICAgIH0sXG4gICAgICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlKSB7XG4gICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIENvbXBhcmUgaWYgdHdvIGl0ZW1zIGhhdmUgc2FtZSBwb3J0cyBhbmQgcHJvdG9jb2xzXG4gICAgICAgICAgICAgICAgKiBAcGFyYW0gdmFsMVxuICAgICAgICAgICAgICAgICogQHBhcmFtIHZhbDJcbiAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICBmdW5jdGlvbiBjb21wYXJlKHZhbDEsIHZhbDIpIHtcbiAgICAgICAgICAgICAgICAgICByZXR1cm4gKHZhbDEgPT09IHZhbDIpO1xuICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICBmdW5jdGlvbiByZXNldE5ld0l0ZW0oKSB7XG4gICAgICAgICAgICAgICAgICAgc2NvcGUubmV3SXRlbSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZVBvcnQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlclBvcnQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICBwcm90b2NvbDogJydcbiAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICBmdW5jdGlvbiBpc0VtcHR5SXRlbShpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgcmV0dXJuIChpdGVtLnNlcnZpY2VQb3J0ID09PSAnJyAmJiBpdGVtLnByb3ZpZGVyUG9ydCA9PT0gJycgJiYgaXRlbS5wcm90b2NvbCA9PT0gJycpO1xuICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICBzY29wZS5hZGQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICBpZiAoaXNFbXB0eUl0ZW0oc2NvcGUubmV3SXRlbSkpIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICBpZiAoc2NvcGUuaXRlbXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5pdGVtcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICB2YXIgbmV3SXRlbVN0ciA9IHNjb3BlLm5ld0l0ZW0uc2VydmljZVBvcnQgKyAnOidcbiAgICAgICAgICAgICAgICAgICAgICAgKyBzY29wZS5uZXdJdGVtLnByb3ZpZGVyUG9ydCArICc6J1xuICAgICAgICAgICAgICAgICAgICAgICArIHNjb3BlLm5ld0l0ZW0ucHJvdG9jb2w7XG4gICAgICAgICAgICAgICAgICAgLy9SZW1vdmVzIGV4aXN0aW5nIGl0ZW0gd2l0aCB0aGUgc2FtZSB2YWx1ZSBmaXJzdCBpZiBpdCBleGlzdHMuXG4gICAgICAgICAgICAgICAgICAgXy5wdWxsQWxsV2l0aChzY29wZS5pdGVtcywgW25ld0l0ZW1TdHJdLCBjb21wYXJlKTtcbiAgICAgICAgICAgICAgICAgICBzY29wZS5pdGVtcy5wdXNoKG5ld0l0ZW1TdHIpO1xuICAgICAgICAgICAgICAgICAgIHJlc2V0TmV3SXRlbSgpO1xuICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgc2NvcGUucmVtb3ZlID0gZnVuY3Rpb24ocGFzc2VkSXRlbSkge1xuICAgICAgICAgICAgICAgICAgIF8ucmVtb3ZlKHNjb3BlLml0ZW1zLCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcGFyZShpdGVtLCBwYXNzZWRJdGVtKTtcbiAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICByZXNldE5ld0l0ZW0oKTtcbiAgICAgICAgICAgfSxcbiAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXJ2aWNlX2xicy9zZXJ2aWNlbGJwb3J0cy5odG1sJ1xuICAgICAgIH1cbiAgICB9KTtcbiIsIi8qKlxuICogQ3JlYXRlZCBieSBjc2hhbXB1ciBvbiA3LzE3LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnNlcnZpY2VsYnMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmRldGFpbHMuc3RhdHMnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL3N0YXRzJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnU2VydmljZWxiU3RhdHNDdHJsIGFzIHNlcnZpY2VsYlN0YXRzQ3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXJ2aWNlX2xicy9zZXJ2aWNlbGJzdGF0cy5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdTZXJ2aWNlbGJTdGF0c0N0cmwnLFxuICAgICAgICBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ1NlcnZpY2VsYnNNb2RlbCcsICdJbnNwZWN0U2VydmljZScsXG4gICAgICAgICAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBTZXJ2aWNlbGJzTW9kZWwsIEluc3BlY3RTZXJ2aWNlKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgc2VydmljZWxiU3RhdHNDdHJsID0gdGhpcztcblxuICAgICAgICAgICAgICAgIC8qIEdldHMgdGhlIE5ldHdvcmsgT3BlcmF0aW9uYWwgc3RhdGUgZnJvbSB0aGUgc2VydmVyICovXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0U2VydmljZWxiSW5zcGVjdChyZWZyZXNoKXtcbiAgICAgICAgICAgICAgICAgICAgU2VydmljZWxic01vZGVsLmdldEluc3BlY3RCeUtleSgkc3RhdGVQYXJhbXMua2V5LCBDb250aXZHbG9iYWxzLlNFUlZJQ0VMQlNfSU5TUEVDVF9FTkRQT0lOVCwgcmVmcmVzaClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlbGJTdGF0c0N0cmwuc2VydmljZWxiSW5zcGVjdFN0YXRzID0gcmVzdWx0Lk9wZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZWxiU3RhdHNDdHJsLmNvbmZpZyA9IHJlc3VsdC5Db25maWc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYocmVzdWx0Lk9wZXIucHJvdmlkZXJzIT11bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb3ZpZGVyRGV0YWlscyA9IEluc3BlY3RTZXJ2aWNlLmJ1aWxkRW5kUG9pbnRzKHJlc3VsdC5PcGVyLnByb3ZpZGVycyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChJbnNwZWN0U2VydmljZS5jaGVja0NvbnRhaW5lckNoYW5nZWQoc2VydmljZWxiU3RhdHNDdHJsLnByb3ZpZGVyRGV0YWlscywgcHJvdmlkZXJEZXRhaWxzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZWxiU3RhdHNDdHJsLnByb3ZpZGVycyA9IHJlc3VsdC5PcGVyLnByb3ZpZGVycztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2VsYlN0YXRzQ3RybC5wcm92aWRlckRldGFpbHMgPSBwcm92aWRlckRldGFpbHM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZWxiU3RhdHNDdHJsLnByb3ZpZGVycyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlbGJTdGF0c0N0cmwucHJvdmlkZXJEZXRhaWxzID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZ2V0U2VydmljZWxiSW5zcGVjdChmYWxzZSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvL0Rvbid0IGRvIGF1dG9yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgICAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdldFNlcnZpY2VsYkluc3BlY3QodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAgICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfV0pOyIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYuc2V0dGluZ3MnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLmNsdXN0ZXInLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2NsdXN0ZXInLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdDbHVzdGVyU2V0dGluZ0N0cmwgYXMgY2x1c3RlclNldHRpbmdDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NldHRpbmdzL2NsdXN0ZXJzZXR0aW5ncy5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdDbHVzdGVyU2V0dGluZ0N0cmwnLCBbJyRzdGF0ZVBhcmFtcycsICdDUlVESGVscGVyU2VydmljZScsICdOb2Rlc1NlcnZpY2UnLFxuICAgICAgICBmdW5jdGlvbiAoJHN0YXRlUGFyYW1zLCBDUlVESGVscGVyU2VydmljZSwgTm9kZXNTZXJ2aWNlKSB7XG4gICAgICAgICAgICB2YXIgY2x1c3RlclNldHRpbmdDdHJsID0gdGhpcztcblxuICAgICAgICAgICAgZnVuY3Rpb24gdXBkYXRlQ2x1c3RlclNldHRpbmdzKCkge1xuICAgICAgICAgICAgICAgIGlmIChjbHVzdGVyU2V0dGluZ0N0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGNsdXN0ZXJTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKGNsdXN0ZXJTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIGNsdXN0ZXJTZXR0aW5nQ3RybC5ub2RlT3BzT2JqLm5vZGVzID0gWyRzdGF0ZVBhcmFtcy5rZXldO1xuICAgICAgICAgICAgICAgICAgICBOb2Rlc1NlcnZpY2UuY2xlYW51cEV4dHJhVmFycyhjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBOb2Rlc1NlcnZpY2UuY3JlYXRlRXh0cmFWYXJzKGNsdXN0ZXJTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIE5vZGVzU2VydmljZS51cGRhdGVTZXR0aW5ncyhjbHVzdGVyU2V0dGluZ0N0cmwubm9kZU9wc09iaikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGNsdXN0ZXJTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGNsdXN0ZXJTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoY2x1c3RlclNldHRpbmdDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNsdXN0ZXJTZXR0aW5nQ3RybC5ub2RlT3BzT2JqID0ge307XG4gICAgICAgICAgICBjbHVzdGVyU2V0dGluZ0N0cmwuZXh0cmFfdmFycyA9IHt9OyAvL1RPRE8gSW50aWFsaXplIGZyb20gZ2xvYmFsIHNldHRpbmdzXG4gICAgICAgICAgICBjbHVzdGVyU2V0dGluZ0N0cmwuYW5zaWJsZVZhcmlhYmxlcyA9IFtdO1xuICAgICAgICAgICAgY2x1c3RlclNldHRpbmdDdHJsLmVudlZhcmlhYmxlcyA9IFtdO1xuXG4gICAgICAgICAgICBOb2Rlc1NlcnZpY2UuZ2V0U2V0dGluZ3MoY2x1c3RlclNldHRpbmdDdHJsKTtcblxuICAgICAgICAgICAgY2x1c3RlclNldHRpbmdDdHJsLnVwZGF0ZUNsdXN0ZXJTZXR0aW5ncyA9IHVwZGF0ZUNsdXN0ZXJTZXR0aW5ncztcblxuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGNsdXN0ZXJTZXR0aW5nQ3RybCk7XG4gICAgICAgIH1dKTtcbiIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYuc2V0dGluZ3MnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLm5ldHdvcmtzJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9uZXR3b3JrcycsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ05ldHdvcmtTZXR0aW5nQ3RybCBhcyBuZXR3b3JrU2V0dGluZ0N0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2V0dGluZ3MvbmV0d29ya3NldHRpbmdzLmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICA7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05ldHdvcmtTZXR0aW5nQ3RybCcsIFsnQ1JVREhlbHBlclNlcnZpY2UnLCAnTmV0d29ya1NlcnZpY2UnLFxuICAgICAgICBmdW5jdGlvbiAoQ1JVREhlbHBlclNlcnZpY2UsIE5ldHdvcmtTZXJ2aWNlKSB7XG4gICAgICAgICAgICB2YXIgbmV0d29ya1NldHRpbmdDdHJsID0gdGhpcztcbiAgICAgICAgICAgIG5ldHdvcmtTZXR0aW5nQ3RybC52bGFuUGF0dGVybiA9IENvbnRpdkdsb2JhbHMuVkxBTl9SRUdFWDtcbiAgICAgICAgICAgIG5ldHdvcmtTZXR0aW5nQ3RybC52eGxhblBhdHRlcm4gPSBDb250aXZHbG9iYWxzLlZYTEFOX1JFR0VYO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiB1cGRhdGVOZXR3b3JrU2V0dGluZ3MoKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5ldHdvcmtTZXR0aW5nQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IobmV0d29ya1NldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIobmV0d29ya1NldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgTmV0d29ya1NlcnZpY2UudXBkYXRlU2V0dGluZ3MobmV0d29ya1NldHRpbmdDdHJsLnNldHRpbmcpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3JrU2V0dGluZ0N0cmwpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IobmV0d29ya1NldHRpbmdDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldE5ldHdvcmtTZXR0aW5ncygpIHtcbiAgICAgICAgICAgICAgICBOZXR3b3JrU2VydmljZS5nZXRTZXR0aW5ncygpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBuZXR3b3JrU2V0dGluZ0N0cmwuc2V0dGluZyA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2V0TmV0d29ya1NldHRpbmdzKCk7XG4gICAgICAgICAgICBuZXR3b3JrU2V0dGluZ0N0cmwudXBkYXRlTmV0d29ya1NldHRpbmdzID0gdXBkYXRlTmV0d29ya1NldHRpbmdzO1xuXG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IobmV0d29ya1NldHRpbmdDdHJsKTtcbiAgICAgICAgfV0pOyIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYuc2V0dGluZ3MnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLnZvbHVtZXMnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL3ZvbHVtZXMnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWb2x1bWVTZXR0aW5nQ3RybCBhcyB2b2x1bWVTZXR0aW5nQ3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvc2V0dGluZ3Mvdm9sdW1lc2V0dGluZ3MuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignVm9sdW1lU2V0dGluZ0N0cmwnLCBbJ0NSVURIZWxwZXJTZXJ2aWNlJywgJ1ZvbHVtZVNldHRpbmdTZXJ2aWNlJyxcbiAgICAgICAgZnVuY3Rpb24gKENSVURIZWxwZXJTZXJ2aWNlLCBWb2x1bWVTZXR0aW5nU2VydmljZSkge1xuICAgICAgICAgICAgdmFyIHZvbHVtZVNldHRpbmdDdHJsID0gdGhpcztcblxuICAgICAgICAgICAgZnVuY3Rpb24gdXBkYXRlVm9sdW1lU2V0dGluZ3MoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZvbHVtZVNldHRpbmdDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcih2b2x1bWVTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKHZvbHVtZVNldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgVm9sdW1lU2V0dGluZ1NlcnZpY2UudXBkYXRlU2V0dGluZ3Modm9sdW1lU2V0dGluZ0N0cmwuc2V0dGluZykudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZVNldHRpbmdDdHJsKTtcblxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Iodm9sdW1lU2V0dGluZ0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0Vm9sdW1lU2V0dGluZ3MoKSB7XG4gICAgICAgICAgICAgICAgVm9sdW1lU2V0dGluZ1NlcnZpY2UuZ2V0U2V0dGluZ3MoKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgdm9sdW1lU2V0dGluZ0N0cmwuc2V0dGluZyA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2V0Vm9sdW1lU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIHZvbHVtZVNldHRpbmdDdHJsLnVwZGF0ZVZvbHVtZVNldHRpbmdzID0gdXBkYXRlVm9sdW1lU2V0dGluZ3M7XG5cbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHZvbHVtZVNldHRpbmdDdHJsKTtcbiAgICAgICAgfV0pOyIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNi8xLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnN0b3JhZ2Vwb2xpY2llcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5jcmVhdGUnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL3N0b3JhZ2Vwb2xpY3ljcmVhdGUuaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1N0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsIGFzIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdTdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdTdG9yYWdlUG9saWNpZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgU3RvcmFnZVBvbGljaWVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgICAgICB2YXIgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwgPSB0aGlzO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1N0b3JhZ2VQb2xpY2llcygpIHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5saXN0Jyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNhbmNlbENyZWF0aW5nKCkge1xuICAgICAgICAgICAgICAgIHJldHVyblRvU3RvcmFnZVBvbGljaWVzKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUZpbGVzeXN0ZW1DbWRzKCkge1xuICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLmZpbGVzeXN0ZW1jbWRzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwubmV3U3RvcmFnZVBvbGljeS5maWxlc3lzdGVtc1tpdGVtLm5hbWVdID0gaXRlbS52YWx1ZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gY3JlYXRlUG9saWN5KCkge1xuICAgICAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAgICAgLy9jaGVja2luZyBpZiBhbGwgdmFsaWRhdGlvbnMgaGF2ZSBwYXNzZWRcbiAgICAgICAgICAgICAgICBpZiAoc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBjcmVhdGVGaWxlc3lzdGVtQ21kcygpO1xuICAgICAgICAgICAgICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbC5jcmVhdGUoc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwubmV3U3RvcmFnZVBvbGljeSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1N0b3JhZ2VQb2xpY2llcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gcmVzZXRGb3JtKCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwubmV3U3RvcmFnZVBvbGljeSA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiYmFja2VuZHNcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJjcnVkXCI6IFwiY2VwaFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJtb3VudFwiOiBcImNlcGhcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic25hcHNob3RcIjogXCJjZXBoXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXCJ1bmxvY2tlZFwiOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgXCJkcml2ZXJcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJwb29sXCI6IFwicmJkXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXCJjcmVhdGVcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJzaXplXCI6IFwiMFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJmaWxlc3lzdGVtXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXCJydW50aW1lXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic25hcHNob3RzXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNuYXBzaG90XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImZyZXF1ZW5jeVwiOiBcIjMwbVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwia2VlcFwiOiAyMFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmF0ZS1saW1pdFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ3cml0ZS1pb3BzXCI6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWFkLWlvcHNcIjogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIndyaXRlLWJwc1wiOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicmVhZC1icHNcIjogMCBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXCJmaWxlc3lzdGVtc1wiOiB7fVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLmNyZWF0ZVBvbGljeSA9IGNyZWF0ZVBvbGljeTtcbiAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLmNhbmNlbENyZWF0aW5nID0gY2FuY2VsQ3JlYXRpbmc7XG4gICAgICAgICAgICBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5maWxlc3lzdGVtY21kcyA9IFtdO1xuXG4gICAgICAgICAgICByZXNldEZvcm0oKTtcbiAgICAgICAgfV0pO1xuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzI3LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnN0b3JhZ2Vwb2xpY2llcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5kZXRhaWxzJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwgYXMgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvc3RvcmFnZXBvbGljeWRldGFpbHMuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5lZGl0Jywge1xuICAgICAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwgYXMgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvc3RvcmFnZXBvbGljeWRldGFpbHMuaHRtbCdcbiAgICAgICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdTdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwnLFxuICAgICAgICBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ1N0b3JhZ2VQb2xpY2llc01vZGVsJywgJ1ZvbHVtZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgICAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBTdG9yYWdlUG9saWNpZXNNb2RlbCwgVm9sdW1lc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICAgICAgICAgIHZhciBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5maWxlc3lzdGVtY21kcyA9IFtdO1xuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogVG8gc2hvdyBlZGl0IG9yIGRldGFpbHMgc2NyZWVuIGJhc2VkIG9uIHRoZSByb3V0ZVxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNldE1vZGUoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkc3RhdGUuaXMoJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5lZGl0JykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5tb2RlID0gJ2VkaXQnO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLm1vZGUgPSAnZGV0YWlscyc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1BvbGljaWVzKCkge1xuICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5saXN0Jyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Qb2xpY3lEZXRhaWxzKCkge1xuICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5kZXRhaWxzJywgeydrZXknOiBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5Lm5hbWV9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjYW5jZWxFZGl0aW5nKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1BvbGljeURldGFpbHMoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBkZWxldGVQb2xpY3koKSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbC5kZWxldGVVc2luZ0tleShzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5Lm5hbWUsICduYW1lJykudGhlbihcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9Qb2xpY2llcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIEdldCB2b2x1bWVzIGJlbG9uZ2luZyB0byBhIHBvbGljeVxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdldFZvbHVtZXMocmVsb2FkKSB7XG4gICAgICAgICAgICAgICAgICAgIFZvbHVtZXNNb2RlbC5nZXQocmVsb2FkKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC52b2x1bWVzID0gJGZpbHRlcignb3JkZXJCeScpKF8uZmlsdGVyKHJlc3VsdCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdwb2xpY3knOiBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5Lm5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLCAnbmFtZScpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBpbml0aWFsaXplRmlsZXN5c3RlbUNtZHNBcnJheSgpIHtcbiAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kuZmlsZXN5c3RlbXMsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHVzaCh7bmFtZToga2V5LCB2YWx1ZTogdmFsdWV9KTtcbiAgICAgICAgICAgICAgICAgICAgfSwgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmZpbGVzeXN0ZW1jbWRzKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjcmVhdGVGaWxlc3lzdGVtQ21kcygpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmZpbGVzeXN0ZW1jbWRzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kuZmlsZXN5c3RlbXNbaXRlbS5uYW1lXSA9IGl0ZW0udmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNhdmVQb2xpY3koKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAgICAgICAgIC8vY2hlY2tpbmcgaWYgYWxsIHZhbGlkYXRpb25zIGhhdmUgcGFzc2VkXG4gICAgICAgICAgICAgICAgICAgIGlmIChzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZUZpbGVzeXN0ZW1DbWRzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbC5zYXZlKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1BvbGljeURldGFpbHMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcblxuICAgICAgICAgICAgICAgIFN0b3JhZ2VQb2xpY2llc01vZGVsLmdldE1vZGVsQnlLZXkoJHN0YXRlUGFyYW1zLmtleSwgZmFsc2UsICduYW1lJylcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnBvbGljeSA9IHBvbGljeTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluaXRpYWxpemVGaWxlc3lzdGVtQ21kc0FycmF5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBnZXRWb2x1bWVzKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmRlbGV0ZVBvbGljeSA9IGRlbGV0ZVBvbGljeTtcbiAgICAgICAgICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwuc2F2ZVBvbGljeSA9IHNhdmVQb2xpY3k7XG4gICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmNhbmNlbEVkaXRpbmcgPSBjYW5jZWxFZGl0aW5nO1xuXG4gICAgICAgICAgICAgICAgc2V0TW9kZSgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgICAgICAgICAgLy9Eb24ndCBkbyBhdXRvcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICAgICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBnZXRWb2x1bWVzKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1dKTtcbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNi8yLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5zdG9yYWdlcG9saWNpZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2U3RvcmFnZXBvbGljeWJhc2ljc2V0dGluZ3NcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG5cbiAgICAgICAgfVxuICAgIH0pXG4gICAgLmRpcmVjdGl2ZShcImN0dlN0b3JhZ2Vwb2xpY3lmaWxlc3lzdGVtc2V0dGluZ3NcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBwb2xpY3k6ICc9JyxcbiAgICAgICAgICAgICAgICBmaWxlc3lzdGVtY21kczogJz0nXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUpIHtcbiAgICAgICAgICAgICAgICBzY29wZS5maWxlc3lzdGVtcyA9IFsnZXh0NCcsICdidHJmcyddO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9maWxlc3lzdGVtc2V0dGluZ3MuaHRtbCdcbiAgICAgICAgfVxuICAgIH0pXG4gICAgLmRpcmVjdGl2ZShcImN0dlN0b3JhZ2Vwb2xpY3lzbmFwc2hvdHNldHRpbmdzXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgcG9saWN5OiAnPSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvc25hcHNob3RzZXR0aW5ncy5odG1sJ1xuICAgICAgICB9XG4gICAgfSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2U3RvcmFnZXBvbGljeXJ3b3Bzc2V0dGluZ3NcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBwb2xpY3k6ICc9J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9yd29wc3NldHRpbmdzLmh0bWwnXG4gICAgICAgIH1cbiAgICB9KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZTdG9yYWdlcG9saWN5YmFja2VuZGRyaXZlcnNcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBwb2xpY3k6ICc9J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9iYWNrZW5kZHJpdmVycy5odG1sJ1xuICAgICAgICB9XG4gICAgfSk7XG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDQvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc3RvcmFnZXBvbGljaWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmxpc3QnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTdG9yYWdlUG9saWN5TGlzdEN0cmwgYXMgc3RvcmFnZVBvbGljeUxpc3RDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvc3RvcmFnZXBvbGljeWxpc3QuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignU3RvcmFnZVBvbGljeUxpc3RDdHJsJywgWyckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnU3RvcmFnZVBvbGljaWVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgICAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIFN0b3JhZ2VQb2xpY2llc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICAgICAgdmFyIHN0b3JhZ2VQb2xpY3lMaXN0Q3RybCA9IHRoaXM7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldFBvbGljaWVzKHJlbG9hZCkge1xuICAgICAgICAgICAgICAgIFN0b3JhZ2VQb2xpY2llc01vZGVsLmdldChyZWxvYWQpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeUxpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lMaXN0Q3RybC5wb2xpY2llcyA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeUxpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vTG9hZCBmcm9tIGNhY2hlIGZvciBxdWljayBkaXNwbGF5IGluaXRpYWxseVxuICAgICAgICAgICAgZ2V0UG9saWNpZXMoZmFsc2UpO1xuXG4gICAgICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgICAgIC8vRG9uJ3QgZG8gYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGdldFBvbGljaWVzKHRydWUpO1xuICAgICAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1dKTsiLCJcblxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52aXN1YWxpemF0aW9uJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUudmlzdWFsaXphdGlvbi5lZGdlJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9lZGdlL3tzb3VyY2VOYW1lLCB0YXJnZXROYW1lLCBzb3VyY2VMaXN0LCB0YXJnZXRMaXN0fScsXG4gICAgICAgICAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZU5hbWU6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldE5hbWU6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZUxpc3Q6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldExpc3Q6IG51bGxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWaXN1YWxpemF0aW9uRWRnZUN0cmwgYXMgdmlzdWFsaXphdGlvbmVkZ2VDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Zpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbmVkZ2UuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignVmlzdWFsaXphdGlvbkVkZ2VDdHJsJywgW1wiJHNjb3BlXCIsIFwiJGh0dHBcIiwgJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnVmlzdWFsaXphdGlvblNlcnZpY2UnLCAnJGludGVydmFsJyxcbiAgICAgICAgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJHN0YXRlLCAkc3RhdGVQYXJhbXMsIFZpc3VhbGl6YXRpb25TZXJ2aWNlLCAkaW50ZXJ2YWwpIHtcbiAgICAgICAgICAgIHZhciBzb3VyY2VOYW1lID0gJHN0YXRlUGFyYW1zLnNvdXJjZU5hbWU7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0TmFtZSA9ICRzdGF0ZVBhcmFtcy50YXJnZXROYW1lO1xuICAgICAgICAgICAgdmFyIHNvdXJjZUxpc3QgPSAkc3RhdGVQYXJhbXMuc291cmNlTGlzdDtcbiAgICAgICAgICAgIHZhciB0YXJnZXRMaXN0ID0gJHN0YXRlUGFyYW1zLnRhcmdldExpc3Q7XG5cbiAgICAgICAgICAgIC8vSWYgdGhlIHBhZ2UgaXMgcmVsb2FkZWQsIHRoZXNlIHN0YXRlIHBhcmFtcyBhcmUgYWxsIG51bGwsXG4gICAgICAgICAgICAvL3NvIGl0IHdpbGwgcm91dGUgdGhlbSBiYWNrIHRvIHRoZSB2aXN1YWxpemF0aW9uIHRhYiB0b3Agdmlld1xuICAgICAgICAgICAgaWYgKHNvdXJjZUxpc3QgPT0gbnVsbCB8fCB0YXJnZXRMaXN0ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZpc3VhbGl6YXRpb24ubGlzdCcpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgdmFyIHQgPSBkLmdldFNlY29uZHMoKTtcbiAgICAgICAgICAgICRzY29wZS5lZGdlRGF0YUludGVydmFsID0gXG4gICAgICAgICAgICAgICAgJGludGVydmFsKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBWaXN1YWxpemF0aW9uU2VydmljZS5nZXRFZGdlRGF0YShzb3VyY2VMaXN0LCB0YXJnZXRMaXN0LCB0LnRvU3RyaW5nKCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSByZXN1bHQucmVzdWx0cztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHJlc3VsdHMsIGZ1bmN0aW9uKHIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF8uaXNFbXB0eShyKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgKz0gci5zZXJpZXNbMF0udmFsdWVzWzBdWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNvdXJjZU5hbWUgPSBzb3VyY2VOYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS50YXJnZXROYW1lID0gdGFyZ2V0TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZWRnZURhdGEgPSBkYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5lZGdlRGF0YVRpbWUgPSB0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9LCAzMDAwKTtcblxuICAgICAgICAgICAgLy9EZXN0cm95aW5nIHRoZSBpbnRlcnZhbCBmdW5jdGlvbiBvbiByb3V0ZSBjaGFuZ2VcbiAgICAgICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkgeyAkaW50ZXJ2YWwuY2FuY2VsKCRzY29wZS5lZGdlRGF0YUludGVydmFsKTsgfSk7XG5cblxuICAgICAgICAgICAgVmlzdWFsaXphdGlvblNlcnZpY2UuZ2V0T2xkRWRnZURhdGEoc291cmNlTGlzdCwgdGFyZ2V0TGlzdClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHRzID0gcmVzdWx0LnJlc3VsdHM7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlZGdlRGF0YSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAvL3Jlc3VsdHMsIGlmIG5vdCBlbXB0eSwgYXJlIGV4cGVjdGVkIHRvIGhhdmVcbiAgICAgICAgICAgICAgICAgICAgLy82IGRhdGEgZW50cmllc1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2gocmVzdWx0cywgZnVuY3Rpb24ocikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF8uaXNFbXB0eShyKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHIuc2VyaWVzWzBdLnZhbHVlcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoXy5pc0VtcHR5KGVkZ2VEYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goZGF0YSwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRnZURhdGEucHVzaChkWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goZGF0YSwgZnVuY3Rpb24oZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRnZURhdGFbaV0gKz0gZFsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zb3VyY2VOYW1lID0gc291cmNlTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRhcmdldE5hbWUgPSB0YXJnZXROYW1lO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlTGlzdCA9IHNvdXJjZUxpc3Q7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50YXJnZXRMaXN0ID0gdGFyZ2V0TGlzdDtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm9sZEVkZ2VEYXRhID0gZWRnZURhdGE7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICB9XSk7XG5cblxuXG5cbiIsIlxuXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nKVxuICAgIC5kaXJlY3RpdmUoXCJ2aXN1YWxpemF0aW9uRWRnZVwiLCBbJyR3aW5kb3cnLFxuICAgICAgICBmdW5jdGlvbigkd2luZG93KSB7XG4gICAgICAgICAgICBmdW5jdGlvbiB2aXN1YWxpemF0aW9uRWRnZUQzKHNjb3BlLCBkMykge1xuICAgICAgICAgICAgICAgIHZhciBib2R5RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnYm9keScpWzBdO1xuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBib2R5RWwuY2xpZW50V2lkdGggLSA0MDAsXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCA9ICBib2R5RWwuY2xpZW50SGVpZ2h0IC0gNDAwO1xuXG5cbiAgICAgICAgICAgICAgICAvL3Rha2VuIGZyb20gaHR0cDovL2JsLm9ja3Mub3JnL3NpbWVuYnJla2tlbi82NjM0MDcwXG4gICAgICAgICAgICAgICAgLy8gLyoqIE1BSU4gU1ZHICoqL1xuICAgICAgICAgICAgICAgIHZhciBsaW1pdCA9IDU5LFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uID0gNzUwLFxuICAgICAgICAgICAgICAgIG5vdyA9IG5ldyBEYXRlKERhdGUubm93KCkgLSBkdXJhdGlvbik7XG5cbiAgICAgICAgICAgICAgICB2YXIgZ3JvdXBzID0ge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnb3JhbmdlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGQzLnJhbmdlKGxpbWl0KS5tYXAoZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzY29wZS5vbGRFZGdlRGF0YVtNYXRoLmZsb29yKGQvMTApXSB8fCAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIHggPSBkMy50aW1lLnNjYWxlKClcbiAgICAgICAgICAgICAgICAgICAgLmRvbWFpbihbbm93IC0gKGxpbWl0IC0gMiksIG5vdyAtIGR1cmF0aW9uXSlcbiAgICAgICAgICAgICAgICAgICAgLnJhbmdlKFswLCB3aWR0aF0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIHkgPSBkMy5zY2FsZS5saW5lYXIoKVxuICAgICAgICAgICAgICAgICAgICAuZG9tYWluKFswLCBkMy5tYXgoZ3JvdXBzLmN1cnJlbnQuZGF0YSwgZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQgKyAxMDsgfSldKVxuICAgICAgICAgICAgICAgICAgICAucmFuZ2UoW2hlaWdodCwgMF0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIGxpbmUgPSBkMy5zdmcubGluZSgpXG4gICAgICAgICAgICAgICAgICAgIC5pbnRlcnBvbGF0ZSgnYmFzaXMnKVxuICAgICAgICAgICAgICAgICAgICAueChmdW5jdGlvbihkLCBpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geChub3cgLSAobGltaXQgLSAxIC0gaSkgKiBkdXJhdGlvbilcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLnkoZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHkoZClcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgeFN2ZyA9IGQzLnNlbGVjdCgnLmdyYXBoJykuYXBwZW5kKCdzdmcnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignd2lkdGgnLCAyNSlcbiAgICAgICAgICAgICAgICAgICAgLnN0eWxlKCdvdmVyZmxvdycsICd2aXNpYmxlJylcbiAgICAgICAgICAgICAgICAgICAgLnN0eWxlKCdwb3NpdGlvbicsICdmaXhlZCcpO1xuXG4gICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICB2YXIgeUF4aXMgPSB4U3ZnLmFwcGVuZCgnZycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICd5IGF4aXMnKVxuICAgICAgICAgICAgICAgICAgICAvLyAuYXR0cigndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZSgwLCcgKyB3aWR0aCArICcpJylcbiAgICAgICAgICAgICAgICAgICAgLmNhbGwoeS5heGlzID0gZDMuc3ZnLmF4aXMoKS5zY2FsZSh5KS5vcmllbnQoJ2xlZnQnKSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIHN2Zz0gZDMuc2VsZWN0KCcuZ3JhcGgnKS5hcHBlbmQoJ3N2ZycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdjaGFydCcpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd3aWR0aCcsIHdpZHRoIC0gNTApXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdoZWlnaHQnLCBoZWlnaHQgKyA1MCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIC5zdHlsZSgnb3ZlcmZsb3cnLCBcInZpc2libGVcIik7XG5cbiAgICAgICAgICAgICAgICB2YXIgYXhpcyA9IHN2Zy5hcHBlbmQoJ2cnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAneCBheGlzJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoMCwnICsgaGVpZ2h0ICsgJyknKVxuICAgICAgICAgICAgICAgICAgICAuY2FsbCh4LmF4aXMgPSBkMy5zdmcuYXhpcygpLnNjYWxlKHgpLm9yaWVudCgnYm90dG9tJykpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHBhdGhzID0gc3ZnLmFwcGVuZCgnZycpO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBncm91cHMpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdyb3VwID0gZ3JvdXBzW25hbWVdO1xuICAgICAgICAgICAgICAgICAgICBncm91cC5wYXRoID0gcGF0aHMuYXBwZW5kKCdwYXRoJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYXRhKFtncm91cC5kYXRhXSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsIG5hbWUgKyAnIGdyb3VwJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdHlsZSgnc3Ryb2tlJywgZ3JvdXAuY29sb3IpXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gdGljaygpIHtcbiAgICAgICAgICAgICAgICAgICAgbm93ID0gbmV3IERhdGUoKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBBZGQgbmV3IHZhbHVlc1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBuYW1lIGluIGdyb3Vwcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdyb3VwID0gZ3JvdXBzW25hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXAuZGF0YS5wdXNoKHNjb3BlLmVkZ2VEYXRhIHx8IDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXAucGF0aC5hdHRyKCdkJywgbGluZSlcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIFNoaWZ0IGRvbWFpblxuICAgICAgICAgICAgICAgICAgICB4LmRvbWFpbihbbm93IC0gKGxpbWl0IC0gMikgKiBkdXJhdGlvbiwgbm93IC0gZHVyYXRpb25dKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBTbGlkZSB4LWF4aXMgbGVmdFxuICAgICAgICAgICAgICAgICAgICBheGlzLnRyYW5zaXRpb24oKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmR1cmF0aW9uKGR1cmF0aW9uKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVhc2UoJ2xpbmVhcicpXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2FsbCh4LmF4aXMpO1xuXG4gICAgICAgICAgICAgICAgICAgIHlBeGlzLnRyYW5zaXRpb24oKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmR1cmF0aW9uKGR1cmF0aW9uKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVhc2UoJ2xpbmVhcicpXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2FsbCh5LmF4aXMpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFNsaWRlIHBhdGhzIGxlZnRcbiAgICAgICAgICAgICAgICAgICAgcGF0aHMuYXR0cigndHJhbnNmb3JtJywgbnVsbClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kdXJhdGlvbihkdXJhdGlvbilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lYXNlKCdsaW5lYXInKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoJyArIHgobm93IC0gKGxpbWl0IC0gMSkgKiBkdXJhdGlvbikgKyAnKScpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZWFjaCgnZW5kJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGljaygpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgb2xkZXN0IGRhdGEgcG9pbnQgZnJvbSBlYWNoIGdyb3VwXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIG5hbWUgaW4gZ3JvdXBzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ3JvdXAgPSBncm91cHNbbmFtZV07XG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cC5kYXRhLnNoaWZ0KClcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aWNrKClcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJue1xuICAgICAgICAgICAgICAgIHJlc3RyaWN0OidFQScsXG4gICAgICAgICAgICAgICAgcmVwbGFjZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb25lZGdldGVtcGxhdGUuaHRtbCcsXG4gICAgICAgICAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUpe1xuICAgICAgICAgICAgICAgICAgICBzY29wZS4kd2F0Y2hHcm91cChbJ2VkZ2VEYXRhJywgJ29sZEVkZ2VEYXRhJ10sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2NvcGUuZWRnZURhdGEgIT0gbnVsbCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUub2xkRWRnZURhdGEgIT0gbnVsbCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzY29wZS5pbml0aWFsaXplKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5pbml0aWFsaXplID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkMyA9ICR3aW5kb3cuZDM7ICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc3VhbGl6YXRpb25FZGdlRDMoc2NvcGUsIGQzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIF1cbik7XG4iLCJcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicpXG4gICAgLnNlcnZpY2UoJ1N0YXRlU2F2ZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zYXZlZFN0YXRlcyA9IHt9O1xuICAgIH0pXG4gICAgLmRpcmVjdGl2ZShcInZpc3VhbGl6YXRpb25HcmFwaFwiLCBbJyR3aW5kb3cnLCAnJHN0YXRlJywgJ1Zpc3VhbGl6ZXJHcmFwaCcsICdQb2xpY3lTZXJ2aWNlJywgJ1Zpc3VhbGl6ZXJEYXRhU291cmNlJywgJ1N0YXRlU2F2ZScsXG4gICAgICAgIGZ1bmN0aW9uKCR3aW5kb3csICRzdGF0ZSwgVmlzdWFsaXplckdyYXBoLCBQb2xpY3lTZXJ2aWNlLCBWaXN1YWxpemVyRGF0YVNvdXJjZSwgU3RhdGVTYXZlKSB7XG4gICAgICAgICAgICBmdW5jdGlvbiB2aXN1YWxpemF0aW9ubGlzdGQzKHNjb3BlLCBlbGVtLCBWaXN1YWxpemVyR3JhcGgsIFBvbGljeVNlcnZpY2UsIFZpc3VhbGl6ZXJEYXRhU291cmNlLCBTdGF0ZVNhdmUpIHtcbiAgICAgICAgICAgICAgICAvL2Rvbid0IHJ1biB1bnRpbCBhbGwgaW5pdGlhbGl6YXRpb24gY2FsbHMgaGF2ZSByZXR1cm5lZFxuICAgICAgICAgICAgICAgIGlmIChzY29wZS5ub2RlcyA9PT0gdW5kZWZpbmVkIHx8IHNjb3BlLmxpbmtzID09PSB1bmRlZmluZWQgfHwgc2NvcGUuY2hpbGRyZW5fc3RydWN0ID09PSB1bmRlZmluZWQgfHxcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuYW5jZXN0b3JzX3N0cnVjdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL2NyZWF0aW5nIERhdGFTb3VyY2VcbiAgICAgICAgICAgICAgICB2YXIgZGF0YVNvdXJjZSA9IG5ldyBWaXN1YWxpemVyRGF0YVNvdXJjZS5EYXRhU291cmNlKHNjb3BlLm5vZGVzLCBzY29wZS5saW5rcywgc2NvcGUuY2hpbGRyZW5fc3RydWN0LCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmFuY2VzdG9yc19zdHJ1Y3QsIHNjb3BlLmxhYmVscywgc2NvcGUuc2VydmljZVNlbGVjdG9ycyk7XG4gICAgICAgICAgICAgICAgZGF0YVNvdXJjZS5zZXRBbmNlc3RvcnMoKTtcblxuICAgICAgICAgICAgICAgIHZhciBub2RlcywgbGlua3M7XG5cbiAgICAgICAgICAgICAgICB2YXIgdG9wRGF0YSA9IGRhdGFTb3VyY2UuZ2V0VG9wTGV2ZWxGbG93KCk7XG4gICAgICAgICAgICAgICAgbm9kZXMgPSBkYXRhU291cmNlLnByb2Nlc3NOb2RlRGF0YSh0b3BEYXRhLm5vZGVEYXRhKTtcbiAgICAgICAgICAgICAgICBsaW5rcyA9IGRhdGFTb3VyY2UucHJvY2Vzc0xpbmtEYXRhKHRvcERhdGEubGlua0RhdGEsIG5vZGVzKTtcblxuICAgICAgICAgICAgICAgIHZhciBib2R5RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnYm9keScpWzBdO1xuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBib2R5RWwuY2xpZW50V2lkdGgsXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCA9ICBib2R5RWwuY2xpZW50SGVpZ2h0O1xuXG4gICAgICAgICAgICAgICAgLyoqIE1BSU4gU1ZHICoqL1xuICAgICAgICAgICAgICAgIHZhciByYXdTdmc9ZWxlbS5maW5kKCdzdmcnKTtcblxuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSAkKHJhd1N2Zy5wYXJlbnQoKSkub2Zmc2V0KCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgZGl2V2lkdGggPSAkKHJhd1N2Zy5wYXJlbnQoKSkud2lkdGgoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdmcgPSBkMy5zZWxlY3QocmF3U3ZnWzBdKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcIndpZHRoXCIsIGRpdldpZHRoKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcImhlaWdodFwiLCBoZWlnaHQgLSBvZmZzZXQudG9wIC0gMjApO1xuXG4gICAgICAgICAgICAgICAgLy9pbnN0YWxsaW5nIHBvbGljaWVzXG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoID0gbmV3IFZpc3VhbGl6ZXJHcmFwaC5HcmFwaChzdmcsIG5vZGVzLCBsaW5rcywgZGF0YVNvdXJjZSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuY2hpbGRyZW5fc3RydWN0LCBzY29wZS5hbmNlc3RvcnNfc3RydWN0KTtcbiAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGguaW5zdGFsbERlZmF1bHRQYXRoUG9saWN5KG5ldyBQb2xpY3lTZXJ2aWNlLlNhdmVTdGF0ZVBvbGljeShTdGF0ZVNhdmUuc2F2ZWRTdGF0ZXMpKTtcbiAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGguaW5zdGFsbERlZmF1bHRQYXRoUG9saWN5KG5ldyBQb2xpY3lTZXJ2aWNlLlBhdGhDaGFuZ2VWaWV3UG9saWN5KCRzdGF0ZSkpO1xuICAgICAgICAgICAgICAgIC8vUVRpcFBvbGljeSBpcyBmb3IgYm90aCBOb2RlcyBhbmQgUGF0aHMsIGluc3RhbGwgc2FtZSBvbmUgb24gYm90aFxuICAgICAgICAgICAgICAgIHZhciBxVGlwUG9saWN5ID0gbmV3IFBvbGljeVNlcnZpY2UuUVRpcFBvbGljeSgpO1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5pbnN0YWxsRGVmYXVsdE5vZGVQb2xpY3kocVRpcFBvbGljeSk7XG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmluc3RhbGxEZWZhdWx0UGF0aFBvbGljeShxVGlwUG9saWN5KTtcbiAgICAgICAgICAgICAgICB2YXIgc3BsaXRKb2luVmlld1BvbGljeSA9IG5ldyBQb2xpY3lTZXJ2aWNlLlNwbGl0Sm9pblZpZXdQb2xpY3koKTtcbiAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGguaW5zdGFsbERlZmF1bHROb2RlUG9saWN5KHNwbGl0Sm9pblZpZXdQb2xpY3kpO1xuICAgICAgICAgICAgICAgIHNwbGl0Sm9pblZpZXdQb2xpY3kuaW5zdGFsbEJhY2tCdXR0b24oJCgnI2JhY2tCdXR0b24nKSk7XG4gICAgICAgICAgICAgICAgc3BsaXRKb2luVmlld1BvbGljeS5pbnN0YWxsVGl0bGUoJCgnI2dyYXBoLXRpdGxlJykpO1xuXG4gICAgICAgICAgICAgICAgLy9sb2FkIG9sZCB2aWV3IGlmIGl0IGV4aXN0cy5cbiAgICAgICAgICAgICAgICBpZiAoXy5pc0VtcHR5KFN0YXRlU2F2ZS5zYXZlZFN0YXRlcykgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdyYXBoID0gc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoO1xuICAgICAgICAgICAgICAgICAgICBncmFwaC5sb2FkKFN0YXRlU2F2ZS5zYXZlZFN0YXRlcyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm57XG4gICAgICAgICAgICAgICAgcmVzdHJpY3Q6J0VBJyxcbiAgICAgICAgICAgICAgICByZXBsYWNlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Zpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbnRlbXBsYXRlLmh0bWwnLFxuICAgICAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtKXtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHsgXG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLnVuYmluZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmRlc3Ryb3koKTt9KTtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJHdhdGNoR3JvdXAoWydub2RlcycsICdsaW5rcycsICdjaGlsZHJlbl9zdHJ1Y3QnLCAnYW5jZXN0b3JzX3N0cnVjdCddLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNjb3BlLm5vZGVzICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUubGlua3MgIT0gbnVsbCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5jaGlsZHJlbl9zdHJ1Y3QgIT0gbnVsbCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5hbmNlc3RvcnNfc3RydWN0ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNjb3BlLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzdWFsaXphdGlvbmxpc3RkMyhzY29wZSwgZWxlbSwgVmlzdWFsaXplckdyYXBoLCBQb2xpY3lTZXJ2aWNlLCBWaXN1YWxpemVyRGF0YVNvdXJjZSwgU3RhdGVTYXZlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGguZGF0YVNvdXJjZS5saW5rcyA9IHNjb3BlLmxpbmtzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGgudXBkYXRlTGlua0RhdGEoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgXVxuKTtcblxuXG5cblxuXG5cblxuXG5cblxuXG5cbiIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZpc3VhbGl6YXRpb24ubGlzdCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1Zpc3VhbGl6YXRpb25MaXN0Q3RybCBhcyB2aXN1YWxpemF0aW9uTGlzdEN0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9ubGlzdC5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdWaXN1YWxpemF0aW9uTGlzdEN0cmwnLCBbXCIkc2NvcGVcIiwgXCIkaHR0cFwiLCAnVmlzdWFsaXphdGlvblNlcnZpY2UnLCAnJGludGVydmFsJyxcbiAgICAgICAgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgVmlzdWFsaXphdGlvblNlcnZpY2UsICRpbnRlcnZhbCkge1xuICAgICAgICAgICAgdmFyIGdyYXBoRGF0YSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBsaW5rcyA9IFtdO1xuICAgICAgICAgICAgICAgIC8vZW5kcG9pbnQgaXBcbiAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKHtuYW1lOiAnMTEuMS4xLjInLCBpZDonMTEuMS4xLjInLCBwYXJlbnQ6bnVsbCwgYW5jZXN0b3JzOm51bGx9KTtcbiAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKHtuYW1lOiAnMTEuMS4xLjMnLCBpZDonMTEuMS4xLjMnLCBwYXJlbnQ6bnVsbCwgYW5jZXN0b3JzOm51bGx9KTtcbiAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKHtuYW1lOiAnMTEuMS4xLjQnLCBpZDonMTEuMS4xLjQnLCBwYXJlbnQ6bnVsbCwgYW5jZXN0b3JzOm51bGx9KTtcbiAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKHtuYW1lOiAnMTEuMS4xLjUnLCBpZDonMTEuMS4xLjUnLCBwYXJlbnQ6bnVsbCwgYW5jZXN0b3JzOm51bGx9KTtcbiAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKHtuYW1lOiAnMTEuMS4xLjYnLCBpZDonMTEuMS4xLjYnLCBwYXJlbnQ6bnVsbCwgYW5jZXN0b3JzOm51bGx9KTtcbiAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKHtuYW1lOiAnMTEuMS4xLjcnLCBpZDonMTEuMS4xLjcnLCBwYXJlbnQ6bnVsbCwgYW5jZXN0b3JzOm51bGx9KTtcbiAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKHtuYW1lOiAnMTEuMS4xLjgnLCBpZDonMTEuMS4xLjgnLCBwYXJlbnQ6bnVsbCwgYW5jZXN0b3JzOm51bGx9KTtcblxuICAgICAgICAgICAgICAgIC8vYXBwLXN2YyBwcm92aWRlciBpcFxuICAgICAgICAgICAgICAgIG5vZGVzLnB1c2goe25hbWU6ICcxMC4xLjEuMScsIGlkOicxMC4xLjEuMScsIHBhcmVudDpudWxsLCBhbmNlc3RvcnM6bnVsbH0pO1xuICAgICAgICAgICAgICAgIG5vZGVzLnB1c2goe25hbWU6ICcxMC4xLjEuMicsIGlkOicxMC4xLjEuMicsIHBhcmVudDpudWxsLCBhbmNlc3RvcnM6bnVsbH0pO1xuICAgICAgICAgICAgICAgIG5vZGVzLnB1c2goe25hbWU6ICcxMC4xLjEuMycsIGlkOicxMC4xLjEuMycsIHBhcmVudDpudWxsLCBhbmNlc3RvcnM6bnVsbH0pO1xuICAgICAgICAgICAgICAgIG5vZGVzLnB1c2goe25hbWU6ICcxMC4xLjEuNCcsIGlkOicxMC4xLjEuNCcsIHBhcmVudDpudWxsLCBhbmNlc3RvcnM6bnVsbH0pO1xuICAgICAgICAgICAgICAgIG5vZGVzLnB1c2goe25hbWU6ICcxMC4xLjEuNScsIGlkOicxMC4xLjEuNScsIHBhcmVudDpudWxsLCBhbmNlc3RvcnM6bnVsbH0pO1xuICAgICAgICAgICAgICAgIG5vZGVzLnB1c2goe25hbWU6ICcxMC4xLjEuNicsIGlkOicxMC4xLjEuNicsIHBhcmVudDpudWxsLCBhbmNlc3RvcnM6bnVsbH0pO1xuICAgICAgICAgICAgICAgIG5vZGVzLnB1c2goe25hbWU6ICcxMC4xLjEuNycsIGlkOicxMC4xLjEuNycsIHBhcmVudDpudWxsLCBhbmNlc3RvcnM6bnVsbH0pO1xuICAgICAgICAgICAgICAgIG5vZGVzLnB1c2goe25hbWU6ICcxMC4xLjEuOCcsIGlkOicxMC4xLjEuOCcsIHBhcmVudDpudWxsLCBhbmNlc3RvcnM6bnVsbH0pO1xuICAgICAgICAgICAgICAgIG5vZGVzLnB1c2goe25hbWU6ICcxMC4xLjEuOScsIGlkOicxMC4xLjEuOScsIHBhcmVudDpudWxsLCBhbmNlc3RvcnM6bnVsbH0pO1xuXG4gICAgICAgICAgICAgICAgLy9hcHAtZGIgcHJvdmlkZXIgaXBcbiAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKHtuYW1lOiAnMTAuMS4xLjEwJywgaWQ6JzEwLjEuMS4xMCcsIHBhcmVudDpudWxsLCBhbmNlc3RvcnM6bnVsbH0pO1xuICAgICAgICAgICAgICAgIG5vZGVzLnB1c2goe25hbWU6ICcxMC4xLjEuMTEnLCBpZDonMTAuMS4xLjExJywgcGFyZW50Om51bGwsIGFuY2VzdG9yczpudWxsfSk7XG4gICAgICAgICAgICAgICAgbm9kZXMucHVzaCh7bmFtZTogJzEwLjEuMS4xMicsIGlkOicxMC4xLjEuMTInLCBwYXJlbnQ6bnVsbCwgYW5jZXN0b3JzOm51bGx9KTtcblxuICAgICAgICAgICAgICAgIC8vYXBwLXN2YyBsaW5rc1xuICAgICAgICAgICAgICAgIGxpbmtzLnB1c2goe3NvdXJjZTogJzExLjEuMS4yJywgdGFyZ2V0OiAnMTAuMS4xLjEnLCB3ZWlnaHQ6NTR9KTtcbiAgICAgICAgICAgICAgICBsaW5rcy5wdXNoKHtzb3VyY2U6ICcxMC4xLjEuMScsIHRhcmdldDogJzExLjEuMS4yJywgd2VpZ2h0Ojk1fSk7XG4gICAgICAgICAgICAgICAgbGlua3MucHVzaCh7c291cmNlOiAnMTEuMS4xLjMnLCB0YXJnZXQ6ICcxMC4xLjEuMScsIHdlaWdodDo4MH0pO1xuICAgICAgICAgICAgICAgIGxpbmtzLnB1c2goe3NvdXJjZTogJzEwLjEuMS4xJywgdGFyZ2V0OiAnMTEuMS4xLjMnLCB3ZWlnaHQ6NTR9KTtcbiAgICAgICAgICAgICAgICBsaW5rcy5wdXNoKHtzb3VyY2U6ICcxMS4xLjEuNCcsIHRhcmdldDogJzEwLjEuMS4zJywgd2VpZ2h0OjQ4fSk7XG4gICAgICAgICAgICAgICAgbGlua3MucHVzaCh7c291cmNlOiAnMTAuMS4xLjMnLCB0YXJnZXQ6ICcxMS4xLjEuNCcsIHdlaWdodDoyNH0pO1xuICAgICAgICAgICAgICAgIGxpbmtzLnB1c2goe3NvdXJjZTogJzExLjEuMS41JywgdGFyZ2V0OiAnMTAuMS4xLjYnLCB3ZWlnaHQ6MjN9KTtcbiAgICAgICAgICAgICAgICBsaW5rcy5wdXNoKHtzb3VyY2U6ICcxMC4xLjEuNicsIHRhcmdldDogJzExLjEuMS41Jywgd2VpZ2h0OjU0fSk7XG4gICAgICAgICAgICAgICAgbGlua3MucHVzaCh7c291cmNlOiAnMTEuMS4xLjYnLCB0YXJnZXQ6ICcxMC4xLjEuNycsIHdlaWdodDo2NX0pO1xuICAgICAgICAgICAgICAgIGxpbmtzLnB1c2goe3NvdXJjZTogJzEwLjEuMS43JywgdGFyZ2V0OiAnMTEuMS4xLjYnLCB3ZWlnaHQ6NDN9KTtcbiAgICAgICAgICAgICAgICBsaW5rcy5wdXNoKHtzb3VyY2U6ICcxMS4xLjEuNycsIHRhcmdldDogJzEwLjEuMS44Jywgd2VpZ2h0OjkwfSk7XG4gICAgICAgICAgICAgICAgbGlua3MucHVzaCh7c291cmNlOiAnMTAuMS4xLjgnLCB0YXJnZXQ6ICcxMS4xLjEuNycsIHdlaWdodDo0OH0pO1xuICAgICAgICAgICAgICAgIGxpbmtzLnB1c2goe3NvdXJjZTogJzExLjEuMS44JywgdGFyZ2V0OiAnMTAuMS4xLjknLCB3ZWlnaHQ6NTR9KTtcbiAgICAgICAgICAgICAgICBsaW5rcy5wdXNoKHtzb3VyY2U6ICcxMC4xLjEuOScsIHRhcmdldDogJzExLjEuMS44Jywgd2VpZ2h0OjU0fSk7XG5cbiAgICAgICAgICAgICAgICAvL2FwcC1kYiBsaW5rc1xuICAgICAgICAgICAgICAgIGxpbmtzLnB1c2goe3NvdXJjZTogJzExLjEuMS44JywgdGFyZ2V0OiAnMTAuMS4xLjEwJywgd2VpZ2h0OjU0fSk7XG4gICAgICAgICAgICAgICAgbGlua3MucHVzaCh7c291cmNlOiAnMTAuMS4xLjEwJywgdGFyZ2V0OiAnMTEuMS4xLjgnLCB3ZWlnaHQ6Nzh9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge25vZGVzOm5vZGVzLCBsaW5rczpsaW5rc307XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzdHJ1Y3R1cmVEYXRhID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxhYmVscyA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCIxMC4xLjEuMTBcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJlbnZpcm9ubWVudFwiOiBcInByb2RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVsZWFzZVwiOiBcInN0YWJsZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ2ZXJzaW9uXCI6IFwiMS4wXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRpZXJcIjogXCJkYlwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjExXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZW52aXJvbm1lbnRcIjogXCJwcm9kXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJlbGVhc2VcIjogXCJzdGFibGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidmVyc2lvblwiOiBcIjEuMFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aWVyXCI6IFwiZGJcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBcIjEwLjEuMS4xMlwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImVudmlyb25tZW50XCI6IFwicHJvZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWxlYXNlXCI6IFwic3RhYmxlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInZlcnNpb25cIjogXCIxLjBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidGllclwiOiBcImRiXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXCIxMC4xLjEuMVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImVudmlyb25tZW50XCI6IFwicHJvZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWxlYXNlXCI6IFwic3RhYmxlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInZlcnNpb25cIjogXCIxLjBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidGllclwiOiBcIndlYlwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjlcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJlbnZpcm9ubWVudFwiOiBcInByb2RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVsZWFzZVwiOiBcInN0YWJsZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ2ZXJzaW9uXCI6IFwiMS4wXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRpZXJcIjogXCJ3ZWJcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBcIjEwLjEuMS44XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZW52aXJvbm1lbnRcIjogXCJwcm9kXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJlbGVhc2VcIjogXCJzdGFibGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidmVyc2lvblwiOiBcIjEuMFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aWVyXCI6IFwid2ViXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXCIxMC4xLjEuM1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImVudmlyb25tZW50XCI6IFwicHJvZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWxlYXNlXCI6IFwic3RhYmxlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInZlcnNpb25cIjogXCIxLjBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidGllclwiOiBcIndlYlwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjJcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJlbnZpcm9ubWVudFwiOiBcInByb2RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVsZWFzZVwiOiBcInN0YWJsZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ2ZXJzaW9uXCI6IFwiMS4wXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRpZXJcIjogXCJ3ZWJcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBcIjEwLjEuMS41XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZW52aXJvbm1lbnRcIjogXCJwcm9kXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJlbGVhc2VcIjogXCJzdGFibGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidmVyc2lvblwiOiBcIjEuMFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aWVyXCI6IFwid2ViXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXCIxMC4xLjEuNFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImVudmlyb25tZW50XCI6IFwicHJvZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWxlYXNlXCI6IFwic3RhYmxlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInZlcnNpb25cIjogXCIxLjBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidGllclwiOiBcIndlYlwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjdcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJlbnZpcm9ubWVudFwiOiBcInByb2RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVsZWFzZVwiOiBcInN0YWJsZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ2ZXJzaW9uXCI6IFwiMS4wXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRpZXJcIjogXCJ3ZWJcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBcIjEwLjEuMS42XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVsZWFzZVwiOiBcInN0YWJsZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aWVyXCI6IFwid2ViXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInZlcnNpb25cIjogXCIxLjBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZW52aXJvbm1lbnRcIjogXCJwcm9kXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIHNlcnZpY2VTZWxlY3RvcnMgPSB7XG4gICAgICAgICAgICAgICAgICAgIFwiYXBwLWRiXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidGllclwiOiBcImRiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJlbGVhc2VcIjogXCJzdGFibGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZW52aXJvbm1lbnRcIjogXCJwcm9kXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXCJhcHAtc3ZjXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidGllclwiOiBcIndlYlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWxlYXNlXCI6IFwic3RhYmxlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImVudmlyb25tZW50XCI6IFwicHJvZFwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJ0b3BMZXZlbFwiOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcC1zdmNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwLWRiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDAtc3ZjXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDAtZGJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwMS1zdmNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwMS1kYlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHAyLXN2Y1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHAyLWRiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDMtc3ZjXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDMtZGJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwNC1zdmNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwNC1kYlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHA1LXN2Y1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHA1LWRiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDYtc3ZjXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDYtZGJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwNy1zdmNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwNy1kYlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHA4LXN2Y1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHA4LWRiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDktc3ZjXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDktZGJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwMTAtc3ZjXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDEwLWRiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDExLXN2Y1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHAxMS1kYlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHAwMS1zdmNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwMDItZGJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwMDMtc3ZjXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDAzLWRiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDIwLXN2Y1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHAyMC1kYlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHAzMC1zdmNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwMzAtZGJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwNDAtc3ZjXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDQwLWRiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDUwLXN2Y1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHA1MC1kYlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHA2MC1zdmNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwNjAtZGJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwNzAtc3ZjXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDcwLWRiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcDgwLXN2Y1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHA4MC1kYlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHA5MC1zdmNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwOTAtZGJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwMTAwLXN2Y1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHAxMDAtZGJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwMTEwLXN2Y1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHAxMTAtZGJcIlxuXG4gICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgIC8vIFwiYXBwMC1zdmNcIjogW10sXG4gICAgICAgICAgICAgICAgICAgIC8vIFwiYXBwMC1kYlwiOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgXCJhcHAtc3ZjXCI6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjFcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjZcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjhcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjlcIlxuICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICBcImFwcC1kYlwiOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBcIjEwLjEuMS4xMFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCIxMC4xLjEuMTFcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiMTAuMS4xLjEyXCJcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBfLmZvckVhY2goY2hpbGRyZW5fc3RydWN0Wyd0b3BMZXZlbCddLCBmdW5jdGlvbihzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGlsZHJlbl9zdHJ1Y3Rbc10gPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW5fc3RydWN0W3NdID0gW107XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnNfc3RydWN0ID0ge307XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKGNoaWxkcmVuX3N0cnVjdFsnYXBwLXN2YyddLCBmdW5jdGlvbihzKSB7XG4gICAgICAgICAgICAgICAgICAgIGFuY2VzdG9yc19zdHJ1Y3Rbc10gPSBbJ2FwcC1zdmMnXTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfLmZvckVhY2goY2hpbGRyZW5fc3RydWN0WydhcHAtZGInXSwgZnVuY3Rpb24ocykge1xuICAgICAgICAgICAgICAgICAgICBhbmNlc3RvcnNfc3RydWN0W3NdID0gWydhcHAtZGInXTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiB7Y2hpbGRyZW5fc3RydWN0OmNoaWxkcmVuX3N0cnVjdCwgYW5jZXN0b3JzX3N0cnVjdDphbmNlc3RvcnNfc3RydWN0LFxuICAgICAgICAgICAgICAgICAgICBsYWJlbHM6bGFiZWxzLCBzZXJ2aWNlU2VsZWN0b3JzOnNlcnZpY2VTZWxlY3RvcnN9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgVmlzdWFsaXphdGlvblNlcnZpY2UuZ2V0R3JhcGhEYXRhKCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBncmFwaERhdGEoKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUubm9kZXMgPSBkYXRhLm5vZGVzO1xuICAgICAgICAgICAgICAgICRzY29wZS5saW5rcyA9IGRhdGEubGlua3M7XG4gICAgICAgICAgICAgICAgLy8gJHNjb3BlLmVuZHBvaW50cyA9IGVuZHBvaW50cztcbiAgICAgICAgICAgICAgICAvLyAkc2NvcGUucHJvdmlkZXJzID0gcHJvdmlkZXJzO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcIkNvdWxkbid0IGxvYWQgZ3JhcGggZGF0YVwiKTtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IGdyYXBoRGF0YSgpO1xuICAgICAgICAgICAgICAgICRzY29wZS5ub2RlcyA9IGRhdGEubm9kZXM7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxpbmtzID0gZGF0YS5saW5rcztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJHNjb3BlLmdyYXBoRGF0YUludGVydmFsID0gJGludGVydmFsKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIFZpc3VhbGl6YXRpb25TZXJ2aWNlLmdldEdyYXBoRGF0YSgpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IGdyYXBoRGF0YSgpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubm9kZXMgPSBkYXRhLm5vZGVzO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubGlua3MgPSBkYXRhLmxpbmtzO1xuICAgICAgICAgICAgICAgICAgICAvLyAkc2NvcGUuZW5kcG9pbnRzID0gZW5kcG9pbnRzO1xuICAgICAgICAgICAgICAgICAgICAvLyAkc2NvcGUucHJvdmlkZXJzID0gcHJvdmlkZXJzO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiQ291bGRuJ3QgbG9hZCBncmFwaCBkYXRhXCIpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IGdyYXBoRGF0YSgpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubm9kZXMgPSBkYXRhLm5vZGVzO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubGlua3MgPSBkYXRhLmxpbmtzO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSwgMzAwMCk7XG5cbiAgICAgICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkgeyAkaW50ZXJ2YWwuY2FuY2VsKCRzY29wZS5ncmFwaERhdGFJbnRlcnZhbCk7IH0pO1xuXG5cbiAgICAgICAgICAgIFZpc3VhbGl6YXRpb25TZXJ2aWNlLmdldFN0cnVjdHVyZURhdGEoKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcblxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gc3RydWN0dXJlRGF0YSgpO1xuICAgICAgICAgICAgICAgICRzY29wZS5hbmNlc3RvcnNfc3RydWN0ID0gZGF0YS5hbmNlc3RvcnNfc3RydWN0O1xuICAgICAgICAgICAgICAgICRzY29wZS5jaGlsZHJlbl9zdHJ1Y3QgPSBkYXRhLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICAkc2NvcGUubGFiZWxzID0gZGF0YS5sYWJlbHM7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlcnZpY2VTZWxlY3RvcnMgPSBkYXRhLnNlcnZpY2VTZWxlY3RvcnM7XG5cbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJDb3VsZG4ndCBsb2FkIHN0cnVjdHVyZSBkYXRhXCIpO1xuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gc3RydWN0dXJlRGF0YSgpO1xuICAgICAgICAgICAgICAgICRzY29wZS5hbmNlc3RvcnNfc3RydWN0ID0gZGF0YS5hbmNlc3RvcnNfc3RydWN0O1xuICAgICAgICAgICAgICAgICRzY29wZS5jaGlsZHJlbl9zdHJ1Y3QgPSBkYXRhLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICAkc2NvcGUubGFiZWxzID0gZGF0YS5sYWJlbHM7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlcnZpY2VTZWxlY3RvcnMgPSBkYXRhLnNlcnZpY2VTZWxlY3RvcnM7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfV0pO1xuXG4vKmFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZpc3VhbGl6YXRpb24ubGlzdCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1Zpc3VhbGl6YXRpb25MaXN0Q3RybCBhcyB2aXN1YWxpemF0aW9uTGlzdEN0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9ubGlzdC5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdWaXN1YWxpemF0aW9uTGlzdEN0cmwnLCBbXCIkc2NvcGVcIiwgXCIkaHR0cFwiLCAnVmlzdWFsaXphdGlvblNlcnZpY2UnLCAnJGludGVydmFsJywgXG4gICAgICAgIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsIFZpc3VhbGl6YXRpb25TZXJ2aWNlLCAkaW50ZXJ2YWwpIHtcbiAgICAgICAgICAgIC8vdG8gc2VlIHRoZSBleHBlY3RlZCBmb3JtYXQgdG8gYmUgcmV0dXJuZWQgZnJvbSB0aGVzZSBjYWxscyxcbiAgICAgICAgICAgIC8vbG9vayBhdCBhcHAvY29tcG9uZW50cy9ncmFwaG9iamVjdHMvZGF0YXNvdXJjZS92aXN1YWxpemVyZGF0YXNvdXJjZS5qc1xuICAgICAgICAgICAgdmFyIHN1Y2Nlc3NHcmFwaERhdGFDYWxsYmFjayA9IGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBsaW5rcyA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBub2RlSWRzID0gW107XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHJlc3VsdC5yZXN1bHRzWzBdLnNlcmllcywgZnVuY3Rpb24oc2VyaWVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbmRwb2ludCA9IHNlcmllcy50YWdzLkVuZHBvaW50SVA7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwcm92aWRlciA9IHNlcmllcy50YWdzLlByb3ZpZGVySVA7XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlO1xuICAgICAgICAgICAgICAgICAgICAvL2NyZWF0aW5nIG5vZGVzXG4gICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKG5vZGVJZHMsIGVuZHBvaW50KSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBlbmRwb2ludCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogZW5kcG9pbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50OiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2VzdG9yczogbnVsbFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzLnB1c2gobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzLnB1c2goZW5kcG9pbnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKG5vZGVJZHMsIHByb3ZpZGVyKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBwcm92aWRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogcHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50OiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2VzdG9yczogbnVsbFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzLnB1c2gobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzLnB1c2gocHJvdmlkZXIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vY3JlYXRpbmcgbGlua3NcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxpbmtPdXQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6IGVuZHBvaW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiBwcm92aWRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIHdlaWdodDogc2VyaWVzLnZhbHVlc1swXVsyXVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBsaW5rcy5wdXNoKGxpbmtPdXQpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGlua0luID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiBwcm92aWRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogZW5kcG9pbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ6IHNlcmllcy52YWx1ZXNbMF1bMV1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgbGlua3MucHVzaChsaW5rSW4pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICRzY29wZS5ub2RlcyA9IG5vZGVzO1xuICAgICAgICAgICAgICAgICRzY29wZS5saW5rcyA9IGxpbmtzO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIC8vaW5pdGlhbCBjYWxsXG4gICAgICAgICAgICBWaXN1YWxpemF0aW9uU2VydmljZS5nZXRHcmFwaERhdGEoKS50aGVuKHN1Y2Nlc3NHcmFwaERhdGFDYWxsYmFjaywgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAvL3dpbGwgZmFpbCBzaWxlbnRseSwgZ3JhcGggd29uJ3QgYmUgZGlzcGxheWVkXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7ICRpbnRlcnZhbC5jYW5jZWwoJHNjb3BlLmdyYXBoRGF0YUludGVydmFsKTsgfSk7XG5cbiAgICAgICAgICAgIFZpc3VhbGl6YXRpb25TZXJ2aWNlLmdldFN0cnVjdHVyZURhdGEoKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAvL3RvIHNlZSB0aGUgZXhwZWN0ZWQgZm9ybSBvZiBhbmNlc3Rvcl9zdHJ1Y3QgYW5kIGNoaWxkcmVuX3N0cnVjdCwgXG4gICAgICAgICAgICAgICAgLy9sb29rIGF0IGFwcC9jb21wb25lbnRzL2dyYXBob2JqZWN0cy9kYXRhc291cmNlL3Zpc3VhbGl6ZXJkYXRhc291cmNlLmpzXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFuY2VzdG9yc19zdHJ1Y3QgPSByZXN1bHQuYW5jZXN0b3JzX3N0cnVjdDtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2hpbGRyZW5fc3RydWN0ID0gcmVzdWx0LmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICAkc2NvcGUubGFiZWxzID0gcmVzdWx0LmxhYmVscztcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VydmljZVNlbGVjdG9ycyA9IHJlc3VsdC5zZXJ2aWNlU2VsZWN0b3JzO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAvL3dpbGwgZmFpbCBzaWxlbnRseSwgZ3JhcGggd29uJ3QgYmUgZGlzcGxheWVkXG4gICAgICAgICAgICB9KTtcbiAgICB9XSk7Ki9cblxuXG5cblxuXG5cblxuXG5cblxuXG4iLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nKVxuICAgIC5mYWN0b3J5KCdWaXN1YWxpemF0aW9uU2VydmljZScsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbiAoJGh0dHAsICRxKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYWtlcyBhIGdldCByZXF1ZXN0IHdpdGggdGhlIHVybCBhbmQgY29uZmlnLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgdXJsICAgICBUaGUgdXJsXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBjb25maWcgIFRoZSBjb25maWd1cmF0aW9uc1xuICAgICAgICAgKiBAcmV0dXJuICAgICB7JEh0dHAgUHJvbWlzZX0gICBQcm9taXNlIG9mIHRoZSByZXF1ZXN0XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBtYWtlR2V0KHVybCwgY29uZmlnKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCwgY29uZmlnKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogTWFrZXMgYSBwb3N0IHJlcXVlc3Qgd2l0aCB0aGUgdXJsIGFuZCBkYXRhXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICB1cmwgICAgIFRoZSB1cmxcbiAgICAgICAgICogQHBhcmFtICAgICAge0pTT059ICAgIGRhdGEgICAgVGhlIGRhdGFcbiAgICAgICAgICogQHJldHVybiAgICAgeyRIdHRwIFByb21pc2V9ICAgUHJvbWlzZSBvZiB0aGUgcmVxdWVzdFxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gbWFrZVBvc3QodXJsLCBkYXRhKSB7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIGNvbnZlcnRzIHRoZSBkYXRhIGludG8geC13d3ctZnJvbS11cmxlbmNvZGVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0pTT059ICBvYmogICAgIEpTT04gZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtzdHJpbmd9ICB4LXd3dy1mb3JtLXVybGVuY29kZWQgc3RyaW5nXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHZhciBwYXJhbSA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgICAgICAgICAgIHZhciBxdWVyeSA9ICcnLCBuYW1lLCB2YWx1ZSwgZnVsbFN1Yk5hbWUsIHN1Yk5hbWUsIHN1YlZhbHVlLCBpbm5lck9iaiwgaTtcbiAgICAgICAgICAgICAgICBmb3IgKG5hbWUgaW4gb2JqKSB7XG4gICAgICAgICAgICAgICAgICB2YWx1ZSA9IG9ialtuYW1lXTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpPTA7IGk8dmFsdWUubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJWYWx1ZSA9IHZhbHVlW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bGxTdWJOYW1lID0gbmFtZSArICdbJyArIGkgKyAnXSc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5uZXJPYmogPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbm5lck9ialtmdWxsU3ViTmFtZV0gPSBzdWJWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeSArPSBwYXJhbShpbm5lck9iaikgKyAnJic7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBPYmplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoc3ViTmFtZSBpbiB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlZhbHVlID0gdmFsdWVbc3ViTmFtZV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVsbFN1Yk5hbWUgPSBuYW1lICsgJ1snICsgc3ViTmFtZSArICddJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbm5lck9iaiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlubmVyT2JqW2Z1bGxTdWJOYW1lXSA9IHN1YlZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ICs9IHBhcmFtKGlubmVyT2JqKSArICcmJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmKHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ICs9IGVuY29kZVVSSUNvbXBvbmVudChuYW1lKSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkgKyAnJic7XG4gICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBxdWVyeS5sZW5ndGggPyBxdWVyeS5zdWJzdHIoMCwgcXVlcnkubGVuZ3RoIC0gMSkgOiBxdWVyeTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgdXJsOnVybCxcbiAgICAgICAgICAgICAgICBtZXRob2Q6J1BPU1QnLFxuICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEsXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm1SZXF1ZXN0OiBbZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYW5ndWxhci5pc09iamVjdChkYXRhKSAmJiBTdHJpbmcoZGF0YSkgIT09ICdbb2JqZWN0IEZpbGVdJyA/IHBhcmFtKGRhdGEpIDogZGF0YTtcbiAgICAgICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldEdyYXBoRGF0YSgpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLlZJU1VBTElaQVRJT05fRU5EUE9JTlQ7XG4gICAgICAgICAgICB1cmwgKz0gJ2luZmx1eC9xdWVyeSc7XG4gICAgICAgICAgICB2YXIgY29uZmlnID0ge1xuICAgICAgICAgICAgICAgIHBhcmFtczoge1xuICAgICAgICAgICAgICAgICAgICBkYjpcInRlbGVncmFmXCIsXG4gICAgICAgICAgICAgICAgICAgIHE6XCJTRUxFQ1QgQnl0ZXNJbiwgQnl0ZXNPdXQsIEVuZHBvaW50SVAsIFByb3ZpZGVySVAgRlJPTSBodHRwanNvbl9zdmNzdGF0cyBXSEVSRSB0aW1lID4gbm93KCkgLSAxbSBHUk9VUCBCWSAqIExJTUlUIDFcIlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gbWFrZUdldCh1cmwsIGNvbmZpZyk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRTdHJ1Y3R1cmVEYXRhKCkge1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuVklTVUFMSVpBVElPTl9FTkRQT0lOVDtcbiAgICAgICAgICAgIHVybCArPSAnc2VydmljZXMnO1xuICAgICAgICAgICAgcmV0dXJuIG1ha2VHZXQodXJsKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGJ1aWxkV2hlcmVRdWVyeShwb2ludHMsIHR5cGUpIHtcbiAgICAgICAgICAgIHZhciBxdWVyeSA9IFwiKFwiO1xuICAgICAgICAgICAgcXVlcnkgKz0gdHlwZSArIFwiPVwiO1xuICAgICAgICAgICAgcXVlcnkgKz0gXCInXCIgKyBwb2ludHNbMF0gKyBcIicgXCI7XG4gICAgICAgICAgICAvL3N0YXJ0cyBhdCAxLCBzbyB3aWxsIG5vdCBydW4gaWYgbGVuZ3RoIGlzIDFcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgcG9pbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcXVlcnkgKz0gJ09SICc7XG4gICAgICAgICAgICAgICAgcXVlcnkgKz0gdHlwZSArIFwiPVwiO1xuICAgICAgICAgICAgICAgIHF1ZXJ5ICs9IFwiJ1wiICsgcG9pbnRzW2ldICsgXCInIFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcXVlcnkgKz0gXCIpXCI7XG4gICAgICAgICAgICByZXR1cm4gcXVlcnk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRFZGdlRGF0YShzb3VyY2VMaXN0LCB0YXJnZXRMaXN0LCB0aW1lKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WSVNVQUxJWkFUSU9OX0VORFBPSU5UO1xuICAgICAgICAgICAgdXJsICs9ICdpbmZsdXgvcXVlcnknO1xuXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICAgICAgZGIgOiBcInRlbGVncmFmXCIsXG4gICAgICAgICAgICAgICAgICAgIHE6IFwiU0VMRUNUIHN1bShcIiArICdCeXRlc091dCcgKyBcIikgZnJvbSBodHRwanNvbl9zdmNzdGF0cyBXSEVSRSB0aW1lID4gbm93KCkgLSAxNXMgQU5EIFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkoc291cmNlTGlzdCwgXCJFbmRwb2ludElQXCIpICtcIiBBTkQgXCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkodGFyZ2V0TGlzdCwgJ1Byb3ZpZGVySVAnKSBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIFwiR1JPVVAgQlkgdGltZSgyMHMpIExJTUlUIDE7IFNFTEVDVCBzdW0oXCIgKyAnQnl0ZXNJbicgKyBcIikgZnJvbSBodHRwanNvbl9zdmNzdGF0cyBXSEVSRSB0aW1lID4gbm93KCkgLSAxNXMgQU5EIFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkoc291cmNlTGlzdCwgJ1Byb3ZpZGVySVAnKSArXCIgQU5EIFwiIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHRhcmdldExpc3QsICdFbmRwb2ludElQJykgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBcIkdST1VQIEJZIHRpbWUoMjBzKSBmaWxsKDApIExJTUlUIDFcIlxuICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBtYWtlUG9zdCh1cmwsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgXG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0T2xkRWRnZURhdGEoc291cmNlTGlzdCwgdGFyZ2V0TGlzdCkge1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuVklTVUFMSVpBVElPTl9FTkRQT0lOVDtcbiAgICAgICAgICAgIHVybCArPSAnaW5mbHV4L3F1ZXJ5JztcbiAgICAgICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICBkYiA6IFwidGVsZWdyYWZcIixcbiAgICAgICAgICAgICAgICAgICAgcTogXCJTRUxFQ1Qgc3VtKFwiICsgJ0J5dGVzT3V0JyArIFwiKSBGUk9NIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDFtIEFORCBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHNvdXJjZUxpc3QsIFwiRW5kcG9pbnRJUFwiKSArXCIgQU5EIFwiIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHRhcmdldExpc3QsIFwiUHJvdmlkZXJJUFwiKSBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIFwiIEdST1VQIEJZIHRpbWUoMTBzKSBmaWxsKDApIExJTUlUIDY7IFNFTEVDVCBzdW0oXCIgKyAnQnl0ZXNJbicgKyBcIikgRlJPTSBodHRwanNvbl9zdmNzdGF0cyBXSEVSRSB0aW1lID4gbm93KCkgLSAxbSBBTkQgXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeShzb3VyY2VMaXN0LCBcIlByb3ZpZGVySVBcIikgK1wiIEFORCBcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeSh0YXJnZXRMaXN0LCBcIkVuZHBvaW50SVBcIikgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBcIiBHUk9VUCBCWSB0aW1lKDEwcykgZmlsbCgwKSBMSU1JVCA2XCJcbiAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gbWFrZVBvc3QodXJsLCBkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRHcmFwaERhdGE6IGdldEdyYXBoRGF0YSxcbiAgICAgICAgICAgIGdldFN0cnVjdHVyZURhdGE6IGdldFN0cnVjdHVyZURhdGEsXG4gICAgICAgICAgICBnZXRFZGdlRGF0YTogZ2V0RWRnZURhdGEsXG4gICAgICAgICAgICBnZXRPbGRFZGdlRGF0YTogZ2V0T2xkRWRnZURhdGFcbiAgICAgICAgfVxuICAgIH1dKTtcblxuXG5cblxuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNi8zLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZvbHVtZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52b2x1bWVzLmNyZWF0ZScsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZvbHVtZXMvdm9sdW1lY3JlYXRlLmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWb2x1bWVDcmVhdGVDdHJsIGFzIHZvbHVtZUNyZWF0ZUN0cmwnXG4gICAgICAgICAgICB9KVxuICAgICAgICA7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1ZvbHVtZUNyZWF0ZUN0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnVm9sdW1lc01vZGVsJywgJ1N0b3JhZ2VQb2xpY2llc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICAgICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBWb2x1bWVzTW9kZWwsIFN0b3JhZ2VQb2xpY2llc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICAgICAgdmFyIHZvbHVtZUNyZWF0ZUN0cmwgPSB0aGlzO1xuICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5maWxlc3lzdGVtcyA9IFsnZXh0NCcsICdidHJmcyddO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1ZvbHVtZXNNb2RlbCgpIHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZvbHVtZXMubGlzdCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBjYW5jZWxDcmVhdGluZygpIHtcbiAgICAgICAgICAgICAgICByZXR1cm5Ub1ZvbHVtZXNNb2RlbCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEdldCBzdG9yYWdlIHBvbGljaWVzLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRTdG9yYWdlUG9saWNpZXMoKSB7XG4gICAgICAgICAgICAgICAgU3RvcmFnZVBvbGljaWVzTW9kZWwuZ2V0KCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwucG9saWNpZXMgPSByZXN1bHQ7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGFwcGx5UG9saWN5U2V0dGluZ3MoKSB7XG4gICAgICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUucG9saWN5ID0gdm9sdW1lQ3JlYXRlQ3RybC5zZWxlY3RlZFBvbGljeS5uYW1lO1xuICAgICAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwubmV3Vm9sdW1lLmJhY2tlbmRzID0gdm9sdW1lQ3JlYXRlQ3RybC5zZWxlY3RlZFBvbGljeS5iYWNrZW5kcztcbiAgICAgICAgICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLm5ld1ZvbHVtZS5kcml2ZXIgPSB2b2x1bWVDcmVhdGVDdHJsLnNlbGVjdGVkUG9saWN5LmRyaXZlcjtcbiAgICAgICAgICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLm5ld1ZvbHVtZS5jcmVhdGUgPSB2b2x1bWVDcmVhdGVDdHJsLnNlbGVjdGVkUG9saWN5LmNyZWF0ZTtcbiAgICAgICAgICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLm5ld1ZvbHVtZS5ydW50aW1lID0gdm9sdW1lQ3JlYXRlQ3RybC5zZWxlY3RlZFBvbGljeS5ydW50aW1lO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBjcmVhdGVWb2x1bWUoKSB7XG4gICAgICAgICAgICAgICAgLy9mb3JtIGNvbnRyb2xsZXIgaXMgaW5qZWN0ZWQgYnkgdGhlIGh0bWwgdGVtcGxhdGVcbiAgICAgICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgICAgIGlmICh2b2x1bWVDcmVhdGVDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcih2b2x1bWVDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIGFwcGx5UG9saWN5U2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgVm9sdW1lc01vZGVsLmNyZWF0ZSh2b2x1bWVDcmVhdGVDdHJsLm5ld1ZvbHVtZSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9Wb2x1bWVzTW9kZWwoKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Iodm9sdW1lQ3JlYXRlQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlc2V0Rm9ybSgpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcih2b2x1bWVDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLm5ld1ZvbHVtZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiYmFja2VuZHNcIjoge30sXG4gICAgICAgICAgICAgICAgICAgIFwiZHJpdmVyXCI6IHt9LFxuICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZVwiOiB7fSxcbiAgICAgICAgICAgICAgICAgICAgXCJydW50aW1lXCI6IHt9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5jcmVhdGVWb2x1bWUgPSBjcmVhdGVWb2x1bWU7XG4gICAgICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLmNhbmNlbENyZWF0aW5nID0gY2FuY2VsQ3JlYXRpbmc7XG5cbiAgICAgICAgICAgIGdldFN0b3JhZ2VQb2xpY2llcygpO1xuXG4gICAgICAgICAgICByZXNldEZvcm0oKTtcbiAgICAgICAgfV0pO1xuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA0LzE1LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZvbHVtZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52b2x1bWVzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1ZvbHVtZURldGFpbHNDdHJsIGFzIHZvbHVtZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZvbHVtZXMvdm9sdW1lZGV0YWlscy5odG1sJ1xuICAgICAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1ZvbHVtZURldGFpbHNDdHJsJyxcbiAgICAgICAgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGh0dHAnLCAnVm9sdW1lc01vZGVsJywgJ1ZvbHVtZVNlcnZpY2UnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgICAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRzY29wZSwgJGludGVydmFsLCAkaHR0cCwgVm9sdW1lc01vZGVsLCBWb2x1bWVTZXJ2aWNlLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICAgICAgdmFyIHZvbHVtZURldGFpbHNDdHJsID0gdGhpcztcblxuICAgICAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Wb2x1bWVzKCkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUudm9sdW1lcy5saXN0Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmdW5jdGlvbiBkZWxldGVWb2x1bWUoKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHZvbHVtZURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcih2b2x1bWVEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgVm9sdW1lc01vZGVsLmRlbGV0ZSh2b2x1bWVEZXRhaWxzQ3RybC52b2x1bWUpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9Wb2x1bWVzKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldFZvbHVtZUluZm8ocmVsb2FkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRva2VucyA9ICRzdGF0ZVBhcmFtcy5rZXkuc3BsaXQoJy8nKTtcbiAgICAgICAgICAgICAgICB2YXIgbW9kZWwgPXt9O1xuICAgICAgICAgICAgICAgIG1vZGVsLnBvbGljeSA9IHRva2Vuc1swXTtcbiAgICAgICAgICAgICAgICBtb2RlbC5uYW1lID0gdG9rZW5zWzFdO1xuICAgICAgICAgICAgICAgIFZvbHVtZXNNb2RlbC5nZXRNb2RlbChtb2RlbCwgcmVsb2FkKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAodm9sdW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2b2x1bWVEZXRhaWxzQ3RybC52b2x1bWUgPSB2b2x1bWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBnZXRWb2x1bWVVc2VJbmZvKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBnZXRWb2x1bWVTbmFwc2hvdHMoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldFZvbHVtZVVzZUluZm8oKSB7XG4gICAgICAgICAgICAgICAgVm9sdW1lU2VydmljZS5nZXRWb2x1bWVVc2VJbmZvKHZvbHVtZURldGFpbHNDdHJsLnZvbHVtZSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZvbHVtZURldGFpbHNDdHJsLnZvbHVtZVVzZSA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAvL1JldHVybnMgZXJyb3IgaWYgdm9sdW1lIGlzIG5vdCBtb3VudGVkIGJ5IGFueSBjb250YWluZXJcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0Vm9sdW1lU25hcHNob3RzKCkge1xuICAgICAgICAgICAgICAgIFZvbHVtZVNlcnZpY2UuZ2V0Vm9sdW1lU25hcHNob3RzKHZvbHVtZURldGFpbHNDdHJsLnZvbHVtZSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZvbHVtZURldGFpbHNDdHJsLnNuYXBzaG90cyA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiB0cmlnZ2VyVm9sdW1lU25hcHNob3QoKXtcbiAgICAgICAgICAgICAgICB2b2x1bWVEZXRhaWxzQ3RybC5zbmFwc2hvdFN1Y2Nlc3M9ZmFsc2U7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHZvbHVtZURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcih2b2x1bWVEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgVm9sdW1lU2VydmljZS50cmlnZ2VyU25hcHNob3Qodm9sdW1lRGV0YWlsc0N0cmwudm9sdW1lKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHZvbHVtZURldGFpbHNDdHJsLnNuYXBzaG90U3VjY2Vzcz10cnVlO1xuICAgICAgICAgICAgICAgIH0sICBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCl7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Iodm9sdW1lRGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZvbHVtZURldGFpbHNDdHJsLmRlbGV0ZVZvbHVtZSA9IGRlbGV0ZVZvbHVtZTtcbiAgICAgICAgICAgIHZvbHVtZURldGFpbHNDdHJsLnRyaWdnZXJWb2x1bWVTbmFwc2hvdCA9IHRyaWdnZXJWb2x1bWVTbmFwc2hvdDtcblxuICAgICAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgICAgICBnZXRWb2x1bWVJbmZvKGZhbHNlKTtcblxuXG4gICAgICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgICAgIC8vRG9uJ3QgZG8gYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGdldFZvbHVtZUluZm8odHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9XSk7IiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzIyLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZvbHVtZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52b2x1bWVzLmxpc3QnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWb2x1bWVMaXN0Q3RybCBhcyB2b2x1bWVMaXN0Q3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2b2x1bWVzL3ZvbHVtZWxpc3QuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignVm9sdW1lTGlzdEN0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdWb2x1bWVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgICAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIFZvbHVtZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgICAgIHZhciB2b2x1bWVMaXN0Q3RybCA9IHRoaXM7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldFZvbHVtZXMocmVsb2FkKSB7XG4gICAgICAgICAgICAgICAgVm9sdW1lc01vZGVsLmdldChyZWxvYWQpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdm9sdW1lTGlzdEN0cmwudm9sdW1lcyA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgICAgICBnZXRWb2x1bWVzKGZhbHNlKTtcblxuICAgICAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgICAgICAvL0Rvbid0IGRvIGF1dG8tcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBnZXRWb2x1bWVzKHRydWUpO1xuICAgICAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1dKTtcbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNi81LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZvbHVtZXMnKVxuICAgIC5mYWN0b3J5KCdWb2x1bWVTZXJ2aWNlJywgWyckaHR0cCcsICckcScsIGZ1bmN0aW9uICgkaHR0cCwgJHEpIHtcbiAgICAgICAgZnVuY3Rpb24gZ2V0Vm9sdW1lVXNlSW5mbyh2b2x1bWUpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WT0xVTUVTX1VTRVNfRU5EUE9JTlRcbiAgICAgICAgICAgICAgICArIHZvbHVtZS5wb2xpY3lcbiAgICAgICAgICAgICAgICArICcvJyArIHZvbHVtZS5uYW1lO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vUmV0dXJucyBlcnJvciBpZiB2b2x1bWUgaXMgbm90IG1vdW50ZWQgYnkgYW55IGNvbnRhaW5lclxuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0Vm9sdW1lU25hcHNob3RzKHZvbHVtZSkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLlZPTFVNRVNfU05BUFNIT1RTX0VORFBPSU5UXG4gICAgICAgICAgICAgICAgKyB2b2x1bWUucG9saWN5XG4gICAgICAgICAgICAgICAgKyAnLycgKyB2b2x1bWUubmFtZTtcbiAgICAgICAgICAgICRodHRwLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHRyaWdnZXJTbmFwc2hvdCh2b2x1bWUpe1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLlZPTFVNRVNfU05BUFNIT1RTX0VORFBPSU5UICsgXCJ0YWtlL1wiIFxuICAgICAgICAgICAgICAgICsgdm9sdW1lLnBvbGljeVxuICAgICAgICAgICAgICAgICsgJy8nICsgdm9sdW1lLm5hbWU7XG4gICAgICAgICAgICAkaHR0cC5wb3N0KHVybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KXtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KXtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpOyBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0Vm9sdW1lVXNlSW5mbzogZ2V0Vm9sdW1lVXNlSW5mbyxcbiAgICAgICAgICAgIGdldFZvbHVtZVNuYXBzaG90czogZ2V0Vm9sdW1lU25hcHNob3RzLFxuICAgICAgICAgICAgdHJpZ2dlclNuYXBzaG90OiB0cmlnZ2VyU25hcHNob3RcbiAgICAgICAgfVxuICAgIH1dKTsiLCIvKipcbiAqIENyZWF0ZWQgYnkgY3NoYW1wdXIgb24gOC85LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZvbHVtZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52b2x1bWVzLmNvcHknLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2NvcHkvJyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHtzbmFwc2hvdDpudWxsLCBwb2xpY3k6bnVsbCwgdm9sdW1lOm51bGx9LFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWb2x1bWVTbmFwc2hvdENvcHlDdHJsIGFzIHZvbHVtZVNuYXBzaG90Q29weUN0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndm9sdW1lcy92b2x1bWVzbmFwc2hvdGNvcHkuaHRtbCdcbiAgICAgICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdWb2x1bWVTbmFwc2hvdENvcHlDdHJsJyxcbiAgICAgICAgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGh0dHAnLCAnVm9sdW1lc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICAgICAgICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgJHNjb3BlLCAkaW50ZXJ2YWwsICRodHRwLCBWb2x1bWVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHZvbHVtZVNuYXBzaG90Q29weUN0cmwgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ29weSgpIHtcbiAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS52b2x1bWVzLmRldGFpbHMnLCB7a2V5OiRzdGF0ZVBhcmFtcy5wb2xpY3krJy8nKyRzdGF0ZVBhcmFtcy52b2x1bWV9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnb1RvTmV3Vm9sdW1lKCkge1xuICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZvbHVtZXMuZGV0YWlscycsIHtrZXk6JHN0YXRlUGFyYW1zLnBvbGljeSsnLycrdm9sdW1lU25hcHNob3RDb3B5Q3RybC5uZXd2b2x1bWV9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjb3B5U25hcHNob3QoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKHZvbHVtZVNuYXBzaG90Q29weUN0cmwuZm9ybS4kdmFsaWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHZvbHVtZVNuYXBzaG90Q29weUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIodm9sdW1lU25hcHNob3RDb3B5Q3RybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9kZWwgPXt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwucG9saWN5ID0gJHN0YXRlUGFyYW1zLnBvbGljeTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLm5hbWUgPSAkc3RhdGVQYXJhbXMudm9sdW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgVm9sdW1lc01vZGVsLmNvcHkobW9kZWwsICRzdGF0ZVBhcmFtcy5zbmFwc2hvdCwgdm9sdW1lU25hcHNob3RDb3B5Q3RybC5uZXd2b2x1bWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZVNuYXBzaG90Q29weUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb1RvTmV3Vm9sdW1lKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVTbmFwc2hvdENvcHlDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHZvbHVtZVNuYXBzaG90Q29weUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2b2x1bWVTbmFwc2hvdENvcHlDdHJsLnBvbGljeSA9ICRzdGF0ZVBhcmFtcy5wb2xpY3k7XG4gICAgICAgICAgICAgICAgdm9sdW1lU25hcHNob3RDb3B5Q3RybC52b2x1bWUgPSAkc3RhdGVQYXJhbXMudm9sdW1lO1xuICAgICAgICAgICAgICAgIHZvbHVtZVNuYXBzaG90Q29weUN0cmwuc25hcHNob3QgPSAkc3RhdGVQYXJhbXMuc25hcHNob3Q7XG4gICAgICAgICAgICAgICAgdm9sdW1lU25hcHNob3RDb3B5Q3RybC5jb3B5U25hcHNob3QgPSBjb3B5U25hcHNob3Q7XG4gICAgICAgICAgICAgICAgdm9sdW1lU25hcHNob3RDb3B5Q3RybC5jYW5jZWxDb3B5ID0gY2FuY2VsQ29weTtcbiAgICAgICAgICAgIH1dKTsiLCIvKipcbiAqIENyZWF0ZWQgYnkgY3NoYW1wdXIgb24gNy8xLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5kaXJlY3RpdmVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dkFjY29yZGlvblwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgaXRlbXM6ICc9JyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBsaW5rOmZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50KXtcbiAgICAgICAgICAgICAgICBpZih0eXBlb2YgZWxlbWVudC5maW5kKCcudWkuYWNjb3JkaW9uJykuYWNjb3JkaW9uID09ICdmdW5jdGlvbicpXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuZmluZCgnLnVpLmFjY29yZGlvbicpLmFjY29yZGlvbigpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9kaXJlY3RpdmVzL2FjY29yZGlvbi5odG1sJ1xuICAgICAgICB9XG4gICAgfSk7IiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA2LzIvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2Q29sbGFwc2libGVcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgdGl0bGU6ICdAJyxcbiAgICAgICAgICAgICAgICBjb2xsYXBzZWQ6ICdAJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2NvcGUuY29sbGFwc2VkID09PSB1bmRlZmluZWQpIHNjb3BlLmNvbGxhcHNlZCA9IHRydWU7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvY29sbGFwc2libGUuaHRtbCdcbiAgICAgICAgfVxuICAgIH0pO1xuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA0LzI4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5kaXJlY3RpdmVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dkVycm9yXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIGhlYWRlcjogJ0AnLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnPSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LmZpbmQoJ2knKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnbmctaGlkZScpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvZXJyb3JtZXNzYWdlLmh0bWwnXG4gICAgICAgIH1cbiAgICB9KTsiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTEvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2TmFtZXZhbHVlXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgIHJldHVybiB7XG4gICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICBpdGVtczogJz0nLFxuICAgICAgICAgICAgICAgbmFtZWhlYWRlcjogJ0AnLC8vRmllbGQgbmFtZSB0byBkaXNwbGF5IGZvciBrZXlcbiAgICAgICAgICAgICAgIHZhbHVlaGVhZGVyOiAnQCcsLy9GaWVsZCBuYW1lIHRvIGRpc3BsYXkgZm9yIHZhbHVlXG4gICAgICAgICAgICAgICB0eXBlOiAnQCcsLy8ndGV4dCcgb3IgJ3NlbGVjdCcgdG8gY2hvb3NlIGlucHV0IG9yIHNlbGVjdCBodG1sIHRhZyBmb3Iga2V5XG4gICAgICAgICAgICAgICBvcHRpb25zOiAnPScvL1RvIGJlIHVzZWQgd2hlbiB0eXBlIGlzICdzZWxlY3QnXG4gICAgICAgICAgIH0sXG4gICAgICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlKSB7XG4gICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIENvbXBhcmUgaWYgdHdvIGl0ZW1zIGhhdmUgc2FtZSBuYW1lXG4gICAgICAgICAgICAgICAgKiBAcGFyYW0gdmFsMVxuICAgICAgICAgICAgICAgICogQHBhcmFtIHZhbDJcbiAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICBmdW5jdGlvbiBjb21wYXJlKHZhbDEsIHZhbDIpIHtcbiAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsMS5uYW1lID09IHZhbDIubmFtZTtcbiAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgZnVuY3Rpb24gcmVzZXROZXdJdGVtKCkge1xuICAgICAgICAgICAgICAgICAgIHNjb3BlLm5ld0l0ZW0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogJydcbiAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICBmdW5jdGlvbiBpc0VtcHR5SXRlbShpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgcmV0dXJuIChpdGVtLm5hbWUgPT09ICcnICYmIGl0ZW0udmFsdWUgPT09ICcnKTtcbiAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgc2NvcGUuYWRkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgaWYgKGlzRW1wdHlJdGVtKHNjb3BlLm5ld0l0ZW0pKSByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgaWYgKHNjb3BlLml0ZW0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5pdGVtID0gW107XG4gICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgIC8vUmVtb3ZlcyBleGlzdGluZyBpdGVtIHdpdGggdGhlIHNhbWUgbmFtZSBmaXJzdCBpZiBpdCBleGlzdHMuXG4gICAgICAgICAgICAgICAgICAgXy5wdWxsQWxsV2l0aChzY29wZS5pdGVtcywgW3Njb3BlLm5ld0l0ZW1dLCBjb21wYXJlKTtcbiAgICAgICAgICAgICAgICAgICBzY29wZS5pdGVtcy5wdXNoKHNjb3BlLm5ld0l0ZW0pO1xuICAgICAgICAgICAgICAgICAgIHJlc2V0TmV3SXRlbSgpO1xuICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgc2NvcGUucmVtb3ZlID0gZnVuY3Rpb24ocGFzc2VkSXRlbSkge1xuICAgICAgICAgICAgICAgICAgIF8ucmVtb3ZlKHNjb3BlLml0ZW1zLCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5uYW1lID09IHBhc3NlZEl0ZW0ubmFtZTtcbiAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICByZXNldE5ld0l0ZW0oKTtcblxuICAgICAgICAgICAgICAgaWYgKHNjb3BlLm5hbWVoZWFkZXIgPT09IHVuZGVmaW5lZCkgc2NvcGUubmFtZWhlYWRlciA9ICdOYW1lJztcbiAgICAgICAgICAgICAgIGlmIChzY29wZS52YWx1ZWhlYWRlciA9PT0gdW5kZWZpbmVkKSBzY29wZS52YWx1ZWhlYWRlciA9ICdWYWx1ZSc7XG4gICAgICAgICAgICAgICBpZiAoc2NvcGUudHlwZSA9PT0gdW5kZWZpbmVkKSBzY29wZS50eXBlID0gJ3RleHQnO1xuICAgICAgICAgICB9LFxuICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy9uYW1ldmFsdWUuaHRtbCdcbiAgICAgICB9XG4gICAgfSk7XG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvNC8xNi5cbiAqL1xuXG4vKlxuRGlyZWN0aXZlIFVzYWdlIDpcblxuYSkgY3R2VGFibGUgLVxuICAgdXNhZ2UgOiA8Y3R2LXRhYmxlIGRlZmF1bHRzb3J0Y29sdW1uPSduYW1lJyBpdGVtcz0ndGFibGVJdGVtcycgZmlsdGVyZWRpdGVtcz0nZmlsdEl0ZW1zJyBzaXplPSdzaXplJz48L2N0di10YWJsZT5cbiAgIGF0dHJpYnV0ZSBkZXRhaWxzIDogIGRlZmF1bHRzb3J0Y29sdW1uIC0gVGhlIGRlZmF1bHQgY29sdW1uIG5hbWUoY29ycmVzcG9uZGluZyBrZXkgaW5zaWRlIHRoZSBvYmplY3Qgb2YgaXRlbXMgYXJyYXkpIG9uIHdoaWNoIHRoZSB0YWJsZSB3aWxsIGJlIHNvcnRlZCB3aGVuIGl0IGlzIGxvYWRlZC5cbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zIC0gQW4gYXJyYXkgb2Ygb2JqZWN0cyB3aGljaCB3aWxsIGJlIGRpc3BsYXllZCBieSB0aGUgY3R2LXRhYmxlIGRpcmVjdGl2ZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIHNpemUgLSBudW1iZXIgb2Ygcm93cyB0byBiZSBkaXNwbGF5ZWQgaW5zaWRlIHRoZSB0YWJsZS4gSWYgaXRlbXMubGVuZ3RoID4gc2l6ZSB0aGVuIHJlbWFpbmluZyBpdGVtc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbGwgYmUgZGlzcGxheWVkIGluIG5leHQgcGFnZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcmVkaXRlbXMgLSBUaGlzIGlzIGFuIG91dHB1dCBmaWVsZCB3aGljaCBwcm9kdWNlcyBhIGZpbHRlcmVkIHN1YnNldCBvZiBpdGVtcyBzcGVjZWZpZWQgYnlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGUgcHJldmlvdXMgYXR0cmlidXRlLCBJdGVtcyBhcmUgZmlsdGVyZWQgYmFzZWQgb24gc2VhcmNoIHRleHQgZGVmaW5lZCBpbnNpZGUgY3R2LXNlYXJjaCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmQgYnkgdGhlIHNpemUgbWVudGlvbmVkIGluIHRoZSBjdHYtdGFibGUgYXR0cmlidXRlXG5iKSBjdHZUSCAtXG4gICB1c2FnZSA6IDxjdHYtdGggc29ydGZpZWxkPSduYW1lJz5uYW1lPC9jdHYtdGg+XG4gICBhdHRyaWJ1dGUgZGV0YWlscyA6IHNvcnRmaWVsZCAtIFRoaXMgaXMgdGhlIGtleSBvZiB0aGUgb2JqZWN0IHByZXNlbnQgaW5zaWRlIGl0ZW1zIGFycmF5IHNwZWNlZmllZCBpbiBjdHZUYWJsZSwgZm9yIGVnIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdGhlIGFycmF5IG9iamVjdCBpcyA6IFt7aXA6IFwiMjAuMS4yLjNcIiwgaG9zdDogXCJjbHVzdGVyLTFcIn0se2lwOiBcIjIwLjEuMi40XCIsIGhvc3Q6IFwiY2x1c3Rlci0yXCJ9XVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGVuIGRpcmVjdGl2ZSB3aWxsIGJlIDxjdHYtdGggc29ydGZpZWxkPVwiJ2lwJ1wiPiBJcCBBZGRyZXNzIDwvY3R2LXRoPlxuICAgVGFibGUgY2FuIG9ubHkgYmUgc29ydGVkIG9uIGNvbHVtbnMgd2hpY2ggaGFzIHNvcnRmaWVsZCBhdHRyaWJ1dGUgc3BlY2VmaWVkLlxuXG5jKSBjdHZUc2VhcmNoIC1cbiAgIHVzYWdlIDogPGN0di10c2VhcmNoIHBsYWNlaG9sZGVyPSdTZWFyY2gnIHNpemU9JzMwJz48L2N0di10c2VhcmNoPlxuICAgYXR0cmlidXRlIGRldGFpbHMgOiBwbGFjZWhvbGRlciAtIHNwZWNpZnkgdGhlIHBsYWNlaG9sZGVyIGZvciB0aGUgaW5wdXQgdGV4dCBmaWVsZFxuICAgICAgICAgICAgICAgICAgICAgICBzaXplIC0gc3BlY2lmeSB0aGUgbWF4aW11bSBsZW5ndGggb2YgdGhlIHNlYXJjaCBzdHJpbmdcbiAgIE9ubHkgaXRlbXMgbWF0Y2hpbmcgdGhlIHNlYXJjaCBzdHJpbmcgYXJlIGRpc3BsYXllZCBpbnNpZGUgdGhlIHRhYmxlLlxuXG5kKSBjdHZUcGFnaW5hdGlvbiAtXG4gICB1c2FnZSA6IDxjdHYtdHBhZ2luYXRpb24+PC9jdHYtdHBhZ2luYXRpb24+XG4gICBQcm92aWRlcyBsaW5rIGZvciBtb3ZpbmcgYmFjayBhbmQgZm9ydGggb2YgdGhlIHJlc3VsdCBwYWdlLlxuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2VGFibGVcIiwgWydmaWx0ZXJGaWx0ZXInLCAnbGltaXRUb0ZpbHRlcicsIGZ1bmN0aW9uIChmaWx0ZXJGaWx0ZXIsIGxpbWl0VG9GaWx0ZXIpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBpdGVtczogJz0nLFxuICAgICAgICAgICAgICAgIGZpbHRlcmVkaXRlbXM6ICc9JyxcbiAgICAgICAgICAgICAgICBzaXplOiAnQCcsXG4gICAgICAgICAgICAgICAgZGVmYXVsdHNvcnRjb2x1bW46ICdAJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgJyRlbGVtZW50JywgJyRhdHRycycsICckZmlsdGVyJywgZnVuY3Rpb24gKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgJGZpbHRlcikge1xuICAgICAgICAgICAgICAgIHZhciB0YWJsZUN0cmwgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5jaHVua3MgPSBbXTtcbiAgICAgICAgICAgICAgICB0YWJsZUN0cmwucGFnZU5vID0gMDtcbiAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc29ydE9iaj1pbml0aWFsaXplU29ydCgkc2NvcGUuZGVmYXVsdHNvcnRjb2x1bW4pO1xuXG4gICAgICAgICAgICAgICAgdGFibGVDdHJsLnNpemUgPSBwYXJzZUludCgkc2NvcGUuc2l6ZSwgMTApO1xuICAgICAgICAgICAgICAgIGlmIChpc05hTih0YWJsZUN0cmwuc2l6ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNpemUgPSAxMjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBBbHdheXMgY2FsbCBzaG93Q2h1bmsgd2l0aCBib3RoIHBhcmFtZXRlcnMuXG4gICAgICAgICAgICAgICAgICogQHBhcmFtIHBhZ2VOb1xuICAgICAgICAgICAgICAgICAqIEBwYXJhbSBzZWFyY2hUZXh0XG4gICAgICAgICAgICAgICAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gc2hvd0NodW5rKHBhZ2VObywgc2VhcmNoVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc2VhcmNoVGV4dCA9IHNlYXJjaFRleHQ7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwYWdlTm8gPT09IHVuZGVmaW5lZCB8fCBwYWdlTm8gPCAwKSBwYWdlTm8gPSAwO1xuICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwucGFnZU5vID0gcGFnZU5vO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuaXRlbXMgIT09IHVuZGVmaW5lZCkgey8vVE9ETzogQ2hlY2sgd2h5IGl0ZW1zIGFyZSB1bmRlZmluZWQgZHVyaW5nIGluaXRpYWxpemF0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VhcmNoVGV4dEZpbHRlcmVkSXRlbXMgPSBmaWx0ZXJGaWx0ZXIoJHNjb3BlLml0ZW1zLCB0YWJsZUN0cmwuc2VhcmNoVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWFyY2hUZXh0RmlsdGVyZWRJdGVtcyA9ICRmaWx0ZXIoJ29yZGVyQnknKShzZWFyY2hUZXh0RmlsdGVyZWRJdGVtcywgdGFibGVDdHJsLnNvcnRPYmouZmllbGQsIHRhYmxlQ3RybC5zb3J0T2JqLnJldmVyc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5vT2ZDaHVua3MgPSBNYXRoLmNlaWwoc2VhcmNoVGV4dEZpbHRlcmVkSXRlbXMubGVuZ3RoIC8gdGFibGVDdHJsLnNpemUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vT2ZDaHVua3MgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vT2ZDaHVua3MgPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLmNodW5rcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub09mQ2h1bmtzOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuY2h1bmtzLnB1c2goe3NlbGVjdGVkOiBmYWxzZSwgcGFnZU5vOiBpfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vQWZ0ZXIgZmlsdGVyaW5nIG51bWJlciBvZiBjaHVua3MgY291bGQgY2hhbmdlIHNvIHJlc2V0IHBhZ2Ugbm8gaWYgaXQgaXMgZ3JlYXRlciB0aGFuIG5vIG9mIGNodW5rc1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhZ2VObyA+PSB0YWJsZUN0cmwuY2h1bmtzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5wYWdlTm8gPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLmNodW5rc1t0YWJsZUN0cmwucGFnZU5vXS5zZWxlY3RlZCA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vVXBkYXRlIG51bWJlciBvZiBjaHVua3MgZm9yIHBhZ2luYXRpb24gbWVudVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhYmxlQ3RybC5jaHVua3MubGVuZ3RoID4gNSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzbGljZVN0YXJ0LCBzbGljZUVuZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbGljZVN0YXJ0ID0gdGFibGVDdHJsLnBhZ2VObyAtIDI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xpY2VFbmQgPSB0YWJsZUN0cmwucGFnZU5vICsgMztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2xpY2VTdGFydCA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xpY2VFbmQgPSBzbGljZUVuZCAtIHNsaWNlU3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsaWNlU3RhcnQgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2xpY2VFbmQgPiB0YWJsZUN0cmwuY2h1bmtzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbGljZVN0YXJ0ID0gc2xpY2VTdGFydCAtIChzbGljZUVuZCAtIHRhYmxlQ3RybC5jaHVua3MubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xpY2VFbmQgPSB0YWJsZUN0cmwuY2h1bmtzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2luYXRpb25NZW51LmNodW5rcyA9IHRhYmxlQ3RybC5jaHVua3Muc2xpY2Uoc2xpY2VTdGFydCwgc2xpY2VFbmQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGFnaW5hdGlvbk1lbnUuY2h1bmtzID0gdGFibGVDdHJsLmNodW5rcztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLmZpbHRlcmVkSXRlbXMgPSBsaW1pdFRvRmlsdGVyKHNlYXJjaFRleHRGaWx0ZXJlZEl0ZW1zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zaXplLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5wYWdlTm8gKiB0YWJsZUN0cmwuc2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZmlsdGVyZWRpdGVtcz10YWJsZUN0cmwuZmlsdGVyZWRJdGVtcztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gc2hvd1ByZXZDaHVuaygpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByZXZDaHVuaztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRhYmxlQ3RybC5wYWdlTm8gPD0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJldkNodW5rID0gMDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZDaHVuayA9IHRhYmxlQ3RybC5wYWdlTm8gLSAxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzaG93Q2h1bmsocHJldkNodW5rKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBzaG93TmV4dENodW5rKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmV4dENodW5rO1xuICAgICAgICAgICAgICAgICAgICBuZXh0Q2h1bmsgPSB0YWJsZUN0cmwucGFnZU5vICsgMTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRDaHVuayA+IHRhYmxlQ3RybC5jaHVua3MubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dENodW5rID0gdGFibGVDdHJsLmNodW5rcy5sZW5ndGggLSAxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzaG93Q2h1bmsobmV4dENodW5rKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBTYXZlIHBhZ2luYXRpb24gc2NvcGUgdG8gcHJvdmlkZSBjaHVuayBpbmZvcm1hdGlvbiB0byBwYWdpbmF0aW9uIG1lbnUuXG4gICAgICAgICAgICAgICAgICogQHBhcmFtIG1lbnVcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhZGRQYWdpbmF0aW9uTWVudShtZW51KSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wYWdpbmF0aW9uTWVudSA9IG1lbnU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gaW5pdGlhbGl6ZVNvcnQoc29ydGZpZWxkKXtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkOnNvcnRmaWVsZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldmVyc2U6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgaWNvbkRpcmVjdGlvbjoge1wiYW5nbGUgZG93biBpY29uXCI6IHRydWUsIFwiYW5nbGUgdXAgaWNvblwiOiBmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNvcnQoc29ydGZpZWxkKXtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNvcnRmaWVsZCA9PSB0YWJsZUN0cmwuc29ydE9iai5maWVsZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc29ydE9iai5maWVsZCA9IHNvcnRmaWVsZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zb3J0T2JqLnJldmVyc2UgPSAhdGFibGVDdHJsLnNvcnRPYmoucmV2ZXJzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zb3J0T2JqLmljb25EaXJlY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhbmdsZSBkb3duIGljb25cIjogIXRhYmxlQ3RybC5zb3J0T2JqLnJldmVyc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhbmdsZSB1cCBpY29uXCI6IHRhYmxlQ3RybC5zb3J0T2JqLnJldmVyc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNvcnRPYmogPSBpbml0aWFsaXplU29ydChzb3J0ZmllbGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zaG93Q2h1bmsodGFibGVDdHJsLnBhZ2VObywgdGFibGVDdHJsLnNlYXJjaFRleHQpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGFibGVDdHJsLnNob3dDaHVuayA9IHNob3dDaHVuaztcbiAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc2hvd05leHRDaHVuayA9IHNob3dOZXh0Q2h1bms7XG4gICAgICAgICAgICAgICAgdGFibGVDdHJsLnNob3dQcmV2Q2h1bmsgPSBzaG93UHJldkNodW5rO1xuICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5hZGRQYWdpbmF0aW9uTWVudSA9IGFkZFBhZ2luYXRpb25NZW51O1xuICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zb3J0ID0gc29ydDtcbiAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRycywgdGFibGVDdHJsKSB7XG4gICAgICAgICAgICAgICAgLy9XYXRjaCBmb3IgaXRlbXMgYXMgdGhleSB3aWxsIGJlIGF1dG8gcmVmcmVzaGVkXG4gICAgICAgICAgICAgICAgc2NvcGUuJHBhcmVudC4kd2F0Y2goYXR0cnMuaXRlbXMsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNob3dDaHVuayh0YWJsZUN0cmwucGFnZU5vLCB0YWJsZUN0cmwuc2VhcmNoVGV4dCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy90YWJsZS5odG1sJ1xuICAgICAgICB9XG4gICAgfV0pXG4gICAgLmRpcmVjdGl2ZShcImN0dlRoZWFkXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPHRoZWFkIG5nLXRyYW5zY2x1ZGU+PC90aGVhZD4nXG4gICAgICAgIH1cbiAgICB9KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZUaFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICAgICAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICAgICAgICByZXF1aXJlOiAnXl5jdHZUYWJsZScsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIGNsYXNzOiAnQCcsXG4gICAgICAgICAgICAgICAgc29ydGZpZWxkOiAnPSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBsaW5rOmZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycywgdGFibGVDdHJsKXtcbiAgICAgICAgICAgICAgICBzY29wZS50YWJsZWN0cmwgPSB0YWJsZUN0cmw7XG4gICAgICAgICAgICAgICAgaWYoc2NvcGUuc29ydGZpZWxkICE9IHVuZGVmaW5lZCAmJiBzY29wZS5zb3J0ZmllbGQgIT0gbnVsbCl7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuYmluZCgnY2xpY2snLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNvcnQoc2NvcGUuc29ydGZpZWxkKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9kaXJlY3RpdmVzL3RhYmxlaGVhZGVyLmh0bWwnXG4gICAgICAgIH1cbiAgICB9KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZUYm9keVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgc2NvcGU6IHt9LFxuICAgICAgICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICAgICAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzx0Ym9keSBuZy10cmFuc2NsdWRlPjwvdGJvZHk+J1xuICAgICAgICB9XG4gICAgfSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2VGZvb3RcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHNjb3BlOiB7fSxcbiAgICAgICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXG4gICAgICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8dGZvb3QgbmctdHJhbnNjbHVkZT48L3Rmb290PidcbiAgICAgICAgfVxuICAgIH0pXG4gICAgLmRpcmVjdGl2ZShcImN0dlRzZWFyY2hcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHJlcXVpcmU6ICdeXmN0dlRhYmxlJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI6ICdAJyxcbiAgICAgICAgICAgICAgICBzaXplOiAnQCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIHRhYmxlQ3RybCkge1xuICAgICAgICAgICAgICAgIHNjb3BlLnNob3dDaHVuayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNob3dDaHVuayh0YWJsZUN0cmwucGFnZU5vLCBzY29wZS5zZWFyY2hUZXh0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvc2VhcmNoaW5wdXQuaHRtbCdcbiAgICAgICAgfVxuICAgIH0pXG4gICAgLmRpcmVjdGl2ZShcImN0dlRyXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0cmFuc2NsdWRlOiAndHJ1ZScsXG4gICAgICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICAgICAgc2NvcGU6IHt9LFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8dHIgbmctdHJhbnNjbHVkZT48L3RyPidcbiAgICAgICAgfVxuICAgIH0pXG4gICAgLmRpcmVjdGl2ZShcImN0dlRkXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgICAgIHNjb3BlOiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8dGQgbmctdHJhbnNjbHVkZT48L3RkPidcbiAgICAgICAgfVxuICAgIH0pXG4gICAgLmRpcmVjdGl2ZShcImN0dlRwYWdpbmF0aW9uXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICByZXF1aXJlOiAnXl5jdHZUYWJsZScsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIGNvbHNwYW46ICdAJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJlcGxhY2U6dHJ1ZSxcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0ciwgdGFibGVDdHJsKSB7XG4gICAgICAgICAgICAgICAgdGFibGVDdHJsLmFkZFBhZ2luYXRpb25NZW51KHNjb3BlKTtcbiAgICAgICAgICAgICAgICAvL3Nob3dDaHVuaygpIHdpbGwgY2FsY3VsYXRlIGFuZCBzZXQgY2h1bmtzIGluIHNjb3BlXG4gICAgICAgICAgICAgICAgdGFibGVDdHJsLnNob3dDaHVuayh0YWJsZUN0cmwucGFnZU5vLCB0YWJsZUN0cmwuc2VhcmNoVGV4dCk7XG4gICAgICAgICAgICAgICAgc2NvcGUuc2hvd0NodW5rID0gZnVuY3Rpb24gKHBhZ2VObykge1xuICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc2hvd0NodW5rKHBhZ2VObywgdGFibGVDdHJsLnNlYXJjaFRleHQpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgc2NvcGUuc2hvd1ByZXZDaHVuayA9IHRhYmxlQ3RybC5zaG93UHJldkNodW5rO1xuICAgICAgICAgICAgICAgIHNjb3BlLnNob3dOZXh0Q2h1bmsgPSB0YWJsZUN0cmwuc2hvd05leHRDaHVuaztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy9wYWdpbmF0aW9ubWVudS5odG1sJ1xuICAgICAgICB9XG4gICAgfSk7XG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMTEvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubW9kZWxzJylcbiAgICAuZmFjdG9yeSgnQXBwbGljYXRpb25Hcm91cHNNb2RlbCcsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbiAoJGh0dHAsICRxKSB7XG4gICAgICAgIHZhciBncm91cHNtb2RlbCA9IG5ldyBDb2xsZWN0aW9uKCRodHRwLCAkcSwgQ29udGl2R2xvYmFscy5BUFBMSUNBVElPTkdST1VQU19FTkRQT0lOVCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdlbmVyYXRlIGtleSBmb3IgYXBwbGljYXRpb24gZ3JvdXBcbiAgICAgICAgICogQHBhcmFtIGdyb3VwXG4gICAgICAgICAqL1xuICAgICAgICBncm91cHNtb2RlbC5nZW5lcmF0ZUtleSA9IGZ1bmN0aW9uIChncm91cCkge1xuICAgICAgICAgICAgcmV0dXJuIGdyb3VwLnRlbmFudE5hbWUgKyAnOicgKyBncm91cC5ncm91cE5hbWU7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGdyb3Vwc21vZGVsO1xuICAgIH1dKTsiLCIvKipcbiAqIENyZWF0ZWQgYnkgaGFyZGlrIGdhbmRoaSBvbiA2LzE1LzE2LlxuICovXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubW9kZWxzJylcbiAgICAuZmFjdG9yeSgnTmV0cHJvZmlsZXNNb2RlbCcsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbiAoJGh0dHAsICRxKSB7XG4gICAgICAgIHZhciBuZXRwcm9maWxlc01vZGVsID0gbmV3IENvbGxlY3Rpb24oJGh0dHAsICRxLCBDb250aXZHbG9iYWxzLk5FVFBST0ZJTEVTX0VORFBPSU5UKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogR2VuZXJhdGUgcG9saWN5IGtleSB0byBzYXZlIHBvbGljeSBvbiBzZXJ2ZXJcbiAgICAgICAgICogQHBhcmFtIHBvbGljeVxuICAgICAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgICAgICAgKi9cbiAgICAgICAgbmV0cHJvZmlsZXNNb2RlbC5nZW5lcmF0ZUtleSA9IGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgIHJldHVybiBwb2xpY3kudGVuYW50TmFtZSArICc6JyArIHBvbGljeS5wcm9maWxlTmFtZTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gbmV0cHJvZmlsZXNNb2RlbDtcbiAgICB9XSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2Lm1vZGVscycpXG4gICAgLmZhY3RvcnkoJ05ldHdvcmtzTW9kZWwnLCBbJyRodHRwJywgJyRxJywgZnVuY3Rpb24gKCRodHRwLCAkcSkge1xuICAgICAgICByZXR1cm4gbmV3IENvbGxlY3Rpb24oJGh0dHAsICRxLCBDb250aXZHbG9iYWxzLk5FVFdPUktTX0VORFBPSU5UKTtcbiAgICB9XSk7XG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMjIvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubW9kZWxzJylcbiAgICAuZmFjdG9yeSgnTm9kZXNNb2RlbCcsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbiAoJGh0dHAsICRxKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBOb2Rlc0NvbGxlY3Rpb24gZXh0ZW5kcyBmcm9tIEJhc2VDb2xsZWN0aW9uLiBJdCBvdmVycmlkZXMgZXh0cmFjdCgpIGFuZCBhZGRzIGNvbW1pc3Npb24sIGRlY29tbWlzc2lvbiwgdXBncmFkZSBhbmRcbiAgICAgICAgICogZGlzY292ZXIgbWV0aG9kc1xuICAgICAgICAgKiBAcGFyYW0gJGh0dHBcbiAgICAgICAgICogQHBhcmFtICRxXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gTm9kZXNDb2xsZWN0aW9uKCRodHRwLCAkcSkge1xuICAgICAgICAgICAgQmFzZUNvbGxlY3Rpb24uY2FsbCh0aGlzLCAkaHR0cCwgJHEsIENvbnRpdkdsb2JhbHMuTk9ERVNfTElTVF9FTkRQT0lOVCk7XG4gICAgICAgIH1cblxuICAgICAgICBOb2Rlc0NvbGxlY3Rpb24ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShCYXNlQ29sbGVjdGlvbi5wcm90b3R5cGUpO1xuXG4gICAgICAgIE5vZGVzQ29sbGVjdGlvbi5wcm90b3R5cGUuZXh0cmFjdCA9IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgIC8vQ29udmVydCB0byBhcnJheSBpZiB0aGUgcmV0dXJuZWQgY29sbGVjdGlvbiBpcyBub3QgYW4gYXJyYXlcbiAgICAgICAgICAgIHJldHVybiBfLm1hcChyZXN1bHQuZGF0YSwgZnVuY3Rpb24gKHZhbHVlLCBrZXkpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZS5rZXkgPSBrZXk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cblxuICAgICAgICAvKipcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIGtleVxuICAgICAgICAgKiBAcGFyYW0gZXh0cmFWYXJzIEpTT04gb2JqZWN0IG9mIGV4dHJhIGFuc2libGUgYW5kIGVudmlyb25tZW50IHZhcmlhYmxlcyB0byBiZSBwYXNzZWQgd2hpbGUgY29tbWlzc2lvbmluZyBhIG5vZGVcbiAgICAgICAgICoge1xuICAgICAgICAgICAgICogXCJlbnZcIjp7XCJodHRwX3Byb3h5XCI6XCJodHRwOi8vcHJveHkuZXNsLmNpc2NvLmNvbTo4MDgwXCIsIFwiaHR0cHNfcHJveHlcIjpcImh0dHA6Ly9wcm94eS5lc2wuY2lzY28uY29tOjgwODBcIn0sXG4gICAgICAgICAgICAgKiBcImNvbnRyb2xfaW50ZXJmYWNlXCI6IFwiZXRoMVwiLCBcInNlcnZpY2VfdmlwXCI6IFwiMTkyLjE2OC4yLjI1MlwiLCBcInZhbGlkYXRlX2NlcnRzXCI6IFwiZmFsc2VcIiwgXCJuZXRwbHVnaW5faWZcIiA6IFwiZXRoMlwiXG4gICAgICAgICAgICAgKiB9XG4gICAgICAgICAqIEByZXR1cm5zIHsqfVxuICAgICAgICAgKi9cbiAgICAgICAgTm9kZXNDb2xsZWN0aW9uLnByb3RvdHlwZS5jb21taXNzaW9uID0gZnVuY3Rpb24gKG5vZGVPcHNPYmopIHtcbiAgICAgICAgICAgIHZhciBub2Rlc2NvbGxlY3Rpb24gPSB0aGlzO1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gbm9kZXNjb2xsZWN0aW9uLiRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5OT0RFU19DT01NSVNTSU9OX0VORFBPSU5UO1xuICAgICAgICAgICAgbm9kZXNjb2xsZWN0aW9uLiRodHRwLnBvc3QodXJsLCBub2RlT3BzT2JqLCB7XG4gICAgICAgICAgICAgICAgICAgICdoZWFkZXJzJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9TZXJ2ZXIgZG9lc24ndCByZXR1cm4gYW55IGpzb24gaW4gcmVzcG9uc2VcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9O1xuXG4gICAgICAgIE5vZGVzQ29sbGVjdGlvbi5wcm90b3R5cGUuZGVjb21taXNzaW9uID0gZnVuY3Rpb24gKG5vZGVPcHNPYmopIHtcbiAgICAgICAgICAgIHZhciBub2Rlc2NvbGxlY3Rpb24gPSB0aGlzO1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gbm9kZXNjb2xsZWN0aW9uLiRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5OT0RFU19ERUNPTU1JU1NJT05fRU5EUE9JTlQ7XG4gICAgICAgICAgICBub2Rlc2NvbGxlY3Rpb24uJGh0dHAucG9zdCh1cmwsIG5vZGVPcHNPYmosIHtcbiAgICAgICAgICAgICAgICAgICAgJ2hlYWRlcnMnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH07XG5cbiAgICAgICAgTm9kZXNDb2xsZWN0aW9uLnByb3RvdHlwZS51cGdyYWRlID0gZnVuY3Rpb24gKG5vZGVPcHNPYmopIHtcbiAgICAgICAgICAgIHZhciBub2Rlc2NvbGxlY3Rpb24gPSB0aGlzO1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gbm9kZXNjb2xsZWN0aW9uLiRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5OT0RFU19NQUlOVEVOQU5DRV9FTkRQT0lOVDtcbiAgICAgICAgICAgIG5vZGVzY29sbGVjdGlvbi4kaHR0cC5wb3N0KHVybCwgbm9kZU9wc09iaiwge1xuICAgICAgICAgICAgICAgICAgICAnaGVhZGVycyc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfTtcblxuICAgICAgICAvKipcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIGlwXG4gICAgICAgICAqIEBwYXJhbSBleHRyYVZhcnMgSlNPTiBvYmplY3Qgb2YgZXh0cmEgYW5zaWJsZSBhbmQgZW52aXJvbm1lbnQgdmFyaWFibGVzIHRvIGJlIHBhc3NlZCB3aGlsZSBkaXNjb3ZlcmluZyBhIG5vZGVcbiAgICAgICAgICoge1xuICAgICAgICAgICAgICogXCJlbnZcIjp7XCJodHRwX3Byb3h5XCI6XCJodHRwOi8vcHJveHkuZXNsLmNpc2NvLmNvbTo4MDgwXCIsIFwiaHR0cHNfcHJveHlcIjpcImh0dHA6Ly9wcm94eS5lc2wuY2lzY28uY29tOjgwODBcIn0sXG4gICAgICAgICAgICAgKiBcImNvbnRyb2xfaW50ZXJmYWNlXCI6IFwiZXRoMVwiLCBcInNlcnZpY2VfdmlwXCI6IFwiMTkyLjE2OC4yLjI1MlwiLCBcImNsdXN0ZXItbmFtZVwiOiBcImNvbnRpdlwiLCBcIm5vZGUtbGFiZWxcIiA6IFwibm9kZTFcIlxuICAgICAgICAgICAgICogfVxuICAgICAgICAgKiBAcmV0dXJucyB7Kn1cbiAgICAgICAgICovXG4gICAgICAgIE5vZGVzQ29sbGVjdGlvbi5wcm90b3R5cGUuZGlzY292ZXIgPSBmdW5jdGlvbiAobm9kZU9wc09iaikge1xuICAgICAgICAgICAgdmFyIG5vZGVzY29sbGVjdGlvbiA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSBub2Rlc2NvbGxlY3Rpb24uJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLk5PREVTX0RJU0NPVkVSX0VORFBPSU5UO1xuICAgICAgICAgICAgbm9kZXNjb2xsZWN0aW9uLiRodHRwLnBvc3QodXJsLCBub2RlT3BzT2JqLCB7XG4gICAgICAgICAgICAgICAgICAgICdoZWFkZXJzJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgbm9kZXNtb2RlbCA9IG5ldyBOb2Rlc0NvbGxlY3Rpb24oJGh0dHAsICRxKTtcbiAgICAgICAgcmV0dXJuIG5vZGVzbW9kZWw7XG4gICAgfV0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5tb2RlbHMnKVxuICAgIC5mYWN0b3J5KCdPcmdhbml6YXRpb25zTW9kZWwnLCBbJyRodHRwJywgJyRxJywgZnVuY3Rpb24gKCRodHRwLCAkcSkge1xuICAgICAgICByZXR1cm4gbmV3IENvbGxlY3Rpb24oJGh0dHAsICRxLCBDb250aXZHbG9iYWxzLk9SR0FOSVpBVElPTlNfRU5EUE9JTlQpO1xuICAgIH1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2Lm1vZGVscycpXG4gICAgLmZhY3RvcnkoJ1BvbGljaWVzTW9kZWwnLCBbJyRodHRwJywgJyRxJywgZnVuY3Rpb24gKCRodHRwLCAkcSkge1xuICAgICAgICB2YXIgcG9saWNpZXNtb2RlbCA9IG5ldyBDb2xsZWN0aW9uKCRodHRwLCAkcSwgQ29udGl2R2xvYmFscy5QT0xJQ0lFU19FTkRQT0lOVCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdlbmVyYXRlIHBvbGljeSBrZXkgdG8gc2F2ZSBwb2xpY3kgb24gc2VydmVyXG4gICAgICAgICAqIEBwYXJhbSBwb2xpY3lcbiAgICAgICAgICogQHJldHVybnMge3N0cmluZ31cbiAgICAgICAgICovXG4gICAgICAgIHBvbGljaWVzbW9kZWwuZ2VuZXJhdGVLZXkgPSBmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICByZXR1cm4gcG9saWN5LnRlbmFudE5hbWUgKyAnOicgKyBwb2xpY3kucG9saWN5TmFtZTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gcG9saWNpZXNtb2RlbDtcbiAgICB9XSk7XG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5tb2RlbHMnKVxuICAgIC5mYWN0b3J5KCdSdWxlc01vZGVsJywgWyckaHR0cCcsICckcScsIGZ1bmN0aW9uICgkaHR0cCwgJHEpIHtcbiAgICAgICAgdmFyIHJ1bGVzbW9kZWwgPSBuZXcgQ29sbGVjdGlvbigkaHR0cCwgJHEsIENvbnRpdkdsb2JhbHMuUlVMRVNfRU5EUE9JTlQpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZXQgaW5jb21pbmcgcnVsZXMgZm9yIGEgZ2l2ZW4gcG9saWN5IGFuZCBhIHRlbmFudFxuICAgICAgICAgKiBAcGFyYW0gcG9saWN5TmFtZVxuICAgICAgICAgKiBAcGFyYW0gdGVuYW50TmFtZVxuICAgICAgICAgKiBAcmV0dXJucyB7Knx3ZWJkcml2ZXIucHJvbWlzZS5Qcm9taXNlfVxuICAgICAgICAgKi9cbiAgICAgICAgcnVsZXNtb2RlbC5nZXRJbmNvbWluZ1J1bGVzID0gZnVuY3Rpb24gKHBvbGljeU5hbWUsIHRlbmFudE5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiBydWxlc21vZGVsLmdldCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLmZpbHRlcihyZXN1bHQsIHtcbiAgICAgICAgICAgICAgICAgICAgJ3BvbGljeU5hbWUnOiBwb2xpY3lOYW1lLFxuICAgICAgICAgICAgICAgICAgICAnZGlyZWN0aW9uJzogJ2luJyxcbiAgICAgICAgICAgICAgICAgICAgJ3RlbmFudE5hbWUnOiB0ZW5hbnROYW1lXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZXQgb3V0Z29pbmcgcnVsZXMgZm9yIGEgZ2l2ZW4gcG9saWN5IGFuZCBhIHRlbmFudFxuICAgICAgICAgKiBAcGFyYW0gcG9saWN5TmFtZVxuICAgICAgICAgKiBAcGFyYW0gdGVuYW50TmFtZVxuICAgICAgICAgKiBAcmV0dXJucyB7Knx3ZWJkcml2ZXIucHJvbWlzZS5Qcm9taXNlfVxuICAgICAgICAgKi9cbiAgICAgICAgcnVsZXNtb2RlbC5nZXRPdXRnb2luZ1J1bGVzID0gZnVuY3Rpb24gKHBvbGljeU5hbWUsIHRlbmFudE5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiBydWxlc21vZGVsLmdldCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLmZpbHRlcihyZXN1bHQsIHtcbiAgICAgICAgICAgICAgICAgICAgJ3BvbGljeU5hbWUnOiBwb2xpY3lOYW1lLFxuICAgICAgICAgICAgICAgICAgICAnZGlyZWN0aW9uJzogJ291dCcsXG4gICAgICAgICAgICAgICAgICAgICd0ZW5hbnROYW1lJzogdGVuYW50TmFtZVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogR2VuZXJhdGUgcnVsZSBrZXkgdG8gc2F2ZSBydWxlIG9uIHNlcnZlclxuICAgICAgICAgKiBAcGFyYW0gcnVsZVxuICAgICAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgICAgICAgKi9cbiAgICAgICAgcnVsZXNtb2RlbC5nZW5lcmF0ZUtleSA9IGZ1bmN0aW9uIChydWxlKSB7XG4gICAgICAgICAgICByZXR1cm4gcnVsZS50ZW5hbnROYW1lICsgJzonICsgcnVsZS5wb2xpY3lOYW1lICsgJzonICsgcnVsZS5ydWxlSWQ7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHJ1bGVzbW9kZWw7XG4gICAgfV0pOyIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xMS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5tb2RlbHMnKVxuICAgIC5mYWN0b3J5KCdTZXJ2aWNlbGJzTW9kZWwnLCBbJyRodHRwJywgJyRxJywgZnVuY3Rpb24gKCRodHRwLCAkcSkge1xuICAgICAgICByZXR1cm4gbmV3IENvbGxlY3Rpb24oJGh0dHAsICRxLCBDb250aXZHbG9iYWxzLlNFUlZJQ0VMQlNfRU5EUE9JTlQpO1xuICAgIH1dKTtcbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNC8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5tb2RlbHMnKVxuICAgIC5mYWN0b3J5KCdTdG9yYWdlUG9saWNpZXNNb2RlbCcsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbiAoJGh0dHAsICRxKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTdG9yYWdlUG9saWNpZXNDb2xsZWN0aW9uIGV4dGVuZHMgZnJvbSBCYXNlQ29sbGVjdGlvblxuICAgICAgICAgKiBAcGFyYW0gJGh0dHBcbiAgICAgICAgICogQHBhcmFtICRxXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gU3RvcmFnZVBvbGljaWVzQ29sbGVjdGlvbigkaHR0cCwgJHEpIHtcbiAgICAgICAgICAgIENvbGxlY3Rpb24uY2FsbCh0aGlzLCAkaHR0cCwgJHEsIENvbnRpdkdsb2JhbHMuU1RPUkFHRVBPTElDSUVTX0VORFBPSU5UKTtcbiAgICAgICAgfVxuXG4gICAgICAgIFN0b3JhZ2VQb2xpY2llc0NvbGxlY3Rpb24ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShDb2xsZWN0aW9uLnByb3RvdHlwZSk7XG5cbiAgICAgICAgU3RvcmFnZVBvbGljaWVzQ29sbGVjdGlvbi5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24gKG1vZGVsKSB7XG4gICAgICAgICAgICB2YXIgY29sbGVjdGlvbiA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgdXJsID0gY29sbGVjdGlvbi51cmwgKyBtb2RlbC5uYW1lO1xuICAgICAgICAgICAgcmV0dXJuIENvbGxlY3Rpb24ucHJvdG90eXBlLmNyZWF0ZS5jYWxsKGNvbGxlY3Rpb24sIG1vZGVsLCB1cmwpO1xuICAgICAgICB9O1xuXG4gICAgICAgIFN0b3JhZ2VQb2xpY2llc0NvbGxlY3Rpb24ucHJvdG90eXBlLnNhdmUgPSBmdW5jdGlvbiAobW9kZWwpIHtcbiAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gdGhpcztcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9IGNvbGxlY3Rpb24uJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB1cmwgPSBjb2xsZWN0aW9uLnVybCArIG1vZGVsLm5hbWU7XG4gICAgICAgICAgICBjb2xsZWN0aW9uLiRodHRwLnBvc3QodXJsLCBtb2RlbClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgXy5yZW1vdmUoY29sbGVjdGlvbi5tb2RlbHMsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbi5uYW1lID09IG1vZGVsLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBjb2xsZWN0aW9uLm1vZGVscy5wdXNoKG1vZGVsKTtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShjb2xsZWN0aW9uLmV4dHJhY3QocmVzcG9uc2UpKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChjb2xsZWN0aW9uLmV4dHJhY3QocmVzcG9uc2UpKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgcG9saWNpZXNtb2RlbCA9IG5ldyBTdG9yYWdlUG9saWNpZXNDb2xsZWN0aW9uKCRodHRwLCAkcSk7XG4gICAgICAgIHJldHVybiBwb2xpY2llc21vZGVsO1xuICAgIH1dKTsiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMjIvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubW9kZWxzJylcbiAgICAuZmFjdG9yeSgnVm9sdW1lc01vZGVsJywgWyckaHR0cCcsICckcScsIGZ1bmN0aW9uICgkaHR0cCwgJHEpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFZvbHVtZXNDb2xsZWN0aW9uIGV4dGVuZHMgZnJvbSBCYXNlQ29sbGVjdGlvblxuICAgICAgICAgKiBAcGFyYW0gJGh0dHBcbiAgICAgICAgICogQHBhcmFtICRxXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gVm9sdW1lc0NvbGxlY3Rpb24oJGh0dHAsICRxKSB7XG4gICAgICAgICAgICBDb2xsZWN0aW9uLmNhbGwodGhpcywgJGh0dHAsICRxLCBDb250aXZHbG9iYWxzLlZPTFVNRVNfRU5EUE9JTlQpO1xuICAgICAgICB9XG5cbiAgICAgICAgVm9sdW1lc0NvbGxlY3Rpb24ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShDb2xsZWN0aW9uLnByb3RvdHlwZSk7XG5cbiAgICAgICAgVm9sdW1lc0NvbGxlY3Rpb24ucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uIChtb2RlbCkge1xuICAgICAgICAgICAgdmFyIHZvbHVtZXNjb2xsZWN0aW9uID0gdGhpcztcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9IHZvbHVtZXNjb2xsZWN0aW9uLiRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WT0xVTUVTX0RFTEVURV9FTkRQT0lOVDtcbiAgICAgICAgICAgIC8vZGVsZXRlIGVuZHBvaW50IGV4cGVjdHMgdm9sdW1lIHByb3BlcnR5IGluIGFkZGl0aW9uIHRvIHBvbGljeS4gVE9ETyBhc2sgdG8gYmUgZml4ZWRcbiAgICAgICAgICAgIG1vZGVsLnZvbHVtZSA9IG1vZGVsLm5hbWU7XG4gICAgICAgICAgICB2YXIgY29uZmlnID0ge1xuICAgICAgICAgICAgICAgIGRhdGE6IG1vZGVsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdm9sdW1lc2NvbGxlY3Rpb24uJGh0dHAuZGVsZXRlKHVybCwgY29uZmlnKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICBfLnJlbW92ZSh2b2x1bWVzY29sbGVjdGlvbi5tb2RlbHMsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKG4ubmFtZSA9PSBtb2RlbC5uYW1lICYmIG4ucG9saWN5ID09IG1vZGVsLnBvbGljeSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHZvbHVtZXNjb2xsZWN0aW9uLmV4dHJhY3QocmVzcG9uc2UpKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdCh2b2x1bWVzY29sbGVjdGlvbi5leHRyYWN0KHJlc3BvbnNlKSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfTtcblxuICAgICAgICBWb2x1bWVzQ29sbGVjdGlvbi5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24gKG1vZGVsKSB7XG4gICAgICAgICAgICB2YXIgY29sbGVjdGlvbiA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WT0xVTUVTX0NSRUFURV9FTkRQT0lOVDtcbiAgICAgICAgICAgIHJldHVybiBDb2xsZWN0aW9uLnByb3RvdHlwZS5jcmVhdGUuY2FsbChjb2xsZWN0aW9uLCBtb2RlbCwgdXJsKTtcbiAgICAgICAgfTtcblxuICAgICAgICBWb2x1bWVzQ29sbGVjdGlvbi5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChtb2RlbCwgc25hcHNob3QsIG5ld1ZvbHVtZSkge1xuICAgICAgICAgICAgdmFyIGNvbGxlY3Rpb24gPSB0aGlzO1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gY29sbGVjdGlvbi4kcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuVk9MVU1FU19DT1BZU05BUFNIT1RTX0VORFBPSU5UO1xuICAgICAgICAgICAgdmFyIHZvbGNvcHltb2RlbCA9IHtcbiAgICAgICAgICAgICAgICBuYW1lOiBtb2RlbC5uYW1lLFxuICAgICAgICAgICAgICAgIHBvbGljeTogbW9kZWwucG9saWN5LFxuICAgICAgICAgICAgICAgIE9wdGlvbnM6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiBuZXdWb2x1bWUsXG4gICAgICAgICAgICAgICAgICAgIHNuYXBzaG90OiBzbmFwc2hvdFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjb2xsZWN0aW9uLiRodHRwLnBvc3QodXJsLCB2b2xjb3B5bW9kZWwpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24ubW9kZWxzLnB1c2goY29sbGVjdGlvbi5leHRyYWN0KHJlc3BvbnNlKSk7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoY29sbGVjdGlvbi5leHRyYWN0KHJlc3BvbnNlKSk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoY29sbGVjdGlvbi5leHRyYWN0KHJlc3BvbnNlKSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgdm9sdW1lc21vZGVsID0gbmV3IFZvbHVtZXNDb2xsZWN0aW9uKCRodHRwLCAkcSk7XG4gICAgICAgIHJldHVybiB2b2x1bWVzbW9kZWw7XG4gICAgfV0pOyIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNC8yOS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi51dGlscycpXG4gICAgLmZhY3RvcnkoJ0NSVURIZWxwZXJTZXJ2aWNlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gc3RhcnRMb2FkZXIoY29udHJvbGxlcikge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuc2hvd0xvYWRlciA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHN0b3BMb2FkZXIoY29udHJvbGxlcikge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuc2hvd0xvYWRlciA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBzaG93U2VydmVyRXJyb3IoY29udHJvbGxlciwgbWVzc2FnZSkge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuc2hvd1NlcnZlckVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLnNlcnZlckVycm9yTWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGhpZGVTZXJ2ZXJFcnJvcihjb250cm9sbGVyKSB7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5zaG93U2VydmVyRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdGFydExvYWRlcjogc3RhcnRMb2FkZXIsXG4gICAgICAgICAgICAgICAgc3RvcExvYWRlcjogc3RvcExvYWRlcixcbiAgICAgICAgICAgICAgICBzaG93U2VydmVyRXJyb3I6IHNob3dTZXJ2ZXJFcnJvcixcbiAgICAgICAgICAgICAgICBoaWRlU2VydmVyRXJyb3I6IGhpZGVTZXJ2ZXJFcnJvclxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgKTtcbiIsIi8qKlxuICogQ3JlYXRlZCBieSBjc2hhbXB1ciBvbiA3LzE3LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi51dGlsc1wiKVxuICAgIC5mYWN0b3J5KFwiSW5zcGVjdFNlcnZpY2VcIiwgZnVuY3Rpb24oKXtcblxuICAgICAgICAvKiBUaGlzIGZ1bmN0aW9uIHdvdWxkIGJ1aWxkIHRoZSBjb250YWluZXJEZXRhaWxzIG9iamVjdC5cbiAgICAgICAgIGVnIDpcbiAgICAgICAgIGNvbnRhaW5lckRldGFpbHM9e1xuICAgICAgICAgQ29udGFpbmVySWQxIDogW3tuYW1lOiBcImhvbWluZ0hvc3RcIiwgdmFsdWU6IFwiY2x1c3Rlci1ub2RlMVwiLCB0eXBlOiBcInN0cmluZ1wiLCBmb3JtYXQ6IFwibm9uZVwifSxcbiAgICAgICAgIHtuYW1lOiBtYWNBZGRyZXNzLCB2YWx1ZTogXCIwMjowMlwiLCB0eXBlOlwic3RyaW5nXCIsIGZvcm1hdDpcIm5vbmVcIn1cbiAgICAgICAgIF0sXG4gICAgICAgICBDb250YWluZXJJZDIgOiBbe25hbWU6IFwiaG9taW5nSG9zdFwiLCB2YWx1ZTogXCJjbHVzdGVyLW5vZGUxXCIgdHlwZTogXCJzdHJpbmdcIiwgZm9ybWF0OiBcIm5vbmVcIn0sXG4gICAgICAgICB7bmFtZTogbWFjQWRkcmVzcywgdmFsdWU6IFwiMDI6MDRcIiwgdHlwZTogXCJzdHJpbmdcIiwgZm9ybWF0OiBcIm5vbmVcIn1cbiAgICAgICAgIF1cbiAgICAgICAgIH1cbiAgICAgICAgIC0tVXNlZCBpbiBkaXNwbGF5aW5nIHRoZSBjb250YWluZXIgZGV0YWlsIGluc2lkZSBhbiBhY2NvcmRpb24uXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBidWlsZEVuZFBvaW50cyhlbmRwb2ludHMpe1xuICAgICAgICAgICAgdmFyIGNvbnRhaW5lckRldGFpbHMgPSB7fTtcbiAgICAgICAgICAgIGZvcih2YXIgaSBpbiBlbmRwb2ludHMgKXtcbiAgICAgICAgICAgICAgICB2YXIgY29udGFpbmVyQXR0cmlidXRlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGZvcih2YXIga2V5IGluIGVuZHBvaW50c1tpXSl7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbmRwb2ludEF0dHJpYnV0ZSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBlbmRwb2ludEF0dHJpYnV0ZS5uYW1lID0ga2V5O1xuICAgICAgICAgICAgICAgICAgICBlbmRwb2ludEF0dHJpYnV0ZS5mb3JtYXQgPSAnbm9uZSc7XG4gICAgICAgICAgICAgICAgICAgIGVuZHBvaW50QXR0cmlidXRlLnR5cGUgPSAnc3RyaW5nJztcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChrZXkpe1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImlwQWRkcmVzc1wiIDogIGVuZHBvaW50QXR0cmlidXRlLnZhbHVlID0gZW5kcG9pbnRzW2ldW2tleV0uZmlsdGVyKGZ1bmN0aW9uKGlwQWRkcmVzcyl7cmV0dXJuIGlwQWRkcmVzcy5sZW5ndGggPiAwO30pLmpvaW4oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJsYWJlbHNcIiA6ICAgICBlbmRwb2ludEF0dHJpYnV0ZS52YWx1ZSA9IGVuZHBvaW50c1tpXVtrZXldLnJlcGxhY2UoLyhtYXBcXFt8XFxdKS9naSwnJykucmVwbGFjZSgvKDopL2dpLCAnPScpLnNwbGl0KCcgJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uKHYpe3JldHVybiB2Lmxlbmd0aCA+IDB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmRwb2ludEF0dHJpYnV0ZS5mb3JtYXQgPSAnbGFiZWwnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZHBvaW50QXR0cmlidXRlLnR5cGUgPSAnYXJyYXknO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdCA6ICAgICAgICAgICBlbmRwb2ludEF0dHJpYnV0ZS52YWx1ZSA9IGVuZHBvaW50c1tpXVtrZXldO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lckF0dHJpYnV0ZXMucHVzaChlbmRwb2ludEF0dHJpYnV0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnRhaW5lckRldGFpbHNbZW5kcG9pbnRzW2ldLmNvbnRhaW5lcklEXSA9IGNvbnRhaW5lckF0dHJpYnV0ZXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY29udGFpbmVyRGV0YWlsc1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvKiAgVGhpcyBmdW5jdGlvbiBjaGVja3Mgd2hldGhlciBhbnkgbmV3IGNvbnRhaW5lcnMgd2VyZSBhZGRlZCBvciBub3RcbiAgICAgICAgIFZpZXcgaXMgdXBkYXRlZCBvbmx5IHdoZW4gdGhlcmUgaXMgYSBjaGFuZ2UgaW4gY29udGFpbmVyIGNvbmZpZ3VyYXRpb25cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGNoZWNrQ29udGFpbmVyQ2hhbmdlZChjb250RGV0YWlsc0EsIGNvbnREZXRhaWxzQil7XG4gICAgICAgICAgICBpZihjb250RGV0YWlsc0EgPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICBpZihPYmplY3Qua2V5cyhjb250RGV0YWlsc0EpLmxlbmd0aCAhPSBPYmplY3Qua2V5cyhjb250RGV0YWlsc0IpLmxlbmd0aClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgZm9yKHZhciBrZXkgaW4gY29udERldGFpbHNCKXtcbiAgICAgICAgICAgICAgICAgICAgaWYoIShrZXkgaW4gY29udERldGFpbHNBKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBidWlsZEVuZFBvaW50cyA6IGJ1aWxkRW5kUG9pbnRzLFxuICAgICAgICAgICAgY2hlY2tDb250YWluZXJDaGFuZ2VkIDogY2hlY2tDb250YWluZXJDaGFuZ2VkXG4gICAgICAgIH1cbiAgICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYudXRpbHMnKVxuICAgIC5mYWN0b3J5KCdOZXR3b3JrU2VydmljZScsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbiAoJGh0dHAsICRxKSB7XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0U2V0dGluZ3MoKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuTkVUV09SS19TRVRUSU5HU19FTkRQT0lOVDtcbiAgICAgICAgICAgICRodHRwLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGFbMF0pO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZVNldHRpbmdzKHNldHRpbmcpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KENvbnRpdkdsb2JhbHMuTkVUV09SS19TRVRUSU5HU19FTkRQT0lOVCBcbiAgICAgICAgICAgICAgICArICdnbG9iYWwvJywgc2V0dGluZyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldFNldHRpbmdzOiBnZXRTZXR0aW5ncyxcbiAgICAgICAgICAgIHVwZGF0ZVNldHRpbmdzOiB1cGRhdGVTZXR0aW5nc1xuICAgICAgICB9XG4gICAgfV0pOyIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYudXRpbHMnKVxuICAgIC5mYWN0b3J5KCdOb2Rlc1NlcnZpY2UnLCBbJyRodHRwJywgJyRxJyxcbiAgICAgICAgZnVuY3Rpb24gKCRodHRwLCAkcSkge1xuICAgICAgICAgICAgdmFyIG5vZGVfY29uc3RhbnRzID0ge1xuICAgICAgICAgICAgICAgIEFQSUNfQ09OVFJfVU5SRVNUUklDVF9NT0RFOiAnYXBpY19jb250cmFjdHNfdW5yZXN0cmljdGVkX21vZGUnLFxuICAgICAgICAgICAgICAgIEFQSUNfRVBHX0JSSURHRV9ET01BSU46ICdhcGljX2VwZ19icmlkZ2VfZG9tYWluJyxcbiAgICAgICAgICAgICAgICBBUElDX0xFQUZfTk9ERVM6ICdhcGljX2xlYWZfbm9kZXMnLFxuICAgICAgICAgICAgICAgIEFQSUNfUEFTU1dPUkQ6ICdhcGljX3Bhc3N3b3JkJyxcbiAgICAgICAgICAgICAgICBBUElDX1BIWVNfRE9NQUlOOiAnYXBpY19waHlzX2RvbWFpbicsXG4gICAgICAgICAgICAgICAgQVBJQ19VUkw6ICdhcGljX3VybCcsXG4gICAgICAgICAgICAgICAgQVBJQ19VU0VSTkFNRTogJ2FwaWNfdXNlcm5hbWUnLFxuICAgICAgICAgICAgICAgIENPTlRJVl9ORVRfTU9ERTogJ2NvbnRpdl9uZXR3b3JrX21vZGUnLFxuICAgICAgICAgICAgICAgIENPTlRST0xfSU5URVJGQUNFOiAnY29udHJvbF9pbnRlcmZhY2UnLFxuICAgICAgICAgICAgICAgIEVOVjogJ2VudicsXG4gICAgICAgICAgICAgICAgRldEX01PREU6ICdmd2RfbW9kZScsXG4gICAgICAgICAgICAgICAgREFUQV9JTlRFUkZBQ0U6ICduZXRwbHVnaW5faWYnLFxuICAgICAgICAgICAgICAgIFNDSEVEX1BST1ZJREVSOiAnc2NoZWR1bGVyX3Byb3ZpZGVyJyxcbiAgICAgICAgICAgICAgICBWSVBfQUREUjogJ3NlcnZpY2VfdmlwJyxcbiAgICAgICAgICAgICAgICBVQ1BfQk9PVFNUUkFQX05PREU6ICd1Y3BfYm9vdHN0cmFwX25vZGVfbmFtZScsXG4gICAgICAgICAgICAgICAgQ0xVU1RFUl9OQU1FOiAnY2x1c3Rlcl9uYW1lJ307XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldFNldHRpbmdzKGN0cmwpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLk5PREVTX1NFVFRJTkdTX0dFVF9FTkRQT0lOVDtcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQodXJsKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIGN0cmwuc2V0dGluZyA9IHJlc3VsdC5kYXRhO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXh0cmFWYXJzID0gY3RybC5zZXR0aW5nLmV4dHJhX3ZhcnM7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzY2hlZF9wcm92aWRlciA9IGV4dHJhVmFyc1tub2RlX2NvbnN0YW50cy5TQ0hFRF9QUk9WSURFUl07XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXR3b3JrX21vZGUgPSBleHRyYVZhcnNbbm9kZV9jb25zdGFudHMuQ09OVElWX05FVF9NT0RFXTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoZXh0cmFWYXJzW25vZGVfY29uc3RhbnRzLkNPTlRST0xfSU5URVJGQUNFXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3RybC5leHRyYV92YXJzW25vZGVfY29uc3RhbnRzLkNPTlRST0xfSU5URVJGQUNFXSA9IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhVmFyc1tub2RlX2NvbnN0YW50cy5DT05UUk9MX0lOVEVSRkFDRV07IFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChleHRyYVZhcnNbbm9kZV9jb25zdGFudHMuREFUQV9JTlRFUkZBQ0VdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdHJsLmV4dHJhX3ZhcnNbbm9kZV9jb25zdGFudHMuREFUQV9JTlRFUkZBQ0VdID0gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmFWYXJzW25vZGVfY29uc3RhbnRzLkRBVEFfSU5URVJGQUNFXTsgXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4dHJhVmFyc1tub2RlX2NvbnN0YW50cy5WSVBfQUREUl0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0cmwuZXh0cmFfdmFyc1tub2RlX2NvbnN0YW50cy5WSVBfQUREUl0gPSBleHRyYVZhcnNbbm9kZV9jb25zdGFudHMuVklQX0FERFJdOyBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoc2NoZWRfcHJvdmlkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0cmwuZXh0cmFfdmFyc1tub2RlX2NvbnN0YW50cy5TQ0hFRF9QUk9WSURFUl0gPSBzY2hlZF9wcm92aWRlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzY2hlZF9wcm92aWRlciA9PT0gJ3VjcC1zd2FybScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHJsLmV4dHJhX3ZhcnNbbm9kZV9jb25zdGFudHMuVUNQX0JPT1RTVFJBUF9OT0RFXSA9IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHRyYVZhcnNbbm9kZV9jb25zdGFudHMuVUNQX0JPT1RTVFJBUF9OT0RFXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAobmV0d29ya19tb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdHJsLmV4dHJhX3ZhcnNbbm9kZV9jb25zdGFudHMuQ09OVElWX05FVF9NT0RFXSA9IG5ldHdvcmtfbW9kZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXR3b3JrX21vZGUgPT09ICdzdGFuZGFsb25lJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0cmwuZXh0cmFfdmFyc1tub2RlX2NvbnN0YW50cy5GV0RfTU9ERV0gPSBleHRyYVZhcnNbbm9kZV9jb25zdGFudHMuRldEX01PREVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAobmV0d29ya19tb2RlID09PSAnYWNpJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0cmwuZXh0cmFfdmFyc1tub2RlX2NvbnN0YW50cy5BUElDX0NPTlRSX1VOUkVTVFJJQ1RfTU9ERV0gPSBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmFWYXJzW25vZGVfY29uc3RhbnRzLkFQSUNfQ09OVFJfVU5SRVNUUklDVF9NT0RFXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHJsLmV4dHJhX3ZhcnNbbm9kZV9jb25zdGFudHMuQVBJQ19FUEdfQlJJREdFX0RPTUFJTl0gPSBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmFWYXJzW25vZGVfY29uc3RhbnRzLkFQSUNfRVBHX0JSSURHRV9ET01BSU5dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0cmwuZXh0cmFfdmFyc1tub2RlX2NvbnN0YW50cy5BUElDX0xFQUZfTk9ERVNdID0gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhVmFyc1tub2RlX2NvbnN0YW50cy5BUElDX0xFQUZfTk9ERVNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0cmwuZXh0cmFfdmFyc1tub2RlX2NvbnN0YW50cy5BUElDX1BBU1NXT1JEXSA9IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHRyYVZhcnNbbm9kZV9jb25zdGFudHMuQVBJQ19QQVNTV09SRF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3RybC5leHRyYV92YXJzW25vZGVfY29uc3RhbnRzLkFQSUNfUEhZU19ET01BSU5dID0gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhVmFyc1tub2RlX2NvbnN0YW50cy5BUElDX1BIWVNfRE9NQUlOXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHJsLmV4dHJhX3ZhcnNbbm9kZV9jb25zdGFudHMuQVBJQ19VUkxdID0gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhVmFyc1tub2RlX2NvbnN0YW50cy5BUElDX1VSTF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3RybC5leHRyYV92YXJzW25vZGVfY29uc3RhbnRzLkFQSUNfVVNFUk5BTUVdID0gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhVmFyc1tub2RlX2NvbnN0YW50cy5BUElDX1VTRVJOQU1FXTsgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoZXh0cmFWYXJzW25vZGVfY29uc3RhbnRzLkNMVVNURVJfTkFNRV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0cmwuZXh0cmFfdmFyc1tub2RlX2NvbnN0YW50cy5DTFVTVEVSX05BTUVdID1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHRyYVZhcnNbbm9kZV9jb25zdGFudHMuQ0xVU1RFUl9OQU1FXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVFbnZWYXJpYWJsZXMoZXh0cmFWYXJzW25vZGVfY29uc3RhbnRzLkVOVl0sIGN0cmwuZW52VmFyaWFibGVzKTtcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlQW5zaWJsZVZhcmlhYmxlcyhleHRyYVZhcnMsIGN0cmwuYW5zaWJsZVZhcmlhYmxlcyk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUVudlZhcmlhYmxlcyhlbnZWYXJzLCBlbnZWYXJpYWJsZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgaTtcbiAgICAgICAgICAgICAgICBmb3IgKGkgaW4gZW52VmFycykge1xuICAgICAgICAgICAgICAgICAgICBlbnZWYXJpYWJsZXMucHVzaCh7J25hbWUnOiBpLCAndmFsdWUnOiBlbnZWYXJzW2ldfSk7XG4gICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUFuc2libGVWYXJpYWJsZXMoZXh0cmFWYXJzLCBhbnNpYmxlVmFyaWFibGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNldHRpbmdfZmlsdGVyID0gW25vZGVfY29uc3RhbnRzLkFQSUNfQ09OVFJfVU5SRVNUUklDVF9NT0RFLFxuICAgICAgICAgICAgICAgICAgICBub2RlX2NvbnN0YW50cy5BUElDX0VQR19CUklER0VfRE9NQUlOLCBub2RlX2NvbnN0YW50cy5BUElDX0xFQUZfTk9ERVMsIFxuICAgICAgICAgICAgICAgICAgICBub2RlX2NvbnN0YW50cy5BUElDX1BBU1NXT1JELCBub2RlX2NvbnN0YW50cy5BUElDX1BIWVNfRE9NQUlOLCBcbiAgICAgICAgICAgICAgICAgICAgbm9kZV9jb25zdGFudHMuQVBJQ19VUkwsIG5vZGVfY29uc3RhbnRzLkFQSUNfVVNFUk5BTUUsIFxuICAgICAgICAgICAgICAgICAgICBub2RlX2NvbnN0YW50cy5DT05USVZfTkVUX01PREUsIG5vZGVfY29uc3RhbnRzLkNPTlRST0xfSU5URVJGQUNFLCBcbiAgICAgICAgICAgICAgICAgICAgbm9kZV9jb25zdGFudHMuRU5WLCBub2RlX2NvbnN0YW50cy5GV0RfTU9ERSwgbm9kZV9jb25zdGFudHMuREFUQV9JTlRFUkZBQ0UsIFxuICAgICAgICAgICAgICAgICAgICBub2RlX2NvbnN0YW50cy5TQ0hFRF9QUk9WSURFUiwgbm9kZV9jb25zdGFudHMuVklQX0FERFIsIFxuICAgICAgICAgICAgICAgICAgICBub2RlX2NvbnN0YW50cy5VQ1BfQk9PVFNUUkFQX05PREUsIG5vZGVfY29uc3RhbnRzLkNMVVNURVJfTkFNRV07XG4gICAgICAgICAgICAgICAgdmFyIGk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKGkgaW4gZXh0cmFWYXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZXR0aW5nX2ZpbHRlci5pbmRleE9mKGkpID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW5zaWJsZVZhcmlhYmxlcy5wdXNoKHsnbmFtZSc6IGksICd2YWx1ZSc6IGV4dHJhVmFyc1tpXX0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gdXBkYXRlU2V0dGluZ3Mobm9kZU9wc09iaikge1xuICAgICAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KENvbnRpdkdsb2JhbHMuTk9ERVNfU0VUVElOR1NfU0VUX0VORFBPSU5ULCBub2RlT3BzT2JqLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnaGVhZGVycyc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gY3JlYXRlRXh0cmFWYXJzKGN0cmwpIHtcbiAgICAgICAgICAgICAgICAvL0FkZCBhbnNpYmxlIHZhcmlhYmxlcyB0byBleHRyYV92YXJzXG4gICAgICAgICAgICAgICAgY3RybC5hbnNpYmxlVmFyaWFibGVzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgY3RybC5leHRyYV92YXJzW2l0ZW0ubmFtZV0gPSBpdGVtLnZhbHVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgLy9BZGQgZW52aXJvbm1lbnQgdmFyaWFibGVzIHRvIGV4dHJhX3ZhcnNcbiAgICAgICAgICAgICAgICB2YXIgZW52VmFycyA9IHt9O1xuICAgICAgICAgICAgICAgIGN0cmwuZW52VmFyaWFibGVzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgZW52VmFyc1tpdGVtLm5hbWVdID0gaXRlbS52YWx1ZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBjdHJsLmV4dHJhX3ZhcnNbbm9kZV9jb25zdGFudHMuRU5WXSA9IGVudlZhcnM7XG4gICAgICAgICAgICAgICAgY3RybC5ub2RlT3BzT2JqLmV4dHJhX3ZhcnMgPSBKU09OLnN0cmluZ2lmeShjdHJsLmV4dHJhX3ZhcnMpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDbGVhbnVwIGFuc2libGUgdmFyaWFibGVzIGZvciBuZXR3b3JrIG1vZGUgYW5kIHNjaGVkdWxlci4gbmctaWYgcmVtb3ZlcyBpdCBmcm9tIHRoZSB2aWV3IChET00pIGJ1dCBub3QgZnJvbVxuICAgICAgICAgICAgICogdGhlIG1vZGVsLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmdW5jdGlvbiBjbGVhbnVwRXh0cmFWYXJzKGN0cmwpIHtcbiAgICAgICAgICAgICAgICAvL0NsZWFudXAgZm9yIG5ldHdvcmsgbW9kZVxuICAgICAgICAgICAgICAgIGlmIChjdHJsLmV4dHJhX3ZhcnNbbm9kZV9jb25zdGFudHMuQ09OVElWX05FVF9NT0RFXSA9PSAnYWNpJykge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgY3RybC5leHRyYV92YXJzW25vZGVfY29uc3RhbnRzLkZXRF9NT0RFXTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgY3RybC5leHRyYV92YXJzW25vZGVfY29uc3RhbnRzLkFQSUNfVVJMXTtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGN0cmwuZXh0cmFfdmFyc1tub2RlX2NvbnN0YW50cy5BUElDX1VTRVJOQU1FXTtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGN0cmwuZXh0cmFfdmFyc1tub2RlX2NvbnN0YW50cy5BUElDX1BBU1NXT1JEXTtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGN0cmwuZXh0cmFfdmFyc1tub2RlX2NvbnN0YW50cy5BUElDX0xFQUZfTk9ERVNdO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgY3RybC5leHRyYV92YXJzW25vZGVfY29uc3RhbnRzLkFQSUNfUEhZU19ET01BSU5dO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgY3RybC5leHRyYV92YXJzW25vZGVfY29uc3RhbnRzLkFQSUNfRVBHX0JSSURHRV9ET01BSU5dO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgY3RybC5leHRyYV92YXJzW25vZGVfY29uc3RhbnRzLkFQSUNfQ09OVFJfVU5SRVNUUklDVF9NT0RFXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9DbGVhbnVwIGZvciBzY2hlZHVsZXJcbiAgICAgICAgICAgICAgICBpZiAoY3RybC5leHRyYV92YXJzW25vZGVfY29uc3RhbnRzLlNDSEVEX1BST1ZJREVSXSA9PSAnbmF0aXZlLXN3YXJtJykge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgY3RybC5leHRyYV92YXJzW25vZGVfY29uc3RhbnRzLlVDUF9CT09UU1RSQVBfTk9ERV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0U2V0dGluZ3M6IGdldFNldHRpbmdzLFxuICAgICAgICAgICAgY3JlYXRlRW52VmFyaWFibGVzOiBjcmVhdGVFbnZWYXJpYWJsZXMsXG4gICAgICAgICAgICBjcmVhdGVBbnNpYmxlVmFyaWFibGVzOiBjcmVhdGVBbnNpYmxlVmFyaWFibGVzLFxuICAgICAgICAgICAgdXBkYXRlU2V0dGluZ3M6IHVwZGF0ZVNldHRpbmdzLFxuICAgICAgICAgICAgY3JlYXRlRXh0cmFWYXJzOiBjcmVhdGVFeHRyYVZhcnMsXG4gICAgICAgICAgICBjbGVhbnVwRXh0cmFWYXJzOiBjbGVhbnVwRXh0cmFWYXJzXG4gICAgICAgIH1cbiAgICB9XSk7IiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi51dGlscycpXG4gICAgLmZhY3RvcnkoJ1ZvbHVtZVNldHRpbmdTZXJ2aWNlJywgWyckaHR0cCcsICckcScsIGZ1bmN0aW9uICgkaHR0cCwgJHEpIHtcblxuICAgICAgICBmdW5jdGlvbiBnZXRTZXR0aW5ncygpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WT0xVTUVTX0dMT0JBTF9FTkRQT0lOVDtcbiAgICAgICAgICAgICRodHRwLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZVNldHRpbmdzKHNldHRpbmcpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KENvbnRpdkdsb2JhbHMuVk9MVU1FU19HTE9CQUxfRU5EUE9JTlQsIHNldHRpbmcpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldFNldHRpbmdzOiBnZXRTZXR0aW5ncyxcbiAgICAgICAgICAgIHVwZGF0ZVNldHRpbmdzOiB1cGRhdGVTZXR0aW5nc1xuICAgICAgICB9XG4gICAgfV0pOyIsImFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2QWNpdmFsaWRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9kaXJlY3RpdmVzL25vZGVzL2FjaXZhbGlkLmh0bWwnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBmb3JtOiBcIj1cIlxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pOyIsImFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2Q29udHJvbGludGVyZmFjZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvbm9kZXMvY29udHJvbGludGVyZmFjZS5odG1sJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgZXh0cmF2YXJzOiBcIj1cIlxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pOyIsImFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2TmV0d29ya21vZGVcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9kaXJlY3RpdmVzL25vZGVzL25ldHdvcmttb2RlLmh0bWwnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBleHRyYXZhcnM6IFwiPVwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7IiwiYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZTY2hlZHVsZXJcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9kaXJlY3RpdmVzL25vZGVzL3NjaGVkdWxlci5odG1sJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgZXh0cmF2YXJzOiBcIj1cIlxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
