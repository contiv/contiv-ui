"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}angular.module("contiv.graph",[]),angular.module("contiv.directives",[]),angular.module("contiv.models",[]);var ContivGlobals=function(){return{NETWORKS_ENDPOINT:"/netmaster/api/v1/networks/",NETWORKS_INSPECT_ENDPOINT:"/netmaster/api/v1/inspect/networks/",SERVICELBS_INSPECT_ENDPOINT:"/netmaster/api/v1/inspect/serviceLBs/",POLICIES_ENDPOINT:"/netmaster/api/v1/policys/",RULES_ENDPOINT:"/netmaster/api/v1/rules/",APPLICATIONGROUPS_ENDPOINT:"/netmaster/api/v1/endpointGroups/",SERVICELBS_ENDPOINT:"/netmaster/api/v1/serviceLBs/",ORGANIZATIONS_ENDPOINT:"/netmaster/api/v1/tenants/",NETWORK_SETTINGS_ENDPOINT:"/netmaster/api/v1/globals/",NETPROFILES_ENDPOINT:"/netmaster/api/v1/netprofiles/",BGPS_ENDPOINT:"/netmaster/api/v1/Bgps/",BGPS_INSPECT_ENDPOINT:"/netmaster/api/v1/inspect/Bgps/",VISUALIZATION_ENDPOINT:"/visualization/",VOLUMES_ENDPOINT:"/volmaster/volumes/",VOLUMES_CREATE_ENDPOINT:"/volmaster/volumes/create/",VOLUMES_DELETE_ENDPOINT:"/volmaster/volumes/remove/",VOLUMES_COPYSNAPSHOTS_ENDPOINT:"/volmaster/volumes/copy",VOLUMES_USES_ENDPOINT:"/volmaster/uses/mounts/",VOLUMES_SNAPSHOTS_ENDPOINT:"/volmaster/snapshots/",STORAGEPOLICIES_ENDPOINT:"/volmaster/policies/",VOLUMES_GLOBAL_ENDPOINT:"/volmaster/global/",NODES_LIST_ENDPOINT:"/info/nodes",NODES_DISCOVER_ENDPOINT:"/discover/nodes",NODES_COMMISSION_ENDPOINT:"/commission/nodes",NODES_DECOMMISSION_ENDPOINT:"/decommission/nodes",NODES_MAINTENANCE_ENDPOINT:"/maintenance/nodes",NODES_LAST_JOB_ENDPOINT:"/info/job/last",NODES_ACTIVE_JOB_ENDPOINT:"/info/job/active",NODES_SETTINGS_SET_ENDPOINT:"/globals",NODES_SETTINGS_GET_ENDPOINT:"/info/globals",REFRESH_INTERVAL:5e3,CIDR_REGEX:"^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]).){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(/([0-9]|[1-2][0-9]|3[0-2]))$",VLAN_REGEX:"^([0-9]{1,4}?-[0-9]{1,4}?)$",VXLAN_REGEX:"^([0-9]{1,8}?-[0-9]{1,8}?)$",NUMBER_REGEX:"^[0-9]*$"}}(),_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();angular.module("contiv.graph").factory("DataSource",["Node","Link",function(t,e){var n=function(){function n(t,e){_classCallCheck(this,n),this.nodes=t,this.links=e}return _createClass(n,[{key:"updateNodes",value:function(t){this.nodes=t}},{key:"updateLinks",value:function(t){this.links=t}},{key:"nodeIdToName",value:function(t){for(var e=this.nodes,n=0;n<e.length;n++)if(e[n].id==t)return e[n].name}},{key:"processNodeData",value:function(e){var n=[];return _.forEach(e,function(e){var o=new t.Node(null,null,e.id,e.text,null);n.push(o)}),n}},{key:"processLinkData",value:function(t,n){function o(t,e){for(var n=0;n<e.length;n++)if(t==e[n].id)return e[n]}for(var i=[],r=0;r<t.length;r++)if(t[r].source!=t[r].target){var a=o(t[r].source,n),s=o(t[r].target,n);if(null==a||null==s)continue;var l=new e.Link(a,s);i.push(l)}return i}}]),n}();return{DataSource:n}}]),angular.module("contiv.utils",[]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();angular.module("contiv.graph").factory("VisualizerDataSource",["DataSource","VisualizerNode","VisualizerLink",function(t,e,n){var o=function(t){function o(t,e,n,i,r,a){_classCallCheck(this,o);var s=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t,e));return s.children_struct=n,s.ancestors_struct=i,s.labels=r,s.selectors=a,s}return _inherits(o,t),_createClass(o,[{key:"hasChild",value:function(t){return null!=this.children_struct[t]}},{key:"setAncestors",value:function(){var t=this,e=!1;_.forEach(t.nodes,function(n){n.ancestors=t.ancestors_struct[n.id]||[],_.isEmpty(n.ancestors)===!1?n.parent=n.ancestors[0]:0==_.includes(t.children_struct.topLevel,n.id)&&(n.ancestors.push("client"),t.ancestors_struct[n.id]=["client"],e===!1&&(e=!0,t.children_struct.topLevel.push("client"),t.children_struct.client=[]),t.children_struct.client.push(n.id))})}},{key:"getTopLevelFlow",value:function(){return this.getFlowBetweenSet(this.children_struct.topLevel)}},{key:"getFlowBetweenSet",value:function(t){for(var e=this.nodes,n={},o=0;o<e.length;o++){var i=e[o];if(null===i.ancestors)n[i.id]=i.name;else for(var r=0;r<t.length;r++)if(i.ancestors.indexOf(t[r])>-1){n[i.id]=t[r];break}}for(var a=this.links,s=[],o=0;o<a.length;o++){var l=[];l.source=n[a[o].source]||a[o].source,l.target=n[a[o].target]||a[o].target,l.weight=a[o].weight,s.push(l)}for(var c=[],o=0;o<t.length;o++){var u=[];u.id=t[o],u.text=this.nodeIdToName(t[o])||t[o],u.ancestors=this.ancestors_struct[t[o]]||this.ancestors_struct[u.text]||[],_.isEmpty(u.ancestors)===!1?u.parent=u.ancestors[0]:u.parent=null,c.push(u)}return{nodeData:c,linkData:s}}},{key:"processNodeData",value:function(t){var n=[];return _.forEach(t,function(t){var o=new e.Node(null,null,t.id,t.text,null,t.parent,t.ancestors,null,null);n.push(o)}),n}},{key:"processLinkData",value:function(t,e){function o(t,e){for(var n=0;n<e.length;n++)if(t==e[n].id)return e[n]}for(var i=[],r={},a=0;a<t.length;a++)if(t[a].source!=t[a].target){var s=o(t[a].source,e),l=o(t[a].target,e),c=t[a].weight;if(null==s||null==l)continue;if(void 0===r[s.id+"-"+l.id]){var u=new n.Link(s,l,c);r[s.id+"-"+l.id]=u,i.push(u)}else{var d=r[s.id+"-"+l.id];d.setWeight(d.getRawWeight()+c),d.increaseCount()}}return i}}]),o}(t.DataSource);return{DataSource:o}}]),angular.module("contiv.applicationgroups",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(t){t.state("contiv.menu.applicationgroups",{url:"/applicationgroups","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.applicationgroups.create",{url:"/create",component:"applicationgroupcreate"}).state("contiv.menu.applicationgroups.details",{url:"/details/:key",component:"applicationgroupdetails"}).state("contiv.menu.applicationgroups.edit",{url:"/edit/:key",component:"applicationgroupdetails"}).state("contiv.menu.applicationgroups.list",{url:"/list",component:"applicationGrouplist"})}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();angular.module("contiv.graph").factory("Graph",["PolicyService",function(t){var e=function(){function e(n,o,i){_classCallCheck(this,e);var r=this;r.nodes=o||[],r.links=i||[],r.defaultNodePolicies=[],r.defaultPathPolicies=[],r.svgPolicy=new t.Policy,r.state={canZoom:!0,canPan:!0,initForce:!1,disableUpdate:!1},r.consts={circleGClass:"conceptG",graphClass:"graph",pathClass:"path",nodeClass:"circle",nodeText:"nodeText",startRadius:50,maxRadius:60,padding:5,displayOffset:60},n.on("mouseover",function(t){r.svgPolicy.mouseover.call(this,t)}).on("dblclick",function(t){r.svgPolicy.dblclick.call(this,t)}).on("contextmenu",function(t){r.svgPolicy.contextmenu.call(this,t)}).on("mouseout",function(t){r.svgPolicy.mouseout.call(this,t)}).on("mousedown",function(t){r.svgPolicy.mousedown.call(this,t)}).on("mouseup",function(t){r.svgPolicy.mouseup.call(this,t)});var a=n.append("svg:defs");a.append("svg:marker").attr("id","end-arrow").attr("viewBox","0 -5 10 10").attr("refX",20).attr("refY",-1).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5"),a.append("svg:marker").attr("id","mark-end-arrow").attr("viewBox","0 -5 10 10").attr("refX",7).attr("markerWidth",3.5).attr("markerHeight",3.5).attr("orient","auto").append("svg:path").attr("d","M0,-5L10,0L0,5"),r.svg=n,r.svgG=n.append("g").classed(r.consts.graphClass,!0);var s=r.svgG;r.paths=s.append("g").selectAll("g"),r.circles=s.append("g").selectAll("g"),r.initNodes(),r.initLinks(),r.setPositions();var l=function(){r.onWindowResize(n)};r.bindings={resize:l},$(window).resize(l)}return _createClass(e,[{key:"destroy",value:function(){var t=this;_(t.defaultNodePolicies).forEach(function(t){t.destroy()}),_(t.defaultPathPolicies).forEach(function(t){t.destroy()}),t.svgPolicy.destroy();for(var e in t.bindings)$(window).off(e,t.bindings[e])}},{key:"initNodes",value:function(){var t=this;_.forEach(t.nodes,function(e){e.initialize(t)})}},{key:"initLinks",value:function(){var t=this;_.forEach(t.links,function(e){e.initialize(t)})}},{key:"findNodeById",value:function(t){for(var e=this,n=0;n<e.nodes.length;n++)if(t===e.nodes[n].id)return e.nodes[n]}},{key:"findD3Node",value:function(t){var e,n=this;return n.circles.each(function(n){n.id===t&&(e=d3.select(this))}),e}},{key:"installDragPolicy",value:function(t){this.drag=t}},{key:"installSvgPolicy",value:function(t){this.svgPolicy=t}},{key:"installDefaultNodePolicy",value:function(t){var e=this;e.defaultNodePolicies.push(t),t.initialize(e)}},{key:"uninstallDefaultNodePolicy",value:function(t){var e;e="string"==typeof t?t:t.policyName,_(thisGraph.defaultNodePolicies).forEach(function(t,n){t.policyName===e&&(t.destroy(),thisGraph.defaultNodePolicies.splice(n,1))})}},{key:"getNodePolicy",value:function(t){var e=this;_(e.defaultNodePolicies).forEach(function(e,n){return e.policyName===t?e:void 0})}},{key:"installDefaultPathPolicy",value:function(t){var e=this;e.defaultPathPolicies.push(t),t.initialize(e)}},{key:"uninstallDefaultPathPolicy",value:function(t){var e,n=this;e="string"==typeof t?t:t.policyName,_(n.defaultPathPolicies).forEach(function(t,o){t.policyName===e&&(t.destroy(),n.defaultPathPolicies.splice(o,1))})}},{key:"pathPolicyEvent",value:function(t,e,n){var o=this;_(o.defaultPathPolicies).forEach(function(o){o[t](e,n)})}},{key:"nodePolicyEvent",value:function(t,e,n){var o=this;_.forEach(o.defaultNodePolicies,function(o){o[t](e,n)})}},{key:"installZoomPolicy",value:function(t){this.dragSvg=t,this.svg.call(this.dragSvg)}},{key:"onWindowResize",value:function(t){}},{key:"insertTitleLinebreaks",value:function(t,e){for(var n=this,o=e.split(/\s+/g),i=o.length,r=t.append("text").attr("class",n.consts.nodeText).attr("text-anchor","middle").attr("dy","-"+7.5*(i-1)),a=0;a<o.length;a++){var s=r.append("tspan").text(o[a]);a>0&&s.attr("x",0).attr("dy","15")}}},{key:"spliceLinksForNode",value:function(t){var e=this,n=e.links.filter(function(e){return e.source===t||e.target===t});n.map(function(t){e.links.splice(e.links.indexOf(t),1)})}},{key:"addNode",value:function(t){var e=this;e.nodes.push(t),t.initialize(e),e.updateGraph()}},{key:"removeNode",value:function(t){var e=this;e.nodes.splice(e.nodes.indexOf(t),1),e.spliceLinksForNode(t),e.updateGraph()}},{key:"addLink",value:function(t){var e=this;e.links.push(t),t.initialize(e),e.updateGraph()}},{key:"removeLink",value:function(t){var e=this;e.links.splice(e.links.indexOf(t),1),t.initialize(e),e.updateGraph()}},{key:"updateExistingPaths",value:function(t){t.each(function(t){t.updateAttr(d3.select(this),t)})}},{key:"updateNewPaths",value:function(t){var e=this;e.initLinks(),t.each(function(t){t.newPathAttr(d3.select(this),t)}),t.on("mouseover",function(t){t.hasPolicy?t.pathPolicyEvent("mouseover",d3.select(this),t):e.pathPolicyEvent("mouseover",d3.select(this),t)}).on("dblclick",function(t){t.hasPolicy?t.pathPolicyEvent("dblclick",d3.select(this),t):e.pathPolicyEvent("dblclick",d3.select(this),t)}).on("contextmenu",function(t){t.hasPolicy?t.pathPolicyEvent("contextmenu",d3.select(this),t):e.pathPolicyEvent("contextmenu",d3.select(this),t)}).on("mouseout",function(t){t.hasPolicy?t.pathPolicyEvent("mouseout",d3.select(this),t):e.pathPolicyEvent("mouseout",d3.select(this),t)}).on("mousedown",function(t){t.hasPolicy?t.pathPolicyEvent("mousedown",d3.select(this),t):e.pathPolicyEvent("mousedown",d3.select(this),t)}).on("mouseup",function(t){t.hasPolicy?t.pathPolicyEvent("mouseup",d3.select(this),t):e.pathPolicyEvent("mouseup",d3.select(this),t)}).call(e.drag)}},{key:"updateExistingNodes",value:function(){var t=this;t.circles=this.circles.data(t.nodes,function(t){return t.id}).each(function(t){t.updateAttr(d3.select(this),t)})}},{key:"updateNewNodes",value:function(t){var e=this;t.each(function(t){null==t.graph&&t.initialize(e),t.newNodeAttr(d3.select(this),t)}),t.on("mouseover",function(t){t.hasPolicy?t.nodePolicyEvent("mouseover",d3.select(this),t):e.nodePolicyEvent("mouseover",d3.select(this),t)}).on("dblclick",function(t){t.hasPolicy?t.nodePolicyEvent("dblclick",d3.select(this),t):e.nodePolicyEvent("dblclick",d3.select(this),t)}).on("contextmenu",function(t){t.hasPolicy?t.nodePolicyEvent("contextmenu",d3.select(this),t):e.nodePolicyEvent("contextmenu",d3.select(this),t)}).on("mouseout",function(t){t.hasPolicy?t.nodePolicyEvent("mouseout",d3.select(this),t):e.nodePolicyEvent("mouseout",d3.select(this),t)}).on("mousedown",function(t){t.hasPolicy?t.nodePolicyEvent("mousedown",d3.select(this),t):e.nodePolicyEvent("mousedown",d3.select(this),t)}).on("mouseup",function(t){t.hasPolicy?t.nodePolicyEvent("mouseup",d3.select(this),t):e.nodePolicyEvent("mouseup",d3.select(this),t)}).call(e.drag),t.append("circle").attr("r",function(t){return String(t.radius)}),t.each(function(t){e.insertTitleLinebreaks(d3.select(this),t.text)})}},{key:"d3ForceCollide",value:function(t){var e=this,n=e.consts,o=e.nodes,i=d3.geom.quadtree(o);return function(e){var o=e.radius+n.maxRadius+n.padding,r=e.x-o,a=e.x+o,s=e.y-o,l=e.y+o;i.visit(function(o,i,c,u,d){if(o.point&&o.point!==e){var v=e.x-o.point.x,f=e.y-o.point.y,p=Math.sqrt(v*v+f*f),h=e.radius+o.point.radius+n.padding;h>p&&(p=(p-h)/p*t,e.x-=v*=p,e.y-=f*=p,o.point.x+=v,o.point.y+=f)}return i>a||r>u||c>l||s>d})}}},{key:"d3ForceTick",value:function(t,e,n){for(var o=this,i=o.consts,r=i.displayOffset,a=o.nodes,s=d3.geom.quadtree(o.nodes),l=0,c=a.length;++l<c;)s.visit(this.d3ForceCollide(a[l]));o.circles.each(this.d3ForceCollide(.5)).attr("cx",function(t){return t.x=Math.max(t.radius+r,Math.min(e-r-t.radius,t.x))}).attr("cy",function(t){return t.y=Math.max(t.radius+r,Math.min(n-r-t.radius,t.y))}),o.paths.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y})}},{key:"d3ForceStart",value:function(){var t=this;t.paths.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y})}},{key:"d3ForceEnd",value:function(){var t=this;t.circles.attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}),t.paths.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y})}},{key:"d3ForceBounds",value:function(){var t=$("#visualization-graph").width(),e=$("#visualization-graph").height(),n=t,o=e;return{width:n,height:o}}},{key:"setForce",value:function(t){var e=this,n=e.nodes,o=e.links;if(!_.isEmpty(n)){var i=e.d3ForceBounds(),r=d3.layout.force().size([i.width,i.height]).nodes(n).charge(function(t){return-6e3}).links(o);r.linkDistance(i.width/3),r.linkStrength(.2),r.gravity(.2),r.on("tick",function(t){e.d3ForceTick.call(e,t,i.width,i.height)}),r.on("start",function(){e.d3ForceStart.call(e)}),r.on("end",function(){e.d3ForceEnd.call(e)}),r.start();for(var a=0;r.alpha()>.01&&150>a;)r.tick(),a+=1;r.stop(),null!=t&&t()}}},{key:"setPositions",value:function(){for(var t=this,e=t.consts.displayOffset,n=$("#visualization-graph").width(),o=$("#visualization-graph").height(),i=n-2*e,r=o-2*e,a=t.nodes,s=0;s<a.length;s++)a[s].radius=a[s].radius||t.consts.startRadius,null!=a[s].x&&null!=a[s].y||(a[s].x=i/2+a[s].radius+e,a[s].y=r/2+a[s].radius+e)}},{key:"updateGraph",value:function(t){var e=this,n=e.consts,o=e.state;if(!e.state.disableUpdate){this.updateExistingNodes();var i=e.circles.enter().append("g");i.classed(n.circleGClass,!0),e.circles.exit().remove(),0==o.initForce?(e.setForce(function(){e.updateNewNodes.call(e,i)}),o.initForce=!0):this.updateNewNodes(i),e.paths=e.paths.data(e.links,function(t){return String(t.source.id)+"+"+String(t.target.id)});var r=e.paths;this.updateExistingPaths(r);var a=r.enter().append("path").style("marker-end","url(#end-arrow)").classed("link",!0);this.updateNewPaths(a),r.exit().remove(),null!=t&&t()}}}]),e}();return{Graph:e}}]),angular.module("contiv.dashboard",["contiv.models"]).config(["$stateProvider",function(t){t.state("contiv.menu.dashboard",{url:"/dashboard",component:"dashboard"})}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();angular.module("contiv.graph").factory("VisualizerGraph",["Graph",function(t){var e=function(t){function e(t,n,o,i){_classCallCheck(this,e);var r=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o)),a=r;a.state.transition=[],a.consts.edge_buffer=200,a.consts.radiusDecay=1,a.consts.containerClass="container",a.dataSource=i;var s=d3.behavior.drag().origin(function(t){return{x:t.x,y:t.y}}).on("dragstart",function(){}).on("drag",function(t){d3.select(this).attr("transform",function(t,e){return t.x+=d3.event.dx,t.y+=d3.event.dy,"translate("+[t.x,t.y]+")"}),a.updateGraph()}).on("dragend",function(){});a.drag=s;var l=d3.behavior.zoom().on("zoom",function(){return null!=d3.event.sourceEvent&&d3.event.sourceEvent.ctrlKey?!1:(a.zoomed.call(a),!0)}).on("zoomstart",function(t,e){});return a.dragSvg=l,a.svg.call(l).on("dblclick.zoom",null),r}return _inherits(e,t),_createClass(e,[{key:"zoomed",value:function(t,e){var n=this;if(1!=n.state.rightClick){if(this.state.justScaleTransGraph=!0,null!=t&&null!=e){var o=n.dragSvg;o.scale(e),o.translate(t);var i=function(){o.scale(e),o.translate(t)},r="zoom"+t;return void d3.select("."+this.consts.graphClass).transition(r).delay(100).duration(750).attr("transform","translate("+o.translate()+") scale("+o.scale()+")").each("end",i)}n.state.canZoom&&d3.select("."+this.consts.graphClass).attr("transform","translate("+n.dragSvg.translate()+") scale("+n.dragSvg.scale()+")")}}},{key:"onWindowResize",value:function(t){var e=document.getElementsByTagName("body")[0],n=$("#visualization-graph").offset(),o=$("#visualization-graph").width(),i=e.clientHeight;t.attr("width",o).attr("height",i-n.top-20)}},{key:"updateLinkData",value:function(){for(var t=this,e=[],n=0;n<t.nodes.length;n++)e.push(t.nodes[n].id);var o=t.dataSource.getFlowBetweenSet(e),i=o.linkData;t.links=t.dataSource.processLinkData(i,t.nodes),this.initNodes(),this.initLinks(),t.updateGraph()}}]),e}(t.Graph);return{Graph:e}}]),angular.module("contiv.login",["contiv.utils"]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();angular.module("contiv.graph").factory("Link",[function(){var t=function(){function t(e,n){_classCallCheck(this,t),this.source=e,this.target=n,this.hasPolicy=!1,this.pathPolicies=[],this.graph=null,this.initialized=!1}return _createClass(t,[{key:"initialize",value:function(t){0==this.initialized&&(this.initialized=!0,this.graph=t)}},{key:"updateAttr",value:function(t,e){t.style("marker-end","url(#end-arrow)").attr("d",arrowPath)}},{key:"newPathAttr",value:function(t,e){t.attr("d",arrowPath)}},{key:"arrowPath",value:function(){var t=this,e=t.target.x-t.source.x,n=t.target.y-t.source.y,o=Math.sqrt(e*e+n*n);return"M"+t.source.x+","+t.source.y+"A"+o+","+o+" 0 0,1 "+t.target.x+","+t.target.y}},{key:"installPathPolicy",value:function(t){this.hasPolicy=!0,this.pathPolicies.push(t),t.initialize(this.graph)}},{key:"uninstallPathPolicy",value:function(t){var e,n=this;e="string"==typeof t?t:t.policyName,_(n.pathPolicies).forEach(function(t,o){t.policyName===e&&(t.destroy(),n.pathPolicies.splice(o,1))}),0===n.pathPolicies.length&&(n.hasPolicy=!1)}},{key:"pathPolicyEvent",value:function(t,e,n){_(n.pathPolicies).forEach(function(o){o[t](e,n)})}}]),t}();return{Link:t}}]),angular.module("contiv.menu",[]),angular.module("contiv.networkpolicies",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(t){t.state("contiv.menu.networkpolicies",{url:"/networkpolicies","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.networkpolicies.isolation",{url:"/isolation","abstract":!0,template:"<ui-view/>"}).state("contiv.menu.networkpolicies.isolation.create",{url:"/create",component:"isolationpolicycreate"}).state("contiv.menu.networkpolicies.isolation.details",{url:"/details/:key",component:"isolationpolicydetails"}).state("contiv.menu.networkpolicies.isolation.edit",{url:"/edit/:key",component:"isolationpolicydetails"}).state("contiv.menu.networkpolicies.bandwidth",{url:"/bandwidth","abstract":!0,template:"<ui-view/>"}).state("contiv.menu.networkpolicies.bandwidth.create",{url:"/create",component:"bandwidthpolicycreate"}).state("contiv.menu.networkpolicies.bandwidth.details",{url:"/details/:key",component:"bandwidthpolicydetails"}).state("contiv.menu.networkpolicies.bandwidth.edit",{url:"/edit/:key",component:"bandwidthpolicydetails"}).state("contiv.menu.networkpolicies.redirection",{url:"/redirection","abstract":!0,template:"<ui-view/>"}).state("contiv.menu.networkpolicies.list.isolation",{url:"/isolation",component:"isolationpolicylist"}).state("contiv.menu.networkpolicies.list.bandwidth",{url:"/bandwidth",component:"bandwidthpolicylist"})}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),_get=function t(e,n,o){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var r=Object.getPrototypeOf(e);return null===r?void 0:t(r,n,o)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(o)};angular.module("contiv.graph").factory("VisualizerLink",["Link",function(t){var e=function(t){function e(t,n,o){_classCallCheck(this,e);var i=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.weight=o,i.count=1,i}return _inherits(e,t),_createClass(e,[{key:"increaseCount",value:function(){this.count+=1}},{key:"qtipHelper",value:function(){var t,e=this,n=(e.target.x-e.source.x)/2,o=(e.target.y-e.source.y)/2;return t=e.source.x<e.target.x?{my:"top center",at:"center center",target:[n,o],adjust:{y:10}}:{my:"bottom center",at:"center center",target:[n,o],adjust:{y:-10}}}},{key:"initialize",value:function(t){if(0==this.initialized){_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"initialize",this).call(this,t);var n=t.state.VisualizerLink;null==n&&(n=t.state.VisualizerLink={},n.maxWeight=null,n.useAvgWeight=!0),this.updateMaxWeight()}}},{key:"setUseAvgWeight",value:function(t){this.graph.state.VisualizerLink.useAvgWeight=!!t}},{key:"setWeight",value:function(t){this.weight=t}},{key:"getRawWeight",value:function(){return this.weight}},{key:"getWeight",value:function(){var t=this.graph,e=t.state.VisualizerLink;if(e.useAvgWeight){var n=this.weight/this.count;return n}return this.weight}},{key:"updateMaxWeight",value:function(){var t=this.graph,e=t.state.VisualizerLink,n=_.maxBy(t.links,function(t){return null!=t.graph?t.getWeight():0});e.maxWeight=n.getWeight()}},{key:"updateAttr",value:function(t,e){var n=this.graph,o=n.state.VisualizerLink;this.updateMaxWeight();var i=d3.scale.linear().domain([0,o.maxWeight]).range(["#ffb366","#F92606"]);o.colorScale=i,t.style("marker-end","url(#end-arrow)").classed(n.consts.selectedClass,function(t){return t===o.selectedEdge}).attr("d",this.arrowPath.call(e)).transition("existingPathTransition").duration(750).attr("stroke",function(t){var e=i(t.getWeight());return e})}},{key:"newPathAttr",value:function(t,e){var n=this.graph,o=n.state.VisualizerLink;this.updateMaxWeight();var i=d3.scale.linear().domain([0,o.maxWeight]).range(["#ffb366","#F92606"]);t.transition("newPathTransition").duration(750).attrTween("opacity",function(t){return d3.interpolateString(0,1)}).attr("stroke",function(t){var e=i(t.getWeight());return e}).attr("d",this.arrowPath.call(e))}}]),e}(t.Link);return{Link:e}}]),angular.module("contiv.networks",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(t){t.state("contiv.menu.networks",{url:"/networks","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.networks.list",{url:"/list",component:"networkList"}).state("contiv.menu.networks.details",{url:"/details/:key",component:"networkdetails"})}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();angular.module("contiv.graph").factory("Node",[function(){
var t=function(){function t(e,n,o,i,r){_classCallCheck(this,t),this.x=e,this.y=n,this.radius=r,this.id=o,this.text=i,this.radius=r,this.hasPolicy=!1,this.policy=null,this.nodePolicies=[],this.graph=null,this.initialized=!1}return _createClass(t,[{key:"initialize",value:function(t){0==this.initialized&&(this.initialized=!0,this.graph=t)}},{key:"updateAttr",value:function(t,e){t.attr("transform",function(t){return"translate("+t.x+","+t.y+")"})}},{key:"newNodeAttr",value:function(t,e){}},{key:"setRadius",value:function(t){this.radius=t}},{key:"installNodePolicy",value:function(t){this.hasPolicy=!0,this.nodePolicies.push(t),t.initialize(this.graph)}},{key:"uninstallNodePolicy",value:function(t){var e,n=this;e="string"==typeof t?t:t.policyName,_(n.nodePolicies).forEach(function(t,o){t.policyName===e&&(t.destroy(),n.nodePolicies.splice(o,1))}),0===n.nodePolicies.length&&(n.hasPolicy=!1)}},{key:"nodePolicyEvent",value:function(t,e,n){_.forEach(this.nodePolicies,function(o){o[t](e,n)})}}]),t}();return{Node:t}}]),angular.module("contiv.nodes",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(t){t.state("contiv.menu.nodes",{url:"/nodes","abstract":!0,template:'<div ui-view class="ui container"/>'})}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();angular.module("contiv.graph").factory("VisualizerNode",["Node",function(t){var e=function(t){function e(t,n,o,i,r,a,s,l,c){_classCallCheck(this,e);var u=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o,i,r));return u.parent=a,u.ancestors=s,null==l?u.xStart=t:u.xStart=l,null==c?u.yStart=n:u.yStart=c,u}return _inherits(e,t),_createClass(e,[{key:"newNodeAttr",value:function(t,e){var n=this.graph;null!=n.consts.containerClass&&null==n.dataSource.children_struct[e.id]&&t.classed(n.consts.containerClass,!0),t.transition("nodePositionTransition").duration(750).attrTween("transform",function(t){if(null!=t.xStart&&null!=t.yStart){var e=t.xStart,n=t.yStart;return t.xStart=t.x,t.yStart=t.y,d3.interpolateString("translate("+e+","+n+")","translate("+t.x+","+t.y+")")}return d3.interpolateString("translate("+t.x+","+t.y+")","translate("+t.x+","+t.y+")")})}}]),e}(t.Node);return{Node:e}}]),angular.module("contiv.organizations",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(t){t.state("contiv.menu.organizations",{url:"/organizations","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.organizations.list",{url:"/list",component:"organizationlist"})}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),_get=function e(t,n,o){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,n,o)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(o)};angular.module("contiv.graph").factory("NodeSelectionPolicy",["Policy",function(t){var e=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"NodeSelectionPolicy"))}return _inherits(e,t),_createClass(e,[{key:"initialize",value:function(t){if(!this.initialized){_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"initialize",this).call(this,t);var n=t.state.NodeSelectionPolicy={};n.selectedNodes=[];var o=t.consts.NodeSelectionPolicy={};o.selectedClass="selected";var i=t.drag;i.on("drag",function(e){var n=t;if(null!=n.consts.NodeSelectionPolicy){var o=n.consts.NodeSelectionPolicy.selectedClass,i=d3.selectAll("."+o);-1==i[0].indexOf(this)&&(i.classed(o,!1),i=d3.select(this),i.classed(o,!0)),i.attr("transform",function(t,e){return t.x+=d3.event.dx,t.y+=d3.event.dy,"translate("+[t.x,t.y]+")"}),n.updateGraph()}})}}},{key:"addSelectNode",value:function(t,e){var n=this.graph,o=n.state.NodeSelectionPolicy,i=n.consts.NodeSelectionPolicy;t.classed(i.selectedClass,!0),o.selectedNodes.push(e)}},{key:"removeSelectFromNode",value:function(t,e){var n=this.graph,o=n.state.NodeSelectionPolicy,i=n.consts.NodeSelectionPolicy;n.circles.filter(function(t){return t.id===e.id}).classed(i.selectedClass,!1);var r=o.selectedNodes.indexOf(e);o.selectedNodes.splice(r,1)}},{key:"removeAllSelectedNodes",value:function(){var t=this.graph,e=t.state.NodeSelectionPolicy,n=t.consts.NodeSelectionPolicy;t.circles.classed(n.selectedClass,!1),e.selectedNodes=[]}},{key:"mousedown",value:function(t,e){var n=this.graph,o=n.state.NodeSelectionPolicy;d3.event.stopPropagation(),d3.event.ctrlKey?o.selectedNodes.indexOf(e)>-1?this.removeSelectFromNode(t,e):this.addSelectNode(t,e):-1==o.selectedNodes.indexOf(e)&&this.removeAllSelectedNodes()}},{key:"mouseup",value:function(t,e){var n=this.graph,o=n.state.NodeSelectionPolicy;d3.event.ctrlKey||o.selectedNodes.length<=1&&this.removeSelectFromNode(t,e)}}]),e}(t.Policy);return{Policy:e}}]),angular.module("contiv.servicelbs",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(t){t.state("contiv.menu.servicelbs",{url:"/servicelbs","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.servicelbs.list",{url:"/list",component:"servicelbList"}).state("contiv.menu.servicelbs.details.stats",{url:"/stats",component:"servicelbstat"})}]),angular.module("contiv.settings",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(t){t.state("contiv.menu.settings",{url:"/global","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.settings.details",{url:"/settings",templateUrl:"settings/settingsmenu.html"}).state("contiv.menu.settings.details.logs",{url:"/logs",controller:"",templateUrl:""}).state("contiv.menu.settings.details.auth",{url:"/auth",controller:"",templateUrl:""}).state("contiv.menu.settings.details.license",{url:"/license",controller:"",templateUrl:""}).state("contiv.menu.settings.details.policies",{url:"/policies",controller:"",templateUrl:""}).state("contiv.menu.settings.details.networks",{url:"/networks",component:"networksetting"}).state("contiv.menu.settings.details.volumes",{url:"/volumes",component:"volumesetting"})}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();angular.module("contiv.graph").factory("PathChangeViewPolicy",["Policy",function(t){var e=function(t){function e(t){_classCallCheck(this,e);var n=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"PathChangeViewPolicy"));return n.$state=t,n}return _inherits(e,t),_createClass(e,[{key:"generateList",value:function(t){var e=this,n=[],o=function i(t,n){for(var o=e.graph.dataSource.children_struct[t],r=0;r<o.length;r++){var a=o[r];if(e.graph.dataSource.hasChild(a)===!0){var s=i(a,n);n.concat(s)}else n.push(a)}};return o(t,n),n}},{key:"viewEdge",value:function(t){var e=[],n=[],o=t.source.id,i=t.target.id;e=this.graph.dataSource.hasChild(o)===!0?this.generateList(o):[o],n=this.graph.dataSource.hasChild(i)===!0?this.generateList(i):[i],this.$state.go("contiv.menu.visualization.edge",{sourceName:o,targetName:i,sourceList:e,targetList:n})}},{key:"mousedown",value:function(t,e){this.viewEdge(e)}}]),e}(t.Policy);return{Policy:e}}]),angular.module("contiv.storagepolicies",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(t){t.state("contiv.menu.storagepolicies",{url:"/storagepolicies","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.storagepolicies.list",{url:"/list",component:"storagepolicylist"})}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();angular.module("contiv.graph").factory("Policy",[function(){var t=function(){function t(e){_classCallCheck(this,t),this.policyName=e,this.graph=null,this.initialized=!1}return _createClass(t,[{key:"initialize",value:function(t){this.initialized||(this.initialized=!0,this.graph=t)}},{key:"mouseover",value:function(t,e){}},{key:"dblclick",value:function(t,e){}},{key:"contextmenu",value:function(t,e){}},{key:"mouseout",value:function(t,e){}},{key:"mousedown",value:function(t,e){}},{key:"mouseup",value:function(t,e){}},{key:"destroy",value:function(){}}]),t}();return{Policy:t}}]),angular.module("contiv.visualization",["contiv.models","contiv.directives","contiv.utils","contiv.graph"]).config(["$stateProvider",function(t){t.state("contiv.menu.visualization",{url:"/visualization","abstract":!0,template:'<div ui-view class="ui container"/>'})}]),angular.module("contiv.graph").factory("PolicyService",["Policy","QTipPolicy","PathChangeViewPolicy","NodeSelectionPolicy","SplitJoinNodePolicy","SplitJoinViewPolicy","SaveStatePolicy",function(t,e,n,o,i,r,a){return{Policy:t.Policy,QTipPolicy:e.Policy,PathChangeViewPolicy:n.Policy,NodeSelectionPolicy:o.Policy,SplitJoinNodePolicy:i.Policy,SplitJoinViewPolicy:r.Policy,SaveStatePolicy:a.Policy}}]),angular.module("contiv.volumes",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(t){t.state("contiv.menu.volumes",{url:"/volumes","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.volumes.list",{url:"/list",component:"volumelist"}).state("contiv.menu.volumes.details",{url:"/details/:key",component:"volumedetails"})}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),_get=function n(t,e,o){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,e);if(void 0===i){var r=Object.getPrototypeOf(t);return null===r?void 0:n(r,e,o)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(o)};angular.module("contiv.graph").factory("QTipPolicy",["Policy",function(t){var e=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"QTipPolicy"))}return _inherits(e,t),_createClass(e,[{key:"initialize",value:function(t){if(!this.initialized){_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"initialize",this).call(this,t);var n=this,o=t.state.QTipPolicy={};o.mousedown=!1,t.consts.QTipPolicy={},$("#visualization-graph").mouseup(function(t){o.mouseup=!1});var i=t.updateNewNodes;t.updateNewNodes=function(e){i.call(t,e),n.updateNewNodes(e)};var r=t.updateNewPaths;t.updateNewPaths=function(e){r.call(t,e),n.updateNewPaths(e)}}}},{key:"destroy",value:function(){$('[id^="qtip"]').remove()}},{key:"mousedown",value:function(t,e){var n=this.graph,o=n.state.QTipPolicy;o.mousedown=!0}},{key:"mouseup",value:function(t,e){var n=this.graph,o=n.state.QTipPolicy;o.mousedown=!1}},{key:"whenQTipAvailable",value:function(t){var e=this,n=500;window.setTimeout(function(){null!=$(document).qtip?t():window.setTimeout(e.whenQTipAvailable(t),n)},n)}},{key:"updateNewNodes",value:function(t){function e(){t.each(function(t){var e,i=this;if(null!=n.dataSource.children_struct[t.id]){e="<b><u>Selectors:</b></u> ";var r=n.dataSource.selectors[t.id],a=!1;for(var s in r)a=!0,e+=s+" : <i>"+r[s]+"</i>,\n ";a===!1&&(e="No Selectors, ")}else{e="<b><u>Labels:</b></u> ";var l=n.dataSource.labels[t.id],a=!1;for(var s in l)a=!0,e+=s+" : <i>"+l[s]+"</i>,\n ";a===!1&&(e="No labels, ")}e=e.slice(0,-2),$(i).qtip({content:{title:t.id,text:e},events:{show:function(){var e=$(i).qtip("api"),r=$("#graphContainer").offset(),a=[r.left+(t.x*n.dragSvg.scale()+n.dragSvg.translate()[0]),r.top+(t.y+t.radius)*n.dragSvg.scale()+n.dragSvg.translate()[1]];return e.set("position.target",a),!o.mousedown}},show:{delay:0,solo:$("#visualization-graph")},style:{classes:"qtip-blue qtip-shadow"},position:{my:"top center",at:"bottom center"},hide:{event:"mousedown mouseleave"}})})}var n=this.graph,o=n.state.QTipPolicy;void 0!=$(document).qtip?e():this.whenQTipAvailable(e)}},{key:"updateNewPaths",value:function(t){var e=this.graph,n=e.state.QTipPolicy;void 0!=$(document).qtip&&t.each(function(t){var e=this,o=d3.select(this).node(),i=(o.getPointAtLength(o.getTotalLength()/2),t.qtipHelper()),r="Bytes: "+t.getWeight();$(e).qtip({content:{text:r},events:{show:function(){return!n.mousedown}},show:{delay:0,solo:$("#graphContainer")},style:{classes:"qtip-blue qtip-shadow"},position:{my:i.my,at:"center center",target:"mouse",adjust:i.adjust},hide:{event:"mousedown mouseleave"}})})}}]),e}(t.Policy);return{Policy:e}}]),angular.module("contivApp",["ui.router","contiv.login","contiv.menu","contiv.dashboard","contiv.applicationgroups","contiv.networks","contiv.networkpolicies","contiv.storagepolicies","contiv.servicelbs","contiv.volumes","contiv.nodes","contiv.organizations","contiv.settings","contiv.visualization"]).config(["$stateProvider","$urlRouterProvider",function(t,e){t.state("contiv",{url:"","abstract":!0,template:'<div ui-view class="ui fluid container"/>'}),e.otherwise("/")}]),angular.module("contiv.login").config(["$stateProvider",function(t){t.state("contiv.login",{url:"/",templateUrl:"login/login.html",controller:"LoginCtrl as loginCtrl"})}]).controller("LoginCtrl",["$state","CRUDHelperService",function(t,e){function n(){t.go("contiv.menu.dashboard",{username:i.username})}function o(){n()}var i=this;e.stopLoader(i),e.hideServerError(i),i.login=o}]),angular.module("contiv.menu").config(["$stateProvider",function(t){t.state("contiv.menu",{url:"/m",templateUrl:"menu/menu.html",controller:"MenuCtrl as menuCtrl",params:{username:null}})}]).controller("MenuCtrl",["$state","$stateParams",function(t,e){function n(){t.go("contiv.login")}var o=this;o.username=e.username,o.logout=n}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();angular.module("contiv.graph").factory("SaveStatePolicy",["Policy",function(t){var e=function(t){function e(t){_classCallCheck(this,e);var n=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"SaveStatePolicy"));return n.savedState=t,n}return _inherits(e,t),_createClass(e,[{key:"initialize",value:function(t){this.graph=t;var e=this;t.destroy=function(){e.graphDestroy.call(t,e.savedState)},t.load=function(n){e.graphLoad.call(t,n)}}},{key:"graphDestroy",value:function(t){var e=this;_(e.defaultNodePolicies).forEach(function(e){e.destroy(t)}),_(e.defaultPathPolicies).forEach(function(e){e.destroy(t)});for(var n in e.bindings)$(window).off(n,e.bindings[n])}},{key:"graphLoad",value:function(t){var e=this;_(e.defaultNodePolicies).forEach(function(e){null!=e.load&&e.load(t)}),_(e.defaultPathPolicies).forEach(function(e){null!=e.load&&e.load(t)})}}]),e}(t.Policy);return{Policy:e}}]),angular.module("contiv.networkpolicies").directive("ctvBandwidth",function(){return{restrict:"E",scope:{bandwidthPolicy:"=",mode:"@"},link:function(t){if(""!=t.bandwidthPolicy.bandwidth){var e=t.bandwidthPolicy.bandwidth.split(" ");t.bandwidthPolicy.bandwidthNumber=Number(e[0]),t.bandwidthPolicy.bandwidthUnit=e[1]}},templateUrl:"network_policies/bandwidth.html"}}),angular.module("contiv.networkpolicies").config(["$stateProvider",function(t){t.state("contiv.menu.networkpolicies.list",{url:"/list","abstract":!0,controller:"NetworkPoliciesTabsCtrl as networkPoliciesTabsCtrl",templateUrl:"network_policies/networkpoliciestabs.html"}).state("contiv.menu.networkpolicies.list.redirection",{url:"/redirection",template:""})}]).controller("NetworkPoliciesTabsCtrl",["$state",function(t){function e(){t.$current.includes["contiv.menu.networkpolicies.list.isolation"]&&t.go("contiv.menu.networkpolicies.isolation.create"),t.$current.includes["contiv.menu.networkpolicies.list.bandwidth"]&&t.go("contiv.menu.networkpolicies.bandwidth.create")}var n=this;n.createNetworkPolicy=e}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),_get=function o(t,e,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,e);if(void 0===i){var r=Object.getPrototypeOf(t);return null===r?void 0:o(r,e,n)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(n)};angular.module("contiv.graph").factory("SplitJoinNodePolicy",["NodeSelectionPolicy","VisualizerNode",function(t,e){var n=function(t){function n(){_classCallCheck(this,n);var t=_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.policyName="SplitJoinNodePolicy",t}return _inherits(n,t),_createClass(n,[{key:"initialize",value:function(t){if(!this.initialized){_get(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"initialize",this).call(this,t);var e=t.state.SplitJoinNodePolicy={};e.splitNodes=[]}}},{key:"dblclick",value:function(t,e){var n=this.graph,o=n.state.SplitJoinNodePolicy;d3.event.ctrlKey||(o.selectedNodes.indexOf(e)>-1?this.splitMultipleNodes(o.selectedNodes):(this.removeAllSelectedNodes(),this.splitNode(e)))}},{key:"contextmenu",value:function(t,e){var n=this.graph,o=n.state.NodeSelectionPolicy;if(d3.event.preventDefault(),!d3.event.ctrlKey){var i=o.selectedNodes;if(i.indexOf(e)>-1)for(var r=0;r<i.length;r++)this.joinNode(i[r]);else this.removeAllSelectedNodes(),this.joinNode(e)}}},{key:"__splitNode",value:function(t){var n=this.graph,o=n.state.SplitJoinNodePolicy,i=t.id,r=n.dataSource.children_struct;if(void 0!==r[i]&&!_.isEmpty(r[i])){n.nodes=_.filter(n.nodes,function(e){return e!=t}),n.spliceLinksForNode(t);for(var a=[],s=0;s<n.nodes.length;s++)a.push(n.nodes[s].id);for(var l=[],s=0;s<r[i].length;s++)a.push(r[i][s]),l.push(r[i][s]);var c=n.dataSource.getFlowBetweenSet(a),u=t.x,d=t.y,v=t.ancestors.slice();v.splice(0,0,t.id);for(var f=t.id,p=[],h=t.radius*n.consts.radiusDecay,y=c.nodeData,s=0;s<y.length;s++)if(l.indexOf(y[s].id)>-1){var g=y[s].id,m=y[s].text,b=new e.Node(null,null,g,m,h,f,v,u,d);b.initialize(n),n.nodes.push(b),p.push(b)}return n.links=n.dataSource.processLinkData(c.linkData,n.nodes),n.initNodes(),n.initLinks(),o.splitNodes.push(t.id),p}}},{key:"splitNode",value:function(t){var e=this.__splitNode(t);null!=e&&this.splitNodeEvent(e)}},{key:"splitMultipleNodes",value:function(t){for(var e=(this.graph,[]),n=0;n<t.length;n++){var o=this.__splitNode(t[n]);e=e.concat(o)}this.splitMultipleNodesEvent(o)}},{key:"splitNodeEvent",value:function(t){var e=this.graph;e.setPositions(),e.updateGraph()}},{key:"splitMultipleNodesEvent",value:function(t){var e=this.graph;e.setPositions(),e.updateGraph()}},{key:"__joinNode",value:function(t){var n=this.graph,o=n.state.SplitJoinNodePolicy;if(-1!=n.nodes.indexOf(t)){var i=n.dataSource.children_struct,r=t.id;if(!(i.topLevel.indexOf(r)>-1)){for(var a=[],s=[],l=0;l<n.nodes.length;l++)-1==n.nodes[l].ancestors.indexOf(t.parent)?s.push(n.nodes[l].id):a.push(n.nodes[l]);var c=t.parent;s.push(t.parent);var u=t.radius/n.consts.radiusDecay,d=t.x,v=t.y,f=t.ancestors[1],p=t.ancestors.slice(1),h=new e.Node(d,v,c,c,u,f,p);n.nodes.push(h);for(var y=n.dataSource.getFlowBetweenSet(s),l=0;l<a.length;l++){var g=a[l];n.nodes.splice(n.nodes.indexOf(g),1),n.spliceLinksForNode(g)}return n.links=n.dataSource.processLinkData(y.linkData,n.nodes),n.initNodes(),n.initLinks(),o.splitNodes.splice(o.splitNodes.indexOf(h.id),1),h}}}},{key:"joinNode",value:function(t){var e=this.__joinNode(t);null!=e&&this.joinNodeEvent(e)}},{key:"joinMultipleNode",value:function(t){for(var e=[],n=0;n<t.length;n++){var o=this.__joinNode(t[n]);e.push(o)}this.joinMultipleNodesEvent(e)}},{key:"joinNodeEvent",value:function(t){var e=this.graph;e.updateGraph()}},{key:"joinMultipleNodesEvent",value:function(t){var e=this.graph;e.updateGraph()}}]),n}(t.Policy);return{Policy:n}}]),angular.module("contiv.networks").config(["$stateProvider",function(t){t.state("contiv.menu.networks.create",{url:"/create",templateUrl:"networks/networkcreate.html",controller:"NetworkCreateCtrl as networkCreateCtrl"})}]).controller("NetworkCreateCtrl",["$state","$stateParams","NetworksModel","CRUDHelperService",function(t,e,n,o){function i(){t.go("contiv.menu.networks.list")}function r(){i()}function a(){l.form.$valid&&(o.hideServerError(l),o.startLoader(l),l.newNetwork.key=l.newNetwork.tenantName+":"+l.newNetwork.networkName,n.create(l.newNetwork).then(function(t){o.stopLoader(l),i()},function(t){o.stopLoader(l),o.showServerError(l,t)}))}function s(){o.stopLoader(l),o.hideServerError(l),l.newNetwork={networkName:"",encap:"vxlan",subnet:"",gateway:"",tenantName:"default"}}var l=this;l.cidrPattern=ContivGlobals.CIDR_REGEX,l.createNetwork=a,l.cancelCreating=r,s()}]);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),_get=function i(t,e,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(void 0===o){var r=Object.getPrototypeOf(t);return null===r?void 0:i(r,e,n)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(n)};angular.module("contiv.graph").factory("SplitJoinViewPolicy",["SplitJoinNodePolicy","VisualizerNode",function(t,e){var n=function(t){function n(){_classCallCheck(this,n);var t=_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.policyName="SplitJoinViewPolicy",t}return _inherits(n,t),_createClass(n,[{key:"initialize",value:function(t){if(!this.initialized){_get(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"initialize",this).call(this,t);var e=t.state.SplitJoinViewPolicy={};e.savedStates=[],e.eventHistory=[],e.focusGroups=[],e.foci=[],e.zooms={},e.layout={},e.layoutDefault=null,e.zoomDefault=null,e.nodeIdsToReshow=null,e.backButtonElem=null,e.titleElem=null;var o=t.consts.SplitJoinViewPolicy={};o.boundary=.8,t.d3ForceBounds=this.d3ForceBounds,t.d3ForceTick=this.d3ForceTick,t.d3ForceStart=this.d3ForceStart,t.d3ForceEnd=this.d3ForceEnd}}},{key:"installBackButton",value:function(t){var e=this.graph,n=this,o=e.state.SplitJoinViewPolicy;o.backButtonElem=t,o.backButton=function(){o.eventHistory.length>0&&n.undoLastEvent.call(n)}}},{key:"installTitle",value:function(t){var e=this.graph,n=e.state.SplitJoinViewPolicy;n.titleElem=t}},{key:"destroy",value:function(t){null!=t&&this.save(t)}},{key:"save",value:function(t){var e=this.graph,n=e.state.SplitJoinViewPolicy,o=e.nodes,i=e.links,r=null;null!=n.titleElem&&(r=n.titleElem.text());var a=n.focusGroups,s=n.eventHistory,l=n.zooms,c=n.layout,u=n.layoutDefault,d=n.zoomDefault,v={nodes:o,links:i,states:n.savedStates,currTitle:r,focusGroups:a,eventHistory:s,zooms:l,layout:c,layoutDefault:u,zoomDefault:d};t.SplitJoinViewPolicy=v}},{key:"load",value:function(t){var e=this,n=this.graph,o=n.state.SplitJoinViewPolicy;t=t.SplitJoinViewPolicy,o.savedStates=t.states,n.links=t.links,n.nodes=t.nodes;var i=t.currTitle;null!=o.titleElem&&o.titleElem.text(i),o.eventHistory=t.eventHistory,o.focusGroups=t.focusGroups,o.zooms=t.zooms,o.layout=t.layout,o.layoutDefault=t.layoutDefault,o.zoomDefault=t.zoomDefault,null!=o.backButtonElem&&o.eventHistory.length>0&&o.backButtonElem.fadeTo("slow",1);var r=n.dataSource.children_struct;_.forEach(n.nodes,function(t){t.SplitJoinViewPolicy={},_.includes(r[o.focusGroups[0]],t.id)?t.SplitJoinViewPolicy.type="focus":t.SplitJoinViewPolicy.type="connected"});var a;if(0===o.focusGroups.length){a=o.layoutDefault;var s=o.zoomDefault;n.zoomed(s[0],s[1])}else{var s=o.zooms[o.focusGroups];null!=s&&n.zoomed(s[0],s[1]),a=o.layout[o.focusGroups]}_.forEach(n.nodes,function(t){var e=a[t.id];null==e&&console.log(a,t),t.x=e.x,t.y=e.y}),n.state.initForce=!0,n.updateGraph.call(n,function(){e.updateGraphCallback.call(e)})}},{key:"dblclick",value:function(t,e){var o=this.graph,i=o.state.SplitJoinViewPolicy,r=e.id,a=o.dataSource.children_struct;if(void 0!==a[r]&&!_.isEmpty(a[r])){if(i.focusGroups.slice(),0===i.focusGroups.length?i.focusGroups.push(e.id):_.includes(a[i.focusGroups[0]],e.id)?i.focusGroups[0]=e.id:1===i.focusGroups.length?i.focusGroups.push(e.id):_.includes(a[i.focusGroups[1]],e.id)&&(i.focusGroups[1]=e.id),2===i.focusGroups.length&&i.focusGroups[1]===e.id){var s=[e],l=[],c=a[i.focusGroups[0]];_.forEach(o.nodes,function(t){_.includes(c,t.id)&&(l.push(t.id),s.push(t))})}else{var s=[e],l=[];_.forEach(o.links,function(t){t.source===e&&-1==l.indexOf(t.target.id)?(t.target.SplitJoinViewPolicy={},t.target.SplitJoinViewPolicy.type="connected",l.push(t.target.id),s.push(t.target)):t.target===e&&-1==l.indexOf(t.source.id)&&(t.source.SplitJoinViewPolicy={},t.source.SplitJoinViewPolicy.type="connected",l.push(t.source.id),s.push(t.source))})}o.circles.each(function(t){t.id!==e.id&&o.spliceLinksForNode(t)}),o.updateGraph(),o.state.disableUpdate=!0,o.circles.each(function(t){t.id!==e.id?d3.select(this).transition().delay(200).duration(400).style("opacity",0):null!=$(this).qtip&&$(this).qtip("disable",!0)});var u=o.dragSvg.translate(),d=o.dragSvg.scale(),v=parseFloat(o.svg.style("width"))/d/2+u[0],f=parseFloat(o.svg.style("height"))/d/2+u[1];e.xStart=e.x,e.yStart=e.y,e.x=v,e.y=f,t.transition("nodePositionTransition").duration(750).attrTween("transform",function(t){var e=t.xStart,n=t.yStart;return t.xStart=t.x,t.yStart=t.y,d3.interpolateString("translate("+e+","+n+")","translate("+t.x+","+t.y+")")});var p=_get(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"splitNode",this);i.nodeIdsToReshow=l;var h=this;setTimeout(function(){o.nodes=s,p.call(h,e)},750)}}},{key:"updateGraphCallback",value:function(){var t=this.graph,e=t.state.SplitJoinViewPolicy;t.circles.each(function(t){d3.select(this).transition().duration(400).style("opacity",1),d3.select(this).classed("focus",!1),d3.select(this).classed("connected",!1),null!=t.SplitJoinViewPolicy&&("focus"===t.SplitJoinViewPolicy.type?d3.select(this).classed("focus",!0):"connected"===t.SplitJoinViewPolicy.type&&d3.select(this).classed("connected",!0))}),e.nodeIdsToReshow=null,t.updateGraph()}},{key:"setPositions",value:function(){function t(t,e){return Math.floor(Math.random()*(e-t+1))+t}var e=this.graph,n=this,o=e.consts,i=o.displayOffset,r=e.nodes,a=n.d3ForceBounds.call(e);_.forEach(r,function(e){if(null==e.x||null==e.y){var n=t(e.radius+i,a.width-e.radius-i),o=t(e.radius+i,a.height-e.radius-i);e.x=n,e.y=o}})}},{key:"d3ForceStart",value:function(){var t=this;t.circles.attr("cx",function(e){return null!=e.xStart&&(e.xStart=e.xStart*t.dragSvg.scale()+t.dragSvg.translate()[0]),e.x}).attr("cy",function(e){return null!=e.yStart&&(e.yStart=e.yStart*t.dragSvg.scale()+t.dragSvg.translate()[1]),e.y}),t.paths.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y})}},{key:"d3ForceEnd",value:function(){var t=this,e=t.state,n=e.SplitJoinViewPolicy;if(null==n.layoutDefault){var o={};_.forEach(t.nodes,function(t){o[t.id]={x:t.x,y:t.y}}),n.layoutDefault=o;var i=t.dragSvg.scale(),r=t.dragSvg.translate();n.zoomDefault=[r,i]}t.circles.attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}),t.paths.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y})}},{key:"d3ForceTick",value:function(t,e,n){function o(t){return function(o){2===u.length?("focus"===o.SplitJoinViewPolicy.type?o.y+=(u[0]-o.y)*t:o.y+=(u[1]-o.y)*t,o.x+=(e/2-o.x)*t):(o.y+=(n/2-o.y)*t,o.x+=(e/2-o.x)*t)}}var i=this,r=i.state,a=i.consts,s=r.SplitJoinViewPolicy,l=a.displayOffset,c=i.dragSvg.scale(),u=s.foci;i.circles.each(this.d3ForceCollide(.5)).each(o(.2*t.alpha)).attr("cx",function(t){return t.x=Math.max((t.radius+l)/c,Math.min(e+(-l-t.radius)/c,t.x))}).attr("cy",function(t){return null==t.SplitJoinViewPolicy||null==t.SplitJoinViewPolicy?(t.y=Math.max((t.radius+l)/c,Math.min(n+(-l-t.radius)/c,t.y)),t.y):"focus"===t.SplitJoinViewPolicy.type?(t.y=Math.max(t.radius+l,Math.min((n+(-l-t.radius)/c)*a.SplitJoinViewPolicy.boundary,t.y)),t.y):"connected"===t.SplitJoinViewPolicy.type?(t.y=Math.max((n+(l-t.radius)/c)*a.SplitJoinViewPolicy.boundary,Math.min(n+(-l-t.radius)/c,t.y)),t.y):void 0}),i.paths.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y})}},{key:"d3ForceBounds",value:function(){function t(t,n){var o=t*n,i=e.consts.startRadius,r=3.5*i,a=o/(r*r);return a}var e=this,n=e.state,o=e.consts,i=o.SplitJoinViewPolicy,r=n.SplitJoinViewPolicy,a=e.nodes,s=o.displayOffset,l=parseFloat(e.svg.style("width")),c=parseFloat(e.svg.style("height")),u=l,d=c,v=t(u-2*s,d-2*s),f=1;a.length>v?(f=v/a.length,e.zoomed(e.dragSvg.translate(),f),u/=f,d/=f):e.zoomed(e.dragSvg.translate(),f);var p,h=r.focusGroups;if(0===h.length)p=[d/2];else{var y=e.dataSource.children_struct[h[0]];i.boundary=y.length/a.length;var g=d*i.boundary,m=d-g;g<2*e.consts.maxRadius&&(i.boundary=2.5*e.consts.maxRadius/d,g=d*i.boundary,m=d-g),m<2*e.consts.maxRadius&&(i.boundary=1-2.5*e.consts.maxRadius/d,g=d*i.boundary,m=d-g),p=[g/2,g+m/2]}return r.foci=p,{width:u,height:d}}},{key:"splitNodeEvent",value:function(t){var e=this,n=this.graph,o=n.state.SplitJoinViewPolicy,i=n.dataSource.children_struct;_.forEach(t,function(t){t.SplitJoinViewPolicy={},_.includes(i[o.focusGroups[0]],t.id)?t.SplitJoinViewPolicy.type="focus":t.SplitJoinViewPolicy.type="connected"});var r=t[0].parent;if(0!==o.eventHistory.length&&o.eventHistory[o.eventHistory.length-1].id===r?o.eventHistory.pop():o.eventHistory.push({id:r,event:"split"}),null!=o.backButtonElem&&0!==o.eventHistory.length&&o.backButtonElem.fadeTo("slow",1),null!=o.titleElem){var a="";o.focusGroups.length>0&&(a+=o.focusGroups[0]),2===o.focusGroups.length&&(a+=" & "+o.focusGroups[1]),o.titleElem.text(a)}n.state.disableUpdate=!1,e.setLayout()}},{key:"setLayout",value:function(){var t,e=this,n=this.graph,o=n.state.SplitJoinViewPolicy;if(0===o.focusGroups.length){t=o.layoutDefault;var i=o.zoomDefault;n.zoomed(i[0],i[1])}else{var i=o.zooms[o.focusGroups];null!=i&&n.zoomed(i[0],i[1]),t=o.layout[o.focusGroups]}if(null!=t)_.forEach(n.nodes,function(e){var n=t[e.id];null==n&&console.log(t,e),e.x=n.x,e.y=n.y}),n.updateGraph.call(n,function(){e.updateGraphCallback.call(e)});else{n.state.initForce=!1,n.updateGraph(function(){e.updateGraphCallback.call(e)}),o.zooms[o.focusGroups]=[n.dragSvg.translate(),n.dragSvg.scale()];var t={};_.forEach(n.nodes,function(e){t[e.id]={x:e.x,y:e.y}}),o.layout[o.focusGroups]=t}}},{key:"__joinNode",value:function(t){var n=this.graph,o=n.state.SplitJoinNodePolicy,i=n.state.SplitJoinViewPolicy;if(-1!=n.nodes.indexOf(t)){var r=n.dataSource.children_struct,a=t.id;if(!(r.topLevel.indexOf(a)>-1)){for(var s=t.parent,l=[],c=[],u=0;u<n.nodes.length;u++)-1==n.nodes[u].ancestors.indexOf(t.parent)?c.push(n.nodes[u].id):l.push(n.nodes[u]);var d=t.parent;c.push(t.parent);var v=n.dataSource.ancestors_struct,r=n.dataSource.children_struct,f=i.focusGroups.indexOf(s);
null!=v[s]?i.focusGroups[f]=v[s]:i.focusGroups.splice(f,1);var p=[];if(1===i.focusGroups.length){var h=v[t.id];h.push(i.focusGroups[0]),h=h.concat(v[i.focusGroups[0]]||[]),_.forEach(r.topLevel,function(t){-1===h.indexOf(t)&&-1==c.indexOf(t)&&p.push(t)}),c=c.concat(p)}else 0===i.focusGroups.length&&(_.forEach(r.topLevel,function(t){-1==c.indexOf(t)&&p.push(t)}),c=c.concat(p));var y=t.radius/n.consts.radiusDecay,g=t.x,m=t.y,s=t.ancestors[1],h=t.ancestors.slice(1),b=new e.Node(g,m,d,d,y,s,h);n.nodes.push(b);for(var u=0;u<l.length;u++){var P=l[u];n.nodes.splice(n.nodes.indexOf(P),1),n.spliceLinksForNode(P)}for(var w=n.dataSource.getFlowBetweenSet(c),k=[],S=w.nodeData,u=0;u<S.length;u++)-1!==p.indexOf(S[u].id)&&k.push(S[u]);var E=n.dataSource.processNodeData(k);_.forEach(E,function(t){t.radius=t.radius||n.consts.startRadius}),n.nodes=n.nodes.concat(E),n.links=n.dataSource.processLinkData(w.linkData,n.nodes),1===i.focusGroups.length?_.forEach(n.links,function(t){-1!==p.indexOf(t.source.id)?i.focusGroups[0]===t.target.parent&&p.splice(p.indexOf(t.source.id),1):-1!==p.indexOf(t.target.id)&&i.focusGroups[0]===t.source.parent&&p.splice(p.indexOf(t.target.id),1)}):p=[];var N=[];if(0!==p.length)for(var u=0;u<n.nodes.length&&(-1===p.indexOf(n.nodes[u].id)||(p.splice(p.indexOf(n.nodes[u].id),1),n.spliceLinksForNode(n.nodes[u]),N.push(n.nodes[u]),0!==p.length));u++);return _.forEach(N,function(t){n.nodes.splice(n.nodes.indexOf(t),1)}),n.initNodes(),n.initLinks(),o.splitNodes.splice(o.splitNodes.indexOf(b.id),1),b}}}},{key:"joinNodeEvent",value:function(t){var e=this.graph,n=this,o=e.state.SplitJoinViewPolicy;0!==o.eventHistory.length&&o.eventHistory[o.eventHistory.length-1].id===t.id?o.eventHistory.pop():o.eventHistory.push({id:t.id,event:"join"});var i=e.dataSource.children_struct;if(_.forEach(e.nodes,function(t){t.SplitJoinViewPolicy={},_.includes(i[o.focusGroups[0]],t.id)?t.SplitJoinViewPolicy.type="focus":t.SplitJoinViewPolicy.type="connected"}),null!=o.backButtonElem&&0===o.eventHistory.length&&o.backButtonElem.fadeTo("slow",0),null!=o.titleElem){var r="";o.focusGroups.length>0&&(r+=o.focusGroups[0]),2===o.focusGroups.length&&(r+=" & "+o.focusGroups[1]),o.titleElem.text(r)}n.setLayout()}},{key:"undoLastEvent",value:function(){var t,e=this.graph,o=this,i=e.state.SplitJoinViewPolicy,r=i.eventHistory[i.eventHistory.length-1],a=r.id;if("join"===r.event){t=e.findNodeById(a);var s=e.findD3Node(a);o.dblclick(s,t)}else{var l=e.dataSource.children_struct[a][0];t=e.findNodeById(l),_get(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"joinNode",this).call(o,t)}}}]),n}(t.Policy);return{Policy:n}}]),angular.module("contiv.nodes").factory("BgpService",["$http","$q",function(t,e){function n(n){var o=e.defer(),i=ContivGlobals.BGPS_ENDPOINT+n.key+"/";return t.get(i).then(function(t){o.resolve(t.data),n.neighbor=t.data,n.neighbors.push({name:n.neighbor.neighbor,value:n.neighbor["neighbor-as"]})},function(t){o.reject(t.data)}),o.promise}function o(e){var n=ContivGlobals.BGPS_ENDPOINT+e.key+"/";return t.post(n,e.neighbor)}function i(n){var o=e.defer(),i=ContivGlobals.BGPS_INSPECT_ENDPOINT+n+"/";return t.get(i).then(function(t){o.resolve(t.data)},function(t){o.reject(t.data)}),o.promise}return{getBgp:n,updateBgp:o,getBgpInspect:i}}]),angular.module("contiv.nodes").directive("ctvLogs",function(){return{restrict:"E",templateUrl:"nodes/logs.html",scope:{log:"=",title:"@"}}}),angular.module("contiv.nodes").factory("LogService",["$http","$q",function(t,e){function n(){var n=e.defer(),o=ContivGlobals.NODES_ACTIVE_JOB_ENDPOINT;return t.get(o).then(function(t){n.resolve(t.data)},function(t){n.reject(t.data)}),n.promise}function o(){var n=e.defer(),o=ContivGlobals.NODES_LAST_JOB_ENDPOINT;return t.get(o).then(function(t){n.resolve(t.data)},function(t){n.reject(t.data)}),n.promise}return{getActiveLogs:n,getLastLogs:o}}]),angular.module("contiv.nodes").config(["$stateProvider",function(t){t.state("contiv.menu.nodes.activelog",{url:"/activelog",controller:"NodeActiveJobLogsCtrl as nodeActiveJobLogsCtrl",template:'<ctv-logs title="Active Job" log="nodeActiveJobLogsCtrl.activeLogs"></ctv-logs>'})}]).controller("NodeActiveJobLogsCtrl",["$scope","$interval","LogService",function(t,e,n){function o(){n.getActiveLogs().then(function(t){i.activeLogs=t},function(t){i.activeLogs={desc:"There is currently no active job. Check Last Job for a job that recently finished."}})}var i=this;o();var r;angular.isDefined(r)||(r=e(function(){o()},ContivGlobals.REFRESH_INTERVAL)),t.$on("$destroy",function(){e.cancel(r)})}]),angular.module("contiv.nodes").config(["$stateProvider",function(t){t.state("contiv.menu.nodes.commission",{url:"/commission/:key",controller:"NodeCommissionCtrl as nodeCommissionCtrl",templateUrl:"nodes/nodecommission.html"})}]).controller("NodeCommissionCtrl",["$state","$stateParams","NodesModel","CRUDHelperService","NodesService",function(t,e,n,o,i){function r(){t.go("contiv.menu.nodes.details.info",{key:e.key})}function a(){r()}function s(){l.form.$valid&&(o.hideServerError(l),o.startLoader(l),l.nodeOpsObj.nodes=[e.key],i.cleanupExtraVars(l),i.createExtraVars(l),n.commission(l.nodeOpsObj).then(function(t){o.stopLoader(l),r()},function(t){o.stopLoader(l),o.showServerError(l,t)}))}var l=this;l.nodeOpsObj={},l.extra_vars={},l.ansibleVariables=[],l.envVariables=[],i.getSettings(l),l.cancelCommissioningNode=a,l.commission=s,o.stopLoader(l),o.hideServerError(l)}]),angular.module("contiv.nodes").config(["$stateProvider",function(t){t.state("contiv.menu.nodes.details",{url:"/details/:key",controller:"NodeDetailsCtrl as nodeDetailsCtrl",templateUrl:"nodes/nodedetails.html"}).state("contiv.menu.nodes.details.info",{url:"/info",controller:"NodeDetailsCtrl as nodeDetailsCtrl",templateUrl:"nodes/nodeinfo.html"}).state("contiv.menu.nodes.details.stats",{url:"/stats",controller:"NodeDetailsCtrl as nodeDetailsCtrl",templateUrl:"nodes/nodestats.html"}).state("contiv.menu.nodes.details.logs",{url:"/logs",controller:"NodeDetailsCtrl as nodeDetailsCtrl",templateUrl:"nodes/nodelogs.html"}).state("contiv.menu.nodes.details.edit",{url:"/edit",controller:"NodeDetailsCtrl as nodeDetailsCtrl",templateUrl:"nodes/nodeinfo.html"})}]).controller("NodeDetailsCtrl",["$state","$stateParams","$scope","$interval","NodesModel","BgpService",function(t,e,n,o,i,r){function a(){var t={nodes:[e.key]};i.decommission(t).then(function(t){h.showCommissionButton=!1,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1})}function s(){var t={nodes:[e.key]};i.upgrade(t).then(function(t){h.showCommissionButton=!1,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1})}function l(){switch(h.node.inventory_state.status){case"Unallocated":h.showCommissionButton=!0,h.commissionButtonEnabled=!0,h.upgradeButtonEnabled=!1;break;case"Decommissioned":h.showCommissionButton=!0,h.commissionButtonEnabled=!0,h.upgradeButtonEnabled=!1;break;case"Provisioning":h.showCommissionButton=!0,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1;break;case"Allocated":h.showCommissionButton=!1,h.commissionButtonEnabled=!0,h.upgradeButtonEnabled=!0;break;case"Cancelled":h.showCommissionButton=!1,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1;break;case"Maintenance":h.showCommissionButton=!0,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1;break;default:h.showCommissionButton=!0,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1}}function c(t){i.getModelByKey(e.key,t).then(function(t){h.node=t,l()})}function u(){t.is("contiv.menu.nodes.details.edit")?h.mode="edit":h.mode="details"}function d(){t.go("contiv.menu.nodes.details.info")}function v(){h.form.$valid&&(h.neighbor.key=e.key,h.neighbors.forEach(function(t){h.neighbor.neighbor=t.name,h.neighbor["neighbor-as"]=t.value}),r.updateBgp(h).then(function(t){h.neighbor=t.config.data,d()},function(t){}))}function f(){r.getBgp(h).then(function(t){h.neighbor=t},function(t){})}function p(){r.getBgpInspect(e.key).then(function(t){h.inspect=t,h.routes=t.Oper.routes,h.filteredroutes=t.Oper.routes},function(t){})}var h=this;h.numberpattern=ContivGlobals.NUMBER_REGEX,h.decommission=a,h.upgrade=s,h.setMode=u,h.updateBgpInfo=v,h.returnToInfo=d,h.neighbors=[],h.neighbor={},h.key=e.key,f(),p(),u(),c(!1);var y;angular.isDefined(y)||(y=o(function(){c(!0)},5e3)),n.$on("$destroy",function(){o.cancel(y)})}]),angular.module("contiv.nodes").directive("ctvNodestatus",function(){return{restrict:"E",scope:{node:"="},templateUrl:"nodes/nodestatus.html"}}).directive("ctvNodestate",function(){return{restrict:"E",scope:{node:"="},templateUrl:"nodes/nodestate.html"}}),angular.module("contiv.nodes").config(["$stateProvider",function(t){t.state("contiv.menu.nodes.discover",{url:"/discover",controller:"NodeDiscoverCtrl as nodeDiscoverCtrl",templateUrl:"nodes/nodediscover.html"})}]).controller("NodeDiscoverCtrl",["$state","$stateParams","NodesModel","CRUDHelperService","NodesService",function(t,e,n,o,i){function r(){t.go("contiv.menu.nodes.list")}function a(){r()}function s(){c.form.$valid&&(o.hideServerError(c),o.startLoader(c),l(),i.createExtraVars(c),n.discover(c.nodeOpsObj).then(function(t){o.stopLoader(c),r()},function(t){o.stopLoader(c),o.showServerError(c,t)}))}function l(){c.nodeOpsObj.addrs=_.words(c.nodeIPAddr,/[^, ]+/g)}var c=this;c.nodeOpsObj={},c.extra_vars={},c.ansibleVariables=[],c.envVariables=[],c.nodeIPAddr="",i.getSettings(c),c.discover=s,c.cancelDiscoveringNode=a,o.stopLoader(c),o.hideServerError(c)}]),angular.module("contiv.nodes").config(["$stateProvider",function(t){t.state("contiv.menu.nodes.lastlog",{url:"/lastlog",controller:"NodeLastJobLogsCtrl as nodeLastJobLogsCtrl",template:'<ctv-logs title="Last Job" log="nodeLastJobLogsCtrl.lastLogs"></ctv-logs>'})}]).controller("NodeLastJobLogsCtrl",["$scope","$interval","LogService",function(t,e,n){function o(){n.getLastLogs().then(function(t){i.lastLogs=t},function(t){})}var i=this;o();var r;angular.isDefined(r)||(r=e(function(){o()},ContivGlobals.REFRESH_INTERVAL)),t.$on("$destroy",function(){e.cancel(r)})}]),angular.module("contiv.nodes").config(["$stateProvider",function(t){t.state("contiv.menu.nodes.list",{url:"/list",controller:"NodeListCtrl as nodeListCtrl",templateUrl:"nodes/nodelist.html"})}]).controller("NodeListCtrl",["$scope","$interval","$filter","NodesModel","CRUDHelperService",function(t,e,n,o,i){function r(t){o.get(t).then(function(t){i.stopLoader(a),a.nodes=t},function(t){i.stopLoader(a)})}var a=this;r(!1);var s;angular.isDefined(s)||(s=e(function(){r(!0)},ContivGlobals.REFRESH_INTERVAL)),t.$on("$destroy",function(){e.cancel(s)})}]),angular.module("contiv.organizations").config(["$stateProvider",function(t){t.state("contiv.menu.organizations.create",{url:"/create",templateUrl:"organizations/organizationcreate.html",controller:"OrganizationCreateCtrl as organizationCreateCtrl"})}]).controller("OrganizationCreateCtrl",["$state","OrganizationsModel","CRUDHelperService",function(t,e,n){function o(){t.go("contiv.menu.organizations.list")}function i(){o()}function r(){s.form.$valid&&(n.hideServerError(s),n.startLoader(s),s.newOrganization.key=s.newOrganization.tenantName,e.create(s.newOrganization).then(function(t){n.stopLoader(s),o()},function(t){n.stopLoader(s),n.showServerError(s,t)}))}function a(){n.stopLoader(s),n.hideServerError(s),s.newOrganization={tenantName:""}}var s=this;s.createOrganization=r,s.cancelCreating=i,a()}]),angular.module("contiv.organizations").config(["$stateProvider",function(t){t.state("contiv.menu.organizations.details",{url:"/details/:key",controller:"OrganizationDetailsCtrl as organizationDetailsCtrl",templateUrl:"organizations/organizationdetails.html"})}]).controller("OrganizationDetailsCtrl",["$state","$stateParams","OrganizationsModel","CRUDHelperService",function(t,e,n,o){function i(){t.go("contiv.menu.organizations.list")}function r(){o.hideServerError(a),o.startLoader(a),n["delete"](a.organization).then(function(t){o.stopLoader(a),i()},function(t){o.stopLoader(a),o.showServerError(a,t)})}var a=this;o.stopLoader(a),o.hideServerError(a),n.getModelByKey(e.key).then(function(t){a.organization=t}),a.deleteOrganization=r}]),angular.module("contiv.settings").config(["$stateProvider",function(t){t.state("contiv.menu.settings.details.cluster",{url:"/cluster",controller:"ClusterSettingCtrl as clusterSettingCtrl",templateUrl:"settings/clustersettings.html"})}]).controller("ClusterSettingCtrl",["$stateParams","CRUDHelperService","NodesService",function(t,e,n){function o(){i.form.$valid&&(e.hideServerError(i),e.startLoader(i),i.nodeOpsObj.nodes=[t.key],n.cleanupExtraVars(i),n.createExtraVars(i),n.updateSettings(i.nodeOpsObj).then(function(t){e.stopLoader(i)},function(t){e.stopLoader(i),e.showServerError(i,t)}))}var i=this;i.nodeOpsObj={},i.extra_vars={},i.ansibleVariables=[],i.envVariables=[],n.getSettings(i),i.updateClusterSettings=o,e.stopLoader(i),e.hideServerError(i)}]),angular.module("contiv.servicelbs").config(["$stateProvider",function(t){t.state("contiv.menu.servicelbs.create",{url:"/create",templateUrl:"service_lbs/servicelbcreate.html",controller:"ServicelbCreateCtrl as servicelbCreateCtrl"})}]).controller("ServicelbCreateCtrl",["$state","$stateParams","ServicelbsModel","NetworksModel","CRUDHelperService",function(t,e,n,o,i){function r(){t.go("contiv.menu.servicelbs.list")}function a(){r()}function s(){o.get().then(function(t){d.networks=_.filter(t,{tenantName:"default"})})}function l(){d.servicelb.selectors=[],angular.forEach(d.labelSelectors,function(t){var e=t.name+"="+t.value;d.servicelb.selectors.push(e)})}function c(){l(),d.form.$valid&&(i.hideServerError(d),i.startLoader(d),d.servicelb.key=d.servicelb.tenantName+":"+d.servicelb.serviceName,n.create(d.servicelb).then(function(t){i.stopLoader(d),r()},function(t){i.stopLoader(d),i.showServerError(d,t)}))}function u(){i.stopLoader(d),i.hideServerError(d),d.servicelb={serviceName:"",networkName:"",ipAddress:"",selectors:[],ports:[],tenantName:"default"}}var d=this;d.labelSelectors=[],d.networks=[],d.createServicelb=c,d.cancelCreating=a,s(),u()}]),angular.module("contiv.servicelbs").config(["$stateProvider",function(t){t.state("contiv.menu.servicelbs.details",{url:"/details/:key",params:{state:null},controller:"ServicelbDetailsCtrl as servicelbDetailsCtrl",templateUrl:"service_lbs/servicelbdetails.html"}).state("contiv.menu.servicelbs.details.info",{url:"/info",controller:"ServicelbDetailsCtrl as servicelbDetailsCtrl",templateUrl:"service_lbs/servicelbinfo.html"}).state("contiv.menu.servicelbs.details.edit",{url:"/edit/:key",controller:"ServicelbDetailsCtrl as servicelbDetailsCtrl",templateUrl:"service_lbs/servicelbinfo.html"})}]).controller("ServicelbDetailsCtrl",["$state","$stateParams","ServicelbsModel","CRUDHelperService",function(t,e,n,o){function i(){t.is("contiv.menu.servicelbs.details.edit")?v.mode="edit":v.mode="details"}function r(){t.go("contiv.menu.servicelbs.list")}function a(){t.go("contiv.menu.servicelbs.details.info",{key:v.servicelb.key,state:"details"})}function s(){a()}function l(){o.hideServerError(v),o.startLoader(v),n["delete"](v.servicelb).then(function(t){o.stopLoader(v),r()},function(t){o.stopLoader(v),o.showServerError(v,t)})}function c(){o.hideServerError(v),o.startLoader(v);var t=v.servicelb.selectors;d(),n.save(v.servicelb).then(function(t){o.stopLoader(v),a()},function(e){v.servicelb.selectors=t,u(),o.stopLoader(v),o.showServerError(v,e)})}function u(){angular.forEach(v.servicelb.selectors,function(t){var e={name:t.split("=")[0],value:t.split("=")[1]};v.labelSelectors.push(e)})}function d(){v.servicelb.selectors=[],angular.forEach(v.labelSelectors,function(t){var e=t.name+"="+t.value;v.servicelb.selectors.push(e)})}var v=this;v.labelSelectors=[],o.stopLoader(v),o.hideServerError(v),n.getModelByKey(e.key).then(function(t){v.servicelb=t,u()}),v.saveServicelb=c,v.cancelEditing=s,v.deleteServicelb=l,i()}]),angular.module("contiv.servicelbs").directive("ctvServicelbports",function(){return{restrict:"E",scope:{items:"="},link:function(t){function e(t,e){return t===e}function n(){t.newItem={servicePort:"",providerPort:"",protocol:""}}function o(t){return""===t.servicePort&&""===t.providerPort&&""===t.protocol}t.add=function(){if(!o(t.newItem)){void 0===t.items&&(t.items=[]);var i=t.newItem.servicePort+":"+t.newItem.providerPort+":"+t.newItem.protocol;_.pullAllWith(t.items,[i],e),t.items.push(i),n()}},t.remove=function(n){_.remove(t.items,function(t){return e(t,n)})},n()},templateUrl:"service_lbs/servicelbports.html"}}),angular.module("contiv.storagepolicies").config(["$stateProvider",function(t){t.state("contiv.menu.storagepolicies.create",{url:"/create",templateUrl:"storage_policies/storagepolicycreate.html",controller:"StoragePolicyCreateCtrl as storagePolicyCreateCtrl"})}]).controller("StoragePolicyCreateCtrl",["$state","$stateParams","StoragePoliciesModel","CRUDHelperService",function(t,e,n,o){function i(){t.go("contiv.menu.storagepolicies.list")}function r(){i()}function a(){c.filesystemcmds.forEach(function(t){c.newStoragePolicy.filesystems[t.name]=t.value})}function s(){c.form.$valid&&(o.hideServerError(c),o.startLoader(c),a(),n.create(c.newStoragePolicy).then(function(t){o.stopLoader(c),i()},function(t){o.stopLoader(c),o.showServerError(c,t)}))}function l(){o.stopLoader(c),o.hideServerError(c),c.newStoragePolicy={name:"",backends:{crud:"ceph",mount:"ceph",snapshot:"ceph"},unlocked:!1,driver:{pool:"rbd"},create:{size:"0",filesystem:""},runtime:{snapshots:!0,snapshot:{frequency:"30m",keep:20},"rate-limit":{"write-iops":0,"read-iops":0,"write-bps":0,"read-bps":0}},filesystems:{}}}var c=this;c.createPolicy=s,c.cancelCreating=r,c.filesystemcmds=[],l()}]),angular.module("contiv.storagepolicies").config(["$stateProvider",function(t){t.state("contiv.menu.storagepolicies.details",{url:"/details/:key",controller:"StoragePolicyDetailsCtrl as storagePolicyDetailsCtrl",templateUrl:"storage_policies/storagepolicydetails.html"}).state("contiv.menu.storagepolicies.edit",{url:"/details/:key",controller:"StoragePolicyDetailsCtrl as storagePolicyDetailsCtrl",templateUrl:"storage_policies/storagepolicydetails.html"})}]).controller("StoragePolicyDetailsCtrl",["$state","$stateParams","$scope","$interval","$filter","StoragePoliciesModel","VolumesModel","CRUDHelperService",function(t,e,n,o,i,r,a,s){function l(){t.is("contiv.menu.storagepolicies.edit")?g.mode="edit":g.mode="details"}function c(){t.go("contiv.menu.storagepolicies.list")}function u(){t.go("contiv.menu.storagepolicies.details",{key:g.policy.name})}function d(){u()}function v(){s.hideServerError(g),s.startLoader(g),r.deleteUsingKey(g.policy.name,"name").then(function(t){s.stopLoader(g),c()},function(t){s.stopLoader(g),s.showServerError(g,t)})}function f(t){a.get(t).then(function(t){g.volumes=i("orderBy")(_.filter(t,{policy:g.policy.name}),"name")})}function p(){angular.forEach(g.policy.filesystems,function(t,e){this.push({name:e,value:t})},g.filesystemcmds)}function h(){g.filesystemcmds.forEach(function(t){g.policy.filesystems[t.name]=t.value})}function y(){g.form.$valid&&(s.hideServerError(g),s.startLoader(g),h(),r.save(g.policy).then(function(t){s.stopLoader(g),u()},function(t){s.stopLoader(g),s.showServerError(g,t)}))}var g=this;g.filesystemcmds=[],s.stopLoader(g),s.hideServerError(g),r.getModelByKey(e.key,!1,"name").then(function(t){g.policy=t,p(),f(!1)}),g.deletePolicy=v,g.savePolicy=y,g.cancelEditing=d,l();var m;angular.isDefined(m)||(m=o(function(){f(!0)},ContivGlobals.REFRESH_INTERVAL)),n.$on("$destroy",function(){o.cancel(m)})}]),angular.module("contiv.storagepolicies").directive("ctvStoragepolicybasicsettings",function(){return{}}).directive("ctvStoragepolicyfilesystemsettings",function(){return{restrict:"E",scope:{policy:"=",filesystemcmds:"="},link:function(t){t.filesystems=["ext4","btrfs"]},templateUrl:"storage_policies/filesystemsettings.html"}}).directive("ctvStoragepolicysnapshotsettings",function(){return{restrict:"E",scope:{policy:"="},templateUrl:"storage_policies/snapshotsettings.html"}}).directive("ctvStoragepolicyrwopssettings",function(){return{restrict:"E",scope:{policy:"="},templateUrl:"storage_policies/rwopssettings.html"}}).directive("ctvStoragepolicybackenddrivers",function(){return{restrict:"E",scope:{policy:"="},templateUrl:"storage_policies/backenddrivers.html"}}),angular.module("contiv.visualization").config(["$stateProvider",function(t){t.state("contiv.menu.visualization.edge",{url:"/edge/{sourceName, targetName, sourceList, targetList}",params:{sourceName:null,targetName:null,sourceList:null,targetList:null},controller:"VisualizationEdgeCtrl as visualizationedgeCtrl",templateUrl:"visualization/visualizationedge.html"})}]).controller("VisualizationEdgeCtrl",["$scope","$http","$state","$stateParams","VisualizationService","$interval",function(t,e,n,o,i,r){var a=o.sourceName,s=o.targetName,l=o.sourceList,c=o.targetList;if(null==l||null==c)return void n.go("contiv.menu.visualization.list");var u=new Date,d=u.getSeconds();t.edgeDataInterval=r(function(){i.getEdgeData(l,c,d.toString()).then(function(e){var n=e.results,o=0;_.forEach(n,function(t){_.isEmpty(t)===!1&&(o+=t.series[0].values[0][1])}),t.sourceName=a,t.targetName=s,t.edgeData=o,t.edgeDataTime=d},function(t){})},3e3),t.$on("$destroy",function(){r.cancel(t.edgeDataInterval)}),i.getOldEdgeData(l,c).then(function(e){var n=e.results,o=[];_.forEach(n,function(t){if(_.isEmpty(t)===!1){var e=t.series[0].values;_.isEmpty(o)?_.forEach(e,function(t){o.push(t[1])}):_.forEach(e,function(t,e){o[e]+=t[1]})}}),t.sourceName=a,t.targetName=s,t.sourceList=l,t.targetList=c,t.oldEdgeData=o},function(t){})}]),angular.module("contiv.visualization").directive("visualizationEdge",["$window",function(t){function e(t,e){function n(){l=new Date;for(var e in c){var o=c[e];o.data.push(t.edgeData||0),o.path.attr("d",v)}u.domain([l-(a-2)*s,l-s]),y.transition().duration(s).ease("linear").call(u.axis),p.transition().duration(s).ease("linear").call(d.axis),g.attr("transform",null).transition().duration(s).ease("linear").attr("transform","translate("+u(l-(a-1)*s)+")").each("end",function(){n()});for(var e in c){var o=c[e];o.data.shift()}}var o=document.getElementsByTagName("body")[0],i=o.clientWidth-400,r=o.clientHeight-400,a=59,s=750,l=new Date(Date.now()-s),c={current:{value:0,color:"orange",data:e.range(a).map(function(e){return t.oldEdgeData[Math.floor(e/10)]||0})}},u=e.time.scale().domain([l-(a-2),l-s]).range([0,i]),d=e.scale.linear().domain([0,e.max(c.current.data,function(t){return t+10})]).range([r,0]),v=e.svg.line().interpolate("basis").x(function(t,e){return u(l-(a-1-e)*s)}).y(function(t){return d(t)}),f=e.select(".graph").append("svg").attr("width",25).style("overflow","visible").style("position","fixed"),p=f.append("g").attr("class","y axis").call(d.axis=e.svg.axis().scale(d).orient("left")),h=e.select(".graph").append("svg").attr("class","chart").attr("width",i-50).attr("height",r+50),y=h.append("g").attr("class","x axis").attr("transform","translate(0,"+r+")").call(u.axis=e.svg.axis().scale(u).orient("bottom")),g=h.append("g");for(var m in c){var b=c[m];b.path=g.append("path").data([b.data]).attr("class",m+" group").style("stroke",b.color)}n()}return{restrict:"EA",replace:!1,templateUrl:"visualization/visualizationedgetemplate.html",link:function(n){n.$watchGroup(["edgeData","oldEdgeData"],function(){if(null!=n.edgeData&&null!=n.oldEdgeData&&!n.initialize){n.initialize=!0;var o=t.d3;e(n,o)}})}}}]),angular.module("contiv.visualization").service("StateSave",function(){this.savedStates={}}).directive("visualizationGraph",["$window","$state","VisualizerGraph","PolicyService","VisualizerDataSource","StateSave",function(t,e,n,o,i,r){function a(t,n,o,i,r,a){if(void 0!==t.nodes&&void 0!==t.links&&void 0!==t.children_struct&&void 0!==t.ancestors_struct){var s=new r.DataSource(t.nodes,t.links,t.children_struct,t.ancestors_struct,t.labels,t.serviceSelectors);s.setAncestors();var l,c,u=s.getTopLevelFlow();l=s.processNodeData(u.nodeData),c=s.processLinkData(u.linkData,l);var d=document.getElementsByTagName("body")[0],v=(d.clientWidth,d.clientHeight),f=n.find("svg"),p=$(f.parent()).offset(),h=$(f.parent()).width(),y=d3.select(f[0]).attr("width",h).attr("height",v-p.top-20);t.visualizationGraph=new o.Graph(y,l,c,s,t.children_struct,t.ancestors_struct),t.visualizationGraph.installDefaultPathPolicy(new i.SaveStatePolicy(a.savedStates)),t.visualizationGraph.installDefaultPathPolicy(new i.PathChangeViewPolicy(e));var g=new i.QTipPolicy;t.visualizationGraph.installDefaultNodePolicy(g),t.visualizationGraph.installDefaultPathPolicy(g);var m=new i.SplitJoinViewPolicy;if(t.visualizationGraph.installDefaultNodePolicy(m),m.installBackButton($("#backButton")),m.installTitle($("#graph-title")),0==_.isEmpty(a.savedStates)){var b=t.visualizationGraph;b.load(a.savedStates)}else t.visualizationGraph.updateGraph()}}return{restrict:"EA",replace:!1,templateUrl:"visualization/visualizationtemplate.html",link:function(t,e){t.$on("$destroy",function(){$("#visualization-graph").unbind(),t.visualizationGraph.destroy()}),t.$watchGroup(["nodes","links","children_struct","ancestors_struct"],function(){null!=t.nodes&&null!=t.links&&null!=t.children_struct&&null!=t.ancestors_struct&&(t.initialized?(t.visualizationGraph.dataSource.links=t.links,t.visualizationGraph.updateLinkData()):(t.initialized=!0,a(t,e,n,o,i,r)))})}}}]),angular.module("contiv.visualization").config(["$stateProvider",function(t){t.state("contiv.menu.visualization.list",{url:"/list",controller:"VisualizationListCtrl as visualizationListCtrl",templateUrl:"visualization/visualizationlist.html"})}]).controller("VisualizationListCtrl",["$scope","$http","VisualizationService","$interval",function(t,e,n,o){var i=function(e){var n=[],o=[],i=[];_.forEach(e.results[0].series,function(t){var e,r=t.tags.EndpointIP,a=t.tags.ProviderIP;0==_.includes(i,r)&&(e={name:r,id:r,parent:null,ancestors:null},n.push(e),i.push(r)),0==_.includes(i,a)&&(e={name:a,id:a,parent:null,ancestors:null},n.push(e),i.push(a));var s={source:r,target:a,weight:t.values[0][2]};o.push(s);var l={source:a,target:r,weight:t.values[0][1]};o.push(l)}),t.nodes=n,t.links=o};n.getGraphData().then(i,function(t){}),t.$on("$destroy",function(){o.cancel(t.graphDataInterval)}),n.getStructureData().then(function(e){t.ancestors_struct=e.ancestors_struct,t.children_struct=e.children_struct,t.labels=e.labels,t.serviceSelectors=e.serviceSelectors},function(t){})}]),angular.module("contiv.visualization").factory("VisualizationService",["$http","$q",function(t,e){function n(n,o){var i=e.defer();return t.get(n,o).then(function(t){i.resolve(t.data)},function(t){i.reject(t.data)}),i.promise}function o(n,o){var i=function(t){var e,n,o,r,a,s,l,c="";for(e in t)if(n=t[e],n instanceof Array)for(l=0;l<n.length;++l)a=n[l],o=e+"["+l+"]",s={},s[o]=a,c+=i(s)+"&";else if(n instanceof Object)for(r in n)a=n[r],o=e+"["+r+"]",s={},s[o]=a,c+=i(s)+"&";else void 0!==n&&null!==n&&(c+=encodeURIComponent(e)+"="+encodeURIComponent(n)+"&");return c.length?c.substr(0,c.length-1):c},r=e.defer();return t({url:n,method:"POST",data:o,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(t){return angular.isObject(t)&&"[object File]"!==String(t)?i(t):t}]}).then(function(t){r.resolve(t.data)},function(t){r.reject(t.data)}),r.promise}function i(){var t=ContivGlobals.VISUALIZATION_ENDPOINT;t+="influx/query";var e={params:{db:"telegraf",q:"SELECT BytesIn, BytesOut, EndpointIP, ProviderIP FROM httpjson_svcstats WHERE time > now() - 1m GROUP BY * LIMIT 1"}};return n(t,e)}function r(){var t=ContivGlobals.VISUALIZATION_ENDPOINT;return t+="services",n(t)}function a(t,e){var n="(";n+=e+"=",n+="'"+t[0]+"' ";for(var o=1;o<t.length;o++)n+="OR ",n+=e+"=",n+="'"+t[o]+"' ";return n+=")"}function s(t,e,n){var i=ContivGlobals.VISUALIZATION_ENDPOINT;i+="influx/query";var r={db:"telegraf",q:"SELECT sum(BytesOut) from httpjson_svcstats WHERE time > now() - 15s AND "+a(t,"EndpointIP")+" AND "+a(e,"ProviderIP")+"GROUP BY time(20s) LIMIT 1; SELECT sum(BytesIn) from httpjson_svcstats WHERE time > now() - 15s AND "+a(t,"ProviderIP")+" AND "+a(e,"EndpointIP")+"GROUP BY time(20s) fill(0) LIMIT 1"};return o(i,r)}function l(t,e){var n=ContivGlobals.VISUALIZATION_ENDPOINT;n+="influx/query";var i={db:"telegraf",q:"SELECT sum(BytesOut) FROM httpjson_svcstats WHERE time > now() - 1m AND "+a(t,"EndpointIP")+" AND "+a(e,"ProviderIP")+" GROUP BY time(10s) fill(0) LIMIT 6; SELECT sum(BytesIn) FROM httpjson_svcstats WHERE time > now() - 1m AND "+a(t,"ProviderIP")+" AND "+a(e,"EndpointIP")+" GROUP BY time(10s) fill(0) LIMIT 6"};return o(n,i)}return{getGraphData:i,getStructureData:r,getEdgeData:s,getOldEdgeData:l}}]),angular.module("contiv.volumes").config(["$stateProvider",function(t){t.state("contiv.menu.volumes.create",{url:"/create",templateUrl:"volumes/volumecreate.html",controller:"VolumeCreateCtrl as volumeCreateCtrl"})}]).controller("VolumeCreateCtrl",["$state","$stateParams","VolumesModel","StoragePoliciesModel","CRUDHelperService",function(t,e,n,o,i){function r(){t.go("contiv.menu.volumes.list")}function a(){r()}function s(){o.get().then(function(t){d.policies=t})}function l(){d.newVolume.policy=d.selectedPolicy.name,d.newVolume.backends=d.selectedPolicy.backends,d.newVolume.driver=d.selectedPolicy.driver,d.newVolume.create=d.selectedPolicy.create,d.newVolume.runtime=d.selectedPolicy.runtime}function c(){d.form.$valid&&(i.hideServerError(d),i.startLoader(d),l(),n.create(d.newVolume).then(function(t){i.stopLoader(d),r()},function(t){i.stopLoader(d),i.showServerError(d,t)}))}function u(){i.stopLoader(d),i.hideServerError(d),d.newVolume={name:"",backends:{},driver:{},create:{},runtime:{}}}var d=this;d.filesystems=["ext4","btrfs"],d.createVolume=c,d.cancelCreating=a,s(),u()}]),angular.module("contiv.volumes").config(["$stateProvider",function(t){t.state("contiv.menu.volumes.copy",{url:"/copy/",params:{snapshot:null,policy:null,volume:null},controller:"VolumeSnapshotCopyCtrl as volumeSnapshotCopyCtrl",templateUrl:"volumes/volumesnapshotcopy.html"})}]).controller("VolumeSnapshotCopyCtrl",["$state","$stateParams","$scope","$interval","$http","VolumesModel","CRUDHelperService",function(t,e,n,o,i,r,a){function s(){t.go("contiv.menu.volumes.details",{key:e.policy+"/"+e.volume})}function l(){t.go("contiv.menu.volumes.details",{key:e.policy+"/"+u.newvolume})}function c(){if(u.form.$valid){a.hideServerError(u),a.startLoader(u);var t={};t.policy=e.policy,t.name=e.volume,r.copy(t,e.snapshot,u.newvolume).then(function(t){a.stopLoader(u),l()},function(t){a.stopLoader(u),a.showServerError(u,t)})}}var u=this;u.policy=e.policy,u.volume=e.volume,u.snapshot=e.snapshot,u.copySnapshot=c,u.cancelCopy=s}]),angular.module("contiv.directives").directive("ctvAcivalid",function(){return{restrict:"E",templateUrl:"components/directives/nodes/acivalid.html",scope:{form:"="}}}),angular.module("contiv.directives").directive("ctvControlinterface",function(){return{restrict:"E",templateUrl:"components/directives/nodes/controlinterface.html",scope:{extravars:"="}}}),angular.module("contiv.directives").directive("ctvNetworkmode",function(){return{restrict:"E",templateUrl:"components/directives/nodes/networkmode.html",scope:{extravars:"="}}}),angular.module("contiv.directives").directive("ctvScheduler",function(){return{restrict:"E",templateUrl:"components/directives/nodes/scheduler.html",scope:{extravars:"="}}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9idW5kbGUuanMiLCJtb2R1bGUuanMiLCJkaXJlY3RpdmVzL21vZHVsZS5qcyIsIm1vZGVscy9tb2R1bGUuanMiLCJkYXRhc291cmNlL2RhdGFzb3VyY2UuanMiLCJ1dGlscy9tb2R1bGUuanMiLCJkYXRhc291cmNlL3Zpc3VhbGl6ZXJkYXRhc291cmNlLmpzIiwiYXBwbGljYXRpb25ncm91cHMvbW9kdWxlLmpzIiwiZ3JhcGgvZ3JhcGguanMiLCJkYXNoYm9hcmQvbW9kdWxlLmpzIiwiZ3JhcGgvdmlzdWFsaXplcmdyYXBoLmpzIiwibG9naW4vbW9kdWxlLmpzIiwibGluay9saW5rLmpzIiwibWVudS9tb2R1bGUuanMiLCJuZXR3b3JrX3BvbGljaWVzL21vZHVsZS5qcyIsImxpbmsvdmlzdWFsaXplcmxpbmsuanMiLCJuZXR3b3Jrcy9tb2R1bGUuanMiLCJub2RlL25vZGUuanMiLCJub2Rlcy9tb2R1bGUuanMiLCJub2RlL3Zpc3VhbGl6ZXJub2RlLmpzIiwib3JnYW5pemF0aW9ucy9tb2R1bGUuanMiLCJwb2xpY3kvbm9kZXNlbGVjdGlvbnBvbGljeS5qcyIsInNlcnZpY2VfbGJzL21vZHVsZS5qcyIsInNldHRpbmdzL21vZHVsZS5qcyIsInBvbGljeS9wYXRoY2hhbmdldmlld3BvbGljeS5qcyIsInN0b3JhZ2VfcG9saWNpZXMvbW9kdWxlLmpzIiwicG9saWN5L3BvbGljeS5qcyIsInZpc3VhbGl6YXRpb24vbW9kdWxlLmpzIiwicG9saWN5L3BvbGljeXNlcnZpY2UuanMiLCJ2b2x1bWVzL21vZHVsZS5qcyIsInBvbGljeS9xdGlwcG9saWN5LmpzIiwiYXBwLmpzIiwibG9naW4vbG9naW5jdHJsLmpzIiwibWVudS9tZW51Q3RybC5qcyIsInBvbGljeS9zYXZlc3RhdGVwb2xpY3kuanMiLCJuZXR3b3JrX3BvbGljaWVzL2JhbmR3aWR0aGRpcmVjdGl2ZS5qcyIsIm5ldHdvcmtfcG9saWNpZXMvbmV0d29ya3BvbGljaWVzdGFic2N0cmwuanMiLCJwb2xpY3kvc3BsaXRqb2lubm9kZXBvbGljeS5qcyIsIm5ldHdvcmtzL25ldHdvcmtjcmVhdGVjdHJsLmpzIiwicG9saWN5L3NwbGl0am9pbnZpZXdwb2xpY3kuanMiLCJub2Rlcy9iZ3BzZXJ2aWNlLmpzIiwibm9kZXMvbG9nc2RpcmVjdGl2ZS5qcyIsIm5vZGVzL2xvZ3NlcnZpY2UuanMiLCJub2Rlcy9ub2RlYWN0aXZlam9ibG9nc2N0cmwuanMiLCJub2Rlcy9ub2RlY29tbWlzc2lvbmN0cmwuanMiLCJub2Rlcy9ub2RlZGV0YWlsc2N0cmwuanMiLCJub2Rlcy9ub2RlZGlyZWN0aXZlLmpzIiwibm9kZXMvbm9kZWRpc2NvdmVyY3RybC5qcyIsIm5vZGVzL25vZGVsYXN0am9ibG9nc2N0cmwuanMiLCJub2Rlcy9ub2RlbGlzdGN0cmwuanMiLCJvcmdhbml6YXRpb25zL29yZ2FuaXphdGlvbmNyZWF0ZWN0cmwuanMiLCJvcmdhbml6YXRpb25zL29yZ2FuaXphdGlvbmRldGFpbHNjdHJsLmpzIiwic2V0dGluZ3MvY2x1c3RlcnNldHRpbmdjdHJsLmpzIiwic2VydmljZV9sYnMvc2VydmljZWxiY3JlYXRlY3RybC5qcyIsInNlcnZpY2VfbGJzL3NlcnZpY2VsYmRldGFpbHNjdHJsLmpzIiwic2VydmljZV9sYnMvc2VydmljZWxicG9ydHNkaXJlY3RpdmUuanMiLCJzdG9yYWdlX3BvbGljaWVzL3N0b3JhZ2Vwb2xpY3ljcmVhdGVjdHJsLmpzIiwic3RvcmFnZV9wb2xpY2llcy9zdG9yYWdlcG9saWN5ZGV0YWlsc2N0cmwuanMiLCJzdG9yYWdlX3BvbGljaWVzL3N0b3JhZ2Vwb2xpY3lkaXJlY3RpdmUuanMiLCJ2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb25lZGdlY3RybC5qcyIsInZpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbmVkZ2VkaXJlY3RpdmUuanMiLCJ2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb25ncmFwaGRpcmVjdGl2ZS5qcyIsInZpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbmxpc3RjdHJsLmpzIiwidmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9uc2VydmljZS5qcyIsInZvbHVtZXMvdm9sdW1lY3JlYXRlY3RybC5qcyIsInZvbHVtZXMvdm9sdW1lc25hcHNob3Rjb3B5Y3RybC5qcyIsImNvbXBvbmVudHMvZGlyZWN0aXZlcy9ub2Rlcy9hY2l2YWxpZGRpcmVjdGl2ZS5qcyIsImNvbXBvbmVudHMvZGlyZWN0aXZlcy9ub2Rlcy9jb250cm9saW50ZXJmYWNlZGlyZWN0aXZlLmpzIiwiY29tcG9uZW50cy9kaXJlY3RpdmVzL25vZGVzL25ldHdvcmttb2RlZGlyZWN0aXZlLmpzIiwiY29tcG9uZW50cy9kaXJlY3RpdmVzL25vZGVzL3NjaGVkdWxlcmRpcmVjdGl2ZS5qcyJdLCJuYW1lcyI6WyJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iLCJzZWxmIiwiY2FsbCIsIlJlZmVyZW5jZUVycm9yIiwiX2luaGVyaXRzIiwic3ViQ2xhc3MiLCJzdXBlckNsYXNzIiwicHJvdG90eXBlIiwiT2JqZWN0IiwiY3JlYXRlIiwiY29uc3RydWN0b3IiLCJ2YWx1ZSIsImVudW1lcmFibGUiLCJ3cml0YWJsZSIsImNvbmZpZ3VyYWJsZSIsInNldFByb3RvdHlwZU9mIiwiX19wcm90b19fIiwiYW5ndWxhciIsIm1vZHVsZSIsIkNvbnRpdkdsb2JhbHMiLCJORVRXT1JLU19FTkRQT0lOVCIsIk5FVFdPUktTX0lOU1BFQ1RfRU5EUE9JTlQiLCJTRVJWSUNFTEJTX0lOU1BFQ1RfRU5EUE9JTlQiLCJQT0xJQ0lFU19FTkRQT0lOVCIsIlJVTEVTX0VORFBPSU5UIiwiQVBQTElDQVRJT05HUk9VUFNfRU5EUE9JTlQiLCJTRVJWSUNFTEJTX0VORFBPSU5UIiwiT1JHQU5JWkFUSU9OU19FTkRQT0lOVCIsIk5FVFdPUktfU0VUVElOR1NfRU5EUE9JTlQiLCJORVRQUk9GSUxFU19FTkRQT0lOVCIsIkJHUFNfRU5EUE9JTlQiLCJCR1BTX0lOU1BFQ1RfRU5EUE9JTlQiLCJWSVNVQUxJWkFUSU9OX0VORFBPSU5UIiwiVk9MVU1FU19FTkRQT0lOVCIsIlZPTFVNRVNfQ1JFQVRFX0VORFBPSU5UIiwiVk9MVU1FU19ERUxFVEVfRU5EUE9JTlQiLCJWT0xVTUVTX0NPUFlTTkFQU0hPVFNfRU5EUE9JTlQiLCJWT0xVTUVTX1VTRVNfRU5EUE9JTlQiLCJWT0xVTUVTX1NOQVBTSE9UU19FTkRQT0lOVCIsIlNUT1JBR0VQT0xJQ0lFU19FTkRQT0lOVCIsIlZPTFVNRVNfR0xPQkFMX0VORFBPSU5UIiwiTk9ERVNfTElTVF9FTkRQT0lOVCIsIk5PREVTX0RJU0NPVkVSX0VORFBPSU5UIiwiTk9ERVNfQ09NTUlTU0lPTl9FTkRQT0lOVCIsIk5PREVTX0RFQ09NTUlTU0lPTl9FTkRQT0lOVCIsIk5PREVTX01BSU5URU5BTkNFX0VORFBPSU5UIiwiTk9ERVNfTEFTVF9KT0JfRU5EUE9JTlQiLCJOT0RFU19BQ1RJVkVfSk9CX0VORFBPSU5UIiwiTk9ERVNfU0VUVElOR1NfU0VUX0VORFBPSU5UIiwiTk9ERVNfU0VUVElOR1NfR0VUX0VORFBPSU5UIiwiUkVGUkVTSF9JTlRFUlZBTCIsIkNJRFJfUkVHRVgiLCJWTEFOX1JFR0VYIiwiVlhMQU5fUkVHRVgiLCJOVU1CRVJfUkVHRVgiLCJfY3JlYXRlQ2xhc3MiLCJkZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJpIiwibGVuZ3RoIiwiZGVzY3JpcHRvciIsImRlZmluZVByb3BlcnR5Iiwia2V5IiwicHJvdG9Qcm9wcyIsInN0YXRpY1Byb3BzIiwiZmFjdG9yeSIsIk5vZGUiLCJMaW5rIiwiRGF0YVNvdXJjZSIsIm5vZGVzIiwibGlua3MiLCJ0aGlzIiwiaWQiLCJuYW1lIiwibm9kZURhdGEiLCJfIiwiZm9yRWFjaCIsImRhdGEiLCJuZXdOb2RlIiwidGV4dCIsInB1c2giLCJsaW5rRGF0YSIsImZpbmROb2RlQnlJZCIsInNvdXJjZSIsImxpbmsiLCJWaXN1YWxpemVyTm9kZSIsIlZpc3VhbGl6ZXJMaW5rIiwiVmlzdWFsaXplckRhdGFTb3VyY2UiLCJfRGF0YVNvdXJjZSREYXRhU291cmMiLCJjaGlsZHJlbl9zdHJ1Y3QiLCJhbmNlc3RvcnNfc3RydWN0IiwibGFiZWxzIiwic2VsZWN0b3JzIiwiX3RoaXMiLCJnZXRQcm90b3R5cGVPZiIsInRoaXNEYXRhU291cmNlIiwiYWRkZWRDbGllbnQiLCJub2RlIiwiYW5jZXN0b3JzIiwiaXNFbXB0eSIsInBhcmVudCIsImluY2x1ZGVzIiwidG9wTGV2ZWwiLCJnZXRGbG93QmV0d2VlblNldCIsIm5vZGVfbmFtZXMiLCJsb2NhbF9ub2RlcyIsImlkTWFwcGluZyIsImoiLCJpbmRleE9mIiwid2VpZ2h0Iiwibm9kZV90b19hZGQiLCJub2RlSWRUb05hbWUiLCJhZGRlZF9saW5rcyIsInVuZGVmaW5lZCIsImV4aXN0aW5nX2xpbmsiLCJzZXRXZWlnaHQiLCJnZXRSYXdXZWlnaHQiLCJpbmNyZWFzZUNvdW50IiwiY29uZmlnIiwiJHN0YXRlUHJvdmlkZXIiLCJzdGF0ZSIsInVybCIsImFic3RyYWN0IiwidGVtcGxhdGUiLCJjb21wb25lbnQiLCJQb2xpY3lTZXJ2aWNlIiwiR3JhcGgiLCJzdmciLCJ0aGlzR3JhcGgiLCJkZWZhdWx0Tm9kZVBvbGljaWVzIiwiZGVmYXVsdFBhdGhQb2xpY2llcyIsInN2Z1BvbGljeSIsIlBvbGljeSIsImNhblpvb20iLCJjYW5QYW4iLCJpbml0Rm9yY2UiLCJkaXNhYmxlVXBkYXRlIiwiY29uc3RzIiwiY2lyY2xlR0NsYXNzIiwiZ3JhcGhDbGFzcyIsInBhdGhDbGFzcyIsIm5vZGVDbGFzcyIsIm5vZGVUZXh0Iiwic3RhcnRSYWRpdXMiLCJtYXhSYWRpdXMiLCJwYWRkaW5nIiwiZGlzcGxheU9mZnNldCIsIm9uIiwiZCIsImRlZnMiLCJhcHBlbmQiLCJhdHRyIiwic3ZnRyIsImNsYXNzZWQiLCJwYXRocyIsInNlbGVjdEFsbCIsImNpcmNsZXMiLCJpbml0Tm9kZXMiLCJpbml0TGlua3MiLCJzZXRQb3NpdGlvbnMiLCJyZXNpemVGdW5jIiwib25XaW5kb3dSZXNpemUiLCJiaW5kaW5ncyIsInJlc2l6ZSIsIiQiLCJ3aW5kb3ciLCJwb2xpY3kiLCJkZXN0cm95Iiwib2ZmIiwiaW5pdGlhbGl6ZSIsImQzTm9kZSIsImVhY2giLCJkMyIsInNlbGVjdCIsImQzZHJhZyIsImRyYWciLCJwb2xpY3lSZW1vdmUiLCJwb2xpY3lSZW1vdmVOYW1lIiwicG9saWN5TmFtZSIsImluZGV4Iiwic3BsaWNlIiwiZXZlbnQiLCJkM3BhdGgiLCJkM25vZGUiLCJkM3pvb20iLCJkcmFnU3ZnIiwiZ0VsIiwidGl0bGUiLCJ3b3JkcyIsInNwbGl0IiwibndvcmRzIiwiZWwiLCJ0c3BhbiIsInRvU3BsaWNlIiwiZmlsdGVyIiwibCIsIm1hcCIsInVwZGF0ZUdyYXBoIiwic3BsaWNlTGlua3NGb3JOb2RlIiwidXBkYXRlQXR0ciIsIm5ld1BhdGhzIiwibmV3UGF0aEF0dHIiLCJoYXNQb2xpY3kiLCJwYXRoUG9saWN5RXZlbnQiLCJuZXdOb2RlcyIsImdyYXBoIiwibmV3Tm9kZUF0dHIiLCJub2RlUG9saWN5RXZlbnQiLCJTdHJpbmciLCJyYWRpdXMiLCJpbnNlcnRUaXRsZUxpbmVicmVha3MiLCJhbHBoYSIsInF1YWR0cmVlIiwiZ2VvbSIsInIiLCJueDEiLCJ4IiwibngyIiwibnkxIiwieSIsIm55MiIsInZpc2l0IiwicXVhZCIsIngxIiwieTEiLCJ4MiIsInkyIiwicG9pbnQiLCJNYXRoIiwic3FydCIsImUiLCJ3aWR0aCIsImhlaWdodCIsIm9mZnNldCIsInEiLCJuIiwiZDNGb3JjZUNvbGxpZGUiLCJtYXgiLCJtaW4iLCJzdmdXaWR0aCIsInN2Z0hlaWdodCIsImNhbGxiYWNrIiwiYm91bmRzIiwiZDNGb3JjZUJvdW5kcyIsImZvcmNlIiwibGF5b3V0Iiwic2l6ZSIsImNoYXJnZSIsImxpbmtEaXN0YW5jZSIsImxpbmtTdHJlbmd0aCIsImdyYXZpdHkiLCJkM0ZvcmNlVGljayIsImQzRm9yY2VTdGFydCIsImQzRm9yY2VFbmQiLCJzdGFydCIsImsiLCJ0aWNrIiwic3RvcCIsInVwZGF0ZUV4aXN0aW5nTm9kZXMiLCJuZXdHcyIsImVudGVyIiwiZXhpdCIsInJlbW92ZSIsInNldEZvcmNlIiwidXBkYXRlTmV3Tm9kZXMiLCJ1cGRhdGVFeGlzdGluZ1BhdGhzIiwibmV3cGF0aHMiLCJzdHlsZSIsInVwZGF0ZU5ld1BhdGhzIiwiVmlzdWFsaXplckdyYXBoIiwiX0dyYXBoJEdyYXBoIiwiZGF0YVNvdXJjZSIsInRyYW5zaXRpb24iLCJlZGdlX2J1ZmZlciIsInJhZGl1c0RlY2F5IiwiY29udGFpbmVyQ2xhc3MiLCJiZWhhdmlvciIsIm9yaWdpbiIsImFyZ3MiLCJkeCIsImR5Iiwiem9vbSIsInNvdXJjZUV2ZW50IiwiY3RybEtleSIsInpvb21lZCIsInRyYW5zbGF0ZSIsInNjYWxlIiwicmlnaHRDbGljayIsImp1c3RTY2FsZVRyYW5zR3JhcGgiLCJ6b29tU2V0Q2FsbGJhY2siLCJ0cmFuc2xhdGVfbmFtZSIsImRlbGF5IiwiZHVyYXRpb24iLCJib2R5RWwiLCJkb2N1bWVudCIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwiZGl2V2lkdGgiLCJjbGllbnRIZWlnaHQiLCJ0b3AiLCJub2RlX25hbWVzX3NldCIsInJldERhdGEiLCJwcm9jZXNzTGlua0RhdGEiLCJzb3VyY2VOb2RlIiwidGFyZ2V0Tm9kZSIsInBhdGhQb2xpY2llcyIsImluaXRpYWxpemVkIiwiYXJyb3dQYXRoIiwiZHIiLCJ0aGlzUGF0aCIsIl9nZXQiLCJnZXQiLCJvYmplY3QiLCJwcm9wZXJ0eSIsInJlY2VpdmVyIiwiRnVuY3Rpb24iLCJkZXNjIiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwiZ2V0dGVyIiwiX0xpbmskTGluayIsImNvdW50IiwicmV0IiwibXkiLCJhdCIsImFkanVzdCIsIm1heFdlaWdodCIsInVzZUF2Z1dlaWdodCIsInVwZGF0ZU1heFdlaWdodCIsInZhbCIsIm1heExpbmsiLCJtYXhCeSIsImdldFdlaWdodCIsImNvbG9yU2NhbGUiLCJsaW5lYXIiLCJkb21haW4iLCJyYW5nZSIsInNlbGVjdGVkQ2xhc3MiLCJzZWxlY3RlZEVkZ2UiLCJjIiwiYXR0clR3ZWVuIiwiaW50ZXJwb2xhdGVTdHJpbmciLCJub2RlUG9saWNpZXMiLCJ0aGlzTm9kZSIsIl9Ob2RlJE5vZGUiLCJ4U3RhcnQiLCJ5U3RhcnQiLCJOb2RlU2VsZWN0aW9uUG9saWN5IiwiX1BvbGljeSRQb2xpY3kiLCJzZWxlY3RlZE5vZGVzIiwic2VsZWN0aW9uIiwiY2QiLCJzdG9wUHJvcGFnYXRpb24iLCJyZW1vdmVTZWxlY3RGcm9tTm9kZSIsImFkZFNlbGVjdE5vZGUiLCJyZW1vdmVBbGxTZWxlY3RlZE5vZGVzIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwiUGF0aENoYW5nZVZpZXdQb2xpY3kiLCIkc3RhdGUiLCJ0aGlzUG9saWN5IiwicmV0TGlzdCIsImdlbmVyYXRlTGlzdEhlbHBlciIsIm5vZGVJZHMiLCJjaGlsZElkIiwiaGFzQ2hpbGQiLCJzdWJSZXRMaXN0IiwiY29uY2F0IiwiZWRnZSIsInNvdXJjZUxpc3QiLCJ0YXJnZXRMaXN0Iiwic291cmNlSWQiLCJ0YXJnZXRJZCIsImdlbmVyYXRlTGlzdCIsImdvIiwic291cmNlTmFtZSIsInRhcmdldE5hbWUiLCJ2aWV3RWRnZSIsImQzb2JqIiwiUVRpcFBvbGljeSIsIlNwbGl0Sm9pbk5vZGVQb2xpY3kiLCJTcGxpdEpvaW5WaWV3UG9saWN5IiwiU2F2ZVN0YXRlUG9saWN5IiwibW91c2Vkb3duIiwibW91c2V1cCIsImdyYXBoVXBkYXRlTmV3Tm9kZXMiLCJncmFwaFVwZGF0ZU5ld1BhdGhzIiwiaW50ZXJ2YWwiLCJzZXRUaW1lb3V0IiwicXRpcCIsIndoZW5RVGlwQXZhaWxhYmxlIiwiYXR0YWNoUVRpcCIsInNlbGVjdG9yTWFwIiwiaGFzS2V5cyIsImxhYmVsc01hcCIsInNsaWNlIiwiY29udGVudCIsImV2ZW50cyIsInNob3ciLCJhcGkiLCJwb3NpdGlvbiIsImxlZnQiLCJzZXQiLCJzb2xvIiwiY2xhc3NlcyIsImhpZGUiLCJwYXRoRWwiLCJ0YXJnZXRSZXQiLCJnZXRQb2ludEF0TGVuZ3RoIiwiZ2V0VG90YWxMZW5ndGgiLCJxdGlwSGVscGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwib3RoZXJ3aXNlIiwiQ1JVREhlbHBlclNlcnZpY2UiLCJyZXR1cm5Ub0Rhc2hib2FyZCIsInVzZXJuYW1lIiwibG9naW5DdHJsIiwibG9naW4iLCJzdG9wTG9hZGVyIiwiaGlkZVNlcnZlckVycm9yIiwicGFyYW1zIiwiJHN0YXRlUGFyYW1zIiwibG9nb3V0IiwibWVudUN0cmwiLCJzYXZlZFN0YXRlIiwiZ3JhcGhEZXN0cm95IiwibG9hZCIsImdyYXBoTG9hZCIsImRpcmVjdGl2ZSIsInJlc3RyaWN0Iiwic2NvcGUiLCJiYW5kd2lkdGhQb2xpY3kiLCJtb2RlIiwiYmFuZHdpZHRoIiwiYmFuZHdpZHRoQXJyYXkiLCJiYW5kd2lkdGhOdW1iZXIiLCJOdW1iZXIiLCJiYW5kd2lkdGhVbml0IiwiY3JlYXRlTmV0d29ya1BvbGljeSIsIiRjdXJyZW50IiwibmV0d29ya1BvbGljaWVzVGFic0N0cmwiLCJfTm9kZVNlbGVjdGlvblBvbGljeSQiLCJzcGxpdE5vZGVzIiwic3VwZXJTdGF0ZSIsInNwbGl0TXVsdGlwbGVOb2RlcyIsInNwbGl0Tm9kZSIsInByZXZlbnREZWZhdWx0Iiwiam9pbk5vZGUiLCJncmFwaE5vZGVzIiwibmV3X25vZGVzIiwieExvYyIsInlMb2MiLCJuZXdfbm9kZV9vYmpzIiwibmV3X25vZGUiLCJyZXMiLCJfX3NwbGl0Tm9kZSIsInNwbGl0Tm9kZUV2ZW50IiwicmVzTm9kZXMiLCJzcGxpdE11bHRpcGxlTm9kZXNFdmVudCIsInRvX2JlX2RlbGV0ZWQiLCJuZXdfbm9kZV9pZCIsIm5vZGVfdG9fZGVsZXRlIiwiX19qb2luTm9kZSIsImpvaW5Ob2RlRXZlbnQiLCJqb2luTXVsdGlwbGVOb2Rlc0V2ZW50IiwiTmV0d29ya3NNb2RlbCIsInJldHVyblRvTmV0d29ya3MiLCJjYW5jZWxDcmVhdGluZyIsImNyZWF0ZU5ldHdvcmsiLCJuZXR3b3JrQ3JlYXRlQ3RybCIsImZvcm0iLCIkdmFsaWQiLCJzdGFydExvYWRlciIsIm5ld05ldHdvcmsiLCJ0ZW5hbnROYW1lIiwibmV0d29ya05hbWUiLCJ0aGVuIiwicmVzdWx0Iiwic2hvd1NlcnZlckVycm9yIiwicmVzZXRGb3JtIiwiZW5jYXAiLCJzdWJuZXQiLCJnYXRld2F5IiwiY2lkclBhdHRlcm4iLCJfU3BsaXRKb2luTm9kZVBvbGljeSQiLCJzYXZlZFN0YXRlcyIsImV2ZW50SGlzdG9yeSIsImZvY3VzR3JvdXBzIiwiZm9jaSIsInpvb21zIiwibGF5b3V0RGVmYXVsdCIsInpvb21EZWZhdWx0Iiwibm9kZUlkc1RvUmVzaG93IiwiYmFja0J1dHRvbkVsZW0iLCJ0aXRsZUVsZW0iLCJib3VuZGFyeSIsImVsZW0iLCJiYWNrQnV0dG9uIiwidW5kb0xhc3RFdmVudCIsInNhdmUiLCJjdXJyVGl0bGUiLCJzdGF0ZXMiLCJsb2FkU3RhdGUiLCJmYWRlVG8iLCJ0eXBlIiwicG9zIiwiY29uc29sZSIsImxvZyIsInVwZGF0ZUdyYXBoQ2FsbGJhY2siLCJub2Rlc1RvS2VlcCIsImdyb3VwT25lTm9kZXMiLCJwYXJzZUZsb2F0Iiwic3BsaXROb2RlRnVuYyIsImdldFJhbmRvbUludCIsImZsb29yIiwicmFuZG9tIiwiZ3JhcGhDb25zdHMiLCJzdGF0ZVBvbGljeSIsImRlZmF1bHRMYXlvdXQiLCJjYWxjTWF4Tm9kZXMiLCJhcmVhIiwiYW1vdW50IiwiY29uc3RzUG9saWN5IiwiZm9jdXNOb2RlcyIsImJvdCIsInBvcCIsInNldExheW91dCIsInN0YXRlU3VwZXIiLCJub2RlTmFtZVNldCIsIm5hbWVUb0FkZCIsIm5vZGVzVG9Qcm9jZXNzIiwicHJvY2Vzc05vZGVEYXRhIiwibm9kZVRvUmVtb3ZlIiwibGFzdCIsImZpbmREM05vZGUiLCJkYmxjbGljayIsIm5vZGVJZCIsIiRodHRwIiwiJHEiLCJnZXRCZ3AiLCJjdHJsIiwiZGVmZXJyZWQiLCJkZWZlciIsInJlc29sdmUiLCJuZWlnaGJvciIsIm5laWdoYm9ycyIsInJlamVjdCIsInByb21pc2UiLCJ1cGRhdGVCZ3AiLCJwb3N0IiwiZ2V0QmdwSW5zcGVjdCIsImdldEFjdGl2ZUxvZ3MiLCJnZXRMYXN0TG9ncyIsIiRzY29wZSIsIiRpbnRlcnZhbCIsIkxvZ1NlcnZpY2UiLCJub2RlQWN0aXZlSm9iTG9nc0N0cmwiLCJhY3RpdmVMb2dzIiwiaXNEZWZpbmVkIiwiJG9uIiwiY2FuY2VsIiwiTm9kZXNNb2RlbCIsIk5vZGVzU2VydmljZSIsInJldHVyblRvTm9kZURldGFpbHMiLCJjYW5jZWxDb21taXNzaW9uaW5nTm9kZSIsImNvbW1pc3Npb24iLCJub2RlQ29tbWlzc2lvbkN0cmwiLCJub2RlT3BzT2JqIiwiY2xlYW51cEV4dHJhVmFycyIsImNyZWF0ZUV4dHJhVmFycyIsImV4dHJhX3ZhcnMiLCJhbnNpYmxlVmFyaWFibGVzIiwiZW52VmFyaWFibGVzIiwiZ2V0U2V0dGluZ3MiLCJCZ3BTZXJ2aWNlIiwiZGVjb21taXNzaW9uIiwibm9kZURldGFpbHNDdHJsIiwic2hvd0NvbW1pc3Npb25CdXR0b24iLCJjb21taXNzaW9uQnV0dG9uRW5hYmxlZCIsInVwZ3JhZGVCdXR0b25FbmFibGVkIiwidXBncmFkZSIsInNldEJ1dHRvbkRpc3BsYXkiLCJzdGF0dXMiLCJnZXROb2RlSW5mbyIsInJlbG9hZCIsImdldE1vZGVsQnlLZXkiLCJzZXRNb2RlIiwiaXMiLCJyZXR1cm5Ub0luZm8iLCJ1cGRhdGVCZ3BJbmZvIiwiaXRlbSIsImdldEJncEluZm8iLCJpbnNwZWN0Iiwicm91dGVzIiwiT3BlciIsImZpbHRlcmVkcm91dGVzIiwibnVtYmVycGF0dGVybiIsInJldHVyblRvTm9kZXMiLCJjYW5jZWxEaXNjb3ZlcmluZ05vZGUiLCJkaXNjb3ZlciIsIm5vZGVEaXNjb3ZlckN0cmwiLCJjcmVhdGVJUEFkZHJBcnJheSIsImFkZHJzIiwibm9kZUlQQWRkciIsIm5vZGVMYXN0Sm9iTG9nc0N0cmwiLCJsYXN0TG9ncyIsIiRmaWx0ZXIiLCJnZXROb2RlcyIsIm5vZGVMaXN0Q3RybCIsIk9yZ2FuaXphdGlvbnNNb2RlbCIsInJldHVyblRvT3JnYW5pemF0aW9ucyIsImNyZWF0ZU9yZ2FuaXphdGlvbiIsIm9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwiLCJuZXdPcmdhbml6YXRpb24iLCJkZWxldGVPcmdhbml6YXRpb24iLCJvcmdhbml6YXRpb25EZXRhaWxzQ3RybCIsIm9yZ2FuaXphdGlvbiIsInVwZGF0ZUNsdXN0ZXJTZXR0aW5ncyIsImNsdXN0ZXJTZXR0aW5nQ3RybCIsInVwZGF0ZVNldHRpbmdzIiwiU2VydmljZWxic01vZGVsIiwicmV0dXJuVG9TZXJ2aWNlbGJzIiwiZ2V0TmV0d29ya3MiLCJzZXJ2aWNlbGJDcmVhdGVDdHJsIiwibmV0d29ya3MiLCJjcmVhdGVMYWJlbFNlbGVjdG9yU3RyaW5ncyIsInNlcnZpY2VsYiIsImxhYmVsU2VsZWN0b3JzIiwibGFiZWxTZWxlY3RvciIsInNlbGVjdG9yU3RyaW5nIiwiY3JlYXRlU2VydmljZWxiIiwic2VydmljZU5hbWUiLCJpcEFkZHJlc3MiLCJwb3J0cyIsInNlcnZpY2VsYkRldGFpbHNDdHJsIiwicmV0dXJuVG9TZXJ2aWNlbGJEZXRhaWxzIiwiY2FuY2VsRWRpdGluZyIsImRlbGV0ZVNlcnZpY2VsYiIsInNhdmVTZXJ2aWNlbGIiLCJleGlzdGluZ0xhYmVscyIsImNyZWF0ZUxhYmVsU2VsZWN0b3JzIiwic2VsZWN0b3JTdHIiLCJzZWxlY3RvciIsIml0ZW1zIiwiY29tcGFyZSIsInZhbDEiLCJ2YWwyIiwicmVzZXROZXdJdGVtIiwibmV3SXRlbSIsInNlcnZpY2VQb3J0IiwicHJvdmlkZXJQb3J0IiwicHJvdG9jb2wiLCJpc0VtcHR5SXRlbSIsImFkZCIsIm5ld0l0ZW1TdHIiLCJwdWxsQWxsV2l0aCIsInBhc3NlZEl0ZW0iLCJTdG9yYWdlUG9saWNpZXNNb2RlbCIsInJldHVyblRvU3RvcmFnZVBvbGljaWVzIiwiY3JlYXRlRmlsZXN5c3RlbUNtZHMiLCJzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCIsImZpbGVzeXN0ZW1jbWRzIiwibmV3U3RvcmFnZVBvbGljeSIsImZpbGVzeXN0ZW1zIiwiY3JlYXRlUG9saWN5IiwiYmFja2VuZHMiLCJjcnVkIiwibW91bnQiLCJzbmFwc2hvdCIsInVubG9ja2VkIiwiZHJpdmVyIiwicG9vbCIsImZpbGVzeXN0ZW0iLCJydW50aW1lIiwic25hcHNob3RzIiwiZnJlcXVlbmN5Iiwia2VlcCIsInJhdGUtbGltaXQiLCJ3cml0ZS1pb3BzIiwicmVhZC1pb3BzIiwid3JpdGUtYnBzIiwicmVhZC1icHMiLCJWb2x1bWVzTW9kZWwiLCJzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwiLCJyZXR1cm5Ub1BvbGljaWVzIiwicmV0dXJuVG9Qb2xpY3lEZXRhaWxzIiwiZGVsZXRlUG9saWN5IiwiZGVsZXRlVXNpbmdLZXkiLCJnZXRWb2x1bWVzIiwidm9sdW1lcyIsImluaXRpYWxpemVGaWxlc3lzdGVtQ21kc0FycmF5Iiwic2F2ZVBvbGljeSIsIlZpc3VhbGl6YXRpb25TZXJ2aWNlIiwiRGF0ZSIsInQiLCJnZXRTZWNvbmRzIiwiZWRnZURhdGFJbnRlcnZhbCIsImdldEVkZ2VEYXRhIiwidG9TdHJpbmciLCJyZXN1bHRzIiwic2VyaWVzIiwidmFsdWVzIiwiZWRnZURhdGEiLCJlZGdlRGF0YVRpbWUiLCJnZXRPbGRFZGdlRGF0YSIsIm9sZEVkZ2VEYXRhIiwiJHdpbmRvdyIsInZpc3VhbGl6YXRpb25FZGdlRDMiLCJub3ciLCJncm91cHMiLCJncm91cCIsInBhdGgiLCJsaW5lIiwibGltaXQiLCJheGlzIiwiZWFzZSIsInlBeGlzIiwic2hpZnQiLCJjbGllbnRXaWR0aCIsImN1cnJlbnQiLCJjb2xvciIsInRpbWUiLCJpbnRlcnBvbGF0ZSIsInhTdmciLCJvcmllbnQiLCJyZXBsYWNlIiwiJHdhdGNoR3JvdXAiLCJzZXJ2aWNlIiwiU3RhdGVTYXZlIiwidmlzdWFsaXphdGlvbmxpc3RkMyIsInNlcnZpY2VTZWxlY3RvcnMiLCJzZXRBbmNlc3RvcnMiLCJ0b3BEYXRhIiwiZ2V0VG9wTGV2ZWxGbG93IiwicmF3U3ZnIiwiZmluZCIsInZpc3VhbGl6YXRpb25HcmFwaCIsImluc3RhbGxEZWZhdWx0UGF0aFBvbGljeSIsInFUaXBQb2xpY3kiLCJpbnN0YWxsRGVmYXVsdE5vZGVQb2xpY3kiLCJzcGxpdEpvaW5WaWV3UG9saWN5IiwiaW5zdGFsbEJhY2tCdXR0b24iLCJpbnN0YWxsVGl0bGUiLCJ1bmJpbmQiLCJ1cGRhdGVMaW5rRGF0YSIsInN1Y2Nlc3NHcmFwaERhdGFDYWxsYmFjayIsImVuZHBvaW50IiwidGFncyIsIkVuZHBvaW50SVAiLCJwcm92aWRlciIsIlByb3ZpZGVySVAiLCJsaW5rT3V0IiwibGlua0luIiwiZ2V0R3JhcGhEYXRhIiwiZ3JhcGhEYXRhSW50ZXJ2YWwiLCJnZXRTdHJ1Y3R1cmVEYXRhIiwibWFrZUdldCIsIm1ha2VQb3N0IiwicGFyYW0iLCJvYmoiLCJmdWxsU3ViTmFtZSIsInN1Yk5hbWUiLCJzdWJWYWx1ZSIsImlubmVyT2JqIiwicXVlcnkiLCJBcnJheSIsImVuY29kZVVSSUNvbXBvbmVudCIsInN1YnN0ciIsIm1ldGhvZCIsImhlYWRlcnMiLCJDb250ZW50LVR5cGUiLCJ0cmFuc2Zvcm1SZXF1ZXN0IiwiaXNPYmplY3QiLCJkYiIsImJ1aWxkV2hlcmVRdWVyeSIsInBvaW50cyIsInJldHVyblRvVm9sdW1lc01vZGVsIiwiZ2V0U3RvcmFnZVBvbGljaWVzIiwidm9sdW1lQ3JlYXRlQ3RybCIsInBvbGljaWVzIiwiYXBwbHlQb2xpY3lTZXR0aW5ncyIsIm5ld1ZvbHVtZSIsInNlbGVjdGVkUG9saWN5IiwiY3JlYXRlVm9sdW1lIiwidm9sdW1lIiwiY2FuY2VsQ29weSIsImdvVG9OZXdWb2x1bWUiLCJ2b2x1bWVTbmFwc2hvdENvcHlDdHJsIiwibmV3dm9sdW1lIiwiY29weVNuYXBzaG90IiwibW9kZWwiLCJjb3B5IiwiZXh0cmF2YXJzIl0sIm1hcHBpbmdzIjoiQUFBQSxZQThEQSxTQUFTQSxpQkFBZ0JDLEVBQVVDLEdBQWUsS0FBTUQsWUFBb0JDLElBQWdCLEtBQU0sSUFBSUMsV0FBVSxxQ0E2SmhILFFBQVNILGlCQUFnQkMsRUFBVUMsR0FBZSxLQUFNRCxZQUFvQkMsSUFBZ0IsS0FBTSxJQUFJQyxXQUFVLHFDQUVoSCxRQUFTQyw0QkFBMkJDLEVBQU1DLEdBQVEsSUFBS0QsRUFBUSxLQUFNLElBQUlFLGdCQUFlLDREQUFnRSxRQUFPRCxHQUF5QixnQkFBVEEsSUFBcUMsa0JBQVRBLEdBQThCRCxFQUFQQyxFQUVsTyxRQUFTRSxXQUFVQyxFQUFVQyxHQUFjLEdBQTBCLGtCQUFmQSxJQUE0QyxPQUFmQSxFQUF1QixLQUFNLElBQUlQLFdBQVUsaUVBQW9FTyxHQUFlRCxHQUFTRSxVQUFZQyxPQUFPQyxPQUFPSCxHQUFjQSxFQUFXQyxXQUFhRyxhQUFlQyxNQUFPTixFQUFVTyxZQUFZLEVBQU9DLFVBQVUsRUFBTUMsY0FBYyxLQUFlUixJQUFZRSxPQUFPTyxlQUFpQlAsT0FBT08sZUFBZVYsRUFBVUMsR0FBY0QsRUFBU1csVUFBWVYsR0F3UmplLFFBQVNWLGlCQUFnQkMsRUFBVUMsR0FBZSxLQUFNRCxZQUFvQkMsSUFBZ0IsS0FBTSxJQUFJQyxXQUFVLHFDQTI1QmhILFFBQVNILGlCQUFnQkMsRUFBVUMsR0FBZSxLQUFNRCxZQUFvQkMsSUFBZ0IsS0FBTSxJQUFJQyxXQUFVLHFDQUVoSCxRQUFTQyw0QkFBMkJDLEVBQU1DLEdBQVEsSUFBS0QsRUFBUSxLQUFNLElBQUlFLGdCQUFlLDREQUFnRSxRQUFPRCxHQUF5QixnQkFBVEEsSUFBcUMsa0JBQVRBLEdBQThCRCxFQUFQQyxFQUVsTyxRQUFTRSxXQUFVQyxFQUFVQyxHQUFjLEdBQTBCLGtCQUFmQSxJQUE0QyxPQUFmQSxFQUF1QixLQUFNLElBQUlQLFdBQVUsaUVBQW9FTyxHQUFlRCxHQUFTRSxVQUFZQyxPQUFPQyxPQUFPSCxHQUFjQSxFQUFXQyxXQUFhRyxhQUFlQyxNQUFPTixFQUFVTyxZQUFZLEVBQU9DLFVBQVUsRUFBTUMsY0FBYyxLQUFlUixJQUFZRSxPQUFPTyxlQUFpQlAsT0FBT08sZUFBZVYsRUFBVUMsR0FBY0QsRUFBU1csVUFBWVYsR0EySmplLFFBQVNWLGlCQUFnQkMsRUFBVUMsR0FBZSxLQUFNRCxZQUFvQkMsSUFBZ0IsS0FBTSxJQUFJQyxXQUFVLHFDQWlPaEgsUUFBU0gsaUJBQWdCQyxFQUFVQyxHQUFlLEtBQU1ELFlBQW9CQyxJQUFnQixLQUFNLElBQUlDLFdBQVUscUNBRWhILFFBQVNDLDRCQUEyQkMsRUFBTUMsR0FBUSxJQUFLRCxFQUFRLEtBQU0sSUFBSUUsZ0JBQWUsNERBQWdFLFFBQU9ELEdBQXlCLGdCQUFUQSxJQUFxQyxrQkFBVEEsR0FBOEJELEVBQVBDLEVBRWxPLFFBQVNFLFdBQVVDLEVBQVVDLEdBQWMsR0FBMEIsa0JBQWZBLElBQTRDLE9BQWZBLEVBQXVCLEtBQU0sSUFBSVAsV0FBVSxpRUFBb0VPLEdBQWVELEdBQVNFLFVBQVlDLE9BQU9DLE9BQU9ILEdBQWNBLEVBQVdDLFdBQWFHLGFBQWVDLE1BQU9OLEVBQVVPLFlBQVksRUFBT0MsVUFBVSxFQUFNQyxjQUFjLEtBQWVSLElBQVlFLE9BQU9PLGVBQWlCUCxPQUFPTyxlQUFlVixFQUFVQyxHQUFjRCxFQUFTVyxVQUFZVixHQTJQamUsUUFBU1YsaUJBQWdCQyxFQUFVQyxHQUFlLEtBQU1ELFlBQW9CQyxJQUFnQixLQUFNLElBQUlDLFdBQVUscUNBK0toSCxRQUFTSCxpQkFBZ0JDLEVBQVVDLEdBQWUsS0FBTUQsWUFBb0JDLElBQWdCLEtBQU0sSUFBSUMsV0FBVSxxQ0FFaEgsUUFBU0MsNEJBQTJCQyxFQUFNQyxHQUFRLElBQUtELEVBQVEsS0FBTSxJQUFJRSxnQkFBZSw0REFBZ0UsUUFBT0QsR0FBeUIsZ0JBQVRBLElBQXFDLGtCQUFUQSxHQUE4QkQsRUFBUEMsRUFFbE8sUUFBU0UsV0FBVUMsRUFBVUMsR0FBYyxHQUEwQixrQkFBZkEsSUFBNEMsT0FBZkEsRUFBdUIsS0FBTSxJQUFJUCxXQUFVLGlFQUFvRU8sR0FBZUQsR0FBU0UsVUFBWUMsT0FBT0MsT0FBT0gsR0FBY0EsRUFBV0MsV0FBYUcsYUFBZUMsTUFBT04sRUFBVU8sWUFBWSxFQUFPQyxVQUFVLEVBQU1DLGNBQWMsS0FBZVIsSUFBWUUsT0FBT08sZUFBaUJQLE9BQU9PLGVBQWVWLEVBQVVDLEdBQWNELEVBQVNXLFVBQVlWLEdBZ0dqZSxRQUFTVixpQkFBZ0JDLEVBQVVDLEdBQWUsS0FBTUQsWUFBb0JDLElBQWdCLEtBQU0sSUFBSUMsV0FBVSxxQ0FFaEgsUUFBU0MsNEJBQTJCQyxFQUFNQyxHQUFRLElBQUtELEVBQVEsS0FBTSxJQUFJRSxnQkFBZSw0REFBZ0UsUUFBT0QsR0FBeUIsZ0JBQVRBLElBQXFDLGtCQUFUQSxHQUE4QkQsRUFBUEMsRUFFbE8sUUFBU0UsV0FBVUMsRUFBVUMsR0FBYyxHQUEwQixrQkFBZkEsSUFBNEMsT0FBZkEsRUFBdUIsS0FBTSxJQUFJUCxXQUFVLGlFQUFvRU8sR0FBZUQsR0FBU0UsVUFBWUMsT0FBT0MsT0FBT0gsR0FBY0EsRUFBV0MsV0FBYUcsYUFBZUMsTUFBT04sRUFBVU8sWUFBWSxFQUFPQyxVQUFVLEVBQU1DLGNBQWMsS0FBZVIsSUFBWUUsT0FBT08sZUFBaUJQLE9BQU9PLGVBQWVWLEVBQVVDLEdBQWNELEVBQVNXLFVBQVlWLEdBbVBqZSxRQUFTVixpQkFBZ0JDLEVBQVVDLEdBQWUsS0FBTUQsWUFBb0JDLElBQWdCLEtBQU0sSUFBSUMsV0FBVSxxQ0FFaEgsUUFBU0MsNEJBQTJCQyxFQUFNQyxHQUFRLElBQUtELEVBQVEsS0FBTSxJQUFJRSxnQkFBZSw0REFBZ0UsUUFBT0QsR0FBeUIsZ0JBQVRBLElBQXFDLGtCQUFUQSxHQUE4QkQsRUFBUEMsRUFFbE8sUUFBU0UsV0FBVUMsRUFBVUMsR0FBYyxHQUEwQixrQkFBZkEsSUFBNEMsT0FBZkEsRUFBdUIsS0FBTSxJQUFJUCxXQUFVLGlFQUFvRU8sR0FBZUQsR0FBU0UsVUFBWUMsT0FBT0MsT0FBT0gsR0FBY0EsRUFBV0MsV0FBYUcsYUFBZUMsTUFBT04sRUFBVU8sWUFBWSxFQUFPQyxVQUFVLEVBQU1DLGNBQWMsS0FBZVIsSUFBWUUsT0FBT08sZUFBaUJQLE9BQU9PLGVBQWVWLEVBQVVDLEdBQWNELEVBQVNXLFVBQVlWLEdBcUhqZSxRQUFTVixpQkFBZ0JDLEVBQVVDLEdBQWUsS0FBTUQsWUFBb0JDLElBQWdCLEtBQU0sSUFBSUMsV0FBVSxxQ0E4SmhILFFBQVNILGlCQUFnQkMsRUFBVUMsR0FBZSxLQUFNRCxZQUFvQkMsSUFBZ0IsS0FBTSxJQUFJQyxXQUFVLHFDQUVoSCxRQUFTQyw0QkFBMkJDLEVBQU1DLEdBQVEsSUFBS0QsRUFBUSxLQUFNLElBQUlFLGdCQUFlLDREQUFnRSxRQUFPRCxHQUF5QixnQkFBVEEsSUFBcUMsa0JBQVRBLEdBQThCRCxFQUFQQyxFQUVsTyxRQUFTRSxXQUFVQyxFQUFVQyxHQUFjLEdBQTBCLGtCQUFmQSxJQUE0QyxPQUFmQSxFQUF1QixLQUFNLElBQUlQLFdBQVUsaUVBQW9FTyxHQUFlRCxHQUFTRSxVQUFZQyxPQUFPQyxPQUFPSCxHQUFjQSxFQUFXQyxXQUFhRyxhQUFlQyxNQUFPTixFQUFVTyxZQUFZLEVBQU9DLFVBQVUsRUFBTUMsY0FBYyxLQUFlUixJQUFZRSxPQUFPTyxlQUFpQlAsT0FBT08sZUFBZVYsRUFBVUMsR0FBY0QsRUFBU1csVUFBWVYsR0FzV2plLFFBQVNWLGlCQUFnQkMsRUFBVUMsR0FBZSxLQUFNRCxZQUFvQkMsSUFBZ0IsS0FBTSxJQUFJQyxXQUFVLHFDQUVoSCxRQUFTQyw0QkFBMkJDLEVBQU1DLEdBQVEsSUFBS0QsRUFBUSxLQUFNLElBQUlFLGdCQUFlLDREQUFnRSxRQUFPRCxHQUF5QixnQkFBVEEsSUFBcUMsa0JBQVRBLEdBQThCRCxFQUFQQyxFQUVsTyxRQUFTRSxXQUFVQyxFQUFVQyxHQUFjLEdBQTBCLGtCQUFmQSxJQUE0QyxPQUFmQSxFQUF1QixLQUFNLElBQUlQLFdBQVUsaUVBQW9FTyxHQUFlRCxHQUFTRSxVQUFZQyxPQUFPQyxPQUFPSCxHQUFjQSxFQUFXQyxXQUFhRyxhQUFlQyxNQUFPTixFQUFVTyxZQUFZLEVBQU9DLFVBQVUsRUFBTUMsY0FBYyxLQUFlUixJQUFZRSxPQUFPTyxlQUFpQlAsT0FBT08sZUFBZVYsRUFBVUMsR0FBY0QsRUFBU1csVUFBWVYsR0EwS2plLFFBQVNWLGlCQUFnQkMsRUFBVUMsR0FBZSxLQUFNRCxZQUFvQkMsSUFBZ0IsS0FBTSxJQUFJQyxXQUFVLHFDQUVoSCxRQUFTQyw0QkFBMkJDLEVBQU1DLEdBQVEsSUFBS0QsRUFBUSxLQUFNLElBQUlFLGdCQUFlLDREQUFnRSxRQUFPRCxHQUF5QixnQkFBVEEsSUFBcUMsa0JBQVRBLEdBQThCRCxFQUFQQyxFQUVsTyxRQUFTRSxXQUFVQyxFQUFVQyxHQUFjLEdBQTBCLGtCQUFmQSxJQUE0QyxPQUFmQSxFQUF1QixLQUFNLElBQUlQLFdBQVUsaUVBQW9FTyxHQUFlRCxHQUFTRSxVQUFZQyxPQUFPQyxPQUFPSCxHQUFjQSxFQUFXQyxXQUFhRyxhQUFlQyxNQUFPTixFQUFVTyxZQUFZLEVBQU9DLFVBQVUsRUFBTUMsY0FBYyxLQUFlUixJQUFZRSxPQUFPTyxlQUFpQlAsT0FBT08sZUFBZVYsRUFBVUMsR0FBY0QsRUFBU1csVUFBWVYsR0FxYWplLFFBQVNWLGlCQUFnQkMsRUFBVUMsR0FBZSxLQUFNRCxZQUFvQkMsSUFBZ0IsS0FBTSxJQUFJQyxXQUFVLHFDQUVoSCxRQUFTQyw0QkFBMkJDLEVBQU1DLEdBQVEsSUFBS0QsRUFBUSxLQUFNLElBQUlFLGdCQUFlLDREQUFnRSxRQUFPRCxHQUF5QixnQkFBVEEsSUFBcUMsa0JBQVRBLEdBQThCRCxFQUFQQyxFQUVsTyxRQUFTRSxXQUFVQyxFQUFVQyxHQUFjLEdBQTBCLGtCQUFmQSxJQUE0QyxPQUFmQSxFQUF1QixLQUFNLElBQUlQLFdBQVUsaUVBQW9FTyxHQUFlRCxHQUFTRSxVQUFZQyxPQUFPQyxPQUFPSCxHQUFjQSxFQUFXQyxXQUFhRyxhQUFlQyxNQUFPTixFQUFVTyxZQUFZLEVBQU9DLFVBQVUsRUFBTUMsY0FBYyxLQUFlUixJQUFZRSxPQUFPTyxlQUFpQlAsT0FBT08sZUFBZVYsRUFBVUMsR0FBY0QsRUFBU1csVUFBWVYsR0NudkhqZVcsUUFBUUMsT0FBTyxtQkNKZkQsUUFBQUMsT0FBQSx3QkNHQUQsUUFBQUMsT0FBQSxtQkFDQSxJQUFBQyxlQUFBLFdBQ0EsT0FFQUMsa0JBQUEsOEJBQ0FDLDBCQUFBLHNDQUNBQyw0QkFBQSx3Q0FDQUMsa0JBQUEsNkJBQ0FDLGVBQUEsMkJBQ0FDLDJCQUFBLG9DQUNBQyxvQkFBQSxnQ0FDQUMsdUJBQUEsNkJBQ0FDLDBCQUFBLDZCQUNBQyxxQkFBQSxpQ0FDQUMsY0FBQSwwQkFDQUMsc0JBQUEsa0NBQ0FDLHVCQUFBLGtCQUVBQyxpQkFBQSxzQkFDQUMsd0JBQUEsNkJBQ0FDLHdCQUFBLDZCQUNBQywrQkFBQSwwQkFDQUMsc0JBQUEsMEJBQ0FDLDJCQUFBLHdCQUNBQyx5QkFBQSx1QkFDQUMsd0JBQUEscUJBRUFDLG9CQUFBLGNBQ0FDLHdCQUFBLGtCQUNBQywwQkFBQSxvQkFDQUMsNEJBQUEsc0JBQ0FDLDJCQUFBLHFCQUNBQyx3QkFBQSxpQkFDQUMsMEJBQUEsbUJBQ0FDLDRCQUFBLFdBQ0FDLDRCQUFBLGdCQUVBQyxpQkFBQSxJQUVBQyxXQUFBLHVJQUNBQyxXQUFBLDhCQUNBQyxZQUFBLDhCQUNBQyxhQUFBLGVIZUlDLGFBQWUsV0FBYyxRQUFTQyxHQUFpQkMsRUFBUUMsR0FBUyxJQUFLLEdBQUlDLEdBQUksRUFBR0EsRUFBSUQsRUFBTUUsT0FBUUQsSUFBSyxDQUFFLEdBQUlFLEdBQWFILEVBQU1DLEVBQUlFLEdBQVdqRCxXQUFhaUQsRUFBV2pELGFBQWMsRUFBT2lELEVBQVcvQyxjQUFlLEVBQVUsU0FBVytDLEtBQVlBLEVBQVdoRCxVQUFXLEdBQU1MLE9BQU9zRCxlQUFlTCxFQUFRSSxFQUFXRSxJQUFLRixJQUFpQixNQUFPLFVBQVUvRCxFQUFha0UsRUFBWUMsR0FBaUosTUFBOUhELElBQVlSLEVBQWlCMUQsRUFBWVMsVUFBV3lELEdBQWlCQyxHQUFhVCxFQUFpQjFELEVBQWFtRSxHQUFxQm5FLEtJekNoaUJtQixTQUFRQyxPQUFPLGdCQUNWZ0QsUUFBUSxjQUFlLE9BQVEsT0FDL0IsU0FBVUMsRUFBTUMsR0FBTSxHQUVoQkMsR0FGZ0IsV0FTeEIsUUFBQUEsR0FBWUMsRUFBT0MsR0FBTzNFLGdCQUFBNEUsS0FBQUgsR0FDekJHLEtBQUtGLE1BQVFBLEVBQ2JFLEtBQUtELE1BQVFBLEVBWFUsTUFBQWhCLGNBQUFjLElBQUFOLElBQUEsY0FBQXBELE1BQUEsU0FtQloyRCxHQUNYRSxLQUFLRixNQUFRQSxLQXBCVVAsSUFBQSxjQUFBcEQsTUFBQSxTQTRCWjRELEdBQ1hDLEtBQUtELE1BQVFBLEtBN0JVUixJQUFBLGVBQUFwRCxNQUFBLFNBdUNYOEQsR0FFTixJQUFLLEdBRERILEdBQVFFLEtBQUtGLE1BQ1JYLEVBQUksRUFBR0EsRUFBSVcsRUFBTVYsT0FBUUQsSUFDOUIsR0FBSVcsRUFBTVgsR0FBR2MsSUFBTUEsRUFDZixNQUFPSCxHQUFNWCxHQUFHZSxRQTNDUFgsSUFBQSxrQkFBQXBELE1BQUEsU0F1RExnRSxHQUNaLEdBQUlMLEtBS0osT0FKQU0sR0FBRUMsUUFBUUYsRUFBVSxTQUFTRyxHQUN6QixHQUFJQyxHQUFVLEdBQUlaLEdBQUtBLEtBQUssS0FBTSxLQUFNVyxFQUFLTCxHQUFJSyxFQUFLRSxLQUFNLEtBQzVEVixHQUFNVyxLQUFLRixLQUVSVCxLQTdEVVAsSUFBQSxrQkFBQXBELE1BQUEsU0F1RUx1RSxFQUFVWixHQU96QixRQUFTYSxHQUFhVixFQUFJSCxHQUN0QixJQUFLLEdBQUlYLEdBQUksRUFBR0EsRUFBSVcsRUFBTVYsT0FBUUQsSUFDOUIsR0FBSWMsR0FBTUgsRUFBTVgsR0FBR2MsR0FDZixNQUFPSCxHQUFNWCxHQU90QixJQUFLLEdBRkRZLE1BRUtaLEVBQUksRUFBR0EsRUFBSXVCLEVBQVN0QixPQUFRRCxJQUNqQyxHQUFJdUIsRUFBU3ZCLEdBQUd5QixRQUFVRixFQUFTdkIsR0FBR0YsT0FBUSxDQUMxQyxHQUFJMkIsR0FBU0QsRUFBYUQsRUFBU3ZCLEdBQUd5QixPQUFRZCxHQUMxQ2IsRUFBUzBCLEVBQWFELEVBQVN2QixHQUFHRixPQUFRYSxFQUM5QyxJQUFjLE1BQVZjLEdBQTRCLE1BQVYzQixFQUNyQixRQUVFLElBQUk0QixHQUFPLEdBQUlqQixHQUFLQSxLQUFLZ0IsRUFBUTNCLEVBQ2pDYyxHQUFNVSxLQUFLSSxHQUd0QixNQUFPZCxPQW5HVUYsSUFzR3pCLFFBQ0NBLFdBQVdBLE1DekhkcEQsUUFBQUMsT0FBQSxrQkxzTkEsSUFBSXFDLGNBQWUsV0FBYyxRQUFTQyxHQUFpQkMsRUFBUUMsR0FBUyxJQUFLLEdBQUlDLEdBQUksRUFBR0EsRUFBSUQsRUFBTUUsT0FBUUQsSUFBSyxDQUFFLEdBQUlFLEdBQWFILEVBQU1DLEVBQUlFLEdBQVdqRCxXQUFhaUQsRUFBV2pELGFBQWMsRUFBT2lELEVBQVcvQyxjQUFlLEVBQVUsU0FBVytDLEtBQVlBLEVBQVdoRCxVQUFXLEdBQU1MLE9BQU9zRCxlQUFlTCxFQUFRSSxFQUFXRSxJQUFLRixJQUFpQixNQUFPLFVBQVUvRCxFQUFha0UsRUFBWUMsR0FBaUosTUFBOUhELElBQVlSLEVBQWlCMUQsRUFBWVMsVUFBV3lELEdBQWlCQyxHQUFhVCxFQUFpQjFELEVBQWFtRSxHQUFxQm5FLEtNOU1oaUJtQixTQUFRQyxPQUFPLGdCQUNWZ0QsUUFBUSx3QkFBeUIsYUFBYyxpQkFBa0IsaUJBQ2pFLFNBQVVHLEVBQVlpQixFQUFnQkMsR0FBZ0IsR0FFaERDLEdBRmdELFNBQUFDLEdBbUJ4RCxRQUFBRCxHQUFZbEIsRUFBT0MsRUFBT21CLEVBQWlCQyxFQUN6Q0MsRUFBUUMsR0FBV2pHLGdCQUFBNEUsS0FBQWdCLEVBQUEsSUFBQU0sR0FBQTlGLDJCQUFBd0UsTUFBQWdCLEVBQUF4RSxXQUFBUixPQUFBdUYsZUFBQVAsSUFBQXRGLEtBQUFzRSxLQUNkRixFQUFNQyxHQURRLE9BRXBCdUIsR0FBS0osZ0JBQWtCQSxFQUN2QkksRUFBS0gsaUJBQW1CQSxFQUN4QkcsRUFBS0YsT0FBU0EsRUFDZEUsRUFBS0QsVUFBWUEsRUFMR0MsRUFwQm1DLE1BQUExRixXQUFBb0YsRUFBQUMsR0FBQWxDLGFBQUFpQyxJQUFBekIsSUFBQSxXQUFBcEQsTUFBQSxTQWtDNUM4RCxHQUNSLE1BQWdDLE9BQTVCRCxLQUFLa0IsZ0JBQWdCakIsTUFuQzJCVixJQUFBLGVBQUFwRCxNQUFBLFdBZ0RwRCxHQUFJcUYsR0FBaUJ4QixLQUNqQnlCLEdBQWMsQ0FDbEJyQixHQUFFQyxRQUFRbUIsRUFBZTFCLE1BQU8sU0FBUzRCLEdBQ3hDQSxFQUFLQyxVQUFZSCxFQUFlTCxpQkFBaUJPLEVBQUt6QixRQUNsREcsRUFBRXdCLFFBQVFGLEVBQUtDLGNBQWUsRUFDakNELEVBQUtHLE9BQVNILEVBQUtDLFVBQVUsR0FFdUMsR0FBaEV2QixFQUFFMEIsU0FBU04sRUFBZU4sZ0JBQWdCYSxTQUFVTCxFQUFLekIsTUFHNUR5QixFQUFLQyxVQUFVbEIsS0FBSyxVQUNwQmUsRUFBZUwsaUJBQWlCTyxFQUFLekIsS0FBTyxVQUN4Q3dCLEtBQWdCLElBQ25CQSxHQUFjLEVBQ2RELEVBQWVOLGdCQUFnQmEsU0FBU3RCLEtBQUssVUFDN0NlLEVBQWVOLGdCQUFmLFdBRURNLEVBQWVOLGdCQUFmLE9BQXlDVCxLQUFLaUIsRUFBS3pCLFVBakVGVixJQUFBLGtCQUFBcEQsTUFBQSxXQTZFakQsTUFBTzZELE1BQUtnQyxrQkFBa0JoQyxLQUFLa0IsZ0JBQWdCYSxhQTdFRnhDLElBQUEsb0JBQUFwRCxNQUFBLFNBc0ZuQzhGLEdBR2QsSUFBSyxHQUZEQyxHQUFjbEMsS0FBS0YsTUFDbkJxQyxLQUNLaEQsRUFBSSxFQUFHQSxFQUFJK0MsRUFBWTlDLE9BQVFELElBQUssQ0FDekMsR0FBSXVDLEdBQU9RLEVBQVkvQyxFQUd2QixJQUF1QixPQUFuQnVDLEVBQUtDLFVBQ0xRLEVBQVVULEVBQUt6QixJQUFNeUIsRUFBS3hCLFNBRzFCLEtBQUssR0FBSWtDLEdBQUksRUFBR0EsRUFBSUgsRUFBVzdDLE9BQVFnRCxJQUNuQyxHQUFJVixFQUFLQyxVQUFVVSxRQUFRSixFQUFXRyxJQUFNLEdBQUksQ0FDNUNELEVBQVVULEVBQUt6QixJQUFNZ0MsRUFBV0csRUFDaEMsUUFTaEIsSUFBSyxHQUhEckMsR0FBUUMsS0FBS0QsTUFDYlcsS0FFS3ZCLEVBQUksRUFBR0EsRUFBSVksRUFBTVgsT0FBUUQsSUFBSyxDQUNuQyxHQUFJMEIsS0FDSkEsR0FBS0QsT0FBU3VCLEVBQVVwQyxFQUFNWixHQUFHeUIsU0FBV2IsRUFBTVosR0FBR3lCLE9BQ3JEQyxFQUFLNUIsT0FBU2tELEVBQVVwQyxFQUFNWixHQUFHRixTQUFXYyxFQUFNWixHQUFHRixPQUNyRDRCLEVBQUt5QixPQUFTdkMsRUFBTVosR0FBR21ELE9BQ3ZCNUIsRUFBU0QsS0FBS0ksR0FLbEIsSUFBSyxHQUREVixNQUNLaEIsRUFBSSxFQUFHQSxFQUFJOEMsRUFBVzdDLE9BQVFELElBQUssQ0FDeEMsR0FBSW9ELEtBQ0pBLEdBQVl0QyxHQUFLZ0MsRUFBVzlDLEdBQzVCb0QsRUFBWS9CLEtBQU9SLEtBQUt3QyxhQUFhUCxFQUFXOUMsS0FBTzhDLEVBQVc5QyxHQUdsRW9ELEVBQVlaLFVBQVkzQixLQUFLbUIsaUJBQWlCYyxFQUFXOUMsS0FBT2EsS0FBS21CLGlCQUFpQm9CLEVBQVkvQixVQUM5RkosRUFBRXdCLFFBQVFXLEVBQVlaLGNBQWUsRUFDckNZLEVBQVlWLE9BQVNVLEVBQVlaLFVBQVUsR0FFM0NZLEVBQVlWLE9BQVMsS0FFekIxQixFQUFTTSxLQUFLOEIsR0FHbEIsT0FBUXBDLFNBQVNBLEVBQVVPLFNBQVNBLE1BdElhbkIsSUFBQSxrQkFBQXBELE1BQUEsU0FnSnJDZ0UsR0FDWixHQUFJTCxLQU1KLE9BTEFNLEdBQUVDLFFBQVFGLEVBQVUsU0FBU0csR0FDekIsR0FBSUMsR0FBVSxHQUFJTyxHQUFlbkIsS0FBSyxLQUFNLEtBQU1XLEVBQUtMLEdBQUlLLEVBQUtFLEtBQzVELEtBQU1GLEVBQUt1QixPQUFRdkIsRUFBS3FCLFVBQVcsS0FBTSxLQUM3QzdCLEdBQU1XLEtBQUtGLEtBRVJULEtBdkowQ1AsSUFBQSxrQkFBQXBELE1BQUEsU0FpS3JDdUUsRUFBVVosR0FPekIsUUFBU2EsR0FBYVYsRUFBSUgsR0FDdEIsSUFBSyxHQUFJWCxHQUFJLEVBQUdBLEVBQUlXLEVBQU1WLE9BQVFELElBQzlCLEdBQUljLEdBQU1ILEVBQU1YLEdBQUdjLEdBQ2YsTUFBT0gsR0FBTVgsR0FTdEIsSUFBSyxHQUpEWSxNQUVBMEMsS0FFS3RELEVBQUksRUFBR0EsRUFBSXVCLEVBQVN0QixPQUFRRCxJQUNqQyxHQUFJdUIsRUFBU3ZCLEdBQUd5QixRQUFVRixFQUFTdkIsR0FBR0YsT0FBUSxDQUMxQyxHQUFJMkIsR0FBU0QsRUFBYUQsRUFBU3ZCLEdBQUd5QixPQUFRZCxHQUMxQ2IsRUFBUzBCLEVBQWFELEVBQVN2QixHQUFHRixPQUFRYSxHQUMxQ3dDLEVBQVM1QixFQUFTdkIsR0FBR21ELE1BSXpCLElBQWMsTUFBVjFCLEdBQTRCLE1BQVYzQixFQUNyQixRQUVELElBQWlEeUQsU0FBN0NELEVBQVk3QixFQUFPWCxHQUFLLElBQU1oQixFQUFPZ0IsSUFBbUIsQ0FDeEQsR0FBSVksR0FBTyxHQUFJRSxHQUFlbkIsS0FBS2dCLEVBQVEzQixFQUFRcUQsRUFDbkRHLEdBQVk3QixFQUFPWCxHQUFLLElBQU1oQixFQUFPZ0IsSUFBTVksRUFDM0NkLEVBQU1VLEtBQUtJLE9BQ1IsQ0FDSCxHQUFJOEIsR0FBZ0JGLEVBQVk3QixFQUFPWCxHQUFLLElBQU1oQixFQUFPZ0IsR0FDekQwQyxHQUFjQyxVQUFVRCxFQUFjRSxlQUFpQlAsR0FDdkRLLEVBQWNHLGlCQUkxQixNQUFPL0MsT0ExTTBDaUIsR0FFbkJuQixFQUFXQSxXQTJNakQsUUFDQ0EsV0FBWW1CLE1DeE5mdkUsUUFBQUMsT0FBQSw0QkFBQSxnQkFBQSxvQkFBQSxpQkFDQXFHLFFBQUEsaUJBQUEsU0FBQUMsR0FDQUEsRUFDQUMsTUFBQSxpQ0FDQUMsSUFBQSxxQkFDQUMsWUFBQSxFQUNBQyxTQUFBLHdDQUVBSCxNQUFBLHdDQUNBQyxJQUFBLFVBQ0FHLFVBQUEsMkJBRUFKLE1BQUEseUNBQ0FDLElBQUEsZ0JBQ0FHLFVBQUEsNEJBRUFKLE1BQUEsc0NBQ0FDLElBQUEsYUFDQUcsVUFBQSw0QkFFQUosTUFBQSxzQ0FDQUMsSUFBQSxRQUNBRyxVQUFBLDJCUDRkQSxJQUFJdEUsY0FBZSxXQUFjLFFBQVNDLEdBQWlCQyxFQUFRQyxHQUFTLElBQUssR0FBSUMsR0FBSSxFQUFHQSxFQUFJRCxFQUFNRSxPQUFRRCxJQUFLLENBQUUsR0FBSUUsR0FBYUgsRUFBTUMsRUFBSUUsR0FBV2pELFdBQWFpRCxFQUFXakQsYUFBYyxFQUFPaUQsRUFBVy9DLGNBQWUsRUFBVSxTQUFXK0MsS0FBWUEsRUFBV2hELFVBQVcsR0FBTUwsT0FBT3NELGVBQWVMLEVBQVFJLEVBQVdFLElBQUtGLElBQWlCLE1BQU8sVUFBVS9ELEVBQWFrRSxFQUFZQyxHQUFpSixNQUE5SEQsSUFBWVIsRUFBaUIxRCxFQUFZUyxVQUFXeUQsR0FBaUJDLEdBQWFULEVBQWlCMUQsRUFBYW1FLEdBQXFCbkUsS1EzZWhpQm1CLFNBQVFDLE9BQU8sZ0JBQ1ZnRCxRQUFRLFNBQVUsZ0JBQWlCLFNBQVU0RCxHQUFlLEdBQ25EQyxHQURtRCxXQVVyRCxRQUFBQSxHQUFZQyxFQUFLMUQsRUFBT0MsR0FBTzNFLGdCQUFBNEUsS0FBQXVELEVBQzNCLElBQUlFLEdBQVl6RCxJQUVoQnlELEdBQVUzRCxNQUFRQSxNQUNsQjJELEVBQVUxRCxNQUFRQSxNQUVsQjBELEVBQVVDLHVCQUNWRCxFQUFVRSx1QkFFVkYsRUFBVUcsVUFBWSxHQUFJTixHQUFjTyxPQUV4Q0osRUFBVVIsT0FDTmEsU0FBUyxFQUNUQyxRQUFRLEVBQ1JDLFdBQVcsRUFDWEMsZUFBZSxHQUduQlIsRUFBVVMsUUFDTkMsYUFBYyxXQUNkQyxXQUFZLFFBQ1pDLFVBQVcsT0FDWEMsVUFBVyxTQUNYQyxTQUFVLFdBQ1ZDLFlBQWEsR0FDYkMsVUFBVyxHQUNYQyxRQUFTLEVBQ1RDLGNBQWUsSUFHbkJuQixFQUFJb0IsR0FBRyxZQUFhLFNBQVNDLEdBQ3JCcEIsRUFBVUcsVUFBVixVQUFpQ2xJLEtBQUtzRSxLQUFNNkUsS0FFL0NELEdBQUcsV0FBWSxTQUFTQyxHQUNyQnBCLEVBQVVHLFVBQVYsU0FBZ0NsSSxLQUFLc0UsS0FBTTZFLEtBRTlDRCxHQUFHLGNBQWUsU0FBU0MsR0FDeEJwQixFQUFVRyxVQUFWLFlBQW1DbEksS0FBS3NFLEtBQU02RSxLQUVqREQsR0FBRyxXQUFZLFNBQVNDLEdBQ3JCcEIsRUFBVUcsVUFBVixTQUFnQ2xJLEtBQUtzRSxLQUFNNkUsS0FFOUNELEdBQUcsWUFBYSxTQUFTQyxHQUN0QnBCLEVBQVVHLFVBQVYsVUFBaUNsSSxLQUFLc0UsS0FBTTZFLEtBRS9DRCxHQUFHLFVBQVcsU0FBU0MsR0FDcEJwQixFQUFVRyxVQUFWLFFBQStCbEksS0FBS3NFLEtBQU02RSxJQUlsRCxJQUFJQyxHQUFPdEIsRUFBSXVCLE9BQU8sV0FDdEJELEdBQUtDLE9BQU8sY0FDUEMsS0FBSyxLQUFNLGFBQ1hBLEtBQUssVUFBVyxjQUNoQkEsS0FBSyxPQUFRLElBQ2JBLEtBQUssT0FBUSxJQUNiQSxLQUFLLGNBQWUsR0FDcEJBLEtBQUssZUFBZ0IsR0FDckJBLEtBQUssU0FBVSxRQUNmRCxPQUFPLFFBQ1BDLEtBQUssSUFBSyxrQkFHZkYsRUFBS0MsT0FBTyxjQUNQQyxLQUFLLEtBQU0sa0JBQ1hBLEtBQUssVUFBVyxjQUNoQkEsS0FBSyxPQUFRLEdBQ2JBLEtBQUssY0FBZSxLQUNwQkEsS0FBSyxlQUFnQixLQUNyQkEsS0FBSyxTQUFVLFFBQ2ZELE9BQU8sWUFDUEMsS0FBSyxJQUFLLGtCQUVmdkIsRUFBVUQsSUFBTUEsRUFDaEJDLEVBQVV3QixLQUFPekIsRUFBSXVCLE9BQU8sS0FDdkJHLFFBQVF6QixFQUFVUyxPQUFPRSxZQUFZLEVBQzFDLElBQUlhLEdBQU94QixFQUFVd0IsSUFHckJ4QixHQUFVMEIsTUFBUUYsRUFBS0YsT0FBTyxLQUFLSyxVQUFVLEtBQzdDM0IsRUFBVTRCLFFBQVVKLEVBQUtGLE9BQU8sS0FBS0ssVUFBVSxLQUMvQzNCLEVBQVU2QixZQUNWN0IsRUFBVThCLFlBRVY5QixFQUFVK0IsY0FDVixJQUFJQyxHQUFhLFdBQ2JoQyxFQUFVaUMsZUFBZWxDLEdBRzdCQyxHQUFVa0MsVUFDTkMsT0FBT0gsR0FFWEksRUFBRUMsUUFBUUYsT0FBT0gsR0F0R2dDLE1BQUExRyxjQUFBd0UsSUFBQWhFLElBQUEsVUFBQXBELE1BQUEsV0E2R2pELEdBQUlzSCxHQUFZekQsSUFDZkksR0FBRXFELEVBQVVDLHFCQUFxQnJELFFBQVEsU0FBUzBGLEdBQy9DQSxFQUFPQyxZQUVYNUYsRUFBRXFELEVBQVVFLHFCQUFxQnRELFFBQVEsU0FBUzBGLEdBQzlDQSxFQUFPQyxZQUVYdkMsRUFBVUcsVUFBVW9DLFNBQ3BCLEtBQUssR0FBSXpHLEtBQU9rRSxHQUFVa0MsU0FDdEJFLEVBQUVDLFFBQVFHLElBQUkxRyxFQUFLa0UsRUFBVWtDLFNBQVNwRyxPQXRIT0EsSUFBQSxZQUFBcEQsTUFBQSxXQThIakQsR0FBSXNILEdBQVl6RCxJQUNoQkksR0FBRUMsUUFBUW9ELEVBQVUzRCxNQUFPLFNBQVM0QixHQUNoQ0EsRUFBS3dFLFdBQVd6QyxRQWhJNkJsRSxJQUFBLFlBQUFwRCxNQUFBLFdBd0lqRCxHQUFJc0gsR0FBWXpELElBQ2hCSSxHQUFFQyxRQUFRb0QsRUFBVTFELE1BQU8sU0FBU2MsR0FDaENBLEVBQUtxRixXQUFXekMsUUExSTZCbEUsSUFBQSxlQUFBcEQsTUFBQSxTQXFKeEM4RCxHQUVULElBQUssR0FERHdELEdBQVl6RCxLQUNQYixFQUFJLEVBQUdBLEVBQUlzRSxFQUFVM0QsTUFBTVYsT0FBUUQsSUFDeEMsR0FBSWMsSUFBT3dELEVBQVUzRCxNQUFNWCxHQUFHYyxHQUMxQixNQUFPd0QsR0FBVTNELE1BQU1YLE1BekprQkksSUFBQSxhQUFBcEQsTUFBQSxTQXFLMUM4RCxHQUNQLEdBQ0lrRyxHQURBMUMsRUFBWXpELElBT2hCLE9BTEF5RCxHQUFVNEIsUUFBUWUsS0FBSyxTQUFTdkIsR0FDeEJBLEVBQUU1RSxLQUFPQSxJQUNUa0csRUFBU0UsR0FBR0MsT0FBT3RHLFNBR3BCbUcsS0E3SzBDNUcsSUFBQSxvQkFBQXBELE1BQUEsU0FzTG5Db0ssR0FDZHZHLEtBQUt3RyxLQUFPRCxLQXZMcUNoSCxJQUFBLG1CQUFBcEQsTUFBQSxTQWdNcEM0SixHQUNiL0YsS0FBSzRELFVBQVltQyxLQWpNZ0N4RyxJQUFBLDJCQUFBcEQsTUFBQSxTQTBNNUI0SixHQUNyQixHQUFJdEMsR0FBWXpELElBQ2hCeUQsR0FBVUMsb0JBQW9CakQsS0FBS3NGLEdBQ25DQSxFQUFPRyxXQUFXekMsTUE3TStCbEUsSUFBQSw2QkFBQXBELE1BQUEsU0FzTjFCc0ssR0FDdkIsR0FBSUMsRUFFQUEsR0FEd0IsZ0JBQWpCRCxHQUNZQSxFQUVBQSxFQUFhRSxXQUVwQ3ZHLEVBQUVxRCxVQUFVQyxxQkFBcUJyRCxRQUFRLFNBQVMwRixFQUFRYSxHQUNsRGIsRUFBT1ksYUFBZUQsSUFDdEJYLEVBQU9DLFVBQ1B2QyxVQUFVQyxvQkFBb0JtRCxPQUFPRCxFQUFPLFNBaE9IckgsSUFBQSxnQkFBQXBELE1BQUEsU0EyT3ZDd0ssR0FDYixHQUFJbEQsR0FBWXpELElBRWJJLEdBQUVxRCxFQUFVQyxxQkFBcUJyRCxRQUFRLFNBQVMwRixFQUFRYSxHQUN0RCxNQUFJYixHQUFPWSxhQUFlQSxFQUNmWixFQURYLFlBL082Q3hHLElBQUEsMkJBQUFwRCxNQUFBLFNBMlA1QjRKLEdBQ3JCLEdBQUl0QyxHQUFZekQsSUFDaEJ5RCxHQUFVRSxvQkFBb0JsRCxLQUFLc0YsR0FDbkNBLEVBQU9HLFdBQVd6QyxNQTlQK0JsRSxJQUFBLDZCQUFBcEQsTUFBQSxTQXNRMUJzSyxHQUN2QixHQUFJQyxHQUNBakQsRUFBWXpELElBRVowRyxHQUR3QixnQkFBakJELEdBQ1lBLEVBRUFBLEVBQWFFLFdBRXBDdkcsRUFBRXFELEVBQVVFLHFCQUFxQnRELFFBQVEsU0FBUzBGLEVBQVFhLEdBQ2xEYixFQUFPWSxhQUFlRCxJQUN0QlgsRUFBT0MsVUFDUHZDLEVBQVVFLG9CQUFvQmtELE9BQU9ELEVBQU8sU0FqUkhySCxJQUFBLGtCQUFBcEQsTUFBQSxTQThSckMySyxFQUFPQyxFQUFRbEMsR0FDM0IsR0FBSXBCLEdBQVl6RCxJQUNoQkksR0FBRXFELEVBQVVFLHFCQUFxQnRELFFBQVEsU0FBUzBGLEdBQzlDQSxFQUFPZSxHQUFPQyxFQUFRbEMsUUFqU3VCdEYsSUFBQSxrQkFBQXBELE1BQUEsU0E2U3JDMkssRUFBT0UsRUFBUW5DLEdBQzNCLEdBQUlwQixHQUFZekQsSUFDaEJJLEdBQUVDLFFBQVFvRCxFQUFVQyxvQkFBcUIsU0FBU3FDLEdBQzlDQSxFQUFPZSxHQUFPRSxFQUFRbkMsUUFoVHVCdEYsSUFBQSxvQkFBQXBELE1BQUEsU0F5VG5DOEssR0FDZGpILEtBQUtrSCxRQUFVRCxFQUNmakgsS0FBS3dELElBQUk5SCxLQUFLc0UsS0FBS2tILFlBM1Q4QjNILElBQUEsaUJBQUFwRCxNQUFBLFNBcVV0Q3FILE9BclVzQ2pFLElBQUEsd0JBQUFwRCxNQUFBLFNBNlU5QmdMLEVBQUtDLEdBU3hCLElBQUssR0FSRDNELEdBQVl6RCxLQUNacUgsRUFBUUQsRUFBTUUsTUFBTSxRQUNwQkMsRUFBU0YsRUFBTWpJLE9BQ2ZvSSxFQUFLTCxFQUFJcEMsT0FBTyxRQUNmQyxLQUFLLFFBQVN2QixFQUFVUyxPQUFPSyxVQUMvQlMsS0FBSyxjQUFjLFVBQ25CQSxLQUFLLEtBQU0sSUFBaUIsS0FBVnVDLEVBQU8sSUFFckJwSSxFQUFJLEVBQUdBLEVBQUlrSSxFQUFNakksT0FBUUQsSUFBSyxDQUNuQyxHQUFJc0ksR0FBUUQsRUFBR3pDLE9BQU8sU0FBU3ZFLEtBQUs2RyxFQUFNbEksR0FDMUNBLEdBQUksR0FDSnNJLEVBQU16QyxLQUFLLElBQUssR0FBR0EsS0FBSyxLQUFNLFVBelZlekYsSUFBQSxxQkFBQXBELE1BQUEsU0FrV2xDdUYsR0FDZixHQUFJK0IsR0FBWXpELEtBQ1owSCxFQUFXakUsRUFBVTFELE1BQU00SCxPQUFPLFNBQVNDLEdBQ3ZDLE1BQVFBLEdBQUVoSCxTQUFXYyxHQUFRa0csRUFBRTNJLFNBQVd5QyxHQUVsRGdHLEdBQVNHLElBQUksU0FBU0QsR0FDbEJuRSxFQUFVMUQsTUFBTThHLE9BQU9wRCxFQUFVMUQsTUFBTXNDLFFBQVF1RixHQUFJLFFBeFdOckksSUFBQSxVQUFBcEQsTUFBQSxTQWlYN0N1RixHQUNKLEdBQUkrQixHQUFZekQsSUFDaEJ5RCxHQUFVM0QsTUFBTVcsS0FBS2lCLEdBQ3JCQSxFQUFLd0UsV0FBV3pDLEdBQ2hCQSxFQUFVcUUsaUJBclh1Q3ZJLElBQUEsYUFBQXBELE1BQUEsU0E2WDFDdUYsR0FDUCxHQUFJK0IsR0FBWXpELElBQ2hCeUQsR0FBVTNELE1BQU0rRyxPQUFPcEQsRUFBVTNELE1BQU11QyxRQUFRWCxHQUFPLEdBQ3REK0IsRUFBVXNFLG1CQUFtQnJHLEdBRTdCK0IsRUFBVXFFLGlCQWxZdUN2SSxJQUFBLFVBQUFwRCxNQUFBLFNBMFk3QzBFLEdBQ0osR0FBSTRDLEdBQVl6RCxJQUNoQnlELEdBQVUxRCxNQUFNVSxLQUFLSSxHQUNyQkEsRUFBS3FGLFdBQVd6QyxHQUNoQkEsRUFBVXFFLGlCQTlZdUN2SSxJQUFBLGFBQUFwRCxNQUFBLFNBc1oxQzBFLEdBQ1AsR0FBSTRDLEdBQVl6RCxJQUNoQnlELEdBQVUxRCxNQUFNOEcsT0FBT3BELEVBQVUxRCxNQUFNc0MsUUFBUXhCLEdBQU8sR0FDdERBLEVBQUtxRixXQUFXekMsR0FDaEJBLEVBQVVxRSxpQkExWnVDdkksSUFBQSxzQkFBQXBELE1BQUEsU0FrYWpDZ0osR0FDaEJBLEVBQU1pQixLQUFLLFNBQVN2QixHQUNoQkEsRUFBRW1ELFdBQVczQixHQUFHQyxPQUFPdEcsTUFBTzZFLFFBcGFldEYsSUFBQSxpQkFBQXBELE1BQUEsU0E2YXRDOEwsR0FDWCxHQUFJeEUsR0FBWXpELElBRWhCeUQsR0FBVThCLFlBRVYwQyxFQUFTN0IsS0FBSyxTQUFTdkIsR0FDbkJBLEVBQUVxRCxZQUFZN0IsR0FBR0MsT0FBT3RHLE1BQU82RSxLQUluQ29ELEVBQVNyRCxHQUFHLFlBQWEsU0FBU0MsR0FDdEJBLEVBQUVzRCxVQUNGdEQsRUFBRXVELGdCQUFnQixZQUFhL0IsR0FBR0MsT0FBT3RHLE1BQU82RSxHQUVoRHBCLEVBQVUyRSxnQkFBZ0IsWUFBYS9CLEdBQUdDLE9BQU90RyxNQUFPNkUsS0FHL0RELEdBQUcsV0FBWSxTQUFTQyxHQUNqQkEsRUFBRXNELFVBQ0Z0RCxFQUFFdUQsZ0JBQWdCLFdBQVkvQixHQUFHQyxPQUFPdEcsTUFBTzZFLEdBRS9DcEIsRUFBVTJFLGdCQUFnQixXQUFZL0IsR0FBR0MsT0FBT3RHLE1BQU82RSxLQUc5REQsR0FBRyxjQUFlLFNBQVNDLEdBQ3BCQSxFQUFFc0QsVUFDRnRELEVBQUV1RCxnQkFBZ0IsY0FBZS9CLEdBQUdDLE9BQU90RyxNQUFPNkUsR0FFbERwQixFQUFVMkUsZ0JBQWdCLGNBQWUvQixHQUFHQyxPQUFPdEcsTUFBTzZFLEtBR2pFRCxHQUFHLFdBQVksU0FBU0MsR0FDakJBLEVBQUVzRCxVQUNGdEQsRUFBRXVELGdCQUFnQixXQUFZL0IsR0FBR0MsT0FBT3RHLE1BQU82RSxHQUUvQ3BCLEVBQVUyRSxnQkFBZ0IsV0FBWS9CLEdBQUdDLE9BQU90RyxNQUFPNkUsS0FHOURELEdBQUcsWUFBYSxTQUFTQyxHQUNsQkEsRUFBRXNELFVBQ0Z0RCxFQUFFdUQsZ0JBQWdCLFlBQWEvQixHQUFHQyxPQUFPdEcsTUFBTzZFLEdBRWhEcEIsRUFBVTJFLGdCQUFnQixZQUFhL0IsR0FBR0MsT0FBT3RHLE1BQU82RSxLQUcvREQsR0FBRyxVQUFXLFNBQVNDLEdBQ2hCQSxFQUFFc0QsVUFDRnRELEVBQUV1RCxnQkFBZ0IsVUFBVy9CLEdBQUdDLE9BQU90RyxNQUFPNkUsR0FFOUNwQixFQUFVMkUsZ0JBQWdCLFVBQVcvQixHQUFHQyxPQUFPdEcsTUFBTzZFLEtBRzdEbkosS0FBSytILEVBQVUrQyxTQWplNkJqSCxJQUFBLHNCQUFBcEQsTUFBQSxXQXllakQsR0FBSXNILEdBQVl6RCxJQUNoQnlELEdBQVU0QixRQUFVckYsS0FBS3FGLFFBQVEvRSxLQUFLbUQsRUFBVTNELE1BQU8sU0FBUytFLEdBQUksTUFBT0EsR0FBRTVFLEtBQ3hFbUcsS0FBSyxTQUFTdkIsR0FDWEEsRUFBRW1ELFdBQVczQixHQUFHQyxPQUFPdEcsTUFBTzZFLFFBNWVXdEYsSUFBQSxpQkFBQXBELE1BQUEsU0FzZnRDa00sR0FDWCxHQUFJNUUsR0FBWXpELElBRWhCcUksR0FBU2pDLEtBQUssU0FBU3ZCLEdBQ0osTUFBWEEsRUFBRXlELE9BQ0Z6RCxFQUFFcUIsV0FBV3pDLEdBRWpCb0IsRUFBRTBELFlBQVlsQyxHQUFHQyxPQUFPdEcsTUFBTzZFLEtBS25Dd0QsRUFBU3pELEdBQUcsWUFBYSxTQUFTQyxHQUN0QkEsRUFBRXNELFVBQ0Z0RCxFQUFFMkQsZ0JBQWdCLFlBQWFuQyxHQUFHQyxPQUFPdEcsTUFBTzZFLEdBRWhEcEIsRUFBVStFLGdCQUFnQixZQUFhbkMsR0FBR0MsT0FBT3RHLE1BQU82RSxLQUcvREQsR0FBRyxXQUFZLFNBQVNDLEdBQ2pCQSxFQUFFc0QsVUFDRnRELEVBQUUyRCxnQkFBZ0IsV0FBWW5DLEdBQUdDLE9BQU90RyxNQUFPNkUsR0FFL0NwQixFQUFVK0UsZ0JBQWdCLFdBQVluQyxHQUFHQyxPQUFPdEcsTUFBTzZFLEtBRzlERCxHQUFHLGNBQWUsU0FBU0MsR0FDcEJBLEVBQUVzRCxVQUNGdEQsRUFBRTJELGdCQUFnQixjQUFlbkMsR0FBR0MsT0FBT3RHLE1BQU82RSxHQUVsRHBCLEVBQVUrRSxnQkFBZ0IsY0FBZW5DLEdBQUdDLE9BQU90RyxNQUFPNkUsS0FHakVELEdBQUcsV0FBWSxTQUFTQyxHQUNqQkEsRUFBRXNELFVBQ0Z0RCxFQUFFMkQsZ0JBQWdCLFdBQVluQyxHQUFHQyxPQUFPdEcsTUFBTzZFLEdBRS9DcEIsRUFBVStFLGdCQUFnQixXQUFZbkMsR0FBR0MsT0FBT3RHLE1BQU82RSxLQUc5REQsR0FBRyxZQUFhLFNBQVNDLEdBQ2xCQSxFQUFFc0QsVUFDRnRELEVBQUUyRCxnQkFBZ0IsWUFBYW5DLEdBQUdDLE9BQU90RyxNQUFPNkUsR0FFaERwQixFQUFVK0UsZ0JBQWdCLFlBQWFuQyxHQUFHQyxPQUFPdEcsTUFBTzZFLEtBRy9ERCxHQUFHLFVBQVcsU0FBU0MsR0FDaEJBLEVBQUVzRCxVQUNGdEQsRUFBRTJELGdCQUFnQixVQUFXbkMsR0FBR0MsT0FBT3RHLE1BQU82RSxHQUU5Q3BCLEVBQVUrRSxnQkFBZ0IsVUFBV25DLEdBQUdDLE9BQU90RyxNQUFPNkUsS0FHN0RuSixLQUFLK0gsRUFBVStDLE1BRXBCNkIsRUFBU3RELE9BQU8sVUFDZkMsS0FBSyxJQUFLLFNBQVNILEdBQUksTUFBTzRELFFBQU81RCxFQUFFNkQsVUFHeENMLEVBQVNqQyxLQUFLLFNBQVN2QixHQUNuQnBCLEVBQVVrRixzQkFBc0J0QyxHQUFHQyxPQUFPdEcsTUFBTzZFLEVBQUVyRSxXQW5qQk5qQixJQUFBLGlCQUFBcEQsTUFBQSxTQThqQnRDeU0sR0FDZCxHQUFJbkYsR0FBWXpELEtBQ2ZrRSxFQUFTVCxFQUFVUyxPQUNoQnBFLEVBQVEyRCxFQUFVM0QsTUFDbEIrSSxFQUFXeEMsR0FBR3lDLEtBQUtELFNBQVMvSSxFQUN6QixPQUFPLFVBQVMrRSxHQUNoQixHQUFJa0UsR0FBSWxFLEVBQUU2RCxPQUFTeEUsRUFBT08sVUFBWVAsRUFBT1EsUUFDekNzRSxFQUFNbkUsRUFBRW9FLEVBQUlGLEVBQ1pHLEVBQU1yRSxFQUFFb0UsRUFBSUYsRUFDWkksRUFBTXRFLEVBQUV1RSxFQUFJTCxFQUNaTSxFQUFNeEUsRUFBRXVFLEVBQUlMLENBQ2hCRixHQUFTUyxNQUFNLFNBQVNDLEVBQU1DLEVBQUlDLEVBQUlDLEVBQUlDLEdBQ3RDLEdBQUlKLEVBQUtLLE9BQVVMLEVBQUtLLFFBQVUvRSxFQUFJLENBQ2xDLEdBQUlvRSxHQUFJcEUsRUFBRW9FLEVBQUlNLEVBQUtLLE1BQU1YLEVBQ3JCRyxFQUFJdkUsRUFBRXVFLEVBQUlHLEVBQUtLLE1BQU1SLEVBQ3JCeEIsRUFBSWlDLEtBQUtDLEtBQUtiLEVBQUlBLEVBQUlHLEVBQUlBLEdBQzFCTCxFQUFJbEUsRUFBRTZELE9BQVNhLEVBQUtLLE1BQU1sQixPQUFTeEUsRUFBT1EsT0FDdENxRSxHQUFKbkIsSUFDRkEsR0FBS0EsRUFBSW1CLEdBQUtuQixFQUFJZ0IsRUFDbEIvRCxFQUFFb0UsR0FBS0EsR0FBS3JCLEVBQ1ovQyxFQUFFdUUsR0FBS0EsR0FBS3hCLEVBQ1oyQixFQUFLSyxNQUFNWCxHQUFLQSxFQUNoQk0sRUFBS0ssTUFBTVIsR0FBS0EsR0FHeEIsTUFBT0ksR0FBS04sR0FBWUYsRUFBTFUsR0FBWUQsRUFBS0osR0FBWUYsRUFBTFEsUUF2bEJBcEssSUFBQSxjQUFBcEQsTUFBQSxTQW1tQnpDNE4sRUFBR0MsRUFBT0MsR0FVaEIsSUFUTCxHQUFJeEcsR0FBWXpELEtBQ2ZrRSxFQUFTVCxFQUFVUyxPQUVoQmdHLEVBQVNoRyxFQUFPUyxjQUNoQjdFLEVBQVEyRCxFQUFVM0QsTUFDbEJxSyxFQUFJOUQsR0FBR3lDLEtBQUtELFNBQVNwRixFQUFVM0QsT0FDMUJYLEVBQUksRUFDSmlMLEVBQUl0SyxFQUFNVixTQUVMRCxFQUFJaUwsR0FDWEQsRUFBRWIsTUFBTXRKLEtBQUtxSyxlQUFldkssRUFBTVgsSUFHdENzRSxHQUFVNEIsUUFBUWUsS0FBS3BHLEtBQUtxSyxlQUFlLEtBQ3RDckYsS0FBSyxLQUFNLFNBQVNILEdBQUssTUFBT0EsR0FBRW9FLEVBQUlZLEtBQUtTLElBQUl6RixFQUFFNkQsT0FBU3dCLEVBQVFMLEtBQUtVLElBQUlQLEVBQVFFLEVBQVNyRixFQUFFNkQsT0FBUTdELEVBQUVvRSxNQUN2R2pFLEtBQUssS0FBTSxTQUFTSCxHQUFLLE1BQU9BLEdBQUV1RSxFQUFJUyxLQUFLUyxJQUFJekYsRUFBRTZELE9BQVN3QixFQUFRTCxLQUFLVSxJQUFJTixFQUFTQyxFQUFTckYsRUFBRTZELE9BQVE3RCxFQUFFdUUsTUFFL0czRixFQUFVMEIsTUFDTEgsS0FBSyxLQUFNLFNBQVNILEdBQUssTUFBT0EsR0FBRWpFLE9BQU9xSSxJQUN6Q2pFLEtBQUssS0FBTSxTQUFTSCxHQUFLLE1BQU9BLEdBQUVqRSxPQUFPd0ksSUFDekNwRSxLQUFLLEtBQU0sU0FBU0gsR0FBSyxNQUFPQSxHQUFFNUYsT0FBT2dLLElBQ3pDakUsS0FBSyxLQUFNLFNBQVNILEdBQUssTUFBT0EsR0FBRTVGLE9BQU9tSyxPQXpuQkc3SixJQUFBLGVBQUFwRCxNQUFBLFdBZ29CcEQsR0FBSXNILEdBQVl6RCxJQUNieUQsR0FBVTBCLE1BQ0xILEtBQUssS0FBTSxTQUFTSCxHQUFLLE1BQU9BLEdBQUVqRSxPQUFPcUksSUFDekNqRSxLQUFLLEtBQU0sU0FBU0gsR0FBSyxNQUFPQSxHQUFFakUsT0FBT3dJLElBQ3pDcEUsS0FBSyxLQUFNLFNBQVNILEdBQUssTUFBT0EsR0FBRTVGLE9BQU9nSyxJQUN6Q2pFLEtBQUssS0FBTSxTQUFTSCxHQUFLLE1BQU9BLEdBQUU1RixPQUFPbUssT0Fyb0JHN0osSUFBQSxhQUFBcEQsTUFBQSxXQTRvQnBELEdBQUlzSCxHQUFZekQsSUFDaEJ5RCxHQUFVNEIsUUFDRkwsS0FBSyxLQUFNLFNBQVNILEdBQUssTUFBT0EsR0FBRW9FLElBQ2xDakUsS0FBSyxLQUFNLFNBQVNILEdBQUssTUFBT0EsR0FBRXVFLElBRXZDM0YsRUFBVTBCLE1BQU1ILEtBQUssS0FBTSxTQUFTSCxHQUFLLE1BQU9BLEdBQUVqRSxPQUFPcUksSUFDcERqRSxLQUFLLEtBQU0sU0FBU0gsR0FBSyxNQUFPQSxHQUFFakUsT0FBT3dJLElBQ3pDcEUsS0FBSyxLQUFNLFNBQVNILEdBQUssTUFBT0EsR0FBRTVGLE9BQU9nSyxJQUN6Q2pFLEtBQUssS0FBTSxTQUFTSCxHQUFLLE1BQU9BLEdBQUU1RixPQUFPbUssT0FwcEJHN0osSUFBQSxnQkFBQXBELE1BQUEsV0E4cEJqRCxHQUFJcU8sR0FBVzNFLEVBQUUsd0JBQXdCbUUsUUFDckNTLEVBQVk1RSxFQUFFLHdCQUF3Qm9FLFNBRXRDRCxFQUFRUSxFQUNSUCxFQUFTUSxDQUNiLFFBQVFULE1BQU1BLEVBQU9DLE9BQU9BLE1BbnFCcUIxSyxJQUFBLFdBQUFwRCxNQUFBLFNBMnFCNUN1TyxHQUNMLEdBQUlqSCxHQUFZekQsS0FFWkYsRUFBUTJELEVBQVUzRCxNQUNsQkMsRUFBUTBELEVBQVUxRCxLQUN0QixLQUFJSyxFQUFFd0IsUUFBUTlCLEdBQWQsQ0FJQSxHQUFJNkssR0FBU2xILEVBQVVtSCxnQkFFbkJDLEVBQVF4RSxHQUFHeUUsT0FBT0QsUUFDakJFLE1BQU1KLEVBQU9YLE1BQU9XLEVBQU9WLFNBQzNCbkssTUFBTUEsR0FDTmtMLE9BQU8sU0FBU25HLEdBQ2IsTUFBTyxPQUVWOUUsTUFBTUEsRUFFWDhLLEdBQU1JLGFBQWFOLEVBQU9YLE1BQU0sR0FDaENhLEVBQU1LLGFBQWEsSUFDbkJMLEVBQU1NLFFBQVEsSUFFZE4sRUFBTWpHLEdBQUcsT0FBUSxTQUFTbUYsR0FDekJ0RyxFQUFVMkgsWUFBWTFQLEtBQUsrSCxFQUN6QnNHLEVBQUdZLEVBQU9YLE1BQU9XLEVBQU9WLFVBRzNCWSxFQUFNakcsR0FBRyxRQUFTLFdBQ2pCbkIsRUFBVTRILGFBQWEzUCxLQUFLK0gsS0FHN0JvSCxFQUFNakcsR0FBRyxNQUFPLFdBQ2ZuQixFQUFVNkgsV0FBVzVQLEtBQUsrSCxLQUkzQm9ILEVBQU1VLE9BRU4sS0FEQSxHQUFJQyxHQUFJLEVBQ0FYLEVBQU1qQyxRQUFVLEtBQWMsSUFBSjRDLEdBQzlCWCxFQUFNWSxPQUNORCxHQUFRLENBRVpYLEdBQU1hLE9BRVUsTUFBWmhCLEdBQ0hBLFFBenRCZ0RuTCxJQUFBLGVBQUFwRCxNQUFBLFdBOHVCakQsSUFBSyxHQVhEc0gsR0FBWXpELEtBRVprSyxFQUFTekcsRUFBVVMsT0FBT1MsY0FDMUI2RixFQUFXM0UsRUFBRSx3QkFBd0JtRSxRQUNyQ1MsRUFBWTVFLEVBQUUsd0JBQXdCb0UsU0FFdENELEVBQVFRLEVBQVksRUFBRU4sRUFDdEJELEVBQVNRLEVBQWEsRUFBRVAsRUFFeEJwSyxFQUFRMkQsRUFBVTNELE1BRWJYLEVBQUksRUFBR0EsRUFBSVcsRUFBTVYsT0FBUUQsSUFDOUJXLEVBQU1YLEdBQUd1SixPQUFTNUksRUFBTVgsR0FBR3VKLFFBQVVqRixFQUFVUyxPQUFPTSxZQUNwQyxNQUFkMUUsRUFBTVgsR0FBRzhKLEdBQTJCLE1BQWRuSixFQUFNWCxHQUFHaUssSUFFL0J0SixFQUFNWCxHQUFHOEosRUFBSWUsRUFBTSxFQUFLbEssRUFBTVgsR0FBR3VKLE9BQVN3QixFQUUxQ3BLLEVBQU1YLEdBQUdpSyxFQUFJYSxFQUFPLEVBQUluSyxFQUFNWCxHQUFHdUosT0FBU3dCLE1BcHZCRDNLLElBQUEsY0FBQXBELE1BQUEsU0ErdkJ6Q3VPLEdBQ1IsR0FBSWpILEdBQVl6RCxLQUNaa0UsRUFBU1QsRUFBVVMsT0FDbkJqQixFQUFRUSxFQUFVUixLQUV6QixLQUFJUSxFQUFVUixNQUFNZ0IsY0FBcEIsQ0FJR2pFLEtBQUsyTCxxQkFDTCxJQUFJQyxHQUFPbkksRUFBVTRCLFFBQVF3RyxRQUN4QjlHLE9BQU8sSUFHWjZHLEdBQU0xRyxRQUFRaEIsRUFBT0MsY0FBYyxHQUtuQ1YsRUFBVTRCLFFBQVF5RyxPQUFPQyxTQUVGLEdBQW5COUksRUFBTWUsV0FDTlAsRUFBVXVJLFNBQVMsV0FDbEJ2SSxFQUFVd0ksZUFBZXZRLEtBQUsrSCxFQUFXbUksS0FFMUMzSSxFQUFNZSxXQUFZLEdBRXJCaEUsS0FBS2lNLGVBQWVMLEdBR3JCbkksRUFBVTBCLE1BQVExQixFQUFVMEIsTUFBTTdFLEtBQUttRCxFQUFVMUQsTUFBTyxTQUFTOEUsR0FDN0QsTUFBTzRELFFBQU81RCxFQUFFakUsT0FBT1gsSUFBTSxJQUFNd0ksT0FBTzVELEVBQUU1RixPQUFPZ0IsS0FFdkQsSUFBSWtGLEdBQVExQixFQUFVMEIsS0FDdEJuRixNQUFLa00sb0JBQW9CL0csRUFFekIsSUFBSWdILEdBQVdoSCxFQUFNMEcsUUFDcEI5RyxPQUFPLFFBQ1BxSCxNQUFNLGFBQWEsbUJBQ25CbEgsUUFBUSxRQUFRLEVBQ2pCbEYsTUFBS3FNLGVBQWVGLEdBR3BCaEgsRUFBTTJHLE9BQU9DLFNBRUcsTUFBWnJCLEdBQ0hBLFNBN3lCZ0RuSCxJQW16QnpELFFBQ0lBLE1BQU9BLE1DNXpCbkI5RyxRQUFBQyxPQUFBLG9CQUFBLGtCQUNBcUcsUUFBQSxpQkFBQSxTQUFBQyxHQUNBQSxFQUNBQyxNQUFBLHlCQUNBQyxJQUFBLGFBQ0FHLFVBQUEsZ0JUdzRDQSxJQUFJdEUsY0FBZSxXQUFjLFFBQVNDLEdBQWlCQyxFQUFRQyxHQUFTLElBQUssR0FBSUMsR0FBSSxFQUFHQSxFQUFJRCxFQUFNRSxPQUFRRCxJQUFLLENBQUUsR0FBSUUsR0FBYUgsRUFBTUMsRUFBSUUsR0FBV2pELFdBQWFpRCxFQUFXakQsYUFBYyxFQUFPaUQsRUFBVy9DLGNBQWUsRUFBVSxTQUFXK0MsS0FBWUEsRUFBV2hELFVBQVcsR0FBTUwsT0FBT3NELGVBQWVMLEVBQVFJLEVBQVdFLElBQUtGLElBQWlCLE1BQU8sVUFBVS9ELEVBQWFrRSxFQUFZQyxHQUFpSixNQUE5SEQsSUFBWVIsRUFBaUIxRCxFQUFZUyxVQUFXeUQsR0FBaUJDLEdBQWFULEVBQWlCMUQsRUFBYW1FLEdBQXFCbkUsS1U3NENoaUJtQixTQUFRQyxPQUFPLGdCQUNWZ0QsUUFBUSxtQkFBb0IsUUFBUyxTQUFVNkQsR0FBTyxHQUNoRCtJLEdBRGdELFNBQUFDLEdBVy9DLFFBQUFELEdBQVk5SSxFQUFLMUQsRUFBT0MsRUFBT3lNLEdBQVlwUixnQkFBQTRFLEtBQUFzTSxFQUFBLElBQUFoTCxHQUFBOUYsMkJBQUF3RSxNQUFBc00sRUFBQTlQLFdBQUFSLE9BQUF1RixlQUFBK0ssSUFBQTVRLEtBQUFzRSxLQUNqQ3dELEVBQUsxRCxFQUFPQyxJQUNkMEQsRUFBQUEsQ0FHSkEsR0FBVVIsTUFBTXdKLGNBRWhCaEosRUFBVVMsT0FBT3dJLFlBQWMsSUFFL0JqSixFQUFVUyxPQUFPeUksWUFBYyxFQUUvQmxKLEVBQVVTLE9BQU8wSSxlQUFpQixZQUlsQ25KLEVBQVUrSSxXQUFhQSxDQUd2QixJQUFJaEcsR0FBT0gsR0FBR3dHLFNBQVNyRyxPQUNsQnNHLE9BQU8sU0FBU2pJLEdBQ2QsT0FBUW9FLEVBQUdwRSxFQUFFb0UsRUFBR0csRUFBR3ZFLEVBQUV1RSxLQUV2QnhFLEdBQUcsWUFBYSxjQUVoQkEsR0FBRyxPQUFRLFNBQVNtSSxHQUNwQjFHLEdBQUdDLE9BQVF0RyxNQUFNZ0YsS0FBSyxZQUFhLFNBQVVILEVBQUcxRixHQUd6QyxNQUZBMEYsR0FBRW9FLEdBQUs1QyxHQUFHUyxNQUFNa0csR0FDaEJuSSxFQUFFdUUsR0FBSy9DLEdBQUdTLE1BQU1tRyxHQUNULGNBQWlCcEksRUFBRW9FLEVBQUVwRSxFQUFFdUUsR0FBTSxNQUV4QzNGLEVBQVVxRSxnQkFFYmxELEdBQUcsVUFBVyxhQUduQm5CLEdBQVUrQyxLQUFPQSxDQUdqQixJQUFJMEcsR0FBTzdHLEdBQUd3RyxTQUFTSyxPQUNsQnRJLEdBQUcsT0FBUSxXQUNSLE1BQTRCLE9BQXhCeUIsR0FBR1MsTUFBTXFHLGFBQXVCOUcsR0FBR1MsTUFBTXFHLFlBQVlDLFNBQzlDLEdBRVAzSixFQUFVNEosT0FBTzNSLEtBQUsrSCxJQUVuQixLQUVWbUIsR0FBRyxZQUFhLFNBQVNDLEVBQUcxRixLQS9DTSxPQWlEdkNzRSxHQUFVeUQsUUFBVWdHLEVBQ3BCekosRUFBVUQsSUFBSTlILEtBQUt3UixHQUFNdEksR0FBRyxnQkFBaUIsTUFsRE50RCxFQVhJLE1BQUExRixXQUFBMFEsRUFBQUMsR0FBQXhOLGFBQUF1TixJQUFBL00sSUFBQSxTQUFBcEQsTUFBQSxTQXdFeENtUixFQUFXQyxHQUNkLEdBQUk5SixHQUFZekQsSUFDaEIsSUFBa0MsR0FBOUJ5RCxFQUFVUixNQUFNdUssV0FBcEIsQ0FJQSxHQURBeE4sS0FBS2lELE1BQU13SyxxQkFBc0IsRUFDaEIsTUFBYkgsR0FBOEIsTUFBVEMsRUFBZSxDQUNwQyxHQUFJTCxHQUFPekosRUFBVXlELE9BQ3JCZ0csR0FBS0ssTUFBTUEsR0FDWEwsRUFBS0ksVUFBVUEsRUFFZixJQUFJSSxHQUFrQixXQUNyQlIsRUFBS0ssTUFBTUEsR0FDWEwsRUFBS0ksVUFBVUEsSUFFWkssRUFBaUIsT0FBU0wsQ0FHOUIsWUFGQWpILElBQUdDLE9BQU8sSUFBTXRHLEtBQUtrRSxPQUFPRSxZQUFZcUksV0FBV2tCLEdBQWdCQyxNQUFNLEtBQUtDLFNBQVMsS0FDbEY3SSxLQUFLLFlBQWEsYUFBZWtJLEVBQUtJLFlBQWMsV0FBYUosRUFBS0ssUUFBVSxLQUFLbkgsS0FBSyxNQUFPc0gsR0FHdEdqSyxFQUFVUixNQUFNYSxTQUNoQnVDLEdBQUdDLE9BQU8sSUFBTXRHLEtBQUtrRSxPQUFPRSxZQUN2QlksS0FBSyxZQUFhLGFBQWV2QixFQUFVeUQsUUFBUW9HLFlBQWMsV0FBWTdKLEVBQVV5RCxRQUFRcUcsUUFBVSxTQTlGdkVoTyxJQUFBLGlCQUFBcEQsTUFBQSxTQXVHaENxSCxHQUNYLEdBQUlzSyxHQUFTQyxTQUFTQyxxQkFBcUIsUUFBUSxHQUMvQzlELEVBQVNyRSxFQUFFLHdCQUF3QnFFLFNBQ25DK0QsRUFBV3BJLEVBQUUsd0JBQXdCbUUsUUFDckNDLEVBQVM2RCxFQUFPSSxZQUNwQjFLLEdBQUl3QixLQUFLLFFBQVNpSixHQUFVakosS0FBSyxTQUFVaUYsRUFBU0MsRUFBT2lFLElBQU0sT0E1R3RCNU8sSUFBQSxpQkFBQXBELE1BQUEsV0FzSDNDLElBQUssR0FGRHNILEdBQVl6RCxLQUNab08sS0FDS2pQLEVBQUksRUFBR0EsRUFBSXNFLEVBQVUzRCxNQUFNVixPQUFRRCxJQUN4Q2lQLEVBQWUzTixLQUFLZ0QsRUFBVTNELE1BQU1YLEdBQUdjLEdBRTNDLElBQUlvTyxHQUFVNUssRUFBVStJLFdBQVd4SyxrQkFBa0JvTSxHQUNqRDFOLEVBQVcyTixFQUFRM04sUUFDdkIrQyxHQUFVMUQsTUFBUTBELEVBQVUrSSxXQUFXOEIsZ0JBQWdCNU4sRUFBVStDLEVBQVUzRCxPQUMzRUUsS0FBS3NGLFlBQ0x0RixLQUFLdUYsWUFDTDlCLEVBQVVxRSxrQkE5SGlDd0UsR0FDeEIvSSxFQUFNQSxNQW1JakMsUUFDSUEsTUFBTytJLE1DdEluQjdQLFFBQUFDLE9BQUEsZ0JBQUEsZ0JYNGlEQSxJQUFJcUMsY0FBZSxXQUFjLFFBQVNDLEdBQWlCQyxFQUFRQyxHQUFTLElBQUssR0FBSUMsR0FBSSxFQUFHQSxFQUFJRCxFQUFNRSxPQUFRRCxJQUFLLENBQUUsR0FBSUUsR0FBYUgsRUFBTUMsRUFBSUUsR0FBV2pELFdBQWFpRCxFQUFXakQsYUFBYyxFQUFPaUQsRUFBVy9DLGNBQWUsRUFBVSxTQUFXK0MsS0FBWUEsRUFBV2hELFVBQVcsR0FBTUwsT0FBT3NELGVBQWVMLEVBQVFJLEVBQVdFLElBQUtGLElBQWlCLE1BQU8sVUFBVS9ELEVBQWFrRSxFQUFZQyxHQUFpSixNQUE5SEQsSUFBWVIsRUFBaUIxRCxFQUFZUyxVQUFXeUQsR0FBaUJDLEdBQWFULEVBQWlCMUQsRUFBYW1FLEdBQXFCbkUsS1l0aURoaUJtQixTQUFRQyxPQUFPLGdCQUNWZ0QsUUFBUSxRQUFTLFdBQVksR0FDdkJFLEdBRHVCLFdBUS9CLFFBQUFBLEdBQVkyTyxFQUFZQyxHQUFZcFQsZ0JBQUE0RSxLQUFBSixHQUNuQ0ksS0FBS1ksT0FBUzJOLEVBQ2R2TyxLQUFLZixPQUFTdVAsRUFDZHhPLEtBQUttSSxXQUFZLEVBQ2pCbkksS0FBS3lPLGdCQUNMek8sS0FBS3NJLE1BQVEsS0FDYnRJLEtBQUswTyxhQUFjLEVBZFcsTUFBQTNQLGNBQUFhLElBQUFMLElBQUEsYUFBQXBELE1BQUEsU0FzQnBCbU0sR0FDYyxHQUFwQnRJLEtBQUswTyxjQUNSMU8sS0FBSzBPLGFBQWMsRUFDbkIxTyxLQUFLc0ksTUFBUUEsTUF6QmdCL0ksSUFBQSxhQUFBcEQsTUFBQSxTQW1DcEI0SyxFQUFRbEMsR0FDbEJrQyxFQUFPcUYsTUFBTSxhQUFjLG1CQUNoQnBILEtBQUssSUFBSzJKLGNBckNTcFAsSUFBQSxjQUFBcEQsTUFBQSxTQThDbkI0SyxFQUFRbEMsR0FDbkJrQyxFQUFPL0IsS0FBSyxJQUFLMkosY0EvQ2FwUCxJQUFBLFlBQUFwRCxNQUFBLFdBd0QzQixHQUFJMEksR0FBSTdFLEtBQ0RnTixFQUFLbkksRUFBRTVGLE9BQU9nSyxFQUFJcEUsRUFBRWpFLE9BQU9xSSxFQUMzQmdFLEVBQUtwSSxFQUFFNUYsT0FBT21LLEVBQUl2RSxFQUFFakUsT0FBT3dJLEVBQzNCd0YsRUFBSy9FLEtBQUtDLEtBQUtrRCxFQUFLQSxFQUFLQyxFQUFLQSxFQUNsQyxPQUFPLElBQU1wSSxFQUFFakUsT0FBT3FJLEVBQUksSUFBTXBFLEVBQUVqRSxPQUFPd0ksRUFBSSxJQUFNd0YsRUFBSyxJQUFNQSxFQUFLLFVBQVkvSixFQUFFNUYsT0FBT2dLLEVBQUksSUFBTXBFLEVBQUU1RixPQUFPbUssS0E1RG5GN0osSUFBQSxvQkFBQXBELE1BQUEsU0FxRWI0SixHQUNqQi9GLEtBQUttSSxXQUFZLEVBQ2pCbkksS0FBS3lPLGFBQWFoTyxLQUFLc0YsR0FDdkJBLEVBQU9HLFdBQVdsRyxLQUFLc0ksVUF4RU8vSSxJQUFBLHNCQUFBcEQsTUFBQSxTQWdGWHNLLEdBQ25CLEdBQUlDLEdBQ0FtSSxFQUFXN08sSUFFZDBHLEdBRDJCLGdCQUFqQkQsR0FDU0EsRUFFQUEsRUFBYUUsV0FFakN2RyxFQUFFeU8sRUFBU0osY0FBY3BPLFFBQVEsU0FBUzBGLEVBQVFhLEdBQzdDYixFQUFPWSxhQUFlRCxJQUN6QlgsRUFBT0MsVUFDUDZJLEVBQVNKLGFBQWE1SCxPQUFPRCxFQUFPLE1BR0QsSUFBakNpSSxFQUFTSixhQUFhclAsU0FDekJ5UCxFQUFTMUcsV0FBWSxNQS9GUTVJLElBQUEsa0JBQUFwRCxNQUFBLFNBMEdmMkssRUFBT0MsRUFBUWxDLEdBQzlCekUsRUFBRXlFLEVBQUU0SixjQUFjcE8sUUFBUSxTQUFTMEYsR0FDbENBLEVBQU9lLEdBQU9DLEVBQVFsQyxTQTVHT2pGLElBZ0hoQyxRQUNDQSxLQUFNQSxNQ3hIVG5ELFFBQUFDLE9BQUEsa0JDQUFELFFBQUFDLE9BQUEsMEJBQUEsZ0JBQUEsb0JBQUEsaUJBQ0FxRyxRQUFBLGlCQUFBLFNBQUFDLEdBQ0FBLEVBQ0FDLE1BQUEsK0JBQ0FDLElBQUEsbUJBQ0FDLFlBQUEsRUFDQUMsU0FBQSx3Q0FFQUgsTUFBQSx5Q0FDQUMsSUFBQSxhQUNBQyxZQUFBLEVBQ0FDLFNBQUEsZUFFQUgsTUFBQSxnREFDQUMsSUFBQSxVQUNBRyxVQUFBLDBCQUVBSixNQUFBLGlEQUNBQyxJQUFBLGdCQUNBRyxVQUFBLDJCQUVBSixNQUFBLDhDQUNBQyxJQUFBLGFBQ0FHLFVBQUEsMkJBRUFKLE1BQUEseUNBQ0FDLElBQUEsYUFDQUMsWUFBQSxFQUNBQyxTQUFBLGVBRUFILE1BQUEsZ0RBQ0FDLElBQUEsVUFDQUcsVUFBQSwwQkFFQUosTUFBQSxpREFDQUMsSUFBQSxnQkFDQUcsVUFBQSwyQkFFQUosTUFBQSw4Q0FDQUMsSUFBQSxhQUNBRyxVQUFBLDJCQUVBSixNQUFBLDJDQUNBQyxJQUFBLGVBQ0FDLFlBQUEsRUFDQUMsU0FBQSxlQUVBSCxNQUFBLDhDQUNBQyxJQUFBLGFBQ0FHLFVBQUEsd0JBRUFKLE1BQUEsOENBQ0FDLElBQUEsYUFDQUcsVUFBQSwwQmRzdERBLElBQUl0RSxjQUFlLFdBQWMsUUFBU0MsR0FBaUJDLEVBQVFDLEdBQVMsSUFBSyxHQUFJQyxHQUFJLEVBQUdBLEVBQUlELEVBQU1FLE9BQVFELElBQUssQ0FBRSxHQUFJRSxHQUFhSCxFQUFNQyxFQUFJRSxHQUFXakQsV0FBYWlELEVBQVdqRCxhQUFjLEVBQU9pRCxFQUFXL0MsY0FBZSxFQUFVLFNBQVcrQyxLQUFZQSxFQUFXaEQsVUFBVyxHQUFNTCxPQUFPc0QsZUFBZUwsRUFBUUksRUFBV0UsSUFBS0YsSUFBaUIsTUFBTyxVQUFVL0QsRUFBYWtFLEVBQVlDLEdBQWlKLE1BQTlIRCxJQUFZUixFQUFpQjFELEVBQVlTLFVBQVd5RCxHQUFpQkMsR0FBYVQsRUFBaUIxRCxFQUFhbUUsR0FBcUJuRSxNQUU1aEJ3VCxLQUFPLFFBQVNDLEdBQUlDLEVBQVFDLEVBQVVDLEdBQTJCLE9BQVhGLElBQWlCQSxFQUFTRyxTQUFTcFQsVUFBVyxJQUFJcVQsR0FBT3BULE9BQU9xVCx5QkFBeUJMLEVBQVFDLEVBQVcsSUFBYXZNLFNBQVQwTSxFQUFvQixDQUFFLEdBQUl2TixHQUFTN0YsT0FBT3VGLGVBQWV5TixFQUFTLE9BQWUsUUFBWG5OLEVBQW1CLE9BQWtDa04sRUFBSWxOLEVBQVFvTixFQUFVQyxHQUFvQixHQUFJLFNBQVdFLEdBQVEsTUFBT0EsR0FBS2pULEtBQWdCLElBQUltVCxHQUFTRixFQUFLTCxHQUFLLElBQWVyTSxTQUFYNE0sRUFBNEMsTUFBT0EsR0FBTzVULEtBQUt3VCxHZTd3RDVkelMsU0FBUUMsT0FBTyxnQkFDVmdELFFBQVEsa0JBQW1CLE9BQVEsU0FBVUUsR0FBTSxHQUNoRG1CLEdBRGdELFNBQUF3TyxHQVNsRCxRQUFBeE8sR0FBWXdOLEVBQVlDLEVBQVlsTSxHQUFRbEgsZ0JBQUE0RSxLQUFBZSxFQUFBLElBQUFPLEdBQUE5RiwyQkFBQXdFLE1BQUFlLEVBQUF2RSxXQUFBUixPQUFBdUYsZUFBQVIsSUFBQXJGLEtBQUFzRSxLQUNsQ3VPLEVBQVlDLEdBRHNCLE9BRXhDbE4sR0FBS2dCLE9BQVNBLEVBSWRoQixFQUFLa08sTUFBUSxFQU4yQmxPLEVBVE0sTUFBQTFGLFdBQUFtRixFQUFBd08sR0FBQXhRLGFBQUFnQyxJQUFBeEIsSUFBQSxnQkFBQXBELE1BQUEsV0F3QjlDNkQsS0FBS3dQLE9BQVMsS0F4QmdDalEsSUFBQSxhQUFBcEQsTUFBQSxXQWlDakQsR0FBSXNULEdBQ0E1SyxFQUFJN0UsS0FDSmdOLEdBQU1uSSxFQUFFNUYsT0FBT2dLLEVBQUlwRSxFQUFFakUsT0FBT3FJLEdBQUssRUFDOUJnRSxHQUFNcEksRUFBRTVGLE9BQU9tSyxFQUFJdkUsRUFBRWpFLE9BQU93SSxHQUFLLENBb0J4QyxPQWxCQ3FHLEdBREc1SyxFQUFFakUsT0FBT3FJLEVBQUlwRSxFQUFFNUYsT0FBT2dLLEdBRVR5RyxHQUFJLGFBQ0pDLEdBQUksZ0JBQ0oxUSxRQUFTK04sRUFBSUMsR0FDYjJDLFFBQ0N4RyxFQUFHLE1BS0pzRyxHQUFJLGdCQUNKQyxHQUFJLGdCQUNKMVEsUUFBUytOLEVBQUlDLEdBQ2IyQyxRQUNDeEcsRUFBRyxTQXBENEI3SixJQUFBLGFBQUFwRCxNQUFBLFNBZ0UxQ21NLEdBQ1YsR0FBd0IsR0FBcEJ0SSxLQUFLME8sWUFBc0IsQ0FDOUJJLEtBQUEvTixFQUFBaEYsVUFBQVMsV0FBQVIsT0FBQXVGLGVBQUFSLEVBQUFoRixXQUFBLGFBQUFpRSxNQUFBdEUsS0FBQXNFLEtBQWlCc0ksRUFDakIsSUFBSXJGLEdBQVFxRixFQUFNckYsTUFBTWxDLGNBQ1gsT0FBVGtDLElBQ0hBLEVBQVFxRixFQUFNckYsTUFBTWxDLGtCQUNwQmtDLEVBQU00TSxVQUFZLEtBQ2xCNU0sRUFBTTZNLGNBQWUsR0FFdEI5UCxLQUFLK1Asc0JBekU4Q3hRLElBQUEsa0JBQUFwRCxNQUFBLFNBa0ZyQzZULEdBQ1RoUSxLQUFLc0ksTUFBTXJGLE1BQU1sQyxlQUFlK08sZUFBaUJFLEtBbkZIelEsSUFBQSxZQUFBcEQsTUFBQSxTQTJGeENtRyxHQUNOdEMsS0FBS3NDLE9BQVNBLEtBNUZnQy9DLElBQUEsZUFBQXBELE1BQUEsV0FxRzlDLE1BQU82RCxNQUFLc0MsVUFyR2tDL0MsSUFBQSxZQUFBcEQsTUFBQSxXQStHOUMsR0FBSXNILEdBQVl6RCxLQUFLc0ksTUFDakJyRixFQUFRUSxFQUFVUixNQUFNbEMsY0FFNUIsSUFBSWtDLEVBQU02TSxhQUFjLENBQ3BCLEdBQUl4TixHQUFTdEMsS0FBS3NDLE9BQVN0QyxLQUFLd1AsS0FDaEMsT0FBT2xOLEdBRVgsTUFBT3RDLE1BQUtzQyxVQXRIa0MvQyxJQUFBLGtCQUFBcEQsTUFBQSxXQTZIOUMsR0FBSXNILEdBQVl6RCxLQUFLc0ksTUFDakJyRixFQUFRUSxFQUFVUixNQUFNbEMsZUFFeEJrUCxFQUFVN1AsRUFBRThQLE1BQU16TSxFQUFVMUQsTUFBTyxTQUFTNkgsR0FDL0MsTUFBZSxPQUFYQSxFQUFFVSxNQUNKVixFQUFFdUksWUFFRyxHQUVSbE4sR0FBTTRNLFVBQVlJLEVBQVFFLGVBdElvQjVRLElBQUEsYUFBQXBELE1BQUEsU0ErSTFDNEssRUFBUWxDLEdBQ1osR0FBSXBCLEdBQVl6RCxLQUFLc0ksTUFDakJyRixFQUFRUSxFQUFVUixNQUFNbEMsY0FDNUJmLE1BQUsrUCxpQkFDRixJQUFJSyxHQUFhL0osR0FBR2tILE1BQU04QyxTQUNyQkMsUUFBUSxFQUFHck4sRUFBTTRNLFlBQ2pCVSxPQUFPLFVBQVcsV0FDdkJ0TixHQUFNbU4sV0FBYUEsRUFDNUJySixFQUFPcUYsTUFBTSxhQUFjLG1CQUNoQmxILFFBQVF6QixFQUFVUyxPQUFPc00sY0FBZSxTQUFTM0wsR0FDOUMsTUFBT0EsS0FBTTVCLEVBQU13TixlQUV0QnpMLEtBQUssSUFBS2hGLEtBQUsyTyxVQUFValQsS0FBS21KLElBQzlCNEgsV0FBVywwQkFDWG9CLFNBQVMsS0FDVDdJLEtBQUssU0FBVSxTQUFTSCxHQUNyQixHQUFJNkwsR0FBSU4sRUFBV3ZMLEVBQUVzTCxZQUNyQixPQUFPTyxRQWhLK0JuUixJQUFBLGNBQUFwRCxNQUFBLFNBMEt6QzRLLEVBQVFsQyxHQUNiLEdBQUlwQixHQUFZekQsS0FBS3NJLE1BQ2pCckYsRUFBUVEsRUFBVVIsTUFBTWxDLGNBQ3pCZixNQUFLK1AsaUJBQ0wsSUFBSUssR0FBYS9KLEdBQUdrSCxNQUFNOEMsU0FDckJDLFFBQVEsRUFBR3JOLEVBQU00TSxZQUNqQlUsT0FBTyxVQUFXLFdBRWhDeEosR0FBTzBGLFdBQVcscUJBQ1BvQixTQUFTLEtBQ1Q4QyxVQUFVLFVBQVcsU0FBUzlMLEdBQzNCLE1BQU93QixJQUFHdUssa0JBQWtCLEVBQUUsS0FFakM1TCxLQUFLLFNBQVUsU0FBU0gsR0FDckIsR0FBSTZMLEdBQUlOLEVBQVd2TCxFQUFFc0wsWUFDckIsT0FBT08sS0FFVjFMLEtBQUssSUFBS2hGLEtBQUsyTyxVQUFValQsS0FBS21KLFFBM0xXOUQsR0FDekJuQixFQUFLQSxLQThMbEMsUUFDQ0EsS0FBT21CLE1Dak1WdEUsUUFBQUMsT0FBQSxtQkFBQSxnQkFBQSxvQkFBQSxpQkFDQXFHLFFBQUEsaUJBQUEsU0FBQUMsR0FDQUEsRUFBQUMsTUFBQSx3QkFDQUMsSUFBQSxZQUNBQyxZQUFBLEVBQ0FDLFNBQUEsd0NBRUFILE1BQUEsNkJBQ0FDLElBQUEsUUFDQUcsVUFBQSxnQkFFQUosTUFBQSxnQ0FDQUMsSUFBQSxnQkFDQUcsVUFBQSxxQmhCKy9EQSxJQUFJdEUsY0FBZSxXQUFjLFFBQVNDLEdBQWlCQyxFQUFRQyxHQUFTLElBQUssR0FBSUMsR0FBSSxFQUFHQSxFQUFJRCxFQUFNRSxPQUFRRCxJQUFLLENBQUUsR0FBSUUsR0FBYUgsRUFBTUMsRUFBSUUsR0FBV2pELFdBQWFpRCxFQUFXakQsYUFBYyxFQUFPaUQsRUFBVy9DLGNBQWUsRUFBVSxTQUFXK0MsS0FBWUEsRUFBV2hELFVBQVcsR0FBTUwsT0FBT3NELGVBQWVMLEVBQVFJLEVBQVdFLElBQUtGLElBQWlCLE1BQU8sVUFBVS9ELEVBQWFrRSxFQUFZQyxHQUFpSixNQUE5SEQsSUFBWVIsRUFBaUIxRCxFQUFZUyxVQUFXeUQsR0FBaUJDLEdBQWFULEVBQWlCMUQsRUFBYW1FLEdBQXFCbkUsS2lCdGdFaGlCbUIsU0FBUUMsT0FBTyxnQkFDVmdELFFBQVEsUUFBUztBQUFZLEdBQzFCQyxHQUQwQixXQVcvQixRQUFBQSxHQUFZc0osRUFBR0csRUFBR25KLEVBQUlPLEVBQU1rSSxHQUFRdE4sZ0JBQUE0RSxLQUFBTCxHQUNuQ0ssS0FBS2lKLEVBQUlBLEVBQ1RqSixLQUFLb0osRUFBSUEsRUFDVHBKLEtBQUswSSxPQUFTQSxFQUNkMUksS0FBS0MsR0FBS0EsRUFDVkQsS0FBS1EsS0FBT0EsRUFDWlIsS0FBSzBJLE9BQVNBLEVBQ2QxSSxLQUFLbUksV0FBWSxFQUNqQm5JLEtBQUsrRixPQUFTLEtBQ2QvRixLQUFLNlEsZ0JBQ0w3USxLQUFLc0ksTUFBUSxLQUNidEksS0FBSzBPLGFBQWMsRUF0QlcsTUFBQTNQLGNBQUFZLElBQUFKLElBQUEsYUFBQXBELE1BQUEsU0E4QnBCbU0sR0FDYyxHQUFwQnRJLEtBQUswTyxjQUNSMU8sS0FBSzBPLGFBQWMsRUFDbkIxTyxLQUFLc0ksTUFBUUEsTUFqQ2dCL0ksSUFBQSxhQUFBcEQsTUFBQSxTQTBDcEI2SyxFQUFRbkMsR0FDbEJtQyxFQUFPaEMsS0FBSyxZQUFhLFNBQVNILEdBQUcsTUFBTyxhQUFlQSxFQUFFb0UsRUFBSSxJQUFNcEUsRUFBRXVFLEVBQUksU0EzQy9DN0osSUFBQSxjQUFBcEQsTUFBQSxTQXFEbkI2SyxFQUFRbkMsT0FyRFd0RixJQUFBLFlBQUFwRCxNQUFBLFNBNkRyQnVNLEdBQ1QxSSxLQUFLMEksT0FBU0EsS0E5RGdCbkosSUFBQSxvQkFBQXBELE1BQUEsU0F1RWI0SixHQUNqQi9GLEtBQUttSSxXQUFZLEVBQ2pCbkksS0FBSzZRLGFBQWFwUSxLQUFLc0YsR0FDdkJBLEVBQU9HLFdBQVdsRyxLQUFLc0ksVUExRU8vSSxJQUFBLHNCQUFBcEQsTUFBQSxTQWtGWHNLLEdBQ25CLEdBQUlDLEdBQ0FvSyxFQUFXOVEsSUFFZDBHLEdBRDJCLGdCQUFqQkQsR0FDU0EsRUFFQUEsRUFBYUUsV0FFakN2RyxFQUFFMFEsRUFBU0QsY0FBY3hRLFFBQVEsU0FBUzBGLEVBQVFhLEdBQzdDYixFQUFPWSxhQUFlRCxJQUN6QlgsRUFBT0MsVUFDUDhLLEVBQVNELGFBQWFoSyxPQUFPRCxFQUFPLE1BR0QsSUFBakNrSyxFQUFTRCxhQUFhelIsU0FDekIwUixFQUFTM0ksV0FBWSxNQWpHUTVJLElBQUEsa0JBQUFwRCxNQUFBLFNBNEdmMkssRUFBT0UsRUFBUW5DLEdBQzlCekUsRUFBRUMsUUFBUUwsS0FBSzZRLGFBQWMsU0FBUzlLLEdBQ3JDQSxFQUFPZSxHQUFPRSxFQUFRbkMsU0E5R09sRixJQWtIaEMsUUFDQ0EsS0FBTUEsTUMxSFRsRCxRQUFBQyxPQUFBLGdCQUFBLGdCQUFBLG9CQUFBLGlCQUNBcUcsUUFBQSxpQkFBQSxTQUFBQyxHQUNBQSxFQUNBQyxNQUFBLHFCQUNBQyxJQUFBLFNBQ0FDLFlBQUEsRUFDQUMsU0FBQSwwQ2xCcXJFQSxJQUFJckUsY0FBZSxXQUFjLFFBQVNDLEdBQWlCQyxFQUFRQyxHQUFTLElBQUssR0FBSUMsR0FBSSxFQUFHQSxFQUFJRCxFQUFNRSxPQUFRRCxJQUFLLENBQUUsR0FBSUUsR0FBYUgsRUFBTUMsRUFBSUUsR0FBV2pELFdBQWFpRCxFQUFXakQsYUFBYyxFQUFPaUQsRUFBVy9DLGNBQWUsRUFBVSxTQUFXK0MsS0FBWUEsRUFBV2hELFVBQVcsR0FBTUwsT0FBT3NELGVBQWVMLEVBQVFJLEVBQVdFLElBQUtGLElBQWlCLE1BQU8sVUFBVS9ELEVBQWFrRSxFQUFZQyxHQUFpSixNQUE5SEQsSUFBWVIsRUFBaUIxRCxFQUFZUyxVQUFXeUQsR0FBaUJDLEdBQWFULEVBQWlCMUQsRUFBYW1FLEdBQXFCbkUsS21CM3JFaGlCbUIsU0FBUUMsT0FBTyxnQkFDVmdELFFBQVEsa0JBQW1CLE9BQVEsU0FBVUMsR0FBTSxHQUNoRG1CLEdBRGdELFNBQUFpUSxHQWVsRCxRQUFBalEsR0FBWW1JLEVBQUdHLEVBQUduSixFQUFJTyxFQUFNa0ksRUFBUTdHLEVBQVFGLEVBQzNDcVAsRUFBUUMsR0FBUTdWLGdCQUFBNEUsS0FBQWMsRUFBQSxJQUFBUSxHQUFBOUYsMkJBQUF3RSxNQUFBYyxFQUFBdEUsV0FBQVIsT0FBQXVGLGVBQUFULElBQUFwRixLQUFBc0UsS0FDUGlKLEVBQUdHLEVBQUduSixFQUFJTyxFQUFNa0ksR0FEVCxPQUVicEgsR0FBS08sT0FBU0EsRUFDZFAsRUFBS0ssVUFBWUEsRUFDSCxNQUFWcVAsRUFDSDFQLEVBQUswUCxPQUFTL0gsRUFFZDNILEVBQUswUCxPQUFTQSxFQUVELE1BQVZDLEVBQ0gzUCxFQUFLMlAsT0FBUzdILEVBRWQ5SCxFQUFLMlAsT0FBU0EsRUFaRjNQLEVBaEJpQyxNQUFBMUYsV0FBQWtGLEVBQUFpUSxHQUFBaFMsYUFBQStCLElBQUF2QixJQUFBLGNBQUFwRCxNQUFBLFNBc0N6QzZLLEVBQVFuQyxHQUNuQixHQUFJcEIsR0FBWXpELEtBQUtzSSxLQUNrQixPQUFuQzdFLEVBQVVTLE9BQU8wSSxnQkFDMkIsTUFBOUNuSixFQUFVK0ksV0FBV3RMLGdCQUFnQjJELEVBQUU1RSxLQUN4QytHLEVBQU85QixRQUFRekIsRUFBVVMsT0FBTzBJLGdCQUFnQixHQUVqRDVGLEVBQU95RixXQUFXLDBCQUNIb0IsU0FBUyxLQUNUOEMsVUFBVSxZQUFhLFNBQVM5TCxHQUM3QixHQUFnQixNQUFaQSxFQUFFbU0sUUFBOEIsTUFBWm5NLEVBQUVvTSxPQUFnQixDQUN0QyxHQUFJRCxHQUFTbk0sRUFBRW1NLE9BQ1hDLEVBQVNwTSxFQUFFb00sTUFHZixPQUZBcE0sR0FBRW1NLE9BQVNuTSxFQUFFb0UsRUFDYnBFLEVBQUVvTSxPQUFTcE0sRUFBRXVFLEVBQ04vQyxHQUFHdUssa0JBQWtCLGFBQWVJLEVBQVMsSUFBTUMsRUFBUyxJQUFLLGFBQWVwTSxFQUFFb0UsRUFBSSxJQUFNcEUsRUFBRXVFLEVBQUksS0FFN0csTUFBTy9DLElBQUd1SyxrQkFBa0IsYUFBZS9MLEVBQUVvRSxFQUFJLElBQU1wRSxFQUFFdUUsRUFBSSxJQUFLLGFBQWV2RSxFQUFFb0UsRUFBSSxJQUFNcEUsRUFBRXVFLEVBQUksV0F0RGpFdEksR0FDekJuQixFQUFLQSxLQTBEbEMsUUFDQ0EsS0FBTW1CLE1DaEVUckUsUUFBQUMsT0FBQSx3QkFBQSxnQkFBQSxvQkFBQSxpQkFDQXFHLFFBQUEsaUJBQUEsU0FBQUMsR0FDQUEsRUFBQUMsTUFBQSw2QkFDQUMsSUFBQSxpQkFDQUMsWUFBQSxFQUNBQyxTQUFBLHdDQUVBSCxNQUFBLGtDQUNBQyxJQUFBLFFBQ0FHLFVBQUEsdUJwQnV4RUEsSUFBSXRFLGNBQWUsV0FBYyxRQUFTQyxHQUFpQkMsRUFBUUMsR0FBUyxJQUFLLEdBQUlDLEdBQUksRUFBR0EsRUFBSUQsRUFBTUUsT0FBUUQsSUFBSyxDQUFFLEdBQUlFLEdBQWFILEVBQU1DLEVBQUlFLEdBQVdqRCxXQUFhaUQsRUFBV2pELGFBQWMsRUFBT2lELEVBQVcvQyxjQUFlLEVBQVUsU0FBVytDLEtBQVlBLEVBQVdoRCxVQUFXLEdBQU1MLE9BQU9zRCxlQUFlTCxFQUFRSSxFQUFXRSxJQUFLRixJQUFpQixNQUFPLFVBQVUvRCxFQUFha0UsRUFBWUMsR0FBaUosTUFBOUhELElBQVlSLEVBQWlCMUQsRUFBWVMsVUFBV3lELEdBQWlCQyxHQUFhVCxFQUFpQjFELEVBQWFtRSxHQUFxQm5FLE1BRTVoQndULEtBQU8sUUFBU0MsR0FBSUMsRUFBUUMsRUFBVUMsR0FBMkIsT0FBWEYsSUFBaUJBLEVBQVNHLFNBQVNwVCxVQUFXLElBQUlxVCxHQUFPcFQsT0FBT3FULHlCQUF5QkwsRUFBUUMsRUFBVyxJQUFhdk0sU0FBVDBNLEVBQW9CLENBQUUsR0FBSXZOLEdBQVM3RixPQUFPdUYsZUFBZXlOLEVBQVMsT0FBZSxRQUFYbk4sRUFBbUIsT0FBa0NrTixFQUFJbE4sRUFBUW9OLEVBQVVDLEdBQW9CLEdBQUksU0FBV0UsR0FBUSxNQUFPQSxHQUFLalQsS0FBZ0IsSUFBSW1ULEdBQVNGLEVBQUtMLEdBQUssSUFBZXJNLFNBQVg0TSxFQUE0QyxNQUFPQSxHQUFPNVQsS0FBS3dULEdxQjl4RTVkelMsU0FBUUMsT0FBTyxnQkFDVmdELFFBQVEsdUJBQXdCLFNBQVUsU0FBVW1FLEdBQVEsR0FFdERxTixHQUZzRCxTQUFBQyxHQU1yRCxRQUFBRCxLQUFjLE1BQUE5VixpQkFBQTRFLEtBQUFrUixHQUFBMVYsMkJBQUF3RSxNQUFBa1IsRUFBQTFVLFdBQUFSLE9BQUF1RixlQUFBMlAsSUFBQXhWLEtBQUFzRSxLQUNKLHdCQVAyQyxNQUFBcEUsV0FBQXNWLEVBQUFDLEdBQUFwUyxhQUFBbVMsSUFBQTNSLElBQUEsYUFBQXBELE1BQUEsU0FpQjFDbU0sR0FDUCxJQUFJdEksS0FBSzBPLFlBQVQsQ0FHQUksS0FBQW9DLEVBQUFuVixVQUFBUyxXQUFBUixPQUFBdUYsZUFBQTJQLEVBQUFuVixXQUFBLGFBQUFpRSxNQUFBdEUsS0FBQXNFLEtBQWlCc0ksRUFDakIsSUFBSXJGLEdBQVFxRixFQUFNckYsTUFBTWlPLHNCQUN4QmpPLEdBQU1tTyxnQkFDTixJQUFJbE4sR0FBU29FLEVBQU1wRSxPQUFPZ04sc0JBQzFCaE4sR0FBT3NNLGNBQWdCLFVBR3ZCLElBQUloSyxHQUFPOEIsRUFBTTlCLElBQ2pCQSxHQUFLNUIsR0FBRyxPQUFRLFNBQVNtSSxHQUN4QixHQUFJdEosR0FBWTZFLENBQ2hCLElBQTRDLE1BQXhDN0UsRUFBVVMsT0FBT2dOLG9CQUE2QixDQUNqRCxHQUFJVixHQUFnQi9NLEVBQVVTLE9BQU9nTixvQkFBb0JWLGNBQ3JEYSxFQUFZaEwsR0FBR2pCLFVBQVcsSUFBS29MLEVBRUksS0FBN0JhLEVBQVUsR0FBR2hQLFFBQVNyQyxRQUN0QnFSLEVBQVVuTSxRQUFRc0wsR0FBZSxHQUNqQ2EsRUFBWWhMLEdBQUdDLE9BQVF0RyxNQUN2QnFSLEVBQVVuTSxRQUFRc0wsR0FBZSxJQUdyQ2EsRUFBVXJNLEtBQUssWUFBYSxTQUFVSCxFQUFHMUYsR0FHckMsTUFGQTBGLEdBQUVvRSxHQUFLNUMsR0FBR1MsTUFBTWtHLEdBQ2hCbkksRUFBRXVFLEdBQUsvQyxHQUFHUyxNQUFNbUcsR0FDVCxjQUFpQnBJLEVBQUVvRSxFQUFFcEUsRUFBRXVFLEdBQU0sTUFFeEMzRixFQUFVcUUscUJBOUMrQnZJLElBQUEsZ0JBQUFwRCxNQUFBLFNBMER2Q2dLLEVBQVFoRyxHQUNsQixHQUFJc0QsR0FBWXpELEtBQUtzSSxNQUNqQnJGLEVBQVFRLEVBQVVSLE1BQU1pTyxvQkFDeEJoTixFQUFTVCxFQUFVUyxPQUFPZ04sbUJBRTlCL0ssR0FBT2pCLFFBQVFoQixFQUFPc00sZUFBZSxHQUNyQ3ZOLEVBQU1tTyxjQUFjM1EsS0FBS04sTUFoRXdCWixJQUFBLHVCQUFBcEQsTUFBQSxTQXlFaENnSyxFQUFRaEcsR0FDekIsR0FBSXNELEdBQVl6RCxLQUFLc0ksTUFDakJyRixFQUFRUSxFQUFVUixNQUFNaU8sb0JBQ3hCaE4sRUFBU1QsRUFBVVMsT0FBT2dOLG1CQUU5QnpOLEdBQVU0QixRQUFRc0MsT0FBTyxTQUFTMkosR0FDOUIsTUFBT0EsR0FBR3JSLEtBQU9FLEVBQVNGLEtBQzNCaUYsUUFBUWhCLEVBQU9zTSxlQUFlLEVBQ2pDLElBQUk1SixHQUFRM0QsRUFBTW1PLGNBQWMvTyxRQUFRbEMsRUFDeEM4QyxHQUFNbU8sY0FBY3ZLLE9BQU9ELEVBQU8sTUFsRmVySCxJQUFBLHlCQUFBcEQsTUFBQSxXQXlGakQsR0FBSXNILEdBQVl6RCxLQUFLc0ksTUFDakJyRixFQUFRUSxFQUFVUixNQUFNaU8sb0JBQ3hCaE4sRUFBU1QsRUFBVVMsT0FBT2dOLG1CQUU5QnpOLEdBQVU0QixRQUFRSCxRQUFRaEIsRUFBT3NNLGVBQWUsR0FDaER2TixFQUFNbU8sb0JBOUYyQzdSLElBQUEsWUFBQXBELE1BQUEsU0F3RzNDNkssRUFBUW5DLEdBQ2QsR0FBSXBCLEdBQVl6RCxLQUFLc0ksTUFDakJyRixFQUFRUSxFQUFVUixNQUFNaU8sbUJBQzVCN0ssSUFBR1MsTUFBTXlLLGtCQUNMbEwsR0FBR1MsTUFBTXNHLFFBQ0xuSyxFQUFNbU8sY0FBYy9PLFFBQVF3QyxHQUFLLEdBQ2pDN0UsS0FBS3dSLHFCQUFxQnhLLEVBQVFuQyxHQUVsQzdFLEtBQUt5UixjQUFjekssRUFBUW5DLEdBRVUsSUFBbEM1QixFQUFNbU8sY0FBYy9PLFFBQVF3QyxJQUduQzdFLEtBQUswUiw0QkFySHdDblMsSUFBQSxVQUFBcEQsTUFBQSxTQWdJN0M2SyxFQUFRbkMsR0FDWixHQUFJcEIsR0FBWXpELEtBQUtzSSxNQUNqQnJGLEVBQVFRLEVBQVVSLE1BQU1pTyxtQkFDdkI3SyxJQUFHUyxNQUFNc0csU0FJTm5LLEVBQU1tTyxjQUFjaFMsUUFBVSxHQUM5QlksS0FBS3dSLHFCQUFxQnhLLEVBQVFuQyxPQXhJT3FNLEdBRTFCck4sRUFBT0EsT0EySXRDLFFBQ0lBLE9BQVFxTixNQ2hKcEJ6VSxRQUFBQyxPQUFBLHFCQUFBLGdCQUFBLG9CQUFBLGlCQUNBcUcsUUFBQSxpQkFBQSxTQUFBQyxHQUNBQSxFQUNBQyxNQUFBLDBCQUNBQyxJQUFBLGNBQ0FDLFlBQUEsRUFDQUMsU0FBQSx3Q0FFQUgsTUFBQSwrQkFDQUMsSUFBQSxRQUNBRyxVQUFBLGtCQUVBSixNQUFBLHdDQUNBQyxJQUFBLFNBQ0FHLFVBQUEscUJDakJBNUcsUUFBQUMsT0FBQSxtQkFBQSxnQkFBQSxvQkFBQSxpQkFDQXFHLFFBQUEsaUJBQUEsU0FBQUMsR0FDQUEsRUFDQUMsTUFBQSx3QkFDQUMsSUFBQSxVQUNBQyxZQUFBLEVBQ0FDLFNBQUEsd0NBRUFILE1BQUEsZ0NBQ0FDLElBQUEsWUFDQXlPLFlBQUEsK0JBRUExTyxNQUFBLHFDQUNBQyxJQUFBLFFBQ0EwTyxXQUFBLEdBQ0FELFlBQUEsS0FFQTFPLE1BQUEscUNBQ0FDLElBQUEsUUFDQTBPLFdBQUEsR0FDQUQsWUFBQSxLQUVBMU8sTUFBQSx3Q0FDQUMsSUFBQSxXQUNBME8sV0FBQSxHQUNBRCxZQUFBLEtBRUExTyxNQUFBLHlDQUNBQyxJQUFBLFlBQ0EwTyxXQUFBLEdBQ0FELFlBQUEsS0FFQTFPLE1BQUEseUNBQ0FDLElBQUEsWUFDQUcsVUFBQSxtQkFFQUosTUFBQSx3Q0FDQUMsSUFBQSxXQUNBRyxVQUFBLG9CdkJtL0VBLElBQUl0RSxjQUFlLFdBQWMsUUFBU0MsR0FBaUJDLEVBQVFDLEdBQVMsSUFBSyxHQUFJQyxHQUFJLEVBQUdBLEVBQUlELEVBQU1FLE9BQVFELElBQUssQ0FBRSxHQUFJRSxHQUFhSCxFQUFNQyxFQUFJRSxHQUFXakQsV0FBYWlELEVBQVdqRCxhQUFjLEVBQU9pRCxFQUFXL0MsY0FBZSxFQUFVLFNBQVcrQyxLQUFZQSxFQUFXaEQsVUFBVyxHQUFNTCxPQUFPc0QsZUFBZUwsRUFBUUksRUFBV0UsSUFBS0YsSUFBaUIsTUFBTyxVQUFVL0QsRUFBYWtFLEVBQVlDLEdBQWlKLE1BQTlIRCxJQUFZUixFQUFpQjFELEVBQVlTLFVBQVd5RCxHQUFpQkMsR0FBYVQsRUFBaUIxRCxFQUFhbUUsR0FBcUJuRSxLd0J0aEZoaUJtQixTQUFRQyxPQUFPLGdCQUNWZ0QsUUFBUSx3QkFBeUIsU0FBVSxTQUFVbUUsR0FBUSxHQUN2RGdPLEdBRHVELFNBQUFWLEdBT3RELFFBQUFVLEdBQVlDLEdBQVExVyxnQkFBQTRFLEtBQUE2UixFQUFBLElBQUF2USxHQUFBOUYsMkJBQUF3RSxNQUFBNlIsRUFBQXJWLFdBQUFSLE9BQUF1RixlQUFBc1EsSUFBQW5XLEtBQUFzRSxLQUNWLHdCQURVLE9BRWhCc0IsR0FBS3dRLE9BQVNBLEVBRkV4USxFQVBrQyxNQUFBMUYsV0FBQWlXLEVBQUFWLEdBQUFwUyxhQUFBOFMsSUFBQXRTLElBQUEsZUFBQXBELE1BQUEsU0FvQnpDOEQsR0FDVCxHQUFJOFIsR0FBYS9SLEtBQ2JnUyxLQUNBQyxFQUFxQixRQUFyQkEsR0FBOEJoUyxFQUFJK1IsR0FFbEMsSUFBSyxHQURERSxHQUFVSCxFQUFXekosTUFBTWtFLFdBQVd0TCxnQkFBZ0JqQixHQUNqRGQsRUFBSSxFQUFHQSxFQUFJK1MsRUFBUTlTLE9BQVFELElBQUssQ0FDckMsR0FBSWdULEdBQVVELEVBQVEvUyxFQUN0QixJQUFJNFMsRUFBV3pKLE1BQU1rRSxXQUFXNEYsU0FBU0QsTUFBYSxFQUFNLENBQ3hELEdBQUlFLEdBQWFKLEVBQW1CRSxFQUFTSCxFQUM3Q0EsR0FBUU0sT0FBT0QsT0FFZkwsR0FBUXZSLEtBQUswUixJQUt6QixPQURBRixHQUFtQmhTLEVBQUkrUixHQUNoQkEsS0FwQzJDelMsSUFBQSxXQUFBcEQsTUFBQSxTQTRDN0NvVyxHQUNMLEdBQUlDLE1BQ0FDLEtBQ0FDLEVBQVdILEVBQUszUixPQUFPWCxHQUN2QjBTLEVBQVdKLEVBQUt0VCxPQUFPZ0IsRUFHdkJ1UyxHQURBeFMsS0FBS3NJLE1BQU1rRSxXQUFXNEYsU0FBU00sTUFBYyxFQUNoQzFTLEtBQUs0UyxhQUFhRixJQUVqQkEsR0FJZEQsRUFEQXpTLEtBQUtzSSxNQUFNa0UsV0FBVzRGLFNBQVNPLE1BQWMsRUFDaEMzUyxLQUFLNFMsYUFBYUQsSUFFakJBLEdBRWxCM1MsS0FBSzhSLE9BQU9lLEdBQUcsa0NBQ1ZDLFdBQVlKLEVBQVVLLFdBQVlKLEVBQy9CSCxXQUFZQSxFQUFZQyxXQUFZQSxPQS9ETWxULElBQUEsWUFBQXBELE1BQUEsU0FrRTVDNEssRUFBUWxDLEdBQ2Q3RSxLQUFLZ1QsU0FBU25PLE9BbkVvQ2dOLEdBQzFCaE8sRUFBT0EsT0FzRXZDLFFBQ0lBLE9BQVFnTyxNQ3pFcEJwVixRQUFBQyxPQUFBLDBCQUFBLGdCQUFBLG9CQUFBLGlCQUNBcUcsUUFBQSxpQkFBQSxTQUFBQyxHQUNBQSxFQUNBQyxNQUFBLCtCQUNBQyxJQUFBLG1CQUNBQyxZQUFBLEVBQ0FDLFNBQUEsd0NBRUFILE1BQUEsb0NBQ0FDLElBQUEsUUFDQUcsVUFBQSx3QnpCcW9GQSxJQUFJdEUsY0FBZSxXQUFjLFFBQVNDLEdBQWlCQyxFQUFRQyxHQUFTLElBQUssR0FBSUMsR0FBSSxFQUFHQSxFQUFJRCxFQUFNRSxPQUFRRCxJQUFLLENBQUUsR0FBSUUsR0FBYUgsRUFBTUMsRUFBSUUsR0FBV2pELFdBQWFpRCxFQUFXakQsYUFBYyxFQUFPaUQsRUFBVy9DLGNBQWUsRUFBVSxTQUFXK0MsS0FBWUEsRUFBV2hELFVBQVcsR0FBTUwsT0FBT3NELGVBQWVMLEVBQVFJLEVBQVdFLElBQUtGLElBQWlCLE1BQU8sVUFBVS9ELEVBQWFrRSxFQUFZQyxHQUFpSixNQUE5SEQsSUFBWVIsRUFBaUIxRCxFQUFZUyxVQUFXeUQsR0FBaUJDLEdBQWFULEVBQWlCMUQsRUFBYW1FLEdBQXFCbkUsSzBCN25GaGlCbUIsU0FBUUMsT0FBTyxnQkFDVmdELFFBQVEsVUFBVyxXQUFZLEdBQ3RCbUUsR0FEc0IsV0FPeEIsUUFBQUEsR0FBWThDLEdBQVl2TCxnQkFBQTRFLEtBQUE2RCxHQUNwQjdELEtBQUsyRyxXQUFhQSxFQUNsQjNHLEtBQUtzSSxNQUFRLEtBQ2J0SSxLQUFLME8sYUFBYyxFQVZDLE1BQUEzUCxjQUFBOEUsSUFBQXRFLElBQUEsYUFBQXBELE1BQUEsU0FtQmJtTSxHQUNIdEksS0FBSzBPLGNBR1QxTyxLQUFLME8sYUFBYyxFQUNuQjFPLEtBQUtzSSxNQUFRQSxNQXhCTy9JLElBQUEsWUFBQXBELE1BQUEsU0FrQ2I4VyxFQUFPcE8sT0FsQ010RixJQUFBLFdBQUFwRCxNQUFBLFNBbUNmOFcsRUFBT3BPLE9BbkNRdEYsSUFBQSxjQUFBcEQsTUFBQSxTQW9DWjhXLEVBQU9wTyxPQXBDS3RGLElBQUEsV0FBQXBELE1BQUEsU0FxQ2Y4VyxFQUFPcE8sT0FyQ1F0RixJQUFBLFlBQUFwRCxNQUFBLFNBc0NkOFcsRUFBT3BPLE9BdENPdEYsSUFBQSxVQUFBcEQsTUFBQSxTQXVDaEI4VyxFQUFPcE8sT0F2Q1N0RixJQUFBLFVBQUFwRCxNQUFBLGdCQUFBMEgsSUFnRDNCLFFBQ0dBLE9BQVFBLE1DckVwQnBILFFBQUFDLE9BQUEsd0JBQUEsZ0JBQUEsb0JBQUEsZUFDQSxpQkFDQXFHLFFBQUEsaUJBQUEsU0FBQUMsR0FDQUEsRUFBQUMsTUFBQSw2QkFDQUMsSUFBQSxpQkFDQUMsWUFBQSxFQUNBQyxTQUFBLDJDQ0pBM0csUUFBUUMsT0FBTyxnQkFDVmdELFFBQVEsaUJBQWtCLFNBQVMsYUFBYyx1QkFDOUMsc0JBQXVCLHNCQUF1QixzQkFDOUMsa0JBQ0ksU0FBVW1FLEVBQVFxUCxFQUFZckIsRUFDbEJYLEVBQXNCaUMsRUFDdEJDLEVBQXFCQyxHQUU3QixPQUNJeFAsT0FBUUEsRUFBT0EsT0FDZnFQLFdBQVlBLEVBQVdyUCxPQUN2QmdPLHFCQUFzQkEsRUFBcUJoTyxPQUMzQ3FOLG9CQUFxQkEsRUFBb0JyTixPQUN6Q3NQLG9CQUFxQkEsRUFBb0J0UCxPQUN6Q3VQLG9CQUFxQkEsRUFBb0J2UCxPQUN6Q3dQLGdCQUFpQkEsRUFBZ0J4UCxXQ2hCckRwSCxRQUFBQyxPQUFBLGtCQUFBLGdCQUFBLG9CQUFBLGlCQUNBcUcsUUFBQSxpQkFBQSxTQUFBQyxHQUNBQSxFQUNBQyxNQUFBLHVCQUNBQyxJQUFBLFdBQ0FDLFlBQUEsRUFDQUMsU0FBQSx3Q0FFQUgsTUFBQSw0QkFDQUMsSUFBQSxRQUNBRyxVQUFBLGVBRUFKLE1BQUEsK0JBQ0FDLElBQUEsZ0JBQ0FHLFVBQUEsb0I3QjZ4RkEsSUFBSXRFLGNBQWUsV0FBYyxRQUFTQyxHQUFpQkMsRUFBUUMsR0FBUyxJQUFLLEdBQUlDLEdBQUksRUFBR0EsRUFBSUQsRUFBTUUsT0FBUUQsSUFBSyxDQUFFLEdBQUlFLEdBQWFILEVBQU1DLEVBQUlFLEdBQVdqRCxXQUFhaUQsRUFBV2pELGFBQWMsRUFBT2lELEVBQVcvQyxjQUFlLEVBQVUsU0FBVytDLEtBQVlBLEVBQVdoRCxVQUFXLEdBQU1MLE9BQU9zRCxlQUFlTCxFQUFRSSxFQUFXRSxJQUFLRixJQUFpQixNQUFPLFVBQVUvRCxFQUFha0UsRUFBWUMsR0FBaUosTUFBOUhELElBQVlSLEVBQWlCMUQsRUFBWVMsVUFBV3lELEdBQWlCQyxHQUFhVCxFQUFpQjFELEVBQWFtRSxHQUFxQm5FLE1BRTVoQndULEtBQU8sUUFBU0MsR0FBSUMsRUFBUUMsRUFBVUMsR0FBMkIsT0FBWEYsSUFBaUJBLEVBQVNHLFNBQVNwVCxVQUFXLElBQUlxVCxHQUFPcFQsT0FBT3FULHlCQUF5QkwsRUFBUUMsRUFBVyxJQUFhdk0sU0FBVDBNLEVBQW9CLENBQUUsR0FBSXZOLEdBQVM3RixPQUFPdUYsZUFBZXlOLEVBQVMsT0FBZSxRQUFYbk4sRUFBbUIsT0FBa0NrTixFQUFJbE4sRUFBUW9OLEVBQVVDLEdBQW9CLEdBQUksU0FBV0UsR0FBUSxNQUFPQSxHQUFLalQsS0FBZ0IsSUFBSW1ULEdBQVNGLEVBQUtMLEdBQUssSUFBZXJNLFNBQVg0TSxFQUE0QyxNQUFPQSxHQUFPNVQsS0FBS3dULEc4QjF5RjVkelMsU0FBUUMsT0FBTyxnQkFDVmdELFFBQVEsY0FBZSxTQUFVLFNBQVVtRSxHQUFRLEdBQzFDcVAsR0FEMEMsU0FBQS9CLEdBSzVDLFFBQUErQixLQUFjLE1BQUE5WCxpQkFBQTRFLEtBQUFrVCxHQUFBMVgsMkJBQUF3RSxNQUFBa1QsRUFBQTFXLFdBQUFSLE9BQUF1RixlQUFBMlIsSUFBQXhYLEtBQUFzRSxLQUNKLGVBTmtDLE1BQUFwRSxXQUFBc1gsRUFBQS9CLEdBQUFwUyxhQUFBbVUsSUFBQTNULElBQUEsYUFBQXBELE1BQUEsU0FrQmpDbU0sR0FDUCxJQUFJdEksS0FBSzBPLFlBQVQsQ0FHQUksS0FBQW9FLEVBQUFuWCxVQUFBUyxXQUFBUixPQUFBdUYsZUFBQTJSLEVBQUFuWCxXQUFBLGFBQUFpRSxNQUFBdEUsS0FBQXNFLEtBQWlCc0ksRUFFakIsSUFBSXlKLEdBQWEvUixLQUNiaUQsRUFBUXFGLEVBQU1yRixNQUFNaVEsYUFFeEJqUSxHQUFNcVEsV0FBWSxFQUVsQmhMLEVBQU1wRSxPQUFPZ1AsY0FJYnJOLEVBQUUsd0JBQXdCME4sUUFBUSxTQUFTeEosR0FDdkM5RyxFQUFNc1EsU0FBVSxHQUtwQixJQUFJQyxHQUFzQmxMLEVBQU0yRCxjQUNoQzNELEdBQU0yRCxlQUFpQixTQUFTNUQsR0FDNUJtTCxFQUFvQjlYLEtBQUs0TSxFQUFPRCxHQUNoQzBKLEVBQVc5RixlQUFlNUQsR0FHOUIsSUFBSW9MLEdBQXNCbkwsRUFBTStELGNBQ2hDL0QsR0FBTStELGVBQWlCLFNBQVNwRSxHQUM1QndMLEVBQW9CL1gsS0FBSzRNLEVBQU9MLEdBQ2hDOEosRUFBVzFGLGVBQWVwRSxRQWhEVTFJLElBQUEsVUFBQXBELE1BQUEsV0EyRHhDMEosRUFBRSxnQkFBZ0JrRyxZQTNEc0J4TSxJQUFBLFlBQUFwRCxNQUFBLFNBb0VsQzhXLEVBQU9wTyxHQUNiLEdBQUlwQixHQUFZekQsS0FBS3NJLE1BQ2pCckYsRUFBUVEsRUFBVVIsTUFBTWlRLFVBQzVCalEsR0FBTXFRLFdBQVksS0F2RXNCL1QsSUFBQSxVQUFBcEQsTUFBQSxTQWdGcEM4VyxFQUFPcE8sR0FDWCxHQUFJcEIsR0FBWXpELEtBQUtzSSxNQUNqQnJGLEVBQVFRLEVBQVVSLE1BQU1pUSxVQUM1QmpRLEdBQU1xUSxXQUFZLEtBbkZzQi9ULElBQUEsb0JBQUFwRCxNQUFBLFNBc0YxQnVPLEdBQ2QsR0FBSXFILEdBQWEvUixLQUNiMFQsRUFBVyxHQUNmNU4sUUFBTzZOLFdBQVcsV0FDVSxNQUFwQjlOLEVBQUVrSSxVQUFVNkYsS0FDWmxKLElBRUE1RSxPQUFPNk4sV0FBVzVCLEVBQVc4QixrQkFBa0JuSixHQUFXZ0osSUFFL0RBLE1BL0ZxQ25VLElBQUEsaUJBQUFwRCxNQUFBLFNBeUc3QmtNLEdBSVgsUUFBU3lMLEtBRUx6TCxFQUFTakMsS0FBSyxTQUFTdkIsR0FDbkIsR0FFSXJFLEdBRkFzUSxFQUFXOVEsSUFLZixJQUFrRCxNQUE5Q3lELEVBQVUrSSxXQUFXdEwsZ0JBQWdCMkQsRUFBRTVFLElBQWEsQ0FDcERPLEVBQU8sMkJBQ1AsSUFBSXVULEdBQWN0USxFQUFVK0ksV0FBV25MLFVBQVV3RCxFQUFFNUUsSUFDL0MrVCxHQUFVLENBQ2QsS0FBSyxHQUFJelUsS0FBT3dVLEdBQ1pDLEdBQVUsRUFDVnhULEdBQVFqQixFQUFNLFNBQVV3VSxFQUFZeFUsR0FBTyxVQUUzQ3lVLE1BQVksSUFFWnhULEVBQU8sc0JBR1IsQ0FDSEEsRUFBTyx3QkFDUCxJQUFJeVQsR0FBWXhRLEVBQVUrSSxXQUFXcEwsT0FBT3lELEVBQUU1RSxJQUMxQytULEdBQVUsQ0FDZCxLQUFLLEdBQUl6VSxLQUFPMFUsR0FDWkQsR0FBVSxFQUNWeFQsR0FBUWpCLEVBQU0sU0FBVTBVLEVBQVUxVSxHQUFPLFVBRXpDeVUsTUFBWSxJQUVaeFQsRUFBTyxlQUlmQSxFQUFPQSxFQUFLMFQsTUFBTSxFQUFHLElBRXJCck8sRUFBRWlMLEdBQVU4QyxNQUNSTyxTQUNJL00sTUFBT3ZDLEVBQUU1RSxHQUNUTyxLQUFNQSxHQUVWNFQsUUFDSUMsS0FBTSxXQUNGLEdBQUlDLEdBQU16TyxFQUFFaUwsR0FBVThDLEtBQUssT0FDdkIxSixFQUFTckUsRUFBRSxtQkFBbUJxRSxTQUM5QnFLLEdBQVlySyxFQUFPc0ssTUFBUzNQLEVBQUVvRSxFQUFJeEYsRUFBVXlELFFBQVFxRyxRQUFXOUosRUFBVXlELFFBQVFvRyxZQUFZLElBQ3pGcEQsRUFBT2lFLEtBQVF0SixFQUFFdUUsRUFBR3ZFLEVBQUU2RCxRQUFVakYsRUFBVXlELFFBQVFxRyxRQUFZOUosRUFBVXlELFFBQVFvRyxZQUFZLEdBRXBHLE9BREFnSCxHQUFJRyxJQUFJLGtCQUFtQkYsSUFDbkJ0UixFQUFNcVEsWUFHdEJlLE1BQ0l6RyxNQUFPLEVBQ1A4RyxLQUFNN08sRUFBRSx5QkFFWnVHLE9BQ0l1SSxRQUFTLHlCQUViSixVQUNJN0UsR0FBSSxhQUNKQyxHQUFJLGlCQUdSaUYsTUFDSTlOLE1BQU8sNEJBcEV2QixHQUFJckQsR0FBWXpELEtBQUtzSSxNQUNqQnJGLEVBQVFRLEVBQVVSLE1BQU1pUSxVQXlFSnhRLFNBQXBCbUQsRUFBRWtJLFVBQVU2RixLQUNaRSxJQUVBOVQsS0FBSzZULGtCQUFrQkMsTUF2TGF2VSxJQUFBLGlCQUFBcEQsTUFBQSxTQWtNN0I4TCxHQUNYLEdBQUl4RSxHQUFZekQsS0FBS3NJLE1BQ2pCckYsRUFBUVEsRUFBVVIsTUFBTWlRLFVBR0p4USxTQUFwQm1ELEVBQUVrSSxVQUFVNkYsTUFFWjNMLEVBQVM3QixLQUFLLFNBQVN2QixHQUNuQixHQUFJZ0ssR0FBVzdPLEtBRVg2VSxFQUFXeE8sR0FBR0MsT0FBT3RHLE1BQU0wQixPQUUzQm9ULEdBRFdELEVBQU9FLGlCQUFpQkYsRUFBT0csaUJBQWlCLEdBQy9DblEsRUFBRW9RLGNBQ2R6VSxFQUFPLFVBQVlxRSxFQUFFc0wsV0FDekJ0SyxHQUFFZ0osR0FBVStFLE1BQ1JPLFNBQ0kzVCxLQUFNQSxHQUVWNFQsUUFDSUMsS0FBTSxXQUVGLE9BQVFwUixFQUFNcVEsWUFHdEJlLE1BQ0l6RyxNQUFPLEVBQ1A4RyxLQUFNN08sRUFBRSxvQkFFWnVHLE9BQ0l1SSxRQUFTLHlCQUViSixVQUNJN0UsR0FBSW9GLEVBQVVwRixHQUNkQyxHQUFJLGdCQUNKMVEsT0FBUSxRQUNSMlEsT0FBUWtGLEVBQVVsRixRQUV0QmdGLE1BQ0k5TixNQUFPLGdDQXhPaUJvTSxHQUN2QnJQLEVBQU9BLE9BZ1BoQyxRQUNJQSxPQUFRcVAsTUN2UHBCelcsUUFBQUMsT0FBQSxhQUNBLFlBQ0EsZUFDQSxjQUNBLG1CQUNBLDJCQUNBLGtCQUNBLHlCQUNBLHlCQUNBLG9CQUNBLGlCQUNBLGVBQ0EsdUJBQ0Esa0JBQ0EseUJBRUFxRyxRQUFBLGlCQUFBLHFCQUFBLFNBQUFDLEVBQUFrUyxHQUNBbFMsRUFDQUMsTUFBQSxVQUNBQyxJQUFBLEdBQ0FDLFlBQUEsRUFDQUMsU0FBQSw4Q0FFQThSLEVBQUFDLFVBQUEsUUN0QkExWSxRQUFBQyxPQUFBLGdCQUNBcUcsUUFBQSxpQkFBQSxTQUFBQyxHQUNBQSxFQUNBQyxNQUFBLGdCQUNBQyxJQUFBLElBQ0F5TyxZQUFBLG1CQUNBQyxXQUFBLDhCQUdBQSxXQUFBLGFBQUEsU0FBQSxvQkFDQSxTQUFBRSxFQUFBc0QsR0FFQSxRQUFBQyxLQUNBdkQsRUFBQWUsR0FBQSx5QkFBQXlDLFNBQUFDLEVBQUFELFdBRUEsUUFBQUUsS0FDQUgsSUFMQSxHQUFBRSxHQUFBdlYsSUFPQW9WLEdBQUFLLFdBQUFGLEdBQ0FILEVBQUFNLGdCQUFBSCxHQUNBQSxFQUFBQyxNQUFBQSxLQ3BCQS9ZLFFBQUFDLE9BQUEsZUFDQXFHLFFBQUEsaUJBQUEsU0FBQUMsR0FDQUEsRUFDQUMsTUFBQSxlQUNBQyxJQUFBLEtBQ0F5TyxZQUFBLGlCQUNBQyxXQUFBLHVCQUNBK0QsUUFBQUwsU0FBQSxXQUdBMUQsV0FBQSxZQUFBLFNBQUEsZUFBQSxTQUFBRSxFQUFBOEQsR0FFQSxRQUFBQyxLQUNBL0QsRUFBQWUsR0FBQSxnQkFGQSxHQUFBaUQsR0FBQTlWLElBSUE4VixHQUFBUixTQUFBTSxFQUFBTixTQUNBUSxFQUFBRCxPQUFBQSxJakN1b0dBLElBQUk5VyxjQUFlLFdBQWMsUUFBU0MsR0FBaUJDLEVBQVFDLEdBQVMsSUFBSyxHQUFJQyxHQUFJLEVBQUdBLEVBQUlELEVBQU1FLE9BQVFELElBQUssQ0FBRSxHQUFJRSxHQUFhSCxFQUFNQyxFQUFJRSxHQUFXakQsV0FBYWlELEVBQVdqRCxhQUFjLEVBQU9pRCxFQUFXL0MsY0FBZSxFQUFVLFNBQVcrQyxLQUFZQSxFQUFXaEQsVUFBVyxHQUFNTCxPQUFPc0QsZUFBZUwsRUFBUUksRUFBV0UsSUFBS0YsSUFBaUIsTUFBTyxVQUFVL0QsRUFBYWtFLEVBQVlDLEdBQWlKLE1BQTlIRCxJQUFZUixFQUFpQjFELEVBQVlTLFVBQVd5RCxHQUFpQkMsR0FBYVQsRUFBaUIxRCxFQUFhbUUsR0FBcUJuRSxLa0M5b0doaUJtQixTQUFRQyxPQUFPLGdCQUNWZ0QsUUFBUSxtQkFBb0IsU0FBVSxTQUFVbUUsR0FBUSxHQUNsRHdQLEdBRGtELFNBQUFsQyxHQVV2RCxRQUFBa0MsR0FBWTBDLEdBQVkzYSxnQkFBQTRFLEtBQUFxVCxFQUFBLElBQUEvUixHQUFBOUYsMkJBQUF3RSxNQUFBcVQsRUFBQTdXLFdBQUFSLE9BQUF1RixlQUFBOFIsSUFBQTNYLEtBQUFzRSxLQUNqQixtQkFEaUIsT0FFdkJzQixHQUFLeVUsV0FBYUEsRUFGS3pVLEVBVitCLE1BQUExRixXQUFBeVgsRUFBQWxDLEdBQUFwUyxhQUFBc1UsSUFBQTlULElBQUEsYUFBQXBELE1BQUEsU0F1QjVDbU0sR0FDVnRJLEtBQUtzSSxNQUFRQSxDQUNiLElBQUl5SixHQUFhL1IsSUFDakJzSSxHQUFNdEMsUUFBVSxXQUNmK0wsRUFBV2lFLGFBQWF0YSxLQUFLNE0sRUFBT3lKLEVBQVdnRSxhQUdoRHpOLEVBQU0yTixLQUFPLFNBQVNGLEdBQ3JCaEUsRUFBV21FLFVBQVV4YSxLQUFLNE0sRUFBT3lOLE9BL0JvQnhXLElBQUEsZUFBQXBELE1BQUEsU0EwQzFDNFosR0FDSCxHQUFJdFMsR0FBWXpELElBQ2ZJLEdBQUVxRCxFQUFVQyxxQkFBcUJyRCxRQUFRLFNBQVMwRixHQUMvQ0EsRUFBT0MsUUFBUStQLEtBRW5CM1YsRUFBRXFELEVBQVVFLHFCQUFxQnRELFFBQVEsU0FBUzBGLEdBQzlDQSxFQUFPQyxRQUFRK1AsSUFFbkIsS0FBSyxHQUFJeFcsS0FBT2tFLEdBQVVrQyxTQUN0QkUsRUFBRUMsUUFBUUcsSUFBSTFHLEVBQUtrRSxFQUFVa0MsU0FBU3BHLE9BbkRHQSxJQUFBLFlBQUFwRCxNQUFBLFNBNkR2QzRaLEdBQ1QsR0FBSXRTLEdBQVl6RCxJQUNaSSxHQUFFcUQsRUFBVUMscUJBQXFCckQsUUFBUSxTQUFTMEYsR0FDOUIsTUFBZkEsRUFBT2tRLE1BQ1JsUSxFQUFPa1EsS0FBS0YsS0FHakIzVixFQUFFcUQsRUFBVUUscUJBQXFCdEQsUUFBUSxTQUFTMEYsR0FDN0IsTUFBZkEsRUFBT2tRLE1BQ1JsUSxFQUFPa1EsS0FBS0YsU0F0RTRCMUMsR0FDMUJ4UCxFQUFPQSxPQTBFckMsUUFDQ0EsT0FBUXdQLE1DdEZkNVcsUUFBQUMsT0FBQSwwQkFDQXlaLFVBQUEsZUFBQSxXQUNBLE9BQ0FDLFNBQUEsSUFDQUMsT0FDQUMsZ0JBQUEsSUFDQUMsS0FBQSxLQUVBMVYsS0FBQSxTQUFBd1YsR0FDQSxHQUFBLElBQUFBLEVBQUFDLGdCQUFBRSxVQUFBLENBQ0EsR0FBQUMsR0FBQUosRUFBQUMsZ0JBQUFFLFVBQUFsUCxNQUFBLElBQ0ErTyxHQUFBQyxnQkFBQUksZ0JBQUFDLE9BQUFGLEVBQUEsSUFDQUosRUFBQUMsZ0JBQUFNLGNBQUFILEVBQUEsS0FHQTlFLFlBQUEscUNDZkFsVixRQUFBQyxPQUFBLDBCQUNBcUcsUUFBQSxpQkFBQSxTQUFBQyxHQUNBQSxFQUNBQyxNQUFBLG9DQUNBQyxJQUFBLFFBQ0FDLFlBQUEsRUFDQXlPLFdBQUEscURBQ0FELFlBQUEsOENBRUExTyxNQUFBLGdEQUNBQyxJQUFBLGVBQ0FFLFNBQUEsUUFHQXdPLFdBQUEsMkJBQUEsU0FBQSxTQUFBRSxHQUVBLFFBQUErRSxLQUNBL0UsRUFBQWdGLFNBQUFoVixTQUFBLCtDQUNBZ1EsRUFBQWUsR0FBQSxnREFFQWYsRUFBQWdGLFNBQUFoVixTQUFBLCtDQUNBZ1EsRUFBQWUsR0FBQSxnREFOQSxHQUFBa0UsR0FBQS9XLElBU0ErVyxHQUFBRixvQkFBQUEsSXBDMnlHQSxJQUFJOVgsY0FBZSxXQUFjLFFBQVNDLEdBQWlCQyxFQUFRQyxHQUFTLElBQUssR0FBSUMsR0FBSSxFQUFHQSxFQUFJRCxFQUFNRSxPQUFRRCxJQUFLLENBQUUsR0FBSUUsR0FBYUgsRUFBTUMsRUFBSUUsR0FBV2pELFdBQWFpRCxFQUFXakQsYUFBYyxFQUFPaUQsRUFBVy9DLGNBQWUsRUFBVSxTQUFXK0MsS0FBWUEsRUFBV2hELFVBQVcsR0FBTUwsT0FBT3NELGVBQWVMLEVBQVFJLEVBQVdFLElBQUtGLElBQWlCLE1BQU8sVUFBVS9ELEVBQWFrRSxFQUFZQyxHQUFpSixNQUE5SEQsSUFBWVIsRUFBaUIxRCxFQUFZUyxVQUFXeUQsR0FBaUJDLEdBQWFULEVBQWlCMUQsRUFBYW1FLEdBQXFCbkUsTUFFNWhCd1QsS0FBTyxRQUFTQyxHQUFJQyxFQUFRQyxFQUFVQyxHQUEyQixPQUFYRixJQUFpQkEsRUFBU0csU0FBU3BULFVBQVcsSUFBSXFULEdBQU9wVCxPQUFPcVQseUJBQXlCTCxFQUFRQyxFQUFXLElBQWF2TSxTQUFUME0sRUFBb0IsQ0FBRSxHQUFJdk4sR0FBUzdGLE9BQU91RixlQUFleU4sRUFBUyxPQUFlLFFBQVhuTixFQUFtQixPQUFrQ2tOLEVBQUlsTixFQUFRb04sRUFBVUMsR0FBb0IsR0FBSSxTQUFXRSxHQUFRLE1BQU9BLEdBQUtqVCxLQUFnQixJQUFJbVQsR0FBU0YsRUFBS0wsR0FBSyxJQUFlck0sU0FBWDRNLEVBQTRDLE1BQU9BLEdBQU81VCxLQUFLd1QsR3FDajBHNWR6UyxTQUFRQyxPQUFPLGdCQUNWZ0QsUUFBUSx1QkFBd0Isc0JBQXVCLGlCQUN0RCxTQUFVd1IsRUFBcUJwUSxHQUFnQixHQUM3Q3FTLEdBRDZDLFNBQUE2RCxHQUt6QyxRQUFBN0QsS0FBYy9YLGdCQUFBNEUsS0FBQW1ULEVBQUEsSUFBQTdSLEdBQUE5RiwyQkFBQXdFLE1BQUFtVCxFQUFBM1csV0FBQVIsT0FBQXVGLGVBQUE0UixJQUFBelgsS0FBQXNFLE1BQUEsT0FFVnNCLEdBQUtxRixXQUFhLHNCQUZSckYsRUFMMkIsTUFBQTFGLFdBQUF1WCxFQUFBNkQsR0FBQWpZLGFBQUFvVSxJQUFBNVQsSUFBQSxhQUFBcEQsTUFBQSxTQWU5Qm1NLEdBQ1AsSUFBSXRJLEtBQUswTyxZQUFULENBR0FJLEtBQUFxRSxFQUFBcFgsVUFBQVMsV0FBQVIsT0FBQXVGLGVBQUE0UixFQUFBcFgsV0FBQSxhQUFBaUUsTUFBQXRFLEtBQUFzRSxLQUFpQnNJLEVBQ2pCLElBQUlyRixHQUFRcUYsRUFBTXJGLE1BQU1rUSxzQkFDeEJsUSxHQUFNZ1Usa0JBckIrQjFYLElBQUEsV0FBQXBELE1BQUEsU0E4QmhDNkssRUFBUW5DLEdBQ2IsR0FBSXBCLEdBQVl6RCxLQUFLc0ksTUFDakI0TyxFQUFhelQsRUFBVVIsTUFBTWtRLG1CQUU1QjlNLElBQUdTLE1BQU1zRyxVQUNOOEosRUFBVzlGLGNBQWMvTyxRQUFRd0MsR0FBSyxHQUN0QzdFLEtBQUttWCxtQkFBbUJELEVBQVc5RixnQkFFbkNwUixLQUFLMFIseUJBQ0wxUixLQUFLb1gsVUFBVXZTLFFBdkNjdEYsSUFBQSxjQUFBcEQsTUFBQSxTQWtEN0I2SyxFQUFRbkMsR0FDaEIsR0FBSXBCLEdBQVl6RCxLQUFLc0ksTUFDakI0TyxFQUFhelQsRUFBVVIsTUFBTWlPLG1CQUVqQyxJQURBN0ssR0FBR1MsTUFBTXVRLGtCQUNKaFIsR0FBR1MsTUFBTXNHLFFBQVMsQ0FHbkIsR0FBSWdFLEdBQWdCOEYsRUFBVzlGLGFBQy9CLElBQUlBLEVBQWMvTyxRQUFRd0MsR0FBSyxHQUMzQixJQUFLLEdBQUkxRixHQUFJLEVBQUdBLEVBQUlpUyxFQUFjaFMsT0FBUUQsSUFDdENhLEtBQUtzWCxTQUFTbEcsRUFBY2pTLFFBS2hDYSxNQUFLMFIseUJBQ0wxUixLQUFLc1gsU0FBU3pTLE9BbEVldEYsSUFBQSxjQUFBcEQsTUFBQSxTQStFN0J1RixHQUNSLEdBQUkrQixHQUFZekQsS0FBS3NJLE1BQ2pCckYsRUFBUVEsRUFBVVIsTUFBTWtRLG9CQUN4QmpULEVBQU93QixFQUFLekIsR0FDWmlCLEVBQWtCdUMsRUFBVStJLFdBQVd0TCxlQUUzQyxJQUE4QndCLFNBQTFCeEIsRUFBZ0JoQixLQUF1QkUsRUFBRXdCLFFBQVFWLEVBQWdCaEIsSUFBckUsQ0FLQXVELEVBQVUzRCxNQUFRTSxFQUFFdUgsT0FBT2xFLEVBQVUzRCxNQUFPLFNBQVN5WCxHQUNqRCxNQUFPQSxJQUFjN1YsSUFHekIrQixFQUFVc0UsbUJBQW1CckcsRUFJN0IsS0FBSyxHQUREME0sTUFDS2pQLEVBQUksRUFBR0EsRUFBSXNFLEVBQVUzRCxNQUFNVixPQUFRRCxJQUN4Q2lQLEVBQWUzTixLQUFLZ0QsRUFBVTNELE1BQU1YLEdBQUdjLEdBSzNDLEtBQUssR0FERHVYLE1BQ0tyWSxFQUFJLEVBQUdBLEVBQUkrQixFQUFnQmhCLEdBQU1kLE9BQVFELElBQzlDaVAsRUFBZTNOLEtBQUtTLEVBQWdCaEIsR0FBTWYsSUFDMUNxWSxFQUFVL1csS0FBS1MsRUFBZ0JoQixHQUFNZixHQUV6QyxJQUFJa1AsR0FBVTVLLEVBQVUrSSxXQUFXeEssa0JBQWtCb00sR0FHakRxSixFQUFPL1YsRUFBS3VILEVBQ1p5TyxFQUFPaFcsRUFBSzBILEVBQ1p6SCxFQUFZRCxFQUFLQyxVQUFVdVMsT0FFL0J2UyxHQUFVa0YsT0FBTyxFQUFHLEVBQUduRixFQUFLekIsR0FLNUIsS0FBSyxHQUpENEIsR0FBU0gsRUFBS3pCLEdBQ2QwWCxLQUNBalAsRUFBU2hILEVBQUtnSCxPQUFTakYsRUFBVVMsT0FBT3lJLFlBQ3hDeE0sRUFBV2tPLEVBQVFsTyxTQUNkaEIsRUFBSSxFQUFHQSxFQUFJZ0IsRUFBU2YsT0FBUUQsSUFFakMsR0FBSXFZLEVBQVVuVixRQUFRbEMsRUFBU2hCLEdBQUdjLElBQU0sR0FBSSxDQUN4QyxHQUFJQSxHQUFLRSxFQUFTaEIsR0FBR2MsR0FDakJPLEVBQU9MLEVBQVNoQixHQUFHcUIsS0FDbkJvWCxFQUFXLEdBQUk5VyxHQUFlbkIsS0FBSyxLQUFNLEtBQU1NLEVBQUlPLEVBQU1rSSxFQUFRN0csRUFBUUYsRUFBVzhWLEVBQU1DLEVBQzlGRSxHQUFTMVIsV0FBV3pDLEdBQ3BCQSxFQUFVM0QsTUFBTVcsS0FBS21YLEdBQ3JCRCxFQUFjbFgsS0FBS21YLEdBUTNCLE1BTEFuVSxHQUFVMUQsTUFBUTBELEVBQVUrSSxXQUFXOEIsZ0JBQWdCRCxFQUFRM04sU0FBVStDLEVBQVUzRCxPQUNuRjJELEVBQVU2QixZQUNWN0IsRUFBVThCLFlBRVZ0QyxFQUFNZ1UsV0FBV3hXLEtBQUtpQixFQUFLekIsSUFDcEIwWCxNQXhJOEJwWSxJQUFBLFlBQUFwRCxNQUFBLFNBZ0ovQnVGLEdBQ04sR0FBSW1XLEdBQU03WCxLQUFLOFgsWUFBWXBXLEVBQ2hCLE9BQVBtVyxHQUdKN1gsS0FBSytYLGVBQWVGLE1BckppQnRZLElBQUEscUJBQUFwRCxNQUFBLFNBOEp0QjJELEdBR2YsSUFBSyxHQUREa1ksSUFEWWhZLEtBQUtzSSxVQUVabkosRUFBSSxFQUFHQSxFQUFJVyxFQUFNVixPQUFRRCxJQUFLLENBQ25DLEdBQUkwWSxHQUFNN1gsS0FBSzhYLFlBQVloWSxFQUFNWCxHQUNqQzZZLEdBQVdBLEVBQVMxRixPQUFPdUYsR0FHL0I3WCxLQUFLaVksd0JBQXdCSixNQXRLUXRZLElBQUEsaUJBQUFwRCxNQUFBLFNBOEsxQmtNLEdBQ1gsR0FBSTVFLEdBQVl6RCxLQUFLc0ksS0FDckI3RSxHQUFVK0IsZUFDVi9CLEVBQVVxRSxpQkFqTDJCdkksSUFBQSwwQkFBQXBELE1BQUEsU0F5TGpCa00sR0FDcEIsR0FBSTVFLEdBQVl6RCxLQUFLc0ksS0FDckI3RSxHQUFVK0IsZUFDVi9CLEVBQVVxRSxpQkE1TDJCdkksSUFBQSxhQUFBcEQsTUFBQSxTQXNNOUJ1RixHQUNQLEdBQUkrQixHQUFZekQsS0FBS3NJLE1BQ2pCckYsRUFBUVEsRUFBVVIsTUFBTWtRLG1CQUc1QixJQUFxQyxJQUFqQzFQLEVBQVUzRCxNQUFNdUMsUUFBUVgsR0FBNUIsQ0FJQSxHQUFJUixHQUFrQnVDLEVBQVUrSSxXQUFXdEwsZ0JBQ3ZDaEIsRUFBT3dCLEVBQUt6QixFQUVoQixNQUFJaUIsRUFBZ0JhLFNBQVNNLFFBQVFuQyxHQUFRLElBQTdDLENBTUEsSUFBSyxHQUZEZ1ksTUFDQTlKLEtBQ0tqUCxFQUFJLEVBQUdBLEVBQUlzRSxFQUFVM0QsTUFBTVYsT0FBUUQsSUFFaUIsSUFBckRzRSxFQUFVM0QsTUFBTVgsR0FBR3dDLFVBQVVVLFFBQVFYLEVBQUtHLFFBQzFDdU0sRUFBZTNOLEtBQUtnRCxFQUFVM0QsTUFBTVgsR0FBR2MsSUFFdkNpWSxFQUFjelgsS0FBS2dELEVBQVUzRCxNQUFNWCxHQUczQyxJQUFJZ1osR0FBY3pXLEVBQUtHLE1BQ3ZCdU0sR0FBZTNOLEtBQUtpQixFQUFLRyxPQUd6QixJQUFJNkcsR0FBU2hILEVBQUtnSCxPQUFTakYsRUFBVVMsT0FBT3lJLFlBQ3hDOEssRUFBTy9WLEVBQUt1SCxFQUNaeU8sRUFBT2hXLEVBQUswSCxFQUNadkgsRUFBU0gsRUFBS0MsVUFBVSxHQUN4QkEsRUFBWUQsRUFBS0MsVUFBVXVTLE1BQU0sR0FDakMwRCxFQUFXLEdBQUk5VyxHQUFlbkIsS0FBSzhYLEVBQU1DLEVBQU1TLEVBQWFBLEVBQWF6UCxFQUFRN0csRUFBUUYsRUFDN0Y4QixHQUFVM0QsTUFBTVcsS0FBS21YLEVBSXJCLEtBQUssR0FGRHZKLEdBQVU1SyxFQUFVK0ksV0FBV3hLLGtCQUFrQm9NLEdBRTVDalAsRUFBSSxFQUFHQSxFQUFJK1ksRUFBYzlZLE9BQVFELElBQUssQ0FDM0MsR0FBSWlaLEdBQWlCRixFQUFjL1ksRUFDbkNzRSxHQUFVM0QsTUFBTStHLE9BQU9wRCxFQUFVM0QsTUFBTXVDLFFBQVErVixHQUFpQixHQUNoRTNVLEVBQVVzRSxtQkFBbUJxUSxHQVFqQyxNQU5BM1UsR0FBVTFELE1BQVEwRCxFQUFVK0ksV0FBVzhCLGdCQUFnQkQsRUFBUTNOLFNBQVUrQyxFQUFVM0QsT0FDbkYyRCxFQUFVNkIsWUFDVjdCLEVBQVU4QixZQUVWdEMsRUFBTWdVLFdBQVdwUSxPQUFPNUQsRUFBTWdVLFdBQVc1VSxRQUFRdVYsRUFBUzNYLElBQUssR0FFeEQyWCxPQXpQOEJyWSxJQUFBLFdBQUFwRCxNQUFBLFNBaVFoQ3VGLEdBQ0wsR0FBSW5CLEdBQVVQLEtBQUtxWSxXQUFXM1csRUFDZixPQUFYbkIsR0FDSFAsS0FBS3NZLGNBQWMvWCxNQXBRaUJoQixJQUFBLG1CQUFBcEQsTUFBQSxTQTZReEIyRCxHQUViLElBQUssR0FERDBYLE1BQ0tyWSxFQUFJLEVBQUdBLEVBQUlXLEVBQU1WLE9BQVFELElBQUssQ0FDbkMsR0FBSTBZLEdBQU03WCxLQUFLcVksV0FBV3ZZLEVBQU1YLEdBQ2hDcVksR0FBVS9XLEtBQUtvWCxHQUVuQjdYLEtBQUt1WSx1QkFBdUJmLE1BblJTalksSUFBQSxnQkFBQXBELE1BQUEsU0EyUjNCb0UsR0FDVixHQUFJa0QsR0FBWXpELEtBQUtzSSxLQUNyQjdFLEdBQVVxRSxpQkE3UjJCdkksSUFBQSx5QkFBQXBELE1BQUEsU0FxU2xCa00sR0FDbkIsR0FBSTVFLEdBQVl6RCxLQUFLc0ksS0FDckI3RSxHQUFVcUUsa0JBdlMyQnFMLEdBQ2pCakMsRUFBb0JyTixPQTBTaEQsUUFDSUEsT0FBUXNQLE1DbFRwQjFXLFFBQUFDLE9BQUEsbUJBQ0FxRyxRQUFBLGlCQUFBLFNBQUFDLEdBQ0FBLEVBQ0FDLE1BQUEsK0JBQ0FDLElBQUEsVUFDQXlPLFlBQUEsOEJBQ0FDLFdBQUEsOENBR0FBLFdBQUEscUJBQUEsU0FBQSxlQUFBLGdCQUFBLG9CQUNBLFNBQUFFLEVBQUE4RCxFQUFBNEMsRUFBQXBELEdBR0EsUUFBQXFELEtBQ0EzRyxFQUFBZSxHQUFBLDZCQUVBLFFBQUE2RixLQUNBRCxJQUVBLFFBQUFFLEtBR0FDLEVBQUFDLEtBQUFDLFNBQ0ExRCxFQUFBTSxnQkFBQWtELEdBQ0F4RCxFQUFBMkQsWUFBQUgsR0FDQUEsRUFBQUksV0FBQXpaLElBQ0FxWixFQUFBSSxXQUFBQyxXQUFBLElBQUFMLEVBQUFJLFdBQUFFLFlBQ0FWLEVBQUF2YyxPQUFBMmMsRUFBQUksWUFBQUcsS0FBQSxTQUFBQyxHQUNBaEUsRUFBQUssV0FBQW1ELEdBQ0FILEtBQ0EsU0FBQVcsR0FDQWhFLEVBQUFLLFdBQUFtRCxHQUNBeEQsRUFBQWlFLGdCQUFBVCxFQUFBUSxNQUlBLFFBQUFFLEtBQ0FsRSxFQUFBSyxXQUFBbUQsR0FDQXhELEVBQUFNLGdCQUFBa0QsR0FDQUEsRUFBQUksWUFDQUUsWUFBQSxHQUNBSyxNQUFBLFFBQ0FDLE9BQUEsR0FDQUMsUUFBQSxHQUNBUixXQUFBLFdBakNBLEdBQUFMLEdBQUE1WSxJQUNBNFksR0FBQWMsWUFBQS9jLGNBQUFnQyxXQW1DQWlhLEVBQUFELGNBQUFBLEVBQ0FDLEVBQUFGLGVBQUFBLEVBQ0FZLE10QzJySEEsSUFBSXZhLGNBQWUsV0FBYyxRQUFTQyxHQUFpQkMsRUFBUUMsR0FBUyxJQUFLLEdBQUlDLEdBQUksRUFBR0EsRUFBSUQsRUFBTUUsT0FBUUQsSUFBSyxDQUFFLEdBQUlFLEdBQWFILEVBQU1DLEVBQUlFLEdBQVdqRCxXQUFhaUQsRUFBV2pELGFBQWMsRUFBT2lELEVBQVcvQyxjQUFlLEVBQVUsU0FBVytDLEtBQVlBLEVBQVdoRCxVQUFXLEdBQU1MLE9BQU9zRCxlQUFlTCxFQUFRSSxFQUFXRSxJQUFLRixJQUFpQixNQUFPLFVBQVUvRCxFQUFha0UsRUFBWUMsR0FBaUosTUFBOUhELElBQVlSLEVBQWlCMUQsRUFBWVMsVUFBV3lELEdBQWlCQyxHQUFhVCxFQUFpQjFELEVBQWFtRSxHQUFxQm5FLE1BRTVoQndULEtBQU8sUUFBU0MsR0FBSUMsRUFBUUMsRUFBVUMsR0FBMkIsT0FBWEYsSUFBaUJBLEVBQVNHLFNBQVNwVCxVQUFXLElBQUlxVCxHQUFPcFQsT0FBT3FULHlCQUF5QkwsRUFBUUMsRUFBVyxJQUFhdk0sU0FBVDBNLEVBQW9CLENBQUUsR0FBSXZOLEdBQVM3RixPQUFPdUYsZUFBZXlOLEVBQVMsT0FBZSxRQUFYbk4sRUFBbUIsT0FBa0NrTixFQUFJbE4sRUFBUW9OLEVBQVVDLEdBQW9CLEdBQUksU0FBV0UsR0FBUSxNQUFPQSxHQUFLalQsS0FBZ0IsSUFBSW1ULEdBQVNGLEVBQUtMLEdBQUssSUFBZXJNLFNBQVg0TSxFQUE0QyxNQUFPQSxHQUFPNVQsS0FBS3dULEd1Q3Z1SDVkelMsU0FBUUMsT0FBTyxnQkFDVmdELFFBQVEsdUJBQXdCLHNCQUF1QixpQkFBa0IsU0FBVXlULEVBQXFCclMsR0FBZ0IsR0FDL0dzUyxHQUQrRyxTQUFBdUcsR0FLakgsUUFBQXZHLEtBQWNoWSxnQkFBQTRFLEtBQUFvVCxFQUFBLElBQUE5UixHQUFBOUYsMkJBQUF3RSxNQUFBb1QsRUFBQTVXLFdBQUFSLE9BQUF1RixlQUFBNlIsSUFBQTFYLEtBQUFzRSxNQUFBLE9BRVZzQixHQUFLcUYsV0FBYSxzQkFGUnJGLEVBTG1HLE1BQUExRixXQUFBd1gsRUFBQXVHLEdBQUE1YSxhQUFBcVUsSUFBQTdULElBQUEsYUFBQXBELE1BQUEsU0FldEdtTSxHQUNQLElBQUl0SSxLQUFLME8sWUFBVCxDQUdBSSxLQUFBc0UsRUFBQXJYLFVBQUFTLFdBQUFSLE9BQUF1RixlQUFBNlIsRUFBQXJYLFdBQUEsYUFBQWlFLE1BQUF0RSxLQUFBc0UsS0FBaUJzSSxFQUNqQixJQUFJckYsR0FBUXFGLEVBQU1yRixNQUFNbVEsc0JBQ3hCblEsR0FBTTJXLGVBRU4zVyxFQUFNNFcsZ0JBQ041VyxFQUFNNlcsZUFDTjdXLEVBQU04VyxRQUNOOVcsRUFBTStXLFNBQ04vVyxFQUFNNkgsVUFDTjdILEVBQU1nWCxjQUFnQixLQUN0QmhYLEVBQU1pWCxZQUFjLEtBQ3BCalgsRUFBTWtYLGdCQUFrQixLQUN4QmxYLEVBQU1tWCxlQUFpQixLQUN2Qm5YLEVBQU1vWCxVQUFZLElBRWxCLElBQUluVyxHQUFTb0UsRUFBTXBFLE9BQU9rUCxzQkFDMUJsUCxHQUFPb1csU0FBVyxHQUdsQmhTLEVBQU1zQyxjQUFnQjVLLEtBQUs0SyxjQUMzQnRDLEVBQU04QyxZQUFjcEwsS0FBS29MLFlBQ3pCOUMsRUFBTStDLGFBQWVyTCxLQUFLcUwsYUFDMUIvQyxFQUFNZ0QsV0FBYXRMLEtBQUtzTCxlQXpDcUYvTCxJQUFBLG9CQUFBcEQsTUFBQSxTQW1EL0ZvZSxHQUNkLEdBQUk5VyxHQUFZekQsS0FBS3NJLE1BQ2pCeUosRUFBYS9SLEtBQ2JpRCxFQUFRUSxFQUFVUixNQUFNbVEsbUJBRTVCblEsR0FBTW1YLGVBQWlCRyxFQUN2QnRYLEVBQU11WCxXQUFhLFdBQ1h2WCxFQUFNNFcsYUFBYXphLE9BQVMsR0FDNUIyUyxFQUFXMEksY0FBYy9lLEtBQUtxVyxPQTNEdUV4UyxJQUFBLGVBQUFwRCxNQUFBLFNBc0VwR29lLEdBQ1QsR0FBSTlXLEdBQVl6RCxLQUFLc0ksTUFDakJyRixFQUFRUSxFQUFVUixNQUFNbVEsbUJBRTVCblEsR0FBTW9YLFVBQVlFLEtBMUUyRmhiLElBQUEsVUFBQXBELE1BQUEsU0FvRnpHNFosR0FFYyxNQUFkQSxHQUNBL1YsS0FBSzBhLEtBQUszRSxNQXZGK0Z4VyxJQUFBLE9BQUFwRCxNQUFBLFNBa0c1RzRaLEdBQ0QsR0FBSXRTLEdBQVl6RCxLQUFLc0ksTUFDakJyRixFQUFRUSxFQUFVUixNQUFNbVEsb0JBRXhCdFQsRUFBUTJELEVBQVUzRCxNQUNsQkMsRUFBUTBELEVBQVUxRCxNQUNsQjRhLEVBQVksSUFDTyxPQUFuQjFYLEVBQU1vWCxZQUNOTSxFQUFZMVgsRUFBTW9YLFVBQVU3WixPQUVoQyxJQUFJc1osR0FBYzdXLEVBQU02VyxZQUNwQkQsRUFBZTVXLEVBQU00VyxhQUNyQkcsRUFBUS9XLEVBQU0rVyxNQUNkbFAsRUFBUzdILEVBQU02SCxPQUVmbVAsRUFBZ0JoWCxFQUFNZ1gsY0FDdEJDLEVBQWNqWCxFQUFNaVgsWUFDcEJ6SyxHQUFPM1AsTUFBTUEsRUFBT0MsTUFBTUEsRUFDMUI2YSxPQUFPM1gsRUFBTTJXLFlBQWFlLFVBQVVBLEVBQ3BDYixZQUFhQSxFQUNiRCxhQUFhQSxFQUFjRyxNQUFNQSxFQUNqQ2xQLE9BQU9BLEVBQVFtUCxjQUFjQSxFQUM3QkMsWUFBWUEsRUFDaEJuRSxHQUFXM0Msb0JBQXNCM0QsS0F6SDRFbFEsSUFBQSxPQUFBcEQsTUFBQSxTQW1JNUcwZSxHQUNELEdBQUk5SSxHQUFhL1IsS0FDYnlELEVBQVl6RCxLQUFLc0ksTUFDakJyRixFQUFRUSxFQUFVUixNQUFNbVEsbUJBRTVCeUgsR0FBWUEsRUFBVXpILG9CQUN0Qm5RLEVBQU0yVyxZQUFjaUIsRUFBVUQsT0FDOUJuWCxFQUFVMUQsTUFBUThhLEVBQVU5YSxNQUM1QjBELEVBQVUzRCxNQUFRK2EsRUFBVS9hLEtBRTVCLElBQUk2YSxHQUFZRSxFQUFVRixTQUNILE9BQW5CMVgsRUFBTW9YLFdBQ05wWCxFQUFNb1gsVUFBVTdaLEtBQUttYSxHQUV6QjFYLEVBQU00VyxhQUFlZ0IsRUFBVWhCLGFBQy9CNVcsRUFBTTZXLFlBQWNlLEVBQVVmLFlBQzlCN1csRUFBTStXLE1BQVFhLEVBQVViLE1BQ3hCL1csRUFBTTZILE9BQVMrUCxFQUFVL1AsT0FDekI3SCxFQUFNZ1gsY0FBZ0JZLEVBQVVaLGNBQ2hDaFgsRUFBTWlYLFlBQWNXLEVBQVVYLFlBRUYsTUFBeEJqWCxFQUFNbVgsZ0JBQ0ZuWCxFQUFNNFcsYUFBYXphLE9BQVMsR0FDNUI2RCxFQUFNbVgsZUFBZVUsT0FBTyxPQUFRLEVBSTVDLElBQUk1WixHQUFrQnVDLEVBQVUrSSxXQUFXdEwsZUFFM0NkLEdBQUVDLFFBQVFvRCxFQUFVM0QsTUFBTyxTQUFTK0UsR0FDaENBLEVBQUV1Tyx1QkFDRWhULEVBQUUwQixTQUFTWixFQUFnQitCLEVBQU02VyxZQUFZLElBQ3pDalYsRUFBRTVFLElBQ040RSxFQUFFdU8sb0JBQW9CMkgsS0FBTyxRQUU3QmxXLEVBQUV1TyxvQkFBb0IySCxLQUFPLGFBS3JDLElBQUlqUSxFQUNKLElBQWlDLElBQTdCN0gsRUFBTTZXLFlBQVkxYSxPQUFjLENBQ2hDMEwsRUFBUzdILEVBQU1nWCxhQUNmLElBQUkvTSxHQUFPakssRUFBTWlYLFdBQ2pCelcsR0FBVTRKLE9BQU9ILEVBQUssR0FBSUEsRUFBSyxRQUM1QixDQUNILEdBQUlBLEdBQU9qSyxFQUFNK1csTUFBTS9XLEVBQU02VyxZQUNqQixPQUFSNU0sR0FDQXpKLEVBQVU0SixPQUFPSCxFQUFLLEdBQUlBLEVBQUssSUFFbkNwQyxFQUFTN0gsRUFBTTZILE9BQU83SCxFQUFNNlcsYUFJaEMxWixFQUFFQyxRQUFRb0QsRUFBVTNELE1BQU8sU0FBU3NLLEdBQ2hDLEdBQUk0USxHQUFNbFEsRUFBT1YsRUFBRW5LLEdBQ1IsT0FBUCthLEdBQ0FDLFFBQVFDLElBQUlwUSxFQUFRVixHQUV4QkEsRUFBRW5CLEVBQUkrUixFQUFJL1IsRUFDVm1CLEVBQUVoQixFQUFJNFIsRUFBSTVSLElBRWQzRixFQUFVUixNQUFNZSxXQUFZLEVBQzVCUCxFQUFVcUUsWUFBWXBNLEtBQUsrSCxFQUFXLFdBQ2xDc08sRUFBV29KLG9CQUFvQnpmLEtBQUtxVyxRQW5NcUV4UyxJQUFBLFdBQUFwRCxNQUFBLFNBOE54RzZLLEVBQVFuQyxHQUNiLEdBQUlwQixHQUFZekQsS0FBS3NJLE1BQ2pCckYsRUFBUVEsRUFBVVIsTUFBTW1RLG9CQUd4QmxULEVBQU8yRSxFQUFFNUUsR0FDVGlCLEVBQWtCdUMsRUFBVStJLFdBQVd0TCxlQUMzQyxJQUE4QndCLFNBQTFCeEIsRUFBZ0JoQixLQUF1QkUsRUFBRXdCLFFBQVFWLEVBQWdCaEIsSUFBckUsQ0FvQkEsR0FoQkErQyxFQUFNNlcsWUFBWTVGLFFBRWUsSUFBN0JqUixFQUFNNlcsWUFBWTFhLE9BQ2xCNkQsRUFBTTZXLFlBQVlyWixLQUFLb0UsRUFBRTVFLElBQ2xCRyxFQUFFMEIsU0FBU1osRUFBZ0IrQixFQUFNNlcsWUFBWSxJQUN4Q2pWLEVBQUU1RSxJQUNkZ0QsRUFBTTZXLFlBQVksR0FBS2pWLEVBQUU1RSxHQUNXLElBQTdCZ0QsRUFBTTZXLFlBQVkxYSxPQUV6QjZELEVBQU02VyxZQUFZclosS0FBS29FLEVBQUU1RSxJQUNsQkcsRUFBRTBCLFNBQVNaLEVBQWdCK0IsRUFBTTZXLFlBQVksSUFDeENqVixFQUFFNUUsTUFFZGdELEVBQU02VyxZQUFZLEdBQUtqVixFQUFFNUUsSUFHSSxJQUE3QmdELEVBQU02VyxZQUFZMWEsUUFDZDZELEVBQU02VyxZQUFZLEtBQU9qVixFQUFFNUUsR0FBSSxDQUVuQyxHQUFJbWIsSUFBZXZXLEdBQ2ZzVixLQUNBa0IsRUFBZ0JuYSxFQUFnQitCLEVBQU02VyxZQUFZLEdBQ3REMVosR0FBRUMsUUFBUW9ELEVBQVUzRCxNQUFPLFNBQVM0QixHQUM1QnRCLEVBQUUwQixTQUFTdVosRUFBZTNaLEVBQUt6QixNQUMvQmthLEVBQWdCMVosS0FBS2lCLEVBQUt6QixJQUMxQm1iLEVBQVkzYSxLQUFLaUIsVUFHdEIsQ0FFSCxHQUFJMFosSUFBZXZXLEdBQ2ZzVixJQUNKL1osR0FBRUMsUUFBUW9ELEVBQVUxRCxNQUFPLFNBQVNjLEdBQzVCQSxFQUFLRCxTQUFXaUUsR0FDK0IsSUFBM0NzVixFQUFnQjlYLFFBQVF4QixFQUFLNUIsT0FBT2dCLEtBQ3hDWSxFQUFLNUIsT0FBT21VLHVCQUNadlMsRUFBSzVCLE9BQU9tVSxvQkFBb0IySCxLQUFPLFlBQ3ZDWixFQUFnQjFaLEtBQUtJLEVBQUs1QixPQUFPZ0IsSUFDakNtYixFQUFZM2EsS0FBS0ksRUFBSzVCLFNBQ2Y0QixFQUFLNUIsU0FBVzRGLEdBQ3dCLElBQTNDc1YsRUFBZ0I5WCxRQUFReEIsRUFBS0QsT0FBT1gsTUFDeENZLEVBQUtELE9BQU93Uyx1QkFDWnZTLEVBQUtELE9BQU93UyxvQkFBb0IySCxLQUFPLFlBQ3ZDWixFQUFnQjFaLEtBQUtJLEVBQUtELE9BQU9YLElBQ2pDbWIsRUFBWTNhLEtBQUtJLEVBQUtELFdBTWxDNkMsRUFBVTRCLFFBQVFlLEtBQUssU0FBUzFFLEdBQ3hCQSxFQUFLekIsS0FBTzRFLEVBQUU1RSxJQUNkd0QsRUFBVXNFLG1CQUFtQnJHLEtBR3JDK0IsRUFBVXFFLGNBSVZyRSxFQUFVUixNQUFNZ0IsZUFBZ0IsRUFDaENSLEVBQVU0QixRQUFRZSxLQUFLLFNBQVMxRSxHQUN4QkEsRUFBS3pCLEtBQU80RSxFQUFFNUUsR0FDZG9HLEdBQUdDLE9BQU90RyxNQUFNeU0sYUFBYW1CLE1BQU0sS0FBS0MsU0FBUyxLQUFLekIsTUFBTSxVQUFXLEdBR25ELE1BQWhCdkcsRUFBRTdGLE1BQU00VCxNQUNSL04sRUFBRTdGLE1BQU00VCxLQUFLLFdBQVcsSUFLcEMsSUFBSXRHLEdBQVk3SixFQUFVeUQsUUFBUW9HLFlBQzlCQyxFQUFROUosRUFBVXlELFFBQVFxRyxRQUMxQmtLLEVBQVE2RCxXQUFXN1gsRUFBVUQsSUFBSTRJLE1BQU0sVUFBWW1CLEVBQVMsRUFBS0QsRUFBVSxHQUMzRW9LLEVBQVE0RCxXQUFXN1gsRUFBVUQsSUFBSTRJLE1BQU0sV0FBYW1CLEVBQVEsRUFBS0QsRUFBVSxFQUMvRXpJLEdBQUVtTSxPQUFTbk0sRUFBRW9FLEVBQ2JwRSxFQUFFb00sT0FBU3BNLEVBQUV1RSxFQUNidkUsRUFBRW9FLEVBQUl3TyxFQUNONVMsRUFBRXVFLEVBQUlzTyxFQUNOMVEsRUFBT3lGLFdBQVcsMEJBQ1RvQixTQUFTLEtBQ1Q4QyxVQUFVLFlBQWEsU0FBUzlMLEdBQzdCLEdBQUltTSxHQUFTbk0sRUFBRW1NLE9BQ1hDLEVBQVNwTSxFQUFFb00sTUFHZixPQUZBcE0sR0FBRW1NLE9BQVNuTSxFQUFFb0UsRUFDYnBFLEVBQUVvTSxPQUFTcE0sRUFBRXVFLEVBQ04vQyxHQUFHdUssa0JBQWtCLGFBQWVJLEVBQVMsSUFBTUMsRUFBUyxJQUFLLGFBQWVwTSxFQUFFb0UsRUFBSSxJQUFNcEUsRUFBRXVFLEVBQUksTUFHckgsSUFBSW1TLEdBQUFBLEtBQUFBLEVBQUFBLFVBQUFBLFdBQUFBLE9BQUFBLGVBQUFBLEVBQUFBLFdBQUFBLFlBQUFBLEtBQ0p0WSxHQUFNa1gsZ0JBQWtCQSxDQUV4QixJQUFJcEksR0FBYS9SLElBQ2pCMlQsWUFBVyxXQUNQbFEsRUFBVTNELE1BQVFzYixFQUNsQkcsRUFBYzdmLEtBQUtxVyxFQUFZbE4sSUFDaEMsU0F6VTBHdEYsSUFBQSxzQkFBQXBELE1BQUEsV0FpVjdHLEdBQUlzSCxHQUFZekQsS0FBS3NJLE1BQ2pCckYsRUFBUVEsRUFBVVIsTUFBTW1RLG1CQUV4QjNQLEdBQVU0QixRQUFRZSxLQUFLLFNBQVMxRSxHQUM1QjJFLEdBQUdDLE9BQU90RyxNQUFNeU0sYUFBYW9CLFNBQVMsS0FBS3pCLE1BQU0sVUFBVyxHQUM1RC9GLEdBQUdDLE9BQU90RyxNQUFNa0YsUUFBUSxTQUFTLEdBQ2pDbUIsR0FBR0MsT0FBT3RHLE1BQU1rRixRQUFRLGFBQWEsR0FFTCxNQUE1QnhELEVBQUswUixzQkFDaUMsVUFBbEMxUixFQUFLMFIsb0JBQW9CMkgsS0FDekIxVSxHQUFHQyxPQUFPdEcsTUFBTWtGLFFBQVEsU0FBUyxHQUNRLGNBQWxDeEQsRUFBSzBSLG9CQUFvQjJILE1BQ2hDMVUsR0FBR0MsT0FBT3RHLE1BQU1rRixRQUFRLGFBQWEsTUFLakRqQyxFQUFNa1gsZ0JBQWtCLEtBRXhCMVcsRUFBVXFFLGlCQXBXK0Z2SSxJQUFBLGVBQUFwRCxNQUFBLFdBbVg3RyxRQUFTcWYsR0FBYWpSLEVBQUtELEdBQ3ZCLE1BQU9ULE1BQUs0UixNQUFNNVIsS0FBSzZSLFVBQVlwUixFQUFNQyxFQUFNLElBQU1BLEVBVHpELEdBQUk5RyxHQUFZekQsS0FBS3NJLE1BQ2pCeUosRUFBYS9SLEtBQ2IyYixFQUFjbFksRUFBVVMsT0FFeEJnRyxFQUFTeVIsRUFBWWhYLGNBQ3JCN0UsRUFBUTJELEVBQVUzRCxNQUNsQjJQLEVBQU1zQyxFQUFXbkgsY0FBY2xQLEtBQUsrSCxFQU14Q3JELEdBQUVDLFFBQVFQLEVBQU8sU0FBUzRCLEdBQ3RCLEdBQWMsTUFBVkEsRUFBS3VILEdBQXVCLE1BQVZ2SCxFQUFLMEgsRUFBVyxDQUNsQyxHQUFJSCxHQUFJdVMsRUFBYTlaLEVBQUtnSCxPQUFTd0IsRUFBUXVGLEVBQUl6RixNQUFRdEksRUFBS2dILE9BQVN3QixHQUNqRWQsRUFBSW9TLEVBQWE5WixFQUFLZ0gsT0FBU3dCLEVBQVF1RixFQUFJeEYsT0FBU3ZJLEVBQUtnSCxPQUFTd0IsRUFDdEV4SSxHQUFLdUgsRUFBSUEsRUFDVHZILEVBQUswSCxFQUFJQSxRQTVYNEY3SixJQUFBLGVBQUFwRCxNQUFBLFdBdVk3RyxHQUFJc0gsR0FBWXpELElBQ2hCeUQsR0FBVTRCLFFBQ0xMLEtBQUssS0FBTSxTQUFTSCxHQUlqQixNQUhnQixPQUFaQSxFQUFFbU0sU0FDRm5NLEVBQUVtTSxPQUFVbk0sRUFBRW1NLE9BQVN2TixFQUFVeUQsUUFBUXFHLFFBQVc5SixFQUFVeUQsUUFBUW9HLFlBQVksSUFFL0V6SSxFQUFFb0UsSUFFWmpFLEtBQUssS0FBTSxTQUFTSCxHQUlqQixNQUhnQixPQUFaQSxFQUFFb00sU0FDRnBNLEVBQUVvTSxPQUFVcE0sRUFBRW9NLE9BQVF4TixFQUFVeUQsUUFBUXFHLFFBQVc5SixFQUFVeUQsUUFBUW9HLFlBQVksSUFFOUV6SSxFQUFFdUUsSUFHakIzRixFQUFVMEIsTUFDTEgsS0FBSyxLQUFNLFNBQVNILEdBQUssTUFBT0EsR0FBRWpFLE9BQU9xSSxJQUN6Q2pFLEtBQUssS0FBTSxTQUFTSCxHQUFLLE1BQU9BLEdBQUVqRSxPQUFPd0ksSUFDekNwRSxLQUFLLEtBQU0sU0FBU0gsR0FBSyxNQUFPQSxHQUFFNUYsT0FBT2dLLElBQ3pDakUsS0FBSyxLQUFNLFNBQVNILEdBQUssTUFBT0EsR0FBRTVGLE9BQU9tSyxPQTFaK0Q3SixJQUFBLGFBQUFwRCxNQUFBLFdBbWE3RyxHQUFJc0gsR0FBWXpELEtBQ1ppRCxFQUFRUSxFQUFVUixNQUNsQjJZLEVBQWMzWSxFQUFNbVEsbUJBQ3hCLElBQWlDLE1BQTdCd0ksRUFBWTNCLGNBQXVCLENBQ25DLEdBQUk0QixLQUNKemIsR0FBRUMsUUFBUW9ELEVBQVUzRCxNQUFPLFNBQVNzSyxHQUNoQ3lSLEVBQWN6UixFQUFFbkssS0FBT2dKLEVBQUVtQixFQUFFbkIsRUFBR0csRUFBRWdCLEVBQUVoQixLQUV0Q3dTLEVBQVkzQixjQUFnQjRCLENBQzVCLElBQUl0TyxHQUFROUosRUFBVXlELFFBQVFxRyxRQUMxQkQsRUFBWTdKLEVBQVV5RCxRQUFRb0csV0FDbENzTyxHQUFZMUIsYUFBZTVNLEVBQVdDLEdBRzFDOUosRUFBVTRCLFFBQ0xMLEtBQUssS0FBTSxTQUFTSCxHQUFLLE1BQU9BLEdBQUVvRSxJQUNsQ2pFLEtBQUssS0FBTSxTQUFTSCxHQUFLLE1BQU9BLEdBQUV1RSxJQUV2QzNGLEVBQVUwQixNQUFNSCxLQUFLLEtBQU0sU0FBU0gsR0FBSyxNQUFPQSxHQUFFakUsT0FBT3FJLElBQ3BEakUsS0FBSyxLQUFNLFNBQVNILEdBQUssTUFBT0EsR0FBRWpFLE9BQU93SSxJQUN6Q3BFLEtBQUssS0FBTSxTQUFTSCxHQUFLLE1BQU9BLEdBQUU1RixPQUFPZ0ssSUFDekNqRSxLQUFLLEtBQU0sU0FBU0gsR0FBSyxNQUFPQSxHQUFFNUYsT0FBT21LLE9BeGIrRDdKLElBQUEsY0FBQXBELE1BQUEsU0FrY3JHNE4sRUFBR0MsRUFBT0MsR0FXbEIsUUFBU2tCLEdBQVF2QyxHQUNiLE1BQU8sVUFBUy9ELEdBQ1EsSUFBaEJrVixFQUFLM2EsUUFDOEIsVUFBL0J5RixFQUFFdU8sb0JBQW9CMkgsS0FDdEJsVyxFQUFFdUUsSUFBTTJRLEVBQUssR0FBS2xWLEVBQUV1RSxHQUFLUixFQUV6Qi9ELEVBQUV1RSxJQUFNMlEsRUFBSyxHQUFLbFYsRUFBRXVFLEdBQUtSLEVBRTdCL0QsRUFBRW9FLElBQU1lLEVBQU0sRUFBSW5GLEVBQUVvRSxHQUFLTCxJQUV6Qi9ELEVBQUV1RSxJQUFNYSxFQUFPLEVBQUlwRixFQUFFdUUsR0FBS1IsRUFDMUIvRCxFQUFFb0UsSUFBTWUsRUFBTSxFQUFJbkYsRUFBRW9FLEdBQUtMLElBckJyQyxHQUFJbkYsR0FBWXpELEtBQ1ppRCxFQUFRUSxFQUFVUixNQUNsQmlCLEVBQVNULEVBQVVTLE9BQ25CMFgsRUFBYzNZLEVBQU1tUSxvQkFFcEJsSixFQUFTaEcsRUFBT1MsY0FDaEI0SSxFQUFROUosRUFBVXlELFFBQVFxRyxRQUcxQndNLEVBQU82QixFQUFZN0IsSUFrQnZCdFcsR0FBVTRCLFFBQ0xlLEtBQUtwRyxLQUFLcUssZUFBZSxLQUN6QmpFLEtBQUsrRSxFQUFRLEdBQUtwQixFQUFFbkIsUUFDcEI1RCxLQUFLLEtBQU0sU0FBU0gsR0FDakIsTUFBT0EsR0FBRW9FLEVBQUlZLEtBQUtTLEtBQUt6RixFQUFFNkQsT0FBU3dCLEdBQVFxRCxFQUFPMUQsS0FBS1UsSUFBSVAsSUFBV0UsRUFBUXJGLEVBQUU2RCxRQUFVNkUsRUFBUTFJLEVBQUVvRSxNQUV0R2pFLEtBQUssS0FBTSxTQUFTSCxHQUNqQixNQUE2QixPQUF6QkEsRUFBRXVPLHFCQUF3RCxNQUF6QnZPLEVBQUV1TyxxQkFDbkN2TyxFQUFFdUUsRUFBSVMsS0FBS1MsS0FBS3pGLEVBQUU2RCxPQUFTd0IsR0FBUXFELEVBQzNCMUQsS0FBS1UsSUFBSU4sSUFBWUMsRUFBU3JGLEVBQUU2RCxRQUFRNkUsRUFBUTFJLEVBQUV1RSxJQUNuRHZFLEVBQUV1RSxHQUM2QixVQUEvQnZFLEVBQUV1TyxvQkFBb0IySCxNQUM3QmxXLEVBQUV1RSxFQUFJUyxLQUFLUyxJQUFJekYsRUFBRTZELE9BQVN3QixFQUNsQkwsS0FBS1UsS0FBS04sSUFBWUMsRUFBU3JGLEVBQUU2RCxRQUFRNkUsR0FBUXJKLEVBQU9rUCxvQkFBb0JrSCxTQUFVelYsRUFBRXVFLElBQ3pGdkUsRUFBRXVFLEdBQzZCLGNBQS9CdkUsRUFBRXVPLG9CQUFvQjJILE1BQzdCbFcsRUFBRXVFLEVBQUlTLEtBQUtTLEtBQUtMLEdBQVdDLEVBQVNyRixFQUFFNkQsUUFBUTZFLEdBQVNySixFQUFPa1Asb0JBQW9Ca0gsU0FDMUV6USxLQUFLVSxJQUFJTixJQUFZQyxFQUFTckYsRUFBRTZELFFBQVE2RSxFQUFRMUksRUFBRXVFLElBQ25EdkUsRUFBRXVFLEdBSE4sU0FPZjNGLEVBQVUwQixNQUNMSCxLQUFLLEtBQU0sU0FBU0gsR0FBSyxNQUFPQSxHQUFFakUsT0FBT3FJLElBQ3pDakUsS0FBSyxLQUFNLFNBQVNILEdBQUssTUFBT0EsR0FBRWpFLE9BQU93SSxJQUN6Q3BFLEtBQUssS0FBTSxTQUFTSCxHQUFLLE1BQU9BLEdBQUU1RixPQUFPZ0ssSUFDekNqRSxLQUFLLEtBQU0sU0FBU0gsR0FBSyxNQUFPQSxHQUFFNUYsT0FBT21LLE9BeGYrRDdKLElBQUEsZ0JBQUFwRCxNQUFBLFdBOGdCN0csUUFBUzJmLEdBQWE5UixFQUFPQyxHQUN6QixHQUFJOFIsR0FBTy9SLEVBQVFDLEVBQ2Z2QixFQUFTakYsRUFBVVMsT0FBT00sWUFFMUJwRixFQUFrQixJQUFSc0osRUFDVnNULEVBQVNELEdBQU8zYyxFQUFRQSxFQUM1QixPQUFPNGMsR0FaWCxHQUFJdlksR0FBWXpELEtBQ1ppRCxFQUFRUSxFQUFVUixNQUNsQmlCLEVBQVNULEVBQVVTLE9BQ25CK1gsRUFBZS9YLEVBQU9rUCxvQkFDdEJ3SSxFQUFjM1ksRUFBTW1RLG9CQUNwQnRULEVBQVEyRCxFQUFVM0QsTUFhbEJvSyxFQUFTaEcsRUFBT1MsY0FDaEI2RixFQUFXOFEsV0FBVzdYLEVBQVVELElBQUk0SSxNQUFNLFVBQzFDM0IsRUFBWTZRLFdBQVc3WCxFQUFVRCxJQUFJNEksTUFBTSxXQUUzQ3BDLEVBQVFRLEVBQ1JQLEVBQVNRLEVBRVR1UixFQUFTRixFQUFhOVIsRUFBUyxFQUFFRSxFQUFTRCxFQUFVLEVBQUVDLEdBQ3REcUQsRUFBUSxDQUNSek4sR0FBTVYsT0FBUzRjLEdBQ2Z6TyxFQUFReU8sRUFBU2xjLEVBQU1WLE9BQ3ZCcUUsRUFBVTRKLE9BQU81SixFQUFVeUQsUUFBUW9HLFlBQWFDLEdBQ2hEdkQsR0FBU3VELEVBQ1R0RCxHQUFVc0QsR0FFVjlKLEVBQVU0SixPQUFPNUosRUFBVXlELFFBQVFvRyxZQUFhQyxFQUlwRCxJQUNJd00sR0FEQUQsRUFBYzhCLEVBQVk5QixXQUU5QixJQUEyQixJQUF2QkEsRUFBWTFhLE9BQ1oyYSxHQUFROVAsRUFBTyxPQUNaLENBRUgsR0FBSWlTLEdBQWF6WSxFQUFVK0ksV0FBV3RMLGdCQUFnQjRZLEVBQVksR0FDbEVtQyxHQUFhM0IsU0FBVzRCLEVBQVc5YyxPQUFTVSxFQUFNVixNQUNsRCxJQUFJK08sR0FBTWxFLEVBQVNnUyxFQUFhM0IsU0FDNUI2QixFQUFNbFMsRUFBU2tFLENBQ2ZBLEdBQU0sRUFBRTFLLEVBQVVTLE9BQU9PLFlBQ3pCd1gsRUFBYTNCLFNBQVksSUFBTTdXLEVBQVVTLE9BQU9PLFVBQWF3RixFQUM3RGtFLEVBQU1sRSxFQUFTZ1MsRUFBYTNCLFNBQzVCNkIsRUFBTWxTLEVBQVNrRSxHQUdmZ08sRUFBTSxFQUFHMVksRUFBVVMsT0FBT08sWUFDMUJ3WCxFQUFhM0IsU0FBVyxFQUFNLElBQU03VyxFQUFVUyxPQUFPTyxVQUFhd0YsRUFDbEVrRSxFQUFNbEUsRUFBU2dTLEVBQWEzQixTQUM1QjZCLEVBQU1sUyxFQUFTa0UsR0FFbkI0TCxHQUFRNUwsRUFBSSxFQUFHQSxFQUFNZ08sRUFBTSxHQUkvQixNQURBUCxHQUFZN0IsS0FBT0EsR0FDWC9QLE1BQU1BLEVBQU9DLE9BQU9BLE1BdGtCaUYxSyxJQUFBLGlCQUFBcEQsTUFBQSxTQThrQmxHa00sR0FDWCxHQUFJMEosR0FBYS9SLEtBQ2J5RCxFQUFZekQsS0FBS3NJLE1BQ2pCckYsRUFBUVEsRUFBVVIsTUFBTW1RLG9CQUV4QmxTLEVBQWtCdUMsRUFBVStJLFdBQVd0TCxlQUMzQ2QsR0FBRUMsUUFBUWdJLEVBQVUsU0FBU3hELEdBQ3pCQSxFQUFFdU8sdUJBQ0VoVCxFQUFFMEIsU0FBU1osRUFBZ0IrQixFQUFNNlcsWUFBWSxJQUN6Q2pWLEVBQUU1RSxJQUNONEUsRUFBRXVPLG9CQUFvQjJILEtBQU8sUUFFN0JsVyxFQUFFdU8sb0JBQW9CMkgsS0FBTyxhQUlyQyxJQUFJM1QsR0FBUWlCLEVBQVMsR0FBR3hHLE1BbUJ4QixJQVprQyxJQUE5Qm9CLEVBQU00VyxhQUFhemEsUUFDZjZELEVBQU00VyxhQUFhNVcsRUFBTTRXLGFBQWF6YSxPQUFTLEdBQUdhLEtBQU9tSCxFQUM3RG5FLEVBQU00VyxhQUFhdUMsTUFFbkJuWixFQUFNNFcsYUFBYXBaLE1BQU1SLEdBQUdtSCxFQUFPTixNQUFNLFVBR2pCLE1BQXhCN0QsRUFBTW1YLGdCQUNnQyxJQUE5Qm5YLEVBQU00VyxhQUFhemEsUUFDM0I2RCxFQUFNbVgsZUFBZVUsT0FBTyxPQUFRLEdBR2pCLE1BQW5CN1gsRUFBTW9YLFVBQW1CLENBQ3pCLEdBQUk3WixHQUFPLEVBQ1B5QyxHQUFNNlcsWUFBWTFhLE9BQVMsSUFDM0JvQixHQUFReUMsRUFBTTZXLFlBQVksSUFFRyxJQUE3QjdXLEVBQU02VyxZQUFZMWEsU0FDbEJvQixHQUFRLE1BQVF5QyxFQUFNNlcsWUFBWSxJQUV0QzdXLEVBQU1vWCxVQUFVN1osS0FBS0EsR0FJekJpRCxFQUFVUixNQUFNZ0IsZUFBZ0IsRUFDaEM4TixFQUFXc0ssZUE5bkJrRzljLElBQUEsWUFBQXBELE1BQUEsV0F1b0I3RyxHQUdJMk8sR0FIQWlILEVBQWEvUixLQUNieUQsRUFBWXpELEtBQUtzSSxNQUNqQnJGLEVBQVFRLEVBQVVSLE1BQU1tUSxtQkFFNUIsSUFBaUMsSUFBN0JuUSxFQUFNNlcsWUFBWTFhLE9BQWMsQ0FDaEMwTCxFQUFTN0gsRUFBTWdYLGFBQ2YsSUFBSS9NLEdBQU9qSyxFQUFNaVgsV0FDakJ6VyxHQUFVNEosT0FBT0gsRUFBSyxHQUFJQSxFQUFLLFFBQzVCLENBQ0gsR0FBSUEsR0FBT2pLLEVBQU0rVyxNQUFNL1csRUFBTTZXLFlBQ2pCLE9BQVI1TSxHQUNBekosRUFBVTRKLE9BQU9ILEVBQUssR0FBSUEsRUFBSyxJQUVuQ3BDLEVBQVM3SCxFQUFNNkgsT0FBTzdILEVBQU02VyxhQUdoQyxHQUFjLE1BQVZoUCxFQUNBMUssRUFBRUMsUUFBUW9ELEVBQVUzRCxNQUFPLFNBQVNzSyxHQUNoQyxHQUFJNFEsR0FBTWxRLEVBQU9WLEVBQUVuSyxHQUNSLE9BQVArYSxHQUNBQyxRQUFRQyxJQUFJcFEsRUFBUVYsR0FFeEJBLEVBQUVuQixFQUFJK1IsRUFBSS9SLEVBQ1ZtQixFQUFFaEIsRUFBSTRSLEVBQUk1UixJQUVkM0YsRUFBVXFFLFlBQVlwTSxLQUFLK0gsRUFBVyxXQUNsQ3NPLEVBQVdvSixvQkFBb0J6ZixLQUFLcVcsU0FFckMsQ0FHSHRPLEVBQVVSLE1BQU1lLFdBQVksRUFFNUJQLEVBQVVxRSxZQUFZLFdBQ2xCaUssRUFBV29KLG9CQUFvQnpmLEtBQUtxVyxLQUV4QzlPLEVBQU0rVyxNQUFNL1csRUFBTTZXLGNBQWdCclcsRUFBVXlELFFBQVFvRyxZQUNoQjdKLEVBQVV5RCxRQUFRcUcsUUFDdEQsSUFBSXpDLEtBQ0oxSyxHQUFFQyxRQUFRb0QsRUFBVTNELE1BQU8sU0FBU3NLLEdBQ2hDVSxFQUFPVixFQUFFbkssS0FBT2dKLEVBQUVtQixFQUFFbkIsRUFBR0csRUFBRWdCLEVBQUVoQixLQUUvQm5HLEVBQU02SCxPQUFPN0gsRUFBTTZXLGFBQWVoUCxNQWpyQnVFdkwsSUFBQSxhQUFBcEQsTUFBQSxTQTZyQnRHdUYsR0FDUCxHQUFJK0IsR0FBWXpELEtBQUtzSSxNQUNqQmdVLEVBQWE3WSxFQUFVUixNQUFNa1Esb0JBQzdCbFEsRUFBUVEsRUFBVVIsTUFBTW1RLG1CQUc1QixJQUFxQyxJQUFqQzNQLEVBQVUzRCxNQUFNdUMsUUFBUVgsR0FBNUIsQ0FJQSxHQUFJUixHQUFrQnVDLEVBQVUrSSxXQUFXdEwsZ0JBQ3ZDaEIsRUFBT3dCLEVBQUt6QixFQUVoQixNQUFJaUIsRUFBZ0JhLFNBQVNNLFFBQVFuQyxHQUFRLElBQTdDLENBT0EsSUFBSyxHQUhEMkIsR0FBU0gsRUFBS0csT0FDZHFXLEtBQ0FxRSxLQUNLcGQsRUFBSSxFQUFHQSxFQUFJc0UsRUFBVTNELE1BQU1WLE9BQVFELElBRWlCLElBQXJEc0UsRUFBVTNELE1BQU1YLEdBQUd3QyxVQUFVVSxRQUFRWCxFQUFLRyxRQUMxQzBhLEVBQVk5YixLQUFLZ0QsRUFBVTNELE1BQU1YLEdBQUdjLElBRXBDaVksRUFBY3pYLEtBQUtnRCxFQUFVM0QsTUFBTVgsR0FHM0MsSUFBSWdaLEdBQWN6VyxFQUFLRyxNQUN2QjBhLEdBQVk5YixLQUFLaUIsRUFBS0csT0FFdEIsSUFBSVYsR0FBbUJzQyxFQUFVK0ksV0FBV3JMLGlCQUN4Q0QsRUFBa0J1QyxFQUFVK0ksV0FBV3RMLGdCQUt2QzBGLEVBQVEzRCxFQUFNNlcsWUFBWXpYLFFBQVFSO0FBQ04sTUFBNUJWLEVBQWlCVSxHQUNqQm9CLEVBQU02VyxZQUFZbFQsR0FBU3pGLEVBQWlCVSxHQUU1Q29CLEVBQU02VyxZQUFZalQsT0FBT0QsRUFBTyxFQUtwQyxJQUFJNFYsS0FHSixJQUFpQyxJQUE3QnZaLEVBQU02VyxZQUFZMWEsT0FBYyxDQVFoQyxHQUFJdUMsR0FBWVIsRUFBaUJPLEVBQUt6QixHQUN0QzBCLEdBQVVsQixLQUFLd0MsRUFBTTZXLFlBQVksSUFHakNuWSxFQUFZQSxFQUFVMlEsT0FBT25SLEVBQWlCOEIsRUFBTTZXLFlBQVksU0FDaEUxWixFQUFFQyxRQUFRYSxFQUFnQmEsU0FBVSxTQUFTcUksR0FDWixLQUF6QnpJLEVBQVVVLFFBQVErSCxJQUNZLElBQTFCbVMsRUFBWWxhLFFBQVErSCxJQUN4Qm9TLEVBQVUvYixLQUFLMkosS0FHdkJtUyxFQUFjQSxFQUFZakssT0FBT2tLLE9BQ0csS0FBN0J2WixFQUFNNlcsWUFBWTFhLFNBSXpCZ0IsRUFBRUMsUUFBUWEsRUFBZ0JhLFNBQVUsU0FBU3FJLEdBQ1gsSUFBMUJtUyxFQUFZbGEsUUFBUStILElBQ3BCb1MsRUFBVS9iLEtBQUsySixLQUd2Qm1TLEVBQWNBLEVBQVlqSyxPQUFPa0ssR0FJckMsSUFBSTlULEdBQVNoSCxFQUFLZ0gsT0FBU2pGLEVBQVVTLE9BQU95SSxZQUN4QzhLLEVBQU8vVixFQUFLdUgsRUFDWnlPLEVBQU9oVyxFQUFLMEgsRUFDWnZILEVBQVNILEVBQUtDLFVBQVUsR0FDeEJBLEVBQVlELEVBQUtDLFVBQVV1UyxNQUFNLEdBQ2pDM1QsRUFBVSxHQUFJTyxHQUFlbkIsS0FBSzhYLEVBQU1DLEVBQU1TLEVBQWFBLEVBQWF6UCxFQUFRN0csRUFBUUYsRUFDNUY4QixHQUFVM0QsTUFBTVcsS0FBS0YsRUFHckIsS0FBSyxHQUFJcEIsR0FBSSxFQUFHQSxFQUFJK1ksRUFBYzlZLE9BQVFELElBQUssQ0FDM0MsR0FBSWlaLEdBQWlCRixFQUFjL1ksRUFDbkNzRSxHQUFVM0QsTUFBTStHLE9BQU9wRCxFQUFVM0QsTUFBTXVDLFFBQVErVixHQUFpQixHQUNoRTNVLEVBQVVzRSxtQkFBbUJxUSxHQVNqQyxJQUFLLEdBTkQvSixHQUFVNUssRUFBVStJLFdBQVd4SyxrQkFBa0J1YSxHQUVqREUsS0FHQXRjLEVBQVdrTyxFQUFRbE8sU0FDZGhCLEVBQUksRUFBR0EsRUFBSWdCLEVBQVNmLE9BQVFELElBQ1MsS0FBdENxZCxFQUFVbmEsUUFBUWxDLEVBQVNoQixHQUFHYyxLQUM5QndjLEVBQWVoYyxLQUFLTixFQUFTaEIsR0FLckMsSUFBSWtKLEdBQVc1RSxFQUFVK0ksV0FBV2tRLGdCQUFnQkQsRUFDcERyYyxHQUFFQyxRQUFRZ0ksRUFBVSxTQUFTK0IsR0FDekJBLEVBQUUxQixPQUFTMEIsRUFBRTFCLFFBQVVqRixFQUFVUyxPQUFPTSxjQUU1Q2YsRUFBVTNELE1BQVEyRCxFQUFVM0QsTUFBTXdTLE9BQU9qSyxHQUV6QzVFLEVBQVUxRCxNQUFRMEQsRUFBVStJLFdBQVc4QixnQkFBZ0JELEVBQVEzTixTQUFVK0MsRUFBVTNELE9BS2xELElBQTdCbUQsRUFBTTZXLFlBQVkxYSxPQUNsQmdCLEVBQUVDLFFBQVFvRCxFQUFVMUQsTUFBTyxTQUFTNkgsR0FFTyxLQUFuQzRVLEVBQVVuYSxRQUFRdUYsRUFBRWhILE9BQU9YLElBQ3ZCZ0QsRUFBTTZXLFlBQVksS0FBT2xTLEVBQUUzSSxPQUFPNEMsUUFDbEMyYSxFQUFVM1YsT0FBTzJWLEVBQVVuYSxRQUFRdUYsRUFBRWhILE9BQU9YLElBQUssR0FFWCxLQUFuQ3VjLEVBQVVuYSxRQUFRdUYsRUFBRTNJLE9BQU9nQixLQUM5QmdELEVBQU02VyxZQUFZLEtBQU9sUyxFQUFFaEgsT0FBT2lCLFFBQ2xDMmEsRUFBVTNWLE9BQU8yVixFQUFVbmEsUUFBUXVGLEVBQUUzSSxPQUFPZ0IsSUFBSyxLQVE3RHVjLElBS0osSUFBSUcsS0FDSixJQUF5QixJQUFyQkgsRUFBVXBkLE9BQ1YsSUFBSyxHQUFJRCxHQUFJLEVBQUdBLEVBQUlzRSxFQUFVM0QsTUFBTVYsU0FDaUIsS0FBN0NvZCxFQUFVbmEsUUFBUW9CLEVBQVUzRCxNQUFNWCxHQUFHYyxNQUNyQ3VjLEVBQVUzVixPQUFPMlYsRUFBVW5hLFFBQVFvQixFQUFVM0QsTUFBTVgsR0FBR2MsSUFBSyxHQUMzRHdELEVBQVVzRSxtQkFBbUJ0RSxFQUFVM0QsTUFBTVgsSUFDN0N3ZCxFQUFhbGMsS0FBS2dELEVBQVUzRCxNQUFNWCxJQUNULElBQXJCcWQsRUFBVXBkLFNBTHNCRCxLQW9CaEQsTUFUQWlCLEdBQUVDLFFBQVFzYyxFQUFjLFNBQVN2UyxHQUM3QjNHLEVBQVUzRCxNQUFNK0csT0FBT3BELEVBQVUzRCxNQUFNdUMsUUFBUStILEdBQUksS0FHdkQzRyxFQUFVNkIsWUFDVjdCLEVBQVU4QixZQUVWK1csRUFBV3JGLFdBQVdwUSxPQUFPeVYsRUFBV3JGLFdBQVc1VSxRQUFROUIsRUFBUU4sSUFBSyxHQUVqRU0sT0FsMkJzR2hCLElBQUEsZ0JBQUFwRCxNQUFBLFNBODJCbkdvRSxHQUNWLEdBQUlrRCxHQUFZekQsS0FBS3NJLE1BQ2pCeUosRUFBYS9SLEtBQ2JpRCxFQUFRUSxFQUFVUixNQUFNbVEsbUJBTU0sS0FBOUJuUSxFQUFNNFcsYUFBYXphLFFBQ25CNkQsRUFBTTRXLGFBQWE1VyxFQUFNNFcsYUFBYXphLE9BQVMsR0FBR2EsS0FBT00sRUFBUU4sR0FDakVnRCxFQUFNNFcsYUFBYXVDLE1BRW5CblosRUFBTTRXLGFBQWFwWixNQUFNUixHQUFHTSxFQUFRTixHQUFJNkcsTUFBTSxRQUdsRCxJQUFJNUYsR0FBa0J1QyxFQUFVK0ksV0FBV3RMLGVBbUIzQyxJQWpCQWQsRUFBRUMsUUFBUW9ELEVBQVUzRCxNQUFPLFNBQVMrRSxHQUNoQ0EsRUFBRXVPLHVCQUNFaFQsRUFBRTBCLFNBQVNaLEVBQWdCK0IsRUFBTTZXLFlBQVksSUFDekNqVixFQUFFNUUsSUFDTjRFLEVBQUV1TyxvQkFBb0IySCxLQUFPLFFBRTdCbFcsRUFBRXVPLG9CQUFvQjJILEtBQU8sY0FLVCxNQUF4QjlYLEVBQU1tWCxnQkFDNkIsSUFBOUJuWCxFQUFNNFcsYUFBYXphLFFBQ3hCNkQsRUFBTW1YLGVBQWVVLE9BQU8sT0FBUSxHQUlqQixNQUFuQjdYLEVBQU1vWCxVQUFtQixDQUN6QixHQUFJN1osR0FBTyxFQUNQeUMsR0FBTTZXLFlBQVkxYSxPQUFTLElBQzNCb0IsR0FBUXlDLEVBQU02VyxZQUFZLElBRUcsSUFBN0I3VyxFQUFNNlcsWUFBWTFhLFNBQ2xCb0IsR0FBUSxNQUFReUMsRUFBTTZXLFlBQVksSUFFdEM3VyxFQUFNb1gsVUFBVTdaLEtBQUtBLEdBRXpCdVIsRUFBV3NLLGVBMzVCa0c5YyxJQUFBLGdCQUFBcEQsTUFBQSxXQW02QjdHLEdBTUl1RixHQU5BK0IsRUFBWXpELEtBQUtzSSxNQUNqQnlKLEVBQWEvUixLQUNiaUQsRUFBUVEsRUFBVVIsTUFBTW1RLG9CQUV4QndKLEVBQU8zWixFQUFNNFcsYUFBYTVXLEVBQU00VyxhQUFhemEsT0FBUyxHQUN0RGEsRUFBSzJjLEVBQUszYyxFQUVkLElBQW1CLFNBQWYyYyxFQUFLOVYsTUFBa0IsQ0FDdkJwRixFQUFPK0IsRUFBVTlDLGFBQWFWLEVBQzlCLElBQUkrRyxHQUFTdkQsRUFBVW9aLFdBQVc1YyxFQUNsQzhSLEdBQVcrSyxTQUFTOVYsRUFBUXRGLE9BQ3pCLENBQ0gsR0FBSXFiLEdBQVN0WixFQUFVK0ksV0FBV3RMLGdCQUFnQmpCLEdBQUksRUFDdER5QixHQUFPK0IsRUFBVTlDLGFBQWFvYyxHQUM5QmpPLEtBQUFzRSxFQUFBclgsVUFBQVMsV0FBQVIsT0FBQXVGLGVBQUE2UixFQUFBclgsV0FBQSxXQUFBaUUsTUFBZXRFLEtBQUtxVyxFQUFZclEsUUFqN0J5RTBSLEdBQ25GRCxFQUFvQnRQLE9BcTdCdEQsUUFDSUEsT0FBUXVQLE1DbDhCcEIzVyxRQUFBQyxPQUFBLGdCQUNBZ0QsUUFBQSxjQUFBLFFBQUEsS0FBQSxTQUFBc2QsRUFBQUMsR0FDQSxRQUFBQyxHQUFBQyxHQUNBLEdBQUFDLEdBQUFILEVBQUFJLFFBQ0FuYSxFQUFBdkcsY0FBQVcsY0FBQTZmLEVBQUE1ZCxJQUFBLEdBUUEsT0FQQXlkLEdBQUFqTyxJQUFBN0wsR0FBQWlXLEtBQUEsU0FBQUMsR0FDQWdFLEVBQUFFLFFBQUFsRSxFQUFBOVksTUFDQTZjLEVBQUFJLFNBQUFuRSxFQUFBOVksS0FDQTZjLEVBQUFLLFVBQUEvYyxNQUFBUCxLQUFBaWQsRUFBQUksU0FBQSxTQUFBcGhCLE1BQUFnaEIsRUFBQUksU0FBQSxrQkFDQSxTQUFBbkUsR0FDQWdFLEVBQUFLLE9BQUFyRSxFQUFBOVksUUFFQThjLEVBQUFNLFFBRUEsUUFBQUMsR0FBQVIsR0FDQSxHQUFBamEsR0FBQXZHLGNBQUFXLGNBQUE2ZixFQUFBNWQsSUFBQSxHQUNBLE9BQUF5ZCxHQUFBWSxLQUFBMWEsRUFBQWlhLEVBQUFJLFVBR0EsUUFBQU0sR0FBQXRlLEdBQ0EsR0FBQTZkLEdBQUFILEVBQUFJLFFBQ0FuYSxFQUFBdkcsY0FBQVksc0JBQUFnQyxFQUFBLEdBTUEsT0FMQXlkLEdBQUFqTyxJQUFBN0wsR0FBQWlXLEtBQUEsU0FBQUMsR0FDQWdFLEVBQUFFLFFBQUFsRSxFQUFBOVksT0FDQSxTQUFBOFksR0FDQWdFLEVBQUFLLE9BQUFyRSxFQUFBOVksUUFFQThjLEVBQUFNLFFBRUEsT0FDQVIsT0FBQUEsRUFDQVMsVUFBQUEsRUFDQUUsY0FBQUEsTUNoQ0FwaEIsUUFBQUMsT0FBQSxnQkFDQXlaLFVBQUEsVUFBQSxXQUNBLE9BQ0FDLFNBQUEsSUFDQXpFLFlBQUEsa0JBQ0EwRSxPQUNBNkUsSUFBQSxJQUNBOVQsTUFBQSxRQ1BBM0ssUUFBQUMsT0FBQSxnQkFDQWdELFFBQUEsY0FBQSxRQUFBLEtBQUEsU0FBQXNkLEVBQUFDLEdBQ0EsUUFBQWEsS0FDQSxHQUFBVixHQUFBSCxFQUFBSSxRQUNBbmEsRUFBQXZHLGNBQUE0Qix5QkFNQSxPQUxBeWUsR0FBQWpPLElBQUE3TCxHQUFBaVcsS0FBQSxTQUFBQyxHQUNBZ0UsRUFBQUUsUUFBQWxFLEVBQUE5WSxPQUNBLFNBQUE4WSxHQUNBZ0UsRUFBQUssT0FBQXJFLEVBQUE5WSxRQUVBOGMsRUFBQU0sUUFFQSxRQUFBSyxLQUNBLEdBQUFYLEdBQUFILEVBQUFJLFFBQ0FuYSxFQUFBdkcsY0FBQTJCLHVCQU1BLE9BTEEwZSxHQUFBak8sSUFBQTdMLEdBQUFpVyxLQUFBLFNBQUFDLEdBQ0FnRSxFQUFBRSxRQUFBbEUsRUFBQTlZLE9BQ0EsU0FBQThZLEdBQ0FnRSxFQUFBSyxPQUFBckUsRUFBQTlZLFFBRUE4YyxFQUFBTSxRQUVBLE9BQ0FJLGNBQUFBLEVBQ0FDLFlBQUFBLE1DeEJBdGhCLFFBQUFDLE9BQUEsZ0JBQ0FxRyxRQUFBLGlCQUFBLFNBQUFDLEdBQ0FBLEVBQ0FDLE1BQUEsK0JBQ0FDLElBQUEsYUFDQTBPLFdBQUEsaURBQ0F4TyxTQUFBLHVGQUdBd08sV0FBQSx5QkFBQSxTQUFBLFlBQUEsYUFDQSxTQUFBb00sRUFBQUMsRUFBQUMsR0FFQSxRQUFBSixLQUNBSSxFQUFBSixnQkFBQTNFLEtBQUEsU0FBQUMsR0FDQStFLEVBQUFDLFdBQUFoRixHQUNBLFNBQUFBLEdBRUErRSxFQUFBQyxZQUNBaFAsS0FBQSx3RkFQQSxHQUFBK08sR0FBQW5lLElBV0E4ZCxJQUNBLElBQUFKLEVBRUFqaEIsU0FBQTRoQixVQUFBWCxLQUNBQSxFQUFBTyxFQUFBLFdBQ0FILEtBQ0FuaEIsY0FBQStCLG1CQUdBc2YsRUFBQU0sSUFBQSxXQUFBLFdBQ0FMLEVBQUFNLE9BQUFiLFFDN0JBamhCLFFBQUFDLE9BQUEsZ0JBQ0FxRyxRQUFBLGlCQUFBLFNBQUFDLEdBQ0FBLEVBQ0FDLE1BQUEsZ0NBQ0FDLElBQUEsbUJBQ0EwTyxXQUFBLDJDQUNBRCxZQUFBLGlDQUdBQyxXQUFBLHNCQUNBLFNBQUEsZUFBQSxhQUFBLG9CQUFBLGVBQ0EsU0FBQUUsRUFBQThELEVBQUE0SSxFQUFBcEosRUFBQXFKLEdBRUEsUUFBQUMsS0FDQTVNLEVBQUFlLEdBQUEsa0NBQUF0VCxJQUFBcVcsRUFBQXJXLE1BRUEsUUFBQW9mLEtBQ0FELElBRUEsUUFBQUUsS0FDQUMsRUFBQWhHLEtBQUFDLFNBQ0ExRCxFQUFBTSxnQkFBQW1KLEdBQ0F6SixFQUFBMkQsWUFBQThGLEdBQ0FBLEVBQUFDLFdBQUFoZixPQUFBOFYsRUFBQXJXLEtBQ0FrZixFQUFBTSxpQkFBQUYsR0FDQUosRUFBQU8sZ0JBQUFILEdBQ0FMLEVBQUFJLFdBQUFDLEVBQUFDLFlBQUEzRixLQUFBLFNBQUFDLEdBQ0FoRSxFQUFBSyxXQUFBb0osR0FDQUgsS0FDQSxTQUFBdEYsR0FDQWhFLEVBQUFLLFdBQUFvSixHQUNBekosRUFBQWlFLGdCQUFBd0YsRUFBQXpGLE1BbkJBLEdBQUF5RixHQUFBN2UsSUF1QkE2ZSxHQUFBQyxjQUNBRCxFQUFBSSxjQUNBSixFQUFBSyxvQkFDQUwsRUFBQU0sZ0JBQ0FWLEVBQUFXLFlBQUFQLEdBQ0FBLEVBQUFGLHdCQUFBQSxFQUNBRSxFQUFBRCxXQUFBQSxFQUNBeEosRUFBQUssV0FBQW9KLEdBQ0F6SixFQUFBTSxnQkFBQW1KLE1DM0NBcGlCLFFBQUFDLE9BQUEsZ0JBQ0FxRyxRQUFBLGlCQUFBLFNBQUFDLEdBQ0FBLEVBQ0FDLE1BQUEsNkJBQ0FDLElBQUEsZ0JBQ0EwTyxXQUFBLHFDQUNBRCxZQUFBLDJCQUVBMU8sTUFBQSxrQ0FDQUMsSUFBQSxRQUNBME8sV0FBQSxxQ0FDQUQsWUFBQSx3QkFFQTFPLE1BQUEsbUNBQ0FDLElBQUEsU0FDQTBPLFdBQUEscUNBQ0FELFlBQUEseUJBRUExTyxNQUFBLGtDQUNBQyxJQUFBLFFBQ0EwTyxXQUFBLHFDQUNBRCxZQUFBLHdCQUVBMU8sTUFBQSxrQ0FDQUMsSUFBQSxRQUNBME8sV0FBQSxxQ0FDQUQsWUFBQSwyQkFHQUMsV0FBQSxtQkFBQSxTQUFBLGVBQUEsU0FBQSxZQUFBLGFBQUEsYUFDQSxTQUFBRSxFQUFBOEQsRUFBQW9JLEVBQUFDLEVBQUFPLEVBQUFhLEdBR0EsUUFBQUMsS0FDQSxHQUFBUixJQUNBaGYsT0FBQThWLEVBQUFyVyxLQUVBaWYsR0FBQWMsYUFBQVIsR0FBQTNGLEtBQUEsU0FBQUMsR0FFQW1HLEVBQUFDLHNCQUFBLEVBQ0FELEVBQUFFLHlCQUFBLEVBQ0FGLEVBQUFHLHNCQUFBLElBR0EsUUFBQUMsS0FDQSxHQUFBYixJQUNBaGYsT0FBQThWLEVBQUFyVyxLQUVBaWYsR0FBQW1CLFFBQUFiLEdBQUEzRixLQUFBLFNBQUFDLEdBRUFtRyxFQUFBQyxzQkFBQSxFQUNBRCxFQUFBRSx5QkFBQSxFQUNBRixFQUFBRyxzQkFBQSxJQU1BLFFBQUFFLEtBQ0EsT0FBQUwsRUFBQTdkLEtBQUEsZ0JBQUFtZSxRQUNBLElBQUEsY0FDQU4sRUFBQUMsc0JBQUEsRUFDQUQsRUFBQUUseUJBQUEsRUFDQUYsRUFBQUcsc0JBQUEsQ0FDQSxNQUNBLEtBQUEsaUJBQ0FILEVBQUFDLHNCQUFBLEVBQ0FELEVBQUFFLHlCQUFBLEVBQ0FGLEVBQUFHLHNCQUFBLENBQ0EsTUFDQSxLQUFBLGVBQ0FILEVBQUFDLHNCQUFBLEVBQ0FELEVBQUFFLHlCQUFBLEVBQ0FGLEVBQUFHLHNCQUFBLENBQ0EsTUFDQSxLQUFBLFlBQ0FILEVBQUFDLHNCQUFBLEVBQ0FELEVBQUFFLHlCQUFBLEVBQ0FGLEVBQUFHLHNCQUFBLENBQ0EsTUFDQSxLQUFBLFlBQ0FILEVBQUFDLHNCQUFBLEVBQ0FELEVBQUFFLHlCQUFBLEVBQ0FGLEVBQUFHLHNCQUFBLENBQ0EsTUFDQSxLQUFBLGNBQ0FILEVBQUFDLHNCQUFBLEVBQ0FELEVBQUFFLHlCQUFBLEVBQ0FGLEVBQUFHLHNCQUFBLENBQ0EsTUFDQSxTQUNBSCxFQUFBQyxzQkFBQSxFQUNBRCxFQUFBRSx5QkFBQSxFQUNBRixFQUFBRyxzQkFBQSxHQUlBLFFBQUFJLEdBQUFDLEdBQ0F2QixFQUFBd0IsY0FBQXBLLEVBQUFyVyxJQUFBd2dCLEdBQ0E1RyxLQUFBLFNBQUF6WCxHQUNBNmQsRUFBQTdkLEtBQUFBLEVBQ0FrZSxNQUdBLFFBQUFLLEtBQ0FuTyxFQUFBb08sR0FBQSxrQ0FDQVgsRUFBQWhKLEtBQUEsT0FHQWdKLEVBQUFoSixLQUFBLFVBR0EsUUFBQTRKLEtBQ0FyTyxFQUFBZSxHQUFBLGtDQUVBLFFBQUF1TixLQUNBYixFQUFBMUcsS0FBQUMsU0FDQXlHLEVBQUFoQyxTQUFBaGUsSUFBQXFXLEVBQUFyVyxJQUVBZ2dCLEVBQUEvQixVQUFBbmQsUUFBQSxTQUFBZ2dCLEdBQ0FkLEVBQUFoQyxTQUFBLFNBQUE4QyxFQUFBbmdCLEtBQ0FxZixFQUFBaEMsU0FBQSxlQUFBOEMsRUFBQWxrQixRQUVBa2pCLEVBQUExQixVQUFBNEIsR0FBQXBHLEtBQUEsU0FBQUMsR0FDQW1HLEVBQUFoQyxTQUFBbkUsRUFBQXJXLE9BQUF6QyxLQUNBNmYsS0FDQSxTQUFBL0csT0FJQSxRQUFBa0gsS0FDQWpCLEVBQUFuQyxPQUFBcUMsR0FBQXBHLEtBQUEsU0FBQUMsR0FDQW1HLEVBQUFoQyxTQUFBbkUsR0FDQSxTQUFBQSxNQUdBLFFBQUF5RSxLQUNBd0IsRUFBQXhCLGNBQUFqSSxFQUFBclcsS0FBQTRaLEtBQUEsU0FBQUMsR0FDQW1HLEVBQUFnQixRQUFBbkgsRUFDQW1HLEVBQUFpQixPQUFBcEgsRUFBQXFILEtBQUFELE9BQ0FqQixFQUFBbUIsZUFBQXRILEVBQUFxSCxLQUFBRCxRQUNBLFNBQUFwSCxNQTlHQSxHQUFBbUcsR0FBQXZmLElBQ0F1ZixHQUFBb0IsY0FBQWhrQixjQUFBbUMsYUFnSEF5Z0IsRUFBQUQsYUFBQUEsRUFDQUMsRUFBQUksUUFBQUEsRUFDQUosRUFBQVUsUUFBQUEsRUFDQVYsRUFBQWEsY0FBQUEsRUFDQWIsRUFBQVksYUFBQUEsRUFDQVosRUFBQS9CLGFBQ0ErQixFQUFBaEMsWUFDQWdDLEVBQUFoZ0IsSUFBQXFXLEVBQUFyVyxJQUNBK2dCLElBQ0F6QyxJQUNBb0MsSUFFQUgsR0FBQSxFQUNBLElBQUFwQyxFQUVBamhCLFNBQUE0aEIsVUFBQVgsS0FDQUEsRUFBQU8sRUFBQSxXQUNBNkIsR0FBQSxJQUNBLE1BR0E5QixFQUFBTSxJQUFBLFdBQUEsV0FDQUwsRUFBQU0sT0FBQWIsUUN0S0FqaEIsUUFBQUMsT0FBQSxnQkFDQXlaLFVBQUEsZ0JBQUEsV0FDQSxPQUNBQyxTQUFBLElBQ0FDLE9BQ0EzVSxLQUFBLEtBRUFpUSxZQUFBLDJCQUdBd0UsVUFBQSxlQUFBLFdBQ0EsT0FDQUMsU0FBQSxJQUNBQyxPQUNBM1UsS0FBQSxLQUVBaVEsWUFBQSwwQkNuQkFsVixRQUFBQyxPQUFBLGdCQUNBcUcsUUFBQSxpQkFBQSxTQUFBQyxHQUNBQSxFQUNBQyxNQUFBLDhCQUNBQyxJQUFBLFlBQ0EwTyxXQUFBLHVDQUNBRCxZQUFBLCtCQUdBQyxXQUFBLG9CQUNBLFNBQUEsZUFBQSxhQUFBLG9CQUFBLGVBQ0EsU0FBQUUsRUFBQThELEVBQUE0SSxFQUFBcEosRUFBQXFKLEdBRUEsUUFBQW1DLEtBQ0E5TyxFQUFBZSxHQUFBLDBCQUVBLFFBQUFnTyxLQUNBRCxJQUVBLFFBQUFFLEtBQ0FDLEVBQUFsSSxLQUFBQyxTQUNBMUQsRUFBQU0sZ0JBQUFxTCxHQUNBM0wsRUFBQTJELFlBQUFnSSxHQUNBQyxJQUNBdkMsRUFBQU8sZ0JBQUErQixHQUNBdkMsRUFBQXNDLFNBQUFDLEVBQUFqQyxZQUFBM0YsS0FBQSxTQUFBQyxHQUNBaEUsRUFBQUssV0FBQXNMLEdBQ0FILEtBQ0EsU0FBQXhILEdBQ0FoRSxFQUFBSyxXQUFBc0wsR0FDQTNMLEVBQUFpRSxnQkFBQTBILEVBQUEzSCxNQUlBLFFBQUE0SCxLQUNBRCxFQUFBakMsV0FBQW1DLE1BQUE3Z0IsRUFBQWlILE1BQUEwWixFQUFBRyxXQUFBLFdBdkJBLEdBQUFILEdBQUEvZ0IsSUF5QkErZ0IsR0FBQWpDLGNBQ0FpQyxFQUFBOUIsY0FDQThCLEVBQUE3QixvQkFDQTZCLEVBQUE1QixnQkFDQTRCLEVBQUFHLFdBQUEsR0FDQXpDLEVBQUFXLFlBQUEyQixHQUNBQSxFQUFBRCxTQUFBQSxFQUNBQyxFQUFBRixzQkFBQUEsRUFDQXpMLEVBQUFLLFdBQUFzTCxHQUNBM0wsRUFBQU0sZ0JBQUFxTCxNQzlDQXRrQixRQUFBQyxPQUFBLGdCQUNBcUcsUUFBQSxpQkFBQSxTQUFBQyxHQUNBQSxFQUNBQyxNQUFBLDZCQUNBQyxJQUFBLFdBQ0EwTyxXQUFBLDZDQUNBeE8sU0FBQSxpRkFHQXdPLFdBQUEsdUJBQUEsU0FBQSxZQUFBLGFBQ0EsU0FBQW9NLEVBQUFDLEVBQUFDLEdBRUEsUUFBQUgsS0FDQUcsRUFBQUgsY0FBQTVFLEtBQUEsU0FBQUMsR0FDQStILEVBQUFDLFNBQUFoSSxHQUNBLFNBQUFBLE1BSkEsR0FBQStILEdBQUFuaEIsSUFPQStkLElBQ0EsSUFBQUwsRUFFQWpoQixTQUFBNGhCLFVBQUFYLEtBQ0FBLEVBQUFPLEVBQUEsV0FDQUYsS0FDQXBoQixjQUFBK0IsbUJBR0FzZixFQUFBTSxJQUFBLFdBQUEsV0FDQUwsRUFBQU0sT0FBQWIsUUN6QkFqaEIsUUFBQUMsT0FBQSxnQkFDQXFHLFFBQUEsaUJBQUEsU0FBQUMsR0FDQUEsRUFDQUMsTUFBQSwwQkFDQUMsSUFBQSxRQUNBME8sV0FBQSwrQkFDQUQsWUFBQSwyQkFHQUMsV0FBQSxnQkFBQSxTQUFBLFlBQUEsVUFBQSxhQUFBLG9CQUNBLFNBQUFvTSxFQUFBQyxFQUFBb0QsRUFBQTdDLEVBQUFwSixHQUVBLFFBQUFrTSxHQUFBdkIsR0FDQXZCLEVBQUF6UCxJQUFBZ1IsR0FDQTVHLEtBQUEsU0FBQUMsR0FDQWhFLEVBQUFLLFdBQUE4TCxHQUNBQSxFQUFBemhCLE1BQUFzWixHQUNBLFNBQUFBLEdBQ0FoRSxFQUFBSyxXQUFBOEwsS0FQQSxHQUFBQSxHQUFBdmhCLElBV0FzaEIsSUFBQSxFQUNBLElBQUE1RCxFQUVBamhCLFNBQUE0aEIsVUFBQVgsS0FDQUEsRUFBQU8sRUFBQSxXQUNBcUQsR0FBQSxJQUNBM2tCLGNBQUErQixtQkFHQXNmLEVBQUFNLElBQUEsV0FBQSxXQUNBTCxFQUFBTSxPQUFBYixRQ25DQWpoQixRQUFBQyxPQUFBLHdCQUNBcUcsUUFBQSxpQkFBQSxTQUFBQyxHQUNBQSxFQUNBQyxNQUFBLG9DQUNBQyxJQUFBLFVBQ0F5TyxZQUFBLHdDQUNBQyxXQUFBLHdEQUdBQSxXQUFBLDBCQUFBLFNBQUEscUJBQUEsb0JBQ0EsU0FBQUUsRUFBQTBQLEVBQUFwTSxHQUVBLFFBQUFxTSxLQUNBM1AsRUFBQWUsR0FBQSxrQ0FFQSxRQUFBNkYsS0FDQStJLElBRUEsUUFBQUMsS0FHQUMsRUFBQTlJLEtBQUFDLFNBQ0ExRCxFQUFBTSxnQkFBQWlNLEdBQ0F2TSxFQUFBMkQsWUFBQTRJLEdBQ0FBLEVBQUFDLGdCQUFBcmlCLElBQUFvaUIsRUFBQUMsZ0JBQUEzSSxXQUNBdUksRUFBQXZsQixPQUFBMGxCLEVBQUFDLGlCQUFBekksS0FBQSxTQUFBQyxHQUNBaEUsRUFBQUssV0FBQWtNLEdBQ0FGLEtBQ0EsU0FBQXJJLEdBQ0FoRSxFQUFBSyxXQUFBa00sR0FDQXZNLEVBQUFpRSxnQkFBQXNJLEVBQUF2SSxNQUlBLFFBQUFFLEtBQ0FsRSxFQUFBSyxXQUFBa00sR0FDQXZNLEVBQUFNLGdCQUFBaU0sR0FDQUEsRUFBQUMsaUJBQ0EzSSxXQUFBLElBM0JBLEdBQUEwSSxHQUFBM2hCLElBOEJBMmhCLEdBQUFELG1CQUFBQSxFQUNBQyxFQUFBakosZUFBQUEsRUFDQVksT0MzQ0E3YyxRQUFBQyxPQUFBLHdCQUNBcUcsUUFBQSxpQkFBQSxTQUFBQyxHQUNBQSxFQUNBQyxNQUFBLHFDQUNBQyxJQUFBLGdCQUNBME8sV0FBQSxxREFDQUQsWUFBQSw4Q0FHQUMsV0FBQSwyQkFBQSxTQUFBLGVBQUEscUJBQUEsb0JBQ0EsU0FBQUUsRUFBQThELEVBQUE0TCxFQUFBcE0sR0FFQSxRQUFBcU0sS0FDQTNQLEVBQUFlLEdBQUEsa0NBRUEsUUFBQWdQLEtBQ0F6TSxFQUFBTSxnQkFBQW9NLEdBQ0ExTSxFQUFBMkQsWUFBQStJLEdBQ0FOLEVBQUFBLFVBQUFNLEVBQUFDLGNBQUE1SSxLQUFBLFNBQUFDLEdBQ0FoRSxFQUFBSyxXQUFBcU0sR0FDQUwsS0FDQSxTQUFBckksR0FDQWhFLEVBQUFLLFdBQUFxTSxHQUNBMU0sRUFBQWlFLGdCQUFBeUksRUFBQTFJLEtBWkEsR0FBQTBJLEdBQUE5aEIsSUFlQW9WLEdBQUFLLFdBQUFxTSxHQUNBMU0sRUFBQU0sZ0JBQUFvTSxHQUNBTixFQUFBeEIsY0FBQXBLLEVBQUFyVyxLQUNBNFosS0FBQSxTQUFBNEksR0FDQUQsRUFBQUMsYUFBQUEsSUFFQUQsRUFBQUQsbUJBQUFBLEtDaENBcGxCLFFBQUFDLE9BQUEsbUJBQ0FxRyxRQUFBLGlCQUFBLFNBQUFDLEdBQ0FBLEVBQ0FDLE1BQUEsd0NBQ0FDLElBQUEsV0FDQTBPLFdBQUEsMkNBQ0FELFlBQUEscUNBR0FDLFdBQUEsc0JBQUEsZUFBQSxvQkFBQSxlQUNBLFNBQUFnRSxFQUFBUixFQUFBcUosR0FFQSxRQUFBdUQsS0FDQUMsRUFBQXBKLEtBQUFDLFNBQ0ExRCxFQUFBTSxnQkFBQXVNLEdBQ0E3TSxFQUFBMkQsWUFBQWtKLEdBQ0FBLEVBQUFuRCxXQUFBaGYsT0FBQThWLEVBQUFyVyxLQUNBa2YsRUFBQU0saUJBQUFrRCxHQUNBeEQsRUFBQU8sZ0JBQUFpRCxHQUNBeEQsRUFBQXlELGVBQUFELEVBQUFuRCxZQUFBM0YsS0FBQSxTQUFBQyxHQUNBaEUsRUFBQUssV0FBQXdNLElBQ0EsU0FBQTdJLEdBQ0FoRSxFQUFBSyxXQUFBd00sR0FDQTdNLEVBQUFpRSxnQkFBQTRJLEVBQUE3SSxNQVpBLEdBQUE2SSxHQUFBamlCLElBZ0JBaWlCLEdBQUFuRCxjQUNBbUQsRUFBQWhELGNBQ0FnRCxFQUFBL0Msb0JBQ0ErQyxFQUFBOUMsZ0JBQ0FWLEVBQUFXLFlBQUE2QyxHQUNBQSxFQUFBRCxzQkFBQUEsRUFDQTVNLEVBQUFLLFdBQUF3TSxHQUNBN00sRUFBQU0sZ0JBQUF1TSxNQy9CQXhsQixRQUFBQyxPQUFBLHFCQUNBcUcsUUFBQSxpQkFBQSxTQUFBQyxHQUNBQSxFQUNBQyxNQUFBLGlDQUNBQyxJQUFBLFVBQ0F5TyxZQUFBLG1DQUNBQyxXQUFBLGtEQUdBQSxXQUFBLHVCQUNBLFNBQUEsZUFBQSxrQkFBQSxnQkFBQSxvQkFDQSxTQUFBRSxFQUFBOEQsRUFBQXVNLEVBQUEzSixFQUFBcEQsR0FJQSxRQUFBZ04sS0FDQXRRLEVBQUFlLEdBQUEsK0JBRUEsUUFBQTZGLEtBQ0EwSixJQUtBLFFBQUFDLEtBQ0E3SixFQUFBekosTUFBQW9LLEtBQUEsU0FBQUMsR0FDQWtKLEVBQUFDLFNBQUFuaUIsRUFBQXVILE9BQUF5UixHQUNBSCxXQUFBLGNBSUEsUUFBQXVKLEtBRUFGLEVBQUFHLFVBQUFwaEIsYUFDQTVFLFFBQUE0RCxRQUFBaWlCLEVBQUFJLGVBQUEsU0FBQUMsR0FDQSxHQUFBQyxHQUFBRCxFQUFBemlCLEtBQUEsSUFBQXlpQixFQUFBeG1CLEtBQ0FtbUIsR0FBQUcsVUFBQXBoQixVQUFBWixLQUFBbWlCLEtBR0EsUUFBQUMsS0FDQUwsSUFHQUYsRUFBQXpKLEtBQUFDLFNBQ0ExRCxFQUFBTSxnQkFBQTRNLEdBQ0FsTixFQUFBMkQsWUFBQXVKLEdBQ0FBLEVBQUFHLFVBQUFsakIsSUFDQStpQixFQUFBRyxVQUFBeEosV0FBQSxJQUFBcUosRUFBQUcsVUFBQUssWUFDQVgsRUFBQWxtQixPQUFBcW1CLEVBQUFHLFdBQUF0SixLQUFBLFNBQUFDLEdBQ0FoRSxFQUFBSyxXQUFBNk0sR0FDQUYsS0FDQSxTQUFBaEosR0FDQWhFLEVBQUFLLFdBQUE2TSxHQUNBbE4sRUFBQWlFLGdCQUFBaUosRUFBQWxKLE1BSUEsUUFBQUUsS0FDQWxFLEVBQUFLLFdBQUE2TSxHQUNBbE4sRUFBQU0sZ0JBQUE0TSxHQUNBQSxFQUFBRyxXQUNBSyxZQUFBLEdBQ0E1SixZQUFBLEdBQ0E2SixVQUFBLEdBQ0ExaEIsYUFDQTJoQixTQUNBL0osV0FBQSxXQXREQSxHQUFBcUosR0FBQXRpQixJQUNBc2lCLEdBQUFJLGtCQUNBSixFQUFBQyxZQXVEQUQsRUFBQU8sZ0JBQUFBLEVBQ0FQLEVBQUE1SixlQUFBQSxFQUNBMkosSUFDQS9JLE9DeEVBN2MsUUFBQUMsT0FBQSxxQkFDQXFHLFFBQUEsaUJBQUEsU0FBQUMsR0FDQUEsRUFDQUMsTUFBQSxrQ0FDQUMsSUFBQSxnQkFDQXlTLFFBQUExUyxNQUFBLE1BQ0EyTyxXQUFBLCtDQUNBRCxZQUFBLHNDQUVBMU8sTUFBQSx1Q0FDQUMsSUFBQSxRQUNBME8sV0FBQSwrQ0FDQUQsWUFBQSxtQ0FFQTFPLE1BQUEsdUNBQ0FDLElBQUEsYUFDQTBPLFdBQUEsK0NBQ0FELFlBQUEsc0NBR0FDLFdBQUEsd0JBQUEsU0FBQSxlQUFBLGtCQUFBLG9CQUNBLFNBQUFFLEVBQUE4RCxFQUFBdU0sRUFBQS9NLEdBTUEsUUFBQTZLLEtBQ0FuTyxFQUFBb08sR0FBQSx1Q0FDQStDLEVBQUExTSxLQUFBLE9BR0EwTSxFQUFBMU0sS0FBQSxVQUdBLFFBQUE2TCxLQUNBdFEsRUFBQWUsR0FBQSwrQkFFQSxRQUFBcVEsS0FDQXBSLEVBQUFlLEdBQUEsdUNBQUF0VCxJQUFBMGpCLEVBQUFSLFVBQUFsakIsSUFBQTBELE1BQUEsWUFFQSxRQUFBa2dCLEtBQ0FELElBRUEsUUFBQUUsS0FDQWhPLEVBQUFNLGdCQUFBdU4sR0FDQTdOLEVBQUEyRCxZQUFBa0ssR0FDQWQsRUFBQUEsVUFBQWMsRUFBQVIsV0FBQXRKLEtBQUEsU0FBQUMsR0FDQWhFLEVBQUFLLFdBQUF3TixHQUNBYixLQUNBLFNBQUFoSixHQUNBaEUsRUFBQUssV0FBQXdOLEdBQ0E3TixFQUFBaUUsZ0JBQUE0SixFQUFBN0osS0FHQSxRQUFBaUssS0FDQWpPLEVBQUFNLGdCQUFBdU4sR0FDQTdOLEVBQUEyRCxZQUFBa0ssRUFDQSxJQUFBSyxHQUFBTCxFQUFBUixVQUFBcGhCLFNBQ0FtaEIsS0FDQUwsRUFBQXpILEtBQUF1SSxFQUFBUixXQUFBdEosS0FBQSxTQUFBQyxHQUNBaEUsRUFBQUssV0FBQXdOLEdBQ0FDLEtBQ0EsU0FBQTlKLEdBQ0E2SixFQUFBUixVQUFBcGhCLFVBQUFpaUIsRUFDQUMsSUFDQW5PLEVBQUFLLFdBQUF3TixHQUNBN04sRUFBQWlFLGdCQUFBNEosRUFBQTdKLEtBR0EsUUFBQW1LLEtBQ0E5bUIsUUFBQTRELFFBQUE0aUIsRUFBQVIsVUFBQXBoQixVQUFBLFNBQUFtaUIsR0FDQSxHQUFBQyxJQUNBdmpCLEtBQUFzakIsRUFBQWxjLE1BQUEsS0FBQSxHQUNBbkwsTUFBQXFuQixFQUFBbGMsTUFBQSxLQUFBLEdBRUEyYixHQUFBUCxlQUFBamlCLEtBQUFnakIsS0FHQSxRQUFBakIsS0FDQVMsRUFBQVIsVUFBQXBoQixhQUNBNUUsUUFBQTRELFFBQUE0aUIsRUFBQVAsZUFBQSxTQUFBQyxHQUNBLEdBQUFDLEdBQUFELEVBQUF6aUIsS0FBQSxJQUFBeWlCLEVBQUF4bUIsS0FDQThtQixHQUFBUixVQUFBcGhCLFVBQUFaLEtBQUFtaUIsS0E3REEsR0FBQUssR0FBQWpqQixJQUNBaWpCLEdBQUFQLGtCQStEQXROLEVBQUFLLFdBQUF3TixHQUNBN04sRUFBQU0sZ0JBQUF1TixHQUNBZCxFQUFBbkMsY0FBQXBLLEVBQUFyVyxLQUNBNFosS0FBQSxTQUFBc0osR0FDQVEsRUFBQVIsVUFBQUEsRUFDQWMsTUFFQU4sRUFBQUksY0FBQUEsRUFDQUosRUFBQUUsY0FBQUEsRUFDQUYsRUFBQUcsZ0JBQUFBLEVBQ0FuRCxPQ2hHQXhqQixRQUFBQyxPQUFBLHFCQUNBeVosVUFBQSxvQkFBQSxXQUNBLE9BQ0FDLFNBQUEsSUFDQUMsT0FDQXFOLE1BQUEsS0FFQTdpQixLQUFBLFNBQUF3VixHQU9BLFFBQUFzTixHQUFBQyxFQUFBQyxHQUNBLE1BQUFELEtBQUFDLEVBRUEsUUFBQUMsS0FDQXpOLEVBQUEwTixTQUNBQyxZQUFBLEdBQ0FDLGFBQUEsR0FDQUMsU0FBQSxJQUdBLFFBQUFDLEdBQUE5RCxHQUNBLE1BQUEsS0FBQUEsRUFBQTJELGFBQUEsS0FBQTNELEVBQUE0RCxjQUFBLEtBQUE1RCxFQUFBNkQsU0FFQTdOLEVBQUErTixJQUFBLFdBQ0EsSUFBQUQsRUFBQTlOLEVBQUEwTixTQUFBLENBRUFyaEIsU0FBQTJULEVBQUFxTixRQUNBck4sRUFBQXFOLFNBRUEsSUFBQVcsR0FBQWhPLEVBQUEwTixRQUFBQyxZQUFBLElBQ0EzTixFQUFBME4sUUFBQUUsYUFBQSxJQUNBNU4sRUFBQTBOLFFBQUFHLFFBRUE5akIsR0FBQWtrQixZQUFBak8sRUFBQXFOLE9BQUFXLEdBQUFWLEdBQ0F0TixFQUFBcU4sTUFBQWpqQixLQUFBNGpCLEdBQ0FQLE1BRUF6TixFQUFBdEssT0FBQSxTQUFBd1ksR0FDQW5rQixFQUFBMkwsT0FBQXNLLEVBQUFxTixNQUFBLFNBQUFyRCxHQUNBLE1BQUFzRCxHQUFBdEQsRUFBQWtFLE1BR0FULEtBRUFuUyxZQUFBLHFDQ2hEQWxWLFFBQUFDLE9BQUEsMEJBQ0FxRyxRQUFBLGlCQUFBLFNBQUFDLEdBQ0FBLEVBQ0FDLE1BQUEsc0NBQ0FDLElBQUEsVUFDQXlPLFlBQUEsNENBQ0FDLFdBQUEsMERBR0FBLFdBQUEsMkJBQUEsU0FBQSxlQUFBLHVCQUFBLG9CQUNBLFNBQUFFLEVBQUE4RCxFQUFBNE8sRUFBQXBQLEdBRUEsUUFBQXFQLEtBQ0EzUyxFQUFBZSxHQUFBLG9DQUVBLFFBQUE2RixLQUNBK0wsSUFFQSxRQUFBQyxLQUNBQyxFQUFBQyxlQUFBdmtCLFFBQUEsU0FBQWdnQixHQUNBc0UsRUFBQUUsaUJBQUFDLFlBQUF6RSxFQUFBbmdCLE1BQUFtZ0IsRUFBQWxrQixRQUdBLFFBQUE0b0IsS0FHQUosRUFBQTlMLEtBQUFDLFNBQ0ExRCxFQUFBTSxnQkFBQWlQLEdBQ0F2UCxFQUFBMkQsWUFBQTRMLEdBQ0FELElBQ0FGLEVBQUF2b0IsT0FBQTBvQixFQUFBRSxrQkFDQTFMLEtBQUEsU0FBQUMsR0FDQWhFLEVBQUFLLFdBQUFrUCxHQUNBRixLQUNBLFNBQUFyTCxHQUNBaEUsRUFBQUssV0FBQWtQLEdBQ0F2UCxFQUFBaUUsZ0JBQUFzTCxFQUFBdkwsTUFJQSxRQUFBRSxLQUNBbEUsRUFBQUssV0FBQWtQLEdBQ0F2UCxFQUFBTSxnQkFBQWlQLEdBQ0FBLEVBQUFFLGtCQUNBM2tCLEtBQUEsR0FDQThrQixVQUNBQyxLQUFBLE9BQ0FDLE1BQUEsT0FDQUMsU0FBQSxRQUVBQyxVQUFBLEVBQ0FDLFFBQ0FDLEtBQUEsT0FFQXJwQixRQUNBOE8sS0FBQSxJQUNBd2EsV0FBQSxJQUVBQyxTQUNBQyxXQUFBLEVBQ0FOLFVBQ0FPLFVBQUEsTUFDQUMsS0FBQSxJQUVBQyxjQUNBQyxhQUFBLEVBQ0FDLFlBQUEsRUFDQUMsWUFBQSxFQUNBQyxXQUFBLElBR0FsQixnQkE1REEsR0FBQUgsR0FBQTNrQixJQStEQTJrQixHQUFBSSxhQUFBQSxFQUNBSixFQUFBak0sZUFBQUEsRUFDQWlNLEVBQUFDLGtCQUNBdEwsT0M3RUE3YyxRQUFBQyxPQUFBLDBCQUNBcUcsUUFBQSxpQkFBQSxTQUFBQyxHQUNBQSxFQUNBQyxNQUFBLHVDQUNBQyxJQUFBLGdCQUNBME8sV0FBQSx1REFDQUQsWUFBQSwrQ0FFQTFPLE1BQUEsb0NBQ0FDLElBQUEsZ0JBQ0EwTyxXQUFBLHVEQUNBRCxZQUFBLGtEQUdBQyxXQUFBLDRCQUFBLFNBQUEsZUFBQSxTQUFBLFlBQUEsVUFBQSx1QkFBQSxlQUFBLG9CQUNBLFNBQUFFLEVBQUE4RCxFQUFBb0ksRUFBQUMsRUFBQW9ELEVBQUFtRCxFQUFBeUIsRUFBQTdRLEdBTUEsUUFBQTZLLEtBQ0FuTyxFQUFBb08sR0FBQSxvQ0FDQWdHLEVBQUEzUCxLQUFBLE9BR0EyUCxFQUFBM1AsS0FBQSxVQUdBLFFBQUE0UCxLQUNBclUsRUFBQWUsR0FBQSxvQ0FFQSxRQUFBdVQsS0FDQXRVLEVBQUFlLEdBQUEsdUNBQUF0VCxJQUFBMm1CLEVBQUFuZ0IsT0FBQTdGLE9BRUEsUUFBQWlqQixLQUNBaUQsSUFFQSxRQUFBQyxLQUNBalIsRUFBQU0sZ0JBQUF3USxHQUNBOVEsRUFBQTJELFlBQUFtTixHQUNBMUIsRUFBQThCLGVBQUFKLEVBQUFuZ0IsT0FBQTdGLEtBQUEsUUFBQWlaLEtBQUEsU0FBQUMsR0FDQWhFLEVBQUFLLFdBQUF5USxHQUNBQyxLQUNBLFNBQUEvTSxHQUNBaEUsRUFBQUssV0FBQXlRLEdBQ0E5USxFQUFBaUUsZ0JBQUE2TSxFQUFBOU0sS0FNQSxRQUFBbU4sR0FBQXhHLEdBQ0FrRyxFQUFBbFgsSUFBQWdSLEdBQUE1RyxLQUFBLFNBQUFDLEdBQ0E4TSxFQUFBTSxRQUFBbkYsRUFBQSxXQUFBamhCLEVBQUF1SCxPQUFBeVIsR0FDQXJULE9BQUFtZ0IsRUFBQW5nQixPQUFBN0YsT0FDQSxVQUdBLFFBQUF1bUIsS0FDQWhxQixRQUFBNEQsUUFBQTZsQixFQUFBbmdCLE9BQUErZSxZQUFBLFNBQUEzb0IsRUFBQW9ELEdBQ0FTLEtBQUFTLE1BQUFQLEtBQUFYLEVBQUFwRCxNQUFBQSxLQUNBK3BCLEVBQUF0QixnQkFFQSxRQUFBRixLQUNBd0IsRUFBQXRCLGVBQUF2a0IsUUFBQSxTQUFBZ2dCLEdBQ0E2RixFQUFBbmdCLE9BQUErZSxZQUFBekUsRUFBQW5nQixNQUFBbWdCLEVBQUFsa0IsUUFHQSxRQUFBdXFCLEtBR0FSLEVBQUFyTixLQUFBQyxTQUNBMUQsRUFBQU0sZ0JBQUF3USxHQUNBOVEsRUFBQTJELFlBQUFtTixHQUNBeEIsSUFDQUYsRUFBQTlKLEtBQUF3TCxFQUFBbmdCLFFBQUFvVCxLQUFBLFNBQUFDLEdBQ0FoRSxFQUFBSyxXQUFBeVEsR0FDQUUsS0FDQSxTQUFBaE4sR0FDQWhFLEVBQUFLLFdBQUF5USxHQUNBOVEsRUFBQWlFLGdCQUFBNk0sRUFBQTlNLE1BakVBLEdBQUE4TSxHQUFBbG1CLElBQ0FrbUIsR0FBQXRCLGtCQW9FQXhQLEVBQUFLLFdBQUF5USxHQUNBOVEsRUFBQU0sZ0JBQUF3USxHQUNBMUIsRUFBQXhFLGNBQUFwSyxFQUFBclcsS0FBQSxFQUFBLFFBQ0E0WixLQUFBLFNBQUFwVCxHQUNBbWdCLEVBQUFuZ0IsT0FBQUEsRUFDQTBnQixJQUNBRixHQUFBLEtBRUFMLEVBQUFHLGFBQUFBLEVBQ0FILEVBQUFRLFdBQUFBLEVBQ0FSLEVBQUEvQyxjQUFBQSxFQUNBbEQsR0FDQSxJQUFBdkMsRUFFQWpoQixTQUFBNGhCLFVBQUFYLEtBQ0FBLEVBQUFPLEVBQUEsV0FDQXNJLEdBQUEsSUFDQTVwQixjQUFBK0IsbUJBR0FzZixFQUFBTSxJQUFBLFdBQUEsV0FDQUwsRUFBQU0sT0FBQWIsUUMxR0FqaEIsUUFBQUMsT0FBQSwwQkFDQXlaLFVBQUEsZ0NBQUEsV0FDQSxXQUVBQSxVQUFBLHFDQUFBLFdBQ0EsT0FDQUMsU0FBQSxJQUNBQyxPQUNBdFEsT0FBQSxJQUNBNmUsZUFBQSxLQUVBL2pCLEtBQUEsU0FBQXdWLEdBQ0FBLEVBQUF5TyxhQUFBLE9BQUEsVUFFQW5ULFlBQUEsOENBR0F3RSxVQUFBLG1DQUFBLFdBQ0EsT0FDQUMsU0FBQSxJQUNBQyxPQUNBdFEsT0FBQSxLQUVBNEwsWUFBQSw0Q0FHQXdFLFVBQUEsZ0NBQUEsV0FDQSxPQUNBQyxTQUFBLElBQ0FDLE9BQ0F0USxPQUFBLEtBRUE0TCxZQUFBLHlDQUdBd0UsVUFBQSxpQ0FBQSxXQUNBLE9BQ0FDLFNBQUEsSUFDQUMsT0FDQXRRLE9BQUEsS0FFQTRMLFlBQUEsMENDMUNBbFYsUUFBQUMsT0FBQSx3QkFDQXFHLFFBQUEsaUJBQUEsU0FBQUMsR0FDQUEsRUFDQUMsTUFBQSxrQ0FDQUMsSUFBQSx5REFDQXlTLFFBQ0E3QyxXQUFBLEtBQ0FDLFdBQUEsS0FDQVAsV0FBQSxLQUNBQyxXQUFBLE1BRUFiLFdBQUEsaURBQ0FELFlBQUEsNENBSUFDLFdBQUEseUJBQUEsU0FBQSxRQUFBLFNBQUEsZUFBQSx1QkFBQSxZQUNBLFNBQUFvTSxFQUFBaEIsRUFBQWxMLEVBQUE4RCxFQUFBK1EsRUFBQTFJLEdBQ0EsR0FBQW5MLEdBQUE4QyxFQUFBOUMsV0FDQUMsRUFBQTZDLEVBQUE3QyxXQUNBUCxFQUFBb0QsRUFBQXBELFdBQ0FDLEVBQUFtRCxFQUFBbkQsVUFJQSxJQUFBLE1BQUFELEdBQUEsTUFBQUMsRUFFQSxXQURBWCxHQUFBZSxHQUFBLGlDQUlBLElBQUFoTyxHQUFBLEdBQUEraEIsTUFDQUMsRUFBQWhpQixFQUFBaWlCLFlBQ0E5SSxHQUFBK0ksaUJBQ0E5SSxFQUFBLFdBQ0EwSSxFQUFBSyxZQUFBeFUsRUFBQUMsRUFBQW9VLEVBQUFJLFlBQ0E5TixLQUFBLFNBQUFDLEdBQ0EsR0FBQThOLEdBQUE5TixFQUFBOE4sUUFDQTVtQixFQUFBLENBQ0FGLEdBQUFDLFFBQUE2bUIsRUFBQSxTQUFBbmUsR0FDQTNJLEVBQUF3QixRQUFBbUgsTUFBQSxJQUNBekksR0FBQXlJLEVBQUFvZSxPQUFBLEdBQUFDLE9BQUEsR0FBQSxNQUdBcEosRUFBQWxMLFdBQUFBLEVBQ0FrTCxFQUFBakwsV0FBQUEsRUFDQWlMLEVBQUFxSixTQUFBL21CLEVBQ0EwZCxFQUFBc0osYUFBQVQsR0FDQSxTQUFBek4sT0FFQSxLQUdBNEUsRUFBQU0sSUFBQSxXQUFBLFdBQUFMLEVBQUFNLE9BQUFQLEVBQUErSSxvQkFHQUosRUFBQVksZUFBQS9VLEVBQUFDLEdBQ0EwRyxLQUFBLFNBQUFDLEdBQ0EsR0FBQThOLEdBQUE5TixFQUFBOE4sUUFDQUcsSUFHQWpuQixHQUFBQyxRQUFBNm1CLEVBQUEsU0FBQW5lLEdBQ0EsR0FBQTNJLEVBQUF3QixRQUFBbUgsTUFBQSxFQUFBLENBQ0EsR0FBQXpJLEdBQUF5SSxFQUFBb2UsT0FBQSxHQUFBQyxNQUNBaG5CLEdBQUF3QixRQUFBeWxCLEdBQ0FqbkIsRUFBQUMsUUFBQUMsRUFBQSxTQUFBdUUsR0FDQXdpQixFQUFBNW1CLEtBQUFvRSxFQUFBLE1BR0F6RSxFQUFBQyxRQUFBQyxFQUFBLFNBQUF1RSxFQUFBMUYsR0FDQWtvQixFQUFBbG9CLElBQUEwRixFQUFBLFFBTUFtWixFQUFBbEwsV0FBQUEsRUFDQWtMLEVBQUFqTCxXQUFBQSxFQUNBaUwsRUFBQXhMLFdBQUFBLEVBQ0F3TCxFQUFBdkwsV0FBQUEsRUFDQXVMLEVBQUF3SixZQUFBSCxHQUNBLFNBQUFqTyxTQ2pGQTNjLFFBQUFDLE9BQUEsd0JBQ0F5WixVQUFBLHFCQUFBLFVBQ0EsU0FBQXNSLEdBQ0EsUUFBQUMsR0FBQXJSLEVBQUFoUSxHQXdFQSxRQUFBb0YsS0FDQWtjLEVBQUEsR0FBQWYsS0FHQSxLQUFBLEdBQUExbUIsS0FBQTBuQixHQUFBLENBQ0EsR0FBQUMsR0FBQUQsRUFBQTFuQixFQUNBMm5CLEdBQUF2bkIsS0FBQUcsS0FBQTRWLEVBQUFnUixVQUFBLEdBQ0FRLEVBQUFDLEtBQUE5aUIsS0FBQSxJQUFBK2lCLEdBSUE5ZSxFQUFBcUgsUUFBQXFYLEdBQUFLLEVBQUEsR0FBQW5hLEVBQUE4WixFQUFBOVosSUFHQW9hLEVBQUF4YixhQUNBb0IsU0FBQUEsR0FDQXFhLEtBQUEsVUFDQXhzQixLQUFBdU4sRUFBQWdmLE1BRUFFLEVBQUExYixhQUNBb0IsU0FBQUEsR0FDQXFhLEtBQUEsVUFDQXhzQixLQUFBME4sRUFBQTZlLE1BR0E5aUIsRUFBQUgsS0FBQSxZQUFBLE1BQ0F5SCxhQUNBb0IsU0FBQUEsR0FDQXFhLEtBQUEsVUFDQWxqQixLQUFBLFlBQUEsYUFBQWlFLEVBQUEwZSxHQUFBSyxFQUFBLEdBQUFuYSxHQUFBLEtBQ0F6SCxLQUFBLE1BQUEsV0FDQXFGLEtBSUEsS0FBQSxHQUFBdkwsS0FBQTBuQixHQUFBLENBQ0EsR0FBQUMsR0FBQUQsRUFBQTFuQixFQUNBMm5CLEdBQUF2bkIsS0FBQThuQixTQTVHQSxHQUFBdGEsR0FBQUMsU0FBQUMscUJBQUEsUUFBQSxHQUVBaEUsRUFBQThELEVBQUF1YSxZQUFBLElBQ0FwZSxFQUFBNkQsRUFBQUksYUFBQSxJQUtBOFosRUFBQSxHQUNBbmEsRUFBQSxJQUNBOFosRUFBQSxHQUFBZixNQUFBQSxLQUFBZSxNQUFBOVosR0FFQStaLEdBQ0FVLFNBQ0Fuc0IsTUFBQSxFQUNBb3NCLE1BQUEsU0FDQWpvQixLQUFBK0YsRUFBQWtLLE1BQUF5WCxHQUFBbmdCLElBQUEsU0FBQWhELEdBQ0EsTUFBQXdSLEdBQUFtUixZQUFBM2QsS0FBQTRSLE1BQUE1VyxFQUFBLE1BQUEsTUFJQW9FLEVBQUE1QyxFQUFBbWlCLEtBQUFqYixRQUNBK0MsUUFBQXFYLEdBQUFLLEVBQUEsR0FBQUwsRUFBQTlaLElBQ0EwQyxPQUFBLEVBQUF2RyxJQUVBWixFQUFBL0MsRUFBQWtILE1BQUE4QyxTQUNBQyxRQUFBLEVBQUFqSyxFQUFBaUUsSUFBQXNkLEVBQUFVLFFBQUFob0IsS0FBQSxTQUFBdUUsR0FBQSxNQUFBQSxHQUFBLE9BQ0EwTCxPQUFBdEcsRUFBQSxJQUVBOGQsRUFBQTFoQixFQUFBN0MsSUFBQXVrQixPQUNBVSxZQUFBLFNBQ0F4ZixFQUFBLFNBQUFwRSxFQUFBMUYsR0FDQSxNQUFBOEosR0FBQTBlLEdBQUFLLEVBQUEsRUFBQTdvQixHQUFBME8sS0FFQXpFLEVBQUEsU0FBQXZFLEdBQ0EsTUFBQXVFLEdBQUF2RSxLQUdBNmpCLEVBQUFyaUIsRUFBQUMsT0FBQSxVQUFBdkIsT0FBQSxPQUNBQyxLQUFBLFFBQUEsSUFDQW9ILE1BQUEsV0FBQSxXQUNBQSxNQUFBLFdBQUEsU0FJQStiLEVBQUFPLEVBQUEzakIsT0FBQSxLQUNBQyxLQUFBLFFBQUEsVUFFQXRKLEtBQUEwTixFQUFBNmUsS0FBQTVoQixFQUFBN0MsSUFBQXlrQixPQUFBMWEsTUFBQW5FLEdBQUF1ZixPQUFBLFNBRUFubEIsRUFBQTZDLEVBQUFDLE9BQUEsVUFBQXZCLE9BQUEsT0FDQUMsS0FBQSxRQUFBLFNBQ0FBLEtBQUEsUUFBQWdGLEVBQUEsSUFDQWhGLEtBQUEsU0FBQWlGLEVBQUEsSUFHQWdlLEVBQUF6a0IsRUFBQXVCLE9BQUEsS0FDQUMsS0FBQSxRQUFBLFVBQ0FBLEtBQUEsWUFBQSxlQUFBaUYsRUFBQSxLQUNBdk8sS0FBQXVOLEVBQUFnZixLQUFBNWhCLEVBQUE3QyxJQUFBeWtCLE9BQUExYSxNQUFBdEUsR0FBQTBmLE9BQUEsV0FFQXhqQixFQUFBM0IsRUFBQXVCLE9BQUEsSUFFQSxLQUFBLEdBQUE3RSxLQUFBMG5CLEdBQUEsQ0FDQSxHQUFBQyxHQUFBRCxFQUFBMW5CLEVBQ0EybkIsR0FBQUMsS0FBQTNpQixFQUFBSixPQUFBLFFBQ0F6RSxNQUFBdW5CLEVBQUF2bkIsT0FDQTBFLEtBQUEsUUFBQTlFLEVBQUEsVUFDQWtNLE1BQUEsU0FBQXliLEVBQUFVLE9BMkNBOWMsSUFHQSxPQUNBMkssU0FBQSxLQUNBd1MsU0FBQSxFQUNBalgsWUFBQSwrQ0FDQTlRLEtBQUEsU0FBQXdWLEdBQ0FBLEVBQUF3UyxhQUFBLFdBQUEsZUFDQSxXQUNBLEdBQUEsTUFBQXhTLEVBQUFnUixVQUNBLE1BQUFoUixFQUFBbVIsY0FDQW5SLEVBQUFuUSxXQUFBLENBQ0FtUSxFQUFBblEsWUFBQSxDQUNBLElBQUFHLEdBQUFvaEIsRUFBQXBoQixFQUNBcWhCLEdBQUFyUixFQUFBaFEsV0NuSUE1SixRQUFBQyxPQUFBLHdCQUNBb3NCLFFBQUEsWUFBQSxXQUNBOW9CLEtBQUE0WixpQkFFQXpELFVBQUEsc0JBQUEsVUFBQSxTQUFBLGtCQUFBLGdCQUFBLHVCQUFBLFlBQ0EsU0FBQXNSLEVBQUEzVixFQUFBeEYsRUFBQWhKLEVBQUF0QyxFQUFBK25CLEdBQ0EsUUFBQUMsR0FBQTNTLEVBQUFrRSxFQUFBak8sRUFBQWhKLEVBQUF0QyxFQUFBK25CLEdBRUEsR0FBQXJtQixTQUFBMlQsRUFBQXZXLE9BQUE0QyxTQUFBMlQsRUFBQXRXLE9BQUEyQyxTQUFBMlQsRUFBQW5WLGlCQUNBd0IsU0FBQTJULEVBQUFsVixpQkFEQSxDQU1BLEdBQUFxTCxHQUFBLEdBQUF4TCxHQUFBbkIsV0FBQXdXLEVBQUF2VyxNQUFBdVcsRUFBQXRXLE1BQUFzVyxFQUFBblYsZ0JBQ0FtVixFQUFBbFYsaUJBQUFrVixFQUFBalYsT0FBQWlWLEVBQUE0UyxpQkFDQXpjLEdBQUEwYyxjQUVBLElBQUFwcEIsR0FBQUMsRUFFQW9wQixFQUFBM2MsRUFBQTRjLGlCQUNBdHBCLEdBQUEwTSxFQUFBa1EsZ0JBQUF5TSxFQUFBaHBCLFVBQ0FKLEVBQUF5TSxFQUFBOEIsZ0JBQUE2YSxFQUFBem9CLFNBQUFaLEVBRUEsSUFBQWdPLEdBQUFDLFNBQUFDLHFCQUFBLFFBQUEsR0FHQS9ELEdBREE2RCxFQUFBdWEsWUFDQXZhLEVBQUFJLGNBR0FtYixFQUFBOU8sRUFBQStPLEtBQUEsT0FFQXBmLEVBQUFyRSxFQUFBd2pCLEVBQUF4bkIsVUFBQXFJLFNBRUErRCxFQUFBcEksRUFBQXdqQixFQUFBeG5CLFVBQUFtSSxRQUVBeEcsRUFBQTZDLEdBQUFDLE9BQUEraUIsRUFBQSxJQUNBcmtCLEtBQUEsUUFBQWlKLEdBQ0FqSixLQUFBLFNBQUFpRixFQUFBQyxFQUFBaUUsSUFBQSxHQUdBa0ksR0FBQWtULG1CQUFBLEdBQUFqZCxHQUFBL0ksTUFBQUMsRUFBQTFELEVBQUFDLEVBQUF5TSxFQUNBNkosRUFBQW5WLGdCQUFBbVYsRUFBQWxWLGtCQUNBa1YsRUFBQWtULG1CQUFBQyx5QkFBQSxHQUFBbG1CLEdBQUErUCxnQkFBQTBWLEVBQUFuUCxjQUNBdkQsRUFBQWtULG1CQUFBQyx5QkFBQSxHQUFBbG1CLEdBQUF1TyxxQkFBQUMsR0FFQSxJQUFBMlgsR0FBQSxHQUFBbm1CLEdBQUE0UCxVQUNBbUQsR0FBQWtULG1CQUFBRyx5QkFBQUQsR0FDQXBULEVBQUFrVCxtQkFBQUMseUJBQUFDLEVBQ0EsSUFBQUUsR0FBQSxHQUFBcm1CLEdBQUE4UCxtQkFNQSxJQUxBaUQsRUFBQWtULG1CQUFBRyx5QkFBQUMsR0FDQUEsRUFBQUMsa0JBQUEvakIsRUFBQSxnQkFDQThqQixFQUFBRSxhQUFBaGtCLEVBQUEsaUJBR0EsR0FBQXpGLEVBQUF3QixRQUFBbW5CLEVBQUFuUCxhQUFBLENBQ0EsR0FBQXRSLEdBQUErTixFQUFBa1Qsa0JBQ0FqaEIsR0FBQTJOLEtBQUE4UyxFQUFBblAsaUJBRUF2RCxHQUFBa1QsbUJBQUF6aEIsZUFJQSxPQUNBc08sU0FBQSxLQUNBd1MsU0FBQSxFQUNBalgsWUFBQSwyQ0FDQTlRLEtBQUEsU0FBQXdWLEVBQUFrRSxHQUNBbEUsRUFBQWlJLElBQUEsV0FBQSxXQUNBelksRUFBQSx3QkFBQWlrQixTQUNBelQsRUFBQWtULG1CQUFBdmpCLFlBQ0FxUSxFQUFBd1MsYUFBQSxRQUFBLFFBQUEsa0JBQUEsb0JBQ0EsV0FDQSxNQUFBeFMsRUFBQXZXLE9BQ0EsTUFBQXVXLEVBQUF0VyxPQUNBLE1BQUFzVyxFQUFBblYsaUJBQ0EsTUFBQW1WLEVBQUFsVixtQkFDQWtWLEVBQUEzSCxhQUlBMkgsRUFBQWtULG1CQUFBL2MsV0FBQXpNLE1BQUFzVyxFQUFBdFcsTUFDQXNXLEVBQUFrVCxtQkFBQVEsbUJBSkExVCxFQUFBM0gsYUFBQSxFQUNBc2EsRUFBQTNTLEVBQUFrRSxFQUFBak8sRUFBQWhKLEVBQUF0QyxFQUFBK25CLFlDaEZBdHNCLFFBQUFDLE9BQUEsd0JBQ0FxRyxRQUFBLGlCQUFBLFNBQUFDLEdBQ0FBLEVBQ0FDLE1BQUEsa0NBQ0FDLElBQUEsUUFDQTBPLFdBQUEsaURBQ0FELFlBQUEsNENBSUFDLFdBQUEseUJBQUEsU0FBQSxRQUFBLHVCQUFBLFlBQ0EsU0FBQW9NLEVBQUFoQixFQUFBMkosRUFBQTFJLEdBR0EsR0FBQStMLEdBQUEsU0FBQTVRLEdBQ0EsR0FBQXRaLE1BQ0FDLEtBQ0FtUyxJQUNBOVIsR0FBQUMsUUFBQStZLEVBQUE4TixRQUFBLEdBQUFDLE9BQUEsU0FBQUEsR0FDQSxHQUVBemxCLEdBRkF1b0IsRUFBQTlDLEVBQUErQyxLQUFBQyxXQUNBQyxFQUFBakQsRUFBQStDLEtBQUFHLFVBR0EsSUFBQWpxQixFQUFBMEIsU0FBQW9RLEVBQUErWCxLQUNBdm9CLEdBQ0F4QixLQUFBK3BCLEVBQ0FocUIsR0FBQWdxQixFQUNBcG9CLE9BQUEsS0FDQUYsVUFBQSxNQUVBN0IsRUFBQVcsS0FBQWlCLEdBQ0F3USxFQUFBelIsS0FBQXdwQixJQUVBLEdBQUE3cEIsRUFBQTBCLFNBQUFvUSxFQUFBa1ksS0FDQTFvQixHQUNBeEIsS0FBQWtxQixFQUNBbnFCLEdBQUFtcUIsRUFDQXZvQixPQUFBLEtBQ0FGLFVBQUEsTUFFQTdCLEVBQUFXLEtBQUFpQixHQUNBd1EsRUFBQXpSLEtBQUEycEIsR0FHQSxJQUFBRSxJQUNBMXBCLE9BQUFxcEIsRUFDQWhyQixPQUFBbXJCLEVBQ0E5bkIsT0FBQTZrQixFQUFBQyxPQUFBLEdBQUEsR0FFQXJuQixHQUFBVSxLQUFBNnBCLEVBQ0EsSUFBQUMsSUFDQTNwQixPQUFBd3BCLEVBQ0FuckIsT0FBQWdyQixFQUNBM25CLE9BQUE2a0IsRUFBQUMsT0FBQSxHQUFBLEdBRUFybkIsR0FBQVUsS0FBQThwQixLQUVBdk0sRUFBQWxlLE1BQUFBLEVBQ0FrZSxFQUFBamUsTUFBQUEsRUFHQTRtQixHQUFBNkQsZUFBQXJSLEtBQUE2USxFQUFBLFNBQUE1USxNQUlBNEUsRUFBQU0sSUFBQSxXQUFBLFdBQUFMLEVBQUFNLE9BQUFQLEVBQUF5TSxxQkFFQTlELEVBQUErRCxtQkFBQXZSLEtBQUEsU0FBQUMsR0FHQTRFLEVBQUE3YyxpQkFBQWlZLEVBQUFqWSxpQkFDQTZjLEVBQUE5YyxnQkFBQWtZLEVBQUFsWSxnQkFDQThjLEVBQUE1YyxPQUFBZ1ksRUFBQWhZLE9BQ0E0YyxFQUFBaUwsaUJBQUE3UCxFQUFBNlAsa0JBQ0EsU0FBQTdQLFNDMUVBM2MsUUFBQUMsT0FBQSx3QkFDQWdELFFBQUEsd0JBQUEsUUFBQSxLQUFBLFNBQUFzZCxFQUFBQyxHQVFBLFFBQUEwTixHQUFBem5CLEVBQUFILEdBQ0EsR0FBQXFhLEdBQUFILEVBQUFJLE9BTUEsT0FMQUwsR0FBQWpPLElBQUE3TCxFQUFBSCxHQUFBb1csS0FBQSxTQUFBQyxHQUNBZ0UsRUFBQUUsUUFBQWxFLEVBQUE5WSxPQUNBLFNBQUE4WSxHQUNBZ0UsRUFBQUssT0FBQXJFLEVBQUE5WSxRQUVBOGMsRUFBQU0sUUFVQSxRQUFBa04sR0FBQTFuQixFQUFBNUMsR0FPQSxHQUFBdXFCLEdBQUEsU0FBQUMsR0FDQSxHQUFBNXFCLEdBQUEvRCxFQUFBNHVCLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUEvckIsRUFBQWdzQixFQUFBLEVBQ0EsS0FBQWpyQixJQUFBNHFCLEdBR0EsR0FGQTN1QixFQUFBMnVCLEVBQUE1cUIsR0FFQS9ELFlBQUFpdkIsT0FDQSxJQUFBanNCLEVBQUEsRUFBQUEsRUFBQWhELEVBQUFpRCxTQUFBRCxFQUNBOHJCLEVBQUE5dUIsRUFBQWdELEdBQ0E0ckIsRUFBQTdxQixFQUFBLElBQUFmLEVBQUEsSUFDQStyQixLQUNBQSxFQUFBSCxHQUFBRSxFQUNBRSxHQUFBTixFQUFBSyxHQUFBLFFBRUEsSUFBQS91QixZQUFBSCxRQUNBLElBQUFndkIsSUFBQTd1QixHQUNBOHVCLEVBQUE5dUIsRUFBQTZ1QixHQUNBRCxFQUFBN3FCLEVBQUEsSUFBQThxQixFQUFBLElBQ0FFLEtBQ0FBLEVBQUFILEdBQUFFLEVBQ0FFLEdBQUFOLEVBQUFLLEdBQUEsUUFFQXhvQixVQUFBdkcsR0FBQSxPQUFBQSxJQUNBZ3ZCLEdBQUFFLG1CQUFBbnJCLEdBQUEsSUFBQW1yQixtQkFBQWx2QixHQUFBLElBSUEsT0FBQWd2QixHQUFBL3JCLE9BQUErckIsRUFBQUcsT0FBQSxFQUFBSCxFQUFBL3JCLE9BQUEsR0FBQStyQixHQUdBL04sRUFBQUgsRUFBQUksT0FpQkEsT0FoQkFMLElBQ0E5WixJQUFBQSxFQUNBcW9CLE9BQUEsT0FDQWpyQixLQUFBQSxFQUNBa3JCLFNBQ0FDLGVBQUEscUNBRUFDLGtCQUFBLFNBQUFwckIsR0FDQSxNQUFBN0QsU0FBQWt2QixTQUFBcnJCLElBQUEsa0JBQUFtSSxPQUFBbkksR0FBQXVxQixFQUFBdnFCLEdBQUFBLE1BR0E2WSxLQUFBLFNBQUFDLEdBQ0FnRSxFQUFBRSxRQUFBbEUsRUFBQTlZLE9BQ0EsU0FBQThZLEdBQ0FnRSxFQUFBSyxPQUFBckUsRUFBQTlZLFFBRUE4YyxFQUFBTSxRQUdBLFFBQUE4TSxLQUNBLEdBQUF0bkIsR0FBQXZHLGNBQUFhLHNCQUNBMEYsSUFBQSxjQUNBLElBQUFILElBQ0E0UyxRQUNBaVcsR0FBQSxXQUNBemhCLEVBQUEsc0hBR0EsT0FBQXdnQixHQUFBem5CLEVBQUFILEdBR0EsUUFBQTJuQixLQUNBLEdBQUF4bkIsR0FBQXZHLGNBQUFhLHNCQUVBLE9BREEwRixJQUFBLFdBQ0F5bkIsRUFBQXpuQixHQUdBLFFBQUEyb0IsR0FBQUMsRUFBQS9RLEdBQ0EsR0FBQW9RLEdBQUEsR0FDQUEsSUFBQXBRLEVBQUEsSUFDQW9RLEdBQUEsSUFBQVcsRUFBQSxHQUFBLElBRUEsS0FBQSxHQUFBM3NCLEdBQUEsRUFBQUEsRUFBQTJzQixFQUFBMXNCLE9BQUFELElBQ0Fnc0IsR0FBQSxNQUNBQSxHQUFBcFEsRUFBQSxJQUNBb1EsR0FBQSxJQUFBVyxFQUFBM3NCLEdBQUEsSUFHQSxPQURBZ3NCLElBQUEsSUFJQSxRQUFBbkUsR0FBQXhVLEVBQUFDLEVBQUErVixHQUNBLEdBQUF0bEIsR0FBQXZHLGNBQUFhLHNCQUNBMEYsSUFBQSxjQUVBLElBQUE1QyxJQUNBc3JCLEdBQUEsV0FDQXpoQixFQUFBLDRFQUNBMGhCLEVBQUFyWixFQUFBLGNBQUEsUUFDQXFaLEVBQUFwWixFQUFBLGNBQ0EsdUdBQ0FvWixFQUFBclosRUFBQSxjQUFBLFFBQ0FxWixFQUFBcFosRUFBQSxjQUNBLHFDQUVBLE9BQUFtWSxHQUFBMW5CLEVBQUE1QyxHQUtBLFFBQUFpbkIsR0FBQS9VLEVBQUFDLEdBQ0EsR0FBQXZQLEdBQUF2RyxjQUFBYSxzQkFDQTBGLElBQUEsY0FDQSxJQUFBNUMsSUFDQXNyQixHQUFBLFdBQ0F6aEIsRUFBQSwyRUFDQTBoQixFQUFBclosRUFBQSxjQUFBLFFBQ0FxWixFQUFBcFosRUFBQSxjQUNBLCtHQUNBb1osRUFBQXJaLEVBQUEsY0FBQSxRQUNBcVosRUFBQXBaLEVBQUEsY0FDQSxzQ0FFQSxPQUFBbVksR0FBQTFuQixFQUFBNUMsR0FHQSxPQUNBa3FCLGFBQUFBLEVBQ0FFLGlCQUFBQSxFQUNBMUQsWUFBQUEsRUFDQU8sZUFBQUEsTUN0SkE5cUIsUUFBQUMsT0FBQSxrQkFDQXFHLFFBQUEsaUJBQUEsU0FBQUMsR0FDQUEsRUFDQUMsTUFBQSw4QkFDQUMsSUFBQSxVQUNBeU8sWUFBQSw0QkFDQUMsV0FBQSw0Q0FHQUEsV0FBQSxvQkFBQSxTQUFBLGVBQUEsZUFBQSx1QkFBQSxvQkFDQSxTQUFBRSxFQUFBOEQsRUFBQXFRLEVBQUF6QixFQUFBcFAsR0FHQSxRQUFBMlcsS0FDQWphLEVBQUFlLEdBQUEsNEJBRUEsUUFBQTZGLEtBQ0FxVCxJQUtBLFFBQUFDLEtBQ0F4SCxFQUFBelYsTUFBQW9LLEtBQUEsU0FBQUMsR0FDQTZTLEVBQUFDLFNBQUE5UyxJQUdBLFFBQUErUyxLQUNBRixFQUFBRyxVQUFBcm1CLE9BQUFrbUIsRUFBQUksZUFBQW5zQixLQUNBK3JCLEVBQUFHLFVBQUFwSCxTQUFBaUgsRUFBQUksZUFBQXJILFNBQ0FpSCxFQUFBRyxVQUFBL0csT0FBQTRHLEVBQUFJLGVBQUFoSCxPQUNBNEcsRUFBQUcsVUFBQW53QixPQUFBZ3dCLEVBQUFJLGVBQUFwd0IsT0FDQWd3QixFQUFBRyxVQUFBNUcsUUFBQXlHLEVBQUFJLGVBQUE3RyxRQUVBLFFBQUE4RyxLQUdBTCxFQUFBcFQsS0FBQUMsU0FDQTFELEVBQUFNLGdCQUFBdVcsR0FDQTdXLEVBQUEyRCxZQUFBa1QsR0FDQUUsSUFDQWxHLEVBQUFocUIsT0FBQWd3QixFQUFBRyxXQUFBalQsS0FBQSxTQUFBQyxHQUNBaEUsRUFBQUssV0FBQXdXLEdBQ0FGLEtBQ0EsU0FBQTNTLEdBQ0FoRSxFQUFBSyxXQUFBd1csR0FDQTdXLEVBQUFpRSxnQkFBQTRTLEVBQUE3UyxNQUlBLFFBQUFFLEtBQ0FsRSxFQUFBSyxXQUFBd1csR0FDQTdXLEVBQUFNLGdCQUFBdVcsR0FDQUEsRUFBQUcsV0FDQWxzQixLQUFBLEdBQ0E4a0IsWUFDQUssVUFDQXBwQixVQUNBdXBCLFlBL0NBLEdBQUF5RyxHQUFBanNCLElBQ0Fpc0IsR0FBQW5ILGFBQUEsT0FBQSxTQWlEQW1ILEVBQUFLLGFBQUFBLEVBQ0FMLEVBQUF2VCxlQUFBQSxFQUNBc1QsSUFDQTFTLE9DaEVBN2MsUUFBQUMsT0FBQSxrQkFDQXFHLFFBQUEsaUJBQUEsU0FBQUMsR0FDQUEsRUFDQUMsTUFBQSw0QkFDQUMsSUFBQSxTQUNBeVMsUUFBQXdQLFNBQUEsS0FBQXBmLE9BQUEsS0FBQXdtQixPQUFBLE1BQ0EzYSxXQUFBLG1EQUNBRCxZQUFBLHVDQUdBQyxXQUFBLDBCQUFBLFNBQUEsZUFBQSxTQUFBLFlBQUEsUUFBQSxlQUFBLG9CQUNBLFNBQUFFLEVBQUE4RCxFQUFBb0ksRUFBQUMsRUFBQWpCLEVBQUFpSixFQUFBN1EsR0FFQSxRQUFBb1gsS0FDQTFhLEVBQUFlLEdBQUEsK0JBQUF0VCxJQUFBcVcsRUFBQTdQLE9BQUEsSUFBQTZQLEVBQUEyVyxTQUVBLFFBQUFFLEtBQ0EzYSxFQUFBZSxHQUFBLCtCQUFBdFQsSUFBQXFXLEVBQUE3UCxPQUFBLElBQUEybUIsRUFBQUMsWUFFQSxRQUFBQyxLQUNBLEdBQUFGLEVBQUE3VCxLQUFBQyxPQUFBLENBQ0ExRCxFQUFBTSxnQkFBQWdYLEdBQ0F0WCxFQUFBMkQsWUFBQTJULEVBQ0EsSUFBQUcsS0FDQUEsR0FBQTltQixPQUFBNlAsRUFBQTdQLE9BQ0E4bUIsRUFBQTNzQixLQUFBMFYsRUFBQTJXLE9BQ0F0RyxFQUFBNkcsS0FBQUQsRUFBQWpYLEVBQUF1UCxTQUFBdUgsRUFBQUMsV0FDQXhULEtBQUEsU0FBQUMsR0FDQWhFLEVBQUFLLFdBQUFpWCxHQUNBRCxLQUNBLFNBQUFyVCxHQUNBaEUsRUFBQUssV0FBQWlYLEdBQ0F0WCxFQUFBaUUsZ0JBQUFxVCxFQUFBdFQsTUFwQkEsR0FBQXNULEdBQUExc0IsSUF3QkEwc0IsR0FBQTNtQixPQUFBNlAsRUFBQTdQLE9BQ0EybUIsRUFBQUgsT0FBQTNXLEVBQUEyVyxPQUNBRyxFQUFBdkgsU0FBQXZQLEVBQUF1UCxTQUNBdUgsRUFBQUUsYUFBQUEsRUFDQUYsRUFBQUYsV0FBQUEsS0MzQ0EvdkIsUUFBQUMsT0FBQSxxQkFDQXlaLFVBQUEsY0FBQSxXQUNBLE9BQ0FDLFNBQUEsSUFDQXpFLFlBQUEsNENBQ0EwRSxPQUNBd0MsS0FBQSxRQ05BcGMsUUFBQUMsT0FBQSxxQkFDQXlaLFVBQUEsc0JBQUEsV0FDQSxPQUNBQyxTQUFBLElBQ0F6RSxZQUFBLG9EQUNBMEUsT0FDQTBXLFVBQUEsUUNOQXR3QixRQUFBQyxPQUFBLHFCQUNBeVosVUFBQSxpQkFBQSxXQUNBLE9BQ0FDLFNBQUEsSUFDQXpFLFlBQUEsK0NBQ0EwRSxPQUNBMFcsVUFBQSxRQ05BdHdCLFFBQUFDLE9BQUEscUJBQ0F5WixVQUFBLGVBQUEsV0FDQSxPQUNBQyxTQUFBLElBQ0F6RSxZQUFBLDZDQUNBMEUsT0FDQTBXLFVBQUEiLCJmaWxlIjoiYXBwL2J1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBEZWZpbmluZyB0aGUgR3JhcGggTW9kdWxlLlxuICogU2VlIERFU0lHTi5tZCBmb3IgaW5mbyBvbiBHcmFwaCBPYmplY3RzLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJywgW10pO1xuYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiLCBbXSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMTQvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubW9kZWxzJywgW10pO1xudmFyIENvbnRpdkdsb2JhbHMgPSAoZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIC8vUkVTVCBlbmRwb2ludHMgZm9yIE5FVE1BU1RFUlxuICAgICAgICAnTkVUV09SS1NfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvbmV0d29ya3MvJyxcbiAgICAgICAgJ05FVFdPUktTX0lOU1BFQ1RfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvaW5zcGVjdC9uZXR3b3Jrcy8nLFxuICAgICAgICAnU0VSVklDRUxCU19JTlNQRUNUX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL2luc3BlY3Qvc2VydmljZUxCcy8nLFxuICAgICAgICAnUE9MSUNJRVNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvcG9saWN5cy8nLFxuICAgICAgICAnUlVMRVNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvcnVsZXMvJyxcbiAgICAgICAgJ0FQUExJQ0FUSU9OR1JPVVBTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL2VuZHBvaW50R3JvdXBzLycsXG4gICAgICAgICdTRVJWSUNFTEJTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL3NlcnZpY2VMQnMvJyxcbiAgICAgICAgJ09SR0FOSVpBVElPTlNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvdGVuYW50cy8nLFxuICAgICAgICAnTkVUV09SS19TRVRUSU5HU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9nbG9iYWxzLycsXG4gICAgICAgICdORVRQUk9GSUxFU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9uZXRwcm9maWxlcy8nLFxuICAgICAgICAnQkdQU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9CZ3BzLycsXG4gICAgICAgICdCR1BTX0lOU1BFQ1RfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvaW5zcGVjdC9CZ3BzLycsXG4gICAgICAgICdWSVNVQUxJWkFUSU9OX0VORFBPSU5UJzogJy92aXN1YWxpemF0aW9uLycsXG4gICAgICAgIC8vUkVTVCBlbmRwb2ludHMgZm9yIFZPTE1BU1RFUlxuICAgICAgICAnVk9MVU1FU19FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3ZvbHVtZXMvJyxcbiAgICAgICAgJ1ZPTFVNRVNfQ1JFQVRFX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvdm9sdW1lcy9jcmVhdGUvJyxcbiAgICAgICAgJ1ZPTFVNRVNfREVMRVRFX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvdm9sdW1lcy9yZW1vdmUvJyxcbiAgICAgICAgJ1ZPTFVNRVNfQ09QWVNOQVBTSE9UU19FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3ZvbHVtZXMvY29weScsXG4gICAgICAgICdWT0xVTUVTX1VTRVNfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci91c2VzL21vdW50cy8nLFxuICAgICAgICAnVk9MVU1FU19TTkFQU0hPVFNfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci9zbmFwc2hvdHMvJyxcbiAgICAgICAgJ1NUT1JBR0VQT0xJQ0lFU19FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3BvbGljaWVzLycsXG4gICAgICAgICdWT0xVTUVTX0dMT0JBTF9FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL2dsb2JhbC8nLFxuICAgICAgICAvL1JFU1QgZW5kcG9pbnRzIGZvciBDTFVTVEVSXG4gICAgICAgICdOT0RFU19MSVNUX0VORFBPSU5UJzogJy9pbmZvL25vZGVzJyxcbiAgICAgICAgJ05PREVTX0RJU0NPVkVSX0VORFBPSU5UJzogJy9kaXNjb3Zlci9ub2RlcycsXG4gICAgICAgICdOT0RFU19DT01NSVNTSU9OX0VORFBPSU5UJzogJy9jb21taXNzaW9uL25vZGVzJyxcbiAgICAgICAgJ05PREVTX0RFQ09NTUlTU0lPTl9FTkRQT0lOVCc6ICcvZGVjb21taXNzaW9uL25vZGVzJyxcbiAgICAgICAgJ05PREVTX01BSU5URU5BTkNFX0VORFBPSU5UJzogJy9tYWludGVuYW5jZS9ub2RlcycsXG4gICAgICAgICdOT0RFU19MQVNUX0pPQl9FTkRQT0lOVCc6ICcvaW5mby9qb2IvbGFzdCcsXG4gICAgICAgICdOT0RFU19BQ1RJVkVfSk9CX0VORFBPSU5UJzogJy9pbmZvL2pvYi9hY3RpdmUnLFxuICAgICAgICAnTk9ERVNfU0VUVElOR1NfU0VUX0VORFBPSU5UJzogJy9nbG9iYWxzJyxcbiAgICAgICAgJ05PREVTX1NFVFRJTkdTX0dFVF9FTkRQT0lOVCc6ICcvaW5mby9nbG9iYWxzJyxcbiAgICAgICAgLy9SZWZyZXNoIGludGVydmFsIGluIG1pbGxpc2Vjb25kc1xuICAgICAgICAnUkVGUkVTSF9JTlRFUlZBTCc6IDUwMDAsXG4gICAgICAgIC8vUmVnRXggZm9yIHZhbGlkYXRpb25cbiAgICAgICAgJ0NJRFJfUkVHRVgnOiAnXigoWzAtOV18WzEtOV1bMC05XXwxWzAtOV17Mn18MlswLTRdWzAtOV18MjVbMC01XSlcXC4pezN9KFswLTldfFsxLTldWzAtOV18MVswLTldezJ9fDJbMC00XVswLTldfDI1WzAtNV0pKFxcLyhbMC05XXxbMS0yXVswLTldfDNbMC0yXSkpJCcsXG4gICAgICAgICdWTEFOX1JFR0VYJzogJ14oWzAtOV17MSw0fT8tWzAtOV17MSw0fT8pJCcsXG4gICAgICAgICdWWExBTl9SRUdFWCc6ICdeKFswLTldezEsOH0/LVswLTldezEsOH0/KSQnLFxuICAgICAgICAnTlVNQkVSX1JFR0VYJzogJ15bMC05XSokJ1xuICAgIH07XG59KSgpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcFxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4vKipcbiAqIFRoZSBiYXNlIGNsYXNzIHRoZSBEYXRhU291cmNlIG9iamVjdC5cbiAqIFxuICogVGhlIERhdGFTb3VyY2Ugb2JqZWN0IHRha2VzIGluIG5vZGUgYW5kIGxpbmsgZGF0YSBmcm9tIHRoZSBzZXJ2ZXIsIFxuICogYW5kIHByb3ZpZGVzIG1ldGhvZHMgZm9yIGNvbnZlcnRpbmcgYW5kIG1hbmlwdWxhdGluZyB0aGUgZGF0YSBmb3JcbiAqIHRoZSBncmFwaCBvYmplY3QuXG4gKiBcbiAqIFRvIHdyaXRlIHlvdXIgb3duIERhdGFTb3VyY2Ugb2JqZWN0LCBjcmVhdGUgYSBuZXcgZmFjdG9yeSB0aGF0IHVzZXMgdGhlIFxuICogRGF0YVNvdXJjZSB5b3Ugd2FudCB0byBpbmhlcml0IGFzIGEgZGVwZW5kZW5jeSwgYW5kIGV4dGVuZCBcbiAqIGl0cyBEYXRhU291cmNlIGNsYXNzLiBcbiAqIFJldHVybiB0aGUgY2xhc3Mgb2JqZWN0IHdpdGggRGF0YVNvdXJjZSBhcyBrZXkuXG4gKiBcbiAqIE5vZGUgZGF0YSBpcyBleHBlY3RlZCB0byBiZSBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDpcbiAqIHtpZDpub2RlX2lkLCB0ZXh0Om5vZGVfdGV4dH1cbiAqIFxuICogTGluayBkYXRhIGlzIGV4cGVjdGVkIHRvIGJlIGluIHRoZSBmb2xsb3dpbmcgZm9ybWF0OlxuICoge3NvdXJjZTogc291cmNlTm9kZUlkLCB0YXJnZXQ6IHRhcmdldE5vZGVJZH1cbiAqIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnRGF0YVNvdXJjZScsIFsnTm9kZScsICdMaW5rJywgZnVuY3Rpb24gKE5vZGUsIExpbmspIHtcblx0dmFyIERhdGFTb3VyY2UgPSBmdW5jdGlvbiAoKSB7XG5cdFx0LyoqXG4gICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICpcbiAgICogQHBhcmFtICAgICAge0FycmF5fSAgIG5vZGVzICAgICAgICAgICAgICBUaGUgbm9kZSBkYXRhIFxuICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgbGlua3MgICAgICAgICAgICAgIFRoZSBsaW5rIGRhdGFcbiAgICovXG5cdFx0ZnVuY3Rpb24gRGF0YVNvdXJjZShub2RlcywgbGlua3MpIHtcblx0XHRcdF9jbGFzc0NhbGxDaGVjayh0aGlzLCBEYXRhU291cmNlKTtcblxuXHRcdFx0dGhpcy5ub2RlcyA9IG5vZGVzO1xuXHRcdFx0dGhpcy5saW5rcyA9IGxpbmtzO1xuXHRcdH1cblxuXHRcdC8qKlxuICAgKiBSZXBsYWNlcyB0aGUgbm9kZSBkYXRhXG4gICAqXG4gICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZXMgICBUaGUgbm9kZXNcbiAgICovXG5cblxuXHRcdF9jcmVhdGVDbGFzcyhEYXRhU291cmNlLCBbe1xuXHRcdFx0a2V5OiAndXBkYXRlTm9kZXMnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZU5vZGVzKG5vZGVzKSB7XG5cdFx0XHRcdHRoaXMubm9kZXMgPSBub2Rlcztcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBSZXBsYWNlcyB0aGUgbGluayBkYXRhXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge0xpbmt9ICBsaW5rcyAgIFRoZSBsaW5rc1xuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICd1cGRhdGVMaW5rcycsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gdXBkYXRlTGlua3MobGlua3MpIHtcblx0XHRcdFx0dGhpcy5saW5rcyA9IGxpbmtzO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIFJldHVybnMgdGhlIE5hbWUgYXR0cmlidXRlIG9mIHRoZSBOb2RlIHdpdGggdGhlIFxuICAgICogbWF0Y2hpbmcgaWRcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgaWQgICAgICBUaGUgaWRlbnRpZmllclxuICAgICogQHJldHVybiAgICAge3N0cmluZ30gIG5hbWUgb2YgdGhlIG1hdGNoaW5nIG5vZGVcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnbm9kZUlkVG9OYW1lJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBub2RlSWRUb05hbWUoaWQpIHtcblx0XHRcdFx0dmFyIG5vZGVzID0gdGhpcy5ub2Rlcztcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdGlmIChub2Rlc1tpXS5pZCA9PSBpZCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIG5vZGVzW2ldLm5hbWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogcHJvY2VzcyB0aGUgbm9kZURhdGEgdG8gY3JlYXRlIE5vZGUgb2JqZWN0c1xuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVEYXRhICBOb2RlRGF0YSB0byBjb252ZXJ0IFxuICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIG5vZGUgb2JqZWN0c1xuICAgICogQHJldHVybiAgICAge0FycmF5fSAgTm9kZSBvYmplY3RzXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3Byb2Nlc3NOb2RlRGF0YScsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gcHJvY2Vzc05vZGVEYXRhKG5vZGVEYXRhKSB7XG5cdFx0XHRcdHZhciBub2RlcyA9IFtdO1xuXHRcdFx0XHRfLmZvckVhY2gobm9kZURhdGEsIGZ1bmN0aW9uIChkYXRhKSB7XG5cdFx0XHRcdFx0dmFyIG5ld05vZGUgPSBuZXcgTm9kZS5Ob2RlKG51bGwsIG51bGwsIGRhdGEuaWQsIGRhdGEudGV4dCwgbnVsbCk7XG5cdFx0XHRcdFx0bm9kZXMucHVzaChuZXdOb2RlKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdHJldHVybiBub2Rlcztcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBwcm9jZXNzIHRoZSBsaW5rRGF0YVxuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIGxpbmtEYXRhICBUaGUgbGluayBkYXRhXG4gICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlcyAgICAgVGhlIG5vZGVzIGZyb20gcHJvY2Vzc05vZGVEYXRhXG4gICAgKiBAcmV0dXJuICAgICB7QXJyYXl9ICBMaW5rIG9iamVjdHNcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAncHJvY2Vzc0xpbmtEYXRhJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBwcm9jZXNzTGlua0RhdGEobGlua0RhdGEsIG5vZGVzKSB7XG5cdFx0XHRcdC8qKlxuICAgICAqIFJldHVybnMgdGhlIG5vZGUgdGhhdCBtYXRjaGVzIHRoZSBpZFxuICAgICAqXG4gICAgICogQHBhcmFtICAgICAge3N0cmluZ30gaWQgICAgICBUaGUgaWRlbnRpZmllclxuICAgICAqIEByZXR1cm4gICAgIHtOb2RlfSAgIFRoZSBub2RlIHdpdGggdGhlIG1hdGNoaW5nIGlkXG4gICAgICovXG5cdFx0XHRcdGZ1bmN0aW9uIGZpbmROb2RlQnlJZChpZCwgbm9kZXMpIHtcblx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRpZiAoaWQgPT0gbm9kZXNbaV0uaWQpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIG5vZGVzW2ldO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdHZhciBsaW5rcyA9IFtdO1xuXHRcdFx0XHQvL3RyYW5zZm9ybWluZyBsaW5rIGRhdGFcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBsaW5rRGF0YS5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdGlmIChsaW5rRGF0YVtpXS5zb3VyY2UgIT0gbGlua0RhdGFbaV0udGFyZ2V0KSB7XG5cdFx0XHRcdFx0XHR2YXIgc291cmNlID0gZmluZE5vZGVCeUlkKGxpbmtEYXRhW2ldLnNvdXJjZSwgbm9kZXMpO1xuXHRcdFx0XHRcdFx0dmFyIHRhcmdldCA9IGZpbmROb2RlQnlJZChsaW5rRGF0YVtpXS50YXJnZXQsIG5vZGVzKTtcblx0XHRcdFx0XHRcdGlmIChzb3VyY2UgPT0gbnVsbCB8fCB0YXJnZXQgPT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdHZhciBsaW5rID0gbmV3IExpbmsuTGluayhzb3VyY2UsIHRhcmdldCk7XG5cdFx0XHRcdFx0XHRsaW5rcy5wdXNoKGxpbmspO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gbGlua3M7XG5cdFx0XHR9XG5cdFx0fV0pO1xuXG5cdFx0cmV0dXJuIERhdGFTb3VyY2U7XG5cdH0oKTtcblxuXHRyZXR1cm4ge1xuXHRcdERhdGFTb3VyY2U6IERhdGFTb3VyY2Vcblx0fTtcbn1dKTtcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi51dGlscycsIFtdKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXBcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG4vKipcbiAqIFRoZSBEYXRhU291cmNlIHVzZWQgZm9yIHRoZSB2aXN1YWxpemF0aW9uIHRhYi5cbiAqIFxuICogTm9kZSBEYXRhIGZyb20gdGhlIHNlcnZlciBpcyBleHBlY3RlZCB0byBiZSBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDpcbiAqIHtpZDogbm9kZV9pZCwgdGV4dDogbm9kZV90ZXh0fVxuICogUGFyZW50IGFuZCBBbmNlc3RvciBhdHRyaWJ1dGVzIGNhbiBiZSBzZXQgYnkgY2FsbGluZyBzZXRBbmNlc3RvcnNcbiAqIFxuICogTGluayBEYXRhIGZyb20gdGhlIHNlcnZlciBpcyBleHBlY3RlZCB0byBiZSBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDpcbiAqIHtzb3VyY2U6IHNvdXJjZU5vZGVJZCwgdGFyZ2V0OiB0YXJnZXROb2RlSWQsIHdlaWdodDogbGlua1dlaWdodH1cbiAqIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnVmlzdWFsaXplckRhdGFTb3VyY2UnLCBbJ0RhdGFTb3VyY2UnLCAnVmlzdWFsaXplck5vZGUnLCAnVmlzdWFsaXplckxpbmsnLCBmdW5jdGlvbiAoRGF0YVNvdXJjZSwgVmlzdWFsaXplck5vZGUsIFZpc3VhbGl6ZXJMaW5rKSB7XG5cdHZhciBWaXN1YWxpemVyRGF0YVNvdXJjZSA9IGZ1bmN0aW9uIChfRGF0YVNvdXJjZSREYXRhU291cmMpIHtcblx0XHRfaW5oZXJpdHMoVmlzdWFsaXplckRhdGFTb3VyY2UsIF9EYXRhU291cmNlJERhdGFTb3VyYyk7XG5cblx0XHQvKipcbiAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgKiBcbiAgICogQ2hpbGRyZW4gU3RydWN0IGFuZCBhbmNlc3RvcnNfc3RydWN0IGFyZSBKU09OIG9iamVjdHMsXG4gICAqIG1hcHBpbmcgYSBub2RlIElkIHRvIGEgbGlzdCBvZiBpdCdzIGNoaWxkcmVuIG9yIGFuY2VzdG9ycy5cbiAgICogQ2hpbGRyZW4gU3RydWN0IGlzIGFsc28gZXhwZWN0ZWQgdG8gaGF2ZSBhIGZpZWxkIGNhbGxlZFxuICAgKiB0b3BMZXZlbCwgdGhhdCBtYXBzIHRvIGEgbGlzdCBvZiBhbGwgdGhlIG5vZGVzIHRoYXQgZG9uJ3RcbiAgICogaGF2ZSBhbnkgcGFyZW50cy5cbiAgICpcbiAgICogQHBhcmFtICAgICAge0FycmF5fSAgIG5vZGVzICAgICAgICAgICAgICBUaGUgbm9kZSBkYXRhIFxuICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgbGlua3MgICAgICAgICAgICAgIFRoZSBsaW5rIGRhdGFcbiAgICogQHBhcmFtICAgICAge09iamVjdH0gIGNoaWxkcmVuX3N0cnVjdCAgICBUaGUgY2hpbGRyZW4gc3RydWN0dXJlXG4gICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBhbmNlc3RvcnNfc3RydWN0ICAgVGhlIGFuY2VzdG9ycyBzdHJ1Y3R1cmVcbiAgICogQHBhcmFtICAgICAge0FycmF5fSAgIGxhYmVscyAgICAgICAgICAgICBUaGUgbGFiZWxzXG4gICAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBzZWxlY3RvcnMgICAgICAgICAgVGhlIHNlbGVjdG9yc1xuICAgKi9cblx0XHRmdW5jdGlvbiBWaXN1YWxpemVyRGF0YVNvdXJjZShub2RlcywgbGlua3MsIGNoaWxkcmVuX3N0cnVjdCwgYW5jZXN0b3JzX3N0cnVjdCwgbGFiZWxzLCBzZWxlY3RvcnMpIHtcblx0XHRcdF9jbGFzc0NhbGxDaGVjayh0aGlzLCBWaXN1YWxpemVyRGF0YVNvdXJjZSk7XG5cblx0XHRcdHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChWaXN1YWxpemVyRGF0YVNvdXJjZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFZpc3VhbGl6ZXJEYXRhU291cmNlKSkuY2FsbCh0aGlzLCBub2RlcywgbGlua3MpKTtcblxuXHRcdFx0X3RoaXMuY2hpbGRyZW5fc3RydWN0ID0gY2hpbGRyZW5fc3RydWN0O1xuXHRcdFx0X3RoaXMuYW5jZXN0b3JzX3N0cnVjdCA9IGFuY2VzdG9yc19zdHJ1Y3Q7XG5cdFx0XHRfdGhpcy5sYWJlbHMgPSBsYWJlbHM7XG5cdFx0XHRfdGhpcy5zZWxlY3RvcnMgPSBzZWxlY3RvcnM7XG5cdFx0XHRyZXR1cm4gX3RoaXM7XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqIERldGVybWluZXMgaWYgaXQgaGFzIGNoaWxkLlxuICAgKlxuICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgIGlkICAgICAgVGhlIGlkZW50aWZpZXJcbiAgICogQHJldHVybiAgICAge2Jvb2xlYW59ICBUcnVlIGlmIGhhcyBjaGlsZCwgRmFsc2Ugb3RoZXJ3aXNlLlxuICAgKi9cblxuXG5cdFx0X2NyZWF0ZUNsYXNzKFZpc3VhbGl6ZXJEYXRhU291cmNlLCBbe1xuXHRcdFx0a2V5OiAnaGFzQ2hpbGQnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGhhc0NoaWxkKGlkKSB7XG5cdFx0XHRcdGlmICh0aGlzLmNoaWxkcmVuX3N0cnVjdFtpZF0gPT0gbnVsbCkge1xuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBTZXRzIHRoZSBwYXJlbnQgYW5kIGFuY2VzdG9ycyBhdHRyaWJ1dGUgdXNpbmcgXG4gICAgKiBhbmNlc3RvcnNfc3RydWN0IGZvciBhbGwgdGhlIG5vZGVzXG4gICAgKiBBbHNvIGFkZHMgYW55IG5vZGVzIHdpdGhvdXQgYW5jZXN0b3JzLCB0aGF0IGFyZW4ndCBcbiAgICAqIHRvcGxldmVsIHRvIHRoZSBjbGllbnQgc2VydmljZS5cbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnc2V0QW5jZXN0b3JzJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBzZXRBbmNlc3RvcnMoKSB7XG5cdFx0XHRcdHZhciB0aGlzRGF0YVNvdXJjZSA9IHRoaXM7XG5cdFx0XHRcdHZhciBhZGRlZENsaWVudCA9IGZhbHNlO1xuXHRcdFx0XHRfLmZvckVhY2godGhpc0RhdGFTb3VyY2Uubm9kZXMsIGZ1bmN0aW9uIChub2RlKSB7XG5cdFx0XHRcdFx0bm9kZS5hbmNlc3RvcnMgPSB0aGlzRGF0YVNvdXJjZS5hbmNlc3RvcnNfc3RydWN0W25vZGUuaWRdIHx8IFtdO1xuXHRcdFx0XHRcdGlmIChfLmlzRW1wdHkobm9kZS5hbmNlc3RvcnMpID09PSBmYWxzZSkge1xuXHRcdFx0XHRcdFx0bm9kZS5wYXJlbnQgPSBub2RlLmFuY2VzdG9yc1swXTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0aWYgKF8uaW5jbHVkZXModGhpc0RhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0LnRvcExldmVsLCBub2RlLmlkKSA9PSBmYWxzZSkge1xuXHRcdFx0XHRcdFx0XHQvL2NvbnRhaW5lciBoYXMgbm8gcGFyZW50XG5cdFx0XHRcdFx0XHRcdC8vYWRkaW5nIHRvIGNsaWVudFxuXHRcdFx0XHRcdFx0XHRub2RlLmFuY2VzdG9ycy5wdXNoKFwiY2xpZW50XCIpO1xuXHRcdFx0XHRcdFx0XHR0aGlzRGF0YVNvdXJjZS5hbmNlc3RvcnNfc3RydWN0W25vZGUuaWRdID0gW1wiY2xpZW50XCJdO1xuXHRcdFx0XHRcdFx0XHRpZiAoYWRkZWRDbGllbnQgPT09IGZhbHNlKSB7XG5cdFx0XHRcdFx0XHRcdFx0YWRkZWRDbGllbnQgPSB0cnVlO1xuXHRcdFx0XHRcdFx0XHRcdHRoaXNEYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbC5wdXNoKFwiY2xpZW50XCIpO1xuXHRcdFx0XHRcdFx0XHRcdHRoaXNEYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFsnY2xpZW50J10gPSBbXTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR0aGlzRGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbJ2NsaWVudCddLnB1c2gobm9kZS5pZCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBSZXR1cm5zIHRoZSBmbG93IGJldHdlZW4gdGhlIGhpZ2hlc3QgbGV2ZWwgZ3JvdXBpbmdcbiAgICAqXG4gICAgKiBAcmV0dXJuICAgICB7T2JqZWN0fSAgVGhlIHRvcCBsZXZlbCBmbG93LlxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdnZXRUb3BMZXZlbEZsb3cnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGdldFRvcExldmVsRmxvdygpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuZ2V0Rmxvd0JldHdlZW5TZXQodGhpcy5jaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwpO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIEdldHMgdGhlIGZsb3cgYmV0d2VlbiBhbnkgc2V0IG9mIG5vZGUgbGV2ZWxzXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZV9uYW1lcyAgVGhlIG5vZGUgbmFtZXMgaW4gdGhlIHNldFxuICAgICogQHJldHVybiAgICAge09iamVjdH0gIFRoZSBmbG93IGJldHdlZW4gc2V0LlxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdnZXRGbG93QmV0d2VlblNldCcsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gZ2V0Rmxvd0JldHdlZW5TZXQobm9kZV9uYW1lcykge1xuXHRcdFx0XHR2YXIgbG9jYWxfbm9kZXMgPSB0aGlzLm5vZGVzO1xuXHRcdFx0XHR2YXIgaWRNYXBwaW5nID0ge307XG5cdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbG9jYWxfbm9kZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHR2YXIgbm9kZSA9IGxvY2FsX25vZGVzW2ldO1xuXG5cdFx0XHRcdFx0Ly9pZiBub2RlIGlzIGFscmVhZHkgYXQgaXRzIGhpZ2hlc3QgbGV2ZWxcblx0XHRcdFx0XHRpZiAobm9kZS5hbmNlc3RvcnMgPT09IG51bGwpIHtcblx0XHRcdFx0XHRcdGlkTWFwcGluZ1tub2RlLmlkXSA9IG5vZGUubmFtZTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0Ly9jaGVjayB0byBzZWUgd2hpY2ggdGFncyBhcmUgcHJlc2VudCBpbiB0aGUgYW5jZXN0b3IgbGlzdFxuXHRcdFx0XHRcdFx0Zm9yICh2YXIgaiA9IDA7IGogPCBub2RlX25hbWVzLmxlbmd0aDsgaisrKSB7XG5cdFx0XHRcdFx0XHRcdGlmIChub2RlLmFuY2VzdG9ycy5pbmRleE9mKG5vZGVfbmFtZXNbal0pID4gLTEpIHtcblx0XHRcdFx0XHRcdFx0XHRpZE1hcHBpbmdbbm9kZS5pZF0gPSBub2RlX25hbWVzW2pdO1xuXHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdC8vbW9kaWZ5IGxpbmtzXG5cdFx0XHRcdHZhciBsaW5rcyA9IHRoaXMubGlua3M7XG5cdFx0XHRcdHZhciBsaW5rRGF0YSA9IFtdO1xuXG5cdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbGlua3MubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHR2YXIgbGluayA9IFtdO1xuXHRcdFx0XHRcdGxpbmsuc291cmNlID0gaWRNYXBwaW5nW2xpbmtzW2ldLnNvdXJjZV0gfHwgbGlua3NbaV0uc291cmNlO1xuXHRcdFx0XHRcdGxpbmsudGFyZ2V0ID0gaWRNYXBwaW5nW2xpbmtzW2ldLnRhcmdldF0gfHwgbGlua3NbaV0udGFyZ2V0O1xuXHRcdFx0XHRcdGxpbmsud2VpZ2h0ID0gbGlua3NbaV0ud2VpZ2h0O1xuXHRcdFx0XHRcdGxpbmtEYXRhLnB1c2gobGluayk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvL2NyZWF0aW5nIHRoZSBub2RlRGF0YVxuXHRcdFx0XHR2YXIgbm9kZURhdGEgPSBbXTtcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBub2RlX25hbWVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0dmFyIG5vZGVfdG9fYWRkID0gW107XG5cdFx0XHRcdFx0bm9kZV90b19hZGQuaWQgPSBub2RlX25hbWVzW2ldO1xuXHRcdFx0XHRcdG5vZGVfdG9fYWRkLnRleHQgPSB0aGlzLm5vZGVJZFRvTmFtZShub2RlX25hbWVzW2ldKSB8fCBub2RlX25hbWVzW2ldO1xuXG5cdFx0XHRcdFx0bm9kZV90b19hZGQuYW5jZXN0b3JzID0gdGhpcy5hbmNlc3RvcnNfc3RydWN0W25vZGVfbmFtZXNbaV1dIHx8IHRoaXMuYW5jZXN0b3JzX3N0cnVjdFtub2RlX3RvX2FkZC50ZXh0XSB8fCBbXTtcblx0XHRcdFx0XHRpZiAoXy5pc0VtcHR5KG5vZGVfdG9fYWRkLmFuY2VzdG9ycykgPT09IGZhbHNlKSB7XG5cdFx0XHRcdFx0XHRub2RlX3RvX2FkZC5wYXJlbnQgPSBub2RlX3RvX2FkZC5hbmNlc3RvcnNbMF07XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdG5vZGVfdG9fYWRkLnBhcmVudCA9IG51bGw7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdG5vZGVEYXRhLnB1c2gobm9kZV90b19hZGQpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuIHsgbm9kZURhdGE6IG5vZGVEYXRhLCBsaW5rRGF0YTogbGlua0RhdGEgfTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBwcm9jZXNzIHRoZSBub2RlRGF0YSBvdXRwdXQgb2YgZ2V0Rmxvd0JldHdlZW5TZXRcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlRGF0YSAgTm9kZURhdGEgdG8gY29udmVydCBcbiAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0byBub2RlIG9iamVjdHNcbiAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIE5vZGUgb2JqZWN0c1xuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdwcm9jZXNzTm9kZURhdGEnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHByb2Nlc3NOb2RlRGF0YShub2RlRGF0YSkge1xuXHRcdFx0XHR2YXIgbm9kZXMgPSBbXTtcblx0XHRcdFx0Xy5mb3JFYWNoKG5vZGVEYXRhLCBmdW5jdGlvbiAoZGF0YSkge1xuXHRcdFx0XHRcdHZhciBuZXdOb2RlID0gbmV3IFZpc3VhbGl6ZXJOb2RlLk5vZGUobnVsbCwgbnVsbCwgZGF0YS5pZCwgZGF0YS50ZXh0LCBudWxsLCBkYXRhLnBhcmVudCwgZGF0YS5hbmNlc3RvcnMsIG51bGwsIG51bGwpO1xuXHRcdFx0XHRcdG5vZGVzLnB1c2gobmV3Tm9kZSk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRyZXR1cm4gbm9kZXM7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogcHJvY2VzcyB0aGUgbGlua0RhdGEgb3V0cHV0IG9mIGdldEZsb3dCZXR3ZWVuU2V0XG4gICAgKlxuICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbGlua0RhdGEgIFRoZSBsaW5rIGRhdGFcbiAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVzICAgICBUaGUgbm9kZXNcbiAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIExpbmsgb2JqZWN0c1xuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdwcm9jZXNzTGlua0RhdGEnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHByb2Nlc3NMaW5rRGF0YShsaW5rRGF0YSwgbm9kZXMpIHtcblx0XHRcdFx0LyoqXG4gICAgICogUmV0dXJucyB0aGUgbm9kZSB0aGF0IG1hdGNoZXMgdGhlIGlkXG4gICAgICpcbiAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG4gICAgICogQHJldHVybiAgICAge05vZGV9ICAgVGhlIG5vZGUgd2l0aCB0aGUgbWF0Y2hpbmcgaWRcbiAgICAgKi9cblx0XHRcdFx0ZnVuY3Rpb24gZmluZE5vZGVCeUlkKGlkLCBub2Rlcykge1xuXHRcdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdGlmIChpZCA9PSBub2Rlc1tpXS5pZCkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gbm9kZXNbaV07XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0dmFyIGxpbmtzID0gW107XG5cdFx0XHRcdC8vYSBtYXBwaW5nIGZyb20gc291cmNlLmlkLXRhcmdldC5pZCB0byB0aGUgbGluayBhZGRlZFxuXHRcdFx0XHR2YXIgYWRkZWRfbGlua3MgPSB7fTtcblx0XHRcdFx0Ly90cmFuc2Zvcm1pbmcgbGluayBkYXRhXG5cdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbGlua0RhdGEubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRpZiAobGlua0RhdGFbaV0uc291cmNlICE9IGxpbmtEYXRhW2ldLnRhcmdldCkge1xuXHRcdFx0XHRcdFx0dmFyIHNvdXJjZSA9IGZpbmROb2RlQnlJZChsaW5rRGF0YVtpXS5zb3VyY2UsIG5vZGVzKTtcblx0XHRcdFx0XHRcdHZhciB0YXJnZXQgPSBmaW5kTm9kZUJ5SWQobGlua0RhdGFbaV0udGFyZ2V0LCBub2Rlcyk7XG5cdFx0XHRcdFx0XHR2YXIgd2VpZ2h0ID0gbGlua0RhdGFbaV0ud2VpZ2h0O1xuXHRcdFx0XHRcdFx0Ly9pbiBvcmRlciB0byBzdW0gYWxsIHRoZSB3ZWlnaHRzIG9mIHRoZSBsaW5rcyBvZiB0aGUgc3ViLW5vZGVzLFxuXHRcdFx0XHRcdFx0Ly93ZSB1c2UgYWRkZWRfbGlua3MgdG8ga2VlcCB0cmFjayBpZiBhbiBsaW5rIHdhcyBhZGRlZFxuXHRcdFx0XHRcdFx0Ly9pZiBpdCBpcywgd2UgbW9kaWZ5IGl0cyB3ZWlnaHRcblx0XHRcdFx0XHRcdGlmIChzb3VyY2UgPT0gbnVsbCB8fCB0YXJnZXQgPT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGlmIChhZGRlZF9saW5rc1tzb3VyY2UuaWQgKyAnLScgKyB0YXJnZXQuaWRdID09PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0XHRcdFx0dmFyIGxpbmsgPSBuZXcgVmlzdWFsaXplckxpbmsuTGluayhzb3VyY2UsIHRhcmdldCwgd2VpZ2h0KTtcblx0XHRcdFx0XHRcdFx0YWRkZWRfbGlua3Nbc291cmNlLmlkICsgJy0nICsgdGFyZ2V0LmlkXSA9IGxpbms7XG5cdFx0XHRcdFx0XHRcdGxpbmtzLnB1c2gobGluayk7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHR2YXIgZXhpc3RpbmdfbGluayA9IGFkZGVkX2xpbmtzW3NvdXJjZS5pZCArICctJyArIHRhcmdldC5pZF07XG5cdFx0XHRcdFx0XHRcdGV4aXN0aW5nX2xpbmsuc2V0V2VpZ2h0KGV4aXN0aW5nX2xpbmsuZ2V0UmF3V2VpZ2h0KCkgKyB3ZWlnaHQpO1xuXHRcdFx0XHRcdFx0XHRleGlzdGluZ19saW5rLmluY3JlYXNlQ291bnQoKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIGxpbmtzO1xuXHRcdFx0fVxuXHRcdH1dKTtcblxuXHRcdHJldHVybiBWaXN1YWxpemVyRGF0YVNvdXJjZTtcblx0fShEYXRhU291cmNlLkRhdGFTb3VyY2UpO1xuXG5cdHJldHVybiB7XG5cdFx0RGF0YVNvdXJjZTogVmlzdWFsaXplckRhdGFTb3VyY2Vcblx0fTtcbn1dKTtcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5hcHBsaWNhdGlvbmdyb3VwcycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvYXBwbGljYXRpb25ncm91cHMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnYXBwbGljYXRpb25ncm91cGNyZWF0ZSdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnYXBwbGljYXRpb25ncm91cGRldGFpbHMnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmVkaXQnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZWRpdC86a2V5JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2FwcGxpY2F0aW9uZ3JvdXBkZXRhaWxzJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3Vwcy5saXN0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnYXBwbGljYXRpb25Hcm91cGxpc3QnXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXBcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLyoqXG4gKiBUaGUgYmFzZSBjbGFzcyB0aGUgZ3JhcGggb2JqZWN0LiBBbnkgbm9kZXMgb3IgbGlua3MgdGhhdCBhcmUgY29udGFpbmVkIGluXG4gKiBpdHMgbm9kZXMgb3IgbGlua3MgcHJvcGVydHkgd2lsbCBiZSBkcmF3biBvbiB1cGRhdGVHcmFwaC5cbiAqIFN1cHBvcnRzIHBvbGljaWVzLlxuICogXG4gKiBUbyB3cml0ZSB5b3VyIG93biBncmFwaCBvYmplY3QsIGNyZWF0ZSBhIG5ldyBmYWN0b3J5IHRoYXQgdXNlcyB0aGUgZ3JhcGhcbiAqIHlvdSB3YW50IHRvIGluaGVyaXQgYXMgYSBkZXBlbmRlbmN5LCBhbmQgZXh0ZW5kIGl0cyBncmFwaCBjbGFzcy4gXG4gKiBSZXR1cm4gdGhlIGNsYXNzIG9iamVjdCB3aXRoIEdyYXBoIGFzIGtleS5cbiAqIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnR3JhcGgnLCBbJ1BvbGljeVNlcnZpY2UnLCBmdW5jdGlvbiAoUG9saWN5U2VydmljZSkge1xuICAgIHZhciBHcmFwaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGNvbnN0cnVjdG9yIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAgICAge0hUTUwgU1ZHfSAgc3ZnICAgICBUaGUgc3ZnIHRoYXQgd2lsbCBcbiAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob2xkIHRoZSBncmFwaFxuICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlcyAgICAgIExpc3Qgb2Ygbm9kZXMgZm9yIHRoZSBncmFwaFxuICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBsaW5rcyAgICAgIExpc3Qgb2YgbGlua3MgZm9yIHRoZSBncmFwaFxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gR3JhcGgoc3ZnLCBub2RlcywgbGlua3MpIHtcbiAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBHcmFwaCk7XG5cbiAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMgPSBub2RlcyB8fCBbXTtcbiAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IGxpbmtzIHx8IFtdO1xuXG4gICAgICAgICAgICB0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcyA9IFtdO1xuICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMgPSBbXTtcblxuICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeSA9IG5ldyBQb2xpY3lTZXJ2aWNlLlBvbGljeSgpO1xuXG4gICAgICAgICAgICB0aGlzR3JhcGguc3RhdGUgPSB7XG4gICAgICAgICAgICAgICAgY2FuWm9vbTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjYW5QYW46IHRydWUsXG4gICAgICAgICAgICAgICAgaW5pdEZvcmNlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBkaXNhYmxlVXBkYXRlOiBmYWxzZVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdGhpc0dyYXBoLmNvbnN0cyA9IHtcbiAgICAgICAgICAgICAgICBjaXJjbGVHQ2xhc3M6IFwiY29uY2VwdEdcIixcbiAgICAgICAgICAgICAgICBncmFwaENsYXNzOiBcImdyYXBoXCIsXG4gICAgICAgICAgICAgICAgcGF0aENsYXNzOiBcInBhdGhcIixcbiAgICAgICAgICAgICAgICBub2RlQ2xhc3M6IFwiY2lyY2xlXCIsXG4gICAgICAgICAgICAgICAgbm9kZVRleHQ6IFwibm9kZVRleHRcIixcbiAgICAgICAgICAgICAgICBzdGFydFJhZGl1czogNTAsXG4gICAgICAgICAgICAgICAgbWF4UmFkaXVzOiA2MCxcbiAgICAgICAgICAgICAgICBwYWRkaW5nOiA1LFxuICAgICAgICAgICAgICAgIGRpc3BsYXlPZmZzZXQ6IDYwXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBzdmcub24oXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wibW91c2VvdmVyXCJdLmNhbGwodGhpcywgZCk7XG4gICAgICAgICAgICB9KS5vbihcImRibGNsaWNrXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcImRibGNsaWNrXCJdLmNhbGwodGhpcywgZCk7XG4gICAgICAgICAgICB9KS5vbihcImNvbnRleHRtZW51XCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcImNvbnRleHRtZW51XCJdLmNhbGwodGhpcywgZCk7XG4gICAgICAgICAgICB9KS5vbihcIm1vdXNlb3V0XCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcIm1vdXNlb3V0XCJdLmNhbGwodGhpcywgZCk7XG4gICAgICAgICAgICB9KS5vbihcIm1vdXNlZG93blwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3lbXCJtb3VzZWRvd25cIl0uY2FsbCh0aGlzLCBkKTtcbiAgICAgICAgICAgIH0pLm9uKFwibW91c2V1cFwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3lbXCJtb3VzZXVwXCJdLmNhbGwodGhpcywgZCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gZGVmaW5lIGFycm93IG1hcmtlcnMgZm9yIGdyYXBoIGxpbmtzXG4gICAgICAgICAgICB2YXIgZGVmcyA9IHN2Zy5hcHBlbmQoJ3N2ZzpkZWZzJyk7XG4gICAgICAgICAgICBkZWZzLmFwcGVuZCgnc3ZnOm1hcmtlcicpLmF0dHIoJ2lkJywgJ2VuZC1hcnJvdycpLmF0dHIoXCJ2aWV3Qm94XCIsIFwiMCAtNSAxMCAxMFwiKS5hdHRyKFwicmVmWFwiLCAyMCkuYXR0cihcInJlZllcIiwgLTEpLmF0dHIoXCJtYXJrZXJXaWR0aFwiLCA2KS5hdHRyKFwibWFya2VySGVpZ2h0XCIsIDYpLmF0dHIoXCJvcmllbnRcIiwgXCJhdXRvXCIpLmFwcGVuZChcInBhdGhcIikuYXR0cihcImRcIiwgXCJNMCwtNUwxMCwwTDAsNVwiKTtcblxuICAgICAgICAgICAgLy8gZGVmaW5lIGFycm93IG1hcmtlcnMgZm9yIGxlYWRpbmcgYXJyb3dcbiAgICAgICAgICAgIGRlZnMuYXBwZW5kKCdzdmc6bWFya2VyJykuYXR0cignaWQnLCAnbWFyay1lbmQtYXJyb3cnKS5hdHRyKCd2aWV3Qm94JywgJzAgLTUgMTAgMTAnKS5hdHRyKCdyZWZYJywgNykuYXR0cignbWFya2VyV2lkdGgnLCAzLjUpLmF0dHIoJ21hcmtlckhlaWdodCcsIDMuNSkuYXR0cignb3JpZW50JywgJ2F1dG8nKS5hcHBlbmQoJ3N2ZzpwYXRoJykuYXR0cignZCcsICdNMCwtNUwxMCwwTDAsNScpO1xuXG4gICAgICAgICAgICB0aGlzR3JhcGguc3ZnID0gc3ZnO1xuICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z0cgPSBzdmcuYXBwZW5kKFwiZ1wiKS5jbGFzc2VkKHRoaXNHcmFwaC5jb25zdHMuZ3JhcGhDbGFzcywgdHJ1ZSk7XG4gICAgICAgICAgICB2YXIgc3ZnRyA9IHRoaXNHcmFwaC5zdmdHO1xuXG4gICAgICAgICAgICAvLyBzdmcgbm9kZXMgYW5kIGxpbmtzIFxuICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzID0gc3ZnRy5hcHBlbmQoXCJnXCIpLnNlbGVjdEFsbChcImdcIik7XG4gICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcyA9IHN2Z0cuYXBwZW5kKFwiZ1wiKS5zZWxlY3RBbGwoXCJnXCIpO1xuICAgICAgICAgICAgdGhpc0dyYXBoLmluaXROb2RlcygpO1xuICAgICAgICAgICAgdGhpc0dyYXBoLmluaXRMaW5rcygpO1xuXG4gICAgICAgICAgICB0aGlzR3JhcGguc2V0UG9zaXRpb25zKCk7XG4gICAgICAgICAgICB2YXIgcmVzaXplRnVuYyA9IGZ1bmN0aW9uIHJlc2l6ZUZ1bmMoKSB7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm9uV2luZG93UmVzaXplKHN2Zyk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0aGlzR3JhcGguYmluZGluZ3MgPSB7XG4gICAgICAgICAgICAgICAgcmVzaXplOiByZXNpemVGdW5jXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgJCh3aW5kb3cpLnJlc2l6ZShyZXNpemVGdW5jKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBjYWxscyB0aGUgZGVzdHJveSBtZXRob2QgZm9yIGFsbCBwb2xpY2llc1xuICAgICAgICAgKi9cblxuXG4gICAgICAgIF9jcmVhdGVDbGFzcyhHcmFwaCwgW3tcbiAgICAgICAgICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeS5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHRoaXNHcmFwaC5iaW5kaW5ncykge1xuICAgICAgICAgICAgICAgICAgICAkKHdpbmRvdykub2ZmKGtleSwgdGhpc0dyYXBoLmJpbmRpbmdzW2tleV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSdW5zIHRoZSBpbml0IGZ1bmN0aW9uIGZvciBhbGwgdGhlIG5vZGVzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdpbml0Tm9kZXMnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXROb2RlcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBub2RlLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSdW5zIHRoZSBpbml0IGZ1bmN0aW9uIGZvciBhbGwgdGhlIGxpbmtzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdpbml0TGlua3MnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRMaW5rcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLmxpbmtzLCBmdW5jdGlvbiAobGluaykge1xuICAgICAgICAgICAgICAgICAgICBsaW5rLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiByZXR1cm5zIHRoZSBub2RlIG1hdGNoaW5nIHRoZSBpZCwgXG4gICAgICAgICAgICAgKiBvciB1bmRlZmluZWQgaWYgdGhlcmUgaXMgbm9uZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7Tm9kZX0gIHsgbWF0Y2hpbmcgbm9kZSB9XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdmaW5kTm9kZUJ5SWQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmROb2RlQnlJZChpZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpc0dyYXBoLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpZCA9PT0gdGhpc0dyYXBoLm5vZGVzW2ldLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpc0dyYXBoLm5vZGVzW2ldO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdmaW5kRDNOb2RlJyxcblxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJldHVybnMgdGhlIGQzTm9kZSBvYmplY3QgdGhhdCBtYXRjaGVzIHRoZSBpZCxcbiAgICAgICAgICAgICAqIG9yIHVuZGVmaW5lZCBpZiB0aGVyZSBpcyBub25lXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGlkICAgICAgVGhlIGlkZW50aWZpZXJcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtEM05vZGV9IFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBmaW5kRDNOb2RlKGlkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIGQzTm9kZTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5lYWNoKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmlkID09PSBpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZDNOb2RlID0gZDMuc2VsZWN0KHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGQzTm9kZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIGluc3RhbGwgYSBkcmFnIHBvbGljeSB0aGF0IHdpbGwgYmUgY2FsbGVkXG4gICAgICAgICAgICAgKiB3aGVuIG5vZGVzIGFyZSBkcmFnZ2VkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzLmJlaGF2aW9yLmRyYWd9ICBkM2RyYWcgIEQzIGRyYWcgb2JqZWN0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdpbnN0YWxsRHJhZ1BvbGljeScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5zdGFsbERyYWdQb2xpY3koZDNkcmFnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kcmFnID0gZDNkcmFnO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVzZWQgdG8gaW5zdGFsbCBhIHBvbGljeSB0aGF0IHdpbGwgYmUgY2FsbGVkIFxuICAgICAgICAgICAgICogd2hlbiB0aGVyZSBpcyBtb3VzZSBpbnRlcmFjdGlvbnMgd2l0aCB0aGUgZ3JhcGgncyBzdmdcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UG9saWN5fSAgcG9saWN5ICBUaGUgcG9saWN5IHRvIGluc3RhbGxcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2luc3RhbGxTdmdQb2xpY3knLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluc3RhbGxTdmdQb2xpY3kocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdmdQb2xpY3kgPSBwb2xpY3k7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byBpbnN0YWxsIHBvbGljaWVzIHRoYXQgYXJlIGNhbGxlZCB3aGVuIHRoZXJlIGlzXG4gICAgICAgICAgICAgKiBtb3VzZSBpbnRlcmFjdGlvbiB3aXRoIGEgbm9kZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3kgIFRoZSBwb2xpY3kgdG8gaW5zdGFsbFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnaW5zdGFsbERlZmF1bHROb2RlUG9saWN5JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbnN0YWxsRGVmYXVsdE5vZGVQb2xpY3kocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMucHVzaChwb2xpY3kpO1xuICAgICAgICAgICAgICAgIHBvbGljeS5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byByZW1vdmUgYW4gaW5zdGFsbGVkIHBvbGljeSBmb3Igbm9kZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHBvbGljeVJlbW92ZSAgVGhlIHBvbGljeSB0byByZW1vdmVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3VuaW5zdGFsbERlZmF1bHROb2RlUG9saWN5JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1bmluc3RhbGxEZWZhdWx0Tm9kZVBvbGljeShwb2xpY3lSZW1vdmUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcG9saWN5UmVtb3ZlTmFtZTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHBvbGljeVJlbW92ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlLnBvbGljeU5hbWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24gKHBvbGljeSwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvbGljeS5wb2xpY3lOYW1lID09PSBwb2xpY3lSZW1vdmVOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2xpY3kuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJldHVybnMgdGhlIG5vZGUgcG9saWN5IG9iamVjdCB3aXRoIHRoZSBnaXZlbiBuYW1lXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHBvbGljeU5hbWUgIFRoZSBwb2xpY3kgbmFtZVxuICAgICAgICAgICAgICogQHJldHVybiAgICAge1BvbGljeX0gIHBvbGljeSAgICAgIFRoZSBtYXRjaGluZyBwb2xpY3lcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2dldE5vZGVQb2xpY3knLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldE5vZGVQb2xpY3kocG9saWN5TmFtZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5LCBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9saWN5LnBvbGljeU5hbWUgPT09IHBvbGljeU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwb2xpY3k7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIGluc3RhbGwgcG9saWNpZXMgdGhhdCBhcmUgY2FsbGVkIHdoZW4gdGhlcmUgaXMgYVxuICAgICAgICAgICAgICogbW91c2UgaW50ZXJhY3Rpb24gd2l0aCBhIHBhdGhcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UG9saWN5fSAgcG9saWN5ICBUaGUgcG9saWN5IHRvIGluc3RhbGxcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2luc3RhbGxEZWZhdWx0UGF0aFBvbGljeScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5zdGFsbERlZmF1bHRQYXRoUG9saWN5KHBvbGljeSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzLnB1c2gocG9saWN5KTtcbiAgICAgICAgICAgICAgICBwb2xpY3kuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVzZWQgdG8gcmVtb3ZlIGFuIGluc3RhbGxlZCBwb2xpY3kgZm9yIGxpbmtzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeVJlbW92ZSAgVGhlIHBvbGljeSB0byByZW1vdmVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3VuaW5zdGFsbERlZmF1bHRQYXRoUG9saWN5JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1bmluc3RhbGxEZWZhdWx0UGF0aFBvbGljeShwb2xpY3lSZW1vdmUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcG9saWN5UmVtb3ZlTmFtZTtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHBvbGljeVJlbW92ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlLnBvbGljeU5hbWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24gKHBvbGljeSwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvbGljeS5wb2xpY3lOYW1lID09PSBwb2xpY3lSZW1vdmVOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2xpY3kuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZXJlIGlzIGEgbW91c2UgaW50ZXJhY3Rpb24gd2l0aCBhIHBhdGhcbiAgICAgICAgICAgICAqIFByb3BvZ2F0ZXMgdGhlIGV2ZW50IHRvIGFsbCBpbnN0YWxsZWQgcGF0aCBwb2xpY2llc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBldmVudCAgIFRoZSBldmVudCB0eXBlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7ZDNvYmplY3R9ICBkM3BhdGggIFRoZSBkMyBwYXRoXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UGF0aH0gIGQgICAgICAgVGhlIG1hdGNoaW5nIExpbmsgb2JqZWN0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdwYXRoUG9saWN5RXZlbnQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHBhdGhQb2xpY3lFdmVudChldmVudCwgZDNwYXRoLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVtldmVudF0oZDNwYXRoLCBkKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGVyZSBpcyBhIG1vdXNlIGludGVyYWN0aW9uIHdpdGggYSBub2RlXG4gICAgICAgICAgICAgKiBQcm9wb2dhdGVzIHRoZSBldmVudCB0byBhbGwgaW5zdGFsbGVkIG5vZGUgcG9saWNpZXNcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGV2ZW50ICAgVGhlIGV2ZW50IHR5cGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM29iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQYXRofSAgZCAgICAgICBUaGUgbWF0Y2hpbmcgTm9kZSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ25vZGVQb2xpY3lFdmVudCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbm9kZVBvbGljeUV2ZW50KGV2ZW50LCBkM25vZGUsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMsIGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5W2V2ZW50XShkM25vZGUsIGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNldHMgcGFuIGFuZCB6b29tIHJ1bGVzIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7ZDMuYmVoYXZpb3Iuem9vbX0gIGQzem9vbSAgRDMgem9vbSBvYmpcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2luc3RhbGxab29tUG9saWN5JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbnN0YWxsWm9vbVBvbGljeShkM3pvb20pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRyYWdTdmcgPSBkM3pvb207XG4gICAgICAgICAgICAgICAgdGhpcy5zdmcuY2FsbCh0aGlzLmRyYWdTdmcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSB3aW5kb3cgaXMgcmVzaXplZFxuICAgICAgICAgICAgICogSG9vayBmb3Igb3ZlcnJpZGluZyBpbiBzdWJjbGFzc2VzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0hUTUwgU1ZHfSAgc3ZnICAgICBUaGUgc3ZnIHRoYXQgdGhlIGhhbmRsZXJcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXMgYXR0YWNoZWQgdG9cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ29uV2luZG93UmVzaXplJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvbldpbmRvd1Jlc2l6ZShzdmcpIHt9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogSW5zZXJ0cyBsaW5lIGJyZWFrcyBpbiBub2RlIHRleHRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBFbGVtfSAgZ0VsICAgIFRoZSBlbGVtIHRvIGFkZCB0ZXh0IHRvXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgdGl0bGUgICBUaGUgdGl0bGVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2luc2VydFRpdGxlTGluZWJyZWFrcycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5zZXJ0VGl0bGVMaW5lYnJlYWtzKGdFbCwgdGl0bGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgd29yZHMgPSB0aXRsZS5zcGxpdCgvXFxzKy9nKSxcbiAgICAgICAgICAgICAgICAgICAgbndvcmRzID0gd29yZHMubGVuZ3RoO1xuICAgICAgICAgICAgICAgIHZhciBlbCA9IGdFbC5hcHBlbmQoXCJ0ZXh0XCIpLmF0dHIoJ2NsYXNzJywgdGhpc0dyYXBoLmNvbnN0cy5ub2RlVGV4dCkuYXR0cihcInRleHQtYW5jaG9yXCIsIFwibWlkZGxlXCIpLmF0dHIoXCJkeVwiLCBcIi1cIiArIChud29yZHMgLSAxKSAqIDcuNSk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHdvcmRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0c3BhbiA9IGVsLmFwcGVuZCgndHNwYW4nKS50ZXh0KHdvcmRzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgPiAwKSB0c3Bhbi5hdHRyKCd4JywgMCkuYXR0cignZHknLCAnMTUnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyBhbGwgbGlua3MgZnJvbSB0aGUgZ2l2ZW4gbm9kZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnc3BsaWNlTGlua3NGb3JOb2RlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzcGxpY2VMaW5rc0Zvck5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICB0b1NwbGljZSA9IHRoaXNHcmFwaC5saW5rcy5maWx0ZXIoZnVuY3Rpb24gKGwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGwuc291cmNlID09PSBub2RlIHx8IGwudGFyZ2V0ID09PSBub2RlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRvU3BsaWNlLm1hcChmdW5jdGlvbiAobCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3Muc3BsaWNlKHRoaXNHcmFwaC5saW5rcy5pbmRleE9mKGwpLCAxKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBBZGRzIHRoZSBub2RlIHRvIHRoZSBncmFwaCBhbmQgdXBkYXRlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnYWRkTm9kZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYWRkTm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnB1c2gobm9kZSk7XG4gICAgICAgICAgICAgICAgbm9kZS5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3JlbW92ZU5vZGUnLFxuXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyB0aGUgbm9kZSB0byB0aGUgZ3JhcGggYW5kIHVwZGF0ZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZU5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5zcGxpY2UodGhpc0dyYXBoLm5vZGVzLmluZGV4T2Yobm9kZSksIDEpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zcGxpY2VMaW5rc0Zvck5vZGUobm9kZSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnYWRkTGluaycsXG5cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBBZGRzIHRoZSBsaW5rIHRvIHRoZSBncmFwaCBhbmQgdXBkYXRlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtsaW5rfSAgbGluayAgICBUaGUgbGlua1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYWRkTGluayhsaW5rKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzLnB1c2gobGluayk7XG4gICAgICAgICAgICAgICAgbGluay5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3JlbW92ZUxpbmsnLFxuXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyB0aGUgbGluayB0byB0aGUgZ3JhcGggYW5kIHVwZGF0ZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bGlua30gIGxpbmsgICAgVGhlIGxpbmtcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZUxpbmsobGluaykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcy5zcGxpY2UodGhpc0dyYXBoLmxpbmtzLmluZGV4T2YobGluayksIDEpO1xuICAgICAgICAgICAgICAgIGxpbmsuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyB1cGRhdGluZyBleGlzdGluZyBwYXRoc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQYXRofSAgcGF0aHMgICBMaXN0IG9mIHBhdGhzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd1cGRhdGVFeGlzdGluZ1BhdGhzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVFeGlzdGluZ1BhdGhzKHBhdGhzKSB7XG4gICAgICAgICAgICAgICAgcGF0aHMuZWFjaChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBkLnVwZGF0ZUF0dHIoZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgYWRkaW5nIG5ldyBwYXRoc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQYXRofSAgbmV3UGF0aHMgIExpc3Qgb2YgbmV3IHBhdGhzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd1cGRhdGVOZXdQYXRocycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlTmV3UGF0aHMobmV3UGF0aHMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0TGlua3MoKTtcblxuICAgICAgICAgICAgICAgIG5ld1BhdGhzLmVhY2goZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5uZXdQYXRoQXR0cihkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy9pZiBub2RlIGRvZXNuJ3QgaGF2ZSBpdHMgb3duIHBvbGljeSwgdXNlIGRlZmF1bHQgZm9yIHRoZSBncmFwaFxuICAgICAgICAgICAgICAgIG5ld1BhdGhzLm9uKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZW92ZXJcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZW92ZXJcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLm9uKFwiZGJsY2xpY2tcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLnBhdGhQb2xpY3lFdmVudChcImRibGNsaWNrXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aFBvbGljeUV2ZW50KFwiZGJsY2xpY2tcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLm9uKFwiY29udGV4dG1lbnVcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLnBhdGhQb2xpY3lFdmVudChcImNvbnRleHRtZW51XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aFBvbGljeUV2ZW50KFwiY29udGV4dG1lbnVcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLm9uKFwibW91c2VvdXRcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlb3V0XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aFBvbGljeUV2ZW50KFwibW91c2VvdXRcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLm9uKFwibW91c2Vkb3duXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZWRvd25cIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZWRvd25cIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLm9uKFwibW91c2V1cFwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQucGF0aFBvbGljeUV2ZW50KFwibW91c2V1cFwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcIm1vdXNldXBcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpc0dyYXBoLmRyYWcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyB1cGRhdGluZyBleGlzdGluZyBub2Rlc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAndXBkYXRlRXhpc3RpbmdOb2RlcycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlRXhpc3RpbmdOb2RlcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcyA9IHRoaXMuY2lyY2xlcy5kYXRhKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuaWQ7XG4gICAgICAgICAgICAgICAgfSkuZWFjaChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBkLnVwZGF0ZUF0dHIoZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgYWRkaW5nIG5ldyBub2Rlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbmV3Tm9kZXMgIExpc3Qgb2YgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd1cGRhdGVOZXdOb2RlcycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlTmV3Tm9kZXMobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgICAgIG5ld05vZGVzLmVhY2goZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuZ3JhcGggPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZC5uZXdOb2RlQXR0cihkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy9pZiBub2RlIGRvZXNuJ3QgaGF2ZSBpdHMgb3duIHBvbGljeSwgdXNlIGRlZmF1bHQgZm9yIHRoZSBncmFwaFxuICAgICAgICAgICAgICAgIG5ld05vZGVzLm9uKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5ub2RlUG9saWN5RXZlbnQoXCJtb3VzZW92ZXJcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlUG9saWN5RXZlbnQoXCJtb3VzZW92ZXJcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLm9uKFwiZGJsY2xpY2tcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcImRibGNsaWNrXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwiZGJsY2xpY2tcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLm9uKFwiY29udGV4dG1lbnVcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcImNvbnRleHRtZW51XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwiY29udGV4dG1lbnVcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLm9uKFwibW91c2VvdXRcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlb3V0XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwibW91c2VvdXRcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLm9uKFwibW91c2Vkb3duXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5ub2RlUG9saWN5RXZlbnQoXCJtb3VzZWRvd25cIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlUG9saWN5RXZlbnQoXCJtb3VzZWRvd25cIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLm9uKFwibW91c2V1cFwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQubm9kZVBvbGljeUV2ZW50KFwibW91c2V1cFwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcIm1vdXNldXBcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpc0dyYXBoLmRyYWcpO1xuXG4gICAgICAgICAgICAgICAgbmV3Tm9kZXMuYXBwZW5kKFwiY2lyY2xlXCIpLmF0dHIoXCJyXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBTdHJpbmcoZC5yYWRpdXMpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgbmV3Tm9kZXMuZWFjaChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5zZXJ0VGl0bGVMaW5lYnJlYWtzKGQzLnNlbGVjdCh0aGlzKSwgZC50ZXh0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBQcmV2ZW50cyBub2RlcyBmcm9tIGNvbGxpZGluZ1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICBhbHBoYSAgIEFmZmVjdHMgaG93IG11Y2ggY2hhbmdlXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGUgY29sbGlzaW9uIGNhdXNlc1xuICAgICAgICAgICAgICogQHJldHVybiAgICAge2Jvb2xlYW59ICB7V2hldGhlciBub2RlcyBhcmUgY29sbGlkZWR9XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkM0ZvcmNlQ29sbGlkZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZDNGb3JjZUNvbGxpZGUoYWxwaGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cztcbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICAgICAgdmFyIHF1YWR0cmVlID0gZDMuZ2VvbS5xdWFkdHJlZShub2Rlcyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByID0gZC5yYWRpdXMgKyBjb25zdHMubWF4UmFkaXVzICsgY29uc3RzLnBhZGRpbmcsXG4gICAgICAgICAgICAgICAgICAgICAgICBueDEgPSBkLnggLSByLFxuICAgICAgICAgICAgICAgICAgICAgICAgbngyID0gZC54ICsgcixcbiAgICAgICAgICAgICAgICAgICAgICAgIG55MSA9IGQueSAtIHIsXG4gICAgICAgICAgICAgICAgICAgICAgICBueTIgPSBkLnkgKyByO1xuICAgICAgICAgICAgICAgICAgICBxdWFkdHJlZS52aXNpdChmdW5jdGlvbiAocXVhZCwgeDEsIHkxLCB4MiwgeTIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChxdWFkLnBvaW50ICYmIHF1YWQucG9pbnQgIT09IGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IGQueCAtIHF1YWQucG9pbnQueCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeSA9IGQueSAtIHF1YWQucG9pbnQueSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbCA9IE1hdGguc3FydCh4ICogeCArIHkgKiB5KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgciA9IGQucmFkaXVzICsgcXVhZC5wb2ludC5yYWRpdXMgKyBjb25zdHMucGFkZGluZztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobCA8IHIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbCA9IChsIC0gcikgLyBsICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCAtPSB4ICo9IGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSAtPSB5ICo9IGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1YWQucG9pbnQueCArPSB4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWFkLnBvaW50LnkgKz0geTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geDEgPiBueDIgfHwgeDIgPCBueDEgfHwgeTEgPiBueTIgfHwgeTIgPCBueTE7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVGljayBvZiB0aGUgZDMgZm9yY2Ugc2ltdWxhdGlvblxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM3RpY2sgZXZlbnR9ICBlICAgIEQzdGljayBldmVudFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge251bWJlcn0gIHdpZHRoICBUaGUgd2lkdGggb2YgdGhlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICBoZWlnaHQgVGhlIGhlaWdodCBvZiB0aGUgc2ltdWxhdGlvblxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZDNGb3JjZVRpY2snLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGQzRm9yY2VUaWNrKGUsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cztcblxuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSBjb25zdHMuZGlzcGxheU9mZnNldDtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICAgICAgdmFyIHEgPSBkMy5nZW9tLnF1YWR0cmVlKHRoaXNHcmFwaC5ub2RlcyksXG4gICAgICAgICAgICAgICAgICAgIGkgPSAwLFxuICAgICAgICAgICAgICAgICAgICBuID0gbm9kZXMubGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgd2hpbGUgKCsraSA8IG4pIHtcbiAgICAgICAgICAgICAgICAgICAgcS52aXNpdCh0aGlzLmQzRm9yY2VDb2xsaWRlKG5vZGVzW2ldKSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZWFjaCh0aGlzLmQzRm9yY2VDb2xsaWRlKC41KSkuYXR0cihcImN4XCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnggPSBNYXRoLm1heChkLnJhZGl1cyArIG9mZnNldCwgTWF0aC5taW4od2lkdGggLSBvZmZzZXQgLSBkLnJhZGl1cywgZC54KSk7XG4gICAgICAgICAgICAgICAgfSkuYXR0cihcImN5XCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnkgPSBNYXRoLm1heChkLnJhZGl1cyArIG9mZnNldCwgTWF0aC5taW4oaGVpZ2h0IC0gb2Zmc2V0IC0gZC5yYWRpdXMsIGQueSkpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzLmF0dHIoJ3gxJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuc291cmNlLng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneTEnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5zb3VyY2UueTtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd4MicsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnRhcmdldC54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3kyJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQudGFyZ2V0Lnk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU3RhcnRzIG9uIHN0YXJ0IG9mIHRoZSBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkM0ZvcmNlU3RhcnQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGQzRm9yY2VTdGFydCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHMuYXR0cigneDEnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5zb3VyY2UueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd5MScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnNvdXJjZS55O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3gyJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQudGFyZ2V0Lng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneTInLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC50YXJnZXQueTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgb24gdGhlIGVuZCBvZiB0aGUgZm9yY2Ugc2ltdWxhdGlvblxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZDNGb3JjZUVuZCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZDNGb3JjZUVuZCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5hdHRyKCdjeCcsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cignY3knLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55O1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzLmF0dHIoJ3gxJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuc291cmNlLng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneTEnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5zb3VyY2UueTtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd4MicsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnRhcmdldC54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3kyJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQudGFyZ2V0Lnk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsY3VsYXRlcyB0aGUgd2lkdGggYW5kIGhlaWdodCBib3VuZHMgZm9yIHRoZSBcbiAgICAgICAgICAgICAqIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7T2JqZWN0fSAgd2lkdGggYW5kIGhlaWdodCBhcyBwcm9wZXJ0aWVzIFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZDNGb3JjZUJvdW5kcycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZDNGb3JjZUJvdW5kcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnV2lkdGggPSAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLndpZHRoKCk7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z0hlaWdodCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykuaGVpZ2h0KCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBzdmdXaWR0aDtcbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gc3ZnSGVpZ2h0O1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHdpZHRoOiB3aWR0aCwgaGVpZ2h0OiBoZWlnaHQgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBEb2VzIGEgZDMgZm9yY2Ugc2ltdWxhdGlvblxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtGdW5jdGlvbn0gIGNhbGxiYWNrICBUaGUgY2FsbGJhY2tcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3NldEZvcmNlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRGb3JjZShjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgICAgIHZhciBsaW5rcyA9IHRoaXNHcmFwaC5saW5rcztcbiAgICAgICAgICAgICAgICBpZiAoXy5pc0VtcHR5KG5vZGVzKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGJvdW5kcyA9IHRoaXNHcmFwaC5kM0ZvcmNlQm91bmRzKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgZm9yY2UgPSBkMy5sYXlvdXQuZm9yY2UoKS5zaXplKFtib3VuZHMud2lkdGgsIGJvdW5kcy5oZWlnaHRdKS5ub2Rlcyhub2RlcykuY2hhcmdlKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtNjAwMDtcbiAgICAgICAgICAgICAgICB9KS5saW5rcyhsaW5rcyk7XG5cbiAgICAgICAgICAgICAgICBmb3JjZS5saW5rRGlzdGFuY2UoYm91bmRzLndpZHRoIC8gMyk7XG4gICAgICAgICAgICAgICAgZm9yY2UubGlua1N0cmVuZ3RoKC4yKTtcbiAgICAgICAgICAgICAgICBmb3JjZS5ncmF2aXR5KC4yKTtcblxuICAgICAgICAgICAgICAgIGZvcmNlLm9uKCd0aWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLmQzRm9yY2VUaWNrLmNhbGwodGhpc0dyYXBoLCBlLCBib3VuZHMud2lkdGgsIGJvdW5kcy5oZWlnaHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZm9yY2Uub24oJ3N0YXJ0JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguZDNGb3JjZVN0YXJ0LmNhbGwodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGZvcmNlLm9uKCdlbmQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kM0ZvcmNlRW5kLmNhbGwodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGZvcmNlLnN0YXJ0KCk7XG4gICAgICAgICAgICAgICAgdmFyIGsgPSAwO1xuICAgICAgICAgICAgICAgIHdoaWxlIChmb3JjZS5hbHBoYSgpID4gMWUtMiAmJiBrIDwgMTUwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvcmNlLnRpY2soKTtcbiAgICAgICAgICAgICAgICAgICAgayA9IGsgKyAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmb3JjZS5zdG9wKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTZXRzIHRoZSBwb3NpdGlvbnMgdG8gYmUgdGhlIGNlbnRlciBvZiB0aGUgc2NyZWVuIGlmIFxuICAgICAgICAgICAgICogbm90IHByb3ZpZGVkXG4gICAgICAgICAgICAgKiBhbHNvIHNldHMgdGhlIHJhZGl1cyBvZiB0aGUgbm9kZXNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3NldFBvc2l0aW9ucycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0UG9zaXRpb25zKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IHRoaXNHcmFwaC5jb25zdHMuZGlzcGxheU9mZnNldDtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnV2lkdGggPSAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLndpZHRoKCk7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z0hlaWdodCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykuaGVpZ2h0KCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBzdmdXaWR0aCAtIDIgKiBvZmZzZXQ7XG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IHN2Z0hlaWdodCAtIDIgKiBvZmZzZXQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVzW2ldLnJhZGl1cyA9IG5vZGVzW2ldLnJhZGl1cyB8fCB0aGlzR3JhcGguY29uc3RzLnN0YXJ0UmFkaXVzO1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZXNbaV0ueCA9PSBudWxsIHx8IG5vZGVzW2ldLnkgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm9kZXNbaV0ueFN0YXJ0ID0gd2lkdGgvMiAgKyBub2Rlc1tpXS5yYWRpdXMgKyBvZmZzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzW2ldLnggPSB3aWR0aCAvIDIgKyBub2Rlc1tpXS5yYWRpdXMgKyBvZmZzZXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBub2Rlc1tpXS55U3RhcnQgPSBoZWlnaHQvMiArIG5vZGVzW2ldLnJhZGl1cyArIG9mZnNldFxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNbaV0ueSA9IGhlaWdodCAvIDIgKyBub2Rlc1tpXS5yYWRpdXMgKyBvZmZzZXQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHRvIHVwZGF0ZSB0aGUgdmlldyBvZiB0aGUgZ3JhcGggd2hlblxuICAgICAgICAgICAgICogZGF0YSBjaGFuZ2VzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0Z1bmN0aW9ufSAgY2FsbGJhY2sgIFRoZSBjYWxsYmFja1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAndXBkYXRlR3JhcGgnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUdyYXBoKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5zdGF0ZS5kaXNhYmxlVXBkYXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUV4aXN0aW5nTm9kZXMoKTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3R3MgPSB0aGlzR3JhcGguY2lyY2xlcy5lbnRlcigpLmFwcGVuZChcImdcIik7XG5cbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygndXBkYXRlJywgbmV3R3MpO1xuICAgICAgICAgICAgICAgIG5ld0dzLmNsYXNzZWQoY29uc3RzLmNpcmNsZUdDbGFzcywgdHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICAvLyB0aGlzLnVwZGF0ZU5ld05vZGVzKG5ld0dzKTtcblxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBvbGQgbm9kZXNcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5leGl0KCkucmVtb3ZlKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuaW5pdEZvcmNlID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zZXRGb3JjZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlTmV3Tm9kZXMuY2FsbCh0aGlzR3JhcGgsIG5ld0dzKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmluaXRGb3JjZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVOZXdOb2RlcyhuZXdHcyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzID0gdGhpc0dyYXBoLnBhdGhzLmRhdGEodGhpc0dyYXBoLmxpbmtzLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gU3RyaW5nKGQuc291cmNlLmlkKSArIFwiK1wiICsgU3RyaW5nKGQudGFyZ2V0LmlkKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB2YXIgcGF0aHMgPSB0aGlzR3JhcGgucGF0aHM7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVFeGlzdGluZ1BhdGhzKHBhdGhzKTtcblxuICAgICAgICAgICAgICAgIHZhciBuZXdwYXRocyA9IHBhdGhzLmVudGVyKCkuYXBwZW5kKFwicGF0aFwiKS5zdHlsZSgnbWFya2VyLWVuZCcsICd1cmwoI2VuZC1hcnJvdyknKS5jbGFzc2VkKFwibGlua1wiLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZU5ld1BhdGhzKG5ld3BhdGhzKTtcblxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBvbGQgbGlua3NcbiAgICAgICAgICAgICAgICBwYXRocy5leGl0KCkucmVtb3ZlKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfV0pO1xuXG4gICAgICAgIHJldHVybiBHcmFwaDtcbiAgICB9KCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBHcmFwaDogR3JhcGhcbiAgICB9O1xufV0pO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmRhc2hib2FyZCcsIFsnY29udGl2Lm1vZGVscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5kYXNoYm9hcmQnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGFzaGJvYXJkJyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2Rhc2hib2FyZCdcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcFxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbi8qKlxuICogVGhlIGdyYXBoIHRoYXQgaXMgdXNlZCBzcGVjaWZpY2FsbHkgZm9yIHRoZSB2aXN1YWxpemF0aW9uIHRhYi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ1Zpc3VhbGl6ZXJHcmFwaCcsIFsnR3JhcGgnLCBmdW5jdGlvbiAoR3JhcGgpIHtcbiAgICB2YXIgVmlzdWFsaXplckdyYXBoID0gZnVuY3Rpb24gKF9HcmFwaCRHcmFwaCkge1xuICAgICAgICBfaW5oZXJpdHMoVmlzdWFsaXplckdyYXBoLCBfR3JhcGgkR3JhcGgpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgIHtIVE1MIFNWR30gIHN2ZyAgICAgICAgICAgICBUaGUgc3ZnIHRoYXQgd2lsbCBcbiAgICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvbGQgdGhlIGdyYXBoXG4gICAgICAgICAgICAgICAqIEBwYXJhbSAgIHtBcnJheX0gIG5vZGVzICAgXHRcdCAgICBMaXN0IG9mIG5vZGVzXG4gICAgICAgICAgICAgICAqIEBwYXJhbSAgIHtBcnJheX0gIGxpbmtzICAgXHRcdCAgICBMaXN0IG9mIGxpbmtzXG4gICAgICAgICAqIEBwYXJhbSAgIHtEYXRhU291cmNlfSAgZGF0YVNvdXJjZSAgICBUaGUgZGF0YSBzb3VyY2VcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIFZpc3VhbGl6ZXJHcmFwaChzdmcsIG5vZGVzLCBsaW5rcywgZGF0YVNvdXJjZSkge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZpc3VhbGl6ZXJHcmFwaCk7XG5cbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChWaXN1YWxpemVyR3JhcGguX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihWaXN1YWxpemVyR3JhcGgpKS5jYWxsKHRoaXMsIHN2Zywgbm9kZXMsIGxpbmtzKSk7XG5cbiAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSBfdGhpcztcblxuICAgICAgICAgICAgLy9ob2xkcyBjdXJyZW50IHRyYW5zaXRpb25zIHRoYXQgYXJlIG9jY3VyaW5nXG4gICAgICAgICAgICB0aGlzR3JhcGguc3RhdGUudHJhbnNpdGlvbiA9IFtdO1xuICAgICAgICAgICAgLy9NaW4gZGlzdGFuY2UgYmV0d2VlbiBub2RlcyB3aGVuIHNwYXduaW5nIHJhbmRvbWx5XG4gICAgICAgICAgICB0aGlzR3JhcGguY29uc3RzLmVkZ2VfYnVmZmVyID0gMjAwO1xuICAgICAgICAgICAgLy9TaXplIHJlZHVjdGlvbiBhcyB5b3UgZ28gdGhyb3VnaCBsZXZlbHMgaW4gbm9kZXNcbiAgICAgICAgICAgIHRoaXNHcmFwaC5jb25zdHMucmFkaXVzRGVjYXkgPSAxO1xuICAgICAgICAgICAgLy9Dc3MgY2xhc3MgZm9yIG5vZGVzIHRoYXQgYXJlIGNvbnRhaW5lcnNcbiAgICAgICAgICAgIHRoaXNHcmFwaC5jb25zdHMuY29udGFpbmVyQ2xhc3MgPSAnY29udGFpbmVyJztcblxuICAgICAgICAgICAgLy9kYXRhU291cmNlIGhvbGRzIHRoZSBzZXJ2ZXIgZGF0YSBhbmQgbWV0aG9kcyBmb3JcbiAgICAgICAgICAgIC8vY29udmVydGluZyBpdCB0byBkYXRhIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgIHRoaXNHcmFwaC5kYXRhU291cmNlID0gZGF0YVNvdXJjZTtcblxuICAgICAgICAgICAgLy9EcmFnIGJlaGF2aW9yIGZvciBub2Rlc1xuICAgICAgICAgICAgdmFyIGRyYWcgPSBkMy5iZWhhdmlvci5kcmFnKCkub3JpZ2luKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgeDogZC54LCB5OiBkLnkgfTtcbiAgICAgICAgICAgIH0pLm9uKFwiZHJhZ3N0YXJ0XCIsIGZ1bmN0aW9uICgpIHt9KS5vbihcImRyYWdcIiwgZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykuYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbiAoZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICBkLnggKz0gZDMuZXZlbnQuZHg7XG4gICAgICAgICAgICAgICAgICAgIGQueSArPSBkMy5ldmVudC5keTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwidHJhbnNsYXRlKFwiICsgW2QueCwgZC55XSArIFwiKVwiO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfSkub24oXCJkcmFnZW5kXCIsIGZ1bmN0aW9uICgpIHt9KTtcblxuICAgICAgICAgICAgdGhpc0dyYXBoLmRyYWcgPSBkcmFnO1xuXG4gICAgICAgICAgICAvL1BhbiBhbmQgWm9vbSBiZWhhdmlvciBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICB2YXIgem9vbSA9IGQzLmJlaGF2aW9yLnpvb20oKS5vbihcInpvb21cIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChkMy5ldmVudC5zb3VyY2VFdmVudCAhPSBudWxsICYmIGQzLmV2ZW50LnNvdXJjZUV2ZW50LmN0cmxLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQuY2FsbCh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0pLm9uKFwiem9vbXN0YXJ0XCIsIGZ1bmN0aW9uIChkLCBpKSB7fSk7XG4gICAgICAgICAgICB0aGlzR3JhcGguZHJhZ1N2ZyA9IHpvb207XG4gICAgICAgICAgICB0aGlzR3JhcGguc3ZnLmNhbGwoem9vbSkub24oXCJkYmxjbGljay56b29tXCIsIG51bGwpO1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENhbGxlZCB3aXRoIG5vIGFyZ3Mgd2hlbiB0aGUgZ3JhcGggaGFzIGEgem9vbSBhY3Rpb25cbiAgICAgICAgICogQ2FuIGFsc28gYmUgY2FsbGVkIHdpdGggYXJncyB0byBmb3JjZSBhIHpvb20gb3IgcGFuIFxuICAgICAgICAgKiBldmVudCBmb3IgdGhlIGdyYXBoLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgdHJhbnNsYXRlICBUaGUgYW1vdW50IHRvIHRyYW5zbGF0ZVxuICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgc2NhbGUgICAgICBUaGUgYW1vdW50IHRvIHNjYWxlXG4gICAgICAgICAqL1xuXG5cbiAgICAgICAgX2NyZWF0ZUNsYXNzKFZpc3VhbGl6ZXJHcmFwaCwgW3tcbiAgICAgICAgICAgIGtleTogJ3pvb21lZCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gem9vbWVkKHRyYW5zbGF0ZSwgc2NhbGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLnN0YXRlLnJpZ2h0Q2xpY2sgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuanVzdFNjYWxlVHJhbnNHcmFwaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKHRyYW5zbGF0ZSAhPSBudWxsICYmIHNjYWxlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSB0aGlzR3JhcGguZHJhZ1N2ZztcbiAgICAgICAgICAgICAgICAgICAgem9vbS5zY2FsZShzY2FsZSk7XG4gICAgICAgICAgICAgICAgICAgIHpvb20udHJhbnNsYXRlKHRyYW5zbGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIC8vY3JlYXRpbmcgbmFtZXMgdG8gcHJldmVudCB0cmFuc2l0aW9uIGNvbmZsaWN0c1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbVNldENhbGxiYWNrID0gZnVuY3Rpb24gem9vbVNldENhbGxiYWNrKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgem9vbS5zY2FsZShzY2FsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB6b29tLnRyYW5zbGF0ZSh0cmFuc2xhdGUpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB2YXIgdHJhbnNsYXRlX25hbWUgPSBcInpvb21cIiArIHRyYW5zbGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KFwiLlwiICsgdGhpcy5jb25zdHMuZ3JhcGhDbGFzcykudHJhbnNpdGlvbih0cmFuc2xhdGVfbmFtZSkuZGVsYXkoMTAwKS5kdXJhdGlvbig3NTApLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoJyArIHpvb20udHJhbnNsYXRlKCkgKyAnKSBzY2FsZSgnICsgem9vbS5zY2FsZSgpICsgJyknKS5lYWNoKFwiZW5kXCIsIHpvb21TZXRDYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5zdGF0ZS5jYW5ab29tKSB7XG4gICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdChcIi5cIiArIHRoaXMuY29uc3RzLmdyYXBoQ2xhc3MpLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKSArIFwiKSBzY2FsZShcIiArIHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCkgKyBcIilcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdvbldpbmRvd1Jlc2l6ZScsXG5cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgd2luZG93IHJlc2l6ZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBTVkd9ICBzdmcgICAgVGhlIHN2ZyB0byByZXNpemVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uV2luZG93UmVzaXplKHN2Zykge1xuICAgICAgICAgICAgICAgIHZhciBib2R5RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnYm9keScpWzBdO1xuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLm9mZnNldCgpO1xuICAgICAgICAgICAgICAgIHZhciBkaXZXaWR0aCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykud2lkdGgoKTtcbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gYm9keUVsLmNsaWVudEhlaWdodDtcbiAgICAgICAgICAgICAgICBzdmcuYXR0cihcIndpZHRoXCIsIGRpdldpZHRoKS5hdHRyKFwiaGVpZ2h0XCIsIGhlaWdodCAtIG9mZnNldC50b3AgLSAyMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3VwZGF0ZUxpbmtEYXRhJyxcblxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBzZXJ2ZXIgc2VuZHMgdXBkYXRlZCBkYXRhIGZvciB0aGUgbGlua3NcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUxpbmtEYXRhKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBub2RlX25hbWVzX3NldCA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpc0dyYXBoLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVfbmFtZXNfc2V0LnB1c2godGhpc0dyYXBoLm5vZGVzW2ldLmlkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHJldERhdGEgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5nZXRGbG93QmV0d2VlblNldChub2RlX25hbWVzX3NldCk7XG4gICAgICAgICAgICAgICAgdmFyIGxpbmtEYXRhID0gcmV0RGF0YS5saW5rRGF0YTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5wcm9jZXNzTGlua0RhdGEobGlua0RhdGEsIHRoaXNHcmFwaC5ub2Rlcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5pbml0Tm9kZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRMaW5rcygpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIFZpc3VhbGl6ZXJHcmFwaDtcbiAgICB9KEdyYXBoLkdyYXBoKTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIEdyYXBoOiBWaXN1YWxpemVyR3JhcGhcbiAgICB9O1xufV0pO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE5LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmxvZ2luJywgWydjb250aXYudXRpbHMnXSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbi8qKlxuICogVGhlIGJhc2UgY2xhc3MgZm9yIGxpbmsgb2JqZWN0cyBmb3IgdGhlIGdyYXBoLlxuICogU3VwcG9ydHMgcG9saWNpZXMuXG4gKiBcbiAqIFRvIHdyaXRlIHlvdXIgb3duIGxpbmsgb2JqZWN0LCBjcmVhdGUgYSBuZXcgZmFjdG9yeSB0aGF0IHVzZXMgdGhlIGxpbmtcbiAqIHlvdSB3YW50IHRvIGluaGVyaXQgYXMgYSBkZXBlbmRlbmN5LCBhbmQgZXh0ZW5kIGl0cyBsaW5rIGNsYXNzLiBcbiAqIFJldHVybiB0aGUgY2xhc3Mgb2JqZWN0IHdpdGggTGluayBhcyBrZXlcbiAqIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnTGluaycsIFtmdW5jdGlvbiAoKSB7XG5cdHZhciBMaW5rID0gZnVuY3Rpb24gKCkge1xuXHRcdC8qKlxuICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAqXG4gICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgc291cmNlTm9kZSAgVGhlIHNvdXJjZSBub2RlXG4gICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgdGFyZ2V0Tm9kZSAgVGhlIHRhcmdldCBub2RlXG4gICAqL1xuXHRcdGZ1bmN0aW9uIExpbmsoc291cmNlTm9kZSwgdGFyZ2V0Tm9kZSkge1xuXHRcdFx0X2NsYXNzQ2FsbENoZWNrKHRoaXMsIExpbmspO1xuXG5cdFx0XHR0aGlzLnNvdXJjZSA9IHNvdXJjZU5vZGU7XG5cdFx0XHR0aGlzLnRhcmdldCA9IHRhcmdldE5vZGU7XG5cdFx0XHR0aGlzLmhhc1BvbGljeSA9IGZhbHNlO1xuXHRcdFx0dGhpcy5wYXRoUG9saWNpZXMgPSBbXTtcblx0XHRcdHRoaXMuZ3JhcGggPSBudWxsO1xuXHRcdFx0dGhpcy5pbml0aWFsaXplZCA9IGZhbHNlO1xuXHRcdH1cblxuXHRcdC8qKlxuICAgKiBDYWxsZWQgd2hlbiBhIGxpbmsgaXMgYWRkZWQgdG8gdGhlIGdyYXBoXG4gICAqXG4gICAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoIGl0IGlzIGFkZGVkIHRvXG4gICAqL1xuXG5cblx0XHRfY3JlYXRlQ2xhc3MoTGluaywgW3tcblx0XHRcdGtleTogJ2luaXRpYWxpemUnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemUoZ3JhcGgpIHtcblx0XHRcdFx0aWYgKHRoaXMuaW5pdGlhbGl6ZWQgPT0gZmFsc2UpIHtcblx0XHRcdFx0XHR0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcblx0XHRcdFx0XHR0aGlzLmdyYXBoID0gZ3JhcGg7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBDYWxsZWQgZHVyaW5nIHRoZSB1cGRhdGUgZ3JhcGggZm9yIGV4aXN0aW5nIGxpbmtzXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuICAgICogQHBhcmFtICAgICAge0xpbmt9ICBcdCAgIGQgICAgICAgTWF0Y2hpbmcgTGluayBPYmplY3QgICAgICAgXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3VwZGF0ZUF0dHInLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUF0dHIoZDNwYXRoLCBkKSB7XG5cdFx0XHRcdGQzcGF0aC5zdHlsZSgnbWFya2VyLWVuZCcsICd1cmwoI2VuZC1hcnJvdyknKS5hdHRyKFwiZFwiLCBhcnJvd1BhdGgpO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIENhbGxlZCBkdXJpbmcgdGhlIGZpcnN0IHVwZGF0ZSBncmFwaCBmb3IgYSBsaW5rXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuICAgICogQHBhcmFtICAgICAge0xpbmt9ICBcdCAgIGQgICAgICAgTWF0Y2hpbmcgTGluayBPYmplY3QgICAgICAgXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ25ld1BhdGhBdHRyJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBuZXdQYXRoQXR0cihkM3BhdGgsIGQpIHtcblx0XHRcdFx0ZDNwYXRoLmF0dHIoJ2QnLCBhcnJvd1BhdGgpO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIENhbGN1bGF0ZXMgdGhlIGFycm93IHBhdGhcbiAgICAqXG4gICAgKiBAcmV0dXJuICAgICB7c3RyaW5nfSAgVGhlIHBhdGggdG8gZHJhd1xuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdhcnJvd1BhdGgnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGFycm93UGF0aCgpIHtcblx0XHRcdFx0dmFyIGQgPSB0aGlzO1xuXHRcdFx0XHR2YXIgZHggPSBkLnRhcmdldC54IC0gZC5zb3VyY2UueCxcblx0XHRcdFx0ICAgIGR5ID0gZC50YXJnZXQueSAtIGQuc291cmNlLnksXG5cdFx0XHRcdCAgICBkciA9IE1hdGguc3FydChkeCAqIGR4ICsgZHkgKiBkeSk7XG5cdFx0XHRcdHJldHVybiBcIk1cIiArIGQuc291cmNlLnggKyBcIixcIiArIGQuc291cmNlLnkgKyBcIkFcIiArIGRyICsgXCIsXCIgKyBkciArIFwiIDAgMCwxIFwiICsgZC50YXJnZXQueCArIFwiLFwiICsgZC50YXJnZXQueTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBVc2VkIHRvIGluc3RhbGwgcG9saWNpZXMgdGhhdCBhcmUgY2FsbGVkIHdoZW4gdGhpc1xuICAgICogbGluayBoYXMgYSBtb3VzZSBldmVudFxuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3kgIFRoZSBwb2xpY3kgdG8gaW5zdGFsbFxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdpbnN0YWxsUGF0aFBvbGljeScsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gaW5zdGFsbFBhdGhQb2xpY3kocG9saWN5KSB7XG5cdFx0XHRcdHRoaXMuaGFzUG9saWN5ID0gdHJ1ZTtcblx0XHRcdFx0dGhpcy5wYXRoUG9saWNpZXMucHVzaChwb2xpY3kpO1xuXHRcdFx0XHRwb2xpY3kuaW5pdGlhbGl6ZSh0aGlzLmdyYXBoKTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBVc2VkIHRvIHVuaW5zdGFsbCBwb2xpY3kgZm9yIHRoaXMgbGlua1xuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3lSZW1vdmUgIFRoZSBwb2xpY3kgdG8gcmVtb3ZlXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3VuaW5zdGFsbFBhdGhQb2xpY3knLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHVuaW5zdGFsbFBhdGhQb2xpY3kocG9saWN5UmVtb3ZlKSB7XG5cdFx0XHRcdHZhciBwb2xpY3lSZW1vdmVOYW1lO1xuXHRcdFx0XHR2YXIgdGhpc1BhdGggPSB0aGlzO1xuXHRcdFx0XHRpZiAodHlwZW9mIHBvbGljeVJlbW92ZSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHRwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmUucG9saWN5TmFtZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRfKHRoaXNQYXRoLnBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5LCBpbmRleCkge1xuXHRcdFx0XHRcdGlmIChwb2xpY3kucG9saWN5TmFtZSA9PT0gcG9saWN5UmVtb3ZlTmFtZSkge1xuXHRcdFx0XHRcdFx0cG9saWN5LmRlc3Ryb3koKTtcblx0XHRcdFx0XHRcdHRoaXNQYXRoLnBhdGhQb2xpY2llcy5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHRcdGlmICh0aGlzUGF0aC5wYXRoUG9saWNpZXMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdFx0dGhpc1BhdGguaGFzUG9saWN5ID0gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBDYWxsZWQgd2hlbiB0aGVyZSBpcyBhIG1vdXNlIGV2ZW50IGZvciB0aGlzIHBhdGhcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgZXZlbnQgICAgIFRoZSBtb3VzZSBldmVudFxuICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGQgICAgICAgICBUaGUgbWF0Y2hpbmcgbGluayBvYmplY3RcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAncGF0aFBvbGljeUV2ZW50Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBwYXRoUG9saWN5RXZlbnQoZXZlbnQsIGQzcGF0aCwgZCkge1xuXHRcdFx0XHRfKGQucGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3kpIHtcblx0XHRcdFx0XHRwb2xpY3lbZXZlbnRdKGQzcGF0aCwgZCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1dKTtcblxuXHRcdHJldHVybiBMaW5rO1xuXHR9KCk7XG5cblx0cmV0dXJuIHtcblx0XHRMaW5rOiBMaW5rXG5cdH07XG59XSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubWVudScsIFtdKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcG9saWNpZXMnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcycsIHtcbiAgICAgICAgICAgIHVybDogJy9uZXR3b3JrcG9saWNpZXMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5pc29sYXRpb24nLCB7XG4gICAgICAgICAgICB1cmw6ICcvaXNvbGF0aW9uJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8dWktdmlldy8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuaXNvbGF0aW9uLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnaXNvbGF0aW9ucG9saWN5Y3JlYXRlJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuaXNvbGF0aW9uLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2lzb2xhdGlvbnBvbGljeWRldGFpbHMnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5pc29sYXRpb24uZWRpdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9lZGl0LzprZXknLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnaXNvbGF0aW9ucG9saWN5ZGV0YWlscydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmJhbmR3aWR0aCcsIHtcbiAgICAgICAgICAgIHVybDogJy9iYW5kd2lkdGgnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzx1aS12aWV3Lz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGguY3JlYXRlJywge1xuICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdiYW5kd2lkdGhwb2xpY3ljcmVhdGUnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGguZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnYmFuZHdpZHRocG9saWN5ZGV0YWlscydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmJhbmR3aWR0aC5lZGl0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2VkaXQvOmtleScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdiYW5kd2lkdGhwb2xpY3lkZXRhaWxzJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMucmVkaXJlY3Rpb24nLCB7XG4gICAgICAgICAgICB1cmw6ICcvcmVkaXJlY3Rpb24nLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzx1aS12aWV3Lz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5saXN0Lmlzb2xhdGlvbicsIHtcbiAgICAgICAgICAgIHVybDogJy9pc29sYXRpb24nLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnaXNvbGF0aW9ucG9saWN5bGlzdCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmxpc3QuYmFuZHdpZHRoJywge1xuICAgICAgICAgICAgdXJsOiAnL2JhbmR3aWR0aCcsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdiYW5kd2lkdGhwb2xpY3lsaXN0J1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KG9iamVjdCwgcHJvcGVydHksIHJlY2VpdmVyKSB7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyByZXR1cm4gZ2V0KHBhcmVudCwgcHJvcGVydHksIHJlY2VpdmVyKTsgfSB9IGVsc2UgaWYgKFwidmFsdWVcIiBpbiBkZXNjKSB7IHJldHVybiBkZXNjLnZhbHVlOyB9IGVsc2UgeyB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7IGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7IH0gfTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG4vKipcbiAqIFRoZSBsaW5rIHRoYXQgaXMgdXNlZCBzcGVjaWZpY2FsbHkgZm9yIHRoZSB2aXN1YWxpemF0aW9uIHRhYi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ1Zpc3VhbGl6ZXJMaW5rJywgWydMaW5rJywgZnVuY3Rpb24gKExpbmspIHtcblx0dmFyIFZpc3VhbGl6ZXJMaW5rID0gZnVuY3Rpb24gKF9MaW5rJExpbmspIHtcblx0XHRfaW5oZXJpdHMoVmlzdWFsaXplckxpbmssIF9MaW5rJExpbmspO1xuXG5cdFx0LyoqXG4gICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICpcbiAgICogQHBhcmFtICAgICAge05vZGV9ICBzb3VyY2VOb2RlICBUaGUgc291cmNlIG5vZGVcbiAgICogQHBhcmFtICAgICAge05vZGV9ICB0YXJnZXROb2RlICBUaGUgdGFyZ2V0IG5vZGVcbiAgICogQHBhcmFtICAgICAge251bWJlcn0gIHdlaWdodCAgICBUaGUgd2VpZ2h0IG9mIHRoZSBsaW5rXG4gICAqL1xuXHRcdGZ1bmN0aW9uIFZpc3VhbGl6ZXJMaW5rKHNvdXJjZU5vZGUsIHRhcmdldE5vZGUsIHdlaWdodCkge1xuXHRcdFx0X2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZpc3VhbGl6ZXJMaW5rKTtcblxuXHRcdFx0dmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKFZpc3VhbGl6ZXJMaW5rLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoVmlzdWFsaXplckxpbmspKS5jYWxsKHRoaXMsIHNvdXJjZU5vZGUsIHRhcmdldE5vZGUpKTtcblxuXHRcdFx0X3RoaXMud2VpZ2h0ID0gd2VpZ2h0O1xuXHRcdFx0Ly9Db3VudCBpcyB1c2VkIHRvIGtlZXAgdHJhY2sgb2YgaG93IG1hbnlcblx0XHRcdC8vcGF0aHMgdG8gaXRzIHN1Ym5vZGVzIHRoZXJlIGFyZVxuXHRcdFx0Ly9pbiBvcmRlciB0byBjYWxjdWxhdGUgYXZlcmFnZSB0cmFmZmljXG5cdFx0XHRfdGhpcy5jb3VudCA9IDE7XG5cdFx0XHRyZXR1cm4gX3RoaXM7XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqIEluY3JlYXNlcyB0aGUgY291bnQgb2YgdGhlIGxpbmtcbiAgICogVVNlZCB0byBrZWVwIHRyYWNrIG9mIGhvdyBtYW55IHBhdGhzIHRvIGl0cyBzdWJub2Rlc1xuICAgKiB0aGVyZSBhcmUgaW4gb3JkZXIgdG8gY2FsY3VsYXRlIGF2ZXJhZ2UgdHJhZmZpY1xuICAgKi9cblxuXG5cdFx0X2NyZWF0ZUNsYXNzKFZpc3VhbGl6ZXJMaW5rLCBbe1xuXHRcdFx0a2V5OiAnaW5jcmVhc2VDb3VudCcsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gaW5jcmVhc2VDb3VudCgpIHtcblx0XHRcdFx0dGhpcy5jb3VudCArPSAxO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIENhbGN1bGF0ZXMgd2hlcmUgdG8gcGxhY2UgcXRpcCBmb3JcbiAgICAqXG4gICAgKiBAcmV0dXJuICAgICB7T2JqZWN0fSAgT2JqZWN0IHdpdGggcVRpcCBzZXR0aW5nc1xuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdxdGlwSGVscGVyJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBxdGlwSGVscGVyKCkge1xuXHRcdFx0XHR2YXIgcmV0O1xuXHRcdFx0XHR2YXIgZCA9IHRoaXM7XG5cdFx0XHRcdHZhciBkeCA9IChkLnRhcmdldC54IC0gZC5zb3VyY2UueCkgLyAyLFxuXHRcdFx0XHQgICAgZHkgPSAoZC50YXJnZXQueSAtIGQuc291cmNlLnkpIC8gMjtcblx0XHRcdFx0aWYgKGQuc291cmNlLnggPCBkLnRhcmdldC54KSB7XG5cdFx0XHRcdFx0cmV0ID0ge1xuXHRcdFx0XHRcdFx0bXk6ICd0b3AgY2VudGVyJyxcblx0XHRcdFx0XHRcdGF0OiAnY2VudGVyIGNlbnRlcicsIC8vIGF0IHRoZSBib3R0b20gcmlnaHQgb2YuLi5cblx0XHRcdFx0XHRcdHRhcmdldDogW2R4LCBkeV0sXG5cdFx0XHRcdFx0XHRhZGp1c3Q6IHtcblx0XHRcdFx0XHRcdFx0eTogMTBcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHJldCA9IHtcblx0XHRcdFx0XHRcdG15OiAnYm90dG9tIGNlbnRlcicsXG5cdFx0XHRcdFx0XHRhdDogJ2NlbnRlciBjZW50ZXInLCAvLyBhdCB0aGUgYm90dG9tIHJpZ2h0IG9mLi4uXG5cdFx0XHRcdFx0XHR0YXJnZXQ6IFtkeCwgZHldLFxuXHRcdFx0XHRcdFx0YWRqdXN0OiB7XG5cdFx0XHRcdFx0XHRcdHk6IC0xMFxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHJldDtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAqIENhbGxlZCB3aGVuIGEgbGluayBpcyBhZGRlZCB0byB0aGUgZ3JhcGhcbiAgICpcbiAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgYWRkZWQgdG9cbiAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdpbml0aWFsaXplJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBpbml0aWFsaXplKGdyYXBoKSB7XG5cdFx0XHRcdGlmICh0aGlzLmluaXRpYWxpemVkID09IGZhbHNlKSB7XG5cdFx0XHRcdFx0X2dldChWaXN1YWxpemVyTGluay5wcm90b3R5cGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihWaXN1YWxpemVyTGluay5wcm90b3R5cGUpLCAnaW5pdGlhbGl6ZScsIHRoaXMpLmNhbGwodGhpcywgZ3JhcGgpO1xuXHRcdFx0XHRcdHZhciBzdGF0ZSA9IGdyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXHRcdFx0XHRcdGlmIChzdGF0ZSA9PSBudWxsKSB7XG5cdFx0XHRcdFx0XHRzdGF0ZSA9IGdyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rID0ge307XG5cdFx0XHRcdFx0XHRzdGF0ZS5tYXhXZWlnaHQgPSBudWxsO1xuXHRcdFx0XHRcdFx0c3RhdGUudXNlQXZnV2VpZ2h0ID0gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0dGhpcy51cGRhdGVNYXhXZWlnaHQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIFNldHMgd2hldGhlciB0aGUgZ3JhcGggc2hvdWxkIHVzZSBhdmcgd2VpZ2h0XG4gICAgKlxuICAgICogQHBhcmFtICAgICAge2Jvb2xlYW59ICB2YWwgICAgIFRoZSB2YWx1ZSB0byBzZXQgdG9cbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnc2V0VXNlQXZnV2VpZ2h0Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBzZXRVc2VBdmdXZWlnaHQodmFsKSB7XG5cdFx0XHRcdHRoaXMuZ3JhcGguc3RhdGUuVmlzdWFsaXplckxpbmsudXNlQXZnV2VpZ2h0ID0gISF2YWw7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogU2V0cyB0aGUgd2VpZ2h0IG9mIHRoaXMgbGlua1xuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB3ZWlnaHQgIFRoZSB3ZWlnaHQgdG8gc2V0IHRvXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3NldFdlaWdodCcsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gc2V0V2VpZ2h0KHdlaWdodCkge1xuXHRcdFx0XHR0aGlzLndlaWdodCA9IHdlaWdodDtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBHZXRzIHRoZSByYXcgd2VpZ2h0LlxuICAgICpcbiAgICAqIEByZXR1cm4gICAgIHtudW1iZXJ9ICBUaGUgcmF3IHdlaWdodC5cbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnZ2V0UmF3V2VpZ2h0Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBnZXRSYXdXZWlnaHQoKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLndlaWdodDtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBHZXRzIHRoZSB3ZWlnaHQgdmFsdWUgb2YgdGhlIGxpbmssIGRlcGVuZGluZyBvbiB0aGVcbiAgICAqIHVzZUF2Z1dlaWd0aCBzZXR0aW5nXG4gICAgKlxuICAgICogQHJldHVybiAgICAge251bWJlcn0gIFRoZSB3ZWlnaHQuXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ2dldFdlaWdodCcsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gZ2V0V2VpZ2h0KCkge1xuXHRcdFx0XHR2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcblx0XHRcdFx0ICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXG5cdFx0XHRcdGlmIChzdGF0ZS51c2VBdmdXZWlnaHQpIHtcblx0XHRcdFx0XHR2YXIgd2VpZ2h0ID0gdGhpcy53ZWlnaHQgLyB0aGlzLmNvdW50O1xuXHRcdFx0XHRcdHJldHVybiB3ZWlnaHQ7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHRoaXMud2VpZ2h0O1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIFVwZGF0ZXMgdGhlIG1heCB3ZWlnaHQgb2YgdGhlIGdyYXBoXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3VwZGF0ZU1heFdlaWdodCcsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gdXBkYXRlTWF4V2VpZ2h0KCkge1xuXHRcdFx0XHR2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcblx0XHRcdFx0ICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXG5cdFx0XHRcdHZhciBtYXhMaW5rID0gXy5tYXhCeSh0aGlzR3JhcGgubGlua3MsIGZ1bmN0aW9uIChsKSB7XG5cdFx0XHRcdFx0aWYgKGwuZ3JhcGggIT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIGwuZ2V0V2VpZ2h0KCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiAwO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0c3RhdGUubWF4V2VpZ2h0ID0gbWF4TGluay5nZXRXZWlnaHQoKTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBDYWxsZWQgZHVyaW5nIHRoZSB1cGRhdGUgZ3JhcGggZm9yIGV4aXN0aW5nIGxpbmtzXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuICAgICogQHBhcmFtICAgICAge0xpbmt9ICBcdCAgIGQgICAgICAgTWF0Y2hpbmcgTGluayBPYmplY3QgICAgICAgXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3VwZGF0ZUF0dHInLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUF0dHIoZDNwYXRoLCBkKSB7XG5cdFx0XHRcdHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuXHRcdFx0XHQgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuVmlzdWFsaXplckxpbms7XG5cdFx0XHRcdHRoaXMudXBkYXRlTWF4V2VpZ2h0KCk7XG5cdFx0XHRcdHZhciBjb2xvclNjYWxlID0gZDMuc2NhbGUubGluZWFyKCkuZG9tYWluKFswLCBzdGF0ZS5tYXhXZWlnaHRdKS5yYW5nZShbXCIjZmZiMzY2XCIsIFwiI0Y5MjYwNlwiXSk7XG5cdFx0XHRcdHN0YXRlLmNvbG9yU2NhbGUgPSBjb2xvclNjYWxlO1xuXHRcdFx0XHRkM3BhdGguc3R5bGUoJ21hcmtlci1lbmQnLCAndXJsKCNlbmQtYXJyb3cpJykuY2xhc3NlZCh0aGlzR3JhcGguY29uc3RzLnNlbGVjdGVkQ2xhc3MsIGZ1bmN0aW9uIChkKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGQgPT09IHN0YXRlLnNlbGVjdGVkRWRnZTtcblx0XHRcdFx0fSkuYXR0cihcImRcIiwgdGhpcy5hcnJvd1BhdGguY2FsbChkKSkudHJhbnNpdGlvbihcImV4aXN0aW5nUGF0aFRyYW5zaXRpb25cIikuZHVyYXRpb24oNzUwKS5hdHRyKFwic3Ryb2tlXCIsIGZ1bmN0aW9uIChkKSB7XG5cdFx0XHRcdFx0dmFyIGMgPSBjb2xvclNjYWxlKGQuZ2V0V2VpZ2h0KCkpO1xuXHRcdFx0XHRcdHJldHVybiBjO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBDYWxsZWQgZHVyaW5nIHRoZSBmaXJzdCB1cGRhdGUgZ3JhcGggZm9yIHRoaXMgbGlua1xuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzcGF0aCAgVGhlIGQzIHBhdGhcbiAgICAqIEBwYXJhbSAgICAgIHtMaW5rfSAgXHQgICBkICAgICAgIE1hdGNoaW5nIExpbmsgT2JqZWN0XG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ25ld1BhdGhBdHRyJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBuZXdQYXRoQXR0cihkM3BhdGgsIGQpIHtcblx0XHRcdFx0dmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG5cdFx0XHRcdCAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluaztcblx0XHRcdFx0dGhpcy51cGRhdGVNYXhXZWlnaHQoKTtcblx0XHRcdFx0dmFyIGNvbG9yU2NhbGUgPSBkMy5zY2FsZS5saW5lYXIoKS5kb21haW4oWzAsIHN0YXRlLm1heFdlaWdodF0pLnJhbmdlKFtcIiNmZmIzNjZcIiwgXCIjRjkyNjA2XCJdKTtcblxuXHRcdFx0XHRkM3BhdGgudHJhbnNpdGlvbihcIm5ld1BhdGhUcmFuc2l0aW9uXCIpLmR1cmF0aW9uKDc1MCkuYXR0clR3ZWVuKFwib3BhY2l0eVwiLCBmdW5jdGlvbiAoZCkge1xuXHRcdFx0XHRcdHJldHVybiBkMy5pbnRlcnBvbGF0ZVN0cmluZygwLCAxKTtcblx0XHRcdFx0fSkuYXR0cihcInN0cm9rZVwiLCBmdW5jdGlvbiAoZCkge1xuXHRcdFx0XHRcdHZhciBjID0gY29sb3JTY2FsZShkLmdldFdlaWdodCgpKTtcblx0XHRcdFx0XHRyZXR1cm4gYztcblx0XHRcdFx0fSkuYXR0cignZCcsIHRoaXMuYXJyb3dQYXRoLmNhbGwoZCkpO1xuXHRcdFx0fVxuXHRcdH1dKTtcblxuXHRcdHJldHVybiBWaXN1YWxpemVyTGluaztcblx0fShMaW5rLkxpbmspO1xuXG5cdHJldHVybiB7XG5cdFx0TGluazogVmlzdWFsaXplckxpbmtcblx0fTtcbn1dKTtcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtzJywge1xuICAgICAgICAgICAgdXJsOiAnL25ldHdvcmtzJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3Jrcy5saXN0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnbmV0d29ya0xpc3QnXG4gICAgICAgIH0pLlxuICAgICAgICAgICAgc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ25ldHdvcmtkZXRhaWxzJ1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbi8qKlxuICogVGhlIGJhc2UgY2xhc3MgZm9yIG5vZGUgb2JqZWN0cyBmb3IgdGhlIGdyYXBoLlxuICogU3VwcG9ydHMgcG9saWNpZXMuXG4gKiBcbiAqIFRvIHdyaXRlIHlvdXIgb3duIE5vZGUgb2JqZWN0LCBjcmVhdGUgYSBuZXcgZmFjdG9yeSB0aGF0IHVzZXMgdGhlIG5vZGVcbiAqIHlvdSB3YW50IHRvIGluaGVyaXQgYXMgYSBkZXBlbmRlbmN5LCBhbmQgZXh0ZW5kIGl0cyBub2RlIGNsYXNzLiBcbiAqIFJldHVybiB0aGUgY2xhc3Mgb2JqZWN0IHdpdGggTm9kZSBhcyBrZXlcbiAqIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnTm9kZScsIFtmdW5jdGlvbiAoKSB7XG5cdHZhciBOb2RlID0gZnVuY3Rpb24gKCkge1xuXHRcdC8qKlxuICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAqXG4gICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB4ICAgICAgIHggbG9jYXRpb25cbiAgICogQHBhcmFtICAgICAge251bWJlcn0gIHkgICAgICAgeSBsb2NhdGlvblxuICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgaWQgICAgICBUaGUgaWRlbnRpZmllclxuICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgdGV4dCAgICBUaGUgdGV4dCB0byBkaXNwbGF5XG4gICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICByYWRpdXMgIFRoZSByYWRpdXMgb2YgdGhlIG5vZGVcbiAgICovXG5cdFx0ZnVuY3Rpb24gTm9kZSh4LCB5LCBpZCwgdGV4dCwgcmFkaXVzKSB7XG5cdFx0XHRfY2xhc3NDYWxsQ2hlY2sodGhpcywgTm9kZSk7XG5cblx0XHRcdHRoaXMueCA9IHg7XG5cdFx0XHR0aGlzLnkgPSB5O1xuXHRcdFx0dGhpcy5yYWRpdXMgPSByYWRpdXM7XG5cdFx0XHR0aGlzLmlkID0gaWQ7XG5cdFx0XHR0aGlzLnRleHQgPSB0ZXh0O1xuXHRcdFx0dGhpcy5yYWRpdXMgPSByYWRpdXM7XG5cdFx0XHR0aGlzLmhhc1BvbGljeSA9IGZhbHNlO1xuXHRcdFx0dGhpcy5wb2xpY3kgPSBudWxsO1xuXHRcdFx0dGhpcy5ub2RlUG9saWNpZXMgPSBbXTtcblx0XHRcdHRoaXMuZ3JhcGggPSBudWxsO1xuXHRcdFx0dGhpcy5pbml0aWFsaXplZCA9IGZhbHNlO1xuXHRcdH1cblxuXHRcdC8qKlxuICAgKiBDYWxsZWQgd2hlbiBhIG5vZGUgaXMgYWRkZWQgdG8gdGhlIGdyYXBoXG4gICAqXG4gICAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoIGl0IGlzIGFkZGVkIHRvXG4gICAqL1xuXG5cblx0XHRfY3JlYXRlQ2xhc3MoTm9kZSwgW3tcblx0XHRcdGtleTogJ2luaXRpYWxpemUnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemUoZ3JhcGgpIHtcblx0XHRcdFx0aWYgKHRoaXMuaW5pdGlhbGl6ZWQgPT0gZmFsc2UpIHtcblx0XHRcdFx0XHR0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcblx0XHRcdFx0XHR0aGlzLmdyYXBoID0gZ3JhcGg7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBDYWxsZWQgZHVyaW5nIHRoZSB1cGRhdGUgZ3JhcGggZm9yIGV4aXN0aW5nIGxpbmtzXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICd1cGRhdGVBdHRyJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVBdHRyKGQzbm9kZSwgZCkge1xuXHRcdFx0XHRkM25vZGUuYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbiAoZCkge1xuXHRcdFx0XHRcdHJldHVybiBcInRyYW5zbGF0ZShcIiArIGQueCArIFwiLFwiICsgZC55ICsgXCIpXCI7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIENhbGxlZCBkdXJpbmcgdGhlIGZpcnN0IHVwZGF0ZSBncmFwaCBmb3IgYSBub2RlXG4gICAgKiBIb29rIGZvciBzdWIgY2xhc3Nlc1xuICAgICogXG4gICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gICAgICBkICAgICAgIE1hdGNoaW5nIE5vZGUgT2JqZWN0XG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ25ld05vZGVBdHRyJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBuZXdOb2RlQXR0cihkM25vZGUsIGQpIHt9XG5cblx0XHRcdC8qKlxuICAgICogU2V0cyB0aGUgcmFkaXVzIG9mIHRoZSBub2RlLlxuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICByYWRpdXMgIFRoZSByYWRpdXNcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnc2V0UmFkaXVzJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBzZXRSYWRpdXMocmFkaXVzKSB7XG5cdFx0XHRcdHRoaXMucmFkaXVzID0gcmFkaXVzO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIFVzZWQgdG8gaW5zdGFsbCBwb2xpY2llcyB0aGF0IGFyZSBjYWxsZWQgd2hlbiB0aGlzXG4gICAgKiBub2RlIGhhcyBhIG1vdXNlIGV2ZW50XG4gICAgKlxuICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeSAgVGhlIHBvbGljeSB0byBpbnN0YWxsXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ2luc3RhbGxOb2RlUG9saWN5Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBpbnN0YWxsTm9kZVBvbGljeShwb2xpY3kpIHtcblx0XHRcdFx0dGhpcy5oYXNQb2xpY3kgPSB0cnVlO1xuXHRcdFx0XHR0aGlzLm5vZGVQb2xpY2llcy5wdXNoKHBvbGljeSk7XG5cdFx0XHRcdHBvbGljeS5pbml0aWFsaXplKHRoaXMuZ3JhcGgpO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIFVzZWQgdG8gdW5pbnN0YWxsIHBvbGljeSBmb3IgdGhpcyBub2RlXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge1BvbGljeXxzdHJpbmd9ICBwb2xpY3lSZW1vdmUgIFRoZSBwb2xpY3kgdG8gcmVtb3ZlXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3VuaW5zdGFsbE5vZGVQb2xpY3knLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHVuaW5zdGFsbE5vZGVQb2xpY3kocG9saWN5UmVtb3ZlKSB7XG5cdFx0XHRcdHZhciBwb2xpY3lSZW1vdmVOYW1lO1xuXHRcdFx0XHR2YXIgdGhpc05vZGUgPSB0aGlzO1xuXHRcdFx0XHRpZiAodHlwZW9mIHBvbGljeVJlbW92ZSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHRwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmUucG9saWN5TmFtZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRfKHRoaXNOb2RlLm5vZGVQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5LCBpbmRleCkge1xuXHRcdFx0XHRcdGlmIChwb2xpY3kucG9saWN5TmFtZSA9PT0gcG9saWN5UmVtb3ZlTmFtZSkge1xuXHRcdFx0XHRcdFx0cG9saWN5LmRlc3Ryb3koKTtcblx0XHRcdFx0XHRcdHRoaXNOb2RlLm5vZGVQb2xpY2llcy5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHRcdGlmICh0aGlzTm9kZS5ub2RlUG9saWNpZXMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdFx0dGhpc05vZGUuaGFzUG9saWN5ID0gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBDYWxsZWQgd2hlbiB0aGVyZSBpcyBhIG1vdXNlIGV2ZW50IGZvciB0aGlzIG5vZGVcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgZXZlbnQgICAgIFRoZSBtb3VzZSBldmVudFxuICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGQgICAgICAgICBUaGUgbWF0Y2hpbmcgbm9kZSBvYmplY3RcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnbm9kZVBvbGljeUV2ZW50Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBub2RlUG9saWN5RXZlbnQoZXZlbnQsIGQzbm9kZSwgZCkge1xuXHRcdFx0XHRfLmZvckVhY2godGhpcy5ub2RlUG9saWNpZXMsIGZ1bmN0aW9uIChwb2xpY3kpIHtcblx0XHRcdFx0XHRwb2xpY3lbZXZlbnRdKGQzbm9kZSwgZCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1dKTtcblxuXHRcdHJldHVybiBOb2RlO1xuXHR9KCk7XG5cblx0cmV0dXJuIHtcblx0XHROb2RlOiBOb2RlXG5cdH07XG59XSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzJywge1xuICAgICAgICAgICAgdXJsOiAnL25vZGVzJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuLyoqXG4gKiBUaGUgbm9kZSB0aGF0IGlzIHVzZWQgc3BlY2lmaWNhbGx5IGZvciB0aGUgdmlzdWFsaXphdGlvbiB0YWIuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdWaXN1YWxpemVyTm9kZScsIFsnTm9kZScsIGZ1bmN0aW9uIChOb2RlKSB7XG5cdHZhciBWaXN1YWxpemVyTm9kZSA9IGZ1bmN0aW9uIChfTm9kZSROb2RlKSB7XG5cdFx0X2luaGVyaXRzKFZpc3VhbGl6ZXJOb2RlLCBfTm9kZSROb2RlKTtcblxuXHRcdC8qKlxuICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAqXG4gICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB4ICAgICAgIFx0eCBsb2NhdGlvblxuICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeSAgICAgICBcdHkgbG9jYXRpb25cbiAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGlkICAgICAgXHRUaGUgaWRlbnRpZmllclxuICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgdGV4dCAgICBcdFRoZSB0ZXh0IHRvIGRpc3BsYXlcbiAgICogQHBhcmFtICAgICAge251bWJlcn0gIHJhZGl1cyAgXHRUaGUgcmFkaXVzIG9mIHRoZSBub2RlXG4gICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBwYXJlbnQgICAgIFRoZSBwYXJlbnQgaWRcbiAgICogQHBhcmFtICAgICAge0FycmF5fSAgIGFuY2VzdG9ycyAgQXJyYXkgb2YgYW5jZXN0b3JzIElkXG4gICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB4U3RhcnQgICAgIHggbG9jIHRvIHN0YXJ0IGFuaW1hdGlvblxuICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeVN0YXJ0ICAgICB5IGxvYyB0byBzdGFydCBhbmltYXRpb25cbiAgICovXG5cdFx0ZnVuY3Rpb24gVmlzdWFsaXplck5vZGUoeCwgeSwgaWQsIHRleHQsIHJhZGl1cywgcGFyZW50LCBhbmNlc3RvcnMsIHhTdGFydCwgeVN0YXJ0KSB7XG5cdFx0XHRfY2xhc3NDYWxsQ2hlY2sodGhpcywgVmlzdWFsaXplck5vZGUpO1xuXG5cdFx0XHR2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoVmlzdWFsaXplck5vZGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihWaXN1YWxpemVyTm9kZSkpLmNhbGwodGhpcywgeCwgeSwgaWQsIHRleHQsIHJhZGl1cykpO1xuXG5cdFx0XHRfdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG5cdFx0XHRfdGhpcy5hbmNlc3RvcnMgPSBhbmNlc3RvcnM7XG5cdFx0XHRpZiAoeFN0YXJ0ID09IG51bGwpIHtcblx0XHRcdFx0X3RoaXMueFN0YXJ0ID0geDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdF90aGlzLnhTdGFydCA9IHhTdGFydDtcblx0XHRcdH1cblx0XHRcdGlmICh5U3RhcnQgPT0gbnVsbCkge1xuXHRcdFx0XHRfdGhpcy55U3RhcnQgPSB5O1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0X3RoaXMueVN0YXJ0ID0geVN0YXJ0O1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIF90aGlzO1xuXHRcdH1cblxuXHRcdC8qKlxuICAgKiBDYWxsZWQgZHVyaW5nIHRoZSBmaXJzdCB1cGRhdGUgZ3JhcGggZm9yIGEgbm9kZVxuICAgKlxuICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICBkICAgICAgICAgVGhlIG1hdGNoaW5nIE5vZGVcbiAgICovXG5cblxuXHRcdF9jcmVhdGVDbGFzcyhWaXN1YWxpemVyTm9kZSwgW3tcblx0XHRcdGtleTogJ25ld05vZGVBdHRyJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBuZXdOb2RlQXR0cihkM25vZGUsIGQpIHtcblx0XHRcdFx0dmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG5cdFx0XHRcdGlmICh0aGlzR3JhcGguY29uc3RzLmNvbnRhaW5lckNsYXNzICE9IG51bGwgJiYgdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0W2QuaWRdID09IG51bGwpIHtcblx0XHRcdFx0XHRkM25vZGUuY2xhc3NlZCh0aGlzR3JhcGguY29uc3RzLmNvbnRhaW5lckNsYXNzLCB0cnVlKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRkM25vZGUudHJhbnNpdGlvbihcIm5vZGVQb3NpdGlvblRyYW5zaXRpb25cIikuZHVyYXRpb24oNzUwKS5hdHRyVHdlZW4oXCJ0cmFuc2Zvcm1cIiwgZnVuY3Rpb24gKGQpIHtcblx0XHRcdFx0XHRpZiAoZC54U3RhcnQgIT0gbnVsbCAmJiBkLnlTdGFydCAhPSBudWxsKSB7XG5cdFx0XHRcdFx0XHR2YXIgeFN0YXJ0ID0gZC54U3RhcnQ7XG5cdFx0XHRcdFx0XHR2YXIgeVN0YXJ0ID0gZC55U3RhcnQ7XG5cdFx0XHRcdFx0XHRkLnhTdGFydCA9IGQueDtcblx0XHRcdFx0XHRcdGQueVN0YXJ0ID0gZC55O1xuXHRcdFx0XHRcdFx0cmV0dXJuIGQzLmludGVycG9sYXRlU3RyaW5nKFwidHJhbnNsYXRlKFwiICsgeFN0YXJ0ICsgXCIsXCIgKyB5U3RhcnQgKyBcIilcIiwgXCJ0cmFuc2xhdGUoXCIgKyBkLnggKyBcIixcIiArIGQueSArIFwiKVwiKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIGQzLmludGVycG9sYXRlU3RyaW5nKFwidHJhbnNsYXRlKFwiICsgZC54ICsgXCIsXCIgKyBkLnkgKyBcIilcIiwgXCJ0cmFuc2xhdGUoXCIgKyBkLnggKyBcIixcIiArIGQueSArIFwiKVwiKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fV0pO1xuXG5cdFx0cmV0dXJuIFZpc3VhbGl6ZXJOb2RlO1xuXHR9KE5vZGUuTm9kZSk7XG5cblx0cmV0dXJuIHtcblx0XHROb2RlOiBWaXN1YWxpemVyTm9kZVxuXHR9O1xufV0pO1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5vcmdhbml6YXRpb25zJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucycsIHtcbiAgICAgICAgICAgIHVybDogJy9vcmdhbml6YXRpb25zJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5vcmdhbml6YXRpb25zLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdvcmdhbml6YXRpb25saXN0J1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KG9iamVjdCwgcHJvcGVydHksIHJlY2VpdmVyKSB7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyByZXR1cm4gZ2V0KHBhcmVudCwgcHJvcGVydHksIHJlY2VpdmVyKTsgfSB9IGVsc2UgaWYgKFwidmFsdWVcIiBpbiBkZXNjKSB7IHJldHVybiBkZXNjLnZhbHVlOyB9IGVsc2UgeyB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7IGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7IH0gfTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG4vKipcbiAqIFRoaXMgcG9saWN5IGlzIHVzZWQgdG8gYWRkIGEgc2VsZWN0IG5vZGUgZmVhdHVyZS5cbiAqIFN1cHBvcnRzIHNlbGVjdGluZyBtdWx0aXBsZSBub2RlcyBieSB1c2luZyB0aGUgY3RybCBrZXkuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdOb2RlU2VsZWN0aW9uUG9saWN5JywgWydQb2xpY3knLCBmdW5jdGlvbiAoUG9saWN5KSB7XG4gICAgdmFyIE5vZGVTZWxlY3Rpb25Qb2xpY3kgPSBmdW5jdGlvbiAoX1BvbGljeSRQb2xpY3kpIHtcbiAgICAgICAgX2luaGVyaXRzKE5vZGVTZWxlY3Rpb25Qb2xpY3ksIF9Qb2xpY3kkUG9saWN5KTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gTm9kZVNlbGVjdGlvblBvbGljeSgpIHtcbiAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBOb2RlU2VsZWN0aW9uUG9saWN5KTtcblxuICAgICAgICAgICAgcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChOb2RlU2VsZWN0aW9uUG9saWN5Ll9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTm9kZVNlbGVjdGlvblBvbGljeSkpLmNhbGwodGhpcywgXCJOb2RlU2VsZWN0aW9uUG9saWN5XCIpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYWxsZWQgd2hlbiBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAqIE92ZXJ3cml0ZXMgdGhlIG9uIGRyYWcgZXZlbnQgb2YgdGhlIGdyYXBoXG4gICAgICAgICAqIFxuICAgICAgICAgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaCBpdCBpcyBcbiAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbGxlZCBvblxuICAgICAgICAqL1xuXG5cbiAgICAgICAgX2NyZWF0ZUNsYXNzKE5vZGVTZWxlY3Rpb25Qb2xpY3ksIFt7XG4gICAgICAgICAgICBrZXk6ICdpbml0aWFsaXplJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0aWFsaXplKGdyYXBoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfZ2V0KE5vZGVTZWxlY3Rpb25Qb2xpY3kucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTm9kZVNlbGVjdGlvblBvbGljeS5wcm90b3R5cGUpLCAnaW5pdGlhbGl6ZScsIHRoaXMpLmNhbGwodGhpcywgZ3JhcGgpO1xuICAgICAgICAgICAgICAgIHZhciBzdGF0ZSA9IGdyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zZWxlY3RlZE5vZGVzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIGNvbnN0cyA9IGdyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgY29uc3RzLnNlbGVjdGVkQ2xhc3MgPSBcInNlbGVjdGVkXCI7XG4gICAgICAgICAgICAgICAgLy9vdmVyd3JpdHRpbmcgZ3JhcGgncyBub2RlIG9uIGRyYWcgZXZlbnQgdG8gc3VwcG9ydFxuICAgICAgICAgICAgICAgIC8vbW92aW5nIG11bHRpcGxlIG5vZGVzIGF0IG9uY2VcbiAgICAgICAgICAgICAgICB2YXIgZHJhZyA9IGdyYXBoLmRyYWc7XG4gICAgICAgICAgICAgICAgZHJhZy5vbignZHJhZycsIGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSBncmFwaDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWRDbGFzcyA9IHRoaXNHcmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeS5zZWxlY3RlZENsYXNzO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGVjdGlvbiA9IGQzLnNlbGVjdEFsbCgnLicgKyBzZWxlY3RlZENsYXNzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGlvblswXS5pbmRleE9mKHRoaXMpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uLmNsYXNzZWQoc2VsZWN0ZWRDbGFzcywgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGlvbiA9IGQzLnNlbGVjdCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb24uY2xhc3NlZChzZWxlY3RlZENsYXNzLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZnVuY3Rpb24gKGQsIGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnggKz0gZDMuZXZlbnQuZHg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55ICs9IGQzLmV2ZW50LmR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcInRyYW5zbGF0ZShcIiArIFtkLngsIGQueV0gKyBcIilcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBBZGRzIHRoZSBnaXZlbiBub2RlIHRvIHRoZSBhcnJheSBvZiBzZWxlY3RlZCBub2Rlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzTm9kZSAgICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgbm9kZURhdGEgIE1hdGNoaW5nIE5vZGUgb2JqZWN0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdhZGRTZWxlY3ROb2RlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRTZWxlY3ROb2RlKGQzTm9kZSwgbm9kZURhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgZDNOb2RlLmNsYXNzZWQoY29uc3RzLnNlbGVjdGVkQ2xhc3MsIHRydWUpO1xuICAgICAgICAgICAgICAgIHN0YXRlLnNlbGVjdGVkTm9kZXMucHVzaChub2RlRGF0YSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyB0aGUgZ2l2ZW4gbm9kZSBmcm9tIHRoZSBhcnJheSBvZiBzZWxlY3RlZCBub2Rlcy5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM05vZGUgICAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgIG5vZGVEYXRhICBNYXRjaGluZyBub2RlIG9iamVjdCBcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3JlbW92ZVNlbGVjdEZyb21Ob2RlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVTZWxlY3RGcm9tTm9kZShkM05vZGUsIG5vZGVEYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmZpbHRlcihmdW5jdGlvbiAoY2QpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNkLmlkID09PSBub2RlRGF0YS5pZDtcbiAgICAgICAgICAgICAgICB9KS5jbGFzc2VkKGNvbnN0cy5zZWxlY3RlZENsYXNzLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gc3RhdGUuc2VsZWN0ZWROb2Rlcy5pbmRleE9mKG5vZGVEYXRhKTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zZWxlY3RlZE5vZGVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyBhbGwgc2VsZWN0ZWQgbm9kZXMuXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdyZW1vdmVBbGxTZWxlY3RlZE5vZGVzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVBbGxTZWxlY3RlZE5vZGVzKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzLk5vZGVTZWxlY3Rpb25Qb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5jbGFzc2VkKGNvbnN0cy5zZWxlY3RlZENsYXNzLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgc3RhdGUuc2VsZWN0ZWROb2RlcyA9IFtdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIE9uIE1vdXNlZG93biwgZGV0ZXJtaW5lcyB3aGV0aGVyIHRvIGNoYW5nZSB0aGVcbiAgICAgICAgICAgICAqIHNlbGVjdGVkIHN0YXR1cyBvZiB0aGUgY2xpY2tlZCBub2RlLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgIGQgICAgICAgTWF0Y2hpbmcgTm9kZSBPYmplY3QgICAgICAgXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdtb3VzZWRvd24nLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdXNlZG93bihkM25vZGUsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeTtcbiAgICAgICAgICAgICAgICBkMy5ldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICBpZiAoZDMuZXZlbnQuY3RybEtleSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuc2VsZWN0ZWROb2Rlcy5pbmRleE9mKGQpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlU2VsZWN0RnJvbU5vZGUoZDNub2RlLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkU2VsZWN0Tm9kZShkM25vZGUsIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdGF0ZS5zZWxlY3RlZE5vZGVzLmluZGV4T2YoZCkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9pZiBubyBjb250cm9sIGtleSwgYW5kIGNsaWNrZWQgbm90IHNlbGVjdGVkIG5vZGUsXG4gICAgICAgICAgICAgICAgICAgIC8vcmVtb3ZlIGFsbCBvZiBjdXJyZW50IHNlbGVjdGlvblxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUFsbFNlbGVjdGVkTm9kZXMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogT24gTW91c2V1cCwgZGV0ZXJtaW5lcyB3aGV0aGVyIHRvIGNoYW5nZSB0aGVcbiAgICAgICAgICAgICAqIHNlbGVjdGVkIHN0YXR1cyBvZiB0aGUgY2xpY2tlZCBub2RlLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgIGQgICAgICAgTWF0Y2hpbmcgTm9kZSBPYmplY3RcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ21vdXNldXAnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdXNldXAoZDNub2RlLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3k7XG4gICAgICAgICAgICAgICAgaWYgKCFkMy5ldmVudC5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgbGVuZ3RoIGlzIGdyZWF0ZXIgdGhhbiAxLCB0aGVuIHdlIGFyZSBtb3ZpbmcgbXVsdGlwbGUgbm9kZXNcbiAgICAgICAgICAgICAgICAgICAgLy9sZWF2ZSB0aGVtIGFsbCBoaWdobGlnaHRlZFxuICAgICAgICAgICAgICAgICAgICAvL290aGVyd2lzZSB3ZSBhcmUganVzdCBtb3Zpbmcgb25lIG5vZGUsIHNvIHVuaGlnaGxpZ2h0XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5zZWxlY3RlZE5vZGVzLmxlbmd0aCA8PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVNlbGVjdEZyb21Ob2RlKGQzbm9kZSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1dKTtcblxuICAgICAgICByZXR1cm4gTm9kZVNlbGVjdGlvblBvbGljeTtcbiAgICB9KFBvbGljeS5Qb2xpY3kpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgUG9saWN5OiBOb2RlU2VsZWN0aW9uUG9saWN5XG4gICAgfTtcbn1dKTtcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zZXJ2aWNlbGJzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzJywge1xuICAgICAgICAgICAgdXJsOiAnL3NlcnZpY2VsYnMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ3NlcnZpY2VsYkxpc3QnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMuZGV0YWlscy5zdGF0cycsIHtcbiAgICAgICAgICAgIHVybDogJy9zdGF0cycsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdzZXJ2aWNlbGJzdGF0J1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnNldHRpbmdzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncycsIHtcbiAgICAgICAgICAgIHVybDogJy9nbG9iYWwnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvc2V0dGluZ3MnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXR0aW5ncy9zZXR0aW5nc21lbnUuaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5sb2dzJywge1xuICAgICAgICAgICAgdXJsOiAnL2xvZ3MnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJycsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5hdXRoJywge1xuICAgICAgICAgICAgdXJsOiAnL2F1dGgnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJycsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5saWNlbnNlJywge1xuICAgICAgICAgICAgdXJsOiAnL2xpY2Vuc2UnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJycsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5wb2xpY2llcycsIHtcbiAgICAgICAgICAgIHVybDogJy9wb2xpY2llcycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLm5ldHdvcmtzJywge1xuICAgICAgICAgICAgdXJsOiAnL25ldHdvcmtzJyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ25ldHdvcmtzZXR0aW5nJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLnZvbHVtZXMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvdm9sdW1lcycsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICd2b2x1bWVzZXR0aW5nJ1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuLyoqXG4gKiBUaGlzIHBvbGljeSBjaGFuZ2VzIHRoZSB2aWV3IHRvIHRoZSB0aW1lZ3JhcGggb2YgbGluayBkYXRhIG9uIGNsaWNrLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnUGF0aENoYW5nZVZpZXdQb2xpY3knLCBbJ1BvbGljeScsIGZ1bmN0aW9uIChQb2xpY3kpIHtcbiAgICB2YXIgUGF0aENoYW5nZVZpZXdQb2xpY3kgPSBmdW5jdGlvbiAoX1BvbGljeSRQb2xpY3kpIHtcbiAgICAgICAgX2luaGVyaXRzKFBhdGhDaGFuZ2VWaWV3UG9saWN5LCBfUG9saWN5JFBvbGljeSk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENhbGxlZCB0byBidWlsZCBwb2xpY3lcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAge0FuZ3VsYXIgU3RhdGV9ICAgICRzdGF0ZSAgICBVc2VkIHRvIGNoYW5nZSB2aWV3XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBQYXRoQ2hhbmdlVmlld1BvbGljeSgkc3RhdGUpIHtcbiAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQYXRoQ2hhbmdlVmlld1BvbGljeSk7XG5cbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChQYXRoQ2hhbmdlVmlld1BvbGljeS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFBhdGhDaGFuZ2VWaWV3UG9saWN5KSkuY2FsbCh0aGlzLCAnUGF0aENoYW5nZVZpZXdQb2xpY3knKSk7XG5cbiAgICAgICAgICAgIF90aGlzLiRzdGF0ZSA9ICRzdGF0ZTtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZW5lcmF0ZXMgYSBsaXN0IG9mIGFsbCBjaGlsZCBjb250YWluZXJzIG9mIHRoZSBzZXJ2aWNlXG4gICAgICAgICAqIENhbiBoYW5kbGUgbmVzdGVkIHNlcnZpY2VzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgaWQgICAgICBOb2RlIElEXG4gICAgICAgICAqL1xuXG5cbiAgICAgICAgX2NyZWF0ZUNsYXNzKFBhdGhDaGFuZ2VWaWV3UG9saWN5LCBbe1xuICAgICAgICAgICAga2V5OiAnZ2VuZXJhdGVMaXN0JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZW5lcmF0ZUxpc3QoaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHJldExpc3QgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgZ2VuZXJhdGVMaXN0SGVscGVyID0gZnVuY3Rpb24gZ2VuZXJhdGVMaXN0SGVscGVyKGlkLCByZXRMaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlSWRzID0gdGhpc1BvbGljeS5ncmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFtpZF07XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZUlkcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkSWQgPSBub2RlSWRzW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNQb2xpY3kuZ3JhcGguZGF0YVNvdXJjZS5oYXNDaGlsZChjaGlsZElkKSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJSZXRMaXN0ID0gZ2VuZXJhdGVMaXN0SGVscGVyKGNoaWxkSWQsIHJldExpc3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldExpc3QuY29uY2F0KHN1YlJldExpc3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXRMaXN0LnB1c2goY2hpbGRJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGdlbmVyYXRlTGlzdEhlbHBlcihpZCwgcmV0TGlzdCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJldExpc3Q7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byByZXJvdXRlIGFuIGVkZ2Ugd2hlbiBjbGlja2VkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0xpbmt9ICBlZGdlICAgIFRoZSBjbGlja2VkIGVkZ2VcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3ZpZXdFZGdlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2aWV3RWRnZShlZGdlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNvdXJjZUxpc3QgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0TGlzdCA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBzb3VyY2VJZCA9IGVkZ2Uuc291cmNlLmlkO1xuICAgICAgICAgICAgICAgIHZhciB0YXJnZXRJZCA9IGVkZ2UudGFyZ2V0LmlkO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZ3JhcGguZGF0YVNvdXJjZS5oYXNDaGlsZChzb3VyY2VJZCkgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9Ob3QgYSBjb250YWluZXIgbm9kZSwgbmVlZCB0byBhZ2dyZWdhdGVcbiAgICAgICAgICAgICAgICAgICAgc291cmNlTGlzdCA9IHRoaXMuZ2VuZXJhdGVMaXN0KHNvdXJjZUlkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzb3VyY2VMaXN0ID0gW3NvdXJjZUlkXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ncmFwaC5kYXRhU291cmNlLmhhc0NoaWxkKHRhcmdldElkKSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAvL05vdCBhIGNvbnRhaW5lciBub2RlLCBuZWVkIHRvIGFnZ3JlZ2F0ZVxuICAgICAgICAgICAgICAgICAgICB0YXJnZXRMaXN0ID0gdGhpcy5nZW5lcmF0ZUxpc3QodGFyZ2V0SWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldExpc3QgPSBbdGFyZ2V0SWRdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLiRzdGF0ZS5nbygnY29udGl2Lm1lbnUudmlzdWFsaXphdGlvbi5lZGdlJywgeyBzb3VyY2VOYW1lOiBzb3VyY2VJZCwgdGFyZ2V0TmFtZTogdGFyZ2V0SWQsXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZUxpc3Q6IHNvdXJjZUxpc3QsIHRhcmdldExpc3Q6IHRhcmdldExpc3QgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ21vdXNlZG93bicsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbW91c2Vkb3duKGQzcGF0aCwgZCkge1xuICAgICAgICAgICAgICAgIHRoaXMudmlld0VkZ2UoZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1dKTtcblxuICAgICAgICByZXR1cm4gUGF0aENoYW5nZVZpZXdQb2xpY3k7XG4gICAgfShQb2xpY3kuUG9saWN5KTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIFBvbGljeTogUGF0aENoYW5nZVZpZXdQb2xpY3lcbiAgICB9O1xufV0pO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnN0b3JhZ2Vwb2xpY2llcycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzJywge1xuICAgICAgICAgICAgdXJsOiAnL3N0b3JhZ2Vwb2xpY2llcycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdzdG9yYWdlcG9saWN5bGlzdCdcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcFxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4vKipcbiAqIEJhc2UgcG9saWN5IGNsYXNzIGZvciB0aGUgZ3JhcGggb2JqZWN0XG4gKiBcbiAqIFBvbGljaWVzIGFyZSB1c2VkIHRvIGlzb2xhdGUgZmVhdHVyZXMgZm9yIGEgZ3JhcGguXG4gKiBQb2xpY2llcyBjYW4gYmUgaW5zdGFsbGVkIG9uIG5vZGVzLCBsaW5rcywgb3IgdGhlIGdyYXBoLlxuICogRWFjaCBwb2xpY3kgaGFzIGludGVyYWN0aW9uIGhhbmRsZXJzIHRoYXQgd2lsbCBiZSBjYWxsZWQgYnkgdGhlIGdyYXBoXG4gKiBpZiBpbnN0YWxsZWQuIFBvbGljaWVzIGNhbiBhbHNvIG1vZGlmeSBncmFwaCBmdW5jdGlvbnMgKHNlZSBRVGlwUG9saWN5KS5cbiAqIE11bHRpcGxlIHBvbGljaWVzIGNhbiBiZSBpbnN0YWxsZWQgZm9yIGEgbm9kZSBvciBsaW5rLiBcbiAqIFxuICogVG8gd3JpdGUgeW91ciBvd24gcG9saWN5LCBjcmVhdGUgYSBuZXcgZmFjdG9yeSB0aGF0IHVzZXMgdGhlIHBvbGljeVxuICogeW91IHdhbnQgdG8gaW5oZXJpdCBhcyBhIGRlcGVuZGVuY3ksIGFuZCBleHRlbmQgaXRzIHBvbGljeS4gXG4gKiBSZXR1cm4gdGhlIGNsYXNzIG9iamVjdCB3aXRoIFBvbGljeSBhcyBrZXksIGFuZCBcbiAqIGFkZCB0aGUgcG9saWN5IHRvIHRoZSBQb2xpY3lTZXJ2aWNlIGZhY3RvcnkuXG4gKiBcbiAqIEZvciBzYXZpbmcgc3RhdGUgb3IgY29uc3RzIGZvciB0aGUgcG9saWN5LCBjcmVhdGUgYSBuYW1lc3BhY2VcbiAqIGluIGdyYXBoLnN0YXRlIGFuZCBncmFwaC5jb25zdHMuXG4gKiBFeC4gXG4gKiAgICAgIGdyYXBoLnN0YXRlLm15UG9saWN5ID0ge307XG4gKiAgICAgIGdyYXBoLmNvbnN0cy5teVBvbGljeSA9IHt9O1xuICogICAgICBcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ1BvbGljeScsIFtmdW5jdGlvbiAoKSB7XG4gIHZhciBQb2xpY3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgICAqXG4gICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHBvbGljeU5hbWUgIFRoZSBwb2xpY3kgbmFtZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFBvbGljeShwb2xpY3lOYW1lKSB7XG4gICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUG9saWN5KTtcblxuICAgICAgdGhpcy5wb2xpY3lOYW1lID0gcG9saWN5TmFtZTtcbiAgICAgIHRoaXMuZ3JhcGggPSBudWxsO1xuICAgICAgdGhpcy5pbml0aWFsaXplZCA9IGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbGxlZCB3aGVuIHRoZSBwb2xpY3kgaXMgaW5zdGFsbGVkLlxuICAgICAqIFxuICAgICAqIEBwYXJhbSAge0dyYXBofSAgZ3JhcGggICBUaGUgR3JhcGggdGhhdCB0aGUgcG9saWN5IGlzXG4gICAgICogICAgICAgICAgICAgICAgICAgICAgICAgIGJlaW5nIGluc3RhbGxlZCBvblxuICAgICAqL1xuXG5cbiAgICBfY3JlYXRlQ2xhc3MoUG9saWN5LCBbe1xuICAgICAga2V5OiAnaW5pdGlhbGl6ZScsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdGlhbGl6ZShncmFwaCkge1xuICAgICAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5ncmFwaCA9IGdyYXBoO1xuICAgICAgfVxuXG4gICAgICAvKipcbiAgICAgICAqIEhhbmRsZXIsIG1lYW50IHRvIGJlIG92ZXJyaWRkZW4gaW4gc3ViY2xhc3Nlc1xuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSAge2QzIG9iamVjdH0gICAgZDNvYmogICAgVGhlIGQzb2JqZWN0XG4gICAgICAgKiBAcGFyYW0gIHtOb2RlL0xpbmsvR3JhcGh9ICBkICAgVGhlIG9iamVjdCBpdCB3YXNcbiAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YWxsZWQgZm9yLiAgICBcbiAgICAgICAqL1xuXG4gICAgfSwge1xuICAgICAga2V5OiAnbW91c2VvdmVyJyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBtb3VzZW92ZXIoZDNvYmosIGQpIHt9XG4gICAgfSwge1xuICAgICAga2V5OiAnZGJsY2xpY2snLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRibGNsaWNrKGQzb2JqLCBkKSB7fVxuICAgIH0sIHtcbiAgICAgIGtleTogJ2NvbnRleHRtZW51JyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb250ZXh0bWVudShkM29iaiwgZCkge31cbiAgICB9LCB7XG4gICAgICBrZXk6ICdtb3VzZW91dCcsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gbW91c2VvdXQoZDNvYmosIGQpIHt9XG4gICAgfSwge1xuICAgICAga2V5OiAnbW91c2Vkb3duJyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBtb3VzZWRvd24oZDNvYmosIGQpIHt9XG4gICAgfSwge1xuICAgICAga2V5OiAnbW91c2V1cCcsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gbW91c2V1cChkM29iaiwgZCkge31cblxuICAgICAgLyoqXG4gICAgICAgKiBXaWxsIGJlIGNhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyBiZWluZyBkZXN0cm95ZWQuXG4gICAgICAgKiBVc2VkIHRvIHJlbW92ZSBhbnkgZWxlbWVudHMgb3IgYmluZGluZ3MgdGhlIHBvbGljeVxuICAgICAgICogaGFzIGFkZGVkLlxuICAgICAgICovXG5cbiAgICB9LCB7XG4gICAgICBrZXk6ICdkZXN0cm95JyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkge31cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gUG9saWN5O1xuICB9KCk7XG5cbiAgcmV0dXJuIHtcbiAgICBQb2xpY3k6IFBvbGljeVxuICB9O1xufV0pO1xuXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnLCBcblx0J2NvbnRpdi5ncmFwaCddKVxuIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnY29udGl2Lm1lbnUudmlzdWFsaXphdGlvbicsIHtcbiAgICAgICAgICAgIHVybDogJy92aXN1YWxpemF0aW9uJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KVxuICAgIH1dKTtcblxuJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIENvbnRhaW5zIGFsbCB0aGUgcG9saWNpZXMuXG4gKiBTZWUgcG9saWN5LmpzIGZvciBpbmZvIG9uIGhvdyBwb2xpY2llcyB3b3JrLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnUG9saWN5U2VydmljZScsIFsnUG9saWN5JywgJ1FUaXBQb2xpY3knLCAnUGF0aENoYW5nZVZpZXdQb2xpY3knLCAnTm9kZVNlbGVjdGlvblBvbGljeScsICdTcGxpdEpvaW5Ob2RlUG9saWN5JywgJ1NwbGl0Sm9pblZpZXdQb2xpY3knLCAnU2F2ZVN0YXRlUG9saWN5JywgZnVuY3Rpb24gKFBvbGljeSwgUVRpcFBvbGljeSwgUGF0aENoYW5nZVZpZXdQb2xpY3ksIE5vZGVTZWxlY3Rpb25Qb2xpY3ksIFNwbGl0Sm9pbk5vZGVQb2xpY3ksIFNwbGl0Sm9pblZpZXdQb2xpY3ksIFNhdmVTdGF0ZVBvbGljeSkge1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgUG9saWN5OiBQb2xpY3kuUG9saWN5LFxuICAgICAgICBRVGlwUG9saWN5OiBRVGlwUG9saWN5LlBvbGljeSxcbiAgICAgICAgUGF0aENoYW5nZVZpZXdQb2xpY3k6IFBhdGhDaGFuZ2VWaWV3UG9saWN5LlBvbGljeSxcbiAgICAgICAgTm9kZVNlbGVjdGlvblBvbGljeTogTm9kZVNlbGVjdGlvblBvbGljeS5Qb2xpY3ksXG4gICAgICAgIFNwbGl0Sm9pbk5vZGVQb2xpY3k6IFNwbGl0Sm9pbk5vZGVQb2xpY3kuUG9saWN5LFxuICAgICAgICBTcGxpdEpvaW5WaWV3UG9saWN5OiBTcGxpdEpvaW5WaWV3UG9saWN5LlBvbGljeSxcbiAgICAgICAgU2F2ZVN0YXRlUG9saWN5OiBTYXZlU3RhdGVQb2xpY3kuUG9saWN5XG4gICAgfTtcbn1dKTtcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52b2x1bWVzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52b2x1bWVzJywge1xuICAgICAgICAgICAgdXJsOiAnL3ZvbHVtZXMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZvbHVtZXMubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ3ZvbHVtZWxpc3QnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZvbHVtZXMuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29tcG9uZW50OiAndm9sdW1lZGV0YWlscydcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcFxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG52YXIgX2dldCA9IGZ1bmN0aW9uIGdldChvYmplY3QsIHByb3BlcnR5LCByZWNlaXZlcikgeyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7IH0gfSBlbHNlIGlmIChcInZhbHVlXCIgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH07XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuLyoqXG4gKiBUaGlzIHBvbGljeSBhZGRzIHRvb2x0aXAgZnVuY3Rpb25hbGl0eSB0byBub2RlcyBhbmQgbGlua3MuXG4gKiBXaGVuIGluc3RhbGxpbmcsIGluc3RhbGwgb24gYm90aCBsaW5rcyBhbmQgbm9kZXMuXG4gKiBcbiAqIFVzZXMgdGhlIHFUaXAgalF1ZXJ5IHBsdWdpblxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnUVRpcFBvbGljeScsIFsnUG9saWN5JywgZnVuY3Rpb24gKFBvbGljeSkge1xuICAgIHZhciBRVGlwUG9saWN5ID0gZnVuY3Rpb24gKF9Qb2xpY3kkUG9saWN5KSB7XG4gICAgICAgIF9pbmhlcml0cyhRVGlwUG9saWN5LCBfUG9saWN5JFBvbGljeSk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIFFUaXBQb2xpY3koKSB7XG4gICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUVRpcFBvbGljeSk7XG5cbiAgICAgICAgICAgIHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoUVRpcFBvbGljeS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFFUaXBQb2xpY3kpKS5jYWxsKHRoaXMsIFwiUVRpcFBvbGljeVwiKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICogTW9kaWZpZXMgdGhlIHVwZGF0ZU5ld05vZGVzIGFuZCBcbiAgICAgICAgICogdXBkYXRlTmV3UGF0aHMgbWV0aG9kIG9mIHRoZSBncmFwaCB0byBpbnN0YWxsIHF0aXBcbiAgICAgICAgICogb250byBlYWNoIG5vZGUgYW5kIHBhdGguXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoIGl0IGlzIFxuICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbGxlZCBvblxuICAgICAgICAgKi9cblxuXG4gICAgICAgIF9jcmVhdGVDbGFzcyhRVGlwUG9saWN5LCBbe1xuICAgICAgICAgICAga2V5OiAnaW5pdGlhbGl6ZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdGlhbGl6ZShncmFwaCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgX2dldChRVGlwUG9saWN5LnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFFUaXBQb2xpY3kucHJvdG90eXBlKSwgJ2luaXRpYWxpemUnLCB0aGlzKS5jYWxsKHRoaXMsIGdyYXBoKTtcblxuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBncmFwaC5zdGF0ZS5RVGlwUG9saWN5ID0ge307XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS5tb3VzZWRvd24gPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIGdyYXBoLmNvbnN0cy5RVGlwUG9saWN5ID0ge307XG5cbiAgICAgICAgICAgICAgICAvL1RyYWNraW5nIG1vdXNlIGNsaWNrIHN0YXRlIHRvIG1ha2UgdG9vbHRpcFxuICAgICAgICAgICAgICAgIC8vZGlzYXBwZWFyIGlmIHRoZSBub2RlIGlzIGJlaW5nIGRyYWdnZWQuXG4gICAgICAgICAgICAgICAgJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS5tb3VzZXVwKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLm1vdXNldXAgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vb3ZlcnJpZGUgdXBkYXRlTmV3Tm9kZXMgYW5kIHVwZGF0ZU5ld1BhdGhzXG4gICAgICAgICAgICAgICAgLy90byBpbnN0YWxsIHF0aXBcbiAgICAgICAgICAgICAgICB2YXIgZ3JhcGhVcGRhdGVOZXdOb2RlcyA9IGdyYXBoLnVwZGF0ZU5ld05vZGVzO1xuICAgICAgICAgICAgICAgIGdyYXBoLnVwZGF0ZU5ld05vZGVzID0gZnVuY3Rpb24gKG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGdyYXBoVXBkYXRlTmV3Tm9kZXMuY2FsbChncmFwaCwgbmV3Tm9kZXMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnVwZGF0ZU5ld05vZGVzKG5ld05vZGVzKTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdmFyIGdyYXBoVXBkYXRlTmV3UGF0aHMgPSBncmFwaC51cGRhdGVOZXdQYXRocztcbiAgICAgICAgICAgICAgICBncmFwaC51cGRhdGVOZXdQYXRocyA9IGZ1bmN0aW9uIChuZXdQYXRocykge1xuICAgICAgICAgICAgICAgICAgICBncmFwaFVwZGF0ZU5ld1BhdGhzLmNhbGwoZ3JhcGgsIG5ld1BhdGhzKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51cGRhdGVOZXdQYXRocyhuZXdQYXRocyk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmVzIGFsbCBxVGlwcyBmcm9tIHRoZSBET00uXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgcG9saWN5IGlzIHVuaW5zdGFsbGVkIG9yXG4gICAgICAgICAgICAgKiB0aGUgZ3JhcGggaXMgZGVzdHJveWVkLlxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZGVzdHJveScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgICAgICAgICAvL3JlbW92aW5nIGFsbCBxdGlwIGZyb20gRE9NXG4gICAgICAgICAgICAgICAgJCgnW2lkXj1cInF0aXBcIl0nKS5yZW1vdmUoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBLZWVwaW5nIHRyYWNrIG9mIG1vdXNlZG93biBzdGF0ZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM09iamVjdH0gIGQzb2JqICBUaGUgZDMgcGJqZWN0XG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZS9MaW5rfSAgZCAgICAgVGhlIG1hdGNoaW5nIGRhdGEgb2JqZWN0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdtb3VzZWRvd24nLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdXNlZG93bihkM29iaiwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5RVGlwUG9saWN5O1xuICAgICAgICAgICAgICAgIHN0YXRlLm1vdXNlZG93biA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogS2VlcGluZyB0cmFjayBvZiBtb3VzZWRvd24gc3RhdGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7ZDNPYmplY3R9ICBkM29iaiAgVGhlIGQzIHBiamVjdFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGUvTGlua30gIGQgICAgIFRoZSBtYXRjaGluZyBkYXRhIG9iamVjdFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnbW91c2V1cCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbW91c2V1cChkM29iaiwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5RVGlwUG9saWN5O1xuICAgICAgICAgICAgICAgIHN0YXRlLm1vdXNlZG93biA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd3aGVuUVRpcEF2YWlsYWJsZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gd2hlblFUaXBBdmFpbGFibGUoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIGludGVydmFsID0gNTAwOyAvLyBtc1xuICAgICAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCQoZG9jdW1lbnQpLnF0aXAgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KHRoaXNQb2xpY3kud2hlblFUaXBBdmFpbGFibGUoY2FsbGJhY2spLCBpbnRlcnZhbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCBpbnRlcnZhbCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gTmV3IE5vZGVzIGFyZSBhZGRlZCBkdXJpbmcgdGhlXG4gICAgICAgICAgICAgKiB1cGRhdGUgZ3JhcGggZnVuY3Rpb25cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7ZDNOb2RlfSAgbmV3Tm9kZXMgIFRoZSBuZXcgbm9kZXMgdGhhdCBhcmVcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmVpbmcgYWRkZWQgdG8gdGhlIGdyYXBoXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd1cGRhdGVOZXdOb2RlcycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlTmV3Tm9kZXMobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuUVRpcFBvbGljeTtcblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGF0dGFjaFFUaXAoKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vYXR0YWNoaW5nIHF0aXBcbiAgICAgICAgICAgICAgICAgICAgbmV3Tm9kZXMuZWFjaChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRoaXNOb2RlID0gdGhpcztcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vSWYgbm9kZSBoYXMgY2hpbGRyZW4sIHRoZW4gaXQgaXMgYSBzZXJ2aWNlXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0W2QuaWRdICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gXCI8Yj48dT5TZWxlY3RvcnM6PC9iPjwvdT4gXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGVjdG9yTWFwID0gdGhpc0dyYXBoLmRhdGFTb3VyY2Uuc2VsZWN0b3JzW2QuaWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoYXNLZXlzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHNlbGVjdG9yTWFwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc0tleXMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ICs9IGtleSArIFwiIDogPGk+XCIgKyBzZWxlY3Rvck1hcFtrZXldICsgXCI8L2k+LFxcbiBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhhc0tleXMgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29tbWEgd2lsbCBiZSByZW1vdmVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSBcIk5vIFNlbGVjdG9ycywgXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gXCI8Yj48dT5MYWJlbHM6PC9iPjwvdT4gXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxhYmVsc01hcCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmxhYmVsc1tkLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGFzS2V5cyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBsYWJlbHNNYXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzS2V5cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0ga2V5ICsgXCIgOiA8aT5cIiArIGxhYmVsc01hcFtrZXldICsgXCI8L2k+LFxcbiBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhhc0tleXMgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29tbWEgd2lsbCBiZSByZW1vdmVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSBcIk5vIGxhYmVscywgXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy9yZW1vdmUgbGFzdCBjb21tYVxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IHRleHQuc2xpY2UoMCwgLTIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXNOb2RlKS5xdGlwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBkLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0ZXh0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdzogZnVuY3Rpb24gc2hvdygpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcGkgPSAkKHRoaXNOb2RlKS5xdGlwKCdhcGknKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSAkKCcjZ3JhcGhDb250YWluZXInKS5vZmZzZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IFtvZmZzZXQubGVmdCArIChkLnggKiB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpICsgdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKClbMF0pLCBvZmZzZXQudG9wICsgKGQueSArIGQucmFkaXVzKSAqIHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCkgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKVsxXV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcGkuc2V0KCdwb3NpdGlvbi50YXJnZXQnLCBwb3NpdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIXN0YXRlLm1vdXNlZG93bjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxheTogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc29sbzogJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NlczogJ3F0aXAtYmx1ZSBxdGlwLXNoYWRvdydcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG15OiAndG9wIGNlbnRlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0OiAnYm90dG9tIGNlbnRlcidcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGFyZ2V0OiBwb3NpdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudDogJ21vdXNlZG93biBtb3VzZWxlYXZlJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9pbmNhc2UgbGlicmFyeSBoYXNuJ3QgbG9hZGVkIHlldFxuICAgICAgICAgICAgICAgIGlmICgkKGRvY3VtZW50KS5xdGlwICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBhdHRhY2hRVGlwKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy53aGVuUVRpcEF2YWlsYWJsZShhdHRhY2hRVGlwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gbmV3IHBhdGhzIGFyZSBhZGRlZCBkdXJpbmcgdGhlXG4gICAgICAgICAgICAgKiB1cGRhdGUgZ3JhcGggZnVuY3Rpb25cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7ZDNQYXRofSAgbmV3UGF0aHMgIFRoZSBuZXcgcGF0aHMgdGhhdCBhcmVcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmVpbmcgYWRkZWQgdG8gdGhlIGdyYXBoXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd1cGRhdGVOZXdQYXRocycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlTmV3UGF0aHMobmV3UGF0aHMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuUVRpcFBvbGljeTtcblxuICAgICAgICAgICAgICAgIC8vaW5jYXNlIGxpYnJhcnkgaGFzbid0IGxvYWRlZCB5ZXRcbiAgICAgICAgICAgICAgICBpZiAoJChkb2N1bWVudCkucXRpcCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9hZGRpbmcgcXRpcFxuICAgICAgICAgICAgICAgICAgICBuZXdQYXRocy5lYWNoKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGhpc1BhdGggPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9nZXR0aW5nIG1pZHBvaW50IG9mIHBhdGhcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXRoRWwgPSBkMy5zZWxlY3QodGhpcykubm9kZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1pZHBvaW50ID0gcGF0aEVsLmdldFBvaW50QXRMZW5ndGgocGF0aEVsLmdldFRvdGFsTGVuZ3RoKCkgLyAyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRSZXQgPSBkLnF0aXBIZWxwZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gXCJCeXRlczogXCIgKyBkLmdldFdlaWdodCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzUGF0aCkucXRpcCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0ZXh0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdzogZnVuY3Rpb24gc2hvdygpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vaWYgbW91c2UgaXMgZG93biwgZG9uJ3QgbGV0IHF0aXAgc2hvd1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICFzdGF0ZS5tb3VzZWRvd247XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3c6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsYXk6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvbG86ICQoJyNncmFwaENvbnRhaW5lcicpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc2VzOiAncXRpcC1ibHVlIHF0aXAtc2hhZG93J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXk6IHRhcmdldFJldC5teSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXQ6ICdjZW50ZXIgY2VudGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiAnbW91c2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGp1c3Q6IHRhcmdldFJldC5hZGp1c3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQ6ICdtb3VzZWRvd24gbW91c2VsZWF2ZSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1dKTtcblxuICAgICAgICByZXR1cm4gUVRpcFBvbGljeTtcbiAgICB9KFBvbGljeS5Qb2xpY3kpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgUG9saWN5OiBRVGlwUG9saWN5XG4gICAgfTtcbn1dKTtcbid1c2Ugc3RyaWN0Jztcbi8vIERlY2xhcmUgYXBwIGxldmVsIG1vZHVsZSB3aGljaCBkZXBlbmRzIG9uIHZpZXdzLCBhbmQgY29tcG9uZW50c1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdkFwcCcsIFtcbiAgICAndWkucm91dGVyJyxcbiAgICAnY29udGl2LmxvZ2luJyxcbiAgICAnY29udGl2Lm1lbnUnLFxuICAgICdjb250aXYuZGFzaGJvYXJkJyxcbiAgICAnY29udGl2LmFwcGxpY2F0aW9uZ3JvdXBzJyxcbiAgICAnY29udGl2Lm5ldHdvcmtzJyxcbiAgICAnY29udGl2Lm5ldHdvcmtwb2xpY2llcycsXG4gICAgJ2NvbnRpdi5zdG9yYWdlcG9saWNpZXMnLFxuICAgICdjb250aXYuc2VydmljZWxicycsXG4gICAgJ2NvbnRpdi52b2x1bWVzJyxcbiAgICAnY29udGl2Lm5vZGVzJyxcbiAgICAnY29udGl2Lm9yZ2FuaXphdGlvbnMnLFxuICAgICdjb250aXYuc2V0dGluZ3MnLFxuICAgICdjb250aXYudmlzdWFsaXphdGlvbidcbl0pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgJyR1cmxSb3V0ZXJQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdicsIHtcbiAgICAgICAgICAgIHVybDogJycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgZmx1aWQgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSk7XG4gICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubG9naW4nKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubG9naW4nLCB7XG4gICAgICAgICAgICB1cmw6ICcvJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbG9naW4vbG9naW4uaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTG9naW5DdHJsIGFzIGxvZ2luQ3RybCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ0xvZ2luQ3RybCcsIFsnJHN0YXRlJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgbG9naW5DdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9EYXNoYm9hcmQoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LmRhc2hib2FyZCcsIHsgdXNlcm5hbWU6IGxvZ2luQ3RybC51c2VybmFtZSB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBsb2dpbigpIHtcbiAgICAgICAgICAgIHJldHVyblRvRGFzaGJvYXJkKCk7XG4gICAgICAgIH1cbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihsb2dpbkN0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IobG9naW5DdHJsKTtcbiAgICAgICAgbG9naW5DdHJsLmxvZ2luID0gbG9naW47XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bG9naW5jdHJsLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE5LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm1lbnUnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudScsIHtcbiAgICAgICAgICAgIHVybDogJy9tJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbWVudS9tZW51Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ01lbnVDdHJsIGFzIG1lbnVDdHJsJyxcbiAgICAgICAgICAgIHBhcmFtczogeyB1c2VybmFtZTogbnVsbCB9XG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdNZW51Q3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcykge1xuICAgICAgICB2YXIgbWVudUN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBsb2dvdXQoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5sb2dpbicpO1xuICAgICAgICB9XG4gICAgICAgIG1lbnVDdHJsLnVzZXJuYW1lID0gJHN0YXRlUGFyYW1zLnVzZXJuYW1lO1xuICAgICAgICBtZW51Q3RybC5sb2dvdXQgPSBsb2dvdXQ7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bWVudUN0cmwuanMubWFwXG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuLyoqXG4gKiBUaGlzIHBvbGljeSBwcm92aWRlcyBhIHdheSBmb3IgcHJvcGVydGllcyB0byBiZSBzYXZlZCBcbiAqIGJldHdlZW4gdmlldyBjaGFuZ2VzXG4gKiBcbiAqIEl0IG1vZGlmaWVzIHRoZSBkZXN0cm95IGZ1bmN0aW9uIHRvIGFsc28gcGFzcyBpbiBhbiBvYmplY3QgdGhhdFxuICogd2lsbCBoYXZlIGFsbCBpdHMgcHJvcGVydGllcyBzYXZlZCBhbmQgd2lsbCBiZSBhdmFpbGFibGUgXG4gKiBvbiBncmFwaCBsb2FkLiBXaGVuIHNhdmluZyB2YXJpYWJsZXMgdG8gdGhlIG9iamVjdCwgbmFtZXNwYWNlIHdpdGhcbiAqIHRoZSBwb2xpY3kgbmFtZS5cbiAqIFxuICogVGhpcyBwb2xpY3kgbXVzdCBiZSBsb2FkZWQgZmlyc3QgaW4gb3JkZXIgZm9yIGl0IHNhdmVkIHZhcmlhYmxlcyBcbiAqIHRvIGJlIGxvYWRlZCB3aGVuIHRoZSB2aWV3IGNvbWVzIGJhY2sgdG8gdGhlIGdyYXBoXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdTYXZlU3RhdGVQb2xpY3knLCBbJ1BvbGljeScsIGZ1bmN0aW9uIChQb2xpY3kpIHtcbiAgICB2YXIgU2F2ZVN0YXRlUG9saWN5ID0gZnVuY3Rpb24gKF9Qb2xpY3kkUG9saWN5KSB7XG4gICAgICAgIF9pbmhlcml0cyhTYXZlU3RhdGVQb2xpY3ksIF9Qb2xpY3kkUG9saWN5KTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGFrZXMgaW4gdGhlIGFuZ3VsYXIgc2VydmljZSB0byB3aGljaCBpdCB3aWxsXG4gICAgICAgICAqIHNhdmUgaXQncyBwcm9wZXJ0aWVzIHRvLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgc2F2ZWRTdGF0ZSAgT2JqZWN0IHRvIHNhdmUgXG4gICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzIHRvXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBTYXZlU3RhdGVQb2xpY3koc2F2ZWRTdGF0ZSkge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNhdmVTdGF0ZVBvbGljeSk7XG5cbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChTYXZlU3RhdGVQb2xpY3kuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihTYXZlU3RhdGVQb2xpY3kpKS5jYWxsKHRoaXMsICdTYXZlU3RhdGVQb2xpY3knKSk7XG5cbiAgICAgICAgICAgIF90aGlzLnNhdmVkU3RhdGUgPSBzYXZlZFN0YXRlO1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAqIE1vZGlmaWVzIHRoZSBkZXN0cm95IG1ldGhvZCBcbiAgICAgICAgICogYW5kIGFkZHMgYSBsb2FkIG1ldGhvZCB0byB0aGUgZ3JhcGhcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgXG4gICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFsbGVkIG9uXG4gICAgICAgICAqL1xuXG5cbiAgICAgICAgX2NyZWF0ZUNsYXNzKFNhdmVTdGF0ZVBvbGljeSwgW3tcbiAgICAgICAgICAgIGtleTogJ2luaXRpYWxpemUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemUoZ3JhcGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmdyYXBoID0gZ3JhcGg7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgICAgICAgICAgICAgIGdyYXBoLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kuZ3JhcGhEZXN0cm95LmNhbGwoZ3JhcGgsIHRoaXNQb2xpY3kuc2F2ZWRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGdyYXBoLmxvYWQgPSBmdW5jdGlvbiAoc2F2ZWRTdGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LmdyYXBoTG9hZC5jYWxsKGdyYXBoLCBzYXZlZFN0YXRlKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgb3ZlcnJpZGUgdGhlIGdyYXBoJ3MgZGVmYXVsdCBkZXN0cm95LCB3aXRoIFxuICAgICAgICAgICAgICogdGhpcyBwb2xpY3kncyBzYXZlZFN0YXRlIHBhc3NlZCBpbi5cbiAgICAgICAgICAgICAqIENhbGxlZCB3aXRoIHRoaXMgYXMgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIHNhdmVkU3RhdGUgIFRoZSBzYXZlZCBzdGF0ZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZ3JhcGhEZXN0cm95JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBncmFwaERlc3Ryb3koc2F2ZWRTdGF0ZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3kuZGVzdHJveShzYXZlZFN0YXRlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5LmRlc3Ryb3koc2F2ZWRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHRoaXNHcmFwaC5iaW5kaW5ncykge1xuICAgICAgICAgICAgICAgICAgICAkKHdpbmRvdykub2ZmKGtleSwgdGhpc0dyYXBoLmJpbmRpbmdzW2tleV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBXaWxsIGJlIGNhbGxlZCB3aXRoIHRoZSBncmFwaCBhcyB0aGlzXG4gICAgICAgICAgICAgKiBVc2VkIHRvIGhhdmUgYWxsIG90aGVyIHBvbGljaWVzIHVzZSB0aGUgbG9hZCBzdGF0ZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBzYXZlZFN0YXRlICBUaGUgc2F2ZWQgc3RhdGVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2dyYXBoTG9hZCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ3JhcGhMb2FkKHNhdmVkU3RhdGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvbGljeS5sb2FkICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljeS5sb2FkKHNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb2xpY3kubG9hZCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2xpY3kubG9hZChzYXZlZFN0YXRlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIFNhdmVTdGF0ZVBvbGljeTtcbiAgICB9KFBvbGljeS5Qb2xpY3kpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgUG9saWN5OiBTYXZlU3RhdGVQb2xpY3lcbiAgICB9O1xufV0pO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IGhhcmRpayBnYW5kaGkgb24gNi8yNC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoXCJjb250aXYubmV0d29ya3BvbGljaWVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dkJhbmR3aWR0aFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIGJhbmR3aWR0aFBvbGljeTogJz0nLFxuICAgICAgICAgICAgbW9kZTogXCJAXCJcbiAgICAgICAgfSxcbiAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlKSB7XG4gICAgICAgICAgICBpZiAoc2NvcGUuYmFuZHdpZHRoUG9saWN5LmJhbmR3aWR0aCAhPSAnJykge1xuICAgICAgICAgICAgICAgIHZhciBiYW5kd2lkdGhBcnJheSA9IHNjb3BlLmJhbmR3aWR0aFBvbGljeS5iYW5kd2lkdGguc3BsaXQoJyAnKTtcbiAgICAgICAgICAgICAgICBzY29wZS5iYW5kd2lkdGhQb2xpY3kuYmFuZHdpZHRoTnVtYmVyID0gTnVtYmVyKGJhbmR3aWR0aEFycmF5WzBdKTtcbiAgICAgICAgICAgICAgICBzY29wZS5iYW5kd2lkdGhQb2xpY3kuYmFuZHdpZHRoVW5pdCA9IGJhbmR3aWR0aEFycmF5WzFdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtfcG9saWNpZXMvYmFuZHdpZHRoLmh0bWwnXG4gICAgfTtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YmFuZHdpZHRoZGlyZWN0aXZlLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3BvbGljaWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOZXR3b3JrUG9saWNpZXNUYWJzQ3RybCBhcyBuZXR3b3JrUG9saWNpZXNUYWJzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtfcG9saWNpZXMvbmV0d29ya3BvbGljaWVzdGFicy5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMubGlzdC5yZWRpcmVjdGlvbicsIHtcbiAgICAgICAgICAgIHVybDogJy9yZWRpcmVjdGlvbicsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJydcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05ldHdvcmtQb2xpY2llc1RhYnNDdHJsJywgWyckc3RhdGUnLCBmdW5jdGlvbiAoJHN0YXRlKSB7XG4gICAgICAgIHZhciBuZXR3b3JrUG9saWNpZXNUYWJzQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZU5ldHdvcmtQb2xpY3koKSB7XG4gICAgICAgICAgICBpZiAoJHN0YXRlLiRjdXJyZW50LmluY2x1ZGVzWydjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMubGlzdC5pc29sYXRpb24nXSkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbi5jcmVhdGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgkc3RhdGUuJGN1cnJlbnQuaW5jbHVkZXNbJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5saXN0LmJhbmR3aWR0aCddKSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuYmFuZHdpZHRoLmNyZWF0ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIG5ldHdvcmtQb2xpY2llc1RhYnNDdHJsLmNyZWF0ZU5ldHdvcmtQb2xpY3kgPSBjcmVhdGVOZXR3b3JrUG9saWN5O1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5ldHdvcmtwb2xpY2llc3RhYnNjdHJsLmpzLm1hcFxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG52YXIgX2dldCA9IGZ1bmN0aW9uIGdldChvYmplY3QsIHByb3BlcnR5LCByZWNlaXZlcikgeyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7IH0gfSBlbHNlIGlmIChcInZhbHVlXCIgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH07XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuLyoqXG4gKiBUaGlzIHBvbGljeSBpcyB1c2VkIGZvciBzcGxpdHRpbmcgYSBub2RlIGludG8gaXRzIGNoaWxkcmVuLFxuICogYW5kIGpvaW5pbmcgdGhlbSBiYWNrIHRvIHRoZWlyIHBhcmVudC5cbiAqIFNwbGl0cyBvbiBkb3VibGUgY2xpY2ssIGFuZCBqb2lucyBvbiByaWdodCBjbGljay5cbiAqIElmIG11bHRpcGxlIG5vZGVzIGFyZSBzZWxlY3RlZCBhdCB0aGUgdGltZSBvZiBhIHNwbGl0IG9yIGpvaW4gZXZlbnQsXG4gKiBpdCB3aWxsIHNwbGl0IG9yIGpvaW4gYWxsIG9mIHRoZW0uXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdTcGxpdEpvaW5Ob2RlUG9saWN5JywgWydOb2RlU2VsZWN0aW9uUG9saWN5JywgJ1Zpc3VhbGl6ZXJOb2RlJywgZnVuY3Rpb24gKE5vZGVTZWxlY3Rpb25Qb2xpY3ksIFZpc3VhbGl6ZXJOb2RlKSB7XG4gICAgdmFyIFNwbGl0Sm9pbk5vZGVQb2xpY3kgPSBmdW5jdGlvbiAoX05vZGVTZWxlY3Rpb25Qb2xpY3kkKSB7XG4gICAgICAgIF9pbmhlcml0cyhTcGxpdEpvaW5Ob2RlUG9saWN5LCBfTm9kZVNlbGVjdGlvblBvbGljeSQpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBTcGxpdEpvaW5Ob2RlUG9saWN5KCkge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNwbGl0Sm9pbk5vZGVQb2xpY3kpO1xuXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoU3BsaXRKb2luTm9kZVBvbGljeS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFNwbGl0Sm9pbk5vZGVQb2xpY3kpKS5jYWxsKHRoaXMpKTtcblxuICAgICAgICAgICAgX3RoaXMucG9saWN5TmFtZSA9IFwiU3BsaXRKb2luTm9kZVBvbGljeVwiO1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENhbGxlZCB3aGVuIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGhcbiAgICAgICAgICovXG5cblxuICAgICAgICBfY3JlYXRlQ2xhc3MoU3BsaXRKb2luTm9kZVBvbGljeSwgW3tcbiAgICAgICAgICAgIGtleTogJ2luaXRpYWxpemUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemUoZ3JhcGgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF9nZXQoU3BsaXRKb2luTm9kZVBvbGljeS5wcm90b3R5cGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihTcGxpdEpvaW5Ob2RlUG9saWN5LnByb3RvdHlwZSksICdpbml0aWFsaXplJywgdGhpcykuY2FsbCh0aGlzLCBncmFwaCk7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuU3BsaXRKb2luTm9kZVBvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLnNwbGl0Tm9kZXMgPSBbXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUcmlnZ2VyaW5nIHNwbGl0IG9uIGRvdWJsZSBjbGlja1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBkICAgICAgVGhlIG1hdGNoaW5nIGRhdGEgb2JqZWN0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkYmxjbGljaycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGJsY2xpY2soZDNub2RlLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN1cGVyU3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luTm9kZVBvbGljeTtcblxuICAgICAgICAgICAgICAgIGlmICghZDMuZXZlbnQuY3RybEtleSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3VwZXJTdGF0ZS5zZWxlY3RlZE5vZGVzLmluZGV4T2YoZCkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGxpdE11bHRpcGxlTm9kZXMoc3VwZXJTdGF0ZS5zZWxlY3RlZE5vZGVzKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQWxsU2VsZWN0ZWROb2RlcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGxpdE5vZGUoZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVHJpZ2dlcmluZyBqb2luIG9uIHJpZ2h0IGNsaWNrXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqfSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGQgICAgICBUaGUgbWF0Y2hpbmcgZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2NvbnRleHRtZW51JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb250ZXh0bWVudShkM25vZGUsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3VwZXJTdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuICAgICAgICAgICAgICAgIGQzLmV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgaWYgKCFkMy5ldmVudC5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgdHJ5IHRvIGpvaW4gYSBoaWdobGlnaHRlZCBub2RlIHdoaWxlIG11bHRpcGxlIG5vZGVzIGFyZSBzZWxlY3RlZCxcbiAgICAgICAgICAgICAgICAgICAgLy93ZSBqb2luIGFsbCBoaWdobGlnaHRlZCBub2Rlc1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWROb2RlcyA9IHN1cGVyU3RhdGUuc2VsZWN0ZWROb2RlcztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkTm9kZXMuaW5kZXhPZihkKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGVjdGVkTm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmpvaW5Ob2RlKHNlbGVjdGVkTm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9pZiB3ZSB0cnkgdG8gam9pbiBhIG5vZGUgdGhhdCBpc24ndCBwYXJ0IG9mIGEgaGlnaGxpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAgICAgLy93ZSByZW1vdmUgYWxsIGhpZ2hsaWdodHMgYW5kIHRoZW4gam9pbiB0aGUgY2xpY2tlZCBub2RlXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUFsbFNlbGVjdGVkTm9kZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuam9pbk5vZGUoZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU3BsaXRzIGEgbm9kZS5cbiAgICAgICAgICAgICAqIHVzZWQgdG8gc2hhcmUgY29kZSBiZXR3ZWVuIHNwbGl0Tm9kZSBhbmQgc3BsaXRNdWx0aXBsZU5vZGVzXG4gICAgICAgICAgICAgKiB3aGlsZSBwcmV2ZW50aW5nIHRoZSBoYW5kbGVycyBmb3IgdGhlbSBib3RoIGZpcmluZ1xuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGUgYmVpbmcgc3BsaXRcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIFRoZSBuZXcgbm9kZXMgY3JlYXRlZCBieSB0aGUgc3BsaXRcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ19fc3BsaXROb2RlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfX3NwbGl0Tm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pbk5vZGVQb2xpY3k7XG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBub2RlLmlkO1xuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgLy9pZiBpdCBoYXMgbm8gY2hpbGRyZW4gdG8gc3BsaXQgaW50b1xuICAgICAgICAgICAgICAgIGlmIChjaGlsZHJlbl9zdHJ1Y3RbbmFtZV0gPT09IHVuZGVmaW5lZCB8fCBfLmlzRW1wdHkoY2hpbGRyZW5fc3RydWN0W25hbWVdKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9yZW1vdmluZyB0aGUgbm9kZSBmcm9tIHRoZSBsaXN0IG9mIG5vZGVzXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzID0gXy5maWx0ZXIodGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbiAoZ3JhcGhOb2Rlcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ3JhcGhOb2RlcyAhPSBub2RlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXNHcmFwaC5ub2Rlcyk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlKTtcblxuICAgICAgICAgICAgICAgIC8vZ2V0dGluZyBhbGwgdGhlIG5vZGUgaWQncyBmb3IgZmluZGluZyBmbG93XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVfbmFtZXNfc2V0ID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZV9uYW1lc19zZXQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0uaWQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vc2V0IG9mIG5vZGVzIGFmdGVyIHRoZSBzcGxpdFxuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoaWxkcmVuX3N0cnVjdFtuYW1lXS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBub2RlX25hbWVzX3NldC5wdXNoKGNoaWxkcmVuX3N0cnVjdFtuYW1lXVtpXSk7XG4gICAgICAgICAgICAgICAgICAgIG5ld19ub2Rlcy5wdXNoKGNoaWxkcmVuX3N0cnVjdFtuYW1lXVtpXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciByZXREYXRhID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuZ2V0Rmxvd0JldHdlZW5TZXQobm9kZV9uYW1lc19zZXQpO1xuXG4gICAgICAgICAgICAgICAgLy9mb3JtYXR0aW5nIGRhdGEgZm9yIG5ldyBub2Rlc1xuICAgICAgICAgICAgICAgIHZhciB4TG9jID0gbm9kZS54O1xuICAgICAgICAgICAgICAgIHZhciB5TG9jID0gbm9kZS55O1xuICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnMgPSBub2RlLmFuY2VzdG9ycy5zbGljZSgpO1xuICAgICAgICAgICAgICAgIC8va2VlcGluZyBvcmRlcmluZyB0aGF0IGZpcnN0IGluIGFuY2VzdG9yIGxpc3QgaXMgY2xvc2VzdCBpbiByZWxhdGlvbnNoaXBcbiAgICAgICAgICAgICAgICBhbmNlc3RvcnMuc3BsaWNlKDAsIDAsIG5vZGUuaWQpO1xuICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBub2RlLmlkO1xuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZV9vYmpzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIHJhZGl1cyA9IG5vZGUucmFkaXVzICogdGhpc0dyYXBoLmNvbnN0cy5yYWRpdXNEZWNheTtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZURhdGEgPSByZXREYXRhLm5vZGVEYXRhO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZURhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgLy9jYWxjdWxhdGluZyB3aGljaCBvZiB0aGUgbm9kZXMgaW4gcmV0RGF0YVswXSBhcmUgbmV3XG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXdfbm9kZXMuaW5kZXhPZihub2RlRGF0YVtpXS5pZCkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkID0gbm9kZURhdGFbaV0uaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IG5vZGVEYXRhW2ldLnRleHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGUgPSBuZXcgVmlzdWFsaXplck5vZGUuTm9kZShudWxsLCBudWxsLCBpZCwgdGV4dCwgcmFkaXVzLCBwYXJlbnQsIGFuY2VzdG9ycywgeExvYywgeUxvYyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdfbm9kZS5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMucHVzaChuZXdfbm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdfbm9kZV9vYmpzLnB1c2gobmV3X25vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YShyZXREYXRhLmxpbmtEYXRhLCB0aGlzR3JhcGgubm9kZXMpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0Tm9kZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdExpbmtzKCk7XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS5zcGxpdE5vZGVzLnB1c2gobm9kZS5pZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ld19ub2RlX29ianM7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU3BsaXRzIHRoZSBnaXZlIG5vZGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGUgYmVpbmcgc3BsaXRcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3NwbGl0Tm9kZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3BsaXROb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzID0gdGhpcy5fX3NwbGl0Tm9kZShub2RlKTtcbiAgICAgICAgICAgICAgICBpZiAocmVzID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnNwbGl0Tm9kZUV2ZW50KHJlcyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU3BsaXRzIGFsbCB0aGUgbm9kZXMgcGFzc2VkIGluXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZXMgICBBcnJheSBvZiBub2RlcyB0byBiZSBzcGxpdFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnc3BsaXRNdWx0aXBsZU5vZGVzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzcGxpdE11bHRpcGxlTm9kZXMobm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaDtcbiAgICAgICAgICAgICAgICB2YXIgcmVzTm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSB0aGlzLl9fc3BsaXROb2RlKG5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzTm9kZXMgPSByZXNOb2Rlcy5jb25jYXQocmVzKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLnNwbGl0TXVsdGlwbGVOb2Rlc0V2ZW50KHJlcyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIGFmdGVyIGEgc2luZ2xlIG5vZGUgaXMgc3BsaXRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBuZXdOb2RlcyAgVGhlIG5ldyBub2Rlc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnc3BsaXROb2RlRXZlbnQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNwbGl0Tm9kZUV2ZW50KG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNldFBvc2l0aW9ucygpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBtdWx0aXBsZSBub2RlcyBhcmUgc3BsaXQgYXQgb25jZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5ld05vZGVzICBUaGUgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdzcGxpdE11bHRpcGxlTm9kZXNFdmVudCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3BsaXRNdWx0aXBsZU5vZGVzRXZlbnQobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaDtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc2V0UG9zaXRpb25zKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogdXNlZCB0byBzaGFyZSBjb2RlIGJldHdlZW4gam9pbk5vZGUgYW5kIGpvaW5NdWx0aXBsZU5vZGVcbiAgICAgICAgICAgICAqIHdoaWxlIHByZXZlbnRpbmcgYm90aCBoYW5kbGVycyBmaXJpbmdcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgICAgIG5vZGUgICAgVGhlIG5vZGUgdG8gam9pblxuICAgICAgICAgICAgICogQHJldHVybiAgICAge05vZGV9ICBUaGUgbmV3IG5vZGUgYWZ0ZXIgdGhlIGpvaW5cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ19fam9pbk5vZGUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9fam9pbk5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5Ob2RlUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgLy9jaGVjayB0aGF0IG5vZGUgc3RpbGwgZXhpc3RzXG4gICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG5vZGUpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gbm9kZS5pZDtcbiAgICAgICAgICAgICAgICAvL2lmIGl0IGhhcyBubyBhbmNlc3Rvciwgbm90aGluZyB0byBqb2luXG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbC5pbmRleE9mKG5hbWUpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciB0b19iZV9kZWxldGVkID0gW107XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVfbmFtZXNfc2V0ID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgLy9pZiBub2RlIHdvbid0IGJlIGNvbGxhcHNlZFxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLm5vZGVzW2ldLmFuY2VzdG9ycy5pbmRleE9mKG5vZGUucGFyZW50KSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZV9uYW1lc19zZXQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0uaWQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9fYmVfZGVsZXRlZC5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlX2lkID0gbm9kZS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgbm9kZV9uYW1lc19zZXQucHVzaChub2RlLnBhcmVudCk7XG5cbiAgICAgICAgICAgICAgICAvL2Zvcm1hdHRpbmcgZGF0YVxuICAgICAgICAgICAgICAgIHZhciByYWRpdXMgPSBub2RlLnJhZGl1cyAvIHRoaXNHcmFwaC5jb25zdHMucmFkaXVzRGVjYXk7XG4gICAgICAgICAgICAgICAgdmFyIHhMb2MgPSBub2RlLng7XG4gICAgICAgICAgICAgICAgdmFyIHlMb2MgPSBub2RlLnk7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IG5vZGUuYW5jZXN0b3JzWzFdO1xuICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnMgPSBub2RlLmFuY2VzdG9ycy5zbGljZSgxKTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGUgPSBuZXcgVmlzdWFsaXplck5vZGUuTm9kZSh4TG9jLCB5TG9jLCBuZXdfbm9kZV9pZCwgbmV3X25vZGVfaWQsIHJhZGl1cywgcGFyZW50LCBhbmNlc3RvcnMpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5wdXNoKG5ld19ub2RlKTtcblxuICAgICAgICAgICAgICAgIHZhciByZXREYXRhID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuZ2V0Rmxvd0JldHdlZW5TZXQobm9kZV9uYW1lc19zZXQpO1xuICAgICAgICAgICAgICAgIC8vcmVtb3ZlIGFsbCBub2RlcyB0aGF0IHdpbGwgYmUgam9pbmVkXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b19iZV9kZWxldGVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlX3RvX2RlbGV0ZSA9IHRvX2JlX2RlbGV0ZWRbaV07XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5zcGxpY2UodGhpc0dyYXBoLm5vZGVzLmluZGV4T2Yobm9kZV90b19kZWxldGUpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlX3RvX2RlbGV0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YShyZXREYXRhLmxpbmtEYXRhLCB0aGlzR3JhcGgubm9kZXMpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0Tm9kZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdExpbmtzKCk7XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS5zcGxpdE5vZGVzLnNwbGljZShzdGF0ZS5zcGxpdE5vZGVzLmluZGV4T2YobmV3X25vZGUuaWQpLCAxKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBuZXdfbm9kZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBKb2lucyB0aGUgZ2l2ZW4gbm9kZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZSB0byBqb2luXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdqb2luTm9kZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gam9pbk5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciBuZXdOb2RlID0gdGhpcy5fX2pvaW5Ob2RlKG5vZGUpO1xuICAgICAgICAgICAgICAgIGlmIChuZXdOb2RlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5qb2luTm9kZUV2ZW50KG5ld05vZGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBKb2lucyBhbGwgdGhlIGdpdmVuIG5vZGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZXMgICBUaGUgbm9kZXMgdG8gam9pblxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnam9pbk11bHRpcGxlTm9kZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gam9pbk11bHRpcGxlTm9kZShub2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSB0aGlzLl9fam9pbk5vZGUobm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICBuZXdfbm9kZXMucHVzaChyZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmpvaW5NdWx0aXBsZU5vZGVzRXZlbnQobmV3X25vZGVzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgYWZ0ZXIgYSBzaW5nbGUgbm9kZSBpcyBqb2luZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5ld05vZGUgIFRoZSBuZXcgbm9kZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnam9pbk5vZGVFdmVudCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gam9pbk5vZGVFdmVudChuZXdOb2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIGFmdGVyIG11bHRpcGxlIG5vZGVzIGFyZSBqb2luZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBuZXdOb2RlcyAgVGhlIG5ldyBub2Rlc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnam9pbk11bHRpcGxlTm9kZXNFdmVudCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gam9pbk11bHRpcGxlTm9kZXNFdmVudChuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIFNwbGl0Sm9pbk5vZGVQb2xpY3k7XG4gICAgfShOb2RlU2VsZWN0aW9uUG9saWN5LlBvbGljeSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBQb2xpY3k6IFNwbGl0Sm9pbk5vZGVQb2xpY3lcbiAgICB9O1xufV0pO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAyLzE5LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3MuY3JlYXRlJywge1xuICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtzL25ldHdvcmtjcmVhdGUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTmV0d29ya0NyZWF0ZUN0cmwgYXMgbmV0d29ya0NyZWF0ZUN0cmwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOZXR3b3JrQ3JlYXRlQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdOZXR3b3Jrc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIE5ldHdvcmtzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBuZXR3b3JrQ3JlYXRlQ3RybCA9IHRoaXM7XG4gICAgICAgIG5ldHdvcmtDcmVhdGVDdHJsLmNpZHJQYXR0ZXJuID0gQ29udGl2R2xvYmFscy5DSURSX1JFR0VYO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub05ldHdvcmtzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5uZXR3b3Jrcy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub05ldHdvcmtzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlTmV0d29yaygpIHtcbiAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgaWYgKG5ldHdvcmtDcmVhdGVDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG5ldHdvcmtDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihuZXR3b3JrQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgbmV0d29ya0NyZWF0ZUN0cmwubmV3TmV0d29yay5rZXkgPVxuICAgICAgICAgICAgICAgICAgICBuZXR3b3JrQ3JlYXRlQ3RybC5uZXdOZXR3b3JrLnRlbmFudE5hbWUgKyAnOicgKyBuZXR3b3JrQ3JlYXRlQ3RybC5uZXdOZXR3b3JrLm5ldHdvcmtOYW1lO1xuICAgICAgICAgICAgICAgIE5ldHdvcmtzTW9kZWwuY3JlYXRlKG5ldHdvcmtDcmVhdGVDdHJsLm5ld05ldHdvcmspLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9OZXR3b3JrcygpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobmV0d29ya0NyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IobmV0d29ya0NyZWF0ZUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmVzZXRGb3JtKCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3JrQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IobmV0d29ya0NyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgbmV0d29ya0NyZWF0ZUN0cmwubmV3TmV0d29yayA9IHtcbiAgICAgICAgICAgICAgICBuZXR3b3JrTmFtZTogJycsXG4gICAgICAgICAgICAgICAgZW5jYXA6ICd2eGxhbicsXG4gICAgICAgICAgICAgICAgc3VibmV0OiAnJyxcbiAgICAgICAgICAgICAgICBnYXRld2F5OiAnJyxcbiAgICAgICAgICAgICAgICB0ZW5hbnROYW1lOiAnZGVmYXVsdCcgLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgbmV0d29ya0NyZWF0ZUN0cmwuY3JlYXRlTmV0d29yayA9IGNyZWF0ZU5ldHdvcms7XG4gICAgICAgIG5ldHdvcmtDcmVhdGVDdHJsLmNhbmNlbENyZWF0aW5nID0gY2FuY2VsQ3JlYXRpbmc7XG4gICAgICAgIHJlc2V0Rm9ybSgpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5ldHdvcmtjcmVhdGVjdHJsLmpzLm1hcFxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG52YXIgX2dldCA9IGZ1bmN0aW9uIGdldChvYmplY3QsIHByb3BlcnR5LCByZWNlaXZlcikgeyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7IH0gfSBlbHNlIGlmIChcInZhbHVlXCIgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH07XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuLyoqXG4gKiBUaGlzIHBvbGljeSBpcyB1c2VkIHRvIGNoYW5nZSB0aGUgdmlldyB0byBmb2N1cyBvbiBzcGxpdHRpbmcgYW5kIFxuICogam9pbmluZyBldmVudHMuXG4gKiBPdmVycmlkZXMgdGhlIGNlcnRhaW4gZm9yY2UgbGF5b3V0IGZ1bmN0aW9ucyBvZiB0aGUgZ3JhcGggdG8gcGFydGl0aW9uIGEgc3BsaXRcbiAqIGludG8gdGhlIGZvY3VzZWQgbm9kZXMgYW5kIHRoZSBjb25uZWN0ZWQgbm9kZXMuXG4gKiBcbiAqIEhhcyBzYXZlL2xvYWQgbWV0aG9kcyBmb3IgdGhlIHNhdmUgc3RhdGUgcG9saWN5LlxuICogSGFzIGJhY2sgYnV0dG9uIHN1cHBvcnQuXG4gKiBDYW4gYXV0byBjaGFuZ2UgdGhlIHRpdGxlIG9mIHRoZSBncmFwaC5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ1NwbGl0Sm9pblZpZXdQb2xpY3knLCBbJ1NwbGl0Sm9pbk5vZGVQb2xpY3knLCAnVmlzdWFsaXplck5vZGUnLCBmdW5jdGlvbiAoU3BsaXRKb2luTm9kZVBvbGljeSwgVmlzdWFsaXplck5vZGUpIHtcbiAgICB2YXIgU3BsaXRKb2luVmlld1BvbGljeSA9IGZ1bmN0aW9uIChfU3BsaXRKb2luTm9kZVBvbGljeSQpIHtcbiAgICAgICAgX2luaGVyaXRzKFNwbGl0Sm9pblZpZXdQb2xpY3ksIF9TcGxpdEpvaW5Ob2RlUG9saWN5JCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIFNwbGl0Sm9pblZpZXdQb2xpY3koKSB7XG4gICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU3BsaXRKb2luVmlld1BvbGljeSk7XG5cbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChTcGxpdEpvaW5WaWV3UG9saWN5Ll9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoU3BsaXRKb2luVmlld1BvbGljeSkpLmNhbGwodGhpcykpO1xuXG4gICAgICAgICAgICBfdGhpcy5wb2xpY3lOYW1lID0gXCJTcGxpdEpvaW5WaWV3UG9saWN5XCI7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2FsbGVkIHdoZW4gcG9saWN5IGlzIGluc3RhbGxlZFxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaFxuICAgICAgICAgKi9cblxuXG4gICAgICAgIF9jcmVhdGVDbGFzcyhTcGxpdEpvaW5WaWV3UG9saWN5LCBbe1xuICAgICAgICAgICAga2V5OiAnaW5pdGlhbGl6ZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdGlhbGl6ZShncmFwaCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgX2dldChTcGxpdEpvaW5WaWV3UG9saWN5LnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFNwbGl0Sm9pblZpZXdQb2xpY3kucHJvdG90eXBlKSwgJ2luaXRpYWxpemUnLCB0aGlzKS5jYWxsKHRoaXMsIGdyYXBoKTtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBncmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgc3RhdGUuc2F2ZWRTdGF0ZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAvLyBzdGF0ZS5mb2N1c0dyb3VwID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkgPSBbXTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3VwcyA9IFtdO1xuICAgICAgICAgICAgICAgIHN0YXRlLmZvY2kgPSBbXTtcbiAgICAgICAgICAgICAgICBzdGF0ZS56b29tcyA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLmxheW91dCA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLmxheW91dERlZmF1bHQgPSBudWxsO1xuICAgICAgICAgICAgICAgIHN0YXRlLnpvb21EZWZhdWx0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS5ub2RlSWRzVG9SZXNob3cgPSBudWxsO1xuICAgICAgICAgICAgICAgIHN0YXRlLmJhY2tCdXR0b25FbGVtID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS50aXRsZUVsZW0gPSBudWxsO1xuXG4gICAgICAgICAgICAgICAgdmFyIGNvbnN0cyA9IGdyYXBoLmNvbnN0cy5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgY29uc3RzLmJvdW5kYXJ5ID0gMC44O1xuXG4gICAgICAgICAgICAgICAgLy9vdmVycmlkaW5nIGQzZm9yY2UgbWV0aG9kcyBvZiB0aGUgZ3JhcGguXG4gICAgICAgICAgICAgICAgZ3JhcGguZDNGb3JjZUJvdW5kcyA9IHRoaXMuZDNGb3JjZUJvdW5kcztcbiAgICAgICAgICAgICAgICBncmFwaC5kM0ZvcmNlVGljayA9IHRoaXMuZDNGb3JjZVRpY2s7XG4gICAgICAgICAgICAgICAgZ3JhcGguZDNGb3JjZVN0YXJ0ID0gdGhpcy5kM0ZvcmNlU3RhcnQ7XG4gICAgICAgICAgICAgICAgZ3JhcGguZDNGb3JjZUVuZCA9IHRoaXMuZDNGb3JjZUVuZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBMaW5rcyB0aGUgcHJvdmlkZWQgZWxlbWVudCBhIGJhY2sgYnV0dG9uIGZlYXR1cmVcbiAgICAgICAgICAgICAqIERvZXNuJ3QgdHJpZ2dlciB0aGUgb24tY2xpY2sgZXZlbnRcbiAgICAgICAgICAgICAqIFRoYXQgc2hvdWxkIGJlIGRvbmUgdGhyb3VnaCBhbmd1bGFyIG5nLWNsaWNrLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtqUXVlcnl9ICBlbGVtICAgIFRoZSBqcXVlcnkgc2VsZWN0ZWQgZWxlbWVudFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnaW5zdGFsbEJhY2tCdXR0b24nLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluc3RhbGxCYWNrQnV0dG9uKGVsZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeSA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uRWxlbSA9IGVsZW07XG4gICAgICAgICAgICAgICAgc3RhdGUuYmFja0J1dHRvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnVuZG9MYXN0RXZlbnQuY2FsbCh0aGlzUG9saWN5KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2lsbCBhbGxvdyB0aGlzIHBvbGljeSB0byBjaGFuZ2UgdGhlIHRpdGxlIG9mIHRoZSBncmFwaFxuICAgICAgICAgICAgICogYXMgc3BsaXQgYW5kIGpvaW4gZXZlbnRzIG9jY3VyLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtqUXVlcnl9ICBlbGVtICAgIFRoZSBqcXVlcnkgc2VsZWN0ZWQgZWxlbWVudFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnaW5zdGFsbFRpdGxlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbnN0YWxsVGl0bGUoZWxlbSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgc3RhdGUudGl0bGVFbGVtID0gZWxlbTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgYmVpbmcgZGVzdHJveWVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIHNhdmVkU3RhdGUgIEFueSBwcm9wZXJ0eSBvbiB0aGlzXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0IHdpbGwgYmUgYWNjZXNzaWJsZVxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gdGhlIHZpZXcgcmVsb2Fkc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZGVzdHJveScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveShzYXZlZFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgLy9Pbmx5IGlmIHRoZSBzYXZlIHN0YXRlIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICAgICAgICBpZiAoc2F2ZWRTdGF0ZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2F2ZShzYXZlZFN0YXRlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2lsbCBzYXZlIHRoZSBjdXJyZW50IHN0YXRlLCBhbmQgYWxsIGhpc3RvcnkuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIHNhdmVkU3RhdGUgIEFueSBwcm9wZXJ0eSBvbiB0aGlzXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0IHdpbGwgYmUgYWNjZXNzaWJsZVxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gdGhlIHZpZXcgcmVsb2Fkc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnc2F2ZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2F2ZShzYXZlZFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICAgICAgdmFyIGxpbmtzID0gdGhpc0dyYXBoLmxpbmtzO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyVGl0bGUgPSBudWxsO1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS50aXRsZUVsZW0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBjdXJyVGl0bGUgPSBzdGF0ZS50aXRsZUVsZW0udGV4dCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZm9jdXNHcm91cHMgPSBzdGF0ZS5mb2N1c0dyb3VwcztcbiAgICAgICAgICAgICAgICB2YXIgZXZlbnRIaXN0b3J5ID0gc3RhdGUuZXZlbnRIaXN0b3J5O1xuICAgICAgICAgICAgICAgIHZhciB6b29tcyA9IHN0YXRlLnpvb21zO1xuICAgICAgICAgICAgICAgIHZhciBsYXlvdXQgPSBzdGF0ZS5sYXlvdXQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgbGF5b3V0RGVmYXVsdCA9IHN0YXRlLmxheW91dERlZmF1bHQ7XG4gICAgICAgICAgICAgICAgdmFyIHpvb21EZWZhdWx0ID0gc3RhdGUuem9vbURlZmF1bHQ7XG4gICAgICAgICAgICAgICAgdmFyIHJldCA9IHsgbm9kZXM6IG5vZGVzLCBsaW5rczogbGlua3MsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlczogc3RhdGUuc2F2ZWRTdGF0ZXMsIGN1cnJUaXRsZTogY3VyclRpdGxlLFxuICAgICAgICAgICAgICAgICAgICBmb2N1c0dyb3VwczogZm9jdXNHcm91cHMsXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50SGlzdG9yeTogZXZlbnRIaXN0b3J5LCB6b29tczogem9vbXMsXG4gICAgICAgICAgICAgICAgICAgIGxheW91dDogbGF5b3V0LCBsYXlvdXREZWZhdWx0OiBsYXlvdXREZWZhdWx0LFxuICAgICAgICAgICAgICAgICAgICB6b29tRGVmYXVsdDogem9vbURlZmF1bHQgfTtcbiAgICAgICAgICAgICAgICBzYXZlZFN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3kgPSByZXQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2lsbCBiZSBjYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgcmVsb2FkZWQsIGFzc3VtaW5nXG4gICAgICAgICAgICAgKiBzYXZlIHN0YXRlIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgbG9hZFN0YXRlICBDb250YWlucyBhbGwgdGhlIHNhdmVkXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJpYWJsZXNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2xvYWQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxvYWQobG9hZFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgbG9hZFN0YXRlID0gbG9hZFN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG4gICAgICAgICAgICAgICAgc3RhdGUuc2F2ZWRTdGF0ZXMgPSBsb2FkU3RhdGUuc3RhdGVzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IGxvYWRTdGF0ZS5saW5rcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMgPSBsb2FkU3RhdGUubm9kZXM7XG5cbiAgICAgICAgICAgICAgICB2YXIgY3VyclRpdGxlID0gbG9hZFN0YXRlLmN1cnJUaXRsZTtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUudGl0bGVFbGVtICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUudGl0bGVFbGVtLnRleHQoY3VyclRpdGxlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5ID0gbG9hZFN0YXRlLmV2ZW50SGlzdG9yeTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3VwcyA9IGxvYWRTdGF0ZS5mb2N1c0dyb3VwcztcbiAgICAgICAgICAgICAgICBzdGF0ZS56b29tcyA9IGxvYWRTdGF0ZS56b29tcztcbiAgICAgICAgICAgICAgICBzdGF0ZS5sYXlvdXQgPSBsb2FkU3RhdGUubGF5b3V0O1xuICAgICAgICAgICAgICAgIHN0YXRlLmxheW91dERlZmF1bHQgPSBsb2FkU3RhdGUubGF5b3V0RGVmYXVsdDtcbiAgICAgICAgICAgICAgICBzdGF0ZS56b29tRGVmYXVsdCA9IGxvYWRTdGF0ZS56b29tRGVmYXVsdDtcblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5iYWNrQnV0dG9uRWxlbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuYmFja0J1dHRvbkVsZW0uZmFkZVRvKCdzbG93JywgMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuXG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV0sIGQuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiZm9jdXNcIjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy9sb2FkaW5nIGEgcHJldmlvdXMgbGF5b3V0XG4gICAgICAgICAgICAgICAgdmFyIGxheW91dDtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGxheW91dCA9IHN0YXRlLmxheW91dERlZmF1bHQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciB6b29tID0gc3RhdGUuem9vbURlZmF1bHQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQoem9vbVswXSwgem9vbVsxXSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSBzdGF0ZS56b29tc1tzdGF0ZS5mb2N1c0dyb3Vwc107XG4gICAgICAgICAgICAgICAgICAgIGlmICh6b29tICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQoem9vbVswXSwgem9vbVsxXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ID0gc3RhdGUubGF5b3V0W3N0YXRlLmZvY3VzR3JvdXBzXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL2xheW91dCBjYW4ndCBiZSBudWxsXG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBvcyA9IGxheW91dFtuLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvcyA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhsYXlvdXQsIG4pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG4ueCA9IHBvcy54O1xuICAgICAgICAgICAgICAgICAgICBuLnkgPSBwb3MueTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3RhdGUuaW5pdEZvcmNlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGguY2FsbCh0aGlzR3JhcGgsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51cGRhdGVHcmFwaENhbGxiYWNrLmNhbGwodGhpc1BvbGljeSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVHJpZ2dlcmluZyBzcGxpdCBvbiBkb3VibGUgY2xpY2tcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogRm9jdXMgZ3JvdXAgc3RvcmVzIHRoZSBub2RlIHRoYXQgaXMgYWJvdXQgdG8gYmUgc3BsaXQuXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIFdoZW4gZm9jdXMgZ3JvdXAgaGFzIGxlbmd0aCAwLCB0aGUgZmlyc3Qgc3BsaXQgXG4gICAgICAgICAgICAgKiB3aWxsIGp1c3QgYmUgcHVzaGVkIG9uLlxuICAgICAgICAgICAgICogVGhlIG5vZGUgd2lsbCBiZSBzcGxpdCBhbmQgcHVzaGVkIHRvIHRoZSB0b3AgaGFsZiBcbiAgICAgICAgICAgICAqIG9mIHRoZSBzY3JlZW4sIGFuZCB0aGUgYm90dG9tIGhhbGYgd2lsbCBjb250YWluIGFueVxuICAgICAgICAgICAgICogbm9kZXMgaXQgaGFzIGNvbm5lY3Rpb25zIHRvLlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBXaGVuIGEgZm9jdXMgZ3JvdXAgbGVuZ3RoIGlzID49IDEsIGlmIHRoZSBub2RlIHRvIGJlXG4gICAgICAgICAgICAgKiBzcGxpdCBpcyBhIGZvY3VzIG5vZGUsIGl0IHdpbGwgcmVwbGFjZSBmb2N1c0dyb3Vwc1swXSBhbmRcbiAgICAgICAgICAgICAqIHRoZSB0b3AgaGFsZiB3aWxsIGJlIGl0cyBjaGlsZHJlbiwgYW5kIGJvdHRvbSBoYWxmIHdpbGxcbiAgICAgICAgICAgICAqIGJlIHRoZSBub2RlcyBpdCBoYXMgY29ubmVjdGlvbnMgdG8uXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIElmIHRoZSBzcGxpdCBpcyBpbiB0aGUgYm90dG9tIGhhbGYsIHRoZW4gdGhlIGJvdHRvbSBoYWxmXG4gICAgICAgICAgICAgKiB3aWxsIGRpc3BsYXkgaXQncyBjaGlsZHJlbiBhbmQgd2lsbCBvbmx5IHNob3cgY29ubmVjdGlvbnMgYmV0d2VlblxuICAgICAgICAgICAgICogdGhlIHR3byBncm91cHMsIGFuZCB3aWxsIHJlcGxhY2UgZm9jdXNHcm91cHNbMV0uXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09ian0gICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgZCAgICAgICBUaGUgbWF0Y2hpbmcgZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2RibGNsaWNrJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkYmxjbGljayhkM25vZGUsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIC8vY2hlY2sgaWYgY2FuIHNwbGl0XG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBkLmlkO1xuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkcmVuX3N0cnVjdFtuYW1lXSA9PT0gdW5kZWZpbmVkIHx8IF8uaXNFbXB0eShjaGlsZHJlbl9zdHJ1Y3RbbmFtZV0pKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwcy5zbGljZSgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAvL3RvcGxldmVsIHNwbGl0XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzLnB1c2goZC5pZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChfLmluY2x1ZGVzKGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV0sIGQuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vc3BsaXR0aW5nIGEgZm9jdXMgbm9kZVxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwc1swXSA9IGQuaWQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9zcGxpdHRpbmcgYVxuICAgICAgICAgICAgICAgICAgICAvL2Nvbm5lY3RlZCBub2RlXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzLnB1c2goZC5pZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChfLmluY2x1ZGVzKGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1sxXV0sIGQuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vc3BsaXR0aW5nIGFcbiAgICAgICAgICAgICAgICAgICAgLy9jb25uZWN0ZWQgbm9kZVxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwc1sxXSA9IGQuaWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMiAmJiBzdGF0ZS5mb2N1c0dyb3Vwc1sxXSA9PT0gZC5pZCkge1xuICAgICAgICAgICAgICAgICAgICAvL1NwbGl0dGluZyBhIGNvbm5lY3RlZCBub2RlLCBrZWVwIGFsbCBmb2N1cyBub2Rlc1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZXNUb0tlZXAgPSBbZF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlSWRzVG9SZXNob3cgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdyb3VwT25lTm9kZXMgPSBjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dO1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF8uaW5jbHVkZXMoZ3JvdXBPbmVOb2Rlcywgbm9kZS5pZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzVG9SZXNob3cucHVzaChub2RlLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1RvS2VlcC5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL01ha2Ugc3BsaXQgbm9kZXMgdGhlIGZvY3VzIGFuZCBrZWVwIG5vZGVzIHRoYXQgYXJlIGNvbm5lY3RlZFxuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZXNUb0tlZXAgPSBbZF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlSWRzVG9SZXNob3cgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5saW5rcywgZnVuY3Rpb24gKGxpbmspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaW5rLnNvdXJjZSA9PT0gZCAmJiBub2RlSWRzVG9SZXNob3cuaW5kZXhPZihsaW5rLnRhcmdldC5pZCkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rLnRhcmdldC5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluay50YXJnZXQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzVG9SZXNob3cucHVzaChsaW5rLnRhcmdldC5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNUb0tlZXAucHVzaChsaW5rLnRhcmdldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxpbmsudGFyZ2V0ID09PSBkICYmIG5vZGVJZHNUb1Jlc2hvdy5pbmRleE9mKGxpbmsuc291cmNlLmlkKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsuc291cmNlLlNwbGl0Sm9pblZpZXdQb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rLnNvdXJjZS5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImNvbm5lY3RlZFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHNUb1Jlc2hvdy5wdXNoKGxpbmsuc291cmNlLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1RvS2VlcC5wdXNoKGxpbmsuc291cmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9SZW1vdmluZyBsaW5rcyBmcm9tIHRoZSBub2RlIHRvIGJlIHNwbGl0XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZWFjaChmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5pZCAhPT0gZC5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuXG4gICAgICAgICAgICAgICAgLy9kaXNhYmxpbmcgdXBkYXRlIGdyYXBoIHRvIHByZXZlbnQgbmV3IGRhdGEgZnJvbVxuICAgICAgICAgICAgICAgIC8vcmVkcmF3aW5nIGxpbmtzIHdoaWxlIHRoZXJlIGFyZSBhbmltYXRpb25zIGdvaW5nIG9uXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN0YXRlLmRpc2FibGVVcGRhdGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2goZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuaWQgIT09IGQuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS50cmFuc2l0aW9uKCkuZGVsYXkoMjAwKS5kdXJhdGlvbig0MDApLnN0eWxlKFwib3BhY2l0eVwiLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vZGlzYWJsaW5nIHF0aXAgaWYgaW5zdGFsbGVkXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJCh0aGlzKS5xdGlwICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnF0aXAoJ2Rpc2FibGUnLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIHRyYW5zbGF0ZSA9IHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpO1xuICAgICAgICAgICAgICAgIHZhciBzY2FsZSA9IHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCk7XG4gICAgICAgICAgICAgICAgdmFyIHhMb2MgPSBwYXJzZUZsb2F0KHRoaXNHcmFwaC5zdmcuc3R5bGUoXCJ3aWR0aFwiKSkgLyBzY2FsZSAvIDIgKyB0cmFuc2xhdGVbMF07XG4gICAgICAgICAgICAgICAgdmFyIHlMb2MgPSBwYXJzZUZsb2F0KHRoaXNHcmFwaC5zdmcuc3R5bGUoXCJoZWlnaHRcIikpIC8gc2NhbGUgLyAyICsgdHJhbnNsYXRlWzFdO1xuICAgICAgICAgICAgICAgIGQueFN0YXJ0ID0gZC54O1xuICAgICAgICAgICAgICAgIGQueVN0YXJ0ID0gZC55O1xuICAgICAgICAgICAgICAgIGQueCA9IHhMb2M7XG4gICAgICAgICAgICAgICAgZC55ID0geUxvYztcbiAgICAgICAgICAgICAgICBkM25vZGUudHJhbnNpdGlvbihcIm5vZGVQb3NpdGlvblRyYW5zaXRpb25cIikuZHVyYXRpb24oNzUwKS5hdHRyVHdlZW4oXCJ0cmFuc2Zvcm1cIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHhTdGFydCA9IGQueFN0YXJ0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgeVN0YXJ0ID0gZC55U3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgIGQueFN0YXJ0ID0gZC54O1xuICAgICAgICAgICAgICAgICAgICBkLnlTdGFydCA9IGQueTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQzLmludGVycG9sYXRlU3RyaW5nKFwidHJhbnNsYXRlKFwiICsgeFN0YXJ0ICsgXCIsXCIgKyB5U3RhcnQgKyBcIilcIiwgXCJ0cmFuc2xhdGUoXCIgKyBkLnggKyBcIixcIiArIGQueSArIFwiKVwiKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHZhciBzcGxpdE5vZGVGdW5jID0gX2dldChTcGxpdEpvaW5WaWV3UG9saWN5LnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFNwbGl0Sm9pblZpZXdQb2xpY3kucHJvdG90eXBlKSwgJ3NwbGl0Tm9kZScsIHRoaXMpO1xuICAgICAgICAgICAgICAgIHN0YXRlLm5vZGVJZHNUb1Jlc2hvdyA9IG5vZGVJZHNUb1Jlc2hvdztcbiAgICAgICAgICAgICAgICAvL3dhaXRpbmcgZm9yIG5vZGUgdHJhbnNpdGlvblxuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzID0gbm9kZXNUb0tlZXA7XG4gICAgICAgICAgICAgICAgICAgIHNwbGl0Tm9kZUZ1bmMuY2FsbCh0aGlzUG9saWN5LCBkKTtcbiAgICAgICAgICAgICAgICB9LCA3NTApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRvIGJlIGNhbGxlZCBhZnRlciB0aGUgZ3JhcGggaXMgc3BsaXQuXG4gICAgICAgICAgICAgKiBCcmluZ3MgYWxsIG5vZGVzIGJhY2sgaW50byB2aWV3IGFuZCBzZXRzIHRoZWlyIGF0dHJpYnV0ZXNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3VwZGF0ZUdyYXBoQ2FsbGJhY2snLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUdyYXBoQ2FsbGJhY2soKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5lYWNoKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS50cmFuc2l0aW9uKCkuZHVyYXRpb24oNDAwKS5zdHlsZShcIm9wYWNpdHlcIiwgMSk7XG4gICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5jbGFzc2VkKFwiZm9jdXNcIiwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykuY2xhc3NlZChcImNvbm5lY3RlZFwiLCBmYWxzZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuU3BsaXRKb2luVmlld1BvbGljeSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPT09IFwiZm9jdXNcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5jbGFzc2VkKFwiZm9jdXNcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vZGUuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID09PSBcImNvbm5lY3RlZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLmNsYXNzZWQoXCJjb25uZWN0ZWRcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHN0YXRlLm5vZGVJZHNUb1Jlc2hvdyA9IG51bGw7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSYW5kb21seSBzZXRzIHRoZSBwb3NpdGlvbnMgb2YgYW55IHVuc2V0IG5vZGVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3NldFBvc2l0aW9ucycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0UG9zaXRpb25zKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5ID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGhDb25zdHMgPSB0aGlzR3JhcGguY29uc3RzO1xuXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IGdyYXBoQ29uc3RzLmRpc3BsYXlPZmZzZXQ7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgICAgIHZhciByZXQgPSB0aGlzUG9saWN5LmQzRm9yY2VCb3VuZHMuY2FsbCh0aGlzR3JhcGgpO1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0UmFuZG9tSW50KG1pbiwgbWF4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluICsgMSkpICsgbWluO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIF8uZm9yRWFjaChub2RlcywgZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUueCA9PSBudWxsIHx8IG5vZGUueSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IGdldFJhbmRvbUludChub2RlLnJhZGl1cyArIG9mZnNldCwgcmV0LndpZHRoIC0gbm9kZS5yYWRpdXMgLSBvZmZzZXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHkgPSBnZXRSYW5kb21JbnQobm9kZS5yYWRpdXMgKyBvZmZzZXQsIHJldC5oZWlnaHQgLSBub2RlLnJhZGl1cyAtIG9mZnNldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLnggPSB4O1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS55ID0geTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBvbiB0aGUgc3RhcnQgb2YgdGhlIGQzIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqIFdpbGwgb3ZlcnJpZGUgdGhlIG1ldGhvZCBvZiB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqIFwidGhpc1wiIHBvaW50cyB0byB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2QzRm9yY2VTdGFydCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZDNGb3JjZVN0YXJ0KCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmF0dHIoJ2N4JywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQueFN0YXJ0ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQueFN0YXJ0ID0gZC54U3RhcnQgKiB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpICsgdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKClbMF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCdjeScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLnlTdGFydCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLnlTdGFydCA9IGQueVN0YXJ0ICogdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKSArIHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpWzFdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHMuYXR0cigneDEnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5zb3VyY2UueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd5MScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnNvdXJjZS55O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3gyJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQudGFyZ2V0Lng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneTInLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC50YXJnZXQueTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgb24gdGhlIHN0YXJ0IG9mIHRoZSBkMyBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKiBXaWxsIG92ZXJyaWRlIHRoZSBtZXRob2Qgb2YgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKiBcInRoaXNcIiBwb2ludHMgdG8gdGhlIGdyYXBoXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkM0ZvcmNlRW5kJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkM0ZvcmNlRW5kKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kgPSBzdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZVBvbGljeS5sYXlvdXREZWZhdWx0ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZmF1bHRMYXlvdXQgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRMYXlvdXRbbi5pZF0gPSB7IHg6IG4ueCwgeTogbi55IH07XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZVBvbGljeS5sYXlvdXREZWZhdWx0ID0gZGVmYXVsdExheW91dDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zbGF0ZSA9IHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZVBvbGljeS56b29tRGVmYXVsdCA9IFt0cmFuc2xhdGUsIHNjYWxlXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5hdHRyKCdjeCcsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cignY3knLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55O1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzLmF0dHIoJ3gxJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuc291cmNlLng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneTEnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5zb3VyY2UueTtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd4MicsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnRhcmdldC54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3kyJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQudGFyZ2V0Lnk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2lsbCBiZSBjYWxsZWQgZHVyaW5nIEQzIGZvcmNlIHNpbXVsYXRpb25zXG4gICAgICAgICAgICAgKiBieSB0aGUgZ3JhcGgsIHNvIFwidGhpc1wiIHdpbGwgcG9pbnQgdG8gdGhlIGdyYXBoIG9iamVjdFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB3aWR0aCAgIEQzIExheW91dCBXaWR0aFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge251bWJlcn0gIGhlaWdodCAgRDMgTGF5b3V0IEhlaWdodFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZDNGb3JjZVRpY2snLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGQzRm9yY2VUaWNrKGUsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5ID0gc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSBjb25zdHMuZGlzcGxheU9mZnNldDtcbiAgICAgICAgICAgICAgICB2YXIgc2NhbGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpO1xuXG4gICAgICAgICAgICAgICAgLy8gTW92ZSBub2RlcyB0b3dhcmQgY2x1c3RlciBmb2N1cy5cbiAgICAgICAgICAgICAgICB2YXIgZm9jaSA9IHN0YXRlUG9saWN5LmZvY2k7XG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ3Jhdml0eShhbHBoYSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb2NpLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9PT0gXCJmb2N1c1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSArPSAoZm9jaVswXSAtIGQueSkgKiBhbHBoYTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gKGZvY2lbMV0gLSBkLnkpICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCArPSAod2lkdGggLyAyIC0gZC54KSAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gKGhlaWdodCAvIDIgLSBkLnkpICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC54ICs9ICh3aWR0aCAvIDIgLSBkLngpICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gTWFrZSBzdXJlIG5vZGVzIGFyZSB3aXRoaW4gYm91bmRzXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZWFjaCh0aGlzLmQzRm9yY2VDb2xsaWRlKC41KSkuZWFjaChncmF2aXR5KC4yICogZS5hbHBoYSkpLmF0dHIoXCJjeFwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC54ID0gTWF0aC5tYXgoKGQucmFkaXVzICsgb2Zmc2V0KSAvIHNjYWxlLCBNYXRoLm1pbih3aWR0aCArICgtb2Zmc2V0IC0gZC5yYWRpdXMpIC8gc2NhbGUsIGQueCkpO1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoXCJjeVwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5TcGxpdEpvaW5WaWV3UG9saWN5ID09IG51bGwgfHwgZC5TcGxpdEpvaW5WaWV3UG9saWN5ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQueSA9IE1hdGgubWF4KChkLnJhZGl1cyArIG9mZnNldCkgLyBzY2FsZSwgTWF0aC5taW4oaGVpZ2h0ICsgKC1vZmZzZXQgLSBkLnJhZGl1cykgLyBzY2FsZSwgZC55KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID09PSBcImZvY3VzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQueSA9IE1hdGgubWF4KGQucmFkaXVzICsgb2Zmc2V0LCBNYXRoLm1pbigoaGVpZ2h0ICsgKC1vZmZzZXQgLSBkLnJhZGl1cykgLyBzY2FsZSkgKiBjb25zdHMuU3BsaXRKb2luVmlld1BvbGljeS5ib3VuZGFyeSwgZC55KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID09PSBcImNvbm5lY3RlZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLnkgPSBNYXRoLm1heCgoaGVpZ2h0ICsgKG9mZnNldCAtIGQucmFkaXVzKSAvIHNjYWxlKSAqIGNvbnN0cy5TcGxpdEpvaW5WaWV3UG9saWN5LmJvdW5kYXJ5LCBNYXRoLm1pbihoZWlnaHQgKyAoLW9mZnNldCAtIGQucmFkaXVzKSAvIHNjYWxlLCBkLnkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocy5hdHRyKCd4MScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnNvdXJjZS54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3kxJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuc291cmNlLnk7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneDInLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC50YXJnZXQueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd5MicsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnRhcmdldC55O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGN1bGF0ZXMgdGhlIGJvdW5kYXJpZXMgb2YgdGhlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogV2lsbCBiZSBjYWxsZWQgZHVyaW5nIEQzIGZvcmNlIHNpbXVsYXRpb25zXG4gICAgICAgICAgICAgKiBieSB0aGUgZ3JhcGgsIHNvIFwidGhpc1wiIHdpbGwgcG9pbnQgdG8gdGhlIGdyYXBoIG9iamVjdFxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7T2JqZWN0fSAgICAgICAgICBSZXR1cm5zIGFuIG9iamVjdFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdCBoYXMgdGhlIHdpZHRoXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmQgaGVpZ2h0IGFzIFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllcyBcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2QzRm9yY2VCb3VuZHMnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGQzRm9yY2VCb3VuZHMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzLFxuICAgICAgICAgICAgICAgICAgICBjb25zdHNQb2xpY3kgPSBjb25zdHMuU3BsaXRKb2luVmlld1BvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kgPSBzdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXNHcmFwaC5ub2RlcztcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjYWxjTWF4Tm9kZXMod2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYXJlYSA9IHdpZHRoICogaGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmFkaXVzID0gdGhpc0dyYXBoLmNvbnN0cy5zdGFydFJhZGl1cztcbiAgICAgICAgICAgICAgICAgICAgLy90cmVhdGluZyB0aGVtIGFzIGEgc3F1YXJlIGZvciBhcHByb3hcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxlbmd0aCA9IHJhZGl1cyAqIDMuNTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFtb3VudCA9IGFyZWEgLyAobGVuZ3RoICogbGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFtb3VudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9UaGUgb2Zmc2V0IGlzIHRoZSBidWZmZXIgZnJvbSB0aGUgZWRnZXNcbiAgICAgICAgICAgICAgICAvL09yaWdpbmFsIFdpZHRoIGFuZCBIZWlnaHQgYXJlIGdpdmVuIHRvIHRoZSBmb3JjZSBsYXlvdXRcbiAgICAgICAgICAgICAgICAvL3NvIHRoYXQgaXQgaXMgY2VudGVyZWQsIGJ1dCBub2RlcyB3aWxsIGJlIGZvcmNlZCB0byBiZVxuICAgICAgICAgICAgICAgIC8vd2l0aGluIHRoZSBvZmZzZXQgYm91bmRzXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IGNvbnN0cy5kaXNwbGF5T2Zmc2V0O1xuICAgICAgICAgICAgICAgIHZhciBzdmdXaWR0aCA9IHBhcnNlRmxvYXQodGhpc0dyYXBoLnN2Zy5zdHlsZShcIndpZHRoXCIpKTtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnSGVpZ2h0ID0gcGFyc2VGbG9hdCh0aGlzR3JhcGguc3ZnLnN0eWxlKFwiaGVpZ2h0XCIpKTtcblxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IHN2Z1dpZHRoO1xuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBzdmdIZWlnaHQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgYW1vdW50ID0gY2FsY01heE5vZGVzKHdpZHRoIC0gMiAqIG9mZnNldCwgaGVpZ2h0IC0gMiAqIG9mZnNldCk7XG4gICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gMTtcbiAgICAgICAgICAgICAgICBpZiAobm9kZXMubGVuZ3RoID4gYW1vdW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHNjYWxlID0gYW1vdW50IC8gbm9kZXMubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguem9vbWVkKHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpLCBzY2FsZSk7XG4gICAgICAgICAgICAgICAgICAgIHdpZHRoIC89IHNjYWxlO1xuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgLz0gc2NhbGU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKSwgc2NhbGUpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vY2FsY3VsYXRpbmcgZm9jaSBmb3Igc2ltdWxhdGlvblxuICAgICAgICAgICAgICAgIHZhciBmb2N1c0dyb3VwcyA9IHN0YXRlUG9saWN5LmZvY3VzR3JvdXBzO1xuICAgICAgICAgICAgICAgIHZhciBmb2NpO1xuICAgICAgICAgICAgICAgIGlmIChmb2N1c0dyb3Vwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZm9jaSA9IFtoZWlnaHQgLyAyXTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL3NldHRpbmcgZm9jaSBoZWlnaHQgcG9zaXRpb24gYmFzZWQgb24gcGVyY2VudGFnZVxuICAgICAgICAgICAgICAgICAgICB2YXIgZm9jdXNOb2RlcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFtmb2N1c0dyb3Vwc1swXV07XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0c1BvbGljeS5ib3VuZGFyeSA9IGZvY3VzTm9kZXMubGVuZ3RoIC8gbm9kZXMubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdG9wID0gaGVpZ2h0ICogY29uc3RzUG9saWN5LmJvdW5kYXJ5O1xuICAgICAgICAgICAgICAgICAgICB2YXIgYm90ID0gaGVpZ2h0IC0gdG9wO1xuICAgICAgICAgICAgICAgICAgICBpZiAodG9wIDwgMiAqIHRoaXNHcmFwaC5jb25zdHMubWF4UmFkaXVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdHNQb2xpY3kuYm91bmRhcnkgPSAyLjUgKiB0aGlzR3JhcGguY29uc3RzLm1heFJhZGl1cyAvIGhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvcCA9IGhlaWdodCAqIGNvbnN0c1BvbGljeS5ib3VuZGFyeTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvdCA9IGhlaWdodCAtIHRvcDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoYm90IDwgMiAqIHRoaXNHcmFwaC5jb25zdHMubWF4UmFkaXVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdHNQb2xpY3kuYm91bmRhcnkgPSAxIC0gMi41ICogdGhpc0dyYXBoLmNvbnN0cy5tYXhSYWRpdXMgLyBoZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3AgPSBoZWlnaHQgKiBjb25zdHNQb2xpY3kuYm91bmRhcnk7XG4gICAgICAgICAgICAgICAgICAgICAgICBib3QgPSBoZWlnaHQgLSB0b3A7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZm9jaSA9IFt0b3AgLyAyLCB0b3AgKyBib3QgLyAyXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kuZm9jaSA9IGZvY2k7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgd2lkdGg6IHdpZHRoLCBoZWlnaHQ6IGhlaWdodCB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBhIHNpbmdsZSBub2RlIGlzIHNwbGl0XG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5ld05vZGVzICBUaGUgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdzcGxpdE5vZGVFdmVudCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3BsaXROb2RlRXZlbnQobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaChuZXdOb2RlcywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV0sIGQuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiZm9jdXNcIjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIHRpdGxlID0gbmV3Tm9kZXNbMF0ucGFyZW50O1xuICAgICAgICAgICAgICAgIC8vIHN0YXRlLmZvY3VzR3JvdXAgPSB0aXRsZTtcblxuICAgICAgICAgICAgICAgIC8vaWYgdGhlIGxhc3QgZXZlbnQgaGFzIHRoZSBzYW1lIGlkLCBpdCBtdXN0IGJlIHRoZVxuICAgICAgICAgICAgICAgIC8vb3BwcG9zaXRlIG9mIHRoaXMgZXZlbnQsIHNvIHdlIHJlbW92ZSB0aGF0IGV2ZW50IGZyb21cbiAgICAgICAgICAgICAgICAvL3RoZSBldmVudCBzdGFjay5cbiAgICAgICAgICAgICAgICAvL090aGVyd2lzZSwgd2UgYWRkIHRoZSBldmVudCBvdCB0aGUgc3RhY2tcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCAhPT0gMCAmJiBzdGF0ZS5ldmVudEhpc3Rvcnlbc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCAtIDFdLmlkID09PSB0aXRsZSkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkucG9wKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5LnB1c2goeyBpZDogdGl0bGUsIGV2ZW50OiAnc3BsaXQnIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5iYWNrQnV0dG9uRWxlbSAhPSBudWxsICYmIHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuYmFja0J1dHRvbkVsZW0uZmFkZVRvKCdzbG93JywgMSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLnRpdGxlRWxlbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0gc3RhdGUuZm9jdXNHcm91cHNbMF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSAnICYgJyArIHN0YXRlLmZvY3VzR3JvdXBzWzFdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLnRpdGxlRWxlbS50ZXh0KHRleHQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vcmUtZW5hYmxlIGdyYXBoIHVwZGF0ZVxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZS5kaXNhYmxlVXBkYXRlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpc1BvbGljeS5zZXRMYXlvdXQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTZXRzIHRoZSBsYXlvdXQgb2YgdGhlIG5vZGVzLiBcbiAgICAgICAgICAgICAqIElmIHRoZXJlIGlzIGEgcHJldmlvdXMgbGF5b3V0LCBpdCB3aWxsIGJlIGxvYWRlZC5cbiAgICAgICAgICAgICAqIEVsc2UsIGl0IHdpbGwgcnVuIGEgRDMgRm9yY2Ugc2ltdWxhdGlvbiBhbmQgY3JlYXRlIG9uZS5cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3NldExheW91dCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0TGF5b3V0KCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcbiAgICAgICAgICAgICAgICB2YXIgbGF5b3V0O1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ID0gc3RhdGUubGF5b3V0RGVmYXVsdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSBzdGF0ZS56b29tRGVmYXVsdDtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh6b29tWzBdLCB6b29tWzFdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbSA9IHN0YXRlLnpvb21zW3N0YXRlLmZvY3VzR3JvdXBzXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHpvb20gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh6b29tWzBdLCB6b29tWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBsYXlvdXQgPSBzdGF0ZS5sYXlvdXRbc3RhdGUuZm9jdXNHcm91cHNdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChsYXlvdXQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvcyA9IGxheW91dFtuLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwb3MgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGxheW91dCwgbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBuLnggPSBwb3MueDtcbiAgICAgICAgICAgICAgICAgICAgICAgIG4ueSA9IHBvcy55O1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoLmNhbGwodGhpc0dyYXBoLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnVwZGF0ZUdyYXBoQ2FsbGJhY2suY2FsbCh0aGlzUG9saWN5KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy9OZWVkIHRvIHJ1biBhIGZvcmNlIHNpbXVsYXRpb24gYXMgdGhpcyBsYXlvdXRcbiAgICAgICAgICAgICAgICAgICAgLy9oYXNuJ3QgYmVlbiBkb25lIGJlZm9yZVxuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3RhdGUuaW5pdEZvcmNlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRoaXNQb2xpY3kuc2V0UG9zaXRpb25zKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnVwZGF0ZUdyYXBoQ2FsbGJhY2suY2FsbCh0aGlzUG9saWN5KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLnpvb21zW3N0YXRlLmZvY3VzR3JvdXBzXSA9IFt0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKSwgdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKV07XG4gICAgICAgICAgICAgICAgICAgIHZhciBsYXlvdXQgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dFtuLmlkXSA9IHsgeDogbi54LCB5OiBuLnkgfTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmxheW91dFtzdGF0ZS5mb2N1c0dyb3Vwc10gPSBsYXlvdXQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIE92ZXJyaWRpbmcgZnJvbSBzdXBlciBjbGFzcyBzbyB0aGF0IHdlIGNhbiBoYXZlXG4gICAgICAgICAgICAgKiB0b3AgbGV2ZWwgbm9kZXMgcmVhcHBlYXIgd2hlbiB0aGV5IGFyZSBoaWRkZW5cbiAgICAgICAgICAgICAqIGR1ZSB0byB0aGVyZSBiZWluZyB0d28gZm9jdXMgZ3JvdXBzLlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gICAgICAgICAgbm9kZSAgICBUaGUgbm9kZSB0byBqb2luXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7Tm9kZX0gIFRoZSBuZXcgbm9kZSBhZnRlciB0aGUgam9pblxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnX19qb2luTm9kZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX19qb2luTm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlU3VwZXIgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luTm9kZVBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIC8vY2hlY2sgdGhhdCBub2RlIHN0aWxsIGV4aXN0c1xuICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGgubm9kZXMuaW5kZXhPZihub2RlKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IG5vZGUuaWQ7XG4gICAgICAgICAgICAgICAgLy9pZiBpdCBoYXMgbm8gYW5jZXN0b3IsIG5vdGhpbmcgdG8gam9pblxuICAgICAgICAgICAgICAgIGlmIChjaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwuaW5kZXhPZihuYW1lKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gbm9kZS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgdmFyIHRvX2JlX2RlbGV0ZWQgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZU5hbWVTZXQgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXNHcmFwaC5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIG5vZGUgd29uJ3QgYmUgY29sbGFwc2VkXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGgubm9kZXNbaV0uYW5jZXN0b3JzLmluZGV4T2Yobm9kZS5wYXJlbnQpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlTmFtZVNldC5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXS5pZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b19iZV9kZWxldGVkLnB1c2godGhpc0dyYXBoLm5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGVfaWQgPSBub2RlLnBhcmVudDtcbiAgICAgICAgICAgICAgICBub2RlTmFtZVNldC5wdXNoKG5vZGUucGFyZW50KTtcblxuICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnNfc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuYW5jZXN0b3JzX3N0cnVjdDtcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIC8vIC0gc2V0dGluZyBmb2N1c0dyb3VwcyAtXG4gICAgICAgICAgICAgICAgLy9laXRoZXIgcmVwbGFjaW5nIG9uZSBvZiB0aGUgZ3JvdXBzLFxuICAgICAgICAgICAgICAgIC8vb3Igam9pbmluZyBiYWNrIGludG8gYSB0b3AgbGV2ZWwsIHNvIHRoZXJlIGlzIG9ubHlcbiAgICAgICAgICAgICAgICAvL29uZSBmb2N1c1xuICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IHN0YXRlLmZvY3VzR3JvdXBzLmluZGV4T2YocGFyZW50KTtcbiAgICAgICAgICAgICAgICBpZiAoYW5jZXN0b3JzX3N0cnVjdFtwYXJlbnRdICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHNbaW5kZXhdID0gYW5jZXN0b3JzX3N0cnVjdFtwYXJlbnRdO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9uYW1lVG9BZGQgYXJlIHRvcCBsZXZlbCBub2RlcyB0aGF0IGFyZSB0byBiZSBhZGRlZFxuICAgICAgICAgICAgICAgIC8vdG8gdGhlIGdyYXBoLlxuICAgICAgICAgICAgICAgIHZhciBuYW1lVG9BZGQgPSBbXTtcbiAgICAgICAgICAgICAgICAvL3dpbGwgb25seSBuZWVkIHRvIGFkZCBhIHRvcCBsZXZlbCBub2RlIGlmIHRoZXJlIGlzXG4gICAgICAgICAgICAgICAgLy9vbmx5IG9uZSBmb2N1c1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9BZGQgb25seSB0aG9zdCB0aGF0IGFyZW4ndCBhbiBhbmNlc3RvciBvZiB0aGUgbm9kZVxuICAgICAgICAgICAgICAgICAgICAvL3RvIGpvaW4sIHRoZSBmb2N1cyBncm91cCBvciBhbiBhbmNlc3RvciBvZiBpdCxcbiAgICAgICAgICAgICAgICAgICAgLy9hbmQgYXJlbid0IGFscmVhZHkgaW4gbm9kZU5hbWVTZXQuXG4gICAgICAgICAgICAgICAgICAgIC8vZ2V0IGZsb3cgYmV0d2VlbiB0b3AgbGV2ZWwgYXMgbG9uZyBhc1xuICAgICAgICAgICAgICAgICAgICAvL3RoZSB0b3AgbGV2ZWwgaXNuJ3QgYW4gYW5jZXN0b3Igb2YgdGhlXG4gICAgICAgICAgICAgICAgICAgIC8vZm9jdXMgZ3JvdXAsIGFuZCBpc24ndCBhbHJlYWR5IHBhcnQgb2YgdGhlXG4gICAgICAgICAgICAgICAgICAgIC8vbm9kZSBzZXQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnMgPSBhbmNlc3RvcnNfc3RydWN0W25vZGUuaWRdO1xuICAgICAgICAgICAgICAgICAgICBhbmNlc3RvcnMucHVzaChzdGF0ZS5mb2N1c0dyb3Vwc1swXSk7XG4gICAgICAgICAgICAgICAgICAgIC8vdGhlIG9yIGVtcHR5IGFycmF5IGlzIHRvIHByZXZlbnQgY29uY2F0ZW5hdGluZyBhIG51bGxcbiAgICAgICAgICAgICAgICAgICAgLy9vciB1bmRlZmluZWQgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3JzID0gYW5jZXN0b3JzLmNvbmNhdChhbmNlc3RvcnNfc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzBdXSB8fCBbXSk7XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChjaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW5jZXN0b3JzLmluZGV4T2YobikgPT09IC0xICYmIG5vZGVOYW1lU2V0LmluZGV4T2YobikgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lVG9BZGQucHVzaChuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVOYW1lU2V0ID0gbm9kZU5hbWVTZXQuY29uY2F0KG5hbWVUb0FkZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy9ubyBmb2N1cyBncm91cHMgbWVhbnMgd2UgYXJlIGF0IHRvcCBsZXZlbFxuICAgICAgICAgICAgICAgICAgICAvL1Nob3VsZCBhZGQgYW55IHRvcCBsZXZlbCBub2RlcyB0aGF0IGFyZW4ndFxuICAgICAgICAgICAgICAgICAgICAvL2FscmVhZHkgdGhlcmVcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKGNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbCwgZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlTmFtZVNldC5pbmRleE9mKG4pID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkLnB1c2gobik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBub2RlTmFtZVNldCA9IG5vZGVOYW1lU2V0LmNvbmNhdChuYW1lVG9BZGQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vZm9ybWF0dGluZyBkYXRhXG4gICAgICAgICAgICAgICAgdmFyIHJhZGl1cyA9IG5vZGUucmFkaXVzIC8gdGhpc0dyYXBoLmNvbnN0cy5yYWRpdXNEZWNheTtcbiAgICAgICAgICAgICAgICB2YXIgeExvYyA9IG5vZGUueDtcbiAgICAgICAgICAgICAgICB2YXIgeUxvYyA9IG5vZGUueTtcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gbm9kZS5hbmNlc3RvcnNbMV07XG4gICAgICAgICAgICAgICAgdmFyIGFuY2VzdG9ycyA9IG5vZGUuYW5jZXN0b3JzLnNsaWNlKDEpO1xuICAgICAgICAgICAgICAgIHZhciBuZXdOb2RlID0gbmV3IFZpc3VhbGl6ZXJOb2RlLk5vZGUoeExvYywgeUxvYywgbmV3X25vZGVfaWQsIG5ld19ub2RlX2lkLCByYWRpdXMsIHBhcmVudCwgYW5jZXN0b3JzKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMucHVzaChuZXdOb2RlKTtcblxuICAgICAgICAgICAgICAgIC8vcmVtb3ZlIGFsbCBub2RlcyB0aGF0IHdpbGwgYmUgam9pbmVkXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b19iZV9kZWxldGVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlX3RvX2RlbGV0ZSA9IHRvX2JlX2RlbGV0ZWRbaV07XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5zcGxpY2UodGhpc0dyYXBoLm5vZGVzLmluZGV4T2Yobm9kZV90b19kZWxldGUpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlX3RvX2RlbGV0ZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHJldERhdGEgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5nZXRGbG93QmV0d2VlblNldChub2RlTmFtZVNldCk7XG4gICAgICAgICAgICAgICAgLy9ob2xkcyB0aGUgbm9kZURhdGEgd2hpY2ggd2lsbCBiZSBwcm9jZXNzZWRcbiAgICAgICAgICAgICAgICB2YXIgbm9kZXNUb1Byb2Nlc3MgPSBbXTtcbiAgICAgICAgICAgICAgICAvL2ZpbmRpbmcgdGhlIG5vZGUgZGF0YSB0aGF0IGNvcnJlc3BvbmRzIHRvIHRoZSB0b3AgbGV2ZWxcbiAgICAgICAgICAgICAgICAvL25vZGVzIHRvIGFkZCAtIG5hbWVUb0FkZC5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZURhdGEgPSByZXREYXRhLm5vZGVEYXRhO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZURhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWVUb0FkZC5pbmRleE9mKG5vZGVEYXRhW2ldLmlkKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzVG9Qcm9jZXNzLnB1c2gobm9kZURhdGFbaV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9UaGUgdG9wIGxldmVsIG5vZGVzIHRoYXQgYXJlIGFkZGVkXG4gICAgICAgICAgICAgICAgdmFyIG5ld05vZGVzID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UucHJvY2Vzc05vZGVEYXRhKG5vZGVzVG9Qcm9jZXNzKTtcbiAgICAgICAgICAgICAgICBfLmZvckVhY2gobmV3Tm9kZXMsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgICAgIG4ucmFkaXVzID0gbi5yYWRpdXMgfHwgdGhpc0dyYXBoLmNvbnN0cy5zdGFydFJhZGl1cztcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMgPSB0aGlzR3JhcGgubm9kZXMuY29uY2F0KG5ld05vZGVzKTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YShyZXREYXRhLmxpbmtEYXRhLCB0aGlzR3JhcGgubm9kZXMpO1xuICAgICAgICAgICAgICAgIC8vT25seSBrZWVwIHRvcCBsZXZlbCBub2RlcyB0aGF0IGhhdmUgY29ubmVjdGlvbnMgdG9cbiAgICAgICAgICAgICAgICAvL3RoZSBjdXJyZW50IGZvY3VzIGdyb3VwXG4gICAgICAgICAgICAgICAgLy93ZSByZW1vdmUgdGhlIG5vZGUgbmFtZSBmcm9tIG5hbWVUb0FkZCBpZiB3ZSBhcmVcbiAgICAgICAgICAgICAgICAvL2tlZXBpbmcgaXRcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubGlua3MsIGZ1bmN0aW9uIChsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2NoZWNraW5nIGlmIHRoZXJlIGV4aXN0cyBhIGxpbmsgdG91Y2hpbmcgZWFjaCBvZiBuYW1lVG9BZGRcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuYW1lVG9BZGQuaW5kZXhPZihsLnNvdXJjZS5pZCkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzWzBdID09PSBsLnRhcmdldC5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkLnNwbGljZShuYW1lVG9BZGQuaW5kZXhPZihsLnNvdXJjZS5pZCksIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobmFtZVRvQWRkLmluZGV4T2YobC50YXJnZXQuaWQpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwc1swXSA9PT0gbC5zb3VyY2UucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVUb0FkZC5zcGxpY2UobmFtZVRvQWRkLmluZGV4T2YobC50YXJnZXQuaWQpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vV2Ugd2FudCB0byBrZWVwIHRoZW0gYWxsXG4gICAgICAgICAgICAgICAgICAgIC8vc2luY2UgYW55IGxlZnQgaW4gbmFtZVRvQWRkIHdpbGwgYmUgcmVtb3ZlZCxcbiAgICAgICAgICAgICAgICAgICAgLy93ZSByZXNldCBuYW1lVG9BZGQgaGVyZS5cbiAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkID0gW107XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy93aGF0ZXZlciBpcyByZW1haW5pbmcgaW4gbmFtZVRvQWRkIGlzbid0IGNvbm5lY3RlZFxuICAgICAgICAgICAgICAgIC8vdG8gdGhlIGZvY3VzIGdyb3VwLCBzbyB3ZSBzaG91bGQgcmVtb3ZlIGl0LlxuICAgICAgICAgICAgICAgIHZhciBub2RlVG9SZW1vdmUgPSBbXTtcbiAgICAgICAgICAgICAgICBpZiAobmFtZVRvQWRkLmxlbmd0aCAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXNHcmFwaC5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWVUb0FkZC5pbmRleE9mKHRoaXNHcmFwaC5ub2Rlc1tpXS5pZCkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkLnNwbGljZShuYW1lVG9BZGQuaW5kZXhPZih0aGlzR3JhcGgubm9kZXNbaV0uaWQpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3BsaWNlTGlua3NGb3JOb2RlKHRoaXNHcmFwaC5ub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZVRvUmVtb3ZlLnB1c2godGhpc0dyYXBoLm5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobmFtZVRvQWRkLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKG5vZGVUb1JlbW92ZSwgZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnNwbGljZSh0aGlzR3JhcGgubm9kZXMuaW5kZXhPZihuKSwgMSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXRMaW5rcygpO1xuXG4gICAgICAgICAgICAgICAgc3RhdGVTdXBlci5zcGxpdE5vZGVzLnNwbGljZShzdGF0ZVN1cGVyLnNwbGl0Tm9kZXMuaW5kZXhPZihuZXdOb2RlLmlkKSwgMSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3Tm9kZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgYWZ0ZXIgYSBzaW5nbGUgbm9kZSBpcyBqb2luZWRcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogSWYgdGhlIGZvY3VzIGdyb3VwIGhhcyBiZWVuIHNlZW4gYmVmb3JlLCBpdCB3aWxsXG4gICAgICAgICAgICAgKiBsb2FkIHRoYXQgbGF5b3V0LiBPdGhlcndpc2UsIGl0IHdpbGwgcnVuIGEgZDMgZm9yY2VcbiAgICAgICAgICAgICAqIHNpbXVsYXRpb24gdG8gZ2VuZXJhdGUgb25lLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbmV3Tm9kZSAgVGhlIG5ldyBub2RlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdqb2luTm9kZUV2ZW50JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBqb2luTm9kZUV2ZW50KG5ld05vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeSA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICAvL2lmIHRoZSBsYXN0IGV2ZW50IGhhcyB0aGUgc2FtZSBpZCwgaXQgbXVzdCBiZSB0aGVcbiAgICAgICAgICAgICAgICAvL29wcHBvc2l0ZSBvZiB0aGlzIGV2ZW50LCBzbyB3ZSByZW1vdmUgdGhhdCBldmVudCBmcm9tXG4gICAgICAgICAgICAgICAgLy90aGUgZXZlbnQgc3RhY2suXG4gICAgICAgICAgICAgICAgLy9PdGhlcndpc2UsIHdlIGFkZCB0aGUgZXZlbnQgdG8gdGhlIHN0YWNrXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggIT09IDAgJiYgc3RhdGUuZXZlbnRIaXN0b3J5W3N0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggLSAxXS5pZCA9PT0gbmV3Tm9kZS5pZCkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkucG9wKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5LnB1c2goeyBpZDogbmV3Tm9kZS5pZCwgZXZlbnQ6ICdqb2luJyB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuXG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV0sIGQuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiZm9jdXNcIjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy9zZXR0aW5nIGJhY2sgYnV0dG9uXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmJhY2tCdXR0b25FbGVtICE9IG51bGwgJiYgc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uRWxlbS5mYWRlVG8oJ3Nsb3cnLCAwKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3NldHRpbmcgdGl0bGVcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUudGl0bGVFbGVtICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSBzdGF0ZS5mb2N1c0dyb3Vwc1swXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ICs9ICcgJiAnICsgc3RhdGUuZm9jdXNHcm91cHNbMV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc3RhdGUudGl0bGVFbGVtLnRleHQodGV4dCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kuc2V0TGF5b3V0KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVW5kb2VzIHRoZSBsYXN0IHNwbGl0IG9yIGpvaW4gZXZlbnQuXG4gICAgICAgICAgICAgKiBNZWFudCB0byBiZSBjYWxsZWQgYnkgdGhlIGJhY2sgYnV0dG9uLlxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAndW5kb0xhc3RFdmVudCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdW5kb0xhc3RFdmVudCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeSA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB2YXIgbGFzdCA9IHN0YXRlLmV2ZW50SGlzdG9yeVtzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgdmFyIGlkID0gbGFzdC5pZDtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZTtcbiAgICAgICAgICAgICAgICBpZiAobGFzdC5ldmVudCA9PT0gJ2pvaW4nKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUgPSB0aGlzR3JhcGguZmluZE5vZGVCeUlkKGlkKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQzbm9kZSA9IHRoaXNHcmFwaC5maW5kRDNOb2RlKGlkKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS5kYmxjbGljayhkM25vZGUsIG5vZGUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlSWQgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbaWRdWzBdO1xuICAgICAgICAgICAgICAgICAgICBub2RlID0gdGhpc0dyYXBoLmZpbmROb2RlQnlJZChub2RlSWQpO1xuICAgICAgICAgICAgICAgICAgICBfZ2V0KFNwbGl0Sm9pblZpZXdQb2xpY3kucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoU3BsaXRKb2luVmlld1BvbGljeS5wcm90b3R5cGUpLCAnam9pbk5vZGUnLCB0aGlzKS5jYWxsKHRoaXNQb2xpY3ksIG5vZGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfV0pO1xuXG4gICAgICAgIHJldHVybiBTcGxpdEpvaW5WaWV3UG9saWN5O1xuICAgIH0oU3BsaXRKb2luTm9kZVBvbGljeS5Qb2xpY3kpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgUG9saWN5OiBTcGxpdEpvaW5WaWV3UG9saWN5XG4gICAgfTtcbn1dKTtcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5mYWN0b3J5KCdCZ3BTZXJ2aWNlJywgWyckaHR0cCcsICckcScsIGZ1bmN0aW9uICgkaHR0cCwgJHEpIHtcbiAgICAgICAgZnVuY3Rpb24gZ2V0QmdwKGN0cmwpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5CR1BTX0VORFBPSU5UICsgY3RybC5rZXkgKyAnLyc7XG4gICAgICAgICAgICAkaHR0cC5nZXQodXJsKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICBjdHJsLm5laWdoYm9yID0gcmVzdWx0LmRhdGE7XG4gICAgICAgICAgICAgICAgY3RybC5uZWlnaGJvcnMucHVzaCh7ICduYW1lJzogY3RybC5uZWlnaGJvclsnbmVpZ2hib3InXSwgJ3ZhbHVlJzogY3RybC5uZWlnaGJvclsnbmVpZ2hib3ItYXMnXSB9KTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlQmdwKGN0cmwpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLkJHUFNfRU5EUE9JTlQgKyBjdHJsLmtleSArICcvJztcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KHVybCwgY3RybC5uZWlnaGJvcik7XG4gICAgICAgIH1cbiAgICAgICAgO1xuICAgICAgICBmdW5jdGlvbiBnZXRCZ3BJbnNwZWN0KGtleSkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLkJHUFNfSU5TUEVDVF9FTkRQT0lOVCArIGtleSArICcvJztcbiAgICAgICAgICAgICRodHRwLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0QmdwOiBnZXRCZ3AsXG4gICAgICAgICAgICB1cGRhdGVCZ3A6IHVwZGF0ZUJncCxcbiAgICAgICAgICAgIGdldEJncEluc3BlY3Q6IGdldEJncEluc3BlY3RcbiAgICAgICAgfTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1iZ3BzZXJ2aWNlLmpzLm1hcFxuYW5ndWxhci5tb2R1bGUoXCJjb250aXYubm9kZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2TG9nc1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9sb2dzLmh0bWwnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgbG9nOiBcIj1cIixcbiAgICAgICAgICAgIHRpdGxlOiBcIkBcIlxuICAgICAgICB9XG4gICAgfTtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bG9nc2RpcmVjdGl2ZS5qcy5tYXBcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5mYWN0b3J5KCdMb2dTZXJ2aWNlJywgWyckaHR0cCcsICckcScsIGZ1bmN0aW9uICgkaHR0cCwgJHEpIHtcbiAgICAgICAgZnVuY3Rpb24gZ2V0QWN0aXZlTG9ncygpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5OT0RFU19BQ1RJVkVfSk9CX0VORFBPSU5UO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdldExhc3RMb2dzKCkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLk5PREVTX0xBU1RfSk9CX0VORFBPSU5UO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRBY3RpdmVMb2dzOiBnZXRBY3RpdmVMb2dzLFxuICAgICAgICAgICAgZ2V0TGFzdExvZ3M6IGdldExhc3RMb2dzXG4gICAgICAgIH07XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bG9nc2VydmljZS5qcy5tYXBcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5hY3RpdmVsb2cnLCB7XG4gICAgICAgICAgICB1cmw6ICcvYWN0aXZlbG9nJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlQWN0aXZlSm9iTG9nc0N0cmwgYXMgbm9kZUFjdGl2ZUpvYkxvZ3NDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGN0di1sb2dzIHRpdGxlPVwiQWN0aXZlIEpvYlwiIGxvZz1cIm5vZGVBY3RpdmVKb2JMb2dzQ3RybC5hY3RpdmVMb2dzXCI+PC9jdHYtbG9ncz4nXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOb2RlQWN0aXZlSm9iTG9nc0N0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnTG9nU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzY29wZSwgJGludGVydmFsLCBMb2dTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBub2RlQWN0aXZlSm9iTG9nc0N0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBnZXRBY3RpdmVMb2dzKCkge1xuICAgICAgICAgICAgTG9nU2VydmljZS5nZXRBY3RpdmVMb2dzKCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgbm9kZUFjdGl2ZUpvYkxvZ3NDdHJsLmFjdGl2ZUxvZ3MgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vT25jZSB0aGUgam9iIGZpbmlzaGVzLCBlbmRwb2ludCByZXR1cm5zIDUwMCBlcnJvci4gU28gcmVzZXQgdGhlIGFjdGl2ZUxvZ3NcbiAgICAgICAgICAgICAgICBub2RlQWN0aXZlSm9iTG9nc0N0cmwuYWN0aXZlTG9ncyA9IHtcbiAgICAgICAgICAgICAgICAgICAgZGVzYzogJ1RoZXJlIGlzIGN1cnJlbnRseSBubyBhY3RpdmUgam9iLiBDaGVjayBMYXN0IEpvYiBmb3IgYSBqb2IgdGhhdCByZWNlbnRseSBmaW5pc2hlZC4nXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGdldEFjdGl2ZUxvZ3MoKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldEFjdGl2ZUxvZ3MoKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVhY3RpdmVqb2Jsb2dzY3RybC5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8yNS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmNvbW1pc3Npb24nLCB7XG4gICAgICAgICAgICB1cmw6ICcvY29tbWlzc2lvbi86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlQ29tbWlzc2lvbkN0cmwgYXMgbm9kZUNvbW1pc3Npb25DdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWNvbW1pc3Npb24uaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVDb21taXNzaW9uQ3RybCcsIFtcbiAgICAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdOb2Rlc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJywgJ05vZGVzU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBOb2Rlc01vZGVsLCBDUlVESGVscGVyU2VydmljZSwgTm9kZXNTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBub2RlQ29tbWlzc2lvbkN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub05vZGVEZXRhaWxzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLmluZm8nLCB7ICdrZXknOiAkc3RhdGVQYXJhbXMua2V5IH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbENvbW1pc3Npb25pbmdOb2RlKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9Ob2RlRGV0YWlscygpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNvbW1pc3Npb24oKSB7XG4gICAgICAgICAgICBpZiAobm9kZUNvbW1pc3Npb25DdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIobm9kZUNvbW1pc3Npb25DdHJsKTtcbiAgICAgICAgICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwubm9kZU9wc09iai5ub2RlcyA9IFskc3RhdGVQYXJhbXMua2V5XTtcbiAgICAgICAgICAgICAgICBOb2Rlc1NlcnZpY2UuY2xlYW51cEV4dHJhVmFycyhub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgICAgICAgICAgICAgIE5vZGVzU2VydmljZS5jcmVhdGVFeHRyYVZhcnMobm9kZUNvbW1pc3Npb25DdHJsKTtcbiAgICAgICAgICAgICAgICBOb2Rlc01vZGVsLmNvbW1pc3Npb24obm9kZUNvbW1pc3Npb25DdHJsLm5vZGVPcHNPYmopLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvTm9kZURldGFpbHMoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihub2RlQ29tbWlzc2lvbkN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLm5vZGVPcHNPYmogPSB7fTtcbiAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLmV4dHJhX3ZhcnMgPSB7fTsgLy9UT0RPIEludGlhbGl6ZSBmcm9tIGdsb2JhbCBzZXR0aW5nc1xuICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuYW5zaWJsZVZhcmlhYmxlcyA9IFtdO1xuICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuZW52VmFyaWFibGVzID0gW107XG4gICAgICAgIE5vZGVzU2VydmljZS5nZXRTZXR0aW5ncyhub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuY2FuY2VsQ29tbWlzc2lvbmluZ05vZGUgPSBjYW5jZWxDb21taXNzaW9uaW5nTm9kZTtcbiAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLmNvbW1pc3Npb24gPSBjb21taXNzaW9uO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVjb21taXNzaW9uY3RybC5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8yNS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGV0YWlsc0N0cmwgYXMgbm9kZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWRldGFpbHMuaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMuZGV0YWlscy5pbmZvJywge1xuICAgICAgICAgICAgdXJsOiAnL2luZm8nLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVEZXRhaWxzQ3RybCBhcyBub2RlRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2RlaW5mby5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLnN0YXRzJywge1xuICAgICAgICAgICAgdXJsOiAnL3N0YXRzJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGV0YWlsc0N0cmwgYXMgbm9kZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZXN0YXRzLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMubG9ncycsIHtcbiAgICAgICAgICAgIHVybDogJy9sb2dzJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGV0YWlsc0N0cmwgYXMgbm9kZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWxvZ3MuaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMuZGV0YWlscy5lZGl0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2VkaXQnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVEZXRhaWxzQ3RybCBhcyBub2RlRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2RlaW5mby5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTm9kZURldGFpbHNDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJyRzY29wZScsICckaW50ZXJ2YWwnLCAnTm9kZXNNb2RlbCcsICdCZ3BTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRzY29wZSwgJGludGVydmFsLCBOb2Rlc01vZGVsLCBCZ3BTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBub2RlRGV0YWlsc0N0cmwgPSB0aGlzO1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwubnVtYmVycGF0dGVybiA9IENvbnRpdkdsb2JhbHMuTlVNQkVSX1JFR0VYO1xuICAgICAgICBmdW5jdGlvbiBkZWNvbW1pc3Npb24oKSB7XG4gICAgICAgICAgICB2YXIgbm9kZU9wc09iaiA9IHtcbiAgICAgICAgICAgICAgICBub2RlczogWyRzdGF0ZVBhcmFtcy5rZXldXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgTm9kZXNNb2RlbC5kZWNvbW1pc3Npb24obm9kZU9wc09iaikudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy9EaXNhYmxlIGFsbCBidXR0b25zIGluaXRpYWxseS4gUG9sbCB3aWxsIGFzc2lnbiB2YWx1ZXMgYXBwcm9wcmlhdGVseS5cbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHVwZ3JhZGUoKSB7XG4gICAgICAgICAgICB2YXIgbm9kZU9wc09iaiA9IHtcbiAgICAgICAgICAgICAgICBub2RlczogWyRzdGF0ZVBhcmFtcy5rZXldXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgTm9kZXNNb2RlbC51cGdyYWRlKG5vZGVPcHNPYmopLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vRGlzYWJsZSBhbGwgYnV0dG9ucyBpbml0aWFsbHkuIFBvbGwgd2lsbCBhc3NpZ24gdmFsdWVzIGFwcHJvcHJpYXRlbHkuXG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogRGlzcGxheSBidXR0b25zIGJhc2VkIG9uIHN0YXR1cyBvZiBub2RlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBzZXRCdXR0b25EaXNwbGF5KCkge1xuICAgICAgICAgICAgc3dpdGNoIChub2RlRGV0YWlsc0N0cmwubm9kZVsnaW52ZW50b3J5X3N0YXRlJ10uc3RhdHVzKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnVW5hbGxvY2F0ZWQnOlxuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnRGVjb21taXNzaW9uZWQnOlxuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnUHJvdmlzaW9uaW5nJzpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdBbGxvY2F0ZWQnOlxuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnQ2FuY2VsbGVkJzpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnTWFpbnRlbmFuY2UnOlxuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0Tm9kZUluZm8ocmVsb2FkKSB7XG4gICAgICAgICAgICBOb2Rlc01vZGVsLmdldE1vZGVsQnlLZXkoJHN0YXRlUGFyYW1zLmtleSwgcmVsb2FkKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm5vZGUgPSBub2RlO1xuICAgICAgICAgICAgICAgIHNldEJ1dHRvbkRpc3BsYXkoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHNldE1vZGUoKSB7XG4gICAgICAgICAgICBpZiAoJHN0YXRlLmlzKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLmVkaXQnKSkge1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5tb2RlID0gJ2VkaXQnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm1vZGUgPSAnZGV0YWlscyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9JbmZvKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLmluZm8nKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVCZ3BJbmZvKCkge1xuICAgICAgICAgICAgaWYgKG5vZGVEZXRhaWxzQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvci5rZXkgPSAkc3RhdGVQYXJhbXMua2V5O1xuICAgICAgICAgICAgICAgIC8vIGJhY2tlbmQgb25seSBzdXBwb3J0cyBhZGRpbmcgb25lIG5laWdoYm9yIGN1cnJlbnRseVxuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvcnMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3JbJ25laWdoYm9yJ10gPSBpdGVtLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvclsnbmVpZ2hib3ItYXMnXSA9IGl0ZW0udmFsdWU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgQmdwU2VydmljZS51cGRhdGVCZ3Aobm9kZURldGFpbHNDdHJsKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm5laWdoYm9yID0gcmVzdWx0LmNvbmZpZy5kYXRhO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub0luZm8oKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdldEJncEluZm8oKSB7XG4gICAgICAgICAgICBCZ3BTZXJ2aWNlLmdldEJncChub2RlRGV0YWlsc0N0cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvciA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnZXRCZ3BJbnNwZWN0KCkge1xuICAgICAgICAgICAgQmdwU2VydmljZS5nZXRCZ3BJbnNwZWN0KCRzdGF0ZVBhcmFtcy5rZXkpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5pbnNwZWN0ID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5yb3V0ZXMgPSByZXN1bHQuT3Blci5yb3V0ZXM7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmZpbHRlcmVkcm91dGVzID0gcmVzdWx0Lk9wZXIucm91dGVzO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC5kZWNvbW1pc3Npb24gPSBkZWNvbW1pc3Npb247XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlID0gdXBncmFkZTtcbiAgICAgICAgbm9kZURldGFpbHNDdHJsLnNldE1vZGUgPSBzZXRNb2RlO1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBkYXRlQmdwSW5mbyA9IHVwZGF0ZUJncEluZm87XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC5yZXR1cm5Ub0luZm8gPSByZXR1cm5Ub0luZm87XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvcnMgPSBbXTtcbiAgICAgICAgbm9kZURldGFpbHNDdHJsLm5laWdoYm9yID0ge307XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC5rZXkgPSAkc3RhdGVQYXJhbXMua2V5O1xuICAgICAgICBnZXRCZ3BJbmZvKCk7XG4gICAgICAgIGdldEJncEluc3BlY3QoKTtcbiAgICAgICAgc2V0TW9kZSgpO1xuICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgZ2V0Tm9kZUluZm8oZmFsc2UpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0Tm9kZUluZm8odHJ1ZSk7XG4gICAgICAgICAgICB9LCA1MDAwKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bm9kZWRldGFpbHNjdHJsLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA2LzE0LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5ub2Rlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZOb2Rlc3RhdHVzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgbm9kZTogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZXN0YXR1cy5odG1sJ1xuICAgIH07XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZOb2Rlc3RhdGVcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBub2RlOiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2Rlc3RhdGUuaHRtbCdcbiAgICB9O1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1ub2RlZGlyZWN0aXZlLmpzLm1hcFxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRpc2NvdmVyJywge1xuICAgICAgICAgICAgdXJsOiAnL2Rpc2NvdmVyJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGlzY292ZXJDdHJsIGFzIG5vZGVEaXNjb3ZlckN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2RlZGlzY292ZXIuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVEaXNjb3ZlckN0cmwnLCBbXG4gICAgJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnTm9kZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsICdOb2Rlc1NlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgTm9kZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UsIE5vZGVzU2VydmljZSkge1xuICAgICAgICB2YXIgbm9kZURpc2NvdmVyQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvTm9kZXMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5vZGVzLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxEaXNjb3ZlcmluZ05vZGUoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub05vZGVzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZGlzY292ZXIoKSB7XG4gICAgICAgICAgICBpZiAobm9kZURpc2NvdmVyQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihub2RlRGlzY292ZXJDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihub2RlRGlzY292ZXJDdHJsKTtcbiAgICAgICAgICAgICAgICBjcmVhdGVJUEFkZHJBcnJheSgpO1xuICAgICAgICAgICAgICAgIE5vZGVzU2VydmljZS5jcmVhdGVFeHRyYVZhcnMobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgICAgICAgICAgICAgTm9kZXNNb2RlbC5kaXNjb3Zlcihub2RlRGlzY292ZXJDdHJsLm5vZGVPcHNPYmopLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub05vZGVzKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihub2RlRGlzY292ZXJDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKG5vZGVEaXNjb3ZlckN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlSVBBZGRyQXJyYXkoKSB7XG4gICAgICAgICAgICBub2RlRGlzY292ZXJDdHJsLm5vZGVPcHNPYmouYWRkcnMgPSBfLndvcmRzKG5vZGVEaXNjb3ZlckN0cmwubm9kZUlQQWRkciwgL1teLCBdKy9nKTtcbiAgICAgICAgfVxuICAgICAgICBub2RlRGlzY292ZXJDdHJsLm5vZGVPcHNPYmogPSB7fTtcbiAgICAgICAgbm9kZURpc2NvdmVyQ3RybC5leHRyYV92YXJzID0ge307IC8vVE9ETyBJbnRpYWxpemUgZnJvbSBnbG9iYWwgc2V0dGluZ3NcbiAgICAgICAgbm9kZURpc2NvdmVyQ3RybC5hbnNpYmxlVmFyaWFibGVzID0gW107XG4gICAgICAgIG5vZGVEaXNjb3ZlckN0cmwuZW52VmFyaWFibGVzID0gW107XG4gICAgICAgIG5vZGVEaXNjb3ZlckN0cmwubm9kZUlQQWRkciA9ICcnOyAvL0lQIGFkZHJlc3Mgb2Ygbm9kZXMgdG8gZGlzY292ZXJcbiAgICAgICAgTm9kZXNTZXJ2aWNlLmdldFNldHRpbmdzKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICBub2RlRGlzY292ZXJDdHJsLmRpc2NvdmVyID0gZGlzY292ZXI7XG4gICAgICAgIG5vZGVEaXNjb3ZlckN0cmwuY2FuY2VsRGlzY292ZXJpbmdOb2RlID0gY2FuY2VsRGlzY292ZXJpbmdOb2RlO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bm9kZWRpc2NvdmVyY3RybC5qcy5tYXBcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5sYXN0bG9nJywge1xuICAgICAgICAgICAgdXJsOiAnL2xhc3Rsb2cnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVMYXN0Sm9iTG9nc0N0cmwgYXMgbm9kZUxhc3RKb2JMb2dzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxjdHYtbG9ncyB0aXRsZT1cIkxhc3QgSm9iXCIgbG9nPVwibm9kZUxhc3RKb2JMb2dzQ3RybC5sYXN0TG9nc1wiPjwvY3R2LWxvZ3M+J1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTm9kZUxhc3RKb2JMb2dzQ3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICdMb2dTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsIExvZ1NlcnZpY2UpIHtcbiAgICAgICAgdmFyIG5vZGVMYXN0Sm9iTG9nc0N0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBnZXRMYXN0TG9ncygpIHtcbiAgICAgICAgICAgIExvZ1NlcnZpY2UuZ2V0TGFzdExvZ3MoKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBub2RlTGFzdEpvYkxvZ3NDdHJsLmxhc3RMb2dzID0gcmVzdWx0O1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGdldExhc3RMb2dzKCk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG8tcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXRMYXN0TG9ncygpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bm9kZWxhc3Rqb2Jsb2dzY3RybC5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8yMi8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZUxpc3RDdHJsIGFzIG5vZGVMaXN0Q3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVsaXN0Lmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOb2RlTGlzdEN0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdOb2Rlc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIE5vZGVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBub2RlTGlzdEN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBnZXROb2RlcyhyZWxvYWQpIHtcbiAgICAgICAgICAgIE5vZGVzTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihub2RlTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgIG5vZGVMaXN0Q3RybC5ub2RlcyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihub2RlTGlzdEN0cmwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgIGdldE5vZGVzKGZhbHNlKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldE5vZGVzKHRydWUpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bm9kZWxpc3RjdHJsLmpzLm1hcFxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5vcmdhbml6YXRpb25zJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5jcmVhdGUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnb3JnYW5pemF0aW9ucy9vcmdhbml6YXRpb25jcmVhdGUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnT3JnYW5pemF0aW9uQ3JlYXRlQ3RybCBhcyBvcmdhbml6YXRpb25DcmVhdGVDdHJsJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignT3JnYW5pemF0aW9uQ3JlYXRlQ3RybCcsIFsnJHN0YXRlJywgJ09yZ2FuaXphdGlvbnNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgT3JnYW5pemF0aW9uc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvT3JnYW5pemF0aW9ucygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub09yZ2FuaXphdGlvbnMoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVPcmdhbml6YXRpb24oKSB7XG4gICAgICAgICAgICAvL2Zvcm0gY29udHJvbGxlciBpcyBpbmplY3RlZCBieSB0aGUgaHRtbCB0ZW1wbGF0ZVxuICAgICAgICAgICAgLy9jaGVja2luZyBpZiBhbGwgdmFsaWRhdGlvbnMgaGF2ZSBwYXNzZWRcbiAgICAgICAgICAgIGlmIChvcmdhbml6YXRpb25DcmVhdGVDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwubmV3T3JnYW5pemF0aW9uLmtleSA9IG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwubmV3T3JnYW5pemF0aW9uLnRlbmFudE5hbWU7XG4gICAgICAgICAgICAgICAgT3JnYW5pemF0aW9uc01vZGVsLmNyZWF0ZShvcmdhbml6YXRpb25DcmVhdGVDdHJsLm5ld09yZ2FuaXphdGlvbikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvT3JnYW5pemF0aW9ucygpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25DcmVhdGVDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJlc2V0Rm9ybSgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBvcmdhbml6YXRpb25DcmVhdGVDdHJsLm5ld09yZ2FuaXphdGlvbiA9IHtcbiAgICAgICAgICAgICAgICB0ZW5hbnROYW1lOiAnJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBvcmdhbml6YXRpb25DcmVhdGVDdHJsLmNyZWF0ZU9yZ2FuaXphdGlvbiA9IGNyZWF0ZU9yZ2FuaXphdGlvbjtcbiAgICAgICAgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybC5jYW5jZWxDcmVhdGluZyA9IGNhbmNlbENyZWF0aW5nO1xuICAgICAgICByZXNldEZvcm0oKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1vcmdhbml6YXRpb25jcmVhdGVjdHJsLmpzLm1hcFxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5vcmdhbml6YXRpb25zJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnT3JnYW5pemF0aW9uRGV0YWlsc0N0cmwgYXMgb3JnYW5pemF0aW9uRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdvcmdhbml6YXRpb25zL29yZ2FuaXphdGlvbmRldGFpbHMuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ09yZ2FuaXphdGlvbkRldGFpbHNDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ09yZ2FuaXphdGlvbnNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBPcmdhbml6YXRpb25zTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBvcmdhbml6YXRpb25EZXRhaWxzQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvT3JnYW5pemF0aW9ucygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZGVsZXRlT3JnYW5pemF0aW9uKCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIE9yZ2FuaXphdGlvbnNNb2RlbC5kZWxldGUob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwub3JnYW5pemF0aW9uKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICByZXR1cm5Ub09yZ2FuaXphdGlvbnMoKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgIE9yZ2FuaXphdGlvbnNNb2RlbC5nZXRNb2RlbEJ5S2V5KCRzdGF0ZVBhcmFtcy5rZXkpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAob3JnYW5pemF0aW9uKSB7XG4gICAgICAgICAgICBvcmdhbml6YXRpb25EZXRhaWxzQ3RybC5vcmdhbml6YXRpb24gPSBvcmdhbml6YXRpb247XG4gICAgICAgIH0pO1xuICAgICAgICBvcmdhbml6YXRpb25EZXRhaWxzQ3RybC5kZWxldGVPcmdhbml6YXRpb24gPSBkZWxldGVPcmdhbml6YXRpb247XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9b3JnYW5pemF0aW9uZGV0YWlsc2N0cmwuanMubWFwXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnNldHRpbmdzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5jbHVzdGVyJywge1xuICAgICAgICAgICAgdXJsOiAnL2NsdXN0ZXInLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0NsdXN0ZXJTZXR0aW5nQ3RybCBhcyBjbHVzdGVyU2V0dGluZ0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXR0aW5ncy9jbHVzdGVyc2V0dGluZ3MuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ0NsdXN0ZXJTZXR0aW5nQ3RybCcsIFsnJHN0YXRlUGFyYW1zJywgJ0NSVURIZWxwZXJTZXJ2aWNlJywgJ05vZGVzU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZVBhcmFtcywgQ1JVREhlbHBlclNlcnZpY2UsIE5vZGVzU2VydmljZSkge1xuICAgICAgICB2YXIgY2x1c3RlclNldHRpbmdDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlQ2x1c3RlclNldHRpbmdzKCkge1xuICAgICAgICAgICAgaWYgKGNsdXN0ZXJTZXR0aW5nQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKGNsdXN0ZXJTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgY2x1c3RlclNldHRpbmdDdHJsLm5vZGVPcHNPYmoubm9kZXMgPSBbJHN0YXRlUGFyYW1zLmtleV07XG4gICAgICAgICAgICAgICAgTm9kZXNTZXJ2aWNlLmNsZWFudXBFeHRyYVZhcnMoY2x1c3RlclNldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICBOb2Rlc1NlcnZpY2UuY3JlYXRlRXh0cmFWYXJzKGNsdXN0ZXJTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgTm9kZXNTZXJ2aWNlLnVwZGF0ZVNldHRpbmdzKGNsdXN0ZXJTZXR0aW5nQ3RybC5ub2RlT3BzT2JqKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoY2x1c3RlclNldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKGNsdXN0ZXJTZXR0aW5nQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjbHVzdGVyU2V0dGluZ0N0cmwubm9kZU9wc09iaiA9IHt9O1xuICAgICAgICBjbHVzdGVyU2V0dGluZ0N0cmwuZXh0cmFfdmFycyA9IHt9OyAvL1RPRE8gSW50aWFsaXplIGZyb20gZ2xvYmFsIHNldHRpbmdzXG4gICAgICAgIGNsdXN0ZXJTZXR0aW5nQ3RybC5hbnNpYmxlVmFyaWFibGVzID0gW107XG4gICAgICAgIGNsdXN0ZXJTZXR0aW5nQ3RybC5lbnZWYXJpYWJsZXMgPSBbXTtcbiAgICAgICAgTm9kZXNTZXJ2aWNlLmdldFNldHRpbmdzKGNsdXN0ZXJTZXR0aW5nQ3RybCk7XG4gICAgICAgIGNsdXN0ZXJTZXR0aW5nQ3RybC51cGRhdGVDbHVzdGVyU2V0dGluZ3MgPSB1cGRhdGVDbHVzdGVyU2V0dGluZ3M7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoY2x1c3RlclNldHRpbmdDdHJsKTtcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGNsdXN0ZXJTZXR0aW5nQ3RybCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y2x1c3RlcnNldHRpbmdjdHJsLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzEyLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnNlcnZpY2VsYnMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXJ2aWNlX2xicy9zZXJ2aWNlbGJjcmVhdGUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU2VydmljZWxiQ3JlYXRlQ3RybCBhcyBzZXJ2aWNlbGJDcmVhdGVDdHJsJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignU2VydmljZWxiQ3JlYXRlQ3RybCcsIFtcbiAgICAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdTZXJ2aWNlbGJzTW9kZWwnLCAnTmV0d29ya3NNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBTZXJ2aWNlbGJzTW9kZWwsIE5ldHdvcmtzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlbGJDcmVhdGVDdHJsID0gdGhpcztcbiAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5sYWJlbFNlbGVjdG9ycyA9IFtdO1xuICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLm5ldHdvcmtzID0gW107XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvU2VydmljZWxicygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuc2VydmljZWxicy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub1NlcnZpY2VsYnMoKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IG5ldHdvcmtzIGZvciB0aGUgZ2l2ZW4gdGVuYW50LlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gZ2V0TmV0d29ya3MoKSB7XG4gICAgICAgICAgICBOZXR3b3Jrc01vZGVsLmdldCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHNlcnZpY2VsYkNyZWF0ZUN0cmwubmV0d29ya3MgPSBfLmZpbHRlcihyZXN1bHQsIHtcbiAgICAgICAgICAgICAgICAgICAgJ3RlbmFudE5hbWUnOiAnZGVmYXVsdCcgLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUxhYmVsU2VsZWN0b3JTdHJpbmdzKCkge1xuICAgICAgICAgICAgLy9FbXB0eSBvdXQgdGhlIHNlbGVjdG9ycy4gSW4gY2FzZSBvZiBzZXJ2ZXIgZXJyb3JzIHRoaXMgbmVlZHMgdG8gYmUgcmVzZXQuXG4gICAgICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLnNlcnZpY2VsYi5zZWxlY3RvcnMgPSBbXTtcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChzZXJ2aWNlbGJDcmVhdGVDdHJsLmxhYmVsU2VsZWN0b3JzLCBmdW5jdGlvbiAobGFiZWxTZWxlY3Rvcikge1xuICAgICAgICAgICAgICAgIHZhciBzZWxlY3RvclN0cmluZyA9IGxhYmVsU2VsZWN0b3IubmFtZSArICc9JyArIGxhYmVsU2VsZWN0b3IudmFsdWU7XG4gICAgICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIuc2VsZWN0b3JzLnB1c2goc2VsZWN0b3JTdHJpbmcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlU2VydmljZWxiKCkge1xuICAgICAgICAgICAgY3JlYXRlTGFiZWxTZWxlY3RvclN0cmluZ3MoKTtcbiAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgaWYgKHNlcnZpY2VsYkNyZWF0ZUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc2VydmljZWxiQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoc2VydmljZWxiQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIua2V5ID1cbiAgICAgICAgICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIudGVuYW50TmFtZSArICc6JyArIHNlcnZpY2VsYkNyZWF0ZUN0cmwuc2VydmljZWxiLnNlcnZpY2VOYW1lO1xuICAgICAgICAgICAgICAgIFNlcnZpY2VsYnNNb2RlbC5jcmVhdGUoc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1NlcnZpY2VsYnMoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Ioc2VydmljZWxiQ3JlYXRlQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXNldEZvcm0oKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHNlcnZpY2VsYkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIgPSB7XG4gICAgICAgICAgICAgICAgc2VydmljZU5hbWU6ICcnLFxuICAgICAgICAgICAgICAgIG5ldHdvcmtOYW1lOiAnJyxcbiAgICAgICAgICAgICAgICBpcEFkZHJlc3M6ICcnLFxuICAgICAgICAgICAgICAgIHNlbGVjdG9yczogW10sXG4gICAgICAgICAgICAgICAgcG9ydHM6IFtdLFxuICAgICAgICAgICAgICAgIHRlbmFudE5hbWU6ICdkZWZhdWx0JyAvL1RPRE86IFJlbW92ZSBoYXJkY29kZWQgdGVuYW50LlxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLmNyZWF0ZVNlcnZpY2VsYiA9IGNyZWF0ZVNlcnZpY2VsYjtcbiAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5jYW5jZWxDcmVhdGluZyA9IGNhbmNlbENyZWF0aW5nO1xuICAgICAgICBnZXROZXR3b3JrcygpO1xuICAgICAgICByZXNldEZvcm0oKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zZXJ2aWNlbGJjcmVhdGVjdHJsLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzExLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnNlcnZpY2VsYnMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIHBhcmFtczogeyBzdGF0ZTogbnVsbCB9LFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1NlcnZpY2VsYkRldGFpbHNDdHJsIGFzIHNlcnZpY2VsYkRldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2VydmljZV9sYnMvc2VydmljZWxiZGV0YWlscy5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmRldGFpbHMuaW5mbycsIHtcbiAgICAgICAgICAgIHVybDogJy9pbmZvJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTZXJ2aWNlbGJEZXRhaWxzQ3RybCBhcyBzZXJ2aWNlbGJEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NlcnZpY2VfbGJzL3NlcnZpY2VsYmluZm8uaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2VydmljZWxicy5kZXRhaWxzLmVkaXQnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZWRpdC86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTZXJ2aWNlbGJEZXRhaWxzQ3RybCBhcyBzZXJ2aWNlbGJEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NlcnZpY2VfbGJzL3NlcnZpY2VsYmluZm8uaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1NlcnZpY2VsYkRldGFpbHNDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ1NlcnZpY2VsYnNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBTZXJ2aWNlbGJzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlbGJEZXRhaWxzQ3RybCA9IHRoaXM7XG4gICAgICAgIHNlcnZpY2VsYkRldGFpbHNDdHJsLmxhYmVsU2VsZWN0b3JzID0gW107XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUbyBzaG93IGVkaXQgb3IgZGV0YWlscyBzY3JlZW4gYmFzZWQgb24gdGhlIHJvdXRlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBzZXRNb2RlKCkge1xuICAgICAgICAgICAgaWYgKCRzdGF0ZS5pcygnY29udGl2Lm1lbnUuc2VydmljZWxicy5kZXRhaWxzLmVkaXQnKSkge1xuICAgICAgICAgICAgICAgIHNlcnZpY2VsYkRldGFpbHNDdHJsLm1vZGUgPSAnZWRpdCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5tb2RlID0gJ2RldGFpbHMnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvU2VydmljZWxicygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuc2VydmljZWxicy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9TZXJ2aWNlbGJEZXRhaWxzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmRldGFpbHMuaW5mbycsIHsgJ2tleSc6IHNlcnZpY2VsYkRldGFpbHNDdHJsLnNlcnZpY2VsYi5rZXksICdzdGF0ZSc6ICdkZXRhaWxzJyB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxFZGl0aW5nKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9TZXJ2aWNlbGJEZXRhaWxzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZGVsZXRlU2VydmljZWxiKCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHNlcnZpY2VsYkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKHNlcnZpY2VsYkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIFNlcnZpY2VsYnNNb2RlbC5kZWxldGUoc2VydmljZWxiRGV0YWlsc0N0cmwuc2VydmljZWxiKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICByZXR1cm5Ub1NlcnZpY2VsYnMoKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHNlcnZpY2VsYkRldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gc2F2ZVNlcnZpY2VsYigpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICB2YXIgZXhpc3RpbmdMYWJlbHMgPSBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIuc2VsZWN0b3JzO1xuICAgICAgICAgICAgY3JlYXRlTGFiZWxTZWxlY3RvclN0cmluZ3MoKTtcbiAgICAgICAgICAgIFNlcnZpY2VsYnNNb2RlbC5zYXZlKHNlcnZpY2VsYkRldGFpbHNDdHJsLnNlcnZpY2VsYikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9TZXJ2aWNlbGJEZXRhaWxzKCk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHNlcnZpY2VsYkRldGFpbHNDdHJsLnNlcnZpY2VsYi5zZWxlY3RvcnMgPSBleGlzdGluZ0xhYmVscztcbiAgICAgICAgICAgICAgICBjcmVhdGVMYWJlbFNlbGVjdG9ycygpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUxhYmVsU2VsZWN0b3JzKCkge1xuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHNlcnZpY2VsYkRldGFpbHNDdHJsLnNlcnZpY2VsYi5zZWxlY3RvcnMsIGZ1bmN0aW9uIChzZWxlY3RvclN0cikge1xuICAgICAgICAgICAgICAgIHZhciBzZWxlY3RvciA9IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogc2VsZWN0b3JTdHIuc3BsaXQoJz0nKVswXSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHNlbGVjdG9yU3RyLnNwbGl0KCc9JylbMV1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHNlcnZpY2VsYkRldGFpbHNDdHJsLmxhYmVsU2VsZWN0b3JzLnB1c2goc2VsZWN0b3IpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlTGFiZWxTZWxlY3RvclN0cmluZ3MoKSB7XG4gICAgICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIuc2VsZWN0b3JzID0gW107XG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goc2VydmljZWxiRGV0YWlsc0N0cmwubGFiZWxTZWxlY3RvcnMsIGZ1bmN0aW9uIChsYWJlbFNlbGVjdG9yKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGVjdG9yU3RyaW5nID0gbGFiZWxTZWxlY3Rvci5uYW1lICsgJz0nICsgbGFiZWxTZWxlY3Rvci52YWx1ZTtcbiAgICAgICAgICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIuc2VsZWN0b3JzLnB1c2goc2VsZWN0b3JTdHJpbmcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgIFNlcnZpY2VsYnNNb2RlbC5nZXRNb2RlbEJ5S2V5KCRzdGF0ZVBhcmFtcy5rZXkpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2soc2VydmljZWxiKSB7XG4gICAgICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIgPSBzZXJ2aWNlbGI7XG4gICAgICAgICAgICBjcmVhdGVMYWJlbFNlbGVjdG9ycygpO1xuICAgICAgICB9KTtcbiAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwuc2F2ZVNlcnZpY2VsYiA9IHNhdmVTZXJ2aWNlbGI7XG4gICAgICAgIHNlcnZpY2VsYkRldGFpbHNDdHJsLmNhbmNlbEVkaXRpbmcgPSBjYW5jZWxFZGl0aW5nO1xuICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5kZWxldGVTZXJ2aWNlbGIgPSBkZWxldGVTZXJ2aWNlbGI7XG4gICAgICAgIHNldE1vZGUoKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zZXJ2aWNlbGJkZXRhaWxzY3RybC5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xMy8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoXCJjb250aXYuc2VydmljZWxic1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZTZXJ2aWNlbGJwb3J0c1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIGl0ZW1zOiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlKSB7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENvbXBhcmUgaWYgdHdvIGl0ZW1zIGhhdmUgc2FtZSBwb3J0cyBhbmQgcHJvdG9jb2xzXG4gICAgICAgICAgICAgKiBAcGFyYW0gdmFsMVxuICAgICAgICAgICAgICogQHBhcmFtIHZhbDJcbiAgICAgICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmdW5jdGlvbiBjb21wYXJlKHZhbDEsIHZhbDIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKHZhbDEgPT09IHZhbDIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZnVuY3Rpb24gcmVzZXROZXdJdGVtKCkge1xuICAgICAgICAgICAgICAgIHNjb3BlLm5ld0l0ZW0gPSB7XG4gICAgICAgICAgICAgICAgICAgIHNlcnZpY2VQb3J0OiAnJyxcbiAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXJQb3J0OiAnJyxcbiAgICAgICAgICAgICAgICAgICAgcHJvdG9jb2w6ICcnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZ1bmN0aW9uIGlzRW1wdHlJdGVtKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKGl0ZW0uc2VydmljZVBvcnQgPT09ICcnICYmIGl0ZW0ucHJvdmlkZXJQb3J0ID09PSAnJyAmJiBpdGVtLnByb3RvY29sID09PSAnJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzY29wZS5hZGQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzRW1wdHlJdGVtKHNjb3BlLm5ld0l0ZW0pKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgaWYgKHNjb3BlLml0ZW1zID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuaXRlbXMgPSBbXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG5ld0l0ZW1TdHIgPSBzY29wZS5uZXdJdGVtLnNlcnZpY2VQb3J0ICsgJzonXG4gICAgICAgICAgICAgICAgICAgICsgc2NvcGUubmV3SXRlbS5wcm92aWRlclBvcnQgKyAnOidcbiAgICAgICAgICAgICAgICAgICAgKyBzY29wZS5uZXdJdGVtLnByb3RvY29sO1xuICAgICAgICAgICAgICAgIC8vUmVtb3ZlcyBleGlzdGluZyBpdGVtIHdpdGggdGhlIHNhbWUgdmFsdWUgZmlyc3QgaWYgaXQgZXhpc3RzLlxuICAgICAgICAgICAgICAgIF8ucHVsbEFsbFdpdGgoc2NvcGUuaXRlbXMsIFtuZXdJdGVtU3RyXSwgY29tcGFyZSk7XG4gICAgICAgICAgICAgICAgc2NvcGUuaXRlbXMucHVzaChuZXdJdGVtU3RyKTtcbiAgICAgICAgICAgICAgICByZXNldE5ld0l0ZW0oKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBzY29wZS5yZW1vdmUgPSBmdW5jdGlvbiAocGFzc2VkSXRlbSkge1xuICAgICAgICAgICAgICAgIF8ucmVtb3ZlKHNjb3BlLml0ZW1zLCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcGFyZShpdGVtLCBwYXNzZWRJdGVtKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXNldE5ld0l0ZW0oKTtcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXJ2aWNlX2xicy9zZXJ2aWNlbGJwb3J0cy5odG1sJ1xuICAgIH07XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNlcnZpY2VsYnBvcnRzZGlyZWN0aXZlLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA2LzEvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc3RvcmFnZXBvbGljaWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL3N0b3JhZ2Vwb2xpY3ljcmVhdGUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwgYXMgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdTdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdTdG9yYWdlUG9saWNpZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBTdG9yYWdlUG9saWNpZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9TdG9yYWdlUG9saWNpZXMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub1N0b3JhZ2VQb2xpY2llcygpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUZpbGVzeXN0ZW1DbWRzKCkge1xuICAgICAgICAgICAgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwuZmlsZXN5c3RlbWNtZHMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLm5ld1N0b3JhZ2VQb2xpY3kuZmlsZXN5c3RlbXNbaXRlbS5uYW1lXSA9IGl0ZW0udmFsdWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVQb2xpY3koKSB7XG4gICAgICAgICAgICAvL2Zvcm0gY29udHJvbGxlciBpcyBpbmplY3RlZCBieSB0aGUgaHRtbCB0ZW1wbGF0ZVxuICAgICAgICAgICAgLy9jaGVja2luZyBpZiBhbGwgdmFsaWRhdGlvbnMgaGF2ZSBwYXNzZWRcbiAgICAgICAgICAgIGlmIChzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIGNyZWF0ZUZpbGVzeXN0ZW1DbWRzKCk7XG4gICAgICAgICAgICAgICAgU3RvcmFnZVBvbGljaWVzTW9kZWwuY3JlYXRlKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLm5ld1N0b3JhZ2VQb2xpY3kpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvU3RvcmFnZVBvbGljaWVzKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXNldEZvcm0oKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5uZXdTdG9yYWdlUG9saWN5ID0ge1xuICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgIFwiYmFja2VuZHNcIjoge1xuICAgICAgICAgICAgICAgICAgICBcImNydWRcIjogXCJjZXBoXCIsXG4gICAgICAgICAgICAgICAgICAgIFwibW91bnRcIjogXCJjZXBoXCIsXG4gICAgICAgICAgICAgICAgICAgIFwic25hcHNob3RcIjogXCJjZXBoXCJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFwidW5sb2NrZWRcIjogZmFsc2UsXG4gICAgICAgICAgICAgICAgXCJkcml2ZXJcIjoge1xuICAgICAgICAgICAgICAgICAgICBcInBvb2xcIjogXCJyYmRcIlxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXCJjcmVhdGVcIjoge1xuICAgICAgICAgICAgICAgICAgICBcInNpemVcIjogXCIwXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiZmlsZXN5c3RlbVwiOiBcIlwiXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBcInJ1bnRpbWVcIjoge1xuICAgICAgICAgICAgICAgICAgICBcInNuYXBzaG90c1wiOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBcInNuYXBzaG90XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZnJlcXVlbmN5XCI6IFwiMzBtXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImtlZXBcIjogMjBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXCJyYXRlLWxpbWl0XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwid3JpdGUtaW9wc1wiOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWFkLWlvcHNcIjogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwid3JpdGUtYnBzXCI6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJlYWQtYnBzXCI6IDBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXCJmaWxlc3lzdGVtc1wiOiB7fVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5jcmVhdGVQb2xpY3kgPSBjcmVhdGVQb2xpY3k7XG4gICAgICAgIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLmNhbmNlbENyZWF0aW5nID0gY2FuY2VsQ3JlYXRpbmc7XG4gICAgICAgIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLmZpbGVzeXN0ZW1jbWRzID0gW107XG4gICAgICAgIHJlc2V0Rm9ybSgpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXN0b3JhZ2Vwb2xpY3ljcmVhdGVjdHJsLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzI3LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnN0b3JhZ2Vwb2xpY2llcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU3RvcmFnZVBvbGljeURldGFpbHNDdHJsIGFzIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvc3RvcmFnZXBvbGljeWRldGFpbHMuaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmVkaXQnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwgYXMgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9zdG9yYWdlcG9saWN5ZGV0YWlscy5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignU3RvcmFnZVBvbGljeURldGFpbHNDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdTdG9yYWdlUG9saWNpZXNNb2RlbCcsICdWb2x1bWVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIFN0b3JhZ2VQb2xpY2llc01vZGVsLCBWb2x1bWVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwgPSB0aGlzO1xuICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwuZmlsZXN5c3RlbWNtZHMgPSBbXTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRvIHNob3cgZWRpdCBvciBkZXRhaWxzIHNjcmVlbiBiYXNlZCBvbiB0aGUgcm91dGVcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHNldE1vZGUoKSB7XG4gICAgICAgICAgICBpZiAoJHN0YXRlLmlzKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMuZWRpdCcpKSB7XG4gICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLm1vZGUgPSAnZWRpdCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwubW9kZSA9ICdkZXRhaWxzJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1BvbGljaWVzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMubGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvUG9saWN5RGV0YWlscygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmRldGFpbHMnLCB7ICdrZXknOiBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5Lm5hbWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsRWRpdGluZygpIHtcbiAgICAgICAgICAgIHJldHVyblRvUG9saWN5RGV0YWlscygpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGRlbGV0ZVBvbGljeSgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIFN0b3JhZ2VQb2xpY2llc01vZGVsLmRlbGV0ZVVzaW5nS2V5KHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kubmFtZSwgJ25hbWUnKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9Qb2xpY2llcygpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZXQgdm9sdW1lcyBiZWxvbmdpbmcgdG8gYSBwb2xpY3lcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGdldFZvbHVtZXMocmVsb2FkKSB7XG4gICAgICAgICAgICBWb2x1bWVzTW9kZWwuZ2V0KHJlbG9hZCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnZvbHVtZXMgPSAkZmlsdGVyKCdvcmRlckJ5JykoXy5maWx0ZXIocmVzdWx0LCB7XG4gICAgICAgICAgICAgICAgICAgICdwb2xpY3knOiBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5Lm5hbWVcbiAgICAgICAgICAgICAgICB9KSwgJ25hbWUnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGluaXRpYWxpemVGaWxlc3lzdGVtQ21kc0FycmF5KCkge1xuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kuZmlsZXN5c3RlbXMsIGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wdXNoKHsgbmFtZToga2V5LCB2YWx1ZTogdmFsdWUgfSk7XG4gICAgICAgICAgICB9LCBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwuZmlsZXN5c3RlbWNtZHMpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUZpbGVzeXN0ZW1DbWRzKCkge1xuICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmZpbGVzeXN0ZW1jbWRzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5LmZpbGVzeXN0ZW1zW2l0ZW0ubmFtZV0gPSBpdGVtLnZhbHVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gc2F2ZVBvbGljeSgpIHtcbiAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgaWYgKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgY3JlYXRlRmlsZXN5c3RlbUNtZHMoKTtcbiAgICAgICAgICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbC5zYXZlKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvUG9saWN5RGV0YWlscygpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbC5nZXRNb2RlbEJ5S2V5KCRzdGF0ZVBhcmFtcy5rZXksIGZhbHNlLCAnbmFtZScpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5ID0gcG9saWN5O1xuICAgICAgICAgICAgaW5pdGlhbGl6ZUZpbGVzeXN0ZW1DbWRzQXJyYXkoKTtcbiAgICAgICAgICAgIGdldFZvbHVtZXMoZmFsc2UpO1xuICAgICAgICB9KTtcbiAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmRlbGV0ZVBvbGljeSA9IGRlbGV0ZVBvbGljeTtcbiAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnNhdmVQb2xpY3kgPSBzYXZlUG9saWN5O1xuICAgICAgICBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwuY2FuY2VsRWRpdGluZyA9IGNhbmNlbEVkaXRpbmc7XG4gICAgICAgIHNldE1vZGUoKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0b3JlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0Vm9sdW1lcyh0cnVlKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXN0b3JhZ2Vwb2xpY3lkZXRhaWxzY3RybC5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNi8yLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5zdG9yYWdlcG9saWNpZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2U3RvcmFnZXBvbGljeWJhc2ljc2V0dGluZ3NcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7fTtcbn0pXG4gICAgLmRpcmVjdGl2ZShcImN0dlN0b3JhZ2Vwb2xpY3lmaWxlc3lzdGVtc2V0dGluZ3NcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBwb2xpY3k6ICc9JyxcbiAgICAgICAgICAgIGZpbGVzeXN0ZW1jbWRzOiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlKSB7XG4gICAgICAgICAgICBzY29wZS5maWxlc3lzdGVtcyA9IFsnZXh0NCcsICdidHJmcyddO1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvZmlsZXN5c3RlbXNldHRpbmdzLmh0bWwnXG4gICAgfTtcbn0pXG4gICAgLmRpcmVjdGl2ZShcImN0dlN0b3JhZ2Vwb2xpY3lzbmFwc2hvdHNldHRpbmdzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgcG9saWN5OiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL3NuYXBzaG90c2V0dGluZ3MuaHRtbCdcbiAgICB9O1xufSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2U3RvcmFnZXBvbGljeXJ3b3Bzc2V0dGluZ3NcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBwb2xpY3k6ICc9J1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvcndvcHNzZXR0aW5ncy5odG1sJ1xuICAgIH07XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZTdG9yYWdlcG9saWN5YmFja2VuZGRyaXZlcnNcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBwb2xpY3k6ICc9J1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvYmFja2VuZGRyaXZlcnMuaHRtbCdcbiAgICB9O1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdG9yYWdlcG9saWN5ZGlyZWN0aXZlLmpzLm1hcFxuXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZpc3VhbGl6YXRpb24uZWRnZScsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvZWRnZS97c291cmNlTmFtZSwgdGFyZ2V0TmFtZSwgc291cmNlTGlzdCwgdGFyZ2V0TGlzdH0nLFxuICAgICAgICAgICAgICAgIHBhcmFtczoge1xuICAgICAgICAgICAgICAgICAgICBzb3VyY2VOYW1lOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICB0YXJnZXROYW1lOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICBzb3VyY2VMaXN0OiBudWxsLFxuICAgICAgICAgICAgICAgICAgICB0YXJnZXRMaXN0OiBudWxsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnVmlzdWFsaXphdGlvbkVkZ2VDdHJsIGFzIHZpc3VhbGl6YXRpb25lZGdlQ3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb25lZGdlLmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICA7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1Zpc3VhbGl6YXRpb25FZGdlQ3RybCcsIFtcIiRzY29wZVwiLCBcIiRodHRwXCIsICckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ1Zpc3VhbGl6YXRpb25TZXJ2aWNlJywgJyRpbnRlcnZhbCcsXG4gICAgICAgIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBWaXN1YWxpemF0aW9uU2VydmljZSwgJGludGVydmFsKSB7XG4gICAgICAgICAgICB2YXIgc291cmNlTmFtZSA9ICRzdGF0ZVBhcmFtcy5zb3VyY2VOYW1lO1xuICAgICAgICAgICAgdmFyIHRhcmdldE5hbWUgPSAkc3RhdGVQYXJhbXMudGFyZ2V0TmFtZTtcbiAgICAgICAgICAgIHZhciBzb3VyY2VMaXN0ID0gJHN0YXRlUGFyYW1zLnNvdXJjZUxpc3Q7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0TGlzdCA9ICRzdGF0ZVBhcmFtcy50YXJnZXRMaXN0O1xuXG4gICAgICAgICAgICAvL0lmIHRoZSBwYWdlIGlzIHJlbG9hZGVkLCB0aGVzZSBzdGF0ZSBwYXJhbXMgYXJlIGFsbCBudWxsLFxuICAgICAgICAgICAgLy9zbyBpdCB3aWxsIHJvdXRlIHRoZW0gYmFjayB0byB0aGUgdmlzdWFsaXphdGlvbiB0YWIgdG9wIHZpZXdcbiAgICAgICAgICAgIGlmIChzb3VyY2VMaXN0ID09IG51bGwgfHwgdGFyZ2V0TGlzdCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS52aXN1YWxpemF0aW9uLmxpc3QnKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBkID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgIHZhciB0ID0gZC5nZXRTZWNvbmRzKCk7XG4gICAgICAgICAgICAkc2NvcGUuZWRnZURhdGFJbnRlcnZhbCA9IFxuICAgICAgICAgICAgICAgICRpbnRlcnZhbChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgVmlzdWFsaXphdGlvblNlcnZpY2UuZ2V0RWRnZURhdGEoc291cmNlTGlzdCwgdGFyZ2V0TGlzdCwgdC50b1N0cmluZygpKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHRzID0gcmVzdWx0LnJlc3VsdHM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChyZXN1bHRzLCBmdW5jdGlvbihyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfLmlzRW1wdHkocikgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhICs9IHIuc2VyaWVzWzBdLnZhbHVlc1swXVsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zb3VyY2VOYW1lID0gc291cmNlTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUudGFyZ2V0TmFtZSA9IHRhcmdldE5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVkZ2VEYXRhID0gZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZWRnZURhdGFUaW1lID0gdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSwgMzAwMCk7XG5cbiAgICAgICAgICAgIC8vRGVzdHJveWluZyB0aGUgaW50ZXJ2YWwgZnVuY3Rpb24gb24gcm91dGUgY2hhbmdlXG4gICAgICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHsgJGludGVydmFsLmNhbmNlbCgkc2NvcGUuZWRnZURhdGFJbnRlcnZhbCk7IH0pO1xuXG5cbiAgICAgICAgICAgIFZpc3VhbGl6YXRpb25TZXJ2aWNlLmdldE9sZEVkZ2VEYXRhKHNvdXJjZUxpc3QsIHRhcmdldExpc3QpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0cyA9IHJlc3VsdC5yZXN1bHRzO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZWRnZURhdGEgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgLy9yZXN1bHRzLCBpZiBub3QgZW1wdHksIGFyZSBleHBlY3RlZCB0byBoYXZlXG4gICAgICAgICAgICAgICAgICAgIC8vNiBkYXRhIGVudHJpZXNcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHJlc3VsdHMsIGZ1bmN0aW9uKHIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfLmlzRW1wdHkocikgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSByLnNlcmllc1swXS52YWx1ZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF8uaXNFbXB0eShlZGdlRGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKGRhdGEsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkZ2VEYXRhLnB1c2goZFsxXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKGRhdGEsIGZ1bmN0aW9uKGQsIGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkZ2VEYXRhW2ldICs9IGRbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlTmFtZSA9IHNvdXJjZU5hbWU7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50YXJnZXROYW1lID0gdGFyZ2V0TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNvdXJjZUxpc3QgPSBzb3VyY2VMaXN0O1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudGFyZ2V0TGlzdCA9IHRhcmdldExpc3Q7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5vbGRFZGdlRGF0YSA9IGVkZ2VEYXRhO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgfV0pO1xuXG5cblxuXG5cblxuXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nKVxuICAgIC5kaXJlY3RpdmUoXCJ2aXN1YWxpemF0aW9uRWRnZVwiLCBbJyR3aW5kb3cnLFxuICAgICAgICBmdW5jdGlvbigkd2luZG93KSB7XG4gICAgICAgICAgICBmdW5jdGlvbiB2aXN1YWxpemF0aW9uRWRnZUQzKHNjb3BlLCBkMykge1xuICAgICAgICAgICAgICAgIHZhciBib2R5RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnYm9keScpWzBdO1xuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBib2R5RWwuY2xpZW50V2lkdGggLSA0MDAsXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCA9ICBib2R5RWwuY2xpZW50SGVpZ2h0IC0gNDAwO1xuXG5cbiAgICAgICAgICAgICAgICAvL3Rha2VuIGZyb20gaHR0cDovL2JsLm9ja3Mub3JnL3NpbWVuYnJla2tlbi82NjM0MDcwXG4gICAgICAgICAgICAgICAgLy8gLyoqIE1BSU4gU1ZHICoqL1xuICAgICAgICAgICAgICAgIHZhciBsaW1pdCA9IDU5LFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uID0gNzUwLFxuICAgICAgICAgICAgICAgIG5vdyA9IG5ldyBEYXRlKERhdGUubm93KCkgLSBkdXJhdGlvbik7XG5cbiAgICAgICAgICAgICAgICB2YXIgZ3JvdXBzID0ge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnb3JhbmdlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGQzLnJhbmdlKGxpbWl0KS5tYXAoZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzY29wZS5vbGRFZGdlRGF0YVtNYXRoLmZsb29yKGQvMTApXSB8fCAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIHggPSBkMy50aW1lLnNjYWxlKClcbiAgICAgICAgICAgICAgICAgICAgLmRvbWFpbihbbm93IC0gKGxpbWl0IC0gMiksIG5vdyAtIGR1cmF0aW9uXSlcbiAgICAgICAgICAgICAgICAgICAgLnJhbmdlKFswLCB3aWR0aF0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIHkgPSBkMy5zY2FsZS5saW5lYXIoKVxuICAgICAgICAgICAgICAgICAgICAuZG9tYWluKFswLCBkMy5tYXgoZ3JvdXBzLmN1cnJlbnQuZGF0YSwgZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQgKyAxMDsgfSldKVxuICAgICAgICAgICAgICAgICAgICAucmFuZ2UoW2hlaWdodCwgMF0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIGxpbmUgPSBkMy5zdmcubGluZSgpXG4gICAgICAgICAgICAgICAgICAgIC5pbnRlcnBvbGF0ZSgnYmFzaXMnKVxuICAgICAgICAgICAgICAgICAgICAueChmdW5jdGlvbihkLCBpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geChub3cgLSAobGltaXQgLSAxIC0gaSkgKiBkdXJhdGlvbilcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLnkoZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHkoZClcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgeFN2ZyA9IGQzLnNlbGVjdCgnLmdyYXBoJykuYXBwZW5kKCdzdmcnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignd2lkdGgnLCAyNSlcbiAgICAgICAgICAgICAgICAgICAgLnN0eWxlKCdvdmVyZmxvdycsICd2aXNpYmxlJylcbiAgICAgICAgICAgICAgICAgICAgLnN0eWxlKCdwb3NpdGlvbicsICdmaXhlZCcpO1xuXG4gICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICB2YXIgeUF4aXMgPSB4U3ZnLmFwcGVuZCgnZycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICd5IGF4aXMnKVxuICAgICAgICAgICAgICAgICAgICAvLyAuYXR0cigndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZSgwLCcgKyB3aWR0aCArICcpJylcbiAgICAgICAgICAgICAgICAgICAgLmNhbGwoeS5heGlzID0gZDMuc3ZnLmF4aXMoKS5zY2FsZSh5KS5vcmllbnQoJ2xlZnQnKSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIHN2Zz0gZDMuc2VsZWN0KCcuZ3JhcGgnKS5hcHBlbmQoJ3N2ZycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdjaGFydCcpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd3aWR0aCcsIHdpZHRoIC0gNTApXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdoZWlnaHQnLCBoZWlnaHQgKyA1MCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIC5zdHlsZSgnb3ZlcmZsb3cnLCBcInZpc2libGVcIik7XG5cbiAgICAgICAgICAgICAgICB2YXIgYXhpcyA9IHN2Zy5hcHBlbmQoJ2cnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAneCBheGlzJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoMCwnICsgaGVpZ2h0ICsgJyknKVxuICAgICAgICAgICAgICAgICAgICAuY2FsbCh4LmF4aXMgPSBkMy5zdmcuYXhpcygpLnNjYWxlKHgpLm9yaWVudCgnYm90dG9tJykpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHBhdGhzID0gc3ZnLmFwcGVuZCgnZycpO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBncm91cHMpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdyb3VwID0gZ3JvdXBzW25hbWVdO1xuICAgICAgICAgICAgICAgICAgICBncm91cC5wYXRoID0gcGF0aHMuYXBwZW5kKCdwYXRoJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYXRhKFtncm91cC5kYXRhXSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsIG5hbWUgKyAnIGdyb3VwJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdHlsZSgnc3Ryb2tlJywgZ3JvdXAuY29sb3IpXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gdGljaygpIHtcbiAgICAgICAgICAgICAgICAgICAgbm93ID0gbmV3IERhdGUoKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBBZGQgbmV3IHZhbHVlc1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBuYW1lIGluIGdyb3Vwcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdyb3VwID0gZ3JvdXBzW25hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXAuZGF0YS5wdXNoKHNjb3BlLmVkZ2VEYXRhIHx8IDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXAucGF0aC5hdHRyKCdkJywgbGluZSlcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIFNoaWZ0IGRvbWFpblxuICAgICAgICAgICAgICAgICAgICB4LmRvbWFpbihbbm93IC0gKGxpbWl0IC0gMikgKiBkdXJhdGlvbiwgbm93IC0gZHVyYXRpb25dKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBTbGlkZSB4LWF4aXMgbGVmdFxuICAgICAgICAgICAgICAgICAgICBheGlzLnRyYW5zaXRpb24oKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmR1cmF0aW9uKGR1cmF0aW9uKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVhc2UoJ2xpbmVhcicpXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2FsbCh4LmF4aXMpO1xuXG4gICAgICAgICAgICAgICAgICAgIHlBeGlzLnRyYW5zaXRpb24oKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmR1cmF0aW9uKGR1cmF0aW9uKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVhc2UoJ2xpbmVhcicpXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2FsbCh5LmF4aXMpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFNsaWRlIHBhdGhzIGxlZnRcbiAgICAgICAgICAgICAgICAgICAgcGF0aHMuYXR0cigndHJhbnNmb3JtJywgbnVsbClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kdXJhdGlvbihkdXJhdGlvbilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lYXNlKCdsaW5lYXInKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoJyArIHgobm93IC0gKGxpbWl0IC0gMSkgKiBkdXJhdGlvbikgKyAnKScpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZWFjaCgnZW5kJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGljaygpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgb2xkZXN0IGRhdGEgcG9pbnQgZnJvbSBlYWNoIGdyb3VwXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIG5hbWUgaW4gZ3JvdXBzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ3JvdXAgPSBncm91cHNbbmFtZV07XG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cC5kYXRhLnNoaWZ0KClcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aWNrKClcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJue1xuICAgICAgICAgICAgICAgIHJlc3RyaWN0OidFQScsXG4gICAgICAgICAgICAgICAgcmVwbGFjZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb25lZGdldGVtcGxhdGUuaHRtbCcsXG4gICAgICAgICAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUpe1xuICAgICAgICAgICAgICAgICAgICBzY29wZS4kd2F0Y2hHcm91cChbJ2VkZ2VEYXRhJywgJ29sZEVkZ2VEYXRhJ10sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2NvcGUuZWRnZURhdGEgIT0gbnVsbCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUub2xkRWRnZURhdGEgIT0gbnVsbCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzY29wZS5pbml0aWFsaXplKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5pbml0aWFsaXplID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkMyA9ICR3aW5kb3cuZDM7ICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc3VhbGl6YXRpb25FZGdlRDMoc2NvcGUsIGQzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIF1cbik7XG5cblxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52aXN1YWxpemF0aW9uJylcbiAgICAuc2VydmljZSgnU3RhdGVTYXZlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNhdmVkU3RhdGVzID0ge307XG4gICAgfSlcbiAgICAuZGlyZWN0aXZlKFwidmlzdWFsaXphdGlvbkdyYXBoXCIsIFsnJHdpbmRvdycsICckc3RhdGUnLCAnVmlzdWFsaXplckdyYXBoJywgJ1BvbGljeVNlcnZpY2UnLCAnVmlzdWFsaXplckRhdGFTb3VyY2UnLCAnU3RhdGVTYXZlJyxcbiAgICAgICAgZnVuY3Rpb24oJHdpbmRvdywgJHN0YXRlLCBWaXN1YWxpemVyR3JhcGgsIFBvbGljeVNlcnZpY2UsIFZpc3VhbGl6ZXJEYXRhU291cmNlLCBTdGF0ZVNhdmUpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIHZpc3VhbGl6YXRpb25saXN0ZDMoc2NvcGUsIGVsZW0sIFZpc3VhbGl6ZXJHcmFwaCwgUG9saWN5U2VydmljZSwgVmlzdWFsaXplckRhdGFTb3VyY2UsIFN0YXRlU2F2ZSkge1xuICAgICAgICAgICAgICAgIC8vZG9uJ3QgcnVuIHVudGlsIGFsbCBpbml0aWFsaXphdGlvbiBjYWxscyBoYXZlIHJldHVybmVkXG4gICAgICAgICAgICAgICAgaWYgKHNjb3BlLm5vZGVzID09PSB1bmRlZmluZWQgfHwgc2NvcGUubGlua3MgPT09IHVuZGVmaW5lZCB8fCBzY29wZS5jaGlsZHJlbl9zdHJ1Y3QgPT09IHVuZGVmaW5lZCB8fFxuICAgICAgICAgICAgICAgICAgICBzY29wZS5hbmNlc3RvcnNfc3RydWN0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vY3JlYXRpbmcgRGF0YVNvdXJjZVxuICAgICAgICAgICAgICAgIHZhciBkYXRhU291cmNlID0gbmV3IFZpc3VhbGl6ZXJEYXRhU291cmNlLkRhdGFTb3VyY2Uoc2NvcGUubm9kZXMsIHNjb3BlLmxpbmtzLCBzY29wZS5jaGlsZHJlbl9zdHJ1Y3QsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuYW5jZXN0b3JzX3N0cnVjdCwgc2NvcGUubGFiZWxzLCBzY29wZS5zZXJ2aWNlU2VsZWN0b3JzKTtcbiAgICAgICAgICAgICAgICBkYXRhU291cmNlLnNldEFuY2VzdG9ycygpO1xuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzLCBsaW5rcztcblxuICAgICAgICAgICAgICAgIHZhciB0b3BEYXRhID0gZGF0YVNvdXJjZS5nZXRUb3BMZXZlbEZsb3coKTtcbiAgICAgICAgICAgICAgICBub2RlcyA9IGRhdGFTb3VyY2UucHJvY2Vzc05vZGVEYXRhKHRvcERhdGEubm9kZURhdGEpO1xuICAgICAgICAgICAgICAgIGxpbmtzID0gZGF0YVNvdXJjZS5wcm9jZXNzTGlua0RhdGEodG9wRGF0YS5saW5rRGF0YSwgbm9kZXMpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGJvZHlFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF07XG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IGJvZHlFbC5jbGllbnRXaWR0aCxcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gIGJvZHlFbC5jbGllbnRIZWlnaHQ7XG5cbiAgICAgICAgICAgICAgICAvKiogTUFJTiBTVkcgKiovXG4gICAgICAgICAgICAgICAgdmFyIHJhd1N2Zz1lbGVtLmZpbmQoJ3N2ZycpO1xuXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9ICQocmF3U3ZnLnBhcmVudCgpKS5vZmZzZXQoKTtcblxuICAgICAgICAgICAgICAgIHZhciBkaXZXaWR0aCA9ICQocmF3U3ZnLnBhcmVudCgpKS53aWR0aCgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN2ZyA9IGQzLnNlbGVjdChyYXdTdmdbMF0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwid2lkdGhcIiwgZGl2V2lkdGgpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGhlaWdodCAtIG9mZnNldC50b3AgLSAyMCk7XG5cbiAgICAgICAgICAgICAgICAvL2luc3RhbGxpbmcgcG9saWNpZXNcbiAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGggPSBuZXcgVmlzdWFsaXplckdyYXBoLkdyYXBoKHN2Zywgbm9kZXMsIGxpbmtzLCBkYXRhU291cmNlLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5jaGlsZHJlbl9zdHJ1Y3QsIHNjb3BlLmFuY2VzdG9yc19zdHJ1Y3QpO1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5pbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3kobmV3IFBvbGljeVNlcnZpY2UuU2F2ZVN0YXRlUG9saWN5KFN0YXRlU2F2ZS5zYXZlZFN0YXRlcykpO1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5pbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3kobmV3IFBvbGljeVNlcnZpY2UuUGF0aENoYW5nZVZpZXdQb2xpY3koJHN0YXRlKSk7XG4gICAgICAgICAgICAgICAgLy9RVGlwUG9saWN5IGlzIGZvciBib3RoIE5vZGVzIGFuZCBQYXRocywgaW5zdGFsbCBzYW1lIG9uZSBvbiBib3RoXG4gICAgICAgICAgICAgICAgdmFyIHFUaXBQb2xpY3kgPSBuZXcgUG9saWN5U2VydmljZS5RVGlwUG9saWN5KCk7XG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmluc3RhbGxEZWZhdWx0Tm9kZVBvbGljeShxVGlwUG9saWN5KTtcbiAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGguaW5zdGFsbERlZmF1bHRQYXRoUG9saWN5KHFUaXBQb2xpY3kpO1xuICAgICAgICAgICAgICAgIHZhciBzcGxpdEpvaW5WaWV3UG9saWN5ID0gbmV3IFBvbGljeVNlcnZpY2UuU3BsaXRKb2luVmlld1BvbGljeSgpO1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5pbnN0YWxsRGVmYXVsdE5vZGVQb2xpY3koc3BsaXRKb2luVmlld1BvbGljeSk7XG4gICAgICAgICAgICAgICAgc3BsaXRKb2luVmlld1BvbGljeS5pbnN0YWxsQmFja0J1dHRvbigkKCcjYmFja0J1dHRvbicpKTtcbiAgICAgICAgICAgICAgICBzcGxpdEpvaW5WaWV3UG9saWN5Lmluc3RhbGxUaXRsZSgkKCcjZ3JhcGgtdGl0bGUnKSk7XG5cbiAgICAgICAgICAgICAgICAvL2xvYWQgb2xkIHZpZXcgaWYgaXQgZXhpc3RzLlxuICAgICAgICAgICAgICAgIGlmIChfLmlzRW1wdHkoU3RhdGVTYXZlLnNhdmVkU3RhdGVzKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ3JhcGggPSBzY29wZS52aXN1YWxpemF0aW9uR3JhcGg7XG4gICAgICAgICAgICAgICAgICAgIGdyYXBoLmxvYWQoU3RhdGVTYXZlLnNhdmVkU3RhdGVzKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybntcbiAgICAgICAgICAgICAgICByZXN0cmljdDonRUEnLFxuICAgICAgICAgICAgICAgIHJlcGxhY2U6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9udGVtcGxhdGUuaHRtbCcsXG4gICAgICAgICAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW0pe1xuICAgICAgICAgICAgICAgICAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkgeyBcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykudW5iaW5kKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGguZGVzdHJveSgpO30pO1xuICAgICAgICAgICAgICAgICAgICBzY29wZS4kd2F0Y2hHcm91cChbJ25vZGVzJywgJ2xpbmtzJywgJ2NoaWxkcmVuX3N0cnVjdCcsICdhbmNlc3RvcnNfc3RydWN0J10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2NvcGUubm9kZXMgIT0gbnVsbCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5saW5rcyAhPSBudWxsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmNoaWxkcmVuX3N0cnVjdCAhPSBudWxsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmFuY2VzdG9yc19zdHJ1Y3QgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2NvcGUuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXN1YWxpemF0aW9ubGlzdGQzKHNjb3BlLCBlbGVtLCBWaXN1YWxpemVyR3JhcGgsIFBvbGljeVNlcnZpY2UsIFZpc3VhbGl6ZXJEYXRhU291cmNlLCBTdGF0ZVNhdmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5kYXRhU291cmNlLmxpbmtzID0gc2NvcGUubGlua3M7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC51cGRhdGVMaW5rRGF0YSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICB9XG4gICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICBdXG4pO1xuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52aXN1YWxpemF0aW9uLmxpc3QnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWaXN1YWxpemF0aW9uTGlzdEN0cmwgYXMgdmlzdWFsaXphdGlvbkxpc3RDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Zpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbmxpc3QuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignVmlzdWFsaXphdGlvbkxpc3RDdHJsJywgW1wiJHNjb3BlXCIsIFwiJGh0dHBcIiwgJ1Zpc3VhbGl6YXRpb25TZXJ2aWNlJywgJyRpbnRlcnZhbCcsIFxuICAgICAgICBmdW5jdGlvbigkc2NvcGUsICRodHRwLCBWaXN1YWxpemF0aW9uU2VydmljZSwgJGludGVydmFsKSB7XG4gICAgICAgICAgICAvL3RvIHNlZSB0aGUgZXhwZWN0ZWQgZm9ybWF0IHRvIGJlIHJldHVybmVkIGZyb20gdGhlc2UgY2FsbHMsXG4gICAgICAgICAgICAvL2xvb2sgYXQgYXBwL2NvbXBvbmVudHMvZ3JhcGhvYmplY3RzL2RhdGFzb3VyY2UvdmlzdWFsaXplcmRhdGFzb3VyY2UuanNcbiAgICAgICAgICAgIHZhciBzdWNjZXNzR3JhcGhEYXRhQ2FsbGJhY2sgPSBmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgbGlua3MgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZUlkcyA9IFtdO1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaChyZXN1bHQucmVzdWx0c1swXS5zZXJpZXMsIGZ1bmN0aW9uKHNlcmllcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZW5kcG9pbnQgPSBzZXJpZXMudGFncy5FbmRwb2ludElQO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJvdmlkZXIgPSBzZXJpZXMudGFncy5Qcm92aWRlcklQO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZTtcbiAgICAgICAgICAgICAgICAgICAgLy9jcmVhdGluZyBub2Rlc1xuICAgICAgICAgICAgICAgICAgICBpZiAoXy5pbmNsdWRlcyhub2RlSWRzLCBlbmRwb2ludCkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogZW5kcG9pbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGVuZHBvaW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNlc3RvcnM6IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlkcy5wdXNoKGVuZHBvaW50KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoXy5pbmNsdWRlcyhub2RlSWRzLCBwcm92aWRlcikgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogcHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHByb3ZpZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNlc3RvcnM6IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlkcy5wdXNoKHByb3ZpZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvL2NyZWF0aW5nIGxpbmtzXG4gICAgICAgICAgICAgICAgICAgIHZhciBsaW5rT3V0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiBlbmRwb2ludCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogcHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ6IHNlcmllcy52YWx1ZXNbMF1bMl1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgbGlua3MucHVzaChsaW5rT3V0KTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxpbmtJbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogcHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IGVuZHBvaW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0OiBzZXJpZXMudmFsdWVzWzBdWzFdXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGxpbmtzLnB1c2gobGlua0luKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAkc2NvcGUubm9kZXMgPSBub2RlcztcbiAgICAgICAgICAgICAgICAkc2NvcGUubGlua3MgPSBsaW5rcztcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAvL2luaXRpYWwgY2FsbFxuICAgICAgICAgICAgVmlzdWFsaXphdGlvblNlcnZpY2UuZ2V0R3JhcGhEYXRhKCkudGhlbihzdWNjZXNzR3JhcGhEYXRhQ2FsbGJhY2ssIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy93aWxsIGZhaWwgc2lsZW50bHksIGdyYXBoIHdvbid0IGJlIGRpc3BsYXllZFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkgeyAkaW50ZXJ2YWwuY2FuY2VsKCRzY29wZS5ncmFwaERhdGFJbnRlcnZhbCk7IH0pO1xuXG4gICAgICAgICAgICBWaXN1YWxpemF0aW9uU2VydmljZS5nZXRTdHJ1Y3R1cmVEYXRhKCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy90byBzZWUgdGhlIGV4cGVjdGVkIGZvcm0gb2YgYW5jZXN0b3Jfc3RydWN0IGFuZCBjaGlsZHJlbl9zdHJ1Y3QsIFxuICAgICAgICAgICAgICAgIC8vbG9vayBhdCBhcHAvY29tcG9uZW50cy9ncmFwaG9iamVjdHMvZGF0YXNvdXJjZS92aXN1YWxpemVyZGF0YXNvdXJjZS5qc1xuICAgICAgICAgICAgICAgICRzY29wZS5hbmNlc3RvcnNfc3RydWN0ID0gcmVzdWx0LmFuY2VzdG9yc19zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoaWxkcmVuX3N0cnVjdCA9IHJlc3VsdC5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxhYmVscyA9IHJlc3VsdC5sYWJlbHM7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlcnZpY2VTZWxlY3RvcnMgPSByZXN1bHQuc2VydmljZVNlbGVjdG9ycztcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy93aWxsIGZhaWwgc2lsZW50bHksIGdyYXBoIHdvbid0IGJlIGRpc3BsYXllZFxuICAgICAgICAgICAgfSk7XG4gICAgfV0pO1xuXG5cblxuXG5cblxuXG5cblxuXG5cblxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52aXN1YWxpemF0aW9uJylcbiAgICAuZmFjdG9yeSgnVmlzdWFsaXphdGlvblNlcnZpY2UnLCBbJyRodHRwJywgJyRxJywgZnVuY3Rpb24gKCRodHRwLCAkcSkge1xuICAgICAgICAvKipcbiAgICAgICAgICogTWFrZXMgYSBnZXQgcmVxdWVzdCB3aXRoIHRoZSB1cmwgYW5kIGNvbmZpZy5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHVybCAgICAgVGhlIHVybFxuICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgY29uZmlnICBUaGUgY29uZmlndXJhdGlvbnNcbiAgICAgICAgICogQHJldHVybiAgICAgeyRIdHRwIFByb21pc2V9ICAgUHJvbWlzZSBvZiB0aGUgcmVxdWVzdFxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gbWFrZUdldCh1cmwsIGNvbmZpZykge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICRodHRwLmdldCh1cmwsIGNvbmZpZykudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1ha2VzIGEgcG9zdCByZXF1ZXN0IHdpdGggdGhlIHVybCBhbmQgZGF0YVxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgdXJsICAgICBUaGUgdXJsXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtKU09OfSAgICBkYXRhICAgIFRoZSBkYXRhXG4gICAgICAgICAqIEByZXR1cm4gICAgIHskSHR0cCBQcm9taXNlfSAgIFByb21pc2Ugb2YgdGhlIHJlcXVlc3RcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIG1ha2VQb3N0KHVybCwgZGF0YSkge1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBjb252ZXJ0cyB0aGUgZGF0YSBpbnRvIHgtd3d3LWZyb20tdXJsZW5jb2RlZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtKU09OfSAgb2JqICAgICBKU09OIGRhdGEgb2JqZWN0XG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7c3RyaW5nfSAgeC13d3ctZm9ybS11cmxlbmNvZGVkIHN0cmluZ1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB2YXIgcGFyYW0gPSBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICAgICAgICB2YXIgcXVlcnkgPSAnJywgbmFtZSwgdmFsdWUsIGZ1bGxTdWJOYW1lLCBzdWJOYW1lLCBzdWJWYWx1ZSwgaW5uZXJPYmosIGk7XG4gICAgICAgICAgICAgICAgZm9yIChuYW1lIGluIG9iaikge1xuICAgICAgICAgICAgICAgICAgdmFsdWUgPSBvYmpbbmFtZV07XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaT0wOyBpPHZhbHVlLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViVmFsdWUgPSB2YWx1ZVtpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdWxsU3ViTmFtZSA9IG5hbWUgKyAnWycgKyBpICsgJ10nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlubmVyT2JqID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5uZXJPYmpbZnVsbFN1Yk5hbWVdID0gc3ViVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkgKz0gcGFyYW0oaW5uZXJPYmopICsgJyYnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHN1Yk5hbWUgaW4gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJWYWx1ZSA9IHZhbHVlW3N1Yk5hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bGxTdWJOYW1lID0gbmFtZSArICdbJyArIHN1Yk5hbWUgKyAnXSc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5uZXJPYmogPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbm5lck9ialtmdWxsU3ViTmFtZV0gPSBzdWJWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeSArPSBwYXJhbShpbm5lck9iaikgKyAnJic7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZih2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHZhbHVlICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyeSArPSBlbmNvZGVVUklDb21wb25lbnQobmFtZSkgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQodmFsdWUpICsgJyYnO1xuICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gcXVlcnkubGVuZ3RoID8gcXVlcnkuc3Vic3RyKDAsIHF1ZXJ5Lmxlbmd0aCAtIDEpIDogcXVlcnk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgIHVybDp1cmwsXG4gICAgICAgICAgICAgICAgbWV0aG9kOidQT1NUJyxcbiAgICAgICAgICAgICAgICBkYXRhOiBkYXRhLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJ1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdHJhbnNmb3JtUmVxdWVzdDogW2Z1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFuZ3VsYXIuaXNPYmplY3QoZGF0YSkgJiYgU3RyaW5nKGRhdGEpICE9PSAnW29iamVjdCBGaWxlXScgPyBwYXJhbShkYXRhKSA6IGRhdGE7XG4gICAgICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRHcmFwaERhdGEoKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WSVNVQUxJWkFUSU9OX0VORFBPSU5UO1xuICAgICAgICAgICAgdXJsICs9ICdpbmZsdXgvcXVlcnknO1xuICAgICAgICAgICAgdmFyIGNvbmZpZyA9IHtcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICAgICAgICAgICAgZGI6XCJ0ZWxlZ3JhZlwiLFxuICAgICAgICAgICAgICAgICAgICBxOlwiU0VMRUNUIEJ5dGVzSW4sIEJ5dGVzT3V0LCBFbmRwb2ludElQLCBQcm92aWRlcklQIEZST00gaHR0cGpzb25fc3Zjc3RhdHMgV0hFUkUgdGltZSA+IG5vdygpIC0gMW0gR1JPVVAgQlkgKiBMSU1JVCAxXCJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIG1ha2VHZXQodXJsLCBjb25maWcpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0U3RydWN0dXJlRGF0YSgpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLlZJU1VBTElaQVRJT05fRU5EUE9JTlQ7XG4gICAgICAgICAgICB1cmwgKz0gJ3NlcnZpY2VzJztcbiAgICAgICAgICAgIHJldHVybiBtYWtlR2V0KHVybCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBidWlsZFdoZXJlUXVlcnkocG9pbnRzLCB0eXBlKSB7XG4gICAgICAgICAgICB2YXIgcXVlcnkgPSBcIihcIjtcbiAgICAgICAgICAgIHF1ZXJ5ICs9IHR5cGUgKyBcIj1cIjtcbiAgICAgICAgICAgIHF1ZXJ5ICs9IFwiJ1wiICsgcG9pbnRzWzBdICsgXCInIFwiO1xuICAgICAgICAgICAgLy9zdGFydHMgYXQgMSwgc28gd2lsbCBub3QgcnVuIGlmIGxlbmd0aCBpcyAxXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IHBvaW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHF1ZXJ5ICs9ICdPUiAnO1xuICAgICAgICAgICAgICAgIHF1ZXJ5ICs9IHR5cGUgKyBcIj1cIjtcbiAgICAgICAgICAgICAgICBxdWVyeSArPSBcIidcIiArIHBvaW50c1tpXSArIFwiJyBcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHF1ZXJ5ICs9IFwiKVwiO1xuICAgICAgICAgICAgcmV0dXJuIHF1ZXJ5O1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0RWRnZURhdGEoc291cmNlTGlzdCwgdGFyZ2V0TGlzdCwgdGltZSkge1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuVklTVUFMSVpBVElPTl9FTkRQT0lOVDtcbiAgICAgICAgICAgIHVybCArPSAnaW5mbHV4L3F1ZXJ5JztcblxuICAgICAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgICAgIGRiIDogXCJ0ZWxlZ3JhZlwiLFxuICAgICAgICAgICAgICAgICAgICBxOiBcIlNFTEVDVCBzdW0oXCIgKyAnQnl0ZXNPdXQnICsgXCIpIGZyb20gaHR0cGpzb25fc3Zjc3RhdHMgV0hFUkUgdGltZSA+IG5vdygpIC0gMTVzIEFORCBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHNvdXJjZUxpc3QsIFwiRW5kcG9pbnRJUFwiKSArXCIgQU5EIFwiIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHRhcmdldExpc3QsICdQcm92aWRlcklQJykgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBcIkdST1VQIEJZIHRpbWUoMjBzKSBMSU1JVCAxOyBTRUxFQ1Qgc3VtKFwiICsgJ0J5dGVzSW4nICsgXCIpIGZyb20gaHR0cGpzb25fc3Zjc3RhdHMgV0hFUkUgdGltZSA+IG5vdygpIC0gMTVzIEFORCBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHNvdXJjZUxpc3QsICdQcm92aWRlcklQJykgK1wiIEFORCBcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeSh0YXJnZXRMaXN0LCAnRW5kcG9pbnRJUCcpIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgXCJHUk9VUCBCWSB0aW1lKDIwcykgZmlsbCgwKSBMSU1JVCAxXCJcbiAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gbWFrZVBvc3QodXJsLCBkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIFxuXG4gICAgICAgIGZ1bmN0aW9uIGdldE9sZEVkZ2VEYXRhKHNvdXJjZUxpc3QsIHRhcmdldExpc3QpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLlZJU1VBTElaQVRJT05fRU5EUE9JTlQ7XG4gICAgICAgICAgICB1cmwgKz0gJ2luZmx1eC9xdWVyeSc7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICAgICAgZGIgOiBcInRlbGVncmFmXCIsXG4gICAgICAgICAgICAgICAgICAgIHE6IFwiU0VMRUNUIHN1bShcIiArICdCeXRlc091dCcgKyBcIikgRlJPTSBodHRwanNvbl9zdmNzdGF0cyBXSEVSRSB0aW1lID4gbm93KCkgLSAxbSBBTkQgXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeShzb3VyY2VMaXN0LCBcIkVuZHBvaW50SVBcIikgK1wiIEFORCBcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeSh0YXJnZXRMaXN0LCBcIlByb3ZpZGVySVBcIikgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBcIiBHUk9VUCBCWSB0aW1lKDEwcykgZmlsbCgwKSBMSU1JVCA2OyBTRUxFQ1Qgc3VtKFwiICsgJ0J5dGVzSW4nICsgXCIpIEZST00gaHR0cGpzb25fc3Zjc3RhdHMgV0hFUkUgdGltZSA+IG5vdygpIC0gMW0gQU5EIFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkoc291cmNlTGlzdCwgXCJQcm92aWRlcklQXCIpICtcIiBBTkQgXCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkodGFyZ2V0TGlzdCwgXCJFbmRwb2ludElQXCIpIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgXCIgR1JPVVAgQlkgdGltZSgxMHMpIGZpbGwoMCkgTElNSVQgNlwiXG4gICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIG1ha2VQb3N0KHVybCwgZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0R3JhcGhEYXRhOiBnZXRHcmFwaERhdGEsXG4gICAgICAgICAgICBnZXRTdHJ1Y3R1cmVEYXRhOiBnZXRTdHJ1Y3R1cmVEYXRhLFxuICAgICAgICAgICAgZ2V0RWRnZURhdGE6IGdldEVkZ2VEYXRhLFxuICAgICAgICAgICAgZ2V0T2xkRWRnZURhdGE6IGdldE9sZEVkZ2VEYXRhXG4gICAgICAgIH1cbiAgICB9XSk7XG5cblxuXG5cblxuXG5cbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNi8zLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZvbHVtZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52b2x1bWVzLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2b2x1bWVzL3ZvbHVtZWNyZWF0ZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWb2x1bWVDcmVhdGVDdHJsIGFzIHZvbHVtZUNyZWF0ZUN0cmwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdWb2x1bWVDcmVhdGVDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ1ZvbHVtZXNNb2RlbCcsICdTdG9yYWdlUG9saWNpZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBWb2x1bWVzTW9kZWwsIFN0b3JhZ2VQb2xpY2llc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgdm9sdW1lQ3JlYXRlQ3RybCA9IHRoaXM7XG4gICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwuZmlsZXN5c3RlbXMgPSBbJ2V4dDQnLCAnYnRyZnMnXTtcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Wb2x1bWVzTW9kZWwoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZvbHVtZXMubGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbENyZWF0aW5nKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9Wb2x1bWVzTW9kZWwoKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IHN0b3JhZ2UgcG9saWNpZXMuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBnZXRTdG9yYWdlUG9saWNpZXMoKSB7XG4gICAgICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbC5nZXQoKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLnBvbGljaWVzID0gcmVzdWx0O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gYXBwbHlQb2xpY3lTZXR0aW5ncygpIHtcbiAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwubmV3Vm9sdW1lLnBvbGljeSA9IHZvbHVtZUNyZWF0ZUN0cmwuc2VsZWN0ZWRQb2xpY3kubmFtZTtcbiAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwubmV3Vm9sdW1lLmJhY2tlbmRzID0gdm9sdW1lQ3JlYXRlQ3RybC5zZWxlY3RlZFBvbGljeS5iYWNrZW5kcztcbiAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwubmV3Vm9sdW1lLmRyaXZlciA9IHZvbHVtZUNyZWF0ZUN0cmwuc2VsZWN0ZWRQb2xpY3kuZHJpdmVyO1xuICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUuY3JlYXRlID0gdm9sdW1lQ3JlYXRlQ3RybC5zZWxlY3RlZFBvbGljeS5jcmVhdGU7XG4gICAgICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLm5ld1ZvbHVtZS5ydW50aW1lID0gdm9sdW1lQ3JlYXRlQ3RybC5zZWxlY3RlZFBvbGljeS5ydW50aW1lO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZVZvbHVtZSgpIHtcbiAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgaWYgKHZvbHVtZUNyZWF0ZUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgYXBwbHlQb2xpY3lTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIFZvbHVtZXNNb2RlbC5jcmVhdGUodm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1ZvbHVtZXNNb2RlbCgpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcih2b2x1bWVDcmVhdGVDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJlc2V0Rm9ybSgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLm5ld1ZvbHVtZSA9IHtcbiAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICBcImJhY2tlbmRzXCI6IHt9LFxuICAgICAgICAgICAgICAgIFwiZHJpdmVyXCI6IHt9LFxuICAgICAgICAgICAgICAgIFwiY3JlYXRlXCI6IHt9LFxuICAgICAgICAgICAgICAgIFwicnVudGltZVwiOiB7fVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLmNyZWF0ZVZvbHVtZSA9IGNyZWF0ZVZvbHVtZTtcbiAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5jYW5jZWxDcmVhdGluZyA9IGNhbmNlbENyZWF0aW5nO1xuICAgICAgICBnZXRTdG9yYWdlUG9saWNpZXMoKTtcbiAgICAgICAgcmVzZXRGb3JtKCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dm9sdW1lY3JlYXRlY3RybC5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSBjc2hhbXB1ciBvbiA4LzkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudm9sdW1lcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZvbHVtZXMuY29weScsIHtcbiAgICAgICAgICAgIHVybDogJy9jb3B5LycsXG4gICAgICAgICAgICBwYXJhbXM6IHsgc25hcHNob3Q6IG51bGwsIHBvbGljeTogbnVsbCwgdm9sdW1lOiBudWxsIH0sXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVm9sdW1lU25hcHNob3RDb3B5Q3RybCBhcyB2b2x1bWVTbmFwc2hvdENvcHlDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndm9sdW1lcy92b2x1bWVzbmFwc2hvdGNvcHkuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1ZvbHVtZVNuYXBzaG90Q29weUN0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckaHR0cCcsICdWb2x1bWVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgJHNjb3BlLCAkaW50ZXJ2YWwsICRodHRwLCBWb2x1bWVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2b2x1bWVTbmFwc2hvdENvcHlDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ29weSgpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUudm9sdW1lcy5kZXRhaWxzJywgeyBrZXk6ICRzdGF0ZVBhcmFtcy5wb2xpY3kgKyAnLycgKyAkc3RhdGVQYXJhbXMudm9sdW1lIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdvVG9OZXdWb2x1bWUoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZvbHVtZXMuZGV0YWlscycsIHsga2V5OiAkc3RhdGVQYXJhbXMucG9saWN5ICsgJy8nICsgdm9sdW1lU25hcHNob3RDb3B5Q3RybC5uZXd2b2x1bWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY29weVNuYXBzaG90KCkge1xuICAgICAgICAgICAgaWYgKHZvbHVtZVNuYXBzaG90Q29weUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iodm9sdW1lU25hcHNob3RDb3B5Q3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIodm9sdW1lU25hcHNob3RDb3B5Q3RybCk7XG4gICAgICAgICAgICAgICAgdmFyIG1vZGVsID0ge307XG4gICAgICAgICAgICAgICAgbW9kZWwucG9saWN5ID0gJHN0YXRlUGFyYW1zLnBvbGljeTtcbiAgICAgICAgICAgICAgICBtb2RlbC5uYW1lID0gJHN0YXRlUGFyYW1zLnZvbHVtZTtcbiAgICAgICAgICAgICAgICBWb2x1bWVzTW9kZWwuY29weShtb2RlbCwgJHN0YXRlUGFyYW1zLnNuYXBzaG90LCB2b2x1bWVTbmFwc2hvdENvcHlDdHJsLm5ld3ZvbHVtZSlcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZVNuYXBzaG90Q29weUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBnb1RvTmV3Vm9sdW1lKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVTbmFwc2hvdENvcHlDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHZvbHVtZVNuYXBzaG90Q29weUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdm9sdW1lU25hcHNob3RDb3B5Q3RybC5wb2xpY3kgPSAkc3RhdGVQYXJhbXMucG9saWN5O1xuICAgICAgICB2b2x1bWVTbmFwc2hvdENvcHlDdHJsLnZvbHVtZSA9ICRzdGF0ZVBhcmFtcy52b2x1bWU7XG4gICAgICAgIHZvbHVtZVNuYXBzaG90Q29weUN0cmwuc25hcHNob3QgPSAkc3RhdGVQYXJhbXMuc25hcHNob3Q7XG4gICAgICAgIHZvbHVtZVNuYXBzaG90Q29weUN0cmwuY29weVNuYXBzaG90ID0gY29weVNuYXBzaG90O1xuICAgICAgICB2b2x1bWVTbmFwc2hvdENvcHlDdHJsLmNhbmNlbENvcHkgPSBjYW5jZWxDb3B5O1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXZvbHVtZXNuYXBzaG90Y29weWN0cmwuanMubWFwXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5kaXJlY3RpdmVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dkFjaXZhbGlkXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy9ub2Rlcy9hY2l2YWxpZC5odG1sJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgZm9ybTogXCI9XCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTtcbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2Q29udHJvbGludGVyZmFjZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvbm9kZXMvY29udHJvbGludGVyZmFjZS5odG1sJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgZXh0cmF2YXJzOiBcIj1cIlxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pO1xuYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZOZXR3b3JrbW9kZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvbm9kZXMvbmV0d29ya21vZGUuaHRtbCcsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIGV4dHJhdmFyczogXCI9XCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTtcbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2U2NoZWR1bGVyXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy9ub2Rlcy9zY2hlZHVsZXIuaHRtbCcsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIGV4dHJhdmFyczogXCI9XCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTsiLCIvKipcbiAqIERlZmluaW5nIHRoZSBHcmFwaCBNb2R1bGUuXG4gKiBTZWUgREVTSUdOLm1kIGZvciBpbmZvIG9uIEdyYXBoIE9iamVjdHMuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnLCBbXSk7XG5cblxuXG5cbiIsImFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIiwgW10pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8xNC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5tb2RlbHMnLCBbXSk7XG52YXIgQ29udGl2R2xvYmFscyA9IChmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgLy9SRVNUIGVuZHBvaW50cyBmb3IgTkVUTUFTVEVSXG4gICAgICAgICdORVRXT1JLU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9uZXR3b3Jrcy8nLFxuICAgICAgICAnTkVUV09SS1NfSU5TUEVDVF9FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9pbnNwZWN0L25ldHdvcmtzLycsXG4gICAgICAgICdTRVJWSUNFTEJTX0lOU1BFQ1RfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvaW5zcGVjdC9zZXJ2aWNlTEJzLycsXG4gICAgICAgICdQT0xJQ0lFU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9wb2xpY3lzLycsXG4gICAgICAgICdSVUxFU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9ydWxlcy8nLFxuICAgICAgICAnQVBQTElDQVRJT05HUk9VUFNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvZW5kcG9pbnRHcm91cHMvJyxcbiAgICAgICAgJ1NFUlZJQ0VMQlNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvc2VydmljZUxCcy8nLFxuICAgICAgICAnT1JHQU5JWkFUSU9OU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS90ZW5hbnRzLycsXG4gICAgICAgICdORVRXT1JLX1NFVFRJTkdTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL2dsb2JhbHMvJyxcbiAgICAgICAgJ05FVFBST0ZJTEVTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL25ldHByb2ZpbGVzLycsXG4gICAgICAgICdCR1BTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL0JncHMvJyxcbiAgICAgICAgJ0JHUFNfSU5TUEVDVF9FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9pbnNwZWN0L0JncHMvJyxcbiAgICAgICAgJ1ZJU1VBTElaQVRJT05fRU5EUE9JTlQnOiAnL3Zpc3VhbGl6YXRpb24vJyxcbiAgICAgICAgLy9SRVNUIGVuZHBvaW50cyBmb3IgVk9MTUFTVEVSXG4gICAgICAgICdWT0xVTUVTX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvdm9sdW1lcy8nLFxuICAgICAgICAnVk9MVU1FU19DUkVBVEVfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci92b2x1bWVzL2NyZWF0ZS8nLFxuICAgICAgICAnVk9MVU1FU19ERUxFVEVfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci92b2x1bWVzL3JlbW92ZS8nLFxuICAgICAgICAnVk9MVU1FU19DT1BZU05BUFNIT1RTX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvdm9sdW1lcy9jb3B5JyxcbiAgICAgICAgJ1ZPTFVNRVNfVVNFU19FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3VzZXMvbW91bnRzLycsXG4gICAgICAgICdWT0xVTUVTX1NOQVBTSE9UU19FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3NuYXBzaG90cy8nLFxuICAgICAgICAnU1RPUkFHRVBPTElDSUVTX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvcG9saWNpZXMvJyxcbiAgICAgICAgJ1ZPTFVNRVNfR0xPQkFMX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvZ2xvYmFsLycsXG4gICAgICAgIC8vUkVTVCBlbmRwb2ludHMgZm9yIENMVVNURVJcbiAgICAgICAgJ05PREVTX0xJU1RfRU5EUE9JTlQnOiAnL2luZm8vbm9kZXMnLFxuICAgICAgICAnTk9ERVNfRElTQ09WRVJfRU5EUE9JTlQnOiAnL2Rpc2NvdmVyL25vZGVzJyxcbiAgICAgICAgJ05PREVTX0NPTU1JU1NJT05fRU5EUE9JTlQnOiAnL2NvbW1pc3Npb24vbm9kZXMnLFxuICAgICAgICAnTk9ERVNfREVDT01NSVNTSU9OX0VORFBPSU5UJzogJy9kZWNvbW1pc3Npb24vbm9kZXMnLFxuICAgICAgICAnTk9ERVNfTUFJTlRFTkFOQ0VfRU5EUE9JTlQnOiAnL21haW50ZW5hbmNlL25vZGVzJyxcbiAgICAgICAgJ05PREVTX0xBU1RfSk9CX0VORFBPSU5UJzogJy9pbmZvL2pvYi9sYXN0JyxcbiAgICAgICAgJ05PREVTX0FDVElWRV9KT0JfRU5EUE9JTlQnOiAnL2luZm8vam9iL2FjdGl2ZScsXG4gICAgICAgICdOT0RFU19TRVRUSU5HU19TRVRfRU5EUE9JTlQnOiAnL2dsb2JhbHMnLFxuICAgICAgICAnTk9ERVNfU0VUVElOR1NfR0VUX0VORFBPSU5UJzogJy9pbmZvL2dsb2JhbHMnLFxuICAgICAgICAvL1JlZnJlc2ggaW50ZXJ2YWwgaW4gbWlsbGlzZWNvbmRzXG4gICAgICAgICdSRUZSRVNIX0lOVEVSVkFMJzogNTAwMCxcbiAgICAgICAgLy9SZWdFeCBmb3IgdmFsaWRhdGlvblxuICAgICAgICAnQ0lEUl9SRUdFWCc6ICdeKChbMC05XXxbMS05XVswLTldfDFbMC05XXsyfXwyWzAtNF1bMC05XXwyNVswLTVdKVxcLil7M30oWzAtOV18WzEtOV1bMC05XXwxWzAtOV17Mn18MlswLTRdWzAtOV18MjVbMC01XSkoXFwvKFswLTldfFsxLTJdWzAtOV18M1swLTJdKSkkJyxcbiAgICAgICAgJ1ZMQU5fUkVHRVgnOiAnXihbMC05XXsxLDR9Py1bMC05XXsxLDR9PykkJyxcbiAgICAgICAgJ1ZYTEFOX1JFR0VYJzogJ14oWzAtOV17MSw4fT8tWzAtOV17MSw4fT8pJCcsXG4gICAgICAgICdOVU1CRVJfUkVHRVgnOiAnXlswLTldKiQnXG4gICAgfTtcbn0pKCk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwIiwiLyoqXG4gKiBUaGUgYmFzZSBjbGFzcyB0aGUgRGF0YVNvdXJjZSBvYmplY3QuXG4gKiBcbiAqIFRoZSBEYXRhU291cmNlIG9iamVjdCB0YWtlcyBpbiBub2RlIGFuZCBsaW5rIGRhdGEgZnJvbSB0aGUgc2VydmVyLCBcbiAqIGFuZCBwcm92aWRlcyBtZXRob2RzIGZvciBjb252ZXJ0aW5nIGFuZCBtYW5pcHVsYXRpbmcgdGhlIGRhdGEgZm9yXG4gKiB0aGUgZ3JhcGggb2JqZWN0LlxuICogXG4gKiBUbyB3cml0ZSB5b3VyIG93biBEYXRhU291cmNlIG9iamVjdCwgY3JlYXRlIGEgbmV3IGZhY3RvcnkgdGhhdCB1c2VzIHRoZSBcbiAqIERhdGFTb3VyY2UgeW91IHdhbnQgdG8gaW5oZXJpdCBhcyBhIGRlcGVuZGVuY3ksIGFuZCBleHRlbmQgXG4gKiBpdHMgRGF0YVNvdXJjZSBjbGFzcy4gXG4gKiBSZXR1cm4gdGhlIGNsYXNzIG9iamVjdCB3aXRoIERhdGFTb3VyY2UgYXMga2V5LlxuICogXG4gKiBOb2RlIGRhdGEgaXMgZXhwZWN0ZWQgdG8gYmUgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6XG4gKiB7aWQ6bm9kZV9pZCwgdGV4dDpub2RlX3RleHR9XG4gKiBcbiAqIExpbmsgZGF0YSBpcyBleHBlY3RlZCB0byBiZSBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDpcbiAqIHtzb3VyY2U6IHNvdXJjZU5vZGVJZCwgdGFyZ2V0OiB0YXJnZXROb2RlSWR9XG4gKiBcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ0RhdGFTb3VyY2UnLCBbJ05vZGUnLCAnTGluaycsIFxuICAgIFx0ZnVuY3Rpb24gKE5vZGUsIExpbmspIHtcblxuICAgIFx0Y2xhc3MgRGF0YVNvdXJjZSB7XG4gICAgXHRcdC8qKlxuICAgIFx0XHQgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgXHRcdCAqXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBub2RlcyAgICAgICAgICAgICAgVGhlIG5vZGUgZGF0YSBcbiAgICBcdFx0ICogQHBhcmFtICAgICAge0FycmF5fSAgIGxpbmtzICAgICAgICAgICAgICBUaGUgbGluayBkYXRhXG4gICAgXHRcdCAqL1xuXHRcdFx0Y29uc3RydWN0b3Iobm9kZXMsIGxpbmtzKSB7XG5cdFx0XHRcdHRoaXMubm9kZXMgPSBub2Rlcztcblx0XHRcdFx0dGhpcy5saW5rcyA9IGxpbmtzO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFJlcGxhY2VzIHRoZSBub2RlIGRhdGFcblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGVzICAgVGhlIG5vZGVzXG5cdFx0XHQgKi9cblx0XHRcdHVwZGF0ZU5vZGVzKG5vZGVzKSB7XG5cdFx0XHRcdHRoaXMubm9kZXMgPSBub2Rlcztcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBSZXBsYWNlcyB0aGUgbGluayBkYXRhXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0xpbmt9ICBsaW5rcyAgIFRoZSBsaW5rc1xuXHRcdFx0ICovXG5cdFx0XHR1cGRhdGVMaW5rcyhsaW5rcykge1xuXHRcdFx0XHR0aGlzLmxpbmtzID0gbGlua3M7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogUmV0dXJucyB0aGUgTmFtZSBhdHRyaWJ1dGUgb2YgdGhlIE5vZGUgd2l0aCB0aGUgXG5cdFx0XHQgKiBtYXRjaGluZyBpZFxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG5cdFx0XHQgKiBAcmV0dXJuICAgICB7c3RyaW5nfSAgbmFtZSBvZiB0aGUgbWF0Y2hpbmcgbm9kZVxuXHRcdFx0ICovXG5cdFx0XHRub2RlSWRUb05hbWUoaWQpIHtcblx0XHQgICAgICAgIHZhciBub2RlcyA9IHRoaXMubm9kZXM7XG5cdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0ICAgICAgICAgICAgaWYgKG5vZGVzW2ldLmlkID09IGlkKSB7XG5cdFx0ICAgICAgICAgICAgICAgIHJldHVybiBub2Rlc1tpXS5uYW1lO1xuXHRcdCAgICAgICAgICAgIH1cblx0XHQgICAgICAgIH1cblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBwcm9jZXNzIHRoZSBub2RlRGF0YSB0byBjcmVhdGUgTm9kZSBvYmplY3RzXG5cdFx0ICAgICAqXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVEYXRhICBOb2RlRGF0YSB0byBjb252ZXJ0IFxuXHRcdCAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gbm9kZSBvYmplY3RzXG5cdFx0ICAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIE5vZGUgb2JqZWN0c1xuXHRcdCAgICAgKi9cblx0XHQgICAgcHJvY2Vzc05vZGVEYXRhKG5vZGVEYXRhKSB7XG5cdFx0ICAgICAgICB2YXIgbm9kZXMgPSBbXTtcblx0XHQgICAgICAgIF8uZm9yRWFjaChub2RlRGF0YSwgZnVuY3Rpb24oZGF0YSkge1xuXHRcdCAgICAgICAgICAgIHZhciBuZXdOb2RlID0gbmV3IE5vZGUuTm9kZShudWxsLCBudWxsLCBkYXRhLmlkLCBkYXRhLnRleHQsIG51bGwpO1xuXHRcdCAgICAgICAgICAgIG5vZGVzLnB1c2gobmV3Tm9kZSk7XG5cdFx0ICAgICAgICB9KTtcblx0XHQgICAgICAgIHJldHVybiBub2Rlcztcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBwcm9jZXNzIHRoZSBsaW5rRGF0YVxuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBsaW5rRGF0YSAgVGhlIGxpbmsgZGF0YVxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlcyAgICAgVGhlIG5vZGVzIGZyb20gcHJvY2Vzc05vZGVEYXRhXG5cdFx0ICAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIExpbmsgb2JqZWN0c1xuXHRcdCAgICAgKi9cblx0XHQgICAgcHJvY2Vzc0xpbmtEYXRhKGxpbmtEYXRhLCBub2Rlcykge1xuXHRcdCAgICBcdC8qKlxuXHRcdFx0ICAgICAqIFJldHVybnMgdGhlIG5vZGUgdGhhdCBtYXRjaGVzIHRoZSBpZFxuXHRcdFx0ICAgICAqXG5cdFx0XHQgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gaWQgICAgICBUaGUgaWRlbnRpZmllclxuXHRcdFx0ICAgICAqIEByZXR1cm4gICAgIHtOb2RlfSAgIFRoZSBub2RlIHdpdGggdGhlIG1hdGNoaW5nIGlkXG5cdFx0XHQgICAgICovXG5cdFx0XHQgICAgZnVuY3Rpb24gZmluZE5vZGVCeUlkKGlkLCBub2Rlcykge1xuXHRcdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHQgICAgICAgICAgICBpZiAoaWQgPT0gbm9kZXNbaV0uaWQpIHtcblx0XHRcdCAgICAgICAgICAgICAgICByZXR1cm4gbm9kZXNbaV07XG5cdFx0XHQgICAgICAgICAgICB9XG5cdFx0XHQgICAgICAgIH1cblx0XHRcdCAgICB9XG5cblx0XHQgICAgICAgIHZhciBsaW5rcyA9IFtdO1xuXHRcdCAgICAgICAgLy90cmFuc2Zvcm1pbmcgbGluayBkYXRhXG5cdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpbmtEYXRhLmxlbmd0aDsgaSsrKSB7XG5cdFx0ICAgICAgICAgICAgaWYgKGxpbmtEYXRhW2ldLnNvdXJjZSAhPSBsaW5rRGF0YVtpXS50YXJnZXQpIHtcblx0XHQgICAgICAgICAgICAgICAgdmFyIHNvdXJjZSA9IGZpbmROb2RlQnlJZChsaW5rRGF0YVtpXS5zb3VyY2UsIG5vZGVzKTtcblx0XHQgICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IGZpbmROb2RlQnlJZChsaW5rRGF0YVtpXS50YXJnZXQsIG5vZGVzKTtcblx0XHQgICAgICAgICAgICAgICAgaWYgKHNvdXJjZSA9PSBudWxsIHx8IHRhcmdldCA9PSBudWxsKSB7XG5cdFx0ICAgICAgICAgICAgICAgIFx0Y29udGludWU7XG5cdFx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICB2YXIgbGluayA9IG5ldyBMaW5rLkxpbmsoc291cmNlLCB0YXJnZXQpO1xuXHQgICAgICAgICAgICAgICAgICAgIGxpbmtzLnB1c2gobGluayk7XG5cdFx0ICAgICAgICAgICAgfSAgXG5cdFx0ICAgICAgICB9XG5cdFx0ICAgICAgICByZXR1cm4gbGlua3M7XG5cdFx0ICAgIH1cblx0XHR9XG5cdFx0cmV0dXJuIHtcblx0XHRcdERhdGFTb3VyY2U6RGF0YVNvdXJjZVxuXHRcdH1cbn1dKTtcblxuXG5cblxuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi51dGlscycsIFtdKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIFRoZSBEYXRhU291cmNlIHVzZWQgZm9yIHRoZSB2aXN1YWxpemF0aW9uIHRhYi5cbiAqIFxuICogTm9kZSBEYXRhIGZyb20gdGhlIHNlcnZlciBpcyBleHBlY3RlZCB0byBiZSBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDpcbiAqIHtpZDogbm9kZV9pZCwgdGV4dDogbm9kZV90ZXh0fVxuICogUGFyZW50IGFuZCBBbmNlc3RvciBhdHRyaWJ1dGVzIGNhbiBiZSBzZXQgYnkgY2FsbGluZyBzZXRBbmNlc3RvcnNcbiAqIFxuICogTGluayBEYXRhIGZyb20gdGhlIHNlcnZlciBpcyBleHBlY3RlZCB0byBiZSBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDpcbiAqIHtzb3VyY2U6IHNvdXJjZU5vZGVJZCwgdGFyZ2V0OiB0YXJnZXROb2RlSWQsIHdlaWdodDogbGlua1dlaWdodH1cbiAqIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnVmlzdWFsaXplckRhdGFTb3VyY2UnLCBbJ0RhdGFTb3VyY2UnLCAnVmlzdWFsaXplck5vZGUnLCAnVmlzdWFsaXplckxpbmsnLCBcbiAgICBcdGZ1bmN0aW9uIChEYXRhU291cmNlLCBWaXN1YWxpemVyTm9kZSwgVmlzdWFsaXplckxpbmspIHtcblxuICAgIFx0Y2xhc3MgVmlzdWFsaXplckRhdGFTb3VyY2UgZXh0ZW5kcyBEYXRhU291cmNlLkRhdGFTb3VyY2Uge1xuICAgIFx0XHQvKipcbiAgICBcdFx0ICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgIFx0XHQgKiBcbiAgICBcdFx0ICogQ2hpbGRyZW4gU3RydWN0IGFuZCBhbmNlc3RvcnNfc3RydWN0IGFyZSBKU09OIG9iamVjdHMsXG4gICAgXHRcdCAqIG1hcHBpbmcgYSBub2RlIElkIHRvIGEgbGlzdCBvZiBpdCdzIGNoaWxkcmVuIG9yIGFuY2VzdG9ycy5cbiAgICBcdFx0ICogQ2hpbGRyZW4gU3RydWN0IGlzIGFsc28gZXhwZWN0ZWQgdG8gaGF2ZSBhIGZpZWxkIGNhbGxlZFxuICAgIFx0XHQgKiB0b3BMZXZlbCwgdGhhdCBtYXBzIHRvIGEgbGlzdCBvZiBhbGwgdGhlIG5vZGVzIHRoYXQgZG9uJ3RcbiAgICBcdFx0ICogaGF2ZSBhbnkgcGFyZW50cy5cbiAgICBcdFx0ICpcbiAgICBcdFx0ICogQHBhcmFtICAgICAge0FycmF5fSAgIG5vZGVzICAgICAgICAgICAgICBUaGUgbm9kZSBkYXRhIFxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgbGlua3MgICAgICAgICAgICAgIFRoZSBsaW5rIGRhdGFcbiAgICBcdFx0ICogQHBhcmFtICAgICAge09iamVjdH0gIGNoaWxkcmVuX3N0cnVjdCAgICBUaGUgY2hpbGRyZW4gc3RydWN0dXJlXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBhbmNlc3RvcnNfc3RydWN0ICAgVGhlIGFuY2VzdG9ycyBzdHJ1Y3R1cmVcbiAgICBcdFx0ICogQHBhcmFtICAgICAge0FycmF5fSAgIGxhYmVscyAgICAgICAgICAgICBUaGUgbGFiZWxzXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBzZWxlY3RvcnMgICAgICAgICAgVGhlIHNlbGVjdG9yc1xuICAgIFx0XHQgKi9cblx0XHRcdGNvbnN0cnVjdG9yKG5vZGVzLCBsaW5rcywgY2hpbGRyZW5fc3RydWN0LCBhbmNlc3RvcnNfc3RydWN0LCBcblx0XHRcdFx0XHRsYWJlbHMsIHNlbGVjdG9ycykge1xuXHRcdFx0XHRzdXBlcihub2RlcyxsaW5rcyk7XG5cdFx0XHRcdHRoaXMuY2hpbGRyZW5fc3RydWN0ID0gY2hpbGRyZW5fc3RydWN0O1xuXHRcdFx0XHR0aGlzLmFuY2VzdG9yc19zdHJ1Y3QgPSBhbmNlc3RvcnNfc3RydWN0O1xuXHRcdFx0XHR0aGlzLmxhYmVscyA9IGxhYmVscztcblx0XHRcdFx0dGhpcy5zZWxlY3RvcnMgPSBzZWxlY3RvcnM7XG5cdFx0XHR9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIERldGVybWluZXMgaWYgaXQgaGFzIGNoaWxkLlxuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgIGlkICAgICAgVGhlIGlkZW50aWZpZXJcblx0XHQgICAgICogQHJldHVybiAgICAge2Jvb2xlYW59ICBUcnVlIGlmIGhhcyBjaGlsZCwgRmFsc2Ugb3RoZXJ3aXNlLlxuXHRcdCAgICAgKi9cblx0XHQgICAgaGFzQ2hpbGQoaWQpIHtcblx0XHQgICAgXHRpZiAodGhpcy5jaGlsZHJlbl9zdHJ1Y3RbaWRdID09IG51bGwpIHtcbiAgICAgICAgICAgIFx0XHRyZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBcdH1cbiAgICAgICAgICAgIFx0cmV0dXJuIHRydWU7XHRcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBTZXRzIHRoZSBwYXJlbnQgYW5kIGFuY2VzdG9ycyBhdHRyaWJ1dGUgdXNpbmcgXG5cdFx0ICAgICAqIGFuY2VzdG9yc19zdHJ1Y3QgZm9yIGFsbCB0aGUgbm9kZXNcblx0XHQgICAgICogQWxzbyBhZGRzIGFueSBub2RlcyB3aXRob3V0IGFuY2VzdG9ycywgdGhhdCBhcmVuJ3QgXG5cdFx0ICAgICAqIHRvcGxldmVsIHRvIHRoZSBjbGllbnQgc2VydmljZS5cblx0XHQgICAgICovXG5cdFx0ICAgIHNldEFuY2VzdG9ycygpIHtcblx0XHQgICAgXHR2YXIgdGhpc0RhdGFTb3VyY2UgPSB0aGlzO1xuXHRcdCAgICBcdHZhciBhZGRlZENsaWVudCA9IGZhbHNlO1xuXHRcdCAgICBcdF8uZm9yRWFjaCh0aGlzRGF0YVNvdXJjZS5ub2RlcywgZnVuY3Rpb24obm9kZSkge1xuXHRcdCAgICBcdFx0bm9kZS5hbmNlc3RvcnMgPSB0aGlzRGF0YVNvdXJjZS5hbmNlc3RvcnNfc3RydWN0W25vZGUuaWRdIHx8IFtdO1xuXHRcdCAgICBcdFx0aWYgKF8uaXNFbXB0eShub2RlLmFuY2VzdG9ycykgPT09IGZhbHNlKSB7XG5cdFx0ICAgIFx0XHRcdG5vZGUucGFyZW50ID0gbm9kZS5hbmNlc3RvcnNbMF07XG5cdFx0ICAgIFx0XHR9IGVsc2Uge1xuXHRcdCAgICBcdFx0XHRpZiAoXy5pbmNsdWRlcyh0aGlzRGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwsIG5vZGUuaWQpID09IGZhbHNlKSB7XG5cdFx0ICAgIFx0XHRcdFx0Ly9jb250YWluZXIgaGFzIG5vIHBhcmVudFxuXHRcdCAgICBcdFx0XHRcdC8vYWRkaW5nIHRvIGNsaWVudFxuXHRcdCAgICBcdFx0XHRcdG5vZGUuYW5jZXN0b3JzLnB1c2goXCJjbGllbnRcIik7XG5cdFx0ICAgIFx0XHRcdFx0dGhpc0RhdGFTb3VyY2UuYW5jZXN0b3JzX3N0cnVjdFtub2RlLmlkXSA9IFtcImNsaWVudFwiXTtcblx0XHQgICAgXHRcdFx0XHRpZiAoYWRkZWRDbGllbnQgPT09IGZhbHNlKSB7XG5cdFx0ICAgIFx0XHRcdFx0XHRhZGRlZENsaWVudCA9IHRydWU7XG5cdFx0XHQgICAgXHRcdFx0XHR0aGlzRGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwucHVzaChcImNsaWVudFwiKTtcblx0XHQgICAgXHRcdFx0XHRcdHRoaXNEYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFsnY2xpZW50J10gPSBbXTtcblx0XHQgICAgXHRcdFx0XHR9XG5cdFx0ICAgIFx0XHRcdFx0dGhpc0RhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0WydjbGllbnQnXS5wdXNoKG5vZGUuaWQpO1xuXHRcdFx0ICAgIFx0XHR9XG5cdFx0ICAgIFx0XHR9XG5cdFx0ICAgIFx0fSlcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBSZXR1cm5zIHRoZSBmbG93IGJldHdlZW4gdGhlIGhpZ2hlc3QgbGV2ZWwgZ3JvdXBpbmdcblx0XHQgICAgICpcblx0XHQgICAgICogQHJldHVybiAgICAge09iamVjdH0gIFRoZSB0b3AgbGV2ZWwgZmxvdy5cblx0XHQgICAgICovXG5cdFx0ICAgIGdldFRvcExldmVsRmxvdygpIHtcblx0XHQgICAgICAgIHJldHVybiB0aGlzLmdldEZsb3dCZXR3ZWVuU2V0KHRoaXMuY2hpbGRyZW5fc3RydWN0LnRvcExldmVsKTtcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBHZXRzIHRoZSBmbG93IGJldHdlZW4gYW55IHNldCBvZiBub2RlIGxldmVsc1xuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlX25hbWVzICBUaGUgbm9kZSBuYW1lcyBpbiB0aGUgc2V0XG5cdFx0ICAgICAqIEByZXR1cm4gICAgIHtPYmplY3R9ICBUaGUgZmxvdyBiZXR3ZWVuIHNldC5cblx0XHQgICAgICovXG5cdFx0ICAgIGdldEZsb3dCZXR3ZWVuU2V0KG5vZGVfbmFtZXMpIHtcblx0XHQgICAgICAgIHZhciBsb2NhbF9ub2RlcyA9IHRoaXMubm9kZXM7XG5cdFx0ICAgICAgICB2YXIgaWRNYXBwaW5nID0ge307XG5cdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxvY2FsX25vZGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0ICAgICAgICAgICAgdmFyIG5vZGUgPSBsb2NhbF9ub2Rlc1tpXTtcblxuXHRcdCAgICAgICAgICAgIC8vaWYgbm9kZSBpcyBhbHJlYWR5IGF0IGl0cyBoaWdoZXN0IGxldmVsXG5cdFx0ICAgICAgICAgICAgaWYgKG5vZGUuYW5jZXN0b3JzID09PSBudWxsKSB7XG5cdFx0ICAgICAgICAgICAgICAgIGlkTWFwcGluZ1tub2RlLmlkXSA9IG5vZGUubmFtZTtcblx0XHQgICAgICAgICAgICB9IGVsc2Uge1xuXHRcdCAgICAgICAgICAgICAgICAvL2NoZWNrIHRvIHNlZSB3aGljaCB0YWdzIGFyZSBwcmVzZW50IGluIHRoZSBhbmNlc3RvciBsaXN0XG5cdFx0ICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbm9kZV9uYW1lcy5sZW5ndGg7IGorKykge1xuXHRcdCAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuYW5jZXN0b3JzLmluZGV4T2Yobm9kZV9uYW1lc1tqXSkgPiAtMSkge1xuXHRcdCAgICAgICAgICAgICAgICAgICAgICAgIGlkTWFwcGluZ1tub2RlLmlkXSA9IG5vZGVfbmFtZXNbal07XG5cdFx0ICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cdFx0ICAgICAgICAgICAgICAgICAgICB9XG5cdFx0ICAgICAgICAgICAgICAgIH1cblx0XHQgICAgICAgICAgICB9XG5cdFx0ICAgICAgICB9ICAgXG5cdFx0ICAgICAgICAvL21vZGlmeSBsaW5rc1xuXHRcdCAgICAgICAgdmFyIGxpbmtzID0gdGhpcy5saW5rcztcblx0XHQgICAgICAgIHZhciBsaW5rRGF0YSA9IFtdO1xuXHRcdCAgICAgICAgXG5cdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpbmtzLmxlbmd0aDsgaSsrKSB7XG5cdFx0ICAgICAgICAgICAgdmFyIGxpbmsgPSBbXTtcblx0XHQgICAgICAgICAgICBsaW5rLnNvdXJjZSA9IGlkTWFwcGluZ1tsaW5rc1tpXS5zb3VyY2VdIHx8IGxpbmtzW2ldLnNvdXJjZTtcblx0XHQgICAgICAgICAgICBsaW5rLnRhcmdldCA9IGlkTWFwcGluZ1tsaW5rc1tpXS50YXJnZXRdIHx8IGxpbmtzW2ldLnRhcmdldDtcblx0XHQgICAgICAgICAgICBsaW5rLndlaWdodCA9IGxpbmtzW2ldLndlaWdodDtcblx0XHQgICAgICAgICAgICBsaW5rRGF0YS5wdXNoKGxpbmspO1xuXHRcdCAgICAgICAgfVxuXG5cdFx0ICAgICAgICAvL2NyZWF0aW5nIHRoZSBub2RlRGF0YVxuXHRcdCAgICAgICAgdmFyIG5vZGVEYXRhID0gW107XG5cdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVfbmFtZXMubGVuZ3RoOyBpKyspIHtcblx0XHQgICAgICAgICAgICB2YXIgbm9kZV90b19hZGQgPSBbXTtcblx0XHQgICAgICAgICAgICBub2RlX3RvX2FkZC5pZCA9IG5vZGVfbmFtZXNbaV07XG5cdFx0ICAgICAgICAgICAgbm9kZV90b19hZGQudGV4dCA9IHRoaXMubm9kZUlkVG9OYW1lKG5vZGVfbmFtZXNbaV0pIHx8IG5vZGVfbmFtZXNbaV07XG5cblxuXHRcdCAgICAgICAgICAgIG5vZGVfdG9fYWRkLmFuY2VzdG9ycyA9IHRoaXMuYW5jZXN0b3JzX3N0cnVjdFtub2RlX25hbWVzW2ldXSB8fCB0aGlzLmFuY2VzdG9yc19zdHJ1Y3Rbbm9kZV90b19hZGQudGV4dF0gfHwgW107XG5cdFx0ICAgICAgICAgICAgaWYgKF8uaXNFbXB0eShub2RlX3RvX2FkZC5hbmNlc3RvcnMpID09PSBmYWxzZSkge1xuXHRcdCAgICAgICAgICAgICAgICBub2RlX3RvX2FkZC5wYXJlbnQgPSBub2RlX3RvX2FkZC5hbmNlc3RvcnNbMF07XG5cdFx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0XHQgICAgICAgICAgICAgICAgbm9kZV90b19hZGQucGFyZW50ID0gbnVsbDtcblx0XHQgICAgICAgICAgICB9XG5cdFx0ICAgICAgICAgICAgbm9kZURhdGEucHVzaChub2RlX3RvX2FkZCk7XG5cdFx0ICAgICAgICB9XG5cblx0XHQgICAgICAgIHJldHVybiB7bm9kZURhdGE6bm9kZURhdGEsIGxpbmtEYXRhOmxpbmtEYXRhfTtcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBwcm9jZXNzIHRoZSBub2RlRGF0YSBvdXRwdXQgb2YgZ2V0Rmxvd0JldHdlZW5TZXRcblx0XHQgICAgICpcblx0XHQgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZURhdGEgIE5vZGVEYXRhIHRvIGNvbnZlcnQgXG5cdFx0ICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0byBub2RlIG9iamVjdHNcblx0XHQgICAgICogQHJldHVybiAgICAge0FycmF5fSAgTm9kZSBvYmplY3RzXG5cdFx0ICAgICAqL1xuXHRcdCAgICBwcm9jZXNzTm9kZURhdGEobm9kZURhdGEpIHtcblx0XHQgICAgICAgIHZhciBub2RlcyA9IFtdO1xuXHRcdCAgICAgICAgXy5mb3JFYWNoKG5vZGVEYXRhLCBmdW5jdGlvbihkYXRhKSB7XG5cdFx0ICAgICAgICAgICAgdmFyIG5ld05vZGUgPSBuZXcgVmlzdWFsaXplck5vZGUuTm9kZShudWxsLCBudWxsLCBkYXRhLmlkLCBkYXRhLnRleHQsXG5cdFx0ICAgICAgICAgICAgICAgIG51bGwsIGRhdGEucGFyZW50LCBkYXRhLmFuY2VzdG9ycywgbnVsbCwgbnVsbCk7XG5cdFx0ICAgICAgICAgICAgbm9kZXMucHVzaChuZXdOb2RlKTtcblx0XHQgICAgICAgIH0pO1xuXHRcdCAgICAgICAgcmV0dXJuIG5vZGVzO1xuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIHByb2Nlc3MgdGhlIGxpbmtEYXRhIG91dHB1dCBvZiBnZXRGbG93QmV0d2VlblNldFxuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBsaW5rRGF0YSAgVGhlIGxpbmsgZGF0YVxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlcyAgICAgVGhlIG5vZGVzXG5cdFx0ICAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIExpbmsgb2JqZWN0c1xuXHRcdCAgICAgKi9cblx0XHQgICAgcHJvY2Vzc0xpbmtEYXRhKGxpbmtEYXRhLCBub2Rlcykge1xuXHRcdCAgICBcdC8qKlxuXHRcdFx0ICAgICAqIFJldHVybnMgdGhlIG5vZGUgdGhhdCBtYXRjaGVzIHRoZSBpZFxuXHRcdFx0ICAgICAqXG5cdFx0XHQgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gaWQgICAgICBUaGUgaWRlbnRpZmllclxuXHRcdFx0ICAgICAqIEByZXR1cm4gICAgIHtOb2RlfSAgIFRoZSBub2RlIHdpdGggdGhlIG1hdGNoaW5nIGlkXG5cdFx0XHQgICAgICovXG5cdFx0XHQgICAgZnVuY3Rpb24gZmluZE5vZGVCeUlkKGlkLCBub2Rlcykge1xuXHRcdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHQgICAgICAgICAgICBpZiAoaWQgPT0gbm9kZXNbaV0uaWQpIHtcblx0XHRcdCAgICAgICAgICAgICAgICByZXR1cm4gbm9kZXNbaV07XG5cdFx0XHQgICAgICAgICAgICB9XG5cdFx0XHQgICAgICAgIH1cblx0XHRcdCAgICB9XG5cblx0XHQgICAgICAgIHZhciBsaW5rcyA9IFtdO1xuXHRcdCAgICAgICAgLy9hIG1hcHBpbmcgZnJvbSBzb3VyY2UuaWQtdGFyZ2V0LmlkIHRvIHRoZSBsaW5rIGFkZGVkXG5cdFx0ICAgICAgICB2YXIgYWRkZWRfbGlua3MgPSB7fTtcblx0XHQgICAgICAgIC8vdHJhbnNmb3JtaW5nIGxpbmsgZGF0YVxuXHRcdCAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5rRGF0YS5sZW5ndGg7IGkrKykge1xuXHRcdCAgICAgICAgICAgIGlmIChsaW5rRGF0YVtpXS5zb3VyY2UgIT0gbGlua0RhdGFbaV0udGFyZ2V0KSB7XG5cdFx0ICAgICAgICAgICAgICAgIHZhciBzb3VyY2UgPSBmaW5kTm9kZUJ5SWQobGlua0RhdGFbaV0uc291cmNlLCBub2Rlcyk7XG5cdFx0ICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSBmaW5kTm9kZUJ5SWQobGlua0RhdGFbaV0udGFyZ2V0LCBub2Rlcyk7XG5cdFx0ICAgICAgICAgICAgICAgIHZhciB3ZWlnaHQgPSBsaW5rRGF0YVtpXS53ZWlnaHQ7XG5cdFx0ICAgICAgICAgICAgICAgIC8vaW4gb3JkZXIgdG8gc3VtIGFsbCB0aGUgd2VpZ2h0cyBvZiB0aGUgbGlua3Mgb2YgdGhlIHN1Yi1ub2Rlcyxcblx0XHQgICAgICAgICAgICAgICAgLy93ZSB1c2UgYWRkZWRfbGlua3MgdG8ga2VlcCB0cmFjayBpZiBhbiBsaW5rIHdhcyBhZGRlZFxuXHRcdCAgICAgICAgICAgICAgICAvL2lmIGl0IGlzLCB3ZSBtb2RpZnkgaXRzIHdlaWdodFxuXHRcdCAgICAgICAgICAgICAgICBpZiAoc291cmNlID09IG51bGwgfHwgdGFyZ2V0ID09IG51bGwpIHtcblx0XHQgICAgICAgICAgICAgICAgXHRjb250aW51ZTtcblx0XHQgICAgICAgICAgICAgICAgfVxuXHRcdCAgICAgICAgICAgICAgICBpZiAoYWRkZWRfbGlua3Nbc291cmNlLmlkICsgJy0nICsgdGFyZ2V0LmlkXSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0ICAgICAgICAgICAgICAgICAgICB2YXIgbGluayA9IG5ldyBWaXN1YWxpemVyTGluay5MaW5rKHNvdXJjZSwgdGFyZ2V0LCB3ZWlnaHQpO1xuXHRcdCAgICAgICAgICAgICAgICAgICAgYWRkZWRfbGlua3Nbc291cmNlLmlkICsgJy0nICsgdGFyZ2V0LmlkXSA9IGxpbms7XG5cdFx0ICAgICAgICAgICAgICAgICAgICBsaW5rcy5wdXNoKGxpbmspO1xuXHRcdCAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHRcdCAgICAgICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nX2xpbmsgPSBhZGRlZF9saW5rc1tzb3VyY2UuaWQgKyAnLScgKyB0YXJnZXQuaWRdO1xuXHRcdCAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdfbGluay5zZXRXZWlnaHQoZXhpc3RpbmdfbGluay5nZXRSYXdXZWlnaHQoKSArIHdlaWdodCk7XG5cdFx0ICAgICAgICAgICAgICAgICAgICBleGlzdGluZ19saW5rLmluY3JlYXNlQ291bnQoKTtcblx0XHQgICAgICAgICAgICAgICAgfVxuXHRcdCAgICAgICAgICAgIH0gIFxuXHRcdCAgICAgICAgfVxuXHRcdCAgICAgICAgcmV0dXJuIGxpbmtzO1xuXHRcdCAgICB9XG5cdFx0fVxuXHRcdHJldHVybiB7XG5cdFx0XHREYXRhU291cmNlOiBWaXN1YWxpemVyRGF0YVNvdXJjZVxuXHRcdH1cbn1dKTtcblxuXG5cblxuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5hcHBsaWNhdGlvbmdyb3VwcycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvYXBwbGljYXRpb25ncm91cHMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnYXBwbGljYXRpb25ncm91cGNyZWF0ZSdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnYXBwbGljYXRpb25ncm91cGRldGFpbHMnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmVkaXQnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZWRpdC86a2V5JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2FwcGxpY2F0aW9uZ3JvdXBkZXRhaWxzJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3Vwcy5saXN0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnYXBwbGljYXRpb25Hcm91cGxpc3QnXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIFRoZSBiYXNlIGNsYXNzIHRoZSBncmFwaCBvYmplY3QuIEFueSBub2RlcyBvciBsaW5rcyB0aGF0IGFyZSBjb250YWluZWQgaW5cbiAqIGl0cyBub2RlcyBvciBsaW5rcyBwcm9wZXJ0eSB3aWxsIGJlIGRyYXduIG9uIHVwZGF0ZUdyYXBoLlxuICogU3VwcG9ydHMgcG9saWNpZXMuXG4gKiBcbiAqIFRvIHdyaXRlIHlvdXIgb3duIGdyYXBoIG9iamVjdCwgY3JlYXRlIGEgbmV3IGZhY3RvcnkgdGhhdCB1c2VzIHRoZSBncmFwaFxuICogeW91IHdhbnQgdG8gaW5oZXJpdCBhcyBhIGRlcGVuZGVuY3ksIGFuZCBleHRlbmQgaXRzIGdyYXBoIGNsYXNzLiBcbiAqIFJldHVybiB0aGUgY2xhc3Mgb2JqZWN0IHdpdGggR3JhcGggYXMga2V5LlxuICogXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdHcmFwaCcsIFsnUG9saWN5U2VydmljZScsIGZ1bmN0aW9uIChQb2xpY3lTZXJ2aWNlKSB7XG4gICAgICAgIGNsYXNzIEdyYXBoIHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogY29uc3RydWN0b3IgZm9yIHRoZSBncmFwaFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtIVE1MIFNWR30gIHN2ZyAgICAgVGhlIHN2ZyB0aGF0IHdpbGwgXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvbGQgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlcyAgICAgIExpc3Qgb2Ygbm9kZXMgZm9yIHRoZSBncmFwaFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbGlua3MgICAgICBMaXN0IG9mIGxpbmtzIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgY29uc3RydWN0b3Ioc3ZnLCBub2RlcywgbGlua3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlcyA9IG5vZGVzIHx8IFtdO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IGxpbmtzIHx8IFtdO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMgPSBbXTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcyA9IFtdO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeSA9IG5ldyBQb2xpY3lTZXJ2aWNlLlBvbGljeSgpO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN0YXRlID0ge1xuICAgICAgICAgICAgICAgICAgICBjYW5ab29tOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBjYW5QYW46IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGluaXRGb3JjZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVVcGRhdGU6IGZhbHNlXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jb25zdHMgPSB7XG4gICAgICAgICAgICAgICAgICAgIGNpcmNsZUdDbGFzczogXCJjb25jZXB0R1wiLFxuICAgICAgICAgICAgICAgICAgICBncmFwaENsYXNzOiBcImdyYXBoXCIsXG4gICAgICAgICAgICAgICAgICAgIHBhdGhDbGFzczogXCJwYXRoXCIsXG4gICAgICAgICAgICAgICAgICAgIG5vZGVDbGFzczogXCJjaXJjbGVcIixcbiAgICAgICAgICAgICAgICAgICAgbm9kZVRleHQ6IFwibm9kZVRleHRcIixcbiAgICAgICAgICAgICAgICAgICAgc3RhcnRSYWRpdXM6IDUwLFxuICAgICAgICAgICAgICAgICAgICBtYXhSYWRpdXM6IDYwLFxuICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiA1LFxuICAgICAgICAgICAgICAgICAgICBkaXNwbGF5T2Zmc2V0OiA2MFxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBzdmcub24oXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wibW91c2VvdmVyXCJdLmNhbGwodGhpcywgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJkYmxjbGlja1wiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wiZGJsY2xpY2tcIl0uY2FsbCh0aGlzLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcImNvbnRleHRtZW51XCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3lbXCJjb250ZXh0bWVudVwiXS5jYWxsKHRoaXMsIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwibW91c2VvdXRcIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wibW91c2VvdXRcIl0uY2FsbCh0aGlzLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcIm1vdXNlZG93blwiLCBmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3lbXCJtb3VzZWRvd25cIl0uY2FsbCh0aGlzLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcIm1vdXNldXBcIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wibW91c2V1cFwiXS5jYWxsKHRoaXMsIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvLyBkZWZpbmUgYXJyb3cgbWFya2VycyBmb3IgZ3JhcGggbGlua3NcbiAgICAgICAgICAgICAgICB2YXIgZGVmcyA9IHN2Zy5hcHBlbmQoJ3N2ZzpkZWZzJyk7XG4gICAgICAgICAgICAgICAgZGVmcy5hcHBlbmQoJ3N2ZzptYXJrZXInKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignaWQnLCAnZW5kLWFycm93JylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ2aWV3Qm94XCIsIFwiMCAtNSAxMCAxMFwiKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcInJlZlhcIiwgMjApXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwicmVmWVwiLCAtMSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJtYXJrZXJXaWR0aFwiLCA2KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcIm1hcmtlckhlaWdodFwiLCA2KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcIm9yaWVudFwiLCBcImF1dG9cIilcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChcInBhdGhcIilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJkXCIsIFwiTTAsLTVMMTAsMEwwLDVcIik7XG5cbiAgICAgICAgICAgICAgICAvLyBkZWZpbmUgYXJyb3cgbWFya2VycyBmb3IgbGVhZGluZyBhcnJvd1xuICAgICAgICAgICAgICAgIGRlZnMuYXBwZW5kKCdzdmc6bWFya2VyJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2lkJywgJ21hcmstZW5kLWFycm93JylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3ZpZXdCb3gnLCAnMCAtNSAxMCAxMCcpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdyZWZYJywgNylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ21hcmtlcldpZHRoJywgMy41KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignbWFya2VySGVpZ2h0JywgMy41KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignb3JpZW50JywgJ2F1dG8nKVxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCdzdmc6cGF0aCcpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdkJywgJ00wLC01TDEwLDBMMCw1Jyk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnID0gc3ZnO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdHID0gc3ZnLmFwcGVuZChcImdcIilcbiAgICAgICAgICAgICAgICAgICAgLmNsYXNzZWQodGhpc0dyYXBoLmNvbnN0cy5ncmFwaENsYXNzLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnRyA9IHRoaXNHcmFwaC5zdmdHO1xuXG4gICAgICAgICAgICAgICAgLy8gc3ZnIG5vZGVzIGFuZCBsaW5rcyBcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHMgPSBzdmdHLmFwcGVuZChcImdcIikuc2VsZWN0QWxsKFwiZ1wiKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcyA9IHN2Z0cuYXBwZW5kKFwiZ1wiKS5zZWxlY3RBbGwoXCJnXCIpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0Tm9kZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdExpbmtzKCk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc2V0UG9zaXRpb25zKCk7XG4gICAgICAgICAgICAgICAgdmFyIHJlc2l6ZUZ1bmMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm9uV2luZG93UmVzaXplKHN2Zyk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5iaW5kaW5ncyA9IHtcbiAgICAgICAgICAgICAgICAgICAgcmVzaXplOnJlc2l6ZUZ1bmNcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICQod2luZG93KS5yZXNpemUocmVzaXplRnVuYyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogY2FsbHMgdGhlIGRlc3Ryb3kgbWV0aG9kIGZvciBhbGwgcG9saWNpZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZGVzdHJveSgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5LmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3kuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3kuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzR3JhcGguYmluZGluZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgJCh3aW5kb3cpLm9mZihrZXksIHRoaXNHcmFwaC5iaW5kaW5nc1trZXldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUnVucyB0aGUgaW5pdCBmdW5jdGlvbiBmb3IgYWxsIHRoZSBub2Rlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbml0Tm9kZXMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBub2RlLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSdW5zIHRoZSBpbml0IGZ1bmN0aW9uIGZvciBhbGwgdGhlIGxpbmtzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluaXRMaW5rcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLmxpbmtzLCBmdW5jdGlvbihsaW5rKSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmsuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIHJldHVybnMgdGhlIG5vZGUgbWF0Y2hpbmcgdGhlIGlkLCBcbiAgICAgICAgICAgICAqIG9yIHVuZGVmaW5lZCBpZiB0aGVyZSBpcyBub25lXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGlkICAgICAgVGhlIGlkZW50aWZpZXJcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtOb2RlfSAgeyBtYXRjaGluZyBub2RlIH1cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZmluZE5vZGVCeUlkKGlkKXtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXNHcmFwaC5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaWQgPT09IHRoaXNHcmFwaC5ub2Rlc1tpXS5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNHcmFwaC5ub2Rlc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmV0dXJucyB0aGUgZDNOb2RlIG9iamVjdCB0aGF0IG1hdGNoZXMgdGhlIGlkLFxuICAgICAgICAgICAgICogb3IgdW5kZWZpbmVkIGlmIHRoZXJlIGlzIG5vbmVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgaWQgICAgICBUaGUgaWRlbnRpZmllclxuICAgICAgICAgICAgICogQHJldHVybiAgICAge0QzTm9kZX0gVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZmluZEQzTm9kZShpZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBkM05vZGU7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZWFjaChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmlkID09PSBpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZDNOb2RlID0gZDMuc2VsZWN0KHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGQzTm9kZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIGluc3RhbGwgYSBkcmFnIHBvbGljeSB0aGF0IHdpbGwgYmUgY2FsbGVkXG4gICAgICAgICAgICAgKiB3aGVuIG5vZGVzIGFyZSBkcmFnZ2VkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzLmJlaGF2aW9yLmRyYWd9ICBkM2RyYWcgIEQzIGRyYWcgb2JqZWN0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluc3RhbGxEcmFnUG9saWN5KGQzZHJhZykge1xuICAgICAgICAgICAgICAgIHRoaXMuZHJhZyA9IGQzZHJhZztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIGluc3RhbGwgYSBwb2xpY3kgdGhhdCB3aWxsIGJlIGNhbGxlZCBcbiAgICAgICAgICAgICAqIHdoZW4gdGhlcmUgaXMgbW91c2UgaW50ZXJhY3Rpb25zIHdpdGggdGhlIGdyYXBoJ3Mgc3ZnXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeSAgVGhlIHBvbGljeSB0byBpbnN0YWxsXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluc3RhbGxTdmdQb2xpY3kocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdmdQb2xpY3kgPSBwb2xpY3k7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byBpbnN0YWxsIHBvbGljaWVzIHRoYXQgYXJlIGNhbGxlZCB3aGVuIHRoZXJlIGlzXG4gICAgICAgICAgICAgKiBtb3VzZSBpbnRlcmFjdGlvbiB3aXRoIGEgbm9kZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3kgIFRoZSBwb2xpY3kgdG8gaW5zdGFsbFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbnN0YWxsRGVmYXVsdE5vZGVQb2xpY3kocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMucHVzaChwb2xpY3kpO1xuICAgICAgICAgICAgICAgIHBvbGljeS5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIHJlbW92ZSBhbiBpbnN0YWxsZWQgcG9saWN5IGZvciBub2Rlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgcG9saWN5UmVtb3ZlICBUaGUgcG9saWN5IHRvIHJlbW92ZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1bmluc3RhbGxEZWZhdWx0Tm9kZVBvbGljeShwb2xpY3lSZW1vdmUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcG9saWN5UmVtb3ZlTmFtZTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHBvbGljeVJlbW92ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlLnBvbGljeU5hbWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5LCBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9saWN5LnBvbGljeU5hbWUgPT09IHBvbGljeVJlbW92ZU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmV0dXJucyB0aGUgbm9kZSBwb2xpY3kgb2JqZWN0IHdpdGggdGhlIGdpdmVuIG5hbWVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgcG9saWN5TmFtZSAgVGhlIHBvbGljeSBuYW1lXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7UG9saWN5fSAgcG9saWN5ICAgICAgVGhlIG1hdGNoaW5nIHBvbGljeVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBnZXROb2RlUG9saWN5KHBvbGljeU5hbWUpIHtcbiAgICAgICAgICAgIFx0dmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvbGljeS5wb2xpY3lOYW1lID09PSBwb2xpY3lOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcG9saWN5O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byBpbnN0YWxsIHBvbGljaWVzIHRoYXQgYXJlIGNhbGxlZCB3aGVuIHRoZXJlIGlzIGFcbiAgICAgICAgICAgICAqIG1vdXNlIGludGVyYWN0aW9uIHdpdGggYSBwYXRoXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeSAgVGhlIHBvbGljeSB0byBpbnN0YWxsXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluc3RhbGxEZWZhdWx0UGF0aFBvbGljeShwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcy5wdXNoKHBvbGljeSk7XG4gICAgICAgICAgICAgICAgcG9saWN5LmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIHJlbW92ZSBhbiBpbnN0YWxsZWQgcG9saWN5IGZvciBsaW5rc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3lSZW1vdmUgIFRoZSBwb2xpY3kgdG8gcmVtb3ZlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHVuaW5zdGFsbERlZmF1bHRQYXRoUG9saWN5KHBvbGljeVJlbW92ZSkge1xuICAgICAgICAgICAgICAgIHZhciBwb2xpY3lSZW1vdmVOYW1lO1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcG9saWN5UmVtb3ZlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmUucG9saWN5TmFtZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3ksIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb2xpY3kucG9saWN5TmFtZSA9PT0gcG9saWN5UmVtb3ZlTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9saWN5LmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGVyZSBpcyBhIG1vdXNlIGludGVyYWN0aW9uIHdpdGggYSBwYXRoXG4gICAgICAgICAgICAgKiBQcm9wb2dhdGVzIHRoZSBldmVudCB0byBhbGwgaW5zdGFsbGVkIHBhdGggcG9saWNpZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgZXZlbnQgICBUaGUgZXZlbnQgdHlwZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2Qzb2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BhdGh9ICBkICAgICAgIFRoZSBtYXRjaGluZyBMaW5rIG9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBwYXRoUG9saWN5RXZlbnQoZXZlbnQsIGQzcGF0aCwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVtldmVudF0oZDNwYXRoLCBkKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZXJlIGlzIGEgbW91c2UgaW50ZXJhY3Rpb24gd2l0aCBhIG5vZGVcbiAgICAgICAgICAgICAqIFByb3BvZ2F0ZXMgdGhlIGV2ZW50IHRvIGFsbCBpbnN0YWxsZWQgbm9kZSBwb2xpY2llc1xuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgZXZlbnQgICBUaGUgZXZlbnQgdHlwZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2Qzb2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BhdGh9ICBkICAgICAgIFRoZSBtYXRjaGluZyBOb2RlIG9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBub2RlUG9saWN5RXZlbnQoZXZlbnQsIGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcywgZnVuY3Rpb24ocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVtldmVudF0oZDNub2RlLCBkKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNldHMgcGFuIGFuZCB6b29tIHJ1bGVzIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7ZDMuYmVoYXZpb3Iuem9vbX0gIGQzem9vbSAgRDMgem9vbSBvYmpcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5zdGFsbFpvb21Qb2xpY3koZDN6b29tKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kcmFnU3ZnID0gZDN6b29tO1xuICAgICAgICAgICAgICAgIHRoaXMuc3ZnLmNhbGwodGhpcy5kcmFnU3ZnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgd2luZG93IGlzIHJlc2l6ZWRcbiAgICAgICAgICAgICAqIEhvb2sgZm9yIG92ZXJyaWRpbmcgaW4gc3ViY2xhc3Nlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtIVE1MIFNWR30gIHN2ZyAgICAgVGhlIHN2ZyB0aGF0IHRoZSBoYW5kbGVyXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzIGF0dGFjaGVkIHRvXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIG9uV2luZG93UmVzaXplKHN2Zykge31cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBJbnNlcnRzIGxpbmUgYnJlYWtzIGluIG5vZGUgdGV4dFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtIVE1MIEVsZW19ICBnRWwgICAgVGhlIGVsZW0gdG8gYWRkIHRleHQgdG9cbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICB0aXRsZSAgIFRoZSB0aXRsZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbnNlcnRUaXRsZUxpbmVicmVha3MgKGdFbCwgdGl0bGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgd29yZHMgPSB0aXRsZS5zcGxpdCgvXFxzKy9nKSxcbiAgICAgICAgICAgICAgICAgICAgbndvcmRzID0gd29yZHMubGVuZ3RoO1xuICAgICAgICAgICAgICAgIHZhciBlbCA9IGdFbC5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsIHRoaXNHcmFwaC5jb25zdHMubm9kZVRleHQpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwidGV4dC1hbmNob3JcIixcIm1pZGRsZVwiKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcImR5XCIsIFwiLVwiICsgKG53b3Jkcy0xKSo3LjUpO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB3b3Jkcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdHNwYW4gPSBlbC5hcHBlbmQoJ3RzcGFuJykudGV4dCh3b3Jkc1tpXSk7XG4gICAgICAgICAgICAgICAgaWYgKGkgPiAwKVxuICAgICAgICAgICAgICAgICAgICB0c3Bhbi5hdHRyKCd4JywgMCkuYXR0cignZHknLCAnMTUnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyBhbGwgbGlua3MgZnJvbSB0aGUgZ2l2ZW4gbm9kZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzcGxpY2VMaW5rc0Zvck5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICB0b1NwbGljZSA9IHRoaXNHcmFwaC5saW5rcy5maWx0ZXIoZnVuY3Rpb24obCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsLnNvdXJjZSA9PT0gbm9kZSB8fCBsLnRhcmdldCA9PT0gbm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRvU3BsaWNlLm1hcChmdW5jdGlvbihsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcy5zcGxpY2UodGhpc0dyYXBoLmxpbmtzLmluZGV4T2YobCksIDEpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEFkZHMgdGhlIG5vZGUgdG8gdGhlIGdyYXBoIGFuZCB1cGRhdGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBub2RlICAgIFRoZSBub2RlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGFkZE5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgIG5vZGUuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmVzIHRoZSBub2RlIHRvIHRoZSBncmFwaCBhbmQgdXBkYXRlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICByZW1vdmVOb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMuc3BsaWNlKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG5vZGUpLCAxKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3BsaWNlTGlua3NGb3JOb2RlKG5vZGUpO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEFkZHMgdGhlIGxpbmsgdG8gdGhlIGdyYXBoIGFuZCB1cGRhdGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2xpbmt9ICBsaW5rICAgIFRoZSBsaW5rXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGFkZExpbmsobGluaykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcy5wdXNoKGxpbmspO1xuICAgICAgICAgICAgICAgIGxpbmsuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmVzIHRoZSBsaW5rIHRvIHRoZSBncmFwaCBhbmQgdXBkYXRlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtsaW5rfSAgbGluayAgICBUaGUgbGlua1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICByZW1vdmVMaW5rKGxpbmspIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3Muc3BsaWNlKHRoaXNHcmFwaC5saW5rcy5pbmRleE9mKGxpbmspLCAxKTtcbiAgICAgICAgICAgICAgICBsaW5rLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgdXBkYXRpbmcgZXhpc3RpbmcgcGF0aHNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UGF0aH0gIHBhdGhzICAgTGlzdCBvZiBwYXRoc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1cGRhdGVFeGlzdGluZ1BhdGhzKHBhdGhzKSB7XG4gICAgICAgICAgICAgICAgcGF0aHMuZWFjaChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgIGQudXBkYXRlQXR0cihkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyBhZGRpbmcgbmV3IHBhdGhzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BhdGh9ICBuZXdQYXRocyAgTGlzdCBvZiBuZXcgcGF0aHNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlTmV3UGF0aHMobmV3UGF0aHMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0TGlua3MoKTtcblxuICAgICAgICAgICAgICAgIG5ld1BhdGhzLmVhY2goZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICBkLm5ld1BhdGhBdHRyKGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvL2lmIG5vZGUgZG9lc24ndCBoYXZlIGl0cyBvd24gcG9saWN5LCB1c2UgZGVmYXVsdCBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgICAgbmV3UGF0aHMub24oXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlb3ZlclwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlb3ZlclwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiZGJsY2xpY2tcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJkYmxjbGlja1wiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcImRibGNsaWNrXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJjb250ZXh0bWVudVwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnBhdGhQb2xpY3lFdmVudChcImNvbnRleHRtZW51XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aFBvbGljeUV2ZW50KFwiY29udGV4dG1lbnVcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcIm1vdXNlb3V0XCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZW91dFwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlb3V0XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlZG93blwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlZG93blwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwibW91c2V1cFwiLCBmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQucGF0aFBvbGljeUV2ZW50KFwibW91c2V1cFwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcIm1vdXNldXBcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5jYWxsKHRoaXNHcmFwaC5kcmFnKTtcbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyB1cGRhdGluZyBleGlzdGluZyBub2Rlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1cGRhdGVFeGlzdGluZ05vZGVzKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzID0gdGhpcy5jaXJjbGVzLmRhdGEodGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbihkKXsgcmV0dXJuIGQuaWQ7fSlcbiAgICAgICAgICAgICAgICAgICAgLmVhY2goZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC51cGRhdGVBdHRyKGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIGFkZGluZyBuZXcgbm9kZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5ld05vZGVzICBMaXN0IG9mIG5ldyBub2Rlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1cGRhdGVOZXdOb2RlcyhuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgbmV3Tm9kZXMuZWFjaChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmdyYXBoID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGQubmV3Tm9kZUF0dHIoZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vaWYgbm9kZSBkb2Vzbid0IGhhdmUgaXRzIG93biBwb2xpY3ksIHVzZSBkZWZhdWx0IGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAgICBuZXdOb2Rlcy5vbihcIm1vdXNlb3ZlclwiLCBmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQubm9kZVBvbGljeUV2ZW50KFwibW91c2VvdmVyXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwibW91c2VvdmVyXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJkYmxjbGlja1wiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcImRibGNsaWNrXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwiZGJsY2xpY2tcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcImNvbnRleHRtZW51XCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQubm9kZVBvbGljeUV2ZW50KFwiY29udGV4dG1lbnVcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlUG9saWN5RXZlbnQoXCJjb250ZXh0bWVudVwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwibW91c2VvdXRcIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlb3V0XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwibW91c2VvdXRcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcIm1vdXNlZG93blwiLCBmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQubm9kZVBvbGljeUV2ZW50KFwibW91c2Vkb3duXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwibW91c2Vkb3duXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZXVwXCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5ub2RlUG9saWN5RXZlbnQoXCJtb3VzZXVwXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwibW91c2V1cFwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmNhbGwodGhpc0dyYXBoLmRyYWcpO1xuXG4gICAgICAgICAgICAgICAgbmV3Tm9kZXMuYXBwZW5kKFwiY2lyY2xlXCIpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJyXCIsIGZ1bmN0aW9uKGQpIHtyZXR1cm4gU3RyaW5nKGQucmFkaXVzKX0pO1xuXG5cbiAgICAgICAgICAgICAgICBuZXdOb2Rlcy5lYWNoKGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5zZXJ0VGl0bGVMaW5lYnJlYWtzKGQzLnNlbGVjdCh0aGlzKSwgZC50ZXh0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBQcmV2ZW50cyBub2RlcyBmcm9tIGNvbGxpZGluZ1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICBhbHBoYSAgIEFmZmVjdHMgaG93IG11Y2ggY2hhbmdlXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGUgY29sbGlzaW9uIGNhdXNlc1xuICAgICAgICAgICAgICogQHJldHVybiAgICAge2Jvb2xlYW59ICB7V2hldGhlciBub2RlcyBhcmUgY29sbGlkZWR9XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGQzRm9yY2VDb2xsaWRlKGFscGhhKSB7XG4gICAgICAgICAgICBcdHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgXHRcdGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHM7XG4gICAgICAgICAgICBcdHZhciBub2RlcyA9IHRoaXNHcmFwaC5ub2RlcztcbiAgICAgICAgICAgIFx0dmFyIHF1YWR0cmVlID0gZDMuZ2VvbS5xdWFkdHJlZShub2Rlcyk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByID0gZC5yYWRpdXMgKyBjb25zdHMubWF4UmFkaXVzICsgY29uc3RzLnBhZGRpbmcsXG4gICAgICAgICAgICAgICAgICAgICAgICBueDEgPSBkLnggLSByLFxuICAgICAgICAgICAgICAgICAgICAgICAgbngyID0gZC54ICsgcixcbiAgICAgICAgICAgICAgICAgICAgICAgIG55MSA9IGQueSAtIHIsXG4gICAgICAgICAgICAgICAgICAgICAgICBueTIgPSBkLnkgKyByO1xuICAgICAgICAgICAgICAgICAgICBxdWFkdHJlZS52aXNpdChmdW5jdGlvbihxdWFkLCB4MSwgeTEsIHgyLCB5Mikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHF1YWQucG9pbnQgJiYgKHF1YWQucG9pbnQgIT09IGQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHggPSBkLnggLSBxdWFkLnBvaW50LngsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHkgPSBkLnkgLSBxdWFkLnBvaW50LnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwgPSBNYXRoLnNxcnQoeCAqIHggKyB5ICogeSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIgPSBkLnJhZGl1cyArIHF1YWQucG9pbnQucmFkaXVzICsgY29uc3RzLnBhZGRpbmc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGwgPCByKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsID0gKGwgLSByKSAvIGwgKiBhbHBoYTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCAtPSB4ICo9IGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgLT0geSAqPSBsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVhZC5wb2ludC54ICs9IHg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWFkLnBvaW50LnkgKz0geTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHgxID4gbngyIHx8IHgyIDwgbngxIHx8IHkxID4gbnkyIHx8IHkyIDwgbnkxO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRpY2sgb2YgdGhlIGQzIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDN0aWNrIGV2ZW50fSAgZSAgICBEM3RpY2sgZXZlbnRcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB3aWR0aCAgVGhlIHdpZHRoIG9mIHRoZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgaGVpZ2h0IFRoZSBoZWlnaHQgb2YgdGhlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZVRpY2soZSwgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgXHR2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgIFx0XHRjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzO1xuXG4gICAgICAgICAgICBcdHZhciBvZmZzZXQgPSBjb25zdHMuZGlzcGxheU9mZnNldDtcdFxuICAgICAgICAgICAgXHR2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICBcdHZhciBxID0gZDMuZ2VvbS5xdWFkdHJlZSh0aGlzR3JhcGgubm9kZXMpLFxuICAgICAgICAgICAgICAgICAgICAgIGkgPSAwLFxuICAgICAgICAgICAgICAgICAgICAgIG4gPSBub2Rlcy5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICAgIHdoaWxlICgrK2kgPCBuKSB7XG4gICAgICAgICAgICAgICAgICAgIHEudmlzaXQodGhpcy5kM0ZvcmNlQ29sbGlkZShub2Rlc1tpXSkpO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZWFjaCh0aGlzLmQzRm9yY2VDb2xsaWRlKC41KSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJjeFwiLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnggPSBNYXRoLm1heChkLnJhZGl1cyArIG9mZnNldCwgTWF0aC5taW4od2lkdGggLSBvZmZzZXQgLSBkLnJhZGl1cywgZC54KSk7IH0pXG4gICAgICAgICAgICAgICAgICAgICAuYXR0cihcImN5XCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQueSA9IE1hdGgubWF4KGQucmFkaXVzICsgb2Zmc2V0LCBNYXRoLm1pbihoZWlnaHQgLSBvZmZzZXQgLSBkLnJhZGl1cywgZC55KSk7IH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd4MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLnk7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd4MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lnk7IH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFN0YXJ0cyBvbiBzdGFydCBvZiB0aGUgZm9yY2Ugc2ltdWxhdGlvblxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkM0ZvcmNlU3RhcnQoKSB7XG4gICAgICAgICAgICBcdHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoc1xuICAgICAgICAgICAgICAgICAgICAuYXR0cigneDEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS55OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneDInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC55OyB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgb24gdGhlIGVuZCBvZiB0aGUgZm9yY2Ugc2ltdWxhdGlvblxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkM0ZvcmNlRW5kKCkge1xuICAgICAgICAgICAgXHR2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgIFx0dGhpc0dyYXBoLmNpcmNsZXNcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2N4JywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY3knLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnk7IH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzLmF0dHIoJ3gxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueTsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueTsgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsY3VsYXRlcyB0aGUgd2lkdGggYW5kIGhlaWdodCBib3VuZHMgZm9yIHRoZSBcbiAgICAgICAgICAgICAqIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7T2JqZWN0fSAgd2lkdGggYW5kIGhlaWdodCBhcyBwcm9wZXJ0aWVzIFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkM0ZvcmNlQm91bmRzKCkge1xuICAgICAgICAgICAgICAgIHZhciBzdmdXaWR0aCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykud2lkdGgoKTtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnSGVpZ2h0ID0gJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS5oZWlnaHQoKTtcblxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IHN2Z1dpZHRoO1xuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBzdmdIZWlnaHQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHt3aWR0aDp3aWR0aCwgaGVpZ2h0OmhlaWdodH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogRG9lcyBhIGQzIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RnVuY3Rpb259ICBjYWxsYmFjayAgVGhlIGNhbGxiYWNrXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNldEZvcmNlKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICAgICAgdmFyIGxpbmtzID0gdGhpc0dyYXBoLmxpbmtzO1xuICAgICAgICAgICAgICAgIGlmIChfLmlzRW1wdHkobm9kZXMpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgYm91bmRzID0gdGhpc0dyYXBoLmQzRm9yY2VCb3VuZHMoKTtcblxuICAgICAgICAgICAgICAgIHZhciBmb3JjZSA9IGQzLmxheW91dC5mb3JjZSgpXG4gICAgICAgICAgICAgICAgICAgIC5zaXplKFtib3VuZHMud2lkdGgsIGJvdW5kcy5oZWlnaHRdKVxuICAgICAgICAgICAgICAgICAgICAubm9kZXMobm9kZXMpXG4gICAgICAgICAgICAgICAgICAgIC5jaGFyZ2UoZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC02MDAwO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAubGlua3MobGlua3MpO1xuXG4gICAgICAgICAgICAgICAgZm9yY2UubGlua0Rpc3RhbmNlKGJvdW5kcy53aWR0aC8zKTtcbiAgICAgICAgICAgICAgICBmb3JjZS5saW5rU3RyZW5ndGgoLjIpO1xuICAgICAgICAgICAgICAgIGZvcmNlLmdyYXZpdHkoLjIpO1xuXG4gICAgICAgICAgICAgICAgZm9yY2Uub24oJ3RpY2snLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgXHR0aGlzR3JhcGguZDNGb3JjZVRpY2suY2FsbCh0aGlzR3JhcGgsIFxuICAgICAgICAgICAgICAgIFx0XHRcdGUsIGJvdW5kcy53aWR0aCwgYm91bmRzLmhlaWdodCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBmb3JjZS5vbignc3RhcnQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBcdHRoaXNHcmFwaC5kM0ZvcmNlU3RhcnQuY2FsbCh0aGlzR3JhcGgpXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBmb3JjZS5vbignZW5kJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgXHR0aGlzR3JhcGguZDNGb3JjZUVuZC5jYWxsKHRoaXNHcmFwaClcbiAgICAgICAgICAgICAgICB9KTsgXG5cblxuICAgICAgICAgICAgICAgIGZvcmNlLnN0YXJ0KCk7XG4gICAgICAgICAgICAgICAgdmFyIGsgPSAwO1xuICAgICAgICAgICAgICAgIHdoaWxlICgoZm9yY2UuYWxwaGEoKSA+IDFlLTIpICYmIChrIDwgMTUwKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3JjZS50aWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIGsgPSBrICsgMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yY2Uuc3RvcCgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBcdGNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNldHMgdGhlIHBvc2l0aW9ucyB0byBiZSB0aGUgY2VudGVyIG9mIHRoZSBzY3JlZW4gaWYgXG4gICAgICAgICAgICAgKiBub3QgcHJvdmlkZWRcbiAgICAgICAgICAgICAqIGFsc28gc2V0cyB0aGUgcmFkaXVzIG9mIHRoZSBub2Rlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzZXRQb3NpdGlvbnMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gdGhpc0dyYXBoLmNvbnN0cy5kaXNwbGF5T2Zmc2V0O1xuICAgICAgICAgICAgICAgIHZhciBzdmdXaWR0aCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykud2lkdGgoKTtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnSGVpZ2h0ID0gJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS5oZWlnaHQoKTtcblxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IHN2Z1dpZHRoIC0gKDIqb2Zmc2V0KTtcbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gc3ZnSGVpZ2h0IC0gKDIqb2Zmc2V0KTtcblxuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXNHcmFwaC5ub2RlcztcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZXNbaV0ucmFkaXVzID0gbm9kZXNbaV0ucmFkaXVzIHx8IHRoaXNHcmFwaC5jb25zdHMuc3RhcnRSYWRpdXM7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2Rlc1tpXS54ID09IG51bGwgfHwgbm9kZXNbaV0ueSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBub2Rlc1tpXS54U3RhcnQgPSB3aWR0aC8yICArIG5vZGVzW2ldLnJhZGl1cyArIG9mZnNldFxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNbaV0ueCA9IHdpZHRoLzIgICsgbm9kZXNbaV0ucmFkaXVzICsgb2Zmc2V0O1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm9kZXNbaV0ueVN0YXJ0ID0gaGVpZ2h0LzIgKyBub2Rlc1tpXS5yYWRpdXMgKyBvZmZzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzW2ldLnkgPSBoZWlnaHQvMiArIG5vZGVzW2ldLnJhZGl1cyArIG9mZnNldFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB0byB1cGRhdGUgdGhlIHZpZXcgb2YgdGhlIGdyYXBoIHdoZW5cbiAgICAgICAgICAgICAqIGRhdGEgY2hhbmdlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtGdW5jdGlvbn0gIGNhbGxiYWNrICBUaGUgY2FsbGJhY2tcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlR3JhcGgoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGU7XG5cbiAgICAgICAgICAgIFx0aWYgKHRoaXNHcmFwaC5zdGF0ZS5kaXNhYmxlVXBkYXRlKSB7XG4gICAgICAgICAgICBcdFx0cmV0dXJuO1xuICAgICAgICAgICAgXHR9XG5cbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUV4aXN0aW5nTm9kZXMoKTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3R3M9IHRoaXNHcmFwaC5jaXJjbGVzLmVudGVyKClcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChcImdcIik7XG5cbiAgICAgICAgICAgIFx0Ly8gY29uc29sZS5sb2coJ3VwZGF0ZScsIG5ld0dzKTtcbiAgICAgICAgICAgICAgICBuZXdHcy5jbGFzc2VkKGNvbnN0cy5jaXJjbGVHQ2xhc3MsIHRydWUpO1xuICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gdGhpcy51cGRhdGVOZXdOb2RlcyhuZXdHcyk7XG5cbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgb2xkIG5vZGVzXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZXhpdCgpLnJlbW92ZSgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmluaXRGb3JjZSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc2V0Rm9yY2UoZnVuY3Rpb24oKSB7XG4gICAgXHQgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZU5ld05vZGVzLmNhbGwodGhpc0dyYXBoLCBuZXdHcyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5pbml0Rm9yY2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZU5ld05vZGVzKG5ld0dzKTtcblx0ICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzID0gdGhpc0dyYXBoLnBhdGhzLmRhdGEodGhpc0dyYXBoLmxpbmtzLCBmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFN0cmluZyhkLnNvdXJjZS5pZCkgKyBcIitcIiArIFN0cmluZyhkLnRhcmdldC5pZCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdmFyIHBhdGhzID0gdGhpc0dyYXBoLnBhdGhzO1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRXhpc3RpbmdQYXRocyhwYXRocyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbmV3cGF0aHMgPSBwYXRocy5lbnRlcigpXG4gICAgICAgICAgICAgICAgLmFwcGVuZChcInBhdGhcIilcbiAgICAgICAgICAgICAgICAuc3R5bGUoJ21hcmtlci1lbmQnLCd1cmwoI2VuZC1hcnJvdyknKVxuICAgICAgICAgICAgICAgIC5jbGFzc2VkKFwibGlua1wiLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZU5ld1BhdGhzKG5ld3BhdGhzKTtcblxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBvbGQgbGlua3NcbiAgICAgICAgICAgICAgICBwYXRocy5leGl0KCkucmVtb3ZlKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIFx0Y2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBHcmFwaDogR3JhcGhcbiAgICAgICAgfVxufV0pO1xuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5kYXNoYm9hcmQnLCBbJ2NvbnRpdi5tb2RlbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuZGFzaGJvYXJkJywge1xuICAgICAgICAgICAgdXJsOiAnL2Rhc2hib2FyZCcsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdkYXNoYm9hcmQnXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIFRoZSBncmFwaCB0aGF0IGlzIHVzZWQgc3BlY2lmaWNhbGx5IGZvciB0aGUgdmlzdWFsaXphdGlvbiB0YWIuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdWaXN1YWxpemVyR3JhcGgnLCBbJ0dyYXBoJywgZnVuY3Rpb24gKEdyYXBoKSB7XG4gICAgXHRjbGFzcyBWaXN1YWxpemVyR3JhcGggZXh0ZW5kcyBHcmFwaC5HcmFwaCB7XG4gICAgXHRcdC8qKlxuICAgIFx0XHQgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgXHRcdCAqXG4gICAgXHRcdCAqIEBwYXJhbSAgIHtIVE1MIFNWR30gIHN2ZyAgICAgICAgICAgICBUaGUgc3ZnIHRoYXQgd2lsbCBcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob2xkIHRoZSBncmFwaFxuICAgICAgICAgICAgICogQHBhcmFtICAge0FycmF5fSAgbm9kZXMgICBcdFx0ICAgIExpc3Qgb2Ygbm9kZXNcbiAgICAgICAgICAgICAqIEBwYXJhbSAgIHtBcnJheX0gIGxpbmtzICAgXHRcdCAgICBMaXN0IG9mIGxpbmtzXG4gICAgXHRcdCAqIEBwYXJhbSAgIHtEYXRhU291cmNlfSAgZGF0YVNvdXJjZSAgICBUaGUgZGF0YSBzb3VyY2VcbiAgICBcdFx0ICovXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcihzdmcsIG5vZGVzLCBsaW5rcywgZGF0YVNvdXJjZSkge1xuICAgICAgICAgICAgICAgIHN1cGVyKHN2Zywgbm9kZXMsIGxpbmtzKTtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgICAgIC8vaG9sZHMgY3VycmVudCB0cmFuc2l0aW9ucyB0aGF0IGFyZSBvY2N1cmluZ1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZS50cmFuc2l0aW9uID0gW107XG4gICAgICAgICAgICAgICAgLy9NaW4gZGlzdGFuY2UgYmV0d2VlbiBub2RlcyB3aGVuIHNwYXduaW5nIHJhbmRvbWx5XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNvbnN0cy5lZGdlX2J1ZmZlciA9IDIwMDtcbiAgICAgICAgICAgICAgICAvL1NpemUgcmVkdWN0aW9uIGFzIHlvdSBnbyB0aHJvdWdoIGxldmVscyBpbiBub2Rlc1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jb25zdHMucmFkaXVzRGVjYXkgPSAxO1xuICAgICAgICAgICAgICAgIC8vQ3NzIGNsYXNzIGZvciBub2RlcyB0aGF0IGFyZSBjb250YWluZXJzXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNvbnN0cy5jb250YWluZXJDbGFzcyA9ICdjb250YWluZXInO1xuXG4gICAgICAgICAgICAgICAgLy9kYXRhU291cmNlIGhvbGRzIHRoZSBzZXJ2ZXIgZGF0YSBhbmQgbWV0aG9kcyBmb3JcbiAgICAgICAgICAgICAgICAvL2NvbnZlcnRpbmcgaXQgdG8gZGF0YSBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRhdGFTb3VyY2UgPSBkYXRhU291cmNlO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vRHJhZyBiZWhhdmlvciBmb3Igbm9kZXNcbiAgICAgICAgICAgICAgICB2YXIgZHJhZyA9IGQzLmJlaGF2aW9yLmRyYWcoKVxuICAgICAgICAgICAgICAgICAgICAub3JpZ2luKGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge3g6IGQueCwgeTogZC55fTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiZHJhZ3N0YXJ0XCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJkcmFnXCIsIGZ1bmN0aW9uKGFyZ3Mpe1xuICAgICAgICAgICAgICAgICAgICBcdGQzLnNlbGVjdCggdGhpcykuYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbiggZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCArPSBkMy5ldmVudC5keDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gZDMuZXZlbnQuZHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwidHJhbnNsYXRlKFwiICsgWyBkLngsZC55IF0gKyBcIilcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcdFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJkcmFnZW5kXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kcmFnID0gZHJhZztcblxuICAgICAgICAgICAgICAgIC8vUGFuIGFuZCBab29tIGJlaGF2aW9yIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAgICB2YXIgem9vbSA9IGQzLmJlaGF2aW9yLnpvb20oKVxuICAgICAgICAgICAgICAgICAgICAub24oXCJ6b29tXCIsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZDMuZXZlbnQuc291cmNlRXZlbnQgIT0gbnVsbCAmJiBkMy5ldmVudC5zb3VyY2VFdmVudC5jdHJsS2V5KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZC5jYWxsKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiem9vbXN0YXJ0XCIsIGZ1bmN0aW9uKGQsIGkpe1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguZHJhZ1N2ZyA9IHpvb207XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Zy5jYWxsKHpvb20pLm9uKFwiZGJsY2xpY2suem9vbVwiLCBudWxsKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2l0aCBubyBhcmdzIHdoZW4gdGhlIGdyYXBoIGhhcyBhIHpvb20gYWN0aW9uXG4gICAgICAgICAgICAgKiBDYW4gYWxzbyBiZSBjYWxsZWQgd2l0aCBhcmdzIHRvIGZvcmNlIGEgem9vbSBvciBwYW4gXG4gICAgICAgICAgICAgKiBldmVudCBmb3IgdGhlIGdyYXBoLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gICB0cmFuc2xhdGUgIFRoZSBhbW91bnQgdG8gdHJhbnNsYXRlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgc2NhbGUgICAgICBUaGUgYW1vdW50IHRvIHNjYWxlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHpvb21lZCh0cmFuc2xhdGUsIHNjYWxlKXtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLnN0YXRlLnJpZ2h0Q2xpY2sgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuanVzdFNjYWxlVHJhbnNHcmFwaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKHRyYW5zbGF0ZSAhPSBudWxsICYmIHNjYWxlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSB0aGlzR3JhcGguZHJhZ1N2ZztcbiAgICAgICAgICAgICAgICAgICAgem9vbS5zY2FsZShzY2FsZSk7XG4gICAgICAgICAgICAgICAgICAgIHpvb20udHJhbnNsYXRlKHRyYW5zbGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIC8vY3JlYXRpbmcgbmFtZXMgdG8gcHJldmVudCB0cmFuc2l0aW9uIGNvbmZsaWN0c1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbVNldENhbGxiYWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIFx0em9vbS5zY2FsZShzY2FsZSk7XG4gICAgICAgICAgICAgICAgICAgIFx0em9vbS50cmFuc2xhdGUodHJhbnNsYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zbGF0ZV9uYW1lID0gXCJ6b29tXCIgKyB0cmFuc2xhdGU7XG4gICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdChcIi5cIiArIHRoaXMuY29uc3RzLmdyYXBoQ2xhc3MpLnRyYW5zaXRpb24odHJhbnNsYXRlX25hbWUpLmRlbGF5KDEwMCkuZHVyYXRpb24oNzUwKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoJyArIHpvb20udHJhbnNsYXRlKCkgKyAnKSBzY2FsZSgnICsgem9vbS5zY2FsZSgpICsgJyknKS5lYWNoKFwiZW5kXCIsIHpvb21TZXRDYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGguc3RhdGUuY2FuWm9vbSkge1xuICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QoXCIuXCIgKyB0aGlzLmNvbnN0cy5ncmFwaENsYXNzKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKSArIFwiKSBzY2FsZShcIiArdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKSArIFwiKVwiKTsgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgd2luZG93IHJlc2l6ZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBTVkd9ICBzdmcgICAgVGhlIHN2ZyB0byByZXNpemVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgb25XaW5kb3dSZXNpemUoc3ZnKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJvZHlFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF07XG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykub2Zmc2V0KCk7XG4gICAgICAgICAgICAgICAgdmFyIGRpdldpZHRoID0gJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS53aWR0aCgpO1xuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBib2R5RWwuY2xpZW50SGVpZ2h0O1xuICAgICAgICAgICAgICAgIHN2Zy5hdHRyKFwid2lkdGhcIiwgZGl2V2lkdGgpLmF0dHIoXCJoZWlnaHRcIiwgaGVpZ2h0IC0gb2Zmc2V0LnRvcCAtIDIwKTtcblxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgc2VydmVyIHNlbmRzIHVwZGF0ZWQgZGF0YSBmb3IgdGhlIGxpbmtzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHVwZGF0ZUxpbmtEYXRhKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBub2RlX25hbWVzX3NldCA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpc0dyYXBoLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVfbmFtZXNfc2V0LnB1c2godGhpc0dyYXBoLm5vZGVzW2ldLmlkKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcmV0RGF0YSA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmdldEZsb3dCZXR3ZWVuU2V0KG5vZGVfbmFtZXNfc2V0KTtcbiAgICAgICAgICAgICAgICB2YXIgbGlua0RhdGEgPSByZXREYXRhLmxpbmtEYXRhO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YShsaW5rRGF0YSwgdGhpc0dyYXBoLm5vZGVzKTtcbiAgICAgICAgICAgICAgICB0aGlzLmluaXROb2RlcygpO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5pdExpbmtzKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIFxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIEdyYXBoOiBWaXN1YWxpemVyR3JhcGhcbiAgICAgICAgfVxufV0pO1xuXG5cblxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE5LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmxvZ2luJywgWydjb250aXYudXRpbHMnXSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwIiwiLyoqXG4gKiBUaGUgYmFzZSBjbGFzcyBmb3IgbGluayBvYmplY3RzIGZvciB0aGUgZ3JhcGguXG4gKiBTdXBwb3J0cyBwb2xpY2llcy5cbiAqIFxuICogVG8gd3JpdGUgeW91ciBvd24gbGluayBvYmplY3QsIGNyZWF0ZSBhIG5ldyBmYWN0b3J5IHRoYXQgdXNlcyB0aGUgbGlua1xuICogeW91IHdhbnQgdG8gaW5oZXJpdCBhcyBhIGRlcGVuZGVuY3ksIGFuZCBleHRlbmQgaXRzIGxpbmsgY2xhc3MuIFxuICogUmV0dXJuIHRoZSBjbGFzcyBvYmplY3Qgd2l0aCBMaW5rIGFzIGtleVxuICogXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdMaW5rJywgW2Z1bmN0aW9uICgpIHtcbiAgICBcdGNsYXNzIExpbmsge1xuICAgIFx0XHQvKipcbiAgICBcdFx0ICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgIFx0XHQgKlxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHNvdXJjZU5vZGUgIFRoZSBzb3VyY2Ugbm9kZVxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHRhcmdldE5vZGUgIFRoZSB0YXJnZXQgbm9kZVxuICAgIFx0XHQgKi9cblx0XHRcdGNvbnN0cnVjdG9yKHNvdXJjZU5vZGUsIHRhcmdldE5vZGUpIHtcblx0XHRcdFx0dGhpcy5zb3VyY2UgPSBzb3VyY2VOb2RlO1xuXHRcdFx0XHR0aGlzLnRhcmdldCA9IHRhcmdldE5vZGU7XG5cdFx0XHRcdHRoaXMuaGFzUG9saWN5ID0gZmFsc2U7XG5cdFx0XHRcdHRoaXMucGF0aFBvbGljaWVzID0gW107XG5cdFx0XHRcdHRoaXMuZ3JhcGggPSBudWxsO1xuXHRcdFx0XHR0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsbGVkIHdoZW4gYSBsaW5rIGlzIGFkZGVkIHRvIHRoZSBncmFwaFxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoIGl0IGlzIGFkZGVkIHRvXG5cdFx0XHQgKi9cblx0XHRcdGluaXRpYWxpemUoZ3JhcGgpIHtcblx0XHRcdFx0aWYgKHRoaXMuaW5pdGlhbGl6ZWQgPT0gZmFsc2UpIHtcblx0XHRcdFx0XHR0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcblx0XHRcdFx0XHR0aGlzLmdyYXBoID0gZ3JhcGg7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxsZWQgZHVyaW5nIHRoZSB1cGRhdGUgZ3JhcGggZm9yIGV4aXN0aW5nIGxpbmtzXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuXHRcdFx0ICogQHBhcmFtICAgICAge0xpbmt9ICBcdCAgIGQgICAgICAgTWF0Y2hpbmcgTGluayBPYmplY3QgICAgICAgXG5cdFx0XHQgKi9cblx0XHRcdHVwZGF0ZUF0dHIoZDNwYXRoLCBkKSB7XG5cdFx0XHRcdGQzcGF0aC5zdHlsZSgnbWFya2VyLWVuZCcsICd1cmwoI2VuZC1hcnJvdyknKVxuXHRcdCAgICAgICAgICAgIC5hdHRyKFwiZFwiLCBhcnJvd1BhdGgpO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCBkdXJpbmcgdGhlIGZpcnN0IHVwZGF0ZSBncmFwaCBmb3IgYSBsaW5rXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuXHRcdFx0ICogQHBhcmFtICAgICAge0xpbmt9ICBcdCAgIGQgICAgICAgTWF0Y2hpbmcgTGluayBPYmplY3QgICAgICAgXG5cdFx0XHQgKi9cblx0XHRcdG5ld1BhdGhBdHRyKGQzcGF0aCwgZCkge1xuXHRcdFx0XHRkM3BhdGguYXR0cignZCcsIGFycm93UGF0aCk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsY3VsYXRlcyB0aGUgYXJyb3cgcGF0aFxuXHRcdFx0ICpcblx0XHRcdCAqIEByZXR1cm4gICAgIHtzdHJpbmd9ICBUaGUgcGF0aCB0byBkcmF3XG5cdFx0XHQgKi9cblx0XHQgICAgYXJyb3dQYXRoKCkge1xuXHRcdCAgICBcdHZhciBkID0gdGhpcztcblx0XHQgICAgICAgIHZhciBkeCA9IGQudGFyZ2V0LnggLSBkLnNvdXJjZS54LFxuXHRcdCAgICAgICAgICAgIGR5ID0gZC50YXJnZXQueSAtIGQuc291cmNlLnksXG5cdFx0ICAgICAgICAgICAgZHIgPSBNYXRoLnNxcnQoZHggKiBkeCArIGR5ICogZHkpO1xuXHRcdCAgICAgICAgcmV0dXJuIFwiTVwiICsgZC5zb3VyY2UueCArIFwiLFwiICsgZC5zb3VyY2UueSArIFwiQVwiICsgZHIgKyBcIixcIiArIGRyICsgXCIgMCAwLDEgXCIgKyBkLnRhcmdldC54ICsgXCIsXCIgKyBkLnRhcmdldC55O1xuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIFVzZWQgdG8gaW5zdGFsbCBwb2xpY2llcyB0aGF0IGFyZSBjYWxsZWQgd2hlbiB0aGlzXG5cdFx0ICAgICAqIGxpbmsgaGFzIGEgbW91c2UgZXZlbnRcblx0XHQgICAgICpcblx0XHQgICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeSAgVGhlIHBvbGljeSB0byBpbnN0YWxsXG5cdFx0ICAgICAqL1xuXHRcdFx0aW5zdGFsbFBhdGhQb2xpY3kocG9saWN5KSB7XG5cdFx0XHRcdHRoaXMuaGFzUG9saWN5ID0gdHJ1ZTtcblx0XHRcdFx0dGhpcy5wYXRoUG9saWNpZXMucHVzaChwb2xpY3kpO1xuXHRcdFx0XHRwb2xpY3kuaW5pdGlhbGl6ZSh0aGlzLmdyYXBoKTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBVc2VkIHRvIHVuaW5zdGFsbCBwb2xpY3kgZm9yIHRoaXMgbGlua1xuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3lSZW1vdmUgIFRoZSBwb2xpY3kgdG8gcmVtb3ZlXG5cdFx0XHQgKi9cblx0XHRcdHVuaW5zdGFsbFBhdGhQb2xpY3kocG9saWN5UmVtb3ZlKSB7XG5cdFx0XHRcdHZhciBwb2xpY3lSZW1vdmVOYW1lO1xuXHRcdFx0XHR2YXIgdGhpc1BhdGggPSB0aGlzO1xuXHRcdFx0XHRpZiAodHlwZW9mIHBvbGljeVJlbW92ZSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHRwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmUucG9saWN5TmFtZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRfKHRoaXNQYXRoLnBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3ksIGluZGV4KSB7XG5cdFx0XHRcdFx0aWYgKHBvbGljeS5wb2xpY3lOYW1lID09PSBwb2xpY3lSZW1vdmVOYW1lKSB7XG5cdFx0XHRcdFx0XHRwb2xpY3kuZGVzdHJveSgpO1xuXHRcdFx0XHRcdFx0dGhpc1BhdGgucGF0aFBvbGljaWVzLnNwbGljZShpbmRleCwgMSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdFx0aWYgKHRoaXNQYXRoLnBhdGhQb2xpY2llcy5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0XHR0aGlzUGF0aC5oYXNQb2xpY3kgPSBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCB3aGVuIHRoZXJlIGlzIGEgbW91c2UgZXZlbnQgZm9yIHRoaXMgcGF0aFxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBldmVudCAgICAgVGhlIG1vdXNlIGV2ZW50XG5cdFx0XHQgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM3BhdGggIFRoZSBkMyBwYXRoXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgZCAgICAgICAgIFRoZSBtYXRjaGluZyBsaW5rIG9iamVjdFxuXHRcdFx0ICovXG5cdFx0XHRwYXRoUG9saWN5RXZlbnQoZXZlbnQsIGQzcGF0aCwgZCkge1xuXHRcdFx0XHRfKGQucGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSkge1xuXHRcdFx0XHRcdHBvbGljeVtldmVudF0oZDNwYXRoLCBkKTtcblx0XHRcdFx0fSlcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHtcblx0XHRcdExpbms6IExpbmtcblx0XHR9XG59XSk7XG5cblxuXG5cblxuXG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubWVudScsIFtdKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3BvbGljaWVzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbmV0d29ya3BvbGljaWVzJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuaXNvbGF0aW9uJywge1xuICAgICAgICAgICAgdXJsOiAnL2lzb2xhdGlvbicsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPHVpLXZpZXcvPidcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbi5jcmVhdGUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2lzb2xhdGlvbnBvbGljeWNyZWF0ZSdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbi5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdpc29sYXRpb25wb2xpY3lkZXRhaWxzJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuaXNvbGF0aW9uLmVkaXQnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZWRpdC86a2V5JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2lzb2xhdGlvbnBvbGljeWRldGFpbHMnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGgnLCB7XG4gICAgICAgICAgICB1cmw6ICcvYmFuZHdpZHRoJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8dWktdmlldy8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuYmFuZHdpZHRoLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnYmFuZHdpZHRocG9saWN5Y3JlYXRlJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuYmFuZHdpZHRoLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2JhbmR3aWR0aHBvbGljeWRldGFpbHMnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGguZWRpdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9lZGl0LzprZXknLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnYmFuZHdpZHRocG9saWN5ZGV0YWlscydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLnJlZGlyZWN0aW9uJywge1xuICAgICAgICAgICAgdXJsOiAnL3JlZGlyZWN0aW9uJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8dWktdmlldy8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMubGlzdC5pc29sYXRpb24nLCB7XG4gICAgICAgICAgICB1cmw6ICcvaXNvbGF0aW9uJyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2lzb2xhdGlvbnBvbGljeWxpc3QnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5saXN0LmJhbmR3aWR0aCcsIHtcbiAgICAgICAgICAgIHVybDogJy9iYW5kd2lkdGgnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnYmFuZHdpZHRocG9saWN5bGlzdCdcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIi8qKlxuICogVGhlIGxpbmsgdGhhdCBpcyB1c2VkIHNwZWNpZmljYWxseSBmb3IgdGhlIHZpc3VhbGl6YXRpb24gdGFiLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnVmlzdWFsaXplckxpbmsnLCBbJ0xpbmsnLCBmdW5jdGlvbiAoTGluaykge1xuXHRcdGNsYXNzIFZpc3VhbGl6ZXJMaW5rIGV4dGVuZHMgTGluay5MaW5rIHtcblx0XHRcdC8qKlxuXHRcdFx0ICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtOb2RlfSAgc291cmNlTm9kZSAgVGhlIHNvdXJjZSBub2RlXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHRhcmdldE5vZGUgIFRoZSB0YXJnZXQgbm9kZVxuXHRcdFx0ICogQHBhcmFtICAgICAge251bWJlcn0gIHdlaWdodCAgICBUaGUgd2VpZ2h0IG9mIHRoZSBsaW5rXG5cdFx0XHQgKi9cblx0XHQgICAgY29uc3RydWN0b3Ioc291cmNlTm9kZSwgdGFyZ2V0Tm9kZSwgd2VpZ2h0KSB7XG5cdFx0ICAgICAgICBzdXBlcihzb3VyY2VOb2RlLCB0YXJnZXROb2RlKTtcblx0XHQgICAgICAgIHRoaXMud2VpZ2h0ID0gd2VpZ2h0O1xuXHRcdCAgICAgICAgLy9Db3VudCBpcyB1c2VkIHRvIGtlZXAgdHJhY2sgb2YgaG93IG1hbnlcblx0XHQgICAgICAgIC8vcGF0aHMgdG8gaXRzIHN1Ym5vZGVzIHRoZXJlIGFyZVxuXHRcdCAgICAgICAgLy9pbiBvcmRlciB0byBjYWxjdWxhdGUgYXZlcmFnZSB0cmFmZmljXG5cdFx0ICAgICAgICB0aGlzLmNvdW50ID0gMTtcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBJbmNyZWFzZXMgdGhlIGNvdW50IG9mIHRoZSBsaW5rXG5cdFx0ICAgICAqIFVTZWQgdG8ga2VlcCB0cmFjayBvZiBob3cgbWFueSBwYXRocyB0byBpdHMgc3Vibm9kZXNcblx0XHQgICAgICogdGhlcmUgYXJlIGluIG9yZGVyIHRvIGNhbGN1bGF0ZSBhdmVyYWdlIHRyYWZmaWNcblx0XHQgICAgICovXG5cdFx0ICAgIGluY3JlYXNlQ291bnQoKSB7XG5cdFx0ICAgICAgICB0aGlzLmNvdW50ICs9IDE7XG5cdFx0ICAgIH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogQ2FsY3VsYXRlcyB3aGVyZSB0byBwbGFjZSBxdGlwIGZvclxuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcmV0dXJuICAgICB7T2JqZWN0fSAgT2JqZWN0IHdpdGggcVRpcCBzZXR0aW5nc1xuXHRcdCAgICAgKi9cblx0XHQgICAgcXRpcEhlbHBlcigpIHtcblx0XHQgICAgXHR2YXIgcmV0O1xuXHRcdCAgICBcdHZhciBkID0gdGhpcztcblx0XHQgICAgXHR2YXIgZHggPSAoZC50YXJnZXQueCAtIGQuc291cmNlLngpIC8gMixcblx0XHQgICAgICAgICAgICBkeSA9IChkLnRhcmdldC55IC0gZC5zb3VyY2UueSkgLyAyO1xuXHRcdCAgICBcdGlmIChkLnNvdXJjZS54IDwgZC50YXJnZXQueCkge1xuXHQgICAgXHRcdFx0cmV0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbXk6ICd0b3AgY2VudGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0OiAnY2VudGVyIGNlbnRlcicsIC8vIGF0IHRoZSBib3R0b20gcmlnaHQgb2YuLi5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogW2R4LCBkeV0sXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGp1c3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFx0eTogMTBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXHRcdCAgICBcdH0gZWxzZSB7XG5cdCAgICBcdFx0XHRyZXQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBteTogJ2JvdHRvbSBjZW50ZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXQ6ICdjZW50ZXIgY2VudGVyJywgLy8gYXQgdGhlIGJvdHRvbSByaWdodCBvZi4uLlxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiBbZHgsIGR5XSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkanVzdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXHR5OiAtMTBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXHRcdCAgICBcdH1cblx0XHQgICAgXHRyZXR1cm4gcmV0O1xuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0XHQgKiBDYWxsZWQgd2hlbiBhIGxpbmsgaXMgYWRkZWQgdG8gdGhlIGdyYXBoXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgYWRkZWQgdG9cblx0XHRcdCAqL1xuXHRcdFx0aW5pdGlhbGl6ZShncmFwaCkge1xuXHRcdFx0XHRpZiAodGhpcy5pbml0aWFsaXplZCA9PSBmYWxzZSkge1xuXHRcdFx0XHRcdHN1cGVyLmluaXRpYWxpemUoZ3JhcGgpO1xuXHRcdFx0XHRcdHZhciBzdGF0ZSA9IGdyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXHRcdFx0XHRcdGlmIChzdGF0ZSA9PSBudWxsKSB7XG5cdFx0XHRcdFx0XHRzdGF0ZSA9IGdyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rID0ge307XG5cdFx0XHRcdFx0XHRzdGF0ZS5tYXhXZWlnaHQgPSBudWxsO1xuXHRcdFx0XHRcdFx0c3RhdGUudXNlQXZnV2VpZ2h0ID0gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0dGhpcy51cGRhdGVNYXhXZWlnaHQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFNldHMgd2hldGhlciB0aGUgZ3JhcGggc2hvdWxkIHVzZSBhdmcgd2VpZ2h0XG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge2Jvb2xlYW59ICB2YWwgICAgIFRoZSB2YWx1ZSB0byBzZXQgdG9cblx0XHRcdCAqL1xuXHRcdFx0c2V0VXNlQXZnV2VpZ2h0KHZhbCkge1xuXHRcdCAgICAgICAgdGhpcy5ncmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluay51c2VBdmdXZWlnaHQgPSAhIXZhbDtcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBTZXRzIHRoZSB3ZWlnaHQgb2YgdGhpcyBsaW5rXG5cdFx0ICAgICAqXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB3ZWlnaHQgIFRoZSB3ZWlnaHQgdG8gc2V0IHRvXG5cdFx0ICAgICAqL1xuXHRcdCAgICBzZXRXZWlnaHQod2VpZ2h0KSB7XG5cdFx0ICAgICAgICB0aGlzLndlaWdodCA9IHdlaWdodDtcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBHZXRzIHRoZSByYXcgd2VpZ2h0LlxuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcmV0dXJuICAgICB7bnVtYmVyfSAgVGhlIHJhdyB3ZWlnaHQuXG5cdFx0ICAgICAqL1xuXHRcdCAgICBnZXRSYXdXZWlnaHQoKSB7XG5cdFx0ICAgICAgICByZXR1cm4gdGhpcy53ZWlnaHQ7IFxuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIEdldHMgdGhlIHdlaWdodCB2YWx1ZSBvZiB0aGUgbGluaywgZGVwZW5kaW5nIG9uIHRoZVxuXHRcdCAgICAgKiB1c2VBdmdXZWlndGggc2V0dGluZ1xuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcmV0dXJuICAgICB7bnVtYmVyfSAgVGhlIHdlaWdodC5cblx0XHQgICAgICovXG5cdFx0ICAgIGdldFdlaWdodCgpIHtcblx0XHQgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuXHRcdCAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXG5cdFx0ICAgICAgICBpZiAoc3RhdGUudXNlQXZnV2VpZ2h0KSB7XG5cdFx0ICAgICAgICAgICAgdmFyIHdlaWdodCA9IHRoaXMud2VpZ2h0IC8gdGhpcy5jb3VudDtcblx0XHQgICAgICAgICAgICByZXR1cm4gd2VpZ2h0O1xuXHRcdCAgICAgICAgfVxuXHRcdCAgICAgICAgcmV0dXJuIHRoaXMud2VpZ2h0O1xuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIFVwZGF0ZXMgdGhlIG1heCB3ZWlnaHQgb2YgdGhlIGdyYXBoXG5cdFx0ICAgICAqL1xuXHRcdCAgICB1cGRhdGVNYXhXZWlnaHQgKCkge1xuXHRcdCAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG5cdFx0ICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuVmlzdWFsaXplckxpbms7XG5cblx0XHQgICAgICAgIHZhciBtYXhMaW5rID0gXy5tYXhCeSh0aGlzR3JhcGgubGlua3MsIGZ1bmN0aW9uKGwpIHtcblx0XHQgICAgICAgIFx0aWYgKGwuZ3JhcGggIT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIGwuZ2V0V2VpZ2h0KCk7XG5cdFx0ICAgICAgICBcdH1cblx0XHQgICAgICAgIFx0cmV0dXJuIDA7XG5cdFx0ICAgICAgICB9KTtcblx0XHQgICAgICAgIHN0YXRlLm1heFdlaWdodCA9IG1heExpbmsuZ2V0V2VpZ2h0KCk7XG5cdFx0ICAgIH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxsZWQgZHVyaW5nIHRoZSB1cGRhdGUgZ3JhcGggZm9yIGV4aXN0aW5nIGxpbmtzXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuXHRcdFx0ICogQHBhcmFtICAgICAge0xpbmt9ICBcdCAgIGQgICAgICAgTWF0Y2hpbmcgTGluayBPYmplY3QgICAgICAgXG5cdFx0XHQgKi9cblx0XHRcdHVwZGF0ZUF0dHIoZDNwYXRoLCBkKSB7XG5cdFx0ICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcblx0XHQgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluaztcblx0XHQgICAgICAgIHRoaXMudXBkYXRlTWF4V2VpZ2h0KCk7XG5cdCAgICAgICAgICAgIHZhciBjb2xvclNjYWxlID0gZDMuc2NhbGUubGluZWFyKClcblx0ICAgICAgICAgICAgICAgIC5kb21haW4oWzAsIHN0YXRlLm1heFdlaWdodF0pXG5cdCAgICAgICAgICAgICAgICAucmFuZ2UoW1wiI2ZmYjM2NlwiLCBcIiNGOTI2MDZcIl0pO1xuXHQgICAgICAgICAgICBzdGF0ZS5jb2xvclNjYWxlID0gY29sb3JTY2FsZTtcblx0XHRcdFx0ZDNwYXRoLnN0eWxlKCdtYXJrZXItZW5kJywgJ3VybCgjZW5kLWFycm93KScpXG5cdFx0ICAgICAgICAgICAgLmNsYXNzZWQodGhpc0dyYXBoLmNvbnN0cy5zZWxlY3RlZENsYXNzLCBmdW5jdGlvbihkKXtcblx0XHQgICAgICAgICAgICAgICAgcmV0dXJuIGQgPT09IHN0YXRlLnNlbGVjdGVkRWRnZTtcblx0XHQgICAgICAgICAgICB9KVxuXHRcdCAgICAgICAgICAgIC5hdHRyKFwiZFwiLCB0aGlzLmFycm93UGF0aC5jYWxsKGQpKVxuXHRcdCAgICAgICAgICAgIC50cmFuc2l0aW9uKFwiZXhpc3RpbmdQYXRoVHJhbnNpdGlvblwiKVxuXHRcdCAgICAgICAgICAgIC5kdXJhdGlvbig3NTApXG5cdFx0ICAgICAgICAgICAgLmF0dHIoXCJzdHJva2VcIiwgZnVuY3Rpb24oZCl7XG5cdFx0ICAgICAgICAgICAgICAgIHZhciBjID0gY29sb3JTY2FsZShkLmdldFdlaWdodCgpKTtcblx0XHQgICAgICAgICAgICAgICAgcmV0dXJuIGM7XG5cdFx0ICAgICAgICAgICAgfSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsbGVkIGR1cmluZyB0aGUgZmlyc3QgdXBkYXRlIGdyYXBoIGZvciB0aGlzIGxpbmtcblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM3BhdGggIFRoZSBkMyBwYXRoXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7TGlua30gIFx0ICAgZCAgICAgICBNYXRjaGluZyBMaW5rIE9iamVjdFxuXHRcdFx0ICovXG5cdFx0XHRuZXdQYXRoQXR0cihkM3BhdGgsIGQpIHtcblx0XHQgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuXHRcdCAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXHQgICAgICAgICAgICB0aGlzLnVwZGF0ZU1heFdlaWdodCgpO1xuXHQgICAgICAgICAgICB2YXIgY29sb3JTY2FsZSA9IGQzLnNjYWxlLmxpbmVhcigpXG5cdCAgICAgICAgICAgICAgICAuZG9tYWluKFswLCBzdGF0ZS5tYXhXZWlnaHRdKVxuXHQgICAgICAgICAgICAgICAgLnJhbmdlKFtcIiNmZmIzNjZcIiwgXCIjRjkyNjA2XCJdKTtcblx0ICAgICAgICAgICAgICAgIFxuXHRcdFx0XHRkM3BhdGgudHJhbnNpdGlvbihcIm5ld1BhdGhUcmFuc2l0aW9uXCIpXG5cdFx0ICAgICAgICAgICAgLmR1cmF0aW9uKDc1MClcblx0XHQgICAgICAgICAgICAuYXR0clR3ZWVuKFwib3BhY2l0eVwiLCBmdW5jdGlvbihkKSB7XG5cdFx0ICAgICAgICAgICAgICAgIHJldHVybiBkMy5pbnRlcnBvbGF0ZVN0cmluZygwLDEpO1xuXHRcdCAgICAgICAgICAgIH0pXG5cdFx0ICAgICAgICAgICAgLmF0dHIoXCJzdHJva2VcIiwgZnVuY3Rpb24oZCl7XG5cdFx0ICAgICAgICAgICAgICAgIHZhciBjID0gY29sb3JTY2FsZShkLmdldFdlaWdodCgpKTtcblx0XHQgICAgICAgICAgICAgICAgcmV0dXJuIGM7XG5cdFx0ICAgICAgICAgICAgfSlcblx0XHQgICAgICAgICAgICAuYXR0cignZCcsIHRoaXMuYXJyb3dQYXRoLmNhbGwoZCkpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB7XG5cdFx0XHRMaW5rIDogVmlzdWFsaXplckxpbmtcblx0XHR9XG59XSk7XG5cblxuXG5cblxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3MnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbmV0d29ya3MnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICduZXR3b3JrTGlzdCdcbiAgICAgICAgfSkuXG4gICAgICAgICAgICBzdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3MuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnbmV0d29ya2RldGFpbHMnXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIFRoZSBiYXNlIGNsYXNzIGZvciBub2RlIG9iamVjdHMgZm9yIHRoZSBncmFwaC5cbiAqIFN1cHBvcnRzIHBvbGljaWVzLlxuICogXG4gKiBUbyB3cml0ZSB5b3VyIG93biBOb2RlIG9iamVjdCwgY3JlYXRlIGEgbmV3IGZhY3RvcnkgdGhhdCB1c2VzIHRoZSBub2RlXG4gKiB5b3Ugd2FudCB0byBpbmhlcml0IGFzIGEgZGVwZW5kZW5jeSwgYW5kIGV4dGVuZCBpdHMgbm9kZSBjbGFzcy4gXG4gKiBSZXR1cm4gdGhlIGNsYXNzIG9iamVjdCB3aXRoIE5vZGUgYXMga2V5XG4gKiBcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ05vZGUnLCBbZnVuY3Rpb24gKCkge1xuXHRcdGNsYXNzIE5vZGUge1xuXHRcdFx0LyoqXG5cdFx0XHQgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge251bWJlcn0gIHggICAgICAgeCBsb2NhdGlvblxuXHRcdFx0ICogQHBhcmFtICAgICAge251bWJlcn0gIHkgICAgICAgeSBsb2NhdGlvblxuXHRcdFx0ICogQHBhcmFtICAgICAge3N0cmluZ30gIGlkICAgICAgVGhlIGlkZW50aWZpZXJcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICB0ZXh0ICAgIFRoZSB0ZXh0IHRvIGRpc3BsYXlcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICByYWRpdXMgIFRoZSByYWRpdXMgb2YgdGhlIG5vZGVcblx0XHRcdCAqL1xuXHRcdFx0Y29uc3RydWN0b3IoeCwgeSwgaWQsIHRleHQsIHJhZGl1cykge1xuXHRcdFx0XHR0aGlzLnggPSB4O1xuXHRcdFx0XHR0aGlzLnkgPSB5O1xuXHRcdFx0XHR0aGlzLnJhZGl1cyA9IHJhZGl1cztcblx0XHRcdFx0dGhpcy5pZCA9IGlkO1xuXHRcdFx0XHR0aGlzLnRleHQgPSB0ZXh0O1xuXHRcdFx0XHR0aGlzLnJhZGl1cyA9IHJhZGl1cztcblx0XHRcdFx0dGhpcy5oYXNQb2xpY3kgPSBmYWxzZTtcblx0XHRcdFx0dGhpcy5wb2xpY3kgPSBudWxsO1xuXHRcdFx0XHR0aGlzLm5vZGVQb2xpY2llcyA9IFtdO1xuXHRcdFx0XHR0aGlzLmdyYXBoID0gbnVsbDtcblx0XHRcdFx0dGhpcy5pbml0aWFsaXplZCA9IGZhbHNlO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCB3aGVuIGEgbm9kZSBpcyBhZGRlZCB0byB0aGUgZ3JhcGhcblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaCBpdCBpcyBhZGRlZCB0b1xuXHRcdFx0ICovXG5cdFx0XHRpbml0aWFsaXplKGdyYXBoKSB7XG5cdFx0XHRcdGlmICh0aGlzLmluaXRpYWxpemVkID09IGZhbHNlKSB7XG5cdFx0XHRcdFx0dGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG5cdFx0XHRcdFx0dGhpcy5ncmFwaCA9IGdyYXBoO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsbGVkIGR1cmluZyB0aGUgdXBkYXRlIGdyYXBoIGZvciBleGlzdGluZyBsaW5rc1xuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcblx0XHRcdCAqL1xuXHRcdFx0dXBkYXRlQXR0cihkM25vZGUsIGQpIHtcblx0XHRcdFx0ZDNub2RlLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZnVuY3Rpb24oZCl7cmV0dXJuIFwidHJhbnNsYXRlKFwiICsgZC54ICsgXCIsXCIgKyBkLnkgKyBcIilcIjt9KTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxsZWQgZHVyaW5nIHRoZSBmaXJzdCB1cGRhdGUgZ3JhcGggZm9yIGEgbm9kZVxuXHRcdFx0ICogSG9vayBmb3Igc3ViIGNsYXNzZXNcblx0XHRcdCAqIFxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuXHRcdFx0ICogQHBhcmFtICAgICAge05vZGV9ICAgICAgZCAgICAgICBNYXRjaGluZyBOb2RlIE9iamVjdFxuXHRcdFx0ICovXG5cdFx0XHRuZXdOb2RlQXR0cihkM25vZGUsIGQpIHtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBTZXRzIHRoZSByYWRpdXMgb2YgdGhlIG5vZGUuXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge251bWJlcn0gIHJhZGl1cyAgVGhlIHJhZGl1c1xuXHRcdFx0ICovXG5cdFx0XHRzZXRSYWRpdXMocmFkaXVzKSB7XG5cdFx0XHRcdHRoaXMucmFkaXVzID0gcmFkaXVzO1xuXHRcdFx0fVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBVc2VkIHRvIGluc3RhbGwgcG9saWNpZXMgdGhhdCBhcmUgY2FsbGVkIHdoZW4gdGhpc1xuXHRcdCAgICAgKiBub2RlIGhhcyBhIG1vdXNlIGV2ZW50XG5cdFx0ICAgICAqXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3kgIFRoZSBwb2xpY3kgdG8gaW5zdGFsbFxuXHRcdCAgICAgKi9cblx0XHRcdGluc3RhbGxOb2RlUG9saWN5KHBvbGljeSkge1xuXHRcdFx0XHR0aGlzLmhhc1BvbGljeSA9IHRydWU7XG5cdFx0XHRcdHRoaXMubm9kZVBvbGljaWVzLnB1c2gocG9saWN5KTtcblx0XHRcdFx0cG9saWN5LmluaXRpYWxpemUodGhpcy5ncmFwaCk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogVXNlZCB0byB1bmluc3RhbGwgcG9saWN5IGZvciB0aGlzIG5vZGVcblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7UG9saWN5fHN0cmluZ30gIHBvbGljeVJlbW92ZSAgVGhlIHBvbGljeSB0byByZW1vdmVcblx0XHRcdCAqL1x0XHRcdFxuXHRcdFx0dW5pbnN0YWxsTm9kZVBvbGljeShwb2xpY3lSZW1vdmUpIHtcblx0XHRcdFx0dmFyIHBvbGljeVJlbW92ZU5hbWU7XG5cdFx0XHRcdHZhciB0aGlzTm9kZSA9IHRoaXM7XG5cdFx0XHRcdGlmICh0eXBlb2YgcG9saWN5UmVtb3ZlID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRcdHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmU7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZS5wb2xpY3lOYW1lO1xuXHRcdFx0XHR9XG5cdFx0XHRcdF8odGhpc05vZGUubm9kZVBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSwgaW5kZXgpIHtcblx0XHRcdFx0XHRpZiAocG9saWN5LnBvbGljeU5hbWUgPT09IHBvbGljeVJlbW92ZU5hbWUpIHtcblx0XHRcdFx0XHRcdHBvbGljeS5kZXN0cm95KCk7XG5cdFx0XHRcdFx0XHR0aGlzTm9kZS5ub2RlUG9saWNpZXMuc3BsaWNlKGluZGV4LCAxKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRpZiAodGhpc05vZGUubm9kZVBvbGljaWVzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0XHRcdHRoaXNOb2RlLmhhc1BvbGljeSA9IGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsbGVkIHdoZW4gdGhlcmUgaXMgYSBtb3VzZSBldmVudCBmb3IgdGhpcyBub2RlXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge3N0cmluZ30gIGV2ZW50ICAgICBUaGUgbW91c2UgZXZlbnRcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBkICAgICAgICAgVGhlIG1hdGNoaW5nIG5vZGUgb2JqZWN0XG5cdFx0XHQgKi9cblx0XHRcdG5vZGVQb2xpY3lFdmVudChldmVudCwgZDNub2RlLCBkKSB7XG5cdFx0XHRcdF8uZm9yRWFjaCh0aGlzLm5vZGVQb2xpY2llcywgZnVuY3Rpb24ocG9saWN5KSB7XG5cdFx0XHRcdFx0cG9saWN5W2V2ZW50XShkM25vZGUsIGQpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHtcblx0XHRcdE5vZGU6IE5vZGVcblx0XHR9XG59XSk7XG5cblxuXG5cblxuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbm9kZXMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIFRoZSBub2RlIHRoYXQgaXMgdXNlZCBzcGVjaWZpY2FsbHkgZm9yIHRoZSB2aXN1YWxpemF0aW9uIHRhYi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ1Zpc3VhbGl6ZXJOb2RlJywgWydOb2RlJywgZnVuY3Rpb24gKE5vZGUpIHtcblx0XHRjbGFzcyBWaXN1YWxpemVyTm9kZSBleHRlbmRzIE5vZGUuTm9kZSB7XG5cdFx0XHQvKipcblx0XHRcdCAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeCAgICAgICBcdHggbG9jYXRpb25cblx0XHRcdCAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB5ICAgICAgIFx0eSBsb2NhdGlvblxuXHRcdFx0ICogQHBhcmFtICAgICAge3N0cmluZ30gIGlkICAgICAgXHRUaGUgaWRlbnRpZmllclxuXHRcdFx0ICogQHBhcmFtICAgICAge3N0cmluZ30gIHRleHQgICAgXHRUaGUgdGV4dCB0byBkaXNwbGF5XG5cdFx0XHQgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgcmFkaXVzICBcdFRoZSByYWRpdXMgb2YgdGhlIG5vZGVcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBwYXJlbnQgICAgIFRoZSBwYXJlbnQgaWRcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBhbmNlc3RvcnMgIEFycmF5IG9mIGFuY2VzdG9ycyBJZFxuXHRcdFx0ICogQHBhcmFtICAgICAge251bWJlcn0gIHhTdGFydCAgICAgeCBsb2MgdG8gc3RhcnQgYW5pbWF0aW9uXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeVN0YXJ0ICAgICB5IGxvYyB0byBzdGFydCBhbmltYXRpb25cblx0XHRcdCAqL1xuXHRcdCAgICBjb25zdHJ1Y3Rvcih4LCB5LCBpZCwgdGV4dCwgcmFkaXVzLCBwYXJlbnQsIGFuY2VzdG9ycywgXG5cdFx0ICAgIFx0eFN0YXJ0LCB5U3RhcnQpIHtcblx0XHQgICAgICAgIHN1cGVyKHgsIHksIGlkLCB0ZXh0LCByYWRpdXMpO1xuXHRcdCAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG5cdFx0ICAgICAgICB0aGlzLmFuY2VzdG9ycyA9IGFuY2VzdG9ycztcblx0XHQgICAgICAgIGlmICh4U3RhcnQgPT0gbnVsbCkge1xuXHRcdCAgICAgICAgXHR0aGlzLnhTdGFydCA9IHg7XG5cdFx0ICAgICAgICB9IGVsc2Uge1xuXHRcdCAgICAgICAgXHR0aGlzLnhTdGFydCA9IHhTdGFydDtcblx0XHQgICAgICAgIH1cblx0XHQgICAgICAgIGlmICh5U3RhcnQgPT0gbnVsbCkge1xuXHRcdCAgICAgICAgXHR0aGlzLnlTdGFydCA9IHk7XG5cdFx0ICAgICAgICB9IGVsc2Uge1xuXHRcdCAgICAgICAgXHR0aGlzLnlTdGFydCA9IHlTdGFydDtcblx0XHQgICAgICAgIH1cblx0XHQgICAgfVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCBkdXJpbmcgdGhlIGZpcnN0IHVwZGF0ZSBncmFwaCBmb3IgYSBub2RlXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuXHRcdFx0ICogQHBhcmFtICAgICAge05vZGV9ICAgIGQgICAgICAgICBUaGUgbWF0Y2hpbmcgTm9kZVxuXHRcdFx0ICovXG5cdFx0XHRuZXdOb2RlQXR0cihkM25vZGUsIGQpIHtcblx0XHRcdFx0dmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG5cdFx0XHRcdGlmICh0aGlzR3JhcGguY29uc3RzLmNvbnRhaW5lckNsYXNzICE9IG51bGwgJiZcblx0XHRcdFx0XHRcdHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFtkLmlkXSA9PSBudWxsKSB7XG5cdFx0XHRcdFx0ZDNub2RlLmNsYXNzZWQodGhpc0dyYXBoLmNvbnN0cy5jb250YWluZXJDbGFzcywgdHJ1ZSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0ZDNub2RlLnRyYW5zaXRpb24oXCJub2RlUG9zaXRpb25UcmFuc2l0aW9uXCIpXG5cdFx0ICAgICAgICAgICAgICAgIC5kdXJhdGlvbig3NTApXG5cdFx0ICAgICAgICAgICAgICAgIC5hdHRyVHdlZW4oXCJ0cmFuc2Zvcm1cIiwgZnVuY3Rpb24oZCkge1xuXHRcdCAgICAgICAgICAgICAgICAgICAgaWYgKGQueFN0YXJ0ICE9IG51bGwgJiYgZC55U3RhcnQgIT0gbnVsbCkge1xuXHRcdCAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4U3RhcnQgPSBkLnhTdGFydDtcblx0XHQgICAgICAgICAgICAgICAgICAgICAgICB2YXIgeVN0YXJ0ID0gZC55U3RhcnQ7XG5cdFx0ICAgICAgICAgICAgICAgICAgICAgICAgZC54U3RhcnQgPSBkLng7XG5cdFx0ICAgICAgICAgICAgICAgICAgICAgICAgZC55U3RhcnQgPSBkLnk7XG5cdFx0ICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQzLmludGVycG9sYXRlU3RyaW5nKFwidHJhbnNsYXRlKFwiICsgeFN0YXJ0ICsgXCIsXCIgKyB5U3RhcnQgKyBcIilcIiwgXCJ0cmFuc2xhdGUoXCIgKyBkLnggKyBcIixcIiArIGQueSArIFwiKVwiKTtcblx0XHQgICAgICAgICAgICAgICAgICAgIH1cblx0XHQgICAgICAgICAgICAgICAgICAgIHJldHVybiBkMy5pbnRlcnBvbGF0ZVN0cmluZyhcInRyYW5zbGF0ZShcIiArIGQueCArIFwiLFwiICsgZC55ICsgXCIpXCIsIFwidHJhbnNsYXRlKFwiICsgZC54ICsgXCIsXCIgKyBkLnkgKyBcIilcIik7XG5cdFx0ICAgICAgICAgICAgICAgIH0pO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB7XG5cdFx0XHROb2RlOiBWaXN1YWxpemVyTm9kZVxuXHRcdH1cblxufV0pO1xuXG5cblxuXG5cblxuXG5cbiIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYub3JnYW5pemF0aW9ucycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvb3JnYW5pemF0aW9ucycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5saXN0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnb3JnYW5pemF0aW9ubGlzdCdcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIi8qKlxuICogVGhpcyBwb2xpY3kgaXMgdXNlZCB0byBhZGQgYSBzZWxlY3Qgbm9kZSBmZWF0dXJlLlxuICogU3VwcG9ydHMgc2VsZWN0aW5nIG11bHRpcGxlIG5vZGVzIGJ5IHVzaW5nIHRoZSBjdHJsIGtleS5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ05vZGVTZWxlY3Rpb25Qb2xpY3knLCBbJ1BvbGljeScsIGZ1bmN0aW9uIChQb2xpY3kpIHtcblxuICAgIFx0Y2xhc3MgTm9kZVNlbGVjdGlvblBvbGljeSBleHRlbmRzIFBvbGljeS5Qb2xpY3kge1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAgICAgICAgIHN1cGVyKFwiTm9kZVNlbGVjdGlvblBvbGljeVwiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAgICAgKiBPdmVyd3JpdGVzIHRoZSBvbiBkcmFnIGV2ZW50IG9mIHRoZSBncmFwaFxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaCBpdCBpcyBcbiAgICBcdFx0ICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YWxsZWQgb25cbiAgICBcdFx0ICovXG4gICAgICAgICAgICBpbml0aWFsaXplKGdyYXBoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdXBlci5pbml0aWFsaXplKGdyYXBoKTtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBncmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgc3RhdGUuc2VsZWN0ZWROb2RlcyA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBjb25zdHMgPSBncmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIGNvbnN0cy5zZWxlY3RlZENsYXNzID0gXCJzZWxlY3RlZFwiO1xuICAgICAgICAgICAgICAgIC8vb3ZlcndyaXR0aW5nIGdyYXBoJ3Mgbm9kZSBvbiBkcmFnIGV2ZW50IHRvIHN1cHBvcnRcbiAgICAgICAgICAgICAgICAvL21vdmluZyBtdWx0aXBsZSBub2RlcyBhdCBvbmNlXG4gICAgICAgICAgICAgICAgdmFyIGRyYWcgPSBncmFwaC5kcmFnO1xuICAgICAgICAgICAgICAgIGRyYWcub24oJ2RyYWcnLCBmdW5jdGlvbihhcmdzKSB7XG4gICAgICAgICAgICAgICAgXHR2YXIgdGhpc0dyYXBoID0gZ3JhcGg7XG4gICAgICAgICAgICAgICAgXHRpZiAodGhpc0dyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBcdFx0dmFyIHNlbGVjdGVkQ2xhc3MgPSB0aGlzR3JhcGguY29uc3RzLk5vZGVTZWxlY3Rpb25Qb2xpY3kuc2VsZWN0ZWRDbGFzcztcbiAgICAgICAgICAgICAgICBcdFx0dmFyIHNlbGVjdGlvbiA9IGQzLnNlbGVjdEFsbCggJy4nICtzZWxlY3RlZENsYXNzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIHNlbGVjdGlvblswXS5pbmRleE9mKCB0aGlzKT09LTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb24uY2xhc3NlZChzZWxlY3RlZENsYXNzLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uID0gZDMuc2VsZWN0KCB0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb24uY2xhc3NlZChzZWxlY3RlZENsYXNzLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGlvbi5hdHRyKFwidHJhbnNmb3JtXCIsIGZ1bmN0aW9uKCBkLCBpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC54ICs9IGQzLmV2ZW50LmR4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSArPSBkMy5ldmVudC5keTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJ0cmFuc2xhdGUoXCIgKyBbIGQueCxkLnkgXSArIFwiKVwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgICAgIFx0fVxuXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBBZGRzIHRoZSBnaXZlbiBub2RlIHRvIHRoZSBhcnJheSBvZiBzZWxlY3RlZCBub2Rlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzTm9kZSAgICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgbm9kZURhdGEgIE1hdGNoaW5nIE5vZGUgb2JqZWN0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGFkZFNlbGVjdE5vZGUoZDNOb2RlLCBub2RlRGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzLk5vZGVTZWxlY3Rpb25Qb2xpY3k7XG5cbiAgICAgICAgICAgICAgICBkM05vZGUuY2xhc3NlZChjb25zdHMuc2VsZWN0ZWRDbGFzcywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgc3RhdGUuc2VsZWN0ZWROb2Rlcy5wdXNoKG5vZGVEYXRhKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmVzIHRoZSBnaXZlbiBub2RlIGZyb20gdGhlIGFycmF5IG9mIHNlbGVjdGVkIG5vZGVzLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzTm9kZSAgICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgbm9kZURhdGEgIE1hdGNoaW5nIG5vZGUgb2JqZWN0IFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICByZW1vdmVTZWxlY3RGcm9tTm9kZShkM05vZGUsIG5vZGVEYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmZpbHRlcihmdW5jdGlvbihjZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2QuaWQgPT09IG5vZGVEYXRhLmlkO1xuICAgICAgICAgICAgICAgIH0pLmNsYXNzZWQoY29uc3RzLnNlbGVjdGVkQ2xhc3MsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBzdGF0ZS5zZWxlY3RlZE5vZGVzLmluZGV4T2Yobm9kZURhdGEpO1xuICAgICAgICAgICAgICAgIHN0YXRlLnNlbGVjdGVkTm9kZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmVzIGFsbCBzZWxlY3RlZCBub2Rlcy5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgcmVtb3ZlQWxsU2VsZWN0ZWROb2RlcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuY2xhc3NlZChjb25zdHMuc2VsZWN0ZWRDbGFzcywgZmFsc2UpO1xuICAgICAgICAgICAgICAgIHN0YXRlLnNlbGVjdGVkTm9kZXMgPSBbXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBPbiBNb3VzZWRvd24sIGRldGVybWluZXMgd2hldGhlciB0byBjaGFuZ2UgdGhlXG4gICAgICAgICAgICAgKiBzZWxlY3RlZCBzdGF0dXMgb2YgdGhlIGNsaWNrZWQgbm9kZS5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gICAgICBkICAgICAgIE1hdGNoaW5nIE5vZGUgT2JqZWN0ICAgICAgIFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBtb3VzZWRvd24oZDNub2RlLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3k7XG4gICAgICAgICAgICAgICAgZDMuZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgaWYgKGQzLmV2ZW50LmN0cmxLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLnNlbGVjdGVkTm9kZXMuaW5kZXhPZihkKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVNlbGVjdEZyb21Ob2RlKGQzbm9kZSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZFNlbGVjdE5vZGUoZDNub2RlLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdGUuc2VsZWN0ZWROb2Rlcy5pbmRleE9mKGQpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgbm8gY29udHJvbCBrZXksIGFuZCBjbGlja2VkIG5vdCBzZWxlY3RlZCBub2RlLFxuICAgICAgICAgICAgICAgICAgICAvL3JlbW92ZSBhbGwgb2YgY3VycmVudCBzZWxlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVBbGxTZWxlY3RlZE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIE9uIE1vdXNldXAsIGRldGVybWluZXMgd2hldGhlciB0byBjaGFuZ2UgdGhlXG4gICAgICAgICAgICAgKiBzZWxlY3RlZCBzdGF0dXMgb2YgdGhlIGNsaWNrZWQgbm9kZS5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gICAgICBkICAgICAgIE1hdGNoaW5nIE5vZGUgT2JqZWN0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIG1vdXNldXAoZDNub2RlLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3k7XG4gICAgICAgICAgICAgICAgaWYgKCFkMy5ldmVudC5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgbGVuZ3RoIGlzIGdyZWF0ZXIgdGhhbiAxLCB0aGVuIHdlIGFyZSBtb3ZpbmcgbXVsdGlwbGUgbm9kZXNcbiAgICAgICAgICAgICAgICAgICAgLy9sZWF2ZSB0aGVtIGFsbCBoaWdobGlnaHRlZFxuICAgICAgICAgICAgICAgICAgICAvL290aGVyd2lzZSB3ZSBhcmUganVzdCBtb3Zpbmcgb25lIG5vZGUsIHNvIHVuaGlnaGxpZ2h0XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5zZWxlY3RlZE5vZGVzLmxlbmd0aCA8PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVNlbGVjdEZyb21Ob2RlKGQzbm9kZSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIFBvbGljeTogTm9kZVNlbGVjdGlvblBvbGljeVxuICAgICAgICB9XG59XSk7XG5cblxuXG5cblxuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zZXJ2aWNlbGJzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzJywge1xuICAgICAgICAgICAgdXJsOiAnL3NlcnZpY2VsYnMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ3NlcnZpY2VsYkxpc3QnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMuZGV0YWlscy5zdGF0cycsIHtcbiAgICAgICAgICAgIHVybDogJy9zdGF0cycsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdzZXJ2aWNlbGJzdGF0J1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zZXR0aW5ncycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZ2xvYmFsJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL3NldHRpbmdzJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2V0dGluZ3Mvc2V0dGluZ3NtZW51Lmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMubG9ncycsIHtcbiAgICAgICAgICAgIHVybDogJy9sb2dzJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICcnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMuYXV0aCcsIHtcbiAgICAgICAgICAgIHVybDogJy9hdXRoJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICcnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMubGljZW5zZScsIHtcbiAgICAgICAgICAgIHVybDogJy9saWNlbnNlJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICcnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMucG9saWNpZXMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvcG9saWNpZXMnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJycsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5uZXR3b3JrcycsIHtcbiAgICAgICAgICAgIHVybDogJy9uZXR3b3JrcycsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICduZXR3b3Jrc2V0dGluZydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy52b2x1bWVzJywge1xuICAgICAgICAgICAgdXJsOiAnL3ZvbHVtZXMnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAndm9sdW1lc2V0dGluZydcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIi8qKlxuICogVGhpcyBwb2xpY3kgY2hhbmdlcyB0aGUgdmlldyB0byB0aGUgdGltZWdyYXBoIG9mIGxpbmsgZGF0YSBvbiBjbGljay5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ1BhdGhDaGFuZ2VWaWV3UG9saWN5JywgWydQb2xpY3knLCBmdW5jdGlvbiAoUG9saWN5KSB7XG4gICAgXHRjbGFzcyBQYXRoQ2hhbmdlVmlld1BvbGljeSBleHRlbmRzIFBvbGljeS5Qb2xpY3kge1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgdG8gYnVpbGQgcG9saWN5XG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAge0FuZ3VsYXIgU3RhdGV9ICAgICRzdGF0ZSAgICBVc2VkIHRvIGNoYW5nZSB2aWV3XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKCRzdGF0ZSkge1xuICAgICAgICAgICAgICAgIHN1cGVyKCdQYXRoQ2hhbmdlVmlld1BvbGljeScpO1xuICAgICAgICAgICAgICAgIHRoaXMuJHN0YXRlID0gJHN0YXRlO1xuICAgICAgICAgICAgfVxuXG5cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBHZW5lcmF0ZXMgYSBsaXN0IG9mIGFsbCBjaGlsZCBjb250YWluZXJzIG9mIHRoZSBzZXJ2aWNlXG4gICAgICAgICAgICAgKiBDYW4gaGFuZGxlIG5lc3RlZCBzZXJ2aWNlcy5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgaWQgICAgICBOb2RlIElEXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGdlbmVyYXRlTGlzdChpZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgcmV0TGlzdCA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBnZW5lcmF0ZUxpc3RIZWxwZXIgPSBmdW5jdGlvbihpZCwgcmV0TGlzdCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZUlkcyA9IHRoaXNQb2xpY3kuZ3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbaWRdO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVJZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZElkID0gbm9kZUlkc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzUG9saWN5LmdyYXBoLmRhdGFTb3VyY2UuaGFzQ2hpbGQoY2hpbGRJZCkgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUmV0TGlzdCA9IGdlbmVyYXRlTGlzdEhlbHBlcihjaGlsZElkLCByZXRMaXN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXRMaXN0LmNvbmNhdChzdWJSZXRMaXN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0TGlzdC5wdXNoKGNoaWxkSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGdlbmVyYXRlTGlzdEhlbHBlcihpZCwgcmV0TGlzdCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJldExpc3RcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIHJlcm91dGUgYW4gZWRnZSB3aGVuIGNsaWNrZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7TGlua30gIGVkZ2UgICAgVGhlIGNsaWNrZWQgZWRnZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB2aWV3RWRnZShlZGdlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNvdXJjZUxpc3QgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0TGlzdCA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBzb3VyY2VJZCA9IGVkZ2Uuc291cmNlLmlkO1xuICAgICAgICAgICAgICAgIHZhciB0YXJnZXRJZCA9IGVkZ2UudGFyZ2V0LmlkO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZ3JhcGguZGF0YVNvdXJjZS5oYXNDaGlsZChzb3VyY2VJZCkgPT09IHRydWUpIHsvL05vdCBhIGNvbnRhaW5lciBub2RlLCBuZWVkIHRvIGFnZ3JlZ2F0ZVxuICAgICAgICAgICAgICAgICAgICBzb3VyY2VMaXN0ID0gdGhpcy5nZW5lcmF0ZUxpc3Qoc291cmNlSWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZUxpc3QgPSBbc291cmNlSWRdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmdyYXBoLmRhdGFTb3VyY2UuaGFzQ2hpbGQodGFyZ2V0SWQpID09PSB0cnVlKSB7Ly9Ob3QgYSBjb250YWluZXIgbm9kZSwgbmVlZCB0byBhZ2dyZWdhdGVcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TGlzdCA9IHRoaXMuZ2VuZXJhdGVMaXN0KHRhcmdldElkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRMaXN0ID0gW3RhcmdldElkXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy4kc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZpc3VhbGl6YXRpb24uZWRnZScsIFxuICAgICAgICAgICAgICAgICAgICB7c291cmNlTmFtZTogc291cmNlSWQsIHRhcmdldE5hbWU6IHRhcmdldElkLFxuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlTGlzdDogc291cmNlTGlzdCwgdGFyZ2V0TGlzdDogdGFyZ2V0TGlzdH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBtb3VzZWRvd24oZDNwYXRoLCBkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52aWV3RWRnZShkKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBQb2xpY3k6IFBhdGhDaGFuZ2VWaWV3UG9saWN5XG4gICAgICAgIH1cbn1dKTtcblxuXG5cblxuXG5cblxuXG5cblxuXG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc3RvcmFnZXBvbGljaWVzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvc3RvcmFnZXBvbGljaWVzJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ3N0b3JhZ2Vwb2xpY3lsaXN0J1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwIiwiLyoqXG4gKiBCYXNlIHBvbGljeSBjbGFzcyBmb3IgdGhlIGdyYXBoIG9iamVjdFxuICogXG4gKiBQb2xpY2llcyBhcmUgdXNlZCB0byBpc29sYXRlIGZlYXR1cmVzIGZvciBhIGdyYXBoLlxuICogUG9saWNpZXMgY2FuIGJlIGluc3RhbGxlZCBvbiBub2RlcywgbGlua3MsIG9yIHRoZSBncmFwaC5cbiAqIEVhY2ggcG9saWN5IGhhcyBpbnRlcmFjdGlvbiBoYW5kbGVycyB0aGF0IHdpbGwgYmUgY2FsbGVkIGJ5IHRoZSBncmFwaFxuICogaWYgaW5zdGFsbGVkLiBQb2xpY2llcyBjYW4gYWxzbyBtb2RpZnkgZ3JhcGggZnVuY3Rpb25zIChzZWUgUVRpcFBvbGljeSkuXG4gKiBNdWx0aXBsZSBwb2xpY2llcyBjYW4gYmUgaW5zdGFsbGVkIGZvciBhIG5vZGUgb3IgbGluay4gXG4gKiBcbiAqIFRvIHdyaXRlIHlvdXIgb3duIHBvbGljeSwgY3JlYXRlIGEgbmV3IGZhY3RvcnkgdGhhdCB1c2VzIHRoZSBwb2xpY3lcbiAqIHlvdSB3YW50IHRvIGluaGVyaXQgYXMgYSBkZXBlbmRlbmN5LCBhbmQgZXh0ZW5kIGl0cyBwb2xpY3kuIFxuICogUmV0dXJuIHRoZSBjbGFzcyBvYmplY3Qgd2l0aCBQb2xpY3kgYXMga2V5LCBhbmQgXG4gKiBhZGQgdGhlIHBvbGljeSB0byB0aGUgUG9saWN5U2VydmljZSBmYWN0b3J5LlxuICogXG4gKiBGb3Igc2F2aW5nIHN0YXRlIG9yIGNvbnN0cyBmb3IgdGhlIHBvbGljeSwgY3JlYXRlIGEgbmFtZXNwYWNlXG4gKiBpbiBncmFwaC5zdGF0ZSBhbmQgZ3JhcGguY29uc3RzLlxuICogRXguIFxuICogICAgICBncmFwaC5zdGF0ZS5teVBvbGljeSA9IHt9O1xuICogICAgICBncmFwaC5jb25zdHMubXlQb2xpY3kgPSB7fTtcbiAqICAgICAgXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdQb2xpY3knLCBbZnVuY3Rpb24gKCkge1xuICAgICAgICBjbGFzcyBQb2xpY3kge1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHBvbGljeU5hbWUgIFRoZSBwb2xpY3kgbmFtZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcihwb2xpY3lOYW1lKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wb2xpY3lOYW1lID0gcG9saWN5TmFtZTtcbiAgICAgICAgICAgICAgICB0aGlzLmdyYXBoID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIHBvbGljeSBpcyBpbnN0YWxsZWQuXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAge0dyYXBofSAgZ3JhcGggICBUaGUgR3JhcGggdGhhdCB0aGUgcG9saWN5IGlzXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgYmVpbmcgaW5zdGFsbGVkIG9uXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluaXRpYWxpemUoZ3JhcGgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47IFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLmdyYXBoID0gZ3JhcGg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogSGFuZGxlciwgbWVhbnQgdG8gYmUgb3ZlcnJpZGRlbiBpbiBzdWJjbGFzc2VzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICB7ZDMgb2JqZWN0fSAgICBkM29iaiAgICBUaGUgZDNvYmplY3RcbiAgICAgICAgICAgICAqIEBwYXJhbSAge05vZGUvTGluay9HcmFwaH0gIGQgICBUaGUgb2JqZWN0IGl0IHdhc1xuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbGxlZCBmb3IuICAgIFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBtb3VzZW92ZXIgKGQzb2JqLCBkKSB7fVxuICAgICAgICAgICAgZGJsY2xpY2soZDNvYmosIGQpIHt9XG4gICAgICAgICAgICBjb250ZXh0bWVudShkM29iaiwgZCkge31cbiAgICAgICAgICAgIG1vdXNlb3V0KGQzb2JqLCBkKSB7fVxuICAgICAgICAgICAgbW91c2Vkb3duKGQzb2JqLCBkKSB7fVxuICAgICAgICAgICAgbW91c2V1cChkM29iaiwgZCkge31cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBXaWxsIGJlIGNhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyBiZWluZyBkZXN0cm95ZWQuXG4gICAgICAgICAgICAgKiBVc2VkIHRvIHJlbW92ZSBhbnkgZWxlbWVudHMgb3IgYmluZGluZ3MgdGhlIHBvbGljeVxuICAgICAgICAgICAgICogaGFzIGFkZGVkLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkZXN0cm95KCkge31cbiAgICAgICAgfVxuICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIFBvbGljeTogUG9saWN5XG4gICAgICAgIH1cbn1dKTtcblxuXG5cblxuIiwiXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnLCBcblx0J2NvbnRpdi5ncmFwaCddKVxuIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnY29udGl2Lm1lbnUudmlzdWFsaXphdGlvbicsIHtcbiAgICAgICAgICAgIHVybDogJy92aXN1YWxpemF0aW9uJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KVxuICAgIH1dKTtcbiIsIi8qKlxuICogQ29udGFpbnMgYWxsIHRoZSBwb2xpY2llcy5cbiAqIFNlZSBwb2xpY3kuanMgZm9yIGluZm8gb24gaG93IHBvbGljaWVzIHdvcmsuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdQb2xpY3lTZXJ2aWNlJywgWydQb2xpY3knLCdRVGlwUG9saWN5JywgJ1BhdGhDaGFuZ2VWaWV3UG9saWN5JywgXG4gICAgICAgICdOb2RlU2VsZWN0aW9uUG9saWN5JywgJ1NwbGl0Sm9pbk5vZGVQb2xpY3knLCAnU3BsaXRKb2luVmlld1BvbGljeScsXG4gICAgICAgICdTYXZlU3RhdGVQb2xpY3knLFxuICAgICAgICAgICAgZnVuY3Rpb24gKFBvbGljeSwgUVRpcFBvbGljeSwgUGF0aENoYW5nZVZpZXdQb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgICAgICBOb2RlU2VsZWN0aW9uUG9saWN5LCAgU3BsaXRKb2luTm9kZVBvbGljeSwgXG4gICAgICAgICAgICAgICAgICAgICAgICBTcGxpdEpvaW5WaWV3UG9saWN5LCBTYXZlU3RhdGVQb2xpY3kpIHtcblxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIFBvbGljeTogUG9saWN5LlBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgUVRpcFBvbGljeTogUVRpcFBvbGljeS5Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIFBhdGhDaGFuZ2VWaWV3UG9saWN5OiBQYXRoQ2hhbmdlVmlld1BvbGljeS5Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIE5vZGVTZWxlY3Rpb25Qb2xpY3k6IE5vZGVTZWxlY3Rpb25Qb2xpY3kuUG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBTcGxpdEpvaW5Ob2RlUG9saWN5OiBTcGxpdEpvaW5Ob2RlUG9saWN5LlBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgU3BsaXRKb2luVmlld1BvbGljeTogU3BsaXRKb2luVmlld1BvbGljeS5Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIFNhdmVTdGF0ZVBvbGljeTogU2F2ZVN0YXRlUG9saWN5LlBvbGljeVxuICAgICAgICAgICAgICAgIH1cbn1dKTsiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudm9sdW1lcycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUudm9sdW1lcycsIHtcbiAgICAgICAgICAgIHVybDogJy92b2x1bWVzJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52b2x1bWVzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICd2b2x1bWVsaXN0J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52b2x1bWVzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ3ZvbHVtZWRldGFpbHMnXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIFRoaXMgcG9saWN5IGFkZHMgdG9vbHRpcCBmdW5jdGlvbmFsaXR5IHRvIG5vZGVzIGFuZCBsaW5rcy5cbiAqIFdoZW4gaW5zdGFsbGluZywgaW5zdGFsbCBvbiBib3RoIGxpbmtzIGFuZCBub2Rlcy5cbiAqIFxuICogVXNlcyB0aGUgcVRpcCBqUXVlcnkgcGx1Z2luXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdRVGlwUG9saWN5JywgWydQb2xpY3knLCBmdW5jdGlvbiAoUG9saWN5KSB7XG4gICAgICAgIGNsYXNzIFFUaXBQb2xpY3kgZXh0ZW5kcyBQb2xpY3kuUG9saWN5IHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgICAgICBzdXBlcihcIlFUaXBQb2xpY3lcIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICAgICAqIE1vZGlmaWVzIHRoZSB1cGRhdGVOZXdOb2RlcyBhbmQgXG4gICAgICAgICAgICAgKiB1cGRhdGVOZXdQYXRocyBtZXRob2Qgb2YgdGhlIGdyYXBoIHRvIGluc3RhbGwgcXRpcFxuICAgICAgICAgICAgICogb250byBlYWNoIG5vZGUgYW5kIHBhdGguXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbGxlZCBvblxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbml0aWFsaXplKGdyYXBoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdXBlci5pbml0aWFsaXplKGdyYXBoKTtcblxuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBncmFwaC5zdGF0ZS5RVGlwUG9saWN5ID0ge307XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS5tb3VzZWRvd24gPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIGdyYXBoLmNvbnN0cy5RVGlwUG9saWN5ID0ge307XG5cbiAgICAgICAgICAgICAgICAvL1RyYWNraW5nIG1vdXNlIGNsaWNrIHN0YXRlIHRvIG1ha2UgdG9vbHRpcFxuICAgICAgICAgICAgICAgIC8vZGlzYXBwZWFyIGlmIHRoZSBub2RlIGlzIGJlaW5nIGRyYWdnZWQuXG4gICAgICAgICAgICAgICAgJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS5tb3VzZXVwKGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUubW91c2V1cCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy9vdmVycmlkZSB1cGRhdGVOZXdOb2RlcyBhbmQgdXBkYXRlTmV3UGF0aHNcbiAgICAgICAgICAgICAgICAvL3RvIGluc3RhbGwgcXRpcFxuICAgICAgICAgICAgICAgIHZhciBncmFwaFVwZGF0ZU5ld05vZGVzID0gZ3JhcGgudXBkYXRlTmV3Tm9kZXM7XG4gICAgICAgICAgICAgICAgZ3JhcGgudXBkYXRlTmV3Tm9kZXMgPSBmdW5jdGlvbihuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgICAgICBncmFwaFVwZGF0ZU5ld05vZGVzLmNhbGwoZ3JhcGgsIG5ld05vZGVzKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51cGRhdGVOZXdOb2RlcyhuZXdOb2Rlcyk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHZhciBncmFwaFVwZGF0ZU5ld1BhdGhzID0gZ3JhcGgudXBkYXRlTmV3UGF0aHM7XG4gICAgICAgICAgICAgICAgZ3JhcGgudXBkYXRlTmV3UGF0aHMgPSBmdW5jdGlvbihuZXdQYXRocykge1xuICAgICAgICAgICAgICAgICAgICBncmFwaFVwZGF0ZU5ld1BhdGhzLmNhbGwoZ3JhcGgsIG5ld1BhdGhzKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51cGRhdGVOZXdQYXRocyhuZXdQYXRocyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJlbW92ZXMgYWxsIHFUaXBzIGZyb20gdGhlIERPTS5cbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBwb2xpY3kgaXMgdW5pbnN0YWxsZWQgb3JcbiAgICAgICAgICAgICAqIHRoZSBncmFwaCBpcyBkZXN0cm95ZWQuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICAgICAgLy9yZW1vdmluZyBhbGwgcXRpcCBmcm9tIERPTVxuICAgICAgICAgICAgICAgICQoJ1tpZF49XCJxdGlwXCJdJykucmVtb3ZlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogS2VlcGluZyB0cmFjayBvZiBtb3VzZWRvd24gc3RhdGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7ZDNPYmplY3R9ICBkM29iaiAgVGhlIGQzIHBiamVjdFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGUvTGlua30gIGQgICAgIFRoZSBtYXRjaGluZyBkYXRhIG9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBtb3VzZWRvd24oZDNvYmosIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuUVRpcFBvbGljeTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5tb3VzZWRvd24gPSB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEtlZXBpbmcgdHJhY2sgb2YgbW91c2Vkb3duIHN0YXRlXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzT2JqZWN0fSAgZDNvYmogIFRoZSBkMyBwYmplY3RcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlL0xpbmt9ICBkICAgICBUaGUgbWF0Y2hpbmcgZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgbW91c2V1cChkM29iaiwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5RVGlwUG9saWN5O1xuICAgICAgICAgICAgICAgIHN0YXRlLm1vdXNlZG93biA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB3aGVuUVRpcEF2YWlsYWJsZShjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgaW50ZXJ2YWwgPSA1MDA7IC8vIG1zXG4gICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkKGRvY3VtZW50KS5xdGlwICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dCh0aGlzUG9saWN5LndoZW5RVGlwQXZhaWxhYmxlKGNhbGxiYWNrKSwgaW50ZXJ2YWwpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgaW50ZXJ2YWwpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIE5ldyBOb2RlcyBhcmUgYWRkZWQgZHVyaW5nIHRoZVxuICAgICAgICAgICAgICogdXBkYXRlIGdyYXBoIGZ1bmN0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzTm9kZX0gIG5ld05vZGVzICBUaGUgbmV3IG5vZGVzIHRoYXQgYXJlXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlaW5nIGFkZGVkIHRvIHRoZSBncmFwaFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1cGRhdGVOZXdOb2RlcyhuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5RVGlwUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gYXR0YWNoUVRpcCgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9hdHRhY2hpbmcgcXRpcFxuICAgICAgICAgICAgICAgICAgICBuZXdOb2Rlcy5lYWNoKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aGlzTm9kZSA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL0lmIG5vZGUgaGFzIGNoaWxkcmVuLCB0aGVuIGl0IGlzIGEgc2VydmljZVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFtkLmlkXSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IFwiPGI+PHU+U2VsZWN0b3JzOjwvYj48L3U+IFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZWxlY3Rvck1hcCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnNlbGVjdG9yc1tkLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGFzS2V5cyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBzZWxlY3Rvck1hcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNLZXlzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSBrZXkgKyBcIiA6IDxpPlwiKyBzZWxlY3Rvck1hcFtrZXldICsgXCI8L2k+LFxcbiBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhhc0tleXMgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29tbWEgd2lsbCBiZSByZW1vdmVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSBcIk5vIFNlbGVjdG9ycywgXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSBcIjxiPjx1PkxhYmVsczo8L2I+PC91PiBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGFiZWxzTWFwID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UubGFiZWxzW2QuaWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoYXNLZXlzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGxhYmVsc01hcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNLZXlzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSBrZXkgKyBcIiA6IDxpPlwiKyBsYWJlbHNNYXBba2V5XSArIFwiPC9pPixcXG4gXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoYXNLZXlzID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbW1hIHdpbGwgYmUgcmVtb3ZlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gXCJObyBsYWJlbHMsIFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vcmVtb3ZlIGxhc3QgY29tbWFcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSB0ZXh0LnNsaWNlKDAsIC0yKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzTm9kZSkucXRpcCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogZC5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRzOiB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcGkgPSAkKHRoaXNOb2RlKS5xdGlwKCdhcGknKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSAkKCcjZ3JhcGhDb250YWluZXInKS5vZmZzZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IFtvZmZzZXQubGVmdCArICgoZC54ICogdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKSkgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKVswXSksIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQudG9wICsgKChkLnkgK2QucmFkaXVzKSAqIHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCkpICArIHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpWzFdXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwaS5zZXQoJ3Bvc2l0aW9uLnRhcmdldCcsIHBvc2l0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhc3RhdGUubW91c2Vkb3duO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGF5OiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb2xvOiAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc2VzOiAncXRpcC1ibHVlIHF0aXAtc2hhZG93J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXk6ICd0b3AgY2VudGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXQ6ICdib3R0b20gY2VudGVyJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0YXJnZXQ6IHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaWRlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50OiAnbW91c2Vkb3duIG1vdXNlbGVhdmUnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vaW5jYXNlIGxpYnJhcnkgaGFzbid0IGxvYWRlZCB5ZXRcbiAgICAgICAgICAgICAgICBpZiAoJChkb2N1bWVudCkucXRpcCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgYXR0YWNoUVRpcCgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMud2hlblFUaXBBdmFpbGFibGUoYXR0YWNoUVRpcCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIG5ldyBwYXRocyBhcmUgYWRkZWQgZHVyaW5nIHRoZVxuICAgICAgICAgICAgICogdXBkYXRlIGdyYXBoIGZ1bmN0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzUGF0aH0gIG5ld1BhdGhzICBUaGUgbmV3IHBhdGhzIHRoYXQgYXJlXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlaW5nIGFkZGVkIHRvIHRoZSBncmFwaFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1cGRhdGVOZXdQYXRocyhuZXdQYXRocykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5RVGlwUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgLy9pbmNhc2UgbGlicmFyeSBoYXNuJ3QgbG9hZGVkIHlldFxuICAgICAgICAgICAgICAgIGlmICgkKGRvY3VtZW50KS5xdGlwICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvL2FkZGluZyBxdGlwXG4gICAgICAgICAgICAgICAgICAgIG5ld1BhdGhzLmVhY2goZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRoaXNQYXRoID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vZ2V0dGluZyBtaWRwb2ludCBvZiBwYXRoXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aEVsICAgPSBkMy5zZWxlY3QodGhpcykubm9kZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1pZHBvaW50ID0gcGF0aEVsLmdldFBvaW50QXRMZW5ndGgocGF0aEVsLmdldFRvdGFsTGVuZ3RoKCkvMik7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0UmV0ID0gZC5xdGlwSGVscGVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IFwiQnl0ZXM6IFwiICsgZC5nZXRXZWlnaHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpc1BhdGgpLnF0aXAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3c6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9pZiBtb3VzZSBpcyBkb3duLCBkb24ndCBsZXQgcXRpcCBzaG93XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIXN0YXRlLm1vdXNlZG93bjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxheTogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc29sbzogJCgnI2dyYXBoQ29udGFpbmVyJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzZXM6ICdxdGlwLWJsdWUgcXRpcC1zaGFkb3cnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBteTogdGFyZ2V0UmV0Lm15LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdDogJ2NlbnRlciBjZW50ZXInLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiAnbW91c2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGp1c3Q6IHRhcmdldFJldC5hZGp1c3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQ6ICdtb3VzZWRvd24gbW91c2VsZWF2ZSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0gICBcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBQb2xpY3k6IFFUaXBQb2xpY3lcbiAgICAgICAgfVxufV0pO1xuXG5cblxuXG5cblxuXG5cbiIsIid1c2Ugc3RyaWN0Jztcbi8vIERlY2xhcmUgYXBwIGxldmVsIG1vZHVsZSB3aGljaCBkZXBlbmRzIG9uIHZpZXdzLCBhbmQgY29tcG9uZW50c1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdkFwcCcsIFtcbiAgICAndWkucm91dGVyJyxcbiAgICAnY29udGl2LmxvZ2luJyxcbiAgICAnY29udGl2Lm1lbnUnLFxuICAgICdjb250aXYuZGFzaGJvYXJkJyxcbiAgICAnY29udGl2LmFwcGxpY2F0aW9uZ3JvdXBzJyxcbiAgICAnY29udGl2Lm5ldHdvcmtzJyxcbiAgICAnY29udGl2Lm5ldHdvcmtwb2xpY2llcycsXG4gICAgJ2NvbnRpdi5zdG9yYWdlcG9saWNpZXMnLFxuICAgICdjb250aXYuc2VydmljZWxicycsXG4gICAgJ2NvbnRpdi52b2x1bWVzJyxcbiAgICAnY29udGl2Lm5vZGVzJyxcbiAgICAnY29udGl2Lm9yZ2FuaXphdGlvbnMnLFxuICAgICdjb250aXYuc2V0dGluZ3MnLFxuICAgICdjb250aXYudmlzdWFsaXphdGlvbidcbl0pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgJyR1cmxSb3V0ZXJQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdicsIHtcbiAgICAgICAgICAgIHVybDogJycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgZmx1aWQgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSk7XG4gICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE5LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmxvZ2luJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2LmxvZ2luJywge1xuICAgICAgICAgICAgdXJsOiAnLycsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2xvZ2luL2xvZ2luLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0xvZ2luQ3RybCBhcyBsb2dpbkN0cmwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdMb2dpbkN0cmwnLCBbJyRzdGF0ZScsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIGxvZ2luQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvRGFzaGJvYXJkKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5kYXNoYm9hcmQnLCB7IHVzZXJuYW1lOiBsb2dpbkN0cmwudXNlcm5hbWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gbG9naW4oKSB7XG4gICAgICAgICAgICByZXR1cm5Ub0Rhc2hib2FyZCgpO1xuICAgICAgICB9XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobG9naW5DdHJsKTtcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGxvZ2luQ3RybCk7XG4gICAgICAgIGxvZ2luQ3RybC5sb2dpbiA9IGxvZ2luO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxvZ2luY3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubWVudScpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Jywge1xuICAgICAgICAgICAgdXJsOiAnL20nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdtZW51L21lbnUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTWVudUN0cmwgYXMgbWVudUN0cmwnLFxuICAgICAgICAgICAgcGFyYW1zOiB7IHVzZXJuYW1lOiBudWxsIH1cbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ01lbnVDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zKSB7XG4gICAgICAgIHZhciBtZW51Q3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGxvZ291dCgpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2LmxvZ2luJyk7XG4gICAgICAgIH1cbiAgICAgICAgbWVudUN0cmwudXNlcm5hbWUgPSAkc3RhdGVQYXJhbXMudXNlcm5hbWU7XG4gICAgICAgIG1lbnVDdHJsLmxvZ291dCA9IGxvZ291dDtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tZW51Q3RybC5qcy5tYXAiLCIvKipcbiAqIFRoaXMgcG9saWN5IHByb3ZpZGVzIGEgd2F5IGZvciBwcm9wZXJ0aWVzIHRvIGJlIHNhdmVkIFxuICogYmV0d2VlbiB2aWV3IGNoYW5nZXNcbiAqIFxuICogSXQgbW9kaWZpZXMgdGhlIGRlc3Ryb3kgZnVuY3Rpb24gdG8gYWxzbyBwYXNzIGluIGFuIG9iamVjdCB0aGF0XG4gKiB3aWxsIGhhdmUgYWxsIGl0cyBwcm9wZXJ0aWVzIHNhdmVkIGFuZCB3aWxsIGJlIGF2YWlsYWJsZSBcbiAqIG9uIGdyYXBoIGxvYWQuIFdoZW4gc2F2aW5nIHZhcmlhYmxlcyB0byB0aGUgb2JqZWN0LCBuYW1lc3BhY2Ugd2l0aFxuICogdGhlIHBvbGljeSBuYW1lLlxuICogXG4gKiBUaGlzIHBvbGljeSBtdXN0IGJlIGxvYWRlZCBmaXJzdCBpbiBvcmRlciBmb3IgaXQgc2F2ZWQgdmFyaWFibGVzIFxuICogdG8gYmUgbG9hZGVkIHdoZW4gdGhlIHZpZXcgY29tZXMgYmFjayB0byB0aGUgZ3JhcGhcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ1NhdmVTdGF0ZVBvbGljeScsIFsnUG9saWN5JywgZnVuY3Rpb24gKFBvbGljeSkge1xuICAgIFx0Y2xhc3MgU2F2ZVN0YXRlUG9saWN5IGV4dGVuZHMgUG9saWN5LlBvbGljeSB7XG4gICAgXHRcdFxuICAgIFx0XHQvKipcbiAgICBcdFx0ICogVGFrZXMgaW4gdGhlIGFuZ3VsYXIgc2VydmljZSB0byB3aGljaCBpdCB3aWxsXG4gICAgXHRcdCAqIHNhdmUgaXQncyBwcm9wZXJ0aWVzIHRvLlxuICAgIFx0XHQgKlxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgc2F2ZWRTdGF0ZSAgT2JqZWN0IHRvIHNhdmUgXG4gICAgXHRcdCAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzIHRvXG4gICAgXHRcdCAqL1xuICAgIFx0XHRjb25zdHJ1Y3RvcihzYXZlZFN0YXRlKSB7XG4gICAgXHRcdFx0c3VwZXIoJ1NhdmVTdGF0ZVBvbGljeScpO1xuICAgIFx0XHRcdHRoaXMuc2F2ZWRTdGF0ZSA9IHNhdmVkU3RhdGU7XG4gICAgXHRcdH1cblxuICAgIFx0XHQvKipcbiAgICBcdFx0ICogQ2FsbGVkIHdoZW4gdGhlIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICBcdFx0ICogTW9kaWZpZXMgdGhlIGRlc3Ryb3kgbWV0aG9kIFxuICAgIFx0XHQgKiBhbmQgYWRkcyBhIGxvYWQgbWV0aG9kIHRvIHRoZSBncmFwaFxuICAgIFx0XHQgKlxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaCBpdCBpcyBcbiAgICBcdFx0ICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YWxsZWQgb25cbiAgICBcdFx0ICovXG4gICAgXHRcdGluaXRpYWxpemUoZ3JhcGgpIHtcbiAgICBcdFx0XHR0aGlzLmdyYXBoID0gZ3JhcGg7XG4gICAgXHRcdFx0dmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgIFx0XHRcdGdyYXBoLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcbiAgICBcdFx0XHRcdHRoaXNQb2xpY3kuZ3JhcGhEZXN0cm95LmNhbGwoZ3JhcGgsIHRoaXNQb2xpY3kuc2F2ZWRTdGF0ZSk7XG4gICAgXHRcdFx0fTtcblxuICAgIFx0XHRcdGdyYXBoLmxvYWQgPSBmdW5jdGlvbihzYXZlZFN0YXRlKSB7XG4gICAgXHRcdFx0XHR0aGlzUG9saWN5LmdyYXBoTG9hZC5jYWxsKGdyYXBoLCBzYXZlZFN0YXRlKTtcbiAgICBcdFx0XHR9XG4gICAgXHRcdH1cblxuICAgIFx0XHQvKipcbiAgICBcdFx0ICogV2lsbCBvdmVycmlkZSB0aGUgZ3JhcGgncyBkZWZhdWx0IGRlc3Ryb3ksIHdpdGggXG4gICAgXHRcdCAqIHRoaXMgcG9saWN5J3Mgc2F2ZWRTdGF0ZSBwYXNzZWQgaW4uXG4gICAgXHRcdCAqIENhbGxlZCB3aXRoIHRoaXMgYXMgdGhlIGdyYXBoXG4gICAgXHRcdCAqXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBzYXZlZFN0YXRlICBUaGUgc2F2ZWQgc3RhdGVcbiAgICBcdFx0ICovXG4gICAgXHRcdGdyYXBoRGVzdHJveShzYXZlZFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KHNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KHNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzR3JhcGguYmluZGluZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgJCh3aW5kb3cpLm9mZihrZXksIHRoaXNHcmFwaC5iaW5kaW5nc1trZXldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2lsbCBiZSBjYWxsZWQgd2l0aCB0aGUgZ3JhcGggYXMgdGhpc1xuICAgICAgICAgICAgICogVXNlZCB0byBoYXZlIGFsbCBvdGhlciBwb2xpY2llcyB1c2UgdGhlIGxvYWQgc3RhdGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgc2F2ZWRTdGF0ZSAgVGhlIHNhdmVkIHN0YXRlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGdyYXBoTG9hZChzYXZlZFN0YXRlKSB7XG4gICAgICAgICAgICBcdHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICBcdGlmIChwb2xpY3kubG9hZCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIFx0cG9saWN5LmxvYWQoc2F2ZWRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgIFx0fVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgIFx0aWYgKHBvbGljeS5sb2FkICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgXHRwb2xpY3kubG9hZChzYXZlZFN0YXRlKTtcbiAgICAgICAgICAgICAgICAgXHR9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgXHR9XG4gICAgXHRyZXR1cm4ge1xuICAgIFx0XHRQb2xpY3k6IFNhdmVTdGF0ZVBvbGljeVxuICAgIFx0fVxufV0pO1xuXG5cblxuXG5cblxuXG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgaGFyZGlrIGdhbmRoaSBvbiA2LzI0LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5uZXR3b3JrcG9saWNpZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2QmFuZHdpZHRoXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgYmFuZHdpZHRoUG9saWN5OiAnPScsXG4gICAgICAgICAgICBtb2RlOiBcIkBcIlxuICAgICAgICB9LFxuICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUpIHtcbiAgICAgICAgICAgIGlmIChzY29wZS5iYW5kd2lkdGhQb2xpY3kuYmFuZHdpZHRoICE9ICcnKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJhbmR3aWR0aEFycmF5ID0gc2NvcGUuYmFuZHdpZHRoUG9saWN5LmJhbmR3aWR0aC5zcGxpdCgnICcpO1xuICAgICAgICAgICAgICAgIHNjb3BlLmJhbmR3aWR0aFBvbGljeS5iYW5kd2lkdGhOdW1iZXIgPSBOdW1iZXIoYmFuZHdpZHRoQXJyYXlbMF0pO1xuICAgICAgICAgICAgICAgIHNjb3BlLmJhbmR3aWR0aFBvbGljeS5iYW5kd2lkdGhVbml0ID0gYmFuZHdpZHRoQXJyYXlbMV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnbmV0d29ya19wb2xpY2llcy9iYW5kd2lkdGguaHRtbCdcbiAgICB9O1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1iYW5kd2lkdGhkaXJlY3RpdmUuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3BvbGljaWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOZXR3b3JrUG9saWNpZXNUYWJzQ3RybCBhcyBuZXR3b3JrUG9saWNpZXNUYWJzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtfcG9saWNpZXMvbmV0d29ya3BvbGljaWVzdGFicy5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMubGlzdC5yZWRpcmVjdGlvbicsIHtcbiAgICAgICAgICAgIHVybDogJy9yZWRpcmVjdGlvbicsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJydcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05ldHdvcmtQb2xpY2llc1RhYnNDdHJsJywgWyckc3RhdGUnLCBmdW5jdGlvbiAoJHN0YXRlKSB7XG4gICAgICAgIHZhciBuZXR3b3JrUG9saWNpZXNUYWJzQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZU5ldHdvcmtQb2xpY3koKSB7XG4gICAgICAgICAgICBpZiAoJHN0YXRlLiRjdXJyZW50LmluY2x1ZGVzWydjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMubGlzdC5pc29sYXRpb24nXSkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbi5jcmVhdGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgkc3RhdGUuJGN1cnJlbnQuaW5jbHVkZXNbJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5saXN0LmJhbmR3aWR0aCddKSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuYmFuZHdpZHRoLmNyZWF0ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIG5ldHdvcmtQb2xpY2llc1RhYnNDdHJsLmNyZWF0ZU5ldHdvcmtQb2xpY3kgPSBjcmVhdGVOZXR3b3JrUG9saWN5O1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5ldHdvcmtwb2xpY2llc3RhYnNjdHJsLmpzLm1hcCIsIi8qKlxuICogVGhpcyBwb2xpY3kgaXMgdXNlZCBmb3Igc3BsaXR0aW5nIGEgbm9kZSBpbnRvIGl0cyBjaGlsZHJlbixcbiAqIGFuZCBqb2luaW5nIHRoZW0gYmFjayB0byB0aGVpciBwYXJlbnQuXG4gKiBTcGxpdHMgb24gZG91YmxlIGNsaWNrLCBhbmQgam9pbnMgb24gcmlnaHQgY2xpY2suXG4gKiBJZiBtdWx0aXBsZSBub2RlcyBhcmUgc2VsZWN0ZWQgYXQgdGhlIHRpbWUgb2YgYSBzcGxpdCBvciBqb2luIGV2ZW50LFxuICogaXQgd2lsbCBzcGxpdCBvciBqb2luIGFsbCBvZiB0aGVtLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnU3BsaXRKb2luTm9kZVBvbGljeScsIFsnTm9kZVNlbGVjdGlvblBvbGljeScsICdWaXN1YWxpemVyTm9kZScsIFxuICAgIFx0XHRmdW5jdGlvbiAoTm9kZVNlbGVjdGlvblBvbGljeSwgVmlzdWFsaXplck5vZGUpIHtcblx0XHRjbGFzcyBTcGxpdEpvaW5Ob2RlUG9saWN5IGV4dGVuZHMgTm9kZVNlbGVjdGlvblBvbGljeS5Qb2xpY3kge1xuXHRcdFx0LyoqXG5cdFx0XHQgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG5cdFx0XHQgKi9cbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAgICAgICAgIHN1cGVyKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wb2xpY3lOYW1lID0gXCJTcGxpdEpvaW5Ob2RlUG9saWN5XCI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gcG9saWN5IGlzIGluc3RhbGxlZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluaXRpYWxpemUoZ3JhcGgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHN1cGVyLmluaXRpYWxpemUoZ3JhcGgpO1xuICAgICAgICAgICAgICAgIHZhciBzdGF0ZSA9IGdyYXBoLnN0YXRlLlNwbGl0Sm9pbk5vZGVQb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zcGxpdE5vZGVzID0gW107IFxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRyaWdnZXJpbmcgc3BsaXQgb24gZG91YmxlIGNsaWNrXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGQgICAgICBUaGUgbWF0Y2hpbmcgZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZGJsY2xpY2soZDNub2RlLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN1cGVyU3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luTm9kZVBvbGljeTtcblxuICAgICAgICAgICAgICAgIGlmICghZDMuZXZlbnQuY3RybEtleSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3VwZXJTdGF0ZS5zZWxlY3RlZE5vZGVzLmluZGV4T2YoZCkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGxpdE11bHRpcGxlTm9kZXMoc3VwZXJTdGF0ZS5zZWxlY3RlZE5vZGVzKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQWxsU2VsZWN0ZWROb2RlcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGxpdE5vZGUoZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVHJpZ2dlcmluZyBqb2luIG9uIHJpZ2h0IGNsaWNrXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqfSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGQgICAgICBUaGUgbWF0Y2hpbmcgZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgY29udGV4dG1lbnUoZDNub2RlLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN1cGVyU3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeTtcbiAgICAgICAgICAgICAgICBkMy5ldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIGlmICghZDMuZXZlbnQuY3RybEtleSkge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIHRyeSB0byBqb2luIGEgaGlnaGxpZ2h0ZWQgbm9kZSB3aGlsZSBtdWx0aXBsZSBub2RlcyBhcmUgc2VsZWN0ZWQsXG4gICAgICAgICAgICAgICAgICAgIC8vd2Ugam9pbiBhbGwgaGlnaGxpZ2h0ZWQgbm9kZXNcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGVjdGVkTm9kZXMgPSBzdXBlclN0YXRlLnNlbGVjdGVkTm9kZXM7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZE5vZGVzLmluZGV4T2YoZCkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxlY3RlZE5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5qb2luTm9kZShzZWxlY3RlZE5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vaWYgd2UgdHJ5IHRvIGpvaW4gYSBub2RlIHRoYXQgaXNuJ3QgcGFydCBvZiBhIGhpZ2hsaWdodCxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vd2UgcmVtb3ZlIGFsbCBoaWdobGlnaHRzIGFuZCB0aGVuIGpvaW4gdGhlIGNsaWNrZWQgbm9kZVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVBbGxTZWxlY3RlZE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmpvaW5Ob2RlKGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNwbGl0cyBhIG5vZGUuXG4gICAgICAgICAgICAgKiB1c2VkIHRvIHNoYXJlIGNvZGUgYmV0d2VlbiBzcGxpdE5vZGUgYW5kIHNwbGl0TXVsdGlwbGVOb2Rlc1xuICAgICAgICAgICAgICogd2hpbGUgcHJldmVudGluZyB0aGUgaGFuZGxlcnMgZm9yIHRoZW0gYm90aCBmaXJpbmdcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBub2RlICAgIFRoZSBub2RlIGJlaW5nIHNwbGl0XG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7QXJyYXl9ICBUaGUgbmV3IG5vZGVzIGNyZWF0ZWQgYnkgdGhlIHNwbGl0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIF9fc3BsaXROb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luTm9kZVBvbGljeTtcbiAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IG5vZGUuaWQ7XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICAvL2lmIGl0IGhhcyBubyBjaGlsZHJlbiB0byBzcGxpdCBpbnRvXG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkcmVuX3N0cnVjdFtuYW1lXSA9PT0gdW5kZWZpbmVkIHx8IF8uaXNFbXB0eShjaGlsZHJlbl9zdHJ1Y3RbbmFtZV0pKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3JlbW92aW5nIHRoZSBub2RlIGZyb20gdGhlIGxpc3Qgb2Ygbm9kZXNcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMgPSBfLmZpbHRlcih0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uKGdyYXBoTm9kZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdyYXBoTm9kZXMgIT0gbm9kZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzR3JhcGgubm9kZXMpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zcGxpY2VMaW5rc0Zvck5vZGUobm9kZSk7XG5cbiAgICAgICAgICAgICAgICAvL2dldHRpbmcgYWxsIHRoZSBub2RlIGlkJ3MgZm9yIGZpbmRpbmcgZmxvd1xuICAgICAgICAgICAgICAgIHZhciBub2RlX25hbWVzX3NldCA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpc0dyYXBoLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVfbmFtZXNfc2V0LnB1c2godGhpc0dyYXBoLm5vZGVzW2ldLmlkKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3NldCBvZiBub2RlcyBhZnRlciB0aGUgc3BsaXRcbiAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGVzID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGlsZHJlbl9zdHJ1Y3RbbmFtZV0ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZV9uYW1lc19zZXQucHVzaChjaGlsZHJlbl9zdHJ1Y3RbbmFtZV1baV0pO1xuICAgICAgICAgICAgICAgICAgICBuZXdfbm9kZXMucHVzaChjaGlsZHJlbl9zdHJ1Y3RbbmFtZV1baV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcmV0RGF0YSA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmdldEZsb3dCZXR3ZWVuU2V0KG5vZGVfbmFtZXNfc2V0KTtcblxuICAgICAgICAgICAgICAgIC8vZm9ybWF0dGluZyBkYXRhIGZvciBuZXcgbm9kZXNcbiAgICAgICAgICAgICAgICB2YXIgeExvYyA9IG5vZGUueDtcbiAgICAgICAgICAgICAgICB2YXIgeUxvYyA9IG5vZGUueTtcbiAgICAgICAgICAgICAgICB2YXIgYW5jZXN0b3JzID0gbm9kZS5hbmNlc3RvcnMuc2xpY2UoKTtcbiAgICAgICAgICAgICAgICAvL2tlZXBpbmcgb3JkZXJpbmcgdGhhdCBmaXJzdCBpbiBhbmNlc3RvciBsaXN0IGlzIGNsb3Nlc3QgaW4gcmVsYXRpb25zaGlwXG4gICAgICAgICAgICAgICAgYW5jZXN0b3JzLnNwbGljZSgwLCAwLCBub2RlLmlkKTtcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gbm9kZS5pZDtcbiAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGVfb2JqcyA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciByYWRpdXMgPSBub2RlLnJhZGl1cyAqIHRoaXNHcmFwaC5jb25zdHMucmFkaXVzRGVjYXk7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVEYXRhID0gcmV0RGF0YS5ub2RlRGF0YTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVEYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vY2FsY3VsYXRpbmcgd2hpY2ggb2YgdGhlIG5vZGVzIGluIHJldERhdGFbMF0gYXJlIG5ld1xuICAgICAgICAgICAgICAgICAgICBpZiAobmV3X25vZGVzLmluZGV4T2Yobm9kZURhdGFbaV0uaWQpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZCA9IG5vZGVEYXRhW2ldLmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSBub2RlRGF0YVtpXS50ZXh0O1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlID0gbmV3IFZpc3VhbGl6ZXJOb2RlLk5vZGUobnVsbCwgbnVsbCwgaWQsIHRleHQsIHJhZGl1cywgcGFyZW50LCBhbmNlc3RvcnMsIHhMb2MsIHlMb2MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3X25vZGUuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnB1c2gobmV3X25vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3X25vZGVfb2Jqcy5wdXNoKG5ld19ub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5wcm9jZXNzTGlua0RhdGEocmV0RGF0YS5saW5rRGF0YSwgdGhpc0dyYXBoLm5vZGVzKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXRMaW5rcygpO1xuXG4gICAgICAgICAgICAgICAgc3RhdGUuc3BsaXROb2Rlcy5wdXNoKG5vZGUuaWQpO1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXdfbm9kZV9vYmpzO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNwbGl0cyB0aGUgZ2l2ZSBub2RlXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBub2RlICAgIFRoZSBub2RlIGJlaW5nIHNwbGl0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNwbGl0Tm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlcyA9IHRoaXMuX19zcGxpdE5vZGUobm9kZSk7XG4gICAgICAgICAgICAgICAgaWYgKHJlcyA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5zcGxpdE5vZGVFdmVudChyZXMpO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU3BsaXRzIGFsbCB0aGUgbm9kZXMgcGFzc2VkIGluXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZXMgICBBcnJheSBvZiBub2RlcyB0byBiZSBzcGxpdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzcGxpdE11bHRpcGxlTm9kZXMobm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaDtcbiAgICAgICAgICAgICAgICB2YXIgcmVzTm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSB0aGlzLl9fc3BsaXROb2RlKG5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzTm9kZXMgPSByZXNOb2Rlcy5jb25jYXQocmVzKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLnNwbGl0TXVsdGlwbGVOb2Rlc0V2ZW50KHJlcyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIGFmdGVyIGEgc2luZ2xlIG5vZGUgaXMgc3BsaXRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBuZXdOb2RlcyAgVGhlIG5ldyBub2Rlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzcGxpdE5vZGVFdmVudChuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zZXRQb3NpdGlvbnMoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgYWZ0ZXIgbXVsdGlwbGUgbm9kZXMgYXJlIHNwbGl0IGF0IG9uY2VcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBuZXdOb2RlcyAgVGhlIG5ldyBub2Rlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzcGxpdE11bHRpcGxlTm9kZXNFdmVudChuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zZXRQb3NpdGlvbnMoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiB1c2VkIHRvIHNoYXJlIGNvZGUgYmV0d2VlbiBqb2luTm9kZSBhbmQgam9pbk11bHRpcGxlTm9kZVxuICAgICAgICAgICAgICogd2hpbGUgcHJldmVudGluZyBib3RoIGhhbmRsZXJzIGZpcmluZ1xuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gICAgICAgICAgbm9kZSAgICBUaGUgbm9kZSB0byBqb2luXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7Tm9kZX0gIFRoZSBuZXcgbm9kZSBhZnRlciB0aGUgam9pblxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBfX2pvaW5Ob2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luTm9kZVBvbGljeTtcblxuICAgICAgICAgICAgICAgIC8vY2hlY2sgdGhhdCBub2RlIHN0aWxsIGV4aXN0c1xuICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGgubm9kZXMuaW5kZXhPZihub2RlKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IG5vZGUuaWQ7XG4gICAgICAgICAgICAgICAgLy9pZiBpdCBoYXMgbm8gYW5jZXN0b3IsIG5vdGhpbmcgdG8gam9pblxuICAgICAgICAgICAgICAgIGlmIChjaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwuaW5kZXhPZihuYW1lKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgdG9fYmVfZGVsZXRlZCA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBub2RlX25hbWVzX3NldCA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpc0dyYXBoLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgbm9kZSB3b24ndCBiZSBjb2xsYXBzZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5ub2Rlc1tpXS5hbmNlc3RvcnMuaW5kZXhPZihub2RlLnBhcmVudCkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVfbmFtZXNfc2V0LnB1c2godGhpc0dyYXBoLm5vZGVzW2ldLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvX2JlX2RlbGV0ZWQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZV9pZCA9IG5vZGUucGFyZW50O1xuICAgICAgICAgICAgICAgIG5vZGVfbmFtZXNfc2V0LnB1c2gobm9kZS5wYXJlbnQpO1xuXG4gICAgICAgICAgICAgICAgLy9mb3JtYXR0aW5nIGRhdGFcbiAgICAgICAgICAgICAgICB2YXIgcmFkaXVzID0gbm9kZS5yYWRpdXMgLyB0aGlzR3JhcGguY29uc3RzLnJhZGl1c0RlY2F5OyBcbiAgICAgICAgICAgICAgICB2YXIgeExvYyA9IG5vZGUueDtcbiAgICAgICAgICAgICAgICB2YXIgeUxvYyA9IG5vZGUueTtcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gbm9kZS5hbmNlc3RvcnNbMV07XG4gICAgICAgICAgICAgICAgdmFyIGFuY2VzdG9ycyA9IG5vZGUuYW5jZXN0b3JzLnNsaWNlKDEpO1xuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZSA9IG5ldyBWaXN1YWxpemVyTm9kZS5Ob2RlKHhMb2MsIHlMb2MsIG5ld19ub2RlX2lkLCBuZXdfbm9kZV9pZCwgcmFkaXVzLCBwYXJlbnQsIGFuY2VzdG9ycyk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnB1c2gobmV3X25vZGUpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHJldERhdGEgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5nZXRGbG93QmV0d2VlblNldChub2RlX25hbWVzX3NldCk7XG4gICAgICAgICAgICAgICAgLy9yZW1vdmUgYWxsIG5vZGVzIHRoYXQgd2lsbCBiZSBqb2luZWRcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRvX2JlX2RlbGV0ZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVfdG9fZGVsZXRlID0gdG9fYmVfZGVsZXRlZFtpXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnNwbGljZSh0aGlzR3JhcGgubm9kZXMuaW5kZXhPZihub2RlX3RvX2RlbGV0ZSksIDEpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3BsaWNlTGlua3NGb3JOb2RlKG5vZGVfdG9fZGVsZXRlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UucHJvY2Vzc0xpbmtEYXRhKHJldERhdGEubGlua0RhdGEsIHRoaXNHcmFwaC5ub2Rlcyk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXROb2RlcygpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0TGlua3MoKTtcblxuICAgICAgICAgICAgICAgIHN0YXRlLnNwbGl0Tm9kZXMuc3BsaWNlKHN0YXRlLnNwbGl0Tm9kZXMuaW5kZXhPZihuZXdfbm9kZS5pZCksIDEpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ld19ub2RlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEpvaW5zIHRoZSBnaXZlbiBub2RlXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBub2RlICAgIFRoZSBub2RlIHRvIGpvaW5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgam9pbk5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciBuZXdOb2RlID0gdGhpcy5fX2pvaW5Ob2RlKG5vZGUpO1xuICAgICAgICAgICAgICAgIGlmIChuZXdOb2RlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBcdHRoaXMuam9pbk5vZGVFdmVudChuZXdOb2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogSm9pbnMgYWxsIHRoZSBnaXZlbiBub2Rlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVzICAgVGhlIG5vZGVzIHRvIGpvaW5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgam9pbk11bHRpcGxlTm9kZShub2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSB0aGlzLl9fam9pbk5vZGUobm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICBuZXdfbm9kZXMucHVzaChyZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmpvaW5NdWx0aXBsZU5vZGVzRXZlbnQobmV3X25vZGVzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgYWZ0ZXIgYSBzaW5nbGUgbm9kZSBpcyBqb2luZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5ld05vZGUgIFRoZSBuZXcgbm9kZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBqb2luTm9kZUV2ZW50KG5ld05vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaDtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgYWZ0ZXIgbXVsdGlwbGUgbm9kZXMgYXJlIGpvaW5lZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5ld05vZGVzICBUaGUgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGpvaW5NdWx0aXBsZU5vZGVzRXZlbnQobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaDtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBQb2xpY3k6IFNwbGl0Sm9pbk5vZGVQb2xpY3lcbiAgICAgICAgfVxufV0pO1xuXG5cblxuXG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDIvMTkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3MnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3Jrcy5jcmVhdGUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmV0d29ya3MvbmV0d29ya2NyZWF0ZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOZXR3b3JrQ3JlYXRlQ3RybCBhcyBuZXR3b3JrQ3JlYXRlQ3RybCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05ldHdvcmtDcmVhdGVDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ05ldHdvcmtzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgTmV0d29ya3NNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIG5ldHdvcmtDcmVhdGVDdHJsID0gdGhpcztcbiAgICAgICAgbmV0d29ya0NyZWF0ZUN0cmwuY2lkclBhdHRlcm4gPSBDb250aXZHbG9iYWxzLkNJRFJfUkVHRVg7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvTmV0d29ya3MoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5ldHdvcmtzLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxDcmVhdGluZygpIHtcbiAgICAgICAgICAgIHJldHVyblRvTmV0d29ya3MoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVOZXR3b3JrKCkge1xuICAgICAgICAgICAgLy9mb3JtIGNvbnRyb2xsZXIgaXMgaW5qZWN0ZWQgYnkgdGhlIGh0bWwgdGVtcGxhdGVcbiAgICAgICAgICAgIC8vY2hlY2tpbmcgaWYgYWxsIHZhbGlkYXRpb25zIGhhdmUgcGFzc2VkXG4gICAgICAgICAgICBpZiAobmV0d29ya0NyZWF0ZUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IobmV0d29ya0NyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKG5ldHdvcmtDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBuZXR3b3JrQ3JlYXRlQ3RybC5uZXdOZXR3b3JrLmtleSA9XG4gICAgICAgICAgICAgICAgICAgIG5ldHdvcmtDcmVhdGVDdHJsLm5ld05ldHdvcmsudGVuYW50TmFtZSArICc6JyArIG5ldHdvcmtDcmVhdGVDdHJsLm5ld05ldHdvcmsubmV0d29ya05hbWU7XG4gICAgICAgICAgICAgICAgTmV0d29ya3NNb2RlbC5jcmVhdGUobmV0d29ya0NyZWF0ZUN0cmwubmV3TmV0d29yaykudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobmV0d29ya0NyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub05ldHdvcmtzKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3JrQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihuZXR3b3JrQ3JlYXRlQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXNldEZvcm0oKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihuZXR3b3JrQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBuZXR3b3JrQ3JlYXRlQ3RybC5uZXdOZXR3b3JrID0ge1xuICAgICAgICAgICAgICAgIG5ldHdvcmtOYW1lOiAnJyxcbiAgICAgICAgICAgICAgICBlbmNhcDogJ3Z4bGFuJyxcbiAgICAgICAgICAgICAgICBzdWJuZXQ6ICcnLFxuICAgICAgICAgICAgICAgIGdhdGV3YXk6ICcnLFxuICAgICAgICAgICAgICAgIHRlbmFudE5hbWU6ICdkZWZhdWx0JyAvL1RPRE86IFJlbW92ZSBoYXJkY29kZWQgdGVuYW50LlxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBuZXR3b3JrQ3JlYXRlQ3RybC5jcmVhdGVOZXR3b3JrID0gY3JlYXRlTmV0d29yaztcbiAgICAgICAgbmV0d29ya0NyZWF0ZUN0cmwuY2FuY2VsQ3JlYXRpbmcgPSBjYW5jZWxDcmVhdGluZztcbiAgICAgICAgcmVzZXRGb3JtKCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bmV0d29ya2NyZWF0ZWN0cmwuanMubWFwIiwiLyoqXG4gKiBUaGlzIHBvbGljeSBpcyB1c2VkIHRvIGNoYW5nZSB0aGUgdmlldyB0byBmb2N1cyBvbiBzcGxpdHRpbmcgYW5kIFxuICogam9pbmluZyBldmVudHMuXG4gKiBPdmVycmlkZXMgdGhlIGNlcnRhaW4gZm9yY2UgbGF5b3V0IGZ1bmN0aW9ucyBvZiB0aGUgZ3JhcGggdG8gcGFydGl0aW9uIGEgc3BsaXRcbiAqIGludG8gdGhlIGZvY3VzZWQgbm9kZXMgYW5kIHRoZSBjb25uZWN0ZWQgbm9kZXMuXG4gKiBcbiAqIEhhcyBzYXZlL2xvYWQgbWV0aG9kcyBmb3IgdGhlIHNhdmUgc3RhdGUgcG9saWN5LlxuICogSGFzIGJhY2sgYnV0dG9uIHN1cHBvcnQuXG4gKiBDYW4gYXV0byBjaGFuZ2UgdGhlIHRpdGxlIG9mIHRoZSBncmFwaC5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ1NwbGl0Sm9pblZpZXdQb2xpY3knLCBbJ1NwbGl0Sm9pbk5vZGVQb2xpY3knLCAnVmlzdWFsaXplck5vZGUnLCBmdW5jdGlvbiAoU3BsaXRKb2luTm9kZVBvbGljeSwgVmlzdWFsaXplck5vZGUpIHsgXG4gICAgICAgIGNsYXNzIFNwbGl0Sm9pblZpZXdQb2xpY3kgZXh0ZW5kcyBTcGxpdEpvaW5Ob2RlUG9saWN5LlBvbGljeXtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgICAgICBzdXBlcigpO1xuICAgICAgICAgICAgICAgIHRoaXMucG9saWN5TmFtZSA9IFwiU3BsaXRKb2luVmlld1BvbGljeVwiO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbml0aWFsaXplKGdyYXBoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdXBlci5pbml0aWFsaXplKGdyYXBoKTtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBncmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgc3RhdGUuc2F2ZWRTdGF0ZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAvLyBzdGF0ZS5mb2N1c0dyb3VwID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkgPSBbXTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3VwcyA9IFtdO1xuICAgICAgICAgICAgICAgIHN0YXRlLmZvY2kgPSBbXTtcbiAgICAgICAgICAgICAgICBzdGF0ZS56b29tcyA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLmxheW91dCA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLmxheW91dERlZmF1bHQgPSBudWxsO1xuICAgICAgICAgICAgICAgIHN0YXRlLnpvb21EZWZhdWx0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS5ub2RlSWRzVG9SZXNob3cgPSBudWxsO1xuICAgICAgICAgICAgICAgIHN0YXRlLmJhY2tCdXR0b25FbGVtID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS50aXRsZUVsZW0gPSBudWxsO1xuXG4gICAgICAgICAgICAgICAgdmFyIGNvbnN0cyA9IGdyYXBoLmNvbnN0cy5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgY29uc3RzLmJvdW5kYXJ5ID0gMC44O1xuXG4gICAgICAgICAgICAgICAgLy9vdmVycmlkaW5nIGQzZm9yY2UgbWV0aG9kcyBvZiB0aGUgZ3JhcGguXG4gICAgICAgICAgICAgICAgZ3JhcGguZDNGb3JjZUJvdW5kcyA9IHRoaXMuZDNGb3JjZUJvdW5kcztcbiAgICAgICAgICAgICAgICBncmFwaC5kM0ZvcmNlVGljayA9IHRoaXMuZDNGb3JjZVRpY2s7XG4gICAgICAgICAgICAgICAgZ3JhcGguZDNGb3JjZVN0YXJ0ID0gdGhpcy5kM0ZvcmNlU3RhcnQ7XG4gICAgICAgICAgICAgICAgZ3JhcGguZDNGb3JjZUVuZCA9IHRoaXMuZDNGb3JjZUVuZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBMaW5rcyB0aGUgcHJvdmlkZWQgZWxlbWVudCBhIGJhY2sgYnV0dG9uIGZlYXR1cmVcbiAgICAgICAgICAgICAqIERvZXNuJ3QgdHJpZ2dlciB0aGUgb24tY2xpY2sgZXZlbnRcbiAgICAgICAgICAgICAqIFRoYXQgc2hvdWxkIGJlIGRvbmUgdGhyb3VnaCBhbmd1bGFyIG5nLWNsaWNrLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtqUXVlcnl9ICBlbGVtICAgIFRoZSBqcXVlcnkgc2VsZWN0ZWQgZWxlbWVudFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbnN0YWxsQmFja0J1dHRvbihlbGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kgPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgc3RhdGUuYmFja0J1dHRvbkVsZW0gPSBlbGVtO1xuICAgICAgICAgICAgICAgIHN0YXRlLmJhY2tCdXR0b24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnVuZG9MYXN0RXZlbnQuY2FsbCh0aGlzUG9saWN5KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBXaWxsIGFsbG93IHRoaXMgcG9saWN5IHRvIGNoYW5nZSB0aGUgdGl0bGUgb2YgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKiBhcyBzcGxpdCBhbmQgam9pbiBldmVudHMgb2NjdXIuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2pRdWVyeX0gIGVsZW0gICAgVGhlIGpxdWVyeSBzZWxlY3RlZCBlbGVtZW50XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluc3RhbGxUaXRsZShlbGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS50aXRsZUVsZW0gPSBlbGVtO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyBiZWluZyBkZXN0cm95ZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgc2F2ZWRTdGF0ZSAgQW55IHByb3BlcnR5IG9uIHRoaXNcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3Qgd2lsbCBiZSBhY2Nlc3NpYmxlXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiB0aGUgdmlldyByZWxvYWRzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGRlc3Ryb3koc2F2ZWRTdGF0ZSkge1xuICAgICAgICAgICAgICAgIC8vT25seSBpZiB0aGUgc2F2ZSBzdGF0ZSBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAgICAgICAgaWYgKHNhdmVkU3RhdGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNhdmUoc2F2ZWRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgc2F2ZSB0aGUgY3VycmVudCBzdGF0ZSwgYW5kIGFsbCBoaXN0b3J5LlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBzYXZlZFN0YXRlICBBbnkgcHJvcGVydHkgb24gdGhpc1xuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdCB3aWxsIGJlIGFjY2Vzc2libGVcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGVuIHRoZSB2aWV3IHJlbG9hZHNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc2F2ZShzYXZlZFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICAgICAgdmFyIGxpbmtzID0gdGhpc0dyYXBoLmxpbmtzO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyVGl0bGUgPSBudWxsO1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS50aXRsZUVsZW0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBjdXJyVGl0bGUgPSBzdGF0ZS50aXRsZUVsZW0udGV4dCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZm9jdXNHcm91cHMgPSBzdGF0ZS5mb2N1c0dyb3VwcztcbiAgICAgICAgICAgICAgICB2YXIgZXZlbnRIaXN0b3J5ID0gc3RhdGUuZXZlbnRIaXN0b3J5O1xuICAgICAgICAgICAgICAgIHZhciB6b29tcyA9IHN0YXRlLnpvb21zO1xuICAgICAgICAgICAgICAgIHZhciBsYXlvdXQgPSBzdGF0ZS5sYXlvdXQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgbGF5b3V0RGVmYXVsdCA9IHN0YXRlLmxheW91dERlZmF1bHQ7XG4gICAgICAgICAgICAgICAgdmFyIHpvb21EZWZhdWx0ID0gc3RhdGUuem9vbURlZmF1bHQ7XG4gICAgICAgICAgICAgICAgdmFyIHJldCA9IHtub2Rlczpub2RlcywgbGlua3M6bGlua3MsIFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZXM6c3RhdGUuc2F2ZWRTdGF0ZXMsIGN1cnJUaXRsZTpjdXJyVGl0bGUsIFxuICAgICAgICAgICAgICAgICAgICBmb2N1c0dyb3VwczogZm9jdXNHcm91cHMsXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50SGlzdG9yeTpldmVudEhpc3RvcnksIHpvb21zOnpvb21zLFxuICAgICAgICAgICAgICAgICAgICBsYXlvdXQ6bGF5b3V0LCBsYXlvdXREZWZhdWx0OmxheW91dERlZmF1bHQsXG4gICAgICAgICAgICAgICAgICAgIHpvb21EZWZhdWx0Onpvb21EZWZhdWx0fTtcbiAgICAgICAgICAgICAgICBzYXZlZFN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3kgPSByZXQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2lsbCBiZSBjYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgcmVsb2FkZWQsIGFzc3VtaW5nXG4gICAgICAgICAgICAgKiBzYXZlIHN0YXRlIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgbG9hZFN0YXRlICBDb250YWlucyBhbGwgdGhlIHNhdmVkXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJpYWJsZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgbG9hZChsb2FkU3RhdGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICBsb2FkU3RhdGUgPSBsb2FkU3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zYXZlZFN0YXRlcyA9IGxvYWRTdGF0ZS5zdGF0ZXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzID0gbG9hZFN0YXRlLmxpbmtzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlcyA9IGxvYWRTdGF0ZS5ub2RlcztcblxuICAgICAgICAgICAgICAgIHZhciBjdXJyVGl0bGUgPSBsb2FkU3RhdGUuY3VyclRpdGxlO1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS50aXRsZUVsZW0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS50aXRsZUVsZW0udGV4dChjdXJyVGl0bGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkgPSBsb2FkU3RhdGUuZXZlbnRIaXN0b3J5O1xuICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzID0gbG9hZFN0YXRlLmZvY3VzR3JvdXBzO1xuICAgICAgICAgICAgICAgIHN0YXRlLnpvb21zID0gbG9hZFN0YXRlLnpvb21zO1xuICAgICAgICAgICAgICAgIHN0YXRlLmxheW91dCA9IGxvYWRTdGF0ZS5sYXlvdXQ7XG4gICAgICAgICAgICAgICAgc3RhdGUubGF5b3V0RGVmYXVsdCA9IGxvYWRTdGF0ZS5sYXlvdXREZWZhdWx0O1xuICAgICAgICAgICAgICAgIHN0YXRlLnpvb21EZWZhdWx0ID0gbG9hZFN0YXRlLnpvb21EZWZhdWx0O1xuXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmJhY2tCdXR0b25FbGVtICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uRWxlbS5mYWRlVG8oJ3Nsb3cnLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG5cbiAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoXy5pbmNsdWRlcyhjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImZvY3VzXCI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiY29ubmVjdGVkXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vbG9hZGluZyBhIHByZXZpb3VzIGxheW91dFxuICAgICAgICAgICAgICAgIHZhciBsYXlvdXQ7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBsYXlvdXQgPSBzdGF0ZS5sYXlvdXREZWZhdWx0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbSA9IHN0YXRlLnpvb21EZWZhdWx0OyBcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh6b29tWzBdLCB6b29tWzFdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbSA9IHN0YXRlLnpvb21zW3N0YXRlLmZvY3VzR3JvdXBzXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHpvb20gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh6b29tWzBdLCB6b29tWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBsYXlvdXQgPSBzdGF0ZS5sYXlvdXRbc3RhdGUuZm9jdXNHcm91cHNdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vbGF5b3V0IGNhbid0IGJlIG51bGxcbiAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbihuKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwb3MgPSBsYXlvdXRbbi5pZF07XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb3MgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cobGF5b3V0LCBuKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBuLnggPSBwb3MueDtcbiAgICAgICAgICAgICAgICAgICAgbi55ID0gcG9zLnk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN0YXRlLmluaXRGb3JjZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoLmNhbGwodGhpc0dyYXBoLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51cGRhdGVHcmFwaENhbGxiYWNrLmNhbGwodGhpc1BvbGljeSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVHJpZ2dlcmluZyBzcGxpdCBvbiBkb3VibGUgY2xpY2tcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogRm9jdXMgZ3JvdXAgc3RvcmVzIHRoZSBub2RlIHRoYXQgaXMgYWJvdXQgdG8gYmUgc3BsaXQuXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIFdoZW4gZm9jdXMgZ3JvdXAgaGFzIGxlbmd0aCAwLCB0aGUgZmlyc3Qgc3BsaXQgXG4gICAgICAgICAgICAgKiB3aWxsIGp1c3QgYmUgcHVzaGVkIG9uLlxuICAgICAgICAgICAgICogVGhlIG5vZGUgd2lsbCBiZSBzcGxpdCBhbmQgcHVzaGVkIHRvIHRoZSB0b3AgaGFsZiBcbiAgICAgICAgICAgICAqIG9mIHRoZSBzY3JlZW4sIGFuZCB0aGUgYm90dG9tIGhhbGYgd2lsbCBjb250YWluIGFueVxuICAgICAgICAgICAgICogbm9kZXMgaXQgaGFzIGNvbm5lY3Rpb25zIHRvLlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBXaGVuIGEgZm9jdXMgZ3JvdXAgbGVuZ3RoIGlzID49IDEsIGlmIHRoZSBub2RlIHRvIGJlXG4gICAgICAgICAgICAgKiBzcGxpdCBpcyBhIGZvY3VzIG5vZGUsIGl0IHdpbGwgcmVwbGFjZSBmb2N1c0dyb3Vwc1swXSBhbmRcbiAgICAgICAgICAgICAqIHRoZSB0b3AgaGFsZiB3aWxsIGJlIGl0cyBjaGlsZHJlbiwgYW5kIGJvdHRvbSBoYWxmIHdpbGxcbiAgICAgICAgICAgICAqIGJlIHRoZSBub2RlcyBpdCBoYXMgY29ubmVjdGlvbnMgdG8uXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIElmIHRoZSBzcGxpdCBpcyBpbiB0aGUgYm90dG9tIGhhbGYsIHRoZW4gdGhlIGJvdHRvbSBoYWxmXG4gICAgICAgICAgICAgKiB3aWxsIGRpc3BsYXkgaXQncyBjaGlsZHJlbiBhbmQgd2lsbCBvbmx5IHNob3cgY29ubmVjdGlvbnMgYmV0d2VlblxuICAgICAgICAgICAgICogdGhlIHR3byBncm91cHMsIGFuZCB3aWxsIHJlcGxhY2UgZm9jdXNHcm91cHNbMV0uXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09ian0gICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgZCAgICAgICBUaGUgbWF0Y2hpbmcgZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZGJsY2xpY2soZDNub2RlLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICAvL2NoZWNrIGlmIGNhbiBzcGxpdFxuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gZC5pZDtcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIGlmIChjaGlsZHJlbl9zdHJ1Y3RbbmFtZV0gPT09IHVuZGVmaW5lZCB8fCBfLmlzRW1wdHkoY2hpbGRyZW5fc3RydWN0W25hbWVdKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMuc2xpY2UoKTtcblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDApIHsgLy90b3BsZXZlbCBzcGxpdFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwcy5wdXNoKGQuaWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXy5pbmNsdWRlcyhjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5pZCkpIHsgLy9zcGxpdHRpbmcgYSBmb2N1cyBub2RlXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzWzBdID0gZC5pZDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMSkgey8vc3BsaXR0aW5nIGFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29ubmVjdGVkIG5vZGVcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMucHVzaChkLmlkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKF8uaW5jbHVkZXMoY2hpbGRyZW5fc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzFdXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5pZCkpIHsvL3NwbGl0dGluZyBhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25uZWN0ZWQgbm9kZVxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwc1sxXSA9IGQuaWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAyICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHNbMV0gPT09IGQuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9TcGxpdHRpbmcgYSBjb25uZWN0ZWQgbm9kZSwga2VlcCBhbGwgZm9jdXMgbm9kZXNcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVzVG9LZWVwID0gW2RdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZUlkc1RvUmVzaG93ID0gW107XG4gICAgICAgICAgICAgICAgICAgIHZhciBncm91cE9uZU5vZGVzID0gY2hpbGRyZW5fc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzBdXTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF8uaW5jbHVkZXMoZ3JvdXBPbmVOb2Rlcywgbm9kZS5pZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzVG9SZXNob3cucHVzaChub2RlLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1RvS2VlcC5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL01ha2Ugc3BsaXQgbm9kZXMgdGhlIGZvY3VzIGFuZCBrZWVwIG5vZGVzIHRoYXQgYXJlIGNvbm5lY3RlZFxuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZXNUb0tlZXAgPSBbZF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlSWRzVG9SZXNob3cgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5saW5rcywgZnVuY3Rpb24obGluaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmsuc291cmNlID09PSBkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHNUb1Jlc2hvdy5pbmRleE9mKGxpbmsudGFyZ2V0LmlkKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsudGFyZ2V0LlNwbGl0Sm9pblZpZXdQb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rLnRhcmdldC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImNvbm5lY3RlZFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHNUb1Jlc2hvdy5wdXNoKGxpbmsudGFyZ2V0LmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1RvS2VlcC5wdXNoKGxpbmsudGFyZ2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobGluay50YXJnZXQgPT09IGQgJiYgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHNUb1Jlc2hvdy5pbmRleE9mKGxpbmsuc291cmNlLmlkKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsuc291cmNlLlNwbGl0Sm9pblZpZXdQb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rLnNvdXJjZS5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImNvbm5lY3RlZFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHNUb1Jlc2hvdy5wdXNoKGxpbmsuc291cmNlLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1RvS2VlcC5wdXNoKGxpbmsuc291cmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9SZW1vdmluZyBsaW5rcyBmcm9tIHRoZSBub2RlIHRvIGJlIHNwbGl0XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZWFjaChmdW5jdGlvbihub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLmlkICE9PSBkLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3BsaWNlTGlua3NGb3JOb2RlKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG5cbiAgICAgICAgICAgICAgICAvL2Rpc2FibGluZyB1cGRhdGUgZ3JhcGggdG8gcHJldmVudCBuZXcgZGF0YSBmcm9tXG4gICAgICAgICAgICAgICAgLy9yZWRyYXdpbmcgbGlua3Mgd2hpbGUgdGhlcmUgYXJlIGFuaW1hdGlvbnMgZ29pbmcgb25cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3RhdGUuZGlzYWJsZVVwZGF0ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZWFjaChmdW5jdGlvbihub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLmlkICE9PSBkLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykudHJhbnNpdGlvbigpLmRlbGF5KDIwMCkuZHVyYXRpb24oNDAwKS5zdHlsZShcIm9wYWNpdHlcIiwgMCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2Rpc2FibGluZyBxdGlwIGlmIGluc3RhbGxlZFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQodGhpcykucXRpcCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5xdGlwKCdkaXNhYmxlJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHZhciB0cmFuc2xhdGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKTtcbiAgICAgICAgICAgICAgICB2YXIgc2NhbGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpO1xuICAgICAgICAgICAgICAgIHZhciB4TG9jID0gKHBhcnNlRmxvYXQodGhpc0dyYXBoLnN2Zy5zdHlsZShcIndpZHRoXCIpKSAvIHNjYWxlKSAvIDIgICsgdHJhbnNsYXRlWzBdO1xuICAgICAgICAgICAgICAgIHZhciB5TG9jID0gKHBhcnNlRmxvYXQodGhpc0dyYXBoLnN2Zy5zdHlsZShcImhlaWdodFwiKSkgLyBzY2FsZSkvIDIgICsgdHJhbnNsYXRlWzFdO1xuICAgICAgICAgICAgICAgIGQueFN0YXJ0ID0gZC54O1xuICAgICAgICAgICAgICAgIGQueVN0YXJ0ID0gZC55O1xuICAgICAgICAgICAgICAgIGQueCA9IHhMb2M7XG4gICAgICAgICAgICAgICAgZC55ID0geUxvYztcbiAgICAgICAgICAgICAgICBkM25vZGUudHJhbnNpdGlvbihcIm5vZGVQb3NpdGlvblRyYW5zaXRpb25cIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kdXJhdGlvbig3NTApXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0clR3ZWVuKFwidHJhbnNmb3JtXCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgeFN0YXJ0ID0gZC54U3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHlTdGFydCA9IGQueVN0YXJ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueFN0YXJ0ID0gZC54O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueVN0YXJ0ID0gZC55O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkMy5pbnRlcnBvbGF0ZVN0cmluZyhcInRyYW5zbGF0ZShcIiArIHhTdGFydCArIFwiLFwiICsgeVN0YXJ0ICsgXCIpXCIsIFwidHJhbnNsYXRlKFwiICsgZC54ICsgXCIsXCIgKyBkLnkgKyBcIilcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHZhciBzcGxpdE5vZGVGdW5jID0gc3VwZXIuc3BsaXROb2RlO1xuICAgICAgICAgICAgICAgIHN0YXRlLm5vZGVJZHNUb1Jlc2hvdyA9IG5vZGVJZHNUb1Jlc2hvdztcbiAgICAgICAgICAgICAgICAvL3dhaXRpbmcgZm9yIG5vZGUgdHJhbnNpdGlvblxuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMgPSBub2Rlc1RvS2VlcDtcbiAgICAgICAgICAgICAgICAgICAgc3BsaXROb2RlRnVuYy5jYWxsKHRoaXNQb2xpY3ksIGQpO1xuICAgICAgICAgICAgICAgIH0sIDc1MCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVG8gYmUgY2FsbGVkIGFmdGVyIHRoZSBncmFwaCBpcyBzcGxpdC5cbiAgICAgICAgICAgICAqIEJyaW5ncyBhbGwgbm9kZXMgYmFjayBpbnRvIHZpZXcgYW5kIHNldHMgdGhlaXIgYXR0cmlidXRlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1cGRhdGVHcmFwaENhbGxiYWNrKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2goZnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLnRyYW5zaXRpb24oKS5kdXJhdGlvbig0MDApLnN0eWxlKFwib3BhY2l0eVwiLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5jbGFzc2VkKFwiZm9jdXNcIiwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLmNsYXNzZWQoXCJjb25uZWN0ZWRcIiwgZmFsc2UpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5TcGxpdEpvaW5WaWV3UG9saWN5ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPT09IFwiZm9jdXNcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykuY2xhc3NlZChcImZvY3VzXCIsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobm9kZS5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPT09IFwiY29ubmVjdGVkXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLmNsYXNzZWQoXCJjb25uZWN0ZWRcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ub2RlSWRzVG9SZXNob3cgPSBudWxsO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJhbmRvbWx5IHNldHMgdGhlIHBvc2l0aW9ucyBvZiBhbnkgdW5zZXQgbm9kZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzZXRQb3NpdGlvbnMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kgPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBncmFwaENvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHM7XG5cbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gZ3JhcGhDb25zdHMuZGlzcGxheU9mZnNldDtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICAgICAgdmFyIHJldCA9IHRoaXNQb2xpY3kuZDNGb3JjZUJvdW5kcy5jYWxsKHRoaXNHcmFwaCk7XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZXRSYW5kb21JbnQobWluLCBtYXgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4gKyAxKSkgKyBtaW47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKG5vZGVzLCBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLnggPT0gbnVsbCB8fCBub2RlLnkgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHggPSBnZXRSYW5kb21JbnQobm9kZS5yYWRpdXMgKyBvZmZzZXQsIHJldC53aWR0aCAtIG5vZGUucmFkaXVzIC0gb2Zmc2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB5ID0gZ2V0UmFuZG9tSW50KG5vZGUucmFkaXVzICsgb2Zmc2V0LCByZXQuaGVpZ2h0IC0gbm9kZS5yYWRpdXMgLSBvZmZzZXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS54ID0geDtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUueSA9IHk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBvbiB0aGUgc3RhcnQgb2YgdGhlIGQzIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqIFdpbGwgb3ZlcnJpZGUgdGhlIG1ldGhvZCBvZiB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqIFwidGhpc1wiIHBvaW50cyB0byB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZVN0YXJ0KCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjeCcsIGZ1bmN0aW9uKGQpIHsgXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC54U3RhcnQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueFN0YXJ0ID0gKGQueFN0YXJ0ICogdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKSkgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkLng7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjeScsIGZ1bmN0aW9uKGQpIHsgXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC55U3RhcnQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueVN0YXJ0ID0gKGQueVN0YXJ0ICp0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpKSArIHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHNcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueTsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueTsgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIG9uIHRoZSBzdGFydCBvZiB0aGUgZDMgZm9yY2Ugc2ltdWxhdGlvblxuICAgICAgICAgICAgICogV2lsbCBvdmVycmlkZSB0aGUgbWV0aG9kIG9mIHRoZSBncmFwaFxuICAgICAgICAgICAgICogXCJ0aGlzXCIgcG9pbnRzIHRvIHRoZSBncmFwaFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkM0ZvcmNlRW5kKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kgPSBzdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZVBvbGljeS5sYXlvdXREZWZhdWx0ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZmF1bHRMYXlvdXQgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24obikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdExheW91dFtuLmlkXSA9IHt4Om4ueCwgeTpuLnl9O1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kubGF5b3V0RGVmYXVsdCA9IGRlZmF1bHRMYXlvdXQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzY2FsZSA9IHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0cmFuc2xhdGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kuem9vbURlZmF1bHQgPSBbdHJhbnNsYXRlLCBzY2FsZV07IFxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjeCcsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2N5JywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC55OyB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocy5hdHRyKCd4MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLnk7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd4MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lnk7IH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgYmUgY2FsbGVkIGR1cmluZyBEMyBmb3JjZSBzaW11bGF0aW9uc1xuICAgICAgICAgICAgICogYnkgdGhlIGdyYXBoLCBzbyBcInRoaXNcIiB3aWxsIHBvaW50IHRvIHRoZSBncmFwaCBvYmplY3RcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgd2lkdGggICBEMyBMYXlvdXQgV2lkdGhcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICBoZWlnaHQgIEQzIExheW91dCBIZWlnaHRcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZVRpY2soZSwgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kgPSBzdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IGNvbnN0cy5kaXNwbGF5T2Zmc2V0O1xuICAgICAgICAgICAgICAgIHZhciBzY2FsZSA9IHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCk7XG5cbiAgICAgICAgICAgICAgICAvLyBNb3ZlIG5vZGVzIHRvd2FyZCBjbHVzdGVyIGZvY3VzLlxuICAgICAgICAgICAgICAgIHZhciBmb2NpID0gc3RhdGVQb2xpY3kuZm9jaTtcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBncmF2aXR5KGFscGhhKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm9jaS5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPT09IFwiZm9jdXNcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gKGZvY2lbMF0gLSBkLnkpICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55ICs9IChmb2NpWzFdIC0gZC55KSAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnggKz0gKHdpZHRoLzIgLSBkLngpICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSArPSAoaGVpZ2h0LzIgLSBkLnkpICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC54ICs9ICh3aWR0aC8yIC0gZC54KSAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIE1ha2Ugc3VyZSBub2RlcyBhcmUgd2l0aGluIGJvdW5kc1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzXG4gICAgICAgICAgICAgICAgICAgIC5lYWNoKHRoaXMuZDNGb3JjZUNvbGxpZGUoLjUpKVxuICAgICAgICAgICAgICAgICAgICAuZWFjaChncmF2aXR5KC4yICogZS5hbHBoYSkpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiY3hcIiwgZnVuY3Rpb24oZCkgeyBcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnggPSBNYXRoLm1heCgoZC5yYWRpdXMgKyBvZmZzZXQpL3NjYWxlLCBNYXRoLm1pbih3aWR0aCArICgoLW9mZnNldC0gZC5yYWRpdXMpIC8gc2NhbGUpLCBkLngpKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJjeVwiLCBmdW5jdGlvbihkKSB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuU3BsaXRKb2luVmlld1BvbGljeSA9PSBudWxsIHx8IGQuU3BsaXRKb2luVmlld1BvbGljeSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55ID0gTWF0aC5tYXgoKGQucmFkaXVzICsgb2Zmc2V0KS9zY2FsZSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLm1pbihoZWlnaHQgKyAoKC1vZmZzZXQgLSBkLnJhZGl1cykvc2NhbGUpLCBkLnkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9PT0gXCJmb2N1c1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55ID0gTWF0aC5tYXgoZC5yYWRpdXMgKyBvZmZzZXQsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5taW4oKGhlaWdodCArICgoLW9mZnNldCAtIGQucmFkaXVzKS9zY2FsZSkpKmNvbnN0cy5TcGxpdEpvaW5WaWV3UG9saWN5LmJvdW5kYXJ5LCBkLnkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9PT0gXCJjb25uZWN0ZWRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSA9IE1hdGgubWF4KChoZWlnaHQgKyAoKG9mZnNldCAtIGQucmFkaXVzKS9zY2FsZSkpICpjb25zdHMuU3BsaXRKb2luVmlld1BvbGljeS5ib3VuZGFyeSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLm1pbihoZWlnaHQgKyAoKC1vZmZzZXQgLSBkLnJhZGl1cykvc2NhbGUpLCBkLnkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoc1xuICAgICAgICAgICAgICAgICAgICAuYXR0cigneDEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS55OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneDInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC55OyB9KTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGN1bGF0ZXMgdGhlIGJvdW5kYXJpZXMgb2YgdGhlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogV2lsbCBiZSBjYWxsZWQgZHVyaW5nIEQzIGZvcmNlIHNpbXVsYXRpb25zXG4gICAgICAgICAgICAgKiBieSB0aGUgZ3JhcGgsIHNvIFwidGhpc1wiIHdpbGwgcG9pbnQgdG8gdGhlIGdyYXBoIG9iamVjdFxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7T2JqZWN0fSAgICAgICAgICBSZXR1cm5zIGFuIG9iamVjdFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdCBoYXMgdGhlIHdpZHRoXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmQgaGVpZ2h0IGFzIFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllcyBcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZUJvdW5kcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0c1BvbGljeSA9IGNvbnN0cy5TcGxpdEpvaW5WaWV3UG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZVBvbGljeSA9IHN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNhbGNNYXhOb2Rlcyh3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhcmVhID0gd2lkdGggKiBoZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciByYWRpdXMgPSB0aGlzR3JhcGguY29uc3RzLnN0YXJ0UmFkaXVzO1xuICAgICAgICAgICAgICAgICAgICAvL3RyZWF0aW5nIHRoZW0gYXMgYSBzcXVhcmUgZm9yIGFwcHJveFxuICAgICAgICAgICAgICAgICAgICB2YXIgbGVuZ3RoID0gKHJhZGl1cyAqMy41KTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFtb3VudCA9IGFyZWEgLyhsZW5ndGggKmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhbW91bnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vVGhlIG9mZnNldCBpcyB0aGUgYnVmZmVyIGZyb20gdGhlIGVkZ2VzXG4gICAgICAgICAgICAgICAgLy9PcmlnaW5hbCBXaWR0aCBhbmQgSGVpZ2h0IGFyZSBnaXZlbiB0byB0aGUgZm9yY2UgbGF5b3V0XG4gICAgICAgICAgICAgICAgLy9zbyB0aGF0IGl0IGlzIGNlbnRlcmVkLCBidXQgbm9kZXMgd2lsbCBiZSBmb3JjZWQgdG8gYmVcbiAgICAgICAgICAgICAgICAvL3dpdGhpbiB0aGUgb2Zmc2V0IGJvdW5kc1xuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSBjb25zdHMuZGlzcGxheU9mZnNldDtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnV2lkdGggPSBwYXJzZUZsb2F0KHRoaXNHcmFwaC5zdmcuc3R5bGUoXCJ3aWR0aFwiKSk7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z0hlaWdodCA9IHBhcnNlRmxvYXQodGhpc0dyYXBoLnN2Zy5zdHlsZShcImhlaWdodFwiKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBzdmdXaWR0aDtcbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gc3ZnSGVpZ2h0O1xuXG4gICAgICAgICAgICAgICAgdmFyIGFtb3VudCA9IGNhbGNNYXhOb2Rlcyh3aWR0aCAtICgyKm9mZnNldCksIGhlaWdodCAtICgyKm9mZnNldCkpO1xuICAgICAgICAgICAgICAgIHZhciBzY2FsZSA9IDE7XG4gICAgICAgICAgICAgICAgaWYgKG5vZGVzLmxlbmd0aCA+IGFtb3VudCkge1xuICAgICAgICAgICAgICAgICAgICBzY2FsZSA9IGFtb3VudCAvIG5vZGVzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKSwgc2NhbGUpO1xuICAgICAgICAgICAgICAgICAgICB3aWR0aCAvPSBzY2FsZTtcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0IC89IHNjYWxlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQodGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKCksIHNjYWxlKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL2NhbGN1bGF0aW5nIGZvY2kgZm9yIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAgICB2YXIgZm9jdXNHcm91cHMgPSBzdGF0ZVBvbGljeS5mb2N1c0dyb3VwcztcbiAgICAgICAgICAgICAgICB2YXIgZm9jaTtcbiAgICAgICAgICAgICAgICBpZiAoZm9jdXNHcm91cHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvY2kgPSBbaGVpZ2h0LzJdO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vc2V0dGluZyBmb2NpIGhlaWdodCBwb3NpdGlvbiBiYXNlZCBvbiBwZXJjZW50YWdlXG4gICAgICAgICAgICAgICAgICAgIHZhciBmb2N1c05vZGVzID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0W2ZvY3VzR3JvdXBzWzBdXTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzUG9saWN5LmJvdW5kYXJ5ID0gZm9jdXNOb2Rlcy5sZW5ndGggLyBub2Rlcy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0b3AgPSBoZWlnaHQgKiBjb25zdHNQb2xpY3kuYm91bmRhcnk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBib3QgPSBoZWlnaHQgLSB0b3A7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0b3AgPCAyKnRoaXNHcmFwaC5jb25zdHMubWF4UmFkaXVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdHNQb2xpY3kuYm91bmRhcnkgPSAoMi41ICogdGhpc0dyYXBoLmNvbnN0cy5tYXhSYWRpdXMpIC8gaGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9wID0gaGVpZ2h0ICogY29uc3RzUG9saWN5LmJvdW5kYXJ5O1xuICAgICAgICAgICAgICAgICAgICAgICAgYm90ID0gaGVpZ2h0IC0gdG9wO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGJvdCA8IDIqIHRoaXNHcmFwaC5jb25zdHMubWF4UmFkaXVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdHNQb2xpY3kuYm91bmRhcnkgPSAxIC0gKCgyLjUgKiB0aGlzR3JhcGguY29uc3RzLm1heFJhZGl1cykgLyBoZWlnaHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9wID0gaGVpZ2h0ICogY29uc3RzUG9saWN5LmJvdW5kYXJ5O1xuICAgICAgICAgICAgICAgICAgICAgICAgYm90ID0gaGVpZ2h0IC0gdG9wO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZvY2kgPSBbdG9wLzIsIHRvcCArIGJvdCAvIDJdO1xuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5LmZvY2kgPSBmb2NpO1xuICAgICAgICAgICAgICAgIHJldHVybiB7d2lkdGg6d2lkdGgsIGhlaWdodDpoZWlnaHR9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBhIHNpbmdsZSBub2RlIGlzIHNwbGl0XG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5ld05vZGVzICBUaGUgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNwbGl0Tm9kZUV2ZW50KG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICBfLmZvckVhY2gobmV3Tm9kZXMsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF8uaW5jbHVkZXMoY2hpbGRyZW5fc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzBdXSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5pZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJmb2N1c1wiO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImNvbm5lY3RlZFwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSBuZXdOb2Rlc1swXS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgLy8gc3RhdGUuZm9jdXNHcm91cCA9IHRpdGxlO1xuXG4gICAgICAgICAgICAgICAgLy9pZiB0aGUgbGFzdCBldmVudCBoYXMgdGhlIHNhbWUgaWQsIGl0IG11c3QgYmUgdGhlXG4gICAgICAgICAgICAgICAgLy9vcHBwb3NpdGUgb2YgdGhpcyBldmVudCwgc28gd2UgcmVtb3ZlIHRoYXQgZXZlbnQgZnJvbVxuICAgICAgICAgICAgICAgIC8vdGhlIGV2ZW50IHN0YWNrLlxuICAgICAgICAgICAgICAgIC8vT3RoZXJ3aXNlLCB3ZSBhZGQgdGhlIGV2ZW50IG90IHRoZSBzdGFja1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoICE9PSAwICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3Rvcnlbc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCAtIDFdLmlkID09PSB0aXRsZSkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkucG9wKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5LnB1c2goe2lkOnRpdGxlLCBldmVudDonc3BsaXQnfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmJhY2tCdXR0b25FbGVtICE9IG51bGwgJiYgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uRWxlbS5mYWRlVG8oJ3Nsb3cnLCAxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLnRpdGxlRWxlbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0gc3RhdGUuZm9jdXNHcm91cHNbMF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSAnICYgJyArIHN0YXRlLmZvY3VzR3JvdXBzWzFdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLnRpdGxlRWxlbS50ZXh0KHRleHQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vcmUtZW5hYmxlIGdyYXBoIHVwZGF0ZVxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZS5kaXNhYmxlVXBkYXRlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpc1BvbGljeS5zZXRMYXlvdXQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTZXRzIHRoZSBsYXlvdXQgb2YgdGhlIG5vZGVzLiBcbiAgICAgICAgICAgICAqIElmIHRoZXJlIGlzIGEgcHJldmlvdXMgbGF5b3V0LCBpdCB3aWxsIGJlIGxvYWRlZC5cbiAgICAgICAgICAgICAqIEVsc2UsIGl0IHdpbGwgcnVuIGEgRDMgRm9yY2Ugc2ltdWxhdGlvbiBhbmQgY3JlYXRlIG9uZS5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc2V0TGF5b3V0KCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcbiAgICAgICAgICAgICAgICB2YXIgbGF5b3V0O1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ID0gc3RhdGUubGF5b3V0RGVmYXVsdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSBzdGF0ZS56b29tRGVmYXVsdDtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh6b29tWzBdLCB6b29tWzFdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbSA9IHN0YXRlLnpvb21zW3N0YXRlLmZvY3VzR3JvdXBzXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHpvb20gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh6b29tWzBdLCB6b29tWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBsYXlvdXQgPSBzdGF0ZS5sYXlvdXRbc3RhdGUuZm9jdXNHcm91cHNdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChsYXlvdXQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbihuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9zID0gbGF5b3V0W24uaWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBvcyA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cobGF5b3V0LCBuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG4ueCA9IHBvcy54O1xuICAgICAgICAgICAgICAgICAgICAgICAgbi55ID0gcG9zLnk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGguY2FsbCh0aGlzR3JhcGgsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51cGRhdGVHcmFwaENhbGxiYWNrLmNhbGwodGhpc1BvbGljeSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vTmVlZCB0byBydW4gYSBmb3JjZSBzaW11bGF0aW9uIGFzIHRoaXMgbGF5b3V0XG4gICAgICAgICAgICAgICAgICAgIC8vaGFzbid0IGJlZW4gZG9uZSBiZWZvcmVcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN0YXRlLmluaXRGb3JjZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAvLyB0aGlzUG9saWN5LnNldFBvc2l0aW9ucygpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnVwZGF0ZUdyYXBoQ2FsbGJhY2suY2FsbCh0aGlzUG9saWN5KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLnpvb21zW3N0YXRlLmZvY3VzR3JvdXBzXSA9IFt0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKV07XG4gICAgICAgICAgICAgICAgICAgIHZhciBsYXlvdXQgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24obikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0W24uaWRdID0ge3g6bi54LCB5Om4ueX07XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5sYXlvdXRbc3RhdGUuZm9jdXNHcm91cHNdID0gbGF5b3V0O1xuICAgICAgICAgICAgICAgIH0gXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogT3ZlcnJpZGluZyBmcm9tIHN1cGVyIGNsYXNzIHNvIHRoYXQgd2UgY2FuIGhhdmVcbiAgICAgICAgICAgICAqIHRvcCBsZXZlbCBub2RlcyByZWFwcGVhciB3aGVuIHRoZXkgYXJlIGhpZGRlblxuICAgICAgICAgICAgICogZHVlIHRvIHRoZXJlIGJlaW5nIHR3byBmb2N1cyBncm91cHMuXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgICAgICBub2RlICAgIFRoZSBub2RlIHRvIGpvaW5cbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtOb2RlfSAgVGhlIG5ldyBub2RlIGFmdGVyIHRoZSBqb2luXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIF9fam9pbk5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZVN1cGVyID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pbk5vZGVQb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICAvL2NoZWNrIHRoYXQgbm9kZSBzdGlsbCBleGlzdHNcbiAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLm5vZGVzLmluZGV4T2Yobm9kZSkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBub2RlLmlkO1xuICAgICAgICAgICAgICAgIC8vaWYgaXQgaGFzIG5vIGFuY2VzdG9yLCBub3RoaW5nIHRvIGpvaW5cbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRyZW5fc3RydWN0LnRvcExldmVsLmluZGV4T2YobmFtZSkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IG5vZGUucGFyZW50O1xuICAgICAgICAgICAgICAgIHZhciB0b19iZV9kZWxldGVkID0gW107XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVOYW1lU2V0ID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgLy9pZiBub2RlIHdvbid0IGJlIGNvbGxhcHNlZFxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLm5vZGVzW2ldLmFuY2VzdG9ycy5pbmRleE9mKG5vZGUucGFyZW50KSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZU5hbWVTZXQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0uaWQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9fYmVfZGVsZXRlZC5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlX2lkID0gbm9kZS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgbm9kZU5hbWVTZXQucHVzaChub2RlLnBhcmVudCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgYW5jZXN0b3JzX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmFuY2VzdG9yc19zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICAvLyAtIHNldHRpbmcgZm9jdXNHcm91cHMgLVxuICAgICAgICAgICAgICAgIC8vZWl0aGVyIHJlcGxhY2luZyBvbmUgb2YgdGhlIGdyb3VwcyxcbiAgICAgICAgICAgICAgICAvL29yIGpvaW5pbmcgYmFjayBpbnRvIGEgdG9wIGxldmVsLCBzbyB0aGVyZSBpcyBvbmx5XG4gICAgICAgICAgICAgICAgLy9vbmUgZm9jdXNcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBzdGF0ZS5mb2N1c0dyb3Vwcy5pbmRleE9mKHBhcmVudCk7XG4gICAgICAgICAgICAgICAgaWYgKGFuY2VzdG9yc19zdHJ1Y3RbcGFyZW50XSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzW2luZGV4XSA9IGFuY2VzdG9yc19zdHJ1Y3RbcGFyZW50XTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vbmFtZVRvQWRkIGFyZSB0b3AgbGV2ZWwgbm9kZXMgdGhhdCBhcmUgdG8gYmUgYWRkZWRcbiAgICAgICAgICAgICAgICAvL3RvIHRoZSBncmFwaC5cbiAgICAgICAgICAgICAgICB2YXIgbmFtZVRvQWRkID0gW107XG4gICAgICAgICAgICAgICAgLy93aWxsIG9ubHkgbmVlZCB0byBhZGQgYSB0b3AgbGV2ZWwgbm9kZSBpZiB0aGVyZSBpc1xuICAgICAgICAgICAgICAgIC8vb25seSBvbmUgZm9jdXNcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vQWRkIG9ubHkgdGhvc3QgdGhhdCBhcmVuJ3QgYW4gYW5jZXN0b3Igb2YgdGhlIG5vZGVcbiAgICAgICAgICAgICAgICAgICAgLy90byBqb2luLCB0aGUgZm9jdXMgZ3JvdXAgb3IgYW4gYW5jZXN0b3Igb2YgaXQsXG4gICAgICAgICAgICAgICAgICAgIC8vYW5kIGFyZW4ndCBhbHJlYWR5IGluIG5vZGVOYW1lU2V0LlxuICAgICAgICAgICAgICAgICAgICAvL2dldCBmbG93IGJldHdlZW4gdG9wIGxldmVsIGFzIGxvbmcgYXNcbiAgICAgICAgICAgICAgICAgICAgLy90aGUgdG9wIGxldmVsIGlzbid0IGFuIGFuY2VzdG9yIG9mIHRoZVxuICAgICAgICAgICAgICAgICAgICAvL2ZvY3VzIGdyb3VwLCBhbmQgaXNuJ3QgYWxyZWFkeSBwYXJ0IG9mIHRoZVxuICAgICAgICAgICAgICAgICAgICAvL25vZGUgc2V0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgYW5jZXN0b3JzID0gYW5jZXN0b3JzX3N0cnVjdFtub2RlLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3JzLnB1c2goc3RhdGUuZm9jdXNHcm91cHNbMF0pO1xuICAgICAgICAgICAgICAgICAgICAvL3RoZSBvciBlbXB0eSBhcnJheSBpcyB0byBwcmV2ZW50IGNvbmNhdGVuYXRpbmcgYSBudWxsXG4gICAgICAgICAgICAgICAgICAgIC8vb3IgdW5kZWZpbmVkIHZhbHVlXG4gICAgICAgICAgICAgICAgICAgIGFuY2VzdG9ycyA9IGFuY2VzdG9ycy5jb25jYXQoYW5jZXN0b3JzX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV0gfHwgW10pO1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goY2hpbGRyZW5fc3RydWN0LnRvcExldmVsLCBmdW5jdGlvbihuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW5jZXN0b3JzLmluZGV4T2YobikgPT09IC0xICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVOYW1lU2V0LmluZGV4T2YobikgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lVG9BZGQucHVzaChuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVOYW1lU2V0ID0gbm9kZU5hbWVTZXQuY29uY2F0KG5hbWVUb0FkZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy9ubyBmb2N1cyBncm91cHMgbWVhbnMgd2UgYXJlIGF0IHRvcCBsZXZlbFxuICAgICAgICAgICAgICAgICAgICAvL1Nob3VsZCBhZGQgYW55IHRvcCBsZXZlbCBub2RlcyB0aGF0IGFyZW4ndFxuICAgICAgICAgICAgICAgICAgICAvL2FscmVhZHkgdGhlcmVcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKGNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbCwgZnVuY3Rpb24obikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGVOYW1lU2V0LmluZGV4T2YobikgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lVG9BZGQucHVzaChuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVOYW1lU2V0ID0gbm9kZU5hbWVTZXQuY29uY2F0KG5hbWVUb0FkZCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9mb3JtYXR0aW5nIGRhdGFcbiAgICAgICAgICAgICAgICB2YXIgcmFkaXVzID0gbm9kZS5yYWRpdXMgLyB0aGlzR3JhcGguY29uc3RzLnJhZGl1c0RlY2F5OyBcbiAgICAgICAgICAgICAgICB2YXIgeExvYyA9IG5vZGUueDtcbiAgICAgICAgICAgICAgICB2YXIgeUxvYyA9IG5vZGUueTtcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gbm9kZS5hbmNlc3RvcnNbMV07XG4gICAgICAgICAgICAgICAgdmFyIGFuY2VzdG9ycyA9IG5vZGUuYW5jZXN0b3JzLnNsaWNlKDEpO1xuICAgICAgICAgICAgICAgIHZhciBuZXdOb2RlID0gbmV3IFZpc3VhbGl6ZXJOb2RlLk5vZGUoeExvYywgeUxvYywgbmV3X25vZGVfaWQsIG5ld19ub2RlX2lkLCByYWRpdXMsIHBhcmVudCwgYW5jZXN0b3JzKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMucHVzaChuZXdOb2RlKTtcblxuICAgICAgICAgICAgICAgIC8vcmVtb3ZlIGFsbCBub2RlcyB0aGF0IHdpbGwgYmUgam9pbmVkXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b19iZV9kZWxldGVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlX3RvX2RlbGV0ZSA9IHRvX2JlX2RlbGV0ZWRbaV07XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5zcGxpY2UodGhpc0dyYXBoLm5vZGVzLmluZGV4T2Yobm9kZV90b19kZWxldGUpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlX3RvX2RlbGV0ZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHJldERhdGEgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5nZXRGbG93QmV0d2VlblNldChub2RlTmFtZVNldCk7XG4gICAgICAgICAgICAgICAgLy9ob2xkcyB0aGUgbm9kZURhdGEgd2hpY2ggd2lsbCBiZSBwcm9jZXNzZWRcbiAgICAgICAgICAgICAgICB2YXIgbm9kZXNUb1Byb2Nlc3MgPSBbXTtcbiAgICAgICAgICAgICAgICAvL2ZpbmRpbmcgdGhlIG5vZGUgZGF0YSB0aGF0IGNvcnJlc3BvbmRzIHRvIHRoZSB0b3AgbGV2ZWxcbiAgICAgICAgICAgICAgICAvL25vZGVzIHRvIGFkZCAtIG5hbWVUb0FkZC5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZURhdGEgPSByZXREYXRhLm5vZGVEYXRhO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZURhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWVUb0FkZC5pbmRleE9mKG5vZGVEYXRhW2ldLmlkKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzVG9Qcm9jZXNzLnB1c2gobm9kZURhdGFbaV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9UaGUgdG9wIGxldmVsIG5vZGVzIHRoYXQgYXJlIGFkZGVkXG4gICAgICAgICAgICAgICAgdmFyIG5ld05vZGVzID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UucHJvY2Vzc05vZGVEYXRhKG5vZGVzVG9Qcm9jZXNzKTtcbiAgICAgICAgICAgICAgICBfLmZvckVhY2gobmV3Tm9kZXMsIGZ1bmN0aW9uKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgbi5yYWRpdXMgPSBuLnJhZGl1cyB8fCB0aGlzR3JhcGguY29uc3RzLnN0YXJ0UmFkaXVzO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlcyA9IHRoaXNHcmFwaC5ub2Rlcy5jb25jYXQobmV3Tm9kZXMpO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UucHJvY2Vzc0xpbmtEYXRhKHJldERhdGEubGlua0RhdGEsIHRoaXNHcmFwaC5ub2Rlcyk7XG4gICAgICAgICAgICAgICAgLy9Pbmx5IGtlZXAgdG9wIGxldmVsIG5vZGVzIHRoYXQgaGF2ZSBjb25uZWN0aW9ucyB0b1xuICAgICAgICAgICAgICAgIC8vdGhlIGN1cnJlbnQgZm9jdXMgZ3JvdXBcbiAgICAgICAgICAgICAgICAvL3dlIHJlbW92ZSB0aGUgbm9kZSBuYW1lIGZyb20gbmFtZVRvQWRkIGlmIHdlIGFyZVxuICAgICAgICAgICAgICAgIC8va2VlcGluZyBpdFxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5saW5rcywgZnVuY3Rpb24obCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9jaGVja2luZyBpZiB0aGVyZSBleGlzdHMgYSBsaW5rIHRvdWNoaW5nIGVhY2ggb2YgbmFtZVRvQWRkXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmFtZVRvQWRkLmluZGV4T2YobC5zb3VyY2UuaWQpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwc1swXSA9PT0gbC50YXJnZXQucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVUb0FkZC5zcGxpY2UobmFtZVRvQWRkLmluZGV4T2YobC5zb3VyY2UuaWQpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5hbWVUb0FkZC5pbmRleE9mKGwudGFyZ2V0LmlkKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHNbMF0gPT09IGwuc291cmNlLnBhcmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lVG9BZGQuc3BsaWNlKG5hbWVUb0FkZC5pbmRleE9mKGwudGFyZ2V0LmlkKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vV2Ugd2FudCB0byBrZWVwIHRoZW0gYWxsXG4gICAgICAgICAgICAgICAgICAgIC8vc2luY2UgYW55IGxlZnQgaW4gbmFtZVRvQWRkIHdpbGwgYmUgcmVtb3ZlZCxcbiAgICAgICAgICAgICAgICAgICAgLy93ZSByZXNldCBuYW1lVG9BZGQgaGVyZS5cbiAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkID0gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vd2hhdGV2ZXIgaXMgcmVtYWluaW5nIGluIG5hbWVUb0FkZCBpc24ndCBjb25uZWN0ZWRcbiAgICAgICAgICAgICAgICAvL3RvIHRoZSBmb2N1cyBncm91cCwgc28gd2Ugc2hvdWxkIHJlbW92ZSBpdC5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZVRvUmVtb3ZlID0gW107XG4gICAgICAgICAgICAgICAgaWYgKG5hbWVUb0FkZC5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuYW1lVG9BZGQuaW5kZXhPZih0aGlzR3JhcGgubm9kZXNbaV0uaWQpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVUb0FkZC5zcGxpY2UobmFtZVRvQWRkLmluZGV4T2YodGhpc0dyYXBoLm5vZGVzW2ldLmlkKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZSh0aGlzR3JhcGgubm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVUb1JlbW92ZS5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWVUb0FkZC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF8uZm9yRWFjaChub2RlVG9SZW1vdmUsIGZ1bmN0aW9uKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnNwbGljZSh0aGlzR3JhcGgubm9kZXMuaW5kZXhPZihuKSwgMSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXRMaW5rcygpO1xuXG4gICAgICAgICAgICAgICAgc3RhdGVTdXBlci5zcGxpdE5vZGVzLnNwbGljZShzdGF0ZVN1cGVyLnNwbGl0Tm9kZXMuaW5kZXhPZihuZXdOb2RlLmlkKSwgMSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3Tm9kZTsgXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIGFmdGVyIGEgc2luZ2xlIG5vZGUgaXMgam9pbmVkXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIElmIHRoZSBmb2N1cyBncm91cCBoYXMgYmVlbiBzZWVuIGJlZm9yZSwgaXQgd2lsbFxuICAgICAgICAgICAgICogbG9hZCB0aGF0IGxheW91dC4gT3RoZXJ3aXNlLCBpdCB3aWxsIHJ1biBhIGQzIGZvcmNlXG4gICAgICAgICAgICAgKiBzaW11bGF0aW9uIHRvIGdlbmVyYXRlIG9uZS5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5ld05vZGUgIFRoZSBuZXcgbm9kZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBqb2luTm9kZUV2ZW50KG5ld05vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeSA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICAvL2lmIHRoZSBsYXN0IGV2ZW50IGhhcyB0aGUgc2FtZSBpZCwgaXQgbXVzdCBiZSB0aGVcbiAgICAgICAgICAgICAgICAvL29wcHBvc2l0ZSBvZiB0aGlzIGV2ZW50LCBzbyB3ZSByZW1vdmUgdGhhdCBldmVudCBmcm9tXG4gICAgICAgICAgICAgICAgLy90aGUgZXZlbnQgc3RhY2suXG4gICAgICAgICAgICAgICAgLy9PdGhlcndpc2UsIHdlIGFkZCB0aGUgZXZlbnQgdG8gdGhlIHN0YWNrXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggIT09IDAgJiZcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5W3N0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggLSAxXS5pZCA9PT0gbmV3Tm9kZS5pZCkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkucG9wKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5LnB1c2goe2lkOm5ld05vZGUuaWQsIGV2ZW50Oidqb2luJ30pXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcblxuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV0sIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiZm9jdXNcIjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy9zZXR0aW5nIGJhY2sgYnV0dG9uXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmJhY2tCdXR0b25FbGVtICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmJhY2tCdXR0b25FbGVtLmZhZGVUbygnc2xvdycsIDApO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vc2V0dGluZyB0aXRsZVxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS50aXRsZUVsZW0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ICs9IHN0YXRlLmZvY3VzR3JvdXBzWzBdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0gJyAmICcgKyBzdGF0ZS5mb2N1c0dyb3Vwc1sxXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS50aXRsZUVsZW0udGV4dCh0ZXh0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpc1BvbGljeS5zZXRMYXlvdXQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVbmRvZXMgdGhlIGxhc3Qgc3BsaXQgb3Igam9pbiBldmVudC5cbiAgICAgICAgICAgICAqIE1lYW50IHRvIGJlIGNhbGxlZCBieSB0aGUgYmFjayBidXR0b24uXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHVuZG9MYXN0RXZlbnQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kgPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdmFyIGxhc3QgPSBzdGF0ZS5ldmVudEhpc3Rvcnlbc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgIHZhciBpZCA9IGxhc3QuaWQ7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGU7XG4gICAgICAgICAgICAgICAgaWYgKGxhc3QuZXZlbnQgPT09ICdqb2luJykge1xuICAgICAgICAgICAgICAgICAgICBub2RlID0gdGhpc0dyYXBoLmZpbmROb2RlQnlJZChpZCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkM25vZGUgPSB0aGlzR3JhcGguZmluZEQzTm9kZShpZCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kuZGJsY2xpY2soZDNub2RlLCBub2RlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZUlkID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0W2lkXVswXTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZSA9IHRoaXNHcmFwaC5maW5kTm9kZUJ5SWQobm9kZUlkKTtcbiAgICAgICAgICAgICAgICAgICAgc3VwZXIuam9pbk5vZGUuY2FsbCh0aGlzUG9saWN5LCBub2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgUG9saWN5OiBTcGxpdEpvaW5WaWV3UG9saWN5XG4gICAgICAgIH1cbn1dKTtcblxuXG5cblxuXG5cblxuIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmZhY3RvcnkoJ0JncFNlcnZpY2UnLCBbJyRodHRwJywgJyRxJywgZnVuY3Rpb24gKCRodHRwLCAkcSkge1xuICAgICAgICBmdW5jdGlvbiBnZXRCZ3AoY3RybCkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLkJHUFNfRU5EUE9JTlQgKyBjdHJsLmtleSArICcvJztcbiAgICAgICAgICAgICRodHRwLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgIGN0cmwubmVpZ2hib3IgPSByZXN1bHQuZGF0YTtcbiAgICAgICAgICAgICAgICBjdHJsLm5laWdoYm9ycy5wdXNoKHsgJ25hbWUnOiBjdHJsLm5laWdoYm9yWyduZWlnaGJvciddLCAndmFsdWUnOiBjdHJsLm5laWdoYm9yWyduZWlnaGJvci1hcyddIH0pO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVCZ3AoY3RybCkge1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuQkdQU19FTkRQT0lOVCArIGN0cmwua2V5ICsgJy8nO1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QodXJsLCBjdHJsLm5laWdoYm9yKTtcbiAgICAgICAgfVxuICAgICAgICA7XG4gICAgICAgIGZ1bmN0aW9uIGdldEJncEluc3BlY3Qoa2V5KSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuQkdQU19JTlNQRUNUX0VORFBPSU5UICsga2V5ICsgJy8nO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRCZ3A6IGdldEJncCxcbiAgICAgICAgICAgIHVwZGF0ZUJncDogdXBkYXRlQmdwLFxuICAgICAgICAgICAgZ2V0QmdwSW5zcGVjdDogZ2V0QmdwSW5zcGVjdFxuICAgICAgICB9O1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJncHNlcnZpY2UuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoXCJjb250aXYubm9kZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2TG9nc1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9sb2dzLmh0bWwnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgbG9nOiBcIj1cIixcbiAgICAgICAgICAgIHRpdGxlOiBcIkBcIlxuICAgICAgICB9XG4gICAgfTtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bG9nc2RpcmVjdGl2ZS5qcy5tYXAiLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJylcbiAgICAuZmFjdG9yeSgnTG9nU2VydmljZScsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbiAoJGh0dHAsICRxKSB7XG4gICAgICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUxvZ3MoKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuTk9ERVNfQUNUSVZFX0pPQl9FTkRQT0lOVDtcbiAgICAgICAgICAgICRodHRwLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnZXRMYXN0TG9ncygpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5OT0RFU19MQVNUX0pPQl9FTkRQT0lOVDtcbiAgICAgICAgICAgICRodHRwLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0QWN0aXZlTG9nczogZ2V0QWN0aXZlTG9ncyxcbiAgICAgICAgICAgIGdldExhc3RMb2dzOiBnZXRMYXN0TG9nc1xuICAgICAgICB9O1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxvZ3NlcnZpY2UuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmFjdGl2ZWxvZycsIHtcbiAgICAgICAgICAgIHVybDogJy9hY3RpdmVsb2cnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVBY3RpdmVKb2JMb2dzQ3RybCBhcyBub2RlQWN0aXZlSm9iTG9nc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8Y3R2LWxvZ3MgdGl0bGU9XCJBY3RpdmUgSm9iXCIgbG9nPVwibm9kZUFjdGl2ZUpvYkxvZ3NDdHJsLmFjdGl2ZUxvZ3NcIj48L2N0di1sb2dzPidcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVBY3RpdmVKb2JMb2dzQ3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICdMb2dTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsIExvZ1NlcnZpY2UpIHtcbiAgICAgICAgdmFyIG5vZGVBY3RpdmVKb2JMb2dzQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUxvZ3MoKSB7XG4gICAgICAgICAgICBMb2dTZXJ2aWNlLmdldEFjdGl2ZUxvZ3MoKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBub2RlQWN0aXZlSm9iTG9nc0N0cmwuYWN0aXZlTG9ncyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy9PbmNlIHRoZSBqb2IgZmluaXNoZXMsIGVuZHBvaW50IHJldHVybnMgNTAwIGVycm9yLiBTbyByZXNldCB0aGUgYWN0aXZlTG9nc1xuICAgICAgICAgICAgICAgIG5vZGVBY3RpdmVKb2JMb2dzQ3RybC5hY3RpdmVMb2dzID0ge1xuICAgICAgICAgICAgICAgICAgICBkZXNjOiAnVGhlcmUgaXMgY3VycmVudGx5IG5vIGFjdGl2ZSBqb2IuIENoZWNrIExhc3QgSm9iIGZvciBhIGpvYiB0aGF0IHJlY2VudGx5IGZpbmlzaGVkLidcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZ2V0QWN0aXZlTG9ncygpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0QWN0aXZlTG9ncygpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bm9kZWFjdGl2ZWpvYmxvZ3NjdHJsLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8yNS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmNvbW1pc3Npb24nLCB7XG4gICAgICAgICAgICB1cmw6ICcvY29tbWlzc2lvbi86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlQ29tbWlzc2lvbkN0cmwgYXMgbm9kZUNvbW1pc3Npb25DdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWNvbW1pc3Npb24uaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVDb21taXNzaW9uQ3RybCcsIFtcbiAgICAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdOb2Rlc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJywgJ05vZGVzU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBOb2Rlc01vZGVsLCBDUlVESGVscGVyU2VydmljZSwgTm9kZXNTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBub2RlQ29tbWlzc2lvbkN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub05vZGVEZXRhaWxzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLmluZm8nLCB7ICdrZXknOiAkc3RhdGVQYXJhbXMua2V5IH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbENvbW1pc3Npb25pbmdOb2RlKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9Ob2RlRGV0YWlscygpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNvbW1pc3Npb24oKSB7XG4gICAgICAgICAgICBpZiAobm9kZUNvbW1pc3Npb25DdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIobm9kZUNvbW1pc3Npb25DdHJsKTtcbiAgICAgICAgICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwubm9kZU9wc09iai5ub2RlcyA9IFskc3RhdGVQYXJhbXMua2V5XTtcbiAgICAgICAgICAgICAgICBOb2Rlc1NlcnZpY2UuY2xlYW51cEV4dHJhVmFycyhub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgICAgICAgICAgICAgIE5vZGVzU2VydmljZS5jcmVhdGVFeHRyYVZhcnMobm9kZUNvbW1pc3Npb25DdHJsKTtcbiAgICAgICAgICAgICAgICBOb2Rlc01vZGVsLmNvbW1pc3Npb24obm9kZUNvbW1pc3Npb25DdHJsLm5vZGVPcHNPYmopLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvTm9kZURldGFpbHMoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihub2RlQ29tbWlzc2lvbkN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLm5vZGVPcHNPYmogPSB7fTtcbiAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLmV4dHJhX3ZhcnMgPSB7fTsgLy9UT0RPIEludGlhbGl6ZSBmcm9tIGdsb2JhbCBzZXR0aW5nc1xuICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuYW5zaWJsZVZhcmlhYmxlcyA9IFtdO1xuICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuZW52VmFyaWFibGVzID0gW107XG4gICAgICAgIE5vZGVzU2VydmljZS5nZXRTZXR0aW5ncyhub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuY2FuY2VsQ29tbWlzc2lvbmluZ05vZGUgPSBjYW5jZWxDb21taXNzaW9uaW5nTm9kZTtcbiAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLmNvbW1pc3Npb24gPSBjb21taXNzaW9uO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVjb21taXNzaW9uY3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMjUvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZURldGFpbHNDdHJsIGFzIG5vZGVEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVkZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMuaW5mbycsIHtcbiAgICAgICAgICAgIHVybDogJy9pbmZvJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGV0YWlsc0N0cmwgYXMgbm9kZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWluZm8uaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMuZGV0YWlscy5zdGF0cycsIHtcbiAgICAgICAgICAgIHVybDogJy9zdGF0cycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZURldGFpbHNDdHJsIGFzIG5vZGVEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVzdGF0cy5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLmxvZ3MnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbG9ncycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZURldGFpbHNDdHJsIGFzIG5vZGVEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVsb2dzLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMuZWRpdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9lZGl0JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGV0YWlsc0N0cmwgYXMgbm9kZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWluZm8uaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVEZXRhaWxzQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICckc2NvcGUnLCAnJGludGVydmFsJywgJ05vZGVzTW9kZWwnLCAnQmdwU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCAkc2NvcGUsICRpbnRlcnZhbCwgTm9kZXNNb2RlbCwgQmdwU2VydmljZSkge1xuICAgICAgICB2YXIgbm9kZURldGFpbHNDdHJsID0gdGhpcztcbiAgICAgICAgbm9kZURldGFpbHNDdHJsLm51bWJlcnBhdHRlcm4gPSBDb250aXZHbG9iYWxzLk5VTUJFUl9SRUdFWDtcbiAgICAgICAgZnVuY3Rpb24gZGVjb21taXNzaW9uKCkge1xuICAgICAgICAgICAgdmFyIG5vZGVPcHNPYmogPSB7XG4gICAgICAgICAgICAgICAgbm9kZXM6IFskc3RhdGVQYXJhbXMua2V5XVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIE5vZGVzTW9kZWwuZGVjb21taXNzaW9uKG5vZGVPcHNPYmopLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vRGlzYWJsZSBhbGwgYnV0dG9ucyBpbml0aWFsbHkuIFBvbGwgd2lsbCBhc3NpZ24gdmFsdWVzIGFwcHJvcHJpYXRlbHkuXG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiB1cGdyYWRlKCkge1xuICAgICAgICAgICAgdmFyIG5vZGVPcHNPYmogPSB7XG4gICAgICAgICAgICAgICAgbm9kZXM6IFskc3RhdGVQYXJhbXMua2V5XVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIE5vZGVzTW9kZWwudXBncmFkZShub2RlT3BzT2JqKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAvL0Rpc2FibGUgYWxsIGJ1dHRvbnMgaW5pdGlhbGx5LiBQb2xsIHdpbGwgYXNzaWduIHZhbHVlcyBhcHByb3ByaWF0ZWx5LlxuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERpc3BsYXkgYnV0dG9ucyBiYXNlZCBvbiBzdGF0dXMgb2Ygbm9kZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gc2V0QnV0dG9uRGlzcGxheSgpIHtcbiAgICAgICAgICAgIHN3aXRjaCAobm9kZURldGFpbHNDdHJsLm5vZGVbJ2ludmVudG9yeV9zdGF0ZSddLnN0YXR1cykge1xuICAgICAgICAgICAgICAgIGNhc2UgJ1VuYWxsb2NhdGVkJzpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0RlY29tbWlzc2lvbmVkJzpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ1Byb3Zpc2lvbmluZyc6XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnQWxsb2NhdGVkJzpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0NhbmNlbGxlZCc6XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ01haW50ZW5hbmNlJzpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdldE5vZGVJbmZvKHJlbG9hZCkge1xuICAgICAgICAgICAgTm9kZXNNb2RlbC5nZXRNb2RlbEJ5S2V5KCRzdGF0ZVBhcmFtcy5rZXksIHJlbG9hZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5ub2RlID0gbm9kZTtcbiAgICAgICAgICAgICAgICBzZXRCdXR0b25EaXNwbGF5KCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBzZXRNb2RlKCkge1xuICAgICAgICAgICAgaWYgKCRzdGF0ZS5pcygnY29udGl2Lm1lbnUubm9kZXMuZGV0YWlscy5lZGl0JykpIHtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubW9kZSA9ICdlZGl0JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5tb2RlID0gJ2RldGFpbHMnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvSW5mbygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubm9kZXMuZGV0YWlscy5pbmZvJyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlQmdwSW5mbygpIHtcbiAgICAgICAgICAgIGlmIChub2RlRGV0YWlsc0N0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3Iua2V5ID0gJHN0YXRlUGFyYW1zLmtleTtcbiAgICAgICAgICAgICAgICAvLyBiYWNrZW5kIG9ubHkgc3VwcG9ydHMgYWRkaW5nIG9uZSBuZWlnaGJvciBjdXJyZW50bHlcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3JzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm5laWdoYm9yWyduZWlnaGJvciddID0gaXRlbS5uYW1lO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3JbJ25laWdoYm9yLWFzJ10gPSBpdGVtLnZhbHVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIEJncFNlcnZpY2UudXBkYXRlQmdwKG5vZGVEZXRhaWxzQ3RybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvciA9IHJlc3VsdC5jb25maWcuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9JbmZvKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnZXRCZ3BJbmZvKCkge1xuICAgICAgICAgICAgQmdwU2VydmljZS5nZXRCZ3Aobm9kZURldGFpbHNDdHJsKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3IgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0QmdwSW5zcGVjdCgpIHtcbiAgICAgICAgICAgIEJncFNlcnZpY2UuZ2V0QmdwSW5zcGVjdCgkc3RhdGVQYXJhbXMua2V5KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuaW5zcGVjdCA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwucm91dGVzID0gcmVzdWx0Lk9wZXIucm91dGVzO1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5maWx0ZXJlZHJvdXRlcyA9IHJlc3VsdC5PcGVyLnJvdXRlcztcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBub2RlRGV0YWlsc0N0cmwuZGVjb21taXNzaW9uID0gZGVjb21taXNzaW9uO1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZSA9IHVwZ3JhZGU7XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zZXRNb2RlID0gc2V0TW9kZTtcbiAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZGF0ZUJncEluZm8gPSB1cGRhdGVCZ3BJbmZvO1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwucmV0dXJuVG9JbmZvID0gcmV0dXJuVG9JbmZvO1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3JzID0gW107XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvciA9IHt9O1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwua2V5ID0gJHN0YXRlUGFyYW1zLmtleTtcbiAgICAgICAgZ2V0QmdwSW5mbygpO1xuICAgICAgICBnZXRCZ3BJbnNwZWN0KCk7XG4gICAgICAgIHNldE1vZGUoKTtcbiAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgIGdldE5vZGVJbmZvKGZhbHNlKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldE5vZGVJbmZvKHRydWUpO1xuICAgICAgICAgICAgfSwgNTAwMCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVkZXRhaWxzY3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDYvMTQvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2Lm5vZGVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dk5vZGVzdGF0dXNcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBub2RlOiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2Rlc3RhdHVzLmh0bWwnXG4gICAgfTtcbn0pXG4gICAgLmRpcmVjdGl2ZShcImN0dk5vZGVzdGF0ZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIG5vZGU6ICc9J1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVzdGF0ZS5odG1sJ1xuICAgIH07XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVkaXJlY3RpdmUuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRpc2NvdmVyJywge1xuICAgICAgICAgICAgdXJsOiAnL2Rpc2NvdmVyJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGlzY292ZXJDdHJsIGFzIG5vZGVEaXNjb3ZlckN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2RlZGlzY292ZXIuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVEaXNjb3ZlckN0cmwnLCBbXG4gICAgJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnTm9kZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsICdOb2Rlc1NlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgTm9kZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UsIE5vZGVzU2VydmljZSkge1xuICAgICAgICB2YXIgbm9kZURpc2NvdmVyQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvTm9kZXMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5vZGVzLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxEaXNjb3ZlcmluZ05vZGUoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub05vZGVzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZGlzY292ZXIoKSB7XG4gICAgICAgICAgICBpZiAobm9kZURpc2NvdmVyQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihub2RlRGlzY292ZXJDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihub2RlRGlzY292ZXJDdHJsKTtcbiAgICAgICAgICAgICAgICBjcmVhdGVJUEFkZHJBcnJheSgpO1xuICAgICAgICAgICAgICAgIE5vZGVzU2VydmljZS5jcmVhdGVFeHRyYVZhcnMobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgICAgICAgICAgICAgTm9kZXNNb2RlbC5kaXNjb3Zlcihub2RlRGlzY292ZXJDdHJsLm5vZGVPcHNPYmopLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub05vZGVzKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihub2RlRGlzY292ZXJDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKG5vZGVEaXNjb3ZlckN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlSVBBZGRyQXJyYXkoKSB7XG4gICAgICAgICAgICBub2RlRGlzY292ZXJDdHJsLm5vZGVPcHNPYmouYWRkcnMgPSBfLndvcmRzKG5vZGVEaXNjb3ZlckN0cmwubm9kZUlQQWRkciwgL1teLCBdKy9nKTtcbiAgICAgICAgfVxuICAgICAgICBub2RlRGlzY292ZXJDdHJsLm5vZGVPcHNPYmogPSB7fTtcbiAgICAgICAgbm9kZURpc2NvdmVyQ3RybC5leHRyYV92YXJzID0ge307IC8vVE9ETyBJbnRpYWxpemUgZnJvbSBnbG9iYWwgc2V0dGluZ3NcbiAgICAgICAgbm9kZURpc2NvdmVyQ3RybC5hbnNpYmxlVmFyaWFibGVzID0gW107XG4gICAgICAgIG5vZGVEaXNjb3ZlckN0cmwuZW52VmFyaWFibGVzID0gW107XG4gICAgICAgIG5vZGVEaXNjb3ZlckN0cmwubm9kZUlQQWRkciA9ICcnOyAvL0lQIGFkZHJlc3Mgb2Ygbm9kZXMgdG8gZGlzY292ZXJcbiAgICAgICAgTm9kZXNTZXJ2aWNlLmdldFNldHRpbmdzKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICBub2RlRGlzY292ZXJDdHJsLmRpc2NvdmVyID0gZGlzY292ZXI7XG4gICAgICAgIG5vZGVEaXNjb3ZlckN0cmwuY2FuY2VsRGlzY292ZXJpbmdOb2RlID0gY2FuY2VsRGlzY292ZXJpbmdOb2RlO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bm9kZWRpc2NvdmVyY3RybC5qcy5tYXAiLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMubGFzdGxvZycsIHtcbiAgICAgICAgICAgIHVybDogJy9sYXN0bG9nJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlTGFzdEpvYkxvZ3NDdHJsIGFzIG5vZGVMYXN0Sm9iTG9nc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8Y3R2LWxvZ3MgdGl0bGU9XCJMYXN0IEpvYlwiIGxvZz1cIm5vZGVMYXN0Sm9iTG9nc0N0cmwubGFzdExvZ3NcIj48L2N0di1sb2dzPidcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVMYXN0Sm9iTG9nc0N0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnTG9nU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzY29wZSwgJGludGVydmFsLCBMb2dTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBub2RlTGFzdEpvYkxvZ3NDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gZ2V0TGFzdExvZ3MoKSB7XG4gICAgICAgICAgICBMb2dTZXJ2aWNlLmdldExhc3RMb2dzKCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgbm9kZUxhc3RKb2JMb2dzQ3RybC5sYXN0TG9ncyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBnZXRMYXN0TG9ncygpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0TGFzdExvZ3MoKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVsYXN0am9ibG9nc2N0cmwuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzIyLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlTGlzdEN0cmwgYXMgbm9kZUxpc3RDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWxpc3QuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVMaXN0Q3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ05vZGVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgTm9kZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIG5vZGVMaXN0Q3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGdldE5vZGVzKHJlbG9hZCkge1xuICAgICAgICAgICAgTm9kZXNNb2RlbC5nZXQocmVsb2FkKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgbm9kZUxpc3RDdHJsLm5vZGVzID0gcmVzdWx0O1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVMaXN0Q3RybCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgZ2V0Tm9kZXMoZmFsc2UpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0Tm9kZXModHJ1ZSk7XG4gICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1ub2RlbGlzdGN0cmwuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5vcmdhbml6YXRpb25zJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5jcmVhdGUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnb3JnYW5pemF0aW9ucy9vcmdhbml6YXRpb25jcmVhdGUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnT3JnYW5pemF0aW9uQ3JlYXRlQ3RybCBhcyBvcmdhbml6YXRpb25DcmVhdGVDdHJsJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignT3JnYW5pemF0aW9uQ3JlYXRlQ3RybCcsIFsnJHN0YXRlJywgJ09yZ2FuaXphdGlvbnNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgT3JnYW5pemF0aW9uc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvT3JnYW5pemF0aW9ucygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub09yZ2FuaXphdGlvbnMoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVPcmdhbml6YXRpb24oKSB7XG4gICAgICAgICAgICAvL2Zvcm0gY29udHJvbGxlciBpcyBpbmplY3RlZCBieSB0aGUgaHRtbCB0ZW1wbGF0ZVxuICAgICAgICAgICAgLy9jaGVja2luZyBpZiBhbGwgdmFsaWRhdGlvbnMgaGF2ZSBwYXNzZWRcbiAgICAgICAgICAgIGlmIChvcmdhbml6YXRpb25DcmVhdGVDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwubmV3T3JnYW5pemF0aW9uLmtleSA9IG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwubmV3T3JnYW5pemF0aW9uLnRlbmFudE5hbWU7XG4gICAgICAgICAgICAgICAgT3JnYW5pemF0aW9uc01vZGVsLmNyZWF0ZShvcmdhbml6YXRpb25DcmVhdGVDdHJsLm5ld09yZ2FuaXphdGlvbikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvT3JnYW5pemF0aW9ucygpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25DcmVhdGVDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJlc2V0Rm9ybSgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBvcmdhbml6YXRpb25DcmVhdGVDdHJsLm5ld09yZ2FuaXphdGlvbiA9IHtcbiAgICAgICAgICAgICAgICB0ZW5hbnROYW1lOiAnJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBvcmdhbml6YXRpb25DcmVhdGVDdHJsLmNyZWF0ZU9yZ2FuaXphdGlvbiA9IGNyZWF0ZU9yZ2FuaXphdGlvbjtcbiAgICAgICAgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybC5jYW5jZWxDcmVhdGluZyA9IGNhbmNlbENyZWF0aW5nO1xuICAgICAgICByZXNldEZvcm0oKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1vcmdhbml6YXRpb25jcmVhdGVjdHJsLmpzLm1hcCIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYub3JnYW5pemF0aW9ucycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ09yZ2FuaXphdGlvbkRldGFpbHNDdHJsIGFzIG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnb3JnYW5pemF0aW9ucy9vcmdhbml6YXRpb25kZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdPcmdhbml6YXRpb25EZXRhaWxzQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdPcmdhbml6YXRpb25zTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgT3JnYW5pemF0aW9uc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgb3JnYW5pemF0aW9uRGV0YWlsc0N0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub09yZ2FuaXphdGlvbnMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMubGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGRlbGV0ZU9yZ2FuaXphdGlvbigpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBPcmdhbml6YXRpb25zTW9kZWwuZGVsZXRlKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsLm9yZ2FuaXphdGlvbikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9Pcmdhbml6YXRpb25zKCk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICBPcmdhbml6YXRpb25zTW9kZWwuZ2V0TW9kZWxCeUtleSgkc3RhdGVQYXJhbXMua2V5KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKG9yZ2FuaXphdGlvbikge1xuICAgICAgICAgICAgb3JnYW5pemF0aW9uRGV0YWlsc0N0cmwub3JnYW5pemF0aW9uID0gb3JnYW5pemF0aW9uO1xuICAgICAgICB9KTtcbiAgICAgICAgb3JnYW5pemF0aW9uRGV0YWlsc0N0cmwuZGVsZXRlT3JnYW5pemF0aW9uID0gZGVsZXRlT3JnYW5pemF0aW9uO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW9yZ2FuaXphdGlvbmRldGFpbHNjdHJsLmpzLm1hcCIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYuc2V0dGluZ3MnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLmNsdXN0ZXInLCB7XG4gICAgICAgICAgICB1cmw6ICcvY2x1c3RlcicsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQ2x1c3RlclNldHRpbmdDdHJsIGFzIGNsdXN0ZXJTZXR0aW5nQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NldHRpbmdzL2NsdXN0ZXJzZXR0aW5ncy5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignQ2x1c3RlclNldHRpbmdDdHJsJywgWyckc3RhdGVQYXJhbXMnLCAnQ1JVREhlbHBlclNlcnZpY2UnLCAnTm9kZXNTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlUGFyYW1zLCBDUlVESGVscGVyU2VydmljZSwgTm9kZXNTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBjbHVzdGVyU2V0dGluZ0N0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiB1cGRhdGVDbHVzdGVyU2V0dGluZ3MoKSB7XG4gICAgICAgICAgICBpZiAoY2x1c3RlclNldHRpbmdDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGNsdXN0ZXJTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoY2x1c3RlclNldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICBjbHVzdGVyU2V0dGluZ0N0cmwubm9kZU9wc09iai5ub2RlcyA9IFskc3RhdGVQYXJhbXMua2V5XTtcbiAgICAgICAgICAgICAgICBOb2Rlc1NlcnZpY2UuY2xlYW51cEV4dHJhVmFycyhjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgIE5vZGVzU2VydmljZS5jcmVhdGVFeHRyYVZhcnMoY2x1c3RlclNldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICBOb2Rlc1NlcnZpY2UudXBkYXRlU2V0dGluZ3MoY2x1c3RlclNldHRpbmdDdHJsLm5vZGVPcHNPYmopLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGNsdXN0ZXJTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoY2x1c3RlclNldHRpbmdDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNsdXN0ZXJTZXR0aW5nQ3RybC5ub2RlT3BzT2JqID0ge307XG4gICAgICAgIGNsdXN0ZXJTZXR0aW5nQ3RybC5leHRyYV92YXJzID0ge307IC8vVE9ETyBJbnRpYWxpemUgZnJvbSBnbG9iYWwgc2V0dGluZ3NcbiAgICAgICAgY2x1c3RlclNldHRpbmdDdHJsLmFuc2libGVWYXJpYWJsZXMgPSBbXTtcbiAgICAgICAgY2x1c3RlclNldHRpbmdDdHJsLmVudlZhcmlhYmxlcyA9IFtdO1xuICAgICAgICBOb2Rlc1NlcnZpY2UuZ2V0U2V0dGluZ3MoY2x1c3RlclNldHRpbmdDdHJsKTtcbiAgICAgICAgY2x1c3RlclNldHRpbmdDdHJsLnVwZGF0ZUNsdXN0ZXJTZXR0aW5ncyA9IHVwZGF0ZUNsdXN0ZXJTZXR0aW5ncztcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoY2x1c3RlclNldHRpbmdDdHJsKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jbHVzdGVyc2V0dGluZ2N0cmwuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzEyLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnNlcnZpY2VsYnMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXJ2aWNlX2xicy9zZXJ2aWNlbGJjcmVhdGUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU2VydmljZWxiQ3JlYXRlQ3RybCBhcyBzZXJ2aWNlbGJDcmVhdGVDdHJsJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignU2VydmljZWxiQ3JlYXRlQ3RybCcsIFtcbiAgICAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdTZXJ2aWNlbGJzTW9kZWwnLCAnTmV0d29ya3NNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBTZXJ2aWNlbGJzTW9kZWwsIE5ldHdvcmtzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlbGJDcmVhdGVDdHJsID0gdGhpcztcbiAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5sYWJlbFNlbGVjdG9ycyA9IFtdO1xuICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLm5ldHdvcmtzID0gW107XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvU2VydmljZWxicygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuc2VydmljZWxicy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub1NlcnZpY2VsYnMoKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IG5ldHdvcmtzIGZvciB0aGUgZ2l2ZW4gdGVuYW50LlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gZ2V0TmV0d29ya3MoKSB7XG4gICAgICAgICAgICBOZXR3b3Jrc01vZGVsLmdldCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHNlcnZpY2VsYkNyZWF0ZUN0cmwubmV0d29ya3MgPSBfLmZpbHRlcihyZXN1bHQsIHtcbiAgICAgICAgICAgICAgICAgICAgJ3RlbmFudE5hbWUnOiAnZGVmYXVsdCcgLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUxhYmVsU2VsZWN0b3JTdHJpbmdzKCkge1xuICAgICAgICAgICAgLy9FbXB0eSBvdXQgdGhlIHNlbGVjdG9ycy4gSW4gY2FzZSBvZiBzZXJ2ZXIgZXJyb3JzIHRoaXMgbmVlZHMgdG8gYmUgcmVzZXQuXG4gICAgICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLnNlcnZpY2VsYi5zZWxlY3RvcnMgPSBbXTtcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChzZXJ2aWNlbGJDcmVhdGVDdHJsLmxhYmVsU2VsZWN0b3JzLCBmdW5jdGlvbiAobGFiZWxTZWxlY3Rvcikge1xuICAgICAgICAgICAgICAgIHZhciBzZWxlY3RvclN0cmluZyA9IGxhYmVsU2VsZWN0b3IubmFtZSArICc9JyArIGxhYmVsU2VsZWN0b3IudmFsdWU7XG4gICAgICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIuc2VsZWN0b3JzLnB1c2goc2VsZWN0b3JTdHJpbmcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlU2VydmljZWxiKCkge1xuICAgICAgICAgICAgY3JlYXRlTGFiZWxTZWxlY3RvclN0cmluZ3MoKTtcbiAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgaWYgKHNlcnZpY2VsYkNyZWF0ZUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc2VydmljZWxiQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoc2VydmljZWxiQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIua2V5ID1cbiAgICAgICAgICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIudGVuYW50TmFtZSArICc6JyArIHNlcnZpY2VsYkNyZWF0ZUN0cmwuc2VydmljZWxiLnNlcnZpY2VOYW1lO1xuICAgICAgICAgICAgICAgIFNlcnZpY2VsYnNNb2RlbC5jcmVhdGUoc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1NlcnZpY2VsYnMoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Ioc2VydmljZWxiQ3JlYXRlQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXNldEZvcm0oKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHNlcnZpY2VsYkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIgPSB7XG4gICAgICAgICAgICAgICAgc2VydmljZU5hbWU6ICcnLFxuICAgICAgICAgICAgICAgIG5ldHdvcmtOYW1lOiAnJyxcbiAgICAgICAgICAgICAgICBpcEFkZHJlc3M6ICcnLFxuICAgICAgICAgICAgICAgIHNlbGVjdG9yczogW10sXG4gICAgICAgICAgICAgICAgcG9ydHM6IFtdLFxuICAgICAgICAgICAgICAgIHRlbmFudE5hbWU6ICdkZWZhdWx0JyAvL1RPRE86IFJlbW92ZSBoYXJkY29kZWQgdGVuYW50LlxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLmNyZWF0ZVNlcnZpY2VsYiA9IGNyZWF0ZVNlcnZpY2VsYjtcbiAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5jYW5jZWxDcmVhdGluZyA9IGNhbmNlbENyZWF0aW5nO1xuICAgICAgICBnZXROZXR3b3JrcygpO1xuICAgICAgICByZXNldEZvcm0oKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zZXJ2aWNlbGJjcmVhdGVjdHJsLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xMS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zZXJ2aWNlbGJzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2VydmljZWxicy5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBwYXJhbXM6IHsgc3RhdGU6IG51bGwgfSxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTZXJ2aWNlbGJEZXRhaWxzQ3RybCBhcyBzZXJ2aWNlbGJEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NlcnZpY2VfbGJzL3NlcnZpY2VsYmRldGFpbHMuaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2VydmljZWxicy5kZXRhaWxzLmluZm8nLCB7XG4gICAgICAgICAgICB1cmw6ICcvaW5mbycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU2VydmljZWxiRGV0YWlsc0N0cmwgYXMgc2VydmljZWxiRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXJ2aWNlX2xicy9zZXJ2aWNlbGJpbmZvLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMuZGV0YWlscy5lZGl0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2VkaXQvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU2VydmljZWxiRGV0YWlsc0N0cmwgYXMgc2VydmljZWxiRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXJ2aWNlX2xicy9zZXJ2aWNlbGJpbmZvLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdTZXJ2aWNlbGJEZXRhaWxzQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdTZXJ2aWNlbGJzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgU2VydmljZWxic01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgc2VydmljZWxiRGV0YWlsc0N0cmwgPSB0aGlzO1xuICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5sYWJlbFNlbGVjdG9ycyA9IFtdO1xuICAgICAgICAvKipcbiAgICAgICAgICogVG8gc2hvdyBlZGl0IG9yIGRldGFpbHMgc2NyZWVuIGJhc2VkIG9uIHRoZSByb3V0ZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gc2V0TW9kZSgpIHtcbiAgICAgICAgICAgIGlmICgkc3RhdGUuaXMoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMuZGV0YWlscy5lZGl0JykpIHtcbiAgICAgICAgICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5tb2RlID0gJ2VkaXQnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwubW9kZSA9ICdkZXRhaWxzJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1NlcnZpY2VsYnMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMubGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvU2VydmljZWxiRGV0YWlscygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuc2VydmljZWxicy5kZXRhaWxzLmluZm8nLCB7ICdrZXknOiBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIua2V5LCAnc3RhdGUnOiAnZGV0YWlscycgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsRWRpdGluZygpIHtcbiAgICAgICAgICAgIHJldHVyblRvU2VydmljZWxiRGV0YWlscygpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGRlbGV0ZVNlcnZpY2VsYigpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBTZXJ2aWNlbGJzTW9kZWwuZGVsZXRlKHNlcnZpY2VsYkRldGFpbHNDdHJsLnNlcnZpY2VsYikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9TZXJ2aWNlbGJzKCk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHNhdmVTZXJ2aWNlbGIoKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgdmFyIGV4aXN0aW5nTGFiZWxzID0gc2VydmljZWxiRGV0YWlsc0N0cmwuc2VydmljZWxiLnNlbGVjdG9ycztcbiAgICAgICAgICAgIGNyZWF0ZUxhYmVsU2VsZWN0b3JTdHJpbmdzKCk7XG4gICAgICAgICAgICBTZXJ2aWNlbGJzTW9kZWwuc2F2ZShzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIHJldHVyblRvU2VydmljZWxiRGV0YWlscygpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIuc2VsZWN0b3JzID0gZXhpc3RpbmdMYWJlbHM7XG4gICAgICAgICAgICAgICAgY3JlYXRlTGFiZWxTZWxlY3RvcnMoKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Ioc2VydmljZWxiRGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVMYWJlbFNlbGVjdG9ycygpIHtcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIuc2VsZWN0b3JzLCBmdW5jdGlvbiAoc2VsZWN0b3JTdHIpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2VsZWN0b3IgPSB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHNlbGVjdG9yU3RyLnNwbGl0KCc9JylbMF0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBzZWxlY3RvclN0ci5zcGxpdCgnPScpWzFdXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5sYWJlbFNlbGVjdG9ycy5wdXNoKHNlbGVjdG9yKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUxhYmVsU2VsZWN0b3JTdHJpbmdzKCkge1xuICAgICAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwuc2VydmljZWxiLnNlbGVjdG9ycyA9IFtdO1xuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHNlcnZpY2VsYkRldGFpbHNDdHJsLmxhYmVsU2VsZWN0b3JzLCBmdW5jdGlvbiAobGFiZWxTZWxlY3Rvcikge1xuICAgICAgICAgICAgICAgIHZhciBzZWxlY3RvclN0cmluZyA9IGxhYmVsU2VsZWN0b3IubmFtZSArICc9JyArIGxhYmVsU2VsZWN0b3IudmFsdWU7XG4gICAgICAgICAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwuc2VydmljZWxiLnNlbGVjdG9ycy5wdXNoKHNlbGVjdG9yU3RyaW5nKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICBTZXJ2aWNlbGJzTW9kZWwuZ2V0TW9kZWxCeUtleSgkc3RhdGVQYXJhbXMua2V5KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHNlcnZpY2VsYikge1xuICAgICAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwuc2VydmljZWxiID0gc2VydmljZWxiO1xuICAgICAgICAgICAgY3JlYXRlTGFiZWxTZWxlY3RvcnMoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHNlcnZpY2VsYkRldGFpbHNDdHJsLnNhdmVTZXJ2aWNlbGIgPSBzYXZlU2VydmljZWxiO1xuICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5jYW5jZWxFZGl0aW5nID0gY2FuY2VsRWRpdGluZztcbiAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwuZGVsZXRlU2VydmljZWxiID0gZGVsZXRlU2VydmljZWxiO1xuICAgICAgICBzZXRNb2RlKCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c2VydmljZWxiZGV0YWlsc2N0cmwuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzEzLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5zZXJ2aWNlbGJzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dlNlcnZpY2VsYnBvcnRzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgaXRlbXM6ICc9J1xuICAgICAgICB9LFxuICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUpIHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ29tcGFyZSBpZiB0d28gaXRlbXMgaGF2ZSBzYW1lIHBvcnRzIGFuZCBwcm90b2NvbHNcbiAgICAgICAgICAgICAqIEBwYXJhbSB2YWwxXG4gICAgICAgICAgICAgKiBAcGFyYW0gdmFsMlxuICAgICAgICAgICAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNvbXBhcmUodmFsMSwgdmFsMikge1xuICAgICAgICAgICAgICAgIHJldHVybiAodmFsMSA9PT0gdmFsMik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmdW5jdGlvbiByZXNldE5ld0l0ZW0oKSB7XG4gICAgICAgICAgICAgICAgc2NvcGUubmV3SXRlbSA9IHtcbiAgICAgICAgICAgICAgICAgICAgc2VydmljZVBvcnQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICBwcm92aWRlclBvcnQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICBwcm90b2NvbDogJydcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZnVuY3Rpb24gaXNFbXB0eUl0ZW0oaXRlbSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAoaXRlbS5zZXJ2aWNlUG9ydCA9PT0gJycgJiYgaXRlbS5wcm92aWRlclBvcnQgPT09ICcnICYmIGl0ZW0ucHJvdG9jb2wgPT09ICcnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNjb3BlLmFkZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoaXNFbXB0eUl0ZW0oc2NvcGUubmV3SXRlbSkpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICBpZiAoc2NvcGUuaXRlbXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzY29wZS5pdGVtcyA9IFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgbmV3SXRlbVN0ciA9IHNjb3BlLm5ld0l0ZW0uc2VydmljZVBvcnQgKyAnOidcbiAgICAgICAgICAgICAgICAgICAgKyBzY29wZS5uZXdJdGVtLnByb3ZpZGVyUG9ydCArICc6J1xuICAgICAgICAgICAgICAgICAgICArIHNjb3BlLm5ld0l0ZW0ucHJvdG9jb2w7XG4gICAgICAgICAgICAgICAgLy9SZW1vdmVzIGV4aXN0aW5nIGl0ZW0gd2l0aCB0aGUgc2FtZSB2YWx1ZSBmaXJzdCBpZiBpdCBleGlzdHMuXG4gICAgICAgICAgICAgICAgXy5wdWxsQWxsV2l0aChzY29wZS5pdGVtcywgW25ld0l0ZW1TdHJdLCBjb21wYXJlKTtcbiAgICAgICAgICAgICAgICBzY29wZS5pdGVtcy5wdXNoKG5ld0l0ZW1TdHIpO1xuICAgICAgICAgICAgICAgIHJlc2V0TmV3SXRlbSgpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHNjb3BlLnJlbW92ZSA9IGZ1bmN0aW9uIChwYXNzZWRJdGVtKSB7XG4gICAgICAgICAgICAgICAgXy5yZW1vdmUoc2NvcGUuaXRlbXMsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb21wYXJlKGl0ZW0sIHBhc3NlZEl0ZW0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJlc2V0TmV3SXRlbSgpO1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3NlcnZpY2VfbGJzL3NlcnZpY2VsYnBvcnRzLmh0bWwnXG4gICAgfTtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c2VydmljZWxicG9ydHNkaXJlY3RpdmUuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA2LzEvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc3RvcmFnZXBvbGljaWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL3N0b3JhZ2Vwb2xpY3ljcmVhdGUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwgYXMgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdTdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdTdG9yYWdlUG9saWNpZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBTdG9yYWdlUG9saWNpZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9TdG9yYWdlUG9saWNpZXMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub1N0b3JhZ2VQb2xpY2llcygpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUZpbGVzeXN0ZW1DbWRzKCkge1xuICAgICAgICAgICAgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwuZmlsZXN5c3RlbWNtZHMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLm5ld1N0b3JhZ2VQb2xpY3kuZmlsZXN5c3RlbXNbaXRlbS5uYW1lXSA9IGl0ZW0udmFsdWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVQb2xpY3koKSB7XG4gICAgICAgICAgICAvL2Zvcm0gY29udHJvbGxlciBpcyBpbmplY3RlZCBieSB0aGUgaHRtbCB0ZW1wbGF0ZVxuICAgICAgICAgICAgLy9jaGVja2luZyBpZiBhbGwgdmFsaWRhdGlvbnMgaGF2ZSBwYXNzZWRcbiAgICAgICAgICAgIGlmIChzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIGNyZWF0ZUZpbGVzeXN0ZW1DbWRzKCk7XG4gICAgICAgICAgICAgICAgU3RvcmFnZVBvbGljaWVzTW9kZWwuY3JlYXRlKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLm5ld1N0b3JhZ2VQb2xpY3kpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvU3RvcmFnZVBvbGljaWVzKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXNldEZvcm0oKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5uZXdTdG9yYWdlUG9saWN5ID0ge1xuICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgIFwiYmFja2VuZHNcIjoge1xuICAgICAgICAgICAgICAgICAgICBcImNydWRcIjogXCJjZXBoXCIsXG4gICAgICAgICAgICAgICAgICAgIFwibW91bnRcIjogXCJjZXBoXCIsXG4gICAgICAgICAgICAgICAgICAgIFwic25hcHNob3RcIjogXCJjZXBoXCJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFwidW5sb2NrZWRcIjogZmFsc2UsXG4gICAgICAgICAgICAgICAgXCJkcml2ZXJcIjoge1xuICAgICAgICAgICAgICAgICAgICBcInBvb2xcIjogXCJyYmRcIlxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXCJjcmVhdGVcIjoge1xuICAgICAgICAgICAgICAgICAgICBcInNpemVcIjogXCIwXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiZmlsZXN5c3RlbVwiOiBcIlwiXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBcInJ1bnRpbWVcIjoge1xuICAgICAgICAgICAgICAgICAgICBcInNuYXBzaG90c1wiOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBcInNuYXBzaG90XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZnJlcXVlbmN5XCI6IFwiMzBtXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImtlZXBcIjogMjBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXCJyYXRlLWxpbWl0XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwid3JpdGUtaW9wc1wiOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWFkLWlvcHNcIjogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwid3JpdGUtYnBzXCI6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJlYWQtYnBzXCI6IDBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXCJmaWxlc3lzdGVtc1wiOiB7fVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5jcmVhdGVQb2xpY3kgPSBjcmVhdGVQb2xpY3k7XG4gICAgICAgIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLmNhbmNlbENyZWF0aW5nID0gY2FuY2VsQ3JlYXRpbmc7XG4gICAgICAgIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLmZpbGVzeXN0ZW1jbWRzID0gW107XG4gICAgICAgIHJlc2V0Rm9ybSgpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXN0b3JhZ2Vwb2xpY3ljcmVhdGVjdHJsLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8yNy8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zdG9yYWdlcG9saWNpZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1N0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCBhcyBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL3N0b3JhZ2Vwb2xpY3lkZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5lZGl0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU3RvcmFnZVBvbGljeURldGFpbHNDdHJsIGFzIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvc3RvcmFnZXBvbGljeWRldGFpbHMuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1N0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnU3RvcmFnZVBvbGljaWVzTW9kZWwnLCAnVm9sdW1lc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBTdG9yYWdlUG9saWNpZXNNb2RlbCwgVm9sdW1lc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsID0gdGhpcztcbiAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmZpbGVzeXN0ZW1jbWRzID0gW107XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUbyBzaG93IGVkaXQgb3IgZGV0YWlscyBzY3JlZW4gYmFzZWQgb24gdGhlIHJvdXRlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBzZXRNb2RlKCkge1xuICAgICAgICAgICAgaWYgKCRzdGF0ZS5pcygnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmVkaXQnKSkge1xuICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5tb2RlID0gJ2VkaXQnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLm1vZGUgPSAnZGV0YWlscyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Qb2xpY2llcygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1BvbGljeURldGFpbHMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5kZXRhaWxzJywgeyAna2V5Jzogc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnBvbGljeS5uYW1lIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbEVkaXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub1BvbGljeURldGFpbHMoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBkZWxldGVQb2xpY3koKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbC5kZWxldGVVc2luZ0tleShzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5Lm5hbWUsICduYW1lJykudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIHJldHVyblRvUG9saWNpZXMoKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IHZvbHVtZXMgYmVsb25naW5nIHRvIGEgcG9saWN5XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBnZXRWb2x1bWVzKHJlbG9hZCkge1xuICAgICAgICAgICAgVm9sdW1lc01vZGVsLmdldChyZWxvYWQpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC52b2x1bWVzID0gJGZpbHRlcignb3JkZXJCeScpKF8uZmlsdGVyKHJlc3VsdCwge1xuICAgICAgICAgICAgICAgICAgICAncG9saWN5Jzogc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnBvbGljeS5uYW1lXG4gICAgICAgICAgICAgICAgfSksICduYW1lJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBpbml0aWFsaXplRmlsZXN5c3RlbUNtZHNBcnJheSgpIHtcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5LmZpbGVzeXN0ZW1zLCBmdW5jdGlvbiAodmFsdWUsIGtleSkge1xuICAgICAgICAgICAgICAgIHRoaXMucHVzaCh7IG5hbWU6IGtleSwgdmFsdWU6IHZhbHVlIH0pO1xuICAgICAgICAgICAgfSwgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmZpbGVzeXN0ZW1jbWRzKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVGaWxlc3lzdGVtQ21kcygpIHtcbiAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5maWxlc3lzdGVtY21kcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnBvbGljeS5maWxlc3lzdGVtc1tpdGVtLm5hbWVdID0gaXRlbS52YWx1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHNhdmVQb2xpY3koKSB7XG4gICAgICAgICAgICAvL2Zvcm0gY29udHJvbGxlciBpcyBpbmplY3RlZCBieSB0aGUgaHRtbCB0ZW1wbGF0ZVxuICAgICAgICAgICAgLy9jaGVja2luZyBpZiBhbGwgdmFsaWRhdGlvbnMgaGF2ZSBwYXNzZWRcbiAgICAgICAgICAgIGlmIChzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIGNyZWF0ZUZpbGVzeXN0ZW1DbWRzKCk7XG4gICAgICAgICAgICAgICAgU3RvcmFnZVBvbGljaWVzTW9kZWwuc2F2ZShzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1BvbGljeURldGFpbHMoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgU3RvcmFnZVBvbGljaWVzTW9kZWwuZ2V0TW9kZWxCeUtleSgkc3RhdGVQYXJhbXMua2V5LCBmYWxzZSwgJ25hbWUnKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnBvbGljeSA9IHBvbGljeTtcbiAgICAgICAgICAgIGluaXRpYWxpemVGaWxlc3lzdGVtQ21kc0FycmF5KCk7XG4gICAgICAgICAgICBnZXRWb2x1bWVzKGZhbHNlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5kZWxldGVQb2xpY3kgPSBkZWxldGVQb2xpY3k7XG4gICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5zYXZlUG9saWN5ID0gc2F2ZVBvbGljeTtcbiAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmNhbmNlbEVkaXRpbmcgPSBjYW5jZWxFZGl0aW5nO1xuICAgICAgICBzZXRNb2RlKCk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG9yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldFZvbHVtZXModHJ1ZSk7XG4gICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdG9yYWdlcG9saWN5ZGV0YWlsc2N0cmwuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA2LzIvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LnN0b3JhZ2Vwb2xpY2llc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZTdG9yYWdlcG9saWN5YmFzaWNzZXR0aW5nc1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHt9O1xufSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2U3RvcmFnZXBvbGljeWZpbGVzeXN0ZW1zZXR0aW5nc1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIHBvbGljeTogJz0nLFxuICAgICAgICAgICAgZmlsZXN5c3RlbWNtZHM6ICc9J1xuICAgICAgICB9LFxuICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUpIHtcbiAgICAgICAgICAgIHNjb3BlLmZpbGVzeXN0ZW1zID0gWydleHQ0JywgJ2J0cmZzJ107XG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9maWxlc3lzdGVtc2V0dGluZ3MuaHRtbCdcbiAgICB9O1xufSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2U3RvcmFnZXBvbGljeXNuYXBzaG90c2V0dGluZ3NcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBwb2xpY3k6ICc9J1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvc25hcHNob3RzZXR0aW5ncy5odG1sJ1xuICAgIH07XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZTdG9yYWdlcG9saWN5cndvcHNzZXR0aW5nc1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIHBvbGljeTogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9yd29wc3NldHRpbmdzLmh0bWwnXG4gICAgfTtcbn0pXG4gICAgLmRpcmVjdGl2ZShcImN0dlN0b3JhZ2Vwb2xpY3liYWNrZW5kZHJpdmVyc1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIHBvbGljeTogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9iYWNrZW5kZHJpdmVycy5odG1sJ1xuICAgIH07XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXN0b3JhZ2Vwb2xpY3lkaXJlY3RpdmUuanMubWFwIiwiXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZpc3VhbGl6YXRpb24uZWRnZScsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvZWRnZS97c291cmNlTmFtZSwgdGFyZ2V0TmFtZSwgc291cmNlTGlzdCwgdGFyZ2V0TGlzdH0nLFxuICAgICAgICAgICAgICAgIHBhcmFtczoge1xuICAgICAgICAgICAgICAgICAgICBzb3VyY2VOYW1lOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICB0YXJnZXROYW1lOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICBzb3VyY2VMaXN0OiBudWxsLFxuICAgICAgICAgICAgICAgICAgICB0YXJnZXRMaXN0OiBudWxsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnVmlzdWFsaXphdGlvbkVkZ2VDdHJsIGFzIHZpc3VhbGl6YXRpb25lZGdlQ3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb25lZGdlLmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICA7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1Zpc3VhbGl6YXRpb25FZGdlQ3RybCcsIFtcIiRzY29wZVwiLCBcIiRodHRwXCIsICckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ1Zpc3VhbGl6YXRpb25TZXJ2aWNlJywgJyRpbnRlcnZhbCcsXG4gICAgICAgIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBWaXN1YWxpemF0aW9uU2VydmljZSwgJGludGVydmFsKSB7XG4gICAgICAgICAgICB2YXIgc291cmNlTmFtZSA9ICRzdGF0ZVBhcmFtcy5zb3VyY2VOYW1lO1xuICAgICAgICAgICAgdmFyIHRhcmdldE5hbWUgPSAkc3RhdGVQYXJhbXMudGFyZ2V0TmFtZTtcbiAgICAgICAgICAgIHZhciBzb3VyY2VMaXN0ID0gJHN0YXRlUGFyYW1zLnNvdXJjZUxpc3Q7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0TGlzdCA9ICRzdGF0ZVBhcmFtcy50YXJnZXRMaXN0O1xuXG4gICAgICAgICAgICAvL0lmIHRoZSBwYWdlIGlzIHJlbG9hZGVkLCB0aGVzZSBzdGF0ZSBwYXJhbXMgYXJlIGFsbCBudWxsLFxuICAgICAgICAgICAgLy9zbyBpdCB3aWxsIHJvdXRlIHRoZW0gYmFjayB0byB0aGUgdmlzdWFsaXphdGlvbiB0YWIgdG9wIHZpZXdcbiAgICAgICAgICAgIGlmIChzb3VyY2VMaXN0ID09IG51bGwgfHwgdGFyZ2V0TGlzdCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS52aXN1YWxpemF0aW9uLmxpc3QnKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBkID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgIHZhciB0ID0gZC5nZXRTZWNvbmRzKCk7XG4gICAgICAgICAgICAkc2NvcGUuZWRnZURhdGFJbnRlcnZhbCA9IFxuICAgICAgICAgICAgICAgICRpbnRlcnZhbChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgVmlzdWFsaXphdGlvblNlcnZpY2UuZ2V0RWRnZURhdGEoc291cmNlTGlzdCwgdGFyZ2V0TGlzdCwgdC50b1N0cmluZygpKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHRzID0gcmVzdWx0LnJlc3VsdHM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChyZXN1bHRzLCBmdW5jdGlvbihyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfLmlzRW1wdHkocikgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhICs9IHIuc2VyaWVzWzBdLnZhbHVlc1swXVsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zb3VyY2VOYW1lID0gc291cmNlTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUudGFyZ2V0TmFtZSA9IHRhcmdldE5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVkZ2VEYXRhID0gZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZWRnZURhdGFUaW1lID0gdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSwgMzAwMCk7XG5cbiAgICAgICAgICAgIC8vRGVzdHJveWluZyB0aGUgaW50ZXJ2YWwgZnVuY3Rpb24gb24gcm91dGUgY2hhbmdlXG4gICAgICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHsgJGludGVydmFsLmNhbmNlbCgkc2NvcGUuZWRnZURhdGFJbnRlcnZhbCk7IH0pO1xuXG5cbiAgICAgICAgICAgIFZpc3VhbGl6YXRpb25TZXJ2aWNlLmdldE9sZEVkZ2VEYXRhKHNvdXJjZUxpc3QsIHRhcmdldExpc3QpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0cyA9IHJlc3VsdC5yZXN1bHRzO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZWRnZURhdGEgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgLy9yZXN1bHRzLCBpZiBub3QgZW1wdHksIGFyZSBleHBlY3RlZCB0byBoYXZlXG4gICAgICAgICAgICAgICAgICAgIC8vNiBkYXRhIGVudHJpZXNcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHJlc3VsdHMsIGZ1bmN0aW9uKHIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfLmlzRW1wdHkocikgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSByLnNlcmllc1swXS52YWx1ZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF8uaXNFbXB0eShlZGdlRGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKGRhdGEsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkZ2VEYXRhLnB1c2goZFsxXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKGRhdGEsIGZ1bmN0aW9uKGQsIGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkZ2VEYXRhW2ldICs9IGRbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlTmFtZSA9IHNvdXJjZU5hbWU7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50YXJnZXROYW1lID0gdGFyZ2V0TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNvdXJjZUxpc3QgPSBzb3VyY2VMaXN0O1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudGFyZ2V0TGlzdCA9IHRhcmdldExpc3Q7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5vbGRFZGdlRGF0YSA9IGVkZ2VEYXRhO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgfV0pO1xuXG5cblxuXG4iLCJcblxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52aXN1YWxpemF0aW9uJylcbiAgICAuZGlyZWN0aXZlKFwidmlzdWFsaXphdGlvbkVkZ2VcIiwgWyckd2luZG93JyxcbiAgICAgICAgZnVuY3Rpb24oJHdpbmRvdykge1xuICAgICAgICAgICAgZnVuY3Rpb24gdmlzdWFsaXphdGlvbkVkZ2VEMyhzY29wZSwgZDMpIHtcbiAgICAgICAgICAgICAgICB2YXIgYm9keUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gYm9keUVsLmNsaWVudFdpZHRoIC0gNDAwLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSAgYm9keUVsLmNsaWVudEhlaWdodCAtIDQwMDtcblxuXG4gICAgICAgICAgICAgICAgLy90YWtlbiBmcm9tIGh0dHA6Ly9ibC5vY2tzLm9yZy9zaW1lbmJyZWtrZW4vNjYzNDA3MFxuICAgICAgICAgICAgICAgIC8vIC8qKiBNQUlOIFNWRyAqKi9cbiAgICAgICAgICAgICAgICB2YXIgbGltaXQgPSA1OSxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbiA9IDc1MCxcbiAgICAgICAgICAgICAgICBub3cgPSBuZXcgRGF0ZShEYXRlLm5vdygpIC0gZHVyYXRpb24pO1xuXG4gICAgICAgICAgICAgICAgdmFyIGdyb3VwcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJ29yYW5nZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkMy5yYW5nZShsaW1pdCkubWFwKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2NvcGUub2xkRWRnZURhdGFbTWF0aC5mbG9vcihkLzEwKV0gfHwgMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciB4ID0gZDMudGltZS5zY2FsZSgpXG4gICAgICAgICAgICAgICAgICAgIC5kb21haW4oW25vdyAtIChsaW1pdCAtIDIpLCBub3cgLSBkdXJhdGlvbl0pXG4gICAgICAgICAgICAgICAgICAgIC5yYW5nZShbMCwgd2lkdGhdKTtcblxuICAgICAgICAgICAgICAgIHZhciB5ID0gZDMuc2NhbGUubGluZWFyKClcbiAgICAgICAgICAgICAgICAgICAgLmRvbWFpbihbMCwgZDMubWF4KGdyb3Vwcy5jdXJyZW50LmRhdGEsIGZ1bmN0aW9uIChkKSB7IHJldHVybiBkICsgMTA7IH0pXSlcbiAgICAgICAgICAgICAgICAgICAgLnJhbmdlKFtoZWlnaHQsIDBdKTtcblxuICAgICAgICAgICAgICAgIHZhciBsaW5lID0gZDMuc3ZnLmxpbmUoKVxuICAgICAgICAgICAgICAgICAgICAuaW50ZXJwb2xhdGUoJ2Jhc2lzJylcbiAgICAgICAgICAgICAgICAgICAgLngoZnVuY3Rpb24oZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHgobm93IC0gKGxpbWl0IC0gMSAtIGkpICogZHVyYXRpb24pXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC55KGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB5KGQpXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIHhTdmcgPSBkMy5zZWxlY3QoJy5ncmFwaCcpLmFwcGVuZCgnc3ZnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgMjUpXG4gICAgICAgICAgICAgICAgICAgIC5zdHlsZSgnb3ZlcmZsb3cnLCAndmlzaWJsZScpXG4gICAgICAgICAgICAgICAgICAgIC5zdHlsZSgncG9zaXRpb24nLCAnZml4ZWQnKTtcblxuICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgdmFyIHlBeGlzID0geFN2Zy5hcHBlbmQoJ2cnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAneSBheGlzJylcbiAgICAgICAgICAgICAgICAgICAgLy8gLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoMCwnICsgd2lkdGggKyAnKScpXG4gICAgICAgICAgICAgICAgICAgIC5jYWxsKHkuYXhpcyA9IGQzLnN2Zy5heGlzKCkuc2NhbGUoeSkub3JpZW50KCdsZWZ0JykpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciBzdmc9IGQzLnNlbGVjdCgnLmdyYXBoJykuYXBwZW5kKCdzdmcnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnY2hhcnQnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignd2lkdGgnLCB3aWR0aCAtIDUwKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignaGVpZ2h0JywgaGVpZ2h0ICsgNTApO1xuICAgICAgICAgICAgICAgICAgICAvLyAuc3R5bGUoJ292ZXJmbG93JywgXCJ2aXNpYmxlXCIpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGF4aXMgPSBzdmcuYXBwZW5kKCdnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ3ggYXhpcycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDAsJyArIGhlaWdodCArICcpJylcbiAgICAgICAgICAgICAgICAgICAgLmNhbGwoeC5heGlzID0gZDMuc3ZnLmF4aXMoKS5zY2FsZSh4KS5vcmllbnQoJ2JvdHRvbScpKTtcblxuICAgICAgICAgICAgICAgIHZhciBwYXRocyA9IHN2Zy5hcHBlbmQoJ2cnKTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIG5hbWUgaW4gZ3JvdXBzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBncm91cCA9IGdyb3Vwc1tuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXAucGF0aCA9IHBhdGhzLmFwcGVuZCgncGF0aCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZGF0YShbZ3JvdXAuZGF0YV0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCBuYW1lICsgJyBncm91cCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ3N0cm9rZScsIGdyb3VwLmNvbG9yKVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHRpY2soKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vdyA9IG5ldyBEYXRlKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQWRkIG5ldyB2YWx1ZXNcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBncm91cHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBncm91cCA9IGdyb3Vwc1tuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLmRhdGEucHVzaChzY29wZS5lZGdlRGF0YSB8fCAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLnBhdGguYXR0cignZCcsIGxpbmUpXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBTaGlmdCBkb21haW5cbiAgICAgICAgICAgICAgICAgICAgeC5kb21haW4oW25vdyAtIChsaW1pdCAtIDIpICogZHVyYXRpb24sIG5vdyAtIGR1cmF0aW9uXSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2xpZGUgeC1heGlzIGxlZnRcbiAgICAgICAgICAgICAgICAgICAgYXhpcy50cmFuc2l0aW9uKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kdXJhdGlvbihkdXJhdGlvbilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lYXNlKCdsaW5lYXInKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhbGwoeC5heGlzKTtcblxuICAgICAgICAgICAgICAgICAgICB5QXhpcy50cmFuc2l0aW9uKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kdXJhdGlvbihkdXJhdGlvbilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lYXNlKCdsaW5lYXInKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhbGwoeS5heGlzKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBTbGlkZSBwYXRocyBsZWZ0XG4gICAgICAgICAgICAgICAgICAgIHBhdGhzLmF0dHIoJ3RyYW5zZm9ybScsIG51bGwpXG4gICAgICAgICAgICAgICAgICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZHVyYXRpb24oZHVyYXRpb24pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZWFzZSgnbGluZWFyJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKCcgKyB4KG5vdyAtIChsaW1pdCAtIDEpICogZHVyYXRpb24pICsgJyknKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVhY2goJ2VuZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpY2soKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIG9sZGVzdCBkYXRhIHBvaW50IGZyb20gZWFjaCBncm91cFxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBuYW1lIGluIGdyb3Vwcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdyb3VwID0gZ3JvdXBzW25hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXAuZGF0YS5zaGlmdCgpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGljaygpXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybntcbiAgICAgICAgICAgICAgICByZXN0cmljdDonRUEnLFxuICAgICAgICAgICAgICAgIHJlcGxhY2U6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9uZWRnZXRlbXBsYXRlLmh0bWwnLFxuICAgICAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlKXtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJHdhdGNoR3JvdXAoWydlZGdlRGF0YScsICdvbGRFZGdlRGF0YSddLFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNjb3BlLmVkZ2VEYXRhICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLm9sZEVkZ2VEYXRhICE9IG51bGwgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2NvcGUuaW5pdGlhbGl6ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuaW5pdGlhbGl6ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZDMgPSAkd2luZG93LmQzOyAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXN1YWxpemF0aW9uRWRnZUQzKHNjb3BlLCBkMyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICB9XG4gICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICBdXG4pO1xuIiwiXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nKVxuICAgIC5zZXJ2aWNlKCdTdGF0ZVNhdmUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2F2ZWRTdGF0ZXMgPSB7fTtcbiAgICB9KVxuICAgIC5kaXJlY3RpdmUoXCJ2aXN1YWxpemF0aW9uR3JhcGhcIiwgWyckd2luZG93JywgJyRzdGF0ZScsICdWaXN1YWxpemVyR3JhcGgnLCAnUG9saWN5U2VydmljZScsICdWaXN1YWxpemVyRGF0YVNvdXJjZScsICdTdGF0ZVNhdmUnLFxuICAgICAgICBmdW5jdGlvbigkd2luZG93LCAkc3RhdGUsIFZpc3VhbGl6ZXJHcmFwaCwgUG9saWN5U2VydmljZSwgVmlzdWFsaXplckRhdGFTb3VyY2UsIFN0YXRlU2F2ZSkge1xuICAgICAgICAgICAgZnVuY3Rpb24gdmlzdWFsaXphdGlvbmxpc3RkMyhzY29wZSwgZWxlbSwgVmlzdWFsaXplckdyYXBoLCBQb2xpY3lTZXJ2aWNlLCBWaXN1YWxpemVyRGF0YVNvdXJjZSwgU3RhdGVTYXZlKSB7XG4gICAgICAgICAgICAgICAgLy9kb24ndCBydW4gdW50aWwgYWxsIGluaXRpYWxpemF0aW9uIGNhbGxzIGhhdmUgcmV0dXJuZWRcbiAgICAgICAgICAgICAgICBpZiAoc2NvcGUubm9kZXMgPT09IHVuZGVmaW5lZCB8fCBzY29wZS5saW5rcyA9PT0gdW5kZWZpbmVkIHx8IHNjb3BlLmNoaWxkcmVuX3N0cnVjdCA9PT0gdW5kZWZpbmVkIHx8XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLmFuY2VzdG9yc19zdHJ1Y3QgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9jcmVhdGluZyBEYXRhU291cmNlXG4gICAgICAgICAgICAgICAgdmFyIGRhdGFTb3VyY2UgPSBuZXcgVmlzdWFsaXplckRhdGFTb3VyY2UuRGF0YVNvdXJjZShzY29wZS5ub2Rlcywgc2NvcGUubGlua3MsIHNjb3BlLmNoaWxkcmVuX3N0cnVjdCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5hbmNlc3RvcnNfc3RydWN0LCBzY29wZS5sYWJlbHMsIHNjb3BlLnNlcnZpY2VTZWxlY3RvcnMpO1xuICAgICAgICAgICAgICAgIGRhdGFTb3VyY2Uuc2V0QW5jZXN0b3JzKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMsIGxpbmtzO1xuXG4gICAgICAgICAgICAgICAgdmFyIHRvcERhdGEgPSBkYXRhU291cmNlLmdldFRvcExldmVsRmxvdygpO1xuICAgICAgICAgICAgICAgIG5vZGVzID0gZGF0YVNvdXJjZS5wcm9jZXNzTm9kZURhdGEodG9wRGF0YS5ub2RlRGF0YSk7XG4gICAgICAgICAgICAgICAgbGlua3MgPSBkYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YSh0b3BEYXRhLmxpbmtEYXRhLCBub2Rlcyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgYm9keUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gYm9keUVsLmNsaWVudFdpZHRoLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSAgYm9keUVsLmNsaWVudEhlaWdodDtcblxuICAgICAgICAgICAgICAgIC8qKiBNQUlOIFNWRyAqKi9cbiAgICAgICAgICAgICAgICB2YXIgcmF3U3ZnPWVsZW0uZmluZCgnc3ZnJyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gJChyYXdTdmcucGFyZW50KCkpLm9mZnNldCgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGRpdldpZHRoID0gJChyYXdTdmcucGFyZW50KCkpLndpZHRoKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3ZnID0gZDMuc2VsZWN0KHJhd1N2Z1swXSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCBkaXZXaWR0aClcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJoZWlnaHRcIiwgaGVpZ2h0IC0gb2Zmc2V0LnRvcCAtIDIwKTtcblxuICAgICAgICAgICAgICAgIC8vaW5zdGFsbGluZyBwb2xpY2llc1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaCA9IG5ldyBWaXN1YWxpemVyR3JhcGguR3JhcGgoc3ZnLCBub2RlcywgbGlua3MsIGRhdGFTb3VyY2UsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmNoaWxkcmVuX3N0cnVjdCwgc2NvcGUuYW5jZXN0b3JzX3N0cnVjdCk7XG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmluc3RhbGxEZWZhdWx0UGF0aFBvbGljeShuZXcgUG9saWN5U2VydmljZS5TYXZlU3RhdGVQb2xpY3koU3RhdGVTYXZlLnNhdmVkU3RhdGVzKSk7XG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmluc3RhbGxEZWZhdWx0UGF0aFBvbGljeShuZXcgUG9saWN5U2VydmljZS5QYXRoQ2hhbmdlVmlld1BvbGljeSgkc3RhdGUpKTtcbiAgICAgICAgICAgICAgICAvL1FUaXBQb2xpY3kgaXMgZm9yIGJvdGggTm9kZXMgYW5kIFBhdGhzLCBpbnN0YWxsIHNhbWUgb25lIG9uIGJvdGhcbiAgICAgICAgICAgICAgICB2YXIgcVRpcFBvbGljeSA9IG5ldyBQb2xpY3lTZXJ2aWNlLlFUaXBQb2xpY3koKTtcbiAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGguaW5zdGFsbERlZmF1bHROb2RlUG9saWN5KHFUaXBQb2xpY3kpO1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5pbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3kocVRpcFBvbGljeSk7XG4gICAgICAgICAgICAgICAgdmFyIHNwbGl0Sm9pblZpZXdQb2xpY3kgPSBuZXcgUG9saWN5U2VydmljZS5TcGxpdEpvaW5WaWV3UG9saWN5KCk7XG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmluc3RhbGxEZWZhdWx0Tm9kZVBvbGljeShzcGxpdEpvaW5WaWV3UG9saWN5KTtcbiAgICAgICAgICAgICAgICBzcGxpdEpvaW5WaWV3UG9saWN5Lmluc3RhbGxCYWNrQnV0dG9uKCQoJyNiYWNrQnV0dG9uJykpO1xuICAgICAgICAgICAgICAgIHNwbGl0Sm9pblZpZXdQb2xpY3kuaW5zdGFsbFRpdGxlKCQoJyNncmFwaC10aXRsZScpKTtcblxuICAgICAgICAgICAgICAgIC8vbG9hZCBvbGQgdmlldyBpZiBpdCBleGlzdHMuXG4gICAgICAgICAgICAgICAgaWYgKF8uaXNFbXB0eShTdGF0ZVNhdmUuc2F2ZWRTdGF0ZXMpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBncmFwaCA9IHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaDtcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGgubG9hZChTdGF0ZVNhdmUuc2F2ZWRTdGF0ZXMpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJue1xuICAgICAgICAgICAgICAgIHJlc3RyaWN0OidFQScsXG4gICAgICAgICAgICAgICAgcmVwbGFjZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb250ZW1wbGF0ZS5odG1sJyxcbiAgICAgICAgICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbSl7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS51bmJpbmQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5kZXN0cm95KCk7fSk7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiR3YXRjaEdyb3VwKFsnbm9kZXMnLCAnbGlua3MnLCAnY2hpbGRyZW5fc3RydWN0JywgJ2FuY2VzdG9yc19zdHJ1Y3QnXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzY29wZS5ub2RlcyAhPSBudWxsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmxpbmtzICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuY2hpbGRyZW5fc3RydWN0ICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuYW5jZXN0b3JzX3N0cnVjdCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzY29wZS5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5pbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc3VhbGl6YXRpb25saXN0ZDMoc2NvcGUsIGVsZW0sIFZpc3VhbGl6ZXJHcmFwaCwgUG9saWN5U2VydmljZSwgVmlzdWFsaXplckRhdGFTb3VyY2UsIFN0YXRlU2F2ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmRhdGFTb3VyY2UubGlua3MgPSBzY29wZS5saW5rcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLnVwZGF0ZUxpbmtEYXRhKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIF1cbik7XG5cblxuXG5cblxuXG5cblxuXG5cblxuXG4iLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52aXN1YWxpemF0aW9uLmxpc3QnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWaXN1YWxpemF0aW9uTGlzdEN0cmwgYXMgdmlzdWFsaXphdGlvbkxpc3RDdHJsJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Zpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbmxpc3QuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignVmlzdWFsaXphdGlvbkxpc3RDdHJsJywgW1wiJHNjb3BlXCIsIFwiJGh0dHBcIiwgJ1Zpc3VhbGl6YXRpb25TZXJ2aWNlJywgJyRpbnRlcnZhbCcsIFxuICAgICAgICBmdW5jdGlvbigkc2NvcGUsICRodHRwLCBWaXN1YWxpemF0aW9uU2VydmljZSwgJGludGVydmFsKSB7XG4gICAgICAgICAgICAvL3RvIHNlZSB0aGUgZXhwZWN0ZWQgZm9ybWF0IHRvIGJlIHJldHVybmVkIGZyb20gdGhlc2UgY2FsbHMsXG4gICAgICAgICAgICAvL2xvb2sgYXQgYXBwL2NvbXBvbmVudHMvZ3JhcGhvYmplY3RzL2RhdGFzb3VyY2UvdmlzdWFsaXplcmRhdGFzb3VyY2UuanNcbiAgICAgICAgICAgIHZhciBzdWNjZXNzR3JhcGhEYXRhQ2FsbGJhY2sgPSBmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgbGlua3MgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZUlkcyA9IFtdO1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaChyZXN1bHQucmVzdWx0c1swXS5zZXJpZXMsIGZ1bmN0aW9uKHNlcmllcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZW5kcG9pbnQgPSBzZXJpZXMudGFncy5FbmRwb2ludElQO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJvdmlkZXIgPSBzZXJpZXMudGFncy5Qcm92aWRlcklQO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZTtcbiAgICAgICAgICAgICAgICAgICAgLy9jcmVhdGluZyBub2Rlc1xuICAgICAgICAgICAgICAgICAgICBpZiAoXy5pbmNsdWRlcyhub2RlSWRzLCBlbmRwb2ludCkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogZW5kcG9pbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGVuZHBvaW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNlc3RvcnM6IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlkcy5wdXNoKGVuZHBvaW50KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoXy5pbmNsdWRlcyhub2RlSWRzLCBwcm92aWRlcikgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogcHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHByb3ZpZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNlc3RvcnM6IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlkcy5wdXNoKHByb3ZpZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvL2NyZWF0aW5nIGxpbmtzXG4gICAgICAgICAgICAgICAgICAgIHZhciBsaW5rT3V0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiBlbmRwb2ludCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogcHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ6IHNlcmllcy52YWx1ZXNbMF1bMl1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgbGlua3MucHVzaChsaW5rT3V0KTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxpbmtJbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogcHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IGVuZHBvaW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0OiBzZXJpZXMudmFsdWVzWzBdWzFdXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGxpbmtzLnB1c2gobGlua0luKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAkc2NvcGUubm9kZXMgPSBub2RlcztcbiAgICAgICAgICAgICAgICAkc2NvcGUubGlua3MgPSBsaW5rcztcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAvL2luaXRpYWwgY2FsbFxuICAgICAgICAgICAgVmlzdWFsaXphdGlvblNlcnZpY2UuZ2V0R3JhcGhEYXRhKCkudGhlbihzdWNjZXNzR3JhcGhEYXRhQ2FsbGJhY2ssIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy93aWxsIGZhaWwgc2lsZW50bHksIGdyYXBoIHdvbid0IGJlIGRpc3BsYXllZFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkgeyAkaW50ZXJ2YWwuY2FuY2VsKCRzY29wZS5ncmFwaERhdGFJbnRlcnZhbCk7IH0pO1xuXG4gICAgICAgICAgICBWaXN1YWxpemF0aW9uU2VydmljZS5nZXRTdHJ1Y3R1cmVEYXRhKCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy90byBzZWUgdGhlIGV4cGVjdGVkIGZvcm0gb2YgYW5jZXN0b3Jfc3RydWN0IGFuZCBjaGlsZHJlbl9zdHJ1Y3QsIFxuICAgICAgICAgICAgICAgIC8vbG9vayBhdCBhcHAvY29tcG9uZW50cy9ncmFwaG9iamVjdHMvZGF0YXNvdXJjZS92aXN1YWxpemVyZGF0YXNvdXJjZS5qc1xuICAgICAgICAgICAgICAgICRzY29wZS5hbmNlc3RvcnNfc3RydWN0ID0gcmVzdWx0LmFuY2VzdG9yc19zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoaWxkcmVuX3N0cnVjdCA9IHJlc3VsdC5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxhYmVscyA9IHJlc3VsdC5sYWJlbHM7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlcnZpY2VTZWxlY3RvcnMgPSByZXN1bHQuc2VydmljZVNlbGVjdG9ycztcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy93aWxsIGZhaWwgc2lsZW50bHksIGdyYXBoIHdvbid0IGJlIGRpc3BsYXllZFxuICAgICAgICAgICAgfSk7XG4gICAgfV0pO1xuXG5cblxuXG5cblxuXG5cblxuXG5cbiIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicpXG4gICAgLmZhY3RvcnkoJ1Zpc3VhbGl6YXRpb25TZXJ2aWNlJywgWyckaHR0cCcsICckcScsIGZ1bmN0aW9uICgkaHR0cCwgJHEpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1ha2VzIGEgZ2V0IHJlcXVlc3Qgd2l0aCB0aGUgdXJsIGFuZCBjb25maWcuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICB1cmwgICAgIFRoZSB1cmxcbiAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGNvbmZpZyAgVGhlIGNvbmZpZ3VyYXRpb25zXG4gICAgICAgICAqIEByZXR1cm4gICAgIHskSHR0cCBQcm9taXNlfSAgIFByb21pc2Ugb2YgdGhlIHJlcXVlc3RcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIG1ha2VHZXQodXJsLCBjb25maWcpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAkaHR0cC5nZXQodXJsLCBjb25maWcpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYWtlcyBhIHBvc3QgcmVxdWVzdCB3aXRoIHRoZSB1cmwgYW5kIGRhdGFcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHVybCAgICAgVGhlIHVybFxuICAgICAgICAgKiBAcGFyYW0gICAgICB7SlNPTn0gICAgZGF0YSAgICBUaGUgZGF0YVxuICAgICAgICAgKiBAcmV0dXJuICAgICB7JEh0dHAgUHJvbWlzZX0gICBQcm9taXNlIG9mIHRoZSByZXF1ZXN0XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBtYWtlUG9zdCh1cmwsIGRhdGEpIHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogY29udmVydHMgdGhlIGRhdGEgaW50byB4LXd3dy1mcm9tLXVybGVuY29kZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SlNPTn0gIG9iaiAgICAgSlNPTiBkYXRhIG9iamVjdFxuICAgICAgICAgICAgICogQHJldHVybiAgICAge3N0cmluZ30gIHgtd3d3LWZvcm0tdXJsZW5jb2RlZCBzdHJpbmdcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdmFyIHBhcmFtID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gJycsIG5hbWUsIHZhbHVlLCBmdWxsU3ViTmFtZSwgc3ViTmFtZSwgc3ViVmFsdWUsIGlubmVyT2JqLCBpO1xuICAgICAgICAgICAgICAgIGZvciAobmFtZSBpbiBvYmopIHtcbiAgICAgICAgICAgICAgICAgIHZhbHVlID0gb2JqW25hbWVdO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGk9MDsgaTx2YWx1ZS5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlZhbHVlID0gdmFsdWVbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVsbFN1Yk5hbWUgPSBuYW1lICsgJ1snICsgaSArICddJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbm5lck9iaiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlubmVyT2JqW2Z1bGxTdWJOYW1lXSA9IHN1YlZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ICs9IHBhcmFtKGlubmVyT2JqKSArICcmJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIE9iamVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChzdWJOYW1lIGluIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViVmFsdWUgPSB2YWx1ZVtzdWJOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdWxsU3ViTmFtZSA9IG5hbWUgKyAnWycgKyBzdWJOYW1lICsgJ10nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlubmVyT2JqID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5uZXJPYmpbZnVsbFN1Yk5hbWVdID0gc3ViVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkgKz0gcGFyYW0oaW5uZXJPYmopICsgJyYnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYodmFsdWUgIT09IHVuZGVmaW5lZCAmJiB2YWx1ZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkgKz0gZW5jb2RlVVJJQ29tcG9uZW50KG5hbWUpICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKSArICcmJztcbiAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHF1ZXJ5Lmxlbmd0aCA/IHF1ZXJ5LnN1YnN0cigwLCBxdWVyeS5sZW5ndGggLSAxKSA6IHF1ZXJ5O1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICB1cmw6dXJsLFxuICAgICAgICAgICAgICAgIG1ldGhvZDonUE9TVCcsXG4gICAgICAgICAgICAgICAgZGF0YTogZGF0YSxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCdcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHRyYW5zZm9ybVJlcXVlc3Q6IFtmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhbmd1bGFyLmlzT2JqZWN0KGRhdGEpICYmIFN0cmluZyhkYXRhKSAhPT0gJ1tvYmplY3QgRmlsZV0nID8gcGFyYW0oZGF0YSkgOiBkYXRhO1xuICAgICAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0R3JhcGhEYXRhKCkge1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuVklTVUFMSVpBVElPTl9FTkRQT0lOVDtcbiAgICAgICAgICAgIHVybCArPSAnaW5mbHV4L3F1ZXJ5JztcbiAgICAgICAgICAgIHZhciBjb25maWcgPSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgICAgICAgICAgIGRiOlwidGVsZWdyYWZcIixcbiAgICAgICAgICAgICAgICAgICAgcTpcIlNFTEVDVCBCeXRlc0luLCBCeXRlc091dCwgRW5kcG9pbnRJUCwgUHJvdmlkZXJJUCBGUk9NIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDFtIEdST1VQIEJZICogTElNSVQgMVwiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBtYWtlR2V0KHVybCwgY29uZmlnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldFN0cnVjdHVyZURhdGEoKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WSVNVQUxJWkFUSU9OX0VORFBPSU5UO1xuICAgICAgICAgICAgdXJsICs9ICdzZXJ2aWNlcyc7XG4gICAgICAgICAgICByZXR1cm4gbWFrZUdldCh1cmwpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gYnVpbGRXaGVyZVF1ZXJ5KHBvaW50cywgdHlwZSkge1xuICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gXCIoXCI7XG4gICAgICAgICAgICBxdWVyeSArPSB0eXBlICsgXCI9XCI7XG4gICAgICAgICAgICBxdWVyeSArPSBcIidcIiArIHBvaW50c1swXSArIFwiJyBcIjtcbiAgICAgICAgICAgIC8vc3RhcnRzIGF0IDEsIHNvIHdpbGwgbm90IHJ1biBpZiBsZW5ndGggaXMgMVxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBwb2ludHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBxdWVyeSArPSAnT1IgJztcbiAgICAgICAgICAgICAgICBxdWVyeSArPSB0eXBlICsgXCI9XCI7XG4gICAgICAgICAgICAgICAgcXVlcnkgKz0gXCInXCIgKyBwb2ludHNbaV0gKyBcIicgXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBxdWVyeSArPSBcIilcIjtcbiAgICAgICAgICAgIHJldHVybiBxdWVyeTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldEVkZ2VEYXRhKHNvdXJjZUxpc3QsIHRhcmdldExpc3QsIHRpbWUpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLlZJU1VBTElaQVRJT05fRU5EUE9JTlQ7XG4gICAgICAgICAgICB1cmwgKz0gJ2luZmx1eC9xdWVyeSc7XG5cbiAgICAgICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICBkYiA6IFwidGVsZWdyYWZcIixcbiAgICAgICAgICAgICAgICAgICAgcTogXCJTRUxFQ1Qgc3VtKFwiICsgJ0J5dGVzT3V0JyArIFwiKSBmcm9tIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDE1cyBBTkQgXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeShzb3VyY2VMaXN0LCBcIkVuZHBvaW50SVBcIikgK1wiIEFORCBcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeSh0YXJnZXRMaXN0LCAnUHJvdmlkZXJJUCcpIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgXCJHUk9VUCBCWSB0aW1lKDIwcykgTElNSVQgMTsgU0VMRUNUIHN1bShcIiArICdCeXRlc0luJyArIFwiKSBmcm9tIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDE1cyBBTkQgXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeShzb3VyY2VMaXN0LCAnUHJvdmlkZXJJUCcpICtcIiBBTkQgXCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkodGFyZ2V0TGlzdCwgJ0VuZHBvaW50SVAnKSBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIFwiR1JPVVAgQlkgdGltZSgyMHMpIGZpbGwoMCkgTElNSVQgMVwiXG4gICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIG1ha2VQb3N0KHVybCwgZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICBcblxuICAgICAgICBmdW5jdGlvbiBnZXRPbGRFZGdlRGF0YShzb3VyY2VMaXN0LCB0YXJnZXRMaXN0KSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WSVNVQUxJWkFUSU9OX0VORFBPSU5UO1xuICAgICAgICAgICAgdXJsICs9ICdpbmZsdXgvcXVlcnknO1xuICAgICAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgICAgIGRiIDogXCJ0ZWxlZ3JhZlwiLFxuICAgICAgICAgICAgICAgICAgICBxOiBcIlNFTEVDVCBzdW0oXCIgKyAnQnl0ZXNPdXQnICsgXCIpIEZST00gaHR0cGpzb25fc3Zjc3RhdHMgV0hFUkUgdGltZSA+IG5vdygpIC0gMW0gQU5EIFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkoc291cmNlTGlzdCwgXCJFbmRwb2ludElQXCIpICtcIiBBTkQgXCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkodGFyZ2V0TGlzdCwgXCJQcm92aWRlcklQXCIpIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgXCIgR1JPVVAgQlkgdGltZSgxMHMpIGZpbGwoMCkgTElNSVQgNjsgU0VMRUNUIHN1bShcIiArICdCeXRlc0luJyArIFwiKSBGUk9NIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDFtIEFORCBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHNvdXJjZUxpc3QsIFwiUHJvdmlkZXJJUFwiKSArXCIgQU5EIFwiIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHRhcmdldExpc3QsIFwiRW5kcG9pbnRJUFwiKSBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIFwiIEdST1VQIEJZIHRpbWUoMTBzKSBmaWxsKDApIExJTUlUIDZcIlxuICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBtYWtlUG9zdCh1cmwsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldEdyYXBoRGF0YTogZ2V0R3JhcGhEYXRhLFxuICAgICAgICAgICAgZ2V0U3RydWN0dXJlRGF0YTogZ2V0U3RydWN0dXJlRGF0YSxcbiAgICAgICAgICAgIGdldEVkZ2VEYXRhOiBnZXRFZGdlRGF0YSxcbiAgICAgICAgICAgIGdldE9sZEVkZ2VEYXRhOiBnZXRPbGRFZGdlRGF0YVxuICAgICAgICB9XG4gICAgfV0pO1xuXG5cblxuXG5cblxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA2LzMvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudm9sdW1lcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZvbHVtZXMuY3JlYXRlJywge1xuICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZvbHVtZXMvdm9sdW1lY3JlYXRlLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1ZvbHVtZUNyZWF0ZUN0cmwgYXMgdm9sdW1lQ3JlYXRlQ3RybCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1ZvbHVtZUNyZWF0ZUN0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnVm9sdW1lc01vZGVsJywgJ1N0b3JhZ2VQb2xpY2llc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIFZvbHVtZXNNb2RlbCwgU3RvcmFnZVBvbGljaWVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2b2x1bWVDcmVhdGVDdHJsID0gdGhpcztcbiAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5maWxlc3lzdGVtcyA9IFsnZXh0NCcsICdidHJmcyddO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1ZvbHVtZXNNb2RlbCgpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUudm9sdW1lcy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub1ZvbHVtZXNNb2RlbCgpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZXQgc3RvcmFnZSBwb2xpY2llcy5cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGdldFN0b3JhZ2VQb2xpY2llcygpIHtcbiAgICAgICAgICAgIFN0b3JhZ2VQb2xpY2llc01vZGVsLmdldCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwucG9saWNpZXMgPSByZXN1bHQ7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBhcHBseVBvbGljeVNldHRpbmdzKCkge1xuICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUucG9saWN5ID0gdm9sdW1lQ3JlYXRlQ3RybC5zZWxlY3RlZFBvbGljeS5uYW1lO1xuICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUuYmFja2VuZHMgPSB2b2x1bWVDcmVhdGVDdHJsLnNlbGVjdGVkUG9saWN5LmJhY2tlbmRzO1xuICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUuZHJpdmVyID0gdm9sdW1lQ3JlYXRlQ3RybC5zZWxlY3RlZFBvbGljeS5kcml2ZXI7XG4gICAgICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLm5ld1ZvbHVtZS5jcmVhdGUgPSB2b2x1bWVDcmVhdGVDdHJsLnNlbGVjdGVkUG9saWN5LmNyZWF0ZTtcbiAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwubmV3Vm9sdW1lLnJ1bnRpbWUgPSB2b2x1bWVDcmVhdGVDdHJsLnNlbGVjdGVkUG9saWN5LnJ1bnRpbWU7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlVm9sdW1lKCkge1xuICAgICAgICAgICAgLy9mb3JtIGNvbnRyb2xsZXIgaXMgaW5qZWN0ZWQgYnkgdGhlIGh0bWwgdGVtcGxhdGVcbiAgICAgICAgICAgIC8vY2hlY2tpbmcgaWYgYWxsIHZhbGlkYXRpb25zIGhhdmUgcGFzc2VkXG4gICAgICAgICAgICBpZiAodm9sdW1lQ3JlYXRlQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcih2b2x1bWVDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcih2b2x1bWVDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBhcHBseVBvbGljeVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgVm9sdW1lc01vZGVsLmNyZWF0ZSh2b2x1bWVDcmVhdGVDdHJsLm5ld1ZvbHVtZSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvVm9sdW1lc01vZGVsKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHZvbHVtZUNyZWF0ZUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmVzZXRGb3JtKCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcih2b2x1bWVDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwubmV3Vm9sdW1lID0ge1xuICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgIFwiYmFja2VuZHNcIjoge30sXG4gICAgICAgICAgICAgICAgXCJkcml2ZXJcIjoge30sXG4gICAgICAgICAgICAgICAgXCJjcmVhdGVcIjoge30sXG4gICAgICAgICAgICAgICAgXCJydW50aW1lXCI6IHt9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwuY3JlYXRlVm9sdW1lID0gY3JlYXRlVm9sdW1lO1xuICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLmNhbmNlbENyZWF0aW5nID0gY2FuY2VsQ3JlYXRpbmc7XG4gICAgICAgIGdldFN0b3JhZ2VQb2xpY2llcygpO1xuICAgICAgICByZXNldEZvcm0oKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD12b2x1bWVjcmVhdGVjdHJsLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSBjc2hhbXB1ciBvbiA4LzkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudm9sdW1lcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZvbHVtZXMuY29weScsIHtcbiAgICAgICAgICAgIHVybDogJy9jb3B5LycsXG4gICAgICAgICAgICBwYXJhbXM6IHsgc25hcHNob3Q6IG51bGwsIHBvbGljeTogbnVsbCwgdm9sdW1lOiBudWxsIH0sXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVm9sdW1lU25hcHNob3RDb3B5Q3RybCBhcyB2b2x1bWVTbmFwc2hvdENvcHlDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndm9sdW1lcy92b2x1bWVzbmFwc2hvdGNvcHkuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1ZvbHVtZVNuYXBzaG90Q29weUN0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckaHR0cCcsICdWb2x1bWVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgJHNjb3BlLCAkaW50ZXJ2YWwsICRodHRwLCBWb2x1bWVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2b2x1bWVTbmFwc2hvdENvcHlDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ29weSgpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUudm9sdW1lcy5kZXRhaWxzJywgeyBrZXk6ICRzdGF0ZVBhcmFtcy5wb2xpY3kgKyAnLycgKyAkc3RhdGVQYXJhbXMudm9sdW1lIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdvVG9OZXdWb2x1bWUoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZvbHVtZXMuZGV0YWlscycsIHsga2V5OiAkc3RhdGVQYXJhbXMucG9saWN5ICsgJy8nICsgdm9sdW1lU25hcHNob3RDb3B5Q3RybC5uZXd2b2x1bWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY29weVNuYXBzaG90KCkge1xuICAgICAgICAgICAgaWYgKHZvbHVtZVNuYXBzaG90Q29weUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iodm9sdW1lU25hcHNob3RDb3B5Q3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIodm9sdW1lU25hcHNob3RDb3B5Q3RybCk7XG4gICAgICAgICAgICAgICAgdmFyIG1vZGVsID0ge307XG4gICAgICAgICAgICAgICAgbW9kZWwucG9saWN5ID0gJHN0YXRlUGFyYW1zLnBvbGljeTtcbiAgICAgICAgICAgICAgICBtb2RlbC5uYW1lID0gJHN0YXRlUGFyYW1zLnZvbHVtZTtcbiAgICAgICAgICAgICAgICBWb2x1bWVzTW9kZWwuY29weShtb2RlbCwgJHN0YXRlUGFyYW1zLnNuYXBzaG90LCB2b2x1bWVTbmFwc2hvdENvcHlDdHJsLm5ld3ZvbHVtZSlcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZVNuYXBzaG90Q29weUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBnb1RvTmV3Vm9sdW1lKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVTbmFwc2hvdENvcHlDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHZvbHVtZVNuYXBzaG90Q29weUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdm9sdW1lU25hcHNob3RDb3B5Q3RybC5wb2xpY3kgPSAkc3RhdGVQYXJhbXMucG9saWN5O1xuICAgICAgICB2b2x1bWVTbmFwc2hvdENvcHlDdHJsLnZvbHVtZSA9ICRzdGF0ZVBhcmFtcy52b2x1bWU7XG4gICAgICAgIHZvbHVtZVNuYXBzaG90Q29weUN0cmwuc25hcHNob3QgPSAkc3RhdGVQYXJhbXMuc25hcHNob3Q7XG4gICAgICAgIHZvbHVtZVNuYXBzaG90Q29weUN0cmwuY29weVNuYXBzaG90ID0gY29weVNuYXBzaG90O1xuICAgICAgICB2b2x1bWVTbmFwc2hvdENvcHlDdHJsLmNhbmNlbENvcHkgPSBjYW5jZWxDb3B5O1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXZvbHVtZXNuYXBzaG90Y29weWN0cmwuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZBY2l2YWxpZFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvbm9kZXMvYWNpdmFsaWQuaHRtbCcsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIGZvcm06IFwiPVwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7IiwiYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZDb250cm9saW50ZXJmYWNlXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy9ub2Rlcy9jb250cm9saW50ZXJmYWNlLmh0bWwnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBleHRyYXZhcnM6IFwiPVwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7IiwiYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZOZXR3b3JrbW9kZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvbm9kZXMvbmV0d29ya21vZGUuaHRtbCcsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIGV4dHJhdmFyczogXCI9XCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTsiLCJhbmd1bGFyLm1vZHVsZShcImNvbnRpdi5kaXJlY3RpdmVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dlNjaGVkdWxlclwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvbm9kZXMvc2NoZWR1bGVyLmh0bWwnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBleHRyYXZhcnM6IFwiPVwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
