"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}angular.module("contiv.graph",[]),angular.module("contiv.directives",[]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();angular.module("contiv.graph").factory("DataSource",["Node","Link",function(e,t){var o=function(){function o(e,t){_classCallCheck(this,o),this.nodes=e,this.links=t}return _createClass(o,[{key:"updateNodes",value:function(e){this.nodes=e}},{key:"updateLinks",value:function(e){this.links=e}},{key:"nodeIdToName",value:function(e){for(var t=this.nodes,o=0;o<t.length;o++)if(t[o].id==e)return t[o].name}},{key:"processNodeData",value:function(t){var o=[];return _.forEach(t,function(t){var n=new e.Node(null,null,t.id,t.text,null);o.push(n)}),o}},{key:"processLinkData",value:function(e,o){function n(e,t){for(var o=0;o<t.length;o++)if(e==t[o].id)return t[o]}for(var i=[],r=0;r<e.length;r++)if(e[r].source!=e[r].target){var a=n(e[r].source,o),l=n(e[r].target,o);if(null==a||null==l)continue;var s=new t.Link(a,l);i.push(s)}return i}}]),o}();return{DataSource:o}}]),angular.module("contiv.models",[]);var ContivGlobals=function(){return{NETWORKS_ENDPOINT:"/netmaster/api/v1/networks/",NETWORKS_INSPECT_ENDPOINT:"/netmaster/api/v1/inspect/networks/",SERVICELBS_INSPECT_ENDPOINT:"/netmaster/api/v1/inspect/serviceLBs/",POLICIES_ENDPOINT:"/netmaster/api/v1/policys/",RULES_ENDPOINT:"/netmaster/api/v1/rules/",APPLICATIONGROUPS_ENDPOINT:"/netmaster/api/v1/endpointGroups/",SERVICELBS_ENDPOINT:"/netmaster/api/v1/serviceLBs/",ORGANIZATIONS_ENDPOINT:"/netmaster/api/v1/tenants/",NETWORK_SETTINGS_ENDPOINT:"/netmaster/api/v1/globals/",NETPROFILES_ENDPOINT:"/netmaster/api/v1/netprofiles/",BGPS_ENDPOINT:"/netmaster/api/v1/Bgps/",BGPS_INSPECT_ENDPOINT:"/netmaster/api/v1/inspect/Bgps/",VISUALIZATION_ENDPOINT:"/visualization/",VOLUMES_ENDPOINT:"/volmaster/volumes/",VOLUMES_CREATE_ENDPOINT:"/volmaster/volumes/create/",VOLUMES_DELETE_ENDPOINT:"/volmaster/volumes/remove/",VOLUMES_COPYSNAPSHOTS_ENDPOINT:"/volmaster/volumes/copy",VOLUMES_USES_ENDPOINT:"/volmaster/uses/mounts/",VOLUMES_SNAPSHOTS_ENDPOINT:"/volmaster/snapshots/",STORAGEPOLICIES_ENDPOINT:"/volmaster/policies/",VOLUMES_GLOBAL_ENDPOINT:"/volmaster/global/",NODES_LIST_ENDPOINT:"/info/nodes",NODES_DISCOVER_ENDPOINT:"/discover/nodes",NODES_COMMISSION_ENDPOINT:"/commission/nodes",NODES_DECOMMISSION_ENDPOINT:"/decommission/nodes",NODES_MAINTENANCE_ENDPOINT:"/maintenance/nodes",NODES_LAST_JOB_ENDPOINT:"/info/job/last",NODES_ACTIVE_JOB_ENDPOINT:"/info/job/active",NODES_SETTINGS_SET_ENDPOINT:"/globals",NODES_SETTINGS_GET_ENDPOINT:"/info/globals",REFRESH_INTERVAL:5e3,CIDR_REGEX:"^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]).){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(/([0-9]|[1-2][0-9]|3[0-2]))$",VLAN_REGEX:"^([0-9]{1,4}?-[0-9]{1,4}?)$",VXLAN_REGEX:"^([0-9]{1,8}?-[0-9]{1,8}?)$",NUMBER_REGEX:"^[0-9]*$"}}();angular.module("contiv.utils",[]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();angular.module("contiv.graph").factory("VisualizerDataSource",["DataSource","VisualizerNode","VisualizerLink",function(e,t,o){var n=function(e){function n(e,t,o,i,r,a){_classCallCheck(this,n);var l=_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,t));return l.children_struct=o,l.ancestors_struct=i,l.labels=r,l.selectors=a,l}return _inherits(n,e),_createClass(n,[{key:"hasChild",value:function(e){return null!=this.children_struct[e]}},{key:"setAncestors",value:function(){var e=this,t=!1;_.forEach(e.nodes,function(o){o.ancestors=e.ancestors_struct[o.id]||[],_.isEmpty(o.ancestors)===!1?o.parent=o.ancestors[0]:0==_.includes(e.children_struct.topLevel,o.id)&&(o.ancestors.push("client"),e.ancestors_struct[o.id]=["client"],t===!1&&(t=!0,e.children_struct.topLevel.push("client"),e.children_struct.client=[]),e.children_struct.client.push(o.id))})}},{key:"getTopLevelFlow",value:function(){return this.getFlowBetweenSet(this.children_struct.topLevel)}},{key:"getFlowBetweenSet",value:function(e){for(var t=this.nodes,o={},n=0;n<t.length;n++){var i=t[n];if(null===i.ancestors)o[i.id]=i.name;else for(var r=0;r<e.length;r++)if(i.ancestors.indexOf(e[r])>-1){o[i.id]=e[r];break}}for(var a=this.links,l=[],n=0;n<a.length;n++){var s=[];s.source=o[a[n].source]||a[n].source,s.target=o[a[n].target]||a[n].target,s.weight=a[n].weight,l.push(s)}for(var c=[],n=0;n<e.length;n++){var u=[];u.id=e[n],u.text=this.nodeIdToName(e[n])||e[n],u.ancestors=this.ancestors_struct[e[n]]||this.ancestors_struct[u.text]||[],_.isEmpty(u.ancestors)===!1?u.parent=u.ancestors[0]:u.parent=null,c.push(u)}return{nodeData:c,linkData:l}}},{key:"processNodeData",value:function(e){var o=[];return _.forEach(e,function(e){var n=new t.Node(null,null,e.id,e.text,null,e.parent,e.ancestors,null,null);o.push(n)}),o}},{key:"processLinkData",value:function(e,t){function n(e,t){for(var o=0;o<t.length;o++)if(e==t[o].id)return t[o]}for(var i=[],r={},a=0;a<e.length;a++)if(e[a].source!=e[a].target){var l=n(e[a].source,t),s=n(e[a].target,t),c=e[a].weight;if(null==l||null==s)continue;if(void 0===r[l.id+"-"+s.id]){var u=new o.Link(l,s,c);r[l.id+"-"+s.id]=u,i.push(u)}else{var d=r[l.id+"-"+s.id];d.setWeight(d.getRawWeight()+c),d.increaseCount()}}return i}}]),n}(e.DataSource);return{DataSource:n}}]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();angular.module("contiv.graph").factory("Graph",["PolicyService",function(e){var t=function(){function t(o,n,i){_classCallCheck(this,t);var r=this;r.nodes=n||[],r.links=i||[],r.defaultNodePolicies=[],r.defaultPathPolicies=[],r.svgPolicy=new e.Policy,r.state={canZoom:!0,canPan:!0,initForce:!1,disableUpdate:!1},r.consts={circleGClass:"conceptG",graphClass:"graph",pathClass:"path",nodeClass:"circle",nodeText:"nodeText",startRadius:50,maxRadius:60,padding:5,displayOffset:60},o.on("mouseover",function(e){r.svgPolicy.mouseover.call(this,e)}).on("dblclick",function(e){r.svgPolicy.dblclick.call(this,e)}).on("contextmenu",function(e){r.svgPolicy.contextmenu.call(this,e)}).on("mouseout",function(e){r.svgPolicy.mouseout.call(this,e)}).on("mousedown",function(e){r.svgPolicy.mousedown.call(this,e)}).on("mouseup",function(e){r.svgPolicy.mouseup.call(this,e)});var a=o.append("svg:defs");a.append("svg:marker").attr("id","end-arrow").attr("viewBox","0 -5 10 10").attr("refX",20).attr("refY",-1).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5"),a.append("svg:marker").attr("id","mark-end-arrow").attr("viewBox","0 -5 10 10").attr("refX",7).attr("markerWidth",3.5).attr("markerHeight",3.5).attr("orient","auto").append("svg:path").attr("d","M0,-5L10,0L0,5"),r.svg=o,r.svgG=o.append("g").classed(r.consts.graphClass,!0);var l=r.svgG;r.paths=l.append("g").selectAll("g"),r.circles=l.append("g").selectAll("g"),r.initNodes(),r.initLinks(),r.setPositions();var s=function(){r.onWindowResize(o)};r.bindings={resize:s},$(window).resize(s)}return _createClass(t,[{key:"destroy",value:function(){var e=this;_(e.defaultNodePolicies).forEach(function(e){e.destroy()}),_(e.defaultPathPolicies).forEach(function(e){e.destroy()}),e.svgPolicy.destroy();for(var t in e.bindings)$(window).off(t,e.bindings[t])}},{key:"initNodes",value:function(){var e=this;_.forEach(e.nodes,function(t){t.initialize(e)})}},{key:"initLinks",value:function(){var e=this;_.forEach(e.links,function(t){t.initialize(e)})}},{key:"findNodeById",value:function(e){for(var t=this,o=0;o<t.nodes.length;o++)if(e===t.nodes[o].id)return t.nodes[o]}},{key:"findD3Node",value:function(e){var t,o=this;return o.circles.each(function(o){o.id===e&&(t=d3.select(this))}),t}},{key:"installDragPolicy",value:function(e){this.drag=e}},{key:"installSvgPolicy",value:function(e){this.svgPolicy=e}},{key:"installDefaultNodePolicy",value:function(e){var t=this;t.defaultNodePolicies.push(e),e.initialize(t)}},{key:"uninstallDefaultNodePolicy",value:function(e){var t;t="string"==typeof e?e:e.policyName,_(thisGraph.defaultNodePolicies).forEach(function(e,o){e.policyName===t&&(e.destroy(),thisGraph.defaultNodePolicies.splice(o,1))})}},{key:"getNodePolicy",value:function(e){var t=this;_(t.defaultNodePolicies).forEach(function(t,o){return t.policyName===e?t:void 0})}},{key:"installDefaultPathPolicy",value:function(e){var t=this;t.defaultPathPolicies.push(e),e.initialize(t)}},{key:"uninstallDefaultPathPolicy",value:function(e){var t,o=this;t="string"==typeof e?e:e.policyName,_(o.defaultPathPolicies).forEach(function(e,n){e.policyName===t&&(e.destroy(),o.defaultPathPolicies.splice(n,1))})}},{key:"pathPolicyEvent",value:function(e,t,o){var n=this;_(n.defaultPathPolicies).forEach(function(n){n[e](t,o)})}},{key:"nodePolicyEvent",value:function(e,t,o){var n=this;_.forEach(n.defaultNodePolicies,function(n){n[e](t,o)})}},{key:"installZoomPolicy",value:function(e){this.dragSvg=e,this.svg.call(this.dragSvg)}},{key:"onWindowResize",value:function(e){}},{key:"insertTitleLinebreaks",value:function(e,t){for(var o=this,n=t.split(/\s+/g),i=n.length,r=e.append("text").attr("class",o.consts.nodeText).attr("text-anchor","middle").attr("dy","-"+7.5*(i-1)),a=0;a<n.length;a++){var l=r.append("tspan").text(n[a]);a>0&&l.attr("x",0).attr("dy","15")}}},{key:"spliceLinksForNode",value:function(e){var t=this,o=t.links.filter(function(t){return t.source===e||t.target===e});o.map(function(e){t.links.splice(t.links.indexOf(e),1)})}},{key:"addNode",value:function(e){var t=this;t.nodes.push(e),e.initialize(t),t.updateGraph()}},{key:"removeNode",value:function(e){var t=this;t.nodes.splice(t.nodes.indexOf(e),1),t.spliceLinksForNode(e),t.updateGraph()}},{key:"addLink",value:function(e){var t=this;t.links.push(e),e.initialize(t),t.updateGraph()}},{key:"removeLink",value:function(e){var t=this;t.links.splice(t.links.indexOf(e),1),e.initialize(t),t.updateGraph()}},{key:"updateExistingPaths",value:function(e){e.each(function(e){e.updateAttr(d3.select(this),e)})}},{key:"updateNewPaths",value:function(e){var t=this;t.initLinks(),e.each(function(e){e.newPathAttr(d3.select(this),e)}),e.on("mouseover",function(e){e.hasPolicy?e.pathPolicyEvent("mouseover",d3.select(this),e):t.pathPolicyEvent("mouseover",d3.select(this),e)}).on("dblclick",function(e){e.hasPolicy?e.pathPolicyEvent("dblclick",d3.select(this),e):t.pathPolicyEvent("dblclick",d3.select(this),e)}).on("contextmenu",function(e){e.hasPolicy?e.pathPolicyEvent("contextmenu",d3.select(this),e):t.pathPolicyEvent("contextmenu",d3.select(this),e)}).on("mouseout",function(e){e.hasPolicy?e.pathPolicyEvent("mouseout",d3.select(this),e):t.pathPolicyEvent("mouseout",d3.select(this),e)}).on("mousedown",function(e){e.hasPolicy?e.pathPolicyEvent("mousedown",d3.select(this),e):t.pathPolicyEvent("mousedown",d3.select(this),e)}).on("mouseup",function(e){e.hasPolicy?e.pathPolicyEvent("mouseup",d3.select(this),e):t.pathPolicyEvent("mouseup",d3.select(this),e)}).call(t.drag)}},{key:"updateExistingNodes",value:function(){var e=this;e.circles=this.circles.data(e.nodes,function(e){return e.id}).each(function(e){e.updateAttr(d3.select(this),e)})}},{key:"updateNewNodes",value:function(e){var t=this;e.each(function(e){null==e.graph&&e.initialize(t),e.newNodeAttr(d3.select(this),e)}),e.on("mouseover",function(e){e.hasPolicy?e.nodePolicyEvent("mouseover",d3.select(this),e):t.nodePolicyEvent("mouseover",d3.select(this),e)}).on("dblclick",function(e){e.hasPolicy?e.nodePolicyEvent("dblclick",d3.select(this),e):t.nodePolicyEvent("dblclick",d3.select(this),e)}).on("contextmenu",function(e){e.hasPolicy?e.nodePolicyEvent("contextmenu",d3.select(this),e):t.nodePolicyEvent("contextmenu",d3.select(this),e)}).on("mouseout",function(e){e.hasPolicy?e.nodePolicyEvent("mouseout",d3.select(this),e):t.nodePolicyEvent("mouseout",d3.select(this),e)}).on("mousedown",function(e){e.hasPolicy?e.nodePolicyEvent("mousedown",d3.select(this),e):t.nodePolicyEvent("mousedown",d3.select(this),e)}).on("mouseup",function(e){e.hasPolicy?e.nodePolicyEvent("mouseup",d3.select(this),e):t.nodePolicyEvent("mouseup",d3.select(this),e)}).call(t.drag),e.append("circle").attr("r",function(e){return String(e.radius)}),e.each(function(e){t.insertTitleLinebreaks(d3.select(this),e.text)})}},{key:"d3ForceCollide",value:function(e){var t=this,o=t.consts,n=t.nodes,i=d3.geom.quadtree(n);return function(t){var n=t.radius+o.maxRadius+o.padding,r=t.x-n,a=t.x+n,l=t.y-n,s=t.y+n;i.visit(function(n,i,c,u,d){if(n.point&&n.point!==t){var p=t.x-n.point.x,f=t.y-n.point.y,v=Math.sqrt(p*p+f*f),h=t.radius+n.point.radius+o.padding;h>v&&(v=(v-h)/v*e,t.x-=p*=v,t.y-=f*=v,n.point.x+=p,n.point.y+=f)}return i>a||r>u||c>s||l>d})}}},{key:"d3ForceTick",value:function(e,t,o){for(var n=this,i=n.consts,r=i.displayOffset,a=n.nodes,l=d3.geom.quadtree(n.nodes),s=0,c=a.length;++s<c;)l.visit(this.d3ForceCollide(a[s]));n.circles.each(this.d3ForceCollide(.5)).attr("cx",function(e){return e.x=Math.max(e.radius+r,Math.min(t-r-e.radius,e.x))}).attr("cy",function(e){return e.y=Math.max(e.radius+r,Math.min(o-r-e.radius,e.y))}),n.paths.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y})}},{key:"d3ForceStart",value:function(){var e=this;e.paths.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y})}},{key:"d3ForceEnd",value:function(){var e=this;e.circles.attr("cx",function(e){return e.x}).attr("cy",function(e){return e.y}),e.paths.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y})}},{key:"d3ForceBounds",value:function(){var e=$("#visualization-graph").width(),t=$("#visualization-graph").height(),o=e,n=t;return{width:o,height:n}}},{key:"setForce",value:function(e){var t=this,o=t.nodes,n=t.links;if(!_.isEmpty(o)){var i=t.d3ForceBounds(),r=d3.layout.force().size([i.width,i.height]).nodes(o).charge(function(e){return-6e3}).links(n);r.linkDistance(i.width/3),r.linkStrength(.2),r.gravity(.2),r.on("tick",function(e){t.d3ForceTick.call(t,e,i.width,i.height)}),r.on("start",function(){t.d3ForceStart.call(t)}),r.on("end",function(){t.d3ForceEnd.call(t)}),r.start();for(var a=0;r.alpha()>.01&&150>a;)r.tick(),a+=1;r.stop(),null!=e&&e()}}},{key:"setPositions",value:function(){for(var e=this,t=e.consts.displayOffset,o=$("#visualization-graph").width(),n=$("#visualization-graph").height(),i=o-2*t,r=n-2*t,a=e.nodes,l=0;l<a.length;l++)a[l].radius=a[l].radius||e.consts.startRadius,null!=a[l].x&&null!=a[l].y||(a[l].x=i/2+a[l].radius+t,a[l].y=r/2+a[l].radius+t)}},{key:"updateGraph",value:function(e){var t=this,o=t.consts,n=t.state;if(!t.state.disableUpdate){this.updateExistingNodes();var i=t.circles.enter().append("g");i.classed(o.circleGClass,!0),t.circles.exit().remove(),0==n.initForce?(t.setForce(function(){t.updateNewNodes.call(t,i)}),n.initForce=!0):this.updateNewNodes(i),t.paths=t.paths.data(t.links,function(e){return String(e.source.id)+"+"+String(e.target.id)});var r=t.paths;this.updateExistingPaths(r);var a=r.enter().append("path").style("marker-end","url(#end-arrow)").classed("link",!0);this.updateNewPaths(a),r.exit().remove(),null!=e&&e()}}}]),t}();return{Graph:t}}]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();angular.module("contiv.graph").factory("VisualizerGraph",["Graph",function(e){var t=function(e){function t(e,o,n,i){_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o,n)),a=r;a.state.transition=[],a.consts.edge_buffer=200,a.consts.radiusDecay=1,a.consts.containerClass="container",a.dataSource=i;var l=d3.behavior.drag().origin(function(e){return{x:e.x,y:e.y}}).on("dragstart",function(){}).on("drag",function(e){d3.select(this).attr("transform",function(e,t){return e.x+=d3.event.dx,e.y+=d3.event.dy,"translate("+[e.x,e.y]+")"}),a.updateGraph()}).on("dragend",function(){});a.drag=l;var s=d3.behavior.zoom().on("zoom",function(){return null!=d3.event.sourceEvent&&d3.event.sourceEvent.ctrlKey?!1:(a.zoomed.call(a),!0)}).on("zoomstart",function(e,t){});return a.dragSvg=s,a.svg.call(s).on("dblclick.zoom",null),r}return _inherits(t,e),_createClass(t,[{key:"zoomed",value:function(e,t){var o=this;if(1!=o.state.rightClick){if(this.state.justScaleTransGraph=!0,null!=e&&null!=t){var n=o.dragSvg;n.scale(t),n.translate(e);var i=function(){n.scale(t),n.translate(e)},r="zoom"+e;return void d3.select("."+this.consts.graphClass).transition(r).delay(100).duration(750).attr("transform","translate("+n.translate()+") scale("+n.scale()+")").each("end",i)}o.state.canZoom&&d3.select("."+this.consts.graphClass).attr("transform","translate("+o.dragSvg.translate()+") scale("+o.dragSvg.scale()+")")}}},{key:"onWindowResize",value:function(e){var t=document.getElementsByTagName("body")[0],o=$("#visualization-graph").offset(),n=$("#visualization-graph").width(),i=t.clientHeight;e.attr("width",n).attr("height",i-o.top-20)}},{key:"updateLinkData",value:function(){for(var e=this,t=[],o=0;o<e.nodes.length;o++)t.push(e.nodes[o].id);var n=e.dataSource.getFlowBetweenSet(t),i=n.linkData;e.links=e.dataSource.processLinkData(i,e.nodes),this.initNodes(),this.initLinks(),e.updateGraph()}}]),t}(e.Graph);return{Graph:t}}]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();angular.module("contiv.graph").factory("Link",[function(){var e=function(){function e(t,o){_classCallCheck(this,e),this.source=t,this.target=o,this.hasPolicy=!1,this.pathPolicies=[],this.graph=null,this.initialized=!1}return _createClass(e,[{key:"initialize",value:function(e){0==this.initialized&&(this.initialized=!0,this.graph=e)}},{key:"updateAttr",value:function(e,t){e.style("marker-end","url(#end-arrow)").attr("d",arrowPath)}},{key:"newPathAttr",value:function(e,t){e.attr("d",arrowPath)}},{key:"arrowPath",value:function(){var e=this,t=e.target.x-e.source.x,o=e.target.y-e.source.y,n=Math.sqrt(t*t+o*o);return"M"+e.source.x+","+e.source.y+"A"+n+","+n+" 0 0,1 "+e.target.x+","+e.target.y}},{key:"installPathPolicy",value:function(e){this.hasPolicy=!0,this.pathPolicies.push(e),e.initialize(this.graph)}},{key:"uninstallPathPolicy",value:function(e){var t,o=this;t="string"==typeof e?e:e.policyName,_(o.pathPolicies).forEach(function(e,n){e.policyName===t&&(e.destroy(),o.pathPolicies.splice(n,1))}),0===o.pathPolicies.length&&(o.hasPolicy=!1)}},{key:"pathPolicyEvent",value:function(e,t,o){_(o.pathPolicies).forEach(function(n){n[e](t,o)})}}]),e}();return{Link:e}}]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),_get=function e(t,o,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,o);if(void 0===i){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,o,n)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(n)};angular.module("contiv.graph").factory("VisualizerLink",["Link",function(e){var t=function(e){function t(e,o,n){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o));return i.weight=n,i.count=1,i}return _inherits(t,e),_createClass(t,[{key:"increaseCount",value:function(){this.count+=1}},{key:"qtipHelper",value:function(){var e,t=this,o=(t.target.x-t.source.x)/2,n=(t.target.y-t.source.y)/2;return e=t.source.x<t.target.x?{my:"top center",at:"center center",target:[o,n],adjust:{y:10}}:{my:"bottom center",at:"center center",target:[o,n],adjust:{y:-10}}}},{key:"initialize",value:function(e){if(0==this.initialized){_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e);var o=e.state.VisualizerLink;null==o&&(o=e.state.VisualizerLink={},o.maxWeight=null,o.useAvgWeight=!0),this.updateMaxWeight()}}},{key:"setUseAvgWeight",value:function(e){this.graph.state.VisualizerLink.useAvgWeight=!!e}},{key:"setWeight",value:function(e){this.weight=e}},{key:"getRawWeight",value:function(){return this.weight}},{key:"getWeight",value:function(){var e=this.graph,t=e.state.VisualizerLink;if(t.useAvgWeight){var o=this.weight/this.count;return o}return this.weight}},{key:"updateMaxWeight",value:function(){var e=this.graph,t=e.state.VisualizerLink,o=_.maxBy(e.links,function(e){return null!=e.graph?e.getWeight():0});t.maxWeight=o.getWeight()}},{key:"updateAttr",value:function(e,t){var o=this.graph,n=o.state.VisualizerLink;this.updateMaxWeight();var i=d3.scale.linear().domain([0,n.maxWeight]).range(["#ffb366","#F92606"]);n.colorScale=i,e.style("marker-end","url(#end-arrow)").classed(o.consts.selectedClass,function(e){return e===n.selectedEdge}).attr("d",this.arrowPath.call(t)).transition("existingPathTransition").duration(750).attr("stroke",function(e){var t=i(e.getWeight());return t})}},{key:"newPathAttr",value:function(e,t){var o=this.graph,n=o.state.VisualizerLink;this.updateMaxWeight();var i=d3.scale.linear().domain([0,n.maxWeight]).range(["#ffb366","#F92606"]);e.transition("newPathTransition").duration(750).attrTween("opacity",function(e){return d3.interpolateString(0,1)}).attr("stroke",function(e){var t=i(e.getWeight());return t}).attr("d",this.arrowPath.call(t))}}]),t}(e.Link);return{Link:t}}]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();angular.module("contiv.graph").factory("Node",[function(){var e=function(){function e(t,o,n,i,r){_classCallCheck(this,e),this.x=t,this.y=o,this.radius=r,this.id=n,this.text=i,this.radius=r,this.hasPolicy=!1,this.policy=null,this.nodePolicies=[],this.graph=null,this.initialized=!1}return _createClass(e,[{key:"initialize",value:function(e){0==this.initialized&&(this.initialized=!0,this.graph=e)}},{key:"updateAttr",value:function(e,t){e.attr("transform",function(e){return"translate("+e.x+","+e.y+")"})}},{key:"newNodeAttr",value:function(e,t){}},{key:"setRadius",value:function(e){this.radius=e}},{key:"installNodePolicy",value:function(e){this.hasPolicy=!0,this.nodePolicies.push(e),e.initialize(this.graph)}},{key:"uninstallNodePolicy",value:function(e){var t,o=this;t="string"==typeof e?e:e.policyName,_(o.nodePolicies).forEach(function(e,n){e.policyName===t&&(e.destroy(),o.nodePolicies.splice(n,1))}),0===o.nodePolicies.length&&(o.hasPolicy=!1)}},{key:"nodePolicyEvent",value:function(e,t,o){_.forEach(this.nodePolicies,function(n){n[e](t,o)})}}]),e}();return{Node:e}}]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();angular.module("contiv.graph").factory("VisualizerNode",["Node",function(e){var t=function(e){function t(e,o,n,i,r,a,l,s,c){_classCallCheck(this,t);var u=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o,n,i,r));return u.parent=a,u.ancestors=l,null==s?u.xStart=e:u.xStart=s,null==c?u.yStart=o:u.yStart=c,u}return _inherits(t,e),_createClass(t,[{key:"newNodeAttr",value:function(e,t){var o=this.graph;null!=o.consts.containerClass&&null==o.dataSource.children_struct[t.id]&&e.classed(o.consts.containerClass,!0),e.transition("nodePositionTransition").duration(750).attrTween("transform",function(e){if(null!=e.xStart&&null!=e.yStart){var t=e.xStart,o=e.yStart;return e.xStart=e.x,e.yStart=e.y,d3.interpolateString("translate("+t+","+o+")","translate("+e.x+","+e.y+")")}return d3.interpolateString("translate("+e.x+","+e.y+")","translate("+e.x+","+e.y+")")})}}]),t}(e.Node);return{Node:t}}]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),_get=function t(e,o,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,o);if(void 0===i){var r=Object.getPrototypeOf(e);return null===r?void 0:t(r,o,n)}if("value"in i)return i.value;
var a=i.get;if(void 0!==a)return a.call(n)};angular.module("contiv.graph").factory("NodeSelectionPolicy",["Policy",function(e){var t=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"NodeSelectionPolicy"))}return _inherits(t,e),_createClass(t,[{key:"initialize",value:function(e){if(!this.initialized){_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e);var o=e.state.NodeSelectionPolicy={};o.selectedNodes=[];var n=e.consts.NodeSelectionPolicy={};n.selectedClass="selected";var i=e.drag;i.on("drag",function(t){var o=e;if(null!=o.consts.NodeSelectionPolicy){var n=o.consts.NodeSelectionPolicy.selectedClass,i=d3.selectAll("."+n);-1==i[0].indexOf(this)&&(i.classed(n,!1),i=d3.select(this),i.classed(n,!0)),i.attr("transform",function(e,t){return e.x+=d3.event.dx,e.y+=d3.event.dy,"translate("+[e.x,e.y]+")"}),o.updateGraph()}})}}},{key:"addSelectNode",value:function(e,t){var o=this.graph,n=o.state.NodeSelectionPolicy,i=o.consts.NodeSelectionPolicy;e.classed(i.selectedClass,!0),n.selectedNodes.push(t)}},{key:"removeSelectFromNode",value:function(e,t){var o=this.graph,n=o.state.NodeSelectionPolicy,i=o.consts.NodeSelectionPolicy;o.circles.filter(function(e){return e.id===t.id}).classed(i.selectedClass,!1);var r=n.selectedNodes.indexOf(t);n.selectedNodes.splice(r,1)}},{key:"removeAllSelectedNodes",value:function(){var e=this.graph,t=e.state.NodeSelectionPolicy,o=e.consts.NodeSelectionPolicy;e.circles.classed(o.selectedClass,!1),t.selectedNodes=[]}},{key:"mousedown",value:function(e,t){var o=this.graph,n=o.state.NodeSelectionPolicy;d3.event.stopPropagation(),d3.event.ctrlKey?n.selectedNodes.indexOf(t)>-1?this.removeSelectFromNode(e,t):this.addSelectNode(e,t):-1==n.selectedNodes.indexOf(t)&&this.removeAllSelectedNodes()}},{key:"mouseup",value:function(e,t){var o=this.graph,n=o.state.NodeSelectionPolicy;d3.event.ctrlKey||n.selectedNodes.length<=1&&this.removeSelectFromNode(e,t)}}]),t}(e.Policy);return{Policy:t}}]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();angular.module("contiv.graph").factory("PathChangeViewPolicy",["Policy",function(e){var t=function(e){function t(e){_classCallCheck(this,t);var o=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"PathChangeViewPolicy"));return o.$state=e,o}return _inherits(t,e),_createClass(t,[{key:"generateList",value:function(e){var t=this,o=[],n=function i(e,o){for(var n=t.graph.dataSource.children_struct[e],r=0;r<n.length;r++){var a=n[r];if(t.graph.dataSource.hasChild(a)===!0){var l=i(a,o);o.concat(l)}else o.push(a)}};return n(e,o),o}},{key:"viewEdge",value:function(e){var t=[],o=[],n=e.source.id,i=e.target.id;t=this.graph.dataSource.hasChild(n)===!0?this.generateList(n):[n],o=this.graph.dataSource.hasChild(i)===!0?this.generateList(i):[i],this.$state.go("contiv.menu.visualization.edge",{sourceName:n,targetName:i,sourceList:t,targetList:o})}},{key:"mousedown",value:function(e,t){this.viewEdge(t)}}]),t}(e.Policy);return{Policy:t}}]),angular.module("contiv.applicationgroups",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.applicationgroups",{url:"/applicationgroups","abstract":!0,template:'<div ui-view class="ui container"/>'})}]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();angular.module("contiv.graph").factory("Policy",[function(){var e=function(){function e(t){_classCallCheck(this,e),this.policyName=t,this.graph=null,this.initialized=!1}return _createClass(e,[{key:"initialize",value:function(e){this.initialized||(this.initialized=!0,this.graph=e)}},{key:"mouseover",value:function(e,t){}},{key:"dblclick",value:function(e,t){}},{key:"contextmenu",value:function(e,t){}},{key:"mouseout",value:function(e,t){}},{key:"mousedown",value:function(e,t){}},{key:"mouseup",value:function(e,t){}},{key:"destroy",value:function(){}}]),e}();return{Policy:e}}]),angular.module("contiv.dashboard",["contiv.models"]).config(["$stateProvider",function(e){e.state("contiv.menu.dashboard",{url:"/dashboard",component:"dashboard"})}]),angular.module("contiv.graph").factory("PolicyService",["Policy","QTipPolicy","PathChangeViewPolicy","NodeSelectionPolicy","SplitJoinNodePolicy","SplitJoinViewPolicy","SaveStatePolicy",function(e,t,o,n,i,r,a){return{Policy:e.Policy,QTipPolicy:t.Policy,PathChangeViewPolicy:o.Policy,NodeSelectionPolicy:n.Policy,SplitJoinNodePolicy:i.Policy,SplitJoinViewPolicy:r.Policy,SaveStatePolicy:a.Policy}}]),angular.module("contiv.login",["contiv.utils"]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),_get=function o(e,t,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(void 0===i){var r=Object.getPrototypeOf(e);return null===r?void 0:o(r,t,n)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(n)};angular.module("contiv.graph").factory("QTipPolicy",["Policy",function(e){var t=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"QTipPolicy"))}return _inherits(t,e),_createClass(t,[{key:"initialize",value:function(e){if(!this.initialized){_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e);var o=this,n=e.state.QTipPolicy={};n.mousedown=!1,e.consts.QTipPolicy={},$("#visualization-graph").mouseup(function(e){n.mouseup=!1});var i=e.updateNewNodes;e.updateNewNodes=function(t){i.call(e,t),o.updateNewNodes(t)};var r=e.updateNewPaths;e.updateNewPaths=function(t){r.call(e,t),o.updateNewPaths(t)}}}},{key:"destroy",value:function(){$('[id^="qtip"]').remove()}},{key:"mousedown",value:function(e,t){var o=this.graph,n=o.state.QTipPolicy;n.mousedown=!0}},{key:"mouseup",value:function(e,t){var o=this.graph,n=o.state.QTipPolicy;n.mousedown=!1}},{key:"whenQTipAvailable",value:function(e){var t=this,o=500;window.setTimeout(function(){null!=$(document).qtip?e():window.setTimeout(t.whenQTipAvailable(e),o)},o)}},{key:"updateNewNodes",value:function(e){function t(){e.each(function(e){var t,i=this;if(null!=o.dataSource.children_struct[e.id]){t="<b><u>Selectors:</b></u> ";var r=o.dataSource.selectors[e.id],a=!1;for(var l in r)a=!0,t+=l+" : <i>"+r[l]+"</i>,\n ";a===!1&&(t="No Selectors, ")}else{t="<b><u>Labels:</b></u> ";var s=o.dataSource.labels[e.id],a=!1;for(var l in s)a=!0,t+=l+" : <i>"+s[l]+"</i>,\n ";a===!1&&(t="No labels, ")}t=t.slice(0,-2),$(i).qtip({content:{title:e.id,text:t},events:{show:function(){var t=$(i).qtip("api"),r=$("#graphContainer").offset(),a=[r.left+(e.x*o.dragSvg.scale()+o.dragSvg.translate()[0]),r.top+(e.y+e.radius)*o.dragSvg.scale()+o.dragSvg.translate()[1]];return t.set("position.target",a),!n.mousedown}},show:{delay:0,solo:$("#visualization-graph")},style:{classes:"qtip-blue qtip-shadow"},position:{my:"top center",at:"bottom center"},hide:{event:"mousedown mouseleave"}})})}var o=this.graph,n=o.state.QTipPolicy;void 0!=$(document).qtip?t():this.whenQTipAvailable(t)}},{key:"updateNewPaths",value:function(e){var t=this.graph,o=t.state.QTipPolicy;void 0!=$(document).qtip&&e.each(function(e){var t=this,n=d3.select(this).node(),i=(n.getPointAtLength(n.getTotalLength()/2),e.qtipHelper()),r="Bytes: "+e.getWeight();$(t).qtip({content:{text:r},events:{show:function(){return!o.mousedown}},show:{delay:0,solo:$("#graphContainer")},style:{classes:"qtip-blue qtip-shadow"},position:{my:i.my,at:"center center",target:"mouse",adjust:i.adjust},hide:{event:"mousedown mouseleave"}})})}}]),t}(e.Policy);return{Policy:t}}]),angular.module("contiv.menu",[]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();angular.module("contiv.graph").factory("SaveStatePolicy",["Policy",function(e){var t=function(e){function t(e){_classCallCheck(this,t);var o=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"SaveStatePolicy"));return o.savedState=e,o}return _inherits(t,e),_createClass(t,[{key:"initialize",value:function(e){this.graph=e;var t=this;e.destroy=function(){t.graphDestroy.call(e,t.savedState)},e.load=function(o){t.graphLoad.call(e,o)}}},{key:"graphDestroy",value:function(e){var t=this;_(t.defaultNodePolicies).forEach(function(t){t.destroy(e)}),_(t.defaultPathPolicies).forEach(function(t){t.destroy(e)});for(var o in t.bindings)$(window).off(o,t.bindings[o])}},{key:"graphLoad",value:function(e){var t=this;_(t.defaultNodePolicies).forEach(function(t){null!=t.load&&t.load(e)}),_(t.defaultPathPolicies).forEach(function(t){null!=t.load&&t.load(e)})}}]),t}(e.Policy);return{Policy:t}}]),angular.module("contiv.networkpolicies",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies",{url:"/networkpolicies","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.networkpolicies.isolation",{url:"/isolation","abstract":!0,template:"<ui-view/>"}).state("contiv.menu.networkpolicies.isolation.create",{url:"/create",component:"isolationpolicycreate"}).state("contiv.menu.networkpolicies.bandwidth",{url:"/bandwidth","abstract":!0,template:"<ui-view/>"}).state("contiv.menu.networkpolicies.redirection",{url:"/redirection","abstract":!0,template:"<ui-view/>"})}]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),_get=function n(e,t,o){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(void 0===i){var r=Object.getPrototypeOf(e);return null===r?void 0:n(r,t,o)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(o)};angular.module("contiv.graph").factory("SplitJoinNodePolicy",["NodeSelectionPolicy","VisualizerNode",function(e,t){var o=function(e){function o(){_classCallCheck(this,o);var e=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return e.policyName="SplitJoinNodePolicy",e}return _inherits(o,e),_createClass(o,[{key:"initialize",value:function(e){if(!this.initialized){_get(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"initialize",this).call(this,e);var t=e.state.SplitJoinNodePolicy={};t.splitNodes=[]}}},{key:"dblclick",value:function(e,t){var o=this.graph,n=o.state.SplitJoinNodePolicy;d3.event.ctrlKey||(n.selectedNodes.indexOf(t)>-1?this.splitMultipleNodes(n.selectedNodes):(this.removeAllSelectedNodes(),this.splitNode(t)))}},{key:"contextmenu",value:function(e,t){var o=this.graph,n=o.state.NodeSelectionPolicy;if(d3.event.preventDefault(),!d3.event.ctrlKey){var i=n.selectedNodes;if(i.indexOf(t)>-1)for(var r=0;r<i.length;r++)this.joinNode(i[r]);else this.removeAllSelectedNodes(),this.joinNode(t)}}},{key:"__splitNode",value:function(e){var o=this.graph,n=o.state.SplitJoinNodePolicy,i=e.id,r=o.dataSource.children_struct;if(void 0!==r[i]&&!_.isEmpty(r[i])){o.nodes=_.filter(o.nodes,function(t){return t!=e}),o.spliceLinksForNode(e);for(var a=[],l=0;l<o.nodes.length;l++)a.push(o.nodes[l].id);for(var s=[],l=0;l<r[i].length;l++)a.push(r[i][l]),s.push(r[i][l]);var c=o.dataSource.getFlowBetweenSet(a),u=e.x,d=e.y,p=e.ancestors.slice();p.splice(0,0,e.id);for(var f=e.id,v=[],h=e.radius*o.consts.radiusDecay,g=c.nodeData,l=0;l<g.length;l++)if(s.indexOf(g[l].id)>-1){var m=g[l].id,y=g[l].text,w=new t.Node(null,null,m,y,h,f,p,u,d);w.initialize(o),o.nodes.push(w),v.push(w)}return o.links=o.dataSource.processLinkData(c.linkData,o.nodes),o.initNodes(),o.initLinks(),n.splitNodes.push(e.id),v}}},{key:"splitNode",value:function(e){var t=this.__splitNode(e);null!=t&&this.splitNodeEvent(t)}},{key:"splitMultipleNodes",value:function(e){for(var t=(this.graph,[]),o=0;o<e.length;o++){var n=this.__splitNode(e[o]);t=t.concat(n)}this.splitMultipleNodesEvent(n)}},{key:"splitNodeEvent",value:function(e){var t=this.graph;t.setPositions(),t.updateGraph()}},{key:"splitMultipleNodesEvent",value:function(e){var t=this.graph;t.setPositions(),t.updateGraph()}},{key:"__joinNode",value:function(e){var o=this.graph,n=o.state.SplitJoinNodePolicy;if(-1!=o.nodes.indexOf(e)){var i=o.dataSource.children_struct,r=e.id;if(!(i.topLevel.indexOf(r)>-1)){for(var a=[],l=[],s=0;s<o.nodes.length;s++)-1==o.nodes[s].ancestors.indexOf(e.parent)?l.push(o.nodes[s].id):a.push(o.nodes[s]);var c=e.parent;l.push(e.parent);var u=e.radius/o.consts.radiusDecay,d=e.x,p=e.y,f=e.ancestors[1],v=e.ancestors.slice(1),h=new t.Node(d,p,c,c,u,f,v);o.nodes.push(h);for(var g=o.dataSource.getFlowBetweenSet(l),s=0;s<a.length;s++){var m=a[s];o.nodes.splice(o.nodes.indexOf(m),1),o.spliceLinksForNode(m)}return o.links=o.dataSource.processLinkData(g.linkData,o.nodes),o.initNodes(),o.initLinks(),n.splitNodes.splice(n.splitNodes.indexOf(h.id),1),h}}}},{key:"joinNode",value:function(e){var t=this.__joinNode(e);null!=t&&this.joinNodeEvent(t)}},{key:"joinMultipleNode",value:function(e){for(var t=[],o=0;o<e.length;o++){var n=this.__joinNode(e[o]);t.push(n)}this.joinMultipleNodesEvent(t)}},{key:"joinNodeEvent",value:function(e){var t=this.graph;t.updateGraph()}},{key:"joinMultipleNodesEvent",value:function(e){var t=this.graph;t.updateGraph()}}]),o}(e.Policy);return{Policy:o}}]),angular.module("contiv.networks",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.networks",{url:"/networks","abstract":!0,template:'<div ui-view class="ui container"/>'})}]);var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),_get=function i(e,t,o){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var r=Object.getPrototypeOf(e);return null===r?void 0:i(r,t,o)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(o)};angular.module("contiv.graph").factory("SplitJoinViewPolicy",["SplitJoinNodePolicy","VisualizerNode",function(e,t){var o=function(e){function o(){_classCallCheck(this,o);var e=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return e.policyName="SplitJoinViewPolicy",e}return _inherits(o,e),_createClass(o,[{key:"initialize",value:function(e){if(!this.initialized){_get(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"initialize",this).call(this,e);var t=e.state.SplitJoinViewPolicy={};t.savedStates=[],t.eventHistory=[],t.focusGroups=[],t.foci=[],t.zooms={},t.layout={},t.layoutDefault=null,t.zoomDefault=null,t.nodeIdsToReshow=null,t.backButtonElem=null,t.titleElem=null;var n=e.consts.SplitJoinViewPolicy={};n.boundary=.8,e.d3ForceBounds=this.d3ForceBounds,e.d3ForceTick=this.d3ForceTick,e.d3ForceStart=this.d3ForceStart,e.d3ForceEnd=this.d3ForceEnd}}},{key:"installBackButton",value:function(e){var t=this.graph,o=this,n=t.state.SplitJoinViewPolicy;n.backButtonElem=e,n.backButton=function(){n.eventHistory.length>0&&o.undoLastEvent.call(o)}}},{key:"installTitle",value:function(e){var t=this.graph,o=t.state.SplitJoinViewPolicy;o.titleElem=e}},{key:"destroy",value:function(e){null!=e&&this.save(e)}},{key:"save",value:function(e){var t=this.graph,o=t.state.SplitJoinViewPolicy,n=t.nodes,i=t.links,r=null;null!=o.titleElem&&(r=o.titleElem.text());var a=o.focusGroups,l=o.eventHistory,s=o.zooms,c=o.layout,u=o.layoutDefault,d=o.zoomDefault,p={nodes:n,links:i,states:o.savedStates,currTitle:r,focusGroups:a,eventHistory:l,zooms:s,layout:c,layoutDefault:u,zoomDefault:d};e.SplitJoinViewPolicy=p}},{key:"load",value:function(e){var t=this,o=this.graph,n=o.state.SplitJoinViewPolicy;e=e.SplitJoinViewPolicy,n.savedStates=e.states,o.links=e.links,o.nodes=e.nodes;var i=e.currTitle;null!=n.titleElem&&n.titleElem.text(i),n.eventHistory=e.eventHistory,n.focusGroups=e.focusGroups,n.zooms=e.zooms,n.layout=e.layout,n.layoutDefault=e.layoutDefault,n.zoomDefault=e.zoomDefault,null!=n.backButtonElem&&n.eventHistory.length>0&&n.backButtonElem.fadeTo("slow",1);var r=o.dataSource.children_struct;_.forEach(o.nodes,function(e){e.SplitJoinViewPolicy={},_.includes(r[n.focusGroups[0]],e.id)?e.SplitJoinViewPolicy.type="focus":e.SplitJoinViewPolicy.type="connected"});var a;if(0===n.focusGroups.length){a=n.layoutDefault;var l=n.zoomDefault;o.zoomed(l[0],l[1])}else{var l=n.zooms[n.focusGroups];null!=l&&o.zoomed(l[0],l[1]),a=n.layout[n.focusGroups]}_.forEach(o.nodes,function(e){var t=a[e.id];null==t&&console.log(a,e),e.x=t.x,e.y=t.y}),o.state.initForce=!0,o.updateGraph.call(o,function(){t.updateGraphCallback.call(t)})}},{key:"dblclick",value:function(e,t){var n=this.graph,i=n.state.SplitJoinViewPolicy,r=t.id,a=n.dataSource.children_struct;if(void 0!==a[r]&&!_.isEmpty(a[r])){if(i.focusGroups.slice(),0===i.focusGroups.length?i.focusGroups.push(t.id):_.includes(a[i.focusGroups[0]],t.id)?i.focusGroups[0]=t.id:1===i.focusGroups.length?i.focusGroups.push(t.id):_.includes(a[i.focusGroups[1]],t.id)&&(i.focusGroups[1]=t.id),2===i.focusGroups.length&&i.focusGroups[1]===t.id){var l=[t],s=[],c=a[i.focusGroups[0]];_.forEach(n.nodes,function(e){_.includes(c,e.id)&&(s.push(e.id),l.push(e))})}else{var l=[t],s=[];_.forEach(n.links,function(e){e.source===t&&-1==s.indexOf(e.target.id)?(e.target.SplitJoinViewPolicy={},e.target.SplitJoinViewPolicy.type="connected",s.push(e.target.id),l.push(e.target)):e.target===t&&-1==s.indexOf(e.source.id)&&(e.source.SplitJoinViewPolicy={},e.source.SplitJoinViewPolicy.type="connected",s.push(e.source.id),l.push(e.source))})}n.circles.each(function(e){e.id!==t.id&&n.spliceLinksForNode(e)}),n.updateGraph(),n.state.disableUpdate=!0,n.circles.each(function(e){e.id!==t.id?d3.select(this).transition().delay(200).duration(400).style("opacity",0):null!=$(this).qtip&&$(this).qtip("disable",!0)});var u=n.dragSvg.translate(),d=n.dragSvg.scale(),p=parseFloat(n.svg.style("width"))/d/2+u[0],f=parseFloat(n.svg.style("height"))/d/2+u[1];t.xStart=t.x,t.yStart=t.y,t.x=p,t.y=f,e.transition("nodePositionTransition").duration(750).attrTween("transform",function(e){var t=e.xStart,o=e.yStart;return e.xStart=e.x,e.yStart=e.y,d3.interpolateString("translate("+t+","+o+")","translate("+e.x+","+e.y+")")});var v=_get(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"splitNode",this);i.nodeIdsToReshow=s;var h=this;setTimeout(function(){n.nodes=l,v.call(h,t)},750)}}},{key:"updateGraphCallback",value:function(){var e=this.graph,t=e.state.SplitJoinViewPolicy;e.circles.each(function(e){d3.select(this).transition().duration(400).style("opacity",1),d3.select(this).classed("focus",!1),d3.select(this).classed("connected",!1),null!=e.SplitJoinViewPolicy&&("focus"===e.SplitJoinViewPolicy.type?d3.select(this).classed("focus",!0):"connected"===e.SplitJoinViewPolicy.type&&d3.select(this).classed("connected",!0))}),t.nodeIdsToReshow=null,e.updateGraph()}},{key:"setPositions",value:function(){function e(e,t){return Math.floor(Math.random()*(t-e+1))+e}var t=this.graph,o=this,n=t.consts,i=n.displayOffset,r=t.nodes,a=o.d3ForceBounds.call(t);_.forEach(r,function(t){if(null==t.x||null==t.y){var o=e(t.radius+i,a.width-t.radius-i),n=e(t.radius+i,a.height-t.radius-i);t.x=o,t.y=n}})}},{key:"d3ForceStart",value:function(){var e=this;e.circles.attr("cx",function(t){return null!=t.xStart&&(t.xStart=t.xStart*e.dragSvg.scale()+e.dragSvg.translate()[0]),t.x}).attr("cy",function(t){return null!=t.yStart&&(t.yStart=t.yStart*e.dragSvg.scale()+e.dragSvg.translate()[1]),t.y}),e.paths.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y})}},{key:"d3ForceEnd",value:function(){var e=this,t=e.state,o=t.SplitJoinViewPolicy;if(null==o.layoutDefault){var n={};_.forEach(e.nodes,function(e){n[e.id]={x:e.x,y:e.y}}),o.layoutDefault=n;var i=e.dragSvg.scale(),r=e.dragSvg.translate();o.zoomDefault=[r,i]}e.circles.attr("cx",function(e){return e.x}).attr("cy",function(e){return e.y}),e.paths.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y})}},{key:"d3ForceTick",value:function(e,t,o){function n(e){return function(n){2===u.length?("focus"===n.SplitJoinViewPolicy.type?n.y+=(u[0]-n.y)*e:n.y+=(u[1]-n.y)*e,n.x+=(t/2-n.x)*e):(n.y+=(o/2-n.y)*e,n.x+=(t/2-n.x)*e)}}var i=this,r=i.state,a=i.consts,l=r.SplitJoinViewPolicy,s=a.displayOffset,c=i.dragSvg.scale(),u=l.foci;i.circles.each(this.d3ForceCollide(.5)).each(n(.2*e.alpha)).attr("cx",function(e){return e.x=Math.max((e.radius+s)/c,Math.min(t+(-s-e.radius)/c,e.x))}).attr("cy",function(e){return null==e.SplitJoinViewPolicy||null==e.SplitJoinViewPolicy?(e.y=Math.max((e.radius+s)/c,Math.min(o+(-s-e.radius)/c,e.y)),e.y):"focus"===e.SplitJoinViewPolicy.type?(e.y=Math.max(e.radius+s,Math.min((o+(-s-e.radius)/c)*a.SplitJoinViewPolicy.boundary,e.y)),e.y):"connected"===e.SplitJoinViewPolicy.type?(e.y=Math.max((o+(s-e.radius)/c)*a.SplitJoinViewPolicy.boundary,Math.min(o+(-s-e.radius)/c,e.y)),e.y):void 0}),i.paths.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y})}},{key:"d3ForceBounds",value:function(){function e(e,o){var n=e*o,i=t.consts.startRadius,r=3.5*i,a=n/(r*r);return a}var t=this,o=t.state,n=t.consts,i=n.SplitJoinViewPolicy,r=o.SplitJoinViewPolicy,a=t.nodes,l=n.displayOffset,s=parseFloat(t.svg.style("width")),c=parseFloat(t.svg.style("height")),u=s,d=c,p=e(u-2*l,d-2*l),f=1;a.length>p?(f=p/a.length,t.zoomed(t.dragSvg.translate(),f),u/=f,d/=f):t.zoomed(t.dragSvg.translate(),f);var v,h=r.focusGroups;if(0===h.length)v=[d/2];else{var g=t.dataSource.children_struct[h[0]];i.boundary=g.length/a.length;var m=d*i.boundary,y=d-m;m<2*t.consts.maxRadius&&(i.boundary=2.5*t.consts.maxRadius/d,m=d*i.boundary,y=d-m),y<2*t.consts.maxRadius&&(i.boundary=1-2.5*t.consts.maxRadius/d,m=d*i.boundary,y=d-m),v=[m/2,m+y/2]}return r.foci=v,{width:u,height:d}}},{key:"splitNodeEvent",value:function(e){var t=this,o=this.graph,n=o.state.SplitJoinViewPolicy,i=o.dataSource.children_struct;_.forEach(e,function(e){e.SplitJoinViewPolicy={},_.includes(i[n.focusGroups[0]],e.id)?e.SplitJoinViewPolicy.type="focus":e.SplitJoinViewPolicy.type="connected"});var r=e[0].parent;if(0!==n.eventHistory.length&&n.eventHistory[n.eventHistory.length-1].id===r?n.eventHistory.pop():n.eventHistory.push({id:r,event:"split"}),null!=n.backButtonElem&&0!==n.eventHistory.length&&n.backButtonElem.fadeTo("slow",1),null!=n.titleElem){var a="";n.focusGroups.length>0&&(a+=n.focusGroups[0]),2===n.focusGroups.length&&(a+=" & "+n.focusGroups[1]),n.titleElem.text(a)}o.state.disableUpdate=!1,t.setLayout()}},{key:"setLayout",value:function(){var e,t=this,o=this.graph,n=o.state.SplitJoinViewPolicy;if(0===n.focusGroups.length){e=n.layoutDefault;var i=n.zoomDefault;o.zoomed(i[0],i[1])}else{var i=n.zooms[n.focusGroups];null!=i&&o.zoomed(i[0],i[1]),e=n.layout[n.focusGroups]}if(null!=e)_.forEach(o.nodes,function(t){var o=e[t.id];null==o&&console.log(e,t),t.x=o.x,t.y=o.y}),o.updateGraph.call(o,function(){t.updateGraphCallback.call(t)});else{o.state.initForce=!1,o.updateGraph(function(){t.updateGraphCallback.call(t)}),n.zooms[n.focusGroups]=[o.dragSvg.translate(),o.dragSvg.scale()];var e={};_.forEach(o.nodes,function(t){e[t.id]={x:t.x,y:t.y}}),n.layout[n.focusGroups]=e}}},{key:"__joinNode",value:function(e){var o=this.graph,n=o.state.SplitJoinNodePolicy,i=o.state.SplitJoinViewPolicy;if(-1!=o.nodes.indexOf(e)){var r=o.dataSource.children_struct,a=e.id;if(!(r.topLevel.indexOf(a)>-1)){for(var l=e.parent,s=[],c=[],u=0;u<o.nodes.length;u++)-1==o.nodes[u].ancestors.indexOf(e.parent)?c.push(o.nodes[u].id):s.push(o.nodes[u]);var d=e.parent;c.push(e.parent);var p=o.dataSource.ancestors_struct,r=o.dataSource.children_struct,f=i.focusGroups.indexOf(l);null!=p[l]?i.focusGroups[f]=p[l]:i.focusGroups.splice(f,1);var v=[];if(1===i.focusGroups.length){var h=p[e.id];h.push(i.focusGroups[0]),h=h.concat(p[i.focusGroups[0]]||[]),_.forEach(r.topLevel,function(e){-1===h.indexOf(e)&&-1==c.indexOf(e)&&v.push(e)}),c=c.concat(v)}else 0===i.focusGroups.length&&(_.forEach(r.topLevel,function(e){-1==c.indexOf(e)&&v.push(e)}),c=c.concat(v));var g=e.radius/o.consts.radiusDecay,m=e.x,y=e.y,l=e.ancestors[1],h=e.ancestors.slice(1),w=new t.Node(m,y,d,d,g,l,h);o.nodes.push(w);for(var u=0;u<s.length;u++){var b=s[u];o.nodes.splice(o.nodes.indexOf(b),1),o.spliceLinksForNode(b)}for(var P=o.dataSource.getFlowBetweenSet(c),S=[],k=P.nodeData,u=0;u<k.length;u++)-1!==v.indexOf(k[u].id)&&S.push(k[u]);var E=o.dataSource.processNodeData(S);_.forEach(E,function(e){e.radius=e.radius||o.consts.startRadius}),o.nodes=o.nodes.concat(E),o.links=o.dataSource.processLinkData(P.linkData,o.nodes),1===i.focusGroups.length?_.forEach(o.links,function(e){-1!==v.indexOf(e.source.id)?i.focusGroups[0]===e.target.parent&&v.splice(v.indexOf(e.source.id),1):-1!==v.indexOf(e.target.id)&&i.focusGroups[0]===e.source.parent&&v.splice(v.indexOf(e.target.id),1)}):v=[];var N=[];if(0!==v.length)for(var u=0;u<o.nodes.length&&(-1===v.indexOf(o.nodes[u].id)||(v.splice(v.indexOf(o.nodes[u].id),1),o.spliceLinksForNode(o.nodes[u]),N.push(o.nodes[u]),0!==v.length));u++);return _.forEach(N,function(e){o.nodes.splice(o.nodes.indexOf(e),1)}),o.initNodes(),o.initLinks(),n.splitNodes.splice(n.splitNodes.indexOf(w.id),1),w}}}},{key:"joinNodeEvent",value:function(e){var t=this.graph,o=this,n=t.state.SplitJoinViewPolicy;0!==n.eventHistory.length&&n.eventHistory[n.eventHistory.length-1].id===e.id?n.eventHistory.pop():n.eventHistory.push({id:e.id,event:"join"});var i=t.dataSource.children_struct;if(_.forEach(t.nodes,function(e){e.SplitJoinViewPolicy={},_.includes(i[n.focusGroups[0]],e.id)?e.SplitJoinViewPolicy.type="focus":e.SplitJoinViewPolicy.type="connected"}),null!=n.backButtonElem&&0===n.eventHistory.length&&n.backButtonElem.fadeTo("slow",0),null!=n.titleElem){var r="";n.focusGroups.length>0&&(r+=n.focusGroups[0]),2===n.focusGroups.length&&(r+=" & "+n.focusGroups[1]),n.titleElem.text(r)}o.setLayout()}},{key:"undoLastEvent",value:function(){var e,t=this.graph,n=this,i=t.state.SplitJoinViewPolicy,r=i.eventHistory[i.eventHistory.length-1],a=r.id;if("join"===r.event){e=t.findNodeById(a);var l=t.findD3Node(a);n.dblclick(l,e)}else{var s=t.dataSource.children_struct[a][0];e=t.findNodeById(s),_get(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"joinNode",this).call(n,e)}}}]),o}(e.Policy);return{Policy:o}}]),angular.module("contiv.nodes",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.nodes",{url:"/nodes","abstract":!0,template:'<div ui-view class="ui container"/>'})}]),angular.module("contiv.organizations",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.organizations",{url:"/organizations","abstract":!0,template:'<div ui-view class="ui container"/>'})}]),angular.module("contiv.servicelbs",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.servicelbs",{url:"/servicelbs","abstract":!0,template:'<div ui-view class="ui container"/>'})}]),angular.module("contiv.settings",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.settings",{url:"/global","abstract":!0,template:'<div ui-view class="ui container"/>'}).state("contiv.menu.settings.details",{url:"/settings",templateUrl:"settings/settingsmenu.html"}).state("contiv.menu.settings.details.logs",{url:"/logs",controller:"",templateUrl:""}).state("contiv.menu.settings.details.auth",{url:"/auth",controller:"",templateUrl:""}).state("contiv.menu.settings.details.license",{url:"/license",controller:"",templateUrl:""}).state("contiv.menu.settings.details.policies",{url:"/policies",controller:"",templateUrl:""})}]),angular.module("contiv.storagepolicies",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.storagepolicies",{url:"/storagepolicies","abstract":!0,template:'<div ui-view class="ui container"/>'})}]),angular.module("contiv.visualization",["contiv.models","contiv.directives","contiv.utils","contiv.graph"]).config(["$stateProvider",function(e){e.state("contiv.menu.visualization",{url:"/visualization","abstract":!0,template:'<div ui-view class="ui container"/>'})}]),angular.module("contiv.volumes",["contiv.models","contiv.directives","contiv.utils"]).config(["$stateProvider",function(e){e.state("contiv.menu.volumes",{url:"/volumes","abstract":!0,template:'<div ui-view class="ui container"/>'})}]),angular.module("contivApp",["ui.router","contiv.login","contiv.menu","contiv.dashboard","contiv.applicationgroups","contiv.networks","contiv.networkpolicies","contiv.storagepolicies","contiv.servicelbs","contiv.volumes","contiv.nodes","contiv.organizations","contiv.settings","contiv.visualization"]).config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("contiv",{url:"","abstract":!0,template:'<div ui-view class="ui fluid container"/>'}),t.otherwise("/")}]),angular.module("contiv.applicationgroups").config(["$stateProvider",function(e){e.state("contiv.menu.applicationgroups.create",{url:"/create",controller:"ApplicationGroupCreateCtrl as applicationGroupCreateCtrl",templateUrl:"applicationgroups/applicationgroupcreate.html"})}]).controller("ApplicationGroupCreateCtrl",["$state","$stateParams","ApplicationGroupsModel","NetworksModel","CRUDHelperService",function(e,t,o,n,i){function r(){e.go("contiv.menu.applicationgroups.list")}function a(){r()}function l(){n.get().then(function(e){u.networks=_.filter(e,{tenantName:"default"})})}function s(){u.form.$valid&&(i.hideServerError(u),i.startLoader(u),u.applicationGroup.networkName=u.selectedNetwork.networkName,u.applicationGroup.key=o.generateKey(u.applicationGroup),o.create(u.applicationGroup).then(function(e){i.stopLoader(u),r()},function(e){i.stopLoader(u),i.showServerError(u,e)}))}function c(){i.stopLoader(u),i.hideServerError(u),u.applicationGroup={groupName:"",networkName:"",policies:[],netProfile:"",tenantName:"default"}}var u=this;u.networks=[],u.applicationGroup={},u.selectedNetwork={},u.mode="edit",l(),u.createApplicationGroup=s,u.cancelCreating=a,c()}]),angular.module("contiv.applicationgroups").config(["$stateProvider",function(e){e.state("contiv.menu.applicationgroups.details",{url:"/details/:key",controller:"ApplicationGroupDetailsCtrl as applicationGroupDetailsCtrl",templateUrl:"applicationgroups/applicationgroupdetails.html"}).state("contiv.menu.applicationgroups.edit",{url:"/edit/:key",controller:"ApplicationGroupDetailsCtrl as applicationGroupDetailsCtrl",templateUrl:"applicationgroups/applicationgroupdetails.html"})}]).controller("ApplicationGroupDetailsCtrl",["$state","$stateParams","ApplicationGroupsModel","CRUDHelperService",function(e,t,o,n){function i(){e.is("contiv.menu.applicationgroups.edit")?u.mode="edit":u.mode="details"}function r(){e.go("contiv.menu.applicationgroups.list");
}function a(){e.go("contiv.menu.applicationgroups.details",{key:u.applicationGroup.key})}function l(){a()}function s(){n.hideServerError(u),n.startLoader(u),o["delete"](u.applicationGroup).then(function(e){n.stopLoader(u),r()},function(e){n.stopLoader(u),n.showServerError(u,e)})}function c(){n.hideServerError(u),n.startLoader(u),o.save(u.applicationGroup).then(function(e){n.stopLoader(u),a()},function(e){n.stopLoader(u),n.showServerError(u,e)})}var u=this;u.applicationGroup={},u.selectedNetwork={},n.stopLoader(u),n.hideServerError(u),o.getModelByKey(t.key).then(function(e){u.applicationGroup=e}),u.saveApplicationGroup=c,u.cancelEditing=l,u.deleteApplicationGroup=s,i()}]),angular.module("contiv.applicationgroups").config(["$stateProvider",function(e){e.state("contiv.menu.applicationgroups.list",{url:"/list",controller:"ApplicationGroupListCtrl as applicationGroupListCtrl",templateUrl:"applicationgroups/applicationgrouplist.html"})}]).controller("ApplicationGroupListCtrl",["$scope","$interval","$filter","ApplicationGroupsModel","CRUDHelperService",function(e,t,o,n,i){function r(e){n.get(e).then(function(e){i.stopLoader(a),a.groups=e},function(e){i.stopLoader(a)})}var a=this;r(!1);var l;angular.isDefined(l)||(l=t(function(){r(!0)},5e3)),e.$on("$destroy",function(){t.cancel(l)})}]),angular.module("contiv.applicationgroups").directive("ctvBandwidthpolicy",function(){return{restrict:"E",scope:{mode:"=",applicationgroup:"="},controller:["$scope","NetprofilesModel",function(e,t){function o(){t.get().then(function(t){e.netProfiles=_.filter(t,{tenantName:"default"}),""!==e.applicationgroup.netProfile&&(e.selectedNetprofile.policy=_.find(e.netProfiles,function(t){return t.profileName===e.applicationgroup.netProfile}))})}e.netProfiles=[],e.selectedNetprofile={policy:{}},e.updateApplicationgroup=function(){null===e.selectedNetprofile.policy?e.applicationgroup.netProfile="":e.applicationgroup.netProfile=e.selectedNetprofile.policy.profileName},o()}],templateUrl:"applicationgroups/bandwidthpolicy.html"}}),angular.module("contiv.applicationgroups").directive("ctvIsolationpolicy",function(){return{restrict:"E",scope:{mode:"=",applicationgroup:"="},controller:["$scope","$stateParams","ApplicationGroupsModel","PoliciesModel","RulesModel",function(e,t,o,n,i){function r(){e.applicationgroup.policies.forEach(function(t){i.getIncomingRules(t,"default").then(function(t){Array.prototype.push.apply(e.incomingRules,t)}),i.getOutgoingRules(t,"default").then(function(t){Array.prototype.push.apply(e.outgoingRules,t)})})}function a(){n.get().then(function(t){e.isolationPolicies=_.filter(t,{tenantName:"default"})})}e.incomingRules=[],e.outgoingRules=[],e.selectedPolicy={policy:{}},e.selectedPolicies=[],e.isolationPolicies=[],e.addIsolationPolicy=function(){var t=e.selectedPolicy.policy.policyName;void 0!==t&&0==_.includes(e.selectedPolicies,t)&&(e.selectedPolicies.push(t),i.getIncomingRules(t,"default").then(function(t){Array.prototype.push.apply(e.incomingRules,t)}),i.getOutgoingRules(t,"default").then(function(t){Array.prototype.push.apply(e.outgoingRules,t)}),e.applicationgroup.policies.push(t))},e.removeIsolationPolicy=function(t){_.remove(e.selectedPolicies,function(e){return e===t}),_.remove(e.applicationgroup.policies,function(e){return e===t}),_.remove(e.incomingRules,function(e){return e.policyName===t}),_.remove(e.outgoingRules,function(e){return e.policyName===t})},("details"==e.mode||"edit"==e.mode&&""!=e.applicationgroup.groupName)&&(void 0===e.applicationgroup.policies&&(e.applicationgroup.policies=[]),r()),a()}],templateUrl:"applicationgroups/isolationpolicy.html"}}),angular.module("contiv.login").config(["$stateProvider",function(e){e.state("contiv.login",{url:"/",templateUrl:"login/login.html",controller:"LoginCtrl as loginCtrl"})}]).controller("LoginCtrl",["$state","CRUDHelperService",function(e,t){function o(){e.go("contiv.menu.dashboard",{username:i.username})}function n(){o()}var i=this;t.stopLoader(i),t.hideServerError(i),i.login=n}]),angular.module("contiv.menu").config(["$stateProvider",function(e){e.state("contiv.menu",{url:"/m",templateUrl:"menu/menu.html",controller:"MenuCtrl as menuCtrl",params:{username:null}})}]).controller("MenuCtrl",["$state","$stateParams",function(e,t){function o(){e.go("contiv.login")}var n=this;n.username=t.username,n.logout=o}]),angular.module("contiv.networkpolicies").directive("ctvBandwidth",function(){return{restrict:"E",scope:{bandwidthPolicy:"=",mode:"@"},link:function(e){if(""!=e.bandwidthPolicy.bandwidth){var t=e.bandwidthPolicy.bandwidth.split(" ");e.bandwidthPolicy.bandwidthNumber=Number(t[0]),e.bandwidthPolicy.bandwidthUnit=t[1]}},templateUrl:"network_policies/bandwidth.html"}}),angular.module("contiv.networkpolicies").config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies.bandwidth.create",{url:"/create",controller:"BandwidthPolicyCreateCtrl as bandwidthPolicyCreateCtrl",templateUrl:"network_policies/bandwidthpolicycreate.html"})}]).controller("BandwidthPolicyCreateCtrl",["$state","$stateParams","NetprofilesModel","CRUDHelperService",function(e,t,o,n){function i(){e.go("contiv.menu.networkpolicies.list.bandwidth")}function r(){i()}function a(){s.form.$valid&&(n.hideServerError(s),n.startLoader(s),s.newPolicy.key=o.generateKey(s.newPolicy),s.newPolicy.bandwidth=s.newPolicy.bandwidthNumber+" "+s.newPolicy.bandwidthUnit,o.create(s.newPolicy).then(function(e){n.stopLoader(s),i()},function(e){n.stopLoader(s),n.showServerError(s,e)}))}function l(){n.stopLoader(s),n.hideServerError(s),s.newPolicy={profileName:"",tenantName:"default",bandwidth:"",DSCP:""}}var s=this;s.createPolicy=a,s.cancelCreating=r,l()}]),angular.module("contiv.networkpolicies").config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies.bandwidth.details",{url:"/details/:key",controller:"BandwidthPolicyDetailsCtrl as bandwidthPolicyDetailsCtrl",templateUrl:"network_policies/bandwidthpolicydetails.html"})}]).config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies.bandwidth.edit",{url:"/edit/:key",controller:"BandwidthPolicyDetailsCtrl as bandwidthPolicyDetailsCtrl",templateUrl:"network_policies/bandwidthpolicydetails.html"})}]).controller("BandwidthPolicyDetailsCtrl",["$state","$stateParams","NetprofilesModel","CRUDHelperService",function(e,t,o,n){function i(){e.is("contiv.menu.networkpolicies.bandwidth.edit")?u.mode="edit":u.mode="details"}function r(){n.hideServerError(u),n.startLoader(u),o.deleteUsingKey(u.policy.key,"name").then(function(e){n.stopLoader(u),a()},function(e){n.stopLoader(u),n.showServerError(u,e)})}function a(){e.go("contiv.menu.networkpolicies.list.bandwidth")}function l(){e.go("contiv.menu.networkpolicies.bandwidth.details",{key:u.policy.key})}function s(){l()}function c(){u.form.$valid&&(n.hideServerError(u),n.startLoader(u),u.policy.bandwidth=u.policy.bandwidthNumber+" "+u.policy.bandwidthUnit,o.save(u.policy).then(function(e){n.stopLoader(u),l()},function(e){n.stopLoader(u),n.showServerError(u,e)}))}var u=this;u.bandwidthProfiles=[],o.getModelByKey(t.key).then(function(e){u.policy=e}),n.stopLoader(u),n.hideServerError(u),i(),u.deletePolicy=r,u.savePolicy=c,u.cancelEditing=s}]),angular.module("contiv.networkpolicies").config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies.list.bandwidth",{url:"/bandwidth",controller:"BandwidthPolicyListCtrl as bandwidthPolicyListCtrl",templateUrl:"network_policies/bandwidthpolicylist.html"})}]).controller("BandwidthPolicyListCtrl",["$scope","$interval","$filter","NetprofilesModel","CRUDHelperService",function(e,t,o,n,i){function r(e){n.get(e).then(function(e){i.stopLoader(a),a.policies=o("orderBy")(e,"profileName")},function(e){i.stopLoader(a)})}var a=this;r(!0);var l;angular.isDefined(l)||(l=t(function(){r(!0)},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(l)})}]),angular.module("contiv.networkpolicies").config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies.isolation.details",{url:"/details/:key",controller:"IsolationPolicyDetailsCtrl as isolationPolicyDetailsCtrl",templateUrl:"network_policies/isolationpolicydetails.html"})}]).config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies.isolation.edit",{url:"/edit/:key",controller:"IsolationPolicyDetailsCtrl as isolationPolicyDetailsCtrl",templateUrl:"network_policies/isolationpolicydetails.html"})}]).controller("IsolationPolicyDetailsCtrl",["$state","$stateParams","PoliciesModel","RulesModel","NetworksModel","ApplicationGroupsModel","CRUDHelperService",function(e,t,o,n,i,r,a){function l(){e.go("contiv.menu.networkpolicies.list.isolation")}function s(){e.go("contiv.menu.networkpolicies.isolation.details",{key:D.policy.key})}function c(){s()}function u(){s()}function d(){a.hideServerError(D),a.startLoader(D),o["delete"](D.policy).then(function(e){a.stopLoader(D),l()},function(e){a.stopLoader(D),a.showServerError(D,e)})}function p(){e.is("contiv.menu.networkpolicies.isolation.edit")?D.mode="edit":D.mode="details"}function f(){D.newIncomingRule={ruleId:"",priority:1,action:"allow",fromEndpointGroup:"",fromNetwork:"",fromIpAddress:"",protocol:"tcp",port:0,direction:"in",tenantName:"default",policyName:D.policy.policyName},D.newIncomingSelectedApplicationGroup="",D.newIncomingSelectedNetwork="",D.disableIncomingNetworkSelection=!1,D.disableIncomingApplicationGroupSelection=!1,D.disableIncomingIPAddressSelection=!1,D.incorrectCIDR=!1,D.validateCIDRFlag=!1}function v(){D.newOutgoingRule={ruleId:"",priority:1,action:"allow",toEndpointGroup:"",toNetwork:"",toIpAddress:"",protocol:"tcp",port:0,direction:"out",tenantName:"default",policyName:D.policy.policyName},D.newOutgoingSelectedApplicationGroup="",D.newOutgoingSelectedNetwork="",D.disableOutgoingNetworkSelection=!1,D.disableOutgoingApplicationGroupSelection=!1,D.disableOutgoingIPAddressSelection=!1,D.incorrectCIDR=!1,D.validateCIDRFlag=!1}function h(){i.get().then(function(e){D.networks=_.filter(e,{tenantName:"default"})})}function g(){r.get().then(function(e){D.applicationGroups=_.filter(e,{tenantName:"default"})})}function m(){null!=D.newOutgoingSelectedApplicationGroup?(D.newOutgoingRule.toEndpointGroup=D.newOutgoingSelectedApplicationGroup.groupName,D.newOutgoingRule.toNetwork="",D.disableOutgoingNetworkSelection=!0):(D.newOutgoingRule.toEndpointGroup="",D.disableOutgoingNetworkSelection=!1)}function y(){null!=D.newIncomingSelectedApplicationGroup?(D.newIncomingRule.fromEndpointGroup=D.newIncomingSelectedApplicationGroup.groupName,D.newIncomingRule.fromNetwork="",D.disableIncomingNetworkSelection=!0):(D.newIncomingRule.fromEndpointGroup="",D.disableOutgoingApplicationGroupSelection=!1,D.disableIncomingNetworkSelection=!1)}function w(){null!=D.newOutgoingSelectedNetwork?(D.newOutgoingRule.toNetwork=D.newOutgoingSelectedNetwork,D.newOutgoingRule.ToEndpointGroup="",D.disableOutgoingApplicationGroupSelection=!0,D.disableOutgoingIPAddressSelection=!0):(D.newOutgoingRule.toIpAddress="",D.disableOutgoingApplicationGroupSelection=!1,D.disableOutgoingIPAddressSelection=!1)}function b(){null!=D.newIncomingSelectedNetwork?(D.newIncomingRule.fromNetwork=D.newIncomingSelectedNetwork,D.newIncomingRule.fromEndpointGroup="",D.disableIncomingApplicationGroupSelection=!0,D.disableIncomingIPAddressSelection=!0):(D.newIncomingRule.fromNetwork="",D.disableIncomingApplicationGroupSelection=!1,D.disableIncomingIPAddressSelection=!1)}function P(e){e.ruleId=(D.incomingRules.length+D.outgoingRules.length+1).toString()+"-"+Date.now().toString()}function S(){N(D.newIncomingRule.fromIpAddress)&&(a.hideServerError(D),a.startLoader(D),P(D.newIncomingRule),D.newIncomingRule.key=n.generateKey(D.newIncomingRule),n.create(D.newIncomingRule).then(function(e){a.stopLoader(D),D.incomingRules.push(e),f()},function(e){a.stopLoader(D),a.showServerError(D,e)}))}function k(){""==D.newIncomingRule.fromIpAddress?(D.incorrectCIDR=!1,D.disableIncomingNetworkSelection=!1):D.disableIncomingNetworkSelection=!0,D.validateCIDRFlag&&D.incorrectCIDR&&N(D.newIncomingRule.fromIpAddress)}function E(){""==D.newOutgoingRule.toIpAddress?(D.incorrectCIDR=!1,D.disableOutgoingNetworkSelection=!1):D.disableOutgoingNetworkSelection=!0,D.validateCIDRFlag&&D.incorrectCIDR&&N(D.newOutgoingRule.toIpAddress)}function N(e){var t=new RegExp(ContivGlobals.CIDR_REGEX);return""==e?!0:t.test(e)?(D.incorrectCIDR=!1,!0):(D.incorrectCIDR=!0,D.validateCIDRFlag=!0,!1)}function C(){N(D.newOutgoingRule.toIpAddress)&&(a.hideServerError(D),a.startLoader(D),P(D.newOutgoingRule),D.newOutgoingRule.key=n.generateKey(D.newOutgoingRule),n.create(D.newOutgoingRule).then(function(e){a.stopLoader(D),D.outgoingRules.push(e),v()},function(e){a.stopLoader(D),a.showServerError(D,e)}))}function O(e){a.hideServerError(D),a.startLoader(D),n.deleteUsingKey(e).then(function(t){a.stopLoader(D),_.remove(D.incomingRules,function(t){return t.key==e})},function(e){a.stopLoader(D),a.showServerError(D,e)})}function L(e){a.hideServerError(D),a.startLoader(D),n.deleteUsingKey(e).then(function(t){a.stopLoader(D),_.remove(D.outgoingRules,function(t){return t.key==e})},function(e){a.stopLoader(D),a.showServerError(D,e)})}var D=this;D.networks=[],D.applicationGroups=[],D.disableOutgoingNetworkSelection=!1,D.disableIncomingNetworkSelection=!1,D.disableOutgoingApplicationGroupSelection=!1,D.disableIncomingApplicationGroupSelection=!1,D.disableIncomingIPAddressSelection=!1,D.disableOutgoingIPAddressSelection=!1,D.newIncomingSelectedApplicationGroup="",D.newOutgoingSelectedApplicationGroup="",D.newIncomingSelectedNetwork="",D.newOutgoingSelectedNetwork="",D.incorrectCIDR=!1,D.validateCIDRFlag=!1,a.stopLoader(D),a.hideServerError(D),o.getModelByKey(t.key).then(function(e){D.policy=e,n.getIncomingRules(e.policyName,"default").then(function(e){D.incomingRules=e,f()}),n.getOutgoingRules(e.policyName,"default").then(function(e){D.outgoingRules=e,v()})}),h(),g(),D.deletePolicy=d,D.deleteIncomingRule=O,D.deleteOutgoingRule=L,D.addIncomingRule=S,D.addOutgoingRule=C,D.doneEditing=u,D.cancelEditing=c,D.onChangeOutgoingApplicationGroupSelection=m,D.onChangeIncomingApplicationGroupSelection=y,D.onChangeOutgoingNetworkSelection=w,D.onChangeIncomingNetworkSelection=b,D.onChangeIncomingIPAddress=k,D.onChangeOutgoingIPAddress=E,p()}]),angular.module("contiv.networkpolicies").config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies.list.isolation",{url:"/isolation",controller:"IsolationPolicyListCtrl as isolationPolicyListCtrl",templateUrl:"network_policies/isolationpolicylist.html"})}]).controller("IsolationPolicyListCtrl",["$scope","$interval","$filter","PoliciesModel","CRUDHelperService",function(e,t,o,n,i){function r(e){n.get(e).then(function(e){i.stopLoader(a),a.policies=o("orderBy")(e,"policyName")},function(e){i.stopLoader(a)})}var a=this;r(!1);var l;angular.isDefined(l)||(l=t(function(){r(!0)},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(l)})}]),angular.module("contiv.networkpolicies").config(["$stateProvider",function(e){e.state("contiv.menu.networkpolicies.list",{url:"/list","abstract":!0,controller:"NetworkPoliciesTabsCtrl as networkPoliciesTabsCtrl",templateUrl:"network_policies/networkpoliciestabs.html"}).state("contiv.menu.networkpolicies.list.redirection",{url:"/redirection",template:""})}]).controller("NetworkPoliciesTabsCtrl",["$state",function(e){function t(){e.$current.includes["contiv.menu.networkpolicies.list.isolation"]&&e.go("contiv.menu.networkpolicies.isolation.create"),e.$current.includes["contiv.menu.networkpolicies.list.bandwidth"]&&e.go("contiv.menu.networkpolicies.bandwidth.create")}var o=this;o.createNetworkPolicy=t}]),angular.module("contiv.networks").config(["$stateProvider",function(e){e.state("contiv.menu.networks.create",{url:"/create",templateUrl:"networks/networkcreate.html",controller:"NetworkCreateCtrl as networkCreateCtrl"})}]).controller("NetworkCreateCtrl",["$state","$stateParams","NetworksModel","CRUDHelperService",function(e,t,o,n){function i(){e.go("contiv.menu.networks.list")}function r(){i()}function a(){s.form.$valid&&(n.hideServerError(s),n.startLoader(s),s.newNetwork.key=s.newNetwork.tenantName+":"+s.newNetwork.networkName,o.create(s.newNetwork).then(function(e){n.stopLoader(s),i()},function(e){n.stopLoader(s),n.showServerError(s,e)}))}function l(){n.stopLoader(s),n.hideServerError(s),s.newNetwork={networkName:"",encap:"vxlan",subnet:"",gateway:"",tenantName:"default"}}var s=this;s.cidrPattern=ContivGlobals.CIDR_REGEX,s.createNetwork=a,s.cancelCreating=r,l()}]),angular.module("contiv.networks").config(["$stateProvider",function(e){e.state("contiv.menu.networks.details",{url:"/details/:key",controller:"NetworkDetailsCtrl as networkDetailsCtrl",templateUrl:"networks/networkdetails.html"}).state("contiv.menu.networks.details.info",{url:"/info",templateUrl:"networks/networkinfo.html"})}]).controller("NetworkDetailsCtrl",["$state","$stateParams","$scope","$interval","$filter","NetworksModel","ApplicationGroupsModel","CRUDHelperService",function(e,t,o,n,i,r,a,l){function s(){e.go("contiv.menu.networks.list")}function c(){l.hideServerError(d),l.startLoader(d),r["delete"](d.network).then(function(e){l.stopLoader(d),s()},function(e){l.stopLoader(d),l.showServerError(d,e)})}function u(e){a.get(e).then(function(e){d.applicationGroups=i("orderBy")(_.filter(e,{networkName:d.network.networkName}),"groupName")})}var d=this;l.stopLoader(d),l.hideServerError(d),r.getModelByKey(t.key).then(function(e){d.network=e,u(!1)}),d.deleteNetwork=c;var p;angular.isDefined(p)||(p=n(function(){u(!0)},ContivGlobals.REFRESH_INTERVAL)),o.$on("$destroy",function(){n.cancel(p)})}]);var NetworksListCtrl=function(){function e(e,t,o,n){function i(e){o.get(e).then(function(e){n.stopLoader(r),r.networks=e},function(e){n.stopLoader(r)})}var r=this;i(!1);var a;angular.isDefined(a)||(a=t(function(){i(!0)},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(a)})}return e.$inject=["$scope","$interval","NetworksModel","CRUDHelperService"],e}();angular.module("contiv.networks").config(["$stateProvider",function(e){e.state("contiv.menu.networks.list",{url:"/list",component:"networkList"})}]).component("networkList",{templateUrl:"networks/networklist.html",controller:NetworksListCtrl,controllerAs:"networksListCtrl"}),angular.module("contiv.networks").config(["$stateProvider",function(e){e.state("contiv.menu.networks.details.stats",{url:"/stats",controller:"NetworkStatsCtrl as networkStatsCtrl",templateUrl:"networks/networkstats.html"})}]).controller("NetworkStatsCtrl",["$state","$stateParams","$scope","$interval","$filter","NetworksModel","InspectService",function(e,t,o,n,i,r,a){function l(e){r.getInspectByKey(t.key,ContivGlobals.NETWORKS_INSPECT_ENDPOINT,e).then(function(e){if(s.networkInspectStats=e.Oper,s.config=e.Config,void 0!=e.Oper.endpoints){var t=a.buildEndPoints(e.Oper.endpoints);a.checkContainerChanged(s.containerDetails,t)&&(s.endpoints=e.Oper.endpoints,s.containerDetails=t)}else s.endpoints=[],s.containerDetails={}})}var s=this;l(!1);var c;angular.isDefined(c)||(c=n(function(){l(!0)},ContivGlobals.REFRESH_INTERVAL)),o.$on("$destroy",function(){n.cancel(c)})}]),angular.module("contiv.nodes").factory("BgpService",["$http","$q",function(e,t){function o(o){var n=t.defer(),i=ContivGlobals.BGPS_ENDPOINT+o.key+"/";return e.get(i).then(function(e){n.resolve(e.data),o.neighbor=e.data,o.neighbors.push({name:o.neighbor.neighbor,value:o.neighbor["neighbor-as"]})},function(e){n.reject(e.data)}),n.promise}function n(t){var o=ContivGlobals.BGPS_ENDPOINT+t.key+"/";return e.post(o,t.neighbor)}function i(o){var n=t.defer(),i=ContivGlobals.BGPS_INSPECT_ENDPOINT+o+"/";return e.get(i).then(function(e){n.resolve(e.data)},function(e){n.reject(e.data)}),n.promise}return{getBgp:o,updateBgp:n,getBgpInspect:i}}]),angular.module("contiv.nodes").directive("ctvLogs",function(){return{restrict:"E",templateUrl:"nodes/logs.html",scope:{log:"=",title:"@"}}}),angular.module("contiv.nodes").factory("LogService",["$http","$q",function(e,t){function o(){var o=t.defer(),n=ContivGlobals.NODES_ACTIVE_JOB_ENDPOINT;return e.get(n).then(function(e){o.resolve(e.data)},function(e){o.reject(e.data)}),o.promise}function n(){var o=t.defer(),n=ContivGlobals.NODES_LAST_JOB_ENDPOINT;return e.get(n).then(function(e){o.resolve(e.data)},function(e){o.reject(e.data)}),o.promise}return{getActiveLogs:o,getLastLogs:n}}]),angular.module("contiv.nodes").config(["$stateProvider",function(e){e.state("contiv.menu.nodes.activelog",{url:"/activelog",controller:"NodeActiveJobLogsCtrl as nodeActiveJobLogsCtrl",template:'<ctv-logs title="Active Job" log="nodeActiveJobLogsCtrl.activeLogs"></ctv-logs>'})}]).controller("NodeActiveJobLogsCtrl",["$scope","$interval","LogService",function(e,t,o){function n(){o.getActiveLogs().then(function(e){i.activeLogs=e},function(e){i.activeLogs={desc:"There is currently no active job. Check Last Job for a job that recently finished."}})}var i=this;n();var r;angular.isDefined(r)||(r=t(function(){n()},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(r)})}]),angular.module("contiv.nodes").config(["$stateProvider",function(e){e.state("contiv.menu.nodes.commission",{url:"/commission/:key",controller:"NodeCommissionCtrl as nodeCommissionCtrl",templateUrl:"nodes/nodecommission.html"})}]).controller("NodeCommissionCtrl",["$state","$stateParams","NodesModel","CRUDHelperService","NodesService",function(e,t,o,n,i){function r(){e.go("contiv.menu.nodes.details.info",{key:t.key})}function a(){r()}function l(){s.form.$valid&&(n.hideServerError(s),n.startLoader(s),s.nodeOpsObj.nodes=[t.key],i.cleanupExtraVars(s),i.createExtraVars(s),o.commission(s.nodeOpsObj).then(function(e){n.stopLoader(s),r()},function(e){n.stopLoader(s),n.showServerError(s,e)}))}var s=this;s.nodeOpsObj={},s.extra_vars={},s.ansibleVariables=[],s.envVariables=[],i.getSettings(s),s.cancelCommissioningNode=a,s.commission=l,n.stopLoader(s),n.hideServerError(s)}]),angular.module("contiv.nodes").config(["$stateProvider",function(e){e.state("contiv.menu.nodes.details",{url:"/details/:key",controller:"NodeDetailsCtrl as nodeDetailsCtrl",templateUrl:"nodes/nodedetails.html"}).state("contiv.menu.nodes.details.info",{url:"/info",controller:"NodeDetailsCtrl as nodeDetailsCtrl",templateUrl:"nodes/nodeinfo.html"}).state("contiv.menu.nodes.details.stats",{url:"/stats",controller:"NodeDetailsCtrl as nodeDetailsCtrl",templateUrl:"nodes/nodestats.html"}).state("contiv.menu.nodes.details.logs",{url:"/logs",controller:"NodeDetailsCtrl as nodeDetailsCtrl",templateUrl:"nodes/nodelogs.html"}).state("contiv.menu.nodes.details.edit",{url:"/edit",controller:"NodeDetailsCtrl as nodeDetailsCtrl",templateUrl:"nodes/nodeinfo.html"})}]).controller("NodeDetailsCtrl",["$state","$stateParams","$scope","$interval","NodesModel","BgpService",function(e,t,o,n,i,r){function a(){var e={nodes:[t.key]};i.decommission(e).then(function(e){h.showCommissionButton=!1,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1})}function l(){var e={nodes:[t.key]};i.upgrade(e).then(function(e){h.showCommissionButton=!1,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1})}function s(){switch(h.node.inventory_state.status){case"Unallocated":h.showCommissionButton=!0,h.commissionButtonEnabled=!0,h.upgradeButtonEnabled=!1;break;case"Decommissioned":h.showCommissionButton=!0,h.commissionButtonEnabled=!0,h.upgradeButtonEnabled=!1;break;case"Provisioning":h.showCommissionButton=!0,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1;break;case"Allocated":h.showCommissionButton=!1,h.commissionButtonEnabled=!0,h.upgradeButtonEnabled=!0;break;case"Cancelled":h.showCommissionButton=!1,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1;break;case"Maintenance":h.showCommissionButton=!0,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1;break;default:h.showCommissionButton=!0,h.commissionButtonEnabled=!1,h.upgradeButtonEnabled=!1}}function c(e){i.getModelByKey(t.key,e).then(function(e){h.node=e,s()})}function u(){e.is("contiv.menu.nodes.details.edit")?h.mode="edit":h.mode="details"}function d(){e.go("contiv.menu.nodes.details.info")}function p(){h.form.$valid&&(h.neighbor.key=t.key,h.neighbors.forEach(function(e){h.neighbor.neighbor=e.name,h.neighbor["neighbor-as"]=e.value}),r.updateBgp(h).then(function(e){h.neighbor=e.config.data,d()},function(e){}))}function f(){r.getBgp(h).then(function(e){h.neighbor=e},function(e){})}function v(){r.getBgpInspect(t.key).then(function(e){h.inspect=e,h.routes=e.Oper.routes,h.filteredroutes=e.Oper.routes},function(e){})}var h=this;h.numberpattern=ContivGlobals.NUMBER_REGEX,h.decommission=a,h.upgrade=l,h.setMode=u,h.updateBgpInfo=p,h.returnToInfo=d,h.neighbors=[],h.neighbor={},h.key=t.key,f(),v(),u(),c(!1);var g;angular.isDefined(g)||(g=n(function(){c(!0)},5e3)),o.$on("$destroy",function(){n.cancel(g)})}]),angular.module("contiv.nodes").directive("ctvNodestatus",function(){return{restrict:"E",scope:{node:"="},templateUrl:"nodes/nodestatus.html"}}).directive("ctvNodestate",function(){return{restrict:"E",scope:{node:"="},templateUrl:"nodes/nodestate.html"}}),angular.module("contiv.nodes").config(["$stateProvider",function(e){e.state("contiv.menu.nodes.discover",{url:"/discover",controller:"NodeDiscoverCtrl as nodeDiscoverCtrl",templateUrl:"nodes/nodediscover.html"})}]).controller("NodeDiscoverCtrl",["$state","$stateParams","NodesModel","CRUDHelperService","NodesService",function(e,t,o,n,i){function r(){e.go("contiv.menu.nodes.list")}function a(){r()}function l(){c.form.$valid&&(n.hideServerError(c),n.startLoader(c),s(),i.createExtraVars(c),o.discover(c.nodeOpsObj).then(function(e){n.stopLoader(c),r()},function(e){n.stopLoader(c),n.showServerError(c,e)}))}function s(){c.nodeOpsObj.addrs=_.words(c.nodeIPAddr,/[^, ]+/g)}var c=this;c.nodeOpsObj={},c.extra_vars={},c.ansibleVariables=[],c.envVariables=[],c.nodeIPAddr="",i.getSettings(c),c.discover=l,c.cancelDiscoveringNode=a,n.stopLoader(c),n.hideServerError(c)}]),angular.module("contiv.nodes").config(["$stateProvider",function(e){e.state("contiv.menu.nodes.lastlog",{url:"/lastlog",controller:"NodeLastJobLogsCtrl as nodeLastJobLogsCtrl",template:'<ctv-logs title="Last Job" log="nodeLastJobLogsCtrl.lastLogs"></ctv-logs>'})}]).controller("NodeLastJobLogsCtrl",["$scope","$interval","LogService",function(e,t,o){function n(){o.getLastLogs().then(function(e){i.lastLogs=e},function(e){})}var i=this;n();var r;angular.isDefined(r)||(r=t(function(){n()},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(r)})}]),angular.module("contiv.nodes").config(["$stateProvider",function(e){e.state("contiv.menu.nodes.list",{url:"/list",controller:"NodeListCtrl as nodeListCtrl",templateUrl:"nodes/nodelist.html"})}]).controller("NodeListCtrl",["$scope","$interval","$filter","NodesModel","CRUDHelperService",function(e,t,o,n,i){function r(e){n.get(e).then(function(e){i.stopLoader(a),a.nodes=e},function(e){i.stopLoader(a)})}var a=this;r(!1);var l;angular.isDefined(l)||(l=t(function(){r(!0)},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(l)})}]),angular.module("contiv.organizations").config(["$stateProvider",function(e){e.state("contiv.menu.organizations.create",{url:"/create",templateUrl:"organizations/organizationcreate.html",controller:"OrganizationCreateCtrl as organizationCreateCtrl"})}]).controller("OrganizationCreateCtrl",["$state","OrganizationsModel","CRUDHelperService",function(e,t,o){function n(){e.go("contiv.menu.organizations.list")}function i(){n()}function r(){l.form.$valid&&(o.hideServerError(l),o.startLoader(l),l.newOrganization.key=l.newOrganization.tenantName,t.create(l.newOrganization).then(function(e){o.stopLoader(l),n()},function(e){o.stopLoader(l),o.showServerError(l,e)}))}function a(){o.stopLoader(l),o.hideServerError(l),l.newOrganization={tenantName:""}}var l=this;l.createOrganization=r,l.cancelCreating=i,a()}]),angular.module("contiv.organizations").config(["$stateProvider",function(e){e.state("contiv.menu.organizations.details",{url:"/details/:key",controller:"OrganizationDetailsCtrl as organizationDetailsCtrl",templateUrl:"organizations/organizationdetails.html"})}]).controller("OrganizationDetailsCtrl",["$state","$stateParams","OrganizationsModel","CRUDHelperService",function(e,t,o,n){function i(){e.go("contiv.menu.organizations.list")}function r(){n.hideServerError(a),n.startLoader(a),o["delete"](a.organization).then(function(e){n.stopLoader(a),i()},function(e){n.stopLoader(a),n.showServerError(a,e)})}var a=this;n.stopLoader(a),n.hideServerError(a),o.getModelByKey(t.key).then(function(e){a.organization=e}),a.deleteOrganization=r}]),angular.module("contiv.organizations").config(["$stateProvider",function(e){e.state("contiv.menu.organizations.list",{url:"/list",controller:"OrganizationsListCtrl as organizationsListCtrl",templateUrl:"organizations/organizationlist.html"})}]).controller("OrganizationsListCtrl",["$scope","$interval","$filter","OrganizationsModel","CRUDHelperService",function(e,t,o,n,i){function r(e){n.get(e).then(function(e){i.stopLoader(a),a.organizations=e},function(e){i.stopLoader(a)})}var a=this;r(!1);var l;angular.isDefined(l)||(l=t(function(){r(!0)},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(l)})}]),angular.module("contiv.settings").config(["$stateProvider",function(e){e.state("contiv.menu.settings.details.cluster",{url:"/cluster",controller:"ClusterSettingCtrl as clusterSettingCtrl",templateUrl:"settings/clustersettings.html"})}]).controller("ClusterSettingCtrl",["$stateParams","CRUDHelperService","NodesService",function(e,t,o){function n(){i.form.$valid&&(t.hideServerError(i),t.startLoader(i),i.nodeOpsObj.nodes=[e.key],o.cleanupExtraVars(i),o.createExtraVars(i),o.updateSettings(i.nodeOpsObj).then(function(e){t.stopLoader(i)},function(e){t.stopLoader(i),t.showServerError(i,e)}))}var i=this;i.nodeOpsObj={},i.extra_vars={},i.ansibleVariables=[],i.envVariables=[],o.getSettings(i),i.updateClusterSettings=n,t.stopLoader(i),t.hideServerError(i)}]),angular.module("contiv.settings").config(["$stateProvider",function(e){e.state("contiv.menu.settings.details.networks",{url:"/networks",controller:"NetworkSettingCtrl as networkSettingCtrl",templateUrl:"settings/networksettings.html"})}]).controller("NetworkSettingCtrl",["CRUDHelperService","NetworkService",function(e,t){function o(){i.form.$valid&&(e.hideServerError(i),e.startLoader(i),t.updateSettings(i.setting).then(function(t){e.stopLoader(i)},function(t){e.stopLoader(i),e.showServerError(i,t.data)}))}function n(){t.getSettings().then(function(e){i.setting=e},function(e){})}var i=this;i.vlanPattern=ContivGlobals.VLAN_REGEX,i.vxlanPattern=ContivGlobals.VXLAN_REGEX,n(),i.updateNetworkSettings=o,e.stopLoader(i),e.hideServerError(i)}]),angular.module("contiv.settings").config(["$stateProvider",function(e){e.state("contiv.menu.settings.details.volumes",{url:"/volumes",controller:"VolumeSettingCtrl as volumeSettingCtrl",templateUrl:"settings/volumesettings.html"})}]).controller("VolumeSettingCtrl",["CRUDHelperService","VolumeSettingService",function(e,t){function o(){i.form.$valid&&(e.hideServerError(i),e.startLoader(i),t.updateSettings(i.setting).then(function(t){e.stopLoader(i)},function(t){e.stopLoader(i),e.showServerError(i,t)}))}function n(){t.getSettings().then(function(e){i.setting=e},function(e){})}var i=this;n(),i.updateVolumeSettings=o,e.stopLoader(i),e.hideServerError(i)}]),angular.module("contiv.servicelbs").config(["$stateProvider",function(e){e.state("contiv.menu.servicelbs.create",{url:"/create",templateUrl:"service_lbs/servicelbcreate.html",controller:"ServicelbCreateCtrl as servicelbCreateCtrl"})}]).controller("ServicelbCreateCtrl",["$state","$stateParams","ServicelbsModel","NetworksModel","CRUDHelperService",function(e,t,o,n,i){function r(){e.go("contiv.menu.servicelbs.list")}function a(){r()}function l(){n.get().then(function(e){d.networks=_.filter(e,{tenantName:"default"})})}function s(){d.servicelb.selectors=[],angular.forEach(d.labelSelectors,function(e){var t=e.name+"="+e.value;
d.servicelb.selectors.push(t)})}function c(){s(),d.form.$valid&&(i.hideServerError(d),i.startLoader(d),d.servicelb.key=d.servicelb.tenantName+":"+d.servicelb.serviceName,o.create(d.servicelb).then(function(e){i.stopLoader(d),r()},function(e){i.stopLoader(d),i.showServerError(d,e)}))}function u(){i.stopLoader(d),i.hideServerError(d),d.servicelb={serviceName:"",networkName:"",ipAddress:"",selectors:[],ports:[],tenantName:"default"}}var d=this;d.labelSelectors=[],d.networks=[],d.createServicelb=c,d.cancelCreating=a,l(),u()}]),angular.module("contiv.servicelbs").config(["$stateProvider",function(e){e.state("contiv.menu.servicelbs.details",{url:"/details/:key",params:{state:null},controller:"ServicelbDetailsCtrl as servicelbDetailsCtrl",templateUrl:"service_lbs/servicelbdetails.html"}).state("contiv.menu.servicelbs.details.info",{url:"/info",controller:"ServicelbDetailsCtrl as servicelbDetailsCtrl",templateUrl:"service_lbs/servicelbinfo.html"}).state("contiv.menu.servicelbs.details.edit",{url:"/edit/:key",controller:"ServicelbDetailsCtrl as servicelbDetailsCtrl",templateUrl:"service_lbs/servicelbinfo.html"})}]).controller("ServicelbDetailsCtrl",["$state","$stateParams","ServicelbsModel","CRUDHelperService",function(e,t,o,n){function i(){e.is("contiv.menu.servicelbs.details.edit")?p.mode="edit":p.mode="details"}function r(){e.go("contiv.menu.servicelbs.list")}function a(){e.go("contiv.menu.servicelbs.details.info",{key:p.servicelb.key,state:"details"})}function l(){a()}function s(){n.hideServerError(p),n.startLoader(p),o["delete"](p.servicelb).then(function(e){n.stopLoader(p),r()},function(e){n.stopLoader(p),n.showServerError(p,e)})}function c(){n.hideServerError(p),n.startLoader(p);var e=p.servicelb.selectors;d(),o.save(p.servicelb).then(function(e){n.stopLoader(p),a()},function(t){p.servicelb.selectors=e,u(),n.stopLoader(p),n.showServerError(p,t)})}function u(){angular.forEach(p.servicelb.selectors,function(e){var t={name:e.split("=")[0],value:e.split("=")[1]};p.labelSelectors.push(t)})}function d(){p.servicelb.selectors=[],angular.forEach(p.labelSelectors,function(e){var t=e.name+"="+e.value;p.servicelb.selectors.push(t)})}var p=this;p.labelSelectors=[],n.stopLoader(p),n.hideServerError(p),o.getModelByKey(t.key).then(function(e){p.servicelb=e,u()}),p.saveServicelb=c,p.cancelEditing=l,p.deleteServicelb=s,i()}]),angular.module("contiv.servicelbs").config(["$stateProvider",function(e){e.state("contiv.menu.servicelbs.list",{url:"/list",controller:"ServicelbListCtrl as servicelbListCtrl",templateUrl:"service_lbs/servicelblist.html"})}]).controller("ServicelbListCtrl",["$scope","$interval","$filter","ServicelbsModel","CRUDHelperService",function(e,t,o,n,i){function r(e){n.get(e).then(function(e){i.stopLoader(a),a.servicelbs=e},function(e){i.stopLoader(a)})}var a=this;r(!1);var l;angular.isDefined(l)||(l=t(function(){r(!0)},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(l)})}]),angular.module("contiv.servicelbs").directive("ctvServicelbports",function(){return{restrict:"E",scope:{items:"="},link:function(e){function t(e,t){return e===t}function o(){e.newItem={servicePort:"",providerPort:"",protocol:""}}function n(e){return""===e.servicePort&&""===e.providerPort&&""===e.protocol}e.add=function(){if(!n(e.newItem)){void 0===e.items&&(e.items=[]);var i=e.newItem.servicePort+":"+e.newItem.providerPort+":"+e.newItem.protocol;_.pullAllWith(e.items,[i],t),e.items.push(i),o()}},e.remove=function(o){_.remove(e.items,function(e){return t(e,o)})},o()},templateUrl:"service_lbs/servicelbports.html"}}),angular.module("contiv.servicelbs").config(["$stateProvider",function(e){e.state("contiv.menu.servicelbs.details.stats",{url:"/stats",controller:"ServicelbStatsCtrl as servicelbStatsCtrl",templateUrl:"service_lbs/servicelbstats.html"})}]).controller("ServicelbStatsCtrl",["$state","$stateParams","$scope","$interval","$filter","ServicelbsModel","InspectService",function(e,t,o,n,i,r,a){function l(e){r.getInspectByKey(t.key,ContivGlobals.SERVICELBS_INSPECT_ENDPOINT,e).then(function(e){if(s.servicelbInspectStats=e.Oper,s.config=e.Config,void 0!=e.Oper.providers){var t=a.buildEndPoints(e.Oper.providers);a.checkContainerChanged(s.providerDetails,t)&&(s.providers=e.Oper.providers,s.providerDetails=t)}else s.providers=[],s.providerDetails={}})}var s=this;l(!1);var c;angular.isDefined(c)||(c=n(function(){l(!0)},ContivGlobals.REFRESH_INTERVAL)),o.$on("$destroy",function(){n.cancel(c)})}]),angular.module("contiv.storagepolicies").config(["$stateProvider",function(e){e.state("contiv.menu.storagepolicies.create",{url:"/create",templateUrl:"storage_policies/storagepolicycreate.html",controller:"StoragePolicyCreateCtrl as storagePolicyCreateCtrl"})}]).controller("StoragePolicyCreateCtrl",["$state","$stateParams","StoragePoliciesModel","CRUDHelperService",function(e,t,o,n){function i(){e.go("contiv.menu.storagepolicies.list")}function r(){i()}function a(){c.filesystemcmds.forEach(function(e){c.newStoragePolicy.filesystems[e.name]=e.value})}function l(){c.form.$valid&&(n.hideServerError(c),n.startLoader(c),a(),o.create(c.newStoragePolicy).then(function(e){n.stopLoader(c),i()},function(e){n.stopLoader(c),n.showServerError(c,e)}))}function s(){n.stopLoader(c),n.hideServerError(c),c.newStoragePolicy={name:"",backends:{crud:"ceph",mount:"ceph",snapshot:"ceph"},unlocked:!1,driver:{pool:"rbd"},create:{size:"0",filesystem:""},runtime:{snapshots:!0,snapshot:{frequency:"30m",keep:20},"rate-limit":{"write-iops":0,"read-iops":0,"write-bps":0,"read-bps":0}},filesystems:{}}}var c=this;c.createPolicy=l,c.cancelCreating=r,c.filesystemcmds=[],s()}]),angular.module("contiv.storagepolicies").config(["$stateProvider",function(e){e.state("contiv.menu.storagepolicies.details",{url:"/details/:key",controller:"StoragePolicyDetailsCtrl as storagePolicyDetailsCtrl",templateUrl:"storage_policies/storagepolicydetails.html"}).state("contiv.menu.storagepolicies.edit",{url:"/details/:key",controller:"StoragePolicyDetailsCtrl as storagePolicyDetailsCtrl",templateUrl:"storage_policies/storagepolicydetails.html"})}]).controller("StoragePolicyDetailsCtrl",["$state","$stateParams","$scope","$interval","$filter","StoragePoliciesModel","VolumesModel","CRUDHelperService",function(e,t,o,n,i,r,a,l){function s(){e.is("contiv.menu.storagepolicies.edit")?m.mode="edit":m.mode="details"}function c(){e.go("contiv.menu.storagepolicies.list")}function u(){e.go("contiv.menu.storagepolicies.details",{key:m.policy.name})}function d(){u()}function p(){l.hideServerError(m),l.startLoader(m),r.deleteUsingKey(m.policy.name,"name").then(function(e){l.stopLoader(m),c()},function(e){l.stopLoader(m),l.showServerError(m,e)})}function f(e){a.get(e).then(function(e){m.volumes=i("orderBy")(_.filter(e,{policy:m.policy.name}),"name")})}function v(){angular.forEach(m.policy.filesystems,function(e,t){this.push({name:t,value:e})},m.filesystemcmds)}function h(){m.filesystemcmds.forEach(function(e){m.policy.filesystems[e.name]=e.value})}function g(){m.form.$valid&&(l.hideServerError(m),l.startLoader(m),h(),r.save(m.policy).then(function(e){l.stopLoader(m),u()},function(e){l.stopLoader(m),l.showServerError(m,e)}))}var m=this;m.filesystemcmds=[],l.stopLoader(m),l.hideServerError(m),r.getModelByKey(t.key,!1,"name").then(function(e){m.policy=e,v(),f(!1)}),m.deletePolicy=p,m.savePolicy=g,m.cancelEditing=d,s();var y;angular.isDefined(y)||(y=n(function(){f(!0)},ContivGlobals.REFRESH_INTERVAL)),o.$on("$destroy",function(){n.cancel(y)})}]),angular.module("contiv.storagepolicies").directive("ctvStoragepolicybasicsettings",function(){return{}}).directive("ctvStoragepolicyfilesystemsettings",function(){return{restrict:"E",scope:{policy:"=",filesystemcmds:"="},link:function(e){e.filesystems=["ext4","btrfs"]},templateUrl:"storage_policies/filesystemsettings.html"}}).directive("ctvStoragepolicysnapshotsettings",function(){return{restrict:"E",scope:{policy:"="},templateUrl:"storage_policies/snapshotsettings.html"}}).directive("ctvStoragepolicyrwopssettings",function(){return{restrict:"E",scope:{policy:"="},templateUrl:"storage_policies/rwopssettings.html"}}).directive("ctvStoragepolicybackenddrivers",function(){return{restrict:"E",scope:{policy:"="},templateUrl:"storage_policies/backenddrivers.html"}}),angular.module("contiv.storagepolicies").config(["$stateProvider",function(e){e.state("contiv.menu.storagepolicies.list",{url:"/list",controller:"StoragePolicyListCtrl as storagePolicyListCtrl",templateUrl:"storage_policies/storagepolicylist.html"})}]).controller("StoragePolicyListCtrl",["$scope","$interval","$filter","StoragePoliciesModel","CRUDHelperService",function(e,t,o,n,i){function r(e){n.get(e).then(function(e){i.stopLoader(a),a.policies=e},function(e){i.stopLoader(a)})}var a=this;r(!1);var l;angular.isDefined(l)||(l=t(function(){r(!0)},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(l)})}]),angular.module("contiv.visualization").config(["$stateProvider",function(e){e.state("contiv.menu.visualization.edge",{url:"/edge/{sourceName, targetName, sourceList, targetList}",params:{sourceName:null,targetName:null,sourceList:null,targetList:null},controller:"VisualizationEdgeCtrl as visualizationedgeCtrl",templateUrl:"visualization/visualizationedge.html"})}]).controller("VisualizationEdgeCtrl",["$scope","$http","$state","$stateParams","VisualizationService","$interval",function(e,t,o,n,i,r){var a=n.sourceName,l=n.targetName,s=n.sourceList,c=n.targetList;if(null==s||null==c)return void o.go("contiv.menu.visualization.list");var u=new Date,d=u.getSeconds();e.edgeDataInterval=r(function(){i.getEdgeData(s,c,d.toString()).then(function(t){var o=t.results,n=0;_.forEach(o,function(e){_.isEmpty(e)===!1&&(n+=e.series[0].values[0][1])}),e.sourceName=a,e.targetName=l,e.edgeData=n,e.edgeDataTime=d},function(e){})},3e3),e.$on("$destroy",function(){r.cancel(e.edgeDataInterval)}),i.getOldEdgeData(s,c).then(function(t){var o=t.results,n=[];_.forEach(o,function(e){if(_.isEmpty(e)===!1){var t=e.series[0].values;_.isEmpty(n)?_.forEach(t,function(e){n.push(e[1])}):_.forEach(t,function(e,t){n[t]+=e[1]})}}),e.sourceName=a,e.targetName=l,e.sourceList=s,e.targetList=c,e.oldEdgeData=n},function(e){})}]),angular.module("contiv.visualization").directive("visualizationEdge",["$window",function(e){function t(e,t){function o(){s=new Date;for(var t in c){var n=c[t];n.data.push(e.edgeData||0),n.path.attr("d",p)}u.domain([s-(a-2)*l,s-l]),g.transition().duration(l).ease("linear").call(u.axis),v.transition().duration(l).ease("linear").call(d.axis),m.attr("transform",null).transition().duration(l).ease("linear").attr("transform","translate("+u(s-(a-1)*l)+")").each("end",function(){o()});for(var t in c){var n=c[t];n.data.shift()}}var n=document.getElementsByTagName("body")[0],i=n.clientWidth-400,r=n.clientHeight-400,a=59,l=750,s=new Date(Date.now()-l),c={current:{value:0,color:"orange",data:t.range(a).map(function(t){return e.oldEdgeData[Math.floor(t/10)]||0})}},u=t.time.scale().domain([s-(a-2),s-l]).range([0,i]),d=t.scale.linear().domain([0,t.max(c.current.data,function(e){return e+10})]).range([r,0]),p=t.svg.line().interpolate("basis").x(function(e,t){return u(s-(a-1-t)*l)}).y(function(e){return d(e)}),f=t.select(".graph").append("svg").attr("width",25).style("overflow","visible").style("position","fixed"),v=f.append("g").attr("class","y axis").call(d.axis=t.svg.axis().scale(d).orient("left")),h=t.select(".graph").append("svg").attr("class","chart").attr("width",i-50).attr("height",r+50),g=h.append("g").attr("class","x axis").attr("transform","translate(0,"+r+")").call(u.axis=t.svg.axis().scale(u).orient("bottom")),m=h.append("g");for(var y in c){var w=c[y];w.path=m.append("path").data([w.data]).attr("class",y+" group").style("stroke",w.color)}o()}return{restrict:"EA",replace:!1,templateUrl:"visualization/visualizationedgetemplate.html",link:function(o){o.$watchGroup(["edgeData","oldEdgeData"],function(){if(null!=o.edgeData&&null!=o.oldEdgeData&&!o.initialize){o.initialize=!0;var n=e.d3;t(o,n)}})}}}]),angular.module("contiv.visualization").service("StateSave",function(){this.savedStates={}}).directive("visualizationGraph",["$window","$state","VisualizerGraph","PolicyService","VisualizerDataSource","StateSave",function(e,t,o,n,i,r){function a(e,o,n,i,r,a){if(void 0!==e.nodes&&void 0!==e.links&&void 0!==e.children_struct&&void 0!==e.ancestors_struct){var l=new r.DataSource(e.nodes,e.links,e.children_struct,e.ancestors_struct,e.labels,e.serviceSelectors);l.setAncestors();var s,c,u=l.getTopLevelFlow();s=l.processNodeData(u.nodeData),c=l.processLinkData(u.linkData,s);var d=document.getElementsByTagName("body")[0],p=(d.clientWidth,d.clientHeight),f=o.find("svg"),v=$(f.parent()).offset(),h=$(f.parent()).width(),g=d3.select(f[0]).attr("width",h).attr("height",p-v.top-20);e.visualizationGraph=new n.Graph(g,s,c,l,e.children_struct,e.ancestors_struct),e.visualizationGraph.installDefaultPathPolicy(new i.SaveStatePolicy(a.savedStates)),e.visualizationGraph.installDefaultPathPolicy(new i.PathChangeViewPolicy(t));var m=new i.QTipPolicy;e.visualizationGraph.installDefaultNodePolicy(m),e.visualizationGraph.installDefaultPathPolicy(m);var y=new i.SplitJoinViewPolicy;if(e.visualizationGraph.installDefaultNodePolicy(y),y.installBackButton($("#backButton")),y.installTitle($("#graph-title")),0==_.isEmpty(a.savedStates)){var w=e.visualizationGraph;w.load(a.savedStates)}else e.visualizationGraph.updateGraph()}}return{restrict:"EA",replace:!1,templateUrl:"visualization/visualizationtemplate.html",link:function(e,t){e.$on("$destroy",function(){$("#visualization-graph").unbind(),e.visualizationGraph.destroy()}),e.$watchGroup(["nodes","links","children_struct","ancestors_struct"],function(){null!=e.nodes&&null!=e.links&&null!=e.children_struct&&null!=e.ancestors_struct&&(e.initialized?(e.visualizationGraph.dataSource.links=e.links,e.visualizationGraph.updateLinkData()):(e.initialized=!0,a(e,t,o,n,i,r)))})}}}]),angular.module("contiv.visualization").config(["$stateProvider",function(e){e.state("contiv.menu.visualization.list",{url:"/list",controller:"VisualizationListCtrl as visualizationListCtrl",templateUrl:"visualization/visualizationlist.html"})}]).controller("VisualizationListCtrl",["$scope","$http","VisualizationService","$interval",function(e,t,o,n){var i=function(t){var o=[],n=[],i=[];_.forEach(t.results[0].series,function(e){var t,r=e.tags.EndpointIP,a=e.tags.ProviderIP;0==_.includes(i,r)&&(t={name:r,id:r,parent:null,ancestors:null},o.push(t),i.push(r)),0==_.includes(i,a)&&(t={name:a,id:a,parent:null,ancestors:null},o.push(t),i.push(a));var l={source:r,target:a,weight:e.values[0][2]};n.push(l);var s={source:a,target:r,weight:e.values[0][1]};n.push(s)}),e.nodes=o,e.links=n};o.getGraphData().then(i,function(e){}),e.$on("$destroy",function(){n.cancel(e.graphDataInterval)}),o.getStructureData().then(function(t){e.ancestors_struct=t.ancestors_struct,e.children_struct=t.children_struct,e.labels=t.labels,e.serviceSelectors=t.serviceSelectors},function(e){})}]),angular.module("contiv.visualization").factory("VisualizationService",["$http","$q",function(e,t){function o(o,n){var i=t.defer();return e.get(o,n).then(function(e){i.resolve(e.data)},function(e){i.reject(e.data)}),i.promise}function n(o,n){var i=function(e){var t,o,n,r,a,l,s,c="";for(t in e)if(o=e[t],o instanceof Array)for(s=0;s<o.length;++s)a=o[s],n=t+"["+s+"]",l={},l[n]=a,c+=i(l)+"&";else if(o instanceof Object)for(r in o)a=o[r],n=t+"["+r+"]",l={},l[n]=a,c+=i(l)+"&";else void 0!==o&&null!==o&&(c+=encodeURIComponent(t)+"="+encodeURIComponent(o)+"&");return c.length?c.substr(0,c.length-1):c},r=t.defer();return e({url:o,method:"POST",data:n,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(e){return angular.isObject(e)&&"[object File]"!==String(e)?i(e):e}]}).then(function(e){r.resolve(e.data)},function(e){r.reject(e.data)}),r.promise}function i(){var e=ContivGlobals.VISUALIZATION_ENDPOINT;e+="influx/query";var t={params:{db:"telegraf",q:"SELECT BytesIn, BytesOut, EndpointIP, ProviderIP FROM httpjson_svcstats WHERE time > now() - 1m GROUP BY * LIMIT 1"}};return o(e,t)}function r(){var e=ContivGlobals.VISUALIZATION_ENDPOINT;return e+="services",o(e)}function a(e,t){var o="(";o+=t+"=",o+="'"+e[0]+"' ";for(var n=1;n<e.length;n++)o+="OR ",o+=t+"=",o+="'"+e[n]+"' ";return o+=")"}function l(e,t,o){var i=ContivGlobals.VISUALIZATION_ENDPOINT;i+="influx/query";var r={db:"telegraf",q:"SELECT sum(BytesOut) from httpjson_svcstats WHERE time > now() - 15s AND "+a(e,"EndpointIP")+" AND "+a(t,"ProviderIP")+"GROUP BY time(20s) LIMIT 1; SELECT sum(BytesIn) from httpjson_svcstats WHERE time > now() - 15s AND "+a(e,"ProviderIP")+" AND "+a(t,"EndpointIP")+"GROUP BY time(20s) fill(0) LIMIT 1"};return n(i,r)}function s(e,t){var o=ContivGlobals.VISUALIZATION_ENDPOINT;o+="influx/query";var i={db:"telegraf",q:"SELECT sum(BytesOut) FROM httpjson_svcstats WHERE time > now() - 1m AND "+a(e,"EndpointIP")+" AND "+a(t,"ProviderIP")+" GROUP BY time(10s) fill(0) LIMIT 6; SELECT sum(BytesIn) FROM httpjson_svcstats WHERE time > now() - 1m AND "+a(e,"ProviderIP")+" AND "+a(t,"EndpointIP")+" GROUP BY time(10s) fill(0) LIMIT 6"};return n(o,i)}return{getGraphData:i,getStructureData:r,getEdgeData:l,getOldEdgeData:s}}]),angular.module("contiv.volumes").config(["$stateProvider",function(e){e.state("contiv.menu.volumes.create",{url:"/create",templateUrl:"volumes/volumecreate.html",controller:"VolumeCreateCtrl as volumeCreateCtrl"})}]).controller("VolumeCreateCtrl",["$state","$stateParams","VolumesModel","StoragePoliciesModel","CRUDHelperService",function(e,t,o,n,i){function r(){e.go("contiv.menu.volumes.list")}function a(){r()}function l(){n.get().then(function(e){d.policies=e})}function s(){d.newVolume.policy=d.selectedPolicy.name,d.newVolume.backends=d.selectedPolicy.backends,d.newVolume.driver=d.selectedPolicy.driver,d.newVolume.create=d.selectedPolicy.create,d.newVolume.runtime=d.selectedPolicy.runtime}function c(){d.form.$valid&&(i.hideServerError(d),i.startLoader(d),s(),o.create(d.newVolume).then(function(e){i.stopLoader(d),r()},function(e){i.stopLoader(d),i.showServerError(d,e)}))}function u(){i.stopLoader(d),i.hideServerError(d),d.newVolume={name:"",backends:{},driver:{},create:{},runtime:{}}}var d=this;d.filesystems=["ext4","btrfs"],d.createVolume=c,d.cancelCreating=a,l(),u()}]),angular.module("contiv.volumes").config(["$stateProvider",function(e){e.state("contiv.menu.volumes.details",{url:"/details/:key",controller:"VolumeDetailsCtrl as volumeDetailsCtrl",templateUrl:"volumes/volumedetails.html"})}]).controller("VolumeDetailsCtrl",["$state","$stateParams","$scope","$interval","$http","VolumesModel","VolumeService","CRUDHelperService",function(e,t,o,n,i,r,a,l){function s(){e.go("contiv.menu.volumes.list")}function c(){l.hideServerError(v),l.startLoader(v),r["delete"](v.volume).then(function(e){l.stopLoader(v),s()})}function u(e){var o=t.key.split("/"),n={};n.policy=o[0],n.name=o[1],r.getModel(n,e).then(function(e){v.volume=e,d(),p()})}function d(){a.getVolumeUseInfo(v.volume).then(function(e){v.volumeUse=e},function(e){})}function p(){a.getVolumeSnapshots(v.volume).then(function(e){v.snapshots=e},function(e){})}function f(){v.snapshotSuccess=!1,l.hideServerError(v),l.startLoader(v),a.triggerSnapshot(v.volume).then(function(e){l.stopLoader(v),v.snapshotSuccess=!0},function(e){l.stopLoader(v),l.showServerError(v,e)})}var v=this;v.deleteVolume=c,v.triggerVolumeSnapshot=f,u(!1);var h;angular.isDefined(h)||(h=n(function(){u(!0)},ContivGlobals.REFRESH_INTERVAL)),o.$on("$destroy",function(){n.cancel(h)})}]),angular.module("contiv.volumes").config(["$stateProvider",function(e){e.state("contiv.menu.volumes.list",{url:"/list",controller:"VolumeListCtrl as volumeListCtrl",templateUrl:"volumes/volumelist.html"})}]).controller("VolumeListCtrl",["$scope","$interval","$filter","VolumesModel","CRUDHelperService",function(e,t,o,n,i){function r(e){n.get(e).then(function(e){i.stopLoader(a),a.volumes=e},function(e){i.stopLoader(a)})}var a=this;r(!1);var l;angular.isDefined(l)||(l=t(function(){r(!0)},ContivGlobals.REFRESH_INTERVAL)),e.$on("$destroy",function(){t.cancel(l)})}]),angular.module("contiv.volumes").factory("VolumeService",["$http","$q",function(e,t){function o(o){var n=t.defer(),i=ContivGlobals.VOLUMES_USES_ENDPOINT+o.policy+"/"+o.name;return e.get(i).then(function(e){n.resolve(e.data)},function(e){n.reject(e.data)}),n.promise}function n(o){var n=t.defer(),i=ContivGlobals.VOLUMES_SNAPSHOTS_ENDPOINT+o.policy+"/"+o.name;return e.get(i).then(function(e){n.resolve(e.data)},function(e){n.reject(e.data)}),n.promise}function i(o){var n=t.defer(),i=ContivGlobals.VOLUMES_SNAPSHOTS_ENDPOINT+"take/"+o.policy+"/"+o.name;return e.post(i).then(function(e){n.resolve(e.data)},function(e){n.reject(e.data)}),n.promise}return{getVolumeUseInfo:o,getVolumeSnapshots:n,triggerSnapshot:i}}]),angular.module("contiv.volumes").config(["$stateProvider",function(e){e.state("contiv.menu.volumes.copy",{url:"/copy/",params:{snapshot:null,policy:null,volume:null},controller:"VolumeSnapshotCopyCtrl as volumeSnapshotCopyCtrl",templateUrl:"volumes/volumesnapshotcopy.html"})}]).controller("VolumeSnapshotCopyCtrl",["$state","$stateParams","$scope","$interval","$http","VolumesModel","CRUDHelperService",function(e,t,o,n,i,r,a){function l(){e.go("contiv.menu.volumes.details",{key:t.policy+"/"+t.volume})}function s(){e.go("contiv.menu.volumes.details",{key:t.policy+"/"+u.newvolume})}function c(){if(u.form.$valid){a.hideServerError(u),a.startLoader(u);var e={};e.policy=t.policy,e.name=t.volume,r.copy(e,t.snapshot,u.newvolume).then(function(e){a.stopLoader(u),s()},function(e){a.stopLoader(u),a.showServerError(u,e)})}}var u=this;u.policy=t.policy,u.volume=t.volume,u.snapshot=t.snapshot,u.copySnapshot=c,u.cancelCopy=l}]),angular.module("contiv.directives").directive("ctvAccordion",function(){return{restrict:"E",transclude:!0,scope:{items:"="},link:function(e,t){"function"==typeof t.find(".ui.accordion").accordion&&t.find(".ui.accordion").accordion()},templateUrl:"components/directives/accordion.html"}}),angular.module("contiv.directives").directive("ctvCollapsible",function(){return{restrict:"E",scope:{title:"@",collapsed:"@"},transclude:!0,link:function(e){void 0===e.collapsed&&(e.collapsed=!0)},templateUrl:"components/directives/collapsible.html"}}),angular.module("contiv.directives").directive("ctvNamevalue",function(){return{restrict:"E",scope:{items:"=",nameheader:"@",valueheader:"@",type:"@",options:"="},link:function(e){function t(e,t){return e.name==t.name}function o(){e.newItem={name:"",value:""}}function n(e){return""===e.name&&""===e.value}e.add=function(){n(e.newItem)||(void 0===e.item&&(e.item=[]),_.pullAllWith(e.items,[e.newItem],t),e.items.push(e.newItem),o())},e.remove=function(t){_.remove(e.items,function(e){return e.name==t.name})},o(),void 0===e.nameheader&&(e.nameheader="Name"),void 0===e.valueheader&&(e.valueheader="Value"),void 0===e.type&&(e.type="text")},templateUrl:"components/directives/namevalue.html"}}),angular.module("contiv.directives").directive("ctvTable",["filterFilter","limitToFilter",function(e,t){return{restrict:"E",transclude:!0,scope:{items:"=",filtereditems:"=",size:"@",defaultsortcolumn:"@"},controller:["$scope","$element","$attrs","$filter",function(o,n,i,r){function a(n,i){if(p.searchText=i,(void 0===n||0>n)&&(n=0),p.pageNo=n,void 0!==o.items){var a=e(o.items,p.searchText);a=r("orderBy")(a,p.sortObj.field,p.sortObj.reverse);var l=Math.ceil(a.length/p.size);0==l&&(l=1),p.chunks=[];for(var s=0;l>s;s++)p.chunks.push({selected:!1,pageNo:s});if(n>=p.chunks.length&&(p.pageNo=0),p.chunks[p.pageNo].selected=!0,p.chunks.length>5){var c,u;c=p.pageNo-2,u=p.pageNo+3,0>c&&(u-=c,c=0),u>p.chunks.length&&(c-=u-p.chunks.length,u=p.chunks.length),o.paginationMenu.chunks=p.chunks.slice(c,u)}else o.paginationMenu.chunks=p.chunks;p.filteredItems=t(a,p.size,p.pageNo*p.size),o.filtereditems=p.filteredItems}return!1}function l(){var e;return e=p.pageNo<=0?0:p.pageNo-1,a(e)}function s(){var e;return e=p.pageNo+1,e>p.chunks.length-1&&(e=p.chunks.length-1),a(e)}function c(e){o.paginationMenu=e}function u(e){return{field:e,reverse:!1,iconDirection:{"angle down icon":!0,"angle up icon":!1}}}function d(e){e==p.sortObj.field?(p.sortObj.field=e,p.sortObj.reverse=!p.sortObj.reverse,p.sortObj.iconDirection={"angle down icon":!p.sortObj.reverse,"angle up icon":p.sortObj.reverse}):p.sortObj=u(e),p.showChunk(p.pageNo,p.searchText),o.$apply()}var p=this;p.chunks=[],p.pageNo=0,p.sortObj=u(o.defaultsortcolumn),p.size=parseInt(o.size,10),isNaN(p.size)&&(p.size=12),p.showChunk=a,p.showNextChunk=s,p.showPrevChunk=l,p.addPaginationMenu=c,p.sort=d}],link:function(e,t,o,n){e.$parent.$watch(o.items,function(){n.showChunk(n.pageNo,n.searchText)})},templateUrl:"components/directives/table.html"}}]).directive("ctvThead",function(){return{restrict:"E",transclude:!0,replace:!0,template:"<thead ng-transclude></thead>"}}).directive("ctvTh",function(){return{restrict:"E",transclude:!0,replace:!0,require:"^^ctvTable",scope:{"class":"@",sortfield:"="},link:function(e,t,o,n){e.tablectrl=n,void 0!=e.sortfield&&null!=e.sortfield&&t.bind("click",function(){n.sort(e.sortfield)})},templateUrl:"components/directives/tableheader.html"}}).directive("ctvTbody",function(){return{restrict:"E",scope:{},transclude:!0,replace:!0,template:"<tbody ng-transclude></tbody>"}}).directive("ctvTfoot",function(){return{restrict:"E",scope:{},transclude:!0,replace:!0,template:"<tfoot ng-transclude></tfoot>"}}).directive("ctvTsearch",function(){return{restrict:"E",require:"^^ctvTable",scope:{placeholder:"@",size:"@"},link:function(e,t,o,n){e.showChunk=function(){n.showChunk(n.pageNo,e.searchText)}},templateUrl:"components/directives/searchinput.html"}}).directive("ctvTr",function(){return{restrict:"E",transclude:"true",replace:!0,scope:{},template:"<tr ng-transclude></tr>"}}).directive("ctvTd",function(){return{restrict:"E",transclude:!0,replace:!0,scope:!0,template:"<td ng-transclude></td>"}}).directive("ctvTpagination",function(){return{restrict:"E",require:"^^ctvTable",scope:{colspan:"@"},replace:!0,link:function(e,t,o,n){n.addPaginationMenu(e),n.showChunk(n.pageNo,n.searchText),e.showChunk=function(e){n.showChunk(e,n.searchText)},e.showPrevChunk=n.showPrevChunk,e.showNextChunk=n.showNextChunk},templateUrl:"components/directives/paginationmenu.html"}}),angular.module("contiv.directives").directive("ctvAcivalid",function(){return{restrict:"E",templateUrl:"components/directives/nodes/acivalid.html",scope:{form:"="}}}),angular.module("contiv.directives").directive("ctvControlinterface",function(){return{restrict:"E",templateUrl:"components/directives/nodes/controlinterface.html",scope:{extravars:"="}}}),angular.module("contiv.directives").directive("ctvNetworkmode",function(){return{restrict:"E",templateUrl:"components/directives/nodes/networkmode.html",scope:{extravars:"="}}}),angular.module("contiv.directives").directive("ctvScheduler",function(){return{restrict:"E",templateUrl:"components/directives/nodes/scheduler.html",scope:{extravars:"="}}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9idW5kbGUuanMiLCJtb2R1bGUuanMiLCJkaXJlY3RpdmVzL21vZHVsZS5qcyIsImRhdGFzb3VyY2UvZGF0YXNvdXJjZS5qcyIsIm1vZGVscy9tb2R1bGUuanMiLCJ1dGlscy9tb2R1bGUuanMiLCJkYXRhc291cmNlL3Zpc3VhbGl6ZXJkYXRhc291cmNlLmpzIiwiZ3JhcGgvZ3JhcGguanMiLCJncmFwaC92aXN1YWxpemVyZ3JhcGguanMiLCJsaW5rL2xpbmsuanMiLCJsaW5rL3Zpc3VhbGl6ZXJsaW5rLmpzIiwibm9kZS9ub2RlLmpzIiwibm9kZS92aXN1YWxpemVybm9kZS5qcyIsInBvbGljeS9ub2Rlc2VsZWN0aW9ucG9saWN5LmpzIiwicG9saWN5L3BhdGhjaGFuZ2V2aWV3cG9saWN5LmpzIiwiYXBwbGljYXRpb25ncm91cHMvbW9kdWxlLmpzIiwicG9saWN5L3BvbGljeS5qcyIsImRhc2hib2FyZC9tb2R1bGUuanMiLCJwb2xpY3kvcG9saWN5c2VydmljZS5qcyIsImxvZ2luL21vZHVsZS5qcyIsInBvbGljeS9xdGlwcG9saWN5LmpzIiwibWVudS9tb2R1bGUuanMiLCJwb2xpY3kvc2F2ZXN0YXRlcG9saWN5LmpzIiwibmV0d29ya19wb2xpY2llcy9tb2R1bGUuanMiLCJwb2xpY3kvc3BsaXRqb2lubm9kZXBvbGljeS5qcyIsIm5ldHdvcmtzL21vZHVsZS5qcyIsInBvbGljeS9zcGxpdGpvaW52aWV3cG9saWN5LmpzIiwibm9kZXMvbW9kdWxlLmpzIiwib3JnYW5pemF0aW9ucy9tb2R1bGUuanMiLCJzZXJ2aWNlX2xicy9tb2R1bGUuanMiLCJzZXR0aW5ncy9tb2R1bGUuanMiLCJzdG9yYWdlX3BvbGljaWVzL21vZHVsZS5qcyIsInZpc3VhbGl6YXRpb24vbW9kdWxlLmpzIiwidm9sdW1lcy9tb2R1bGUuanMiLCJhcHAuanMiLCJhcHBsaWNhdGlvbmdyb3Vwcy9hcHBsaWNhdGlvbmdyb3VwY3JlYXRlY3RybC5qcyIsImFwcGxpY2F0aW9uZ3JvdXBzL2FwcGxpY2F0aW9uZ3JvdXBkZXRhaWxzY3RybC5qcyIsImFwcGxpY2F0aW9uZ3JvdXBzL2FwcGxpY2F0aW9uZ3JvdXBsaXN0Y3RybC5qcyIsImFwcGxpY2F0aW9uZ3JvdXBzL2JhbmR3aWR0aHBvbGljeWRpcmVjdGl2ZS5qcyIsImFwcGxpY2F0aW9uZ3JvdXBzL2lzb2xhdGlvbnBvbGljeWRpcmVjdGl2ZS5qcyIsImxvZ2luL2xvZ2luY3RybC5qcyIsIm1lbnUvbWVudUN0cmwuanMiLCJuZXR3b3JrX3BvbGljaWVzL2JhbmR3aWR0aGRpcmVjdGl2ZS5qcyIsIm5ldHdvcmtfcG9saWNpZXMvYmFuZHdpZHRocG9saWN5Y3JlYXRlY3RybC5qcyIsIm5ldHdvcmtfcG9saWNpZXMvYmFuZHdpZHRocG9saWN5ZGV0YWlsc2N0cmwuanMiLCJuZXR3b3JrX3BvbGljaWVzL2JhbmR3aWR0aHBvbGljeWxpc3RjdHJsLmpzIiwibmV0d29ya19wb2xpY2llcy9pc29sYXRpb25wb2xpY3lkZXRhaWxzY3RybC5qcyIsIm5ldHdvcmtfcG9saWNpZXMvaXNvbGF0aW9ucG9saWN5bGlzdGN0cmwuanMiLCJuZXR3b3JrX3BvbGljaWVzL25ldHdvcmtwb2xpY2llc3RhYnNjdHJsLmpzIiwibmV0d29ya3MvbmV0d29ya2NyZWF0ZWN0cmwuanMiLCJuZXR3b3Jrcy9uZXR3b3JrZGV0YWlsc2N0cmwuanMiLCJuZXR3b3Jrcy9uZXR3b3JrbGlzdGN0cmwuanMiLCJuZXR3b3Jrcy9uZXR3b3Jrc3RhdHNjdHJsLmpzIiwibm9kZXMvYmdwc2VydmljZS5qcyIsIm5vZGVzL2xvZ3NkaXJlY3RpdmUuanMiLCJub2Rlcy9sb2dzZXJ2aWNlLmpzIiwibm9kZXMvbm9kZWFjdGl2ZWpvYmxvZ3NjdHJsLmpzIiwibm9kZXMvbm9kZWNvbW1pc3Npb25jdHJsLmpzIiwibm9kZXMvbm9kZWRldGFpbHNjdHJsLmpzIiwibm9kZXMvbm9kZWRpcmVjdGl2ZS5qcyIsIm5vZGVzL25vZGVkaXNjb3ZlcmN0cmwuanMiLCJub2Rlcy9ub2RlbGFzdGpvYmxvZ3NjdHJsLmpzIiwibm9kZXMvbm9kZWxpc3RjdHJsLmpzIiwib3JnYW5pemF0aW9ucy9vcmdhbml6YXRpb25jcmVhdGVjdHJsLmpzIiwib3JnYW5pemF0aW9ucy9vcmdhbml6YXRpb25kZXRhaWxzY3RybC5qcyIsIm9yZ2FuaXphdGlvbnMvb3JnYW5pemF0aW9ubGlzdGN0cmwuanMiLCJzZXR0aW5ncy9jbHVzdGVyc2V0dGluZ2N0cmwuanMiLCJzZXR0aW5ncy9uZXR3b3Jrc2V0dGluZ2N0cmwuanMiLCJzZXR0aW5ncy92b2x1bWVzZXR0aW5nY3RybC5qcyIsInNlcnZpY2VfbGJzL3NlcnZpY2VsYmNyZWF0ZWN0cmwuanMiLCJzZXJ2aWNlX2xicy9zZXJ2aWNlbGJkZXRhaWxzY3RybC5qcyIsInNlcnZpY2VfbGJzL3NlcnZpY2VsYmxpc3RjdHJsLmpzIiwic2VydmljZV9sYnMvc2VydmljZWxicG9ydHNkaXJlY3RpdmUuanMiLCJzZXJ2aWNlX2xicy9zZXJ2aWNlbGJzdGF0c2N0cmwuanMiLCJzdG9yYWdlX3BvbGljaWVzL3N0b3JhZ2Vwb2xpY3ljcmVhdGVjdHJsLmpzIiwic3RvcmFnZV9wb2xpY2llcy9zdG9yYWdlcG9saWN5ZGV0YWlsc2N0cmwuanMiLCJzdG9yYWdlX3BvbGljaWVzL3N0b3JhZ2Vwb2xpY3lkaXJlY3RpdmUuanMiLCJzdG9yYWdlX3BvbGljaWVzL3N0b3JhZ2Vwb2xpY3lsaXN0Y3RybC5qcyIsInZpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbmVkZ2VjdHJsLmpzIiwidmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9uZWRnZWRpcmVjdGl2ZS5qcyIsInZpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbmdyYXBoZGlyZWN0aXZlLmpzIiwidmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9ubGlzdGN0cmwuanMiLCJ2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb25zZXJ2aWNlLmpzIiwidm9sdW1lcy92b2x1bWVjcmVhdGVjdHJsLmpzIiwidm9sdW1lcy92b2x1bWVkZXRhaWxzY3RybC5qcyIsInZvbHVtZXMvdm9sdW1lbGlzdGN0cmwuanMiLCJ2b2x1bWVzL3ZvbHVtZXNlcnZpY2UuanMiLCJ2b2x1bWVzL3ZvbHVtZXNuYXBzaG90Y29weWN0cmwuanMiLCJjb21wb25lbnRzL2RpcmVjdGl2ZXMvYWNjb3JkaW9uZGlyZWN0aXZlLmpzIiwiY29tcG9uZW50cy9kaXJlY3RpdmVzL2NvbGxhcHNpYmxlZGlyZWN0aXZlLmpzIiwiY29tcG9uZW50cy9kaXJlY3RpdmVzL25hbWV2YWx1ZWRpcmVjdGl2ZS5qcyIsImNvbXBvbmVudHMvZGlyZWN0aXZlcy90YWJsZWRpcmVjdGl2ZS5qcyIsImNvbXBvbmVudHMvZGlyZWN0aXZlcy9ub2Rlcy9hY2l2YWxpZGRpcmVjdGl2ZS5qcyIsImNvbXBvbmVudHMvZGlyZWN0aXZlcy9ub2Rlcy9jb250cm9saW50ZXJmYWNlZGlyZWN0aXZlLmpzIiwiY29tcG9uZW50cy9kaXJlY3RpdmVzL25vZGVzL25ldHdvcmttb2RlZGlyZWN0aXZlLmpzIiwiY29tcG9uZW50cy9kaXJlY3RpdmVzL25vZGVzL3NjaGVkdWxlcmRpcmVjdGl2ZS5qcyJdLCJuYW1lcyI6WyJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iLCJzZWxmIiwiY2FsbCIsIlJlZmVyZW5jZUVycm9yIiwiX2luaGVyaXRzIiwic3ViQ2xhc3MiLCJzdXBlckNsYXNzIiwicHJvdG90eXBlIiwiT2JqZWN0IiwiY3JlYXRlIiwiY29uc3RydWN0b3IiLCJ2YWx1ZSIsImVudW1lcmFibGUiLCJ3cml0YWJsZSIsImNvbmZpZ3VyYWJsZSIsInNldFByb3RvdHlwZU9mIiwiX19wcm90b19fIiwiYW5ndWxhciIsIm1vZHVsZSIsIl9jcmVhdGVDbGFzcyIsImRlZmluZVByb3BlcnRpZXMiLCJ0YXJnZXQiLCJwcm9wcyIsImkiLCJsZW5ndGgiLCJkZXNjcmlwdG9yIiwiZGVmaW5lUHJvcGVydHkiLCJrZXkiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJmYWN0b3J5IiwiTm9kZSIsIkxpbmsiLCJEYXRhU291cmNlIiwibm9kZXMiLCJsaW5rcyIsInRoaXMiLCJpZCIsIm5hbWUiLCJub2RlRGF0YSIsIl8iLCJmb3JFYWNoIiwiZGF0YSIsIm5ld05vZGUiLCJ0ZXh0IiwicHVzaCIsImxpbmtEYXRhIiwiZmluZE5vZGVCeUlkIiwic291cmNlIiwibGluayIsIkNvbnRpdkdsb2JhbHMiLCJORVRXT1JLU19FTkRQT0lOVCIsIk5FVFdPUktTX0lOU1BFQ1RfRU5EUE9JTlQiLCJTRVJWSUNFTEJTX0lOU1BFQ1RfRU5EUE9JTlQiLCJQT0xJQ0lFU19FTkRQT0lOVCIsIlJVTEVTX0VORFBPSU5UIiwiQVBQTElDQVRJT05HUk9VUFNfRU5EUE9JTlQiLCJTRVJWSUNFTEJTX0VORFBPSU5UIiwiT1JHQU5JWkFUSU9OU19FTkRQT0lOVCIsIk5FVFdPUktfU0VUVElOR1NfRU5EUE9JTlQiLCJORVRQUk9GSUxFU19FTkRQT0lOVCIsIkJHUFNfRU5EUE9JTlQiLCJCR1BTX0lOU1BFQ1RfRU5EUE9JTlQiLCJWSVNVQUxJWkFUSU9OX0VORFBPSU5UIiwiVk9MVU1FU19FTkRQT0lOVCIsIlZPTFVNRVNfQ1JFQVRFX0VORFBPSU5UIiwiVk9MVU1FU19ERUxFVEVfRU5EUE9JTlQiLCJWT0xVTUVTX0NPUFlTTkFQU0hPVFNfRU5EUE9JTlQiLCJWT0xVTUVTX1VTRVNfRU5EUE9JTlQiLCJWT0xVTUVTX1NOQVBTSE9UU19FTkRQT0lOVCIsIlNUT1JBR0VQT0xJQ0lFU19FTkRQT0lOVCIsIlZPTFVNRVNfR0xPQkFMX0VORFBPSU5UIiwiTk9ERVNfTElTVF9FTkRQT0lOVCIsIk5PREVTX0RJU0NPVkVSX0VORFBPSU5UIiwiTk9ERVNfQ09NTUlTU0lPTl9FTkRQT0lOVCIsIk5PREVTX0RFQ09NTUlTU0lPTl9FTkRQT0lOVCIsIk5PREVTX01BSU5URU5BTkNFX0VORFBPSU5UIiwiTk9ERVNfTEFTVF9KT0JfRU5EUE9JTlQiLCJOT0RFU19BQ1RJVkVfSk9CX0VORFBPSU5UIiwiTk9ERVNfU0VUVElOR1NfU0VUX0VORFBPSU5UIiwiTk9ERVNfU0VUVElOR1NfR0VUX0VORFBPSU5UIiwiUkVGUkVTSF9JTlRFUlZBTCIsIkNJRFJfUkVHRVgiLCJWTEFOX1JFR0VYIiwiVlhMQU5fUkVHRVgiLCJOVU1CRVJfUkVHRVgiLCJWaXN1YWxpemVyTm9kZSIsIlZpc3VhbGl6ZXJMaW5rIiwiVmlzdWFsaXplckRhdGFTb3VyY2UiLCJfRGF0YVNvdXJjZSREYXRhU291cmMiLCJjaGlsZHJlbl9zdHJ1Y3QiLCJhbmNlc3RvcnNfc3RydWN0IiwibGFiZWxzIiwic2VsZWN0b3JzIiwiX3RoaXMiLCJnZXRQcm90b3R5cGVPZiIsInRoaXNEYXRhU291cmNlIiwiYWRkZWRDbGllbnQiLCJub2RlIiwiYW5jZXN0b3JzIiwiaXNFbXB0eSIsInBhcmVudCIsImluY2x1ZGVzIiwidG9wTGV2ZWwiLCJnZXRGbG93QmV0d2VlblNldCIsIm5vZGVfbmFtZXMiLCJsb2NhbF9ub2RlcyIsImlkTWFwcGluZyIsImoiLCJpbmRleE9mIiwid2VpZ2h0Iiwibm9kZV90b19hZGQiLCJub2RlSWRUb05hbWUiLCJhZGRlZF9saW5rcyIsInVuZGVmaW5lZCIsImV4aXN0aW5nX2xpbmsiLCJzZXRXZWlnaHQiLCJnZXRSYXdXZWlnaHQiLCJpbmNyZWFzZUNvdW50IiwiUG9saWN5U2VydmljZSIsIkdyYXBoIiwic3ZnIiwidGhpc0dyYXBoIiwiZGVmYXVsdE5vZGVQb2xpY2llcyIsImRlZmF1bHRQYXRoUG9saWNpZXMiLCJzdmdQb2xpY3kiLCJQb2xpY3kiLCJzdGF0ZSIsImNhblpvb20iLCJjYW5QYW4iLCJpbml0Rm9yY2UiLCJkaXNhYmxlVXBkYXRlIiwiY29uc3RzIiwiY2lyY2xlR0NsYXNzIiwiZ3JhcGhDbGFzcyIsInBhdGhDbGFzcyIsIm5vZGVDbGFzcyIsIm5vZGVUZXh0Iiwic3RhcnRSYWRpdXMiLCJtYXhSYWRpdXMiLCJwYWRkaW5nIiwiZGlzcGxheU9mZnNldCIsIm9uIiwiZCIsImRlZnMiLCJhcHBlbmQiLCJhdHRyIiwic3ZnRyIsImNsYXNzZWQiLCJwYXRocyIsInNlbGVjdEFsbCIsImNpcmNsZXMiLCJpbml0Tm9kZXMiLCJpbml0TGlua3MiLCJzZXRQb3NpdGlvbnMiLCJyZXNpemVGdW5jIiwib25XaW5kb3dSZXNpemUiLCJiaW5kaW5ncyIsInJlc2l6ZSIsIiQiLCJ3aW5kb3ciLCJwb2xpY3kiLCJkZXN0cm95Iiwib2ZmIiwiaW5pdGlhbGl6ZSIsImQzTm9kZSIsImVhY2giLCJkMyIsInNlbGVjdCIsImQzZHJhZyIsImRyYWciLCJwb2xpY3lSZW1vdmUiLCJwb2xpY3lSZW1vdmVOYW1lIiwicG9saWN5TmFtZSIsImluZGV4Iiwic3BsaWNlIiwiZXZlbnQiLCJkM3BhdGgiLCJkM25vZGUiLCJkM3pvb20iLCJkcmFnU3ZnIiwiZ0VsIiwidGl0bGUiLCJ3b3JkcyIsInNwbGl0IiwibndvcmRzIiwiZWwiLCJ0c3BhbiIsInRvU3BsaWNlIiwiZmlsdGVyIiwibCIsIm1hcCIsInVwZGF0ZUdyYXBoIiwic3BsaWNlTGlua3NGb3JOb2RlIiwidXBkYXRlQXR0ciIsIm5ld1BhdGhzIiwibmV3UGF0aEF0dHIiLCJoYXNQb2xpY3kiLCJwYXRoUG9saWN5RXZlbnQiLCJuZXdOb2RlcyIsImdyYXBoIiwibmV3Tm9kZUF0dHIiLCJub2RlUG9saWN5RXZlbnQiLCJTdHJpbmciLCJyYWRpdXMiLCJpbnNlcnRUaXRsZUxpbmVicmVha3MiLCJhbHBoYSIsInF1YWR0cmVlIiwiZ2VvbSIsInIiLCJueDEiLCJ4IiwibngyIiwibnkxIiwieSIsIm55MiIsInZpc2l0IiwicXVhZCIsIngxIiwieTEiLCJ4MiIsInkyIiwicG9pbnQiLCJNYXRoIiwic3FydCIsImUiLCJ3aWR0aCIsImhlaWdodCIsIm9mZnNldCIsInEiLCJuIiwiZDNGb3JjZUNvbGxpZGUiLCJtYXgiLCJtaW4iLCJzdmdXaWR0aCIsInN2Z0hlaWdodCIsImNhbGxiYWNrIiwiYm91bmRzIiwiZDNGb3JjZUJvdW5kcyIsImZvcmNlIiwibGF5b3V0Iiwic2l6ZSIsImNoYXJnZSIsImxpbmtEaXN0YW5jZSIsImxpbmtTdHJlbmd0aCIsImdyYXZpdHkiLCJkM0ZvcmNlVGljayIsImQzRm9yY2VTdGFydCIsImQzRm9yY2VFbmQiLCJzdGFydCIsImsiLCJ0aWNrIiwic3RvcCIsInVwZGF0ZUV4aXN0aW5nTm9kZXMiLCJuZXdHcyIsImVudGVyIiwiZXhpdCIsInJlbW92ZSIsInNldEZvcmNlIiwidXBkYXRlTmV3Tm9kZXMiLCJ1cGRhdGVFeGlzdGluZ1BhdGhzIiwibmV3cGF0aHMiLCJzdHlsZSIsInVwZGF0ZU5ld1BhdGhzIiwiVmlzdWFsaXplckdyYXBoIiwiX0dyYXBoJEdyYXBoIiwiZGF0YVNvdXJjZSIsInRyYW5zaXRpb24iLCJlZGdlX2J1ZmZlciIsInJhZGl1c0RlY2F5IiwiY29udGFpbmVyQ2xhc3MiLCJiZWhhdmlvciIsIm9yaWdpbiIsImFyZ3MiLCJkeCIsImR5Iiwiem9vbSIsInNvdXJjZUV2ZW50IiwiY3RybEtleSIsInpvb21lZCIsInRyYW5zbGF0ZSIsInNjYWxlIiwicmlnaHRDbGljayIsImp1c3RTY2FsZVRyYW5zR3JhcGgiLCJ6b29tU2V0Q2FsbGJhY2siLCJ0cmFuc2xhdGVfbmFtZSIsImRlbGF5IiwiZHVyYXRpb24iLCJib2R5RWwiLCJkb2N1bWVudCIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwiZGl2V2lkdGgiLCJjbGllbnRIZWlnaHQiLCJ0b3AiLCJub2RlX25hbWVzX3NldCIsInJldERhdGEiLCJwcm9jZXNzTGlua0RhdGEiLCJzb3VyY2VOb2RlIiwidGFyZ2V0Tm9kZSIsInBhdGhQb2xpY2llcyIsImluaXRpYWxpemVkIiwiYXJyb3dQYXRoIiwiZHIiLCJ0aGlzUGF0aCIsIl9nZXQiLCJnZXQiLCJvYmplY3QiLCJwcm9wZXJ0eSIsInJlY2VpdmVyIiwiRnVuY3Rpb24iLCJkZXNjIiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwiZ2V0dGVyIiwiX0xpbmskTGluayIsImNvdW50IiwicmV0IiwibXkiLCJhdCIsImFkanVzdCIsIm1heFdlaWdodCIsInVzZUF2Z1dlaWdodCIsInVwZGF0ZU1heFdlaWdodCIsInZhbCIsIm1heExpbmsiLCJtYXhCeSIsImdldFdlaWdodCIsImNvbG9yU2NhbGUiLCJsaW5lYXIiLCJkb21haW4iLCJyYW5nZSIsInNlbGVjdGVkQ2xhc3MiLCJzZWxlY3RlZEVkZ2UiLCJjIiwiYXR0clR3ZWVuIiwiaW50ZXJwb2xhdGVTdHJpbmciLCJub2RlUG9saWNpZXMiLCJ0aGlzTm9kZSIsIl9Ob2RlJE5vZGUiLCJ4U3RhcnQiLCJ5U3RhcnQiLCJOb2RlU2VsZWN0aW9uUG9saWN5IiwiX1BvbGljeSRQb2xpY3kiLCJzZWxlY3RlZE5vZGVzIiwic2VsZWN0aW9uIiwiY2QiLCJzdG9wUHJvcGFnYXRpb24iLCJyZW1vdmVTZWxlY3RGcm9tTm9kZSIsImFkZFNlbGVjdE5vZGUiLCJyZW1vdmVBbGxTZWxlY3RlZE5vZGVzIiwiUGF0aENoYW5nZVZpZXdQb2xpY3kiLCIkc3RhdGUiLCJ0aGlzUG9saWN5IiwicmV0TGlzdCIsImdlbmVyYXRlTGlzdEhlbHBlciIsIm5vZGVJZHMiLCJjaGlsZElkIiwiaGFzQ2hpbGQiLCJzdWJSZXRMaXN0IiwiY29uY2F0IiwiZWRnZSIsInNvdXJjZUxpc3QiLCJ0YXJnZXRMaXN0Iiwic291cmNlSWQiLCJ0YXJnZXRJZCIsImdlbmVyYXRlTGlzdCIsImdvIiwic291cmNlTmFtZSIsInRhcmdldE5hbWUiLCJ2aWV3RWRnZSIsImNvbmZpZyIsIiRzdGF0ZVByb3ZpZGVyIiwidXJsIiwiYWJzdHJhY3QiLCJ0ZW1wbGF0ZSIsImQzb2JqIiwiY29tcG9uZW50IiwiUVRpcFBvbGljeSIsIlNwbGl0Sm9pbk5vZGVQb2xpY3kiLCJTcGxpdEpvaW5WaWV3UG9saWN5IiwiU2F2ZVN0YXRlUG9saWN5IiwibW91c2Vkb3duIiwibW91c2V1cCIsImdyYXBoVXBkYXRlTmV3Tm9kZXMiLCJncmFwaFVwZGF0ZU5ld1BhdGhzIiwiaW50ZXJ2YWwiLCJzZXRUaW1lb3V0IiwicXRpcCIsIndoZW5RVGlwQXZhaWxhYmxlIiwiYXR0YWNoUVRpcCIsInNlbGVjdG9yTWFwIiwiaGFzS2V5cyIsImxhYmVsc01hcCIsInNsaWNlIiwiY29udGVudCIsImV2ZW50cyIsInNob3ciLCJhcGkiLCJwb3NpdGlvbiIsImxlZnQiLCJzZXQiLCJzb2xvIiwiY2xhc3NlcyIsImhpZGUiLCJwYXRoRWwiLCJ0YXJnZXRSZXQiLCJnZXRQb2ludEF0TGVuZ3RoIiwiZ2V0VG90YWxMZW5ndGgiLCJxdGlwSGVscGVyIiwic2F2ZWRTdGF0ZSIsImdyYXBoRGVzdHJveSIsImxvYWQiLCJncmFwaExvYWQiLCJfTm9kZVNlbGVjdGlvblBvbGljeSQiLCJzcGxpdE5vZGVzIiwic3VwZXJTdGF0ZSIsInNwbGl0TXVsdGlwbGVOb2RlcyIsInNwbGl0Tm9kZSIsInByZXZlbnREZWZhdWx0Iiwiam9pbk5vZGUiLCJncmFwaE5vZGVzIiwibmV3X25vZGVzIiwieExvYyIsInlMb2MiLCJuZXdfbm9kZV9vYmpzIiwibmV3X25vZGUiLCJyZXMiLCJfX3NwbGl0Tm9kZSIsInNwbGl0Tm9kZUV2ZW50IiwicmVzTm9kZXMiLCJzcGxpdE11bHRpcGxlTm9kZXNFdmVudCIsInRvX2JlX2RlbGV0ZWQiLCJuZXdfbm9kZV9pZCIsIm5vZGVfdG9fZGVsZXRlIiwiX19qb2luTm9kZSIsImpvaW5Ob2RlRXZlbnQiLCJqb2luTXVsdGlwbGVOb2Rlc0V2ZW50IiwiX1NwbGl0Sm9pbk5vZGVQb2xpY3kkIiwic2F2ZWRTdGF0ZXMiLCJldmVudEhpc3RvcnkiLCJmb2N1c0dyb3VwcyIsImZvY2kiLCJ6b29tcyIsImxheW91dERlZmF1bHQiLCJ6b29tRGVmYXVsdCIsIm5vZGVJZHNUb1Jlc2hvdyIsImJhY2tCdXR0b25FbGVtIiwidGl0bGVFbGVtIiwiYm91bmRhcnkiLCJlbGVtIiwiYmFja0J1dHRvbiIsInVuZG9MYXN0RXZlbnQiLCJzYXZlIiwiY3VyclRpdGxlIiwic3RhdGVzIiwibG9hZFN0YXRlIiwiZmFkZVRvIiwidHlwZSIsInBvcyIsImNvbnNvbGUiLCJsb2ciLCJ1cGRhdGVHcmFwaENhbGxiYWNrIiwibm9kZXNUb0tlZXAiLCJncm91cE9uZU5vZGVzIiwicGFyc2VGbG9hdCIsInNwbGl0Tm9kZUZ1bmMiLCJnZXRSYW5kb21JbnQiLCJmbG9vciIsInJhbmRvbSIsImdyYXBoQ29uc3RzIiwic3RhdGVQb2xpY3kiLCJkZWZhdWx0TGF5b3V0IiwiY2FsY01heE5vZGVzIiwiYXJlYSIsImFtb3VudCIsImNvbnN0c1BvbGljeSIsImZvY3VzTm9kZXMiLCJib3QiLCJwb3AiLCJzZXRMYXlvdXQiLCJzdGF0ZVN1cGVyIiwibm9kZU5hbWVTZXQiLCJuYW1lVG9BZGQiLCJub2Rlc1RvUHJvY2VzcyIsInByb2Nlc3NOb2RlRGF0YSIsIm5vZGVUb1JlbW92ZSIsImxhc3QiLCJmaW5kRDNOb2RlIiwiZGJsY2xpY2siLCJub2RlSWQiLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJvdGhlcndpc2UiLCIkc3RhdGVQYXJhbXMiLCJBcHBsaWNhdGlvbkdyb3Vwc01vZGVsIiwiTmV0d29ya3NNb2RlbCIsIkNSVURIZWxwZXJTZXJ2aWNlIiwicmV0dXJuVG9BcHBsaWNhdGlvbkdyb3VwIiwiY2FuY2VsQ3JlYXRpbmciLCJnZXROZXR3b3JrcyIsInRoZW4iLCJyZXN1bHQiLCJhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCIsIm5ldHdvcmtzIiwidGVuYW50TmFtZSIsImNyZWF0ZUFwcGxpY2F0aW9uR3JvdXAiLCJmb3JtIiwiJHZhbGlkIiwiaGlkZVNlcnZlckVycm9yIiwic3RhcnRMb2FkZXIiLCJhcHBsaWNhdGlvbkdyb3VwIiwibmV0d29ya05hbWUiLCJzZWxlY3RlZE5ldHdvcmsiLCJnZW5lcmF0ZUtleSIsInN0b3BMb2FkZXIiLCJzaG93U2VydmVyRXJyb3IiLCJyZXNldEZvcm0iLCJncm91cE5hbWUiLCJwb2xpY2llcyIsIm5ldFByb2ZpbGUiLCJtb2RlIiwic2V0TW9kZSIsImlzIiwiYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsIiwicmV0dXJuVG9BcHBsaWNhdGlvbkdyb3VwRGV0YWlscyIsImNhbmNlbEVkaXRpbmciLCJkZWxldGVBcHBsaWNhdGlvbkdyb3VwIiwic2F2ZUFwcGxpY2F0aW9uR3JvdXAiLCJnZXRNb2RlbEJ5S2V5IiwiZ3JvdXAiLCIkc2NvcGUiLCIkaW50ZXJ2YWwiLCIkZmlsdGVyIiwiZ2V0QXBwbGljYXRpb25Hcm91cHMiLCJyZWxvYWQiLCJhcHBsaWNhdGlvbkdyb3VwTGlzdEN0cmwiLCJncm91cHMiLCJwcm9taXNlIiwiaXNEZWZpbmVkIiwiJG9uIiwiY2FuY2VsIiwiZGlyZWN0aXZlIiwicmVzdHJpY3QiLCJzY29wZSIsImFwcGxpY2F0aW9uZ3JvdXAiLCJOZXRwcm9maWxlc01vZGVsIiwiZ2V0TmV0cHJvZmlsZXMiLCJuZXRQcm9maWxlcyIsInNlbGVjdGVkTmV0cHJvZmlsZSIsImZpbmQiLCJwcm9maWxlTmFtZSIsInVwZGF0ZUFwcGxpY2F0aW9uZ3JvdXAiLCJQb2xpY2llc01vZGVsIiwiUnVsZXNNb2RlbCIsImdldFJ1bGVzIiwiZ2V0SW5jb21pbmdSdWxlcyIsInJ1bGVzIiwiQXJyYXkiLCJhcHBseSIsImluY29taW5nUnVsZXMiLCJnZXRPdXRnb2luZ1J1bGVzIiwib3V0Z29pbmdSdWxlcyIsImdldElzb2xhdGlvblBvbGljaWVzIiwiaXNvbGF0aW9uUG9saWNpZXMiLCJzZWxlY3RlZFBvbGljeSIsInNlbGVjdGVkUG9saWNpZXMiLCJhZGRJc29sYXRpb25Qb2xpY3kiLCJjdXJyZW50UG9saWN5TmFtZSIsInJlbW92ZUlzb2xhdGlvblBvbGljeSIsInJ1bGUiLCJyZXR1cm5Ub0Rhc2hib2FyZCIsInVzZXJuYW1lIiwibG9naW5DdHJsIiwibG9naW4iLCJwYXJhbXMiLCJsb2dvdXQiLCJtZW51Q3RybCIsImJhbmR3aWR0aFBvbGljeSIsImJhbmR3aWR0aCIsImJhbmR3aWR0aEFycmF5IiwiYmFuZHdpZHRoTnVtYmVyIiwiTnVtYmVyIiwiYmFuZHdpZHRoVW5pdCIsInJldHVyblRvUG9saWNpZXMiLCJjcmVhdGVQb2xpY3kiLCJiYW5kd2lkdGhQb2xpY3lDcmVhdGVDdHJsIiwibmV3UG9saWN5IiwiRFNDUCIsImJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsIiwiZGVsZXRlUG9saWN5IiwiZGVsZXRlVXNpbmdLZXkiLCJyZXR1cm5Ub1BvbGljeURldGFpbHMiLCJzYXZlUG9saWN5IiwiYmFuZHdpZHRoUHJvZmlsZXMiLCJnZXRQb2xpY2llcyIsInBvbGljaWVzTGlzdEN0cmwiLCJpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCIsImRvbmVFZGl0aW5nIiwicmVzZXROZXdJbmNvbWluZ1J1bGUiLCJuZXdJbmNvbWluZ1J1bGUiLCJydWxlSWQiLCJwcmlvcml0eSIsImFjdGlvbiIsImZyb21FbmRwb2ludEdyb3VwIiwiZnJvbU5ldHdvcmsiLCJmcm9tSXBBZGRyZXNzIiwicHJvdG9jb2wiLCJwb3J0IiwiZGlyZWN0aW9uIiwibmV3SW5jb21pbmdTZWxlY3RlZEFwcGxpY2F0aW9uR3JvdXAiLCJuZXdJbmNvbWluZ1NlbGVjdGVkTmV0d29yayIsImRpc2FibGVJbmNvbWluZ05ldHdvcmtTZWxlY3Rpb24iLCJkaXNhYmxlSW5jb21pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uIiwiZGlzYWJsZUluY29taW5nSVBBZGRyZXNzU2VsZWN0aW9uIiwiaW5jb3JyZWN0Q0lEUiIsInZhbGlkYXRlQ0lEUkZsYWciLCJyZXNldE5ld091dGdvaW5nUnVsZSIsIm5ld091dGdvaW5nUnVsZSIsInRvRW5kcG9pbnRHcm91cCIsInRvTmV0d29yayIsInRvSXBBZGRyZXNzIiwibmV3T3V0Z29pbmdTZWxlY3RlZEFwcGxpY2F0aW9uR3JvdXAiLCJuZXdPdXRnb2luZ1NlbGVjdGVkTmV0d29yayIsImRpc2FibGVPdXRnb2luZ05ldHdvcmtTZWxlY3Rpb24iLCJkaXNhYmxlT3V0Z29pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uIiwiZGlzYWJsZU91dGdvaW5nSVBBZGRyZXNzU2VsZWN0aW9uIiwiYXBwbGljYXRpb25Hcm91cHMiLCJvbkNoYW5nZU91dGdvaW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiIsIm9uQ2hhbmdlSW5jb21pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uIiwib25DaGFuZ2VPdXRnb2luZ05ldHdvcmtTZWxlY3Rpb24iLCJUb0VuZHBvaW50R3JvdXAiLCJvbkNoYW5nZUluY29taW5nTmV0d29ya1NlbGVjdGlvbiIsImdlbmVyYXRlUnVsZUlkIiwidG9TdHJpbmciLCJEYXRlIiwibm93IiwiYWRkSW5jb21pbmdSdWxlIiwidmFsaWRhdGVDSURSIiwib25DaGFuZ2VJbmNvbWluZ0lQQWRkcmVzcyIsIm9uQ2hhbmdlT3V0Z29pbmdJUEFkZHJlc3MiLCJpcGFkZHJlc3MiLCJjaWRyUGF0dGVybiIsIlJlZ0V4cCIsInRlc3QiLCJhZGRPdXRnb2luZ1J1bGUiLCJkZWxldGVJbmNvbWluZ1J1bGUiLCJkZWxldGVPdXRnb2luZ1J1bGUiLCJjcmVhdGVOZXR3b3JrUG9saWN5IiwiJGN1cnJlbnQiLCJuZXR3b3JrUG9saWNpZXNUYWJzQ3RybCIsInJldHVyblRvTmV0d29ya3MiLCJjcmVhdGVOZXR3b3JrIiwibmV0d29ya0NyZWF0ZUN0cmwiLCJuZXdOZXR3b3JrIiwiZW5jYXAiLCJzdWJuZXQiLCJnYXRld2F5IiwiZGVsZXRlTmV0d29yayIsIm5ldHdvcmtEZXRhaWxzQ3RybCIsIm5ldHdvcmsiLCJOZXR3b3Jrc0xpc3RDdHJsIiwibmV0d29ya3NMaXN0Q3RybCIsIiRpbmplY3QiLCJjb250cm9sbGVyQXMiLCJJbnNwZWN0U2VydmljZSIsImdldE5ldHdvcmtJbnNwZWN0IiwicmVmcmVzaCIsImdldEluc3BlY3RCeUtleSIsIm5ldHdvcmtTdGF0c0N0cmwiLCJuZXR3b3JrSW5zcGVjdFN0YXRzIiwiT3BlciIsIkNvbmZpZyIsImVuZHBvaW50cyIsImNvbnRhaW5lckRldGFpbHMiLCJidWlsZEVuZFBvaW50cyIsImNoZWNrQ29udGFpbmVyQ2hhbmdlZCIsIiRodHRwIiwiJHEiLCJnZXRCZ3AiLCJjdHJsIiwiZGVmZXJyZWQiLCJkZWZlciIsInJlc29sdmUiLCJuZWlnaGJvciIsIm5laWdoYm9ycyIsInJlamVjdCIsInVwZGF0ZUJncCIsInBvc3QiLCJnZXRCZ3BJbnNwZWN0IiwiZ2V0QWN0aXZlTG9ncyIsImdldExhc3RMb2dzIiwiTG9nU2VydmljZSIsIm5vZGVBY3RpdmVKb2JMb2dzQ3RybCIsImFjdGl2ZUxvZ3MiLCJOb2Rlc01vZGVsIiwiTm9kZXNTZXJ2aWNlIiwicmV0dXJuVG9Ob2RlRGV0YWlscyIsImNhbmNlbENvbW1pc3Npb25pbmdOb2RlIiwiY29tbWlzc2lvbiIsIm5vZGVDb21taXNzaW9uQ3RybCIsIm5vZGVPcHNPYmoiLCJjbGVhbnVwRXh0cmFWYXJzIiwiY3JlYXRlRXh0cmFWYXJzIiwiZXh0cmFfdmFycyIsImFuc2libGVWYXJpYWJsZXMiLCJlbnZWYXJpYWJsZXMiLCJnZXRTZXR0aW5ncyIsIkJncFNlcnZpY2UiLCJkZWNvbW1pc3Npb24iLCJub2RlRGV0YWlsc0N0cmwiLCJzaG93Q29tbWlzc2lvbkJ1dHRvbiIsImNvbW1pc3Npb25CdXR0b25FbmFibGVkIiwidXBncmFkZUJ1dHRvbkVuYWJsZWQiLCJ1cGdyYWRlIiwic2V0QnV0dG9uRGlzcGxheSIsInN0YXR1cyIsImdldE5vZGVJbmZvIiwicmV0dXJuVG9JbmZvIiwidXBkYXRlQmdwSW5mbyIsIml0ZW0iLCJnZXRCZ3BJbmZvIiwiaW5zcGVjdCIsInJvdXRlcyIsImZpbHRlcmVkcm91dGVzIiwibnVtYmVycGF0dGVybiIsInJldHVyblRvTm9kZXMiLCJjYW5jZWxEaXNjb3ZlcmluZ05vZGUiLCJkaXNjb3ZlciIsIm5vZGVEaXNjb3ZlckN0cmwiLCJjcmVhdGVJUEFkZHJBcnJheSIsImFkZHJzIiwibm9kZUlQQWRkciIsIm5vZGVMYXN0Sm9iTG9nc0N0cmwiLCJsYXN0TG9ncyIsImdldE5vZGVzIiwibm9kZUxpc3RDdHJsIiwiT3JnYW5pemF0aW9uc01vZGVsIiwicmV0dXJuVG9Pcmdhbml6YXRpb25zIiwiY3JlYXRlT3JnYW5pemF0aW9uIiwib3JnYW5pemF0aW9uQ3JlYXRlQ3RybCIsIm5ld09yZ2FuaXphdGlvbiIsImRlbGV0ZU9yZ2FuaXphdGlvbiIsIm9yZ2FuaXphdGlvbkRldGFpbHNDdHJsIiwib3JnYW5pemF0aW9uIiwiZ2V0T3JnYW5pemF0aW9ucyIsIm9yZ2FuaXphdGlvbnNMaXN0Q3RybCIsIm9yZ2FuaXphdGlvbnMiLCJ1cGRhdGVDbHVzdGVyU2V0dGluZ3MiLCJjbHVzdGVyU2V0dGluZ0N0cmwiLCJ1cGRhdGVTZXR0aW5ncyIsIk5ldHdvcmtTZXJ2aWNlIiwidXBkYXRlTmV0d29ya1NldHRpbmdzIiwibmV0d29ya1NldHRpbmdDdHJsIiwic2V0dGluZyIsImdldE5ldHdvcmtTZXR0aW5ncyIsInZsYW5QYXR0ZXJuIiwidnhsYW5QYXR0ZXJuIiwiVm9sdW1lU2V0dGluZ1NlcnZpY2UiLCJ1cGRhdGVWb2x1bWVTZXR0aW5ncyIsInZvbHVtZVNldHRpbmdDdHJsIiwiZ2V0Vm9sdW1lU2V0dGluZ3MiLCJTZXJ2aWNlbGJzTW9kZWwiLCJyZXR1cm5Ub1NlcnZpY2VsYnMiLCJzZXJ2aWNlbGJDcmVhdGVDdHJsIiwiY3JlYXRlTGFiZWxTZWxlY3RvclN0cmluZ3MiLCJzZXJ2aWNlbGIiLCJsYWJlbFNlbGVjdG9ycyIsImxhYmVsU2VsZWN0b3IiLCJzZWxlY3RvclN0cmluZyIsImNyZWF0ZVNlcnZpY2VsYiIsInNlcnZpY2VOYW1lIiwiaXBBZGRyZXNzIiwicG9ydHMiLCJzZXJ2aWNlbGJEZXRhaWxzQ3RybCIsInJldHVyblRvU2VydmljZWxiRGV0YWlscyIsImRlbGV0ZVNlcnZpY2VsYiIsInNhdmVTZXJ2aWNlbGIiLCJleGlzdGluZ0xhYmVscyIsImNyZWF0ZUxhYmVsU2VsZWN0b3JzIiwic2VsZWN0b3JTdHIiLCJzZWxlY3RvciIsImdldFNlcnZpY2VsYnMiLCJzZXJ2aWNlbGJMaXN0Q3RybCIsInNlcnZpY2VsYnMiLCJpdGVtcyIsImNvbXBhcmUiLCJ2YWwxIiwidmFsMiIsInJlc2V0TmV3SXRlbSIsIm5ld0l0ZW0iLCJzZXJ2aWNlUG9ydCIsInByb3ZpZGVyUG9ydCIsImlzRW1wdHlJdGVtIiwiYWRkIiwibmV3SXRlbVN0ciIsInB1bGxBbGxXaXRoIiwicGFzc2VkSXRlbSIsImdldFNlcnZpY2VsYkluc3BlY3QiLCJzZXJ2aWNlbGJTdGF0c0N0cmwiLCJzZXJ2aWNlbGJJbnNwZWN0U3RhdHMiLCJwcm92aWRlcnMiLCJwcm92aWRlckRldGFpbHMiLCJTdG9yYWdlUG9saWNpZXNNb2RlbCIsInJldHVyblRvU3RvcmFnZVBvbGljaWVzIiwiY3JlYXRlRmlsZXN5c3RlbUNtZHMiLCJzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCIsImZpbGVzeXN0ZW1jbWRzIiwibmV3U3RvcmFnZVBvbGljeSIsImZpbGVzeXN0ZW1zIiwiYmFja2VuZHMiLCJjcnVkIiwibW91bnQiLCJzbmFwc2hvdCIsInVubG9ja2VkIiwiZHJpdmVyIiwicG9vbCIsImZpbGVzeXN0ZW0iLCJydW50aW1lIiwic25hcHNob3RzIiwiZnJlcXVlbmN5Iiwia2VlcCIsInJhdGUtbGltaXQiLCJ3cml0ZS1pb3BzIiwicmVhZC1pb3BzIiwid3JpdGUtYnBzIiwicmVhZC1icHMiLCJWb2x1bWVzTW9kZWwiLCJzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwiLCJnZXRWb2x1bWVzIiwidm9sdW1lcyIsImluaXRpYWxpemVGaWxlc3lzdGVtQ21kc0FycmF5Iiwic3RvcmFnZVBvbGljeUxpc3RDdHJsIiwiVmlzdWFsaXphdGlvblNlcnZpY2UiLCJ0IiwiZ2V0U2Vjb25kcyIsImVkZ2VEYXRhSW50ZXJ2YWwiLCJnZXRFZGdlRGF0YSIsInJlc3VsdHMiLCJzZXJpZXMiLCJ2YWx1ZXMiLCJlZGdlRGF0YSIsImVkZ2VEYXRhVGltZSIsImdldE9sZEVkZ2VEYXRhIiwib2xkRWRnZURhdGEiLCIkd2luZG93IiwidmlzdWFsaXphdGlvbkVkZ2VEMyIsInBhdGgiLCJsaW5lIiwibGltaXQiLCJheGlzIiwiZWFzZSIsInlBeGlzIiwic2hpZnQiLCJjbGllbnRXaWR0aCIsImN1cnJlbnQiLCJjb2xvciIsInRpbWUiLCJpbnRlcnBvbGF0ZSIsInhTdmciLCJvcmllbnQiLCJyZXBsYWNlIiwiJHdhdGNoR3JvdXAiLCJzZXJ2aWNlIiwiU3RhdGVTYXZlIiwidmlzdWFsaXphdGlvbmxpc3RkMyIsInNlcnZpY2VTZWxlY3RvcnMiLCJzZXRBbmNlc3RvcnMiLCJ0b3BEYXRhIiwiZ2V0VG9wTGV2ZWxGbG93IiwicmF3U3ZnIiwidmlzdWFsaXphdGlvbkdyYXBoIiwiaW5zdGFsbERlZmF1bHRQYXRoUG9saWN5IiwicVRpcFBvbGljeSIsImluc3RhbGxEZWZhdWx0Tm9kZVBvbGljeSIsInNwbGl0Sm9pblZpZXdQb2xpY3kiLCJpbnN0YWxsQmFja0J1dHRvbiIsImluc3RhbGxUaXRsZSIsInVuYmluZCIsInVwZGF0ZUxpbmtEYXRhIiwic3VjY2Vzc0dyYXBoRGF0YUNhbGxiYWNrIiwiZW5kcG9pbnQiLCJ0YWdzIiwiRW5kcG9pbnRJUCIsInByb3ZpZGVyIiwiUHJvdmlkZXJJUCIsImxpbmtPdXQiLCJsaW5rSW4iLCJnZXRHcmFwaERhdGEiLCJncmFwaERhdGFJbnRlcnZhbCIsImdldFN0cnVjdHVyZURhdGEiLCJtYWtlR2V0IiwibWFrZVBvc3QiLCJwYXJhbSIsIm9iaiIsImZ1bGxTdWJOYW1lIiwic3ViTmFtZSIsInN1YlZhbHVlIiwiaW5uZXJPYmoiLCJxdWVyeSIsImVuY29kZVVSSUNvbXBvbmVudCIsInN1YnN0ciIsIm1ldGhvZCIsImhlYWRlcnMiLCJDb250ZW50LVR5cGUiLCJ0cmFuc2Zvcm1SZXF1ZXN0IiwiaXNPYmplY3QiLCJkYiIsImJ1aWxkV2hlcmVRdWVyeSIsInBvaW50cyIsInJldHVyblRvVm9sdW1lc01vZGVsIiwiZ2V0U3RvcmFnZVBvbGljaWVzIiwidm9sdW1lQ3JlYXRlQ3RybCIsImFwcGx5UG9saWN5U2V0dGluZ3MiLCJuZXdWb2x1bWUiLCJjcmVhdGVWb2x1bWUiLCJWb2x1bWVTZXJ2aWNlIiwicmV0dXJuVG9Wb2x1bWVzIiwiZGVsZXRlVm9sdW1lIiwidm9sdW1lRGV0YWlsc0N0cmwiLCJ2b2x1bWUiLCJnZXRWb2x1bWVJbmZvIiwidG9rZW5zIiwibW9kZWwiLCJnZXRNb2RlbCIsImdldFZvbHVtZVVzZUluZm8iLCJnZXRWb2x1bWVTbmFwc2hvdHMiLCJ2b2x1bWVVc2UiLCJ0cmlnZ2VyVm9sdW1lU25hcHNob3QiLCJzbmFwc2hvdFN1Y2Nlc3MiLCJ0cmlnZ2VyU25hcHNob3QiLCJ2b2x1bWVMaXN0Q3RybCIsImNhbmNlbENvcHkiLCJnb1RvTmV3Vm9sdW1lIiwidm9sdW1lU25hcHNob3RDb3B5Q3RybCIsIm5ld3ZvbHVtZSIsImNvcHlTbmFwc2hvdCIsImNvcHkiLCJ0cmFuc2NsdWRlIiwiZWxlbWVudCIsImFjY29yZGlvbiIsImNvbGxhcHNlZCIsIm5hbWVoZWFkZXIiLCJ2YWx1ZWhlYWRlciIsIm9wdGlvbnMiLCJmaWx0ZXJGaWx0ZXIiLCJsaW1pdFRvRmlsdGVyIiwiZmlsdGVyZWRpdGVtcyIsImRlZmF1bHRzb3J0Y29sdW1uIiwiJGVsZW1lbnQiLCIkYXR0cnMiLCJzaG93Q2h1bmsiLCJwYWdlTm8iLCJzZWFyY2hUZXh0IiwidGFibGVDdHJsIiwic2VhcmNoVGV4dEZpbHRlcmVkSXRlbXMiLCJzb3J0T2JqIiwiZmllbGQiLCJyZXZlcnNlIiwibm9PZkNodW5rcyIsImNlaWwiLCJjaHVua3MiLCJzZWxlY3RlZCIsInNsaWNlU3RhcnQiLCJzbGljZUVuZCIsInBhZ2luYXRpb25NZW51IiwiZmlsdGVyZWRJdGVtcyIsInNob3dQcmV2Q2h1bmsiLCJwcmV2Q2h1bmsiLCJzaG93TmV4dENodW5rIiwibmV4dENodW5rIiwiYWRkUGFnaW5hdGlvbk1lbnUiLCJtZW51IiwiaW5pdGlhbGl6ZVNvcnQiLCJzb3J0ZmllbGQiLCJpY29uRGlyZWN0aW9uIiwiYW5nbGUgZG93biBpY29uIiwiYW5nbGUgdXAgaWNvbiIsInNvcnQiLCIkYXBwbHkiLCJwYXJzZUludCIsImlzTmFOIiwiYXR0cnMiLCIkcGFyZW50IiwiJHdhdGNoIiwicmVxdWlyZSIsImNsYXNzIiwidGFibGVjdHJsIiwiYmluZCIs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QXpaLEVBQUF1YSxjQUFBYixFQUFBYSxjQUNBdmEsRUFBQXlhLGNBQUFmLEVBQUFlLGVBRUEvZCxZQUFBLCtDQ3hRQXhkLFFBQUFDLE9BQUEscUJBQ0EyZ0IsVUFBQSxjQUFBLFdBQ0EsT0FDQUMsU0FBQSxJQUNBckQsWUFBQSw0Q0FDQXNELE9BQ0FyQyxLQUFBLFFDTkF6ZSxRQUFBQyxPQUFBLHFCQUNBMmdCLFVBQUEsc0JBQUEsV0FDQSxPQUNBQyxTQUFBLElBQ0FyRCxZQUFBLG9EQUNBc0QsT0FDQStiLFVBQUEsUUNOQTc4QixRQUFBQyxPQUFBLHFCQUNBMmdCLFVBQUEsaUJBQUEsV0FDQSxPQUNBQyxTQUFBLElBQ0FyRCxZQUFBLCtDQUNBc0QsT0FDQStiLFVBQUEsUUNOQTc4QixRQUFBQyxPQUFBLHFCQUNBMmdCLFVBQUEsZUFBQSxXQUNBLE9BQ0FDLFNBQUEsSUFDQXJELFlBQUEsNkNBQ0FzRCxPQUNBK2IsVUFBQSIsImZpbGUiOiJhcHAvYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIERlZmluaW5nIHRoZSBHcmFwaCBNb2R1bGUuXG4gKiBTZWUgREVTSUdOLm1kIGZvciBpbmZvIG9uIEdyYXBoIE9iamVjdHMuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnLCBbXSk7XG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5kaXJlY3RpdmVzXCIsIFtdKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXBcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLyoqXG4gKiBUaGUgYmFzZSBjbGFzcyB0aGUgRGF0YVNvdXJjZSBvYmplY3QuXG4gKiBcbiAqIFRoZSBEYXRhU291cmNlIG9iamVjdCB0YWtlcyBpbiBub2RlIGFuZCBsaW5rIGRhdGEgZnJvbSB0aGUgc2VydmVyLCBcbiAqIGFuZCBwcm92aWRlcyBtZXRob2RzIGZvciBjb252ZXJ0aW5nIGFuZCBtYW5pcHVsYXRpbmcgdGhlIGRhdGEgZm9yXG4gKiB0aGUgZ3JhcGggb2JqZWN0LlxuICogXG4gKiBUbyB3cml0ZSB5b3VyIG93biBEYXRhU291cmNlIG9iamVjdCwgY3JlYXRlIGEgbmV3IGZhY3RvcnkgdGhhdCB1c2VzIHRoZSBcbiAqIERhdGFTb3VyY2UgeW91IHdhbnQgdG8gaW5oZXJpdCBhcyBhIGRlcGVuZGVuY3ksIGFuZCBleHRlbmQgXG4gKiBpdHMgRGF0YVNvdXJjZSBjbGFzcy4gXG4gKiBSZXR1cm4gdGhlIGNsYXNzIG9iamVjdCB3aXRoIERhdGFTb3VyY2UgYXMga2V5LlxuICogXG4gKiBOb2RlIGRhdGEgaXMgZXhwZWN0ZWQgdG8gYmUgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6XG4gKiB7aWQ6bm9kZV9pZCwgdGV4dDpub2RlX3RleHR9XG4gKiBcbiAqIExpbmsgZGF0YSBpcyBleHBlY3RlZCB0byBiZSBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDpcbiAqIHtzb3VyY2U6IHNvdXJjZU5vZGVJZCwgdGFyZ2V0OiB0YXJnZXROb2RlSWR9XG4gKiBcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ0RhdGFTb3VyY2UnLCBbJ05vZGUnLCAnTGluaycsIGZ1bmN0aW9uIChOb2RlLCBMaW5rKSB7XG5cdHZhciBEYXRhU291cmNlID0gZnVuY3Rpb24gKCkge1xuXHRcdC8qKlxuICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAqXG4gICAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBub2RlcyAgICAgICAgICAgICAgVGhlIG5vZGUgZGF0YSBcbiAgICogQHBhcmFtICAgICAge0FycmF5fSAgIGxpbmtzICAgICAgICAgICAgICBUaGUgbGluayBkYXRhXG4gICAqL1xuXHRcdGZ1bmN0aW9uIERhdGFTb3VyY2Uobm9kZXMsIGxpbmtzKSB7XG5cdFx0XHRfY2xhc3NDYWxsQ2hlY2sodGhpcywgRGF0YVNvdXJjZSk7XG5cblx0XHRcdHRoaXMubm9kZXMgPSBub2Rlcztcblx0XHRcdHRoaXMubGlua3MgPSBsaW5rcztcblx0XHR9XG5cblx0XHQvKipcbiAgICogUmVwbGFjZXMgdGhlIG5vZGUgZGF0YVxuICAgKlxuICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGVzICAgVGhlIG5vZGVzXG4gICAqL1xuXG5cblx0XHRfY3JlYXRlQ2xhc3MoRGF0YVNvdXJjZSwgW3tcblx0XHRcdGtleTogJ3VwZGF0ZU5vZGVzJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVOb2Rlcyhub2Rlcykge1xuXHRcdFx0XHR0aGlzLm5vZGVzID0gbm9kZXM7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogUmVwbGFjZXMgdGhlIGxpbmsgZGF0YVxuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtMaW5rfSAgbGlua3MgICBUaGUgbGlua3NcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAndXBkYXRlTGlua3MnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUxpbmtzKGxpbmtzKSB7XG5cdFx0XHRcdHRoaXMubGlua3MgPSBsaW5rcztcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBSZXR1cm5zIHRoZSBOYW1lIGF0dHJpYnV0ZSBvZiB0aGUgTm9kZSB3aXRoIHRoZSBcbiAgICAqIG1hdGNoaW5nIGlkXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGlkICAgICAgVGhlIGlkZW50aWZpZXJcbiAgICAqIEByZXR1cm4gICAgIHtzdHJpbmd9ICBuYW1lIG9mIHRoZSBtYXRjaGluZyBub2RlXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ25vZGVJZFRvTmFtZScsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gbm9kZUlkVG9OYW1lKGlkKSB7XG5cdFx0XHRcdHZhciBub2RlcyA9IHRoaXMubm9kZXM7XG5cdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRpZiAobm9kZXNbaV0uaWQgPT0gaWQpIHtcblx0XHRcdFx0XHRcdHJldHVybiBub2Rlc1tpXS5uYW1lO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIHByb2Nlc3MgdGhlIG5vZGVEYXRhIHRvIGNyZWF0ZSBOb2RlIG9iamVjdHNcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlRGF0YSAgTm9kZURhdGEgdG8gY29udmVydCBcbiAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0byBub2RlIG9iamVjdHNcbiAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIE5vZGUgb2JqZWN0c1xuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdwcm9jZXNzTm9kZURhdGEnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHByb2Nlc3NOb2RlRGF0YShub2RlRGF0YSkge1xuXHRcdFx0XHR2YXIgbm9kZXMgPSBbXTtcblx0XHRcdFx0Xy5mb3JFYWNoKG5vZGVEYXRhLCBmdW5jdGlvbiAoZGF0YSkge1xuXHRcdFx0XHRcdHZhciBuZXdOb2RlID0gbmV3IE5vZGUuTm9kZShudWxsLCBudWxsLCBkYXRhLmlkLCBkYXRhLnRleHQsIG51bGwpO1xuXHRcdFx0XHRcdG5vZGVzLnB1c2gobmV3Tm9kZSk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRyZXR1cm4gbm9kZXM7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogcHJvY2VzcyB0aGUgbGlua0RhdGFcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBsaW5rRGF0YSAgVGhlIGxpbmsgZGF0YVxuICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZXMgICAgIFRoZSBub2RlcyBmcm9tIHByb2Nlc3NOb2RlRGF0YVxuICAgICogQHJldHVybiAgICAge0FycmF5fSAgTGluayBvYmplY3RzXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3Byb2Nlc3NMaW5rRGF0YScsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gcHJvY2Vzc0xpbmtEYXRhKGxpbmtEYXRhLCBub2Rlcykge1xuXHRcdFx0XHQvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBub2RlIHRoYXQgbWF0Y2hlcyB0aGUgaWRcbiAgICAgKlxuICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9IGlkICAgICAgVGhlIGlkZW50aWZpZXJcbiAgICAgKiBAcmV0dXJuICAgICB7Tm9kZX0gICBUaGUgbm9kZSB3aXRoIHRoZSBtYXRjaGluZyBpZFxuICAgICAqL1xuXHRcdFx0XHRmdW5jdGlvbiBmaW5kTm9kZUJ5SWQoaWQsIG5vZGVzKSB7XG5cdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0aWYgKGlkID09IG5vZGVzW2ldLmlkKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBub2Rlc1tpXTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR2YXIgbGlua3MgPSBbXTtcblx0XHRcdFx0Ly90cmFuc2Zvcm1pbmcgbGluayBkYXRhXG5cdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbGlua0RhdGEubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRpZiAobGlua0RhdGFbaV0uc291cmNlICE9IGxpbmtEYXRhW2ldLnRhcmdldCkge1xuXHRcdFx0XHRcdFx0dmFyIHNvdXJjZSA9IGZpbmROb2RlQnlJZChsaW5rRGF0YVtpXS5zb3VyY2UsIG5vZGVzKTtcblx0XHRcdFx0XHRcdHZhciB0YXJnZXQgPSBmaW5kTm9kZUJ5SWQobGlua0RhdGFbaV0udGFyZ2V0LCBub2Rlcyk7XG5cdFx0XHRcdFx0XHRpZiAoc291cmNlID09IG51bGwgfHwgdGFyZ2V0ID09IG51bGwpIHtcblx0XHRcdFx0XHRcdFx0Y29udGludWU7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR2YXIgbGluayA9IG5ldyBMaW5rLkxpbmsoc291cmNlLCB0YXJnZXQpO1xuXHRcdFx0XHRcdFx0bGlua3MucHVzaChsaW5rKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIGxpbmtzO1xuXHRcdFx0fVxuXHRcdH1dKTtcblxuXHRcdHJldHVybiBEYXRhU291cmNlO1xuXHR9KCk7XG5cblx0cmV0dXJuIHtcblx0XHREYXRhU291cmNlOiBEYXRhU291cmNlXG5cdH07XG59XSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMTQvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubW9kZWxzJywgW10pO1xudmFyIENvbnRpdkdsb2JhbHMgPSAoZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIC8vUkVTVCBlbmRwb2ludHMgZm9yIE5FVE1BU1RFUlxuICAgICAgICAnTkVUV09SS1NfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvbmV0d29ya3MvJyxcbiAgICAgICAgJ05FVFdPUktTX0lOU1BFQ1RfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvaW5zcGVjdC9uZXR3b3Jrcy8nLFxuICAgICAgICAnU0VSVklDRUxCU19JTlNQRUNUX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL2luc3BlY3Qvc2VydmljZUxCcy8nLFxuICAgICAgICAnUE9MSUNJRVNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvcG9saWN5cy8nLFxuICAgICAgICAnUlVMRVNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvcnVsZXMvJyxcbiAgICAgICAgJ0FQUExJQ0FUSU9OR1JPVVBTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL2VuZHBvaW50R3JvdXBzLycsXG4gICAgICAgICdTRVJWSUNFTEJTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL3NlcnZpY2VMQnMvJyxcbiAgICAgICAgJ09SR0FOSVpBVElPTlNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvdGVuYW50cy8nLFxuICAgICAgICAnTkVUV09SS19TRVRUSU5HU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9nbG9iYWxzLycsXG4gICAgICAgICdORVRQUk9GSUxFU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9uZXRwcm9maWxlcy8nLFxuICAgICAgICAnQkdQU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9CZ3BzLycsXG4gICAgICAgICdCR1BTX0lOU1BFQ1RfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvaW5zcGVjdC9CZ3BzLycsXG4gICAgICAgICdWSVNVQUxJWkFUSU9OX0VORFBPSU5UJzogJy92aXN1YWxpemF0aW9uLycsXG4gICAgICAgIC8vUkVTVCBlbmRwb2ludHMgZm9yIFZPTE1BU1RFUlxuICAgICAgICAnVk9MVU1FU19FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3ZvbHVtZXMvJyxcbiAgICAgICAgJ1ZPTFVNRVNfQ1JFQVRFX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvdm9sdW1lcy9jcmVhdGUvJyxcbiAgICAgICAgJ1ZPTFVNRVNfREVMRVRFX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvdm9sdW1lcy9yZW1vdmUvJyxcbiAgICAgICAgJ1ZPTFVNRVNfQ09QWVNOQVBTSE9UU19FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3ZvbHVtZXMvY29weScsXG4gICAgICAgICdWT0xVTUVTX1VTRVNfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci91c2VzL21vdW50cy8nLFxuICAgICAgICAnVk9MVU1FU19TTkFQU0hPVFNfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci9zbmFwc2hvdHMvJyxcbiAgICAgICAgJ1NUT1JBR0VQT0xJQ0lFU19FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3BvbGljaWVzLycsXG4gICAgICAgICdWT0xVTUVTX0dMT0JBTF9FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL2dsb2JhbC8nLFxuICAgICAgICAvL1JFU1QgZW5kcG9pbnRzIGZvciBDTFVTVEVSXG4gICAgICAgICdOT0RFU19MSVNUX0VORFBPSU5UJzogJy9pbmZvL25vZGVzJyxcbiAgICAgICAgJ05PREVTX0RJU0NPVkVSX0VORFBPSU5UJzogJy9kaXNjb3Zlci9ub2RlcycsXG4gICAgICAgICdOT0RFU19DT01NSVNTSU9OX0VORFBPSU5UJzogJy9jb21taXNzaW9uL25vZGVzJyxcbiAgICAgICAgJ05PREVTX0RFQ09NTUlTU0lPTl9FTkRQT0lOVCc6ICcvZGVjb21taXNzaW9uL25vZGVzJyxcbiAgICAgICAgJ05PREVTX01BSU5URU5BTkNFX0VORFBPSU5UJzogJy9tYWludGVuYW5jZS9ub2RlcycsXG4gICAgICAgICdOT0RFU19MQVNUX0pPQl9FTkRQT0lOVCc6ICcvaW5mby9qb2IvbGFzdCcsXG4gICAgICAgICdOT0RFU19BQ1RJVkVfSk9CX0VORFBPSU5UJzogJy9pbmZvL2pvYi9hY3RpdmUnLFxuICAgICAgICAnTk9ERVNfU0VUVElOR1NfU0VUX0VORFBPSU5UJzogJy9nbG9iYWxzJyxcbiAgICAgICAgJ05PREVTX1NFVFRJTkdTX0dFVF9FTkRQT0lOVCc6ICcvaW5mby9nbG9iYWxzJyxcbiAgICAgICAgLy9SZWZyZXNoIGludGVydmFsIGluIG1pbGxpc2Vjb25kc1xuICAgICAgICAnUkVGUkVTSF9JTlRFUlZBTCc6IDUwMDAsXG4gICAgICAgIC8vUmVnRXggZm9yIHZhbGlkYXRpb25cbiAgICAgICAgJ0NJRFJfUkVHRVgnOiAnXigoWzAtOV18WzEtOV1bMC05XXwxWzAtOV17Mn18MlswLTRdWzAtOV18MjVbMC01XSlcXC4pezN9KFswLTldfFsxLTldWzAtOV18MVswLTldezJ9fDJbMC00XVswLTldfDI1WzAtNV0pKFxcLyhbMC05XXxbMS0yXVswLTldfDNbMC0yXSkpJCcsXG4gICAgICAgICdWTEFOX1JFR0VYJzogJ14oWzAtOV17MSw0fT8tWzAtOV17MSw0fT8pJCcsXG4gICAgICAgICdWWExBTl9SRUdFWCc6ICdeKFswLTldezEsOH0/LVswLTldezEsOH0/KSQnLFxuICAgICAgICAnTlVNQkVSX1JFR0VYJzogJ15bMC05XSokJ1xuICAgIH07XG59KSgpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnV0aWxzJywgW10pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcFxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbi8qKlxuICogVGhlIERhdGFTb3VyY2UgdXNlZCBmb3IgdGhlIHZpc3VhbGl6YXRpb24gdGFiLlxuICogXG4gKiBOb2RlIERhdGEgZnJvbSB0aGUgc2VydmVyIGlzIGV4cGVjdGVkIHRvIGJlIGluIHRoZSBmb2xsb3dpbmcgZm9ybWF0OlxuICoge2lkOiBub2RlX2lkLCB0ZXh0OiBub2RlX3RleHR9XG4gKiBQYXJlbnQgYW5kIEFuY2VzdG9yIGF0dHJpYnV0ZXMgY2FuIGJlIHNldCBieSBjYWxsaW5nIHNldEFuY2VzdG9yc1xuICogXG4gKiBMaW5rIERhdGEgZnJvbSB0aGUgc2VydmVyIGlzIGV4cGVjdGVkIHRvIGJlIGluIHRoZSBmb2xsb3dpbmcgZm9ybWF0OlxuICoge3NvdXJjZTogc291cmNlTm9kZUlkLCB0YXJnZXQ6IHRhcmdldE5vZGVJZCwgd2VpZ2h0OiBsaW5rV2VpZ2h0fVxuICogXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdWaXN1YWxpemVyRGF0YVNvdXJjZScsIFsnRGF0YVNvdXJjZScsICdWaXN1YWxpemVyTm9kZScsICdWaXN1YWxpemVyTGluaycsIGZ1bmN0aW9uIChEYXRhU291cmNlLCBWaXN1YWxpemVyTm9kZSwgVmlzdWFsaXplckxpbmspIHtcblx0dmFyIFZpc3VhbGl6ZXJEYXRhU291cmNlID0gZnVuY3Rpb24gKF9EYXRhU291cmNlJERhdGFTb3VyYykge1xuXHRcdF9pbmhlcml0cyhWaXN1YWxpemVyRGF0YVNvdXJjZSwgX0RhdGFTb3VyY2UkRGF0YVNvdXJjKTtcblxuXHRcdC8qKlxuICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAqIFxuICAgKiBDaGlsZHJlbiBTdHJ1Y3QgYW5kIGFuY2VzdG9yc19zdHJ1Y3QgYXJlIEpTT04gb2JqZWN0cyxcbiAgICogbWFwcGluZyBhIG5vZGUgSWQgdG8gYSBsaXN0IG9mIGl0J3MgY2hpbGRyZW4gb3IgYW5jZXN0b3JzLlxuICAgKiBDaGlsZHJlbiBTdHJ1Y3QgaXMgYWxzbyBleHBlY3RlZCB0byBoYXZlIGEgZmllbGQgY2FsbGVkXG4gICAqIHRvcExldmVsLCB0aGF0IG1hcHMgdG8gYSBsaXN0IG9mIGFsbCB0aGUgbm9kZXMgdGhhdCBkb24ndFxuICAgKiBoYXZlIGFueSBwYXJlbnRzLlxuICAgKlxuICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgbm9kZXMgICAgICAgICAgICAgIFRoZSBub2RlIGRhdGEgXG4gICAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBsaW5rcyAgICAgICAgICAgICAgVGhlIGxpbmsgZGF0YVxuICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgY2hpbGRyZW5fc3RydWN0ICAgIFRoZSBjaGlsZHJlbiBzdHJ1Y3R1cmVcbiAgICogQHBhcmFtICAgICAge09iamVjdH0gIGFuY2VzdG9yc19zdHJ1Y3QgICBUaGUgYW5jZXN0b3JzIHN0cnVjdHVyZVxuICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgbGFiZWxzICAgICAgICAgICAgIFRoZSBsYWJlbHNcbiAgICogQHBhcmFtICAgICAge0FycmF5fSAgIHNlbGVjdG9ycyAgICAgICAgICBUaGUgc2VsZWN0b3JzXG4gICAqL1xuXHRcdGZ1bmN0aW9uIFZpc3VhbGl6ZXJEYXRhU291cmNlKG5vZGVzLCBsaW5rcywgY2hpbGRyZW5fc3RydWN0LCBhbmNlc3RvcnNfc3RydWN0LCBsYWJlbHMsIHNlbGVjdG9ycykge1xuXHRcdFx0X2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZpc3VhbGl6ZXJEYXRhU291cmNlKTtcblxuXHRcdFx0dmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKFZpc3VhbGl6ZXJEYXRhU291cmNlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoVmlzdWFsaXplckRhdGFTb3VyY2UpKS5jYWxsKHRoaXMsIG5vZGVzLCBsaW5rcykpO1xuXG5cdFx0XHRfdGhpcy5jaGlsZHJlbl9zdHJ1Y3QgPSBjaGlsZHJlbl9zdHJ1Y3Q7XG5cdFx0XHRfdGhpcy5hbmNlc3RvcnNfc3RydWN0ID0gYW5jZXN0b3JzX3N0cnVjdDtcblx0XHRcdF90aGlzLmxhYmVscyA9IGxhYmVscztcblx0XHRcdF90aGlzLnNlbGVjdG9ycyA9IHNlbGVjdG9ycztcblx0XHRcdHJldHVybiBfdGhpcztcblx0XHR9XG5cblx0XHQvKipcbiAgICogRGV0ZXJtaW5lcyBpZiBpdCBoYXMgY2hpbGQuXG4gICAqXG4gICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICAgaWQgICAgICBUaGUgaWRlbnRpZmllclxuICAgKiBAcmV0dXJuICAgICB7Ym9vbGVhbn0gIFRydWUgaWYgaGFzIGNoaWxkLCBGYWxzZSBvdGhlcndpc2UuXG4gICAqL1xuXG5cblx0XHRfY3JlYXRlQ2xhc3MoVmlzdWFsaXplckRhdGFTb3VyY2UsIFt7XG5cdFx0XHRrZXk6ICdoYXNDaGlsZCcsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gaGFzQ2hpbGQoaWQpIHtcblx0XHRcdFx0aWYgKHRoaXMuY2hpbGRyZW5fc3RydWN0W2lkXSA9PSBudWxsKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIFNldHMgdGhlIHBhcmVudCBhbmQgYW5jZXN0b3JzIGF0dHJpYnV0ZSB1c2luZyBcbiAgICAqIGFuY2VzdG9yc19zdHJ1Y3QgZm9yIGFsbCB0aGUgbm9kZXNcbiAgICAqIEFsc28gYWRkcyBhbnkgbm9kZXMgd2l0aG91dCBhbmNlc3RvcnMsIHRoYXQgYXJlbid0IFxuICAgICogdG9wbGV2ZWwgdG8gdGhlIGNsaWVudCBzZXJ2aWNlLlxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdzZXRBbmNlc3RvcnMnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHNldEFuY2VzdG9ycygpIHtcblx0XHRcdFx0dmFyIHRoaXNEYXRhU291cmNlID0gdGhpcztcblx0XHRcdFx0dmFyIGFkZGVkQ2xpZW50ID0gZmFsc2U7XG5cdFx0XHRcdF8uZm9yRWFjaCh0aGlzRGF0YVNvdXJjZS5ub2RlcywgZnVuY3Rpb24gKG5vZGUpIHtcblx0XHRcdFx0XHRub2RlLmFuY2VzdG9ycyA9IHRoaXNEYXRhU291cmNlLmFuY2VzdG9yc19zdHJ1Y3Rbbm9kZS5pZF0gfHwgW107XG5cdFx0XHRcdFx0aWYgKF8uaXNFbXB0eShub2RlLmFuY2VzdG9ycykgPT09IGZhbHNlKSB7XG5cdFx0XHRcdFx0XHRub2RlLnBhcmVudCA9IG5vZGUuYW5jZXN0b3JzWzBdO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRpZiAoXy5pbmNsdWRlcyh0aGlzRGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwsIG5vZGUuaWQpID09IGZhbHNlKSB7XG5cdFx0XHRcdFx0XHRcdC8vY29udGFpbmVyIGhhcyBubyBwYXJlbnRcblx0XHRcdFx0XHRcdFx0Ly9hZGRpbmcgdG8gY2xpZW50XG5cdFx0XHRcdFx0XHRcdG5vZGUuYW5jZXN0b3JzLnB1c2goXCJjbGllbnRcIik7XG5cdFx0XHRcdFx0XHRcdHRoaXNEYXRhU291cmNlLmFuY2VzdG9yc19zdHJ1Y3Rbbm9kZS5pZF0gPSBbXCJjbGllbnRcIl07XG5cdFx0XHRcdFx0XHRcdGlmIChhZGRlZENsaWVudCA9PT0gZmFsc2UpIHtcblx0XHRcdFx0XHRcdFx0XHRhZGRlZENsaWVudCA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdFx0dGhpc0RhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0LnRvcExldmVsLnB1c2goXCJjbGllbnRcIik7XG5cdFx0XHRcdFx0XHRcdFx0dGhpc0RhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0WydjbGllbnQnXSA9IFtdO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdHRoaXNEYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFsnY2xpZW50J10ucHVzaChub2RlLmlkKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIFJldHVybnMgdGhlIGZsb3cgYmV0d2VlbiB0aGUgaGlnaGVzdCBsZXZlbCBncm91cGluZ1xuICAgICpcbiAgICAqIEByZXR1cm4gICAgIHtPYmplY3R9ICBUaGUgdG9wIGxldmVsIGZsb3cuXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ2dldFRvcExldmVsRmxvdycsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gZ2V0VG9wTGV2ZWxGbG93KCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5nZXRGbG93QmV0d2VlblNldCh0aGlzLmNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbCk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogR2V0cyB0aGUgZmxvdyBiZXR3ZWVuIGFueSBzZXQgb2Ygbm9kZSBsZXZlbHNcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlX25hbWVzICBUaGUgbm9kZSBuYW1lcyBpbiB0aGUgc2V0XG4gICAgKiBAcmV0dXJuICAgICB7T2JqZWN0fSAgVGhlIGZsb3cgYmV0d2VlbiBzZXQuXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ2dldEZsb3dCZXR3ZWVuU2V0Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBnZXRGbG93QmV0d2VlblNldChub2RlX25hbWVzKSB7XG5cdFx0XHRcdHZhciBsb2NhbF9ub2RlcyA9IHRoaXMubm9kZXM7XG5cdFx0XHRcdHZhciBpZE1hcHBpbmcgPSB7fTtcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBsb2NhbF9ub2Rlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdHZhciBub2RlID0gbG9jYWxfbm9kZXNbaV07XG5cblx0XHRcdFx0XHQvL2lmIG5vZGUgaXMgYWxyZWFkeSBhdCBpdHMgaGlnaGVzdCBsZXZlbFxuXHRcdFx0XHRcdGlmIChub2RlLmFuY2VzdG9ycyA9PT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0aWRNYXBwaW5nW25vZGUuaWRdID0gbm9kZS5uYW1lO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHQvL2NoZWNrIHRvIHNlZSB3aGljaCB0YWdzIGFyZSBwcmVzZW50IGluIHRoZSBhbmNlc3RvciBsaXN0XG5cdFx0XHRcdFx0XHRmb3IgKHZhciBqID0gMDsgaiA8IG5vZGVfbmFtZXMubGVuZ3RoOyBqKyspIHtcblx0XHRcdFx0XHRcdFx0aWYgKG5vZGUuYW5jZXN0b3JzLmluZGV4T2Yobm9kZV9uYW1lc1tqXSkgPiAtMSkge1xuXHRcdFx0XHRcdFx0XHRcdGlkTWFwcGluZ1tub2RlLmlkXSA9IG5vZGVfbmFtZXNbal07XG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0Ly9tb2RpZnkgbGlua3Ncblx0XHRcdFx0dmFyIGxpbmtzID0gdGhpcy5saW5rcztcblx0XHRcdFx0dmFyIGxpbmtEYXRhID0gW107XG5cblx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBsaW5rcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdHZhciBsaW5rID0gW107XG5cdFx0XHRcdFx0bGluay5zb3VyY2UgPSBpZE1hcHBpbmdbbGlua3NbaV0uc291cmNlXSB8fCBsaW5rc1tpXS5zb3VyY2U7XG5cdFx0XHRcdFx0bGluay50YXJnZXQgPSBpZE1hcHBpbmdbbGlua3NbaV0udGFyZ2V0XSB8fCBsaW5rc1tpXS50YXJnZXQ7XG5cdFx0XHRcdFx0bGluay53ZWlnaHQgPSBsaW5rc1tpXS53ZWlnaHQ7XG5cdFx0XHRcdFx0bGlua0RhdGEucHVzaChsaW5rKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vY3JlYXRpbmcgdGhlIG5vZGVEYXRhXG5cdFx0XHRcdHZhciBub2RlRGF0YSA9IFtdO1xuXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVfbmFtZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHR2YXIgbm9kZV90b19hZGQgPSBbXTtcblx0XHRcdFx0XHRub2RlX3RvX2FkZC5pZCA9IG5vZGVfbmFtZXNbaV07XG5cdFx0XHRcdFx0bm9kZV90b19hZGQudGV4dCA9IHRoaXMubm9kZUlkVG9OYW1lKG5vZGVfbmFtZXNbaV0pIHx8IG5vZGVfbmFtZXNbaV07XG5cblx0XHRcdFx0XHRub2RlX3RvX2FkZC5hbmNlc3RvcnMgPSB0aGlzLmFuY2VzdG9yc19zdHJ1Y3Rbbm9kZV9uYW1lc1tpXV0gfHwgdGhpcy5hbmNlc3RvcnNfc3RydWN0W25vZGVfdG9fYWRkLnRleHRdIHx8IFtdO1xuXHRcdFx0XHRcdGlmIChfLmlzRW1wdHkobm9kZV90b19hZGQuYW5jZXN0b3JzKSA9PT0gZmFsc2UpIHtcblx0XHRcdFx0XHRcdG5vZGVfdG9fYWRkLnBhcmVudCA9IG5vZGVfdG9fYWRkLmFuY2VzdG9yc1swXTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0bm9kZV90b19hZGQucGFyZW50ID0gbnVsbDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0bm9kZURhdGEucHVzaChub2RlX3RvX2FkZCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4geyBub2RlRGF0YTogbm9kZURhdGEsIGxpbmtEYXRhOiBsaW5rRGF0YSB9O1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIHByb2Nlc3MgdGhlIG5vZGVEYXRhIG91dHB1dCBvZiBnZXRGbG93QmV0d2VlblNldFxuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVEYXRhICBOb2RlRGF0YSB0byBjb252ZXJ0IFxuICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIG5vZGUgb2JqZWN0c1xuICAgICogQHJldHVybiAgICAge0FycmF5fSAgTm9kZSBvYmplY3RzXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3Byb2Nlc3NOb2RlRGF0YScsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gcHJvY2Vzc05vZGVEYXRhKG5vZGVEYXRhKSB7XG5cdFx0XHRcdHZhciBub2RlcyA9IFtdO1xuXHRcdFx0XHRfLmZvckVhY2gobm9kZURhdGEsIGZ1bmN0aW9uIChkYXRhKSB7XG5cdFx0XHRcdFx0dmFyIG5ld05vZGUgPSBuZXcgVmlzdWFsaXplck5vZGUuTm9kZShudWxsLCBudWxsLCBkYXRhLmlkLCBkYXRhLnRleHQsIG51bGwsIGRhdGEucGFyZW50LCBkYXRhLmFuY2VzdG9ycywgbnVsbCwgbnVsbCk7XG5cdFx0XHRcdFx0bm9kZXMucHVzaChuZXdOb2RlKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdHJldHVybiBub2Rlcztcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBwcm9jZXNzIHRoZSBsaW5rRGF0YSBvdXRwdXQgb2YgZ2V0Rmxvd0JldHdlZW5TZXRcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBsaW5rRGF0YSAgVGhlIGxpbmsgZGF0YVxuICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZXMgICAgIFRoZSBub2Rlc1xuICAgICogQHJldHVybiAgICAge0FycmF5fSAgTGluayBvYmplY3RzXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3Byb2Nlc3NMaW5rRGF0YScsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gcHJvY2Vzc0xpbmtEYXRhKGxpbmtEYXRhLCBub2Rlcykge1xuXHRcdFx0XHQvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBub2RlIHRoYXQgbWF0Y2hlcyB0aGUgaWRcbiAgICAgKlxuICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9IGlkICAgICAgVGhlIGlkZW50aWZpZXJcbiAgICAgKiBAcmV0dXJuICAgICB7Tm9kZX0gICBUaGUgbm9kZSB3aXRoIHRoZSBtYXRjaGluZyBpZFxuICAgICAqL1xuXHRcdFx0XHRmdW5jdGlvbiBmaW5kTm9kZUJ5SWQoaWQsIG5vZGVzKSB7XG5cdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0aWYgKGlkID09IG5vZGVzW2ldLmlkKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBub2Rlc1tpXTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR2YXIgbGlua3MgPSBbXTtcblx0XHRcdFx0Ly9hIG1hcHBpbmcgZnJvbSBzb3VyY2UuaWQtdGFyZ2V0LmlkIHRvIHRoZSBsaW5rIGFkZGVkXG5cdFx0XHRcdHZhciBhZGRlZF9saW5rcyA9IHt9O1xuXHRcdFx0XHQvL3RyYW5zZm9ybWluZyBsaW5rIGRhdGFcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBsaW5rRGF0YS5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdGlmIChsaW5rRGF0YVtpXS5zb3VyY2UgIT0gbGlua0RhdGFbaV0udGFyZ2V0KSB7XG5cdFx0XHRcdFx0XHR2YXIgc291cmNlID0gZmluZE5vZGVCeUlkKGxpbmtEYXRhW2ldLnNvdXJjZSwgbm9kZXMpO1xuXHRcdFx0XHRcdFx0dmFyIHRhcmdldCA9IGZpbmROb2RlQnlJZChsaW5rRGF0YVtpXS50YXJnZXQsIG5vZGVzKTtcblx0XHRcdFx0XHRcdHZhciB3ZWlnaHQgPSBsaW5rRGF0YVtpXS53ZWlnaHQ7XG5cdFx0XHRcdFx0XHQvL2luIG9yZGVyIHRvIHN1bSBhbGwgdGhlIHdlaWdodHMgb2YgdGhlIGxpbmtzIG9mIHRoZSBzdWItbm9kZXMsXG5cdFx0XHRcdFx0XHQvL3dlIHVzZSBhZGRlZF9saW5rcyB0byBrZWVwIHRyYWNrIGlmIGFuIGxpbmsgd2FzIGFkZGVkXG5cdFx0XHRcdFx0XHQvL2lmIGl0IGlzLCB3ZSBtb2RpZnkgaXRzIHdlaWdodFxuXHRcdFx0XHRcdFx0aWYgKHNvdXJjZSA9PSBudWxsIHx8IHRhcmdldCA9PSBudWxsKSB7XG5cdFx0XHRcdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0aWYgKGFkZGVkX2xpbmtzW3NvdXJjZS5pZCArICctJyArIHRhcmdldC5pZF0gPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdFx0XHR2YXIgbGluayA9IG5ldyBWaXN1YWxpemVyTGluay5MaW5rKHNvdXJjZSwgdGFyZ2V0LCB3ZWlnaHQpO1xuXHRcdFx0XHRcdFx0XHRhZGRlZF9saW5rc1tzb3VyY2UuaWQgKyAnLScgKyB0YXJnZXQuaWRdID0gbGluaztcblx0XHRcdFx0XHRcdFx0bGlua3MucHVzaChsaW5rKTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdHZhciBleGlzdGluZ19saW5rID0gYWRkZWRfbGlua3Nbc291cmNlLmlkICsgJy0nICsgdGFyZ2V0LmlkXTtcblx0XHRcdFx0XHRcdFx0ZXhpc3RpbmdfbGluay5zZXRXZWlnaHQoZXhpc3RpbmdfbGluay5nZXRSYXdXZWlnaHQoKSArIHdlaWdodCk7XG5cdFx0XHRcdFx0XHRcdGV4aXN0aW5nX2xpbmsuaW5jcmVhc2VDb3VudCgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gbGlua3M7XG5cdFx0XHR9XG5cdFx0fV0pO1xuXG5cdFx0cmV0dXJuIFZpc3VhbGl6ZXJEYXRhU291cmNlO1xuXHR9KERhdGFTb3VyY2UuRGF0YVNvdXJjZSk7XG5cblx0cmV0dXJuIHtcblx0XHREYXRhU291cmNlOiBWaXN1YWxpemVyRGF0YVNvdXJjZVxuXHR9O1xufV0pO1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4vKipcbiAqIFRoZSBiYXNlIGNsYXNzIHRoZSBncmFwaCBvYmplY3QuIEFueSBub2RlcyBvciBsaW5rcyB0aGF0IGFyZSBjb250YWluZWQgaW5cbiAqIGl0cyBub2RlcyBvciBsaW5rcyBwcm9wZXJ0eSB3aWxsIGJlIGRyYXduIG9uIHVwZGF0ZUdyYXBoLlxuICogU3VwcG9ydHMgcG9saWNpZXMuXG4gKiBcbiAqIFRvIHdyaXRlIHlvdXIgb3duIGdyYXBoIG9iamVjdCwgY3JlYXRlIGEgbmV3IGZhY3RvcnkgdGhhdCB1c2VzIHRoZSBncmFwaFxuICogeW91IHdhbnQgdG8gaW5oZXJpdCBhcyBhIGRlcGVuZGVuY3ksIGFuZCBleHRlbmQgaXRzIGdyYXBoIGNsYXNzLiBcbiAqIFJldHVybiB0aGUgY2xhc3Mgb2JqZWN0IHdpdGggR3JhcGggYXMga2V5LlxuICogXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdHcmFwaCcsIFsnUG9saWN5U2VydmljZScsIGZ1bmN0aW9uIChQb2xpY3lTZXJ2aWNlKSB7XG4gICAgdmFyIEdyYXBoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvKipcbiAgICAgICAgICogY29uc3RydWN0b3IgZm9yIHRoZSBncmFwaFxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBTVkd9ICBzdmcgICAgIFRoZSBzdmcgdGhhdCB3aWxsIFxuICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvbGQgdGhlIGdyYXBoXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVzICAgICAgTGlzdCBvZiBub2RlcyBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIGxpbmtzICAgICAgTGlzdCBvZiBsaW5rcyBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBHcmFwaChzdmcsIG5vZGVzLCBsaW5rcykge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEdyYXBoKTtcblxuICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlcyA9IG5vZGVzIHx8IFtdO1xuICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzID0gbGlua3MgfHwgW107XG5cbiAgICAgICAgICAgIHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzID0gW107XG4gICAgICAgICAgICB0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcyA9IFtdO1xuXG4gICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5ID0gbmV3IFBvbGljeVNlcnZpY2UuUG9saWN5KCk7XG5cbiAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZSA9IHtcbiAgICAgICAgICAgICAgICBjYW5ab29tOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNhblBhbjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpbml0Rm9yY2U6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGRpc2FibGVVcGRhdGU6IGZhbHNlXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0aGlzR3JhcGguY29uc3RzID0ge1xuICAgICAgICAgICAgICAgIGNpcmNsZUdDbGFzczogXCJjb25jZXB0R1wiLFxuICAgICAgICAgICAgICAgIGdyYXBoQ2xhc3M6IFwiZ3JhcGhcIixcbiAgICAgICAgICAgICAgICBwYXRoQ2xhc3M6IFwicGF0aFwiLFxuICAgICAgICAgICAgICAgIG5vZGVDbGFzczogXCJjaXJjbGVcIixcbiAgICAgICAgICAgICAgICBub2RlVGV4dDogXCJub2RlVGV4dFwiLFxuICAgICAgICAgICAgICAgIHN0YXJ0UmFkaXVzOiA1MCxcbiAgICAgICAgICAgICAgICBtYXhSYWRpdXM6IDYwLFxuICAgICAgICAgICAgICAgIHBhZGRpbmc6IDUsXG4gICAgICAgICAgICAgICAgZGlzcGxheU9mZnNldDogNjBcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHN2Zy5vbihcIm1vdXNlb3ZlclwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3lbXCJtb3VzZW92ZXJcIl0uY2FsbCh0aGlzLCBkKTtcbiAgICAgICAgICAgIH0pLm9uKFwiZGJsY2xpY2tcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wiZGJsY2xpY2tcIl0uY2FsbCh0aGlzLCBkKTtcbiAgICAgICAgICAgIH0pLm9uKFwiY29udGV4dG1lbnVcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wiY29udGV4dG1lbnVcIl0uY2FsbCh0aGlzLCBkKTtcbiAgICAgICAgICAgIH0pLm9uKFwibW91c2VvdXRcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wibW91c2VvdXRcIl0uY2FsbCh0aGlzLCBkKTtcbiAgICAgICAgICAgIH0pLm9uKFwibW91c2Vkb3duXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcIm1vdXNlZG93blwiXS5jYWxsKHRoaXMsIGQpO1xuICAgICAgICAgICAgfSkub24oXCJtb3VzZXVwXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeVtcIm1vdXNldXBcIl0uY2FsbCh0aGlzLCBkKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBkZWZpbmUgYXJyb3cgbWFya2VycyBmb3IgZ3JhcGggbGlua3NcbiAgICAgICAgICAgIHZhciBkZWZzID0gc3ZnLmFwcGVuZCgnc3ZnOmRlZnMnKTtcbiAgICAgICAgICAgIGRlZnMuYXBwZW5kKCdzdmc6bWFya2VyJykuYXR0cignaWQnLCAnZW5kLWFycm93JykuYXR0cihcInZpZXdCb3hcIiwgXCIwIC01IDEwIDEwXCIpLmF0dHIoXCJyZWZYXCIsIDIwKS5hdHRyKFwicmVmWVwiLCAtMSkuYXR0cihcIm1hcmtlcldpZHRoXCIsIDYpLmF0dHIoXCJtYXJrZXJIZWlnaHRcIiwgNikuYXR0cihcIm9yaWVudFwiLCBcImF1dG9cIikuYXBwZW5kKFwicGF0aFwiKS5hdHRyKFwiZFwiLCBcIk0wLC01TDEwLDBMMCw1XCIpO1xuXG4gICAgICAgICAgICAvLyBkZWZpbmUgYXJyb3cgbWFya2VycyBmb3IgbGVhZGluZyBhcnJvd1xuICAgICAgICAgICAgZGVmcy5hcHBlbmQoJ3N2ZzptYXJrZXInKS5hdHRyKCdpZCcsICdtYXJrLWVuZC1hcnJvdycpLmF0dHIoJ3ZpZXdCb3gnLCAnMCAtNSAxMCAxMCcpLmF0dHIoJ3JlZlgnLCA3KS5hdHRyKCdtYXJrZXJXaWR0aCcsIDMuNSkuYXR0cignbWFya2VySGVpZ2h0JywgMy41KS5hdHRyKCdvcmllbnQnLCAnYXV0bycpLmFwcGVuZCgnc3ZnOnBhdGgnKS5hdHRyKCdkJywgJ00wLC01TDEwLDBMMCw1Jyk7XG5cbiAgICAgICAgICAgIHRoaXNHcmFwaC5zdmcgPSBzdmc7XG4gICAgICAgICAgICB0aGlzR3JhcGguc3ZnRyA9IHN2Zy5hcHBlbmQoXCJnXCIpLmNsYXNzZWQodGhpc0dyYXBoLmNvbnN0cy5ncmFwaENsYXNzLCB0cnVlKTtcbiAgICAgICAgICAgIHZhciBzdmdHID0gdGhpc0dyYXBoLnN2Z0c7XG5cbiAgICAgICAgICAgIC8vIHN2ZyBub2RlcyBhbmQgbGlua3MgXG4gICAgICAgICAgICB0aGlzR3JhcGgucGF0aHMgPSBzdmdHLmFwcGVuZChcImdcIikuc2VsZWN0QWxsKFwiZ1wiKTtcbiAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzID0gc3ZnRy5hcHBlbmQoXCJnXCIpLnNlbGVjdEFsbChcImdcIik7XG4gICAgICAgICAgICB0aGlzR3JhcGguaW5pdE5vZGVzKCk7XG4gICAgICAgICAgICB0aGlzR3JhcGguaW5pdExpbmtzKCk7XG5cbiAgICAgICAgICAgIHRoaXNHcmFwaC5zZXRQb3NpdGlvbnMoKTtcbiAgICAgICAgICAgIHZhciByZXNpemVGdW5jID0gZnVuY3Rpb24gcmVzaXplRnVuYygpIHtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgub25XaW5kb3dSZXNpemUoc3ZnKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHRoaXNHcmFwaC5iaW5kaW5ncyA9IHtcbiAgICAgICAgICAgICAgICByZXNpemU6IHJlc2l6ZUZ1bmNcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAkKHdpbmRvdykucmVzaXplKHJlc2l6ZUZ1bmMpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIGNhbGxzIHRoZSBkZXN0cm95IG1ldGhvZCBmb3IgYWxsIHBvbGljaWVzXG4gICAgICAgICAqL1xuXG5cbiAgICAgICAgX2NyZWF0ZUNsYXNzKEdyYXBoLCBbe1xuICAgICAgICAgICAga2V5OiAnZGVzdHJveScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5LmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5LmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5LmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gdGhpc0dyYXBoLmJpbmRpbmdzKSB7XG4gICAgICAgICAgICAgICAgICAgICQod2luZG93KS5vZmYoa2V5LCB0aGlzR3JhcGguYmluZGluZ3Nba2V5XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJ1bnMgdGhlIGluaXQgZnVuY3Rpb24gZm9yIGFsbCB0aGUgbm9kZXNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2luaXROb2RlcycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdE5vZGVzKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJ1bnMgdGhlIGluaXQgZnVuY3Rpb24gZm9yIGFsbCB0aGUgbGlua3NcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2luaXRMaW5rcycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdExpbmtzKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubGlua3MsIGZ1bmN0aW9uIChsaW5rKSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmsuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIHJldHVybnMgdGhlIG5vZGUgbWF0Y2hpbmcgdGhlIGlkLCBcbiAgICAgICAgICAgICAqIG9yIHVuZGVmaW5lZCBpZiB0aGVyZSBpcyBub25lXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGlkICAgICAgVGhlIGlkZW50aWZpZXJcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtOb2RlfSAgeyBtYXRjaGluZyBub2RlIH1cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2ZpbmROb2RlQnlJZCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZmluZE5vZGVCeUlkKGlkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSB0aGlzR3JhcGgubm9kZXNbaV0uaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzR3JhcGgubm9kZXNbaV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2ZpbmREM05vZGUnLFxuXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmV0dXJucyB0aGUgZDNOb2RlIG9iamVjdCB0aGF0IG1hdGNoZXMgdGhlIGlkLFxuICAgICAgICAgICAgICogb3IgdW5kZWZpbmVkIGlmIHRoZXJlIGlzIG5vbmVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgaWQgICAgICBUaGUgaWRlbnRpZmllclxuICAgICAgICAgICAgICogQHJldHVybiAgICAge0QzTm9kZX0gVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmREM05vZGUoaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgZDNOb2RlO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2goZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuaWQgPT09IGlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkM05vZGUgPSBkMy5zZWxlY3QodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZDNOb2RlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVzZWQgdG8gaW5zdGFsbCBhIGRyYWcgcG9saWN5IHRoYXQgd2lsbCBiZSBjYWxsZWRcbiAgICAgICAgICAgICAqIHdoZW4gbm9kZXMgYXJlIGRyYWdnZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7ZDMuYmVoYXZpb3IuZHJhZ30gIGQzZHJhZyAgRDMgZHJhZyBvYmplY3RcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2luc3RhbGxEcmFnUG9saWN5JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbnN0YWxsRHJhZ1BvbGljeShkM2RyYWcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRyYWcgPSBkM2RyYWc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byBpbnN0YWxsIGEgcG9saWN5IHRoYXQgd2lsbCBiZSBjYWxsZWQgXG4gICAgICAgICAgICAgKiB3aGVuIHRoZXJlIGlzIG1vdXNlIGludGVyYWN0aW9ucyB3aXRoIHRoZSBncmFwaCdzIHN2Z1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3kgIFRoZSBwb2xpY3kgdG8gaW5zdGFsbFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnaW5zdGFsbFN2Z1BvbGljeScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5zdGFsbFN2Z1BvbGljeShwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN2Z1BvbGljeSA9IHBvbGljeTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIGluc3RhbGwgcG9saWNpZXMgdGhhdCBhcmUgY2FsbGVkIHdoZW4gdGhlcmUgaXNcbiAgICAgICAgICAgICAqIG1vdXNlIGludGVyYWN0aW9uIHdpdGggYSBub2RlXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeSAgVGhlIHBvbGljeSB0byBpbnN0YWxsXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdpbnN0YWxsRGVmYXVsdE5vZGVQb2xpY3knLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluc3RhbGxEZWZhdWx0Tm9kZVBvbGljeShwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcy5wdXNoKHBvbGljeSk7XG4gICAgICAgICAgICAgICAgcG9saWN5LmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIHJlbW92ZSBhbiBpbnN0YWxsZWQgcG9saWN5IGZvciBub2Rlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgcG9saWN5UmVtb3ZlICBUaGUgcG9saWN5IHRvIHJlbW92ZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAndW5pbnN0YWxsRGVmYXVsdE5vZGVQb2xpY3knLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVuaW5zdGFsbERlZmF1bHROb2RlUG9saWN5KHBvbGljeVJlbW92ZSkge1xuICAgICAgICAgICAgICAgIHZhciBwb2xpY3lSZW1vdmVOYW1lO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcG9saWN5UmVtb3ZlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmUucG9saWN5TmFtZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5LCBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9saWN5LnBvbGljeU5hbWUgPT09IHBvbGljeVJlbW92ZU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmV0dXJucyB0aGUgbm9kZSBwb2xpY3kgb2JqZWN0IHdpdGggdGhlIGdpdmVuIG5hbWVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgcG9saWN5TmFtZSAgVGhlIHBvbGljeSBuYW1lXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7UG9saWN5fSAgcG9saWN5ICAgICAgVGhlIG1hdGNoaW5nIHBvbGljeVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZ2V0Tm9kZVBvbGljeScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Tm9kZVBvbGljeShwb2xpY3lOYW1lKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3ksIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb2xpY3kucG9saWN5TmFtZSA9PT0gcG9saWN5TmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBvbGljeTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVzZWQgdG8gaW5zdGFsbCBwb2xpY2llcyB0aGF0IGFyZSBjYWxsZWQgd2hlbiB0aGVyZSBpcyBhXG4gICAgICAgICAgICAgKiBtb3VzZSBpbnRlcmFjdGlvbiB3aXRoIGEgcGF0aFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3kgIFRoZSBwb2xpY3kgdG8gaW5zdGFsbFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnaW5zdGFsbERlZmF1bHRQYXRoUG9saWN5JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3kocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMucHVzaChwb2xpY3kpO1xuICAgICAgICAgICAgICAgIHBvbGljeS5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byByZW1vdmUgYW4gaW5zdGFsbGVkIHBvbGljeSBmb3IgbGlua3NcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UG9saWN5fSAgcG9saWN5UmVtb3ZlICBUaGUgcG9saWN5IHRvIHJlbW92ZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAndW5pbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3knLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVuaW5zdGFsbERlZmF1bHRQYXRoUG9saWN5KHBvbGljeVJlbW92ZSkge1xuICAgICAgICAgICAgICAgIHZhciBwb2xpY3lSZW1vdmVOYW1lO1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcG9saWN5UmVtb3ZlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmUucG9saWN5TmFtZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5LCBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9saWN5LnBvbGljeU5hbWUgPT09IHBvbGljeVJlbW92ZU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlcmUgaXMgYSBtb3VzZSBpbnRlcmFjdGlvbiB3aXRoIGEgcGF0aFxuICAgICAgICAgICAgICogUHJvcG9nYXRlcyB0aGUgZXZlbnQgdG8gYWxsIGluc3RhbGxlZCBwYXRoIHBvbGljaWVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIGV2ZW50ICAgVGhlIGV2ZW50IHR5cGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM29iamVjdH0gIGQzcGF0aCAgVGhlIGQzIHBhdGhcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQYXRofSAgZCAgICAgICBUaGUgbWF0Y2hpbmcgTGluayBvYmplY3RcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3BhdGhQb2xpY3lFdmVudCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcGF0aFBvbGljeUV2ZW50KGV2ZW50LCBkM3BhdGgsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5W2V2ZW50XShkM3BhdGgsIGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZXJlIGlzIGEgbW91c2UgaW50ZXJhY3Rpb24gd2l0aCBhIG5vZGVcbiAgICAgICAgICAgICAqIFByb3BvZ2F0ZXMgdGhlIGV2ZW50IHRvIGFsbCBpbnN0YWxsZWQgbm9kZSBwb2xpY2llc1xuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgZXZlbnQgICBUaGUgZXZlbnQgdHlwZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2Qzb2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BhdGh9ICBkICAgICAgIFRoZSBtYXRjaGluZyBOb2RlIG9iamVjdFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnbm9kZVBvbGljeUV2ZW50JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBub2RlUG9saWN5RXZlbnQoZXZlbnQsIGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcywgZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lbZXZlbnRdKGQzbm9kZSwgZCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU2V0cyBwYW4gYW5kIHpvb20gcnVsZXMgZm9yIHRoZSBncmFwaFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkMy5iZWhhdmlvci56b29tfSAgZDN6b29tICBEMyB6b29tIG9ialxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnaW5zdGFsbFpvb21Qb2xpY3knLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluc3RhbGxab29tUG9saWN5KGQzem9vbSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZHJhZ1N2ZyA9IGQzem9vbTtcbiAgICAgICAgICAgICAgICB0aGlzLnN2Zy5jYWxsKHRoaXMuZHJhZ1N2Zyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIHdpbmRvdyBpcyByZXNpemVkXG4gICAgICAgICAgICAgKiBIb29rIGZvciBvdmVycmlkaW5nIGluIHN1YmNsYXNzZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SFRNTCBTVkd9ICBzdmcgICAgIFRoZSBzdmcgdGhhdCB0aGUgaGFuZGxlclxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpcyBhdHRhY2hlZCB0b1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnb25XaW5kb3dSZXNpemUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uV2luZG93UmVzaXplKHN2Zykge31cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBJbnNlcnRzIGxpbmUgYnJlYWtzIGluIG5vZGUgdGV4dFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtIVE1MIEVsZW19ICBnRWwgICAgVGhlIGVsZW0gdG8gYWRkIHRleHQgdG9cbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICB0aXRsZSAgIFRoZSB0aXRsZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnaW5zZXJ0VGl0bGVMaW5lYnJlYWtzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbnNlcnRUaXRsZUxpbmVicmVha3MoZ0VsLCB0aXRsZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciB3b3JkcyA9IHRpdGxlLnNwbGl0KC9cXHMrL2cpLFxuICAgICAgICAgICAgICAgICAgICBud29yZHMgPSB3b3Jkcy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgdmFyIGVsID0gZ0VsLmFwcGVuZChcInRleHRcIikuYXR0cignY2xhc3MnLCB0aGlzR3JhcGguY29uc3RzLm5vZGVUZXh0KS5hdHRyKFwidGV4dC1hbmNob3JcIiwgXCJtaWRkbGVcIikuYXR0cihcImR5XCIsIFwiLVwiICsgKG53b3JkcyAtIDEpICogNy41KTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgd29yZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRzcGFuID0gZWwuYXBwZW5kKCd0c3BhbicpLnRleHQod29yZHNbaV0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaSA+IDApIHRzcGFuLmF0dHIoJ3gnLCAwKS5hdHRyKCdkeScsICcxNScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmVzIGFsbCBsaW5rcyBmcm9tIHRoZSBnaXZlbiBub2RlXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBub2RlICAgIFRoZSBub2RlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdzcGxpY2VMaW5rc0Zvck5vZGUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNwbGljZUxpbmtzRm9yTm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHRvU3BsaWNlID0gdGhpc0dyYXBoLmxpbmtzLmZpbHRlcihmdW5jdGlvbiAobCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbC5zb3VyY2UgPT09IG5vZGUgfHwgbC50YXJnZXQgPT09IG5vZGU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdG9TcGxpY2UubWFwKGZ1bmN0aW9uIChsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcy5zcGxpY2UodGhpc0dyYXBoLmxpbmtzLmluZGV4T2YobCksIDEpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEFkZHMgdGhlIG5vZGUgdG8gdGhlIGdyYXBoIGFuZCB1cGRhdGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBub2RlICAgIFRoZSBub2RlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdhZGROb2RlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGROb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICBub2RlLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAncmVtb3ZlTm9kZScsXG5cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmVzIHRoZSBub2RlIHRvIHRoZSBncmFwaCBhbmQgdXBkYXRlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlTm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnNwbGljZSh0aGlzR3JhcGgubm9kZXMuaW5kZXhPZihub2RlKSwgMSk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlKTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdhZGRMaW5rJyxcblxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEFkZHMgdGhlIGxpbmsgdG8gdGhlIGdyYXBoIGFuZCB1cGRhdGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2xpbmt9ICBsaW5rICAgIFRoZSBsaW5rXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRMaW5rKGxpbmspIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MucHVzaChsaW5rKTtcbiAgICAgICAgICAgICAgICBsaW5rLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAncmVtb3ZlTGluaycsXG5cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmVzIHRoZSBsaW5rIHRvIHRoZSBncmFwaCBhbmQgdXBkYXRlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtsaW5rfSAgbGluayAgICBUaGUgbGlua1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlTGluayhsaW5rKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzLnNwbGljZSh0aGlzR3JhcGgubGlua3MuaW5kZXhPZihsaW5rKSwgMSk7XG4gICAgICAgICAgICAgICAgbGluay5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIHVwZGF0aW5nIGV4aXN0aW5nIHBhdGhzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BhdGh9ICBwYXRocyAgIExpc3Qgb2YgcGF0aHNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3VwZGF0ZUV4aXN0aW5nUGF0aHMnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUV4aXN0aW5nUGF0aHMocGF0aHMpIHtcbiAgICAgICAgICAgICAgICBwYXRocy5lYWNoKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGQudXBkYXRlQXR0cihkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyBhZGRpbmcgbmV3IHBhdGhzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BhdGh9ICBuZXdQYXRocyAgTGlzdCBvZiBuZXcgcGF0aHNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3VwZGF0ZU5ld1BhdGhzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVOZXdQYXRocyhuZXdQYXRocykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXRMaW5rcygpO1xuXG4gICAgICAgICAgICAgICAgbmV3UGF0aHMuZWFjaChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBkLm5ld1BhdGhBdHRyKGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvL2lmIG5vZGUgZG9lc24ndCBoYXZlIGl0cyBvd24gcG9saWN5LCB1c2UgZGVmYXVsdCBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgICAgbmV3UGF0aHMub24oXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlb3ZlclwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlb3ZlclwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkub24oXCJkYmxjbGlja1wiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQucGF0aFBvbGljeUV2ZW50KFwiZGJsY2xpY2tcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJkYmxjbGlja1wiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkub24oXCJjb250ZXh0bWVudVwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQucGF0aFBvbGljeUV2ZW50KFwiY29udGV4dG1lbnVcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJjb250ZXh0bWVudVwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkub24oXCJtb3VzZW91dFwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQucGF0aFBvbGljeUV2ZW50KFwibW91c2VvdXRcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZW91dFwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkub24oXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlZG93blwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlZG93blwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkub24oXCJtb3VzZXVwXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZXVwXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aFBvbGljeUV2ZW50KFwibW91c2V1cFwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzR3JhcGguZHJhZyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIHVwZGF0aW5nIGV4aXN0aW5nIG5vZGVzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd1cGRhdGVFeGlzdGluZ05vZGVzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVFeGlzdGluZ05vZGVzKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzID0gdGhpcy5jaXJjbGVzLmRhdGEodGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5pZDtcbiAgICAgICAgICAgICAgICB9KS5lYWNoKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGQudXBkYXRlQXR0cihkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyBhZGRpbmcgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBuZXdOb2RlcyAgTGlzdCBvZiBuZXcgbm9kZXNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3VwZGF0ZU5ld05vZGVzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVOZXdOb2RlcyhuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgbmV3Tm9kZXMuZWFjaChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5ncmFwaCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBkLm5ld05vZGVBdHRyKGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvL2lmIG5vZGUgZG9lc24ndCBoYXZlIGl0cyBvd24gcG9saWN5LCB1c2UgZGVmYXVsdCBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgICAgbmV3Tm9kZXMub24oXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlb3ZlclwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlb3ZlclwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkub24oXCJkYmxjbGlja1wiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQubm9kZVBvbGljeUV2ZW50KFwiZGJsY2xpY2tcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlUG9saWN5RXZlbnQoXCJkYmxjbGlja1wiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkub24oXCJjb250ZXh0bWVudVwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQubm9kZVBvbGljeUV2ZW50KFwiY29udGV4dG1lbnVcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlUG9saWN5RXZlbnQoXCJjb250ZXh0bWVudVwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkub24oXCJtb3VzZW91dFwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQubm9kZVBvbGljeUV2ZW50KFwibW91c2VvdXRcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlUG9saWN5RXZlbnQoXCJtb3VzZW91dFwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkub24oXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlZG93blwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlZG93blwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkub24oXCJtb3VzZXVwXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5ub2RlUG9saWN5RXZlbnQoXCJtb3VzZXVwXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwibW91c2V1cFwiLCBkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzR3JhcGguZHJhZyk7XG5cbiAgICAgICAgICAgICAgICBuZXdOb2Rlcy5hcHBlbmQoXCJjaXJjbGVcIikuYXR0cihcInJcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFN0cmluZyhkLnJhZGl1cyk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBuZXdOb2Rlcy5lYWNoKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbnNlcnRUaXRsZUxpbmVicmVha3MoZDMuc2VsZWN0KHRoaXMpLCBkLnRleHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFByZXZlbnRzIG5vZGVzIGZyb20gY29sbGlkaW5nXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge251bWJlcn0gIGFscGhhICAgQWZmZWN0cyBob3cgbXVjaCBjaGFuZ2VcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZSBjb2xsaXNpb24gY2F1c2VzXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7Ym9vbGVhbn0gIHtXaGV0aGVyIG5vZGVzIGFyZSBjb2xsaWRlZH1cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2QzRm9yY2VDb2xsaWRlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkM0ZvcmNlQ29sbGlkZShhbHBoYSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzO1xuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXNHcmFwaC5ub2RlcztcbiAgICAgICAgICAgICAgICB2YXIgcXVhZHRyZWUgPSBkMy5nZW9tLnF1YWR0cmVlKG5vZGVzKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSBkLnJhZGl1cyArIGNvbnN0cy5tYXhSYWRpdXMgKyBjb25zdHMucGFkZGluZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG54MSA9IGQueCAtIHIsXG4gICAgICAgICAgICAgICAgICAgICAgICBueDIgPSBkLnggKyByLFxuICAgICAgICAgICAgICAgICAgICAgICAgbnkxID0gZC55IC0gcixcbiAgICAgICAgICAgICAgICAgICAgICAgIG55MiA9IGQueSArIHI7XG4gICAgICAgICAgICAgICAgICAgIHF1YWR0cmVlLnZpc2l0KGZ1bmN0aW9uIChxdWFkLCB4MSwgeTEsIHgyLCB5Mikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHF1YWQucG9pbnQgJiYgcXVhZC5wb2ludCAhPT0gZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4ID0gZC54IC0gcXVhZC5wb2ludC54LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ID0gZC55IC0gcXVhZC5wb2ludC55LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsID0gTWF0aC5zcXJ0KHggKiB4ICsgeSAqIHkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByID0gZC5yYWRpdXMgKyBxdWFkLnBvaW50LnJhZGl1cyArIGNvbnN0cy5wYWRkaW5nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsIDwgcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsID0gKGwgLSByKSAvIGwgKiBhbHBoYTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC54IC09IHggKj0gbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55IC09IHkgKj0gbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVhZC5wb2ludC54ICs9IHg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1YWQucG9pbnQueSArPSB5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB4MSA+IG54MiB8fCB4MiA8IG54MSB8fCB5MSA+IG55MiB8fCB5MiA8IG55MTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUaWNrIG9mIHRoZSBkMyBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzdGljayBldmVudH0gIGUgICAgRDN0aWNrIGV2ZW50XG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgd2lkdGggIFRoZSB3aWR0aCBvZiB0aGUgc2ltdWxhdGlvblxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge251bWJlcn0gIGhlaWdodCBUaGUgaGVpZ2h0IG9mIHRoZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkM0ZvcmNlVGljaycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZDNGb3JjZVRpY2soZSwgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzO1xuXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IGNvbnN0cy5kaXNwbGF5T2Zmc2V0O1xuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXNHcmFwaC5ub2RlcztcbiAgICAgICAgICAgICAgICB2YXIgcSA9IGQzLmdlb20ucXVhZHRyZWUodGhpc0dyYXBoLm5vZGVzKSxcbiAgICAgICAgICAgICAgICAgICAgaSA9IDAsXG4gICAgICAgICAgICAgICAgICAgIG4gPSBub2Rlcy5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICB3aGlsZSAoKytpIDwgbikge1xuICAgICAgICAgICAgICAgICAgICBxLnZpc2l0KHRoaXMuZDNGb3JjZUNvbGxpZGUobm9kZXNbaV0pKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5lYWNoKHRoaXMuZDNGb3JjZUNvbGxpZGUoLjUpKS5hdHRyKFwiY3hcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueCA9IE1hdGgubWF4KGQucmFkaXVzICsgb2Zmc2V0LCBNYXRoLm1pbih3aWR0aCAtIG9mZnNldCAtIGQucmFkaXVzLCBkLngpKTtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKFwiY3lcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueSA9IE1hdGgubWF4KGQucmFkaXVzICsgb2Zmc2V0LCBNYXRoLm1pbihoZWlnaHQgLSBvZmZzZXQgLSBkLnJhZGl1cywgZC55KSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHMuYXR0cigneDEnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5zb3VyY2UueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd5MScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnNvdXJjZS55O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3gyJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQudGFyZ2V0Lng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneTInLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC50YXJnZXQueTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTdGFydHMgb24gc3RhcnQgb2YgdGhlIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2QzRm9yY2VTdGFydCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZDNGb3JjZVN0YXJ0KCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocy5hdHRyKCd4MScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnNvdXJjZS54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3kxJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuc291cmNlLnk7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneDInLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC50YXJnZXQueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd5MicsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnRhcmdldC55O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBvbiB0aGUgZW5kIG9mIHRoZSBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkM0ZvcmNlRW5kJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkM0ZvcmNlRW5kKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmF0dHIoJ2N4JywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCdjeScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHMuYXR0cigneDEnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5zb3VyY2UueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd5MScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnNvdXJjZS55O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3gyJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQudGFyZ2V0Lng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneTInLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC50YXJnZXQueTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxjdWxhdGVzIHRoZSB3aWR0aCBhbmQgaGVpZ2h0IGJvdW5kcyBmb3IgdGhlIFxuICAgICAgICAgICAgICogZm9yY2Ugc2ltdWxhdGlvblxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtPYmplY3R9ICB3aWR0aCBhbmQgaGVpZ2h0IGFzIHByb3BlcnRpZXMgXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkM0ZvcmNlQm91bmRzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkM0ZvcmNlQm91bmRzKCkge1xuICAgICAgICAgICAgICAgIHZhciBzdmdXaWR0aCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykud2lkdGgoKTtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnSGVpZ2h0ID0gJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS5oZWlnaHQoKTtcblxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IHN2Z1dpZHRoO1xuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBzdmdIZWlnaHQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgd2lkdGg6IHdpZHRoLCBoZWlnaHQ6IGhlaWdodCB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIERvZXMgYSBkMyBmb3JjZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0Z1bmN0aW9ufSAgY2FsbGJhY2sgIFRoZSBjYWxsYmFja1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnc2V0Rm9yY2UnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldEZvcmNlKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICAgICAgdmFyIGxpbmtzID0gdGhpc0dyYXBoLmxpbmtzO1xuICAgICAgICAgICAgICAgIGlmIChfLmlzRW1wdHkobm9kZXMpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgYm91bmRzID0gdGhpc0dyYXBoLmQzRm9yY2VCb3VuZHMoKTtcblxuICAgICAgICAgICAgICAgIHZhciBmb3JjZSA9IGQzLmxheW91dC5mb3JjZSgpLnNpemUoW2JvdW5kcy53aWR0aCwgYm91bmRzLmhlaWdodF0pLm5vZGVzKG5vZGVzKS5jaGFyZ2UoZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC02MDAwO1xuICAgICAgICAgICAgICAgIH0pLmxpbmtzKGxpbmtzKTtcblxuICAgICAgICAgICAgICAgIGZvcmNlLmxpbmtEaXN0YW5jZShib3VuZHMud2lkdGggLyAzKTtcbiAgICAgICAgICAgICAgICBmb3JjZS5saW5rU3RyZW5ndGgoLjIpO1xuICAgICAgICAgICAgICAgIGZvcmNlLmdyYXZpdHkoLjIpO1xuXG4gICAgICAgICAgICAgICAgZm9yY2Uub24oJ3RpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguZDNGb3JjZVRpY2suY2FsbCh0aGlzR3JhcGgsIGUsIGJvdW5kcy53aWR0aCwgYm91bmRzLmhlaWdodCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBmb3JjZS5vbignc3RhcnQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kM0ZvcmNlU3RhcnQuY2FsbCh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZm9yY2Uub24oJ2VuZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLmQzRm9yY2VFbmQuY2FsbCh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZm9yY2Uuc3RhcnQoKTtcbiAgICAgICAgICAgICAgICB2YXIgayA9IDA7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGZvcmNlLmFscGhhKCkgPiAxZS0yICYmIGsgPCAxNTApIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yY2UudGljaygpO1xuICAgICAgICAgICAgICAgICAgICBrID0gayArIDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvcmNlLnN0b3AoKTtcblxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjayAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNldHMgdGhlIHBvc2l0aW9ucyB0byBiZSB0aGUgY2VudGVyIG9mIHRoZSBzY3JlZW4gaWYgXG4gICAgICAgICAgICAgKiBub3QgcHJvdmlkZWRcbiAgICAgICAgICAgICAqIGFsc28gc2V0cyB0aGUgcmFkaXVzIG9mIHRoZSBub2Rlc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnc2V0UG9zaXRpb25zJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRQb3NpdGlvbnMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gdGhpc0dyYXBoLmNvbnN0cy5kaXNwbGF5T2Zmc2V0O1xuICAgICAgICAgICAgICAgIHZhciBzdmdXaWR0aCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykud2lkdGgoKTtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnSGVpZ2h0ID0gJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS5oZWlnaHQoKTtcblxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IHN2Z1dpZHRoIC0gMiAqIG9mZnNldDtcbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gc3ZnSGVpZ2h0IC0gMiAqIG9mZnNldDtcblxuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXNHcmFwaC5ub2RlcztcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZXNbaV0ucmFkaXVzID0gbm9kZXNbaV0ucmFkaXVzIHx8IHRoaXNHcmFwaC5jb25zdHMuc3RhcnRSYWRpdXM7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2Rlc1tpXS54ID09IG51bGwgfHwgbm9kZXNbaV0ueSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBub2Rlc1tpXS54U3RhcnQgPSB3aWR0aC8yICArIG5vZGVzW2ldLnJhZGl1cyArIG9mZnNldFxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNbaV0ueCA9IHdpZHRoIC8gMiArIG5vZGVzW2ldLnJhZGl1cyArIG9mZnNldDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5vZGVzW2ldLnlTdGFydCA9IGhlaWdodC8yICsgbm9kZXNbaV0ucmFkaXVzICsgb2Zmc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1tpXS55ID0gaGVpZ2h0IC8gMiArIG5vZGVzW2ldLnJhZGl1cyArIG9mZnNldDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgdG8gdXBkYXRlIHRoZSB2aWV3IG9mIHRoZSBncmFwaCB3aGVuXG4gICAgICAgICAgICAgKiBkYXRhIGNoYW5nZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RnVuY3Rpb259ICBjYWxsYmFjayAgVGhlIGNhbGxiYWNrXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd1cGRhdGVHcmFwaCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlR3JhcGgoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGU7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLnN0YXRlLmRpc2FibGVVcGRhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRXhpc3RpbmdOb2RlcygpO1xuICAgICAgICAgICAgICAgIHZhciBuZXdHcyA9IHRoaXNHcmFwaC5jaXJjbGVzLmVudGVyKCkuYXBwZW5kKFwiZ1wiKTtcblxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCd1cGRhdGUnLCBuZXdHcyk7XG4gICAgICAgICAgICAgICAgbmV3R3MuY2xhc3NlZChjb25zdHMuY2lyY2xlR0NsYXNzLCB0cnVlKTtcblxuICAgICAgICAgICAgICAgIC8vIHRoaXMudXBkYXRlTmV3Tm9kZXMobmV3R3MpO1xuXG4gICAgICAgICAgICAgICAgLy8gcmVtb3ZlIG9sZCBub2Rlc1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmV4aXQoKS5yZW1vdmUoKTtcblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5pbml0Rm9yY2UgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNldEZvcmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVOZXdOb2Rlcy5jYWxsKHRoaXNHcmFwaCwgbmV3R3MpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuaW5pdEZvcmNlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZU5ld05vZGVzKG5ld0dzKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHMgPSB0aGlzR3JhcGgucGF0aHMuZGF0YSh0aGlzR3JhcGgubGlua3MsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBTdHJpbmcoZC5zb3VyY2UuaWQpICsgXCIrXCIgKyBTdHJpbmcoZC50YXJnZXQuaWQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciBwYXRocyA9IHRoaXNHcmFwaC5wYXRocztcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUV4aXN0aW5nUGF0aHMocGF0aHMpO1xuXG4gICAgICAgICAgICAgICAgdmFyIG5ld3BhdGhzID0gcGF0aHMuZW50ZXIoKS5hcHBlbmQoXCJwYXRoXCIpLnN0eWxlKCdtYXJrZXItZW5kJywgJ3VybCgjZW5kLWFycm93KScpLmNsYXNzZWQoXCJsaW5rXCIsIHRydWUpO1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlTmV3UGF0aHMobmV3cGF0aHMpO1xuXG4gICAgICAgICAgICAgICAgLy8gcmVtb3ZlIG9sZCBsaW5rc1xuICAgICAgICAgICAgICAgIHBhdGhzLmV4aXQoKS5yZW1vdmUoKTtcblxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjayAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIEdyYXBoO1xuICAgIH0oKTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIEdyYXBoOiBHcmFwaFxuICAgIH07XG59XSk7XG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuLyoqXG4gKiBUaGUgZ3JhcGggdGhhdCBpcyB1c2VkIHNwZWNpZmljYWxseSBmb3IgdGhlIHZpc3VhbGl6YXRpb24gdGFiLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnVmlzdWFsaXplckdyYXBoJywgWydHcmFwaCcsIGZ1bmN0aW9uIChHcmFwaCkge1xuICAgIHZhciBWaXN1YWxpemVyR3JhcGggPSBmdW5jdGlvbiAoX0dyYXBoJEdyYXBoKSB7XG4gICAgICAgIF9pbmhlcml0cyhWaXN1YWxpemVyR3JhcGgsIF9HcmFwaCRHcmFwaCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAge0hUTUwgU1ZHfSAgc3ZnICAgICAgICAgICAgIFRoZSBzdmcgdGhhdCB3aWxsIFxuICAgICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9sZCB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAgICogQHBhcmFtICAge0FycmF5fSAgbm9kZXMgICBcdFx0ICAgIExpc3Qgb2Ygbm9kZXNcbiAgICAgICAgICAgICAgICogQHBhcmFtICAge0FycmF5fSAgbGlua3MgICBcdFx0ICAgIExpc3Qgb2YgbGlua3NcbiAgICAgICAgICogQHBhcmFtICAge0RhdGFTb3VyY2V9ICBkYXRhU291cmNlICAgIFRoZSBkYXRhIHNvdXJjZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gVmlzdWFsaXplckdyYXBoKHN2Zywgbm9kZXMsIGxpbmtzLCBkYXRhU291cmNlKSB7XG4gICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVmlzdWFsaXplckdyYXBoKTtcblxuICAgICAgICAgICAgdmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKFZpc3VhbGl6ZXJHcmFwaC5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFZpc3VhbGl6ZXJHcmFwaCkpLmNhbGwodGhpcywgc3ZnLCBub2RlcywgbGlua3MpKTtcblxuICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IF90aGlzO1xuXG4gICAgICAgICAgICAvL2hvbGRzIGN1cnJlbnQgdHJhbnNpdGlvbnMgdGhhdCBhcmUgb2NjdXJpbmdcbiAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZS50cmFuc2l0aW9uID0gW107XG4gICAgICAgICAgICAvL01pbiBkaXN0YW5jZSBiZXR3ZWVuIG5vZGVzIHdoZW4gc3Bhd25pbmcgcmFuZG9tbHlcbiAgICAgICAgICAgIHRoaXNHcmFwaC5jb25zdHMuZWRnZV9idWZmZXIgPSAyMDA7XG4gICAgICAgICAgICAvL1NpemUgcmVkdWN0aW9uIGFzIHlvdSBnbyB0aHJvdWdoIGxldmVscyBpbiBub2Rlc1xuICAgICAgICAgICAgdGhpc0dyYXBoLmNvbnN0cy5yYWRpdXNEZWNheSA9IDE7XG4gICAgICAgICAgICAvL0NzcyBjbGFzcyBmb3Igbm9kZXMgdGhhdCBhcmUgY29udGFpbmVyc1xuICAgICAgICAgICAgdGhpc0dyYXBoLmNvbnN0cy5jb250YWluZXJDbGFzcyA9ICdjb250YWluZXInO1xuXG4gICAgICAgICAgICAvL2RhdGFTb3VyY2UgaG9sZHMgdGhlIHNlcnZlciBkYXRhIGFuZCBtZXRob2RzIGZvclxuICAgICAgICAgICAgLy9jb252ZXJ0aW5nIGl0IHRvIGRhdGEgZm9yIHRoZSBncmFwaFxuICAgICAgICAgICAgdGhpc0dyYXBoLmRhdGFTb3VyY2UgPSBkYXRhU291cmNlO1xuXG4gICAgICAgICAgICAvL0RyYWcgYmVoYXZpb3IgZm9yIG5vZGVzXG4gICAgICAgICAgICB2YXIgZHJhZyA9IGQzLmJlaGF2aW9yLmRyYWcoKS5vcmlnaW4oZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyB4OiBkLngsIHk6IGQueSB9O1xuICAgICAgICAgICAgfSkub24oXCJkcmFnc3RhcnRcIiwgZnVuY3Rpb24gKCkge30pLm9uKFwiZHJhZ1wiLCBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5hdHRyKFwidHJhbnNmb3JtXCIsIGZ1bmN0aW9uIChkLCBpKSB7XG4gICAgICAgICAgICAgICAgICAgIGQueCArPSBkMy5ldmVudC5keDtcbiAgICAgICAgICAgICAgICAgICAgZC55ICs9IGQzLmV2ZW50LmR5O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJ0cmFuc2xhdGUoXCIgKyBbZC54LCBkLnldICsgXCIpXCI7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9KS5vbihcImRyYWdlbmRcIiwgZnVuY3Rpb24gKCkge30pO1xuXG4gICAgICAgICAgICB0aGlzR3JhcGguZHJhZyA9IGRyYWc7XG5cbiAgICAgICAgICAgIC8vUGFuIGFuZCBab29tIGJlaGF2aW9yIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgIHZhciB6b29tID0gZDMuYmVoYXZpb3Iuem9vbSgpLm9uKFwiem9vbVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKGQzLmV2ZW50LnNvdXJjZUV2ZW50ICE9IG51bGwgJiYgZDMuZXZlbnQuc291cmNlRXZlbnQuY3RybEtleSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZC5jYWxsKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfSkub24oXCJ6b29tc3RhcnRcIiwgZnVuY3Rpb24gKGQsIGkpIHt9KTtcbiAgICAgICAgICAgIHRoaXNHcmFwaC5kcmFnU3ZnID0gem9vbTtcbiAgICAgICAgICAgIHRoaXNHcmFwaC5zdmcuY2FsbCh6b29tKS5vbihcImRibGNsaWNrLnpvb21cIiwgbnVsbCk7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2FsbGVkIHdpdGggbm8gYXJncyB3aGVuIHRoZSBncmFwaCBoYXMgYSB6b29tIGFjdGlvblxuICAgICAgICAgKiBDYW4gYWxzbyBiZSBjYWxsZWQgd2l0aCBhcmdzIHRvIGZvcmNlIGEgem9vbSBvciBwYW4gXG4gICAgICAgICAqIGV2ZW50IGZvciB0aGUgZ3JhcGguXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gICB0cmFuc2xhdGUgIFRoZSBhbW91bnQgdG8gdHJhbnNsYXRlXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICBzY2FsZSAgICAgIFRoZSBhbW91bnQgdG8gc2NhbGVcbiAgICAgICAgICovXG5cblxuICAgICAgICBfY3JlYXRlQ2xhc3MoVmlzdWFsaXplckdyYXBoLCBbe1xuICAgICAgICAgICAga2V5OiAnem9vbWVkJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB6b29tZWQodHJhbnNsYXRlLCBzY2FsZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGguc3RhdGUucmlnaHRDbGljayA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5qdXN0U2NhbGVUcmFuc0dyYXBoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpZiAodHJhbnNsYXRlICE9IG51bGwgJiYgc2NhbGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbSA9IHRoaXNHcmFwaC5kcmFnU3ZnO1xuICAgICAgICAgICAgICAgICAgICB6b29tLnNjYWxlKHNjYWxlKTtcbiAgICAgICAgICAgICAgICAgICAgem9vbS50cmFuc2xhdGUodHJhbnNsYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgLy9jcmVhdGluZyBuYW1lcyB0byBwcmV2ZW50IHRyYW5zaXRpb24gY29uZmxpY3RzXG4gICAgICAgICAgICAgICAgICAgIHZhciB6b29tU2V0Q2FsbGJhY2sgPSBmdW5jdGlvbiB6b29tU2V0Q2FsbGJhY2soKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB6b29tLnNjYWxlKHNjYWxlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHpvb20udHJhbnNsYXRlKHRyYW5zbGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHZhciB0cmFuc2xhdGVfbmFtZSA9IFwiem9vbVwiICsgdHJhbnNsYXRlO1xuICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QoXCIuXCIgKyB0aGlzLmNvbnN0cy5ncmFwaENsYXNzKS50cmFuc2l0aW9uKHRyYW5zbGF0ZV9uYW1lKS5kZWxheSgxMDApLmR1cmF0aW9uKDc1MCkuYXR0cigndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZSgnICsgem9vbS50cmFuc2xhdGUoKSArICcpIHNjYWxlKCcgKyB6b29tLnNjYWxlKCkgKyAnKScpLmVhY2goXCJlbmRcIiwgem9vbVNldENhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLnN0YXRlLmNhblpvb20pIHtcbiAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KFwiLlwiICsgdGhpcy5jb25zdHMuZ3JhcGhDbGFzcykuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArIHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpICsgXCIpIHNjYWxlKFwiICsgdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKSArIFwiKVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ29uV2luZG93UmVzaXplJyxcblxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSB3aW5kb3cgcmVzaXplc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtIVE1MIFNWR30gIHN2ZyAgICBUaGUgc3ZnIHRvIHJlc2l6ZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb25XaW5kb3dSZXNpemUoc3ZnKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJvZHlFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF07XG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykub2Zmc2V0KCk7XG4gICAgICAgICAgICAgICAgdmFyIGRpdldpZHRoID0gJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS53aWR0aCgpO1xuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBib2R5RWwuY2xpZW50SGVpZ2h0O1xuICAgICAgICAgICAgICAgIHN2Zy5hdHRyKFwid2lkdGhcIiwgZGl2V2lkdGgpLmF0dHIoXCJoZWlnaHRcIiwgaGVpZ2h0IC0gb2Zmc2V0LnRvcCAtIDIwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAndXBkYXRlTGlua0RhdGEnLFxuXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIHNlcnZlciBzZW5kcyB1cGRhdGVkIGRhdGEgZm9yIHRoZSBsaW5rc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlTGlua0RhdGEoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVfbmFtZXNfc2V0ID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZV9uYW1lc19zZXQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0uaWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcmV0RGF0YSA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmdldEZsb3dCZXR3ZWVuU2V0KG5vZGVfbmFtZXNfc2V0KTtcbiAgICAgICAgICAgICAgICB2YXIgbGlua0RhdGEgPSByZXREYXRhLmxpbmtEYXRhO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YShsaW5rRGF0YSwgdGhpc0dyYXBoLm5vZGVzKTtcbiAgICAgICAgICAgICAgICB0aGlzLmluaXROb2RlcygpO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5pdExpbmtzKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1dKTtcblxuICAgICAgICByZXR1cm4gVmlzdWFsaXplckdyYXBoO1xuICAgIH0oR3JhcGguR3JhcGgpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgR3JhcGg6IFZpc3VhbGl6ZXJHcmFwaFxuICAgIH07XG59XSk7XG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbi8qKlxuICogVGhlIGJhc2UgY2xhc3MgZm9yIGxpbmsgb2JqZWN0cyBmb3IgdGhlIGdyYXBoLlxuICogU3VwcG9ydHMgcG9saWNpZXMuXG4gKiBcbiAqIFRvIHdyaXRlIHlvdXIgb3duIGxpbmsgb2JqZWN0LCBjcmVhdGUgYSBuZXcgZmFjdG9yeSB0aGF0IHVzZXMgdGhlIGxpbmtcbiAqIHlvdSB3YW50IHRvIGluaGVyaXQgYXMgYSBkZXBlbmRlbmN5LCBhbmQgZXh0ZW5kIGl0cyBsaW5rIGNsYXNzLiBcbiAqIFJldHVybiB0aGUgY2xhc3Mgb2JqZWN0IHdpdGggTGluayBhcyBrZXlcbiAqIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnTGluaycsIFtmdW5jdGlvbiAoKSB7XG5cdHZhciBMaW5rID0gZnVuY3Rpb24gKCkge1xuXHRcdC8qKlxuICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAqXG4gICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgc291cmNlTm9kZSAgVGhlIHNvdXJjZSBub2RlXG4gICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgdGFyZ2V0Tm9kZSAgVGhlIHRhcmdldCBub2RlXG4gICAqL1xuXHRcdGZ1bmN0aW9uIExpbmsoc291cmNlTm9kZSwgdGFyZ2V0Tm9kZSkge1xuXHRcdFx0X2NsYXNzQ2FsbENoZWNrKHRoaXMsIExpbmspO1xuXG5cdFx0XHR0aGlzLnNvdXJjZSA9IHNvdXJjZU5vZGU7XG5cdFx0XHR0aGlzLnRhcmdldCA9IHRhcmdldE5vZGU7XG5cdFx0XHR0aGlzLmhhc1BvbGljeSA9IGZhbHNlO1xuXHRcdFx0dGhpcy5wYXRoUG9saWNpZXMgPSBbXTtcblx0XHRcdHRoaXMuZ3JhcGggPSBudWxsO1xuXHRcdFx0dGhpcy5pbml0aWFsaXplZCA9IGZhbHNlO1xuXHRcdH1cblxuXHRcdC8qKlxuICAgKiBDYWxsZWQgd2hlbiBhIGxpbmsgaXMgYWRkZWQgdG8gdGhlIGdyYXBoXG4gICAqXG4gICAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoIGl0IGlzIGFkZGVkIHRvXG4gICAqL1xuXG5cblx0XHRfY3JlYXRlQ2xhc3MoTGluaywgW3tcblx0XHRcdGtleTogJ2luaXRpYWxpemUnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemUoZ3JhcGgpIHtcblx0XHRcdFx0aWYgKHRoaXMuaW5pdGlhbGl6ZWQgPT0gZmFsc2UpIHtcblx0XHRcdFx0XHR0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcblx0XHRcdFx0XHR0aGlzLmdyYXBoID0gZ3JhcGg7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBDYWxsZWQgZHVyaW5nIHRoZSB1cGRhdGUgZ3JhcGggZm9yIGV4aXN0aW5nIGxpbmtzXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuICAgICogQHBhcmFtICAgICAge0xpbmt9ICBcdCAgIGQgICAgICAgTWF0Y2hpbmcgTGluayBPYmplY3QgICAgICAgXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3VwZGF0ZUF0dHInLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUF0dHIoZDNwYXRoLCBkKSB7XG5cdFx0XHRcdGQzcGF0aC5zdHlsZSgnbWFya2VyLWVuZCcsICd1cmwoI2VuZC1hcnJvdyknKS5hdHRyKFwiZFwiLCBhcnJvd1BhdGgpO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIENhbGxlZCBkdXJpbmcgdGhlIGZpcnN0IHVwZGF0ZSBncmFwaCBmb3IgYSBsaW5rXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuICAgICogQHBhcmFtICAgICAge0xpbmt9ICBcdCAgIGQgICAgICAgTWF0Y2hpbmcgTGluayBPYmplY3QgICAgICAgXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ25ld1BhdGhBdHRyJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBuZXdQYXRoQXR0cihkM3BhdGgsIGQpIHtcblx0XHRcdFx0ZDNwYXRoLmF0dHIoJ2QnLCBhcnJvd1BhdGgpO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIENhbGN1bGF0ZXMgdGhlIGFycm93IHBhdGhcbiAgICAqXG4gICAgKiBAcmV0dXJuICAgICB7c3RyaW5nfSAgVGhlIHBhdGggdG8gZHJhd1xuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdhcnJvd1BhdGgnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGFycm93UGF0aCgpIHtcblx0XHRcdFx0dmFyIGQgPSB0aGlzO1xuXHRcdFx0XHR2YXIgZHggPSBkLnRhcmdldC54IC0gZC5zb3VyY2UueCxcblx0XHRcdFx0ICAgIGR5ID0gZC50YXJnZXQueSAtIGQuc291cmNlLnksXG5cdFx0XHRcdCAgICBkciA9IE1hdGguc3FydChkeCAqIGR4ICsgZHkgKiBkeSk7XG5cdFx0XHRcdHJldHVybiBcIk1cIiArIGQuc291cmNlLnggKyBcIixcIiArIGQuc291cmNlLnkgKyBcIkFcIiArIGRyICsgXCIsXCIgKyBkciArIFwiIDAgMCwxIFwiICsgZC50YXJnZXQueCArIFwiLFwiICsgZC50YXJnZXQueTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBVc2VkIHRvIGluc3RhbGwgcG9saWNpZXMgdGhhdCBhcmUgY2FsbGVkIHdoZW4gdGhpc1xuICAgICogbGluayBoYXMgYSBtb3VzZSBldmVudFxuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3kgIFRoZSBwb2xpY3kgdG8gaW5zdGFsbFxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdpbnN0YWxsUGF0aFBvbGljeScsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gaW5zdGFsbFBhdGhQb2xpY3kocG9saWN5KSB7XG5cdFx0XHRcdHRoaXMuaGFzUG9saWN5ID0gdHJ1ZTtcblx0XHRcdFx0dGhpcy5wYXRoUG9saWNpZXMucHVzaChwb2xpY3kpO1xuXHRcdFx0XHRwb2xpY3kuaW5pdGlhbGl6ZSh0aGlzLmdyYXBoKTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBVc2VkIHRvIHVuaW5zdGFsbCBwb2xpY3kgZm9yIHRoaXMgbGlua1xuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3lSZW1vdmUgIFRoZSBwb2xpY3kgdG8gcmVtb3ZlXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3VuaW5zdGFsbFBhdGhQb2xpY3knLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHVuaW5zdGFsbFBhdGhQb2xpY3kocG9saWN5UmVtb3ZlKSB7XG5cdFx0XHRcdHZhciBwb2xpY3lSZW1vdmVOYW1lO1xuXHRcdFx0XHR2YXIgdGhpc1BhdGggPSB0aGlzO1xuXHRcdFx0XHRpZiAodHlwZW9mIHBvbGljeVJlbW92ZSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHRwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmUucG9saWN5TmFtZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRfKHRoaXNQYXRoLnBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5LCBpbmRleCkge1xuXHRcdFx0XHRcdGlmIChwb2xpY3kucG9saWN5TmFtZSA9PT0gcG9saWN5UmVtb3ZlTmFtZSkge1xuXHRcdFx0XHRcdFx0cG9saWN5LmRlc3Ryb3koKTtcblx0XHRcdFx0XHRcdHRoaXNQYXRoLnBhdGhQb2xpY2llcy5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHRcdGlmICh0aGlzUGF0aC5wYXRoUG9saWNpZXMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdFx0dGhpc1BhdGguaGFzUG9saWN5ID0gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBDYWxsZWQgd2hlbiB0aGVyZSBpcyBhIG1vdXNlIGV2ZW50IGZvciB0aGlzIHBhdGhcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgZXZlbnQgICAgIFRoZSBtb3VzZSBldmVudFxuICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGQgICAgICAgICBUaGUgbWF0Y2hpbmcgbGluayBvYmplY3RcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAncGF0aFBvbGljeUV2ZW50Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBwYXRoUG9saWN5RXZlbnQoZXZlbnQsIGQzcGF0aCwgZCkge1xuXHRcdFx0XHRfKGQucGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3kpIHtcblx0XHRcdFx0XHRwb2xpY3lbZXZlbnRdKGQzcGF0aCwgZCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1dKTtcblxuXHRcdHJldHVybiBMaW5rO1xuXHR9KCk7XG5cblx0cmV0dXJuIHtcblx0XHRMaW5rOiBMaW5rXG5cdH07XG59XSk7XG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KG9iamVjdCwgcHJvcGVydHksIHJlY2VpdmVyKSB7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyByZXR1cm4gZ2V0KHBhcmVudCwgcHJvcGVydHksIHJlY2VpdmVyKTsgfSB9IGVsc2UgaWYgKFwidmFsdWVcIiBpbiBkZXNjKSB7IHJldHVybiBkZXNjLnZhbHVlOyB9IGVsc2UgeyB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7IGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7IH0gfTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG4vKipcbiAqIFRoZSBsaW5rIHRoYXQgaXMgdXNlZCBzcGVjaWZpY2FsbHkgZm9yIHRoZSB2aXN1YWxpemF0aW9uIHRhYi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ1Zpc3VhbGl6ZXJMaW5rJywgWydMaW5rJywgZnVuY3Rpb24gKExpbmspIHtcblx0dmFyIFZpc3VhbGl6ZXJMaW5rID0gZnVuY3Rpb24gKF9MaW5rJExpbmspIHtcblx0XHRfaW5oZXJpdHMoVmlzdWFsaXplckxpbmssIF9MaW5rJExpbmspO1xuXG5cdFx0LyoqXG4gICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICpcbiAgICogQHBhcmFtICAgICAge05vZGV9ICBzb3VyY2VOb2RlICBUaGUgc291cmNlIG5vZGVcbiAgICogQHBhcmFtICAgICAge05vZGV9ICB0YXJnZXROb2RlICBUaGUgdGFyZ2V0IG5vZGVcbiAgICogQHBhcmFtICAgICAge251bWJlcn0gIHdlaWdodCAgICBUaGUgd2VpZ2h0IG9mIHRoZSBsaW5rXG4gICAqL1xuXHRcdGZ1bmN0aW9uIFZpc3VhbGl6ZXJMaW5rKHNvdXJjZU5vZGUsIHRhcmdldE5vZGUsIHdlaWdodCkge1xuXHRcdFx0X2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZpc3VhbGl6ZXJMaW5rKTtcblxuXHRcdFx0dmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKFZpc3VhbGl6ZXJMaW5rLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoVmlzdWFsaXplckxpbmspKS5jYWxsKHRoaXMsIHNvdXJjZU5vZGUsIHRhcmdldE5vZGUpKTtcblxuXHRcdFx0X3RoaXMud2VpZ2h0ID0gd2VpZ2h0O1xuXHRcdFx0Ly9Db3VudCBpcyB1c2VkIHRvIGtlZXAgdHJhY2sgb2YgaG93IG1hbnlcblx0XHRcdC8vcGF0aHMgdG8gaXRzIHN1Ym5vZGVzIHRoZXJlIGFyZVxuXHRcdFx0Ly9pbiBvcmRlciB0byBjYWxjdWxhdGUgYXZlcmFnZSB0cmFmZmljXG5cdFx0XHRfdGhpcy5jb3VudCA9IDE7XG5cdFx0XHRyZXR1cm4gX3RoaXM7XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqIEluY3JlYXNlcyB0aGUgY291bnQgb2YgdGhlIGxpbmtcbiAgICogVVNlZCB0byBrZWVwIHRyYWNrIG9mIGhvdyBtYW55IHBhdGhzIHRvIGl0cyBzdWJub2Rlc1xuICAgKiB0aGVyZSBhcmUgaW4gb3JkZXIgdG8gY2FsY3VsYXRlIGF2ZXJhZ2UgdHJhZmZpY1xuICAgKi9cblxuXG5cdFx0X2NyZWF0ZUNsYXNzKFZpc3VhbGl6ZXJMaW5rLCBbe1xuXHRcdFx0a2V5OiAnaW5jcmVhc2VDb3VudCcsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gaW5jcmVhc2VDb3VudCgpIHtcblx0XHRcdFx0dGhpcy5jb3VudCArPSAxO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIENhbGN1bGF0ZXMgd2hlcmUgdG8gcGxhY2UgcXRpcCBmb3JcbiAgICAqXG4gICAgKiBAcmV0dXJuICAgICB7T2JqZWN0fSAgT2JqZWN0IHdpdGggcVRpcCBzZXR0aW5nc1xuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdxdGlwSGVscGVyJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBxdGlwSGVscGVyKCkge1xuXHRcdFx0XHR2YXIgcmV0O1xuXHRcdFx0XHR2YXIgZCA9IHRoaXM7XG5cdFx0XHRcdHZhciBkeCA9IChkLnRhcmdldC54IC0gZC5zb3VyY2UueCkgLyAyLFxuXHRcdFx0XHQgICAgZHkgPSAoZC50YXJnZXQueSAtIGQuc291cmNlLnkpIC8gMjtcblx0XHRcdFx0aWYgKGQuc291cmNlLnggPCBkLnRhcmdldC54KSB7XG5cdFx0XHRcdFx0cmV0ID0ge1xuXHRcdFx0XHRcdFx0bXk6ICd0b3AgY2VudGVyJyxcblx0XHRcdFx0XHRcdGF0OiAnY2VudGVyIGNlbnRlcicsIC8vIGF0IHRoZSBib3R0b20gcmlnaHQgb2YuLi5cblx0XHRcdFx0XHRcdHRhcmdldDogW2R4LCBkeV0sXG5cdFx0XHRcdFx0XHRhZGp1c3Q6IHtcblx0XHRcdFx0XHRcdFx0eTogMTBcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHJldCA9IHtcblx0XHRcdFx0XHRcdG15OiAnYm90dG9tIGNlbnRlcicsXG5cdFx0XHRcdFx0XHRhdDogJ2NlbnRlciBjZW50ZXInLCAvLyBhdCB0aGUgYm90dG9tIHJpZ2h0IG9mLi4uXG5cdFx0XHRcdFx0XHR0YXJnZXQ6IFtkeCwgZHldLFxuXHRcdFx0XHRcdFx0YWRqdXN0OiB7XG5cdFx0XHRcdFx0XHRcdHk6IC0xMFxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHJldDtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAqIENhbGxlZCB3aGVuIGEgbGluayBpcyBhZGRlZCB0byB0aGUgZ3JhcGhcbiAgICpcbiAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgYWRkZWQgdG9cbiAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdpbml0aWFsaXplJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBpbml0aWFsaXplKGdyYXBoKSB7XG5cdFx0XHRcdGlmICh0aGlzLmluaXRpYWxpemVkID09IGZhbHNlKSB7XG5cdFx0XHRcdFx0X2dldChWaXN1YWxpemVyTGluay5wcm90b3R5cGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihWaXN1YWxpemVyTGluay5wcm90b3R5cGUpLCAnaW5pdGlhbGl6ZScsIHRoaXMpLmNhbGwodGhpcywgZ3JhcGgpO1xuXHRcdFx0XHRcdHZhciBzdGF0ZSA9IGdyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXHRcdFx0XHRcdGlmIChzdGF0ZSA9PSBudWxsKSB7XG5cdFx0XHRcdFx0XHRzdGF0ZSA9IGdyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rID0ge307XG5cdFx0XHRcdFx0XHRzdGF0ZS5tYXhXZWlnaHQgPSBudWxsO1xuXHRcdFx0XHRcdFx0c3RhdGUudXNlQXZnV2VpZ2h0ID0gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0dGhpcy51cGRhdGVNYXhXZWlnaHQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIFNldHMgd2hldGhlciB0aGUgZ3JhcGggc2hvdWxkIHVzZSBhdmcgd2VpZ2h0XG4gICAgKlxuICAgICogQHBhcmFtICAgICAge2Jvb2xlYW59ICB2YWwgICAgIFRoZSB2YWx1ZSB0byBzZXQgdG9cbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnc2V0VXNlQXZnV2VpZ2h0Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBzZXRVc2VBdmdXZWlnaHQodmFsKSB7XG5cdFx0XHRcdHRoaXMuZ3JhcGguc3RhdGUuVmlzdWFsaXplckxpbmsudXNlQXZnV2VpZ2h0ID0gISF2YWw7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogU2V0cyB0aGUgd2VpZ2h0IG9mIHRoaXMgbGlua1xuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB3ZWlnaHQgIFRoZSB3ZWlnaHQgdG8gc2V0IHRvXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3NldFdlaWdodCcsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gc2V0V2VpZ2h0KHdlaWdodCkge1xuXHRcdFx0XHR0aGlzLndlaWdodCA9IHdlaWdodDtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBHZXRzIHRoZSByYXcgd2VpZ2h0LlxuICAgICpcbiAgICAqIEByZXR1cm4gICAgIHtudW1iZXJ9ICBUaGUgcmF3IHdlaWdodC5cbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnZ2V0UmF3V2VpZ2h0Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBnZXRSYXdXZWlnaHQoKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLndlaWdodDtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBHZXRzIHRoZSB3ZWlnaHQgdmFsdWUgb2YgdGhlIGxpbmssIGRlcGVuZGluZyBvbiB0aGVcbiAgICAqIHVzZUF2Z1dlaWd0aCBzZXR0aW5nXG4gICAgKlxuICAgICogQHJldHVybiAgICAge251bWJlcn0gIFRoZSB3ZWlnaHQuXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ2dldFdlaWdodCcsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gZ2V0V2VpZ2h0KCkge1xuXHRcdFx0XHR2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcblx0XHRcdFx0ICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXG5cdFx0XHRcdGlmIChzdGF0ZS51c2VBdmdXZWlnaHQpIHtcblx0XHRcdFx0XHR2YXIgd2VpZ2h0ID0gdGhpcy53ZWlnaHQgLyB0aGlzLmNvdW50O1xuXHRcdFx0XHRcdHJldHVybiB3ZWlnaHQ7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHRoaXMud2VpZ2h0O1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIFVwZGF0ZXMgdGhlIG1heCB3ZWlnaHQgb2YgdGhlIGdyYXBoXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3VwZGF0ZU1heFdlaWdodCcsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gdXBkYXRlTWF4V2VpZ2h0KCkge1xuXHRcdFx0XHR2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcblx0XHRcdFx0ICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXG5cdFx0XHRcdHZhciBtYXhMaW5rID0gXy5tYXhCeSh0aGlzR3JhcGgubGlua3MsIGZ1bmN0aW9uIChsKSB7XG5cdFx0XHRcdFx0aWYgKGwuZ3JhcGggIT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIGwuZ2V0V2VpZ2h0KCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiAwO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0c3RhdGUubWF4V2VpZ2h0ID0gbWF4TGluay5nZXRXZWlnaHQoKTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBDYWxsZWQgZHVyaW5nIHRoZSB1cGRhdGUgZ3JhcGggZm9yIGV4aXN0aW5nIGxpbmtzXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuICAgICogQHBhcmFtICAgICAge0xpbmt9ICBcdCAgIGQgICAgICAgTWF0Y2hpbmcgTGluayBPYmplY3QgICAgICAgXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3VwZGF0ZUF0dHInLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUF0dHIoZDNwYXRoLCBkKSB7XG5cdFx0XHRcdHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuXHRcdFx0XHQgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuVmlzdWFsaXplckxpbms7XG5cdFx0XHRcdHRoaXMudXBkYXRlTWF4V2VpZ2h0KCk7XG5cdFx0XHRcdHZhciBjb2xvclNjYWxlID0gZDMuc2NhbGUubGluZWFyKCkuZG9tYWluKFswLCBzdGF0ZS5tYXhXZWlnaHRdKS5yYW5nZShbXCIjZmZiMzY2XCIsIFwiI0Y5MjYwNlwiXSk7XG5cdFx0XHRcdHN0YXRlLmNvbG9yU2NhbGUgPSBjb2xvclNjYWxlO1xuXHRcdFx0XHRkM3BhdGguc3R5bGUoJ21hcmtlci1lbmQnLCAndXJsKCNlbmQtYXJyb3cpJykuY2xhc3NlZCh0aGlzR3JhcGguY29uc3RzLnNlbGVjdGVkQ2xhc3MsIGZ1bmN0aW9uIChkKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGQgPT09IHN0YXRlLnNlbGVjdGVkRWRnZTtcblx0XHRcdFx0fSkuYXR0cihcImRcIiwgdGhpcy5hcnJvd1BhdGguY2FsbChkKSkudHJhbnNpdGlvbihcImV4aXN0aW5nUGF0aFRyYW5zaXRpb25cIikuZHVyYXRpb24oNzUwKS5hdHRyKFwic3Ryb2tlXCIsIGZ1bmN0aW9uIChkKSB7XG5cdFx0XHRcdFx0dmFyIGMgPSBjb2xvclNjYWxlKGQuZ2V0V2VpZ2h0KCkpO1xuXHRcdFx0XHRcdHJldHVybiBjO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiBDYWxsZWQgZHVyaW5nIHRoZSBmaXJzdCB1cGRhdGUgZ3JhcGggZm9yIHRoaXMgbGlua1xuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzcGF0aCAgVGhlIGQzIHBhdGhcbiAgICAqIEBwYXJhbSAgICAgIHtMaW5rfSAgXHQgICBkICAgICAgIE1hdGNoaW5nIExpbmsgT2JqZWN0XG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ25ld1BhdGhBdHRyJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBuZXdQYXRoQXR0cihkM3BhdGgsIGQpIHtcblx0XHRcdFx0dmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG5cdFx0XHRcdCAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluaztcblx0XHRcdFx0dGhpcy51cGRhdGVNYXhXZWlnaHQoKTtcblx0XHRcdFx0dmFyIGNvbG9yU2NhbGUgPSBkMy5zY2FsZS5saW5lYXIoKS5kb21haW4oWzAsIHN0YXRlLm1heFdlaWdodF0pLnJhbmdlKFtcIiNmZmIzNjZcIiwgXCIjRjkyNjA2XCJdKTtcblxuXHRcdFx0XHRkM3BhdGgudHJhbnNpdGlvbihcIm5ld1BhdGhUcmFuc2l0aW9uXCIpLmR1cmF0aW9uKDc1MCkuYXR0clR3ZWVuKFwib3BhY2l0eVwiLCBmdW5jdGlvbiAoZCkge1xuXHRcdFx0XHRcdHJldHVybiBkMy5pbnRlcnBvbGF0ZVN0cmluZygwLCAxKTtcblx0XHRcdFx0fSkuYXR0cihcInN0cm9rZVwiLCBmdW5jdGlvbiAoZCkge1xuXHRcdFx0XHRcdHZhciBjID0gY29sb3JTY2FsZShkLmdldFdlaWdodCgpKTtcblx0XHRcdFx0XHRyZXR1cm4gYztcblx0XHRcdFx0fSkuYXR0cignZCcsIHRoaXMuYXJyb3dQYXRoLmNhbGwoZCkpO1xuXHRcdFx0fVxuXHRcdH1dKTtcblxuXHRcdHJldHVybiBWaXN1YWxpemVyTGluaztcblx0fShMaW5rLkxpbmspO1xuXG5cdHJldHVybiB7XG5cdFx0TGluazogVmlzdWFsaXplckxpbmtcblx0fTtcbn1dKTtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLyoqXG4gKiBUaGUgYmFzZSBjbGFzcyBmb3Igbm9kZSBvYmplY3RzIGZvciB0aGUgZ3JhcGguXG4gKiBTdXBwb3J0cyBwb2xpY2llcy5cbiAqIFxuICogVG8gd3JpdGUgeW91ciBvd24gTm9kZSBvYmplY3QsIGNyZWF0ZSBhIG5ldyBmYWN0b3J5IHRoYXQgdXNlcyB0aGUgbm9kZVxuICogeW91IHdhbnQgdG8gaW5oZXJpdCBhcyBhIGRlcGVuZGVuY3ksIGFuZCBleHRlbmQgaXRzIG5vZGUgY2xhc3MuIFxuICogUmV0dXJuIHRoZSBjbGFzcyBvYmplY3Qgd2l0aCBOb2RlIGFzIGtleVxuICogXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdOb2RlJywgW2Z1bmN0aW9uICgpIHtcblx0dmFyIE5vZGUgPSBmdW5jdGlvbiAoKSB7XG5cdFx0LyoqXG4gICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICpcbiAgICogQHBhcmFtICAgICAge251bWJlcn0gIHggICAgICAgeCBsb2NhdGlvblxuICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeSAgICAgICB5IGxvY2F0aW9uXG4gICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG4gICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICB0ZXh0ICAgIFRoZSB0ZXh0IHRvIGRpc3BsYXlcbiAgICogQHBhcmFtICAgICAge251bWJlcn0gIHJhZGl1cyAgVGhlIHJhZGl1cyBvZiB0aGUgbm9kZVxuICAgKi9cblx0XHRmdW5jdGlvbiBOb2RlKHgsIHksIGlkLCB0ZXh0LCByYWRpdXMpIHtcblx0XHRcdF9jbGFzc0NhbGxDaGVjayh0aGlzLCBOb2RlKTtcblxuXHRcdFx0dGhpcy54ID0geDtcblx0XHRcdHRoaXMueSA9IHk7XG5cdFx0XHR0aGlzLnJhZGl1cyA9IHJhZGl1cztcblx0XHRcdHRoaXMuaWQgPSBpZDtcblx0XHRcdHRoaXMudGV4dCA9IHRleHQ7XG5cdFx0XHR0aGlzLnJhZGl1cyA9IHJhZGl1cztcblx0XHRcdHRoaXMuaGFzUG9saWN5ID0gZmFsc2U7XG5cdFx0XHR0aGlzLnBvbGljeSA9IG51bGw7XG5cdFx0XHR0aGlzLm5vZGVQb2xpY2llcyA9IFtdO1xuXHRcdFx0dGhpcy5ncmFwaCA9IG51bGw7XG5cdFx0XHR0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqIENhbGxlZCB3aGVuIGEgbm9kZSBpcyBhZGRlZCB0byB0aGUgZ3JhcGhcbiAgICpcbiAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgYWRkZWQgdG9cbiAgICovXG5cblxuXHRcdF9jcmVhdGVDbGFzcyhOb2RlLCBbe1xuXHRcdFx0a2V5OiAnaW5pdGlhbGl6ZScsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gaW5pdGlhbGl6ZShncmFwaCkge1xuXHRcdFx0XHRpZiAodGhpcy5pbml0aWFsaXplZCA9PSBmYWxzZSkge1xuXHRcdFx0XHRcdHRoaXMuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuXHRcdFx0XHRcdHRoaXMuZ3JhcGggPSBncmFwaDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIENhbGxlZCBkdXJpbmcgdGhlIHVwZGF0ZSBncmFwaCBmb3IgZXhpc3RpbmcgbGlua3NcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ3VwZGF0ZUF0dHInLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUF0dHIoZDNub2RlLCBkKSB7XG5cdFx0XHRcdGQzbm9kZS5hdHRyKFwidHJhbnNmb3JtXCIsIGZ1bmN0aW9uIChkKSB7XG5cdFx0XHRcdFx0cmV0dXJuIFwidHJhbnNsYXRlKFwiICsgZC54ICsgXCIsXCIgKyBkLnkgKyBcIilcIjtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogQ2FsbGVkIGR1cmluZyB0aGUgZmlyc3QgdXBkYXRlIGdyYXBoIGZvciBhIG5vZGVcbiAgICAqIEhvb2sgZm9yIHN1YiBjbGFzc2VzXG4gICAgKiBcbiAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgIGQgICAgICAgTWF0Y2hpbmcgTm9kZSBPYmplY3RcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnbmV3Tm9kZUF0dHInLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIG5ld05vZGVBdHRyKGQzbm9kZSwgZCkge31cblxuXHRcdFx0LyoqXG4gICAgKiBTZXRzIHRoZSByYWRpdXMgb2YgdGhlIG5vZGUuXG4gICAgKlxuICAgICogQHBhcmFtICAgICAge251bWJlcn0gIHJhZGl1cyAgVGhlIHJhZGl1c1xuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdzZXRSYWRpdXMnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHNldFJhZGl1cyhyYWRpdXMpIHtcblx0XHRcdFx0dGhpcy5yYWRpdXMgPSByYWRpdXM7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogVXNlZCB0byBpbnN0YWxsIHBvbGljaWVzIHRoYXQgYXJlIGNhbGxlZCB3aGVuIHRoaXNcbiAgICAqIG5vZGUgaGFzIGEgbW91c2UgZXZlbnRcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7UG9saWN5fSAgcG9saWN5ICBUaGUgcG9saWN5IHRvIGluc3RhbGxcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnaW5zdGFsbE5vZGVQb2xpY3knLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGluc3RhbGxOb2RlUG9saWN5KHBvbGljeSkge1xuXHRcdFx0XHR0aGlzLmhhc1BvbGljeSA9IHRydWU7XG5cdFx0XHRcdHRoaXMubm9kZVBvbGljaWVzLnB1c2gocG9saWN5KTtcblx0XHRcdFx0cG9saWN5LmluaXRpYWxpemUodGhpcy5ncmFwaCk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICogVXNlZCB0byB1bmluc3RhbGwgcG9saWN5IGZvciB0aGlzIG5vZGVcbiAgICAqXG4gICAgKiBAcGFyYW0gICAgICB7UG9saWN5fHN0cmluZ30gIHBvbGljeVJlbW92ZSAgVGhlIHBvbGljeSB0byByZW1vdmVcbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAndW5pbnN0YWxsTm9kZVBvbGljeScsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gdW5pbnN0YWxsTm9kZVBvbGljeShwb2xpY3lSZW1vdmUpIHtcblx0XHRcdFx0dmFyIHBvbGljeVJlbW92ZU5hbWU7XG5cdFx0XHRcdHZhciB0aGlzTm9kZSA9IHRoaXM7XG5cdFx0XHRcdGlmICh0eXBlb2YgcG9saWN5UmVtb3ZlID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRcdHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmU7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZS5wb2xpY3lOYW1lO1xuXHRcdFx0XHR9XG5cdFx0XHRcdF8odGhpc05vZGUubm9kZVBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3ksIGluZGV4KSB7XG5cdFx0XHRcdFx0aWYgKHBvbGljeS5wb2xpY3lOYW1lID09PSBwb2xpY3lSZW1vdmVOYW1lKSB7XG5cdFx0XHRcdFx0XHRwb2xpY3kuZGVzdHJveSgpO1xuXHRcdFx0XHRcdFx0dGhpc05vZGUubm9kZVBvbGljaWVzLnNwbGljZShpbmRleCwgMSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdFx0aWYgKHRoaXNOb2RlLm5vZGVQb2xpY2llcy5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0XHR0aGlzTm9kZS5oYXNQb2xpY3kgPSBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqIENhbGxlZCB3aGVuIHRoZXJlIGlzIGEgbW91c2UgZXZlbnQgZm9yIHRoaXMgbm9kZVxuICAgICpcbiAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBldmVudCAgICAgVGhlIG1vdXNlIGV2ZW50XG4gICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgZCAgICAgICAgIFRoZSBtYXRjaGluZyBub2RlIG9iamVjdFxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdub2RlUG9saWN5RXZlbnQnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIG5vZGVQb2xpY3lFdmVudChldmVudCwgZDNub2RlLCBkKSB7XG5cdFx0XHRcdF8uZm9yRWFjaCh0aGlzLm5vZGVQb2xpY2llcywgZnVuY3Rpb24gKHBvbGljeSkge1xuXHRcdFx0XHRcdHBvbGljeVtldmVudF0oZDNub2RlLCBkKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fV0pO1xuXG5cdFx0cmV0dXJuIE5vZGU7XG5cdH0oKTtcblxuXHRyZXR1cm4ge1xuXHRcdE5vZGU6IE5vZGVcblx0fTtcbn1dKTtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG4vKipcbiAqIFRoZSBub2RlIHRoYXQgaXMgdXNlZCBzcGVjaWZpY2FsbHkgZm9yIHRoZSB2aXN1YWxpemF0aW9uIHRhYi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpLmZhY3RvcnkoJ1Zpc3VhbGl6ZXJOb2RlJywgWydOb2RlJywgZnVuY3Rpb24gKE5vZGUpIHtcblx0dmFyIFZpc3VhbGl6ZXJOb2RlID0gZnVuY3Rpb24gKF9Ob2RlJE5vZGUpIHtcblx0XHRfaW5oZXJpdHMoVmlzdWFsaXplck5vZGUsIF9Ob2RlJE5vZGUpO1xuXG5cdFx0LyoqXG4gICAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICpcbiAgICogQHBhcmFtICAgICAge251bWJlcn0gIHggICAgICAgXHR4IGxvY2F0aW9uXG4gICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB5ICAgICAgIFx0eSBsb2NhdGlvblxuICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgaWQgICAgICBcdFRoZSBpZGVudGlmaWVyXG4gICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICB0ZXh0ICAgIFx0VGhlIHRleHQgdG8gZGlzcGxheVxuICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgcmFkaXVzICBcdFRoZSByYWRpdXMgb2YgdGhlIG5vZGVcbiAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHBhcmVudCAgICAgVGhlIHBhcmVudCBpZFxuICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgYW5jZXN0b3JzICBBcnJheSBvZiBhbmNlc3RvcnMgSWRcbiAgICogQHBhcmFtICAgICAge251bWJlcn0gIHhTdGFydCAgICAgeCBsb2MgdG8gc3RhcnQgYW5pbWF0aW9uXG4gICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB5U3RhcnQgICAgIHkgbG9jIHRvIHN0YXJ0IGFuaW1hdGlvblxuICAgKi9cblx0XHRmdW5jdGlvbiBWaXN1YWxpemVyTm9kZSh4LCB5LCBpZCwgdGV4dCwgcmFkaXVzLCBwYXJlbnQsIGFuY2VzdG9ycywgeFN0YXJ0LCB5U3RhcnQpIHtcblx0XHRcdF9jbGFzc0NhbGxDaGVjayh0aGlzLCBWaXN1YWxpemVyTm9kZSk7XG5cblx0XHRcdHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChWaXN1YWxpemVyTm9kZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFZpc3VhbGl6ZXJOb2RlKSkuY2FsbCh0aGlzLCB4LCB5LCBpZCwgdGV4dCwgcmFkaXVzKSk7XG5cblx0XHRcdF90aGlzLnBhcmVudCA9IHBhcmVudDtcblx0XHRcdF90aGlzLmFuY2VzdG9ycyA9IGFuY2VzdG9ycztcblx0XHRcdGlmICh4U3RhcnQgPT0gbnVsbCkge1xuXHRcdFx0XHRfdGhpcy54U3RhcnQgPSB4O1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0X3RoaXMueFN0YXJ0ID0geFN0YXJ0O1xuXHRcdFx0fVxuXHRcdFx0aWYgKHlTdGFydCA9PSBudWxsKSB7XG5cdFx0XHRcdF90aGlzLnlTdGFydCA9IHk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRfdGhpcy55U3RhcnQgPSB5U3RhcnQ7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gX3RoaXM7XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqIENhbGxlZCBkdXJpbmcgdGhlIGZpcnN0IHVwZGF0ZSBncmFwaCBmb3IgYSBub2RlXG4gICAqXG4gICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICogQHBhcmFtICAgICAge05vZGV9ICAgIGQgICAgICAgICBUaGUgbWF0Y2hpbmcgTm9kZVxuICAgKi9cblxuXG5cdFx0X2NyZWF0ZUNsYXNzKFZpc3VhbGl6ZXJOb2RlLCBbe1xuXHRcdFx0a2V5OiAnbmV3Tm9kZUF0dHInLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIG5ld05vZGVBdHRyKGQzbm9kZSwgZCkge1xuXHRcdFx0XHR2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaDtcblx0XHRcdFx0aWYgKHRoaXNHcmFwaC5jb25zdHMuY29udGFpbmVyQ2xhc3MgIT0gbnVsbCAmJiB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbZC5pZF0gPT0gbnVsbCkge1xuXHRcdFx0XHRcdGQzbm9kZS5jbGFzc2VkKHRoaXNHcmFwaC5jb25zdHMuY29udGFpbmVyQ2xhc3MsIHRydWUpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGQzbm9kZS50cmFuc2l0aW9uKFwibm9kZVBvc2l0aW9uVHJhbnNpdGlvblwiKS5kdXJhdGlvbig3NTApLmF0dHJUd2VlbihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbiAoZCkge1xuXHRcdFx0XHRcdGlmIChkLnhTdGFydCAhPSBudWxsICYmIGQueVN0YXJ0ICE9IG51bGwpIHtcblx0XHRcdFx0XHRcdHZhciB4U3RhcnQgPSBkLnhTdGFydDtcblx0XHRcdFx0XHRcdHZhciB5U3RhcnQgPSBkLnlTdGFydDtcblx0XHRcdFx0XHRcdGQueFN0YXJ0ID0gZC54O1xuXHRcdFx0XHRcdFx0ZC55U3RhcnQgPSBkLnk7XG5cdFx0XHRcdFx0XHRyZXR1cm4gZDMuaW50ZXJwb2xhdGVTdHJpbmcoXCJ0cmFuc2xhdGUoXCIgKyB4U3RhcnQgKyBcIixcIiArIHlTdGFydCArIFwiKVwiLCBcInRyYW5zbGF0ZShcIiArIGQueCArIFwiLFwiICsgZC55ICsgXCIpXCIpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm4gZDMuaW50ZXJwb2xhdGVTdHJpbmcoXCJ0cmFuc2xhdGUoXCIgKyBkLnggKyBcIixcIiArIGQueSArIFwiKVwiLCBcInRyYW5zbGF0ZShcIiArIGQueCArIFwiLFwiICsgZC55ICsgXCIpXCIpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XSk7XG5cblx0XHRyZXR1cm4gVmlzdWFsaXplck5vZGU7XG5cdH0oTm9kZS5Ob2RlKTtcblxuXHRyZXR1cm4ge1xuXHRcdE5vZGU6IFZpc3VhbGl6ZXJOb2RlXG5cdH07XG59XSk7XG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KG9iamVjdCwgcHJvcGVydHksIHJlY2VpdmVyKSB7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyByZXR1cm4gZ2V0KHBhcmVudCwgcHJvcGVydHksIHJlY2VpdmVyKTsgfSB9IGVsc2UgaWYgKFwidmFsdWVcIiBpbiBkZXNjKSB7IHJldHVybiBkZXNjLnZhbHVlOyB9IGVsc2UgeyB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7IGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7IH0gfTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG4vKipcbiAqIFRoaXMgcG9saWN5IGlzIHVzZWQgdG8gYWRkIGEgc2VsZWN0IG5vZGUgZmVhdHVyZS5cbiAqIFN1cHBvcnRzIHNlbGVjdGluZyBtdWx0aXBsZSBub2RlcyBieSB1c2luZyB0aGUgY3RybCBrZXkuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdOb2RlU2VsZWN0aW9uUG9saWN5JywgWydQb2xpY3knLCBmdW5jdGlvbiAoUG9saWN5KSB7XG4gICAgdmFyIE5vZGVTZWxlY3Rpb25Qb2xpY3kgPSBmdW5jdGlvbiAoX1BvbGljeSRQb2xpY3kpIHtcbiAgICAgICAgX2luaGVyaXRzKE5vZGVTZWxlY3Rpb25Qb2xpY3ksIF9Qb2xpY3kkUG9saWN5KTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gTm9kZVNlbGVjdGlvblBvbGljeSgpIHtcbiAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBOb2RlU2VsZWN0aW9uUG9saWN5KTtcblxuICAgICAgICAgICAgcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChOb2RlU2VsZWN0aW9uUG9saWN5Ll9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTm9kZVNlbGVjdGlvblBvbGljeSkpLmNhbGwodGhpcywgXCJOb2RlU2VsZWN0aW9uUG9saWN5XCIpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYWxsZWQgd2hlbiBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAqIE92ZXJ3cml0ZXMgdGhlIG9uIGRyYWcgZXZlbnQgb2YgdGhlIGdyYXBoXG4gICAgICAgICAqIFxuICAgICAgICAgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaCBpdCBpcyBcbiAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbGxlZCBvblxuICAgICAgICAqL1xuXG5cbiAgICAgICAgX2NyZWF0ZUNsYXNzKE5vZGVTZWxlY3Rpb25Qb2xpY3ksIFt7XG4gICAgICAgICAgICBrZXk6ICdpbml0aWFsaXplJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0aWFsaXplKGdyYXBoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfZ2V0KE5vZGVTZWxlY3Rpb25Qb2xpY3kucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTm9kZVNlbGVjdGlvblBvbGljeS5wcm90b3R5cGUpLCAnaW5pdGlhbGl6ZScsIHRoaXMpLmNhbGwodGhpcywgZ3JhcGgpO1xuICAgICAgICAgICAgICAgIHZhciBzdGF0ZSA9IGdyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zZWxlY3RlZE5vZGVzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIGNvbnN0cyA9IGdyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgY29uc3RzLnNlbGVjdGVkQ2xhc3MgPSBcInNlbGVjdGVkXCI7XG4gICAgICAgICAgICAgICAgLy9vdmVyd3JpdHRpbmcgZ3JhcGgncyBub2RlIG9uIGRyYWcgZXZlbnQgdG8gc3VwcG9ydFxuICAgICAgICAgICAgICAgIC8vbW92aW5nIG11bHRpcGxlIG5vZGVzIGF0IG9uY2VcbiAgICAgICAgICAgICAgICB2YXIgZHJhZyA9IGdyYXBoLmRyYWc7XG4gICAgICAgICAgICAgICAgZHJhZy5vbignZHJhZycsIGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSBncmFwaDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWRDbGFzcyA9IHRoaXNHcmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeS5zZWxlY3RlZENsYXNzO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGVjdGlvbiA9IGQzLnNlbGVjdEFsbCgnLicgKyBzZWxlY3RlZENsYXNzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGlvblswXS5pbmRleE9mKHRoaXMpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uLmNsYXNzZWQoc2VsZWN0ZWRDbGFzcywgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGlvbiA9IGQzLnNlbGVjdCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb24uY2xhc3NlZChzZWxlY3RlZENsYXNzLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZnVuY3Rpb24gKGQsIGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnggKz0gZDMuZXZlbnQuZHg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55ICs9IGQzLmV2ZW50LmR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcInRyYW5zbGF0ZShcIiArIFtkLngsIGQueV0gKyBcIilcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBBZGRzIHRoZSBnaXZlbiBub2RlIHRvIHRoZSBhcnJheSBvZiBzZWxlY3RlZCBub2Rlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzTm9kZSAgICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgbm9kZURhdGEgIE1hdGNoaW5nIE5vZGUgb2JqZWN0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdhZGRTZWxlY3ROb2RlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRTZWxlY3ROb2RlKGQzTm9kZSwgbm9kZURhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgZDNOb2RlLmNsYXNzZWQoY29uc3RzLnNlbGVjdGVkQ2xhc3MsIHRydWUpO1xuICAgICAgICAgICAgICAgIHN0YXRlLnNlbGVjdGVkTm9kZXMucHVzaChub2RlRGF0YSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyB0aGUgZ2l2ZW4gbm9kZSBmcm9tIHRoZSBhcnJheSBvZiBzZWxlY3RlZCBub2Rlcy5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM05vZGUgICAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgIG5vZGVEYXRhICBNYXRjaGluZyBub2RlIG9iamVjdCBcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3JlbW92ZVNlbGVjdEZyb21Ob2RlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVTZWxlY3RGcm9tTm9kZShkM05vZGUsIG5vZGVEYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmZpbHRlcihmdW5jdGlvbiAoY2QpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNkLmlkID09PSBub2RlRGF0YS5pZDtcbiAgICAgICAgICAgICAgICB9KS5jbGFzc2VkKGNvbnN0cy5zZWxlY3RlZENsYXNzLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gc3RhdGUuc2VsZWN0ZWROb2Rlcy5pbmRleE9mKG5vZGVEYXRhKTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zZWxlY3RlZE5vZGVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyBhbGwgc2VsZWN0ZWQgbm9kZXMuXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdyZW1vdmVBbGxTZWxlY3RlZE5vZGVzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVBbGxTZWxlY3RlZE5vZGVzKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzLk5vZGVTZWxlY3Rpb25Qb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5jbGFzc2VkKGNvbnN0cy5zZWxlY3RlZENsYXNzLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgc3RhdGUuc2VsZWN0ZWROb2RlcyA9IFtdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIE9uIE1vdXNlZG93biwgZGV0ZXJtaW5lcyB3aGV0aGVyIHRvIGNoYW5nZSB0aGVcbiAgICAgICAgICAgICAqIHNlbGVjdGVkIHN0YXR1cyBvZiB0aGUgY2xpY2tlZCBub2RlLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgIGQgICAgICAgTWF0Y2hpbmcgTm9kZSBPYmplY3QgICAgICAgXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdtb3VzZWRvd24nLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdXNlZG93bihkM25vZGUsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeTtcbiAgICAgICAgICAgICAgICBkMy5ldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICBpZiAoZDMuZXZlbnQuY3RybEtleSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuc2VsZWN0ZWROb2Rlcy5pbmRleE9mKGQpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlU2VsZWN0RnJvbU5vZGUoZDNub2RlLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkU2VsZWN0Tm9kZShkM25vZGUsIGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdGF0ZS5zZWxlY3RlZE5vZGVzLmluZGV4T2YoZCkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9pZiBubyBjb250cm9sIGtleSwgYW5kIGNsaWNrZWQgbm90IHNlbGVjdGVkIG5vZGUsXG4gICAgICAgICAgICAgICAgICAgIC8vcmVtb3ZlIGFsbCBvZiBjdXJyZW50IHNlbGVjdGlvblxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUFsbFNlbGVjdGVkTm9kZXMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogT24gTW91c2V1cCwgZGV0ZXJtaW5lcyB3aGV0aGVyIHRvIGNoYW5nZSB0aGVcbiAgICAgICAgICAgICAqIHNlbGVjdGVkIHN0YXR1cyBvZiB0aGUgY2xpY2tlZCBub2RlLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgIGQgICAgICAgTWF0Y2hpbmcgTm9kZSBPYmplY3RcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ21vdXNldXAnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdXNldXAoZDNub2RlLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3k7XG4gICAgICAgICAgICAgICAgaWYgKCFkMy5ldmVudC5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgbGVuZ3RoIGlzIGdyZWF0ZXIgdGhhbiAxLCB0aGVuIHdlIGFyZSBtb3ZpbmcgbXVsdGlwbGUgbm9kZXNcbiAgICAgICAgICAgICAgICAgICAgLy9sZWF2ZSB0aGVtIGFsbCBoaWdobGlnaHRlZFxuICAgICAgICAgICAgICAgICAgICAvL290aGVyd2lzZSB3ZSBhcmUganVzdCBtb3Zpbmcgb25lIG5vZGUsIHNvIHVuaGlnaGxpZ2h0XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5zZWxlY3RlZE5vZGVzLmxlbmd0aCA8PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVNlbGVjdEZyb21Ob2RlKGQzbm9kZSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1dKTtcblxuICAgICAgICByZXR1cm4gTm9kZVNlbGVjdGlvblBvbGljeTtcbiAgICB9KFBvbGljeS5Qb2xpY3kpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgUG9saWN5OiBOb2RlU2VsZWN0aW9uUG9saWN5XG4gICAgfTtcbn1dKTtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG4vKipcbiAqIFRoaXMgcG9saWN5IGNoYW5nZXMgdGhlIHZpZXcgdG8gdGhlIHRpbWVncmFwaCBvZiBsaW5rIGRhdGEgb24gY2xpY2suXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdQYXRoQ2hhbmdlVmlld1BvbGljeScsIFsnUG9saWN5JywgZnVuY3Rpb24gKFBvbGljeSkge1xuICAgIHZhciBQYXRoQ2hhbmdlVmlld1BvbGljeSA9IGZ1bmN0aW9uIChfUG9saWN5JFBvbGljeSkge1xuICAgICAgICBfaW5oZXJpdHMoUGF0aENoYW5nZVZpZXdQb2xpY3ksIF9Qb2xpY3kkUG9saWN5KTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2FsbGVkIHRvIGJ1aWxkIHBvbGljeVxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gICB7QW5ndWxhciBTdGF0ZX0gICAgJHN0YXRlICAgIFVzZWQgdG8gY2hhbmdlIHZpZXdcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIFBhdGhDaGFuZ2VWaWV3UG9saWN5KCRzdGF0ZSkge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFBhdGhDaGFuZ2VWaWV3UG9saWN5KTtcblxuICAgICAgICAgICAgdmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKFBhdGhDaGFuZ2VWaWV3UG9saWN5Ll9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoUGF0aENoYW5nZVZpZXdQb2xpY3kpKS5jYWxsKHRoaXMsICdQYXRoQ2hhbmdlVmlld1BvbGljeScpKTtcblxuICAgICAgICAgICAgX3RoaXMuJHN0YXRlID0gJHN0YXRlO1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdlbmVyYXRlcyBhIGxpc3Qgb2YgYWxsIGNoaWxkIGNvbnRhaW5lcnMgb2YgdGhlIHNlcnZpY2VcbiAgICAgICAgICogQ2FuIGhhbmRsZSBuZXN0ZWQgc2VydmljZXMuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBpZCAgICAgIE5vZGUgSURcbiAgICAgICAgICovXG5cblxuICAgICAgICBfY3JlYXRlQ2xhc3MoUGF0aENoYW5nZVZpZXdQb2xpY3ksIFt7XG4gICAgICAgICAgICBrZXk6ICdnZW5lcmF0ZUxpc3QnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdlbmVyYXRlTGlzdChpZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgcmV0TGlzdCA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBnZW5lcmF0ZUxpc3RIZWxwZXIgPSBmdW5jdGlvbiBnZW5lcmF0ZUxpc3RIZWxwZXIoaWQsIHJldExpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVJZHMgPSB0aGlzUG9saWN5LmdyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0W2lkXTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2RlSWRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGRJZCA9IG5vZGVJZHNbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpc1BvbGljeS5ncmFwaC5kYXRhU291cmNlLmhhc0NoaWxkKGNoaWxkSWQpID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlJldExpc3QgPSBnZW5lcmF0ZUxpc3RIZWxwZXIoY2hpbGRJZCwgcmV0TGlzdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0TGlzdC5jb25jYXQoc3ViUmV0TGlzdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldExpc3QucHVzaChjaGlsZElkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgZ2VuZXJhdGVMaXN0SGVscGVyKGlkLCByZXRMaXN0KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmV0TGlzdDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIHJlcm91dGUgYW4gZWRnZSB3aGVuIGNsaWNrZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7TGlua30gIGVkZ2UgICAgVGhlIGNsaWNrZWQgZWRnZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAndmlld0VkZ2UnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZpZXdFZGdlKGVkZ2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgc291cmNlTGlzdCA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciB0YXJnZXRMaXN0ID0gW107XG4gICAgICAgICAgICAgICAgdmFyIHNvdXJjZUlkID0gZWRnZS5zb3VyY2UuaWQ7XG4gICAgICAgICAgICAgICAgdmFyIHRhcmdldElkID0gZWRnZS50YXJnZXQuaWQ7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ncmFwaC5kYXRhU291cmNlLmhhc0NoaWxkKHNvdXJjZUlkKSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAvL05vdCBhIGNvbnRhaW5lciBub2RlLCBuZWVkIHRvIGFnZ3JlZ2F0ZVxuICAgICAgICAgICAgICAgICAgICBzb3VyY2VMaXN0ID0gdGhpcy5nZW5lcmF0ZUxpc3Qoc291cmNlSWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZUxpc3QgPSBbc291cmNlSWRdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmdyYXBoLmRhdGFTb3VyY2UuaGFzQ2hpbGQodGFyZ2V0SWQpID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vTm90IGEgY29udGFpbmVyIG5vZGUsIG5lZWQgdG8gYWdncmVnYXRlXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldExpc3QgPSB0aGlzLmdlbmVyYXRlTGlzdCh0YXJnZXRJZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TGlzdCA9IFt0YXJnZXRJZF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuJHN0YXRlLmdvKCdjb250aXYubWVudS52aXN1YWxpemF0aW9uLmVkZ2UnLCB7IHNvdXJjZU5hbWU6IHNvdXJjZUlkLCB0YXJnZXROYW1lOiB0YXJnZXRJZCxcbiAgICAgICAgICAgICAgICAgICAgc291cmNlTGlzdDogc291cmNlTGlzdCwgdGFyZ2V0TGlzdDogdGFyZ2V0TGlzdCB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnbW91c2Vkb3duJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtb3VzZWRvd24oZDNwYXRoLCBkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52aWV3RWRnZShkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfV0pO1xuXG4gICAgICAgIHJldHVybiBQYXRoQ2hhbmdlVmlld1BvbGljeTtcbiAgICB9KFBvbGljeS5Qb2xpY3kpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgUG9saWN5OiBQYXRoQ2hhbmdlVmlld1BvbGljeVxuICAgIH07XG59XSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuYXBwbGljYXRpb25ncm91cHMnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzJywge1xuICAgICAgICAgICAgdXJsOiAnL2FwcGxpY2F0aW9uZ3JvdXBzJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbi8qKlxuICogQmFzZSBwb2xpY3kgY2xhc3MgZm9yIHRoZSBncmFwaCBvYmplY3RcbiAqIFxuICogUG9saWNpZXMgYXJlIHVzZWQgdG8gaXNvbGF0ZSBmZWF0dXJlcyBmb3IgYSBncmFwaC5cbiAqIFBvbGljaWVzIGNhbiBiZSBpbnN0YWxsZWQgb24gbm9kZXMsIGxpbmtzLCBvciB0aGUgZ3JhcGguXG4gKiBFYWNoIHBvbGljeSBoYXMgaW50ZXJhY3Rpb24gaGFuZGxlcnMgdGhhdCB3aWxsIGJlIGNhbGxlZCBieSB0aGUgZ3JhcGhcbiAqIGlmIGluc3RhbGxlZC4gUG9saWNpZXMgY2FuIGFsc28gbW9kaWZ5IGdyYXBoIGZ1bmN0aW9ucyAoc2VlIFFUaXBQb2xpY3kpLlxuICogTXVsdGlwbGUgcG9saWNpZXMgY2FuIGJlIGluc3RhbGxlZCBmb3IgYSBub2RlIG9yIGxpbmsuIFxuICogXG4gKiBUbyB3cml0ZSB5b3VyIG93biBwb2xpY3ksIGNyZWF0ZSBhIG5ldyBmYWN0b3J5IHRoYXQgdXNlcyB0aGUgcG9saWN5XG4gKiB5b3Ugd2FudCB0byBpbmhlcml0IGFzIGEgZGVwZW5kZW5jeSwgYW5kIGV4dGVuZCBpdHMgcG9saWN5LiBcbiAqIFJldHVybiB0aGUgY2xhc3Mgb2JqZWN0IHdpdGggUG9saWN5IGFzIGtleSwgYW5kIFxuICogYWRkIHRoZSBwb2xpY3kgdG8gdGhlIFBvbGljeVNlcnZpY2UgZmFjdG9yeS5cbiAqIFxuICogRm9yIHNhdmluZyBzdGF0ZSBvciBjb25zdHMgZm9yIHRoZSBwb2xpY3ksIGNyZWF0ZSBhIG5hbWVzcGFjZVxuICogaW4gZ3JhcGguc3RhdGUgYW5kIGdyYXBoLmNvbnN0cy5cbiAqIEV4LiBcbiAqICAgICAgZ3JhcGguc3RhdGUubXlQb2xpY3kgPSB7fTtcbiAqICAgICAgZ3JhcGguY29uc3RzLm15UG9saWN5ID0ge307XG4gKiAgICAgIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnUG9saWN5JywgW2Z1bmN0aW9uICgpIHtcbiAgdmFyIFBvbGljeSA9IGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgcG9saWN5TmFtZSAgVGhlIHBvbGljeSBuYW1lXG4gICAgICovXG4gICAgZnVuY3Rpb24gUG9saWN5KHBvbGljeU5hbWUpIHtcbiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQb2xpY3kpO1xuXG4gICAgICB0aGlzLnBvbGljeU5hbWUgPSBwb2xpY3lOYW1lO1xuICAgICAgdGhpcy5ncmFwaCA9IG51bGw7XG4gICAgICB0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHdoZW4gdGhlIHBvbGljeSBpcyBpbnN0YWxsZWQuXG4gICAgICogXG4gICAgICogQHBhcmFtICB7R3JhcGh9ICBncmFwaCAgIFRoZSBHcmFwaCB0aGF0IHRoZSBwb2xpY3kgaXNcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgYmVpbmcgaW5zdGFsbGVkIG9uXG4gICAgICovXG5cblxuICAgIF9jcmVhdGVDbGFzcyhQb2xpY3ksIFt7XG4gICAgICBrZXk6ICdpbml0aWFsaXplJyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0aWFsaXplKGdyYXBoKSB7XG4gICAgICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLmdyYXBoID0gZ3JhcGg7XG4gICAgICB9XG5cbiAgICAgIC8qKlxuICAgICAgICogSGFuZGxlciwgbWVhbnQgdG8gYmUgb3ZlcnJpZGRlbiBpbiBzdWJjbGFzc2VzXG4gICAgICAgKlxuICAgICAgICogQHBhcmFtICB7ZDMgb2JqZWN0fSAgICBkM29iaiAgICBUaGUgZDNvYmplY3RcbiAgICAgICAqIEBwYXJhbSAge05vZGUvTGluay9HcmFwaH0gIGQgICBUaGUgb2JqZWN0IGl0IHdhc1xuICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbGxlZCBmb3IuICAgIFxuICAgICAgICovXG5cbiAgICB9LCB7XG4gICAgICBrZXk6ICdtb3VzZW92ZXInLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdXNlb3ZlcihkM29iaiwgZCkge31cbiAgICB9LCB7XG4gICAgICBrZXk6ICdkYmxjbGljaycsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gZGJsY2xpY2soZDNvYmosIGQpIHt9XG4gICAgfSwge1xuICAgICAga2V5OiAnY29udGV4dG1lbnUnLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNvbnRleHRtZW51KGQzb2JqLCBkKSB7fVxuICAgIH0sIHtcbiAgICAgIGtleTogJ21vdXNlb3V0JyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBtb3VzZW91dChkM29iaiwgZCkge31cbiAgICB9LCB7XG4gICAgICBrZXk6ICdtb3VzZWRvd24nLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdXNlZG93bihkM29iaiwgZCkge31cbiAgICB9LCB7XG4gICAgICBrZXk6ICdtb3VzZXVwJyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBtb3VzZXVwKGQzb2JqLCBkKSB7fVxuXG4gICAgICAvKipcbiAgICAgICAqIFdpbGwgYmUgY2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIGJlaW5nIGRlc3Ryb3llZC5cbiAgICAgICAqIFVzZWQgdG8gcmVtb3ZlIGFueSBlbGVtZW50cyBvciBiaW5kaW5ncyB0aGUgcG9saWN5XG4gICAgICAgKiBoYXMgYWRkZWQuXG4gICAgICAgKi9cblxuICAgIH0sIHtcbiAgICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7fVxuICAgIH1dKTtcblxuICAgIHJldHVybiBQb2xpY3k7XG4gIH0oKTtcblxuICByZXR1cm4ge1xuICAgIFBvbGljeTogUG9saWN5XG4gIH07XG59XSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZGFzaGJvYXJkJywgWydjb250aXYubW9kZWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmRhc2hib2FyZCcsIHtcbiAgICAgICAgICAgIHVybDogJy9kYXNoYm9hcmQnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnZGFzaGJvYXJkJ1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4ndXNlIHN0cmljdCc7XG5cbi8qKlxuICogQ29udGFpbnMgYWxsIHRoZSBwb2xpY2llcy5cbiAqIFNlZSBwb2xpY3kuanMgZm9yIGluZm8gb24gaG93IHBvbGljaWVzIHdvcmsuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdQb2xpY3lTZXJ2aWNlJywgWydQb2xpY3knLCAnUVRpcFBvbGljeScsICdQYXRoQ2hhbmdlVmlld1BvbGljeScsICdOb2RlU2VsZWN0aW9uUG9saWN5JywgJ1NwbGl0Sm9pbk5vZGVQb2xpY3knLCAnU3BsaXRKb2luVmlld1BvbGljeScsICdTYXZlU3RhdGVQb2xpY3knLCBmdW5jdGlvbiAoUG9saWN5LCBRVGlwUG9saWN5LCBQYXRoQ2hhbmdlVmlld1BvbGljeSwgTm9kZVNlbGVjdGlvblBvbGljeSwgU3BsaXRKb2luTm9kZVBvbGljeSwgU3BsaXRKb2luVmlld1BvbGljeSwgU2F2ZVN0YXRlUG9saWN5KSB7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBQb2xpY3k6IFBvbGljeS5Qb2xpY3ksXG4gICAgICAgIFFUaXBQb2xpY3k6IFFUaXBQb2xpY3kuUG9saWN5LFxuICAgICAgICBQYXRoQ2hhbmdlVmlld1BvbGljeTogUGF0aENoYW5nZVZpZXdQb2xpY3kuUG9saWN5LFxuICAgICAgICBOb2RlU2VsZWN0aW9uUG9saWN5OiBOb2RlU2VsZWN0aW9uUG9saWN5LlBvbGljeSxcbiAgICAgICAgU3BsaXRKb2luTm9kZVBvbGljeTogU3BsaXRKb2luTm9kZVBvbGljeS5Qb2xpY3ksXG4gICAgICAgIFNwbGl0Sm9pblZpZXdQb2xpY3k6IFNwbGl0Sm9pblZpZXdQb2xpY3kuUG9saWN5LFxuICAgICAgICBTYXZlU3RhdGVQb2xpY3k6IFNhdmVTdGF0ZVBvbGljeS5Qb2xpY3lcbiAgICB9O1xufV0pO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE5LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmxvZ2luJywgWydjb250aXYudXRpbHMnXSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KG9iamVjdCwgcHJvcGVydHksIHJlY2VpdmVyKSB7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyByZXR1cm4gZ2V0KHBhcmVudCwgcHJvcGVydHksIHJlY2VpdmVyKTsgfSB9IGVsc2UgaWYgKFwidmFsdWVcIiBpbiBkZXNjKSB7IHJldHVybiBkZXNjLnZhbHVlOyB9IGVsc2UgeyB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7IGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7IH0gfTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG4vKipcbiAqIFRoaXMgcG9saWN5IGFkZHMgdG9vbHRpcCBmdW5jdGlvbmFsaXR5IHRvIG5vZGVzIGFuZCBsaW5rcy5cbiAqIFdoZW4gaW5zdGFsbGluZywgaW5zdGFsbCBvbiBib3RoIGxpbmtzIGFuZCBub2Rlcy5cbiAqIFxuICogVXNlcyB0aGUgcVRpcCBqUXVlcnkgcGx1Z2luXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdRVGlwUG9saWN5JywgWydQb2xpY3knLCBmdW5jdGlvbiAoUG9saWN5KSB7XG4gICAgdmFyIFFUaXBQb2xpY3kgPSBmdW5jdGlvbiAoX1BvbGljeSRQb2xpY3kpIHtcbiAgICAgICAgX2luaGVyaXRzKFFUaXBQb2xpY3ksIF9Qb2xpY3kkUG9saWN5KTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gUVRpcFBvbGljeSgpIHtcbiAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBRVGlwUG9saWN5KTtcblxuICAgICAgICAgICAgcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChRVGlwUG9saWN5Ll9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoUVRpcFBvbGljeSkpLmNhbGwodGhpcywgXCJRVGlwUG9saWN5XCIpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgcG9saWN5IGlzIGluc3RhbGxlZFxuICAgICAgICAgKiBNb2RpZmllcyB0aGUgdXBkYXRlTmV3Tm9kZXMgYW5kIFxuICAgICAgICAgKiB1cGRhdGVOZXdQYXRocyBtZXRob2Qgb2YgdGhlIGdyYXBoIHRvIGluc3RhbGwgcXRpcFxuICAgICAgICAgKiBvbnRvIGVhY2ggbm9kZSBhbmQgcGF0aC5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgXG4gICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFsbGVkIG9uXG4gICAgICAgICAqL1xuXG5cbiAgICAgICAgX2NyZWF0ZUNsYXNzKFFUaXBQb2xpY3ksIFt7XG4gICAgICAgICAgICBrZXk6ICdpbml0aWFsaXplJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0aWFsaXplKGdyYXBoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfZ2V0KFFUaXBQb2xpY3kucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoUVRpcFBvbGljeS5wcm90b3R5cGUpLCAnaW5pdGlhbGl6ZScsIHRoaXMpLmNhbGwodGhpcywgZ3JhcGgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBzdGF0ZSA9IGdyYXBoLnN0YXRlLlFUaXBQb2xpY3kgPSB7fTtcblxuICAgICAgICAgICAgICAgIHN0YXRlLm1vdXNlZG93biA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgZ3JhcGguY29uc3RzLlFUaXBQb2xpY3kgPSB7fTtcblxuICAgICAgICAgICAgICAgIC8vVHJhY2tpbmcgbW91c2UgY2xpY2sgc3RhdGUgdG8gbWFrZSB0b29sdGlwXG4gICAgICAgICAgICAgICAgLy9kaXNhcHBlYXIgaWYgdGhlIG5vZGUgaXMgYmVpbmcgZHJhZ2dlZC5cbiAgICAgICAgICAgICAgICAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLm1vdXNldXAoZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUubW91c2V1cCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy9vdmVycmlkZSB1cGRhdGVOZXdOb2RlcyBhbmQgdXBkYXRlTmV3UGF0aHNcbiAgICAgICAgICAgICAgICAvL3RvIGluc3RhbGwgcXRpcFxuICAgICAgICAgICAgICAgIHZhciBncmFwaFVwZGF0ZU5ld05vZGVzID0gZ3JhcGgudXBkYXRlTmV3Tm9kZXM7XG4gICAgICAgICAgICAgICAgZ3JhcGgudXBkYXRlTmV3Tm9kZXMgPSBmdW5jdGlvbiAobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGhVcGRhdGVOZXdOb2Rlcy5jYWxsKGdyYXBoLCBuZXdOb2Rlcyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kudXBkYXRlTmV3Tm9kZXMobmV3Tm9kZXMpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB2YXIgZ3JhcGhVcGRhdGVOZXdQYXRocyA9IGdyYXBoLnVwZGF0ZU5ld1BhdGhzO1xuICAgICAgICAgICAgICAgIGdyYXBoLnVwZGF0ZU5ld1BhdGhzID0gZnVuY3Rpb24gKG5ld1BhdGhzKSB7XG4gICAgICAgICAgICAgICAgICAgIGdyYXBoVXBkYXRlTmV3UGF0aHMuY2FsbChncmFwaCwgbmV3UGF0aHMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnVwZGF0ZU5ld1BhdGhzKG5ld1BhdGhzKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJlbW92ZXMgYWxsIHFUaXBzIGZyb20gdGhlIERPTS5cbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBwb2xpY3kgaXMgdW5pbnN0YWxsZWQgb3JcbiAgICAgICAgICAgICAqIHRoZSBncmFwaCBpcyBkZXN0cm95ZWQuXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkZXN0cm95JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICAgICAgICAgIC8vcmVtb3ZpbmcgYWxsIHF0aXAgZnJvbSBET01cbiAgICAgICAgICAgICAgICAkKCdbaWRePVwicXRpcFwiXScpLnJlbW92ZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEtlZXBpbmcgdHJhY2sgb2YgbW91c2Vkb3duIHN0YXRlXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzT2JqZWN0fSAgZDNvYmogIFRoZSBkMyBwYmplY3RcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlL0xpbmt9ICBkICAgICBUaGUgbWF0Y2hpbmcgZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ21vdXNlZG93bicsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbW91c2Vkb3duKGQzb2JqLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlFUaXBQb2xpY3k7XG4gICAgICAgICAgICAgICAgc3RhdGUubW91c2Vkb3duID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBLZWVwaW5nIHRyYWNrIG9mIG1vdXNlZG93biBzdGF0ZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM09iamVjdH0gIGQzb2JqICBUaGUgZDMgcGJqZWN0XG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZS9MaW5rfSAgZCAgICAgVGhlIG1hdGNoaW5nIGRhdGEgb2JqZWN0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdtb3VzZXVwJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtb3VzZXVwKGQzb2JqLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlFUaXBQb2xpY3k7XG4gICAgICAgICAgICAgICAgc3RhdGUubW91c2Vkb3duID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3doZW5RVGlwQXZhaWxhYmxlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB3aGVuUVRpcEF2YWlsYWJsZShjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgaW50ZXJ2YWwgPSA1MDA7IC8vIG1zXG4gICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJChkb2N1bWVudCkucXRpcCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQodGhpc1BvbGljeS53aGVuUVRpcEF2YWlsYWJsZShjYWxsYmFjayksIGludGVydmFsKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIGludGVydmFsKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiBOZXcgTm9kZXMgYXJlIGFkZGVkIGR1cmluZyB0aGVcbiAgICAgICAgICAgICAqIHVwZGF0ZSBncmFwaCBmdW5jdGlvblxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM05vZGV9ICBuZXdOb2RlcyAgVGhlIG5ldyBub2RlcyB0aGF0IGFyZVxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZWluZyBhZGRlZCB0byB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3VwZGF0ZU5ld05vZGVzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVOZXdOb2RlcyhuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5RVGlwUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gYXR0YWNoUVRpcCgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9hdHRhY2hpbmcgcXRpcFxuICAgICAgICAgICAgICAgICAgICBuZXdOb2Rlcy5lYWNoKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGhpc05vZGUgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy9JZiBub2RlIGhhcyBjaGlsZHJlbiwgdGhlbiBpdCBpcyBhIHNlcnZpY2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbZC5pZF0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSBcIjxiPjx1PlNlbGVjdG9yczo8L2I+PC91PiBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0b3JNYXAgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5zZWxlY3RvcnNbZC5pZF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhhc0tleXMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gc2VsZWN0b3JNYXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzS2V5cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0ga2V5ICsgXCIgOiA8aT5cIiArIHNlbGVjdG9yTWFwW2tleV0gKyBcIjwvaT4sXFxuIFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFzS2V5cyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb21tYSB3aWxsIGJlIHJlbW92ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IFwiTm8gU2VsZWN0b3JzLCBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSBcIjxiPjx1PkxhYmVsczo8L2I+PC91PiBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGFiZWxzTWFwID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UubGFiZWxzW2QuaWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoYXNLZXlzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGxhYmVsc01hcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNLZXlzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSBrZXkgKyBcIiA6IDxpPlwiICsgbGFiZWxzTWFwW2tleV0gKyBcIjwvaT4sXFxuIFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFzS2V5cyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb21tYSB3aWxsIGJlIHJlbW92ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IFwiTm8gbGFiZWxzLCBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3JlbW92ZSBsYXN0IGNvbW1hXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gdGV4dC5zbGljZSgwLCAtMik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpc05vZGUpLnF0aXAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGQuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRleHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93OiBmdW5jdGlvbiBzaG93KCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFwaSA9ICQodGhpc05vZGUpLnF0aXAoJ2FwaScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9ICQoJyNncmFwaENvbnRhaW5lcicpLm9mZnNldCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvc2l0aW9uID0gW29mZnNldC5sZWZ0ICsgKGQueCAqIHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCkgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKVswXSksIG9mZnNldC50b3AgKyAoZC55ICsgZC5yYWRpdXMpICogdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKSArIHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpWzFdXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwaS5zZXQoJ3Bvc2l0aW9uLnRhcmdldCcsIHBvc2l0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhc3RhdGUubW91c2Vkb3duO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGF5OiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb2xvOiAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc2VzOiAncXRpcC1ibHVlIHF0aXAtc2hhZG93J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXk6ICd0b3AgY2VudGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXQ6ICdib3R0b20gY2VudGVyJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0YXJnZXQ6IHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaWRlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50OiAnbW91c2Vkb3duIG1vdXNlbGVhdmUnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL2luY2FzZSBsaWJyYXJ5IGhhc24ndCBsb2FkZWQgeWV0XG4gICAgICAgICAgICAgICAgaWYgKCQoZG9jdW1lbnQpLnF0aXAgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGF0dGFjaFFUaXAoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLndoZW5RVGlwQXZhaWxhYmxlKGF0dGFjaFFUaXApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiBuZXcgcGF0aHMgYXJlIGFkZGVkIGR1cmluZyB0aGVcbiAgICAgICAgICAgICAqIHVwZGF0ZSBncmFwaCBmdW5jdGlvblxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtkM1BhdGh9ICBuZXdQYXRocyAgVGhlIG5ldyBwYXRocyB0aGF0IGFyZVxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZWluZyBhZGRlZCB0byB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3VwZGF0ZU5ld1BhdGhzJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVOZXdQYXRocyhuZXdQYXRocykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5RVGlwUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgLy9pbmNhc2UgbGlicmFyeSBoYXNuJ3QgbG9hZGVkIHlldFxuICAgICAgICAgICAgICAgIGlmICgkKGRvY3VtZW50KS5xdGlwICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvL2FkZGluZyBxdGlwXG4gICAgICAgICAgICAgICAgICAgIG5ld1BhdGhzLmVhY2goZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aGlzUGF0aCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2dldHRpbmcgbWlkcG9pbnQgb2YgcGF0aFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhdGhFbCA9IGQzLnNlbGVjdCh0aGlzKS5ub2RlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWlkcG9pbnQgPSBwYXRoRWwuZ2V0UG9pbnRBdExlbmd0aChwYXRoRWwuZ2V0VG90YWxMZW5ndGgoKSAvIDIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldFJldCA9IGQucXRpcEhlbHBlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSBcIkJ5dGVzOiBcIiArIGQuZ2V0V2VpZ2h0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXNQYXRoKS5xdGlwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRleHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93OiBmdW5jdGlvbiBzaG93KCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9pZiBtb3VzZSBpcyBkb3duLCBkb24ndCBsZXQgcXRpcCBzaG93XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIXN0YXRlLm1vdXNlZG93bjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxheTogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc29sbzogJCgnI2dyYXBoQ29udGFpbmVyJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzZXM6ICdxdGlwLWJsdWUgcXRpcC1zaGFkb3cnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBteTogdGFyZ2V0UmV0Lm15LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdDogJ2NlbnRlciBjZW50ZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6ICdtb3VzZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkanVzdDogdGFyZ2V0UmV0LmFkanVzdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudDogJ21vdXNlZG93biBtb3VzZWxlYXZlJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfV0pO1xuXG4gICAgICAgIHJldHVybiBRVGlwUG9saWN5O1xuICAgIH0oUG9saWN5LlBvbGljeSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBQb2xpY3k6IFFUaXBQb2xpY3lcbiAgICB9O1xufV0pO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE5LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm1lbnUnLCBbXSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuLyoqXG4gKiBUaGlzIHBvbGljeSBwcm92aWRlcyBhIHdheSBmb3IgcHJvcGVydGllcyB0byBiZSBzYXZlZCBcbiAqIGJldHdlZW4gdmlldyBjaGFuZ2VzXG4gKiBcbiAqIEl0IG1vZGlmaWVzIHRoZSBkZXN0cm95IGZ1bmN0aW9uIHRvIGFsc28gcGFzcyBpbiBhbiBvYmplY3QgdGhhdFxuICogd2lsbCBoYXZlIGFsbCBpdHMgcHJvcGVydGllcyBzYXZlZCBhbmQgd2lsbCBiZSBhdmFpbGFibGUgXG4gKiBvbiBncmFwaCBsb2FkLiBXaGVuIHNhdmluZyB2YXJpYWJsZXMgdG8gdGhlIG9iamVjdCwgbmFtZXNwYWNlIHdpdGhcbiAqIHRoZSBwb2xpY3kgbmFtZS5cbiAqIFxuICogVGhpcyBwb2xpY3kgbXVzdCBiZSBsb2FkZWQgZmlyc3QgaW4gb3JkZXIgZm9yIGl0IHNhdmVkIHZhcmlhYmxlcyBcbiAqIHRvIGJlIGxvYWRlZCB3aGVuIHRoZSB2aWV3IGNvbWVzIGJhY2sgdG8gdGhlIGdyYXBoXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKS5mYWN0b3J5KCdTYXZlU3RhdGVQb2xpY3knLCBbJ1BvbGljeScsIGZ1bmN0aW9uIChQb2xpY3kpIHtcbiAgICB2YXIgU2F2ZVN0YXRlUG9saWN5ID0gZnVuY3Rpb24gKF9Qb2xpY3kkUG9saWN5KSB7XG4gICAgICAgIF9pbmhlcml0cyhTYXZlU3RhdGVQb2xpY3ksIF9Qb2xpY3kkUG9saWN5KTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGFrZXMgaW4gdGhlIGFuZ3VsYXIgc2VydmljZSB0byB3aGljaCBpdCB3aWxsXG4gICAgICAgICAqIHNhdmUgaXQncyBwcm9wZXJ0aWVzIHRvLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgc2F2ZWRTdGF0ZSAgT2JqZWN0IHRvIHNhdmUgXG4gICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzIHRvXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBTYXZlU3RhdGVQb2xpY3koc2F2ZWRTdGF0ZSkge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNhdmVTdGF0ZVBvbGljeSk7XG5cbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChTYXZlU3RhdGVQb2xpY3kuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihTYXZlU3RhdGVQb2xpY3kpKS5jYWxsKHRoaXMsICdTYXZlU3RhdGVQb2xpY3knKSk7XG5cbiAgICAgICAgICAgIF90aGlzLnNhdmVkU3RhdGUgPSBzYXZlZFN0YXRlO1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAqIE1vZGlmaWVzIHRoZSBkZXN0cm95IG1ldGhvZCBcbiAgICAgICAgICogYW5kIGFkZHMgYSBsb2FkIG1ldGhvZCB0byB0aGUgZ3JhcGhcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgXG4gICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFsbGVkIG9uXG4gICAgICAgICAqL1xuXG5cbiAgICAgICAgX2NyZWF0ZUNsYXNzKFNhdmVTdGF0ZVBvbGljeSwgW3tcbiAgICAgICAgICAgIGtleTogJ2luaXRpYWxpemUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemUoZ3JhcGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmdyYXBoID0gZ3JhcGg7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgICAgICAgICAgICAgIGdyYXBoLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kuZ3JhcGhEZXN0cm95LmNhbGwoZ3JhcGgsIHRoaXNQb2xpY3kuc2F2ZWRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGdyYXBoLmxvYWQgPSBmdW5jdGlvbiAoc2F2ZWRTdGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LmdyYXBoTG9hZC5jYWxsKGdyYXBoLCBzYXZlZFN0YXRlKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgb3ZlcnJpZGUgdGhlIGdyYXBoJ3MgZGVmYXVsdCBkZXN0cm95LCB3aXRoIFxuICAgICAgICAgICAgICogdGhpcyBwb2xpY3kncyBzYXZlZFN0YXRlIHBhc3NlZCBpbi5cbiAgICAgICAgICAgICAqIENhbGxlZCB3aXRoIHRoaXMgYXMgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIHNhdmVkU3RhdGUgIFRoZSBzYXZlZCBzdGF0ZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZ3JhcGhEZXN0cm95JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBncmFwaERlc3Ryb3koc2F2ZWRTdGF0ZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3kuZGVzdHJveShzYXZlZFN0YXRlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5LmRlc3Ryb3koc2F2ZWRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHRoaXNHcmFwaC5iaW5kaW5ncykge1xuICAgICAgICAgICAgICAgICAgICAkKHdpbmRvdykub2ZmKGtleSwgdGhpc0dyYXBoLmJpbmRpbmdzW2tleV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBXaWxsIGJlIGNhbGxlZCB3aXRoIHRoZSBncmFwaCBhcyB0aGlzXG4gICAgICAgICAgICAgKiBVc2VkIHRvIGhhdmUgYWxsIG90aGVyIHBvbGljaWVzIHVzZSB0aGUgbG9hZCBzdGF0ZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBzYXZlZFN0YXRlICBUaGUgc2F2ZWQgc3RhdGVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2dyYXBoTG9hZCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ3JhcGhMb2FkKHNhdmVkU3RhdGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvbGljeS5sb2FkICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljeS5sb2FkKHNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb2xpY3kubG9hZCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2xpY3kubG9hZChzYXZlZFN0YXRlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIFNhdmVTdGF0ZVBvbGljeTtcbiAgICB9KFBvbGljeS5Qb2xpY3kpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgUG9saWN5OiBTYXZlU3RhdGVQb2xpY3lcbiAgICB9O1xufV0pO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtwb2xpY2llcycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzJywge1xuICAgICAgICAgICAgdXJsOiAnL25ldHdvcmtwb2xpY2llcycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbicsIHtcbiAgICAgICAgICAgIHVybDogJy9pc29sYXRpb24nLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzx1aS12aWV3Lz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5pc29sYXRpb24uY3JlYXRlJywge1xuICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICdpc29sYXRpb25wb2xpY3ljcmVhdGUnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGgnLCB7XG4gICAgICAgICAgICB1cmw6ICcvYmFuZHdpZHRoJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8dWktdmlldy8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMucmVkaXJlY3Rpb24nLCB7XG4gICAgICAgICAgICB1cmw6ICcvcmVkaXJlY3Rpb24nLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzx1aS12aWV3Lz4nXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXBcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxudmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQob2JqZWN0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IHJldHVybiBnZXQocGFyZW50LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpOyB9IH0gZWxzZSBpZiAoXCJ2YWx1ZVwiIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9O1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbi8qKlxuICogVGhpcyBwb2xpY3kgaXMgdXNlZCBmb3Igc3BsaXR0aW5nIGEgbm9kZSBpbnRvIGl0cyBjaGlsZHJlbixcbiAqIGFuZCBqb2luaW5nIHRoZW0gYmFjayB0byB0aGVpciBwYXJlbnQuXG4gKiBTcGxpdHMgb24gZG91YmxlIGNsaWNrLCBhbmQgam9pbnMgb24gcmlnaHQgY2xpY2suXG4gKiBJZiBtdWx0aXBsZSBub2RlcyBhcmUgc2VsZWN0ZWQgYXQgdGhlIHRpbWUgb2YgYSBzcGxpdCBvciBqb2luIGV2ZW50LFxuICogaXQgd2lsbCBzcGxpdCBvciBqb2luIGFsbCBvZiB0aGVtLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnU3BsaXRKb2luTm9kZVBvbGljeScsIFsnTm9kZVNlbGVjdGlvblBvbGljeScsICdWaXN1YWxpemVyTm9kZScsIGZ1bmN0aW9uIChOb2RlU2VsZWN0aW9uUG9saWN5LCBWaXN1YWxpemVyTm9kZSkge1xuICAgIHZhciBTcGxpdEpvaW5Ob2RlUG9saWN5ID0gZnVuY3Rpb24gKF9Ob2RlU2VsZWN0aW9uUG9saWN5JCkge1xuICAgICAgICBfaW5oZXJpdHMoU3BsaXRKb2luTm9kZVBvbGljeSwgX05vZGVTZWxlY3Rpb25Qb2xpY3kkKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gU3BsaXRKb2luTm9kZVBvbGljeSgpIHtcbiAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTcGxpdEpvaW5Ob2RlUG9saWN5KTtcblxuICAgICAgICAgICAgdmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKFNwbGl0Sm9pbk5vZGVQb2xpY3kuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihTcGxpdEpvaW5Ob2RlUG9saWN5KSkuY2FsbCh0aGlzKSk7XG5cbiAgICAgICAgICAgIF90aGlzLnBvbGljeU5hbWUgPSBcIlNwbGl0Sm9pbk5vZGVQb2xpY3lcIjtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYWxsZWQgd2hlbiBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoXG4gICAgICAgICAqL1xuXG5cbiAgICAgICAgX2NyZWF0ZUNsYXNzKFNwbGl0Sm9pbk5vZGVQb2xpY3ksIFt7XG4gICAgICAgICAgICBrZXk6ICdpbml0aWFsaXplJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0aWFsaXplKGdyYXBoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfZ2V0KFNwbGl0Sm9pbk5vZGVQb2xpY3kucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoU3BsaXRKb2luTm9kZVBvbGljeS5wcm90b3R5cGUpLCAnaW5pdGlhbGl6ZScsIHRoaXMpLmNhbGwodGhpcywgZ3JhcGgpO1xuICAgICAgICAgICAgICAgIHZhciBzdGF0ZSA9IGdyYXBoLnN0YXRlLlNwbGl0Sm9pbk5vZGVQb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zcGxpdE5vZGVzID0gW107XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVHJpZ2dlcmluZyBzcGxpdCBvbiBkb3VibGUgY2xpY2tcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgZCAgICAgIFRoZSBtYXRjaGluZyBkYXRhIG9iamVjdFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZGJsY2xpY2snLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRibGNsaWNrKGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdXBlclN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pbk5vZGVQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWQzLmV2ZW50LmN0cmxLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN1cGVyU3RhdGUuc2VsZWN0ZWROb2Rlcy5pbmRleE9mKGQpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3BsaXRNdWx0aXBsZU5vZGVzKHN1cGVyU3RhdGUuc2VsZWN0ZWROb2Rlcyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUFsbFNlbGVjdGVkTm9kZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3BsaXROb2RlKGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRyaWdnZXJpbmcgam9pbiBvbiByaWdodCBjbGlja1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09ian0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBkICAgICAgVGhlIG1hdGNoaW5nIGRhdGEgb2JqZWN0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdjb250ZXh0bWVudScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY29udGV4dG1lbnUoZDNub2RlLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN1cGVyU3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeTtcbiAgICAgICAgICAgICAgICBkMy5ldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIGlmICghZDMuZXZlbnQuY3RybEtleSkge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIHRyeSB0byBqb2luIGEgaGlnaGxpZ2h0ZWQgbm9kZSB3aGlsZSBtdWx0aXBsZSBub2RlcyBhcmUgc2VsZWN0ZWQsXG4gICAgICAgICAgICAgICAgICAgIC8vd2Ugam9pbiBhbGwgaGlnaGxpZ2h0ZWQgbm9kZXNcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGVjdGVkTm9kZXMgPSBzdXBlclN0YXRlLnNlbGVjdGVkTm9kZXM7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZE5vZGVzLmluZGV4T2YoZCkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxlY3RlZE5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5qb2luTm9kZShzZWxlY3RlZE5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vaWYgd2UgdHJ5IHRvIGpvaW4gYSBub2RlIHRoYXQgaXNuJ3QgcGFydCBvZiBhIGhpZ2hsaWdodCxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vd2UgcmVtb3ZlIGFsbCBoaWdobGlnaHRzIGFuZCB0aGVuIGpvaW4gdGhlIGNsaWNrZWQgbm9kZVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVBbGxTZWxlY3RlZE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmpvaW5Ob2RlKGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNwbGl0cyBhIG5vZGUuXG4gICAgICAgICAgICAgKiB1c2VkIHRvIHNoYXJlIGNvZGUgYmV0d2VlbiBzcGxpdE5vZGUgYW5kIHNwbGl0TXVsdGlwbGVOb2Rlc1xuICAgICAgICAgICAgICogd2hpbGUgcHJldmVudGluZyB0aGUgaGFuZGxlcnMgZm9yIHRoZW0gYm90aCBmaXJpbmdcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBub2RlICAgIFRoZSBub2RlIGJlaW5nIHNwbGl0XG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7QXJyYXl9ICBUaGUgbmV3IG5vZGVzIGNyZWF0ZWQgYnkgdGhlIHNwbGl0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdfX3NwbGl0Tm9kZScsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX19zcGxpdE5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5Ob2RlUG9saWN5O1xuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gbm9kZS5pZDtcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIC8vaWYgaXQgaGFzIG5vIGNoaWxkcmVuIHRvIHNwbGl0IGludG9cbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRyZW5fc3RydWN0W25hbWVdID09PSB1bmRlZmluZWQgfHwgXy5pc0VtcHR5KGNoaWxkcmVuX3N0cnVjdFtuYW1lXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vcmVtb3ZpbmcgdGhlIG5vZGUgZnJvbSB0aGUgbGlzdCBvZiBub2Rlc1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlcyA9IF8uZmlsdGVyKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24gKGdyYXBoTm9kZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdyYXBoTm9kZXMgIT0gbm9kZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzR3JhcGgubm9kZXMpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zcGxpY2VMaW5rc0Zvck5vZGUobm9kZSk7XG5cbiAgICAgICAgICAgICAgICAvL2dldHRpbmcgYWxsIHRoZSBub2RlIGlkJ3MgZm9yIGZpbmRpbmcgZmxvd1xuICAgICAgICAgICAgICAgIHZhciBub2RlX25hbWVzX3NldCA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpc0dyYXBoLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVfbmFtZXNfc2V0LnB1c2godGhpc0dyYXBoLm5vZGVzW2ldLmlkKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3NldCBvZiBub2RlcyBhZnRlciB0aGUgc3BsaXRcbiAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGVzID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGlsZHJlbl9zdHJ1Y3RbbmFtZV0ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZV9uYW1lc19zZXQucHVzaChjaGlsZHJlbl9zdHJ1Y3RbbmFtZV1baV0pO1xuICAgICAgICAgICAgICAgICAgICBuZXdfbm9kZXMucHVzaChjaGlsZHJlbl9zdHJ1Y3RbbmFtZV1baV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcmV0RGF0YSA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmdldEZsb3dCZXR3ZWVuU2V0KG5vZGVfbmFtZXNfc2V0KTtcblxuICAgICAgICAgICAgICAgIC8vZm9ybWF0dGluZyBkYXRhIGZvciBuZXcgbm9kZXNcbiAgICAgICAgICAgICAgICB2YXIgeExvYyA9IG5vZGUueDtcbiAgICAgICAgICAgICAgICB2YXIgeUxvYyA9IG5vZGUueTtcbiAgICAgICAgICAgICAgICB2YXIgYW5jZXN0b3JzID0gbm9kZS5hbmNlc3RvcnMuc2xpY2UoKTtcbiAgICAgICAgICAgICAgICAvL2tlZXBpbmcgb3JkZXJpbmcgdGhhdCBmaXJzdCBpbiBhbmNlc3RvciBsaXN0IGlzIGNsb3Nlc3QgaW4gcmVsYXRpb25zaGlwXG4gICAgICAgICAgICAgICAgYW5jZXN0b3JzLnNwbGljZSgwLCAwLCBub2RlLmlkKTtcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gbm9kZS5pZDtcbiAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGVfb2JqcyA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciByYWRpdXMgPSBub2RlLnJhZGl1cyAqIHRoaXNHcmFwaC5jb25zdHMucmFkaXVzRGVjYXk7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVEYXRhID0gcmV0RGF0YS5ub2RlRGF0YTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVEYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vY2FsY3VsYXRpbmcgd2hpY2ggb2YgdGhlIG5vZGVzIGluIHJldERhdGFbMF0gYXJlIG5ld1xuICAgICAgICAgICAgICAgICAgICBpZiAobmV3X25vZGVzLmluZGV4T2Yobm9kZURhdGFbaV0uaWQpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZCA9IG5vZGVEYXRhW2ldLmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSBub2RlRGF0YVtpXS50ZXh0O1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlID0gbmV3IFZpc3VhbGl6ZXJOb2RlLk5vZGUobnVsbCwgbnVsbCwgaWQsIHRleHQsIHJhZGl1cywgcGFyZW50LCBhbmNlc3RvcnMsIHhMb2MsIHlMb2MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3X25vZGUuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnB1c2gobmV3X25vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3X25vZGVfb2Jqcy5wdXNoKG5ld19ub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5wcm9jZXNzTGlua0RhdGEocmV0RGF0YS5saW5rRGF0YSwgdGhpc0dyYXBoLm5vZGVzKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXRMaW5rcygpO1xuXG4gICAgICAgICAgICAgICAgc3RhdGUuc3BsaXROb2Rlcy5wdXNoKG5vZGUuaWQpO1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXdfbm9kZV9vYmpzO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNwbGl0cyB0aGUgZ2l2ZSBub2RlXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBub2RlICAgIFRoZSBub2RlIGJlaW5nIHNwbGl0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdzcGxpdE5vZGUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNwbGl0Tm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlcyA9IHRoaXMuX19zcGxpdE5vZGUobm9kZSk7XG4gICAgICAgICAgICAgICAgaWYgKHJlcyA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5zcGxpdE5vZGVFdmVudChyZXMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNwbGl0cyBhbGwgdGhlIG5vZGVzIHBhc3NlZCBpblxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVzICAgQXJyYXkgb2Ygbm9kZXMgdG8gYmUgc3BsaXRcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3NwbGl0TXVsdGlwbGVOb2RlcycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3BsaXRNdWx0aXBsZU5vZGVzKG5vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG4gICAgICAgICAgICAgICAgdmFyIHJlc05vZGVzID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0gdGhpcy5fX3NwbGl0Tm9kZShub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIHJlc05vZGVzID0gcmVzTm9kZXMuY29uY2F0KHJlcyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5zcGxpdE11bHRpcGxlTm9kZXNFdmVudChyZXMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBhIHNpbmdsZSBub2RlIGlzIHNwbGl0XG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbmV3Tm9kZXMgIFRoZSBuZXcgbm9kZXNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3NwbGl0Tm9kZUV2ZW50JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzcGxpdE5vZGVFdmVudChuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zZXRQb3NpdGlvbnMoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgYWZ0ZXIgbXVsdGlwbGUgbm9kZXMgYXJlIHNwbGl0IGF0IG9uY2VcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBuZXdOb2RlcyAgVGhlIG5ldyBub2Rlc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnc3BsaXRNdWx0aXBsZU5vZGVzRXZlbnQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNwbGl0TXVsdGlwbGVOb2Rlc0V2ZW50KG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNldFBvc2l0aW9ucygpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIHVzZWQgdG8gc2hhcmUgY29kZSBiZXR3ZWVuIGpvaW5Ob2RlIGFuZCBqb2luTXVsdGlwbGVOb2RlXG4gICAgICAgICAgICAgKiB3aGlsZSBwcmV2ZW50aW5nIGJvdGggaGFuZGxlcnMgZmlyaW5nXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgICAgICBub2RlICAgIFRoZSBub2RlIHRvIGpvaW5cbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtOb2RlfSAgVGhlIG5ldyBub2RlIGFmdGVyIHRoZSBqb2luXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdfX2pvaW5Ob2RlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfX2pvaW5Ob2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luTm9kZVBvbGljeTtcblxuICAgICAgICAgICAgICAgIC8vY2hlY2sgdGhhdCBub2RlIHN0aWxsIGV4aXN0c1xuICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGgubm9kZXMuaW5kZXhPZihub2RlKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IG5vZGUuaWQ7XG4gICAgICAgICAgICAgICAgLy9pZiBpdCBoYXMgbm8gYW5jZXN0b3IsIG5vdGhpbmcgdG8gam9pblxuICAgICAgICAgICAgICAgIGlmIChjaGlsZHJlbl9zdHJ1Y3QudG9wTGV2ZWwuaW5kZXhPZihuYW1lKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgdG9fYmVfZGVsZXRlZCA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBub2RlX25hbWVzX3NldCA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpc0dyYXBoLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgbm9kZSB3b24ndCBiZSBjb2xsYXBzZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5ub2Rlc1tpXS5hbmNlc3RvcnMuaW5kZXhPZihub2RlLnBhcmVudCkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVfbmFtZXNfc2V0LnB1c2godGhpc0dyYXBoLm5vZGVzW2ldLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvX2JlX2RlbGV0ZWQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZV9pZCA9IG5vZGUucGFyZW50O1xuICAgICAgICAgICAgICAgIG5vZGVfbmFtZXNfc2V0LnB1c2gobm9kZS5wYXJlbnQpO1xuXG4gICAgICAgICAgICAgICAgLy9mb3JtYXR0aW5nIGRhdGFcbiAgICAgICAgICAgICAgICB2YXIgcmFkaXVzID0gbm9kZS5yYWRpdXMgLyB0aGlzR3JhcGguY29uc3RzLnJhZGl1c0RlY2F5O1xuICAgICAgICAgICAgICAgIHZhciB4TG9jID0gbm9kZS54O1xuICAgICAgICAgICAgICAgIHZhciB5TG9jID0gbm9kZS55O1xuICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBub2RlLmFuY2VzdG9yc1sxXTtcbiAgICAgICAgICAgICAgICB2YXIgYW5jZXN0b3JzID0gbm9kZS5hbmNlc3RvcnMuc2xpY2UoMSk7XG4gICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlID0gbmV3IFZpc3VhbGl6ZXJOb2RlLk5vZGUoeExvYywgeUxvYywgbmV3X25vZGVfaWQsIG5ld19ub2RlX2lkLCByYWRpdXMsIHBhcmVudCwgYW5jZXN0b3JzKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMucHVzaChuZXdfbm9kZSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgcmV0RGF0YSA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmdldEZsb3dCZXR3ZWVuU2V0KG5vZGVfbmFtZXNfc2V0KTtcbiAgICAgICAgICAgICAgICAvL3JlbW92ZSBhbGwgbm9kZXMgdGhhdCB3aWxsIGJlIGpvaW5lZFxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdG9fYmVfZGVsZXRlZC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZV90b19kZWxldGUgPSB0b19iZV9kZWxldGVkW2ldO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMuc3BsaWNlKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG5vZGVfdG9fZGVsZXRlKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zcGxpY2VMaW5rc0Zvck5vZGUobm9kZV90b19kZWxldGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5wcm9jZXNzTGlua0RhdGEocmV0RGF0YS5saW5rRGF0YSwgdGhpc0dyYXBoLm5vZGVzKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXRMaW5rcygpO1xuXG4gICAgICAgICAgICAgICAgc3RhdGUuc3BsaXROb2Rlcy5zcGxpY2Uoc3RhdGUuc3BsaXROb2Rlcy5pbmRleE9mKG5ld19ub2RlLmlkKSwgMSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3X25vZGU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogSm9pbnMgdGhlIGdpdmVuIG5vZGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGUgdG8gam9pblxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnam9pbk5vZGUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGpvaW5Ob2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3Tm9kZSA9IHRoaXMuX19qb2luTm9kZShub2RlKTtcbiAgICAgICAgICAgICAgICBpZiAobmV3Tm9kZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuam9pbk5vZGVFdmVudChuZXdOb2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogSm9pbnMgYWxsIHRoZSBnaXZlbiBub2Rlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVzICAgVGhlIG5vZGVzIHRvIGpvaW5cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2pvaW5NdWx0aXBsZU5vZGUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGpvaW5NdWx0aXBsZU5vZGUobm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGVzID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0gdGhpcy5fX2pvaW5Ob2RlKG5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3X25vZGVzLnB1c2gocmVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5qb2luTXVsdGlwbGVOb2Rlc0V2ZW50KG5ld19ub2Rlcyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIGFmdGVyIGEgc2luZ2xlIG5vZGUgaXMgam9pbmVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBuZXdOb2RlICBUaGUgbmV3IG5vZGVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2pvaW5Ob2RlRXZlbnQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGpvaW5Ob2RlRXZlbnQobmV3Tm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBtdWx0aXBsZSBub2RlcyBhcmUgam9pbmVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbmV3Tm9kZXMgIFRoZSBuZXcgbm9kZXNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2pvaW5NdWx0aXBsZU5vZGVzRXZlbnQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGpvaW5NdWx0aXBsZU5vZGVzRXZlbnQobmV3Tm9kZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaDtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfV0pO1xuXG4gICAgICAgIHJldHVybiBTcGxpdEpvaW5Ob2RlUG9saWN5O1xuICAgIH0oTm9kZVNlbGVjdGlvblBvbGljeS5Qb2xpY3kpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgUG9saWN5OiBTcGxpdEpvaW5Ob2RlUG9saWN5XG4gICAgfTtcbn1dKTtcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtzJywge1xuICAgICAgICAgICAgdXJsOiAnL25ldHdvcmtzJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KG9iamVjdCwgcHJvcGVydHksIHJlY2VpdmVyKSB7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyByZXR1cm4gZ2V0KHBhcmVudCwgcHJvcGVydHksIHJlY2VpdmVyKTsgfSB9IGVsc2UgaWYgKFwidmFsdWVcIiBpbiBkZXNjKSB7IHJldHVybiBkZXNjLnZhbHVlOyB9IGVsc2UgeyB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7IGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7IH0gfTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG4vKipcbiAqIFRoaXMgcG9saWN5IGlzIHVzZWQgdG8gY2hhbmdlIHRoZSB2aWV3IHRvIGZvY3VzIG9uIHNwbGl0dGluZyBhbmQgXG4gKiBqb2luaW5nIGV2ZW50cy5cbiAqIE92ZXJyaWRlcyB0aGUgY2VydGFpbiBmb3JjZSBsYXlvdXQgZnVuY3Rpb25zIG9mIHRoZSBncmFwaCB0byBwYXJ0aXRpb24gYSBzcGxpdFxuICogaW50byB0aGUgZm9jdXNlZCBub2RlcyBhbmQgdGhlIGNvbm5lY3RlZCBub2Rlcy5cbiAqIFxuICogSGFzIHNhdmUvbG9hZCBtZXRob2RzIGZvciB0aGUgc2F2ZSBzdGF0ZSBwb2xpY3kuXG4gKiBIYXMgYmFjayBidXR0b24gc3VwcG9ydC5cbiAqIENhbiBhdXRvIGNoYW5nZSB0aGUgdGl0bGUgb2YgdGhlIGdyYXBoLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJykuZmFjdG9yeSgnU3BsaXRKb2luVmlld1BvbGljeScsIFsnU3BsaXRKb2luTm9kZVBvbGljeScsICdWaXN1YWxpemVyTm9kZScsIGZ1bmN0aW9uIChTcGxpdEpvaW5Ob2RlUG9saWN5LCBWaXN1YWxpemVyTm9kZSkge1xuICAgIHZhciBTcGxpdEpvaW5WaWV3UG9saWN5ID0gZnVuY3Rpb24gKF9TcGxpdEpvaW5Ob2RlUG9saWN5JCkge1xuICAgICAgICBfaW5oZXJpdHMoU3BsaXRKb2luVmlld1BvbGljeSwgX1NwbGl0Sm9pbk5vZGVQb2xpY3kkKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gU3BsaXRKb2luVmlld1BvbGljeSgpIHtcbiAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTcGxpdEpvaW5WaWV3UG9saWN5KTtcblxuICAgICAgICAgICAgdmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKFNwbGl0Sm9pblZpZXdQb2xpY3kuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihTcGxpdEpvaW5WaWV3UG9saWN5KSkuY2FsbCh0aGlzKSk7XG5cbiAgICAgICAgICAgIF90aGlzLnBvbGljeU5hbWUgPSBcIlNwbGl0Sm9pblZpZXdQb2xpY3lcIjtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYWxsZWQgd2hlbiBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoXG4gICAgICAgICAqL1xuXG5cbiAgICAgICAgX2NyZWF0ZUNsYXNzKFNwbGl0Sm9pblZpZXdQb2xpY3ksIFt7XG4gICAgICAgICAgICBrZXk6ICdpbml0aWFsaXplJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0aWFsaXplKGdyYXBoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfZ2V0KFNwbGl0Sm9pblZpZXdQb2xpY3kucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoU3BsaXRKb2luVmlld1BvbGljeS5wcm90b3R5cGUpLCAnaW5pdGlhbGl6ZScsIHRoaXMpLmNhbGwodGhpcywgZ3JhcGgpO1xuICAgICAgICAgICAgICAgIHZhciBzdGF0ZSA9IGdyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zYXZlZFN0YXRlcyA9IFtdO1xuICAgICAgICAgICAgICAgIC8vIHN0YXRlLmZvY3VzR3JvdXAgPSBudWxsO1xuICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeSA9IFtdO1xuICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzID0gW107XG4gICAgICAgICAgICAgICAgc3RhdGUuZm9jaSA9IFtdO1xuICAgICAgICAgICAgICAgIHN0YXRlLnpvb21zID0ge307XG4gICAgICAgICAgICAgICAgc3RhdGUubGF5b3V0ID0ge307XG4gICAgICAgICAgICAgICAgc3RhdGUubGF5b3V0RGVmYXVsdCA9IG51bGw7XG4gICAgICAgICAgICAgICAgc3RhdGUuem9vbURlZmF1bHQgPSBudWxsO1xuICAgICAgICAgICAgICAgIHN0YXRlLm5vZGVJZHNUb1Jlc2hvdyA9IG51bGw7XG4gICAgICAgICAgICAgICAgc3RhdGUuYmFja0J1dHRvbkVsZW0gPSBudWxsO1xuICAgICAgICAgICAgICAgIHN0YXRlLnRpdGxlRWxlbSA9IG51bGw7XG5cbiAgICAgICAgICAgICAgICB2YXIgY29uc3RzID0gZ3JhcGguY29uc3RzLlNwbGl0Sm9pblZpZXdQb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICBjb25zdHMuYm91bmRhcnkgPSAwLjg7XG5cbiAgICAgICAgICAgICAgICAvL292ZXJyaWRpbmcgZDNmb3JjZSBtZXRob2RzIG9mIHRoZSBncmFwaC5cbiAgICAgICAgICAgICAgICBncmFwaC5kM0ZvcmNlQm91bmRzID0gdGhpcy5kM0ZvcmNlQm91bmRzO1xuICAgICAgICAgICAgICAgIGdyYXBoLmQzRm9yY2VUaWNrID0gdGhpcy5kM0ZvcmNlVGljaztcbiAgICAgICAgICAgICAgICBncmFwaC5kM0ZvcmNlU3RhcnQgPSB0aGlzLmQzRm9yY2VTdGFydDtcbiAgICAgICAgICAgICAgICBncmFwaC5kM0ZvcmNlRW5kID0gdGhpcy5kM0ZvcmNlRW5kO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIExpbmtzIHRoZSBwcm92aWRlZCBlbGVtZW50IGEgYmFjayBidXR0b24gZmVhdHVyZVxuICAgICAgICAgICAgICogRG9lc24ndCB0cmlnZ2VyIHRoZSBvbi1jbGljayBldmVudFxuICAgICAgICAgICAgICogVGhhdCBzaG91bGQgYmUgZG9uZSB0aHJvdWdoIGFuZ3VsYXIgbmctY2xpY2suXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2pRdWVyeX0gIGVsZW0gICAgVGhlIGpxdWVyeSBzZWxlY3RlZCBlbGVtZW50XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdpbnN0YWxsQmFja0J1dHRvbicsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5zdGFsbEJhY2tCdXR0b24oZWxlbSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5ID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIHN0YXRlLmJhY2tCdXR0b25FbGVtID0gZWxlbTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kudW5kb0xhc3RFdmVudC5jYWxsKHRoaXNQb2xpY3kpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBXaWxsIGFsbG93IHRoaXMgcG9saWN5IHRvIGNoYW5nZSB0aGUgdGl0bGUgb2YgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKiBhcyBzcGxpdCBhbmQgam9pbiBldmVudHMgb2NjdXIuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2pRdWVyeX0gIGVsZW0gICAgVGhlIGpxdWVyeSBzZWxlY3RlZCBlbGVtZW50XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdpbnN0YWxsVGl0bGUnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluc3RhbGxUaXRsZShlbGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS50aXRsZUVsZW0gPSBlbGVtO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyBiZWluZyBkZXN0cm95ZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgc2F2ZWRTdGF0ZSAgQW55IHByb3BlcnR5IG9uIHRoaXNcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3Qgd2lsbCBiZSBhY2Nlc3NpYmxlXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiB0aGUgdmlldyByZWxvYWRzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkZXN0cm95JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KHNhdmVkU3RhdGUpIHtcbiAgICAgICAgICAgICAgICAvL09ubHkgaWYgdGhlIHNhdmUgc3RhdGUgcG9saWN5IGlzIGluc3RhbGxlZFxuICAgICAgICAgICAgICAgIGlmIChzYXZlZFN0YXRlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zYXZlKHNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBXaWxsIHNhdmUgdGhlIGN1cnJlbnQgc3RhdGUsIGFuZCBhbGwgaGlzdG9yeS5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgc2F2ZWRTdGF0ZSAgQW55IHByb3BlcnR5IG9uIHRoaXNcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3Qgd2lsbCBiZSBhY2Nlc3NpYmxlXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiB0aGUgdmlldyByZWxvYWRzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdzYXZlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzYXZlKHNhdmVkU3RhdGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXNHcmFwaC5ub2RlcztcbiAgICAgICAgICAgICAgICB2YXIgbGlua3MgPSB0aGlzR3JhcGgubGlua3M7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJUaXRsZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLnRpdGxlRWxlbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJUaXRsZSA9IHN0YXRlLnRpdGxlRWxlbS50ZXh0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBmb2N1c0dyb3VwcyA9IHN0YXRlLmZvY3VzR3JvdXBzO1xuICAgICAgICAgICAgICAgIHZhciBldmVudEhpc3RvcnkgPSBzdGF0ZS5ldmVudEhpc3Rvcnk7XG4gICAgICAgICAgICAgICAgdmFyIHpvb21zID0gc3RhdGUuem9vbXM7XG4gICAgICAgICAgICAgICAgdmFyIGxheW91dCA9IHN0YXRlLmxheW91dDtcblxuICAgICAgICAgICAgICAgIHZhciBsYXlvdXREZWZhdWx0ID0gc3RhdGUubGF5b3V0RGVmYXVsdDtcbiAgICAgICAgICAgICAgICB2YXIgem9vbURlZmF1bHQgPSBzdGF0ZS56b29tRGVmYXVsdDtcbiAgICAgICAgICAgICAgICB2YXIgcmV0ID0geyBub2Rlczogbm9kZXMsIGxpbmtzOiBsaW5rcyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVzOiBzdGF0ZS5zYXZlZFN0YXRlcywgY3VyclRpdGxlOiBjdXJyVGl0bGUsXG4gICAgICAgICAgICAgICAgICAgIGZvY3VzR3JvdXBzOiBmb2N1c0dyb3VwcyxcbiAgICAgICAgICAgICAgICAgICAgZXZlbnRIaXN0b3J5OiBldmVudEhpc3RvcnksIHpvb21zOiB6b29tcyxcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0OiBsYXlvdXQsIGxheW91dERlZmF1bHQ6IGxheW91dERlZmF1bHQsXG4gICAgICAgICAgICAgICAgICAgIHpvb21EZWZhdWx0OiB6b29tRGVmYXVsdCB9O1xuICAgICAgICAgICAgICAgIHNhdmVkU3RhdGUuU3BsaXRKb2luVmlld1BvbGljeSA9IHJldDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBXaWxsIGJlIGNhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyByZWxvYWRlZCwgYXNzdW1pbmdcbiAgICAgICAgICAgICAqIHNhdmUgc3RhdGUgcG9saWN5IGlzIGluc3RhbGxlZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBsb2FkU3RhdGUgIENvbnRhaW5zIGFsbCB0aGUgc2F2ZWRcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhYmxlc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnbG9hZCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbG9hZChsb2FkU3RhdGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICBsb2FkU3RhdGUgPSBsb2FkU3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zYXZlZFN0YXRlcyA9IGxvYWRTdGF0ZS5zdGF0ZXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzID0gbG9hZFN0YXRlLmxpbmtzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlcyA9IGxvYWRTdGF0ZS5ub2RlcztcblxuICAgICAgICAgICAgICAgIHZhciBjdXJyVGl0bGUgPSBsb2FkU3RhdGUuY3VyclRpdGxlO1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS50aXRsZUVsZW0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS50aXRsZUVsZW0udGV4dChjdXJyVGl0bGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkgPSBsb2FkU3RhdGUuZXZlbnRIaXN0b3J5O1xuICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzID0gbG9hZFN0YXRlLmZvY3VzR3JvdXBzO1xuICAgICAgICAgICAgICAgIHN0YXRlLnpvb21zID0gbG9hZFN0YXRlLnpvb21zO1xuICAgICAgICAgICAgICAgIHN0YXRlLmxheW91dCA9IGxvYWRTdGF0ZS5sYXlvdXQ7XG4gICAgICAgICAgICAgICAgc3RhdGUubGF5b3V0RGVmYXVsdCA9IGxvYWRTdGF0ZS5sYXlvdXREZWZhdWx0O1xuICAgICAgICAgICAgICAgIHN0YXRlLnpvb21EZWZhdWx0ID0gbG9hZFN0YXRlLnpvb21EZWZhdWx0O1xuXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmJhY2tCdXR0b25FbGVtICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uRWxlbS5mYWRlVG8oJ3Nsb3cnLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG5cbiAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF8uaW5jbHVkZXMoY2hpbGRyZW5fc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzBdXSwgZC5pZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJmb2N1c1wiO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImNvbm5lY3RlZFwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvL2xvYWRpbmcgYSBwcmV2aW91cyBsYXlvdXRcbiAgICAgICAgICAgICAgICB2YXIgbGF5b3V0O1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ID0gc3RhdGUubGF5b3V0RGVmYXVsdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSBzdGF0ZS56b29tRGVmYXVsdDtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh6b29tWzBdLCB6b29tWzFdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbSA9IHN0YXRlLnpvb21zW3N0YXRlLmZvY3VzR3JvdXBzXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHpvb20gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh6b29tWzBdLCB6b29tWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBsYXlvdXQgPSBzdGF0ZS5sYXlvdXRbc3RhdGUuZm9jdXNHcm91cHNdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vbGF5b3V0IGNhbid0IGJlIG51bGxcbiAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcG9zID0gbGF5b3V0W24uaWRdO1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9zID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGxheW91dCwgbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbi54ID0gcG9zLng7XG4gICAgICAgICAgICAgICAgICAgIG4ueSA9IHBvcy55O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZS5pbml0Rm9yY2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaC5jYWxsKHRoaXNHcmFwaCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnVwZGF0ZUdyYXBoQ2FsbGJhY2suY2FsbCh0aGlzUG9saWN5KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUcmlnZ2VyaW5nIHNwbGl0IG9uIGRvdWJsZSBjbGlja1xuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBGb2N1cyBncm91cCBzdG9yZXMgdGhlIG5vZGUgdGhhdCBpcyBhYm91dCB0byBiZSBzcGxpdC5cbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogV2hlbiBmb2N1cyBncm91cCBoYXMgbGVuZ3RoIDAsIHRoZSBmaXJzdCBzcGxpdCBcbiAgICAgICAgICAgICAqIHdpbGwganVzdCBiZSBwdXNoZWQgb24uXG4gICAgICAgICAgICAgKiBUaGUgbm9kZSB3aWxsIGJlIHNwbGl0IGFuZCBwdXNoZWQgdG8gdGhlIHRvcCBoYWxmIFxuICAgICAgICAgICAgICogb2YgdGhlIHNjcmVlbiwgYW5kIHRoZSBib3R0b20gaGFsZiB3aWxsIGNvbnRhaW4gYW55XG4gICAgICAgICAgICAgKiBub2RlcyBpdCBoYXMgY29ubmVjdGlvbnMgdG8uXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIFdoZW4gYSBmb2N1cyBncm91cCBsZW5ndGggaXMgPj0gMSwgaWYgdGhlIG5vZGUgdG8gYmVcbiAgICAgICAgICAgICAqIHNwbGl0IGlzIGEgZm9jdXMgbm9kZSwgaXQgd2lsbCByZXBsYWNlIGZvY3VzR3JvdXBzWzBdIGFuZFxuICAgICAgICAgICAgICogdGhlIHRvcCBoYWxmIHdpbGwgYmUgaXRzIGNoaWxkcmVuLCBhbmQgYm90dG9tIGhhbGYgd2lsbFxuICAgICAgICAgICAgICogYmUgdGhlIG5vZGVzIGl0IGhhcyBjb25uZWN0aW9ucyB0by5cbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogSWYgdGhlIHNwbGl0IGlzIGluIHRoZSBib3R0b20gaGFsZiwgdGhlbiB0aGUgYm90dG9tIGhhbGZcbiAgICAgICAgICAgICAqIHdpbGwgZGlzcGxheSBpdCdzIGNoaWxkcmVuIGFuZCB3aWxsIG9ubHkgc2hvdyBjb25uZWN0aW9ucyBiZXR3ZWVuXG4gICAgICAgICAgICAgKiB0aGUgdHdvIGdyb3VwcywgYW5kIHdpbGwgcmVwbGFjZSBmb2N1c0dyb3Vwc1sxXS5cbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0QzT2JqfSAgIGQzbm9kZSAgVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBkICAgICAgIFRoZSBtYXRjaGluZyBkYXRhIG9iamVjdFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZGJsY2xpY2snLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRibGNsaWNrKGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgLy9jaGVjayBpZiBjYW4gc3BsaXRcbiAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IGQuaWQ7XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRyZW5fc3RydWN0W25hbWVdID09PSB1bmRlZmluZWQgfHwgXy5pc0VtcHR5KGNoaWxkcmVuX3N0cnVjdFtuYW1lXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzLnNsaWNlKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vdG9wbGV2ZWwgc3BsaXRcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMucHVzaChkLmlkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKF8uaW5jbHVkZXMoY2hpbGRyZW5fc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzBdXSwgZC5pZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9zcGxpdHRpbmcgYSBmb2N1cyBub2RlXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzWzBdID0gZC5pZDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAvL3NwbGl0dGluZyBhXG4gICAgICAgICAgICAgICAgICAgIC8vY29ubmVjdGVkIG5vZGVcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMucHVzaChkLmlkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKF8uaW5jbHVkZXMoY2hpbGRyZW5fc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzFdXSwgZC5pZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9zcGxpdHRpbmcgYVxuICAgICAgICAgICAgICAgICAgICAvL2Nvbm5lY3RlZCBub2RlXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzWzFdID0gZC5pZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAyICYmIHN0YXRlLmZvY3VzR3JvdXBzWzFdID09PSBkLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vU3BsaXR0aW5nIGEgY29ubmVjdGVkIG5vZGUsIGtlZXAgYWxsIGZvY3VzIG5vZGVzXG4gICAgICAgICAgICAgICAgICAgIHZhciBub2Rlc1RvS2VlcCA9IFtkXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVJZHNUb1Jlc2hvdyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ3JvdXBPbmVOb2RlcyA9IGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV07XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoXy5pbmNsdWRlcyhncm91cE9uZU5vZGVzLCBub2RlLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHNUb1Jlc2hvdy5wdXNoKG5vZGUuaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzVG9LZWVwLnB1c2gobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vTWFrZSBzcGxpdCBub2RlcyB0aGUgZm9jdXMgYW5kIGtlZXAgbm9kZXMgdGhhdCBhcmUgY29ubmVjdGVkXG4gICAgICAgICAgICAgICAgICAgIHZhciBub2Rlc1RvS2VlcCA9IFtkXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVJZHNUb1Jlc2hvdyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLmxpbmtzLCBmdW5jdGlvbiAobGluaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmsuc291cmNlID09PSBkICYmIG5vZGVJZHNUb1Jlc2hvdy5pbmRleE9mKGxpbmsudGFyZ2V0LmlkKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsudGFyZ2V0LlNwbGl0Sm9pblZpZXdQb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rLnRhcmdldC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImNvbm5lY3RlZFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHNUb1Jlc2hvdy5wdXNoKGxpbmsudGFyZ2V0LmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1RvS2VlcC5wdXNoKGxpbmsudGFyZ2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobGluay50YXJnZXQgPT09IGQgJiYgbm9kZUlkc1RvUmVzaG93LmluZGV4T2YobGluay5zb3VyY2UuaWQpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluay5zb3VyY2UuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsuc291cmNlLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiY29ubmVjdGVkXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlkc1RvUmVzaG93LnB1c2gobGluay5zb3VyY2UuaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzVG9LZWVwLnB1c2gobGluay5zb3VyY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL1JlbW92aW5nIGxpbmtzIGZyb20gdGhlIG5vZGUgdG8gYmUgc3BsaXRcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5lYWNoKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLmlkICE9PSBkLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3BsaWNlTGlua3NGb3JOb2RlKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG5cbiAgICAgICAgICAgICAgICAvL2Rpc2FibGluZyB1cGRhdGUgZ3JhcGggdG8gcHJldmVudCBuZXcgZGF0YSBmcm9tXG4gICAgICAgICAgICAgICAgLy9yZWRyYXdpbmcgbGlua3Mgd2hpbGUgdGhlcmUgYXJlIGFuaW1hdGlvbnMgZ29pbmcgb25cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3RhdGUuZGlzYWJsZVVwZGF0ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZWFjaChmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5pZCAhPT0gZC5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLnRyYW5zaXRpb24oKS5kZWxheSgyMDApLmR1cmF0aW9uKDQwMCkuc3R5bGUoXCJvcGFjaXR5XCIsIDApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9kaXNhYmxpbmcgcXRpcCBpZiBpbnN0YWxsZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkKHRoaXMpLnF0aXAgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykucXRpcCgnZGlzYWJsZScsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgdHJhbnNsYXRlID0gdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKCk7XG4gICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKTtcbiAgICAgICAgICAgICAgICB2YXIgeExvYyA9IHBhcnNlRmxvYXQodGhpc0dyYXBoLnN2Zy5zdHlsZShcIndpZHRoXCIpKSAvIHNjYWxlIC8gMiArIHRyYW5zbGF0ZVswXTtcbiAgICAgICAgICAgICAgICB2YXIgeUxvYyA9IHBhcnNlRmxvYXQodGhpc0dyYXBoLnN2Zy5zdHlsZShcImhlaWdodFwiKSkgLyBzY2FsZSAvIDIgKyB0cmFuc2xhdGVbMV07XG4gICAgICAgICAgICAgICAgZC54U3RhcnQgPSBkLng7XG4gICAgICAgICAgICAgICAgZC55U3RhcnQgPSBkLnk7XG4gICAgICAgICAgICAgICAgZC54ID0geExvYztcbiAgICAgICAgICAgICAgICBkLnkgPSB5TG9jO1xuICAgICAgICAgICAgICAgIGQzbm9kZS50cmFuc2l0aW9uKFwibm9kZVBvc2l0aW9uVHJhbnNpdGlvblwiKS5kdXJhdGlvbig3NTApLmF0dHJUd2VlbihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgeFN0YXJ0ID0gZC54U3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciB5U3RhcnQgPSBkLnlTdGFydDtcbiAgICAgICAgICAgICAgICAgICAgZC54U3RhcnQgPSBkLng7XG4gICAgICAgICAgICAgICAgICAgIGQueVN0YXJ0ID0gZC55O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZDMuaW50ZXJwb2xhdGVTdHJpbmcoXCJ0cmFuc2xhdGUoXCIgKyB4U3RhcnQgKyBcIixcIiArIHlTdGFydCArIFwiKVwiLCBcInRyYW5zbGF0ZShcIiArIGQueCArIFwiLFwiICsgZC55ICsgXCIpXCIpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIHNwbGl0Tm9kZUZ1bmMgPSBfZ2V0KFNwbGl0Sm9pblZpZXdQb2xpY3kucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoU3BsaXRKb2luVmlld1BvbGljeS5wcm90b3R5cGUpLCAnc3BsaXROb2RlJywgdGhpcyk7XG4gICAgICAgICAgICAgICAgc3RhdGUubm9kZUlkc1RvUmVzaG93ID0gbm9kZUlkc1RvUmVzaG93O1xuICAgICAgICAgICAgICAgIC8vd2FpdGluZyBmb3Igbm9kZSB0cmFuc2l0aW9uXG4gICAgICAgICAgICAgICAgdmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMgPSBub2Rlc1RvS2VlcDtcbiAgICAgICAgICAgICAgICAgICAgc3BsaXROb2RlRnVuYy5jYWxsKHRoaXNQb2xpY3ksIGQpO1xuICAgICAgICAgICAgICAgIH0sIDc1MCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVG8gYmUgY2FsbGVkIGFmdGVyIHRoZSBncmFwaCBpcyBzcGxpdC5cbiAgICAgICAgICAgICAqIEJyaW5ncyBhbGwgbm9kZXMgYmFjayBpbnRvIHZpZXcgYW5kIHNldHMgdGhlaXIgYXR0cmlidXRlc1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAndXBkYXRlR3JhcGhDYWxsYmFjaycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlR3JhcGhDYWxsYmFjaygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2goZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLnRyYW5zaXRpb24oKS5kdXJhdGlvbig0MDApLnN0eWxlKFwib3BhY2l0eVwiLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLmNsYXNzZWQoXCJmb2N1c1wiLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5jbGFzc2VkKFwiY29ubmVjdGVkXCIsIGZhbHNlKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5TcGxpdEpvaW5WaWV3UG9saWN5ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9PT0gXCJmb2N1c1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLmNsYXNzZWQoXCJmb2N1c1wiLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobm9kZS5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPT09IFwiY29ubmVjdGVkXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykuY2xhc3NlZChcImNvbm5lY3RlZFwiLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgc3RhdGUubm9kZUlkc1RvUmVzaG93ID0gbnVsbDtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJhbmRvbWx5IHNldHMgdGhlIHBvc2l0aW9ucyBvZiBhbnkgdW5zZXQgbm9kZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnc2V0UG9zaXRpb25zJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRQb3NpdGlvbnMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kgPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBncmFwaENvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHM7XG5cbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gZ3JhcGhDb25zdHMuZGlzcGxheU9mZnNldDtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICAgICAgdmFyIHJldCA9IHRoaXNQb2xpY3kuZDNGb3JjZUJvdW5kcy5jYWxsKHRoaXNHcmFwaCk7XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZXRSYW5kb21JbnQobWluLCBtYXgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4gKyAxKSkgKyBtaW47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKG5vZGVzLCBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS54ID09IG51bGwgfHwgbm9kZS55ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4ID0gZ2V0UmFuZG9tSW50KG5vZGUucmFkaXVzICsgb2Zmc2V0LCByZXQud2lkdGggLSBub2RlLnJhZGl1cyAtIG9mZnNldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgeSA9IGdldFJhbmRvbUludChub2RlLnJhZGl1cyArIG9mZnNldCwgcmV0LmhlaWdodCAtIG5vZGUucmFkaXVzIC0gb2Zmc2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUueCA9IHg7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLnkgPSB5O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIG9uIHRoZSBzdGFydCBvZiB0aGUgZDMgZm9yY2Ugc2ltdWxhdGlvblxuICAgICAgICAgICAgICogV2lsbCBvdmVycmlkZSB0aGUgbWV0aG9kIG9mIHRoZSBncmFwaFxuICAgICAgICAgICAgICogXCJ0aGlzXCIgcG9pbnRzIHRvIHRoZSBncmFwaFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZDNGb3JjZVN0YXJ0JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkM0ZvcmNlU3RhcnQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuYXR0cignY3gnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC54U3RhcnQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC54U3RhcnQgPSBkLnhTdGFydCAqIHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCkgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKVswXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ2N5JywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQueVN0YXJ0ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQueVN0YXJ0ID0gZC55U3RhcnQgKiB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpICsgdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKClbMV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocy5hdHRyKCd4MScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnNvdXJjZS54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3kxJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuc291cmNlLnk7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneDInLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC50YXJnZXQueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd5MicsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnRhcmdldC55O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBvbiB0aGUgc3RhcnQgb2YgdGhlIGQzIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqIFdpbGwgb3ZlcnJpZGUgdGhlIG1ldGhvZCBvZiB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqIFwidGhpc1wiIHBvaW50cyB0byB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2QzRm9yY2VFbmQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGQzRm9yY2VFbmQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZVBvbGljeSA9IHN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlUG9saWN5LmxheW91dERlZmF1bHQgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmYXVsdExheW91dCA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdExheW91dFtuLmlkXSA9IHsgeDogbi54LCB5OiBuLnkgfTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5LmxheW91dERlZmF1bHQgPSBkZWZhdWx0TGF5b3V0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2NhbGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdHJhbnNsYXRlID0gdGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5Lnpvb21EZWZhdWx0ID0gW3RyYW5zbGF0ZSwgc2NhbGVdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmF0dHIoJ2N4JywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCdjeScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHMuYXR0cigneDEnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5zb3VyY2UueDtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd5MScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnNvdXJjZS55O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3gyJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQudGFyZ2V0Lng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneTInLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC50YXJnZXQueTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBXaWxsIGJlIGNhbGxlZCBkdXJpbmcgRDMgZm9yY2Ugc2ltdWxhdGlvbnNcbiAgICAgICAgICAgICAqIGJ5IHRoZSBncmFwaCwgc28gXCJ0aGlzXCIgd2lsbCBwb2ludCB0byB0aGUgZ3JhcGggb2JqZWN0XG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge251bWJlcn0gIHdpZHRoICAgRDMgTGF5b3V0IFdpZHRoXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgaGVpZ2h0ICBEMyBMYXlvdXQgSGVpZ2h0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdkM0ZvcmNlVGljaycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZDNGb3JjZVRpY2soZSwgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kgPSBzdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IGNvbnN0cy5kaXNwbGF5T2Zmc2V0O1xuICAgICAgICAgICAgICAgIHZhciBzY2FsZSA9IHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCk7XG5cbiAgICAgICAgICAgICAgICAvLyBNb3ZlIG5vZGVzIHRvd2FyZCBjbHVzdGVyIGZvY3VzLlxuICAgICAgICAgICAgICAgIHZhciBmb2NpID0gc3RhdGVQb2xpY3kuZm9jaTtcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBncmF2aXR5KGFscGhhKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZvY2kubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID09PSBcImZvY3VzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55ICs9IChmb2NpWzBdIC0gZC55KSAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSArPSAoZm9jaVsxXSAtIGQueSkgKiBhbHBoYTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC54ICs9ICh3aWR0aCAvIDIgLSBkLngpICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSArPSAoaGVpZ2h0IC8gMiAtIGQueSkgKiBhbHBoYTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnggKz0gKHdpZHRoIC8gMiAtIGQueCkgKiBhbHBoYTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBNYWtlIHN1cmUgbm9kZXMgYXJlIHdpdGhpbiBib3VuZHNcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcy5lYWNoKHRoaXMuZDNGb3JjZUNvbGxpZGUoLjUpKS5lYWNoKGdyYXZpdHkoLjIgKiBlLmFscGhhKSkuYXR0cihcImN4XCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnggPSBNYXRoLm1heCgoZC5yYWRpdXMgKyBvZmZzZXQpIC8gc2NhbGUsIE1hdGgubWluKHdpZHRoICsgKC1vZmZzZXQgLSBkLnJhZGl1cykgLyBzY2FsZSwgZC54KSk7XG4gICAgICAgICAgICAgICAgfSkuYXR0cihcImN5XCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLlNwbGl0Sm9pblZpZXdQb2xpY3kgPT0gbnVsbCB8fCBkLlNwbGl0Sm9pblZpZXdQb2xpY3kgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC55ID0gTWF0aC5tYXgoKGQucmFkaXVzICsgb2Zmc2V0KSAvIHNjYWxlLCBNYXRoLm1pbihoZWlnaHQgKyAoLW9mZnNldCAtIGQucmFkaXVzKSAvIHNjYWxlLCBkLnkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPT09IFwiZm9jdXNcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC55ID0gTWF0aC5tYXgoZC5yYWRpdXMgKyBvZmZzZXQsIE1hdGgubWluKChoZWlnaHQgKyAoLW9mZnNldCAtIGQucmFkaXVzKSAvIHNjYWxlKSAqIGNvbnN0cy5TcGxpdEpvaW5WaWV3UG9saWN5LmJvdW5kYXJ5LCBkLnkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPT09IFwiY29ubmVjdGVkXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQueSA9IE1hdGgubWF4KChoZWlnaHQgKyAob2Zmc2V0IC0gZC5yYWRpdXMpIC8gc2NhbGUpICogY29uc3RzLlNwbGl0Sm9pblZpZXdQb2xpY3kuYm91bmRhcnksIE1hdGgubWluKGhlaWdodCArICgtb2Zmc2V0IC0gZC5yYWRpdXMpIC8gc2NhbGUsIGQueSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzLmF0dHIoJ3gxJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuc291cmNlLng7XG4gICAgICAgICAgICAgICAgfSkuYXR0cigneTEnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5zb3VyY2UueTtcbiAgICAgICAgICAgICAgICB9KS5hdHRyKCd4MicsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnRhcmdldC54O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ3kyJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQudGFyZ2V0Lnk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsY3VsYXRlcyB0aGUgYm91bmRhcmllcyBvZiB0aGUgc2ltdWxhdGlvblxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBXaWxsIGJlIGNhbGxlZCBkdXJpbmcgRDMgZm9yY2Ugc2ltdWxhdGlvbnNcbiAgICAgICAgICAgICAqIGJ5IHRoZSBncmFwaCwgc28gXCJ0aGlzXCIgd2lsbCBwb2ludCB0byB0aGUgZ3JhcGggb2JqZWN0XG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtPYmplY3R9ICAgICAgICAgIFJldHVybnMgYW4gb2JqZWN0XG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGF0IGhhcyB0aGUgd2lkdGhcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZCBoZWlnaHQgYXMgXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzIFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnZDNGb3JjZUJvdW5kcycsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZDNGb3JjZUJvdW5kcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0c1BvbGljeSA9IGNvbnN0cy5TcGxpdEpvaW5WaWV3UG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZVBvbGljeSA9IHN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNhbGNNYXhOb2Rlcyh3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhcmVhID0gd2lkdGggKiBoZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciByYWRpdXMgPSB0aGlzR3JhcGguY29uc3RzLnN0YXJ0UmFkaXVzO1xuICAgICAgICAgICAgICAgICAgICAvL3RyZWF0aW5nIHRoZW0gYXMgYSBzcXVhcmUgZm9yIGFwcHJveFxuICAgICAgICAgICAgICAgICAgICB2YXIgbGVuZ3RoID0gcmFkaXVzICogMy41O1xuICAgICAgICAgICAgICAgICAgICB2YXIgYW1vdW50ID0gYXJlYSAvIChsZW5ndGggKiBsZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYW1vdW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL1RoZSBvZmZzZXQgaXMgdGhlIGJ1ZmZlciBmcm9tIHRoZSBlZGdlc1xuICAgICAgICAgICAgICAgIC8vT3JpZ2luYWwgV2lkdGggYW5kIEhlaWdodCBhcmUgZ2l2ZW4gdG8gdGhlIGZvcmNlIGxheW91dFxuICAgICAgICAgICAgICAgIC8vc28gdGhhdCBpdCBpcyBjZW50ZXJlZCwgYnV0IG5vZGVzIHdpbGwgYmUgZm9yY2VkIHRvIGJlXG4gICAgICAgICAgICAgICAgLy93aXRoaW4gdGhlIG9mZnNldCBib3VuZHNcbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gY29uc3RzLmRpc3BsYXlPZmZzZXQ7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z1dpZHRoID0gcGFyc2VGbG9hdCh0aGlzR3JhcGguc3ZnLnN0eWxlKFwid2lkdGhcIikpO1xuICAgICAgICAgICAgICAgIHZhciBzdmdIZWlnaHQgPSBwYXJzZUZsb2F0KHRoaXNHcmFwaC5zdmcuc3R5bGUoXCJoZWlnaHRcIikpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gc3ZnV2lkdGg7XG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IHN2Z0hlaWdodDtcblxuICAgICAgICAgICAgICAgIHZhciBhbW91bnQgPSBjYWxjTWF4Tm9kZXMod2lkdGggLSAyICogb2Zmc2V0LCBoZWlnaHQgLSAyICogb2Zmc2V0KTtcbiAgICAgICAgICAgICAgICB2YXIgc2NhbGUgPSAxO1xuICAgICAgICAgICAgICAgIGlmIChub2Rlcy5sZW5ndGggPiBhbW91bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NhbGUgPSBhbW91bnQgLyBub2Rlcy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQodGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKCksIHNjYWxlKTtcbiAgICAgICAgICAgICAgICAgICAgd2lkdGggLz0gc2NhbGU7XG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCAvPSBzY2FsZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguem9vbWVkKHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpLCBzY2FsZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9jYWxjdWxhdGluZyBmb2NpIGZvciBzaW11bGF0aW9uXG4gICAgICAgICAgICAgICAgdmFyIGZvY3VzR3JvdXBzID0gc3RhdGVQb2xpY3kuZm9jdXNHcm91cHM7XG4gICAgICAgICAgICAgICAgdmFyIGZvY2k7XG4gICAgICAgICAgICAgICAgaWYgKGZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBmb2NpID0gW2hlaWdodCAvIDJdO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vc2V0dGluZyBmb2NpIGhlaWdodCBwb3NpdGlvbiBiYXNlZCBvbiBwZXJjZW50YWdlXG4gICAgICAgICAgICAgICAgICAgIHZhciBmb2N1c05vZGVzID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0W2ZvY3VzR3JvdXBzWzBdXTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzUG9saWN5LmJvdW5kYXJ5ID0gZm9jdXNOb2Rlcy5sZW5ndGggLyBub2Rlcy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0b3AgPSBoZWlnaHQgKiBjb25zdHNQb2xpY3kuYm91bmRhcnk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBib3QgPSBoZWlnaHQgLSB0b3A7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0b3AgPCAyICogdGhpc0dyYXBoLmNvbnN0cy5tYXhSYWRpdXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0c1BvbGljeS5ib3VuZGFyeSA9IDIuNSAqIHRoaXNHcmFwaC5jb25zdHMubWF4UmFkaXVzIC8gaGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9wID0gaGVpZ2h0ICogY29uc3RzUG9saWN5LmJvdW5kYXJ5O1xuICAgICAgICAgICAgICAgICAgICAgICAgYm90ID0gaGVpZ2h0IC0gdG9wO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChib3QgPCAyICogdGhpc0dyYXBoLmNvbnN0cy5tYXhSYWRpdXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0c1BvbGljeS5ib3VuZGFyeSA9IDEgLSAyLjUgKiB0aGlzR3JhcGguY29uc3RzLm1heFJhZGl1cyAvIGhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvcCA9IGhlaWdodCAqIGNvbnN0c1BvbGljeS5ib3VuZGFyeTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvdCA9IGhlaWdodCAtIHRvcDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmb2NpID0gW3RvcCAvIDIsIHRvcCArIGJvdCAvIDJdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdGF0ZVBvbGljeS5mb2NpID0gZm9jaTtcbiAgICAgICAgICAgICAgICByZXR1cm4geyB3aWR0aDogd2lkdGgsIGhlaWdodDogaGVpZ2h0IH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIGFmdGVyIGEgc2luZ2xlIG5vZGUgaXMgc3BsaXRcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbmV3Tm9kZXMgIFRoZSBuZXcgbm9kZXNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3NwbGl0Tm9kZUV2ZW50JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzcGxpdE5vZGVFdmVudChuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKG5ld05vZGVzLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF8uaW5jbHVkZXMoY2hpbGRyZW5fc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzBdXSwgZC5pZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJmb2N1c1wiO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImNvbm5lY3RlZFwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSBuZXdOb2Rlc1swXS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgLy8gc3RhdGUuZm9jdXNHcm91cCA9IHRpdGxlO1xuXG4gICAgICAgICAgICAgICAgLy9pZiB0aGUgbGFzdCBldmVudCBoYXMgdGhlIHNhbWUgaWQsIGl0IG11c3QgYmUgdGhlXG4gICAgICAgICAgICAgICAgLy9vcHBwb3NpdGUgb2YgdGhpcyBldmVudCwgc28gd2UgcmVtb3ZlIHRoYXQgZXZlbnQgZnJvbVxuICAgICAgICAgICAgICAgIC8vdGhlIGV2ZW50IHN0YWNrLlxuICAgICAgICAgICAgICAgIC8vT3RoZXJ3aXNlLCB3ZSBhZGQgdGhlIGV2ZW50IG90IHRoZSBzdGFja1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoICE9PSAwICYmIHN0YXRlLmV2ZW50SGlzdG9yeVtzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoIC0gMV0uaWQgPT09IHRpdGxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeS5wb3AoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkucHVzaCh7IGlkOiB0aXRsZSwgZXZlbnQ6ICdzcGxpdCcgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmJhY2tCdXR0b25FbGVtICE9IG51bGwgJiYgc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uRWxlbS5mYWRlVG8oJ3Nsb3cnLCAxKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUudGl0bGVFbGVtICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSBzdGF0ZS5mb2N1c0dyb3Vwc1swXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ICs9ICcgJiAnICsgc3RhdGUuZm9jdXNHcm91cHNbMV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc3RhdGUudGl0bGVFbGVtLnRleHQodGV4dCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9yZS1lbmFibGUgZ3JhcGggdXBkYXRlXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN0YXRlLmRpc2FibGVVcGRhdGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnNldExheW91dCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNldHMgdGhlIGxheW91dCBvZiB0aGUgbm9kZXMuIFxuICAgICAgICAgICAgICogSWYgdGhlcmUgaXMgYSBwcmV2aW91cyBsYXlvdXQsIGl0IHdpbGwgYmUgbG9hZGVkLlxuICAgICAgICAgICAgICogRWxzZSwgaXQgd2lsbCBydW4gYSBEMyBGb3JjZSBzaW11bGF0aW9uIGFuZCBjcmVhdGUgb25lLlxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnc2V0TGF5b3V0JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRMYXlvdXQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuICAgICAgICAgICAgICAgIHZhciBsYXlvdXQ7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBsYXlvdXQgPSBzdGF0ZS5sYXlvdXREZWZhdWx0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbSA9IHN0YXRlLnpvb21EZWZhdWx0O1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguem9vbWVkKHpvb21bMF0sIHpvb21bMV0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB6b29tID0gc3RhdGUuem9vbXNbc3RhdGUuZm9jdXNHcm91cHNdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoem9vbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguem9vbWVkKHpvb21bMF0sIHpvb21bMV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGxheW91dCA9IHN0YXRlLmxheW91dFtzdGF0ZS5mb2N1c0dyb3Vwc107XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGxheW91dCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9zID0gbGF5b3V0W24uaWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBvcyA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cobGF5b3V0LCBuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG4ueCA9IHBvcy54O1xuICAgICAgICAgICAgICAgICAgICAgICAgbi55ID0gcG9zLnk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGguY2FsbCh0aGlzR3JhcGgsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kudXBkYXRlR3JhcGhDYWxsYmFjay5jYWxsKHRoaXNQb2xpY3kpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL05lZWQgdG8gcnVuIGEgZm9yY2Ugc2ltdWxhdGlvbiBhcyB0aGlzIGxheW91dFxuICAgICAgICAgICAgICAgICAgICAvL2hhc24ndCBiZWVuIGRvbmUgYmVmb3JlXG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZS5pbml0Rm9yY2UgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhpc1BvbGljeS5zZXRQb3NpdGlvbnMoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kudXBkYXRlR3JhcGhDYWxsYmFjay5jYWxsKHRoaXNQb2xpY3kpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuem9vbXNbc3RhdGUuZm9jdXNHcm91cHNdID0gW3RoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpLCB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxheW91dCA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0W24uaWRdID0geyB4OiBuLngsIHk6IG4ueSB9O1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUubGF5b3V0W3N0YXRlLmZvY3VzR3JvdXBzXSA9IGxheW91dDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogT3ZlcnJpZGluZyBmcm9tIHN1cGVyIGNsYXNzIHNvIHRoYXQgd2UgY2FuIGhhdmVcbiAgICAgICAgICAgICAqIHRvcCBsZXZlbCBub2RlcyByZWFwcGVhciB3aGVuIHRoZXkgYXJlIGhpZGRlblxuICAgICAgICAgICAgICogZHVlIHRvIHRoZXJlIGJlaW5nIHR3byBmb2N1cyBncm91cHMuXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgICAgICBub2RlICAgIFRoZSBub2RlIHRvIGpvaW5cbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtOb2RlfSAgVGhlIG5ldyBub2RlIGFmdGVyIHRoZSBqb2luXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdfX2pvaW5Ob2RlJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfX2pvaW5Ob2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVTdXBlciA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5Ob2RlUG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgLy9jaGVjayB0aGF0IG5vZGUgc3RpbGwgZXhpc3RzXG4gICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG5vZGUpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gbm9kZS5pZDtcbiAgICAgICAgICAgICAgICAvL2lmIGl0IGhhcyBubyBhbmNlc3Rvciwgbm90aGluZyB0byBqb2luXG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbC5pbmRleE9mKG5hbWUpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBub2RlLnBhcmVudDtcbiAgICAgICAgICAgICAgICB2YXIgdG9fYmVfZGVsZXRlZCA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBub2RlTmFtZVNldCA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpc0dyYXBoLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgbm9kZSB3b24ndCBiZSBjb2xsYXBzZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5ub2Rlc1tpXS5hbmNlc3RvcnMuaW5kZXhPZihub2RlLnBhcmVudCkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVOYW1lU2V0LnB1c2godGhpc0dyYXBoLm5vZGVzW2ldLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvX2JlX2RlbGV0ZWQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZV9pZCA9IG5vZGUucGFyZW50O1xuICAgICAgICAgICAgICAgIG5vZGVOYW1lU2V0LnB1c2gobm9kZS5wYXJlbnQpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFuY2VzdG9yc19zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5hbmNlc3RvcnNfc3RydWN0O1xuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgLy8gLSBzZXR0aW5nIGZvY3VzR3JvdXBzIC1cbiAgICAgICAgICAgICAgICAvL2VpdGhlciByZXBsYWNpbmcgb25lIG9mIHRoZSBncm91cHMsXG4gICAgICAgICAgICAgICAgLy9vciBqb2luaW5nIGJhY2sgaW50byBhIHRvcCBsZXZlbCwgc28gdGhlcmUgaXMgb25seVxuICAgICAgICAgICAgICAgIC8vb25lIGZvY3VzXG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gc3RhdGUuZm9jdXNHcm91cHMuaW5kZXhPZihwYXJlbnQpO1xuICAgICAgICAgICAgICAgIGlmIChhbmNlc3RvcnNfc3RydWN0W3BhcmVudF0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwc1tpbmRleF0gPSBhbmNlc3RvcnNfc3RydWN0W3BhcmVudF07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL25hbWVUb0FkZCBhcmUgdG9wIGxldmVsIG5vZGVzIHRoYXQgYXJlIHRvIGJlIGFkZGVkXG4gICAgICAgICAgICAgICAgLy90byB0aGUgZ3JhcGguXG4gICAgICAgICAgICAgICAgdmFyIG5hbWVUb0FkZCA9IFtdO1xuICAgICAgICAgICAgICAgIC8vd2lsbCBvbmx5IG5lZWQgdG8gYWRkIGEgdG9wIGxldmVsIG5vZGUgaWYgdGhlcmUgaXNcbiAgICAgICAgICAgICAgICAvL29ubHkgb25lIGZvY3VzXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAvL0FkZCBvbmx5IHRob3N0IHRoYXQgYXJlbid0IGFuIGFuY2VzdG9yIG9mIHRoZSBub2RlXG4gICAgICAgICAgICAgICAgICAgIC8vdG8gam9pbiwgdGhlIGZvY3VzIGdyb3VwIG9yIGFuIGFuY2VzdG9yIG9mIGl0LFxuICAgICAgICAgICAgICAgICAgICAvL2FuZCBhcmVuJ3QgYWxyZWFkeSBpbiBub2RlTmFtZVNldC5cbiAgICAgICAgICAgICAgICAgICAgLy9nZXQgZmxvdyBiZXR3ZWVuIHRvcCBsZXZlbCBhcyBsb25nIGFzXG4gICAgICAgICAgICAgICAgICAgIC8vdGhlIHRvcCBsZXZlbCBpc24ndCBhbiBhbmNlc3RvciBvZiB0aGVcbiAgICAgICAgICAgICAgICAgICAgLy9mb2N1cyBncm91cCwgYW5kIGlzbid0IGFscmVhZHkgcGFydCBvZiB0aGVcbiAgICAgICAgICAgICAgICAgICAgLy9ub2RlIHNldDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFuY2VzdG9ycyA9IGFuY2VzdG9yc19zdHJ1Y3Rbbm9kZS5pZF07XG4gICAgICAgICAgICAgICAgICAgIGFuY2VzdG9ycy5wdXNoKHN0YXRlLmZvY3VzR3JvdXBzWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgLy90aGUgb3IgZW1wdHkgYXJyYXkgaXMgdG8gcHJldmVudCBjb25jYXRlbmF0aW5nIGEgbnVsbFxuICAgICAgICAgICAgICAgICAgICAvL29yIHVuZGVmaW5lZCB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICBhbmNlc3RvcnMgPSBhbmNlc3RvcnMuY29uY2F0KGFuY2VzdG9yc19zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dIHx8IFtdKTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKGNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbCwgZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhbmNlc3RvcnMuaW5kZXhPZihuKSA9PT0gLTEgJiYgbm9kZU5hbWVTZXQuaW5kZXhPZihuKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVUb0FkZC5wdXNoKG4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZU5hbWVTZXQgPSBub2RlTmFtZVNldC5jb25jYXQobmFtZVRvQWRkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAvL25vIGZvY3VzIGdyb3VwcyBtZWFucyB3ZSBhcmUgYXQgdG9wIGxldmVsXG4gICAgICAgICAgICAgICAgICAgIC8vU2hvdWxkIGFkZCBhbnkgdG9wIGxldmVsIG5vZGVzIHRoYXQgYXJlbid0XG4gICAgICAgICAgICAgICAgICAgIC8vYWxyZWFkeSB0aGVyZVxuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goY2hpbGRyZW5fc3RydWN0LnRvcExldmVsLCBmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGVOYW1lU2V0LmluZGV4T2YobikgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lVG9BZGQucHVzaChuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVOYW1lU2V0ID0gbm9kZU5hbWVTZXQuY29uY2F0KG5hbWVUb0FkZCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9mb3JtYXR0aW5nIGRhdGFcbiAgICAgICAgICAgICAgICB2YXIgcmFkaXVzID0gbm9kZS5yYWRpdXMgLyB0aGlzR3JhcGguY29uc3RzLnJhZGl1c0RlY2F5O1xuICAgICAgICAgICAgICAgIHZhciB4TG9jID0gbm9kZS54O1xuICAgICAgICAgICAgICAgIHZhciB5TG9jID0gbm9kZS55O1xuICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBub2RlLmFuY2VzdG9yc1sxXTtcbiAgICAgICAgICAgICAgICB2YXIgYW5jZXN0b3JzID0gbm9kZS5hbmNlc3RvcnMuc2xpY2UoMSk7XG4gICAgICAgICAgICAgICAgdmFyIG5ld05vZGUgPSBuZXcgVmlzdWFsaXplck5vZGUuTm9kZSh4TG9jLCB5TG9jLCBuZXdfbm9kZV9pZCwgbmV3X25vZGVfaWQsIHJhZGl1cywgcGFyZW50LCBhbmNlc3RvcnMpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5wdXNoKG5ld05vZGUpO1xuXG4gICAgICAgICAgICAgICAgLy9yZW1vdmUgYWxsIG5vZGVzIHRoYXQgd2lsbCBiZSBqb2luZWRcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRvX2JlX2RlbGV0ZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVfdG9fZGVsZXRlID0gdG9fYmVfZGVsZXRlZFtpXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnNwbGljZSh0aGlzR3JhcGgubm9kZXMuaW5kZXhPZihub2RlX3RvX2RlbGV0ZSksIDEpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3BsaWNlTGlua3NGb3JOb2RlKG5vZGVfdG9fZGVsZXRlKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgcmV0RGF0YSA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmdldEZsb3dCZXR3ZWVuU2V0KG5vZGVOYW1lU2V0KTtcbiAgICAgICAgICAgICAgICAvL2hvbGRzIHRoZSBub2RlRGF0YSB3aGljaCB3aWxsIGJlIHByb2Nlc3NlZFxuICAgICAgICAgICAgICAgIHZhciBub2Rlc1RvUHJvY2VzcyA9IFtdO1xuICAgICAgICAgICAgICAgIC8vZmluZGluZyB0aGUgbm9kZSBkYXRhIHRoYXQgY29ycmVzcG9uZHMgdG8gdGhlIHRvcCBsZXZlbFxuICAgICAgICAgICAgICAgIC8vbm9kZXMgdG8gYWRkIC0gbmFtZVRvQWRkLlxuICAgICAgICAgICAgICAgIHZhciBub2RlRGF0YSA9IHJldERhdGEubm9kZURhdGE7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2RlRGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAobmFtZVRvQWRkLmluZGV4T2Yobm9kZURhdGFbaV0uaWQpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNUb1Byb2Nlc3MucHVzaChub2RlRGF0YVtpXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL1RoZSB0b3AgbGV2ZWwgbm9kZXMgdGhhdCBhcmUgYWRkZWRcbiAgICAgICAgICAgICAgICB2YXIgbmV3Tm9kZXMgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5wcm9jZXNzTm9kZURhdGEobm9kZXNUb1Byb2Nlc3MpO1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaChuZXdOb2RlcywgZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgbi5yYWRpdXMgPSBuLnJhZGl1cyB8fCB0aGlzR3JhcGguY29uc3RzLnN0YXJ0UmFkaXVzO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlcyA9IHRoaXNHcmFwaC5ub2Rlcy5jb25jYXQobmV3Tm9kZXMpO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UucHJvY2Vzc0xpbmtEYXRhKHJldERhdGEubGlua0RhdGEsIHRoaXNHcmFwaC5ub2Rlcyk7XG4gICAgICAgICAgICAgICAgLy9Pbmx5IGtlZXAgdG9wIGxldmVsIG5vZGVzIHRoYXQgaGF2ZSBjb25uZWN0aW9ucyB0b1xuICAgICAgICAgICAgICAgIC8vdGhlIGN1cnJlbnQgZm9jdXMgZ3JvdXBcbiAgICAgICAgICAgICAgICAvL3dlIHJlbW92ZSB0aGUgbm9kZSBuYW1lIGZyb20gbmFtZVRvQWRkIGlmIHdlIGFyZVxuICAgICAgICAgICAgICAgIC8va2VlcGluZyBpdFxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5saW5rcywgZnVuY3Rpb24gKGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vY2hlY2tpbmcgaWYgdGhlcmUgZXhpc3RzIGEgbGluayB0b3VjaGluZyBlYWNoIG9mIG5hbWVUb0FkZFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWVUb0FkZC5pbmRleE9mKGwuc291cmNlLmlkKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHNbMF0gPT09IGwudGFyZ2V0LnBhcmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lVG9BZGQuc3BsaWNlKG5hbWVUb0FkZC5pbmRleE9mKGwuc291cmNlLmlkKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChuYW1lVG9BZGQuaW5kZXhPZihsLnRhcmdldC5pZCkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzWzBdID09PSBsLnNvdXJjZS5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkLnNwbGljZShuYW1lVG9BZGQuaW5kZXhPZihsLnRhcmdldC5pZCksIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy9XZSB3YW50IHRvIGtlZXAgdGhlbSBhbGxcbiAgICAgICAgICAgICAgICAgICAgLy9zaW5jZSBhbnkgbGVmdCBpbiBuYW1lVG9BZGQgd2lsbCBiZSByZW1vdmVkLFxuICAgICAgICAgICAgICAgICAgICAvL3dlIHJlc2V0IG5hbWVUb0FkZCBoZXJlLlxuICAgICAgICAgICAgICAgICAgICBuYW1lVG9BZGQgPSBbXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3doYXRldmVyIGlzIHJlbWFpbmluZyBpbiBuYW1lVG9BZGQgaXNuJ3QgY29ubmVjdGVkXG4gICAgICAgICAgICAgICAgLy90byB0aGUgZm9jdXMgZ3JvdXAsIHNvIHdlIHNob3VsZCByZW1vdmUgaXQuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVUb1JlbW92ZSA9IFtdO1xuICAgICAgICAgICAgICAgIGlmIChuYW1lVG9BZGQubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpc0dyYXBoLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmFtZVRvQWRkLmluZGV4T2YodGhpc0dyYXBoLm5vZGVzW2ldLmlkKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lVG9BZGQuc3BsaWNlKG5hbWVUb0FkZC5pbmRleE9mKHRoaXNHcmFwaC5ub2Rlc1tpXS5pZCksIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zcGxpY2VMaW5rc0Zvck5vZGUodGhpc0dyYXBoLm5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlVG9SZW1vdmUucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuYW1lVG9BZGQubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfLmZvckVhY2gobm9kZVRvUmVtb3ZlLCBmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMuc3BsaWNlKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG4pLCAxKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0Tm9kZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdExpbmtzKCk7XG5cbiAgICAgICAgICAgICAgICBzdGF0ZVN1cGVyLnNwbGl0Tm9kZXMuc3BsaWNlKHN0YXRlU3VwZXIuc3BsaXROb2Rlcy5pbmRleE9mKG5ld05vZGUuaWQpLCAxKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBuZXdOb2RlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBhIHNpbmdsZSBub2RlIGlzIGpvaW5lZFxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBJZiB0aGUgZm9jdXMgZ3JvdXAgaGFzIGJlZW4gc2VlbiBiZWZvcmUsIGl0IHdpbGxcbiAgICAgICAgICAgICAqIGxvYWQgdGhhdCBsYXlvdXQuIE90aGVyd2lzZSwgaXQgd2lsbCBydW4gYSBkMyBmb3JjZVxuICAgICAgICAgICAgICogc2ltdWxhdGlvbiB0byBnZW5lcmF0ZSBvbmUuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBuZXdOb2RlICBUaGUgbmV3IG5vZGVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2pvaW5Ob2RlRXZlbnQnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGpvaW5Ob2RlRXZlbnQobmV3Tm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5ID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIC8vaWYgdGhlIGxhc3QgZXZlbnQgaGFzIHRoZSBzYW1lIGlkLCBpdCBtdXN0IGJlIHRoZVxuICAgICAgICAgICAgICAgIC8vb3BwcG9zaXRlIG9mIHRoaXMgZXZlbnQsIHNvIHdlIHJlbW92ZSB0aGF0IGV2ZW50IGZyb21cbiAgICAgICAgICAgICAgICAvL3RoZSBldmVudCBzdGFjay5cbiAgICAgICAgICAgICAgICAvL090aGVyd2lzZSwgd2UgYWRkIHRoZSBldmVudCB0byB0aGUgc3RhY2tcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCAhPT0gMCAmJiBzdGF0ZS5ldmVudEhpc3Rvcnlbc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCAtIDFdLmlkID09PSBuZXdOb2RlLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmV2ZW50SGlzdG9yeS5wb3AoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkucHVzaCh7IGlkOiBuZXdOb2RlLmlkLCBldmVudDogJ2pvaW4nIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG5cbiAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF8uaW5jbHVkZXMoY2hpbGRyZW5fc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzBdXSwgZC5pZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJmb2N1c1wiO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImNvbm5lY3RlZFwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvL3NldHRpbmcgYmFjayBidXR0b25cbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuYmFja0J1dHRvbkVsZW0gIT0gbnVsbCAmJiBzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmJhY2tCdXR0b25FbGVtLmZhZGVUbygnc2xvdycsIDApO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vc2V0dGluZyB0aXRsZVxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS50aXRsZUVsZW0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ICs9IHN0YXRlLmZvY3VzR3JvdXBzWzBdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0gJyAmICcgKyBzdGF0ZS5mb2N1c0dyb3Vwc1sxXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS50aXRsZUVsZW0udGV4dCh0ZXh0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpc1BvbGljeS5zZXRMYXlvdXQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVbmRvZXMgdGhlIGxhc3Qgc3BsaXQgb3Igam9pbiBldmVudC5cbiAgICAgICAgICAgICAqIE1lYW50IHRvIGJlIGNhbGxlZCBieSB0aGUgYmFjayBidXR0b24uXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICd1bmRvTGFzdEV2ZW50JyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1bmRvTGFzdEV2ZW50KCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5ID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcblxuICAgICAgICAgICAgICAgIHZhciBsYXN0ID0gc3RhdGUuZXZlbnRIaXN0b3J5W3N0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgICB2YXIgaWQgPSBsYXN0LmlkO1xuICAgICAgICAgICAgICAgIHZhciBub2RlO1xuICAgICAgICAgICAgICAgIGlmIChsYXN0LmV2ZW50ID09PSAnam9pbicpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZSA9IHRoaXNHcmFwaC5maW5kTm9kZUJ5SWQoaWQpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZDNub2RlID0gdGhpc0dyYXBoLmZpbmREM05vZGUoaWQpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LmRibGNsaWNrKGQzbm9kZSwgbm9kZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVJZCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFtpZF1bMF07XG4gICAgICAgICAgICAgICAgICAgIG5vZGUgPSB0aGlzR3JhcGguZmluZE5vZGVCeUlkKG5vZGVJZCk7XG4gICAgICAgICAgICAgICAgICAgIF9nZXQoU3BsaXRKb2luVmlld1BvbGljeS5wcm90b3R5cGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihTcGxpdEpvaW5WaWV3UG9saWN5LnByb3RvdHlwZSksICdqb2luTm9kZScsIHRoaXMpLmNhbGwodGhpc1BvbGljeSwgbm9kZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIFNwbGl0Sm9pblZpZXdQb2xpY3k7XG4gICAgfShTcGxpdEpvaW5Ob2RlUG9saWN5LlBvbGljeSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBQb2xpY3k6IFNwbGl0Sm9pblZpZXdQb2xpY3lcbiAgICB9O1xufV0pO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2RlcycsIHtcbiAgICAgICAgICAgIHVybDogJy9ub2RlcycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcFxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5vcmdhbml6YXRpb25zJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucycsIHtcbiAgICAgICAgICAgIHVybDogJy9vcmdhbml6YXRpb25zJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc2VydmljZWxicycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2VydmljZWxicycsIHtcbiAgICAgICAgICAgIHVybDogJy9zZXJ2aWNlbGJzJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnNldHRpbmdzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncycsIHtcbiAgICAgICAgICAgIHVybDogJy9nbG9iYWwnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvc2V0dGluZ3MnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXR0aW5ncy9zZXR0aW5nc21lbnUuaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5sb2dzJywge1xuICAgICAgICAgICAgdXJsOiAnL2xvZ3MnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJycsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5hdXRoJywge1xuICAgICAgICAgICAgdXJsOiAnL2F1dGgnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJycsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5saWNlbnNlJywge1xuICAgICAgICAgICAgdXJsOiAnL2xpY2Vuc2UnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJycsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5wb2xpY2llcycsIHtcbiAgICAgICAgICAgIHVybDogJy9wb2xpY2llcycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnJ1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc3RvcmFnZXBvbGljaWVzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvc3RvcmFnZXBvbGljaWVzJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG5cblxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52aXN1YWxpemF0aW9uJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscycsIFxuXHQnY29udGl2LmdyYXBoJ10pXG4gLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdjb250aXYubWVudS52aXN1YWxpemF0aW9uJywge1xuICAgICAgICAgICAgdXJsOiAnL3Zpc3VhbGl6YXRpb24nLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgfV0pO1xuXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudm9sdW1lcycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUudm9sdW1lcycsIHtcbiAgICAgICAgICAgIHVybDogJy92b2x1bWVzJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwXG4ndXNlIHN0cmljdCc7XG4vLyBEZWNsYXJlIGFwcCBsZXZlbCBtb2R1bGUgd2hpY2ggZGVwZW5kcyBvbiB2aWV3cywgYW5kIGNvbXBvbmVudHNcbmFuZ3VsYXIubW9kdWxlKCdjb250aXZBcHAnLCBbXG4gICAgJ3VpLnJvdXRlcicsXG4gICAgJ2NvbnRpdi5sb2dpbicsXG4gICAgJ2NvbnRpdi5tZW51JyxcbiAgICAnY29udGl2LmRhc2hib2FyZCcsXG4gICAgJ2NvbnRpdi5hcHBsaWNhdGlvbmdyb3VwcycsXG4gICAgJ2NvbnRpdi5uZXR3b3JrcycsXG4gICAgJ2NvbnRpdi5uZXR3b3JrcG9saWNpZXMnLFxuICAgICdjb250aXYuc3RvcmFnZXBvbGljaWVzJyxcbiAgICAnY29udGl2LnNlcnZpY2VsYnMnLFxuICAgICdjb250aXYudm9sdW1lcycsXG4gICAgJ2NvbnRpdi5ub2RlcycsXG4gICAgJ2NvbnRpdi5vcmdhbml6YXRpb25zJyxcbiAgICAnY29udGl2LnNldHRpbmdzJyxcbiAgICAnY29udGl2LnZpc3VhbGl6YXRpb24nXG5dKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsICckdXJsUm91dGVyUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYnLCB7XG4gICAgICAgICAgICB1cmw6ICcnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGZsdWlkIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pO1xuICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvJyk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzExLzE2LlxuICovXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMTAvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuYXBwbGljYXRpb25ncm91cHMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3Vwcy5jcmVhdGUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCBhcyBhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcGxpY2F0aW9uZ3JvdXBzL2FwcGxpY2F0aW9uZ3JvdXBjcmVhdGUuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ0FwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsJywgW1xuICAgICckc3RhdGUnLFxuICAgICckc3RhdGVQYXJhbXMnLFxuICAgICdBcHBsaWNhdGlvbkdyb3Vwc01vZGVsJyxcbiAgICAnTmV0d29ya3NNb2RlbCcsXG4gICAgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwsIE5ldHdvcmtzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCA9IHRoaXM7XG4gICAgICAgIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLm5ldHdvcmtzID0gW107XG4gICAgICAgIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLmFwcGxpY2F0aW9uR3JvdXAgPSB7fTtcbiAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwuc2VsZWN0ZWROZXR3b3JrID0ge307XG4gICAgICAgIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLm1vZGUgPSBcImVkaXRcIjtcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9BcHBsaWNhdGlvbkdyb3VwKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3Vwcy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub0FwcGxpY2F0aW9uR3JvdXAoKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IG5ldHdvcmtzIGZvciB0aGUgZ2l2ZW4gdGVuYW50LlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gZ2V0TmV0d29ya3MoKSB7XG4gICAgICAgICAgICBOZXR3b3Jrc01vZGVsLmdldCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLm5ldHdvcmtzID0gXy5maWx0ZXIocmVzdWx0LCB7XG4gICAgICAgICAgICAgICAgICAgICd0ZW5hbnROYW1lJzogJ2RlZmF1bHQnIC8vVE9ETzogUmVtb3ZlIGhhcmRjb2RlZCB0ZW5hbnQuXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVBcHBsaWNhdGlvbkdyb3VwKCkge1xuICAgICAgICAgICAgLy9mb3JtIGNvbnRyb2xsZXIgaXMgaW5qZWN0ZWQgYnkgdGhlIGh0bWwgdGVtcGxhdGVcbiAgICAgICAgICAgIC8vY2hlY2tpbmcgaWYgYWxsIHZhbGlkYXRpb25zIGhhdmUgcGFzc2VkXG4gICAgICAgICAgICBpZiAoYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybC5hcHBsaWNhdGlvbkdyb3VwLm5ldHdvcmtOYW1lID1cbiAgICAgICAgICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwuc2VsZWN0ZWROZXR3b3JrLm5ldHdvcmtOYW1lO1xuICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLmFwcGxpY2F0aW9uR3JvdXAua2V5ID1cbiAgICAgICAgICAgICAgICAgICAgQXBwbGljYXRpb25Hcm91cHNNb2RlbC5nZW5lcmF0ZUtleShhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybC5hcHBsaWNhdGlvbkdyb3VwKTtcbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBhcHBsaWNhdGlvbkdyb3VwIGNvbnNpc3Qgb2YgR3JvdXAgTmFtZSwgTmV0d29yayBOYW1lLCBJc29sYXRpb24gUG9saWNpZXMsIEJhbmR3aWR0aCBQb2xpY3lcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBBcHBsaWNhdGlvbkdyb3Vwc01vZGVsLmNyZWF0ZShhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybC5hcHBsaWNhdGlvbkdyb3VwKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvQXBwbGljYXRpb25Hcm91cCgpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmVzZXRGb3JtKCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwuYXBwbGljYXRpb25Hcm91cCA9IHtcbiAgICAgICAgICAgICAgICBncm91cE5hbWU6ICcnLFxuICAgICAgICAgICAgICAgIG5ldHdvcmtOYW1lOiAnJyxcbiAgICAgICAgICAgICAgICBwb2xpY2llczogW10sXG4gICAgICAgICAgICAgICAgbmV0UHJvZmlsZTogJycsXG4gICAgICAgICAgICAgICAgdGVuYW50TmFtZTogJ2RlZmF1bHQnIC8vVE9ETzogUmVtb3ZlIGhhcmRjb2RlZCB0ZW5hbnQuXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGdldE5ldHdvcmtzKCk7XG4gICAgICAgIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLmNyZWF0ZUFwcGxpY2F0aW9uR3JvdXAgPSBjcmVhdGVBcHBsaWNhdGlvbkdyb3VwO1xuICAgICAgICBhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybC5jYW5jZWxDcmVhdGluZyA9IGNhbmNlbENyZWF0aW5nO1xuICAgICAgICByZXNldEZvcm0oKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHBsaWNhdGlvbmdyb3VwY3JlYXRlY3RybC5qcy5tYXBcbi8qKlxuKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzE1LzE2LlxuKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuYXBwbGljYXRpb25ncm91cHMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3Vwcy5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsIGFzIGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcGxpY2F0aW9uZ3JvdXBzL2FwcGxpY2F0aW9uZ3JvdXBkZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmVkaXQnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZWRpdC86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwgYXMgYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwbGljYXRpb25ncm91cHMvYXBwbGljYXRpb25ncm91cGRldGFpbHMuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ0FwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCcsIFtcbiAgICAnJHN0YXRlJyxcbiAgICAnJHN0YXRlUGFyYW1zJyxcbiAgICAnQXBwbGljYXRpb25Hcm91cHNNb2RlbCcsXG4gICAgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwgPSB0aGlzO1xuICAgICAgICBhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwuYXBwbGljYXRpb25Hcm91cCA9IHt9O1xuICAgICAgICBhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwuc2VsZWN0ZWROZXR3b3JrID0ge307XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUbyBzaG93IGVkaXQgb3IgZGV0YWlscyBzY3JlZW4gYmFzZWQgb24gdGhlIHJvdXRlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBzZXRNb2RlKCkge1xuICAgICAgICAgICAgaWYgKCRzdGF0ZS5pcygnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMuZWRpdCcpKSB7XG4gICAgICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLm1vZGUgPSAnZWRpdCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwubW9kZSA9ICdkZXRhaWxzJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub0FwcGxpY2F0aW9uR3JvdXAoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub0FwcGxpY2F0aW9uR3JvdXBEZXRhaWxzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3Vwcy5kZXRhaWxzJywgeyAna2V5JzogYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLmFwcGxpY2F0aW9uR3JvdXAua2V5IH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbEVkaXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub0FwcGxpY2F0aW9uR3JvdXBEZXRhaWxzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZGVsZXRlQXBwbGljYXRpb25Hcm91cCgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwuZGVsZXRlKGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybC5hcHBsaWNhdGlvbkdyb3VwKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9BcHBsaWNhdGlvbkdyb3VwKCk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gc2F2ZUFwcGxpY2F0aW9uR3JvdXAoKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBBcHBsaWNhdGlvbkdyb3Vwc01vZGVsLnNhdmUoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLmFwcGxpY2F0aW9uR3JvdXApLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICByZXR1cm5Ub0FwcGxpY2F0aW9uR3JvdXBEZXRhaWxzKCk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsKTtcbiAgICAgICAgQXBwbGljYXRpb25Hcm91cHNNb2RlbC5nZXRNb2RlbEJ5S2V5KCRzdGF0ZVBhcmFtcy5rZXkpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZ3JvdXApIHtcbiAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybC5hcHBsaWNhdGlvbkdyb3VwID0gZ3JvdXA7XG4gICAgICAgIH0pO1xuICAgICAgICBhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwuc2F2ZUFwcGxpY2F0aW9uR3JvdXAgPSBzYXZlQXBwbGljYXRpb25Hcm91cDtcbiAgICAgICAgYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLmNhbmNlbEVkaXRpbmcgPSBjYW5jZWxFZGl0aW5nO1xuICAgICAgICBhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwuZGVsZXRlQXBwbGljYXRpb25Hcm91cCA9IGRlbGV0ZUFwcGxpY2F0aW9uR3JvdXA7XG4gICAgICAgIHNldE1vZGUoKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHBsaWNhdGlvbmdyb3VwZGV0YWlsc2N0cmwuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMTEvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuYXBwbGljYXRpb25ncm91cHMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3Vwcy5saXN0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0FwcGxpY2F0aW9uR3JvdXBMaXN0Q3RybCBhcyBhcHBsaWNhdGlvbkdyb3VwTGlzdEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHBsaWNhdGlvbmdyb3Vwcy9hcHBsaWNhdGlvbmdyb3VwbGlzdC5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignQXBwbGljYXRpb25Hcm91cExpc3RDdHJsJywgWyckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnQXBwbGljYXRpb25Hcm91cHNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBBcHBsaWNhdGlvbkdyb3Vwc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgYXBwbGljYXRpb25Hcm91cExpc3RDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gZ2V0QXBwbGljYXRpb25Hcm91cHMocmVsb2FkKSB7XG4gICAgICAgICAgICBBcHBsaWNhdGlvbkdyb3Vwc01vZGVsLmdldChyZWxvYWQpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYXBwbGljYXRpb25Hcm91cExpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICBhcHBsaWNhdGlvbkdyb3VwTGlzdEN0cmwuZ3JvdXBzID0gcmVzdWx0O1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGFwcGxpY2F0aW9uR3JvdXBMaXN0Q3RybCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgZ2V0QXBwbGljYXRpb25Hcm91cHMoZmFsc2UpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBzdGFydCBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0QXBwbGljYXRpb25Hcm91cHModHJ1ZSk7XG4gICAgICAgICAgICB9LCA1MDAwKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwbGljYXRpb25ncm91cGxpc3RjdHJsLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IGhhcmRpayBnYW5kaGkgb24gNi8yOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoXCJjb250aXYuYXBwbGljYXRpb25ncm91cHNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2QmFuZHdpZHRocG9saWN5XCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgbW9kZTogXCI9XCIsXG4gICAgICAgICAgICBhcHBsaWNhdGlvbmdyb3VwOiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgY29udHJvbGxlcjogW1xuICAgICAgICAgICAgJyRzY29wZScsXG4gICAgICAgICAgICAnTmV0cHJvZmlsZXNNb2RlbCcsXG4gICAgICAgICAgICBmdW5jdGlvbiAoJHNjb3BlLCBOZXRwcm9maWxlc01vZGVsKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLm5ldFByb2ZpbGVzID0gW107XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkTmV0cHJvZmlsZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5OiB7fVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogR2V0IHByb2ZpbGVzIGZvciB0aGUgZ2l2ZW4gdGVuYW50LlxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdldE5ldHByb2ZpbGVzKCkge1xuICAgICAgICAgICAgICAgICAgICBOZXRwcm9maWxlc01vZGVsLmdldCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm5ldFByb2ZpbGVzID0gXy5maWx0ZXIocmVzdWx0LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RlbmFudE5hbWUnOiAnZGVmYXVsdCcgLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5hcHBsaWNhdGlvbmdyb3VwLm5ldFByb2ZpbGUgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkTmV0cHJvZmlsZS5wb2xpY3kgPSBfLmZpbmQoJHNjb3BlLm5ldFByb2ZpbGVzLCBmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwb2xpY3kucHJvZmlsZU5hbWUgPT09ICRzY29wZS5hcHBsaWNhdGlvbmdyb3VwLm5ldFByb2ZpbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBBc3NpZ24gcHJvZmlsZU5hbWUgdG8gYXBwbGljYXRpb25ncm91cCB3aGljaGV2ZXIgdXNlciBoYXMgZ2l2ZW5cbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAkc2NvcGUudXBkYXRlQXBwbGljYXRpb25ncm91cCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5zZWxlY3RlZE5ldHByb2ZpbGUucG9saWN5ID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXBwbGljYXRpb25ncm91cC5uZXRQcm9maWxlID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXBwbGljYXRpb25ncm91cC5uZXRQcm9maWxlID0gJHNjb3BlLnNlbGVjdGVkTmV0cHJvZmlsZS5wb2xpY3kucHJvZmlsZU5hbWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGdldE5ldHByb2ZpbGVzKCk7XG4gICAgICAgICAgICB9XSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHBsaWNhdGlvbmdyb3Vwcy9iYW5kd2lkdGhwb2xpY3kuaHRtbCdcbiAgICB9O1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1iYW5kd2lkdGhwb2xpY3lkaXJlY3RpdmUuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgaGFyZGlrIGdhbmRoaSBvbiA3LzgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmFwcGxpY2F0aW9uZ3JvdXBzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dklzb2xhdGlvbnBvbGljeVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIG1vZGU6ICc9JyxcbiAgICAgICAgICAgIGFwcGxpY2F0aW9uZ3JvdXA6ICc9J1xuICAgICAgICB9LFxuICAgICAgICBjb250cm9sbGVyOiBbXG4gICAgICAgICAgICAnJHNjb3BlJyxcbiAgICAgICAgICAgICckc3RhdGVQYXJhbXMnLFxuICAgICAgICAgICAgJ0FwcGxpY2F0aW9uR3JvdXBzTW9kZWwnLFxuICAgICAgICAgICAgJ1BvbGljaWVzTW9kZWwnLFxuICAgICAgICAgICAgJ1J1bGVzTW9kZWwnLFxuICAgICAgICAgICAgZnVuY3Rpb24gKCRzY29wZSwgJHN0YXRlUGFyYW1zLCBBcHBsaWNhdGlvbkdyb3Vwc01vZGVsLCBQb2xpY2llc01vZGVsLCBSdWxlc01vZGVsKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmluY29taW5nUnVsZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAkc2NvcGUub3V0Z29pbmdSdWxlcyA9IFtdO1xuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZFBvbGljeSA9IHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5OiB7fVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkUG9saWNpZXMgPSBbXTsgLy8gVG8gU3RvcmUgcG9saWNpZXMgc2VsZWN0ZWQgYnkgdXNlciB0byBkaXNwbGF5XG4gICAgICAgICAgICAgICAgJHNjb3BlLmlzb2xhdGlvblBvbGljaWVzID0gW107IC8vIFRvIEdldCBhbGwgaXNvbGF0aW9uIHBvbGljaWVzIG9mIHRlbmFudFxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIEdldCBpbmNvbWluZyBhbmQgb3V0Z29pbmcgcnVsZXMgZm9yIGVhY2ggcG9saWN5IHByZXNlbnQgaW4gYXBwbGljYXRpb25ncm91cFxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdldFJ1bGVzKCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXBwbGljYXRpb25ncm91cC5wb2xpY2llcy5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vVG8gZGlzcGxheSBydWxlcyBvZiBzZWxlY3RlZCBwb2xpY2llc1xuICAgICAgICAgICAgICAgICAgICAgICAgUnVsZXNNb2RlbC5nZXRJbmNvbWluZ1J1bGVzKHBvbGljeSwgJ2RlZmF1bHQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChydWxlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KCRzY29wZS5pbmNvbWluZ1J1bGVzLCBydWxlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFJ1bGVzTW9kZWwuZ2V0T3V0Z29pbmdSdWxlcyhwb2xpY3ksICdkZWZhdWx0JylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocnVsZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseSgkc2NvcGUub3V0Z29pbmdSdWxlcywgcnVsZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBHZXQgcG9saWNpZXMgZm9yIHRoZSBnaXZlbiB0ZW5hbnQuXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0SXNvbGF0aW9uUG9saWNpZXMoKSB7XG4gICAgICAgICAgICAgICAgICAgIFBvbGljaWVzTW9kZWwuZ2V0KCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXNvbGF0aW9uUG9saWNpZXMgPSBfLmZpbHRlcihyZXN1bHQsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndGVuYW50TmFtZSc6ICdkZWZhdWx0JyAvL1RPRE86IFJlbW92ZSBoYXJkY29kZWQgdGVuYW50LlxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBBZGQgcG9saWN5IHRvIGFwcGxpY2F0aW9uIGdyb3VwXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFkZElzb2xhdGlvblBvbGljeSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRQb2xpY3lOYW1lID0gJHNjb3BlLnNlbGVjdGVkUG9saWN5LnBvbGljeS5wb2xpY3lOYW1lO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFBvbGljeU5hbWUgIT09IHVuZGVmaW5lZCAmJiBfLmluY2x1ZGVzKCRzY29wZS5zZWxlY3RlZFBvbGljaWVzLCBjdXJyZW50UG9saWN5TmFtZSkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vVG8gZGlzcGxheSBzZWxlY3RlZCBwb2xpY2llc1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkUG9saWNpZXMucHVzaChjdXJyZW50UG9saWN5TmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1RvIGRpc3BsYXkgcnVsZXMgb2Ygc2VsZWN0ZWQgcG9saWNpZXNcbiAgICAgICAgICAgICAgICAgICAgICAgIFJ1bGVzTW9kZWwuZ2V0SW5jb21pbmdSdWxlcyhjdXJyZW50UG9saWN5TmFtZSwgJ2RlZmF1bHQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChydWxlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KCRzY29wZS5pbmNvbWluZ1J1bGVzLCBydWxlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFJ1bGVzTW9kZWwuZ2V0T3V0Z29pbmdSdWxlcyhjdXJyZW50UG9saWN5TmFtZSwgJ2RlZmF1bHQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChydWxlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KCRzY29wZS5vdXRnb2luZ1J1bGVzLCBydWxlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vVG8gYmUgYWRkZWQgdG8gYXBwbGljYXRpb24gZ3JvdXAgYW5kIHNhdmVkIHRvIHRoZSBzZXJ2ZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hcHBsaWNhdGlvbmdyb3VwLnBvbGljaWVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnB1c2goY3VycmVudFBvbGljeU5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBSZW1vdmUgcG9saWN5IGZyb20gYXBwbGljYXRpb24gZ3JvdXBcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAkc2NvcGUucmVtb3ZlSXNvbGF0aW9uUG9saWN5ID0gZnVuY3Rpb24gKHBvbGljeU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgXy5yZW1vdmUoJHNjb3BlLnNlbGVjdGVkUG9saWNpZXMsIGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwb2xpY3kgPT09IHBvbGljeU5hbWU7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBfLnJlbW92ZSgkc2NvcGUuYXBwbGljYXRpb25ncm91cC5wb2xpY2llcywgZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBvbGljeSA9PT0gcG9saWN5TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIF8ucmVtb3ZlKCRzY29wZS5pbmNvbWluZ1J1bGVzLCBmdW5jdGlvbiAocnVsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJ1bGUucG9saWN5TmFtZSA9PT0gcG9saWN5TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIF8ucmVtb3ZlKCRzY29wZS5vdXRnb2luZ1J1bGVzLCBmdW5jdGlvbiAocnVsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJ1bGUucG9saWN5TmFtZSA9PT0gcG9saWN5TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiAgVG8gY2hlY2sgJ2RldGFpbHMnIG9yICdlZGl0JyBtb2RlIChub3QgY3JlYXRlIG1vZGUpXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5tb2RlID09ICdkZXRhaWxzJyB8fCAoJHNjb3BlLm1vZGUgPT0gJ2VkaXQnICYmICRzY29wZS5hcHBsaWNhdGlvbmdyb3VwLmdyb3VwTmFtZSAhPSBcIlwiKSkge1xuICAgICAgICAgICAgICAgICAgICAvL0FwcGxpY2F0aW9uIEdyb3VwcyBtaWdodCBub3QgaGF2ZSBhbnkgcG9saWNpZXMgYXNzb2NpYXRlZCB3aXRoIHRoZW0gc28gZGVmaW5lIGFuIGVtcHR5IGFycmF5XG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuYXBwbGljYXRpb25ncm91cC5wb2xpY2llcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXBwbGljYXRpb25ncm91cC5wb2xpY2llcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGdldFJ1bGVzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGdldElzb2xhdGlvblBvbGljaWVzKCk7XG4gICAgICAgICAgICB9XSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHBsaWNhdGlvbmdyb3Vwcy9pc29sYXRpb25wb2xpY3kuaHRtbCdcbiAgICB9O1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pc29sYXRpb25wb2xpY3lkaXJlY3RpdmUuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubG9naW4nKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubG9naW4nLCB7XG4gICAgICAgICAgICB1cmw6ICcvJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbG9naW4vbG9naW4uaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTG9naW5DdHJsIGFzIGxvZ2luQ3RybCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ0xvZ2luQ3RybCcsIFsnJHN0YXRlJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgbG9naW5DdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9EYXNoYm9hcmQoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LmRhc2hib2FyZCcsIHsgdXNlcm5hbWU6IGxvZ2luQ3RybC51c2VybmFtZSB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBsb2dpbigpIHtcbiAgICAgICAgICAgIHJldHVyblRvRGFzaGJvYXJkKCk7XG4gICAgICAgIH1cbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihsb2dpbkN0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IobG9naW5DdHJsKTtcbiAgICAgICAgbG9naW5DdHJsLmxvZ2luID0gbG9naW47XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bG9naW5jdHJsLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE5LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm1lbnUnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudScsIHtcbiAgICAgICAgICAgIHVybDogJy9tJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbWVudS9tZW51Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ01lbnVDdHJsIGFzIG1lbnVDdHJsJyxcbiAgICAgICAgICAgIHBhcmFtczogeyB1c2VybmFtZTogbnVsbCB9XG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdNZW51Q3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcykge1xuICAgICAgICB2YXIgbWVudUN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBsb2dvdXQoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5sb2dpbicpO1xuICAgICAgICB9XG4gICAgICAgIG1lbnVDdHJsLnVzZXJuYW1lID0gJHN0YXRlUGFyYW1zLnVzZXJuYW1lO1xuICAgICAgICBtZW51Q3RybC5sb2dvdXQgPSBsb2dvdXQ7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bWVudUN0cmwuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgaGFyZGlrIGdhbmRoaSBvbiA2LzI0LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5uZXR3b3JrcG9saWNpZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2QmFuZHdpZHRoXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgYmFuZHdpZHRoUG9saWN5OiAnPScsXG4gICAgICAgICAgICBtb2RlOiBcIkBcIlxuICAgICAgICB9LFxuICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUpIHtcbiAgICAgICAgICAgIGlmIChzY29wZS5iYW5kd2lkdGhQb2xpY3kuYmFuZHdpZHRoICE9ICcnKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJhbmR3aWR0aEFycmF5ID0gc2NvcGUuYmFuZHdpZHRoUG9saWN5LmJhbmR3aWR0aC5zcGxpdCgnICcpO1xuICAgICAgICAgICAgICAgIHNjb3BlLmJhbmR3aWR0aFBvbGljeS5iYW5kd2lkdGhOdW1iZXIgPSBOdW1iZXIoYmFuZHdpZHRoQXJyYXlbMF0pO1xuICAgICAgICAgICAgICAgIHNjb3BlLmJhbmR3aWR0aFBvbGljeS5iYW5kd2lkdGhVbml0ID0gYmFuZHdpZHRoQXJyYXlbMV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnbmV0d29ya19wb2xpY2llcy9iYW5kd2lkdGguaHRtbCdcbiAgICB9O1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1iYW5kd2lkdGhkaXJlY3RpdmUuanMubWFwXG4vKlxuLyoqXG4gKiBDcmVhdGVkIGJ5IGhhcmRpayBnYW5kaGkgb24gNi8xNC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcG9saWNpZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuYmFuZHdpZHRoLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0JhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwgYXMgYmFuZHdpZHRoUG9saWN5Q3JlYXRlQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtfcG9saWNpZXMvYmFuZHdpZHRocG9saWN5Y3JlYXRlLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdCYW5kd2lkdGhQb2xpY3lDcmVhdGVDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ05ldHByb2ZpbGVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgTmV0cHJvZmlsZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1BvbGljaWVzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMubGlzdC5iYW5kd2lkdGgnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxDcmVhdGluZygpIHtcbiAgICAgICAgICAgIHJldHVyblRvUG9saWNpZXMoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVQb2xpY3koKSB7XG4gICAgICAgICAgICBpZiAoYmFuZHdpZHRoUG9saWN5Q3JlYXRlQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihiYW5kd2lkdGhQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihiYW5kd2lkdGhQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBiYW5kd2lkdGhQb2xpY3lDcmVhdGVDdHJsLm5ld1BvbGljeS5rZXkgPVxuICAgICAgICAgICAgICAgICAgICBOZXRwcm9maWxlc01vZGVsLmdlbmVyYXRlS2V5KGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwubmV3UG9saWN5KTtcbiAgICAgICAgICAgICAgICBiYW5kd2lkdGhQb2xpY3lDcmVhdGVDdHJsLm5ld1BvbGljeS5iYW5kd2lkdGggPSBiYW5kd2lkdGhQb2xpY3lDcmVhdGVDdHJsLm5ld1BvbGljeS5iYW5kd2lkdGhOdW1iZXJcbiAgICAgICAgICAgICAgICAgICAgKyBcIiBcIiArIGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwubmV3UG9saWN5LmJhbmR3aWR0aFVuaXQ7XG4gICAgICAgICAgICAgICAgTmV0cHJvZmlsZXNNb2RlbC5jcmVhdGUoYmFuZHdpZHRoUG9saWN5Q3JlYXRlQ3RybC5uZXdQb2xpY3kpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1BvbGljaWVzKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihiYW5kd2lkdGhQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmVzZXRGb3JtKCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihiYW5kd2lkdGhQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihiYW5kd2lkdGhQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwubmV3UG9saWN5ID0ge1xuICAgICAgICAgICAgICAgIHByb2ZpbGVOYW1lOiAnJyxcbiAgICAgICAgICAgICAgICB0ZW5hbnROYW1lOiAnZGVmYXVsdCcsXG4gICAgICAgICAgICAgICAgYmFuZHdpZHRoOiAnJyxcbiAgICAgICAgICAgICAgICBEU0NQOiAnJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBiYW5kd2lkdGhQb2xpY3lDcmVhdGVDdHJsLmNyZWF0ZVBvbGljeSA9IGNyZWF0ZVBvbGljeTtcbiAgICAgICAgYmFuZHdpZHRoUG9saWN5Q3JlYXRlQ3RybC5jYW5jZWxDcmVhdGluZyA9IGNhbmNlbENyZWF0aW5nO1xuICAgICAgICByZXNldEZvcm0oKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1iYW5kd2lkdGhwb2xpY3ljcmVhdGVjdHJsLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IGhhcmRpayBnYW5kaGkgb24gNi8xNi8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcG9saWNpZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuYmFuZHdpZHRoLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdCYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCBhcyBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtfcG9saWNpZXMvYmFuZHdpZHRocG9saWN5ZGV0YWlscy5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmJhbmR3aWR0aC5lZGl0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2VkaXQvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwgYXMgYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3JrX3BvbGljaWVzL2JhbmR3aWR0aHBvbGljeWRldGFpbHMuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ0JhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsJywgW1xuICAgICckc3RhdGUnLFxuICAgICckc3RhdGVQYXJhbXMnLFxuICAgICdOZXRwcm9maWxlc01vZGVsJyxcbiAgICAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgTmV0cHJvZmlsZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsID0gdGhpcztcbiAgICAgICAgYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwuYmFuZHdpZHRoUHJvZmlsZXMgPSBbXTtcbiAgICAgICAgLyogR2V0IHBhcnRpY3VsYXIgUHJvZmlsZSBmb3IgYmFzZWQgb24ga2V5Ki9cbiAgICAgICAgTmV0cHJvZmlsZXNNb2RlbC5nZXRNb2RlbEJ5S2V5KCRzdGF0ZVBhcmFtcy5rZXkpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kgPSBwb2xpY3k7XG4gICAgICAgIH0pO1xuICAgICAgICAvKipcbiAgICAgICAgICogVG8gc2hvdyBlZGl0IG9yIGRldGFpbHMgc2NyZWVuIGJhc2VkIG9uIHRoZSByb3V0ZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gc2V0TW9kZSgpIHtcbiAgICAgICAgICAgIGlmICgkc3RhdGUuaXMoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGguZWRpdCcpKSB7XG4gICAgICAgICAgICAgICAgYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwubW9kZSA9ICdlZGl0JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLm1vZGUgPSAnZGV0YWlscyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZGVsZXRlUG9saWN5KCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIE5ldHByb2ZpbGVzTW9kZWwuZGVsZXRlVXNpbmdLZXkoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwucG9saWN5LmtleSwgJ25hbWUnKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICByZXR1cm5Ub1BvbGljaWVzKCk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvUG9saWNpZXMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5saXN0LmJhbmR3aWR0aCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvUG9saWN5RGV0YWlscygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmJhbmR3aWR0aC5kZXRhaWxzJywgeyAna2V5JzogYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwucG9saWN5LmtleSB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxFZGl0aW5nKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9Qb2xpY3lEZXRhaWxzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gc2F2ZVBvbGljeSgpIHtcbiAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgaWYgKGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwucG9saWN5LmJhbmR3aWR0aCA9IGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLnBvbGljeS5iYW5kd2lkdGhOdW1iZXIgKyBcIiBcIiArIGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLnBvbGljeS5iYW5kd2lkdGhVbml0O1xuICAgICAgICAgICAgICAgIE5ldHByb2ZpbGVzTW9kZWwuc2F2ZShiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9Qb2xpY3lEZXRhaWxzKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgc2V0TW9kZSgpO1xuICAgICAgICBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybC5kZWxldGVQb2xpY3kgPSBkZWxldGVQb2xpY3k7XG4gICAgICAgIGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLnNhdmVQb2xpY3kgPSBzYXZlUG9saWN5O1xuICAgICAgICBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybC5jYW5jZWxFZGl0aW5nID0gY2FuY2VsRWRpdGluZztcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1iYW5kd2lkdGhwb2xpY3lkZXRhaWxzY3RybC5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSBoYXJkaWsgZ2FuZGhpIG9uIDYvMTQvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3BvbGljaWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmxpc3QuYmFuZHdpZHRoJywge1xuICAgICAgICAgICAgdXJsOiAnL2JhbmR3aWR0aCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQmFuZHdpZHRoUG9saWN5TGlzdEN0cmwgYXMgYmFuZHdpZHRoUG9saWN5TGlzdEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3JrX3BvbGljaWVzL2JhbmR3aWR0aHBvbGljeWxpc3QuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ0JhbmR3aWR0aFBvbGljeUxpc3RDdHJsJywgWyckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnTmV0cHJvZmlsZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBOZXRwcm9maWxlc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgcG9saWNpZXNMaXN0Q3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGdldFBvbGljaWVzKHJlbG9hZCkge1xuICAgICAgICAgICAgTmV0cHJvZmlsZXNNb2RlbC5nZXQocmVsb2FkKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHBvbGljaWVzTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgIHBvbGljaWVzTGlzdEN0cmwucG9saWNpZXMgPSAkZmlsdGVyKCdvcmRlckJ5JykocmVzdWx0LCAncHJvZmlsZU5hbWUnKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihwb2xpY2llc0xpc3RDdHJsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vTG9hZCBmcm9tIGNhY2hlIGZvciBxdWljayBkaXNwbGF5IGluaXRpYWxseVxuICAgICAgICBnZXRQb2xpY2llcyh0cnVlKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3Qgc3RhcnQgYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldFBvbGljaWVzKHRydWUpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YmFuZHdpZHRocG9saWN5bGlzdGN0cmwuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcG9saWNpZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuaXNvbGF0aW9uLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdJc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCBhcyBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtfcG9saWNpZXMvaXNvbGF0aW9ucG9saWN5ZGV0YWlscy5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbi5lZGl0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2VkaXQvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnSXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwgYXMgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3JrX3BvbGljaWVzL2lzb2xhdGlvbnBvbGljeWRldGFpbHMuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ0lzb2xhdGlvblBvbGljeURldGFpbHNDdHJsJywgW1xuICAgICckc3RhdGUnLFxuICAgICckc3RhdGVQYXJhbXMnLFxuICAgICdQb2xpY2llc01vZGVsJyxcbiAgICAnUnVsZXNNb2RlbCcsXG4gICAgJ05ldHdvcmtzTW9kZWwnLFxuICAgICdBcHBsaWNhdGlvbkdyb3Vwc01vZGVsJyxcbiAgICAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgUG9saWNpZXNNb2RlbCwgUnVsZXNNb2RlbCwgTmV0d29ya3NNb2RlbCwgQXBwbGljYXRpb25Hcm91cHNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsID0gdGhpcztcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV0d29ya3MgPSBbXTtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuYXBwbGljYXRpb25Hcm91cHMgPSBbXTtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nTmV0d29ya1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdOZXR3b3JrU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdJUEFkZHJlc3NTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nSVBBZGRyZXNzU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nU2VsZWN0ZWRBcHBsaWNhdGlvbkdyb3VwID0gJyc7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nU2VsZWN0ZWRBcHBsaWNhdGlvbkdyb3VwID0gJyc7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nU2VsZWN0ZWROZXR3b3JrID0gJyc7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nU2VsZWN0ZWROZXR3b3JrID0gJyc7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29ycmVjdENJRFIgPSBmYWxzZTtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwudmFsaWRhdGVDSURSRmxhZyA9IGZhbHNlO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1BvbGljaWVzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMubGlzdC5pc29sYXRpb24nKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1BvbGljeURldGFpbHMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5pc29sYXRpb24uZGV0YWlscycsIHsga2V5OiBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kua2V5IH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbEVkaXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub1BvbGljeURldGFpbHMoKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogR28gYmFjayB0byBwb2xpY3kgZGV0YWlscyBhZnRlciBkb25lIGVkaXRpbmdcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGRvbmVFZGl0aW5nKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9Qb2xpY3lEZXRhaWxzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZGVsZXRlUG9saWN5KCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIFBvbGljaWVzTW9kZWwuZGVsZXRlKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLnBvbGljeSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9Qb2xpY2llcygpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogVG8gc2hvdyBlZGl0IG9yIGRldGFpbHMgc2NyZWVuIGJhc2VkIG9uIHRoZSByb3V0ZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gc2V0TW9kZSgpIHtcbiAgICAgICAgICAgIGlmICgkc3RhdGUuaXMoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5pc29sYXRpb24uZWRpdCcpKSB7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubW9kZSA9ICdlZGl0JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm1vZGUgPSAnZGV0YWlscyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmVzZXROZXdJbmNvbWluZ1J1bGUoKSB7XG4gICAgICAgICAgICAvL1J1bGUgb2JqZWN0IHRvIGJlIGNyZWF0ZWQgb24gc2VydmVyXG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUgPSB7XG4gICAgICAgICAgICAgICAgcnVsZUlkOiAnJyxcbiAgICAgICAgICAgICAgICBwcmlvcml0eTogMSxcbiAgICAgICAgICAgICAgICBhY3Rpb246ICdhbGxvdycsXG4gICAgICAgICAgICAgICAgZnJvbUVuZHBvaW50R3JvdXA6ICcnLFxuICAgICAgICAgICAgICAgIGZyb21OZXR3b3JrOiAnJyxcbiAgICAgICAgICAgICAgICBmcm9tSXBBZGRyZXNzOiAnJyxcbiAgICAgICAgICAgICAgICBwcm90b2NvbDogJ3RjcCcsXG4gICAgICAgICAgICAgICAgcG9ydDogMCxcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb246ICdpbicsXG4gICAgICAgICAgICAgICAgdGVuYW50TmFtZTogJ2RlZmF1bHQnLFxuICAgICAgICAgICAgICAgIHBvbGljeU5hbWU6IGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLnBvbGljeS5wb2xpY3lOYW1lXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdTZWxlY3RlZEFwcGxpY2F0aW9uR3JvdXAgPSAnJztcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nU2VsZWN0ZWROZXR3b3JrID0gJyc7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdOZXR3b3JrU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdJUEFkZHJlc3NTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29ycmVjdENJRFIgPSBmYWxzZTtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLnZhbGlkYXRlQ0lEUkZsYWcgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXNldE5ld091dGdvaW5nUnVsZSgpIHtcbiAgICAgICAgICAgIC8vUnVsZSBvYmplY3QgdG8gYmUgY3JlYXRlZCBvbiBzZXJ2ZXJcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZSA9IHtcbiAgICAgICAgICAgICAgICBydWxlSWQ6ICcnLFxuICAgICAgICAgICAgICAgIHByaW9yaXR5OiAxLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogJ2FsbG93JyxcbiAgICAgICAgICAgICAgICB0b0VuZHBvaW50R3JvdXA6ICcnLFxuICAgICAgICAgICAgICAgIHRvTmV0d29yazogJycsXG4gICAgICAgICAgICAgICAgdG9JcEFkZHJlc3M6ICcnLFxuICAgICAgICAgICAgICAgIHByb3RvY29sOiAndGNwJyxcbiAgICAgICAgICAgICAgICBwb3J0OiAwLFxuICAgICAgICAgICAgICAgIGRpcmVjdGlvbjogJ291dCcsXG4gICAgICAgICAgICAgICAgdGVuYW50TmFtZTogJ2RlZmF1bHQnLFxuICAgICAgICAgICAgICAgIHBvbGljeU5hbWU6IGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLnBvbGljeS5wb2xpY3lOYW1lXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdTZWxlY3RlZEFwcGxpY2F0aW9uR3JvdXAgPSAnJztcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nU2VsZWN0ZWROZXR3b3JrID0gJyc7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlT3V0Z29pbmdOZXR3b3JrU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlT3V0Z29pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlT3V0Z29pbmdJUEFkZHJlc3NTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29ycmVjdENJRFIgPSBmYWxzZTtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLnZhbGlkYXRlQ0lEUkZsYWcgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IG5ldHdvcmsgbmFtZXMgZm9yIHRoZSBnaXZlbiB0ZW5hbnQuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBnZXROZXR3b3JrcygpIHtcbiAgICAgICAgICAgIE5ldHdvcmtzTW9kZWwuZ2V0KCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy9fLmZpbHRlcigpIHJldHVybnMgYSBuZXcgYXJyYXlcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXR3b3JrcyA9IF8uZmlsdGVyKHJlc3VsdCwge1xuICAgICAgICAgICAgICAgICAgICAndGVuYW50TmFtZSc6ICdkZWZhdWx0JyAvL1RPRE86IFJlbW92ZSBoYXJkY29kZWQgdGVuYW50LlxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdldCBhcHBsaWNhdGlvbiBncm91cCBuYW1lcyBmb3IgdGhlIGdpdmVuIHRlbmFudC5cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGdldEFwcGxpY2F0aW9uR3JvdXBzKCkge1xuICAgICAgICAgICAgQXBwbGljYXRpb25Hcm91cHNNb2RlbC5nZXQoKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAvL18uZmlsdGVyKCkgcmV0dXJucyBhIG5ldyBhcnJheVxuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmFwcGxpY2F0aW9uR3JvdXBzID0gXy5maWx0ZXIocmVzdWx0LCB7XG4gICAgICAgICAgICAgICAgICAgICd0ZW5hbnROYW1lJzogJ2RlZmF1bHQnIC8vVE9ETzogUmVtb3ZlIGhhcmRjb2RlZCB0ZW5hbnQuXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogRXZlbnQgaGFuZGxlciB0byBkaXNhYmxlIG5ldHdvcmsgc2VsZWN0aW9uIGJveCBvbmNlIGFwcGxpY2F0aW9uIGdyb3VwIGlzIHNlbGVjdGVkIHdoaWxlIGNyZWF0aW5nIGEgbmV3XG4gICAgICAgICAqIHJ1bGUuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBvbkNoYW5nZU91dGdvaW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbigpIHtcbiAgICAgICAgICAgIGlmIChpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1NlbGVjdGVkQXBwbGljYXRpb25Hcm91cCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgLy9JZiBhcHBsaWNhdGlvbiBncm91cCBoYXMgYmVlbiBzZWxlY3RlZFxuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZS50b0VuZHBvaW50R3JvdXAgPVxuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1NlbGVjdGVkQXBwbGljYXRpb25Hcm91cC5ncm91cE5hbWU7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlLnRvTmV0d29yayA9ICcnO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ05ldHdvcmtTZWxlY3Rpb24gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy9XaGVuICdub25lJyBpcyBzZWxlY3RlZFxuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZS50b0VuZHBvaW50R3JvdXAgPSAnJztcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlT3V0Z29pbmdOZXR3b3JrU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEV2ZW50IGhhbmRsZXIgdG8gZGlzYWJsZSBuZXR3b3JrIHNlbGVjdGlvbiBib3ggb25jZSBhcHBsaWNhdGlvbiBncm91cCBpcyBzZWxlY3RlZCB3aGlsZSBjcmVhdGluZyBhIG5ld1xuICAgICAgICAgKiBydWxlLlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gb25DaGFuZ2VJbmNvbWluZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdTZWxlY3RlZEFwcGxpY2F0aW9uR3JvdXAgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIC8vSWYgYXBwbGljYXRpb24gZ3JvdXAgaGFzIGJlZW4gc2VsZWN0ZWRcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUuZnJvbUVuZHBvaW50R3JvdXAgPVxuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1NlbGVjdGVkQXBwbGljYXRpb25Hcm91cC5ncm91cE5hbWU7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlLmZyb21OZXR3b3JrID0gJyc7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nTmV0d29ya1NlbGVjdGlvbiA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvL1doZW4gJ25vbmUnIGlzIHNlbGVjdGVkXG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlLmZyb21FbmRwb2ludEdyb3VwID0gJyc7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVJbmNvbWluZ05ldHdvcmtTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogRXZlbnQgaGFuZGxlciB0byBkaXNhYmxlIGFwcGxpY2F0aW9uIGdyb3VwIHNlbGVjdGlvbiBib3ggb25jZSBuZXR3b3JrIGlzIHNlbGVjdGVkIHdoaWxlIGNyZWF0aW5nIGEgbmV3XG4gICAgICAgICAqIHJ1bGUuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBvbkNoYW5nZU91dGdvaW5nTmV0d29ya1NlbGVjdGlvbigpIHtcbiAgICAgICAgICAgIGlmIChpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1NlbGVjdGVkTmV0d29yayAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgLy9JZiBuZXR3b3JrIGhhcyBiZWVuIHNlbGVjdGVkXG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlLnRvTmV0d29yayA9XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nU2VsZWN0ZWROZXR3b3JrO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZS5Ub0VuZHBvaW50R3JvdXAgPSAnJztcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlT3V0Z29pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlT3V0Z29pbmdJUEFkZHJlc3NTZWxlY3Rpb24gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlLnRvSXBBZGRyZXNzID0gJyc7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ0lQQWRkcmVzc1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBFdmVudCBoYW5kbGVyIHRvIGRpc2FibGUgYXBwbGljYXRpb24gZ3JvdXAgc2VsZWN0aW9uIGJveCBvbmNlIG5ldHdvcmsgaXMgc2VsZWN0ZWQgd2hpbGUgY3JlYXRpbmcgYSBuZXdcbiAgICAgICAgICogcnVsZS5cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIG9uQ2hhbmdlSW5jb21pbmdOZXR3b3JrU2VsZWN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nU2VsZWN0ZWROZXR3b3JrICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAvL0lmIG5ldHdvcmsgaGFzIGJlZW4gc2VsZWN0ZWRcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUuZnJvbU5ldHdvcmsgPVxuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1NlbGVjdGVkTmV0d29yaztcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUuZnJvbUVuZHBvaW50R3JvdXAgPSAnJztcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdJUEFkZHJlc3NTZWxlY3Rpb24gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlLmZyb21OZXR3b3JrID0gJyc7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVJbmNvbWluZ0lQQWRkcmVzc1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZW5lcmF0ZXMgcnVsZSBpZFxuICAgICAgICAgKiBUT0RPIE1ha2UgaXQgY3J5cHRvZ3JhcGhpY2FsbHkgc3Ryb25nZXIgb25jZSB3ZSBoYXZlIG11bHRpcGxlIHVzZXJzIHVwZGF0aW5nIHNhbWUgcG9saWN5XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBnZW5lcmF0ZVJ1bGVJZChydWxlKSB7XG4gICAgICAgICAgICBydWxlLnJ1bGVJZCA9XG4gICAgICAgICAgICAgICAgKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29taW5nUnVsZXMubGVuZ3RoICsgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwub3V0Z29pbmdSdWxlcy5sZW5ndGggKyAxKS50b1N0cmluZygpICsgJy0nICtcbiAgICAgICAgICAgICAgICAgICAgRGF0ZS5ub3coKS50b1N0cmluZygpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSdWxlIGlzIHNhdmVkIHRvIHNlcnZlclxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gYWRkSW5jb21pbmdSdWxlKCkge1xuICAgICAgICAgICAgaWYgKHZhbGlkYXRlQ0lEUihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUuZnJvbUlwQWRkcmVzcykpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBnZW5lcmF0ZVJ1bGVJZChpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUpO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nUnVsZS5rZXkgPSBSdWxlc01vZGVsLmdlbmVyYXRlS2V5KGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nUnVsZSk7XG4gICAgICAgICAgICAgICAgUnVsZXNNb2RlbC5jcmVhdGUoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29taW5nUnVsZXMucHVzaChyZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICByZXNldE5ld0luY29taW5nUnVsZSgpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gb25DaGFuZ2VJbmNvbWluZ0lQQWRkcmVzcygpIHtcbiAgICAgICAgICAgIGlmIChpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUuZnJvbUlwQWRkcmVzcyA9PSAnJykge1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29ycmVjdENJRFIgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdOZXR3b3JrU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdOZXR3b3JrU2VsZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC52YWxpZGF0ZUNJRFJGbGFnICYmXG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuaW5jb3JyZWN0Q0lEUikge1xuICAgICAgICAgICAgICAgIHZhbGlkYXRlQ0lEUihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUuZnJvbUlwQWRkcmVzcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gb25DaGFuZ2VPdXRnb2luZ0lQQWRkcmVzcygpIHtcbiAgICAgICAgICAgIGlmIChpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1J1bGUudG9JcEFkZHJlc3MgPT0gJycpIHtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvcnJlY3RDSURSID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nTmV0d29ya1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nTmV0d29ya1NlbGVjdGlvbiA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwudmFsaWRhdGVDSURSRmxhZyAmJlxuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29ycmVjdENJRFIpIHtcbiAgICAgICAgICAgICAgICB2YWxpZGF0ZUNJRFIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlLnRvSXBBZGRyZXNzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiB2YWxpZGF0ZUNJRFIoaXBhZGRyZXNzKSB7XG4gICAgICAgICAgICB2YXIgY2lkclBhdHRlcm4gPSBuZXcgUmVnRXhwKENvbnRpdkdsb2JhbHMuQ0lEUl9SRUdFWCk7XG4gICAgICAgICAgICBpZiAoaXBhZGRyZXNzID09ICcnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY2lkclBhdHRlcm4udGVzdChpcGFkZHJlc3MpKSB7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuaW5jb3JyZWN0Q0lEUiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuaW5jb3JyZWN0Q0lEUiA9IHRydWU7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC52YWxpZGF0ZUNJRFJGbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogUnVsZSBpcyBzYXZlZCB0byBzZXJ2ZXJcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGFkZE91dGdvaW5nUnVsZSgpIHtcbiAgICAgICAgICAgIGlmICh2YWxpZGF0ZUNJRFIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlLnRvSXBBZGRyZXNzKSkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIGdlbmVyYXRlUnVsZUlkKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZSk7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlLmtleSA9IFJ1bGVzTW9kZWwuZ2VuZXJhdGVLZXkoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlKTtcbiAgICAgICAgICAgICAgICBSdWxlc01vZGVsLmNyZWF0ZShpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1J1bGUpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwub3V0Z29pbmdSdWxlcy5wdXNoKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIHJlc2V0TmV3T3V0Z29pbmdSdWxlKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogRGVsZXRlIGluY29taW5nIHJ1bGUgZnJvbSBzZXJ2ZXJcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGRlbGV0ZUluY29taW5nUnVsZShrZXkpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBSdWxlc01vZGVsLmRlbGV0ZVVzaW5nS2V5KGtleSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgXy5yZW1vdmUoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuaW5jb21pbmdSdWxlcywgZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG4ua2V5ID09IGtleTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERlbGV0ZSBvdXRnb2luZyBydWxlIGZyb20gc2VydmVyXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBkZWxldGVPdXRnb2luZ1J1bGUoa2V5KSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgUnVsZXNNb2RlbC5kZWxldGVVc2luZ0tleShrZXkpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIF8ucmVtb3ZlKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm91dGdvaW5nUnVsZXMsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuLmtleSA9PSBrZXk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICBQb2xpY2llc01vZGVsLmdldE1vZGVsQnlLZXkoJHN0YXRlUGFyYW1zLmtleSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLnBvbGljeSA9IHBvbGljeTtcbiAgICAgICAgICAgIFJ1bGVzTW9kZWwuZ2V0SW5jb21pbmdSdWxlcyhwb2xpY3kucG9saWN5TmFtZSwgJ2RlZmF1bHQnKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvbWluZ1J1bGVzID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgIHJlc2V0TmV3SW5jb21pbmdSdWxlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFJ1bGVzTW9kZWwuZ2V0T3V0Z29pbmdSdWxlcyhwb2xpY3kucG9saWN5TmFtZSwgJ2RlZmF1bHQnKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5vdXRnb2luZ1J1bGVzID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgIHJlc2V0TmV3T3V0Z29pbmdSdWxlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGdldE5ldHdvcmtzKCk7XG4gICAgICAgIGdldEFwcGxpY2F0aW9uR3JvdXBzKCk7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRlbGV0ZVBvbGljeSA9IGRlbGV0ZVBvbGljeTtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGVsZXRlSW5jb21pbmdSdWxlID0gZGVsZXRlSW5jb21pbmdSdWxlO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kZWxldGVPdXRnb2luZ1J1bGUgPSBkZWxldGVPdXRnb2luZ1J1bGU7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmFkZEluY29taW5nUnVsZSA9IGFkZEluY29taW5nUnVsZTtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuYWRkT3V0Z29pbmdSdWxlID0gYWRkT3V0Z29pbmdSdWxlO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kb25lRWRpdGluZyA9IGRvbmVFZGl0aW5nO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5jYW5jZWxFZGl0aW5nID0gY2FuY2VsRWRpdGluZztcbiAgICAgICAgLy9FdmVudCBIYW5kbGVyc1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5vbkNoYW5nZU91dGdvaW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IG9uQ2hhbmdlT3V0Z29pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5vbkNoYW5nZUluY29taW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IG9uQ2hhbmdlSW5jb21pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5vbkNoYW5nZU91dGdvaW5nTmV0d29ya1NlbGVjdGlvbiA9IG9uQ2hhbmdlT3V0Z29pbmdOZXR3b3JrU2VsZWN0aW9uO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5vbkNoYW5nZUluY29taW5nTmV0d29ya1NlbGVjdGlvbiA9IG9uQ2hhbmdlSW5jb21pbmdOZXR3b3JrU2VsZWN0aW9uO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5vbkNoYW5nZUluY29taW5nSVBBZGRyZXNzID0gb25DaGFuZ2VJbmNvbWluZ0lQQWRkcmVzcztcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwub25DaGFuZ2VPdXRnb2luZ0lQQWRkcmVzcyA9IG9uQ2hhbmdlT3V0Z29pbmdJUEFkZHJlc3M7XG4gICAgICAgIHNldE1vZGUoKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pc29sYXRpb25wb2xpY3lkZXRhaWxzY3RybC5qcy5tYXBcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3BvbGljaWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmxpc3QuaXNvbGF0aW9uJywge1xuICAgICAgICAgICAgdXJsOiAnL2lzb2xhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnSXNvbGF0aW9uUG9saWN5TGlzdEN0cmwgYXMgaXNvbGF0aW9uUG9saWN5TGlzdEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3JrX3BvbGljaWVzL2lzb2xhdGlvbnBvbGljeWxpc3QuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ0lzb2xhdGlvblBvbGljeUxpc3RDdHJsJywgWyckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnUG9saWNpZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBQb2xpY2llc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgcG9saWNpZXNMaXN0Q3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGdldFBvbGljaWVzKHJlbG9hZCkge1xuICAgICAgICAgICAgUG9saWNpZXNNb2RlbC5nZXQocmVsb2FkKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHBvbGljaWVzTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgIHBvbGljaWVzTGlzdEN0cmwucG9saWNpZXMgPSAkZmlsdGVyKCdvcmRlckJ5JykocmVzdWx0LCAncG9saWN5TmFtZScpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHBvbGljaWVzTGlzdEN0cmwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgIGdldFBvbGljaWVzKGZhbHNlKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3Qgc3RhcnQgYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldFBvbGljaWVzKHRydWUpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aXNvbGF0aW9ucG9saWN5bGlzdGN0cmwuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvOS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcG9saWNpZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05ldHdvcmtQb2xpY2llc1RhYnNDdHJsIGFzIG5ldHdvcmtQb2xpY2llc1RhYnNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmV0d29ya19wb2xpY2llcy9uZXR3b3JrcG9saWNpZXN0YWJzLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5saXN0LnJlZGlyZWN0aW9uJywge1xuICAgICAgICAgICAgdXJsOiAnL3JlZGlyZWN0aW9uJyxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTmV0d29ya1BvbGljaWVzVGFic0N0cmwnLCBbJyRzdGF0ZScsIGZ1bmN0aW9uICgkc3RhdGUpIHtcbiAgICAgICAgdmFyIG5ldHdvcmtQb2xpY2llc1RhYnNDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlTmV0d29ya1BvbGljeSgpIHtcbiAgICAgICAgICAgIGlmICgkc3RhdGUuJGN1cnJlbnQuaW5jbHVkZXNbJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5saXN0Lmlzb2xhdGlvbiddKSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuaXNvbGF0aW9uLmNyZWF0ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCRzdGF0ZS4kY3VycmVudC5pbmNsdWRlc1snY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmxpc3QuYmFuZHdpZHRoJ10pIHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGguY3JlYXRlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbmV0d29ya1BvbGljaWVzVGFic0N0cmwuY3JlYXRlTmV0d29ya1BvbGljeSA9IGNyZWF0ZU5ldHdvcmtQb2xpY3k7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bmV0d29ya3BvbGljaWVzdGFic2N0cmwuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDIvMTkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3MnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3Jrcy5jcmVhdGUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmV0d29ya3MvbmV0d29ya2NyZWF0ZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOZXR3b3JrQ3JlYXRlQ3RybCBhcyBuZXR3b3JrQ3JlYXRlQ3RybCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05ldHdvcmtDcmVhdGVDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ05ldHdvcmtzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgTmV0d29ya3NNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIG5ldHdvcmtDcmVhdGVDdHJsID0gdGhpcztcbiAgICAgICAgbmV0d29ya0NyZWF0ZUN0cmwuY2lkclBhdHRlcm4gPSBDb250aXZHbG9iYWxzLkNJRFJfUkVHRVg7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvTmV0d29ya3MoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5ldHdvcmtzLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxDcmVhdGluZygpIHtcbiAgICAgICAgICAgIHJldHVyblRvTmV0d29ya3MoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVOZXR3b3JrKCkge1xuICAgICAgICAgICAgLy9mb3JtIGNvbnRyb2xsZXIgaXMgaW5qZWN0ZWQgYnkgdGhlIGh0bWwgdGVtcGxhdGVcbiAgICAgICAgICAgIC8vY2hlY2tpbmcgaWYgYWxsIHZhbGlkYXRpb25zIGhhdmUgcGFzc2VkXG4gICAgICAgICAgICBpZiAobmV0d29ya0NyZWF0ZUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IobmV0d29ya0NyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKG5ldHdvcmtDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBuZXR3b3JrQ3JlYXRlQ3RybC5uZXdOZXR3b3JrLmtleSA9XG4gICAgICAgICAgICAgICAgICAgIG5ldHdvcmtDcmVhdGVDdHJsLm5ld05ldHdvcmsudGVuYW50TmFtZSArICc6JyArIG5ldHdvcmtDcmVhdGVDdHJsLm5ld05ldHdvcmsubmV0d29ya05hbWU7XG4gICAgICAgICAgICAgICAgTmV0d29ya3NNb2RlbC5jcmVhdGUobmV0d29ya0NyZWF0ZUN0cmwubmV3TmV0d29yaykudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobmV0d29ya0NyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub05ldHdvcmtzKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3JrQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihuZXR3b3JrQ3JlYXRlQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXNldEZvcm0oKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihuZXR3b3JrQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBuZXR3b3JrQ3JlYXRlQ3RybC5uZXdOZXR3b3JrID0ge1xuICAgICAgICAgICAgICAgIG5ldHdvcmtOYW1lOiAnJyxcbiAgICAgICAgICAgICAgICBlbmNhcDogJ3Z4bGFuJyxcbiAgICAgICAgICAgICAgICBzdWJuZXQ6ICcnLFxuICAgICAgICAgICAgICAgIGdhdGV3YXk6ICcnLFxuICAgICAgICAgICAgICAgIHRlbmFudE5hbWU6ICdkZWZhdWx0JyAvL1RPRE86IFJlbW92ZSBoYXJkY29kZWQgdGVuYW50LlxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBuZXR3b3JrQ3JlYXRlQ3RybC5jcmVhdGVOZXR3b3JrID0gY3JlYXRlTmV0d29yaztcbiAgICAgICAgbmV0d29ya0NyZWF0ZUN0cmwuY2FuY2VsQ3JlYXRpbmcgPSBjYW5jZWxDcmVhdGluZztcbiAgICAgICAgcmVzZXRGb3JtKCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bmV0d29ya2NyZWF0ZWN0cmwuanMubWFwXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3MuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05ldHdvcmtEZXRhaWxzQ3RybCBhcyBuZXR3b3JrRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3Jrcy9uZXR3b3JrZGV0YWlscy5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3Jrcy5kZXRhaWxzLmluZm8nLCB7XG4gICAgICAgICAgICB1cmw6ICcvaW5mbycsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtzL25ldHdvcmtpbmZvLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOZXR3b3JrRGV0YWlsc0N0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ05ldHdvcmtzTW9kZWwnLCAnQXBwbGljYXRpb25Hcm91cHNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCAkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgTmV0d29ya3NNb2RlbCwgQXBwbGljYXRpb25Hcm91cHNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIG5ldHdvcmtEZXRhaWxzQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvTmV0d29ya3MoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5ldHdvcmtzLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBkZWxldGVOZXR3b3JrKCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG5ldHdvcmtEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihuZXR3b3JrRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgTmV0d29ya3NNb2RlbC5kZWxldGUobmV0d29ya0RldGFpbHNDdHJsLm5ldHdvcmspLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobmV0d29ya0RldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICByZXR1cm5Ub05ldHdvcmtzKCk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobmV0d29ya0RldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IobmV0d29ya0RldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdldCBhcHBsaWNhdGlvbiBncm91cHMgYmVsb25naW5nIHRvIGEgbmV0d29ya1xuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gZ2V0QXBwbGljYXRpb25Hcm91cHMocmVsb2FkKSB7XG4gICAgICAgICAgICBBcHBsaWNhdGlvbkdyb3Vwc01vZGVsLmdldChyZWxvYWQpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIG5ldHdvcmtEZXRhaWxzQ3RybC5hcHBsaWNhdGlvbkdyb3VwcyA9ICRmaWx0ZXIoJ29yZGVyQnknKShfLmZpbHRlcihyZXN1bHQsIHtcbiAgICAgICAgICAgICAgICAgICAgJ25ldHdvcmtOYW1lJzogbmV0d29ya0RldGFpbHNDdHJsLm5ldHdvcmsubmV0d29ya05hbWVcbiAgICAgICAgICAgICAgICB9KSwgJ2dyb3VwTmFtZScpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3JrRGV0YWlsc0N0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IobmV0d29ya0RldGFpbHNDdHJsKTtcbiAgICAgICAgTmV0d29ya3NNb2RlbC5nZXRNb2RlbEJ5S2V5KCRzdGF0ZVBhcmFtcy5rZXkpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAobmV0d29yaykge1xuICAgICAgICAgICAgbmV0d29ya0RldGFpbHNDdHJsLm5ldHdvcmsgPSBuZXR3b3JrO1xuICAgICAgICAgICAgZ2V0QXBwbGljYXRpb25Hcm91cHMoZmFsc2UpO1xuICAgICAgICB9KTtcbiAgICAgICAgbmV0d29ya0RldGFpbHNDdHJsLmRlbGV0ZU5ldHdvcmsgPSBkZWxldGVOZXR3b3JrO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXRBcHBsaWNhdGlvbkdyb3Vwcyh0cnVlKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5ldHdvcmtkZXRhaWxzY3RybC5qcy5tYXBcbnZhciBOZXR3b3Jrc0xpc3RDdHJsID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBOZXR3b3Jrc0xpc3RDdHJsKCRzY29wZSwgJGludGVydmFsLCBOZXR3b3Jrc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgbmV0d29ya3NMaXN0Q3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGdldE5ldHdvcmtzKHJlbG9hZCkge1xuICAgICAgICAgICAgTmV0d29ya3NNb2RlbC5nZXQocmVsb2FkKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtzTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgIG5ldHdvcmtzTGlzdEN0cmwubmV0d29ya3MgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobmV0d29ya3NMaXN0Q3RybCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgZ2V0TmV0d29ya3MoZmFsc2UpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXROZXR3b3Jrcyh0cnVlKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBOZXR3b3Jrc0xpc3RDdHJsLiRpbmplY3QgPSBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnTmV0d29ya3NNb2RlbCcsICdDUlVESGVscGVyU2VydmljZSddO1xuICAgIHJldHVybiBOZXR3b3Jrc0xpc3RDdHJsO1xufSgpKTtcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3MnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3Jrcy5saXN0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnbmV0d29ya0xpc3QnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb21wb25lbnQoJ25ldHdvcmtMaXN0Jywge1xuICAgIHRlbXBsYXRlVXJsOiAnbmV0d29ya3MvbmV0d29ya2xpc3QuaHRtbCcsXG4gICAgY29udHJvbGxlcjogTmV0d29ya3NMaXN0Q3RybCxcbiAgICBjb250cm9sbGVyQXM6ICduZXR3b3Jrc0xpc3RDdHJsJ1xufSk7XG4vKlxuICAgIC5jb250cm9sbGVyKCdOZXR3b3Jrc0xpc3RDdHJsJywgWyckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnTmV0d29ya3NNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgTmV0d29ya3NNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgICAgIHZhciBuZXR3b3Jrc0xpc3RDdHJsID0gdGhpcztcblxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0TmV0d29ya3MocmVsb2FkKSB7XG4gICAgICAgICAgICAgICAgTmV0d29ya3NNb2RlbC5nZXQocmVsb2FkKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3Jrc0xpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXR3b3Jrc0xpc3RDdHJsLm5ldHdvcmtzID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3Jrc0xpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgICAgIGdldE5ldHdvcmtzKGZhbHNlKTtcblxuICAgICAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgICAgICAvL0Rvbid0IGRvIGF1dG9yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGdldE5ldHdvcmtzKHRydWUpO1xuICAgICAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfV0pO1xuKi8gXG4vLyMgc291cmNlTWFwcGluZ1VSTD1uZXR3b3JrbGlzdGN0cmwuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgY3NoYW1wdXIgb24gNi8yMy8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtzLmRldGFpbHMuc3RhdHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvc3RhdHMnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05ldHdvcmtTdGF0c0N0cmwgYXMgbmV0d29ya1N0YXRzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtzL25ldHdvcmtzdGF0cy5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTmV0d29ya1N0YXRzQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnTmV0d29ya3NNb2RlbCcsICdJbnNwZWN0U2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCAkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgTmV0d29ya3NNb2RlbCwgSW5zcGVjdFNlcnZpY2UpIHtcbiAgICAgICAgdmFyIG5ldHdvcmtTdGF0c0N0cmwgPSB0aGlzO1xuICAgICAgICAvKiBHZXRzIHRoZSBOZXR3b3JrIE9wZXJhdGlvbmFsIHN0YXRlIGZyb20gdGhlIHNlcnZlciAqL1xuICAgICAgICBmdW5jdGlvbiBnZXROZXR3b3JrSW5zcGVjdChyZWZyZXNoKSB7XG4gICAgICAgICAgICBOZXR3b3Jrc01vZGVsLmdldEluc3BlY3RCeUtleSgkc3RhdGVQYXJhbXMua2V5LCBDb250aXZHbG9iYWxzLk5FVFdPUktTX0lOU1BFQ1RfRU5EUE9JTlQsIHJlZnJlc2gpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIG5ldHdvcmtTdGF0c0N0cmwubmV0d29ya0luc3BlY3RTdGF0cyA9IHJlc3VsdC5PcGVyO1xuICAgICAgICAgICAgICAgIG5ldHdvcmtTdGF0c0N0cmwuY29uZmlnID0gcmVzdWx0LkNvbmZpZztcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0Lk9wZXIuZW5kcG9pbnRzICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29udGFpbmVyRGV0YWlscyA9IEluc3BlY3RTZXJ2aWNlLmJ1aWxkRW5kUG9pbnRzKHJlc3VsdC5PcGVyLmVuZHBvaW50cyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChJbnNwZWN0U2VydmljZS5jaGVja0NvbnRhaW5lckNoYW5nZWQobmV0d29ya1N0YXRzQ3RybC5jb250YWluZXJEZXRhaWxzLCBjb250YWluZXJEZXRhaWxzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV0d29ya1N0YXRzQ3RybC5lbmRwb2ludHMgPSByZXN1bHQuT3Blci5lbmRwb2ludHM7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXR3b3JrU3RhdHNDdHJsLmNvbnRhaW5lckRldGFpbHMgPSBjb250YWluZXJEZXRhaWxzO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBuZXR3b3JrU3RhdHNDdHJsLmVuZHBvaW50cyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBuZXR3b3JrU3RhdHNDdHJsLmNvbnRhaW5lckRldGFpbHMgPSB7fTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBnZXROZXR3b3JrSW5zcGVjdChmYWxzZSk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG9yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldE5ldHdvcmtJbnNwZWN0KHRydWUpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bmV0d29ya3N0YXRzY3RybC5qcy5tYXBcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5mYWN0b3J5KCdCZ3BTZXJ2aWNlJywgWyckaHR0cCcsICckcScsIGZ1bmN0aW9uICgkaHR0cCwgJHEpIHtcbiAgICAgICAgZnVuY3Rpb24gZ2V0QmdwKGN0cmwpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5CR1BTX0VORFBPSU5UICsgY3RybC5rZXkgKyAnLyc7XG4gICAgICAgICAgICAkaHR0cC5nZXQodXJsKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICBjdHJsLm5laWdoYm9yID0gcmVzdWx0LmRhdGE7XG4gICAgICAgICAgICAgICAgY3RybC5uZWlnaGJvcnMucHVzaCh7ICduYW1lJzogY3RybC5uZWlnaGJvclsnbmVpZ2hib3InXSwgJ3ZhbHVlJzogY3RybC5uZWlnaGJvclsnbmVpZ2hib3ItYXMnXSB9KTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlQmdwKGN0cmwpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLkJHUFNfRU5EUE9JTlQgKyBjdHJsLmtleSArICcvJztcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KHVybCwgY3RybC5uZWlnaGJvcik7XG4gICAgICAgIH1cbiAgICAgICAgO1xuICAgICAgICBmdW5jdGlvbiBnZXRCZ3BJbnNwZWN0KGtleSkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLkJHUFNfSU5TUEVDVF9FTkRQT0lOVCArIGtleSArICcvJztcbiAgICAgICAgICAgICRodHRwLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0QmdwOiBnZXRCZ3AsXG4gICAgICAgICAgICB1cGRhdGVCZ3A6IHVwZGF0ZUJncCxcbiAgICAgICAgICAgIGdldEJncEluc3BlY3Q6IGdldEJncEluc3BlY3RcbiAgICAgICAgfTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1iZ3BzZXJ2aWNlLmpzLm1hcFxuYW5ndWxhci5tb2R1bGUoXCJjb250aXYubm9kZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2TG9nc1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9sb2dzLmh0bWwnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgbG9nOiBcIj1cIixcbiAgICAgICAgICAgIHRpdGxlOiBcIkBcIlxuICAgICAgICB9XG4gICAgfTtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bG9nc2RpcmVjdGl2ZS5qcy5tYXBcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5mYWN0b3J5KCdMb2dTZXJ2aWNlJywgWyckaHR0cCcsICckcScsIGZ1bmN0aW9uICgkaHR0cCwgJHEpIHtcbiAgICAgICAgZnVuY3Rpb24gZ2V0QWN0aXZlTG9ncygpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5OT0RFU19BQ1RJVkVfSk9CX0VORFBPSU5UO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdldExhc3RMb2dzKCkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLk5PREVTX0xBU1RfSk9CX0VORFBPSU5UO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRBY3RpdmVMb2dzOiBnZXRBY3RpdmVMb2dzLFxuICAgICAgICAgICAgZ2V0TGFzdExvZ3M6IGdldExhc3RMb2dzXG4gICAgICAgIH07XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bG9nc2VydmljZS5qcy5tYXBcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5hY3RpdmVsb2cnLCB7XG4gICAgICAgICAgICB1cmw6ICcvYWN0aXZlbG9nJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlQWN0aXZlSm9iTG9nc0N0cmwgYXMgbm9kZUFjdGl2ZUpvYkxvZ3NDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGN0di1sb2dzIHRpdGxlPVwiQWN0aXZlIEpvYlwiIGxvZz1cIm5vZGVBY3RpdmVKb2JMb2dzQ3RybC5hY3RpdmVMb2dzXCI+PC9jdHYtbG9ncz4nXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOb2RlQWN0aXZlSm9iTG9nc0N0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnTG9nU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzY29wZSwgJGludGVydmFsLCBMb2dTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBub2RlQWN0aXZlSm9iTG9nc0N0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBnZXRBY3RpdmVMb2dzKCkge1xuICAgICAgICAgICAgTG9nU2VydmljZS5nZXRBY3RpdmVMb2dzKCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgbm9kZUFjdGl2ZUpvYkxvZ3NDdHJsLmFjdGl2ZUxvZ3MgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vT25jZSB0aGUgam9iIGZpbmlzaGVzLCBlbmRwb2ludCByZXR1cm5zIDUwMCBlcnJvci4gU28gcmVzZXQgdGhlIGFjdGl2ZUxvZ3NcbiAgICAgICAgICAgICAgICBub2RlQWN0aXZlSm9iTG9nc0N0cmwuYWN0aXZlTG9ncyA9IHtcbiAgICAgICAgICAgICAgICAgICAgZGVzYzogJ1RoZXJlIGlzIGN1cnJlbnRseSBubyBhY3RpdmUgam9iLiBDaGVjayBMYXN0IEpvYiBmb3IgYSBqb2IgdGhhdCByZWNlbnRseSBmaW5pc2hlZC4nXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGdldEFjdGl2ZUxvZ3MoKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldEFjdGl2ZUxvZ3MoKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVhY3RpdmVqb2Jsb2dzY3RybC5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8yNS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmNvbW1pc3Npb24nLCB7XG4gICAgICAgICAgICB1cmw6ICcvY29tbWlzc2lvbi86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlQ29tbWlzc2lvbkN0cmwgYXMgbm9kZUNvbW1pc3Npb25DdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWNvbW1pc3Npb24uaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVDb21taXNzaW9uQ3RybCcsIFtcbiAgICAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdOb2Rlc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJywgJ05vZGVzU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBOb2Rlc01vZGVsLCBDUlVESGVscGVyU2VydmljZSwgTm9kZXNTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBub2RlQ29tbWlzc2lvbkN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub05vZGVEZXRhaWxzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLmluZm8nLCB7ICdrZXknOiAkc3RhdGVQYXJhbXMua2V5IH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbENvbW1pc3Npb25pbmdOb2RlKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9Ob2RlRGV0YWlscygpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNvbW1pc3Npb24oKSB7XG4gICAgICAgICAgICBpZiAobm9kZUNvbW1pc3Npb25DdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIobm9kZUNvbW1pc3Npb25DdHJsKTtcbiAgICAgICAgICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwubm9kZU9wc09iai5ub2RlcyA9IFskc3RhdGVQYXJhbXMua2V5XTtcbiAgICAgICAgICAgICAgICBOb2Rlc1NlcnZpY2UuY2xlYW51cEV4dHJhVmFycyhub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgICAgICAgICAgICAgIE5vZGVzU2VydmljZS5jcmVhdGVFeHRyYVZhcnMobm9kZUNvbW1pc3Npb25DdHJsKTtcbiAgICAgICAgICAgICAgICBOb2Rlc01vZGVsLmNvbW1pc3Npb24obm9kZUNvbW1pc3Npb25DdHJsLm5vZGVPcHNPYmopLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvTm9kZURldGFpbHMoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihub2RlQ29tbWlzc2lvbkN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLm5vZGVPcHNPYmogPSB7fTtcbiAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLmV4dHJhX3ZhcnMgPSB7fTsgLy9UT0RPIEludGlhbGl6ZSBmcm9tIGdsb2JhbCBzZXR0aW5nc1xuICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuYW5zaWJsZVZhcmlhYmxlcyA9IFtdO1xuICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuZW52VmFyaWFibGVzID0gW107XG4gICAgICAgIE5vZGVzU2VydmljZS5nZXRTZXR0aW5ncyhub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuY2FuY2VsQ29tbWlzc2lvbmluZ05vZGUgPSBjYW5jZWxDb21taXNzaW9uaW5nTm9kZTtcbiAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLmNvbW1pc3Npb24gPSBjb21taXNzaW9uO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVjb21taXNzaW9uY3RybC5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8yNS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGV0YWlsc0N0cmwgYXMgbm9kZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWRldGFpbHMuaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMuZGV0YWlscy5pbmZvJywge1xuICAgICAgICAgICAgdXJsOiAnL2luZm8nLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVEZXRhaWxzQ3RybCBhcyBub2RlRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2RlaW5mby5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLnN0YXRzJywge1xuICAgICAgICAgICAgdXJsOiAnL3N0YXRzJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGV0YWlsc0N0cmwgYXMgbm9kZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZXN0YXRzLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMubG9ncycsIHtcbiAgICAgICAgICAgIHVybDogJy9sb2dzJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGV0YWlsc0N0cmwgYXMgbm9kZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWxvZ3MuaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMuZGV0YWlscy5lZGl0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2VkaXQnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVEZXRhaWxzQ3RybCBhcyBub2RlRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2RlaW5mby5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTm9kZURldGFpbHNDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJyRzY29wZScsICckaW50ZXJ2YWwnLCAnTm9kZXNNb2RlbCcsICdCZ3BTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRzY29wZSwgJGludGVydmFsLCBOb2Rlc01vZGVsLCBCZ3BTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBub2RlRGV0YWlsc0N0cmwgPSB0aGlzO1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwubnVtYmVycGF0dGVybiA9IENvbnRpdkdsb2JhbHMuTlVNQkVSX1JFR0VYO1xuICAgICAgICBmdW5jdGlvbiBkZWNvbW1pc3Npb24oKSB7XG4gICAgICAgICAgICB2YXIgbm9kZU9wc09iaiA9IHtcbiAgICAgICAgICAgICAgICBub2RlczogWyRzdGF0ZVBhcmFtcy5rZXldXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgTm9kZXNNb2RlbC5kZWNvbW1pc3Npb24obm9kZU9wc09iaikudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy9EaXNhYmxlIGFsbCBidXR0b25zIGluaXRpYWxseS4gUG9sbCB3aWxsIGFzc2lnbiB2YWx1ZXMgYXBwcm9wcmlhdGVseS5cbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHVwZ3JhZGUoKSB7XG4gICAgICAgICAgICB2YXIgbm9kZU9wc09iaiA9IHtcbiAgICAgICAgICAgICAgICBub2RlczogWyRzdGF0ZVBhcmFtcy5rZXldXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgTm9kZXNNb2RlbC51cGdyYWRlKG5vZGVPcHNPYmopLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vRGlzYWJsZSBhbGwgYnV0dG9ucyBpbml0aWFsbHkuIFBvbGwgd2lsbCBhc3NpZ24gdmFsdWVzIGFwcHJvcHJpYXRlbHkuXG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogRGlzcGxheSBidXR0b25zIGJhc2VkIG9uIHN0YXR1cyBvZiBub2RlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBzZXRCdXR0b25EaXNwbGF5KCkge1xuICAgICAgICAgICAgc3dpdGNoIChub2RlRGV0YWlsc0N0cmwubm9kZVsnaW52ZW50b3J5X3N0YXRlJ10uc3RhdHVzKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnVW5hbGxvY2F0ZWQnOlxuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnRGVjb21taXNzaW9uZWQnOlxuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnUHJvdmlzaW9uaW5nJzpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdBbGxvY2F0ZWQnOlxuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnQ2FuY2VsbGVkJzpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnTWFpbnRlbmFuY2UnOlxuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0Tm9kZUluZm8ocmVsb2FkKSB7XG4gICAgICAgICAgICBOb2Rlc01vZGVsLmdldE1vZGVsQnlLZXkoJHN0YXRlUGFyYW1zLmtleSwgcmVsb2FkKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm5vZGUgPSBub2RlO1xuICAgICAgICAgICAgICAgIHNldEJ1dHRvbkRpc3BsYXkoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHNldE1vZGUoKSB7XG4gICAgICAgICAgICBpZiAoJHN0YXRlLmlzKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLmVkaXQnKSkge1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5tb2RlID0gJ2VkaXQnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm1vZGUgPSAnZGV0YWlscyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9JbmZvKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLmluZm8nKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVCZ3BJbmZvKCkge1xuICAgICAgICAgICAgaWYgKG5vZGVEZXRhaWxzQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvci5rZXkgPSAkc3RhdGVQYXJhbXMua2V5O1xuICAgICAgICAgICAgICAgIC8vIGJhY2tlbmQgb25seSBzdXBwb3J0cyBhZGRpbmcgb25lIG5laWdoYm9yIGN1cnJlbnRseVxuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvcnMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3JbJ25laWdoYm9yJ10gPSBpdGVtLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvclsnbmVpZ2hib3ItYXMnXSA9IGl0ZW0udmFsdWU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgQmdwU2VydmljZS51cGRhdGVCZ3Aobm9kZURldGFpbHNDdHJsKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm5laWdoYm9yID0gcmVzdWx0LmNvbmZpZy5kYXRhO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub0luZm8oKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdldEJncEluZm8oKSB7XG4gICAgICAgICAgICBCZ3BTZXJ2aWNlLmdldEJncChub2RlRGV0YWlsc0N0cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvciA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnZXRCZ3BJbnNwZWN0KCkge1xuICAgICAgICAgICAgQmdwU2VydmljZS5nZXRCZ3BJbnNwZWN0KCRzdGF0ZVBhcmFtcy5rZXkpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5pbnNwZWN0ID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5yb3V0ZXMgPSByZXN1bHQuT3Blci5yb3V0ZXM7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmZpbHRlcmVkcm91dGVzID0gcmVzdWx0Lk9wZXIucm91dGVzO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC5kZWNvbW1pc3Npb24gPSBkZWNvbW1pc3Npb247XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlID0gdXBncmFkZTtcbiAgICAgICAgbm9kZURldGFpbHNDdHJsLnNldE1vZGUgPSBzZXRNb2RlO1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBkYXRlQmdwSW5mbyA9IHVwZGF0ZUJncEluZm87XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC5yZXR1cm5Ub0luZm8gPSByZXR1cm5Ub0luZm87XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvcnMgPSBbXTtcbiAgICAgICAgbm9kZURldGFpbHNDdHJsLm5laWdoYm9yID0ge307XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC5rZXkgPSAkc3RhdGVQYXJhbXMua2V5O1xuICAgICAgICBnZXRCZ3BJbmZvKCk7XG4gICAgICAgIGdldEJncEluc3BlY3QoKTtcbiAgICAgICAgc2V0TW9kZSgpO1xuICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgZ2V0Tm9kZUluZm8oZmFsc2UpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0Tm9kZUluZm8odHJ1ZSk7XG4gICAgICAgICAgICB9LCA1MDAwKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bm9kZWRldGFpbHNjdHJsLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA2LzE0LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5ub2Rlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZOb2Rlc3RhdHVzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgbm9kZTogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZXN0YXR1cy5odG1sJ1xuICAgIH07XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZOb2Rlc3RhdGVcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBub2RlOiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2Rlc3RhdGUuaHRtbCdcbiAgICB9O1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1ub2RlZGlyZWN0aXZlLmpzLm1hcFxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRpc2NvdmVyJywge1xuICAgICAgICAgICAgdXJsOiAnL2Rpc2NvdmVyJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGlzY292ZXJDdHJsIGFzIG5vZGVEaXNjb3ZlckN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2RlZGlzY292ZXIuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVEaXNjb3ZlckN0cmwnLCBbXG4gICAgJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnTm9kZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsICdOb2Rlc1NlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgTm9kZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UsIE5vZGVzU2VydmljZSkge1xuICAgICAgICB2YXIgbm9kZURpc2NvdmVyQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvTm9kZXMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5vZGVzLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxEaXNjb3ZlcmluZ05vZGUoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub05vZGVzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZGlzY292ZXIoKSB7XG4gICAgICAgICAgICBpZiAobm9kZURpc2NvdmVyQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihub2RlRGlzY292ZXJDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihub2RlRGlzY292ZXJDdHJsKTtcbiAgICAgICAgICAgICAgICBjcmVhdGVJUEFkZHJBcnJheSgpO1xuICAgICAgICAgICAgICAgIE5vZGVzU2VydmljZS5jcmVhdGVFeHRyYVZhcnMobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgICAgICAgICAgICAgTm9kZXNNb2RlbC5kaXNjb3Zlcihub2RlRGlzY292ZXJDdHJsLm5vZGVPcHNPYmopLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub05vZGVzKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihub2RlRGlzY292ZXJDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKG5vZGVEaXNjb3ZlckN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlSVBBZGRyQXJyYXkoKSB7XG4gICAgICAgICAgICBub2RlRGlzY292ZXJDdHJsLm5vZGVPcHNPYmouYWRkcnMgPSBfLndvcmRzKG5vZGVEaXNjb3ZlckN0cmwubm9kZUlQQWRkciwgL1teLCBdKy9nKTtcbiAgICAgICAgfVxuICAgICAgICBub2RlRGlzY292ZXJDdHJsLm5vZGVPcHNPYmogPSB7fTtcbiAgICAgICAgbm9kZURpc2NvdmVyQ3RybC5leHRyYV92YXJzID0ge307IC8vVE9ETyBJbnRpYWxpemUgZnJvbSBnbG9iYWwgc2V0dGluZ3NcbiAgICAgICAgbm9kZURpc2NvdmVyQ3RybC5hbnNpYmxlVmFyaWFibGVzID0gW107XG4gICAgICAgIG5vZGVEaXNjb3ZlckN0cmwuZW52VmFyaWFibGVzID0gW107XG4gICAgICAgIG5vZGVEaXNjb3ZlckN0cmwubm9kZUlQQWRkciA9ICcnOyAvL0lQIGFkZHJlc3Mgb2Ygbm9kZXMgdG8gZGlzY292ZXJcbiAgICAgICAgTm9kZXNTZXJ2aWNlLmdldFNldHRpbmdzKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICBub2RlRGlzY292ZXJDdHJsLmRpc2NvdmVyID0gZGlzY292ZXI7XG4gICAgICAgIG5vZGVEaXNjb3ZlckN0cmwuY2FuY2VsRGlzY292ZXJpbmdOb2RlID0gY2FuY2VsRGlzY292ZXJpbmdOb2RlO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bm9kZWRpc2NvdmVyY3RybC5qcy5tYXBcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5sYXN0bG9nJywge1xuICAgICAgICAgICAgdXJsOiAnL2xhc3Rsb2cnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVMYXN0Sm9iTG9nc0N0cmwgYXMgbm9kZUxhc3RKb2JMb2dzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxjdHYtbG9ncyB0aXRsZT1cIkxhc3QgSm9iXCIgbG9nPVwibm9kZUxhc3RKb2JMb2dzQ3RybC5sYXN0TG9nc1wiPjwvY3R2LWxvZ3M+J1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTm9kZUxhc3RKb2JMb2dzQ3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICdMb2dTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsIExvZ1NlcnZpY2UpIHtcbiAgICAgICAgdmFyIG5vZGVMYXN0Sm9iTG9nc0N0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBnZXRMYXN0TG9ncygpIHtcbiAgICAgICAgICAgIExvZ1NlcnZpY2UuZ2V0TGFzdExvZ3MoKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBub2RlTGFzdEpvYkxvZ3NDdHJsLmxhc3RMb2dzID0gcmVzdWx0O1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGdldExhc3RMb2dzKCk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG8tcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXRMYXN0TG9ncygpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bm9kZWxhc3Rqb2Jsb2dzY3RybC5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8yMi8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZUxpc3RDdHJsIGFzIG5vZGVMaXN0Q3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVsaXN0Lmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOb2RlTGlzdEN0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdOb2Rlc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIE5vZGVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBub2RlTGlzdEN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBnZXROb2RlcyhyZWxvYWQpIHtcbiAgICAgICAgICAgIE5vZGVzTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihub2RlTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgIG5vZGVMaXN0Q3RybC5ub2RlcyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihub2RlTGlzdEN0cmwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgIGdldE5vZGVzKGZhbHNlKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldE5vZGVzKHRydWUpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bm9kZWxpc3RjdHJsLmpzLm1hcFxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5vcmdhbml6YXRpb25zJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5jcmVhdGUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnb3JnYW5pemF0aW9ucy9vcmdhbml6YXRpb25jcmVhdGUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnT3JnYW5pemF0aW9uQ3JlYXRlQ3RybCBhcyBvcmdhbml6YXRpb25DcmVhdGVDdHJsJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignT3JnYW5pemF0aW9uQ3JlYXRlQ3RybCcsIFsnJHN0YXRlJywgJ09yZ2FuaXphdGlvbnNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgT3JnYW5pemF0aW9uc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvT3JnYW5pemF0aW9ucygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub09yZ2FuaXphdGlvbnMoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVPcmdhbml6YXRpb24oKSB7XG4gICAgICAgICAgICAvL2Zvcm0gY29udHJvbGxlciBpcyBpbmplY3RlZCBieSB0aGUgaHRtbCB0ZW1wbGF0ZVxuICAgICAgICAgICAgLy9jaGVja2luZyBpZiBhbGwgdmFsaWRhdGlvbnMgaGF2ZSBwYXNzZWRcbiAgICAgICAgICAgIGlmIChvcmdhbml6YXRpb25DcmVhdGVDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwubmV3T3JnYW5pemF0aW9uLmtleSA9IG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwubmV3T3JnYW5pemF0aW9uLnRlbmFudE5hbWU7XG4gICAgICAgICAgICAgICAgT3JnYW5pemF0aW9uc01vZGVsLmNyZWF0ZShvcmdhbml6YXRpb25DcmVhdGVDdHJsLm5ld09yZ2FuaXphdGlvbikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvT3JnYW5pemF0aW9ucygpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25DcmVhdGVDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJlc2V0Rm9ybSgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBvcmdhbml6YXRpb25DcmVhdGVDdHJsLm5ld09yZ2FuaXphdGlvbiA9IHtcbiAgICAgICAgICAgICAgICB0ZW5hbnROYW1lOiAnJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBvcmdhbml6YXRpb25DcmVhdGVDdHJsLmNyZWF0ZU9yZ2FuaXphdGlvbiA9IGNyZWF0ZU9yZ2FuaXphdGlvbjtcbiAgICAgICAgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybC5jYW5jZWxDcmVhdGluZyA9IGNhbmNlbENyZWF0aW5nO1xuICAgICAgICByZXNldEZvcm0oKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1vcmdhbml6YXRpb25jcmVhdGVjdHJsLmpzLm1hcFxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5vcmdhbml6YXRpb25zJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnT3JnYW5pemF0aW9uRGV0YWlsc0N0cmwgYXMgb3JnYW5pemF0aW9uRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdvcmdhbml6YXRpb25zL29yZ2FuaXphdGlvbmRldGFpbHMuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ09yZ2FuaXphdGlvbkRldGFpbHNDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ09yZ2FuaXphdGlvbnNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBPcmdhbml6YXRpb25zTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBvcmdhbml6YXRpb25EZXRhaWxzQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvT3JnYW5pemF0aW9ucygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZGVsZXRlT3JnYW5pemF0aW9uKCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIE9yZ2FuaXphdGlvbnNNb2RlbC5kZWxldGUob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwub3JnYW5pemF0aW9uKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICByZXR1cm5Ub09yZ2FuaXphdGlvbnMoKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgIE9yZ2FuaXphdGlvbnNNb2RlbC5nZXRNb2RlbEJ5S2V5KCRzdGF0ZVBhcmFtcy5rZXkpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAob3JnYW5pemF0aW9uKSB7XG4gICAgICAgICAgICBvcmdhbml6YXRpb25EZXRhaWxzQ3RybC5vcmdhbml6YXRpb24gPSBvcmdhbml6YXRpb247XG4gICAgICAgIH0pO1xuICAgICAgICBvcmdhbml6YXRpb25EZXRhaWxzQ3RybC5kZWxldGVPcmdhbml6YXRpb24gPSBkZWxldGVPcmdhbml6YXRpb247XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9b3JnYW5pemF0aW9uZGV0YWlsc2N0cmwuanMubWFwXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm9yZ2FuaXphdGlvbnMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5vcmdhbml6YXRpb25zLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnT3JnYW5pemF0aW9uc0xpc3RDdHJsIGFzIG9yZ2FuaXphdGlvbnNMaXN0Q3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ29yZ2FuaXphdGlvbnMvb3JnYW5pemF0aW9ubGlzdC5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignT3JnYW5pemF0aW9uc0xpc3RDdHJsJywgWyckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnT3JnYW5pemF0aW9uc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIE9yZ2FuaXphdGlvbnNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIG9yZ2FuaXphdGlvbnNMaXN0Q3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGdldE9yZ2FuaXphdGlvbnMocmVsb2FkKSB7XG4gICAgICAgICAgICBPcmdhbml6YXRpb25zTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25zTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgIG9yZ2FuaXphdGlvbnNMaXN0Q3RybC5vcmdhbml6YXRpb25zID0gcmVzdWx0O1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG9yZ2FuaXphdGlvbnNMaXN0Q3RybCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgZ2V0T3JnYW5pemF0aW9ucyhmYWxzZSk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG9yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldE9yZ2FuaXphdGlvbnModHJ1ZSk7XG4gICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1vcmdhbml6YXRpb25saXN0Y3RybC5qcy5tYXBcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc2V0dGluZ3MnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLmNsdXN0ZXInLCB7XG4gICAgICAgICAgICB1cmw6ICcvY2x1c3RlcicsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQ2x1c3RlclNldHRpbmdDdHJsIGFzIGNsdXN0ZXJTZXR0aW5nQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NldHRpbmdzL2NsdXN0ZXJzZXR0aW5ncy5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignQ2x1c3RlclNldHRpbmdDdHJsJywgWyckc3RhdGVQYXJhbXMnLCAnQ1JVREhlbHBlclNlcnZpY2UnLCAnTm9kZXNTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlUGFyYW1zLCBDUlVESGVscGVyU2VydmljZSwgTm9kZXNTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBjbHVzdGVyU2V0dGluZ0N0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiB1cGRhdGVDbHVzdGVyU2V0dGluZ3MoKSB7XG4gICAgICAgICAgICBpZiAoY2x1c3RlclNldHRpbmdDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGNsdXN0ZXJTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoY2x1c3RlclNldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICBjbHVzdGVyU2V0dGluZ0N0cmwubm9kZU9wc09iai5ub2RlcyA9IFskc3RhdGVQYXJhbXMua2V5XTtcbiAgICAgICAgICAgICAgICBOb2Rlc1NlcnZpY2UuY2xlYW51cEV4dHJhVmFycyhjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgIE5vZGVzU2VydmljZS5jcmVhdGVFeHRyYVZhcnMoY2x1c3RlclNldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICBOb2Rlc1NlcnZpY2UudXBkYXRlU2V0dGluZ3MoY2x1c3RlclNldHRpbmdDdHJsLm5vZGVPcHNPYmopLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGNsdXN0ZXJTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoY2x1c3RlclNldHRpbmdDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNsdXN0ZXJTZXR0aW5nQ3RybC5ub2RlT3BzT2JqID0ge307XG4gICAgICAgIGNsdXN0ZXJTZXR0aW5nQ3RybC5leHRyYV92YXJzID0ge307IC8vVE9ETyBJbnRpYWxpemUgZnJvbSBnbG9iYWwgc2V0dGluZ3NcbiAgICAgICAgY2x1c3RlclNldHRpbmdDdHJsLmFuc2libGVWYXJpYWJsZXMgPSBbXTtcbiAgICAgICAgY2x1c3RlclNldHRpbmdDdHJsLmVudlZhcmlhYmxlcyA9IFtdO1xuICAgICAgICBOb2Rlc1NlcnZpY2UuZ2V0U2V0dGluZ3MoY2x1c3RlclNldHRpbmdDdHJsKTtcbiAgICAgICAgY2x1c3RlclNldHRpbmdDdHJsLnVwZGF0ZUNsdXN0ZXJTZXR0aW5ncyA9IHVwZGF0ZUNsdXN0ZXJTZXR0aW5ncztcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoY2x1c3RlclNldHRpbmdDdHJsKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jbHVzdGVyc2V0dGluZ2N0cmwuanMubWFwXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnNldHRpbmdzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5uZXR3b3JrcycsIHtcbiAgICAgICAgICAgIHVybDogJy9uZXR3b3JrcycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTmV0d29ya1NldHRpbmdDdHJsIGFzIG5ldHdvcmtTZXR0aW5nQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NldHRpbmdzL25ldHdvcmtzZXR0aW5ncy5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTmV0d29ya1NldHRpbmdDdHJsJywgWydDUlVESGVscGVyU2VydmljZScsICdOZXR3b3JrU2VydmljZScsXG4gICAgZnVuY3Rpb24gKENSVURIZWxwZXJTZXJ2aWNlLCBOZXR3b3JrU2VydmljZSkge1xuICAgICAgICB2YXIgbmV0d29ya1NldHRpbmdDdHJsID0gdGhpcztcbiAgICAgICAgbmV0d29ya1NldHRpbmdDdHJsLnZsYW5QYXR0ZXJuID0gQ29udGl2R2xvYmFscy5WTEFOX1JFR0VYO1xuICAgICAgICBuZXR3b3JrU2V0dGluZ0N0cmwudnhsYW5QYXR0ZXJuID0gQ29udGl2R2xvYmFscy5WWExBTl9SRUdFWDtcbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlTmV0d29ya1NldHRpbmdzKCkge1xuICAgICAgICAgICAgaWYgKG5ldHdvcmtTZXR0aW5nQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihuZXR3b3JrU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKG5ldHdvcmtTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgTmV0d29ya1NlcnZpY2UudXBkYXRlU2V0dGluZ3MobmV0d29ya1NldHRpbmdDdHJsLnNldHRpbmcpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3JrU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IobmV0d29ya1NldHRpbmdDdHJsLCByZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0TmV0d29ya1NldHRpbmdzKCkge1xuICAgICAgICAgICAgTmV0d29ya1NlcnZpY2UuZ2V0U2V0dGluZ3MoKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBuZXR3b3JrU2V0dGluZ0N0cmwuc2V0dGluZyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBnZXROZXR3b3JrU2V0dGluZ3MoKTtcbiAgICAgICAgbmV0d29ya1NldHRpbmdDdHJsLnVwZGF0ZU5ldHdvcmtTZXR0aW5ncyA9IHVwZGF0ZU5ldHdvcmtTZXR0aW5ncztcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3JrU2V0dGluZ0N0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IobmV0d29ya1NldHRpbmdDdHJsKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1uZXR3b3Jrc2V0dGluZ2N0cmwuanMubWFwXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnNldHRpbmdzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy52b2x1bWVzJywge1xuICAgICAgICAgICAgdXJsOiAnL3ZvbHVtZXMnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1ZvbHVtZVNldHRpbmdDdHJsIGFzIHZvbHVtZVNldHRpbmdDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2V0dGluZ3Mvdm9sdW1lc2V0dGluZ3MuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1ZvbHVtZVNldHRpbmdDdHJsJywgWydDUlVESGVscGVyU2VydmljZScsICdWb2x1bWVTZXR0aW5nU2VydmljZScsXG4gICAgZnVuY3Rpb24gKENSVURIZWxwZXJTZXJ2aWNlLCBWb2x1bWVTZXR0aW5nU2VydmljZSkge1xuICAgICAgICB2YXIgdm9sdW1lU2V0dGluZ0N0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiB1cGRhdGVWb2x1bWVTZXR0aW5ncygpIHtcbiAgICAgICAgICAgIGlmICh2b2x1bWVTZXR0aW5nQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcih2b2x1bWVTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIodm9sdW1lU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgIFZvbHVtZVNldHRpbmdTZXJ2aWNlLnVwZGF0ZVNldHRpbmdzKHZvbHVtZVNldHRpbmdDdHJsLnNldHRpbmcpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZVNldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZVNldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHZvbHVtZVNldHRpbmdDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdldFZvbHVtZVNldHRpbmdzKCkge1xuICAgICAgICAgICAgVm9sdW1lU2V0dGluZ1NlcnZpY2UuZ2V0U2V0dGluZ3MoKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB2b2x1bWVTZXR0aW5nQ3RybC5zZXR0aW5nID0gcmVzdWx0O1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGdldFZvbHVtZVNldHRpbmdzKCk7XG4gICAgICAgIHZvbHVtZVNldHRpbmdDdHJsLnVwZGF0ZVZvbHVtZVNldHRpbmdzID0gdXBkYXRlVm9sdW1lU2V0dGluZ3M7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lU2V0dGluZ0N0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iodm9sdW1lU2V0dGluZ0N0cmwpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXZvbHVtZXNldHRpbmdjdHJsLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzEyLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnNlcnZpY2VsYnMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXJ2aWNlX2xicy9zZXJ2aWNlbGJjcmVhdGUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU2VydmljZWxiQ3JlYXRlQ3RybCBhcyBzZXJ2aWNlbGJDcmVhdGVDdHJsJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignU2VydmljZWxiQ3JlYXRlQ3RybCcsIFtcbiAgICAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdTZXJ2aWNlbGJzTW9kZWwnLCAnTmV0d29ya3NNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBTZXJ2aWNlbGJzTW9kZWwsIE5ldHdvcmtzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlbGJDcmVhdGVDdHJsID0gdGhpcztcbiAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5sYWJlbFNlbGVjdG9ycyA9IFtdO1xuICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLm5ldHdvcmtzID0gW107XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvU2VydmljZWxicygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuc2VydmljZWxicy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub1NlcnZpY2VsYnMoKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IG5ldHdvcmtzIGZvciB0aGUgZ2l2ZW4gdGVuYW50LlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gZ2V0TmV0d29ya3MoKSB7XG4gICAgICAgICAgICBOZXR3b3Jrc01vZGVsLmdldCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHNlcnZpY2VsYkNyZWF0ZUN0cmwubmV0d29ya3MgPSBfLmZpbHRlcihyZXN1bHQsIHtcbiAgICAgICAgICAgICAgICAgICAgJ3RlbmFudE5hbWUnOiAnZGVmYXVsdCcgLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUxhYmVsU2VsZWN0b3JTdHJpbmdzKCkge1xuICAgICAgICAgICAgLy9FbXB0eSBvdXQgdGhlIHNlbGVjdG9ycy4gSW4gY2FzZSBvZiBzZXJ2ZXIgZXJyb3JzIHRoaXMgbmVlZHMgdG8gYmUgcmVzZXQuXG4gICAgICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLnNlcnZpY2VsYi5zZWxlY3RvcnMgPSBbXTtcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChzZXJ2aWNlbGJDcmVhdGVDdHJsLmxhYmVsU2VsZWN0b3JzLCBmdW5jdGlvbiAobGFiZWxTZWxlY3Rvcikge1xuICAgICAgICAgICAgICAgIHZhciBzZWxlY3RvclN0cmluZyA9IGxhYmVsU2VsZWN0b3IubmFtZSArICc9JyArIGxhYmVsU2VsZWN0b3IudmFsdWU7XG4gICAgICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIuc2VsZWN0b3JzLnB1c2goc2VsZWN0b3JTdHJpbmcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlU2VydmljZWxiKCkge1xuICAgICAgICAgICAgY3JlYXRlTGFiZWxTZWxlY3RvclN0cmluZ3MoKTtcbiAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgaWYgKHNlcnZpY2VsYkNyZWF0ZUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc2VydmljZWxiQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoc2VydmljZWxiQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIua2V5ID1cbiAgICAgICAgICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIudGVuYW50TmFtZSArICc6JyArIHNlcnZpY2VsYkNyZWF0ZUN0cmwuc2VydmljZWxiLnNlcnZpY2VOYW1lO1xuICAgICAgICAgICAgICAgIFNlcnZpY2VsYnNNb2RlbC5jcmVhdGUoc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1NlcnZpY2VsYnMoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Ioc2VydmljZWxiQ3JlYXRlQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXNldEZvcm0oKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHNlcnZpY2VsYkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIgPSB7XG4gICAgICAgICAgICAgICAgc2VydmljZU5hbWU6ICcnLFxuICAgICAgICAgICAgICAgIG5ldHdvcmtOYW1lOiAnJyxcbiAgICAgICAgICAgICAgICBpcEFkZHJlc3M6ICcnLFxuICAgICAgICAgICAgICAgIHNlbGVjdG9yczogW10sXG4gICAgICAgICAgICAgICAgcG9ydHM6IFtdLFxuICAgICAgICAgICAgICAgIHRlbmFudE5hbWU6ICdkZWZhdWx0JyAvL1RPRE86IFJlbW92ZSBoYXJkY29kZWQgdGVuYW50LlxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLmNyZWF0ZVNlcnZpY2VsYiA9IGNyZWF0ZVNlcnZpY2VsYjtcbiAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5jYW5jZWxDcmVhdGluZyA9IGNhbmNlbENyZWF0aW5nO1xuICAgICAgICBnZXROZXR3b3JrcygpO1xuICAgICAgICByZXNldEZvcm0oKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zZXJ2aWNlbGJjcmVhdGVjdHJsLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzExLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnNlcnZpY2VsYnMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGV0YWlscy86a2V5JyxcbiAgICAgICAgICAgIHBhcmFtczogeyBzdGF0ZTogbnVsbCB9LFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1NlcnZpY2VsYkRldGFpbHNDdHJsIGFzIHNlcnZpY2VsYkRldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2VydmljZV9sYnMvc2VydmljZWxiZGV0YWlscy5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmRldGFpbHMuaW5mbycsIHtcbiAgICAgICAgICAgIHVybDogJy9pbmZvJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTZXJ2aWNlbGJEZXRhaWxzQ3RybCBhcyBzZXJ2aWNlbGJEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NlcnZpY2VfbGJzL3NlcnZpY2VsYmluZm8uaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2VydmljZWxicy5kZXRhaWxzLmVkaXQnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZWRpdC86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTZXJ2aWNlbGJEZXRhaWxzQ3RybCBhcyBzZXJ2aWNlbGJEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NlcnZpY2VfbGJzL3NlcnZpY2VsYmluZm8uaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1NlcnZpY2VsYkRldGFpbHNDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ1NlcnZpY2VsYnNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBTZXJ2aWNlbGJzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlbGJEZXRhaWxzQ3RybCA9IHRoaXM7XG4gICAgICAgIHNlcnZpY2VsYkRldGFpbHNDdHJsLmxhYmVsU2VsZWN0b3JzID0gW107XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUbyBzaG93IGVkaXQgb3IgZGV0YWlscyBzY3JlZW4gYmFzZWQgb24gdGhlIHJvdXRlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBzZXRNb2RlKCkge1xuICAgICAgICAgICAgaWYgKCRzdGF0ZS5pcygnY29udGl2Lm1lbnUuc2VydmljZWxicy5kZXRhaWxzLmVkaXQnKSkge1xuICAgICAgICAgICAgICAgIHNlcnZpY2VsYkRldGFpbHNDdHJsLm1vZGUgPSAnZWRpdCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5tb2RlID0gJ2RldGFpbHMnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvU2VydmljZWxicygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuc2VydmljZWxicy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9TZXJ2aWNlbGJEZXRhaWxzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmRldGFpbHMuaW5mbycsIHsgJ2tleSc6IHNlcnZpY2VsYkRldGFpbHNDdHJsLnNlcnZpY2VsYi5rZXksICdzdGF0ZSc6ICdkZXRhaWxzJyB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxFZGl0aW5nKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9TZXJ2aWNlbGJEZXRhaWxzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZGVsZXRlU2VydmljZWxiKCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHNlcnZpY2VsYkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKHNlcnZpY2VsYkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIFNlcnZpY2VsYnNNb2RlbC5kZWxldGUoc2VydmljZWxiRGV0YWlsc0N0cmwuc2VydmljZWxiKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICByZXR1cm5Ub1NlcnZpY2VsYnMoKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKHNlcnZpY2VsYkRldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gc2F2ZVNlcnZpY2VsYigpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICB2YXIgZXhpc3RpbmdMYWJlbHMgPSBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIuc2VsZWN0b3JzO1xuICAgICAgICAgICAgY3JlYXRlTGFiZWxTZWxlY3RvclN0cmluZ3MoKTtcbiAgICAgICAgICAgIFNlcnZpY2VsYnNNb2RlbC5zYXZlKHNlcnZpY2VsYkRldGFpbHNDdHJsLnNlcnZpY2VsYikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9TZXJ2aWNlbGJEZXRhaWxzKCk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHNlcnZpY2VsYkRldGFpbHNDdHJsLnNlcnZpY2VsYi5zZWxlY3RvcnMgPSBleGlzdGluZ0xhYmVscztcbiAgICAgICAgICAgICAgICBjcmVhdGVMYWJlbFNlbGVjdG9ycygpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUxhYmVsU2VsZWN0b3JzKCkge1xuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHNlcnZpY2VsYkRldGFpbHNDdHJsLnNlcnZpY2VsYi5zZWxlY3RvcnMsIGZ1bmN0aW9uIChzZWxlY3RvclN0cikge1xuICAgICAgICAgICAgICAgIHZhciBzZWxlY3RvciA9IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogc2VsZWN0b3JTdHIuc3BsaXQoJz0nKVswXSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHNlbGVjdG9yU3RyLnNwbGl0KCc9JylbMV1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHNlcnZpY2VsYkRldGFpbHNDdHJsLmxhYmVsU2VsZWN0b3JzLnB1c2goc2VsZWN0b3IpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlTGFiZWxTZWxlY3RvclN0cmluZ3MoKSB7XG4gICAgICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIuc2VsZWN0b3JzID0gW107XG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goc2VydmljZWxiRGV0YWlsc0N0cmwubGFiZWxTZWxlY3RvcnMsIGZ1bmN0aW9uIChsYWJlbFNlbGVjdG9yKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGVjdG9yU3RyaW5nID0gbGFiZWxTZWxlY3Rvci5uYW1lICsgJz0nICsgbGFiZWxTZWxlY3Rvci52YWx1ZTtcbiAgICAgICAgICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIuc2VsZWN0b3JzLnB1c2goc2VsZWN0b3JTdHJpbmcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgIFNlcnZpY2VsYnNNb2RlbC5nZXRNb2RlbEJ5S2V5KCRzdGF0ZVBhcmFtcy5rZXkpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2soc2VydmljZWxiKSB7XG4gICAgICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIgPSBzZXJ2aWNlbGI7XG4gICAgICAgICAgICBjcmVhdGVMYWJlbFNlbGVjdG9ycygpO1xuICAgICAgICB9KTtcbiAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwuc2F2ZVNlcnZpY2VsYiA9IHNhdmVTZXJ2aWNlbGI7XG4gICAgICAgIHNlcnZpY2VsYkRldGFpbHNDdHJsLmNhbmNlbEVkaXRpbmcgPSBjYW5jZWxFZGl0aW5nO1xuICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5kZWxldGVTZXJ2aWNlbGIgPSBkZWxldGVTZXJ2aWNlbGI7XG4gICAgICAgIHNldE1vZGUoKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zZXJ2aWNlbGJkZXRhaWxzY3RybC5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xMS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zZXJ2aWNlbGJzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2VydmljZWxicy5saXN0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1NlcnZpY2VsYkxpc3RDdHJsIGFzIHNlcnZpY2VsYkxpc3RDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2VydmljZV9sYnMvc2VydmljZWxibGlzdC5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignU2VydmljZWxiTGlzdEN0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdTZXJ2aWNlbGJzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgU2VydmljZWxic01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgc2VydmljZWxiTGlzdEN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBnZXRTZXJ2aWNlbGJzKHJlbG9hZCkge1xuICAgICAgICAgICAgU2VydmljZWxic01vZGVsLmdldChyZWxvYWQpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc2VydmljZWxiTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgIHNlcnZpY2VsYkxpc3RDdHJsLnNlcnZpY2VsYnMgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc2VydmljZWxiTGlzdEN0cmwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgIGdldFNlcnZpY2VsYnMoZmFsc2UpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXRTZXJ2aWNlbGJzKHRydWUpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c2VydmljZWxibGlzdGN0cmwuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTMvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LnNlcnZpY2VsYnNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2U2VydmljZWxicG9ydHNcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBpdGVtczogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSkge1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDb21wYXJlIGlmIHR3byBpdGVtcyBoYXZlIHNhbWUgcG9ydHMgYW5kIHByb3RvY29sc1xuICAgICAgICAgICAgICogQHBhcmFtIHZhbDFcbiAgICAgICAgICAgICAqIEBwYXJhbSB2YWwyXG4gICAgICAgICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gY29tcGFyZSh2YWwxLCB2YWwyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICh2YWwxID09PSB2YWwyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlc2V0TmV3SXRlbSgpIHtcbiAgICAgICAgICAgICAgICBzY29wZS5uZXdJdGVtID0ge1xuICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlUG9ydDogJycsXG4gICAgICAgICAgICAgICAgICAgIHByb3ZpZGVyUG9ydDogJycsXG4gICAgICAgICAgICAgICAgICAgIHByb3RvY29sOiAnJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmdW5jdGlvbiBpc0VtcHR5SXRlbShpdGVtKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChpdGVtLnNlcnZpY2VQb3J0ID09PSAnJyAmJiBpdGVtLnByb3ZpZGVyUG9ydCA9PT0gJycgJiYgaXRlbS5wcm90b2NvbCA9PT0gJycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2NvcGUuYWRkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChpc0VtcHR5SXRlbShzY29wZS5uZXdJdGVtKSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGlmIChzY29wZS5pdGVtcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLml0ZW1zID0gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBuZXdJdGVtU3RyID0gc2NvcGUubmV3SXRlbS5zZXJ2aWNlUG9ydCArICc6J1xuICAgICAgICAgICAgICAgICAgICArIHNjb3BlLm5ld0l0ZW0ucHJvdmlkZXJQb3J0ICsgJzonXG4gICAgICAgICAgICAgICAgICAgICsgc2NvcGUubmV3SXRlbS5wcm90b2NvbDtcbiAgICAgICAgICAgICAgICAvL1JlbW92ZXMgZXhpc3RpbmcgaXRlbSB3aXRoIHRoZSBzYW1lIHZhbHVlIGZpcnN0IGlmIGl0IGV4aXN0cy5cbiAgICAgICAgICAgICAgICBfLnB1bGxBbGxXaXRoKHNjb3BlLml0ZW1zLCBbbmV3SXRlbVN0cl0sIGNvbXBhcmUpO1xuICAgICAgICAgICAgICAgIHNjb3BlLml0ZW1zLnB1c2gobmV3SXRlbVN0cik7XG4gICAgICAgICAgICAgICAgcmVzZXROZXdJdGVtKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgc2NvcGUucmVtb3ZlID0gZnVuY3Rpb24gKHBhc3NlZEl0ZW0pIHtcbiAgICAgICAgICAgICAgICBfLnJlbW92ZShzY29wZS5pdGVtcywgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBhcmUoaXRlbSwgcGFzc2VkSXRlbSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmVzZXROZXdJdGVtKCk7XG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnc2VydmljZV9sYnMvc2VydmljZWxicG9ydHMuaHRtbCdcbiAgICB9O1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zZXJ2aWNlbGJwb3J0c2RpcmVjdGl2ZS5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSBjc2hhbXB1ciBvbiA3LzE3LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnNlcnZpY2VsYnMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmRldGFpbHMuc3RhdHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvc3RhdHMnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1NlcnZpY2VsYlN0YXRzQ3RybCBhcyBzZXJ2aWNlbGJTdGF0c0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXJ2aWNlX2xicy9zZXJ2aWNlbGJzdGF0cy5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignU2VydmljZWxiU3RhdHNDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdTZXJ2aWNlbGJzTW9kZWwnLCAnSW5zcGVjdFNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIFNlcnZpY2VsYnNNb2RlbCwgSW5zcGVjdFNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHNlcnZpY2VsYlN0YXRzQ3RybCA9IHRoaXM7XG4gICAgICAgIC8qIEdldHMgdGhlIE5ldHdvcmsgT3BlcmF0aW9uYWwgc3RhdGUgZnJvbSB0aGUgc2VydmVyICovXG4gICAgICAgIGZ1bmN0aW9uIGdldFNlcnZpY2VsYkluc3BlY3QocmVmcmVzaCkge1xuICAgICAgICAgICAgU2VydmljZWxic01vZGVsLmdldEluc3BlY3RCeUtleSgkc3RhdGVQYXJhbXMua2V5LCBDb250aXZHbG9iYWxzLlNFUlZJQ0VMQlNfSU5TUEVDVF9FTkRQT0lOVCwgcmVmcmVzaClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgc2VydmljZWxiU3RhdHNDdHJsLnNlcnZpY2VsYkluc3BlY3RTdGF0cyA9IHJlc3VsdC5PcGVyO1xuICAgICAgICAgICAgICAgIHNlcnZpY2VsYlN0YXRzQ3RybC5jb25maWcgPSByZXN1bHQuQ29uZmlnO1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuT3Blci5wcm92aWRlcnMgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwcm92aWRlckRldGFpbHMgPSBJbnNwZWN0U2VydmljZS5idWlsZEVuZFBvaW50cyhyZXN1bHQuT3Blci5wcm92aWRlcnMpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoSW5zcGVjdFNlcnZpY2UuY2hlY2tDb250YWluZXJDaGFuZ2VkKHNlcnZpY2VsYlN0YXRzQ3RybC5wcm92aWRlckRldGFpbHMsIHByb3ZpZGVyRGV0YWlscykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2VsYlN0YXRzQ3RybC5wcm92aWRlcnMgPSByZXN1bHQuT3Blci5wcm92aWRlcnM7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlbGJTdGF0c0N0cmwucHJvdmlkZXJEZXRhaWxzID0gcHJvdmlkZXJEZXRhaWxzO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlbGJTdGF0c0N0cmwucHJvdmlkZXJzID0gW107XG4gICAgICAgICAgICAgICAgICAgIHNlcnZpY2VsYlN0YXRzQ3RybC5wcm92aWRlckRldGFpbHMgPSB7fTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBnZXRTZXJ2aWNlbGJJbnNwZWN0KGZhbHNlKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0b3JlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0U2VydmljZWxiSW5zcGVjdCh0cnVlKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNlcnZpY2VsYnN0YXRzY3RybC5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNi8xLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnN0b3JhZ2Vwb2xpY2llcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5jcmVhdGUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9zdG9yYWdlcG9saWN5Y3JlYXRlLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1N0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsIGFzIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignU3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnU3RvcmFnZVBvbGljaWVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgU3RvcmFnZVBvbGljaWVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvU3RvcmFnZVBvbGljaWVzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMubGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbENyZWF0aW5nKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9TdG9yYWdlUG9saWNpZXMoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVGaWxlc3lzdGVtQ21kcygpIHtcbiAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLmZpbGVzeXN0ZW1jbWRzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5uZXdTdG9yYWdlUG9saWN5LmZpbGVzeXN0ZW1zW2l0ZW0ubmFtZV0gPSBpdGVtLnZhbHVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlUG9saWN5KCkge1xuICAgICAgICAgICAgLy9mb3JtIGNvbnRyb2xsZXIgaXMgaW5qZWN0ZWQgYnkgdGhlIGh0bWwgdGVtcGxhdGVcbiAgICAgICAgICAgIC8vY2hlY2tpbmcgaWYgYWxsIHZhbGlkYXRpb25zIGhhdmUgcGFzc2VkXG4gICAgICAgICAgICBpZiAoc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBjcmVhdGVGaWxlc3lzdGVtQ21kcygpO1xuICAgICAgICAgICAgICAgIFN0b3JhZ2VQb2xpY2llc01vZGVsLmNyZWF0ZShzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5uZXdTdG9yYWdlUG9saWN5KVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1N0b3JhZ2VQb2xpY2llcygpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmVzZXRGb3JtKCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwubmV3U3RvcmFnZVBvbGljeSA9IHtcbiAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICBcImJhY2tlbmRzXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJjcnVkXCI6IFwiY2VwaFwiLFxuICAgICAgICAgICAgICAgICAgICBcIm1vdW50XCI6IFwiY2VwaFwiLFxuICAgICAgICAgICAgICAgICAgICBcInNuYXBzaG90XCI6IFwiY2VwaFwiXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBcInVubG9ja2VkXCI6IGZhbHNlLFxuICAgICAgICAgICAgICAgIFwiZHJpdmVyXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJwb29sXCI6IFwicmJkXCJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFwiY3JlYXRlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJzaXplXCI6IFwiMFwiLFxuICAgICAgICAgICAgICAgICAgICBcImZpbGVzeXN0ZW1cIjogXCJcIlxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXCJydW50aW1lXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJzbmFwc2hvdHNcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgXCJzbmFwc2hvdFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImZyZXF1ZW5jeVwiOiBcIjMwbVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJrZWVwXCI6IDIwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFwicmF0ZS1saW1pdFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcIndyaXRlLWlvcHNcIjogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVhZC1pb3BzXCI6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIndyaXRlLWJwc1wiOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWFkLWJwc1wiOiAwXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFwiZmlsZXN5c3RlbXNcIjoge31cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwuY3JlYXRlUG9saWN5ID0gY3JlYXRlUG9saWN5O1xuICAgICAgICBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5jYW5jZWxDcmVhdGluZyA9IGNhbmNlbENyZWF0aW5nO1xuICAgICAgICBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5maWxlc3lzdGVtY21kcyA9IFtdO1xuICAgICAgICByZXNldEZvcm0oKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdG9yYWdlcG9saWN5Y3JlYXRlY3RybC5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8yNy8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zdG9yYWdlcG9saWNpZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1N0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCBhcyBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL3N0b3JhZ2Vwb2xpY3lkZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5lZGl0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU3RvcmFnZVBvbGljeURldGFpbHNDdHJsIGFzIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvc3RvcmFnZXBvbGljeWRldGFpbHMuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1N0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnU3RvcmFnZVBvbGljaWVzTW9kZWwnLCAnVm9sdW1lc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBTdG9yYWdlUG9saWNpZXNNb2RlbCwgVm9sdW1lc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsID0gdGhpcztcbiAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmZpbGVzeXN0ZW1jbWRzID0gW107XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUbyBzaG93IGVkaXQgb3IgZGV0YWlscyBzY3JlZW4gYmFzZWQgb24gdGhlIHJvdXRlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBzZXRNb2RlKCkge1xuICAgICAgICAgICAgaWYgKCRzdGF0ZS5pcygnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmVkaXQnKSkge1xuICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5tb2RlID0gJ2VkaXQnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLm1vZGUgPSAnZGV0YWlscyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Qb2xpY2llcygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1BvbGljeURldGFpbHMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5kZXRhaWxzJywgeyAna2V5Jzogc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnBvbGljeS5uYW1lIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbEVkaXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub1BvbGljeURldGFpbHMoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBkZWxldGVQb2xpY3koKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbC5kZWxldGVVc2luZ0tleShzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5Lm5hbWUsICduYW1lJykudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIHJldHVyblRvUG9saWNpZXMoKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IHZvbHVtZXMgYmVsb25naW5nIHRvIGEgcG9saWN5XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBnZXRWb2x1bWVzKHJlbG9hZCkge1xuICAgICAgICAgICAgVm9sdW1lc01vZGVsLmdldChyZWxvYWQpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC52b2x1bWVzID0gJGZpbHRlcignb3JkZXJCeScpKF8uZmlsdGVyKHJlc3VsdCwge1xuICAgICAgICAgICAgICAgICAgICAncG9saWN5Jzogc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnBvbGljeS5uYW1lXG4gICAgICAgICAgICAgICAgfSksICduYW1lJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBpbml0aWFsaXplRmlsZXN5c3RlbUNtZHNBcnJheSgpIHtcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5LmZpbGVzeXN0ZW1zLCBmdW5jdGlvbiAodmFsdWUsIGtleSkge1xuICAgICAgICAgICAgICAgIHRoaXMucHVzaCh7IG5hbWU6IGtleSwgdmFsdWU6IHZhbHVlIH0pO1xuICAgICAgICAgICAgfSwgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmZpbGVzeXN0ZW1jbWRzKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVGaWxlc3lzdGVtQ21kcygpIHtcbiAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5maWxlc3lzdGVtY21kcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnBvbGljeS5maWxlc3lzdGVtc1tpdGVtLm5hbWVdID0gaXRlbS52YWx1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHNhdmVQb2xpY3koKSB7XG4gICAgICAgICAgICAvL2Zvcm0gY29udHJvbGxlciBpcyBpbmplY3RlZCBieSB0aGUgaHRtbCB0ZW1wbGF0ZVxuICAgICAgICAgICAgLy9jaGVja2luZyBpZiBhbGwgdmFsaWRhdGlvbnMgaGF2ZSBwYXNzZWRcbiAgICAgICAgICAgIGlmIChzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIGNyZWF0ZUZpbGVzeXN0ZW1DbWRzKCk7XG4gICAgICAgICAgICAgICAgU3RvcmFnZVBvbGljaWVzTW9kZWwuc2F2ZShzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1BvbGljeURldGFpbHMoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgU3RvcmFnZVBvbGljaWVzTW9kZWwuZ2V0TW9kZWxCeUtleSgkc3RhdGVQYXJhbXMua2V5LCBmYWxzZSwgJ25hbWUnKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnBvbGljeSA9IHBvbGljeTtcbiAgICAgICAgICAgIGluaXRpYWxpemVGaWxlc3lzdGVtQ21kc0FycmF5KCk7XG4gICAgICAgICAgICBnZXRWb2x1bWVzKGZhbHNlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5kZWxldGVQb2xpY3kgPSBkZWxldGVQb2xpY3k7XG4gICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5zYXZlUG9saWN5ID0gc2F2ZVBvbGljeTtcbiAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmNhbmNlbEVkaXRpbmcgPSBjYW5jZWxFZGl0aW5nO1xuICAgICAgICBzZXRNb2RlKCk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG9yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldFZvbHVtZXModHJ1ZSk7XG4gICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdG9yYWdlcG9saWN5ZGV0YWlsc2N0cmwuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDYvMi8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoXCJjb250aXYuc3RvcmFnZXBvbGljaWVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dlN0b3JhZ2Vwb2xpY3liYXNpY3NldHRpbmdzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge307XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZTdG9yYWdlcG9saWN5ZmlsZXN5c3RlbXNldHRpbmdzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgcG9saWN5OiAnPScsXG4gICAgICAgICAgICBmaWxlc3lzdGVtY21kczogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSkge1xuICAgICAgICAgICAgc2NvcGUuZmlsZXN5c3RlbXMgPSBbJ2V4dDQnLCAnYnRyZnMnXTtcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL2ZpbGVzeXN0ZW1zZXR0aW5ncy5odG1sJ1xuICAgIH07XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZTdG9yYWdlcG9saWN5c25hcHNob3RzZXR0aW5nc1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIHBvbGljeTogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9zbmFwc2hvdHNldHRpbmdzLmh0bWwnXG4gICAgfTtcbn0pXG4gICAgLmRpcmVjdGl2ZShcImN0dlN0b3JhZ2Vwb2xpY3lyd29wc3NldHRpbmdzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgcG9saWN5OiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL3J3b3Bzc2V0dGluZ3MuaHRtbCdcbiAgICB9O1xufSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2U3RvcmFnZXBvbGljeWJhY2tlbmRkcml2ZXJzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgcG9saWN5OiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL2JhY2tlbmRkcml2ZXJzLmh0bWwnXG4gICAgfTtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3RvcmFnZXBvbGljeWRpcmVjdGl2ZS5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNC8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zdG9yYWdlcG9saWNpZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTdG9yYWdlUG9saWN5TGlzdEN0cmwgYXMgc3RvcmFnZVBvbGljeUxpc3RDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9zdG9yYWdlcG9saWN5bGlzdC5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignU3RvcmFnZVBvbGljeUxpc3RDdHJsJywgWyckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnU3RvcmFnZVBvbGljaWVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgU3RvcmFnZVBvbGljaWVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBzdG9yYWdlUG9saWN5TGlzdEN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBnZXRQb2xpY2llcyhyZWxvYWQpIHtcbiAgICAgICAgICAgIFN0b3JhZ2VQb2xpY2llc01vZGVsLmdldChyZWxvYWQpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeUxpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICBzdG9yYWdlUG9saWN5TGlzdEN0cmwucG9saWNpZXMgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc3RvcmFnZVBvbGljeUxpc3RDdHJsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vTG9hZCBmcm9tIGNhY2hlIGZvciBxdWljayBkaXNwbGF5IGluaXRpYWxseVxuICAgICAgICBnZXRQb2xpY2llcyhmYWxzZSk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG8tcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXRQb2xpY2llcyh0cnVlKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXN0b3JhZ2Vwb2xpY3lsaXN0Y3RybC5qcy5tYXBcblxuXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52aXN1YWxpemF0aW9uLmVkZ2UnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2VkZ2Uve3NvdXJjZU5hbWUsIHRhcmdldE5hbWUsIHNvdXJjZUxpc3QsIHRhcmdldExpc3R9JyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlTmFtZTogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TmFtZTogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgc291cmNlTGlzdDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TGlzdDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1Zpc3VhbGl6YXRpb25FZGdlQ3RybCBhcyB2aXN1YWxpemF0aW9uZWRnZUN0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9uZWRnZS5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdWaXN1YWxpemF0aW9uRWRnZUN0cmwnLCBbXCIkc2NvcGVcIiwgXCIkaHR0cFwiLCAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdWaXN1YWxpemF0aW9uU2VydmljZScsICckaW50ZXJ2YWwnLFxuICAgICAgICBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkc3RhdGUsICRzdGF0ZVBhcmFtcywgVmlzdWFsaXphdGlvblNlcnZpY2UsICRpbnRlcnZhbCkge1xuICAgICAgICAgICAgdmFyIHNvdXJjZU5hbWUgPSAkc3RhdGVQYXJhbXMuc291cmNlTmFtZTtcbiAgICAgICAgICAgIHZhciB0YXJnZXROYW1lID0gJHN0YXRlUGFyYW1zLnRhcmdldE5hbWU7XG4gICAgICAgICAgICB2YXIgc291cmNlTGlzdCA9ICRzdGF0ZVBhcmFtcy5zb3VyY2VMaXN0O1xuICAgICAgICAgICAgdmFyIHRhcmdldExpc3QgPSAkc3RhdGVQYXJhbXMudGFyZ2V0TGlzdDtcblxuICAgICAgICAgICAgLy9JZiB0aGUgcGFnZSBpcyByZWxvYWRlZCwgdGhlc2Ugc3RhdGUgcGFyYW1zIGFyZSBhbGwgbnVsbCxcbiAgICAgICAgICAgIC8vc28gaXQgd2lsbCByb3V0ZSB0aGVtIGJhY2sgdG8gdGhlIHZpc3VhbGl6YXRpb24gdGFiIHRvcCB2aWV3XG4gICAgICAgICAgICBpZiAoc291cmNlTGlzdCA9PSBudWxsIHx8IHRhcmdldExpc3QgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUudmlzdWFsaXphdGlvbi5saXN0Jyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgZCA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICB2YXIgdCA9IGQuZ2V0U2Vjb25kcygpO1xuICAgICAgICAgICAgJHNjb3BlLmVkZ2VEYXRhSW50ZXJ2YWwgPSBcbiAgICAgICAgICAgICAgICAkaW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIFZpc3VhbGl6YXRpb25TZXJ2aWNlLmdldEVkZ2VEYXRhKHNvdXJjZUxpc3QsIHRhcmdldExpc3QsIHQudG9TdHJpbmcoKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0cyA9IHJlc3VsdC5yZXN1bHRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2gocmVzdWx0cywgZnVuY3Rpb24ocikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoXy5pc0VtcHR5KHIpID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSArPSByLnNlcmllc1swXS52YWx1ZXNbMF1bMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlTmFtZSA9IHNvdXJjZU5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRhcmdldE5hbWUgPSB0YXJnZXROYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5lZGdlRGF0YSA9IGRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVkZ2VEYXRhVGltZSA9IHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0sIDMwMDApO1xuXG4gICAgICAgICAgICAvL0Rlc3Ryb3lpbmcgdGhlIGludGVydmFsIGZ1bmN0aW9uIG9uIHJvdXRlIGNoYW5nZVxuICAgICAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7ICRpbnRlcnZhbC5jYW5jZWwoJHNjb3BlLmVkZ2VEYXRhSW50ZXJ2YWwpOyB9KTtcblxuXG4gICAgICAgICAgICBWaXN1YWxpemF0aW9uU2VydmljZS5nZXRPbGRFZGdlRGF0YShzb3VyY2VMaXN0LCB0YXJnZXRMaXN0KVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSByZXN1bHQucmVzdWx0cztcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVkZ2VEYXRhID0gW107XG4gICAgICAgICAgICAgICAgICAgIC8vcmVzdWx0cywgaWYgbm90IGVtcHR5LCBhcmUgZXhwZWN0ZWQgdG8gaGF2ZVxuICAgICAgICAgICAgICAgICAgICAvLzYgZGF0YSBlbnRyaWVzXG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChyZXN1bHRzLCBmdW5jdGlvbihyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoXy5pc0VtcHR5KHIpID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gci5zZXJpZXNbMF0udmFsdWVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfLmlzRW1wdHkoZWRnZURhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChkYXRhLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGdlRGF0YS5wdXNoKGRbMV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChkYXRhLCBmdW5jdGlvbihkLCBpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGdlRGF0YVtpXSArPSBkWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNvdXJjZU5hbWUgPSBzb3VyY2VOYW1lO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudGFyZ2V0TmFtZSA9IHRhcmdldE5hbWU7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zb3VyY2VMaXN0ID0gc291cmNlTGlzdDtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRhcmdldExpc3QgPSB0YXJnZXRMaXN0O1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUub2xkRWRnZURhdGEgPSBlZGdlRGF0YTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIH0pO1xuICAgIH1dKTtcblxuXG5cblxuXG5cblxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52aXN1YWxpemF0aW9uJylcbiAgICAuZGlyZWN0aXZlKFwidmlzdWFsaXphdGlvbkVkZ2VcIiwgWyckd2luZG93JyxcbiAgICAgICAgZnVuY3Rpb24oJHdpbmRvdykge1xuICAgICAgICAgICAgZnVuY3Rpb24gdmlzdWFsaXphdGlvbkVkZ2VEMyhzY29wZSwgZDMpIHtcbiAgICAgICAgICAgICAgICB2YXIgYm9keUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gYm9keUVsLmNsaWVudFdpZHRoIC0gNDAwLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSAgYm9keUVsLmNsaWVudEhlaWdodCAtIDQwMDtcblxuXG4gICAgICAgICAgICAgICAgLy90YWtlbiBmcm9tIGh0dHA6Ly9ibC5vY2tzLm9yZy9zaW1lbmJyZWtrZW4vNjYzNDA3MFxuICAgICAgICAgICAgICAgIC8vIC8qKiBNQUlOIFNWRyAqKi9cbiAgICAgICAgICAgICAgICB2YXIgbGltaXQgPSA1OSxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbiA9IDc1MCxcbiAgICAgICAgICAgICAgICBub3cgPSBuZXcgRGF0ZShEYXRlLm5vdygpIC0gZHVyYXRpb24pO1xuXG4gICAgICAgICAgICAgICAgdmFyIGdyb3VwcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJ29yYW5nZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkMy5yYW5nZShsaW1pdCkubWFwKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2NvcGUub2xkRWRnZURhdGFbTWF0aC5mbG9vcihkLzEwKV0gfHwgMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciB4ID0gZDMudGltZS5zY2FsZSgpXG4gICAgICAgICAgICAgICAgICAgIC5kb21haW4oW25vdyAtIChsaW1pdCAtIDIpLCBub3cgLSBkdXJhdGlvbl0pXG4gICAgICAgICAgICAgICAgICAgIC5yYW5nZShbMCwgd2lkdGhdKTtcblxuICAgICAgICAgICAgICAgIHZhciB5ID0gZDMuc2NhbGUubGluZWFyKClcbiAgICAgICAgICAgICAgICAgICAgLmRvbWFpbihbMCwgZDMubWF4KGdyb3Vwcy5jdXJyZW50LmRhdGEsIGZ1bmN0aW9uIChkKSB7IHJldHVybiBkICsgMTA7IH0pXSlcbiAgICAgICAgICAgICAgICAgICAgLnJhbmdlKFtoZWlnaHQsIDBdKTtcblxuICAgICAgICAgICAgICAgIHZhciBsaW5lID0gZDMuc3ZnLmxpbmUoKVxuICAgICAgICAgICAgICAgICAgICAuaW50ZXJwb2xhdGUoJ2Jhc2lzJylcbiAgICAgICAgICAgICAgICAgICAgLngoZnVuY3Rpb24oZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHgobm93IC0gKGxpbWl0IC0gMSAtIGkpICogZHVyYXRpb24pXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC55KGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB5KGQpXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIHhTdmcgPSBkMy5zZWxlY3QoJy5ncmFwaCcpLmFwcGVuZCgnc3ZnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgMjUpXG4gICAgICAgICAgICAgICAgICAgIC5zdHlsZSgnb3ZlcmZsb3cnLCAndmlzaWJsZScpXG4gICAgICAgICAgICAgICAgICAgIC5zdHlsZSgncG9zaXRpb24nLCAnZml4ZWQnKTtcblxuICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgdmFyIHlBeGlzID0geFN2Zy5hcHBlbmQoJ2cnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAneSBheGlzJylcbiAgICAgICAgICAgICAgICAgICAgLy8gLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoMCwnICsgd2lkdGggKyAnKScpXG4gICAgICAgICAgICAgICAgICAgIC5jYWxsKHkuYXhpcyA9IGQzLnN2Zy5heGlzKCkuc2NhbGUoeSkub3JpZW50KCdsZWZ0JykpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciBzdmc9IGQzLnNlbGVjdCgnLmdyYXBoJykuYXBwZW5kKCdzdmcnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnY2hhcnQnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignd2lkdGgnLCB3aWR0aCAtIDUwKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignaGVpZ2h0JywgaGVpZ2h0ICsgNTApO1xuICAgICAgICAgICAgICAgICAgICAvLyAuc3R5bGUoJ292ZXJmbG93JywgXCJ2aXNpYmxlXCIpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGF4aXMgPSBzdmcuYXBwZW5kKCdnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ3ggYXhpcycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDAsJyArIGhlaWdodCArICcpJylcbiAgICAgICAgICAgICAgICAgICAgLmNhbGwoeC5heGlzID0gZDMuc3ZnLmF4aXMoKS5zY2FsZSh4KS5vcmllbnQoJ2JvdHRvbScpKTtcblxuICAgICAgICAgICAgICAgIHZhciBwYXRocyA9IHN2Zy5hcHBlbmQoJ2cnKTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIG5hbWUgaW4gZ3JvdXBzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBncm91cCA9IGdyb3Vwc1tuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXAucGF0aCA9IHBhdGhzLmFwcGVuZCgncGF0aCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZGF0YShbZ3JvdXAuZGF0YV0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCBuYW1lICsgJyBncm91cCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ3N0cm9rZScsIGdyb3VwLmNvbG9yKVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHRpY2soKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vdyA9IG5ldyBEYXRlKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQWRkIG5ldyB2YWx1ZXNcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBncm91cHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBncm91cCA9IGdyb3Vwc1tuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLmRhdGEucHVzaChzY29wZS5lZGdlRGF0YSB8fCAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLnBhdGguYXR0cignZCcsIGxpbmUpXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBTaGlmdCBkb21haW5cbiAgICAgICAgICAgICAgICAgICAgeC5kb21haW4oW25vdyAtIChsaW1pdCAtIDIpICogZHVyYXRpb24sIG5vdyAtIGR1cmF0aW9uXSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2xpZGUgeC1heGlzIGxlZnRcbiAgICAgICAgICAgICAgICAgICAgYXhpcy50cmFuc2l0aW9uKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kdXJhdGlvbihkdXJhdGlvbilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lYXNlKCdsaW5lYXInKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhbGwoeC5heGlzKTtcblxuICAgICAgICAgICAgICAgICAgICB5QXhpcy50cmFuc2l0aW9uKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kdXJhdGlvbihkdXJhdGlvbilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lYXNlKCdsaW5lYXInKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhbGwoeS5heGlzKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBTbGlkZSBwYXRocyBsZWZ0XG4gICAgICAgICAgICAgICAgICAgIHBhdGhzLmF0dHIoJ3RyYW5zZm9ybScsIG51bGwpXG4gICAgICAgICAgICAgICAgICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZHVyYXRpb24oZHVyYXRpb24pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZWFzZSgnbGluZWFyJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKCcgKyB4KG5vdyAtIChsaW1pdCAtIDEpICogZHVyYXRpb24pICsgJyknKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVhY2goJ2VuZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpY2soKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIG9sZGVzdCBkYXRhIHBvaW50IGZyb20gZWFjaCBncm91cFxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBuYW1lIGluIGdyb3Vwcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdyb3VwID0gZ3JvdXBzW25hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXAuZGF0YS5zaGlmdCgpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGljaygpXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybntcbiAgICAgICAgICAgICAgICByZXN0cmljdDonRUEnLFxuICAgICAgICAgICAgICAgIHJlcGxhY2U6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9uZWRnZXRlbXBsYXRlLmh0bWwnLFxuICAgICAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlKXtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJHdhdGNoR3JvdXAoWydlZGdlRGF0YScsICdvbGRFZGdlRGF0YSddLFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNjb3BlLmVkZ2VEYXRhICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLm9sZEVkZ2VEYXRhICE9IG51bGwgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2NvcGUuaW5pdGlhbGl6ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuaW5pdGlhbGl6ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZDMgPSAkd2luZG93LmQzOyAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXN1YWxpemF0aW9uRWRnZUQzKHNjb3BlLCBkMyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICB9XG4gICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICBdXG4pO1xuXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicpXG4gICAgLnNlcnZpY2UoJ1N0YXRlU2F2ZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zYXZlZFN0YXRlcyA9IHt9O1xuICAgIH0pXG4gICAgLmRpcmVjdGl2ZShcInZpc3VhbGl6YXRpb25HcmFwaFwiLCBbJyR3aW5kb3cnLCAnJHN0YXRlJywgJ1Zpc3VhbGl6ZXJHcmFwaCcsICdQb2xpY3lTZXJ2aWNlJywgJ1Zpc3VhbGl6ZXJEYXRhU291cmNlJywgJ1N0YXRlU2F2ZScsXG4gICAgICAgIGZ1bmN0aW9uKCR3aW5kb3csICRzdGF0ZSwgVmlzdWFsaXplckdyYXBoLCBQb2xpY3lTZXJ2aWNlLCBWaXN1YWxpemVyRGF0YVNvdXJjZSwgU3RhdGVTYXZlKSB7XG4gICAgICAgICAgICBmdW5jdGlvbiB2aXN1YWxpemF0aW9ubGlzdGQzKHNjb3BlLCBlbGVtLCBWaXN1YWxpemVyR3JhcGgsIFBvbGljeVNlcnZpY2UsIFZpc3VhbGl6ZXJEYXRhU291cmNlLCBTdGF0ZVNhdmUpIHtcbiAgICAgICAgICAgICAgICAvL2Rvbid0IHJ1biB1bnRpbCBhbGwgaW5pdGlhbGl6YXRpb24gY2FsbHMgaGF2ZSByZXR1cm5lZFxuICAgICAgICAgICAgICAgIGlmIChzY29wZS5ub2RlcyA9PT0gdW5kZWZpbmVkIHx8IHNjb3BlLmxpbmtzID09PSB1bmRlZmluZWQgfHwgc2NvcGUuY2hpbGRyZW5fc3RydWN0ID09PSB1bmRlZmluZWQgfHxcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuYW5jZXN0b3JzX3N0cnVjdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL2NyZWF0aW5nIERhdGFTb3VyY2VcbiAgICAgICAgICAgICAgICB2YXIgZGF0YVNvdXJjZSA9IG5ldyBWaXN1YWxpemVyRGF0YVNvdXJjZS5EYXRhU291cmNlKHNjb3BlLm5vZGVzLCBzY29wZS5saW5rcywgc2NvcGUuY2hpbGRyZW5fc3RydWN0LCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmFuY2VzdG9yc19zdHJ1Y3QsIHNjb3BlLmxhYmVscywgc2NvcGUuc2VydmljZVNlbGVjdG9ycyk7XG4gICAgICAgICAgICAgICAgZGF0YVNvdXJjZS5zZXRBbmNlc3RvcnMoKTtcblxuICAgICAgICAgICAgICAgIHZhciBub2RlcywgbGlua3M7XG5cbiAgICAgICAgICAgICAgICB2YXIgdG9wRGF0YSA9IGRhdGFTb3VyY2UuZ2V0VG9wTGV2ZWxGbG93KCk7XG4gICAgICAgICAgICAgICAgbm9kZXMgPSBkYXRhU291cmNlLnByb2Nlc3NOb2RlRGF0YSh0b3BEYXRhLm5vZGVEYXRhKTtcbiAgICAgICAgICAgICAgICBsaW5rcyA9IGRhdGFTb3VyY2UucHJvY2Vzc0xpbmtEYXRhKHRvcERhdGEubGlua0RhdGEsIG5vZGVzKTtcblxuICAgICAgICAgICAgICAgIHZhciBib2R5RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnYm9keScpWzBdO1xuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBib2R5RWwuY2xpZW50V2lkdGgsXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCA9ICBib2R5RWwuY2xpZW50SGVpZ2h0O1xuXG4gICAgICAgICAgICAgICAgLyoqIE1BSU4gU1ZHICoqL1xuICAgICAgICAgICAgICAgIHZhciByYXdTdmc9ZWxlbS5maW5kKCdzdmcnKTtcblxuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSAkKHJhd1N2Zy5wYXJlbnQoKSkub2Zmc2V0KCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgZGl2V2lkdGggPSAkKHJhd1N2Zy5wYXJlbnQoKSkud2lkdGgoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdmcgPSBkMy5zZWxlY3QocmF3U3ZnWzBdKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcIndpZHRoXCIsIGRpdldpZHRoKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcImhlaWdodFwiLCBoZWlnaHQgLSBvZmZzZXQudG9wIC0gMjApO1xuXG4gICAgICAgICAgICAgICAgLy9pbnN0YWxsaW5nIHBvbGljaWVzXG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoID0gbmV3IFZpc3VhbGl6ZXJHcmFwaC5HcmFwaChzdmcsIG5vZGVzLCBsaW5rcywgZGF0YVNvdXJjZSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuY2hpbGRyZW5fc3RydWN0LCBzY29wZS5hbmNlc3RvcnNfc3RydWN0KTtcbiAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGguaW5zdGFsbERlZmF1bHRQYXRoUG9saWN5KG5ldyBQb2xpY3lTZXJ2aWNlLlNhdmVTdGF0ZVBvbGljeShTdGF0ZVNhdmUuc2F2ZWRTdGF0ZXMpKTtcbiAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGguaW5zdGFsbERlZmF1bHRQYXRoUG9saWN5KG5ldyBQb2xpY3lTZXJ2aWNlLlBhdGhDaGFuZ2VWaWV3UG9saWN5KCRzdGF0ZSkpO1xuICAgICAgICAgICAgICAgIC8vUVRpcFBvbGljeSBpcyBmb3IgYm90aCBOb2RlcyBhbmQgUGF0aHMsIGluc3RhbGwgc2FtZSBvbmUgb24gYm90aFxuICAgICAgICAgICAgICAgIHZhciBxVGlwUG9saWN5ID0gbmV3IFBvbGljeVNlcnZpY2UuUVRpcFBvbGljeSgpO1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5pbnN0YWxsRGVmYXVsdE5vZGVQb2xpY3kocVRpcFBvbGljeSk7XG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmluc3RhbGxEZWZhdWx0UGF0aFBvbGljeShxVGlwUG9saWN5KTtcbiAgICAgICAgICAgICAgICB2YXIgc3BsaXRKb2luVmlld1BvbGljeSA9IG5ldyBQb2xpY3lTZXJ2aWNlLlNwbGl0Sm9pblZpZXdQb2xpY3koKTtcbiAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGguaW5zdGFsbERlZmF1bHROb2RlUG9saWN5KHNwbGl0Sm9pblZpZXdQb2xpY3kpO1xuICAgICAgICAgICAgICAgIHNwbGl0Sm9pblZpZXdQb2xpY3kuaW5zdGFsbEJhY2tCdXR0b24oJCgnI2JhY2tCdXR0b24nKSk7XG4gICAgICAgICAgICAgICAgc3BsaXRKb2luVmlld1BvbGljeS5pbnN0YWxsVGl0bGUoJCgnI2dyYXBoLXRpdGxlJykpO1xuXG4gICAgICAgICAgICAgICAgLy9sb2FkIG9sZCB2aWV3IGlmIGl0IGV4aXN0cy5cbiAgICAgICAgICAgICAgICBpZiAoXy5pc0VtcHR5KFN0YXRlU2F2ZS5zYXZlZFN0YXRlcykgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdyYXBoID0gc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoO1xuICAgICAgICAgICAgICAgICAgICBncmFwaC5sb2FkKFN0YXRlU2F2ZS5zYXZlZFN0YXRlcyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm57XG4gICAgICAgICAgICAgICAgcmVzdHJpY3Q6J0VBJyxcbiAgICAgICAgICAgICAgICByZXBsYWNlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Zpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbnRlbXBsYXRlLmh0bWwnLFxuICAgICAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtKXtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHsgXG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLnVuYmluZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmRlc3Ryb3koKTt9KTtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJHdhdGNoR3JvdXAoWydub2RlcycsICdsaW5rcycsICdjaGlsZHJlbl9zdHJ1Y3QnLCAnYW5jZXN0b3JzX3N0cnVjdCddLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNjb3BlLm5vZGVzICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUubGlua3MgIT0gbnVsbCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5jaGlsZHJlbl9zdHJ1Y3QgIT0gbnVsbCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5hbmNlc3RvcnNfc3RydWN0ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNjb3BlLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzdWFsaXphdGlvbmxpc3RkMyhzY29wZSwgZWxlbSwgVmlzdWFsaXplckdyYXBoLCBQb2xpY3lTZXJ2aWNlLCBWaXN1YWxpemVyRGF0YVNvdXJjZSwgU3RhdGVTYXZlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGguZGF0YVNvdXJjZS5saW5rcyA9IHNjb3BlLmxpbmtzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGgudXBkYXRlTGlua0RhdGEoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgXVxuKTtcblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52aXN1YWxpemF0aW9uJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUudmlzdWFsaXphdGlvbi5saXN0Jywge1xuICAgICAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnVmlzdWFsaXphdGlvbkxpc3RDdHJsIGFzIHZpc3VhbGl6YXRpb25MaXN0Q3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb25saXN0Lmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICA7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1Zpc3VhbGl6YXRpb25MaXN0Q3RybCcsIFtcIiRzY29wZVwiLCBcIiRodHRwXCIsICdWaXN1YWxpemF0aW9uU2VydmljZScsICckaW50ZXJ2YWwnLCBcbiAgICAgICAgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgVmlzdWFsaXphdGlvblNlcnZpY2UsICRpbnRlcnZhbCkge1xuICAgICAgICAgICAgLy90byBzZWUgdGhlIGV4cGVjdGVkIGZvcm1hdCB0byBiZSByZXR1cm5lZCBmcm9tIHRoZXNlIGNhbGxzLFxuICAgICAgICAgICAgLy9sb29rIGF0IGFwcC9jb21wb25lbnRzL2dyYXBob2JqZWN0cy9kYXRhc291cmNlL3Zpc3VhbGl6ZXJkYXRhc291cmNlLmpzXG4gICAgICAgICAgICB2YXIgc3VjY2Vzc0dyYXBoRGF0YUNhbGxiYWNrID0gZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIGxpbmtzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVJZHMgPSBbXTtcbiAgICAgICAgICAgICAgICBfLmZvckVhY2gocmVzdWx0LnJlc3VsdHNbMF0uc2VyaWVzLCBmdW5jdGlvbihzZXJpZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVuZHBvaW50ID0gc2VyaWVzLnRhZ3MuRW5kcG9pbnRJUDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb3ZpZGVyID0gc2VyaWVzLnRhZ3MuUHJvdmlkZXJJUDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGU7XG4gICAgICAgICAgICAgICAgICAgIC8vY3JlYXRpbmcgbm9kZXNcbiAgICAgICAgICAgICAgICAgICAgaWYgKF8uaW5jbHVkZXMobm9kZUlkcywgZW5kcG9pbnQpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGVuZHBvaW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBlbmRwb2ludCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3JzOiBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXMucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHMucHVzaChlbmRwb2ludCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKF8uaW5jbHVkZXMobm9kZUlkcywgcHJvdmlkZXIpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHByb3ZpZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBwcm92aWRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3JzOiBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXMucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHMucHVzaChwcm92aWRlcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy9jcmVhdGluZyBsaW5rc1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGlua091dCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogZW5kcG9pbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IHByb3ZpZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0OiBzZXJpZXMudmFsdWVzWzBdWzJdXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGxpbmtzLnB1c2gobGlua091dCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsaW5rSW4gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6IHByb3ZpZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiBlbmRwb2ludCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHdlaWdodDogc2VyaWVzLnZhbHVlc1swXVsxXVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBsaW5rcy5wdXNoKGxpbmtJbik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLm5vZGVzID0gbm9kZXM7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxpbmtzID0gbGlua3M7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLy9pbml0aWFsIGNhbGxcbiAgICAgICAgICAgIFZpc3VhbGl6YXRpb25TZXJ2aWNlLmdldEdyYXBoRGF0YSgpLnRoZW4oc3VjY2Vzc0dyYXBoRGF0YUNhbGxiYWNrLCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vd2lsbCBmYWlsIHNpbGVudGx5LCBncmFwaCB3b24ndCBiZSBkaXNwbGF5ZWRcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHsgJGludGVydmFsLmNhbmNlbCgkc2NvcGUuZ3JhcGhEYXRhSW50ZXJ2YWwpOyB9KTtcblxuICAgICAgICAgICAgVmlzdWFsaXphdGlvblNlcnZpY2UuZ2V0U3RydWN0dXJlRGF0YSgpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vdG8gc2VlIHRoZSBleHBlY3RlZCBmb3JtIG9mIGFuY2VzdG9yX3N0cnVjdCBhbmQgY2hpbGRyZW5fc3RydWN0LCBcbiAgICAgICAgICAgICAgICAvL2xvb2sgYXQgYXBwL2NvbXBvbmVudHMvZ3JhcGhvYmplY3RzL2RhdGFzb3VyY2UvdmlzdWFsaXplcmRhdGFzb3VyY2UuanNcbiAgICAgICAgICAgICAgICAkc2NvcGUuYW5jZXN0b3JzX3N0cnVjdCA9IHJlc3VsdC5hbmNlc3RvcnNfc3RydWN0O1xuICAgICAgICAgICAgICAgICRzY29wZS5jaGlsZHJlbl9zdHJ1Y3QgPSByZXN1bHQuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgICRzY29wZS5sYWJlbHMgPSByZXN1bHQubGFiZWxzO1xuICAgICAgICAgICAgICAgICRzY29wZS5zZXJ2aWNlU2VsZWN0b3JzID0gcmVzdWx0LnNlcnZpY2VTZWxlY3RvcnM7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vd2lsbCBmYWlsIHNpbGVudGx5LCBncmFwaCB3b24ndCBiZSBkaXNwbGF5ZWRcbiAgICAgICAgICAgIH0pO1xuICAgIH1dKTtcblxuXG5cblxuXG5cblxuXG5cblxuXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicpXG4gICAgLmZhY3RvcnkoJ1Zpc3VhbGl6YXRpb25TZXJ2aWNlJywgWyckaHR0cCcsICckcScsIGZ1bmN0aW9uICgkaHR0cCwgJHEpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1ha2VzIGEgZ2V0IHJlcXVlc3Qgd2l0aCB0aGUgdXJsIGFuZCBjb25maWcuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICB1cmwgICAgIFRoZSB1cmxcbiAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGNvbmZpZyAgVGhlIGNvbmZpZ3VyYXRpb25zXG4gICAgICAgICAqIEByZXR1cm4gICAgIHskSHR0cCBQcm9taXNlfSAgIFByb21pc2Ugb2YgdGhlIHJlcXVlc3RcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIG1ha2VHZXQodXJsLCBjb25maWcpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAkaHR0cC5nZXQodXJsLCBjb25maWcpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYWtlcyBhIHBvc3QgcmVxdWVzdCB3aXRoIHRoZSB1cmwgYW5kIGRhdGFcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHVybCAgICAgVGhlIHVybFxuICAgICAgICAgKiBAcGFyYW0gICAgICB7SlNPTn0gICAgZGF0YSAgICBUaGUgZGF0YVxuICAgICAgICAgKiBAcmV0dXJuICAgICB7JEh0dHAgUHJvbWlzZX0gICBQcm9taXNlIG9mIHRoZSByZXF1ZXN0XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBtYWtlUG9zdCh1cmwsIGRhdGEpIHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogY29udmVydHMgdGhlIGRhdGEgaW50byB4LXd3dy1mcm9tLXVybGVuY29kZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7SlNPTn0gIG9iaiAgICAgSlNPTiBkYXRhIG9iamVjdFxuICAgICAgICAgICAgICogQHJldHVybiAgICAge3N0cmluZ30gIHgtd3d3LWZvcm0tdXJsZW5jb2RlZCBzdHJpbmdcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdmFyIHBhcmFtID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gJycsIG5hbWUsIHZhbHVlLCBmdWxsU3ViTmFtZSwgc3ViTmFtZSwgc3ViVmFsdWUsIGlubmVyT2JqLCBpO1xuICAgICAgICAgICAgICAgIGZvciAobmFtZSBpbiBvYmopIHtcbiAgICAgICAgICAgICAgICAgIHZhbHVlID0gb2JqW25hbWVdO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGk9MDsgaTx2YWx1ZS5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlZhbHVlID0gdmFsdWVbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVsbFN1Yk5hbWUgPSBuYW1lICsgJ1snICsgaSArICddJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbm5lck9iaiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlubmVyT2JqW2Z1bGxTdWJOYW1lXSA9IHN1YlZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ICs9IHBhcmFtKGlubmVyT2JqKSArICcmJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIE9iamVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChzdWJOYW1lIGluIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViVmFsdWUgPSB2YWx1ZVtzdWJOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdWxsU3ViTmFtZSA9IG5hbWUgKyAnWycgKyBzdWJOYW1lICsgJ10nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlubmVyT2JqID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5uZXJPYmpbZnVsbFN1Yk5hbWVdID0gc3ViVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkgKz0gcGFyYW0oaW5uZXJPYmopICsgJyYnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYodmFsdWUgIT09IHVuZGVmaW5lZCAmJiB2YWx1ZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkgKz0gZW5jb2RlVVJJQ29tcG9uZW50KG5hbWUpICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKSArICcmJztcbiAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHF1ZXJ5Lmxlbmd0aCA/IHF1ZXJ5LnN1YnN0cigwLCBxdWVyeS5sZW5ndGggLSAxKSA6IHF1ZXJ5O1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICB1cmw6dXJsLFxuICAgICAgICAgICAgICAgIG1ldGhvZDonUE9TVCcsXG4gICAgICAgICAgICAgICAgZGF0YTogZGF0YSxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCdcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHRyYW5zZm9ybVJlcXVlc3Q6IFtmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhbmd1bGFyLmlzT2JqZWN0KGRhdGEpICYmIFN0cmluZyhkYXRhKSAhPT0gJ1tvYmplY3QgRmlsZV0nID8gcGFyYW0oZGF0YSkgOiBkYXRhO1xuICAgICAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0R3JhcGhEYXRhKCkge1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuVklTVUFMSVpBVElPTl9FTkRQT0lOVDtcbiAgICAgICAgICAgIHVybCArPSAnaW5mbHV4L3F1ZXJ5JztcbiAgICAgICAgICAgIHZhciBjb25maWcgPSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgICAgICAgICAgIGRiOlwidGVsZWdyYWZcIixcbiAgICAgICAgICAgICAgICAgICAgcTpcIlNFTEVDVCBCeXRlc0luLCBCeXRlc091dCwgRW5kcG9pbnRJUCwgUHJvdmlkZXJJUCBGUk9NIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDFtIEdST1VQIEJZICogTElNSVQgMVwiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBtYWtlR2V0KHVybCwgY29uZmlnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldFN0cnVjdHVyZURhdGEoKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WSVNVQUxJWkFUSU9OX0VORFBPSU5UO1xuICAgICAgICAgICAgdXJsICs9ICdzZXJ2aWNlcyc7XG4gICAgICAgICAgICByZXR1cm4gbWFrZUdldCh1cmwpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gYnVpbGRXaGVyZVF1ZXJ5KHBvaW50cywgdHlwZSkge1xuICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gXCIoXCI7XG4gICAgICAgICAgICBxdWVyeSArPSB0eXBlICsgXCI9XCI7XG4gICAgICAgICAgICBxdWVyeSArPSBcIidcIiArIHBvaW50c1swXSArIFwiJyBcIjtcbiAgICAgICAgICAgIC8vc3RhcnRzIGF0IDEsIHNvIHdpbGwgbm90IHJ1biBpZiBsZW5ndGggaXMgMVxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBwb2ludHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBxdWVyeSArPSAnT1IgJztcbiAgICAgICAgICAgICAgICBxdWVyeSArPSB0eXBlICsgXCI9XCI7XG4gICAgICAgICAgICAgICAgcXVlcnkgKz0gXCInXCIgKyBwb2ludHNbaV0gKyBcIicgXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBxdWVyeSArPSBcIilcIjtcbiAgICAgICAgICAgIHJldHVybiBxdWVyeTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldEVkZ2VEYXRhKHNvdXJjZUxpc3QsIHRhcmdldExpc3QsIHRpbWUpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLlZJU1VBTElaQVRJT05fRU5EUE9JTlQ7XG4gICAgICAgICAgICB1cmwgKz0gJ2luZmx1eC9xdWVyeSc7XG5cbiAgICAgICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICBkYiA6IFwidGVsZWdyYWZcIixcbiAgICAgICAgICAgICAgICAgICAgcTogXCJTRUxFQ1Qgc3VtKFwiICsgJ0J5dGVzT3V0JyArIFwiKSBmcm9tIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDE1cyBBTkQgXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeShzb3VyY2VMaXN0LCBcIkVuZHBvaW50SVBcIikgK1wiIEFORCBcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeSh0YXJnZXRMaXN0LCAnUHJvdmlkZXJJUCcpIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgXCJHUk9VUCBCWSB0aW1lKDIwcykgTElNSVQgMTsgU0VMRUNUIHN1bShcIiArICdCeXRlc0luJyArIFwiKSBmcm9tIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDE1cyBBTkQgXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeShzb3VyY2VMaXN0LCAnUHJvdmlkZXJJUCcpICtcIiBBTkQgXCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkodGFyZ2V0TGlzdCwgJ0VuZHBvaW50SVAnKSBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIFwiR1JPVVAgQlkgdGltZSgyMHMpIGZpbGwoMCkgTElNSVQgMVwiXG4gICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIG1ha2VQb3N0KHVybCwgZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICBcblxuICAgICAgICBmdW5jdGlvbiBnZXRPbGRFZGdlRGF0YShzb3VyY2VMaXN0LCB0YXJnZXRMaXN0KSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WSVNVQUxJWkFUSU9OX0VORFBPSU5UO1xuICAgICAgICAgICAgdXJsICs9ICdpbmZsdXgvcXVlcnknO1xuICAgICAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgICAgIGRiIDogXCJ0ZWxlZ3JhZlwiLFxuICAgICAgICAgICAgICAgICAgICBxOiBcIlNFTEVDVCBzdW0oXCIgKyAnQnl0ZXNPdXQnICsgXCIpIEZST00gaHR0cGpzb25fc3Zjc3RhdHMgV0hFUkUgdGltZSA+IG5vdygpIC0gMW0gQU5EIFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkoc291cmNlTGlzdCwgXCJFbmRwb2ludElQXCIpICtcIiBBTkQgXCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkodGFyZ2V0TGlzdCwgXCJQcm92aWRlcklQXCIpIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgXCIgR1JPVVAgQlkgdGltZSgxMHMpIGZpbGwoMCkgTElNSVQgNjsgU0VMRUNUIHN1bShcIiArICdCeXRlc0luJyArIFwiKSBGUk9NIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDFtIEFORCBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHNvdXJjZUxpc3QsIFwiUHJvdmlkZXJJUFwiKSArXCIgQU5EIFwiIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHRhcmdldExpc3QsIFwiRW5kcG9pbnRJUFwiKSBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIFwiIEdST1VQIEJZIHRpbWUoMTBzKSBmaWxsKDApIExJTUlUIDZcIlxuICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBtYWtlUG9zdCh1cmwsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldEdyYXBoRGF0YTogZ2V0R3JhcGhEYXRhLFxuICAgICAgICAgICAgZ2V0U3RydWN0dXJlRGF0YTogZ2V0U3RydWN0dXJlRGF0YSxcbiAgICAgICAgICAgIGdldEVkZ2VEYXRhOiBnZXRFZGdlRGF0YSxcbiAgICAgICAgICAgIGdldE9sZEVkZ2VEYXRhOiBnZXRPbGRFZGdlRGF0YVxuICAgICAgICB9XG4gICAgfV0pO1xuXG5cblxuXG5cblxuXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDYvMy8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52b2x1bWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUudm9sdW1lcy5jcmVhdGUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndm9sdW1lcy92b2x1bWVjcmVhdGUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVm9sdW1lQ3JlYXRlQ3RybCBhcyB2b2x1bWVDcmVhdGVDdHJsJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignVm9sdW1lQ3JlYXRlQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdWb2x1bWVzTW9kZWwnLCAnU3RvcmFnZVBvbGljaWVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgVm9sdW1lc01vZGVsLCBTdG9yYWdlUG9saWNpZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHZvbHVtZUNyZWF0ZUN0cmwgPSB0aGlzO1xuICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLmZpbGVzeXN0ZW1zID0gWydleHQ0JywgJ2J0cmZzJ107XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvVm9sdW1lc01vZGVsKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS52b2x1bWVzLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxDcmVhdGluZygpIHtcbiAgICAgICAgICAgIHJldHVyblRvVm9sdW1lc01vZGVsKCk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdldCBzdG9yYWdlIHBvbGljaWVzLlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gZ2V0U3RvcmFnZVBvbGljaWVzKCkge1xuICAgICAgICAgICAgU3RvcmFnZVBvbGljaWVzTW9kZWwuZ2V0KCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5wb2xpY2llcyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGFwcGx5UG9saWN5U2V0dGluZ3MoKSB7XG4gICAgICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLm5ld1ZvbHVtZS5wb2xpY3kgPSB2b2x1bWVDcmVhdGVDdHJsLnNlbGVjdGVkUG9saWN5Lm5hbWU7XG4gICAgICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLm5ld1ZvbHVtZS5iYWNrZW5kcyA9IHZvbHVtZUNyZWF0ZUN0cmwuc2VsZWN0ZWRQb2xpY3kuYmFja2VuZHM7XG4gICAgICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLm5ld1ZvbHVtZS5kcml2ZXIgPSB2b2x1bWVDcmVhdGVDdHJsLnNlbGVjdGVkUG9saWN5LmRyaXZlcjtcbiAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwubmV3Vm9sdW1lLmNyZWF0ZSA9IHZvbHVtZUNyZWF0ZUN0cmwuc2VsZWN0ZWRQb2xpY3kuY3JlYXRlO1xuICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUucnVudGltZSA9IHZvbHVtZUNyZWF0ZUN0cmwuc2VsZWN0ZWRQb2xpY3kucnVudGltZTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVWb2x1bWUoKSB7XG4gICAgICAgICAgICAvL2Zvcm0gY29udHJvbGxlciBpcyBpbmplY3RlZCBieSB0aGUgaHRtbCB0ZW1wbGF0ZVxuICAgICAgICAgICAgLy9jaGVja2luZyBpZiBhbGwgdmFsaWRhdGlvbnMgaGF2ZSBwYXNzZWRcbiAgICAgICAgICAgIGlmICh2b2x1bWVDcmVhdGVDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHZvbHVtZUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKHZvbHVtZUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIGFwcGx5UG9saWN5U2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICBWb2x1bWVzTW9kZWwuY3JlYXRlKHZvbHVtZUNyZWF0ZUN0cmwubmV3Vm9sdW1lKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9Wb2x1bWVzTW9kZWwoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Iodm9sdW1lQ3JlYXRlQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXNldEZvcm0oKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHZvbHVtZUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUgPSB7XG4gICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgXCJiYWNrZW5kc1wiOiB7fSxcbiAgICAgICAgICAgICAgICBcImRyaXZlclwiOiB7fSxcbiAgICAgICAgICAgICAgICBcImNyZWF0ZVwiOiB7fSxcbiAgICAgICAgICAgICAgICBcInJ1bnRpbWVcIjoge31cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5jcmVhdGVWb2x1bWUgPSBjcmVhdGVWb2x1bWU7XG4gICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwuY2FuY2VsQ3JlYXRpbmcgPSBjYW5jZWxDcmVhdGluZztcbiAgICAgICAgZ2V0U3RvcmFnZVBvbGljaWVzKCk7XG4gICAgICAgIHJlc2V0Rm9ybSgpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXZvbHVtZWNyZWF0ZWN0cmwuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDQvMTUvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudm9sdW1lcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZvbHVtZXMuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1ZvbHVtZURldGFpbHNDdHJsIGFzIHZvbHVtZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndm9sdW1lcy92b2x1bWVkZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdWb2x1bWVEZXRhaWxzQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICckc2NvcGUnLCAnJGludGVydmFsJywgJyRodHRwJywgJ1ZvbHVtZXNNb2RlbCcsICdWb2x1bWVTZXJ2aWNlJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRzY29wZSwgJGludGVydmFsLCAkaHR0cCwgVm9sdW1lc01vZGVsLCBWb2x1bWVTZXJ2aWNlLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgdm9sdW1lRGV0YWlsc0N0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1ZvbHVtZXMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZvbHVtZXMubGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGRlbGV0ZVZvbHVtZSgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcih2b2x1bWVEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcih2b2x1bWVEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBWb2x1bWVzTW9kZWwuZGVsZXRlKHZvbHVtZURldGFpbHNDdHJsLnZvbHVtZSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9Wb2x1bWVzKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnZXRWb2x1bWVJbmZvKHJlbG9hZCkge1xuICAgICAgICAgICAgdmFyIHRva2VucyA9ICRzdGF0ZVBhcmFtcy5rZXkuc3BsaXQoJy8nKTtcbiAgICAgICAgICAgIHZhciBtb2RlbCA9IHt9O1xuICAgICAgICAgICAgbW9kZWwucG9saWN5ID0gdG9rZW5zWzBdO1xuICAgICAgICAgICAgbW9kZWwubmFtZSA9IHRva2Vuc1sxXTtcbiAgICAgICAgICAgIFZvbHVtZXNNb2RlbC5nZXRNb2RlbChtb2RlbCwgcmVsb2FkKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICh2b2x1bWUpIHtcbiAgICAgICAgICAgICAgICB2b2x1bWVEZXRhaWxzQ3RybC52b2x1bWUgPSB2b2x1bWU7XG4gICAgICAgICAgICAgICAgZ2V0Vm9sdW1lVXNlSW5mbygpO1xuICAgICAgICAgICAgICAgIGdldFZvbHVtZVNuYXBzaG90cygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0Vm9sdW1lVXNlSW5mbygpIHtcbiAgICAgICAgICAgIFZvbHVtZVNlcnZpY2UuZ2V0Vm9sdW1lVXNlSW5mbyh2b2x1bWVEZXRhaWxzQ3RybC52b2x1bWUpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHZvbHVtZURldGFpbHNDdHJsLnZvbHVtZVVzZSA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy9SZXR1cm5zIGVycm9yIGlmIHZvbHVtZSBpcyBub3QgbW91bnRlZCBieSBhbnkgY29udGFpbmVyXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnZXRWb2x1bWVTbmFwc2hvdHMoKSB7XG4gICAgICAgICAgICBWb2x1bWVTZXJ2aWNlLmdldFZvbHVtZVNuYXBzaG90cyh2b2x1bWVEZXRhaWxzQ3RybC52b2x1bWUpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHZvbHVtZURldGFpbHNDdHJsLnNuYXBzaG90cyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiB0cmlnZ2VyVm9sdW1lU25hcHNob3QoKSB7XG4gICAgICAgICAgICB2b2x1bWVEZXRhaWxzQ3RybC5zbmFwc2hvdFN1Y2Nlc3MgPSBmYWxzZTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcih2b2x1bWVEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcih2b2x1bWVEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBWb2x1bWVTZXJ2aWNlLnRyaWdnZXJTbmFwc2hvdCh2b2x1bWVEZXRhaWxzQ3RybC52b2x1bWUpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIHZvbHVtZURldGFpbHNDdHJsLnNuYXBzaG90U3VjY2VzcyA9IHRydWU7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcih2b2x1bWVEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHZvbHVtZURldGFpbHNDdHJsLmRlbGV0ZVZvbHVtZSA9IGRlbGV0ZVZvbHVtZTtcbiAgICAgICAgdm9sdW1lRGV0YWlsc0N0cmwudHJpZ2dlclZvbHVtZVNuYXBzaG90ID0gdHJpZ2dlclZvbHVtZVNuYXBzaG90O1xuICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgZ2V0Vm9sdW1lSW5mbyhmYWxzZSk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG8tcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXRWb2x1bWVJbmZvKHRydWUpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dm9sdW1lZGV0YWlsc2N0cmwuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMjIvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudm9sdW1lcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZvbHVtZXMubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWb2x1bWVMaXN0Q3RybCBhcyB2b2x1bWVMaXN0Q3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZvbHVtZXMvdm9sdW1lbGlzdC5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignVm9sdW1lTGlzdEN0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdWb2x1bWVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgVm9sdW1lc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgdm9sdW1lTGlzdEN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBnZXRWb2x1bWVzKHJlbG9hZCkge1xuICAgICAgICAgICAgVm9sdW1lc01vZGVsLmdldChyZWxvYWQpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgIHZvbHVtZUxpc3RDdHJsLnZvbHVtZXMgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lTGlzdEN0cmwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgIGdldFZvbHVtZXMoZmFsc2UpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0Vm9sdW1lcyh0cnVlKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXZvbHVtZWxpc3RjdHJsLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA2LzUvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudm9sdW1lcycpXG4gICAgLmZhY3RvcnkoJ1ZvbHVtZVNlcnZpY2UnLCBbJyRodHRwJywgJyRxJywgZnVuY3Rpb24gKCRodHRwLCAkcSkge1xuICAgICAgICBmdW5jdGlvbiBnZXRWb2x1bWVVc2VJbmZvKHZvbHVtZSkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLlZPTFVNRVNfVVNFU19FTkRQT0lOVFxuICAgICAgICAgICAgICAgICsgdm9sdW1lLnBvbGljeVxuICAgICAgICAgICAgICAgICsgJy8nICsgdm9sdW1lLm5hbWU7XG4gICAgICAgICAgICAkaHR0cC5nZXQodXJsKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy9SZXR1cm5zIGVycm9yIGlmIHZvbHVtZSBpcyBub3QgbW91bnRlZCBieSBhbnkgY29udGFpbmVyXG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0Vm9sdW1lU25hcHNob3RzKHZvbHVtZSkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLlZPTFVNRVNfU05BUFNIT1RTX0VORFBPSU5UXG4gICAgICAgICAgICAgICAgKyB2b2x1bWUucG9saWN5XG4gICAgICAgICAgICAgICAgKyAnLycgKyB2b2x1bWUubmFtZTtcbiAgICAgICAgICAgICRodHRwLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiB0cmlnZ2VyU25hcHNob3Qodm9sdW1lKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuVk9MVU1FU19TTkFQU0hPVFNfRU5EUE9JTlQgKyBcInRha2UvXCJcbiAgICAgICAgICAgICAgICArIHZvbHVtZS5wb2xpY3lcbiAgICAgICAgICAgICAgICArICcvJyArIHZvbHVtZS5uYW1lO1xuICAgICAgICAgICAgJGh0dHAucG9zdCh1cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0Vm9sdW1lVXNlSW5mbzogZ2V0Vm9sdW1lVXNlSW5mbyxcbiAgICAgICAgICAgIGdldFZvbHVtZVNuYXBzaG90czogZ2V0Vm9sdW1lU25hcHNob3RzLFxuICAgICAgICAgICAgdHJpZ2dlclNuYXBzaG90OiB0cmlnZ2VyU25hcHNob3RcbiAgICAgICAgfTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD12b2x1bWVzZXJ2aWNlLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IGNzaGFtcHVyIG9uIDgvOS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52b2x1bWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUudm9sdW1lcy5jb3B5Jywge1xuICAgICAgICAgICAgdXJsOiAnL2NvcHkvJyxcbiAgICAgICAgICAgIHBhcmFtczogeyBzbmFwc2hvdDogbnVsbCwgcG9saWN5OiBudWxsLCB2b2x1bWU6IG51bGwgfSxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWb2x1bWVTbmFwc2hvdENvcHlDdHJsIGFzIHZvbHVtZVNuYXBzaG90Q29weUN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2b2x1bWVzL3ZvbHVtZXNuYXBzaG90Y29weS5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignVm9sdW1lU25hcHNob3RDb3B5Q3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICckc2NvcGUnLCAnJGludGVydmFsJywgJyRodHRwJywgJ1ZvbHVtZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCAkc2NvcGUsICRpbnRlcnZhbCwgJGh0dHAsIFZvbHVtZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHZvbHVtZVNuYXBzaG90Q29weUN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBjYW5jZWxDb3B5KCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS52b2x1bWVzLmRldGFpbHMnLCB7IGtleTogJHN0YXRlUGFyYW1zLnBvbGljeSArICcvJyArICRzdGF0ZVBhcmFtcy52b2x1bWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ29Ub05ld1ZvbHVtZSgpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUudm9sdW1lcy5kZXRhaWxzJywgeyBrZXk6ICRzdGF0ZVBhcmFtcy5wb2xpY3kgKyAnLycgKyB2b2x1bWVTbmFwc2hvdENvcHlDdHJsLm5ld3ZvbHVtZSB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjb3B5U25hcHNob3QoKSB7XG4gICAgICAgICAgICBpZiAodm9sdW1lU25hcHNob3RDb3B5Q3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcih2b2x1bWVTbmFwc2hvdENvcHlDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcih2b2x1bWVTbmFwc2hvdENvcHlDdHJsKTtcbiAgICAgICAgICAgICAgICB2YXIgbW9kZWwgPSB7fTtcbiAgICAgICAgICAgICAgICBtb2RlbC5wb2xpY3kgPSAkc3RhdGVQYXJhbXMucG9saWN5O1xuICAgICAgICAgICAgICAgIG1vZGVsLm5hbWUgPSAkc3RhdGVQYXJhbXMudm9sdW1lO1xuICAgICAgICAgICAgICAgIFZvbHVtZXNNb2RlbC5jb3B5KG1vZGVsLCAkc3RhdGVQYXJhbXMuc25hcHNob3QsIHZvbHVtZVNuYXBzaG90Q29weUN0cmwubmV3dm9sdW1lKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lU25hcHNob3RDb3B5Q3RybCk7XG4gICAgICAgICAgICAgICAgICAgIGdvVG9OZXdWb2x1bWUoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZVNuYXBzaG90Q29weUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Iodm9sdW1lU25hcHNob3RDb3B5Q3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2b2x1bWVTbmFwc2hvdENvcHlDdHJsLnBvbGljeSA9ICRzdGF0ZVBhcmFtcy5wb2xpY3k7XG4gICAgICAgIHZvbHVtZVNuYXBzaG90Q29weUN0cmwudm9sdW1lID0gJHN0YXRlUGFyYW1zLnZvbHVtZTtcbiAgICAgICAgdm9sdW1lU25hcHNob3RDb3B5Q3RybC5zbmFwc2hvdCA9ICRzdGF0ZVBhcmFtcy5zbmFwc2hvdDtcbiAgICAgICAgdm9sdW1lU25hcHNob3RDb3B5Q3RybC5jb3B5U25hcHNob3QgPSBjb3B5U25hcHNob3Q7XG4gICAgICAgIHZvbHVtZVNuYXBzaG90Q29weUN0cmwuY2FuY2VsQ29weSA9IGNhbmNlbENvcHk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dm9sdW1lc25hcHNob3Rjb3B5Y3RybC5qcy5tYXBcbi8qKlxuICogQ3JlYXRlZCBieSBjc2hhbXB1ciBvbiA3LzEvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2QWNjb3JkaW9uXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgaXRlbXM6ICc9JyxcbiAgICAgICAgfSxcbiAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50KSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGVsZW1lbnQuZmluZCgnLnVpLmFjY29yZGlvbicpLmFjY29yZGlvbiA9PSAnZnVuY3Rpb24nKVxuICAgICAgICAgICAgICAgIGVsZW1lbnQuZmluZCgnLnVpLmFjY29yZGlvbicpLmFjY29yZGlvbigpO1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy9hY2NvcmRpb24uaHRtbCdcbiAgICB9O1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hY2NvcmRpb25kaXJlY3RpdmUuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDYvMi8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZDb2xsYXBzaWJsZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIHRpdGxlOiAnQCcsXG4gICAgICAgICAgICBjb2xsYXBzZWQ6ICdAJ1xuICAgICAgICB9LFxuICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUpIHtcbiAgICAgICAgICAgIGlmIChzY29wZS5jb2xsYXBzZWQgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICBzY29wZS5jb2xsYXBzZWQgPSB0cnVlO1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy9jb2xsYXBzaWJsZS5odG1sJ1xuICAgIH07XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNvbGxhcHNpYmxlZGlyZWN0aXZlLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzExLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5kaXJlY3RpdmVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dk5hbWV2YWx1ZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIGl0ZW1zOiAnPScsXG4gICAgICAgICAgICBuYW1laGVhZGVyOiAnQCcsXG4gICAgICAgICAgICB2YWx1ZWhlYWRlcjogJ0AnLFxuICAgICAgICAgICAgdHlwZTogJ0AnLFxuICAgICAgICAgICAgb3B0aW9uczogJz0nIC8vVG8gYmUgdXNlZCB3aGVuIHR5cGUgaXMgJ3NlbGVjdCdcbiAgICAgICAgfSxcbiAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlKSB7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENvbXBhcmUgaWYgdHdvIGl0ZW1zIGhhdmUgc2FtZSBuYW1lXG4gICAgICAgICAgICAgKiBAcGFyYW0gdmFsMVxuICAgICAgICAgICAgICogQHBhcmFtIHZhbDJcbiAgICAgICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmdW5jdGlvbiBjb21wYXJlKHZhbDEsIHZhbDIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsMS5uYW1lID09IHZhbDIubmFtZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlc2V0TmV3SXRlbSgpIHtcbiAgICAgICAgICAgICAgICBzY29wZS5uZXdJdGVtID0ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6ICcnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZ1bmN0aW9uIGlzRW1wdHlJdGVtKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKGl0ZW0ubmFtZSA9PT0gJycgJiYgaXRlbS52YWx1ZSA9PT0gJycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2NvcGUuYWRkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChpc0VtcHR5SXRlbShzY29wZS5uZXdJdGVtKSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGlmIChzY29wZS5pdGVtID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuaXRlbSA9IFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL1JlbW92ZXMgZXhpc3RpbmcgaXRlbSB3aXRoIHRoZSBzYW1lIG5hbWUgZmlyc3QgaWYgaXQgZXhpc3RzLlxuICAgICAgICAgICAgICAgIF8ucHVsbEFsbFdpdGgoc2NvcGUuaXRlbXMsIFtzY29wZS5uZXdJdGVtXSwgY29tcGFyZSk7XG4gICAgICAgICAgICAgICAgc2NvcGUuaXRlbXMucHVzaChzY29wZS5uZXdJdGVtKTtcbiAgICAgICAgICAgICAgICByZXNldE5ld0l0ZW0oKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBzY29wZS5yZW1vdmUgPSBmdW5jdGlvbiAocGFzc2VkSXRlbSkge1xuICAgICAgICAgICAgICAgIF8ucmVtb3ZlKHNjb3BlLml0ZW1zLCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5uYW1lID09IHBhc3NlZEl0ZW0ubmFtZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXNldE5ld0l0ZW0oKTtcbiAgICAgICAgICAgIGlmIChzY29wZS5uYW1laGVhZGVyID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgc2NvcGUubmFtZWhlYWRlciA9ICdOYW1lJztcbiAgICAgICAgICAgIGlmIChzY29wZS52YWx1ZWhlYWRlciA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgIHNjb3BlLnZhbHVlaGVhZGVyID0gJ1ZhbHVlJztcbiAgICAgICAgICAgIGlmIChzY29wZS50eXBlID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgc2NvcGUudHlwZSA9ICd0ZXh0JztcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvbmFtZXZhbHVlLmh0bWwnXG4gICAgfTtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bmFtZXZhbHVlZGlyZWN0aXZlLmpzLm1hcFxuLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzQvMTYuXG4gKi9cbi8qXG5EaXJlY3RpdmUgVXNhZ2UgOlxuXG5hKSBjdHZUYWJsZSAtXG4gICB1c2FnZSA6IDxjdHYtdGFibGUgZGVmYXVsdHNvcnRjb2x1bW49J25hbWUnIGl0ZW1zPSd0YWJsZUl0ZW1zJyBmaWx0ZXJlZGl0ZW1zPSdmaWx0SXRlbXMnIHNpemU9J3NpemUnPjwvY3R2LXRhYmxlPlxuICAgYXR0cmlidXRlIGRldGFpbHMgOiAgZGVmYXVsdHNvcnRjb2x1bW4gLSBUaGUgZGVmYXVsdCBjb2x1bW4gbmFtZShjb3JyZXNwb25kaW5nIGtleSBpbnNpZGUgdGhlIG9iamVjdCBvZiBpdGVtcyBhcnJheSkgb24gd2hpY2ggdGhlIHRhYmxlIHdpbGwgYmUgc29ydGVkIHdoZW4gaXQgaXMgbG9hZGVkLlxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXMgLSBBbiBhcnJheSBvZiBvYmplY3RzIHdoaWNoIHdpbGwgYmUgZGlzcGxheWVkIGJ5IHRoZSBjdHYtdGFibGUgZGlyZWN0aXZlLlxuICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZSAtIG51bWJlciBvZiByb3dzIHRvIGJlIGRpc3BsYXllZCBpbnNpZGUgdGhlIHRhYmxlLiBJZiBpdGVtcy5sZW5ndGggPiBzaXplIHRoZW4gcmVtYWluaW5nIGl0ZW1zXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lsbCBiZSBkaXNwbGF5ZWQgaW4gbmV4dCBwYWdlLlxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyZWRpdGVtcyAtIFRoaXMgaXMgYW4gb3V0cHV0IGZpZWxkIHdoaWNoIHByb2R1Y2VzIGEgZmlsdGVyZWQgc3Vic2V0IG9mIGl0ZW1zIHNwZWNlZmllZCBieVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZSBwcmV2aW91cyBhdHRyaWJ1dGUsIEl0ZW1zIGFyZSBmaWx0ZXJlZCBiYXNlZCBvbiBzZWFyY2ggdGV4dCBkZWZpbmVkIGluc2lkZSBjdHYtc2VhcmNoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZCBieSB0aGUgc2l6ZSBtZW50aW9uZWQgaW4gdGhlIGN0di10YWJsZSBhdHRyaWJ1dGVcbmIpIGN0dlRIIC1cbiAgIHVzYWdlIDogPGN0di10aCBzb3J0ZmllbGQ9J25hbWUnPm5hbWU8L2N0di10aD5cbiAgIGF0dHJpYnV0ZSBkZXRhaWxzIDogc29ydGZpZWxkIC0gVGhpcyBpcyB0aGUga2V5IG9mIHRoZSBvYmplY3QgcHJlc2VudCBpbnNpZGUgaXRlbXMgYXJyYXkgc3BlY2VmaWVkIGluIGN0dlRhYmxlLCBmb3IgZWcgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0aGUgYXJyYXkgb2JqZWN0IGlzIDogW3tpcDogXCIyMC4xLjIuM1wiLCBob3N0OiBcImNsdXN0ZXItMVwifSx7aXA6IFwiMjAuMS4yLjRcIiwgaG9zdDogXCJjbHVzdGVyLTJcIn1dXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZW4gZGlyZWN0aXZlIHdpbGwgYmUgPGN0di10aCBzb3J0ZmllbGQ9XCInaXAnXCI+IElwIEFkZHJlc3MgPC9jdHYtdGg+XG4gICBUYWJsZSBjYW4gb25seSBiZSBzb3J0ZWQgb24gY29sdW1ucyB3aGljaCBoYXMgc29ydGZpZWxkIGF0dHJpYnV0ZSBzcGVjZWZpZWQuXG5cbmMpIGN0dlRzZWFyY2ggLVxuICAgdXNhZ2UgOiA8Y3R2LXRzZWFyY2ggcGxhY2Vob2xkZXI9J1NlYXJjaCcgc2l6ZT0nMzAnPjwvY3R2LXRzZWFyY2g+XG4gICBhdHRyaWJ1dGUgZGV0YWlscyA6IHBsYWNlaG9sZGVyIC0gc3BlY2lmeSB0aGUgcGxhY2Vob2xkZXIgZm9yIHRoZSBpbnB1dCB0ZXh0IGZpZWxkXG4gICAgICAgICAgICAgICAgICAgICAgIHNpemUgLSBzcGVjaWZ5IHRoZSBtYXhpbXVtIGxlbmd0aCBvZiB0aGUgc2VhcmNoIHN0cmluZ1xuICAgT25seSBpdGVtcyBtYXRjaGluZyB0aGUgc2VhcmNoIHN0cmluZyBhcmUgZGlzcGxheWVkIGluc2lkZSB0aGUgdGFibGUuXG5cbmQpIGN0dlRwYWdpbmF0aW9uIC1cbiAgIHVzYWdlIDogPGN0di10cGFnaW5hdGlvbj48L2N0di10cGFnaW5hdGlvbj5cbiAgIFByb3ZpZGVzIGxpbmsgZm9yIG1vdmluZyBiYWNrIGFuZCBmb3J0aCBvZiB0aGUgcmVzdWx0IHBhZ2UuXG5cbiAqL1xuYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZUYWJsZVwiLCBbJ2ZpbHRlckZpbHRlcicsICdsaW1pdFRvRmlsdGVyJywgZnVuY3Rpb24gKGZpbHRlckZpbHRlciwgbGltaXRUb0ZpbHRlcikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIGl0ZW1zOiAnPScsXG4gICAgICAgICAgICAgICAgZmlsdGVyZWRpdGVtczogJz0nLFxuICAgICAgICAgICAgICAgIHNpemU6ICdAJyxcbiAgICAgICAgICAgICAgICBkZWZhdWx0c29ydGNvbHVtbjogJ0AnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY29udHJvbGxlcjogWyckc2NvcGUnLCAnJGVsZW1lbnQnLCAnJGF0dHJzJywgJyRmaWx0ZXInLCBmdW5jdGlvbiAoJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCAkZmlsdGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0YWJsZUN0cmwgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuY2h1bmtzID0gW107XG4gICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5wYWdlTm8gPSAwO1xuICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc29ydE9iaiA9IGluaXRpYWxpemVTb3J0KCRzY29wZS5kZWZhdWx0c29ydGNvbHVtbik7XG4gICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zaXplID0gcGFyc2VJbnQoJHNjb3BlLnNpemUsIDEwKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzTmFOKHRhYmxlQ3RybC5zaXplKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNpemUgPSAxMjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICogQWx3YXlzIGNhbGwgc2hvd0NodW5rIHdpdGggYm90aCBwYXJhbWV0ZXJzLlxuICAgICAgICAgICAgICAgICAgICAgKiBAcGFyYW0gcGFnZU5vXG4gICAgICAgICAgICAgICAgICAgICAqIEBwYXJhbSBzZWFyY2hUZXh0XG4gICAgICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gc2hvd0NodW5rKHBhZ2VObywgc2VhcmNoVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNlYXJjaFRleHQgPSBzZWFyY2hUZXh0O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhZ2VObyA9PT0gdW5kZWZpbmVkIHx8IHBhZ2VObyA8IDApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZU5vID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5wYWdlTm8gPSBwYWdlTm87XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLml0ZW1zICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VhcmNoVGV4dEZpbHRlcmVkSXRlbXMgPSBmaWx0ZXJGaWx0ZXIoJHNjb3BlLml0ZW1zLCB0YWJsZUN0cmwuc2VhcmNoVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoVGV4dEZpbHRlcmVkSXRlbXMgPSAkZmlsdGVyKCdvcmRlckJ5Jykoc2VhcmNoVGV4dEZpbHRlcmVkSXRlbXMsIHRhYmxlQ3RybC5zb3J0T2JqLmZpZWxkLCB0YWJsZUN0cmwuc29ydE9iai5yZXZlcnNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbm9PZkNodW5rcyA9IE1hdGguY2VpbChzZWFyY2hUZXh0RmlsdGVyZWRJdGVtcy5sZW5ndGggLyB0YWJsZUN0cmwuc2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vT2ZDaHVua3MgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub09mQ2h1bmtzID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLmNodW5rcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9PZkNodW5rczsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5jaHVua3MucHVzaCh7IHNlbGVjdGVkOiBmYWxzZSwgcGFnZU5vOiBpIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0FmdGVyIGZpbHRlcmluZyBudW1iZXIgb2YgY2h1bmtzIGNvdWxkIGNoYW5nZSBzbyByZXNldCBwYWdlIG5vIGlmIGl0IGlzIGdyZWF0ZXIgdGhhbiBubyBvZiBjaHVua3NcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFnZU5vID49IHRhYmxlQ3RybC5jaHVua3MubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5wYWdlTm8gPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuY2h1bmtzW3RhYmxlQ3RybC5wYWdlTm9dLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1VwZGF0ZSBudW1iZXIgb2YgY2h1bmtzIGZvciBwYWdpbmF0aW9uIG1lbnVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFibGVDdHJsLmNodW5rcy5sZW5ndGggPiA1KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzbGljZVN0YXJ0LCBzbGljZUVuZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xpY2VTdGFydCA9IHRhYmxlQ3RybC5wYWdlTm8gLSAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbGljZUVuZCA9IHRhYmxlQ3RybC5wYWdlTm8gKyAzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2xpY2VTdGFydCA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsaWNlRW5kID0gc2xpY2VFbmQgLSBzbGljZVN0YXJ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xpY2VTdGFydCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNsaWNlRW5kID4gdGFibGVDdHJsLmNodW5rcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsaWNlU3RhcnQgPSBzbGljZVN0YXJ0IC0gKHNsaWNlRW5kIC0gdGFibGVDdHJsLmNodW5rcy5sZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xpY2VFbmQgPSB0YWJsZUN0cmwuY2h1bmtzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGFnaW5hdGlvbk1lbnUuY2h1bmtzID0gdGFibGVDdHJsLmNodW5rcy5zbGljZShzbGljZVN0YXJ0LCBzbGljZUVuZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGFnaW5hdGlvbk1lbnUuY2h1bmtzID0gdGFibGVDdHJsLmNodW5rcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLmZpbHRlcmVkSXRlbXMgPSBsaW1pdFRvRmlsdGVyKHNlYXJjaFRleHRGaWx0ZXJlZEl0ZW1zLCB0YWJsZUN0cmwuc2l6ZSwgdGFibGVDdHJsLnBhZ2VObyAqIHRhYmxlQ3RybC5zaXplKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZmlsdGVyZWRpdGVtcyA9IHRhYmxlQ3RybC5maWx0ZXJlZEl0ZW1zO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNob3dQcmV2Q2h1bmsoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJldkNodW5rO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhYmxlQ3RybC5wYWdlTm8gPD0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZDaHVuayA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2Q2h1bmsgPSB0YWJsZUN0cmwucGFnZU5vIC0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzaG93Q2h1bmsocHJldkNodW5rKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBzaG93TmV4dENodW5rKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5leHRDaHVuaztcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHRDaHVuayA9IHRhYmxlQ3RybC5wYWdlTm8gKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRDaHVuayA+IHRhYmxlQ3RybC5jaHVua3MubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHRDaHVuayA9IHRhYmxlQ3RybC5jaHVua3MubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzaG93Q2h1bmsobmV4dENodW5rKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICogU2F2ZSBwYWdpbmF0aW9uIHNjb3BlIHRvIHByb3ZpZGUgY2h1bmsgaW5mb3JtYXRpb24gdG8gcGFnaW5hdGlvbiBtZW51LlxuICAgICAgICAgICAgICAgICAgICAgKiBAcGFyYW0gbWVudVxuICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYWRkUGFnaW5hdGlvbk1lbnUobWVudSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2luYXRpb25NZW51ID0gbWVudTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBpbml0aWFsaXplU29ydChzb3J0ZmllbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGQ6IHNvcnRmaWVsZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXZlcnNlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpY29uRGlyZWN0aW9uOiB7IFwiYW5nbGUgZG93biBpY29uXCI6IHRydWUsIFwiYW5nbGUgdXAgaWNvblwiOiBmYWxzZSB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNvcnQoc29ydGZpZWxkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc29ydGZpZWxkID09IHRhYmxlQ3RybC5zb3J0T2JqLmZpZWxkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNvcnRPYmouZmllbGQgPSBzb3J0ZmllbGQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNvcnRPYmoucmV2ZXJzZSA9ICF0YWJsZUN0cmwuc29ydE9iai5yZXZlcnNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zb3J0T2JqLmljb25EaXJlY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYW5nbGUgZG93biBpY29uXCI6ICF0YWJsZUN0cmwuc29ydE9iai5yZXZlcnNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFuZ2xlIHVwIGljb25cIjogdGFibGVDdHJsLnNvcnRPYmoucmV2ZXJzZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc29ydE9iaiA9IGluaXRpYWxpemVTb3J0KHNvcnRmaWVsZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc2hvd0NodW5rKHRhYmxlQ3RybC5wYWdlTm8sIHRhYmxlQ3RybC5zZWFyY2hUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc2hvd0NodW5rID0gc2hvd0NodW5rO1xuICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc2hvd05leHRDaHVuayA9IHNob3dOZXh0Q2h1bms7XG4gICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zaG93UHJldkNodW5rID0gc2hvd1ByZXZDaHVuaztcbiAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLmFkZFBhZ2luYXRpb25NZW51ID0gYWRkUGFnaW5hdGlvbk1lbnU7XG4gICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zb3J0ID0gc29ydDtcbiAgICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cnMsIHRhYmxlQ3RybCkge1xuICAgICAgICAgICAgICAgIC8vV2F0Y2ggZm9yIGl0ZW1zIGFzIHRoZXkgd2lsbCBiZSBhdXRvIHJlZnJlc2hlZFxuICAgICAgICAgICAgICAgIHNjb3BlLiRwYXJlbnQuJHdhdGNoKGF0dHJzLml0ZW1zLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zaG93Q2h1bmsodGFibGVDdHJsLnBhZ2VObywgdGFibGVDdHJsLnNlYXJjaFRleHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9kaXJlY3RpdmVzL3RhYmxlLmh0bWwnXG4gICAgICAgIH07XG4gICAgfV0pXG4gICAgLmRpcmVjdGl2ZShcImN0dlRoZWFkXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICB0ZW1wbGF0ZTogJzx0aGVhZCBuZy10cmFuc2NsdWRlPjwvdGhlYWQ+J1xuICAgIH07XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZUaFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgcmVxdWlyZTogJ15eY3R2VGFibGUnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgY2xhc3M6ICdAJyxcbiAgICAgICAgICAgIHNvcnRmaWVsZDogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cnMsIHRhYmxlQ3RybCkge1xuICAgICAgICAgICAgc2NvcGUudGFibGVjdHJsID0gdGFibGVDdHJsO1xuICAgICAgICAgICAgaWYgKHNjb3BlLnNvcnRmaWVsZCAhPSB1bmRlZmluZWQgJiYgc2NvcGUuc29ydGZpZWxkICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc29ydChzY29wZS5zb3J0ZmllbGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy90YWJsZWhlYWRlci5odG1sJ1xuICAgIH07XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZUYm9keVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHt9LFxuICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICB0ZW1wbGF0ZTogJzx0Ym9keSBuZy10cmFuc2NsdWRlPjwvdGJvZHk+J1xuICAgIH07XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZUZm9vdFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHt9LFxuICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICB0ZW1wbGF0ZTogJzx0Zm9vdCBuZy10cmFuc2NsdWRlPjwvdGZvb3Q+J1xuICAgIH07XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZUc2VhcmNoXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICByZXF1aXJlOiAnXl5jdHZUYWJsZScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBwbGFjZWhvbGRlcjogJ0AnLFxuICAgICAgICAgICAgc2l6ZTogJ0AnXG4gICAgICAgIH0sXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0ciwgdGFibGVDdHJsKSB7XG4gICAgICAgICAgICBzY29wZS5zaG93Q2h1bmsgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGFibGVDdHJsLnNob3dDaHVuayh0YWJsZUN0cmwucGFnZU5vLCBzY29wZS5zZWFyY2hUZXh0KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9kaXJlY3RpdmVzL3NlYXJjaGlucHV0Lmh0bWwnXG4gICAgfTtcbn0pXG4gICAgLmRpcmVjdGl2ZShcImN0dlRyXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICB0cmFuc2NsdWRlOiAndHJ1ZScsXG4gICAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICAgIHNjb3BlOiB7fSxcbiAgICAgICAgdGVtcGxhdGU6ICc8dHIgbmctdHJhbnNjbHVkZT48L3RyPidcbiAgICB9O1xufSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2VGRcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXG4gICAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICAgIHNjb3BlOiB0cnVlLFxuICAgICAgICB0ZW1wbGF0ZTogJzx0ZCBuZy10cmFuc2NsdWRlPjwvdGQ+J1xuICAgIH07XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZUcGFnaW5hdGlvblwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgcmVxdWlyZTogJ15eY3R2VGFibGUnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgY29sc3BhbjogJ0AnXG4gICAgICAgIH0sXG4gICAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0ciwgdGFibGVDdHJsKSB7XG4gICAgICAgICAgICB0YWJsZUN0cmwuYWRkUGFnaW5hdGlvbk1lbnUoc2NvcGUpO1xuICAgICAgICAgICAgLy9zaG93Q2h1bmsoKSB3aWxsIGNhbGN1bGF0ZSBhbmQgc2V0IGNodW5rcyBpbiBzY29wZVxuICAgICAgICAgICAgdGFibGVDdHJsLnNob3dDaHVuayh0YWJsZUN0cmwucGFnZU5vLCB0YWJsZUN0cmwuc2VhcmNoVGV4dCk7XG4gICAgICAgICAgICBzY29wZS5zaG93Q2h1bmsgPSBmdW5jdGlvbiAocGFnZU5vKSB7XG4gICAgICAgICAgICAgICAgdGFibGVDdHJsLnNob3dDaHVuayhwYWdlTm8sIHRhYmxlQ3RybC5zZWFyY2hUZXh0KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBzY29wZS5zaG93UHJldkNodW5rID0gdGFibGVDdHJsLnNob3dQcmV2Q2h1bms7XG4gICAgICAgICAgICBzY29wZS5zaG93TmV4dENodW5rID0gdGFibGVDdHJsLnNob3dOZXh0Q2h1bms7XG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9kaXJlY3RpdmVzL3BhZ2luYXRpb25tZW51Lmh0bWwnXG4gICAgfTtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGFibGVkaXJlY3RpdmUuanMubWFwXG4vKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDEwLzE0LzE2LlxuICovXG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2RlbHMubW9kdWxlLmpzLm1hcFxuYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZBY2l2YWxpZFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvbm9kZXMvYWNpdmFsaWQuaHRtbCcsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIGZvcm06IFwiPVwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5kaXJlY3RpdmVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dkNvbnRyb2xpbnRlcmZhY2VcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9kaXJlY3RpdmVzL25vZGVzL2NvbnRyb2xpbnRlcmZhY2UuaHRtbCcsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIGV4dHJhdmFyczogXCI9XCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTtcbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2TmV0d29ya21vZGVcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9kaXJlY3RpdmVzL25vZGVzL25ldHdvcmttb2RlLmh0bWwnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBleHRyYXZhcnM6IFwiPVwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5kaXJlY3RpdmVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dlNjaGVkdWxlclwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvbm9kZXMvc2NoZWR1bGVyLmh0bWwnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBleHRyYXZhcnM6IFwiPVwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7IiwiLyoqXG4gKiBEZWZpbmluZyB0aGUgR3JhcGggTW9kdWxlLlxuICogU2VlIERFU0lHTi5tZCBmb3IgaW5mbyBvbiBHcmFwaCBPYmplY3RzLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJywgW10pO1xuXG5cblxuXG4iLCJhbmd1bGFyLm1vZHVsZShcImNvbnRpdi5kaXJlY3RpdmVzXCIsIFtdKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIFRoZSBiYXNlIGNsYXNzIHRoZSBEYXRhU291cmNlIG9iamVjdC5cbiAqIFxuICogVGhlIERhdGFTb3VyY2Ugb2JqZWN0IHRha2VzIGluIG5vZGUgYW5kIGxpbmsgZGF0YSBmcm9tIHRoZSBzZXJ2ZXIsIFxuICogYW5kIHByb3ZpZGVzIG1ldGhvZHMgZm9yIGNvbnZlcnRpbmcgYW5kIG1hbmlwdWxhdGluZyB0aGUgZGF0YSBmb3JcbiAqIHRoZSBncmFwaCBvYmplY3QuXG4gKiBcbiAqIFRvIHdyaXRlIHlvdXIgb3duIERhdGFTb3VyY2Ugb2JqZWN0LCBjcmVhdGUgYSBuZXcgZmFjdG9yeSB0aGF0IHVzZXMgdGhlIFxuICogRGF0YVNvdXJjZSB5b3Ugd2FudCB0byBpbmhlcml0IGFzIGEgZGVwZW5kZW5jeSwgYW5kIGV4dGVuZCBcbiAqIGl0cyBEYXRhU291cmNlIGNsYXNzLiBcbiAqIFJldHVybiB0aGUgY2xhc3Mgb2JqZWN0IHdpdGggRGF0YVNvdXJjZSBhcyBrZXkuXG4gKiBcbiAqIE5vZGUgZGF0YSBpcyBleHBlY3RlZCB0byBiZSBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDpcbiAqIHtpZDpub2RlX2lkLCB0ZXh0Om5vZGVfdGV4dH1cbiAqIFxuICogTGluayBkYXRhIGlzIGV4cGVjdGVkIHRvIGJlIGluIHRoZSBmb2xsb3dpbmcgZm9ybWF0OlxuICoge3NvdXJjZTogc291cmNlTm9kZUlkLCB0YXJnZXQ6IHRhcmdldE5vZGVJZH1cbiAqIFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnRGF0YVNvdXJjZScsIFsnTm9kZScsICdMaW5rJywgXG4gICAgXHRmdW5jdGlvbiAoTm9kZSwgTGluaykge1xuXG4gICAgXHRjbGFzcyBEYXRhU291cmNlIHtcbiAgICBcdFx0LyoqXG4gICAgXHRcdCAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICBcdFx0ICpcbiAgICBcdFx0ICogQHBhcmFtICAgICAge0FycmF5fSAgIG5vZGVzICAgICAgICAgICAgICBUaGUgbm9kZSBkYXRhIFxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgbGlua3MgICAgICAgICAgICAgIFRoZSBsaW5rIGRhdGFcbiAgICBcdFx0ICovXG5cdFx0XHRjb25zdHJ1Y3Rvcihub2RlcywgbGlua3MpIHtcblx0XHRcdFx0dGhpcy5ub2RlcyA9IG5vZGVzO1xuXHRcdFx0XHR0aGlzLmxpbmtzID0gbGlua3M7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogUmVwbGFjZXMgdGhlIG5vZGUgZGF0YVxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZXMgICBUaGUgbm9kZXNcblx0XHRcdCAqL1xuXHRcdFx0dXBkYXRlTm9kZXMobm9kZXMpIHtcblx0XHRcdFx0dGhpcy5ub2RlcyA9IG5vZGVzO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFJlcGxhY2VzIHRoZSBsaW5rIGRhdGFcblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7TGlua30gIGxpbmtzICAgVGhlIGxpbmtzXG5cdFx0XHQgKi9cblx0XHRcdHVwZGF0ZUxpbmtzKGxpbmtzKSB7XG5cdFx0XHRcdHRoaXMubGlua3MgPSBsaW5rcztcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBSZXR1cm5zIHRoZSBOYW1lIGF0dHJpYnV0ZSBvZiB0aGUgTm9kZSB3aXRoIHRoZSBcblx0XHRcdCAqIG1hdGNoaW5nIGlkXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge3N0cmluZ30gIGlkICAgICAgVGhlIGlkZW50aWZpZXJcblx0XHRcdCAqIEByZXR1cm4gICAgIHtzdHJpbmd9ICBuYW1lIG9mIHRoZSBtYXRjaGluZyBub2RlXG5cdFx0XHQgKi9cblx0XHRcdG5vZGVJZFRvTmFtZShpZCkge1xuXHRcdCAgICAgICAgdmFyIG5vZGVzID0gdGhpcy5ub2Rlcztcblx0XHQgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcblx0XHQgICAgICAgICAgICBpZiAobm9kZXNbaV0uaWQgPT0gaWQpIHtcblx0XHQgICAgICAgICAgICAgICAgcmV0dXJuIG5vZGVzW2ldLm5hbWU7XG5cdFx0ICAgICAgICAgICAgfVxuXHRcdCAgICAgICAgfVxuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIHByb2Nlc3MgdGhlIG5vZGVEYXRhIHRvIGNyZWF0ZSBOb2RlIG9iamVjdHNcblx0XHQgICAgICpcblx0XHQgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZURhdGEgIE5vZGVEYXRhIHRvIGNvbnZlcnQgXG5cdFx0ICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0byBub2RlIG9iamVjdHNcblx0XHQgICAgICogQHJldHVybiAgICAge0FycmF5fSAgTm9kZSBvYmplY3RzXG5cdFx0ICAgICAqL1xuXHRcdCAgICBwcm9jZXNzTm9kZURhdGEobm9kZURhdGEpIHtcblx0XHQgICAgICAgIHZhciBub2RlcyA9IFtdO1xuXHRcdCAgICAgICAgXy5mb3JFYWNoKG5vZGVEYXRhLCBmdW5jdGlvbihkYXRhKSB7XG5cdFx0ICAgICAgICAgICAgdmFyIG5ld05vZGUgPSBuZXcgTm9kZS5Ob2RlKG51bGwsIG51bGwsIGRhdGEuaWQsIGRhdGEudGV4dCwgbnVsbCk7XG5cdFx0ICAgICAgICAgICAgbm9kZXMucHVzaChuZXdOb2RlKTtcblx0XHQgICAgICAgIH0pO1xuXHRcdCAgICAgICAgcmV0dXJuIG5vZGVzO1xuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIHByb2Nlc3MgdGhlIGxpbmtEYXRhXG5cdFx0ICAgICAqXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIGxpbmtEYXRhICBUaGUgbGluayBkYXRhXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVzICAgICBUaGUgbm9kZXMgZnJvbSBwcm9jZXNzTm9kZURhdGFcblx0XHQgICAgICogQHJldHVybiAgICAge0FycmF5fSAgTGluayBvYmplY3RzXG5cdFx0ICAgICAqL1xuXHRcdCAgICBwcm9jZXNzTGlua0RhdGEobGlua0RhdGEsIG5vZGVzKSB7XG5cdFx0ICAgIFx0LyoqXG5cdFx0XHQgICAgICogUmV0dXJucyB0aGUgbm9kZSB0aGF0IG1hdGNoZXMgdGhlIGlkXG5cdFx0XHQgICAgICpcblx0XHRcdCAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG5cdFx0XHQgICAgICogQHJldHVybiAgICAge05vZGV9ICAgVGhlIG5vZGUgd2l0aCB0aGUgbWF0Y2hpbmcgaWRcblx0XHRcdCAgICAgKi9cblx0XHRcdCAgICBmdW5jdGlvbiBmaW5kTm9kZUJ5SWQoaWQsIG5vZGVzKSB7XG5cdFx0XHQgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdCAgICAgICAgICAgIGlmIChpZCA9PSBub2Rlc1tpXS5pZCkge1xuXHRcdFx0ICAgICAgICAgICAgICAgIHJldHVybiBub2Rlc1tpXTtcblx0XHRcdCAgICAgICAgICAgIH1cblx0XHRcdCAgICAgICAgfVxuXHRcdFx0ICAgIH1cblxuXHRcdCAgICAgICAgdmFyIGxpbmtzID0gW107XG5cdFx0ICAgICAgICAvL3RyYW5zZm9ybWluZyBsaW5rIGRhdGFcblx0XHQgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGlua0RhdGEubGVuZ3RoOyBpKyspIHtcblx0XHQgICAgICAgICAgICBpZiAobGlua0RhdGFbaV0uc291cmNlICE9IGxpbmtEYXRhW2ldLnRhcmdldCkge1xuXHRcdCAgICAgICAgICAgICAgICB2YXIgc291cmNlID0gZmluZE5vZGVCeUlkKGxpbmtEYXRhW2ldLnNvdXJjZSwgbm9kZXMpO1xuXHRcdCAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0ID0gZmluZE5vZGVCeUlkKGxpbmtEYXRhW2ldLnRhcmdldCwgbm9kZXMpO1xuXHRcdCAgICAgICAgICAgICAgICBpZiAoc291cmNlID09IG51bGwgfHwgdGFyZ2V0ID09IG51bGwpIHtcblx0XHQgICAgICAgICAgICAgICAgXHRjb250aW51ZTtcblx0XHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgICAgIHZhciBsaW5rID0gbmV3IExpbmsuTGluayhzb3VyY2UsIHRhcmdldCk7XG5cdCAgICAgICAgICAgICAgICAgICAgbGlua3MucHVzaChsaW5rKTtcblx0XHQgICAgICAgICAgICB9ICBcblx0XHQgICAgICAgIH1cblx0XHQgICAgICAgIHJldHVybiBsaW5rcztcblx0XHQgICAgfVxuXHRcdH1cblx0XHRyZXR1cm4ge1xuXHRcdFx0RGF0YVNvdXJjZTpEYXRhU291cmNlXG5cdFx0fVxufV0pO1xuXG5cblxuXG5cblxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzE0LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm1vZGVscycsIFtdKTtcbnZhciBDb250aXZHbG9iYWxzID0gKGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICAvL1JFU1QgZW5kcG9pbnRzIGZvciBORVRNQVNURVJcbiAgICAgICAgJ05FVFdPUktTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL25ldHdvcmtzLycsXG4gICAgICAgICdORVRXT1JLU19JTlNQRUNUX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL2luc3BlY3QvbmV0d29ya3MvJyxcbiAgICAgICAgJ1NFUlZJQ0VMQlNfSU5TUEVDVF9FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9pbnNwZWN0L3NlcnZpY2VMQnMvJyxcbiAgICAgICAgJ1BPTElDSUVTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL3BvbGljeXMvJyxcbiAgICAgICAgJ1JVTEVTX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL3J1bGVzLycsXG4gICAgICAgICdBUFBMSUNBVElPTkdST1VQU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9lbmRwb2ludEdyb3Vwcy8nLFxuICAgICAgICAnU0VSVklDRUxCU19FTkRQT0lOVCc6ICcvbmV0bWFzdGVyL2FwaS92MS9zZXJ2aWNlTEJzLycsXG4gICAgICAgICdPUkdBTklaQVRJT05TX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL3RlbmFudHMvJyxcbiAgICAgICAgJ05FVFdPUktfU0VUVElOR1NfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvZ2xvYmFscy8nLFxuICAgICAgICAnTkVUUFJPRklMRVNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvbmV0cHJvZmlsZXMvJyxcbiAgICAgICAgJ0JHUFNfRU5EUE9JTlQnOiAnL25ldG1hc3Rlci9hcGkvdjEvQmdwcy8nLFxuICAgICAgICAnQkdQU19JTlNQRUNUX0VORFBPSU5UJzogJy9uZXRtYXN0ZXIvYXBpL3YxL2luc3BlY3QvQmdwcy8nLFxuICAgICAgICAnVklTVUFMSVpBVElPTl9FTkRQT0lOVCc6ICcvdmlzdWFsaXphdGlvbi8nLFxuICAgICAgICAvL1JFU1QgZW5kcG9pbnRzIGZvciBWT0xNQVNURVJcbiAgICAgICAgJ1ZPTFVNRVNfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci92b2x1bWVzLycsXG4gICAgICAgICdWT0xVTUVTX0NSRUFURV9FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3ZvbHVtZXMvY3JlYXRlLycsXG4gICAgICAgICdWT0xVTUVTX0RFTEVURV9FTkRQT0lOVCc6ICcvdm9sbWFzdGVyL3ZvbHVtZXMvcmVtb3ZlLycsXG4gICAgICAgICdWT0xVTUVTX0NPUFlTTkFQU0hPVFNfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci92b2x1bWVzL2NvcHknLFxuICAgICAgICAnVk9MVU1FU19VU0VTX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvdXNlcy9tb3VudHMvJyxcbiAgICAgICAgJ1ZPTFVNRVNfU05BUFNIT1RTX0VORFBPSU5UJzogJy92b2xtYXN0ZXIvc25hcHNob3RzLycsXG4gICAgICAgICdTVE9SQUdFUE9MSUNJRVNfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci9wb2xpY2llcy8nLFxuICAgICAgICAnVk9MVU1FU19HTE9CQUxfRU5EUE9JTlQnOiAnL3ZvbG1hc3Rlci9nbG9iYWwvJyxcbiAgICAgICAgLy9SRVNUIGVuZHBvaW50cyBmb3IgQ0xVU1RFUlxuICAgICAgICAnTk9ERVNfTElTVF9FTkRQT0lOVCc6ICcvaW5mby9ub2RlcycsXG4gICAgICAgICdOT0RFU19ESVNDT1ZFUl9FTkRQT0lOVCc6ICcvZGlzY292ZXIvbm9kZXMnLFxuICAgICAgICAnTk9ERVNfQ09NTUlTU0lPTl9FTkRQT0lOVCc6ICcvY29tbWlzc2lvbi9ub2RlcycsXG4gICAgICAgICdOT0RFU19ERUNPTU1JU1NJT05fRU5EUE9JTlQnOiAnL2RlY29tbWlzc2lvbi9ub2RlcycsXG4gICAgICAgICdOT0RFU19NQUlOVEVOQU5DRV9FTkRQT0lOVCc6ICcvbWFpbnRlbmFuY2Uvbm9kZXMnLFxuICAgICAgICAnTk9ERVNfTEFTVF9KT0JfRU5EUE9JTlQnOiAnL2luZm8vam9iL2xhc3QnLFxuICAgICAgICAnTk9ERVNfQUNUSVZFX0pPQl9FTkRQT0lOVCc6ICcvaW5mby9qb2IvYWN0aXZlJyxcbiAgICAgICAgJ05PREVTX1NFVFRJTkdTX1NFVF9FTkRQT0lOVCc6ICcvZ2xvYmFscycsXG4gICAgICAgICdOT0RFU19TRVRUSU5HU19HRVRfRU5EUE9JTlQnOiAnL2luZm8vZ2xvYmFscycsXG4gICAgICAgIC8vUmVmcmVzaCBpbnRlcnZhbCBpbiBtaWxsaXNlY29uZHNcbiAgICAgICAgJ1JFRlJFU0hfSU5URVJWQUwnOiA1MDAwLFxuICAgICAgICAvL1JlZ0V4IGZvciB2YWxpZGF0aW9uXG4gICAgICAgICdDSURSX1JFR0VYJzogJ14oKFswLTldfFsxLTldWzAtOV18MVswLTldezJ9fDJbMC00XVswLTldfDI1WzAtNV0pXFwuKXszfShbMC05XXxbMS05XVswLTldfDFbMC05XXsyfXwyWzAtNF1bMC05XXwyNVswLTVdKShcXC8oWzAtOV18WzEtMl1bMC05XXwzWzAtMl0pKSQnLFxuICAgICAgICAnVkxBTl9SRUdFWCc6ICdeKFswLTldezEsNH0/LVswLTldezEsNH0/KSQnLFxuICAgICAgICAnVlhMQU5fUkVHRVgnOiAnXihbMC05XXsxLDh9Py1bMC05XXsxLDh9PykkJyxcbiAgICAgICAgJ05VTUJFUl9SRUdFWCc6ICdeWzAtOV0qJCdcbiAgICB9O1xufSkoKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudXRpbHMnLCBbXSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwIiwiLyoqXG4gKiBUaGUgRGF0YVNvdXJjZSB1c2VkIGZvciB0aGUgdmlzdWFsaXphdGlvbiB0YWIuXG4gKiBcbiAqIE5vZGUgRGF0YSBmcm9tIHRoZSBzZXJ2ZXIgaXMgZXhwZWN0ZWQgdG8gYmUgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6XG4gKiB7aWQ6IG5vZGVfaWQsIHRleHQ6IG5vZGVfdGV4dH1cbiAqIFBhcmVudCBhbmQgQW5jZXN0b3IgYXR0cmlidXRlcyBjYW4gYmUgc2V0IGJ5IGNhbGxpbmcgc2V0QW5jZXN0b3JzXG4gKiBcbiAqIExpbmsgRGF0YSBmcm9tIHRoZSBzZXJ2ZXIgaXMgZXhwZWN0ZWQgdG8gYmUgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6XG4gKiB7c291cmNlOiBzb3VyY2VOb2RlSWQsIHRhcmdldDogdGFyZ2V0Tm9kZUlkLCB3ZWlnaHQ6IGxpbmtXZWlnaHR9XG4gKiBcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ1Zpc3VhbGl6ZXJEYXRhU291cmNlJywgWydEYXRhU291cmNlJywgJ1Zpc3VhbGl6ZXJOb2RlJywgJ1Zpc3VhbGl6ZXJMaW5rJywgXG4gICAgXHRmdW5jdGlvbiAoRGF0YVNvdXJjZSwgVmlzdWFsaXplck5vZGUsIFZpc3VhbGl6ZXJMaW5rKSB7XG5cbiAgICBcdGNsYXNzIFZpc3VhbGl6ZXJEYXRhU291cmNlIGV4dGVuZHMgRGF0YVNvdXJjZS5EYXRhU291cmNlIHtcbiAgICBcdFx0LyoqXG4gICAgXHRcdCAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICBcdFx0ICogXG4gICAgXHRcdCAqIENoaWxkcmVuIFN0cnVjdCBhbmQgYW5jZXN0b3JzX3N0cnVjdCBhcmUgSlNPTiBvYmplY3RzLFxuICAgIFx0XHQgKiBtYXBwaW5nIGEgbm9kZSBJZCB0byBhIGxpc3Qgb2YgaXQncyBjaGlsZHJlbiBvciBhbmNlc3RvcnMuXG4gICAgXHRcdCAqIENoaWxkcmVuIFN0cnVjdCBpcyBhbHNvIGV4cGVjdGVkIHRvIGhhdmUgYSBmaWVsZCBjYWxsZWRcbiAgICBcdFx0ICogdG9wTGV2ZWwsIHRoYXQgbWFwcyB0byBhIGxpc3Qgb2YgYWxsIHRoZSBub2RlcyB0aGF0IGRvbid0XG4gICAgXHRcdCAqIGhhdmUgYW55IHBhcmVudHMuXG4gICAgXHRcdCAqXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBub2RlcyAgICAgICAgICAgICAgVGhlIG5vZGUgZGF0YSBcbiAgICBcdFx0ICogQHBhcmFtICAgICAge0FycmF5fSAgIGxpbmtzICAgICAgICAgICAgICBUaGUgbGluayBkYXRhXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBjaGlsZHJlbl9zdHJ1Y3QgICAgVGhlIGNoaWxkcmVuIHN0cnVjdHVyZVxuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgYW5jZXN0b3JzX3N0cnVjdCAgIFRoZSBhbmNlc3RvcnMgc3RydWN0dXJlXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBsYWJlbHMgICAgICAgICAgICAgVGhlIGxhYmVsc1xuICAgIFx0XHQgKiBAcGFyYW0gICAgICB7QXJyYXl9ICAgc2VsZWN0b3JzICAgICAgICAgIFRoZSBzZWxlY3RvcnNcbiAgICBcdFx0ICovXG5cdFx0XHRjb25zdHJ1Y3Rvcihub2RlcywgbGlua3MsIGNoaWxkcmVuX3N0cnVjdCwgYW5jZXN0b3JzX3N0cnVjdCwgXG5cdFx0XHRcdFx0bGFiZWxzLCBzZWxlY3RvcnMpIHtcblx0XHRcdFx0c3VwZXIobm9kZXMsbGlua3MpO1xuXHRcdFx0XHR0aGlzLmNoaWxkcmVuX3N0cnVjdCA9IGNoaWxkcmVuX3N0cnVjdDtcblx0XHRcdFx0dGhpcy5hbmNlc3RvcnNfc3RydWN0ID0gYW5jZXN0b3JzX3N0cnVjdDtcblx0XHRcdFx0dGhpcy5sYWJlbHMgPSBsYWJlbHM7XG5cdFx0XHRcdHRoaXMuc2VsZWN0b3JzID0gc2VsZWN0b3JzO1xuXHRcdFx0fVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBEZXRlcm1pbmVzIGlmIGl0IGhhcyBjaGlsZC5cblx0XHQgICAgICpcblx0XHQgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gICBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG5cdFx0ICAgICAqIEByZXR1cm4gICAgIHtib29sZWFufSAgVHJ1ZSBpZiBoYXMgY2hpbGQsIEZhbHNlIG90aGVyd2lzZS5cblx0XHQgICAgICovXG5cdFx0ICAgIGhhc0NoaWxkKGlkKSB7XG5cdFx0ICAgIFx0aWYgKHRoaXMuY2hpbGRyZW5fc3RydWN0W2lkXSA9PSBudWxsKSB7XG4gICAgICAgICAgICBcdFx0cmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgXHR9XG4gICAgICAgICAgICBcdHJldHVybiB0cnVlO1x0XG5cdFx0ICAgIH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogU2V0cyB0aGUgcGFyZW50IGFuZCBhbmNlc3RvcnMgYXR0cmlidXRlIHVzaW5nIFxuXHRcdCAgICAgKiBhbmNlc3RvcnNfc3RydWN0IGZvciBhbGwgdGhlIG5vZGVzXG5cdFx0ICAgICAqIEFsc28gYWRkcyBhbnkgbm9kZXMgd2l0aG91dCBhbmNlc3RvcnMsIHRoYXQgYXJlbid0IFxuXHRcdCAgICAgKiB0b3BsZXZlbCB0byB0aGUgY2xpZW50IHNlcnZpY2UuXG5cdFx0ICAgICAqL1xuXHRcdCAgICBzZXRBbmNlc3RvcnMoKSB7XG5cdFx0ICAgIFx0dmFyIHRoaXNEYXRhU291cmNlID0gdGhpcztcblx0XHQgICAgXHR2YXIgYWRkZWRDbGllbnQgPSBmYWxzZTtcblx0XHQgICAgXHRfLmZvckVhY2godGhpc0RhdGFTb3VyY2Uubm9kZXMsIGZ1bmN0aW9uKG5vZGUpIHtcblx0XHQgICAgXHRcdG5vZGUuYW5jZXN0b3JzID0gdGhpc0RhdGFTb3VyY2UuYW5jZXN0b3JzX3N0cnVjdFtub2RlLmlkXSB8fCBbXTtcblx0XHQgICAgXHRcdGlmIChfLmlzRW1wdHkobm9kZS5hbmNlc3RvcnMpID09PSBmYWxzZSkge1xuXHRcdCAgICBcdFx0XHRub2RlLnBhcmVudCA9IG5vZGUuYW5jZXN0b3JzWzBdO1xuXHRcdCAgICBcdFx0fSBlbHNlIHtcblx0XHQgICAgXHRcdFx0aWYgKF8uaW5jbHVkZXModGhpc0RhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0LnRvcExldmVsLCBub2RlLmlkKSA9PSBmYWxzZSkge1xuXHRcdCAgICBcdFx0XHRcdC8vY29udGFpbmVyIGhhcyBubyBwYXJlbnRcblx0XHQgICAgXHRcdFx0XHQvL2FkZGluZyB0byBjbGllbnRcblx0XHQgICAgXHRcdFx0XHRub2RlLmFuY2VzdG9ycy5wdXNoKFwiY2xpZW50XCIpO1xuXHRcdCAgICBcdFx0XHRcdHRoaXNEYXRhU291cmNlLmFuY2VzdG9yc19zdHJ1Y3Rbbm9kZS5pZF0gPSBbXCJjbGllbnRcIl07XG5cdFx0ICAgIFx0XHRcdFx0aWYgKGFkZGVkQ2xpZW50ID09PSBmYWxzZSkge1xuXHRcdCAgICBcdFx0XHRcdFx0YWRkZWRDbGllbnQgPSB0cnVlO1xuXHRcdFx0ICAgIFx0XHRcdFx0dGhpc0RhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0LnRvcExldmVsLnB1c2goXCJjbGllbnRcIik7XG5cdFx0ICAgIFx0XHRcdFx0XHR0aGlzRGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbJ2NsaWVudCddID0gW107XG5cdFx0ICAgIFx0XHRcdFx0fVxuXHRcdCAgICBcdFx0XHRcdHRoaXNEYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFsnY2xpZW50J10ucHVzaChub2RlLmlkKTtcblx0XHRcdCAgICBcdFx0fVxuXHRcdCAgICBcdFx0fVxuXHRcdCAgICBcdH0pXG5cdFx0ICAgIH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogUmV0dXJucyB0aGUgZmxvdyBiZXR3ZWVuIHRoZSBoaWdoZXN0IGxldmVsIGdyb3VwaW5nXG5cdFx0ICAgICAqXG5cdFx0ICAgICAqIEByZXR1cm4gICAgIHtPYmplY3R9ICBUaGUgdG9wIGxldmVsIGZsb3cuXG5cdFx0ICAgICAqL1xuXHRcdCAgICBnZXRUb3BMZXZlbEZsb3coKSB7XG5cdFx0ICAgICAgICByZXR1cm4gdGhpcy5nZXRGbG93QmV0d2VlblNldCh0aGlzLmNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbCk7XG5cdFx0ICAgIH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogR2V0cyB0aGUgZmxvdyBiZXR3ZWVuIGFueSBzZXQgb2Ygbm9kZSBsZXZlbHNcblx0XHQgICAgICpcblx0XHQgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZV9uYW1lcyAgVGhlIG5vZGUgbmFtZXMgaW4gdGhlIHNldFxuXHRcdCAgICAgKiBAcmV0dXJuICAgICB7T2JqZWN0fSAgVGhlIGZsb3cgYmV0d2VlbiBzZXQuXG5cdFx0ICAgICAqL1xuXHRcdCAgICBnZXRGbG93QmV0d2VlblNldChub2RlX25hbWVzKSB7XG5cdFx0ICAgICAgICB2YXIgbG9jYWxfbm9kZXMgPSB0aGlzLm5vZGVzO1xuXHRcdCAgICAgICAgdmFyIGlkTWFwcGluZyA9IHt9O1xuXHRcdCAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsb2NhbF9ub2Rlcy5sZW5ndGg7IGkrKykge1xuXHRcdCAgICAgICAgICAgIHZhciBub2RlID0gbG9jYWxfbm9kZXNbaV07XG5cblx0XHQgICAgICAgICAgICAvL2lmIG5vZGUgaXMgYWxyZWFkeSBhdCBpdHMgaGlnaGVzdCBsZXZlbFxuXHRcdCAgICAgICAgICAgIGlmIChub2RlLmFuY2VzdG9ycyA9PT0gbnVsbCkge1xuXHRcdCAgICAgICAgICAgICAgICBpZE1hcHBpbmdbbm9kZS5pZF0gPSBub2RlLm5hbWU7XG5cdFx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0XHQgICAgICAgICAgICAgICAgLy9jaGVjayB0byBzZWUgd2hpY2ggdGFncyBhcmUgcHJlc2VudCBpbiB0aGUgYW5jZXN0b3IgbGlzdFxuXHRcdCAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG5vZGVfbmFtZXMubGVuZ3RoOyBqKyspIHtcblx0XHQgICAgICAgICAgICAgICAgICAgIGlmIChub2RlLmFuY2VzdG9ycy5pbmRleE9mKG5vZGVfbmFtZXNbal0pID4gLTEpIHtcblx0XHQgICAgICAgICAgICAgICAgICAgICAgICBpZE1hcHBpbmdbbm9kZS5pZF0gPSBub2RlX25hbWVzW2pdO1xuXHRcdCAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXHRcdCAgICAgICAgICAgICAgICAgICAgfVxuXHRcdCAgICAgICAgICAgICAgICB9XG5cdFx0ICAgICAgICAgICAgfVxuXHRcdCAgICAgICAgfSAgIFxuXHRcdCAgICAgICAgLy9tb2RpZnkgbGlua3Ncblx0XHQgICAgICAgIHZhciBsaW5rcyA9IHRoaXMubGlua3M7XG5cdFx0ICAgICAgICB2YXIgbGlua0RhdGEgPSBbXTtcblx0XHQgICAgICAgIFxuXHRcdCAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5rcy5sZW5ndGg7IGkrKykge1xuXHRcdCAgICAgICAgICAgIHZhciBsaW5rID0gW107XG5cdFx0ICAgICAgICAgICAgbGluay5zb3VyY2UgPSBpZE1hcHBpbmdbbGlua3NbaV0uc291cmNlXSB8fCBsaW5rc1tpXS5zb3VyY2U7XG5cdFx0ICAgICAgICAgICAgbGluay50YXJnZXQgPSBpZE1hcHBpbmdbbGlua3NbaV0udGFyZ2V0XSB8fCBsaW5rc1tpXS50YXJnZXQ7XG5cdFx0ICAgICAgICAgICAgbGluay53ZWlnaHQgPSBsaW5rc1tpXS53ZWlnaHQ7XG5cdFx0ICAgICAgICAgICAgbGlua0RhdGEucHVzaChsaW5rKTtcblx0XHQgICAgICAgIH1cblxuXHRcdCAgICAgICAgLy9jcmVhdGluZyB0aGUgbm9kZURhdGFcblx0XHQgICAgICAgIHZhciBub2RlRGF0YSA9IFtdO1xuXHRcdCAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2RlX25hbWVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0ICAgICAgICAgICAgdmFyIG5vZGVfdG9fYWRkID0gW107XG5cdFx0ICAgICAgICAgICAgbm9kZV90b19hZGQuaWQgPSBub2RlX25hbWVzW2ldO1xuXHRcdCAgICAgICAgICAgIG5vZGVfdG9fYWRkLnRleHQgPSB0aGlzLm5vZGVJZFRvTmFtZShub2RlX25hbWVzW2ldKSB8fCBub2RlX25hbWVzW2ldO1xuXG5cblx0XHQgICAgICAgICAgICBub2RlX3RvX2FkZC5hbmNlc3RvcnMgPSB0aGlzLmFuY2VzdG9yc19zdHJ1Y3Rbbm9kZV9uYW1lc1tpXV0gfHwgdGhpcy5hbmNlc3RvcnNfc3RydWN0W25vZGVfdG9fYWRkLnRleHRdIHx8IFtdO1xuXHRcdCAgICAgICAgICAgIGlmIChfLmlzRW1wdHkobm9kZV90b19hZGQuYW5jZXN0b3JzKSA9PT0gZmFsc2UpIHtcblx0XHQgICAgICAgICAgICAgICAgbm9kZV90b19hZGQucGFyZW50ID0gbm9kZV90b19hZGQuYW5jZXN0b3JzWzBdO1xuXHRcdCAgICAgICAgICAgIH0gZWxzZSB7XG5cdFx0ICAgICAgICAgICAgICAgIG5vZGVfdG9fYWRkLnBhcmVudCA9IG51bGw7XG5cdFx0ICAgICAgICAgICAgfVxuXHRcdCAgICAgICAgICAgIG5vZGVEYXRhLnB1c2gobm9kZV90b19hZGQpO1xuXHRcdCAgICAgICAgfVxuXG5cdFx0ICAgICAgICByZXR1cm4ge25vZGVEYXRhOm5vZGVEYXRhLCBsaW5rRGF0YTpsaW5rRGF0YX07XG5cdFx0ICAgIH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogcHJvY2VzcyB0aGUgbm9kZURhdGEgb3V0cHV0IG9mIGdldEZsb3dCZXR3ZWVuU2V0XG5cdFx0ICAgICAqXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5vZGVEYXRhICBOb2RlRGF0YSB0byBjb252ZXJ0IFxuXHRcdCAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gbm9kZSBvYmplY3RzXG5cdFx0ICAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIE5vZGUgb2JqZWN0c1xuXHRcdCAgICAgKi9cblx0XHQgICAgcHJvY2Vzc05vZGVEYXRhKG5vZGVEYXRhKSB7XG5cdFx0ICAgICAgICB2YXIgbm9kZXMgPSBbXTtcblx0XHQgICAgICAgIF8uZm9yRWFjaChub2RlRGF0YSwgZnVuY3Rpb24oZGF0YSkge1xuXHRcdCAgICAgICAgICAgIHZhciBuZXdOb2RlID0gbmV3IFZpc3VhbGl6ZXJOb2RlLk5vZGUobnVsbCwgbnVsbCwgZGF0YS5pZCwgZGF0YS50ZXh0LFxuXHRcdCAgICAgICAgICAgICAgICBudWxsLCBkYXRhLnBhcmVudCwgZGF0YS5hbmNlc3RvcnMsIG51bGwsIG51bGwpO1xuXHRcdCAgICAgICAgICAgIG5vZGVzLnB1c2gobmV3Tm9kZSk7XG5cdFx0ICAgICAgICB9KTtcblx0XHQgICAgICAgIHJldHVybiBub2Rlcztcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBwcm9jZXNzIHRoZSBsaW5rRGF0YSBvdXRwdXQgb2YgZ2V0Rmxvd0JldHdlZW5TZXRcblx0XHQgICAgICpcblx0XHQgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbGlua0RhdGEgIFRoZSBsaW5rIGRhdGFcblx0XHQgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZXMgICAgIFRoZSBub2Rlc1xuXHRcdCAgICAgKiBAcmV0dXJuICAgICB7QXJyYXl9ICBMaW5rIG9iamVjdHNcblx0XHQgICAgICovXG5cdFx0ICAgIHByb2Nlc3NMaW5rRGF0YShsaW5rRGF0YSwgbm9kZXMpIHtcblx0XHQgICAgXHQvKipcblx0XHRcdCAgICAgKiBSZXR1cm5zIHRoZSBub2RlIHRoYXQgbWF0Y2hlcyB0aGUgaWRcblx0XHRcdCAgICAgKlxuXHRcdFx0ICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9IGlkICAgICAgVGhlIGlkZW50aWZpZXJcblx0XHRcdCAgICAgKiBAcmV0dXJuICAgICB7Tm9kZX0gICBUaGUgbm9kZSB3aXRoIHRoZSBtYXRjaGluZyBpZFxuXHRcdFx0ICAgICAqL1xuXHRcdFx0ICAgIGZ1bmN0aW9uIGZpbmROb2RlQnlJZChpZCwgbm9kZXMpIHtcblx0XHRcdCAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0ICAgICAgICAgICAgaWYgKGlkID09IG5vZGVzW2ldLmlkKSB7XG5cdFx0XHQgICAgICAgICAgICAgICAgcmV0dXJuIG5vZGVzW2ldO1xuXHRcdFx0ICAgICAgICAgICAgfVxuXHRcdFx0ICAgICAgICB9XG5cdFx0XHQgICAgfVxuXG5cdFx0ICAgICAgICB2YXIgbGlua3MgPSBbXTtcblx0XHQgICAgICAgIC8vYSBtYXBwaW5nIGZyb20gc291cmNlLmlkLXRhcmdldC5pZCB0byB0aGUgbGluayBhZGRlZFxuXHRcdCAgICAgICAgdmFyIGFkZGVkX2xpbmtzID0ge307XG5cdFx0ICAgICAgICAvL3RyYW5zZm9ybWluZyBsaW5rIGRhdGFcblx0XHQgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGlua0RhdGEubGVuZ3RoOyBpKyspIHtcblx0XHQgICAgICAgICAgICBpZiAobGlua0RhdGFbaV0uc291cmNlICE9IGxpbmtEYXRhW2ldLnRhcmdldCkge1xuXHRcdCAgICAgICAgICAgICAgICB2YXIgc291cmNlID0gZmluZE5vZGVCeUlkKGxpbmtEYXRhW2ldLnNvdXJjZSwgbm9kZXMpO1xuXHRcdCAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0ID0gZmluZE5vZGVCeUlkKGxpbmtEYXRhW2ldLnRhcmdldCwgbm9kZXMpO1xuXHRcdCAgICAgICAgICAgICAgICB2YXIgd2VpZ2h0ID0gbGlua0RhdGFbaV0ud2VpZ2h0O1xuXHRcdCAgICAgICAgICAgICAgICAvL2luIG9yZGVyIHRvIHN1bSBhbGwgdGhlIHdlaWdodHMgb2YgdGhlIGxpbmtzIG9mIHRoZSBzdWItbm9kZXMsXG5cdFx0ICAgICAgICAgICAgICAgIC8vd2UgdXNlIGFkZGVkX2xpbmtzIHRvIGtlZXAgdHJhY2sgaWYgYW4gbGluayB3YXMgYWRkZWRcblx0XHQgICAgICAgICAgICAgICAgLy9pZiBpdCBpcywgd2UgbW9kaWZ5IGl0cyB3ZWlnaHRcblx0XHQgICAgICAgICAgICAgICAgaWYgKHNvdXJjZSA9PSBudWxsIHx8IHRhcmdldCA9PSBudWxsKSB7XG5cdFx0ICAgICAgICAgICAgICAgIFx0Y29udGludWU7XG5cdFx0ICAgICAgICAgICAgICAgIH1cblx0XHQgICAgICAgICAgICAgICAgaWYgKGFkZGVkX2xpbmtzW3NvdXJjZS5pZCArICctJyArIHRhcmdldC5pZF0gPT09IHVuZGVmaW5lZCkge1xuXHRcdCAgICAgICAgICAgICAgICAgICAgdmFyIGxpbmsgPSBuZXcgVmlzdWFsaXplckxpbmsuTGluayhzb3VyY2UsIHRhcmdldCwgd2VpZ2h0KTtcblx0XHQgICAgICAgICAgICAgICAgICAgIGFkZGVkX2xpbmtzW3NvdXJjZS5pZCArICctJyArIHRhcmdldC5pZF0gPSBsaW5rO1xuXHRcdCAgICAgICAgICAgICAgICAgICAgbGlua3MucHVzaChsaW5rKTtcblx0XHQgICAgICAgICAgICAgICAgfSBlbHNlIHtcblx0XHQgICAgICAgICAgICAgICAgICAgIHZhciBleGlzdGluZ19saW5rID0gYWRkZWRfbGlua3Nbc291cmNlLmlkICsgJy0nICsgdGFyZ2V0LmlkXTtcblx0XHQgICAgICAgICAgICAgICAgICAgIGV4aXN0aW5nX2xpbmsuc2V0V2VpZ2h0KGV4aXN0aW5nX2xpbmsuZ2V0UmF3V2VpZ2h0KCkgKyB3ZWlnaHQpO1xuXHRcdCAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdfbGluay5pbmNyZWFzZUNvdW50KCk7XG5cdFx0ICAgICAgICAgICAgICAgIH1cblx0XHQgICAgICAgICAgICB9ICBcblx0XHQgICAgICAgIH1cblx0XHQgICAgICAgIHJldHVybiBsaW5rcztcblx0XHQgICAgfVxuXHRcdH1cblx0XHRyZXR1cm4ge1xuXHRcdFx0RGF0YVNvdXJjZTogVmlzdWFsaXplckRhdGFTb3VyY2Vcblx0XHR9XG59XSk7XG5cblxuXG5cblxuXG4iLCIvKipcbiAqIFRoZSBiYXNlIGNsYXNzIHRoZSBncmFwaCBvYmplY3QuIEFueSBub2RlcyBvciBsaW5rcyB0aGF0IGFyZSBjb250YWluZWQgaW5cbiAqIGl0cyBub2RlcyBvciBsaW5rcyBwcm9wZXJ0eSB3aWxsIGJlIGRyYXduIG9uIHVwZGF0ZUdyYXBoLlxuICogU3VwcG9ydHMgcG9saWNpZXMuXG4gKiBcbiAqIFRvIHdyaXRlIHlvdXIgb3duIGdyYXBoIG9iamVjdCwgY3JlYXRlIGEgbmV3IGZhY3RvcnkgdGhhdCB1c2VzIHRoZSBncmFwaFxuICogeW91IHdhbnQgdG8gaW5oZXJpdCBhcyBhIGRlcGVuZGVuY3ksIGFuZCBleHRlbmQgaXRzIGdyYXBoIGNsYXNzLiBcbiAqIFJldHVybiB0aGUgY2xhc3Mgb2JqZWN0IHdpdGggR3JhcGggYXMga2V5LlxuICogXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdHcmFwaCcsIFsnUG9saWN5U2VydmljZScsIGZ1bmN0aW9uIChQb2xpY3lTZXJ2aWNlKSB7XG4gICAgICAgIGNsYXNzIEdyYXBoIHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogY29uc3RydWN0b3IgZm9yIHRoZSBncmFwaFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtIVE1MIFNWR30gIHN2ZyAgICAgVGhlIHN2ZyB0aGF0IHdpbGwgXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvbGQgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlcyAgICAgIExpc3Qgb2Ygbm9kZXMgZm9yIHRoZSBncmFwaFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbGlua3MgICAgICBMaXN0IG9mIGxpbmtzIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgY29uc3RydWN0b3Ioc3ZnLCBub2RlcywgbGlua3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlcyA9IG5vZGVzIHx8IFtdO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IGxpbmtzIHx8IFtdO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMgPSBbXTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcyA9IFtdO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN2Z1BvbGljeSA9IG5ldyBQb2xpY3lTZXJ2aWNlLlBvbGljeSgpO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN0YXRlID0ge1xuICAgICAgICAgICAgICAgICAgICBjYW5ab29tOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBjYW5QYW46IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGluaXRGb3JjZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVVcGRhdGU6IGZhbHNlXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jb25zdHMgPSB7XG4gICAgICAgICAgICAgICAgICAgIGNpcmNsZUdDbGFzczogXCJjb25jZXB0R1wiLFxuICAgICAgICAgICAgICAgICAgICBncmFwaENsYXNzOiBcImdyYXBoXCIsXG4gICAgICAgICAgICAgICAgICAgIHBhdGhDbGFzczogXCJwYXRoXCIsXG4gICAgICAgICAgICAgICAgICAgIG5vZGVDbGFzczogXCJjaXJjbGVcIixcbiAgICAgICAgICAgICAgICAgICAgbm9kZVRleHQ6IFwibm9kZVRleHRcIixcbiAgICAgICAgICAgICAgICAgICAgc3RhcnRSYWRpdXM6IDUwLFxuICAgICAgICAgICAgICAgICAgICBtYXhSYWRpdXM6IDYwLFxuICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiA1LFxuICAgICAgICAgICAgICAgICAgICBkaXNwbGF5T2Zmc2V0OiA2MFxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBzdmcub24oXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wibW91c2VvdmVyXCJdLmNhbGwodGhpcywgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJkYmxjbGlja1wiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wiZGJsY2xpY2tcIl0uY2FsbCh0aGlzLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcImNvbnRleHRtZW51XCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3lbXCJjb250ZXh0bWVudVwiXS5jYWxsKHRoaXMsIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwibW91c2VvdXRcIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wibW91c2VvdXRcIl0uY2FsbCh0aGlzLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcIm1vdXNlZG93blwiLCBmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3lbXCJtb3VzZWRvd25cIl0uY2FsbCh0aGlzLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcIm1vdXNldXBcIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnUG9saWN5W1wibW91c2V1cFwiXS5jYWxsKHRoaXMsIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvLyBkZWZpbmUgYXJyb3cgbWFya2VycyBmb3IgZ3JhcGggbGlua3NcbiAgICAgICAgICAgICAgICB2YXIgZGVmcyA9IHN2Zy5hcHBlbmQoJ3N2ZzpkZWZzJyk7XG4gICAgICAgICAgICAgICAgZGVmcy5hcHBlbmQoJ3N2ZzptYXJrZXInKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignaWQnLCAnZW5kLWFycm93JylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ2aWV3Qm94XCIsIFwiMCAtNSAxMCAxMFwiKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcInJlZlhcIiwgMjApXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwicmVmWVwiLCAtMSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJtYXJrZXJXaWR0aFwiLCA2KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcIm1hcmtlckhlaWdodFwiLCA2KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcIm9yaWVudFwiLCBcImF1dG9cIilcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChcInBhdGhcIilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJkXCIsIFwiTTAsLTVMMTAsMEwwLDVcIik7XG5cbiAgICAgICAgICAgICAgICAvLyBkZWZpbmUgYXJyb3cgbWFya2VycyBmb3IgbGVhZGluZyBhcnJvd1xuICAgICAgICAgICAgICAgIGRlZnMuYXBwZW5kKCdzdmc6bWFya2VyJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2lkJywgJ21hcmstZW5kLWFycm93JylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3ZpZXdCb3gnLCAnMCAtNSAxMCAxMCcpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdyZWZYJywgNylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ21hcmtlcldpZHRoJywgMy41KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignbWFya2VySGVpZ2h0JywgMy41KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignb3JpZW50JywgJ2F1dG8nKVxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCdzdmc6cGF0aCcpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdkJywgJ00wLC01TDEwLDBMMCw1Jyk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnID0gc3ZnO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdHID0gc3ZnLmFwcGVuZChcImdcIilcbiAgICAgICAgICAgICAgICAgICAgLmNsYXNzZWQodGhpc0dyYXBoLmNvbnN0cy5ncmFwaENsYXNzLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnRyA9IHRoaXNHcmFwaC5zdmdHO1xuXG4gICAgICAgICAgICAgICAgLy8gc3ZnIG5vZGVzIGFuZCBsaW5rcyBcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHMgPSBzdmdHLmFwcGVuZChcImdcIikuc2VsZWN0QWxsKFwiZ1wiKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY2lyY2xlcyA9IHN2Z0cuYXBwZW5kKFwiZ1wiKS5zZWxlY3RBbGwoXCJnXCIpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0Tm9kZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdExpbmtzKCk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc2V0UG9zaXRpb25zKCk7XG4gICAgICAgICAgICAgICAgdmFyIHJlc2l6ZUZ1bmMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm9uV2luZG93UmVzaXplKHN2Zyk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5iaW5kaW5ncyA9IHtcbiAgICAgICAgICAgICAgICAgICAgcmVzaXplOnJlc2l6ZUZ1bmNcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICQod2luZG93KS5yZXNpemUocmVzaXplRnVuYyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogY2FsbHMgdGhlIGRlc3Ryb3kgbWV0aG9kIGZvciBhbGwgcG9saWNpZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZGVzdHJveSgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5LmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3kuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdmdQb2xpY3kuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzR3JhcGguYmluZGluZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgJCh3aW5kb3cpLm9mZihrZXksIHRoaXNHcmFwaC5iaW5kaW5nc1trZXldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUnVucyB0aGUgaW5pdCBmdW5jdGlvbiBmb3IgYWxsIHRoZSBub2Rlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbml0Tm9kZXMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBub2RlLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSdW5zIHRoZSBpbml0IGZ1bmN0aW9uIGZvciBhbGwgdGhlIGxpbmtzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluaXRMaW5rcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLmxpbmtzLCBmdW5jdGlvbihsaW5rKSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmsuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIHJldHVybnMgdGhlIG5vZGUgbWF0Y2hpbmcgdGhlIGlkLCBcbiAgICAgICAgICAgICAqIG9yIHVuZGVmaW5lZCBpZiB0aGVyZSBpcyBub25lXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge09iamVjdH0gIGlkICAgICAgVGhlIGlkZW50aWZpZXJcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtOb2RlfSAgeyBtYXRjaGluZyBub2RlIH1cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZmluZE5vZGVCeUlkKGlkKXtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXNHcmFwaC5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaWQgPT09IHRoaXNHcmFwaC5ub2Rlc1tpXS5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNHcmFwaC5ub2Rlc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmV0dXJucyB0aGUgZDNOb2RlIG9iamVjdCB0aGF0IG1hdGNoZXMgdGhlIGlkLFxuICAgICAgICAgICAgICogb3IgdW5kZWZpbmVkIGlmIHRoZXJlIGlzIG5vbmVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgaWQgICAgICBUaGUgaWRlbnRpZmllclxuICAgICAgICAgICAgICogQHJldHVybiAgICAge0QzTm9kZX0gVGhlIGQzIG5vZGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZmluZEQzTm9kZShpZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBkM05vZGU7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZWFjaChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmlkID09PSBpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZDNOb2RlID0gZDMuc2VsZWN0KHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGQzTm9kZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIGluc3RhbGwgYSBkcmFnIHBvbGljeSB0aGF0IHdpbGwgYmUgY2FsbGVkXG4gICAgICAgICAgICAgKiB3aGVuIG5vZGVzIGFyZSBkcmFnZ2VkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzLmJlaGF2aW9yLmRyYWd9ICBkM2RyYWcgIEQzIGRyYWcgb2JqZWN0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluc3RhbGxEcmFnUG9saWN5KGQzZHJhZykge1xuICAgICAgICAgICAgICAgIHRoaXMuZHJhZyA9IGQzZHJhZztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIGluc3RhbGwgYSBwb2xpY3kgdGhhdCB3aWxsIGJlIGNhbGxlZCBcbiAgICAgICAgICAgICAqIHdoZW4gdGhlcmUgaXMgbW91c2UgaW50ZXJhY3Rpb25zIHdpdGggdGhlIGdyYXBoJ3Mgc3ZnXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeSAgVGhlIHBvbGljeSB0byBpbnN0YWxsXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluc3RhbGxTdmdQb2xpY3kocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdmdQb2xpY3kgPSBwb2xpY3k7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byBpbnN0YWxsIHBvbGljaWVzIHRoYXQgYXJlIGNhbGxlZCB3aGVuIHRoZXJlIGlzXG4gICAgICAgICAgICAgKiBtb3VzZSBpbnRlcmFjdGlvbiB3aXRoIGEgbm9kZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3kgIFRoZSBwb2xpY3kgdG8gaW5zdGFsbFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbnN0YWxsRGVmYXVsdE5vZGVQb2xpY3kocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMucHVzaChwb2xpY3kpO1xuICAgICAgICAgICAgICAgIHBvbGljeS5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIHJlbW92ZSBhbiBpbnN0YWxsZWQgcG9saWN5IGZvciBub2Rlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgcG9saWN5UmVtb3ZlICBUaGUgcG9saWN5IHRvIHJlbW92ZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1bmluc3RhbGxEZWZhdWx0Tm9kZVBvbGljeShwb2xpY3lSZW1vdmUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcG9saWN5UmVtb3ZlTmFtZTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHBvbGljeVJlbW92ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlLnBvbGljeU5hbWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5LCBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9saWN5LnBvbGljeU5hbWUgPT09IHBvbGljeVJlbW92ZU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljeS5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmV0dXJucyB0aGUgbm9kZSBwb2xpY3kgb2JqZWN0IHdpdGggdGhlIGdpdmVuIG5hbWVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgcG9saWN5TmFtZSAgVGhlIHBvbGljeSBuYW1lXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7UG9saWN5fSAgcG9saWN5ICAgICAgVGhlIG1hdGNoaW5nIHBvbGljeVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBnZXROb2RlUG9saWN5KHBvbGljeU5hbWUpIHtcbiAgICAgICAgICAgIFx0dmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICBfKHRoaXNHcmFwaC5kZWZhdWx0Tm9kZVBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvbGljeS5wb2xpY3lOYW1lID09PSBwb2xpY3lOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcG9saWN5O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlZCB0byBpbnN0YWxsIHBvbGljaWVzIHRoYXQgYXJlIGNhbGxlZCB3aGVuIHRoZXJlIGlzIGFcbiAgICAgICAgICAgICAqIG1vdXNlIGludGVyYWN0aW9uIHdpdGggYSBwYXRoXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeSAgVGhlIHBvbGljeSB0byBpbnN0YWxsXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluc3RhbGxEZWZhdWx0UGF0aFBvbGljeShwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcy5wdXNoKHBvbGljeSk7XG4gICAgICAgICAgICAgICAgcG9saWN5LmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIHJlbW92ZSBhbiBpbnN0YWxsZWQgcG9saWN5IGZvciBsaW5rc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtQb2xpY3l9ICBwb2xpY3lSZW1vdmUgIFRoZSBwb2xpY3kgdG8gcmVtb3ZlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHVuaW5zdGFsbERlZmF1bHRQYXRoUG9saWN5KHBvbGljeVJlbW92ZSkge1xuICAgICAgICAgICAgICAgIHZhciBwb2xpY3lSZW1vdmVOYW1lO1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcG9saWN5UmVtb3ZlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmUucG9saWN5TmFtZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3ksIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb2xpY3kucG9saWN5TmFtZSA9PT0gcG9saWN5UmVtb3ZlTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9saWN5LmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kZWZhdWx0UGF0aFBvbGljaWVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGVyZSBpcyBhIG1vdXNlIGludGVyYWN0aW9uIHdpdGggYSBwYXRoXG4gICAgICAgICAgICAgKiBQcm9wb2dhdGVzIHRoZSBldmVudCB0byBhbGwgaW5zdGFsbGVkIHBhdGggcG9saWNpZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgZXZlbnQgICBUaGUgZXZlbnQgdHlwZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2Qzb2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BhdGh9ICBkICAgICAgIFRoZSBtYXRjaGluZyBMaW5rIG9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBwYXRoUG9saWN5RXZlbnQoZXZlbnQsIGQzcGF0aCwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHRQYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVtldmVudF0oZDNwYXRoLCBkKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZXJlIGlzIGEgbW91c2UgaW50ZXJhY3Rpb24gd2l0aCBhIG5vZGVcbiAgICAgICAgICAgICAqIFByb3BvZ2F0ZXMgdGhlIGV2ZW50IHRvIGFsbCBpbnN0YWxsZWQgbm9kZSBwb2xpY2llc1xuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgZXZlbnQgICBUaGUgZXZlbnQgdHlwZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2Qzb2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BhdGh9ICBkICAgICAgIFRoZSBtYXRjaGluZyBOb2RlIG9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBub2RlUG9saWN5RXZlbnQoZXZlbnQsIGQzbm9kZSwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcywgZnVuY3Rpb24ocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVtldmVudF0oZDNub2RlLCBkKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNldHMgcGFuIGFuZCB6b29tIHJ1bGVzIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7ZDMuYmVoYXZpb3Iuem9vbX0gIGQzem9vbSAgRDMgem9vbSBvYmpcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5zdGFsbFpvb21Qb2xpY3koZDN6b29tKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kcmFnU3ZnID0gZDN6b29tO1xuICAgICAgICAgICAgICAgIHRoaXMuc3ZnLmNhbGwodGhpcy5kcmFnU3ZnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgd2luZG93IGlzIHJlc2l6ZWRcbiAgICAgICAgICAgICAqIEhvb2sgZm9yIG92ZXJyaWRpbmcgaW4gc3ViY2xhc3Nlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtIVE1MIFNWR30gIHN2ZyAgICAgVGhlIHN2ZyB0aGF0IHRoZSBoYW5kbGVyXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzIGF0dGFjaGVkIHRvXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIG9uV2luZG93UmVzaXplKHN2Zykge31cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBJbnNlcnRzIGxpbmUgYnJlYWtzIGluIG5vZGUgdGV4dFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtIVE1MIEVsZW19ICBnRWwgICAgVGhlIGVsZW0gdG8gYWRkIHRleHQgdG9cbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICB0aXRsZSAgIFRoZSB0aXRsZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbnNlcnRUaXRsZUxpbmVicmVha3MgKGdFbCwgdGl0bGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgd29yZHMgPSB0aXRsZS5zcGxpdCgvXFxzKy9nKSxcbiAgICAgICAgICAgICAgICAgICAgbndvcmRzID0gd29yZHMubGVuZ3RoO1xuICAgICAgICAgICAgICAgIHZhciBlbCA9IGdFbC5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsIHRoaXNHcmFwaC5jb25zdHMubm9kZVRleHQpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwidGV4dC1hbmNob3JcIixcIm1pZGRsZVwiKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcImR5XCIsIFwiLVwiICsgKG53b3Jkcy0xKSo3LjUpO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB3b3Jkcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdHNwYW4gPSBlbC5hcHBlbmQoJ3RzcGFuJykudGV4dCh3b3Jkc1tpXSk7XG4gICAgICAgICAgICAgICAgaWYgKGkgPiAwKVxuICAgICAgICAgICAgICAgICAgICB0c3Bhbi5hdHRyKCd4JywgMCkuYXR0cignZHknLCAnMTUnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlcyBhbGwgbGlua3MgZnJvbSB0aGUgZ2l2ZW4gbm9kZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzcGxpY2VMaW5rc0Zvck5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICB0b1NwbGljZSA9IHRoaXNHcmFwaC5saW5rcy5maWx0ZXIoZnVuY3Rpb24obCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsLnNvdXJjZSA9PT0gbm9kZSB8fCBsLnRhcmdldCA9PT0gbm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRvU3BsaWNlLm1hcChmdW5jdGlvbihsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcy5zcGxpY2UodGhpc0dyYXBoLmxpbmtzLmluZGV4T2YobCksIDEpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEFkZHMgdGhlIG5vZGUgdG8gdGhlIGdyYXBoIGFuZCB1cGRhdGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICBub2RlICAgIFRoZSBub2RlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGFkZE5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgIG5vZGUuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmVzIHRoZSBub2RlIHRvIHRoZSBncmFwaCBhbmQgdXBkYXRlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbm9kZSAgICBUaGUgbm9kZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICByZW1vdmVOb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMuc3BsaWNlKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG5vZGUpLCAxKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3BsaWNlTGlua3NGb3JOb2RlKG5vZGUpO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEFkZHMgdGhlIGxpbmsgdG8gdGhlIGdyYXBoIGFuZCB1cGRhdGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2xpbmt9ICBsaW5rICAgIFRoZSBsaW5rXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGFkZExpbmsobGluaykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcy5wdXNoKGxpbmspO1xuICAgICAgICAgICAgICAgIGxpbmsuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmVzIHRoZSBsaW5rIHRvIHRoZSBncmFwaCBhbmQgdXBkYXRlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtsaW5rfSAgbGluayAgICBUaGUgbGlua1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICByZW1vdmVMaW5rKGxpbmspIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3Muc3BsaWNlKHRoaXNHcmFwaC5saW5rcy5pbmRleE9mKGxpbmspLCAxKTtcbiAgICAgICAgICAgICAgICBsaW5rLmluaXRpYWxpemUodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgdXBkYXRpbmcgZXhpc3RpbmcgcGF0aHNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7UGF0aH0gIHBhdGhzICAgTGlzdCBvZiBwYXRoc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1cGRhdGVFeGlzdGluZ1BhdGhzKHBhdGhzKSB7XG4gICAgICAgICAgICAgICAgcGF0aHMuZWFjaChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgIGQudXBkYXRlQXR0cihkMy5zZWxlY3QodGhpcyksIGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyBhZGRpbmcgbmV3IHBhdGhzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge1BhdGh9ICBuZXdQYXRocyAgTGlzdCBvZiBuZXcgcGF0aHNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlTmV3UGF0aHMobmV3UGF0aHMpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0TGlua3MoKTtcblxuICAgICAgICAgICAgICAgIG5ld1BhdGhzLmVhY2goZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICBkLm5ld1BhdGhBdHRyKGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvL2lmIG5vZGUgZG9lc24ndCBoYXZlIGl0cyBvd24gcG9saWN5LCB1c2UgZGVmYXVsdCBmb3IgdGhlIGdyYXBoXG4gICAgICAgICAgICAgICAgbmV3UGF0aHMub24oXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlb3ZlclwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlb3ZlclwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiZGJsY2xpY2tcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJkYmxjbGlja1wiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcImRibGNsaWNrXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJjb250ZXh0bWVudVwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnBhdGhQb2xpY3lFdmVudChcImNvbnRleHRtZW51XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aFBvbGljeUV2ZW50KFwiY29udGV4dG1lbnVcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcIm1vdXNlb3V0XCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5wYXRoUG9saWN5RXZlbnQoXCJtb3VzZW91dFwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlb3V0XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlZG93blwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcIm1vdXNlZG93blwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwibW91c2V1cFwiLCBmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQucGF0aFBvbGljeUV2ZW50KFwibW91c2V1cFwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhQb2xpY3lFdmVudChcIm1vdXNldXBcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5jYWxsKHRoaXNHcmFwaC5kcmFnKTtcbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyB1cGRhdGluZyBleGlzdGluZyBub2Rlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1cGRhdGVFeGlzdGluZ05vZGVzKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzID0gdGhpcy5jaXJjbGVzLmRhdGEodGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbihkKXsgcmV0dXJuIGQuaWQ7fSlcbiAgICAgICAgICAgICAgICAgICAgLmVhY2goZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC51cGRhdGVBdHRyKGQzLnNlbGVjdCh0aGlzKSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIGdyYXBoIGlzIGFkZGluZyBuZXcgbm9kZXNcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5ld05vZGVzICBMaXN0IG9mIG5ldyBub2Rlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1cGRhdGVOZXdOb2RlcyhuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgbmV3Tm9kZXMuZWFjaChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmdyYXBoID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuaW5pdGlhbGl6ZSh0aGlzR3JhcGgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGQubmV3Tm9kZUF0dHIoZDMuc2VsZWN0KHRoaXMpLCBkKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vaWYgbm9kZSBkb2Vzbid0IGhhdmUgaXRzIG93biBwb2xpY3ksIHVzZSBkZWZhdWx0IGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAgICBuZXdOb2Rlcy5vbihcIm1vdXNlb3ZlclwiLCBmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQubm9kZVBvbGljeUV2ZW50KFwibW91c2VvdmVyXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwibW91c2VvdmVyXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJkYmxjbGlja1wiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcImRibGNsaWNrXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwiZGJsY2xpY2tcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcImNvbnRleHRtZW51XCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQubm9kZVBvbGljeUV2ZW50KFwiY29udGV4dG1lbnVcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlUG9saWN5RXZlbnQoXCJjb250ZXh0bWVudVwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwibW91c2VvdXRcIiwgZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5oYXNQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLm5vZGVQb2xpY3lFdmVudChcIm1vdXNlb3V0XCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwibW91c2VvdXRcIiwgZDMuc2VsZWN0KHRoaXMpLCBkKTsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcIm1vdXNlZG93blwiLCBmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmhhc1BvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQubm9kZVBvbGljeUV2ZW50KFwibW91c2Vkb3duXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwibW91c2Vkb3duXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZXVwXCIsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGFzUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5ub2RlUG9saWN5RXZlbnQoXCJtb3VzZXVwXCIsIGQzLnNlbGVjdCh0aGlzKSwgZCk7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZVBvbGljeUV2ZW50KFwibW91c2V1cFwiLCBkMy5zZWxlY3QodGhpcyksIGQpOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmNhbGwodGhpc0dyYXBoLmRyYWcpO1xuXG4gICAgICAgICAgICAgICAgbmV3Tm9kZXMuYXBwZW5kKFwiY2lyY2xlXCIpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJyXCIsIGZ1bmN0aW9uKGQpIHtyZXR1cm4gU3RyaW5nKGQucmFkaXVzKX0pO1xuXG5cbiAgICAgICAgICAgICAgICBuZXdOb2Rlcy5lYWNoKGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5zZXJ0VGl0bGVMaW5lYnJlYWtzKGQzLnNlbGVjdCh0aGlzKSwgZC50ZXh0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBQcmV2ZW50cyBub2RlcyBmcm9tIGNvbGxpZGluZ1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICBhbHBoYSAgIEFmZmVjdHMgaG93IG11Y2ggY2hhbmdlXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGUgY29sbGlzaW9uIGNhdXNlc1xuICAgICAgICAgICAgICogQHJldHVybiAgICAge2Jvb2xlYW59ICB7V2hldGhlciBub2RlcyBhcmUgY29sbGlkZWR9XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGQzRm9yY2VDb2xsaWRlKGFscGhhKSB7XG4gICAgICAgICAgICBcdHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgXHRcdGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHM7XG4gICAgICAgICAgICBcdHZhciBub2RlcyA9IHRoaXNHcmFwaC5ub2RlcztcbiAgICAgICAgICAgIFx0dmFyIHF1YWR0cmVlID0gZDMuZ2VvbS5xdWFkdHJlZShub2Rlcyk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByID0gZC5yYWRpdXMgKyBjb25zdHMubWF4UmFkaXVzICsgY29uc3RzLnBhZGRpbmcsXG4gICAgICAgICAgICAgICAgICAgICAgICBueDEgPSBkLnggLSByLFxuICAgICAgICAgICAgICAgICAgICAgICAgbngyID0gZC54ICsgcixcbiAgICAgICAgICAgICAgICAgICAgICAgIG55MSA9IGQueSAtIHIsXG4gICAgICAgICAgICAgICAgICAgICAgICBueTIgPSBkLnkgKyByO1xuICAgICAgICAgICAgICAgICAgICBxdWFkdHJlZS52aXNpdChmdW5jdGlvbihxdWFkLCB4MSwgeTEsIHgyLCB5Mikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHF1YWQucG9pbnQgJiYgKHF1YWQucG9pbnQgIT09IGQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHggPSBkLnggLSBxdWFkLnBvaW50LngsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHkgPSBkLnkgLSBxdWFkLnBvaW50LnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwgPSBNYXRoLnNxcnQoeCAqIHggKyB5ICogeSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIgPSBkLnJhZGl1cyArIHF1YWQucG9pbnQucmFkaXVzICsgY29uc3RzLnBhZGRpbmc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGwgPCByKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsID0gKGwgLSByKSAvIGwgKiBhbHBoYTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueCAtPSB4ICo9IGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgLT0geSAqPSBsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVhZC5wb2ludC54ICs9IHg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWFkLnBvaW50LnkgKz0geTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHgxID4gbngyIHx8IHgyIDwgbngxIHx8IHkxID4gbnkyIHx8IHkyIDwgbnkxO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRpY2sgb2YgdGhlIGQzIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDN0aWNrIGV2ZW50fSAgZSAgICBEM3RpY2sgZXZlbnRcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB3aWR0aCAgVGhlIHdpZHRoIG9mIHRoZSBzaW11bGF0aW9uXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgaGVpZ2h0IFRoZSBoZWlnaHQgb2YgdGhlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZVRpY2soZSwgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgXHR2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgIFx0XHRjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzO1xuXG4gICAgICAgICAgICBcdHZhciBvZmZzZXQgPSBjb25zdHMuZGlzcGxheU9mZnNldDtcdFxuICAgICAgICAgICAgXHR2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICBcdHZhciBxID0gZDMuZ2VvbS5xdWFkdHJlZSh0aGlzR3JhcGgubm9kZXMpLFxuICAgICAgICAgICAgICAgICAgICAgIGkgPSAwLFxuICAgICAgICAgICAgICAgICAgICAgIG4gPSBub2Rlcy5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICAgIHdoaWxlICgrK2kgPCBuKSB7XG4gICAgICAgICAgICAgICAgICAgIHEudmlzaXQodGhpcy5kM0ZvcmNlQ29sbGlkZShub2Rlc1tpXSkpO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZWFjaCh0aGlzLmQzRm9yY2VDb2xsaWRlKC41KSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJjeFwiLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnggPSBNYXRoLm1heChkLnJhZGl1cyArIG9mZnNldCwgTWF0aC5taW4od2lkdGggLSBvZmZzZXQgLSBkLnJhZGl1cywgZC54KSk7IH0pXG4gICAgICAgICAgICAgICAgICAgICAuYXR0cihcImN5XCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQueSA9IE1hdGgubWF4KGQucmFkaXVzICsgb2Zmc2V0LCBNYXRoLm1pbihoZWlnaHQgLSBvZmZzZXQgLSBkLnJhZGl1cywgZC55KSk7IH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd4MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLnk7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd4MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lnk7IH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFN0YXJ0cyBvbiBzdGFydCBvZiB0aGUgZm9yY2Ugc2ltdWxhdGlvblxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkM0ZvcmNlU3RhcnQoKSB7XG4gICAgICAgICAgICBcdHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoc1xuICAgICAgICAgICAgICAgICAgICAuYXR0cigneDEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS55OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneDInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC55OyB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgb24gdGhlIGVuZCBvZiB0aGUgZm9yY2Ugc2ltdWxhdGlvblxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkM0ZvcmNlRW5kKCkge1xuICAgICAgICAgICAgXHR2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgIFx0dGhpc0dyYXBoLmNpcmNsZXNcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2N4JywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY3knLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnk7IH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzLmF0dHIoJ3gxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueTsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueTsgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsY3VsYXRlcyB0aGUgd2lkdGggYW5kIGhlaWdodCBib3VuZHMgZm9yIHRoZSBcbiAgICAgICAgICAgICAqIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7T2JqZWN0fSAgd2lkdGggYW5kIGhlaWdodCBhcyBwcm9wZXJ0aWVzIFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkM0ZvcmNlQm91bmRzKCkge1xuICAgICAgICAgICAgICAgIHZhciBzdmdXaWR0aCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykud2lkdGgoKTtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnSGVpZ2h0ID0gJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS5oZWlnaHQoKTtcblxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IHN2Z1dpZHRoO1xuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBzdmdIZWlnaHQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHt3aWR0aDp3aWR0aCwgaGVpZ2h0OmhlaWdodH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogRG9lcyBhIGQzIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RnVuY3Rpb259ICBjYWxsYmFjayAgVGhlIGNhbGxiYWNrXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNldEZvcmNlKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICAgICAgdmFyIGxpbmtzID0gdGhpc0dyYXBoLmxpbmtzO1xuICAgICAgICAgICAgICAgIGlmIChfLmlzRW1wdHkobm9kZXMpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgYm91bmRzID0gdGhpc0dyYXBoLmQzRm9yY2VCb3VuZHMoKTtcblxuICAgICAgICAgICAgICAgIHZhciBmb3JjZSA9IGQzLmxheW91dC5mb3JjZSgpXG4gICAgICAgICAgICAgICAgICAgIC5zaXplKFtib3VuZHMud2lkdGgsIGJvdW5kcy5oZWlnaHRdKVxuICAgICAgICAgICAgICAgICAgICAubm9kZXMobm9kZXMpXG4gICAgICAgICAgICAgICAgICAgIC5jaGFyZ2UoZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC02MDAwO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAubGlua3MobGlua3MpO1xuXG4gICAgICAgICAgICAgICAgZm9yY2UubGlua0Rpc3RhbmNlKGJvdW5kcy53aWR0aC8zKTtcbiAgICAgICAgICAgICAgICBmb3JjZS5saW5rU3RyZW5ndGgoLjIpO1xuICAgICAgICAgICAgICAgIGZvcmNlLmdyYXZpdHkoLjIpO1xuXG4gICAgICAgICAgICAgICAgZm9yY2Uub24oJ3RpY2snLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgXHR0aGlzR3JhcGguZDNGb3JjZVRpY2suY2FsbCh0aGlzR3JhcGgsIFxuICAgICAgICAgICAgICAgIFx0XHRcdGUsIGJvdW5kcy53aWR0aCwgYm91bmRzLmhlaWdodCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBmb3JjZS5vbignc3RhcnQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBcdHRoaXNHcmFwaC5kM0ZvcmNlU3RhcnQuY2FsbCh0aGlzR3JhcGgpXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBmb3JjZS5vbignZW5kJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgXHR0aGlzR3JhcGguZDNGb3JjZUVuZC5jYWxsKHRoaXNHcmFwaClcbiAgICAgICAgICAgICAgICB9KTsgXG5cblxuICAgICAgICAgICAgICAgIGZvcmNlLnN0YXJ0KCk7XG4gICAgICAgICAgICAgICAgdmFyIGsgPSAwO1xuICAgICAgICAgICAgICAgIHdoaWxlICgoZm9yY2UuYWxwaGEoKSA+IDFlLTIpICYmIChrIDwgMTUwKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3JjZS50aWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIGsgPSBrICsgMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yY2Uuc3RvcCgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBcdGNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNldHMgdGhlIHBvc2l0aW9ucyB0byBiZSB0aGUgY2VudGVyIG9mIHRoZSBzY3JlZW4gaWYgXG4gICAgICAgICAgICAgKiBub3QgcHJvdmlkZWRcbiAgICAgICAgICAgICAqIGFsc28gc2V0cyB0aGUgcmFkaXVzIG9mIHRoZSBub2Rlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzZXRQb3NpdGlvbnMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gdGhpc0dyYXBoLmNvbnN0cy5kaXNwbGF5T2Zmc2V0O1xuICAgICAgICAgICAgICAgIHZhciBzdmdXaWR0aCA9ICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykud2lkdGgoKTtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnSGVpZ2h0ID0gJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS5oZWlnaHQoKTtcblxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IHN2Z1dpZHRoIC0gKDIqb2Zmc2V0KTtcbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gc3ZnSGVpZ2h0IC0gKDIqb2Zmc2V0KTtcblxuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXNHcmFwaC5ub2RlcztcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZXNbaV0ucmFkaXVzID0gbm9kZXNbaV0ucmFkaXVzIHx8IHRoaXNHcmFwaC5jb25zdHMuc3RhcnRSYWRpdXM7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2Rlc1tpXS54ID09IG51bGwgfHwgbm9kZXNbaV0ueSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBub2Rlc1tpXS54U3RhcnQgPSB3aWR0aC8yICArIG5vZGVzW2ldLnJhZGl1cyArIG9mZnNldFxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNbaV0ueCA9IHdpZHRoLzIgICsgbm9kZXNbaV0ucmFkaXVzICsgb2Zmc2V0O1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm9kZXNbaV0ueVN0YXJ0ID0gaGVpZ2h0LzIgKyBub2Rlc1tpXS5yYWRpdXMgKyBvZmZzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzW2ldLnkgPSBoZWlnaHQvMiArIG5vZGVzW2ldLnJhZGl1cyArIG9mZnNldFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB0byB1cGRhdGUgdGhlIHZpZXcgb2YgdGhlIGdyYXBoIHdoZW5cbiAgICAgICAgICAgICAqIGRhdGEgY2hhbmdlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtGdW5jdGlvbn0gIGNhbGxiYWNrICBUaGUgY2FsbGJhY2tcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlR3JhcGgoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGU7XG5cbiAgICAgICAgICAgIFx0aWYgKHRoaXNHcmFwaC5zdGF0ZS5kaXNhYmxlVXBkYXRlKSB7XG4gICAgICAgICAgICBcdFx0cmV0dXJuO1xuICAgICAgICAgICAgXHR9XG5cbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUV4aXN0aW5nTm9kZXMoKTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3R3M9IHRoaXNHcmFwaC5jaXJjbGVzLmVudGVyKClcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChcImdcIik7XG5cbiAgICAgICAgICAgIFx0Ly8gY29uc29sZS5sb2coJ3VwZGF0ZScsIG5ld0dzKTtcbiAgICAgICAgICAgICAgICBuZXdHcy5jbGFzc2VkKGNvbnN0cy5jaXJjbGVHQ2xhc3MsIHRydWUpO1xuICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gdGhpcy51cGRhdGVOZXdOb2RlcyhuZXdHcyk7XG5cbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgb2xkIG5vZGVzXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZXhpdCgpLnJlbW92ZSgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmluaXRGb3JjZSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc2V0Rm9yY2UoZnVuY3Rpb24oKSB7XG4gICAgXHQgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZU5ld05vZGVzLmNhbGwodGhpc0dyYXBoLCBuZXdHcyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5pbml0Rm9yY2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZU5ld05vZGVzKG5ld0dzKTtcblx0ICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnBhdGhzID0gdGhpc0dyYXBoLnBhdGhzLmRhdGEodGhpc0dyYXBoLmxpbmtzLCBmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFN0cmluZyhkLnNvdXJjZS5pZCkgKyBcIitcIiArIFN0cmluZyhkLnRhcmdldC5pZCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdmFyIHBhdGhzID0gdGhpc0dyYXBoLnBhdGhzO1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRXhpc3RpbmdQYXRocyhwYXRocyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbmV3cGF0aHMgPSBwYXRocy5lbnRlcigpXG4gICAgICAgICAgICAgICAgLmFwcGVuZChcInBhdGhcIilcbiAgICAgICAgICAgICAgICAuc3R5bGUoJ21hcmtlci1lbmQnLCd1cmwoI2VuZC1hcnJvdyknKVxuICAgICAgICAgICAgICAgIC5jbGFzc2VkKFwibGlua1wiLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZU5ld1BhdGhzKG5ld3BhdGhzKTtcblxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBvbGQgbGlua3NcbiAgICAgICAgICAgICAgICBwYXRocy5leGl0KCkucmVtb3ZlKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIFx0Y2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBHcmFwaDogR3JhcGhcbiAgICAgICAgfVxufV0pO1xuXG5cbiIsIi8qKlxuICogVGhlIGdyYXBoIHRoYXQgaXMgdXNlZCBzcGVjaWZpY2FsbHkgZm9yIHRoZSB2aXN1YWxpemF0aW9uIHRhYi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ1Zpc3VhbGl6ZXJHcmFwaCcsIFsnR3JhcGgnLCBmdW5jdGlvbiAoR3JhcGgpIHtcbiAgICBcdGNsYXNzIFZpc3VhbGl6ZXJHcmFwaCBleHRlbmRzIEdyYXBoLkdyYXBoIHtcbiAgICBcdFx0LyoqXG4gICAgXHRcdCAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cbiAgICBcdFx0ICpcbiAgICBcdFx0ICogQHBhcmFtICAge0hUTUwgU1ZHfSAgc3ZnICAgICAgICAgICAgIFRoZSBzdmcgdGhhdCB3aWxsIFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvbGQgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKiBAcGFyYW0gICB7QXJyYXl9ICBub2RlcyAgIFx0XHQgICAgTGlzdCBvZiBub2Rlc1xuICAgICAgICAgICAgICogQHBhcmFtICAge0FycmF5fSAgbGlua3MgICBcdFx0ICAgIExpc3Qgb2YgbGlua3NcbiAgICBcdFx0ICogQHBhcmFtICAge0RhdGFTb3VyY2V9ICBkYXRhU291cmNlICAgIFRoZSBkYXRhIHNvdXJjZVxuICAgIFx0XHQgKi9cbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHN2Zywgbm9kZXMsIGxpbmtzLCBkYXRhU291cmNlKSB7XG4gICAgICAgICAgICAgICAgc3VwZXIoc3ZnLCBub2RlcywgbGlua3MpO1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgLy9ob2xkcyBjdXJyZW50IHRyYW5zaXRpb25zIHRoYXQgYXJlIG9jY3VyaW5nXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN0YXRlLnRyYW5zaXRpb24gPSBbXTtcbiAgICAgICAgICAgICAgICAvL01pbiBkaXN0YW5jZSBiZXR3ZWVuIG5vZGVzIHdoZW4gc3Bhd25pbmcgcmFuZG9tbHlcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY29uc3RzLmVkZ2VfYnVmZmVyID0gMjAwO1xuICAgICAgICAgICAgICAgIC8vU2l6ZSByZWR1Y3Rpb24gYXMgeW91IGdvIHRocm91Z2ggbGV2ZWxzIGluIG5vZGVzXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNvbnN0cy5yYWRpdXNEZWNheSA9IDE7XG4gICAgICAgICAgICAgICAgLy9Dc3MgY2xhc3MgZm9yIG5vZGVzIHRoYXQgYXJlIGNvbnRhaW5lcnNcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguY29uc3RzLmNvbnRhaW5lckNsYXNzID0gJ2NvbnRhaW5lcic7XG5cbiAgICAgICAgICAgICAgICAvL2RhdGFTb3VyY2UgaG9sZHMgdGhlIHNlcnZlciBkYXRhIGFuZCBtZXRob2RzIGZvclxuICAgICAgICAgICAgICAgIC8vY29udmVydGluZyBpdCB0byBkYXRhIGZvciB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguZGF0YVNvdXJjZSA9IGRhdGFTb3VyY2U7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy9EcmFnIGJlaGF2aW9yIGZvciBub2Rlc1xuICAgICAgICAgICAgICAgIHZhciBkcmFnID0gZDMuYmVoYXZpb3IuZHJhZygpXG4gICAgICAgICAgICAgICAgICAgIC5vcmlnaW4oZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7eDogZC54LCB5OiBkLnl9O1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJkcmFnc3RhcnRcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcImRyYWdcIiwgZnVuY3Rpb24oYXJncyl7XG4gICAgICAgICAgICAgICAgICAgIFx0ZDMuc2VsZWN0KCB0aGlzKS5hdHRyKFwidHJhbnNmb3JtXCIsIGZ1bmN0aW9uKCBkLCBpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC54ICs9IGQzLmV2ZW50LmR4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSArPSBkMy5ldmVudC5keTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJ0cmFuc2xhdGUoXCIgKyBbIGQueCxkLnkgXSArIFwiKVwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1x0XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbihcImRyYWdlbmRcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRyYWcgPSBkcmFnO1xuXG4gICAgICAgICAgICAgICAgLy9QYW4gYW5kIFpvb20gYmVoYXZpb3IgZm9yIHRoZSBncmFwaFxuICAgICAgICAgICAgICAgIHZhciB6b29tID0gZDMuYmVoYXZpb3Iuem9vbSgpXG4gICAgICAgICAgICAgICAgICAgIC5vbihcInpvb21cIiwgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkMy5ldmVudC5zb3VyY2VFdmVudCAhPSBudWxsICYmIGQzLmV2ZW50LnNvdXJjZUV2ZW50LmN0cmxLZXkpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguem9vbWVkLmNhbGwodGhpc0dyYXBoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJ6b29tc3RhcnRcIiwgZnVuY3Rpb24oZCwgaSl7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5kcmFnU3ZnID0gem9vbTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3ZnLmNhbGwoem9vbSkub24oXCJkYmxjbGljay56b29tXCIsIG51bGwpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aXRoIG5vIGFyZ3Mgd2hlbiB0aGUgZ3JhcGggaGFzIGEgem9vbSBhY3Rpb25cbiAgICAgICAgICAgICAqIENhbiBhbHNvIGJlIGNhbGxlZCB3aXRoIGFyZ3MgdG8gZm9yY2UgYSB6b29tIG9yIHBhbiBcbiAgICAgICAgICAgICAqIGV2ZW50IGZvciB0aGUgZ3JhcGguXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgIHRyYW5zbGF0ZSAgVGhlIGFtb3VudCB0byB0cmFuc2xhdGVcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICBzY2FsZSAgICAgIFRoZSBhbW91bnQgdG8gc2NhbGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgem9vbWVkKHRyYW5zbGF0ZSwgc2NhbGUpe1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzR3JhcGguc3RhdGUucmlnaHRDbGljayA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5qdXN0U2NhbGVUcmFuc0dyYXBoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpZiAodHJhbnNsYXRlICE9IG51bGwgJiYgc2NhbGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbSA9IHRoaXNHcmFwaC5kcmFnU3ZnO1xuICAgICAgICAgICAgICAgICAgICB6b29tLnNjYWxlKHNjYWxlKTtcbiAgICAgICAgICAgICAgICAgICAgem9vbS50cmFuc2xhdGUodHJhbnNsYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgLy9jcmVhdGluZyBuYW1lcyB0byBwcmV2ZW50IHRyYW5zaXRpb24gY29uZmxpY3RzXG4gICAgICAgICAgICAgICAgICAgIHZhciB6b29tU2V0Q2FsbGJhY2sgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgXHR6b29tLnNjYWxlKHNjYWxlKTtcbiAgICAgICAgICAgICAgICAgICAgXHR6b29tLnRyYW5zbGF0ZSh0cmFuc2xhdGUpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB2YXIgdHJhbnNsYXRlX25hbWUgPSBcInpvb21cIiArIHRyYW5zbGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KFwiLlwiICsgdGhpcy5jb25zdHMuZ3JhcGhDbGFzcykudHJhbnNpdGlvbih0cmFuc2xhdGVfbmFtZSkuZGVsYXkoMTAwKS5kdXJhdGlvbig3NTApXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZSgnICsgem9vbS50cmFuc2xhdGUoKSArICcpIHNjYWxlKCcgKyB6b29tLnNjYWxlKCkgKyAnKScpLmVhY2goXCJlbmRcIiwgem9vbVNldENhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH0gXG4gICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5zdGF0ZS5jYW5ab29tKSB7XG4gICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdChcIi5cIiArIHRoaXMuY29uc3RzLmdyYXBoQ2xhc3MpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArIHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpICsgXCIpIHNjYWxlKFwiICt0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpICsgXCIpXCIpOyBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSB3aW5kb3cgcmVzaXplc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtIVE1MIFNWR30gIHN2ZyAgICBUaGUgc3ZnIHRvIHJlc2l6ZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBvbldpbmRvd1Jlc2l6ZShzdmcpIHtcbiAgICAgICAgICAgICAgICB2YXIgYm9keUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXTtcbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS5vZmZzZXQoKTtcbiAgICAgICAgICAgICAgICB2YXIgZGl2V2lkdGggPSAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpLndpZHRoKCk7XG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IGJvZHlFbC5jbGllbnRIZWlnaHQ7XG4gICAgICAgICAgICAgICAgc3ZnLmF0dHIoXCJ3aWR0aFwiLCBkaXZXaWR0aCkuYXR0cihcImhlaWdodFwiLCBoZWlnaHQgLSBvZmZzZXQudG9wIC0gMjApO1xuXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBzZXJ2ZXIgc2VuZHMgdXBkYXRlZCBkYXRhIGZvciB0aGUgbGlua3NcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlTGlua0RhdGEoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVfbmFtZXNfc2V0ID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZV9uYW1lc19zZXQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0uaWQpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciByZXREYXRhID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuZ2V0Rmxvd0JldHdlZW5TZXQobm9kZV9uYW1lc19zZXQpO1xuICAgICAgICAgICAgICAgIHZhciBsaW5rRGF0YSA9IHJldERhdGEubGlua0RhdGE7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UucHJvY2Vzc0xpbmtEYXRhKGxpbmtEYXRhLCB0aGlzR3JhcGgubm9kZXMpO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5pdE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5pbml0TGlua3MoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgR3JhcGg6IFZpc3VhbGl6ZXJHcmFwaFxuICAgICAgICB9XG59XSk7XG5cblxuXG4iLCIvKipcbiAqIFRoZSBiYXNlIGNsYXNzIGZvciBsaW5rIG9iamVjdHMgZm9yIHRoZSBncmFwaC5cbiAqIFN1cHBvcnRzIHBvbGljaWVzLlxuICogXG4gKiBUbyB3cml0ZSB5b3VyIG93biBsaW5rIG9iamVjdCwgY3JlYXRlIGEgbmV3IGZhY3RvcnkgdGhhdCB1c2VzIHRoZSBsaW5rXG4gKiB5b3Ugd2FudCB0byBpbmhlcml0IGFzIGEgZGVwZW5kZW5jeSwgYW5kIGV4dGVuZCBpdHMgbGluayBjbGFzcy4gXG4gKiBSZXR1cm4gdGhlIGNsYXNzIG9iamVjdCB3aXRoIExpbmsgYXMga2V5XG4gKiBcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ0xpbmsnLCBbZnVuY3Rpb24gKCkge1xuICAgIFx0Y2xhc3MgTGluayB7XG4gICAgXHRcdC8qKlxuICAgIFx0XHQgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgXHRcdCAqXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtOb2RlfSAgc291cmNlTm9kZSAgVGhlIHNvdXJjZSBub2RlXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtOb2RlfSAgdGFyZ2V0Tm9kZSAgVGhlIHRhcmdldCBub2RlXG4gICAgXHRcdCAqL1xuXHRcdFx0Y29uc3RydWN0b3Ioc291cmNlTm9kZSwgdGFyZ2V0Tm9kZSkge1xuXHRcdFx0XHR0aGlzLnNvdXJjZSA9IHNvdXJjZU5vZGU7XG5cdFx0XHRcdHRoaXMudGFyZ2V0ID0gdGFyZ2V0Tm9kZTtcblx0XHRcdFx0dGhpcy5oYXNQb2xpY3kgPSBmYWxzZTtcblx0XHRcdFx0dGhpcy5wYXRoUG9saWNpZXMgPSBbXTtcblx0XHRcdFx0dGhpcy5ncmFwaCA9IG51bGw7XG5cdFx0XHRcdHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxsZWQgd2hlbiBhIGxpbmsgaXMgYWRkZWQgdG8gdGhlIGdyYXBoXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgYWRkZWQgdG9cblx0XHRcdCAqL1xuXHRcdFx0aW5pdGlhbGl6ZShncmFwaCkge1xuXHRcdFx0XHRpZiAodGhpcy5pbml0aWFsaXplZCA9PSBmYWxzZSkge1xuXHRcdFx0XHRcdHRoaXMuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuXHRcdFx0XHRcdHRoaXMuZ3JhcGggPSBncmFwaDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCBkdXJpbmcgdGhlIHVwZGF0ZSBncmFwaCBmb3IgZXhpc3RpbmcgbGlua3Ncblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM3BhdGggIFRoZSBkMyBwYXRoXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7TGlua30gIFx0ICAgZCAgICAgICBNYXRjaGluZyBMaW5rIE9iamVjdCAgICAgICBcblx0XHRcdCAqL1xuXHRcdFx0dXBkYXRlQXR0cihkM3BhdGgsIGQpIHtcblx0XHRcdFx0ZDNwYXRoLnN0eWxlKCdtYXJrZXItZW5kJywgJ3VybCgjZW5kLWFycm93KScpXG5cdFx0ICAgICAgICAgICAgLmF0dHIoXCJkXCIsIGFycm93UGF0aCk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsbGVkIGR1cmluZyB0aGUgZmlyc3QgdXBkYXRlIGdyYXBoIGZvciBhIGxpbmtcblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM3BhdGggIFRoZSBkMyBwYXRoXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7TGlua30gIFx0ICAgZCAgICAgICBNYXRjaGluZyBMaW5rIE9iamVjdCAgICAgICBcblx0XHRcdCAqL1xuXHRcdFx0bmV3UGF0aEF0dHIoZDNwYXRoLCBkKSB7XG5cdFx0XHRcdGQzcGF0aC5hdHRyKCdkJywgYXJyb3dQYXRoKTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxjdWxhdGVzIHRoZSBhcnJvdyBwYXRoXG5cdFx0XHQgKlxuXHRcdFx0ICogQHJldHVybiAgICAge3N0cmluZ30gIFRoZSBwYXRoIHRvIGRyYXdcblx0XHRcdCAqL1xuXHRcdCAgICBhcnJvd1BhdGgoKSB7XG5cdFx0ICAgIFx0dmFyIGQgPSB0aGlzO1xuXHRcdCAgICAgICAgdmFyIGR4ID0gZC50YXJnZXQueCAtIGQuc291cmNlLngsXG5cdFx0ICAgICAgICAgICAgZHkgPSBkLnRhcmdldC55IC0gZC5zb3VyY2UueSxcblx0XHQgICAgICAgICAgICBkciA9IE1hdGguc3FydChkeCAqIGR4ICsgZHkgKiBkeSk7XG5cdFx0ICAgICAgICByZXR1cm4gXCJNXCIgKyBkLnNvdXJjZS54ICsgXCIsXCIgKyBkLnNvdXJjZS55ICsgXCJBXCIgKyBkciArIFwiLFwiICsgZHIgKyBcIiAwIDAsMSBcIiArIGQudGFyZ2V0LnggKyBcIixcIiArIGQudGFyZ2V0Lnk7XG5cdFx0ICAgIH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogVXNlZCB0byBpbnN0YWxsIHBvbGljaWVzIHRoYXQgYXJlIGNhbGxlZCB3aGVuIHRoaXNcblx0XHQgICAgICogbGluayBoYXMgYSBtb3VzZSBldmVudFxuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7UG9saWN5fSAgcG9saWN5ICBUaGUgcG9saWN5IHRvIGluc3RhbGxcblx0XHQgICAgICovXG5cdFx0XHRpbnN0YWxsUGF0aFBvbGljeShwb2xpY3kpIHtcblx0XHRcdFx0dGhpcy5oYXNQb2xpY3kgPSB0cnVlO1xuXHRcdFx0XHR0aGlzLnBhdGhQb2xpY2llcy5wdXNoKHBvbGljeSk7XG5cdFx0XHRcdHBvbGljeS5pbml0aWFsaXplKHRoaXMuZ3JhcGgpO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFVzZWQgdG8gdW5pbnN0YWxsIHBvbGljeSBmb3IgdGhpcyBsaW5rXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge1BvbGljeX0gIHBvbGljeVJlbW92ZSAgVGhlIHBvbGljeSB0byByZW1vdmVcblx0XHRcdCAqL1xuXHRcdFx0dW5pbnN0YWxsUGF0aFBvbGljeShwb2xpY3lSZW1vdmUpIHtcblx0XHRcdFx0dmFyIHBvbGljeVJlbW92ZU5hbWU7XG5cdFx0XHRcdHZhciB0aGlzUGF0aCA9IHRoaXM7XG5cdFx0XHRcdGlmICh0eXBlb2YgcG9saWN5UmVtb3ZlID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRcdHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmU7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cG9saWN5UmVtb3ZlTmFtZSA9IHBvbGljeVJlbW92ZS5wb2xpY3lOYW1lO1xuXHRcdFx0XHR9XG5cdFx0XHRcdF8odGhpc1BhdGgucGF0aFBvbGljaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHBvbGljeSwgaW5kZXgpIHtcblx0XHRcdFx0XHRpZiAocG9saWN5LnBvbGljeU5hbWUgPT09IHBvbGljeVJlbW92ZU5hbWUpIHtcblx0XHRcdFx0XHRcdHBvbGljeS5kZXN0cm95KCk7XG5cdFx0XHRcdFx0XHR0aGlzUGF0aC5wYXRoUG9saWNpZXMuc3BsaWNlKGluZGV4LCAxKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRpZiAodGhpc1BhdGgucGF0aFBvbGljaWVzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0XHRcdHRoaXNQYXRoLmhhc1BvbGljeSA9IGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsbGVkIHdoZW4gdGhlcmUgaXMgYSBtb3VzZSBldmVudCBmb3IgdGhpcyBwYXRoXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge3N0cmluZ30gIGV2ZW50ICAgICBUaGUgbW91c2UgZXZlbnRcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzcGF0aCAgVGhlIGQzIHBhdGhcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBkICAgICAgICAgVGhlIG1hdGNoaW5nIGxpbmsgb2JqZWN0XG5cdFx0XHQgKi9cblx0XHRcdHBhdGhQb2xpY3lFdmVudChldmVudCwgZDNwYXRoLCBkKSB7XG5cdFx0XHRcdF8oZC5wYXRoUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5KSB7XG5cdFx0XHRcdFx0cG9saWN5W2V2ZW50XShkM3BhdGgsIGQpO1xuXHRcdFx0XHR9KVxuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4ge1xuXHRcdFx0TGluazogTGlua1xuXHRcdH1cbn1dKTtcblxuXG5cblxuXG5cbiIsIi8qKlxuICogVGhlIGxpbmsgdGhhdCBpcyB1c2VkIHNwZWNpZmljYWxseSBmb3IgdGhlIHZpc3VhbGl6YXRpb24gdGFiLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnVmlzdWFsaXplckxpbmsnLCBbJ0xpbmsnLCBmdW5jdGlvbiAoTGluaykge1xuXHRcdGNsYXNzIFZpc3VhbGl6ZXJMaW5rIGV4dGVuZHMgTGluay5MaW5rIHtcblx0XHRcdC8qKlxuXHRcdFx0ICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtOb2RlfSAgc291cmNlTm9kZSAgVGhlIHNvdXJjZSBub2RlXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7Tm9kZX0gIHRhcmdldE5vZGUgIFRoZSB0YXJnZXQgbm9kZVxuXHRcdFx0ICogQHBhcmFtICAgICAge251bWJlcn0gIHdlaWdodCAgICBUaGUgd2VpZ2h0IG9mIHRoZSBsaW5rXG5cdFx0XHQgKi9cblx0XHQgICAgY29uc3RydWN0b3Ioc291cmNlTm9kZSwgdGFyZ2V0Tm9kZSwgd2VpZ2h0KSB7XG5cdFx0ICAgICAgICBzdXBlcihzb3VyY2VOb2RlLCB0YXJnZXROb2RlKTtcblx0XHQgICAgICAgIHRoaXMud2VpZ2h0ID0gd2VpZ2h0O1xuXHRcdCAgICAgICAgLy9Db3VudCBpcyB1c2VkIHRvIGtlZXAgdHJhY2sgb2YgaG93IG1hbnlcblx0XHQgICAgICAgIC8vcGF0aHMgdG8gaXRzIHN1Ym5vZGVzIHRoZXJlIGFyZVxuXHRcdCAgICAgICAgLy9pbiBvcmRlciB0byBjYWxjdWxhdGUgYXZlcmFnZSB0cmFmZmljXG5cdFx0ICAgICAgICB0aGlzLmNvdW50ID0gMTtcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBJbmNyZWFzZXMgdGhlIGNvdW50IG9mIHRoZSBsaW5rXG5cdFx0ICAgICAqIFVTZWQgdG8ga2VlcCB0cmFjayBvZiBob3cgbWFueSBwYXRocyB0byBpdHMgc3Vibm9kZXNcblx0XHQgICAgICogdGhlcmUgYXJlIGluIG9yZGVyIHRvIGNhbGN1bGF0ZSBhdmVyYWdlIHRyYWZmaWNcblx0XHQgICAgICovXG5cdFx0ICAgIGluY3JlYXNlQ291bnQoKSB7XG5cdFx0ICAgICAgICB0aGlzLmNvdW50ICs9IDE7XG5cdFx0ICAgIH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogQ2FsY3VsYXRlcyB3aGVyZSB0byBwbGFjZSBxdGlwIGZvclxuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcmV0dXJuICAgICB7T2JqZWN0fSAgT2JqZWN0IHdpdGggcVRpcCBzZXR0aW5nc1xuXHRcdCAgICAgKi9cblx0XHQgICAgcXRpcEhlbHBlcigpIHtcblx0XHQgICAgXHR2YXIgcmV0O1xuXHRcdCAgICBcdHZhciBkID0gdGhpcztcblx0XHQgICAgXHR2YXIgZHggPSAoZC50YXJnZXQueCAtIGQuc291cmNlLngpIC8gMixcblx0XHQgICAgICAgICAgICBkeSA9IChkLnRhcmdldC55IC0gZC5zb3VyY2UueSkgLyAyO1xuXHRcdCAgICBcdGlmIChkLnNvdXJjZS54IDwgZC50YXJnZXQueCkge1xuXHQgICAgXHRcdFx0cmV0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbXk6ICd0b3AgY2VudGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0OiAnY2VudGVyIGNlbnRlcicsIC8vIGF0IHRoZSBib3R0b20gcmlnaHQgb2YuLi5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogW2R4LCBkeV0sXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGp1c3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFx0eTogMTBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXHRcdCAgICBcdH0gZWxzZSB7XG5cdCAgICBcdFx0XHRyZXQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBteTogJ2JvdHRvbSBjZW50ZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXQ6ICdjZW50ZXIgY2VudGVyJywgLy8gYXQgdGhlIGJvdHRvbSByaWdodCBvZi4uLlxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiBbZHgsIGR5XSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkanVzdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXHR5OiAtMTBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXHRcdCAgICBcdH1cblx0XHQgICAgXHRyZXR1cm4gcmV0O1xuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0XHQgKiBDYWxsZWQgd2hlbiBhIGxpbmsgaXMgYWRkZWQgdG8gdGhlIGdyYXBoXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgYWRkZWQgdG9cblx0XHRcdCAqL1xuXHRcdFx0aW5pdGlhbGl6ZShncmFwaCkge1xuXHRcdFx0XHRpZiAodGhpcy5pbml0aWFsaXplZCA9PSBmYWxzZSkge1xuXHRcdFx0XHRcdHN1cGVyLmluaXRpYWxpemUoZ3JhcGgpO1xuXHRcdFx0XHRcdHZhciBzdGF0ZSA9IGdyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXHRcdFx0XHRcdGlmIChzdGF0ZSA9PSBudWxsKSB7XG5cdFx0XHRcdFx0XHRzdGF0ZSA9IGdyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rID0ge307XG5cdFx0XHRcdFx0XHRzdGF0ZS5tYXhXZWlnaHQgPSBudWxsO1xuXHRcdFx0XHRcdFx0c3RhdGUudXNlQXZnV2VpZ2h0ID0gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0dGhpcy51cGRhdGVNYXhXZWlnaHQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFNldHMgd2hldGhlciB0aGUgZ3JhcGggc2hvdWxkIHVzZSBhdmcgd2VpZ2h0XG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge2Jvb2xlYW59ICB2YWwgICAgIFRoZSB2YWx1ZSB0byBzZXQgdG9cblx0XHRcdCAqL1xuXHRcdFx0c2V0VXNlQXZnV2VpZ2h0KHZhbCkge1xuXHRcdCAgICAgICAgdGhpcy5ncmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluay51c2VBdmdXZWlnaHQgPSAhIXZhbDtcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBTZXRzIHRoZSB3ZWlnaHQgb2YgdGhpcyBsaW5rXG5cdFx0ICAgICAqXG5cdFx0ICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB3ZWlnaHQgIFRoZSB3ZWlnaHQgdG8gc2V0IHRvXG5cdFx0ICAgICAqL1xuXHRcdCAgICBzZXRXZWlnaHQod2VpZ2h0KSB7XG5cdFx0ICAgICAgICB0aGlzLndlaWdodCA9IHdlaWdodDtcblx0XHQgICAgfVxuXG5cdFx0ICAgIC8qKlxuXHRcdCAgICAgKiBHZXRzIHRoZSByYXcgd2VpZ2h0LlxuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcmV0dXJuICAgICB7bnVtYmVyfSAgVGhlIHJhdyB3ZWlnaHQuXG5cdFx0ICAgICAqL1xuXHRcdCAgICBnZXRSYXdXZWlnaHQoKSB7XG5cdFx0ICAgICAgICByZXR1cm4gdGhpcy53ZWlnaHQ7IFxuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIEdldHMgdGhlIHdlaWdodCB2YWx1ZSBvZiB0aGUgbGluaywgZGVwZW5kaW5nIG9uIHRoZVxuXHRcdCAgICAgKiB1c2VBdmdXZWlndGggc2V0dGluZ1xuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcmV0dXJuICAgICB7bnVtYmVyfSAgVGhlIHdlaWdodC5cblx0XHQgICAgICovXG5cdFx0ICAgIGdldFdlaWdodCgpIHtcblx0XHQgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuXHRcdCAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXG5cdFx0ICAgICAgICBpZiAoc3RhdGUudXNlQXZnV2VpZ2h0KSB7XG5cdFx0ICAgICAgICAgICAgdmFyIHdlaWdodCA9IHRoaXMud2VpZ2h0IC8gdGhpcy5jb3VudDtcblx0XHQgICAgICAgICAgICByZXR1cm4gd2VpZ2h0O1xuXHRcdCAgICAgICAgfVxuXHRcdCAgICAgICAgcmV0dXJuIHRoaXMud2VpZ2h0O1xuXHRcdCAgICB9XG5cblx0XHQgICAgLyoqXG5cdFx0ICAgICAqIFVwZGF0ZXMgdGhlIG1heCB3ZWlnaHQgb2YgdGhlIGdyYXBoXG5cdFx0ICAgICAqL1xuXHRcdCAgICB1cGRhdGVNYXhXZWlnaHQgKCkge1xuXHRcdCAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG5cdFx0ICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuVmlzdWFsaXplckxpbms7XG5cblx0XHQgICAgICAgIHZhciBtYXhMaW5rID0gXy5tYXhCeSh0aGlzR3JhcGgubGlua3MsIGZ1bmN0aW9uKGwpIHtcblx0XHQgICAgICAgIFx0aWYgKGwuZ3JhcGggIT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIGwuZ2V0V2VpZ2h0KCk7XG5cdFx0ICAgICAgICBcdH1cblx0XHQgICAgICAgIFx0cmV0dXJuIDA7XG5cdFx0ICAgICAgICB9KTtcblx0XHQgICAgICAgIHN0YXRlLm1heFdlaWdodCA9IG1heExpbmsuZ2V0V2VpZ2h0KCk7XG5cdFx0ICAgIH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxsZWQgZHVyaW5nIHRoZSB1cGRhdGUgZ3JhcGggZm9yIGV4aXN0aW5nIGxpbmtzXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNwYXRoICBUaGUgZDMgcGF0aFxuXHRcdFx0ICogQHBhcmFtICAgICAge0xpbmt9ICBcdCAgIGQgICAgICAgTWF0Y2hpbmcgTGluayBPYmplY3QgICAgICAgXG5cdFx0XHQgKi9cblx0XHRcdHVwZGF0ZUF0dHIoZDNwYXRoLCBkKSB7XG5cdFx0ICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcblx0XHQgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5WaXN1YWxpemVyTGluaztcblx0XHQgICAgICAgIHRoaXMudXBkYXRlTWF4V2VpZ2h0KCk7XG5cdCAgICAgICAgICAgIHZhciBjb2xvclNjYWxlID0gZDMuc2NhbGUubGluZWFyKClcblx0ICAgICAgICAgICAgICAgIC5kb21haW4oWzAsIHN0YXRlLm1heFdlaWdodF0pXG5cdCAgICAgICAgICAgICAgICAucmFuZ2UoW1wiI2ZmYjM2NlwiLCBcIiNGOTI2MDZcIl0pO1xuXHQgICAgICAgICAgICBzdGF0ZS5jb2xvclNjYWxlID0gY29sb3JTY2FsZTtcblx0XHRcdFx0ZDNwYXRoLnN0eWxlKCdtYXJrZXItZW5kJywgJ3VybCgjZW5kLWFycm93KScpXG5cdFx0ICAgICAgICAgICAgLmNsYXNzZWQodGhpc0dyYXBoLmNvbnN0cy5zZWxlY3RlZENsYXNzLCBmdW5jdGlvbihkKXtcblx0XHQgICAgICAgICAgICAgICAgcmV0dXJuIGQgPT09IHN0YXRlLnNlbGVjdGVkRWRnZTtcblx0XHQgICAgICAgICAgICB9KVxuXHRcdCAgICAgICAgICAgIC5hdHRyKFwiZFwiLCB0aGlzLmFycm93UGF0aC5jYWxsKGQpKVxuXHRcdCAgICAgICAgICAgIC50cmFuc2l0aW9uKFwiZXhpc3RpbmdQYXRoVHJhbnNpdGlvblwiKVxuXHRcdCAgICAgICAgICAgIC5kdXJhdGlvbig3NTApXG5cdFx0ICAgICAgICAgICAgLmF0dHIoXCJzdHJva2VcIiwgZnVuY3Rpb24oZCl7XG5cdFx0ICAgICAgICAgICAgICAgIHZhciBjID0gY29sb3JTY2FsZShkLmdldFdlaWdodCgpKTtcblx0XHQgICAgICAgICAgICAgICAgcmV0dXJuIGM7XG5cdFx0ICAgICAgICAgICAgfSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsbGVkIGR1cmluZyB0aGUgZmlyc3QgdXBkYXRlIGdyYXBoIGZvciB0aGlzIGxpbmtcblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM3BhdGggIFRoZSBkMyBwYXRoXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7TGlua30gIFx0ICAgZCAgICAgICBNYXRjaGluZyBMaW5rIE9iamVjdFxuXHRcdFx0ICovXG5cdFx0XHRuZXdQYXRoQXR0cihkM3BhdGgsIGQpIHtcblx0XHQgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuXHRcdCAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlZpc3VhbGl6ZXJMaW5rO1xuXHQgICAgICAgICAgICB0aGlzLnVwZGF0ZU1heFdlaWdodCgpO1xuXHQgICAgICAgICAgICB2YXIgY29sb3JTY2FsZSA9IGQzLnNjYWxlLmxpbmVhcigpXG5cdCAgICAgICAgICAgICAgICAuZG9tYWluKFswLCBzdGF0ZS5tYXhXZWlnaHRdKVxuXHQgICAgICAgICAgICAgICAgLnJhbmdlKFtcIiNmZmIzNjZcIiwgXCIjRjkyNjA2XCJdKTtcblx0ICAgICAgICAgICAgICAgIFxuXHRcdFx0XHRkM3BhdGgudHJhbnNpdGlvbihcIm5ld1BhdGhUcmFuc2l0aW9uXCIpXG5cdFx0ICAgICAgICAgICAgLmR1cmF0aW9uKDc1MClcblx0XHQgICAgICAgICAgICAuYXR0clR3ZWVuKFwib3BhY2l0eVwiLCBmdW5jdGlvbihkKSB7XG5cdFx0ICAgICAgICAgICAgICAgIHJldHVybiBkMy5pbnRlcnBvbGF0ZVN0cmluZygwLDEpO1xuXHRcdCAgICAgICAgICAgIH0pXG5cdFx0ICAgICAgICAgICAgLmF0dHIoXCJzdHJva2VcIiwgZnVuY3Rpb24oZCl7XG5cdFx0ICAgICAgICAgICAgICAgIHZhciBjID0gY29sb3JTY2FsZShkLmdldFdlaWdodCgpKTtcblx0XHQgICAgICAgICAgICAgICAgcmV0dXJuIGM7XG5cdFx0ICAgICAgICAgICAgfSlcblx0XHQgICAgICAgICAgICAuYXR0cignZCcsIHRoaXMuYXJyb3dQYXRoLmNhbGwoZCkpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB7XG5cdFx0XHRMaW5rIDogVmlzdWFsaXplckxpbmtcblx0XHR9XG59XSk7XG5cblxuXG5cblxuIiwiLyoqXG4gKiBUaGUgYmFzZSBjbGFzcyBmb3Igbm9kZSBvYmplY3RzIGZvciB0aGUgZ3JhcGguXG4gKiBTdXBwb3J0cyBwb2xpY2llcy5cbiAqIFxuICogVG8gd3JpdGUgeW91ciBvd24gTm9kZSBvYmplY3QsIGNyZWF0ZSBhIG5ldyBmYWN0b3J5IHRoYXQgdXNlcyB0aGUgbm9kZVxuICogeW91IHdhbnQgdG8gaW5oZXJpdCBhcyBhIGRlcGVuZGVuY3ksIGFuZCBleHRlbmQgaXRzIG5vZGUgY2xhc3MuIFxuICogUmV0dXJuIHRoZSBjbGFzcyBvYmplY3Qgd2l0aCBOb2RlIGFzIGtleVxuICogXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdOb2RlJywgW2Z1bmN0aW9uICgpIHtcblx0XHRjbGFzcyBOb2RlIHtcblx0XHRcdC8qKlxuXHRcdFx0ICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB4ICAgICAgIHggbG9jYXRpb25cblx0XHRcdCAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB5ICAgICAgIHkgbG9jYXRpb25cblx0XHRcdCAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBpZCAgICAgIFRoZSBpZGVudGlmaWVyXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgdGV4dCAgICBUaGUgdGV4dCB0byBkaXNwbGF5XG5cdFx0XHQgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgcmFkaXVzICBUaGUgcmFkaXVzIG9mIHRoZSBub2RlXG5cdFx0XHQgKi9cblx0XHRcdGNvbnN0cnVjdG9yKHgsIHksIGlkLCB0ZXh0LCByYWRpdXMpIHtcblx0XHRcdFx0dGhpcy54ID0geDtcblx0XHRcdFx0dGhpcy55ID0geTtcblx0XHRcdFx0dGhpcy5yYWRpdXMgPSByYWRpdXM7XG5cdFx0XHRcdHRoaXMuaWQgPSBpZDtcblx0XHRcdFx0dGhpcy50ZXh0ID0gdGV4dDtcblx0XHRcdFx0dGhpcy5yYWRpdXMgPSByYWRpdXM7XG5cdFx0XHRcdHRoaXMuaGFzUG9saWN5ID0gZmFsc2U7XG5cdFx0XHRcdHRoaXMucG9saWN5ID0gbnVsbDtcblx0XHRcdFx0dGhpcy5ub2RlUG9saWNpZXMgPSBbXTtcblx0XHRcdFx0dGhpcy5ncmFwaCA9IG51bGw7XG5cdFx0XHRcdHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBDYWxsZWQgd2hlbiBhIG5vZGUgaXMgYWRkZWQgdG8gdGhlIGdyYXBoXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgYWRkZWQgdG9cblx0XHRcdCAqL1xuXHRcdFx0aW5pdGlhbGl6ZShncmFwaCkge1xuXHRcdFx0XHRpZiAodGhpcy5pbml0aWFsaXplZCA9PSBmYWxzZSkge1xuXHRcdFx0XHRcdHRoaXMuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuXHRcdFx0XHRcdHRoaXMuZ3JhcGggPSBncmFwaDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCBkdXJpbmcgdGhlIHVwZGF0ZSBncmFwaCBmb3IgZXhpc3RpbmcgbGlua3Ncblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG5cdFx0XHQgKi9cblx0XHRcdHVwZGF0ZUF0dHIoZDNub2RlLCBkKSB7XG5cdFx0XHRcdGQzbm9kZS5hdHRyKFwidHJhbnNmb3JtXCIsIGZ1bmN0aW9uKGQpe3JldHVybiBcInRyYW5zbGF0ZShcIiArIGQueCArIFwiLFwiICsgZC55ICsgXCIpXCI7fSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FsbGVkIGR1cmluZyB0aGUgZmlyc3QgdXBkYXRlIGdyYXBoIGZvciBhIG5vZGVcblx0XHRcdCAqIEhvb2sgZm9yIHN1YiBjbGFzc2VzXG5cdFx0XHQgKiBcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzbm9kZSAgVGhlIGQzIG5vZGVcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgIGQgICAgICAgTWF0Y2hpbmcgTm9kZSBPYmplY3Rcblx0XHRcdCAqL1xuXHRcdFx0bmV3Tm9kZUF0dHIoZDNub2RlLCBkKSB7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogU2V0cyB0aGUgcmFkaXVzIG9mIHRoZSBub2RlLlxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICByYWRpdXMgIFRoZSByYWRpdXNcblx0XHRcdCAqL1xuXHRcdFx0c2V0UmFkaXVzKHJhZGl1cykge1xuXHRcdFx0XHR0aGlzLnJhZGl1cyA9IHJhZGl1cztcblx0XHRcdH1cblxuXHRcdCAgICAvKipcblx0XHQgICAgICogVXNlZCB0byBpbnN0YWxsIHBvbGljaWVzIHRoYXQgYXJlIGNhbGxlZCB3aGVuIHRoaXNcblx0XHQgICAgICogbm9kZSBoYXMgYSBtb3VzZSBldmVudFxuXHRcdCAgICAgKlxuXHRcdCAgICAgKiBAcGFyYW0gICAgICB7UG9saWN5fSAgcG9saWN5ICBUaGUgcG9saWN5IHRvIGluc3RhbGxcblx0XHQgICAgICovXG5cdFx0XHRpbnN0YWxsTm9kZVBvbGljeShwb2xpY3kpIHtcblx0XHRcdFx0dGhpcy5oYXNQb2xpY3kgPSB0cnVlO1xuXHRcdFx0XHR0aGlzLm5vZGVQb2xpY2llcy5wdXNoKHBvbGljeSk7XG5cdFx0XHRcdHBvbGljeS5pbml0aWFsaXplKHRoaXMuZ3JhcGgpO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFVzZWQgdG8gdW5pbnN0YWxsIHBvbGljeSBmb3IgdGhpcyBub2RlXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge1BvbGljeXxzdHJpbmd9ICBwb2xpY3lSZW1vdmUgIFRoZSBwb2xpY3kgdG8gcmVtb3ZlXG5cdFx0XHQgKi9cdFx0XHRcblx0XHRcdHVuaW5zdGFsbE5vZGVQb2xpY3kocG9saWN5UmVtb3ZlKSB7XG5cdFx0XHRcdHZhciBwb2xpY3lSZW1vdmVOYW1lO1xuXHRcdFx0XHR2YXIgdGhpc05vZGUgPSB0aGlzO1xuXHRcdFx0XHRpZiAodHlwZW9mIHBvbGljeVJlbW92ZSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHRwb2xpY3lSZW1vdmVOYW1lID0gcG9saWN5UmVtb3ZlO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHBvbGljeVJlbW92ZU5hbWUgPSBwb2xpY3lSZW1vdmUucG9saWN5TmFtZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRfKHRoaXNOb2RlLm5vZGVQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3ksIGluZGV4KSB7XG5cdFx0XHRcdFx0aWYgKHBvbGljeS5wb2xpY3lOYW1lID09PSBwb2xpY3lSZW1vdmVOYW1lKSB7XG5cdFx0XHRcdFx0XHRwb2xpY3kuZGVzdHJveSgpO1xuXHRcdFx0XHRcdFx0dGhpc05vZGUubm9kZVBvbGljaWVzLnNwbGljZShpbmRleCwgMSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdFx0aWYgKHRoaXNOb2RlLm5vZGVQb2xpY2llcy5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0XHR0aGlzTm9kZS5oYXNQb2xpY3kgPSBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCB3aGVuIHRoZXJlIGlzIGEgbW91c2UgZXZlbnQgZm9yIHRoaXMgbm9kZVxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBldmVudCAgICAgVGhlIG1vdXNlIGV2ZW50XG5cdFx0XHQgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgZCAgICAgICAgIFRoZSBtYXRjaGluZyBub2RlIG9iamVjdFxuXHRcdFx0ICovXG5cdFx0XHRub2RlUG9saWN5RXZlbnQoZXZlbnQsIGQzbm9kZSwgZCkge1xuXHRcdFx0XHRfLmZvckVhY2godGhpcy5ub2RlUG9saWNpZXMsIGZ1bmN0aW9uKHBvbGljeSkge1xuXHRcdFx0XHRcdHBvbGljeVtldmVudF0oZDNub2RlLCBkKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB7XG5cdFx0XHROb2RlOiBOb2RlXG5cdFx0fVxufV0pO1xuXG5cblxuXG5cblxuXG4iLCIvKipcbiAqIFRoZSBub2RlIHRoYXQgaXMgdXNlZCBzcGVjaWZpY2FsbHkgZm9yIHRoZSB2aXN1YWxpemF0aW9uIHRhYi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ1Zpc3VhbGl6ZXJOb2RlJywgWydOb2RlJywgZnVuY3Rpb24gKE5vZGUpIHtcblx0XHRjbGFzcyBWaXN1YWxpemVyTm9kZSBleHRlbmRzIE5vZGUuTm9kZSB7XG5cdFx0XHQvKipcblx0XHRcdCAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeCAgICAgICBcdHggbG9jYXRpb25cblx0XHRcdCAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICB5ICAgICAgIFx0eSBsb2NhdGlvblxuXHRcdFx0ICogQHBhcmFtICAgICAge3N0cmluZ30gIGlkICAgICAgXHRUaGUgaWRlbnRpZmllclxuXHRcdFx0ICogQHBhcmFtICAgICAge3N0cmluZ30gIHRleHQgICAgXHRUaGUgdGV4dCB0byBkaXNwbGF5XG5cdFx0XHQgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgcmFkaXVzICBcdFRoZSByYWRpdXMgb2YgdGhlIG5vZGVcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICBwYXJlbnQgICAgIFRoZSBwYXJlbnQgaWRcblx0XHRcdCAqIEBwYXJhbSAgICAgIHtBcnJheX0gICBhbmNlc3RvcnMgIEFycmF5IG9mIGFuY2VzdG9ycyBJZFxuXHRcdFx0ICogQHBhcmFtICAgICAge251bWJlcn0gIHhTdGFydCAgICAgeCBsb2MgdG8gc3RhcnQgYW5pbWF0aW9uXG5cdFx0XHQgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgeVN0YXJ0ICAgICB5IGxvYyB0byBzdGFydCBhbmltYXRpb25cblx0XHRcdCAqL1xuXHRcdCAgICBjb25zdHJ1Y3Rvcih4LCB5LCBpZCwgdGV4dCwgcmFkaXVzLCBwYXJlbnQsIGFuY2VzdG9ycywgXG5cdFx0ICAgIFx0eFN0YXJ0LCB5U3RhcnQpIHtcblx0XHQgICAgICAgIHN1cGVyKHgsIHksIGlkLCB0ZXh0LCByYWRpdXMpO1xuXHRcdCAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG5cdFx0ICAgICAgICB0aGlzLmFuY2VzdG9ycyA9IGFuY2VzdG9ycztcblx0XHQgICAgICAgIGlmICh4U3RhcnQgPT0gbnVsbCkge1xuXHRcdCAgICAgICAgXHR0aGlzLnhTdGFydCA9IHg7XG5cdFx0ICAgICAgICB9IGVsc2Uge1xuXHRcdCAgICAgICAgXHR0aGlzLnhTdGFydCA9IHhTdGFydDtcblx0XHQgICAgICAgIH1cblx0XHQgICAgICAgIGlmICh5U3RhcnQgPT0gbnVsbCkge1xuXHRcdCAgICAgICAgXHR0aGlzLnlTdGFydCA9IHk7XG5cdFx0ICAgICAgICB9IGVsc2Uge1xuXHRcdCAgICAgICAgXHR0aGlzLnlTdGFydCA9IHlTdGFydDtcblx0XHQgICAgICAgIH1cblx0XHQgICAgfVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIENhbGxlZCBkdXJpbmcgdGhlIGZpcnN0IHVwZGF0ZSBncmFwaCBmb3IgYSBub2RlXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICAgICAge0QzT2JqZWN0fSAgZDNub2RlICBUaGUgZDMgbm9kZVxuXHRcdFx0ICogQHBhcmFtICAgICAge05vZGV9ICAgIGQgICAgICAgICBUaGUgbWF0Y2hpbmcgTm9kZVxuXHRcdFx0ICovXG5cdFx0XHRuZXdOb2RlQXR0cihkM25vZGUsIGQpIHtcblx0XHRcdFx0dmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG5cdFx0XHRcdGlmICh0aGlzR3JhcGguY29uc3RzLmNvbnRhaW5lckNsYXNzICE9IG51bGwgJiZcblx0XHRcdFx0XHRcdHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFtkLmlkXSA9PSBudWxsKSB7XG5cdFx0XHRcdFx0ZDNub2RlLmNsYXNzZWQodGhpc0dyYXBoLmNvbnN0cy5jb250YWluZXJDbGFzcywgdHJ1ZSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0ZDNub2RlLnRyYW5zaXRpb24oXCJub2RlUG9zaXRpb25UcmFuc2l0aW9uXCIpXG5cdFx0ICAgICAgICAgICAgICAgIC5kdXJhdGlvbig3NTApXG5cdFx0ICAgICAgICAgICAgICAgIC5hdHRyVHdlZW4oXCJ0cmFuc2Zvcm1cIiwgZnVuY3Rpb24oZCkge1xuXHRcdCAgICAgICAgICAgICAgICAgICAgaWYgKGQueFN0YXJ0ICE9IG51bGwgJiYgZC55U3RhcnQgIT0gbnVsbCkge1xuXHRcdCAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4U3RhcnQgPSBkLnhTdGFydDtcblx0XHQgICAgICAgICAgICAgICAgICAgICAgICB2YXIgeVN0YXJ0ID0gZC55U3RhcnQ7XG5cdFx0ICAgICAgICAgICAgICAgICAgICAgICAgZC54U3RhcnQgPSBkLng7XG5cdFx0ICAgICAgICAgICAgICAgICAgICAgICAgZC55U3RhcnQgPSBkLnk7XG5cdFx0ICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQzLmludGVycG9sYXRlU3RyaW5nKFwidHJhbnNsYXRlKFwiICsgeFN0YXJ0ICsgXCIsXCIgKyB5U3RhcnQgKyBcIilcIiwgXCJ0cmFuc2xhdGUoXCIgKyBkLnggKyBcIixcIiArIGQueSArIFwiKVwiKTtcblx0XHQgICAgICAgICAgICAgICAgICAgIH1cblx0XHQgICAgICAgICAgICAgICAgICAgIHJldHVybiBkMy5pbnRlcnBvbGF0ZVN0cmluZyhcInRyYW5zbGF0ZShcIiArIGQueCArIFwiLFwiICsgZC55ICsgXCIpXCIsIFwidHJhbnNsYXRlKFwiICsgZC54ICsgXCIsXCIgKyBkLnkgKyBcIilcIik7XG5cdFx0ICAgICAgICAgICAgICAgIH0pO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB7XG5cdFx0XHROb2RlOiBWaXN1YWxpemVyTm9kZVxuXHRcdH1cblxufV0pO1xuXG5cblxuXG5cblxuXG5cbiIsIi8qKlxuICogVGhpcyBwb2xpY3kgaXMgdXNlZCB0byBhZGQgYSBzZWxlY3Qgbm9kZSBmZWF0dXJlLlxuICogU3VwcG9ydHMgc2VsZWN0aW5nIG11bHRpcGxlIG5vZGVzIGJ5IHVzaW5nIHRoZSBjdHJsIGtleS5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ05vZGVTZWxlY3Rpb25Qb2xpY3knLCBbJ1BvbGljeScsIGZ1bmN0aW9uIChQb2xpY3kpIHtcblxuICAgIFx0Y2xhc3MgTm9kZVNlbGVjdGlvblBvbGljeSBleHRlbmRzIFBvbGljeS5Qb2xpY3kge1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAgICAgICAgIHN1cGVyKFwiTm9kZVNlbGVjdGlvblBvbGljeVwiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAgICAgKiBPdmVyd3JpdGVzIHRoZSBvbiBkcmFnIGV2ZW50IG9mIHRoZSBncmFwaFxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaCBpdCBpcyBcbiAgICBcdFx0ICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YWxsZWQgb25cbiAgICBcdFx0ICovXG4gICAgICAgICAgICBpbml0aWFsaXplKGdyYXBoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdXBlci5pbml0aWFsaXplKGdyYXBoKTtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBncmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgc3RhdGUuc2VsZWN0ZWROb2RlcyA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBjb25zdHMgPSBncmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIGNvbnN0cy5zZWxlY3RlZENsYXNzID0gXCJzZWxlY3RlZFwiO1xuICAgICAgICAgICAgICAgIC8vb3ZlcndyaXR0aW5nIGdyYXBoJ3Mgbm9kZSBvbiBkcmFnIGV2ZW50IHRvIHN1cHBvcnRcbiAgICAgICAgICAgICAgICAvL21vdmluZyBtdWx0aXBsZSBub2RlcyBhdCBvbmNlXG4gICAgICAgICAgICAgICAgdmFyIGRyYWcgPSBncmFwaC5kcmFnO1xuICAgICAgICAgICAgICAgIGRyYWcub24oJ2RyYWcnLCBmdW5jdGlvbihhcmdzKSB7XG4gICAgICAgICAgICAgICAgXHR2YXIgdGhpc0dyYXBoID0gZ3JhcGg7XG4gICAgICAgICAgICAgICAgXHRpZiAodGhpc0dyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBcdFx0dmFyIHNlbGVjdGVkQ2xhc3MgPSB0aGlzR3JhcGguY29uc3RzLk5vZGVTZWxlY3Rpb25Qb2xpY3kuc2VsZWN0ZWRDbGFzcztcbiAgICAgICAgICAgICAgICBcdFx0dmFyIHNlbGVjdGlvbiA9IGQzLnNlbGVjdEFsbCggJy4nICtzZWxlY3RlZENsYXNzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIHNlbGVjdGlvblswXS5pbmRleE9mKCB0aGlzKT09LTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb24uY2xhc3NlZChzZWxlY3RlZENsYXNzLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uID0gZDMuc2VsZWN0KCB0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb24uY2xhc3NlZChzZWxlY3RlZENsYXNzLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGlvbi5hdHRyKFwidHJhbnNmb3JtXCIsIGZ1bmN0aW9uKCBkLCBpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC54ICs9IGQzLmV2ZW50LmR4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSArPSBkMy5ldmVudC5keTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJ0cmFuc2xhdGUoXCIgKyBbIGQueCxkLnkgXSArIFwiKVwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgICAgIFx0fVxuXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBBZGRzIHRoZSBnaXZlbiBub2RlIHRvIHRoZSBhcnJheSBvZiBzZWxlY3RlZCBub2Rlc1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzTm9kZSAgICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgbm9kZURhdGEgIE1hdGNoaW5nIE5vZGUgb2JqZWN0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGFkZFNlbGVjdE5vZGUoZDNOb2RlLCBub2RlRGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBjb25zdHMgPSB0aGlzR3JhcGguY29uc3RzLk5vZGVTZWxlY3Rpb25Qb2xpY3k7XG5cbiAgICAgICAgICAgICAgICBkM05vZGUuY2xhc3NlZChjb25zdHMuc2VsZWN0ZWRDbGFzcywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgc3RhdGUuc2VsZWN0ZWROb2Rlcy5wdXNoKG5vZGVEYXRhKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmVzIHRoZSBnaXZlbiBub2RlIGZyb20gdGhlIGFycmF5IG9mIHNlbGVjdGVkIG5vZGVzLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09iamVjdH0gIGQzTm9kZSAgICBUaGUgZDMgbm9kZVxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGV9ICAgICAgbm9kZURhdGEgIE1hdGNoaW5nIG5vZGUgb2JqZWN0IFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICByZW1vdmVTZWxlY3RGcm9tTm9kZShkM05vZGUsIG5vZGVEYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMuTm9kZVNlbGVjdGlvblBvbGljeTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmZpbHRlcihmdW5jdGlvbihjZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2QuaWQgPT09IG5vZGVEYXRhLmlkO1xuICAgICAgICAgICAgICAgIH0pLmNsYXNzZWQoY29uc3RzLnNlbGVjdGVkQ2xhc3MsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBzdGF0ZS5zZWxlY3RlZE5vZGVzLmluZGV4T2Yobm9kZURhdGEpO1xuICAgICAgICAgICAgICAgIHN0YXRlLnNlbGVjdGVkTm9kZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmVzIGFsbCBzZWxlY3RlZCBub2Rlcy5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgcmVtb3ZlQWxsU2VsZWN0ZWROb2RlcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuTm9kZVNlbGVjdGlvblBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cy5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuY2xhc3NlZChjb25zdHMuc2VsZWN0ZWRDbGFzcywgZmFsc2UpO1xuICAgICAgICAgICAgICAgIHN0YXRlLnNlbGVjdGVkTm9kZXMgPSBbXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBPbiBNb3VzZWRvd24sIGRldGVybWluZXMgd2hldGhlciB0byBjaGFuZ2UgdGhlXG4gICAgICAgICAgICAgKiBzZWxlY3RlZCBzdGF0dXMgb2YgdGhlIGNsaWNrZWQgbm9kZS5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gICAgICBkICAgICAgIE1hdGNoaW5nIE5vZGUgT2JqZWN0ICAgICAgIFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBtb3VzZWRvd24oZDNub2RlLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3k7XG4gICAgICAgICAgICAgICAgZDMuZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgaWYgKGQzLmV2ZW50LmN0cmxLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLnNlbGVjdGVkTm9kZXMuaW5kZXhPZihkKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVNlbGVjdEZyb21Ob2RlKGQzbm9kZSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZFNlbGVjdE5vZGUoZDNub2RlLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdGUuc2VsZWN0ZWROb2Rlcy5pbmRleE9mKGQpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgbm8gY29udHJvbCBrZXksIGFuZCBjbGlja2VkIG5vdCBzZWxlY3RlZCBub2RlLFxuICAgICAgICAgICAgICAgICAgICAvL3JlbW92ZSBhbGwgb2YgY3VycmVudCBzZWxlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVBbGxTZWxlY3RlZE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIE9uIE1vdXNldXAsIGRldGVybWluZXMgd2hldGhlciB0byBjaGFuZ2UgdGhlXG4gICAgICAgICAgICAgKiBzZWxlY3RlZCBzdGF0dXMgb2YgdGhlIGNsaWNrZWQgbm9kZS5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gICAgICBkICAgICAgIE1hdGNoaW5nIE5vZGUgT2JqZWN0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIG1vdXNldXAoZDNub2RlLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLk5vZGVTZWxlY3Rpb25Qb2xpY3k7XG4gICAgICAgICAgICAgICAgaWYgKCFkMy5ldmVudC5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgbGVuZ3RoIGlzIGdyZWF0ZXIgdGhhbiAxLCB0aGVuIHdlIGFyZSBtb3ZpbmcgbXVsdGlwbGUgbm9kZXNcbiAgICAgICAgICAgICAgICAgICAgLy9sZWF2ZSB0aGVtIGFsbCBoaWdobGlnaHRlZFxuICAgICAgICAgICAgICAgICAgICAvL290aGVyd2lzZSB3ZSBhcmUganVzdCBtb3Zpbmcgb25lIG5vZGUsIHNvIHVuaGlnaGxpZ2h0XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5zZWxlY3RlZE5vZGVzLmxlbmd0aCA8PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVNlbGVjdEZyb21Ob2RlKGQzbm9kZSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIFBvbGljeTogTm9kZVNlbGVjdGlvblBvbGljeVxuICAgICAgICB9XG59XSk7XG5cblxuXG5cblxuXG5cbiIsIi8qKlxuICogVGhpcyBwb2xpY3kgY2hhbmdlcyB0aGUgdmlldyB0byB0aGUgdGltZWdyYXBoIG9mIGxpbmsgZGF0YSBvbiBjbGljay5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ1BhdGhDaGFuZ2VWaWV3UG9saWN5JywgWydQb2xpY3knLCBmdW5jdGlvbiAoUG9saWN5KSB7XG4gICAgXHRjbGFzcyBQYXRoQ2hhbmdlVmlld1BvbGljeSBleHRlbmRzIFBvbGljeS5Qb2xpY3kge1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgdG8gYnVpbGQgcG9saWN5XG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAge0FuZ3VsYXIgU3RhdGV9ICAgICRzdGF0ZSAgICBVc2VkIHRvIGNoYW5nZSB2aWV3XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKCRzdGF0ZSkge1xuICAgICAgICAgICAgICAgIHN1cGVyKCdQYXRoQ2hhbmdlVmlld1BvbGljeScpO1xuICAgICAgICAgICAgICAgIHRoaXMuJHN0YXRlID0gJHN0YXRlO1xuICAgICAgICAgICAgfVxuXG5cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBHZW5lcmF0ZXMgYSBsaXN0IG9mIGFsbCBjaGlsZCBjb250YWluZXJzIG9mIHRoZSBzZXJ2aWNlXG4gICAgICAgICAgICAgKiBDYW4gaGFuZGxlIG5lc3RlZCBzZXJ2aWNlcy5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgaWQgICAgICBOb2RlIElEXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGdlbmVyYXRlTGlzdChpZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgcmV0TGlzdCA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBnZW5lcmF0ZUxpc3RIZWxwZXIgPSBmdW5jdGlvbihpZCwgcmV0TGlzdCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZUlkcyA9IHRoaXNQb2xpY3kuZ3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3RbaWRdO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVJZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZElkID0gbm9kZUlkc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzUG9saWN5LmdyYXBoLmRhdGFTb3VyY2UuaGFzQ2hpbGQoY2hpbGRJZCkgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUmV0TGlzdCA9IGdlbmVyYXRlTGlzdEhlbHBlcihjaGlsZElkLCByZXRMaXN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXRMaXN0LmNvbmNhdChzdWJSZXRMaXN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0TGlzdC5wdXNoKGNoaWxkSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGdlbmVyYXRlTGlzdEhlbHBlcihpZCwgcmV0TGlzdCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJldExpc3RcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2VkIHRvIHJlcm91dGUgYW4gZWRnZSB3aGVuIGNsaWNrZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7TGlua30gIGVkZ2UgICAgVGhlIGNsaWNrZWQgZWRnZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB2aWV3RWRnZShlZGdlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNvdXJjZUxpc3QgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0TGlzdCA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBzb3VyY2VJZCA9IGVkZ2Uuc291cmNlLmlkO1xuICAgICAgICAgICAgICAgIHZhciB0YXJnZXRJZCA9IGVkZ2UudGFyZ2V0LmlkO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZ3JhcGguZGF0YVNvdXJjZS5oYXNDaGlsZChzb3VyY2VJZCkgPT09IHRydWUpIHsvL05vdCBhIGNvbnRhaW5lciBub2RlLCBuZWVkIHRvIGFnZ3JlZ2F0ZVxuICAgICAgICAgICAgICAgICAgICBzb3VyY2VMaXN0ID0gdGhpcy5nZW5lcmF0ZUxpc3Qoc291cmNlSWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZUxpc3QgPSBbc291cmNlSWRdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmdyYXBoLmRhdGFTb3VyY2UuaGFzQ2hpbGQodGFyZ2V0SWQpID09PSB0cnVlKSB7Ly9Ob3QgYSBjb250YWluZXIgbm9kZSwgbmVlZCB0byBhZ2dyZWdhdGVcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TGlzdCA9IHRoaXMuZ2VuZXJhdGVMaXN0KHRhcmdldElkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRMaXN0ID0gW3RhcmdldElkXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy4kc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZpc3VhbGl6YXRpb24uZWRnZScsIFxuICAgICAgICAgICAgICAgICAgICB7c291cmNlTmFtZTogc291cmNlSWQsIHRhcmdldE5hbWU6IHRhcmdldElkLFxuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlTGlzdDogc291cmNlTGlzdCwgdGFyZ2V0TGlzdDogdGFyZ2V0TGlzdH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBtb3VzZWRvd24oZDNwYXRoLCBkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52aWV3RWRnZShkKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBQb2xpY3k6IFBhdGhDaGFuZ2VWaWV3UG9saWN5XG4gICAgICAgIH1cbn1dKTtcblxuXG5cblxuXG5cblxuXG5cblxuXG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuYXBwbGljYXRpb25ncm91cHMnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzJywge1xuICAgICAgICAgICAgdXJsOiAnL2FwcGxpY2F0aW9uZ3JvdXBzJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwIiwiLyoqXG4gKiBCYXNlIHBvbGljeSBjbGFzcyBmb3IgdGhlIGdyYXBoIG9iamVjdFxuICogXG4gKiBQb2xpY2llcyBhcmUgdXNlZCB0byBpc29sYXRlIGZlYXR1cmVzIGZvciBhIGdyYXBoLlxuICogUG9saWNpZXMgY2FuIGJlIGluc3RhbGxlZCBvbiBub2RlcywgbGlua3MsIG9yIHRoZSBncmFwaC5cbiAqIEVhY2ggcG9saWN5IGhhcyBpbnRlcmFjdGlvbiBoYW5kbGVycyB0aGF0IHdpbGwgYmUgY2FsbGVkIGJ5IHRoZSBncmFwaFxuICogaWYgaW5zdGFsbGVkLiBQb2xpY2llcyBjYW4gYWxzbyBtb2RpZnkgZ3JhcGggZnVuY3Rpb25zIChzZWUgUVRpcFBvbGljeSkuXG4gKiBNdWx0aXBsZSBwb2xpY2llcyBjYW4gYmUgaW5zdGFsbGVkIGZvciBhIG5vZGUgb3IgbGluay4gXG4gKiBcbiAqIFRvIHdyaXRlIHlvdXIgb3duIHBvbGljeSwgY3JlYXRlIGEgbmV3IGZhY3RvcnkgdGhhdCB1c2VzIHRoZSBwb2xpY3lcbiAqIHlvdSB3YW50IHRvIGluaGVyaXQgYXMgYSBkZXBlbmRlbmN5LCBhbmQgZXh0ZW5kIGl0cyBwb2xpY3kuIFxuICogUmV0dXJuIHRoZSBjbGFzcyBvYmplY3Qgd2l0aCBQb2xpY3kgYXMga2V5LCBhbmQgXG4gKiBhZGQgdGhlIHBvbGljeSB0byB0aGUgUG9saWN5U2VydmljZSBmYWN0b3J5LlxuICogXG4gKiBGb3Igc2F2aW5nIHN0YXRlIG9yIGNvbnN0cyBmb3IgdGhlIHBvbGljeSwgY3JlYXRlIGEgbmFtZXNwYWNlXG4gKiBpbiBncmFwaC5zdGF0ZSBhbmQgZ3JhcGguY29uc3RzLlxuICogRXguIFxuICogICAgICBncmFwaC5zdGF0ZS5teVBvbGljeSA9IHt9O1xuICogICAgICBncmFwaC5jb25zdHMubXlQb2xpY3kgPSB7fTtcbiAqICAgICAgXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdQb2xpY3knLCBbZnVuY3Rpb24gKCkge1xuICAgICAgICBjbGFzcyBQb2xpY3kge1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDb25zdHJ1Y3RzIHRoZSBvYmplY3QuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge3N0cmluZ30gIHBvbGljeU5hbWUgIFRoZSBwb2xpY3kgbmFtZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcihwb2xpY3lOYW1lKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wb2xpY3lOYW1lID0gcG9saWN5TmFtZTtcbiAgICAgICAgICAgICAgICB0aGlzLmdyYXBoID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIHBvbGljeSBpcyBpbnN0YWxsZWQuXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAge0dyYXBofSAgZ3JhcGggICBUaGUgR3JhcGggdGhhdCB0aGUgcG9saWN5IGlzXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgYmVpbmcgaW5zdGFsbGVkIG9uXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluaXRpYWxpemUoZ3JhcGgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47IFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLmdyYXBoID0gZ3JhcGg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogSGFuZGxlciwgbWVhbnQgdG8gYmUgb3ZlcnJpZGRlbiBpbiBzdWJjbGFzc2VzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICB7ZDMgb2JqZWN0fSAgICBkM29iaiAgICBUaGUgZDNvYmplY3RcbiAgICAgICAgICAgICAqIEBwYXJhbSAge05vZGUvTGluay9HcmFwaH0gIGQgICBUaGUgb2JqZWN0IGl0IHdhc1xuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbGxlZCBmb3IuICAgIFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBtb3VzZW92ZXIgKGQzb2JqLCBkKSB7fVxuICAgICAgICAgICAgZGJsY2xpY2soZDNvYmosIGQpIHt9XG4gICAgICAgICAgICBjb250ZXh0bWVudShkM29iaiwgZCkge31cbiAgICAgICAgICAgIG1vdXNlb3V0KGQzb2JqLCBkKSB7fVxuICAgICAgICAgICAgbW91c2Vkb3duKGQzb2JqLCBkKSB7fVxuICAgICAgICAgICAgbW91c2V1cChkM29iaiwgZCkge31cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBXaWxsIGJlIGNhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyBiZWluZyBkZXN0cm95ZWQuXG4gICAgICAgICAgICAgKiBVc2VkIHRvIHJlbW92ZSBhbnkgZWxlbWVudHMgb3IgYmluZGluZ3MgdGhlIHBvbGljeVxuICAgICAgICAgICAgICogaGFzIGFkZGVkLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkZXN0cm95KCkge31cbiAgICAgICAgfVxuICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIFBvbGljeTogUG9saWN5XG4gICAgICAgIH1cbn1dKTtcblxuXG5cblxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmRhc2hib2FyZCcsIFsnY29udGl2Lm1vZGVscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5kYXNoYm9hcmQnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZGFzaGJvYXJkJyxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ2Rhc2hib2FyZCdcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIi8qKlxuICogQ29udGFpbnMgYWxsIHRoZSBwb2xpY2llcy5cbiAqIFNlZSBwb2xpY3kuanMgZm9yIGluZm8gb24gaG93IHBvbGljaWVzIHdvcmsuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdQb2xpY3lTZXJ2aWNlJywgWydQb2xpY3knLCdRVGlwUG9saWN5JywgJ1BhdGhDaGFuZ2VWaWV3UG9saWN5JywgXG4gICAgICAgICdOb2RlU2VsZWN0aW9uUG9saWN5JywgJ1NwbGl0Sm9pbk5vZGVQb2xpY3knLCAnU3BsaXRKb2luVmlld1BvbGljeScsXG4gICAgICAgICdTYXZlU3RhdGVQb2xpY3knLFxuICAgICAgICAgICAgZnVuY3Rpb24gKFBvbGljeSwgUVRpcFBvbGljeSwgUGF0aENoYW5nZVZpZXdQb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgICAgICBOb2RlU2VsZWN0aW9uUG9saWN5LCAgU3BsaXRKb2luTm9kZVBvbGljeSwgXG4gICAgICAgICAgICAgICAgICAgICAgICBTcGxpdEpvaW5WaWV3UG9saWN5LCBTYXZlU3RhdGVQb2xpY3kpIHtcblxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIFBvbGljeTogUG9saWN5LlBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgUVRpcFBvbGljeTogUVRpcFBvbGljeS5Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIFBhdGhDaGFuZ2VWaWV3UG9saWN5OiBQYXRoQ2hhbmdlVmlld1BvbGljeS5Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIE5vZGVTZWxlY3Rpb25Qb2xpY3k6IE5vZGVTZWxlY3Rpb25Qb2xpY3kuUG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBTcGxpdEpvaW5Ob2RlUG9saWN5OiBTcGxpdEpvaW5Ob2RlUG9saWN5LlBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgU3BsaXRKb2luVmlld1BvbGljeTogU3BsaXRKb2luVmlld1BvbGljeS5Qb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIFNhdmVTdGF0ZVBvbGljeTogU2F2ZVN0YXRlUG9saWN5LlBvbGljeVxuICAgICAgICAgICAgICAgIH1cbn1dKTsiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubG9naW4nLCBbJ2NvbnRpdi51dGlscyddKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCIvKipcbiAqIFRoaXMgcG9saWN5IGFkZHMgdG9vbHRpcCBmdW5jdGlvbmFsaXR5IHRvIG5vZGVzIGFuZCBsaW5rcy5cbiAqIFdoZW4gaW5zdGFsbGluZywgaW5zdGFsbCBvbiBib3RoIGxpbmtzIGFuZCBub2Rlcy5cbiAqIFxuICogVXNlcyB0aGUgcVRpcCBqUXVlcnkgcGx1Z2luXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdRVGlwUG9saWN5JywgWydQb2xpY3knLCBmdW5jdGlvbiAoUG9saWN5KSB7XG4gICAgICAgIGNsYXNzIFFUaXBQb2xpY3kgZXh0ZW5kcyBQb2xpY3kuUG9saWN5IHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgICAgICBzdXBlcihcIlFUaXBQb2xpY3lcIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIHdoZW4gdGhlIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICAgICAqIE1vZGlmaWVzIHRoZSB1cGRhdGVOZXdOb2RlcyBhbmQgXG4gICAgICAgICAgICAgKiB1cGRhdGVOZXdQYXRocyBtZXRob2Qgb2YgdGhlIGdyYXBoIHRvIGluc3RhbGwgcXRpcFxuICAgICAgICAgICAgICogb250byBlYWNoIG5vZGUgYW5kIHBhdGguXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGggaXQgaXMgXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbGxlZCBvblxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbml0aWFsaXplKGdyYXBoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdXBlci5pbml0aWFsaXplKGdyYXBoKTtcblxuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBncmFwaC5zdGF0ZS5RVGlwUG9saWN5ID0ge307XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS5tb3VzZWRvd24gPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIGdyYXBoLmNvbnN0cy5RVGlwUG9saWN5ID0ge307XG5cbiAgICAgICAgICAgICAgICAvL1RyYWNraW5nIG1vdXNlIGNsaWNrIHN0YXRlIHRvIG1ha2UgdG9vbHRpcFxuICAgICAgICAgICAgICAgIC8vZGlzYXBwZWFyIGlmIHRoZSBub2RlIGlzIGJlaW5nIGRyYWdnZWQuXG4gICAgICAgICAgICAgICAgJCgnI3Zpc3VhbGl6YXRpb24tZ3JhcGgnKS5tb3VzZXVwKGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUubW91c2V1cCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy9vdmVycmlkZSB1cGRhdGVOZXdOb2RlcyBhbmQgdXBkYXRlTmV3UGF0aHNcbiAgICAgICAgICAgICAgICAvL3RvIGluc3RhbGwgcXRpcFxuICAgICAgICAgICAgICAgIHZhciBncmFwaFVwZGF0ZU5ld05vZGVzID0gZ3JhcGgudXBkYXRlTmV3Tm9kZXM7XG4gICAgICAgICAgICAgICAgZ3JhcGgudXBkYXRlTmV3Tm9kZXMgPSBmdW5jdGlvbihuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgICAgICBncmFwaFVwZGF0ZU5ld05vZGVzLmNhbGwoZ3JhcGgsIG5ld05vZGVzKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51cGRhdGVOZXdOb2RlcyhuZXdOb2Rlcyk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHZhciBncmFwaFVwZGF0ZU5ld1BhdGhzID0gZ3JhcGgudXBkYXRlTmV3UGF0aHM7XG4gICAgICAgICAgICAgICAgZ3JhcGgudXBkYXRlTmV3UGF0aHMgPSBmdW5jdGlvbihuZXdQYXRocykge1xuICAgICAgICAgICAgICAgICAgICBncmFwaFVwZGF0ZU5ld1BhdGhzLmNhbGwoZ3JhcGgsIG5ld1BhdGhzKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51cGRhdGVOZXdQYXRocyhuZXdQYXRocyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJlbW92ZXMgYWxsIHFUaXBzIGZyb20gdGhlIERPTS5cbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBwb2xpY3kgaXMgdW5pbnN0YWxsZWQgb3JcbiAgICAgICAgICAgICAqIHRoZSBncmFwaCBpcyBkZXN0cm95ZWQuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICAgICAgLy9yZW1vdmluZyBhbGwgcXRpcCBmcm9tIERPTVxuICAgICAgICAgICAgICAgICQoJ1tpZF49XCJxdGlwXCJdJykucmVtb3ZlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogS2VlcGluZyB0cmFjayBvZiBtb3VzZWRvd24gc3RhdGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7ZDNPYmplY3R9ICBkM29iaiAgVGhlIGQzIHBiamVjdFxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge05vZGUvTGlua30gIGQgICAgIFRoZSBtYXRjaGluZyBkYXRhIG9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBtb3VzZWRvd24oZDNvYmosIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuUVRpcFBvbGljeTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5tb3VzZWRvd24gPSB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEtlZXBpbmcgdHJhY2sgb2YgbW91c2Vkb3duIHN0YXRlXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzT2JqZWN0fSAgZDNvYmogIFRoZSBkMyBwYmplY3RcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlL0xpbmt9ICBkICAgICBUaGUgbWF0Y2hpbmcgZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgbW91c2V1cChkM29iaiwgZCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5RVGlwUG9saWN5O1xuICAgICAgICAgICAgICAgIHN0YXRlLm1vdXNlZG93biA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB3aGVuUVRpcEF2YWlsYWJsZShjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgaW50ZXJ2YWwgPSA1MDA7IC8vIG1zXG4gICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkKGRvY3VtZW50KS5xdGlwICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dCh0aGlzUG9saWN5LndoZW5RVGlwQXZhaWxhYmxlKGNhbGxiYWNrKSwgaW50ZXJ2YWwpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgaW50ZXJ2YWwpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIE5ldyBOb2RlcyBhcmUgYWRkZWQgZHVyaW5nIHRoZVxuICAgICAgICAgICAgICogdXBkYXRlIGdyYXBoIGZ1bmN0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzTm9kZX0gIG5ld05vZGVzICBUaGUgbmV3IG5vZGVzIHRoYXQgYXJlXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlaW5nIGFkZGVkIHRvIHRoZSBncmFwaFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1cGRhdGVOZXdOb2RlcyhuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5RVGlwUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gYXR0YWNoUVRpcCgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9hdHRhY2hpbmcgcXRpcFxuICAgICAgICAgICAgICAgICAgICBuZXdOb2Rlcy5lYWNoKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aGlzTm9kZSA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL0lmIG5vZGUgaGFzIGNoaWxkcmVuLCB0aGVuIGl0IGlzIGEgc2VydmljZVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdFtkLmlkXSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IFwiPGI+PHU+U2VsZWN0b3JzOjwvYj48L3U+IFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZWxlY3Rvck1hcCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnNlbGVjdG9yc1tkLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGFzS2V5cyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBzZWxlY3Rvck1hcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNLZXlzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSBrZXkgKyBcIiA6IDxpPlwiKyBzZWxlY3Rvck1hcFtrZXldICsgXCI8L2k+LFxcbiBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhhc0tleXMgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29tbWEgd2lsbCBiZSByZW1vdmVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSBcIk5vIFNlbGVjdG9ycywgXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSBcIjxiPjx1PkxhYmVsczo8L2I+PC91PiBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGFiZWxzTWFwID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UubGFiZWxzW2QuaWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoYXNLZXlzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGxhYmVsc01hcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNLZXlzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSBrZXkgKyBcIiA6IDxpPlwiKyBsYWJlbHNNYXBba2V5XSArIFwiPC9pPixcXG4gXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoYXNLZXlzID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbW1hIHdpbGwgYmUgcmVtb3ZlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gXCJObyBsYWJlbHMsIFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vcmVtb3ZlIGxhc3QgY29tbWFcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSB0ZXh0LnNsaWNlKDAsIC0yKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzTm9kZSkucXRpcCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogZC5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRzOiB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcGkgPSAkKHRoaXNOb2RlKS5xdGlwKCdhcGknKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSAkKCcjZ3JhcGhDb250YWluZXInKS5vZmZzZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IFtvZmZzZXQubGVmdCArICgoZC54ICogdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKSkgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKVswXSksIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQudG9wICsgKChkLnkgK2QucmFkaXVzKSAqIHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCkpICArIHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpWzFdXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwaS5zZXQoJ3Bvc2l0aW9uLnRhcmdldCcsIHBvc2l0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhc3RhdGUubW91c2Vkb3duO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGF5OiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb2xvOiAkKCcjdmlzdWFsaXphdGlvbi1ncmFwaCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc2VzOiAncXRpcC1ibHVlIHF0aXAtc2hhZG93J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXk6ICd0b3AgY2VudGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXQ6ICdib3R0b20gY2VudGVyJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0YXJnZXQ6IHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaWRlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50OiAnbW91c2Vkb3duIG1vdXNlbGVhdmUnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vaW5jYXNlIGxpYnJhcnkgaGFzbid0IGxvYWRlZCB5ZXRcbiAgICAgICAgICAgICAgICBpZiAoJChkb2N1bWVudCkucXRpcCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgYXR0YWNoUVRpcCgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMud2hlblFUaXBBdmFpbGFibGUoYXR0YWNoUVRpcCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIG5ldyBwYXRocyBhcmUgYWRkZWQgZHVyaW5nIHRoZVxuICAgICAgICAgICAgICogdXBkYXRlIGdyYXBoIGZ1bmN0aW9uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2QzUGF0aH0gIG5ld1BhdGhzICBUaGUgbmV3IHBhdGhzIHRoYXQgYXJlXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlaW5nIGFkZGVkIHRvIHRoZSBncmFwaFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1cGRhdGVOZXdQYXRocyhuZXdQYXRocykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5RVGlwUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgLy9pbmNhc2UgbGlicmFyeSBoYXNuJ3QgbG9hZGVkIHlldFxuICAgICAgICAgICAgICAgIGlmICgkKGRvY3VtZW50KS5xdGlwICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvL2FkZGluZyBxdGlwXG4gICAgICAgICAgICAgICAgICAgIG5ld1BhdGhzLmVhY2goZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRoaXNQYXRoID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vZ2V0dGluZyBtaWRwb2ludCBvZiBwYXRoXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aEVsICAgPSBkMy5zZWxlY3QodGhpcykubm9kZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1pZHBvaW50ID0gcGF0aEVsLmdldFBvaW50QXRMZW5ndGgocGF0aEVsLmdldFRvdGFsTGVuZ3RoKCkvMik7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0UmV0ID0gZC5xdGlwSGVscGVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IFwiQnl0ZXM6IFwiICsgZC5nZXRXZWlnaHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpc1BhdGgpLnF0aXAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3c6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9pZiBtb3VzZSBpcyBkb3duLCBkb24ndCBsZXQgcXRpcCBzaG93XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIXN0YXRlLm1vdXNlZG93bjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxheTogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc29sbzogJCgnI2dyYXBoQ29udGFpbmVyJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzZXM6ICdxdGlwLWJsdWUgcXRpcC1zaGFkb3cnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBteTogdGFyZ2V0UmV0Lm15LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdDogJ2NlbnRlciBjZW50ZXInLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiAnbW91c2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGp1c3Q6IHRhcmdldFJldC5hZGp1c3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQ6ICdtb3VzZWRvd24gbW91c2VsZWF2ZSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0gICBcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBQb2xpY3k6IFFUaXBQb2xpY3lcbiAgICAgICAgfVxufV0pO1xuXG5cblxuXG5cblxuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5tZW51JywgW10pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIi8qKlxuICogVGhpcyBwb2xpY3kgcHJvdmlkZXMgYSB3YXkgZm9yIHByb3BlcnRpZXMgdG8gYmUgc2F2ZWQgXG4gKiBiZXR3ZWVuIHZpZXcgY2hhbmdlc1xuICogXG4gKiBJdCBtb2RpZmllcyB0aGUgZGVzdHJveSBmdW5jdGlvbiB0byBhbHNvIHBhc3MgaW4gYW4gb2JqZWN0IHRoYXRcbiAqIHdpbGwgaGF2ZSBhbGwgaXRzIHByb3BlcnRpZXMgc2F2ZWQgYW5kIHdpbGwgYmUgYXZhaWxhYmxlIFxuICogb24gZ3JhcGggbG9hZC4gV2hlbiBzYXZpbmcgdmFyaWFibGVzIHRvIHRoZSBvYmplY3QsIG5hbWVzcGFjZSB3aXRoXG4gKiB0aGUgcG9saWN5IG5hbWUuXG4gKiBcbiAqIFRoaXMgcG9saWN5IG11c3QgYmUgbG9hZGVkIGZpcnN0IGluIG9yZGVyIGZvciBpdCBzYXZlZCB2YXJpYWJsZXMgXG4gKiB0byBiZSBsb2FkZWQgd2hlbiB0aGUgdmlldyBjb21lcyBiYWNrIHRvIHRoZSBncmFwaFxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmdyYXBoJylcbiAgICAuZmFjdG9yeSgnU2F2ZVN0YXRlUG9saWN5JywgWydQb2xpY3knLCBmdW5jdGlvbiAoUG9saWN5KSB7XG4gICAgXHRjbGFzcyBTYXZlU3RhdGVQb2xpY3kgZXh0ZW5kcyBQb2xpY3kuUG9saWN5IHtcbiAgICBcdFx0XG4gICAgXHRcdC8qKlxuICAgIFx0XHQgKiBUYWtlcyBpbiB0aGUgYW5ndWxhciBzZXJ2aWNlIHRvIHdoaWNoIGl0IHdpbGxcbiAgICBcdFx0ICogc2F2ZSBpdCdzIHByb3BlcnRpZXMgdG8uXG4gICAgXHRcdCAqXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBzYXZlZFN0YXRlICBPYmplY3QgdG8gc2F2ZSBcbiAgICBcdFx0ICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXMgdG9cbiAgICBcdFx0ICovXG4gICAgXHRcdGNvbnN0cnVjdG9yKHNhdmVkU3RhdGUpIHtcbiAgICBcdFx0XHRzdXBlcignU2F2ZVN0YXRlUG9saWN5Jyk7XG4gICAgXHRcdFx0dGhpcy5zYXZlZFN0YXRlID0gc2F2ZWRTdGF0ZTtcbiAgICBcdFx0fVxuXG4gICAgXHRcdC8qKlxuICAgIFx0XHQgKiBDYWxsZWQgd2hlbiB0aGUgcG9saWN5IGlzIGluc3RhbGxlZFxuICAgIFx0XHQgKiBNb2RpZmllcyB0aGUgZGVzdHJveSBtZXRob2QgXG4gICAgXHRcdCAqIGFuZCBhZGRzIGEgbG9hZCBtZXRob2QgdG8gdGhlIGdyYXBoXG4gICAgXHRcdCAqXG4gICAgXHRcdCAqIEBwYXJhbSAgICAgIHtHcmFwaH0gIGdyYXBoICAgVGhlIGdyYXBoIGl0IGlzIFxuICAgIFx0XHQgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbGxlZCBvblxuICAgIFx0XHQgKi9cbiAgICBcdFx0aW5pdGlhbGl6ZShncmFwaCkge1xuICAgIFx0XHRcdHRoaXMuZ3JhcGggPSBncmFwaDtcbiAgICBcdFx0XHR2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgXHRcdFx0Z3JhcGguZGVzdHJveSA9IGZ1bmN0aW9uKCkge1xuICAgIFx0XHRcdFx0dGhpc1BvbGljeS5ncmFwaERlc3Ryb3kuY2FsbChncmFwaCwgdGhpc1BvbGljeS5zYXZlZFN0YXRlKTtcbiAgICBcdFx0XHR9O1xuXG4gICAgXHRcdFx0Z3JhcGgubG9hZCA9IGZ1bmN0aW9uKHNhdmVkU3RhdGUpIHtcbiAgICBcdFx0XHRcdHRoaXNQb2xpY3kuZ3JhcGhMb2FkLmNhbGwoZ3JhcGgsIHNhdmVkU3RhdGUpO1xuICAgIFx0XHRcdH1cbiAgICBcdFx0fVxuXG4gICAgXHRcdC8qKlxuICAgIFx0XHQgKiBXaWxsIG92ZXJyaWRlIHRoZSBncmFwaCdzIGRlZmF1bHQgZGVzdHJveSwgd2l0aCBcbiAgICBcdFx0ICogdGhpcyBwb2xpY3kncyBzYXZlZFN0YXRlIHBhc3NlZCBpbi5cbiAgICBcdFx0ICogQ2FsbGVkIHdpdGggdGhpcyBhcyB0aGUgZ3JhcGhcbiAgICBcdFx0ICpcbiAgICBcdFx0ICogQHBhcmFtICAgICAge09iamVjdH0gIHNhdmVkU3RhdGUgIFRoZSBzYXZlZCBzdGF0ZVxuICAgIFx0XHQgKi9cbiAgICBcdFx0Z3JhcGhEZXN0cm95KHNhdmVkU3RhdGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcztcbiAgICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdE5vZGVQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5LmRlc3Ryb3koc2F2ZWRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5LmRlc3Ryb3koc2F2ZWRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHRoaXNHcmFwaC5iaW5kaW5ncykge1xuICAgICAgICAgICAgICAgICAgICAkKHdpbmRvdykub2ZmKGtleSwgdGhpc0dyYXBoLmJpbmRpbmdzW2tleV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBXaWxsIGJlIGNhbGxlZCB3aXRoIHRoZSBncmFwaCBhcyB0aGlzXG4gICAgICAgICAgICAgKiBVc2VkIHRvIGhhdmUgYWxsIG90aGVyIHBvbGljaWVzIHVzZSB0aGUgbG9hZCBzdGF0ZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBzYXZlZFN0YXRlICBUaGUgc2F2ZWQgc3RhdGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZ3JhcGhMb2FkKHNhdmVkU3RhdGUpIHtcbiAgICAgICAgICAgIFx0dmFyIHRoaXNHcmFwaCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgIF8odGhpc0dyYXBoLmRlZmF1bHROb2RlUG9saWNpZXMpLmZvckVhY2goZnVuY3Rpb24ocG9saWN5KSB7XG4gICAgICAgICAgICAgICAgIFx0aWYgKHBvbGljeS5sb2FkICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgXHRwb2xpY3kubG9hZChzYXZlZFN0YXRlKTtcbiAgICAgICAgICAgICAgICAgXHR9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXyh0aGlzR3JhcGguZGVmYXVsdFBhdGhQb2xpY2llcykuZm9yRWFjaChmdW5jdGlvbihwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgXHRpZiAocG9saWN5LmxvYWQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBcdHBvbGljeS5sb2FkKHNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgICAgICBcdH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICBcdH1cbiAgICBcdHJldHVybiB7XG4gICAgXHRcdFBvbGljeTogU2F2ZVN0YXRlUG9saWN5XG4gICAgXHR9XG59XSk7XG5cblxuXG5cblxuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcG9saWNpZXMnLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcycsIHtcbiAgICAgICAgICAgIHVybDogJy9uZXR3b3JrcG9saWNpZXMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5pc29sYXRpb24nLCB7XG4gICAgICAgICAgICB1cmw6ICcvaXNvbGF0aW9uJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8dWktdmlldy8+J1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuaXNvbGF0aW9uLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnaXNvbGF0aW9ucG9saWN5Y3JlYXRlJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuYmFuZHdpZHRoJywge1xuICAgICAgICAgICAgdXJsOiAnL2JhbmR3aWR0aCcsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPHVpLXZpZXcvPidcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLnJlZGlyZWN0aW9uJywge1xuICAgICAgICAgICAgdXJsOiAnL3JlZGlyZWN0aW9uJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8dWktdmlldy8+J1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwIiwiLyoqXG4gKiBUaGlzIHBvbGljeSBpcyB1c2VkIGZvciBzcGxpdHRpbmcgYSBub2RlIGludG8gaXRzIGNoaWxkcmVuLFxuICogYW5kIGpvaW5pbmcgdGhlbSBiYWNrIHRvIHRoZWlyIHBhcmVudC5cbiAqIFNwbGl0cyBvbiBkb3VibGUgY2xpY2ssIGFuZCBqb2lucyBvbiByaWdodCBjbGljay5cbiAqIElmIG11bHRpcGxlIG5vZGVzIGFyZSBzZWxlY3RlZCBhdCB0aGUgdGltZSBvZiBhIHNwbGl0IG9yIGpvaW4gZXZlbnQsXG4gKiBpdCB3aWxsIHNwbGl0IG9yIGpvaW4gYWxsIG9mIHRoZW0uXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuZ3JhcGgnKVxuICAgIC5mYWN0b3J5KCdTcGxpdEpvaW5Ob2RlUG9saWN5JywgWydOb2RlU2VsZWN0aW9uUG9saWN5JywgJ1Zpc3VhbGl6ZXJOb2RlJywgXG4gICAgXHRcdGZ1bmN0aW9uIChOb2RlU2VsZWN0aW9uUG9saWN5LCBWaXN1YWxpemVyTm9kZSkge1xuXHRcdGNsYXNzIFNwbGl0Sm9pbk5vZGVQb2xpY3kgZXh0ZW5kcyBOb2RlU2VsZWN0aW9uUG9saWN5LlBvbGljeSB7XG5cdFx0XHQvKipcblx0XHRcdCAqIENvbnN0cnVjdHMgdGhlIG9iamVjdC5cblx0XHRcdCAqL1xuICAgICAgICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgICAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBvbGljeU5hbWUgPSBcIlNwbGl0Sm9pbk5vZGVQb2xpY3lcIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgd2hlbiBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0dyYXBofSAgZ3JhcGggICBUaGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5pdGlhbGl6ZShncmFwaCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3VwZXIuaW5pdGlhbGl6ZShncmFwaCk7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZ3JhcGguc3RhdGUuU3BsaXRKb2luTm9kZVBvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLnNwbGl0Tm9kZXMgPSBbXTsgXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVHJpZ2dlcmluZyBzcGxpdCBvbiBkb3VibGUgY2xpY2tcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmplY3R9ICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgZCAgICAgIFRoZSBtYXRjaGluZyBkYXRhIG9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkYmxjbGljayhkM25vZGUsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3VwZXJTdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5Ob2RlUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgaWYgKCFkMy5ldmVudC5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdXBlclN0YXRlLnNlbGVjdGVkTm9kZXMuaW5kZXhPZihkKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNwbGl0TXVsdGlwbGVOb2RlcyhzdXBlclN0YXRlLnNlbGVjdGVkTm9kZXMpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVBbGxTZWxlY3RlZE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNwbGl0Tm9kZShkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUcmlnZ2VyaW5nIGpvaW4gb24gcmlnaHQgY2xpY2tcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7RDNPYmp9ICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgZCAgICAgIFRoZSBtYXRjaGluZyBkYXRhIG9iamVjdFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb250ZXh0bWVudShkM25vZGUsIGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3VwZXJTdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5Ob2RlU2VsZWN0aW9uUG9saWN5O1xuICAgICAgICAgICAgICAgIGQzLmV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgaWYgKCFkMy5ldmVudC5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgdHJ5IHRvIGpvaW4gYSBoaWdobGlnaHRlZCBub2RlIHdoaWxlIG11bHRpcGxlIG5vZGVzIGFyZSBzZWxlY3RlZCxcbiAgICAgICAgICAgICAgICAgICAgLy93ZSBqb2luIGFsbCBoaWdobGlnaHRlZCBub2Rlc1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWROb2RlcyA9IHN1cGVyU3RhdGUuc2VsZWN0ZWROb2RlcztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkTm9kZXMuaW5kZXhPZihkKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGVjdGVkTm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmpvaW5Ob2RlKHNlbGVjdGVkTm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9pZiB3ZSB0cnkgdG8gam9pbiBhIG5vZGUgdGhhdCBpc24ndCBwYXJ0IG9mIGEgaGlnaGxpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAgICAgLy93ZSByZW1vdmUgYWxsIGhpZ2hsaWdodHMgYW5kIHRoZW4gam9pbiB0aGUgY2xpY2tlZCBub2RlXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUFsbFNlbGVjdGVkTm9kZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuam9pbk5vZGUoZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU3BsaXRzIGEgbm9kZS5cbiAgICAgICAgICAgICAqIHVzZWQgdG8gc2hhcmUgY29kZSBiZXR3ZWVuIHNwbGl0Tm9kZSBhbmQgc3BsaXRNdWx0aXBsZU5vZGVzXG4gICAgICAgICAgICAgKiB3aGlsZSBwcmV2ZW50aW5nIHRoZSBoYW5kbGVycyBmb3IgdGhlbSBib3RoIGZpcmluZ1xuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGUgYmVpbmcgc3BsaXRcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtBcnJheX0gIFRoZSBuZXcgbm9kZXMgY3JlYXRlZCBieSB0aGUgc3BsaXRcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgX19zcGxpdE5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5Ob2RlUG9saWN5O1xuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gbm9kZS5pZDtcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIC8vaWYgaXQgaGFzIG5vIGNoaWxkcmVuIHRvIHNwbGl0IGludG9cbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRyZW5fc3RydWN0W25hbWVdID09PSB1bmRlZmluZWQgfHwgXy5pc0VtcHR5KGNoaWxkcmVuX3N0cnVjdFtuYW1lXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vcmVtb3ZpbmcgdGhlIG5vZGUgZnJvbSB0aGUgbGlzdCBvZiBub2Rlc1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlcyA9IF8uZmlsdGVyKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24oZ3JhcGhOb2Rlcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ3JhcGhOb2RlcyAhPSBub2RlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXNHcmFwaC5ub2Rlcyk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlKTtcblxuICAgICAgICAgICAgICAgIC8vZ2V0dGluZyBhbGwgdGhlIG5vZGUgaWQncyBmb3IgZmluZGluZyBmbG93XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVfbmFtZXNfc2V0ID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZV9uYW1lc19zZXQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0uaWQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vc2V0IG9mIG5vZGVzIGFmdGVyIHRoZSBzcGxpdFxuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoaWxkcmVuX3N0cnVjdFtuYW1lXS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBub2RlX25hbWVzX3NldC5wdXNoKGNoaWxkcmVuX3N0cnVjdFtuYW1lXVtpXSk7XG4gICAgICAgICAgICAgICAgICAgIG5ld19ub2Rlcy5wdXNoKGNoaWxkcmVuX3N0cnVjdFtuYW1lXVtpXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciByZXREYXRhID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuZ2V0Rmxvd0JldHdlZW5TZXQobm9kZV9uYW1lc19zZXQpO1xuXG4gICAgICAgICAgICAgICAgLy9mb3JtYXR0aW5nIGRhdGEgZm9yIG5ldyBub2Rlc1xuICAgICAgICAgICAgICAgIHZhciB4TG9jID0gbm9kZS54O1xuICAgICAgICAgICAgICAgIHZhciB5TG9jID0gbm9kZS55O1xuICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvcnMgPSBub2RlLmFuY2VzdG9ycy5zbGljZSgpO1xuICAgICAgICAgICAgICAgIC8va2VlcGluZyBvcmRlcmluZyB0aGF0IGZpcnN0IGluIGFuY2VzdG9yIGxpc3QgaXMgY2xvc2VzdCBpbiByZWxhdGlvbnNoaXBcbiAgICAgICAgICAgICAgICBhbmNlc3RvcnMuc3BsaWNlKDAsIDAsIG5vZGUuaWQpO1xuICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBub2RlLmlkO1xuICAgICAgICAgICAgICAgIHZhciBuZXdfbm9kZV9vYmpzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIHJhZGl1cyA9IG5vZGUucmFkaXVzICogdGhpc0dyYXBoLmNvbnN0cy5yYWRpdXNEZWNheTtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZURhdGEgPSByZXREYXRhLm5vZGVEYXRhO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZURhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgLy9jYWxjdWxhdGluZyB3aGljaCBvZiB0aGUgbm9kZXMgaW4gcmV0RGF0YVswXSBhcmUgbmV3XG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXdfbm9kZXMuaW5kZXhPZihub2RlRGF0YVtpXS5pZCkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkID0gbm9kZURhdGFbaV0uaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IG5vZGVEYXRhW2ldLnRleHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGUgPSBuZXcgVmlzdWFsaXplck5vZGUuTm9kZShudWxsLCBudWxsLCBpZCwgdGV4dCwgcmFkaXVzLCBwYXJlbnQsIGFuY2VzdG9ycywgeExvYywgeUxvYyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdfbm9kZS5pbml0aWFsaXplKHRoaXNHcmFwaCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMucHVzaChuZXdfbm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdfbm9kZV9vYmpzLnB1c2gobmV3X25vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5saW5rcyA9IHRoaXNHcmFwaC5kYXRhU291cmNlLnByb2Nlc3NMaW5rRGF0YShyZXREYXRhLmxpbmtEYXRhLCB0aGlzR3JhcGgubm9kZXMpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5pbml0Tm9kZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdExpbmtzKCk7XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS5zcGxpdE5vZGVzLnB1c2gobm9kZS5pZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ld19ub2RlX29ianM7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU3BsaXRzIHRoZSBnaXZlIG5vZGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGUgYmVpbmcgc3BsaXRcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc3BsaXROb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzID0gdGhpcy5fX3NwbGl0Tm9kZShub2RlKTtcbiAgICAgICAgICAgICAgICBpZiAocmVzID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnNwbGl0Tm9kZUV2ZW50KHJlcyk7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTcGxpdHMgYWxsIHRoZSBub2RlcyBwYXNzZWQgaW5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7QXJyYXl9ICBub2RlcyAgIEFycmF5IG9mIG5vZGVzIHRvIGJlIHNwbGl0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNwbGl0TXVsdGlwbGVOb2Rlcyhub2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoO1xuICAgICAgICAgICAgICAgIHZhciByZXNOb2RlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IHRoaXMuX19zcGxpdE5vZGUobm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICByZXNOb2RlcyA9IHJlc05vZGVzLmNvbmNhdChyZXMpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuc3BsaXRNdWx0aXBsZU5vZGVzRXZlbnQocmVzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDYWxsZWQgYWZ0ZXIgYSBzaW5nbGUgbm9kZSBpcyBzcGxpdFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5ld05vZGVzICBUaGUgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNwbGl0Tm9kZUV2ZW50KG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNldFBvc2l0aW9ucygpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBtdWx0aXBsZSBub2RlcyBhcmUgc3BsaXQgYXQgb25jZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5ld05vZGVzICBUaGUgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNwbGl0TXVsdGlwbGVOb2Rlc0V2ZW50KG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGg7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNldFBvc2l0aW9ucygpO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIHVzZWQgdG8gc2hhcmUgY29kZSBiZXR3ZWVuIGpvaW5Ob2RlIGFuZCBqb2luTXVsdGlwbGVOb2RlXG4gICAgICAgICAgICAgKiB3aGlsZSBwcmV2ZW50aW5nIGJvdGggaGFuZGxlcnMgZmlyaW5nXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgICAgICBub2RlICAgIFRoZSBub2RlIHRvIGpvaW5cbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtOb2RlfSAgVGhlIG5ldyBub2RlIGFmdGVyIHRoZSBqb2luXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIF9fam9pbk5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5Ob2RlUG9saWN5O1xuXG4gICAgICAgICAgICAgICAgLy9jaGVjayB0aGF0IG5vZGUgc3RpbGwgZXhpc3RzXG4gICAgICAgICAgICAgICAgaWYgKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG5vZGUpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gbm9kZS5pZDtcbiAgICAgICAgICAgICAgICAvL2lmIGl0IGhhcyBubyBhbmNlc3Rvciwgbm90aGluZyB0byBqb2luXG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbC5pbmRleE9mKG5hbWUpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciB0b19iZV9kZWxldGVkID0gW107XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVfbmFtZXNfc2V0ID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgLy9pZiBub2RlIHdvbid0IGJlIGNvbGxhcHNlZFxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLm5vZGVzW2ldLmFuY2VzdG9ycy5pbmRleE9mKG5vZGUucGFyZW50KSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZV9uYW1lc19zZXQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0uaWQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9fYmVfZGVsZXRlZC5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlX2lkID0gbm9kZS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgbm9kZV9uYW1lc19zZXQucHVzaChub2RlLnBhcmVudCk7XG5cbiAgICAgICAgICAgICAgICAvL2Zvcm1hdHRpbmcgZGF0YVxuICAgICAgICAgICAgICAgIHZhciByYWRpdXMgPSBub2RlLnJhZGl1cyAvIHRoaXNHcmFwaC5jb25zdHMucmFkaXVzRGVjYXk7IFxuICAgICAgICAgICAgICAgIHZhciB4TG9jID0gbm9kZS54O1xuICAgICAgICAgICAgICAgIHZhciB5TG9jID0gbm9kZS55O1xuICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBub2RlLmFuY2VzdG9yc1sxXTtcbiAgICAgICAgICAgICAgICB2YXIgYW5jZXN0b3JzID0gbm9kZS5hbmNlc3RvcnMuc2xpY2UoMSk7XG4gICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlID0gbmV3IFZpc3VhbGl6ZXJOb2RlLk5vZGUoeExvYywgeUxvYywgbmV3X25vZGVfaWQsIG5ld19ub2RlX2lkLCByYWRpdXMsIHBhcmVudCwgYW5jZXN0b3JzKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMucHVzaChuZXdfbm9kZSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgcmV0RGF0YSA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmdldEZsb3dCZXR3ZWVuU2V0KG5vZGVfbmFtZXNfc2V0KTtcbiAgICAgICAgICAgICAgICAvL3JlbW92ZSBhbGwgbm9kZXMgdGhhdCB3aWxsIGJlIGpvaW5lZFxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdG9fYmVfZGVsZXRlZC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZV90b19kZWxldGUgPSB0b19iZV9kZWxldGVkW2ldO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMuc3BsaWNlKHRoaXNHcmFwaC5ub2Rlcy5pbmRleE9mKG5vZGVfdG9fZGVsZXRlKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zcGxpY2VMaW5rc0Zvck5vZGUobm9kZV90b19kZWxldGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubGlua3MgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5wcm9jZXNzTGlua0RhdGEocmV0RGF0YS5saW5rRGF0YSwgdGhpc0dyYXBoLm5vZGVzKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXRMaW5rcygpO1xuXG4gICAgICAgICAgICAgICAgc3RhdGUuc3BsaXROb2Rlcy5zcGxpY2Uoc3RhdGUuc3BsaXROb2Rlcy5pbmRleE9mKG5ld19ub2RlLmlkKSwgMSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3X25vZGU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogSm9pbnMgdGhlIGdpdmVuIG5vZGVcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5vZGUgICAgVGhlIG5vZGUgdG8gam9pblxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBqb2luTm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5ld05vZGUgPSB0aGlzLl9fam9pbk5vZGUobm9kZSk7XG4gICAgICAgICAgICAgICAgaWYgKG5ld05vZGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIFx0dGhpcy5qb2luTm9kZUV2ZW50KG5ld05vZGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBKb2lucyBhbGwgdGhlIGdpdmVuIG5vZGVzXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbm9kZXMgICBUaGUgbm9kZXMgdG8gam9pblxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBqb2luTXVsdGlwbGVOb2RlKG5vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IHRoaXMuX19qb2luTm9kZShub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIG5ld19ub2Rlcy5wdXNoKHJlcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuam9pbk11bHRpcGxlTm9kZXNFdmVudChuZXdfbm9kZXMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBhIHNpbmdsZSBub2RlIGlzIGpvaW5lZFxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgbmV3Tm9kZSAgVGhlIG5ldyBub2RlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGpvaW5Ob2RlRXZlbnQobmV3Tm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBtdWx0aXBsZSBub2RlcyBhcmUgam9pbmVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0FycmF5fSAgbmV3Tm9kZXMgIFRoZSBuZXcgbm9kZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgam9pbk11bHRpcGxlTm9kZXNFdmVudChuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIFBvbGljeTogU3BsaXRKb2luTm9kZVBvbGljeVxuICAgICAgICB9XG59XSk7XG5cblxuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtzJywge1xuICAgICAgICAgICAgdXJsOiAnL25ldHdvcmtzJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwIiwiLyoqXG4gKiBUaGlzIHBvbGljeSBpcyB1c2VkIHRvIGNoYW5nZSB0aGUgdmlldyB0byBmb2N1cyBvbiBzcGxpdHRpbmcgYW5kIFxuICogam9pbmluZyBldmVudHMuXG4gKiBPdmVycmlkZXMgdGhlIGNlcnRhaW4gZm9yY2UgbGF5b3V0IGZ1bmN0aW9ucyBvZiB0aGUgZ3JhcGggdG8gcGFydGl0aW9uIGEgc3BsaXRcbiAqIGludG8gdGhlIGZvY3VzZWQgbm9kZXMgYW5kIHRoZSBjb25uZWN0ZWQgbm9kZXMuXG4gKiBcbiAqIEhhcyBzYXZlL2xvYWQgbWV0aG9kcyBmb3IgdGhlIHNhdmUgc3RhdGUgcG9saWN5LlxuICogSGFzIGJhY2sgYnV0dG9uIHN1cHBvcnQuXG4gKiBDYW4gYXV0byBjaGFuZ2UgdGhlIHRpdGxlIG9mIHRoZSBncmFwaC5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ncmFwaCcpXG4gICAgLmZhY3RvcnkoJ1NwbGl0Sm9pblZpZXdQb2xpY3knLCBbJ1NwbGl0Sm9pbk5vZGVQb2xpY3knLCAnVmlzdWFsaXplck5vZGUnLCBmdW5jdGlvbiAoU3BsaXRKb2luTm9kZVBvbGljeSwgVmlzdWFsaXplck5vZGUpIHsgXG4gICAgICAgIGNsYXNzIFNwbGl0Sm9pblZpZXdQb2xpY3kgZXh0ZW5kcyBTcGxpdEpvaW5Ob2RlUG9saWN5LlBvbGljeXtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0LlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgICAgICBzdXBlcigpO1xuICAgICAgICAgICAgICAgIHRoaXMucG9saWN5TmFtZSA9IFwiU3BsaXRKb2luVmlld1BvbGljeVwiO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7R3JhcGh9ICBncmFwaCAgIFRoZSBncmFwaFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbml0aWFsaXplKGdyYXBoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdXBlci5pbml0aWFsaXplKGdyYXBoKTtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBncmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgc3RhdGUuc2F2ZWRTdGF0ZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAvLyBzdGF0ZS5mb2N1c0dyb3VwID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkgPSBbXTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3VwcyA9IFtdO1xuICAgICAgICAgICAgICAgIHN0YXRlLmZvY2kgPSBbXTtcbiAgICAgICAgICAgICAgICBzdGF0ZS56b29tcyA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLmxheW91dCA9IHt9O1xuICAgICAgICAgICAgICAgIHN0YXRlLmxheW91dERlZmF1bHQgPSBudWxsO1xuICAgICAgICAgICAgICAgIHN0YXRlLnpvb21EZWZhdWx0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS5ub2RlSWRzVG9SZXNob3cgPSBudWxsO1xuICAgICAgICAgICAgICAgIHN0YXRlLmJhY2tCdXR0b25FbGVtID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzdGF0ZS50aXRsZUVsZW0gPSBudWxsO1xuXG4gICAgICAgICAgICAgICAgdmFyIGNvbnN0cyA9IGdyYXBoLmNvbnN0cy5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgY29uc3RzLmJvdW5kYXJ5ID0gMC44O1xuXG4gICAgICAgICAgICAgICAgLy9vdmVycmlkaW5nIGQzZm9yY2UgbWV0aG9kcyBvZiB0aGUgZ3JhcGguXG4gICAgICAgICAgICAgICAgZ3JhcGguZDNGb3JjZUJvdW5kcyA9IHRoaXMuZDNGb3JjZUJvdW5kcztcbiAgICAgICAgICAgICAgICBncmFwaC5kM0ZvcmNlVGljayA9IHRoaXMuZDNGb3JjZVRpY2s7XG4gICAgICAgICAgICAgICAgZ3JhcGguZDNGb3JjZVN0YXJ0ID0gdGhpcy5kM0ZvcmNlU3RhcnQ7XG4gICAgICAgICAgICAgICAgZ3JhcGguZDNGb3JjZUVuZCA9IHRoaXMuZDNGb3JjZUVuZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBMaW5rcyB0aGUgcHJvdmlkZWQgZWxlbWVudCBhIGJhY2sgYnV0dG9uIGZlYXR1cmVcbiAgICAgICAgICAgICAqIERvZXNuJ3QgdHJpZ2dlciB0aGUgb24tY2xpY2sgZXZlbnRcbiAgICAgICAgICAgICAqIFRoYXQgc2hvdWxkIGJlIGRvbmUgdGhyb3VnaCBhbmd1bGFyIG5nLWNsaWNrLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtqUXVlcnl9ICBlbGVtICAgIFRoZSBqcXVlcnkgc2VsZWN0ZWQgZWxlbWVudFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbnN0YWxsQmFja0J1dHRvbihlbGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kgPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgc3RhdGUuYmFja0J1dHRvbkVsZW0gPSBlbGVtO1xuICAgICAgICAgICAgICAgIHN0YXRlLmJhY2tCdXR0b24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnVuZG9MYXN0RXZlbnQuY2FsbCh0aGlzUG9saWN5KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBXaWxsIGFsbG93IHRoaXMgcG9saWN5IHRvIGNoYW5nZSB0aGUgdGl0bGUgb2YgdGhlIGdyYXBoXG4gICAgICAgICAgICAgKiBhcyBzcGxpdCBhbmQgam9pbiBldmVudHMgb2NjdXIuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge2pRdWVyeX0gIGVsZW0gICAgVGhlIGpxdWVyeSBzZWxlY3RlZCBlbGVtZW50XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluc3RhbGxUaXRsZShlbGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICBzdGF0ZS50aXRsZUVsZW0gPSBlbGVtO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCB3aGVuIHRoZSBncmFwaCBpcyBiZWluZyBkZXN0cm95ZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgc2F2ZWRTdGF0ZSAgQW55IHByb3BlcnR5IG9uIHRoaXNcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3Qgd2lsbCBiZSBhY2Nlc3NpYmxlXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiB0aGUgdmlldyByZWxvYWRzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGRlc3Ryb3koc2F2ZWRTdGF0ZSkge1xuICAgICAgICAgICAgICAgIC8vT25seSBpZiB0aGUgc2F2ZSBzdGF0ZSBwb2xpY3kgaXMgaW5zdGFsbGVkXG4gICAgICAgICAgICAgICAgaWYgKHNhdmVkU3RhdGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNhdmUoc2F2ZWRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgc2F2ZSB0aGUgY3VycmVudCBzdGF0ZSwgYW5kIGFsbCBoaXN0b3J5LlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBzYXZlZFN0YXRlICBBbnkgcHJvcGVydHkgb24gdGhpc1xuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdCB3aWxsIGJlIGFjY2Vzc2libGVcbiAgICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGVuIHRoZSB2aWV3IHJlbG9hZHNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc2F2ZShzYXZlZFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICAgICAgdmFyIGxpbmtzID0gdGhpc0dyYXBoLmxpbmtzO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyVGl0bGUgPSBudWxsO1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS50aXRsZUVsZW0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBjdXJyVGl0bGUgPSBzdGF0ZS50aXRsZUVsZW0udGV4dCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZm9jdXNHcm91cHMgPSBzdGF0ZS5mb2N1c0dyb3VwcztcbiAgICAgICAgICAgICAgICB2YXIgZXZlbnRIaXN0b3J5ID0gc3RhdGUuZXZlbnRIaXN0b3J5O1xuICAgICAgICAgICAgICAgIHZhciB6b29tcyA9IHN0YXRlLnpvb21zO1xuICAgICAgICAgICAgICAgIHZhciBsYXlvdXQgPSBzdGF0ZS5sYXlvdXQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgbGF5b3V0RGVmYXVsdCA9IHN0YXRlLmxheW91dERlZmF1bHQ7XG4gICAgICAgICAgICAgICAgdmFyIHpvb21EZWZhdWx0ID0gc3RhdGUuem9vbURlZmF1bHQ7XG4gICAgICAgICAgICAgICAgdmFyIHJldCA9IHtub2Rlczpub2RlcywgbGlua3M6bGlua3MsIFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZXM6c3RhdGUuc2F2ZWRTdGF0ZXMsIGN1cnJUaXRsZTpjdXJyVGl0bGUsIFxuICAgICAgICAgICAgICAgICAgICBmb2N1c0dyb3VwczogZm9jdXNHcm91cHMsXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50SGlzdG9yeTpldmVudEhpc3RvcnksIHpvb21zOnpvb21zLFxuICAgICAgICAgICAgICAgICAgICBsYXlvdXQ6bGF5b3V0LCBsYXlvdXREZWZhdWx0OmxheW91dERlZmF1bHQsXG4gICAgICAgICAgICAgICAgICAgIHpvb21EZWZhdWx0Onpvb21EZWZhdWx0fTtcbiAgICAgICAgICAgICAgICBzYXZlZFN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3kgPSByZXQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2lsbCBiZSBjYWxsZWQgd2hlbiB0aGUgZ3JhcGggaXMgcmVsb2FkZWQsIGFzc3VtaW5nXG4gICAgICAgICAgICAgKiBzYXZlIHN0YXRlIHBvbGljeSBpcyBpbnN0YWxsZWRcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgbG9hZFN0YXRlICBDb250YWlucyBhbGwgdGhlIHNhdmVkXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJpYWJsZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgbG9hZChsb2FkU3RhdGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc1BvbGljeSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICBsb2FkU3RhdGUgPSBsb2FkU3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5zYXZlZFN0YXRlcyA9IGxvYWRTdGF0ZS5zdGF0ZXM7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzID0gbG9hZFN0YXRlLmxpbmtzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlcyA9IGxvYWRTdGF0ZS5ub2RlcztcblxuICAgICAgICAgICAgICAgIHZhciBjdXJyVGl0bGUgPSBsb2FkU3RhdGUuY3VyclRpdGxlO1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS50aXRsZUVsZW0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS50aXRsZUVsZW0udGV4dChjdXJyVGl0bGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkgPSBsb2FkU3RhdGUuZXZlbnRIaXN0b3J5O1xuICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzID0gbG9hZFN0YXRlLmZvY3VzR3JvdXBzO1xuICAgICAgICAgICAgICAgIHN0YXRlLnpvb21zID0gbG9hZFN0YXRlLnpvb21zO1xuICAgICAgICAgICAgICAgIHN0YXRlLmxheW91dCA9IGxvYWRTdGF0ZS5sYXlvdXQ7XG4gICAgICAgICAgICAgICAgc3RhdGUubGF5b3V0RGVmYXVsdCA9IGxvYWRTdGF0ZS5sYXlvdXREZWZhdWx0O1xuICAgICAgICAgICAgICAgIHN0YXRlLnpvb21EZWZhdWx0ID0gbG9hZFN0YXRlLnpvb21EZWZhdWx0O1xuXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmJhY2tCdXR0b25FbGVtICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uRWxlbS5mYWRlVG8oJ3Nsb3cnLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG5cbiAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoXy5pbmNsdWRlcyhjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImZvY3VzXCI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiY29ubmVjdGVkXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vbG9hZGluZyBhIHByZXZpb3VzIGxheW91dFxuICAgICAgICAgICAgICAgIHZhciBsYXlvdXQ7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBsYXlvdXQgPSBzdGF0ZS5sYXlvdXREZWZhdWx0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbSA9IHN0YXRlLnpvb21EZWZhdWx0OyBcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh6b29tWzBdLCB6b29tWzFdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbSA9IHN0YXRlLnpvb21zW3N0YXRlLmZvY3VzR3JvdXBzXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHpvb20gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh6b29tWzBdLCB6b29tWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBsYXlvdXQgPSBzdGF0ZS5sYXlvdXRbc3RhdGUuZm9jdXNHcm91cHNdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vbGF5b3V0IGNhbid0IGJlIG51bGxcbiAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbihuKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwb3MgPSBsYXlvdXRbbi5pZF07XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb3MgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cobGF5b3V0LCBuKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBuLnggPSBwb3MueDtcbiAgICAgICAgICAgICAgICAgICAgbi55ID0gcG9zLnk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN0YXRlLmluaXRGb3JjZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoLmNhbGwodGhpc0dyYXBoLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51cGRhdGVHcmFwaENhbGxiYWNrLmNhbGwodGhpc1BvbGljeSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVHJpZ2dlcmluZyBzcGxpdCBvbiBkb3VibGUgY2xpY2tcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogRm9jdXMgZ3JvdXAgc3RvcmVzIHRoZSBub2RlIHRoYXQgaXMgYWJvdXQgdG8gYmUgc3BsaXQuXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIFdoZW4gZm9jdXMgZ3JvdXAgaGFzIGxlbmd0aCAwLCB0aGUgZmlyc3Qgc3BsaXQgXG4gICAgICAgICAgICAgKiB3aWxsIGp1c3QgYmUgcHVzaGVkIG9uLlxuICAgICAgICAgICAgICogVGhlIG5vZGUgd2lsbCBiZSBzcGxpdCBhbmQgcHVzaGVkIHRvIHRoZSB0b3AgaGFsZiBcbiAgICAgICAgICAgICAqIG9mIHRoZSBzY3JlZW4sIGFuZCB0aGUgYm90dG9tIGhhbGYgd2lsbCBjb250YWluIGFueVxuICAgICAgICAgICAgICogbm9kZXMgaXQgaGFzIGNvbm5lY3Rpb25zIHRvLlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBXaGVuIGEgZm9jdXMgZ3JvdXAgbGVuZ3RoIGlzID49IDEsIGlmIHRoZSBub2RlIHRvIGJlXG4gICAgICAgICAgICAgKiBzcGxpdCBpcyBhIGZvY3VzIG5vZGUsIGl0IHdpbGwgcmVwbGFjZSBmb2N1c0dyb3Vwc1swXSBhbmRcbiAgICAgICAgICAgICAqIHRoZSB0b3AgaGFsZiB3aWxsIGJlIGl0cyBjaGlsZHJlbiwgYW5kIGJvdHRvbSBoYWxmIHdpbGxcbiAgICAgICAgICAgICAqIGJlIHRoZSBub2RlcyBpdCBoYXMgY29ubmVjdGlvbnMgdG8uXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIElmIHRoZSBzcGxpdCBpcyBpbiB0aGUgYm90dG9tIGhhbGYsIHRoZW4gdGhlIGJvdHRvbSBoYWxmXG4gICAgICAgICAgICAgKiB3aWxsIGRpc3BsYXkgaXQncyBjaGlsZHJlbiBhbmQgd2lsbCBvbmx5IHNob3cgY29ubmVjdGlvbnMgYmV0d2VlblxuICAgICAgICAgICAgICogdGhlIHR3byBncm91cHMsIGFuZCB3aWxsIHJlcGxhY2UgZm9jdXNHcm91cHNbMV0uXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtEM09ian0gICBkM25vZGUgIFRoZSBkMyBub2RlXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7T2JqZWN0fSAgZCAgICAgICBUaGUgbWF0Y2hpbmcgZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZGJsY2xpY2soZDNub2RlLCBkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICAvL2NoZWNrIGlmIGNhbiBzcGxpdFxuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gZC5pZDtcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5fc3RydWN0ID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgIGlmIChjaGlsZHJlbl9zdHJ1Y3RbbmFtZV0gPT09IHVuZGVmaW5lZCB8fCBfLmlzRW1wdHkoY2hpbGRyZW5fc3RydWN0W25hbWVdKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMuc2xpY2UoKTtcblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDApIHsgLy90b3BsZXZlbCBzcGxpdFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwcy5wdXNoKGQuaWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXy5pbmNsdWRlcyhjaGlsZHJlbl9zdHJ1Y3Rbc3RhdGUuZm9jdXNHcm91cHNbMF1dLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5pZCkpIHsgLy9zcGxpdHRpbmcgYSBmb2N1cyBub2RlXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzWzBdID0gZC5pZDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMSkgey8vc3BsaXR0aW5nIGFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29ubmVjdGVkIG5vZGVcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHMucHVzaChkLmlkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKF8uaW5jbHVkZXMoY2hpbGRyZW5fc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzFdXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5pZCkpIHsvL3NwbGl0dGluZyBhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25uZWN0ZWQgbm9kZVxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwc1sxXSA9IGQuaWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAyICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuZm9jdXNHcm91cHNbMV0gPT09IGQuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9TcGxpdHRpbmcgYSBjb25uZWN0ZWQgbm9kZSwga2VlcCBhbGwgZm9jdXMgbm9kZXNcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVzVG9LZWVwID0gW2RdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZUlkc1RvUmVzaG93ID0gW107XG4gICAgICAgICAgICAgICAgICAgIHZhciBncm91cE9uZU5vZGVzID0gY2hpbGRyZW5fc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzBdXTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF8uaW5jbHVkZXMoZ3JvdXBPbmVOb2Rlcywgbm9kZS5pZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlSWRzVG9SZXNob3cucHVzaChub2RlLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1RvS2VlcC5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL01ha2Ugc3BsaXQgbm9kZXMgdGhlIGZvY3VzIGFuZCBrZWVwIG5vZGVzIHRoYXQgYXJlIGNvbm5lY3RlZFxuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZXNUb0tlZXAgPSBbZF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlSWRzVG9SZXNob3cgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5saW5rcywgZnVuY3Rpb24obGluaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmsuc291cmNlID09PSBkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHNUb1Jlc2hvdy5pbmRleE9mKGxpbmsudGFyZ2V0LmlkKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsudGFyZ2V0LlNwbGl0Sm9pblZpZXdQb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rLnRhcmdldC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImNvbm5lY3RlZFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHNUb1Jlc2hvdy5wdXNoKGxpbmsudGFyZ2V0LmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1RvS2VlcC5wdXNoKGxpbmsudGFyZ2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobGluay50YXJnZXQgPT09IGQgJiYgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHNUb1Jlc2hvdy5pbmRleE9mKGxpbmsuc291cmNlLmlkKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsuc291cmNlLlNwbGl0Sm9pblZpZXdQb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rLnNvdXJjZS5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImNvbm5lY3RlZFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHNUb1Jlc2hvdy5wdXNoKGxpbmsuc291cmNlLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1RvS2VlcC5wdXNoKGxpbmsuc291cmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9SZW1vdmluZyBsaW5rcyBmcm9tIHRoZSBub2RlIHRvIGJlIHNwbGl0XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZWFjaChmdW5jdGlvbihub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLmlkICE9PSBkLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3BsaWNlTGlua3NGb3JOb2RlKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLnVwZGF0ZUdyYXBoKCk7XG5cbiAgICAgICAgICAgICAgICAvL2Rpc2FibGluZyB1cGRhdGUgZ3JhcGggdG8gcHJldmVudCBuZXcgZGF0YSBmcm9tXG4gICAgICAgICAgICAgICAgLy9yZWRyYXdpbmcgbGlua3Mgd2hpbGUgdGhlcmUgYXJlIGFuaW1hdGlvbnMgZ29pbmcgb25cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguc3RhdGUuZGlzYWJsZVVwZGF0ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmNpcmNsZXMuZWFjaChmdW5jdGlvbihub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLmlkICE9PSBkLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykudHJhbnNpdGlvbigpLmRlbGF5KDIwMCkuZHVyYXRpb24oNDAwKS5zdHlsZShcIm9wYWNpdHlcIiwgMCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2Rpc2FibGluZyBxdGlwIGlmIGluc3RhbGxlZFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQodGhpcykucXRpcCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5xdGlwKCdkaXNhYmxlJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHZhciB0cmFuc2xhdGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKTtcbiAgICAgICAgICAgICAgICB2YXIgc2NhbGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpO1xuICAgICAgICAgICAgICAgIHZhciB4TG9jID0gKHBhcnNlRmxvYXQodGhpc0dyYXBoLnN2Zy5zdHlsZShcIndpZHRoXCIpKSAvIHNjYWxlKSAvIDIgICsgdHJhbnNsYXRlWzBdO1xuICAgICAgICAgICAgICAgIHZhciB5TG9jID0gKHBhcnNlRmxvYXQodGhpc0dyYXBoLnN2Zy5zdHlsZShcImhlaWdodFwiKSkgLyBzY2FsZSkvIDIgICsgdHJhbnNsYXRlWzFdO1xuICAgICAgICAgICAgICAgIGQueFN0YXJ0ID0gZC54O1xuICAgICAgICAgICAgICAgIGQueVN0YXJ0ID0gZC55O1xuICAgICAgICAgICAgICAgIGQueCA9IHhMb2M7XG4gICAgICAgICAgICAgICAgZC55ID0geUxvYztcbiAgICAgICAgICAgICAgICBkM25vZGUudHJhbnNpdGlvbihcIm5vZGVQb3NpdGlvblRyYW5zaXRpb25cIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kdXJhdGlvbig3NTApXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0clR3ZWVuKFwidHJhbnNmb3JtXCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgeFN0YXJ0ID0gZC54U3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHlTdGFydCA9IGQueVN0YXJ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueFN0YXJ0ID0gZC54O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueVN0YXJ0ID0gZC55O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkMy5pbnRlcnBvbGF0ZVN0cmluZyhcInRyYW5zbGF0ZShcIiArIHhTdGFydCArIFwiLFwiICsgeVN0YXJ0ICsgXCIpXCIsIFwidHJhbnNsYXRlKFwiICsgZC54ICsgXCIsXCIgKyBkLnkgKyBcIilcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHZhciBzcGxpdE5vZGVGdW5jID0gc3VwZXIuc3BsaXROb2RlO1xuICAgICAgICAgICAgICAgIHN0YXRlLm5vZGVJZHNUb1Jlc2hvdyA9IG5vZGVJZHNUb1Jlc2hvdztcbiAgICAgICAgICAgICAgICAvL3dhaXRpbmcgZm9yIG5vZGUgdHJhbnNpdGlvblxuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMgPSBub2Rlc1RvS2VlcDtcbiAgICAgICAgICAgICAgICAgICAgc3BsaXROb2RlRnVuYy5jYWxsKHRoaXNQb2xpY3ksIGQpO1xuICAgICAgICAgICAgICAgIH0sIDc1MCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVG8gYmUgY2FsbGVkIGFmdGVyIHRoZSBncmFwaCBpcyBzcGxpdC5cbiAgICAgICAgICAgICAqIEJyaW5ncyBhbGwgbm9kZXMgYmFjayBpbnRvIHZpZXcgYW5kIHNldHMgdGhlaXIgYXR0cmlidXRlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB1cGRhdGVHcmFwaENhbGxiYWNrKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzLmVhY2goZnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLnRyYW5zaXRpb24oKS5kdXJhdGlvbig0MDApLnN0eWxlKFwib3BhY2l0eVwiLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5jbGFzc2VkKFwiZm9jdXNcIiwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLmNsYXNzZWQoXCJjb25uZWN0ZWRcIiwgZmFsc2UpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5TcGxpdEpvaW5WaWV3UG9saWN5ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPT09IFwiZm9jdXNcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykuY2xhc3NlZChcImZvY3VzXCIsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobm9kZS5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPT09IFwiY29ubmVjdGVkXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLmNsYXNzZWQoXCJjb25uZWN0ZWRcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ub2RlSWRzVG9SZXNob3cgPSBudWxsO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC51cGRhdGVHcmFwaCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJhbmRvbWx5IHNldHMgdGhlIHBvc2l0aW9ucyBvZiBhbnkgdW5zZXQgbm9kZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzZXRQb3NpdGlvbnMoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kgPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBncmFwaENvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHM7XG5cbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gZ3JhcGhDb25zdHMuZGlzcGxheU9mZnNldDtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzR3JhcGgubm9kZXM7XG4gICAgICAgICAgICAgICAgdmFyIHJldCA9IHRoaXNQb2xpY3kuZDNGb3JjZUJvdW5kcy5jYWxsKHRoaXNHcmFwaCk7XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZXRSYW5kb21JbnQobWluLCBtYXgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4gKyAxKSkgKyBtaW47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKG5vZGVzLCBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLnggPT0gbnVsbCB8fCBub2RlLnkgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHggPSBnZXRSYW5kb21JbnQobm9kZS5yYWRpdXMgKyBvZmZzZXQsIHJldC53aWR0aCAtIG5vZGUucmFkaXVzIC0gb2Zmc2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB5ID0gZ2V0UmFuZG9tSW50KG5vZGUucmFkaXVzICsgb2Zmc2V0LCByZXQuaGVpZ2h0IC0gbm9kZS5yYWRpdXMgLSBvZmZzZXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS54ID0geDtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUueSA9IHk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBvbiB0aGUgc3RhcnQgb2YgdGhlIGQzIGZvcmNlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqIFdpbGwgb3ZlcnJpZGUgdGhlIG1ldGhvZCBvZiB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqIFwidGhpc1wiIHBvaW50cyB0byB0aGUgZ3JhcGhcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZVN0YXJ0KCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjeCcsIGZ1bmN0aW9uKGQpIHsgXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC54U3RhcnQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueFN0YXJ0ID0gKGQueFN0YXJ0ICogdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKSkgKyB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkLng7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjeScsIGZ1bmN0aW9uKGQpIHsgXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC55U3RhcnQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueVN0YXJ0ID0gKGQueVN0YXJ0ICp0aGlzR3JhcGguZHJhZ1N2Zy5zY2FsZSgpKSArIHRoaXNHcmFwaC5kcmFnU3ZnLnRyYW5zbGF0ZSgpWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQueTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgucGF0aHNcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kxJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zb3VyY2UueTsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3kyJywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueTsgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIG9uIHRoZSBzdGFydCBvZiB0aGUgZDMgZm9yY2Ugc2ltdWxhdGlvblxuICAgICAgICAgICAgICogV2lsbCBvdmVycmlkZSB0aGUgbWV0aG9kIG9mIHRoZSBncmFwaFxuICAgICAgICAgICAgICogXCJ0aGlzXCIgcG9pbnRzIHRvIHRoZSBncmFwaFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkM0ZvcmNlRW5kKCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kgPSBzdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZVBvbGljeS5sYXlvdXREZWZhdWx0ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZmF1bHRMYXlvdXQgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24obikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdExheW91dFtuLmlkXSA9IHt4Om4ueCwgeTpuLnl9O1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kubGF5b3V0RGVmYXVsdCA9IGRlZmF1bHRMYXlvdXQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzY2FsZSA9IHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0cmFuc2xhdGUgPSB0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kuem9vbURlZmF1bHQgPSBbdHJhbnNsYXRlLCBzY2FsZV07IFxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjeCcsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQueDsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2N5JywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC55OyB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRocy5hdHRyKCd4MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MScsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLnk7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd4MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lng7IH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MicsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lnk7IH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdpbGwgYmUgY2FsbGVkIGR1cmluZyBEMyBmb3JjZSBzaW11bGF0aW9uc1xuICAgICAgICAgICAgICogYnkgdGhlIGdyYXBoLCBzbyBcInRoaXNcIiB3aWxsIHBvaW50IHRvIHRoZSBncmFwaCBvYmplY3RcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7bnVtYmVyfSAgd2lkdGggICBEMyBMYXlvdXQgV2lkdGhcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtudW1iZXJ9ICBoZWlnaHQgIEQzIExheW91dCBIZWlnaHRcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZVRpY2soZSwgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzID0gdGhpc0dyYXBoLmNvbnN0cyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVQb2xpY3kgPSBzdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IGNvbnN0cy5kaXNwbGF5T2Zmc2V0O1xuICAgICAgICAgICAgICAgIHZhciBzY2FsZSA9IHRoaXNHcmFwaC5kcmFnU3ZnLnNjYWxlKCk7XG5cbiAgICAgICAgICAgICAgICAvLyBNb3ZlIG5vZGVzIHRvd2FyZCBjbHVzdGVyIGZvY3VzLlxuICAgICAgICAgICAgICAgIHZhciBmb2NpID0gc3RhdGVQb2xpY3kuZm9jaTtcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBncmF2aXR5KGFscGhhKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm9jaS5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPT09IFwiZm9jdXNcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnkgKz0gKGZvY2lbMF0gLSBkLnkpICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55ICs9IChmb2NpWzFdIC0gZC55KSAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnggKz0gKHdpZHRoLzIgLSBkLngpICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSArPSAoaGVpZ2h0LzIgLSBkLnkpICogYWxwaGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC54ICs9ICh3aWR0aC8yIC0gZC54KSAqIGFscGhhO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIE1ha2Ugc3VyZSBub2RlcyBhcmUgd2l0aGluIGJvdW5kc1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5jaXJjbGVzXG4gICAgICAgICAgICAgICAgICAgIC5lYWNoKHRoaXMuZDNGb3JjZUNvbGxpZGUoLjUpKVxuICAgICAgICAgICAgICAgICAgICAuZWFjaChncmF2aXR5KC4yICogZS5hbHBoYSkpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiY3hcIiwgZnVuY3Rpb24oZCkgeyBcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnggPSBNYXRoLm1heCgoZC5yYWRpdXMgKyBvZmZzZXQpL3NjYWxlLCBNYXRoLm1pbih3aWR0aCArICgoLW9mZnNldC0gZC5yYWRpdXMpIC8gc2NhbGUpLCBkLngpKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJjeVwiLCBmdW5jdGlvbihkKSB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuU3BsaXRKb2luVmlld1BvbGljeSA9PSBudWxsIHx8IGQuU3BsaXRKb2luVmlld1BvbGljeSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55ID0gTWF0aC5tYXgoKGQucmFkaXVzICsgb2Zmc2V0KS9zY2FsZSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLm1pbihoZWlnaHQgKyAoKC1vZmZzZXQgLSBkLnJhZGl1cykvc2NhbGUpLCBkLnkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9PT0gXCJmb2N1c1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC55ID0gTWF0aC5tYXgoZC5yYWRpdXMgKyBvZmZzZXQsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5taW4oKGhlaWdodCArICgoLW9mZnNldCAtIGQucmFkaXVzKS9zY2FsZSkpKmNvbnN0cy5TcGxpdEpvaW5WaWV3UG9saWN5LmJvdW5kYXJ5LCBkLnkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9PT0gXCJjb25uZWN0ZWRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQueSA9IE1hdGgubWF4KChoZWlnaHQgKyAoKG9mZnNldCAtIGQucmFkaXVzKS9zY2FsZSkpICpjb25zdHMuU3BsaXRKb2luVmlld1BvbGljeS5ib3VuZGFyeSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLm1pbihoZWlnaHQgKyAoKC1vZmZzZXQgLSBkLnJhZGl1cykvc2NhbGUpLCBkLnkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC55O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5wYXRoc1xuICAgICAgICAgICAgICAgICAgICAuYXR0cigneDEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTEnLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS55OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneDInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC54OyB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneTInLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRhcmdldC55OyB9KTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGN1bGF0ZXMgdGhlIGJvdW5kYXJpZXMgb2YgdGhlIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogV2lsbCBiZSBjYWxsZWQgZHVyaW5nIEQzIGZvcmNlIHNpbXVsYXRpb25zXG4gICAgICAgICAgICAgKiBieSB0aGUgZ3JhcGgsIHNvIFwidGhpc1wiIHdpbGwgcG9pbnQgdG8gdGhlIGdyYXBoIG9iamVjdFxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBAcmV0dXJuICAgICB7T2JqZWN0fSAgICAgICAgICBSZXR1cm5zIGFuIG9iamVjdFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdCBoYXMgdGhlIHdpZHRoXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmQgaGVpZ2h0IGFzIFxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllcyBcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZDNGb3JjZUJvdW5kcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cyA9IHRoaXNHcmFwaC5jb25zdHMsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0c1BvbGljeSA9IGNvbnN0cy5TcGxpdEpvaW5WaWV3UG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZVBvbGljeSA9IHN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpc0dyYXBoLm5vZGVzO1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNhbGNNYXhOb2Rlcyh3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhcmVhID0gd2lkdGggKiBoZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciByYWRpdXMgPSB0aGlzR3JhcGguY29uc3RzLnN0YXJ0UmFkaXVzO1xuICAgICAgICAgICAgICAgICAgICAvL3RyZWF0aW5nIHRoZW0gYXMgYSBzcXVhcmUgZm9yIGFwcHJveFxuICAgICAgICAgICAgICAgICAgICB2YXIgbGVuZ3RoID0gKHJhZGl1cyAqMy41KTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFtb3VudCA9IGFyZWEgLyhsZW5ndGggKmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhbW91bnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vVGhlIG9mZnNldCBpcyB0aGUgYnVmZmVyIGZyb20gdGhlIGVkZ2VzXG4gICAgICAgICAgICAgICAgLy9PcmlnaW5hbCBXaWR0aCBhbmQgSGVpZ2h0IGFyZSBnaXZlbiB0byB0aGUgZm9yY2UgbGF5b3V0XG4gICAgICAgICAgICAgICAgLy9zbyB0aGF0IGl0IGlzIGNlbnRlcmVkLCBidXQgbm9kZXMgd2lsbCBiZSBmb3JjZWQgdG8gYmVcbiAgICAgICAgICAgICAgICAvL3dpdGhpbiB0aGUgb2Zmc2V0IGJvdW5kc1xuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSBjb25zdHMuZGlzcGxheU9mZnNldDtcbiAgICAgICAgICAgICAgICB2YXIgc3ZnV2lkdGggPSBwYXJzZUZsb2F0KHRoaXNHcmFwaC5zdmcuc3R5bGUoXCJ3aWR0aFwiKSk7XG4gICAgICAgICAgICAgICAgdmFyIHN2Z0hlaWdodCA9IHBhcnNlRmxvYXQodGhpc0dyYXBoLnN2Zy5zdHlsZShcImhlaWdodFwiKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBzdmdXaWR0aDtcbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gc3ZnSGVpZ2h0O1xuXG4gICAgICAgICAgICAgICAgdmFyIGFtb3VudCA9IGNhbGNNYXhOb2Rlcyh3aWR0aCAtICgyKm9mZnNldCksIGhlaWdodCAtICgyKm9mZnNldCkpO1xuICAgICAgICAgICAgICAgIHZhciBzY2FsZSA9IDE7XG4gICAgICAgICAgICAgICAgaWYgKG5vZGVzLmxlbmd0aCA+IGFtb3VudCkge1xuICAgICAgICAgICAgICAgICAgICBzY2FsZSA9IGFtb3VudCAvIG5vZGVzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKSwgc2NhbGUpO1xuICAgICAgICAgICAgICAgICAgICB3aWR0aCAvPSBzY2FsZTtcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0IC89IHNjYWxlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC56b29tZWQodGhpc0dyYXBoLmRyYWdTdmcudHJhbnNsYXRlKCksIHNjYWxlKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL2NhbGN1bGF0aW5nIGZvY2kgZm9yIHNpbXVsYXRpb25cbiAgICAgICAgICAgICAgICB2YXIgZm9jdXNHcm91cHMgPSBzdGF0ZVBvbGljeS5mb2N1c0dyb3VwcztcbiAgICAgICAgICAgICAgICB2YXIgZm9jaTtcbiAgICAgICAgICAgICAgICBpZiAoZm9jdXNHcm91cHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvY2kgPSBbaGVpZ2h0LzJdO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vc2V0dGluZyBmb2NpIGhlaWdodCBwb3NpdGlvbiBiYXNlZCBvbiBwZXJjZW50YWdlXG4gICAgICAgICAgICAgICAgICAgIHZhciBmb2N1c05vZGVzID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0W2ZvY3VzR3JvdXBzWzBdXTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3RzUG9saWN5LmJvdW5kYXJ5ID0gZm9jdXNOb2Rlcy5sZW5ndGggLyBub2Rlcy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0b3AgPSBoZWlnaHQgKiBjb25zdHNQb2xpY3kuYm91bmRhcnk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBib3QgPSBoZWlnaHQgLSB0b3A7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0b3AgPCAyKnRoaXNHcmFwaC5jb25zdHMubWF4UmFkaXVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdHNQb2xpY3kuYm91bmRhcnkgPSAoMi41ICogdGhpc0dyYXBoLmNvbnN0cy5tYXhSYWRpdXMpIC8gaGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9wID0gaGVpZ2h0ICogY29uc3RzUG9saWN5LmJvdW5kYXJ5O1xuICAgICAgICAgICAgICAgICAgICAgICAgYm90ID0gaGVpZ2h0IC0gdG9wO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGJvdCA8IDIqIHRoaXNHcmFwaC5jb25zdHMubWF4UmFkaXVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdHNQb2xpY3kuYm91bmRhcnkgPSAxIC0gKCgyLjUgKiB0aGlzR3JhcGguY29uc3RzLm1heFJhZGl1cykgLyBoZWlnaHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9wID0gaGVpZ2h0ICogY29uc3RzUG9saWN5LmJvdW5kYXJ5O1xuICAgICAgICAgICAgICAgICAgICAgICAgYm90ID0gaGVpZ2h0IC0gdG9wO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZvY2kgPSBbdG9wLzIsIHRvcCArIGJvdCAvIDJdO1xuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHN0YXRlUG9saWN5LmZvY2kgPSBmb2NpO1xuICAgICAgICAgICAgICAgIHJldHVybiB7d2lkdGg6d2lkdGgsIGhlaWdodDpoZWlnaHR9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENhbGxlZCBhZnRlciBhIHNpbmdsZSBub2RlIGlzIHNwbGl0XG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtBcnJheX0gIG5ld05vZGVzICBUaGUgbmV3IG5vZGVzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNwbGl0Tm9kZUV2ZW50KG5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNQb2xpY3kgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICBfLmZvckVhY2gobmV3Tm9kZXMsIGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF8uaW5jbHVkZXMoY2hpbGRyZW5fc3RydWN0W3N0YXRlLmZvY3VzR3JvdXBzWzBdXSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5pZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJmb2N1c1wiO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5LnR5cGUgPSBcImNvbm5lY3RlZFwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSBuZXdOb2Rlc1swXS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgLy8gc3RhdGUuZm9jdXNHcm91cCA9IHRpdGxlO1xuXG4gICAgICAgICAgICAgICAgLy9pZiB0aGUgbGFzdCBldmVudCBoYXMgdGhlIHNhbWUgaWQsIGl0IG11c3QgYmUgdGhlXG4gICAgICAgICAgICAgICAgLy9vcHBwb3NpdGUgb2YgdGhpcyBldmVudCwgc28gd2UgcmVtb3ZlIHRoYXQgZXZlbnQgZnJvbVxuICAgICAgICAgICAgICAgIC8vdGhlIGV2ZW50IHN0YWNrLlxuICAgICAgICAgICAgICAgIC8vT3RoZXJ3aXNlLCB3ZSBhZGQgdGhlIGV2ZW50IG90IHRoZSBzdGFja1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoICE9PSAwICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3Rvcnlbc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCAtIDFdLmlkID09PSB0aXRsZSkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkucG9wKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5LnB1c2goe2lkOnRpdGxlLCBldmVudDonc3BsaXQnfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmJhY2tCdXR0b25FbGVtICE9IG51bGwgJiYgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5iYWNrQnV0dG9uRWxlbS5mYWRlVG8oJ3Nsb3cnLCAxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLnRpdGxlRWxlbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0gc3RhdGUuZm9jdXNHcm91cHNbMF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmZvY3VzR3JvdXBzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSAnICYgJyArIHN0YXRlLmZvY3VzR3JvdXBzWzFdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLnRpdGxlRWxlbS50ZXh0KHRleHQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vcmUtZW5hYmxlIGdyYXBoIHVwZGF0ZVxuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5zdGF0ZS5kaXNhYmxlVXBkYXRlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpc1BvbGljeS5zZXRMYXlvdXQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTZXRzIHRoZSBsYXlvdXQgb2YgdGhlIG5vZGVzLiBcbiAgICAgICAgICAgICAqIElmIHRoZXJlIGlzIGEgcHJldmlvdXMgbGF5b3V0LCBpdCB3aWxsIGJlIGxvYWRlZC5cbiAgICAgICAgICAgICAqIEVsc2UsIGl0IHdpbGwgcnVuIGEgRDMgRm9yY2Ugc2ltdWxhdGlvbiBhbmQgY3JlYXRlIG9uZS5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc2V0TGF5b3V0KCkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzUG9saWN5ID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzR3JhcGguc3RhdGUuU3BsaXRKb2luVmlld1BvbGljeTtcbiAgICAgICAgICAgICAgICB2YXIgbGF5b3V0O1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ID0gc3RhdGUubGF5b3V0RGVmYXVsdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSBzdGF0ZS56b29tRGVmYXVsdDtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh6b29tWzBdLCB6b29tWzFdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbSA9IHN0YXRlLnpvb21zW3N0YXRlLmZvY3VzR3JvdXBzXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHpvb20gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnpvb21lZCh6b29tWzBdLCB6b29tWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBsYXlvdXQgPSBzdGF0ZS5sYXlvdXRbc3RhdGUuZm9jdXNHcm91cHNdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChsYXlvdXQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2godGhpc0dyYXBoLm5vZGVzLCBmdW5jdGlvbihuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9zID0gbGF5b3V0W24uaWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBvcyA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cobGF5b3V0LCBuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG4ueCA9IHBvcy54O1xuICAgICAgICAgICAgICAgICAgICAgICAgbi55ID0gcG9zLnk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGguY2FsbCh0aGlzR3JhcGgsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeS51cGRhdGVHcmFwaENhbGxiYWNrLmNhbGwodGhpc1BvbGljeSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vTmVlZCB0byBydW4gYSBmb3JjZSBzaW11bGF0aW9uIGFzIHRoaXMgbGF5b3V0XG4gICAgICAgICAgICAgICAgICAgIC8vaGFzbid0IGJlZW4gZG9uZSBiZWZvcmVcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnN0YXRlLmluaXRGb3JjZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAvLyB0aGlzUG9saWN5LnNldFBvc2l0aW9ucygpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzR3JhcGgudXBkYXRlR3JhcGgoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzUG9saWN5LnVwZGF0ZUdyYXBoQ2FsbGJhY2suY2FsbCh0aGlzUG9saWN5KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLnpvb21zW3N0YXRlLmZvY3VzR3JvdXBzXSA9IFt0aGlzR3JhcGguZHJhZ1N2Zy50cmFuc2xhdGUoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLmRyYWdTdmcuc2NhbGUoKV07XG4gICAgICAgICAgICAgICAgICAgIHZhciBsYXlvdXQgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5ub2RlcywgZnVuY3Rpb24obikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0W24uaWRdID0ge3g6bi54LCB5Om4ueX07XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5sYXlvdXRbc3RhdGUuZm9jdXNHcm91cHNdID0gbGF5b3V0O1xuICAgICAgICAgICAgICAgIH0gXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogT3ZlcnJpZGluZyBmcm9tIHN1cGVyIGNsYXNzIHNvIHRoYXQgd2UgY2FuIGhhdmVcbiAgICAgICAgICAgICAqIHRvcCBsZXZlbCBub2RlcyByZWFwcGVhciB3aGVuIHRoZXkgYXJlIGhpZGRlblxuICAgICAgICAgICAgICogZHVlIHRvIHRoZXJlIGJlaW5nIHR3byBmb2N1cyBncm91cHMuXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSAgICAgIHtOb2RlfSAgICAgICAgICBub2RlICAgIFRoZSBub2RlIHRvIGpvaW5cbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtOb2RlfSAgVGhlIG5ldyBub2RlIGFmdGVyIHRoZSBqb2luXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIF9fam9pbk5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aGlzR3JhcGggPSB0aGlzLmdyYXBoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZVN1cGVyID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pbk5vZGVQb2xpY3ksXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICAvL2NoZWNrIHRoYXQgbm9kZSBzdGlsbCBleGlzdHNcbiAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLm5vZGVzLmluZGV4T2Yobm9kZSkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbl9zdHJ1Y3QgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5jaGlsZHJlbl9zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBub2RlLmlkO1xuICAgICAgICAgICAgICAgIC8vaWYgaXQgaGFzIG5vIGFuY2VzdG9yLCBub3RoaW5nIHRvIGpvaW5cbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRyZW5fc3RydWN0LnRvcExldmVsLmluZGV4T2YobmFtZSkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IG5vZGUucGFyZW50O1xuICAgICAgICAgICAgICAgIHZhciB0b19iZV9kZWxldGVkID0gW107XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVOYW1lU2V0ID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgLy9pZiBub2RlIHdvbid0IGJlIGNvbGxhcHNlZFxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpc0dyYXBoLm5vZGVzW2ldLmFuY2VzdG9ycy5pbmRleE9mKG5vZGUucGFyZW50KSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZU5hbWVTZXQucHVzaCh0aGlzR3JhcGgubm9kZXNbaV0uaWQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9fYmVfZGVsZXRlZC5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG5ld19ub2RlX2lkID0gbm9kZS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgbm9kZU5hbWVTZXQucHVzaChub2RlLnBhcmVudCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgYW5jZXN0b3JzX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmFuY2VzdG9yc19zdHJ1Y3Q7XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcbiAgICAgICAgICAgICAgICAvLyAtIHNldHRpbmcgZm9jdXNHcm91cHMgLVxuICAgICAgICAgICAgICAgIC8vZWl0aGVyIHJlcGxhY2luZyBvbmUgb2YgdGhlIGdyb3VwcyxcbiAgICAgICAgICAgICAgICAvL29yIGpvaW5pbmcgYmFjayBpbnRvIGEgdG9wIGxldmVsLCBzbyB0aGVyZSBpcyBvbmx5XG4gICAgICAgICAgICAgICAgLy9vbmUgZm9jdXNcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBzdGF0ZS5mb2N1c0dyb3Vwcy5pbmRleE9mKHBhcmVudCk7XG4gICAgICAgICAgICAgICAgaWYgKGFuY2VzdG9yc19zdHJ1Y3RbcGFyZW50XSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmZvY3VzR3JvdXBzW2luZGV4XSA9IGFuY2VzdG9yc19zdHJ1Y3RbcGFyZW50XTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5mb2N1c0dyb3Vwcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vbmFtZVRvQWRkIGFyZSB0b3AgbGV2ZWwgbm9kZXMgdGhhdCBhcmUgdG8gYmUgYWRkZWRcbiAgICAgICAgICAgICAgICAvL3RvIHRoZSBncmFwaC5cbiAgICAgICAgICAgICAgICB2YXIgbmFtZVRvQWRkID0gW107XG4gICAgICAgICAgICAgICAgLy93aWxsIG9ubHkgbmVlZCB0byBhZGQgYSB0b3AgbGV2ZWwgbm9kZSBpZiB0aGVyZSBpc1xuICAgICAgICAgICAgICAgIC8vb25seSBvbmUgZm9jdXNcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vQWRkIG9ubHkgdGhvc3QgdGhhdCBhcmVuJ3QgYW4gYW5jZXN0b3Igb2YgdGhlIG5vZGVcbiAgICAgICAgICAgICAgICAgICAgLy90byBqb2luLCB0aGUgZm9jdXMgZ3JvdXAgb3IgYW4gYW5jZXN0b3Igb2YgaXQsXG4gICAgICAgICAgICAgICAgICAgIC8vYW5kIGFyZW4ndCBhbHJlYWR5IGluIG5vZGVOYW1lU2V0LlxuICAgICAgICAgICAgICAgICAgICAvL2dldCBmbG93IGJldHdlZW4gdG9wIGxldmVsIGFzIGxvbmcgYXNcbiAgICAgICAgICAgICAgICAgICAgLy90aGUgdG9wIGxldmVsIGlzbid0IGFuIGFuY2VzdG9yIG9mIHRoZVxuICAgICAgICAgICAgICAgICAgICAvL2ZvY3VzIGdyb3VwLCBhbmQgaXNuJ3QgYWxyZWFkeSBwYXJ0IG9mIHRoZVxuICAgICAgICAgICAgICAgICAgICAvL25vZGUgc2V0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgYW5jZXN0b3JzID0gYW5jZXN0b3JzX3N0cnVjdFtub2RlLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3JzLnB1c2goc3RhdGUuZm9jdXNHcm91cHNbMF0pO1xuICAgICAgICAgICAgICAgICAgICAvL3RoZSBvciBlbXB0eSBhcnJheSBpcyB0byBwcmV2ZW50IGNvbmNhdGVuYXRpbmcgYSBudWxsXG4gICAgICAgICAgICAgICAgICAgIC8vb3IgdW5kZWZpbmVkIHZhbHVlXG4gICAgICAgICAgICAgICAgICAgIGFuY2VzdG9ycyA9IGFuY2VzdG9ycy5jb25jYXQoYW5jZXN0b3JzX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV0gfHwgW10pO1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goY2hpbGRyZW5fc3RydWN0LnRvcExldmVsLCBmdW5jdGlvbihuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW5jZXN0b3JzLmluZGV4T2YobikgPT09IC0xICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVOYW1lU2V0LmluZGV4T2YobikgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lVG9BZGQucHVzaChuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVOYW1lU2V0ID0gbm9kZU5hbWVTZXQuY29uY2F0KG5hbWVUb0FkZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy9ubyBmb2N1cyBncm91cHMgbWVhbnMgd2UgYXJlIGF0IHRvcCBsZXZlbFxuICAgICAgICAgICAgICAgICAgICAvL1Nob3VsZCBhZGQgYW55IHRvcCBsZXZlbCBub2RlcyB0aGF0IGFyZW4ndFxuICAgICAgICAgICAgICAgICAgICAvL2FscmVhZHkgdGhlcmVcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKGNoaWxkcmVuX3N0cnVjdC50b3BMZXZlbCwgZnVuY3Rpb24obikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGVOYW1lU2V0LmluZGV4T2YobikgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lVG9BZGQucHVzaChuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVOYW1lU2V0ID0gbm9kZU5hbWVTZXQuY29uY2F0KG5hbWVUb0FkZCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9mb3JtYXR0aW5nIGRhdGFcbiAgICAgICAgICAgICAgICB2YXIgcmFkaXVzID0gbm9kZS5yYWRpdXMgLyB0aGlzR3JhcGguY29uc3RzLnJhZGl1c0RlY2F5OyBcbiAgICAgICAgICAgICAgICB2YXIgeExvYyA9IG5vZGUueDtcbiAgICAgICAgICAgICAgICB2YXIgeUxvYyA9IG5vZGUueTtcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gbm9kZS5hbmNlc3RvcnNbMV07XG4gICAgICAgICAgICAgICAgdmFyIGFuY2VzdG9ycyA9IG5vZGUuYW5jZXN0b3JzLnNsaWNlKDEpO1xuICAgICAgICAgICAgICAgIHZhciBuZXdOb2RlID0gbmV3IFZpc3VhbGl6ZXJOb2RlLk5vZGUoeExvYywgeUxvYywgbmV3X25vZGVfaWQsIG5ld19ub2RlX2lkLCByYWRpdXMsIHBhcmVudCwgYW5jZXN0b3JzKTtcbiAgICAgICAgICAgICAgICB0aGlzR3JhcGgubm9kZXMucHVzaChuZXdOb2RlKTtcblxuICAgICAgICAgICAgICAgIC8vcmVtb3ZlIGFsbCBub2RlcyB0aGF0IHdpbGwgYmUgam9pbmVkXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b19iZV9kZWxldGVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlX3RvX2RlbGV0ZSA9IHRvX2JlX2RlbGV0ZWRbaV07XG4gICAgICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2Rlcy5zcGxpY2UodGhpc0dyYXBoLm5vZGVzLmluZGV4T2Yobm9kZV90b19kZWxldGUpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZShub2RlX3RvX2RlbGV0ZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHJldERhdGEgPSB0aGlzR3JhcGguZGF0YVNvdXJjZS5nZXRGbG93QmV0d2VlblNldChub2RlTmFtZVNldCk7XG4gICAgICAgICAgICAgICAgLy9ob2xkcyB0aGUgbm9kZURhdGEgd2hpY2ggd2lsbCBiZSBwcm9jZXNzZWRcbiAgICAgICAgICAgICAgICB2YXIgbm9kZXNUb1Byb2Nlc3MgPSBbXTtcbiAgICAgICAgICAgICAgICAvL2ZpbmRpbmcgdGhlIG5vZGUgZGF0YSB0aGF0IGNvcnJlc3BvbmRzIHRvIHRoZSB0b3AgbGV2ZWxcbiAgICAgICAgICAgICAgICAvL25vZGVzIHRvIGFkZCAtIG5hbWVUb0FkZC5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZURhdGEgPSByZXREYXRhLm5vZGVEYXRhO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZURhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWVUb0FkZC5pbmRleE9mKG5vZGVEYXRhW2ldLmlkKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzVG9Qcm9jZXNzLnB1c2gobm9kZURhdGFbaV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9UaGUgdG9wIGxldmVsIG5vZGVzIHRoYXQgYXJlIGFkZGVkXG4gICAgICAgICAgICAgICAgdmFyIG5ld05vZGVzID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UucHJvY2Vzc05vZGVEYXRhKG5vZGVzVG9Qcm9jZXNzKTtcbiAgICAgICAgICAgICAgICBfLmZvckVhY2gobmV3Tm9kZXMsIGZ1bmN0aW9uKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgbi5yYWRpdXMgPSBuLnJhZGl1cyB8fCB0aGlzR3JhcGguY29uc3RzLnN0YXJ0UmFkaXVzO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXNHcmFwaC5ub2RlcyA9IHRoaXNHcmFwaC5ub2Rlcy5jb25jYXQobmV3Tm9kZXMpO1xuXG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmxpbmtzID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UucHJvY2Vzc0xpbmtEYXRhKHJldERhdGEubGlua0RhdGEsIHRoaXNHcmFwaC5ub2Rlcyk7XG4gICAgICAgICAgICAgICAgLy9Pbmx5IGtlZXAgdG9wIGxldmVsIG5vZGVzIHRoYXQgaGF2ZSBjb25uZWN0aW9ucyB0b1xuICAgICAgICAgICAgICAgIC8vdGhlIGN1cnJlbnQgZm9jdXMgZ3JvdXBcbiAgICAgICAgICAgICAgICAvL3dlIHJlbW92ZSB0aGUgbm9kZSBuYW1lIGZyb20gbmFtZVRvQWRkIGlmIHdlIGFyZVxuICAgICAgICAgICAgICAgIC8va2VlcGluZyBpdFxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHRoaXNHcmFwaC5saW5rcywgZnVuY3Rpb24obCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9jaGVja2luZyBpZiB0aGVyZSBleGlzdHMgYSBsaW5rIHRvdWNoaW5nIGVhY2ggb2YgbmFtZVRvQWRkXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmFtZVRvQWRkLmluZGV4T2YobC5zb3VyY2UuaWQpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwc1swXSA9PT0gbC50YXJnZXQucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVUb0FkZC5zcGxpY2UobmFtZVRvQWRkLmluZGV4T2YobC5zb3VyY2UuaWQpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5hbWVUb0FkZC5pbmRleE9mKGwudGFyZ2V0LmlkKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZm9jdXNHcm91cHNbMF0gPT09IGwuc291cmNlLnBhcmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lVG9BZGQuc3BsaWNlKG5hbWVUb0FkZC5pbmRleE9mKGwudGFyZ2V0LmlkKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vV2Ugd2FudCB0byBrZWVwIHRoZW0gYWxsXG4gICAgICAgICAgICAgICAgICAgIC8vc2luY2UgYW55IGxlZnQgaW4gbmFtZVRvQWRkIHdpbGwgYmUgcmVtb3ZlZCxcbiAgICAgICAgICAgICAgICAgICAgLy93ZSByZXNldCBuYW1lVG9BZGQgaGVyZS5cbiAgICAgICAgICAgICAgICAgICAgbmFtZVRvQWRkID0gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vd2hhdGV2ZXIgaXMgcmVtYWluaW5nIGluIG5hbWVUb0FkZCBpc24ndCBjb25uZWN0ZWRcbiAgICAgICAgICAgICAgICAvL3RvIHRoZSBmb2N1cyBncm91cCwgc28gd2Ugc2hvdWxkIHJlbW92ZSBpdC5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZVRvUmVtb3ZlID0gW107XG4gICAgICAgICAgICAgICAgaWYgKG5hbWVUb0FkZC5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JhcGgubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuYW1lVG9BZGQuaW5kZXhPZih0aGlzR3JhcGgubm9kZXNbaV0uaWQpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVUb0FkZC5zcGxpY2UobmFtZVRvQWRkLmluZGV4T2YodGhpc0dyYXBoLm5vZGVzW2ldLmlkKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLnNwbGljZUxpbmtzRm9yTm9kZSh0aGlzR3JhcGgubm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVUb1JlbW92ZS5wdXNoKHRoaXNHcmFwaC5ub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWVUb0FkZC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF8uZm9yRWFjaChub2RlVG9SZW1vdmUsIGZ1bmN0aW9uKG4pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc0dyYXBoLm5vZGVzLnNwbGljZSh0aGlzR3JhcGgubm9kZXMuaW5kZXhPZihuKSwgMSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzR3JhcGguaW5pdE5vZGVzKCk7XG4gICAgICAgICAgICAgICAgdGhpc0dyYXBoLmluaXRMaW5rcygpO1xuXG4gICAgICAgICAgICAgICAgc3RhdGVTdXBlci5zcGxpdE5vZGVzLnNwbGljZShzdGF0ZVN1cGVyLnNwbGl0Tm9kZXMuaW5kZXhPZihuZXdOb2RlLmlkKSwgMSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3Tm9kZTsgXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ2FsbGVkIGFmdGVyIGEgc2luZ2xlIG5vZGUgaXMgam9pbmVkXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIElmIHRoZSBmb2N1cyBncm91cCBoYXMgYmVlbiBzZWVuIGJlZm9yZSwgaXQgd2lsbFxuICAgICAgICAgICAgICogbG9hZCB0aGF0IGxheW91dC4gT3RoZXJ3aXNlLCBpdCB3aWxsIHJ1biBhIGQzIGZvcmNlXG4gICAgICAgICAgICAgKiBzaW11bGF0aW9uIHRvIGdlbmVyYXRlIG9uZS5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0gICAgICB7Tm9kZX0gIG5ld05vZGUgIFRoZSBuZXcgbm9kZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBqb2luTm9kZUV2ZW50KG5ld05vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0dyYXBoID0gdGhpcy5ncmFwaCxcbiAgICAgICAgICAgICAgICAgICAgdGhpc1BvbGljeSA9IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpc0dyYXBoLnN0YXRlLlNwbGl0Sm9pblZpZXdQb2xpY3k7XG5cbiAgICAgICAgICAgICAgICAvL2lmIHRoZSBsYXN0IGV2ZW50IGhhcyB0aGUgc2FtZSBpZCwgaXQgbXVzdCBiZSB0aGVcbiAgICAgICAgICAgICAgICAvL29wcHBvc2l0ZSBvZiB0aGlzIGV2ZW50LCBzbyB3ZSByZW1vdmUgdGhhdCBldmVudCBmcm9tXG4gICAgICAgICAgICAgICAgLy90aGUgZXZlbnQgc3RhY2suXG4gICAgICAgICAgICAgICAgLy9PdGhlcndpc2UsIHdlIGFkZCB0aGUgZXZlbnQgdG8gdGhlIHN0YWNrXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggIT09IDAgJiZcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5W3N0YXRlLmV2ZW50SGlzdG9yeS5sZW5ndGggLSAxXS5pZCA9PT0gbmV3Tm9kZS5pZCkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkucG9wKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZXZlbnRIaXN0b3J5LnB1c2goe2lkOm5ld05vZGUuaWQsIGV2ZW50Oidqb2luJ30pXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuX3N0cnVjdCA9IHRoaXNHcmFwaC5kYXRhU291cmNlLmNoaWxkcmVuX3N0cnVjdDtcblxuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzR3JhcGgubm9kZXMsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5TcGxpdEpvaW5WaWV3UG9saWN5ID0ge307XG4gICAgICAgICAgICAgICAgICAgIGlmIChfLmluY2x1ZGVzKGNoaWxkcmVuX3N0cnVjdFtzdGF0ZS5mb2N1c0dyb3Vwc1swXV0sIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLlNwbGl0Sm9pblZpZXdQb2xpY3kudHlwZSA9IFwiZm9jdXNcIjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuU3BsaXRKb2luVmlld1BvbGljeS50eXBlID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy9zZXR0aW5nIGJhY2sgYnV0dG9uXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmJhY2tCdXR0b25FbGVtICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ldmVudEhpc3RvcnkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmJhY2tCdXR0b25FbGVtLmZhZGVUbygnc2xvdycsIDApO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vc2V0dGluZyB0aXRsZVxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS50aXRsZUVsZW0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ICs9IHN0YXRlLmZvY3VzR3JvdXBzWzBdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5mb2N1c0dyb3Vwcy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0gJyAmICcgKyBzdGF0ZS5mb2N1c0dyb3Vwc1sxXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS50aXRsZUVsZW0udGV4dCh0ZXh0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpc1BvbGljeS5zZXRMYXlvdXQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVbmRvZXMgdGhlIGxhc3Qgc3BsaXQgb3Igam9pbiBldmVudC5cbiAgICAgICAgICAgICAqIE1lYW50IHRvIGJlIGNhbGxlZCBieSB0aGUgYmFjayBidXR0b24uXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHVuZG9MYXN0RXZlbnQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNHcmFwaCA9IHRoaXMuZ3JhcGgsXG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kgPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXNHcmFwaC5zdGF0ZS5TcGxpdEpvaW5WaWV3UG9saWN5O1xuXG4gICAgICAgICAgICAgICAgdmFyIGxhc3QgPSBzdGF0ZS5ldmVudEhpc3Rvcnlbc3RhdGUuZXZlbnRIaXN0b3J5Lmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgIHZhciBpZCA9IGxhc3QuaWQ7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGU7XG4gICAgICAgICAgICAgICAgaWYgKGxhc3QuZXZlbnQgPT09ICdqb2luJykge1xuICAgICAgICAgICAgICAgICAgICBub2RlID0gdGhpc0dyYXBoLmZpbmROb2RlQnlJZChpZCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkM25vZGUgPSB0aGlzR3JhcGguZmluZEQzTm9kZShpZCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNQb2xpY3kuZGJsY2xpY2soZDNub2RlLCBub2RlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZUlkID0gdGhpc0dyYXBoLmRhdGFTb3VyY2UuY2hpbGRyZW5fc3RydWN0W2lkXVswXTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZSA9IHRoaXNHcmFwaC5maW5kTm9kZUJ5SWQobm9kZUlkKTtcbiAgICAgICAgICAgICAgICAgICAgc3VwZXIuam9pbk5vZGUuY2FsbCh0aGlzUG9saWN5LCBub2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgUG9saWN5OiBTcGxpdEpvaW5WaWV3UG9saWN5XG4gICAgICAgIH1cbn1dKTtcblxuXG5cblxuXG5cblxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2RlcycsIHtcbiAgICAgICAgICAgIHVybDogJy9ub2RlcycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYub3JnYW5pemF0aW9ucycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvb3JnYW5pemF0aW9ucycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xOC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zZXJ2aWNlbGJzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzJywge1xuICAgICAgICAgICAgdXJsOiAnL3NlcnZpY2VsYnMnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS5qcy5tYXAiLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2LnNldHRpbmdzJywgWydjb250aXYubW9kZWxzJywgJ2NvbnRpdi5kaXJlY3RpdmVzJywgJ2NvbnRpdi51dGlscyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncycsIHtcbiAgICAgICAgICAgIHVybDogJy9nbG9iYWwnLFxuICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgdWktdmlldyBjbGFzcz1cInVpIGNvbnRhaW5lclwiLz4nXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvc2V0dGluZ3MnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXR0aW5ncy9zZXR0aW5nc21lbnUuaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5sb2dzJywge1xuICAgICAgICAgICAgdXJsOiAnL2xvZ3MnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJycsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5hdXRoJywge1xuICAgICAgICAgICAgdXJsOiAnL2F1dGgnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJycsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5saWNlbnNlJywge1xuICAgICAgICAgICAgdXJsOiAnL2xpY2Vuc2UnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJycsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJydcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2V0dGluZ3MuZGV0YWlscy5wb2xpY2llcycsIHtcbiAgICAgICAgICAgIHVybDogJy9wb2xpY2llcycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnJ1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnN0b3JhZ2Vwb2xpY2llcycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzJywge1xuICAgICAgICAgICAgdXJsOiAnL3N0b3JhZ2Vwb2xpY2llcycsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLmpzLm1hcCIsIlxuXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nLCBbJ2NvbnRpdi5tb2RlbHMnLCAnY29udGl2LmRpcmVjdGl2ZXMnLCAnY29udGl2LnV0aWxzJywgXG5cdCdjb250aXYuZ3JhcGgnXSlcbiAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2NvbnRpdi5tZW51LnZpc3VhbGl6YXRpb24nLCB7XG4gICAgICAgICAgICB1cmw6ICcvdmlzdWFsaXphdGlvbicsXG4gICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3IGNsYXNzPVwidWkgY29udGFpbmVyXCIvPidcbiAgICAgICAgfSlcbiAgICB9XSk7XG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudm9sdW1lcycsIFsnY29udGl2Lm1vZGVscycsICdjb250aXYuZGlyZWN0aXZlcycsICdjb250aXYudXRpbHMnXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUudm9sdW1lcycsIHtcbiAgICAgICAgICAgIHVybDogJy92b2x1bWVzJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBjb250YWluZXJcIi8+J1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUuanMubWFwIiwiJ3VzZSBzdHJpY3QnO1xuLy8gRGVjbGFyZSBhcHAgbGV2ZWwgbW9kdWxlIHdoaWNoIGRlcGVuZHMgb24gdmlld3MsIGFuZCBjb21wb25lbnRzXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2QXBwJywgW1xuICAgICd1aS5yb3V0ZXInLFxuICAgICdjb250aXYubG9naW4nLFxuICAgICdjb250aXYubWVudScsXG4gICAgJ2NvbnRpdi5kYXNoYm9hcmQnLFxuICAgICdjb250aXYuYXBwbGljYXRpb25ncm91cHMnLFxuICAgICdjb250aXYubmV0d29ya3MnLFxuICAgICdjb250aXYubmV0d29ya3BvbGljaWVzJyxcbiAgICAnY29udGl2LnN0b3JhZ2Vwb2xpY2llcycsXG4gICAgJ2NvbnRpdi5zZXJ2aWNlbGJzJyxcbiAgICAnY29udGl2LnZvbHVtZXMnLFxuICAgICdjb250aXYubm9kZXMnLFxuICAgICdjb250aXYub3JnYW5pemF0aW9ucycsXG4gICAgJ2NvbnRpdi5zZXR0aW5ncycsXG4gICAgJ2NvbnRpdi52aXN1YWxpemF0aW9uJ1xuXSlcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCAnJHVybFJvdXRlclByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Jywge1xuICAgICAgICAgICAgdXJsOiAnJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHVpLXZpZXcgY2xhc3M9XCJ1aSBmbHVpZCBjb250YWluZXJcIi8+J1xuICAgICAgICB9KTtcbiAgICAgICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMTEvMTYuXG4gKi9cbi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8xMC8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5hcHBsaWNhdGlvbmdyb3VwcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0FwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsIGFzIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwbGljYXRpb25ncm91cHMvYXBwbGljYXRpb25ncm91cGNyZWF0ZS5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignQXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwnLCBbXG4gICAgJyRzdGF0ZScsXG4gICAgJyRzdGF0ZVBhcmFtcycsXG4gICAgJ0FwcGxpY2F0aW9uR3JvdXBzTW9kZWwnLFxuICAgICdOZXR3b3Jrc01vZGVsJyxcbiAgICAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgQXBwbGljYXRpb25Hcm91cHNNb2RlbCwgTmV0d29ya3NNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsID0gdGhpcztcbiAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwubmV0d29ya3MgPSBbXTtcbiAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwuYXBwbGljYXRpb25Hcm91cCA9IHt9O1xuICAgICAgICBhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybC5zZWxlY3RlZE5ldHdvcmsgPSB7fTtcbiAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwubW9kZSA9IFwiZWRpdFwiO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub0FwcGxpY2F0aW9uR3JvdXAoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxDcmVhdGluZygpIHtcbiAgICAgICAgICAgIHJldHVyblRvQXBwbGljYXRpb25Hcm91cCgpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZXQgbmV0d29ya3MgZm9yIHRoZSBnaXZlbiB0ZW5hbnQuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBnZXROZXR3b3JrcygpIHtcbiAgICAgICAgICAgIE5ldHdvcmtzTW9kZWwuZ2V0KCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwubmV0d29ya3MgPSBfLmZpbHRlcihyZXN1bHQsIHtcbiAgICAgICAgICAgICAgICAgICAgJ3RlbmFudE5hbWUnOiAnZGVmYXVsdCcgLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUFwcGxpY2F0aW9uR3JvdXAoKSB7XG4gICAgICAgICAgICAvL2Zvcm0gY29udHJvbGxlciBpcyBpbmplY3RlZCBieSB0aGUgaHRtbCB0ZW1wbGF0ZVxuICAgICAgICAgICAgLy9jaGVja2luZyBpZiBhbGwgdmFsaWRhdGlvbnMgaGF2ZSBwYXNzZWRcbiAgICAgICAgICAgIGlmIChhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLmFwcGxpY2F0aW9uR3JvdXAubmV0d29ya05hbWUgPVxuICAgICAgICAgICAgICAgICAgICBhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybC5zZWxlY3RlZE5ldHdvcmsubmV0d29ya05hbWU7XG4gICAgICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwuYXBwbGljYXRpb25Hcm91cC5rZXkgPVxuICAgICAgICAgICAgICAgICAgICBBcHBsaWNhdGlvbkdyb3Vwc01vZGVsLmdlbmVyYXRlS2V5KGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLmFwcGxpY2F0aW9uR3JvdXApO1xuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIGFwcGxpY2F0aW9uR3JvdXAgY29uc2lzdCBvZiBHcm91cCBOYW1lLCBOZXR3b3JrIE5hbWUsIElzb2xhdGlvbiBQb2xpY2llcywgQmFuZHdpZHRoIFBvbGljeVxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwuY3JlYXRlKGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLmFwcGxpY2F0aW9uR3JvdXApLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9BcHBsaWNhdGlvbkdyb3VwKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXNldEZvcm0oKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBhcHBsaWNhdGlvbkdyb3VwQ3JlYXRlQ3RybC5hcHBsaWNhdGlvbkdyb3VwID0ge1xuICAgICAgICAgICAgICAgIGdyb3VwTmFtZTogJycsXG4gICAgICAgICAgICAgICAgbmV0d29ya05hbWU6ICcnLFxuICAgICAgICAgICAgICAgIHBvbGljaWVzOiBbXSxcbiAgICAgICAgICAgICAgICBuZXRQcm9maWxlOiAnJyxcbiAgICAgICAgICAgICAgICB0ZW5hbnROYW1lOiAnZGVmYXVsdCcgLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgZ2V0TmV0d29ya3MoKTtcbiAgICAgICAgYXBwbGljYXRpb25Hcm91cENyZWF0ZUN0cmwuY3JlYXRlQXBwbGljYXRpb25Hcm91cCA9IGNyZWF0ZUFwcGxpY2F0aW9uR3JvdXA7XG4gICAgICAgIGFwcGxpY2F0aW9uR3JvdXBDcmVhdGVDdHJsLmNhbmNlbENyZWF0aW5nID0gY2FuY2VsQ3JlYXRpbmc7XG4gICAgICAgIHJlc2V0Rm9ybSgpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcGxpY2F0aW9uZ3JvdXBjcmVhdGVjdHJsLmpzLm1hcCIsIi8qKlxuKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzE1LzE2LlxuKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuYXBwbGljYXRpb25ncm91cHMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3Vwcy5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsIGFzIGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcGxpY2F0aW9uZ3JvdXBzL2FwcGxpY2F0aW9uZ3JvdXBkZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmVkaXQnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZWRpdC86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwgYXMgYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwbGljYXRpb25ncm91cHMvYXBwbGljYXRpb25ncm91cGRldGFpbHMuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ0FwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCcsIFtcbiAgICAnJHN0YXRlJyxcbiAgICAnJHN0YXRlUGFyYW1zJyxcbiAgICAnQXBwbGljYXRpb25Hcm91cHNNb2RlbCcsXG4gICAgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwgPSB0aGlzO1xuICAgICAgICBhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwuYXBwbGljYXRpb25Hcm91cCA9IHt9O1xuICAgICAgICBhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwuc2VsZWN0ZWROZXR3b3JrID0ge307XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUbyBzaG93IGVkaXQgb3IgZGV0YWlscyBzY3JlZW4gYmFzZWQgb24gdGhlIHJvdXRlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBzZXRNb2RlKCkge1xuICAgICAgICAgICAgaWYgKCRzdGF0ZS5pcygnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMuZWRpdCcpKSB7XG4gICAgICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLm1vZGUgPSAnZWRpdCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwubW9kZSA9ICdkZXRhaWxzJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub0FwcGxpY2F0aW9uR3JvdXAoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LmFwcGxpY2F0aW9uZ3JvdXBzLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub0FwcGxpY2F0aW9uR3JvdXBEZXRhaWxzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5hcHBsaWNhdGlvbmdyb3Vwcy5kZXRhaWxzJywgeyAna2V5JzogYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLmFwcGxpY2F0aW9uR3JvdXAua2V5IH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbEVkaXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub0FwcGxpY2F0aW9uR3JvdXBEZXRhaWxzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZGVsZXRlQXBwbGljYXRpb25Hcm91cCgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwuZGVsZXRlKGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybC5hcHBsaWNhdGlvbkdyb3VwKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9BcHBsaWNhdGlvbkdyb3VwKCk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gc2F2ZUFwcGxpY2F0aW9uR3JvdXAoKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBBcHBsaWNhdGlvbkdyb3Vwc01vZGVsLnNhdmUoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLmFwcGxpY2F0aW9uR3JvdXApLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICByZXR1cm5Ub0FwcGxpY2F0aW9uR3JvdXBEZXRhaWxzKCk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsKTtcbiAgICAgICAgQXBwbGljYXRpb25Hcm91cHNNb2RlbC5nZXRNb2RlbEJ5S2V5KCRzdGF0ZVBhcmFtcy5rZXkpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZ3JvdXApIHtcbiAgICAgICAgICAgIGFwcGxpY2F0aW9uR3JvdXBEZXRhaWxzQ3RybC5hcHBsaWNhdGlvbkdyb3VwID0gZ3JvdXA7XG4gICAgICAgIH0pO1xuICAgICAgICBhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwuc2F2ZUFwcGxpY2F0aW9uR3JvdXAgPSBzYXZlQXBwbGljYXRpb25Hcm91cDtcbiAgICAgICAgYXBwbGljYXRpb25Hcm91cERldGFpbHNDdHJsLmNhbmNlbEVkaXRpbmcgPSBjYW5jZWxFZGl0aW5nO1xuICAgICAgICBhcHBsaWNhdGlvbkdyb3VwRGV0YWlsc0N0cmwuZGVsZXRlQXBwbGljYXRpb25Hcm91cCA9IGRlbGV0ZUFwcGxpY2F0aW9uR3JvdXA7XG4gICAgICAgIHNldE1vZGUoKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHBsaWNhdGlvbmdyb3VwZGV0YWlsc2N0cmwuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzExLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmFwcGxpY2F0aW9uZ3JvdXBzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuYXBwbGljYXRpb25ncm91cHMubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBcHBsaWNhdGlvbkdyb3VwTGlzdEN0cmwgYXMgYXBwbGljYXRpb25Hcm91cExpc3RDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwbGljYXRpb25ncm91cHMvYXBwbGljYXRpb25ncm91cGxpc3QuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ0FwcGxpY2F0aW9uR3JvdXBMaXN0Q3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ0FwcGxpY2F0aW9uR3JvdXBzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgQXBwbGljYXRpb25Hcm91cHNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIGFwcGxpY2F0aW9uR3JvdXBMaXN0Q3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGdldEFwcGxpY2F0aW9uR3JvdXBzKHJlbG9hZCkge1xuICAgICAgICAgICAgQXBwbGljYXRpb25Hcm91cHNNb2RlbC5nZXQocmVsb2FkKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGFwcGxpY2F0aW9uR3JvdXBMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgYXBwbGljYXRpb25Hcm91cExpc3RDdHJsLmdyb3VwcyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihhcHBsaWNhdGlvbkdyb3VwTGlzdEN0cmwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgIGdldEFwcGxpY2F0aW9uR3JvdXBzKGZhbHNlKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3Qgc3RhcnQgYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldEFwcGxpY2F0aW9uR3JvdXBzKHRydWUpO1xuICAgICAgICAgICAgfSwgNTAwMCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcGxpY2F0aW9uZ3JvdXBsaXN0Y3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgaGFyZGlrIGdhbmRoaSBvbiA2LzI4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5hcHBsaWNhdGlvbmdyb3Vwc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZCYW5kd2lkdGhwb2xpY3lcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBtb2RlOiBcIj1cIixcbiAgICAgICAgICAgIGFwcGxpY2F0aW9uZ3JvdXA6ICc9J1xuICAgICAgICB9LFxuICAgICAgICBjb250cm9sbGVyOiBbXG4gICAgICAgICAgICAnJHNjb3BlJyxcbiAgICAgICAgICAgICdOZXRwcm9maWxlc01vZGVsJyxcbiAgICAgICAgICAgIGZ1bmN0aW9uICgkc2NvcGUsIE5ldHByb2ZpbGVzTW9kZWwpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUubmV0UHJvZmlsZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWROZXRwcm9maWxlID0ge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3k6IHt9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBHZXQgcHJvZmlsZXMgZm9yIHRoZSBnaXZlbiB0ZW5hbnQuXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0TmV0cHJvZmlsZXMoKSB7XG4gICAgICAgICAgICAgICAgICAgIE5ldHByb2ZpbGVzTW9kZWwuZ2V0KCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubmV0UHJvZmlsZXMgPSBfLmZpbHRlcihyZXN1bHQsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndGVuYW50TmFtZSc6ICdkZWZhdWx0JyAvL1RPRE86IFJlbW92ZSBoYXJkY29kZWQgdGVuYW50LlxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmFwcGxpY2F0aW9uZ3JvdXAubmV0UHJvZmlsZSAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWROZXRwcm9maWxlLnBvbGljeSA9IF8uZmluZCgkc2NvcGUubmV0UHJvZmlsZXMsIGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBvbGljeS5wcm9maWxlTmFtZSA9PT0gJHNjb3BlLmFwcGxpY2F0aW9uZ3JvdXAubmV0UHJvZmlsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIEFzc2lnbiBwcm9maWxlTmFtZSB0byBhcHBsaWNhdGlvbmdyb3VwIHdoaWNoZXZlciB1c2VyIGhhcyBnaXZlblxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICRzY29wZS51cGRhdGVBcHBsaWNhdGlvbmdyb3VwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnNlbGVjdGVkTmV0cHJvZmlsZS5wb2xpY3kgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hcHBsaWNhdGlvbmdyb3VwLm5ldFByb2ZpbGUgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hcHBsaWNhdGlvbmdyb3VwLm5ldFByb2ZpbGUgPSAkc2NvcGUuc2VsZWN0ZWROZXRwcm9maWxlLnBvbGljeS5wcm9maWxlTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgZ2V0TmV0cHJvZmlsZXMoKTtcbiAgICAgICAgICAgIH1dLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcGxpY2F0aW9uZ3JvdXBzL2JhbmR3aWR0aHBvbGljeS5odG1sJ1xuICAgIH07XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJhbmR3aWR0aHBvbGljeWRpcmVjdGl2ZS5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgaGFyZGlrIGdhbmRoaSBvbiA3LzgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmFwcGxpY2F0aW9uZ3JvdXBzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dklzb2xhdGlvbnBvbGljeVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIG1vZGU6ICc9JyxcbiAgICAgICAgICAgIGFwcGxpY2F0aW9uZ3JvdXA6ICc9J1xuICAgICAgICB9LFxuICAgICAgICBjb250cm9sbGVyOiBbXG4gICAgICAgICAgICAnJHNjb3BlJyxcbiAgICAgICAgICAgICckc3RhdGVQYXJhbXMnLFxuICAgICAgICAgICAgJ0FwcGxpY2F0aW9uR3JvdXBzTW9kZWwnLFxuICAgICAgICAgICAgJ1BvbGljaWVzTW9kZWwnLFxuICAgICAgICAgICAgJ1J1bGVzTW9kZWwnLFxuICAgICAgICAgICAgZnVuY3Rpb24gKCRzY29wZSwgJHN0YXRlUGFyYW1zLCBBcHBsaWNhdGlvbkdyb3Vwc01vZGVsLCBQb2xpY2llc01vZGVsLCBSdWxlc01vZGVsKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmluY29taW5nUnVsZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAkc2NvcGUub3V0Z29pbmdSdWxlcyA9IFtdO1xuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZFBvbGljeSA9IHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5OiB7fVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkUG9saWNpZXMgPSBbXTsgLy8gVG8gU3RvcmUgcG9saWNpZXMgc2VsZWN0ZWQgYnkgdXNlciB0byBkaXNwbGF5XG4gICAgICAgICAgICAgICAgJHNjb3BlLmlzb2xhdGlvblBvbGljaWVzID0gW107IC8vIFRvIEdldCBhbGwgaXNvbGF0aW9uIHBvbGljaWVzIG9mIHRlbmFudFxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIEdldCBpbmNvbWluZyBhbmQgb3V0Z29pbmcgcnVsZXMgZm9yIGVhY2ggcG9saWN5IHByZXNlbnQgaW4gYXBwbGljYXRpb25ncm91cFxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdldFJ1bGVzKCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXBwbGljYXRpb25ncm91cC5wb2xpY2llcy5mb3JFYWNoKGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vVG8gZGlzcGxheSBydWxlcyBvZiBzZWxlY3RlZCBwb2xpY2llc1xuICAgICAgICAgICAgICAgICAgICAgICAgUnVsZXNNb2RlbC5nZXRJbmNvbWluZ1J1bGVzKHBvbGljeSwgJ2RlZmF1bHQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChydWxlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KCRzY29wZS5pbmNvbWluZ1J1bGVzLCBydWxlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFJ1bGVzTW9kZWwuZ2V0T3V0Z29pbmdSdWxlcyhwb2xpY3ksICdkZWZhdWx0JylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocnVsZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseSgkc2NvcGUub3V0Z29pbmdSdWxlcywgcnVsZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBHZXQgcG9saWNpZXMgZm9yIHRoZSBnaXZlbiB0ZW5hbnQuXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0SXNvbGF0aW9uUG9saWNpZXMoKSB7XG4gICAgICAgICAgICAgICAgICAgIFBvbGljaWVzTW9kZWwuZ2V0KCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXNvbGF0aW9uUG9saWNpZXMgPSBfLmZpbHRlcihyZXN1bHQsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndGVuYW50TmFtZSc6ICdkZWZhdWx0JyAvL1RPRE86IFJlbW92ZSBoYXJkY29kZWQgdGVuYW50LlxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBBZGQgcG9saWN5IHRvIGFwcGxpY2F0aW9uIGdyb3VwXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFkZElzb2xhdGlvblBvbGljeSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRQb2xpY3lOYW1lID0gJHNjb3BlLnNlbGVjdGVkUG9saWN5LnBvbGljeS5wb2xpY3lOYW1lO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFBvbGljeU5hbWUgIT09IHVuZGVmaW5lZCAmJiBfLmluY2x1ZGVzKCRzY29wZS5zZWxlY3RlZFBvbGljaWVzLCBjdXJyZW50UG9saWN5TmFtZSkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vVG8gZGlzcGxheSBzZWxlY3RlZCBwb2xpY2llc1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkUG9saWNpZXMucHVzaChjdXJyZW50UG9saWN5TmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1RvIGRpc3BsYXkgcnVsZXMgb2Ygc2VsZWN0ZWQgcG9saWNpZXNcbiAgICAgICAgICAgICAgICAgICAgICAgIFJ1bGVzTW9kZWwuZ2V0SW5jb21pbmdSdWxlcyhjdXJyZW50UG9saWN5TmFtZSwgJ2RlZmF1bHQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChydWxlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KCRzY29wZS5pbmNvbWluZ1J1bGVzLCBydWxlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFJ1bGVzTW9kZWwuZ2V0T3V0Z29pbmdSdWxlcyhjdXJyZW50UG9saWN5TmFtZSwgJ2RlZmF1bHQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChydWxlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KCRzY29wZS5vdXRnb2luZ1J1bGVzLCBydWxlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vVG8gYmUgYWRkZWQgdG8gYXBwbGljYXRpb24gZ3JvdXAgYW5kIHNhdmVkIHRvIHRoZSBzZXJ2ZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hcHBsaWNhdGlvbmdyb3VwLnBvbGljaWVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnB1c2goY3VycmVudFBvbGljeU5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBSZW1vdmUgcG9saWN5IGZyb20gYXBwbGljYXRpb24gZ3JvdXBcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAkc2NvcGUucmVtb3ZlSXNvbGF0aW9uUG9saWN5ID0gZnVuY3Rpb24gKHBvbGljeU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgXy5yZW1vdmUoJHNjb3BlLnNlbGVjdGVkUG9saWNpZXMsIGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwb2xpY3kgPT09IHBvbGljeU5hbWU7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBfLnJlbW92ZSgkc2NvcGUuYXBwbGljYXRpb25ncm91cC5wb2xpY2llcywgZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBvbGljeSA9PT0gcG9saWN5TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIF8ucmVtb3ZlKCRzY29wZS5pbmNvbWluZ1J1bGVzLCBmdW5jdGlvbiAocnVsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJ1bGUucG9saWN5TmFtZSA9PT0gcG9saWN5TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIF8ucmVtb3ZlKCRzY29wZS5vdXRnb2luZ1J1bGVzLCBmdW5jdGlvbiAocnVsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJ1bGUucG9saWN5TmFtZSA9PT0gcG9saWN5TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiAgVG8gY2hlY2sgJ2RldGFpbHMnIG9yICdlZGl0JyBtb2RlIChub3QgY3JlYXRlIG1vZGUpXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5tb2RlID09ICdkZXRhaWxzJyB8fCAoJHNjb3BlLm1vZGUgPT0gJ2VkaXQnICYmICRzY29wZS5hcHBsaWNhdGlvbmdyb3VwLmdyb3VwTmFtZSAhPSBcIlwiKSkge1xuICAgICAgICAgICAgICAgICAgICAvL0FwcGxpY2F0aW9uIEdyb3VwcyBtaWdodCBub3QgaGF2ZSBhbnkgcG9saWNpZXMgYXNzb2NpYXRlZCB3aXRoIHRoZW0gc28gZGVmaW5lIGFuIGVtcHR5IGFycmF5XG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuYXBwbGljYXRpb25ncm91cC5wb2xpY2llcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXBwbGljYXRpb25ncm91cC5wb2xpY2llcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGdldFJ1bGVzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGdldElzb2xhdGlvblBvbGljaWVzKCk7XG4gICAgICAgICAgICB9XSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHBsaWNhdGlvbmdyb3Vwcy9pc29sYXRpb25wb2xpY3kuaHRtbCdcbiAgICB9O1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pc29sYXRpb25wb2xpY3lkaXJlY3RpdmUuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzE5LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LmxvZ2luJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2LmxvZ2luJywge1xuICAgICAgICAgICAgdXJsOiAnLycsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2xvZ2luL2xvZ2luLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0xvZ2luQ3RybCBhcyBsb2dpbkN0cmwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdMb2dpbkN0cmwnLCBbJyRzdGF0ZScsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIGxvZ2luQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvRGFzaGJvYXJkKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5kYXNoYm9hcmQnLCB7IHVzZXJuYW1lOiBsb2dpbkN0cmwudXNlcm5hbWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gbG9naW4oKSB7XG4gICAgICAgICAgICByZXR1cm5Ub0Rhc2hib2FyZCgpO1xuICAgICAgICB9XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobG9naW5DdHJsKTtcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGxvZ2luQ3RybCk7XG4gICAgICAgIGxvZ2luQ3RybC5sb2dpbiA9IGxvZ2luO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxvZ2luY3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTkvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubWVudScpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Jywge1xuICAgICAgICAgICAgdXJsOiAnL20nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdtZW51L21lbnUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTWVudUN0cmwgYXMgbWVudUN0cmwnLFxuICAgICAgICAgICAgcGFyYW1zOiB7IHVzZXJuYW1lOiBudWxsIH1cbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ01lbnVDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zKSB7XG4gICAgICAgIHZhciBtZW51Q3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGxvZ291dCgpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2LmxvZ2luJyk7XG4gICAgICAgIH1cbiAgICAgICAgbWVudUN0cmwudXNlcm5hbWUgPSAkc3RhdGVQYXJhbXMudXNlcm5hbWU7XG4gICAgICAgIG1lbnVDdHJsLmxvZ291dCA9IGxvZ291dDtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tZW51Q3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgaGFyZGlrIGdhbmRoaSBvbiA2LzI0LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5uZXR3b3JrcG9saWNpZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2QmFuZHdpZHRoXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgYmFuZHdpZHRoUG9saWN5OiAnPScsXG4gICAgICAgICAgICBtb2RlOiBcIkBcIlxuICAgICAgICB9LFxuICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUpIHtcbiAgICAgICAgICAgIGlmIChzY29wZS5iYW5kd2lkdGhQb2xpY3kuYmFuZHdpZHRoICE9ICcnKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJhbmR3aWR0aEFycmF5ID0gc2NvcGUuYmFuZHdpZHRoUG9saWN5LmJhbmR3aWR0aC5zcGxpdCgnICcpO1xuICAgICAgICAgICAgICAgIHNjb3BlLmJhbmR3aWR0aFBvbGljeS5iYW5kd2lkdGhOdW1iZXIgPSBOdW1iZXIoYmFuZHdpZHRoQXJyYXlbMF0pO1xuICAgICAgICAgICAgICAgIHNjb3BlLmJhbmR3aWR0aFBvbGljeS5iYW5kd2lkdGhVbml0ID0gYmFuZHdpZHRoQXJyYXlbMV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnbmV0d29ya19wb2xpY2llcy9iYW5kd2lkdGguaHRtbCdcbiAgICB9O1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1iYW5kd2lkdGhkaXJlY3RpdmUuanMubWFwIiwiLypcbi8qKlxuICogQ3JlYXRlZCBieSBoYXJkaWsgZ2FuZGhpIG9uIDYvMTQvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3BvbGljaWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmJhbmR3aWR0aC5jcmVhdGUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdCYW5kd2lkdGhQb2xpY3lDcmVhdGVDdHJsIGFzIGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3JrX3BvbGljaWVzL2JhbmR3aWR0aHBvbGljeWNyZWF0ZS5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignQmFuZHdpZHRoUG9saWN5Q3JlYXRlQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdOZXRwcm9maWxlc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIE5ldHByb2ZpbGVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBiYW5kd2lkdGhQb2xpY3lDcmVhdGVDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Qb2xpY2llcygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmxpc3QuYmFuZHdpZHRoJyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub1BvbGljaWVzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlUG9saWN5KCkge1xuICAgICAgICAgICAgaWYgKGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoYmFuZHdpZHRoUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoYmFuZHdpZHRoUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgYmFuZHdpZHRoUG9saWN5Q3JlYXRlQ3RybC5uZXdQb2xpY3kua2V5ID1cbiAgICAgICAgICAgICAgICAgICAgTmV0cHJvZmlsZXNNb2RlbC5nZW5lcmF0ZUtleShiYW5kd2lkdGhQb2xpY3lDcmVhdGVDdHJsLm5ld1BvbGljeSk7XG4gICAgICAgICAgICAgICAgYmFuZHdpZHRoUG9saWN5Q3JlYXRlQ3RybC5uZXdQb2xpY3kuYmFuZHdpZHRoID0gYmFuZHdpZHRoUG9saWN5Q3JlYXRlQ3RybC5uZXdQb2xpY3kuYmFuZHdpZHRoTnVtYmVyXG4gICAgICAgICAgICAgICAgICAgICsgXCIgXCIgKyBiYW5kd2lkdGhQb2xpY3lDcmVhdGVDdHJsLm5ld1BvbGljeS5iYW5kd2lkdGhVbml0O1xuICAgICAgICAgICAgICAgIE5ldHByb2ZpbGVzTW9kZWwuY3JlYXRlKGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwubmV3UG9saWN5KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihiYW5kd2lkdGhQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9Qb2xpY2llcygpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYmFuZHdpZHRoUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihiYW5kd2lkdGhQb2xpY3lDcmVhdGVDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJlc2V0Rm9ybSgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYmFuZHdpZHRoUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoYmFuZHdpZHRoUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBiYW5kd2lkdGhQb2xpY3lDcmVhdGVDdHJsLm5ld1BvbGljeSA9IHtcbiAgICAgICAgICAgICAgICBwcm9maWxlTmFtZTogJycsXG4gICAgICAgICAgICAgICAgdGVuYW50TmFtZTogJ2RlZmF1bHQnLFxuICAgICAgICAgICAgICAgIGJhbmR3aWR0aDogJycsXG4gICAgICAgICAgICAgICAgRFNDUDogJydcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgYmFuZHdpZHRoUG9saWN5Q3JlYXRlQ3RybC5jcmVhdGVQb2xpY3kgPSBjcmVhdGVQb2xpY3k7XG4gICAgICAgIGJhbmR3aWR0aFBvbGljeUNyZWF0ZUN0cmwuY2FuY2VsQ3JlYXRpbmcgPSBjYW5jZWxDcmVhdGluZztcbiAgICAgICAgcmVzZXRGb3JtKCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YmFuZHdpZHRocG9saWN5Y3JlYXRlY3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgaGFyZGlrIGdhbmRoaSBvbiA2LzE2LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtwb2xpY2llcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGguZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0JhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsIGFzIGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmV0d29ya19wb2xpY2llcy9iYW5kd2lkdGhwb2xpY3lkZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuYmFuZHdpZHRoLmVkaXQnLCB7XG4gICAgICAgICAgICB1cmw6ICcvZWRpdC86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdCYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCBhcyBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtfcG9saWNpZXMvYmFuZHdpZHRocG9saWN5ZGV0YWlscy5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignQmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwnLCBbXG4gICAgJyRzdGF0ZScsXG4gICAgJyRzdGF0ZVBhcmFtcycsXG4gICAgJ05ldHByb2ZpbGVzTW9kZWwnLFxuICAgICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBOZXRwcm9maWxlc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwgPSB0aGlzO1xuICAgICAgICBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybC5iYW5kd2lkdGhQcm9maWxlcyA9IFtdO1xuICAgICAgICAvKiBHZXQgcGFydGljdWxhciBQcm9maWxlIGZvciBiYXNlZCBvbiBrZXkqL1xuICAgICAgICBOZXRwcm9maWxlc01vZGVsLmdldE1vZGVsQnlLZXkoJHN0YXRlUGFyYW1zLmtleSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChwb2xpY3kpIHtcbiAgICAgICAgICAgIGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLnBvbGljeSA9IHBvbGljeTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUbyBzaG93IGVkaXQgb3IgZGV0YWlscyBzY3JlZW4gYmFzZWQgb24gdGhlIHJvdXRlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBzZXRNb2RlKCkge1xuICAgICAgICAgICAgaWYgKCRzdGF0ZS5pcygnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmJhbmR3aWR0aC5lZGl0JykpIHtcbiAgICAgICAgICAgICAgICBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybC5tb2RlID0gJ2VkaXQnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwubW9kZSA9ICdkZXRhaWxzJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBkZWxldGVQb2xpY3koKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgTmV0cHJvZmlsZXNNb2RlbC5kZWxldGVVc2luZ0tleShiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kua2V5LCAnbmFtZScpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIHJldHVyblRvUG9saWNpZXMoKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Qb2xpY2llcygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmxpc3QuYmFuZHdpZHRoJyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Qb2xpY3lEZXRhaWxzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuYmFuZHdpZHRoLmRldGFpbHMnLCB7ICdrZXknOiBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kua2V5IH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbEVkaXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub1BvbGljeURldGFpbHMoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBzYXZlUG9saWN5KCkge1xuICAgICAgICAgICAgLy9mb3JtIGNvbnRyb2xsZXIgaXMgaW5qZWN0ZWQgYnkgdGhlIGh0bWwgdGVtcGxhdGVcbiAgICAgICAgICAgIC8vY2hlY2tpbmcgaWYgYWxsIHZhbGlkYXRpb25zIGhhdmUgcGFzc2VkXG4gICAgICAgICAgICBpZiAoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBiYW5kd2lkdGhQb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kuYmFuZHdpZHRoID0gYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwucG9saWN5LmJhbmR3aWR0aE51bWJlciArIFwiIFwiICsgYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwucG9saWN5LmJhbmR3aWR0aFVuaXQ7XG4gICAgICAgICAgICAgICAgTmV0cHJvZmlsZXNNb2RlbC5zYXZlKGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLnBvbGljeSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1BvbGljeURldGFpbHMoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICBzZXRNb2RlKCk7XG4gICAgICAgIGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLmRlbGV0ZVBvbGljeSA9IGRlbGV0ZVBvbGljeTtcbiAgICAgICAgYmFuZHdpZHRoUG9saWN5RGV0YWlsc0N0cmwuc2F2ZVBvbGljeSA9IHNhdmVQb2xpY3k7XG4gICAgICAgIGJhbmR3aWR0aFBvbGljeURldGFpbHNDdHJsLmNhbmNlbEVkaXRpbmcgPSBjYW5jZWxFZGl0aW5nO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJhbmR3aWR0aHBvbGljeWRldGFpbHNjdHJsLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSBoYXJkaWsgZ2FuZGhpIG9uIDYvMTQvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3BvbGljaWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmxpc3QuYmFuZHdpZHRoJywge1xuICAgICAgICAgICAgdXJsOiAnL2JhbmR3aWR0aCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQmFuZHdpZHRoUG9saWN5TGlzdEN0cmwgYXMgYmFuZHdpZHRoUG9saWN5TGlzdEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3JrX3BvbGljaWVzL2JhbmR3aWR0aHBvbGljeWxpc3QuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ0JhbmR3aWR0aFBvbGljeUxpc3RDdHJsJywgWyckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnTmV0cHJvZmlsZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBOZXRwcm9maWxlc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgcG9saWNpZXNMaXN0Q3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGdldFBvbGljaWVzKHJlbG9hZCkge1xuICAgICAgICAgICAgTmV0cHJvZmlsZXNNb2RlbC5nZXQocmVsb2FkKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHBvbGljaWVzTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgIHBvbGljaWVzTGlzdEN0cmwucG9saWNpZXMgPSAkZmlsdGVyKCdvcmRlckJ5JykocmVzdWx0LCAncHJvZmlsZU5hbWUnKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihwb2xpY2llc0xpc3RDdHJsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vTG9hZCBmcm9tIGNhY2hlIGZvciBxdWljayBkaXNwbGF5IGluaXRpYWxseVxuICAgICAgICBnZXRQb2xpY2llcyh0cnVlKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3Qgc3RhcnQgYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldFBvbGljaWVzKHRydWUpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YmFuZHdpZHRocG9saWN5bGlzdGN0cmwuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzgvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3BvbGljaWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmlzb2xhdGlvbi5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnSXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwgYXMgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3JrX3BvbGljaWVzL2lzb2xhdGlvbnBvbGljeWRldGFpbHMuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5pc29sYXRpb24uZWRpdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9lZGl0LzprZXknLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0lzb2xhdGlvblBvbGljeURldGFpbHNDdHJsIGFzIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmV0d29ya19wb2xpY2llcy9pc29sYXRpb25wb2xpY3lkZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdJc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCcsIFtcbiAgICAnJHN0YXRlJyxcbiAgICAnJHN0YXRlUGFyYW1zJyxcbiAgICAnUG9saWNpZXNNb2RlbCcsXG4gICAgJ1J1bGVzTW9kZWwnLFxuICAgICdOZXR3b3Jrc01vZGVsJyxcbiAgICAnQXBwbGljYXRpb25Hcm91cHNNb2RlbCcsXG4gICAgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIFBvbGljaWVzTW9kZWwsIFJ1bGVzTW9kZWwsIE5ldHdvcmtzTW9kZWwsIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCA9IHRoaXM7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ldHdvcmtzID0gW107XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmFwcGxpY2F0aW9uR3JvdXBzID0gW107XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ05ldHdvcmtTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nTmV0d29ya1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlT3V0Z29pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVJbmNvbWluZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nSVBBZGRyZXNzU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ0lQQWRkcmVzc1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1NlbGVjdGVkQXBwbGljYXRpb25Hcm91cCA9ICcnO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1NlbGVjdGVkQXBwbGljYXRpb25Hcm91cCA9ICcnO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1NlbGVjdGVkTmV0d29yayA9ICcnO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1NlbGVjdGVkTmV0d29yayA9ICcnO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvcnJlY3RDSURSID0gZmFsc2U7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLnZhbGlkYXRlQ0lEUkZsYWcgPSBmYWxzZTtcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Qb2xpY2llcygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmxpc3QuaXNvbGF0aW9uJyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Qb2xpY3lEZXRhaWxzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuaXNvbGF0aW9uLmRldGFpbHMnLCB7IGtleTogaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwucG9saWN5LmtleSB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxFZGl0aW5nKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9Qb2xpY3lEZXRhaWxzKCk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdvIGJhY2sgdG8gcG9saWN5IGRldGFpbHMgYWZ0ZXIgZG9uZSBlZGl0aW5nXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBkb25lRWRpdGluZygpIHtcbiAgICAgICAgICAgIHJldHVyblRvUG9saWN5RGV0YWlscygpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGRlbGV0ZVBvbGljeSgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBQb2xpY2llc01vZGVsLmRlbGV0ZShpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIHJldHVyblRvUG9saWNpZXMoKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRvIHNob3cgZWRpdCBvciBkZXRhaWxzIHNjcmVlbiBiYXNlZCBvbiB0aGUgcm91dGVcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHNldE1vZGUoKSB7XG4gICAgICAgICAgICBpZiAoJHN0YXRlLmlzKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuaXNvbGF0aW9uLmVkaXQnKSkge1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm1vZGUgPSAnZWRpdCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5tb2RlID0gJ2RldGFpbHMnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJlc2V0TmV3SW5jb21pbmdSdWxlKCkge1xuICAgICAgICAgICAgLy9SdWxlIG9iamVjdCB0byBiZSBjcmVhdGVkIG9uIHNlcnZlclxuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlID0ge1xuICAgICAgICAgICAgICAgIHJ1bGVJZDogJycsXG4gICAgICAgICAgICAgICAgcHJpb3JpdHk6IDEsXG4gICAgICAgICAgICAgICAgYWN0aW9uOiAnYWxsb3cnLFxuICAgICAgICAgICAgICAgIGZyb21FbmRwb2ludEdyb3VwOiAnJyxcbiAgICAgICAgICAgICAgICBmcm9tTmV0d29yazogJycsXG4gICAgICAgICAgICAgICAgZnJvbUlwQWRkcmVzczogJycsXG4gICAgICAgICAgICAgICAgcHJvdG9jb2w6ICd0Y3AnLFxuICAgICAgICAgICAgICAgIHBvcnQ6IDAsXG4gICAgICAgICAgICAgICAgZGlyZWN0aW9uOiAnaW4nLFxuICAgICAgICAgICAgICAgIHRlbmFudE5hbWU6ICdkZWZhdWx0JyxcbiAgICAgICAgICAgICAgICBwb2xpY3lOYW1lOiBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kucG9saWN5TmFtZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nU2VsZWN0ZWRBcHBsaWNhdGlvbkdyb3VwID0gJyc7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1NlbGVjdGVkTmV0d29yayA9ICcnO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nTmV0d29ya1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nSVBBZGRyZXNzU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvcnJlY3RDSURSID0gZmFsc2U7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC52YWxpZGF0ZUNJRFJGbGFnID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmVzZXROZXdPdXRnb2luZ1J1bGUoKSB7XG4gICAgICAgICAgICAvL1J1bGUgb2JqZWN0IHRvIGJlIGNyZWF0ZWQgb24gc2VydmVyXG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1J1bGUgPSB7XG4gICAgICAgICAgICAgICAgcnVsZUlkOiAnJyxcbiAgICAgICAgICAgICAgICBwcmlvcml0eTogMSxcbiAgICAgICAgICAgICAgICBhY3Rpb246ICdhbGxvdycsXG4gICAgICAgICAgICAgICAgdG9FbmRwb2ludEdyb3VwOiAnJyxcbiAgICAgICAgICAgICAgICB0b05ldHdvcms6ICcnLFxuICAgICAgICAgICAgICAgIHRvSXBBZGRyZXNzOiAnJyxcbiAgICAgICAgICAgICAgICBwcm90b2NvbDogJ3RjcCcsXG4gICAgICAgICAgICAgICAgcG9ydDogMCxcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb246ICdvdXQnLFxuICAgICAgICAgICAgICAgIHRlbmFudE5hbWU6ICdkZWZhdWx0JyxcbiAgICAgICAgICAgICAgICBwb2xpY3lOYW1lOiBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kucG9saWN5TmFtZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nU2VsZWN0ZWRBcHBsaWNhdGlvbkdyb3VwID0gJyc7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1NlbGVjdGVkTmV0d29yayA9ICcnO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nTmV0d29ya1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nSVBBZGRyZXNzU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvcnJlY3RDSURSID0gZmFsc2U7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC52YWxpZGF0ZUNJRFJGbGFnID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdldCBuZXR3b3JrIG5hbWVzIGZvciB0aGUgZ2l2ZW4gdGVuYW50LlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gZ2V0TmV0d29ya3MoKSB7XG4gICAgICAgICAgICBOZXR3b3Jrc01vZGVsLmdldCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vXy5maWx0ZXIoKSByZXR1cm5zIGEgbmV3IGFycmF5XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV0d29ya3MgPSBfLmZpbHRlcihyZXN1bHQsIHtcbiAgICAgICAgICAgICAgICAgICAgJ3RlbmFudE5hbWUnOiAnZGVmYXVsdCcgLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZXQgYXBwbGljYXRpb24gZ3JvdXAgbmFtZXMgZm9yIHRoZSBnaXZlbiB0ZW5hbnQuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBnZXRBcHBsaWNhdGlvbkdyb3VwcygpIHtcbiAgICAgICAgICAgIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwuZ2V0KClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy9fLmZpbHRlcigpIHJldHVybnMgYSBuZXcgYXJyYXlcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5hcHBsaWNhdGlvbkdyb3VwcyA9IF8uZmlsdGVyKHJlc3VsdCwge1xuICAgICAgICAgICAgICAgICAgICAndGVuYW50TmFtZSc6ICdkZWZhdWx0JyAvL1RPRE86IFJlbW92ZSBoYXJkY29kZWQgdGVuYW50LlxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEV2ZW50IGhhbmRsZXIgdG8gZGlzYWJsZSBuZXR3b3JrIHNlbGVjdGlvbiBib3ggb25jZSBhcHBsaWNhdGlvbiBncm91cCBpcyBzZWxlY3RlZCB3aGlsZSBjcmVhdGluZyBhIG5ld1xuICAgICAgICAgKiBydWxlLlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gb25DaGFuZ2VPdXRnb2luZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdTZWxlY3RlZEFwcGxpY2F0aW9uR3JvdXAgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIC8vSWYgYXBwbGljYXRpb24gZ3JvdXAgaGFzIGJlZW4gc2VsZWN0ZWRcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1J1bGUudG9FbmRwb2ludEdyb3VwID1cbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdTZWxlY3RlZEFwcGxpY2F0aW9uR3JvdXAuZ3JvdXBOYW1lO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZS50b05ldHdvcmsgPSAnJztcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlT3V0Z29pbmdOZXR3b3JrU2VsZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vV2hlbiAnbm9uZScgaXMgc2VsZWN0ZWRcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1J1bGUudG9FbmRwb2ludEdyb3VwID0gJyc7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nTmV0d29ya1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBFdmVudCBoYW5kbGVyIHRvIGRpc2FibGUgbmV0d29yayBzZWxlY3Rpb24gYm94IG9uY2UgYXBwbGljYXRpb24gZ3JvdXAgaXMgc2VsZWN0ZWQgd2hpbGUgY3JlYXRpbmcgYSBuZXdcbiAgICAgICAgICogcnVsZS5cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIG9uQ2hhbmdlSW5jb21pbmdBcHBsaWNhdGlvbkdyb3VwU2VsZWN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nU2VsZWN0ZWRBcHBsaWNhdGlvbkdyb3VwICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAvL0lmIGFwcGxpY2F0aW9uIGdyb3VwIGhhcyBiZWVuIHNlbGVjdGVkXG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlLmZyb21FbmRwb2ludEdyb3VwID1cbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdTZWxlY3RlZEFwcGxpY2F0aW9uR3JvdXAuZ3JvdXBOYW1lO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nUnVsZS5mcm9tTmV0d29yayA9ICcnO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVJbmNvbWluZ05ldHdvcmtTZWxlY3Rpb24gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy9XaGVuICdub25lJyBpcyBzZWxlY3RlZFxuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nUnVsZS5mcm9tRW5kcG9pbnRHcm91cCA9ICcnO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdOZXR3b3JrU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEV2ZW50IGhhbmRsZXIgdG8gZGlzYWJsZSBhcHBsaWNhdGlvbiBncm91cCBzZWxlY3Rpb24gYm94IG9uY2UgbmV0d29yayBpcyBzZWxlY3RlZCB3aGlsZSBjcmVhdGluZyBhIG5ld1xuICAgICAgICAgKiBydWxlLlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gb25DaGFuZ2VPdXRnb2luZ05ldHdvcmtTZWxlY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdTZWxlY3RlZE5ldHdvcmsgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIC8vSWYgbmV0d29yayBoYXMgYmVlbiBzZWxlY3RlZFxuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZS50b05ldHdvcmsgPVxuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1NlbGVjdGVkTmV0d29yaztcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1J1bGUuVG9FbmRwb2ludEdyb3VwID0gJyc7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZU91dGdvaW5nSVBBZGRyZXNzU2VsZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZS50b0lwQWRkcmVzcyA9ICcnO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlT3V0Z29pbmdJUEFkZHJlc3NTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogRXZlbnQgaGFuZGxlciB0byBkaXNhYmxlIGFwcGxpY2F0aW9uIGdyb3VwIHNlbGVjdGlvbiBib3ggb25jZSBuZXR3b3JrIGlzIHNlbGVjdGVkIHdoaWxlIGNyZWF0aW5nIGEgbmV3XG4gICAgICAgICAqIHJ1bGUuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBvbkNoYW5nZUluY29taW5nTmV0d29ya1NlbGVjdGlvbigpIHtcbiAgICAgICAgICAgIGlmIChpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1NlbGVjdGVkTmV0d29yayAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgLy9JZiBuZXR3b3JrIGhhcyBiZWVuIHNlbGVjdGVkXG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlLmZyb21OZXR3b3JrID1cbiAgICAgICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdTZWxlY3RlZE5ldHdvcms7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlLmZyb21FbmRwb2ludEdyb3VwID0gJyc7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nSVBBZGRyZXNzU2VsZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nUnVsZS5mcm9tTmV0d29yayA9ICcnO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVJbmNvbWluZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kaXNhYmxlSW5jb21pbmdJUEFkZHJlc3NTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogR2VuZXJhdGVzIHJ1bGUgaWRcbiAgICAgICAgICogVE9ETyBNYWtlIGl0IGNyeXB0b2dyYXBoaWNhbGx5IHN0cm9uZ2VyIG9uY2Ugd2UgaGF2ZSBtdWx0aXBsZSB1c2VycyB1cGRhdGluZyBzYW1lIHBvbGljeVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gZ2VuZXJhdGVSdWxlSWQocnVsZSkge1xuICAgICAgICAgICAgcnVsZS5ydWxlSWQgPVxuICAgICAgICAgICAgICAgIChpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvbWluZ1J1bGVzLmxlbmd0aCArIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm91dGdvaW5nUnVsZXMubGVuZ3RoICsgMSkudG9TdHJpbmcoKSArICctJyArXG4gICAgICAgICAgICAgICAgICAgIERhdGUubm93KCkudG9TdHJpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogUnVsZSBpcyBzYXZlZCB0byBzZXJ2ZXJcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGFkZEluY29taW5nUnVsZSgpIHtcbiAgICAgICAgICAgIGlmICh2YWxpZGF0ZUNJRFIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlLmZyb21JcEFkZHJlc3MpKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgZ2VuZXJhdGVSdWxlSWQoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlKTtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUua2V5ID0gUnVsZXNNb2RlbC5nZW5lcmF0ZUtleShpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdJbmNvbWluZ1J1bGUpO1xuICAgICAgICAgICAgICAgIFJ1bGVzTW9kZWwuY3JlYXRlKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld0luY29taW5nUnVsZSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvbWluZ1J1bGVzLnB1c2gocmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgcmVzZXROZXdJbmNvbWluZ1J1bGUoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIG9uQ2hhbmdlSW5jb21pbmdJUEFkZHJlc3MoKSB7XG4gICAgICAgICAgICBpZiAoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlLmZyb21JcEFkZHJlc3MgPT0gJycpIHtcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvcnJlY3RDSURSID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nTmV0d29ya1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGlzYWJsZUluY29taW5nTmV0d29ya1NlbGVjdGlvbiA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwudmFsaWRhdGVDSURSRmxhZyAmJlxuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29ycmVjdENJRFIpIHtcbiAgICAgICAgICAgICAgICB2YWxpZGF0ZUNJRFIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3SW5jb21pbmdSdWxlLmZyb21JcEFkZHJlc3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIG9uQ2hhbmdlT3V0Z29pbmdJUEFkZHJlc3MoKSB7XG4gICAgICAgICAgICBpZiAoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlLnRvSXBBZGRyZXNzID09ICcnKSB7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuaW5jb3JyZWN0Q0lEUiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ05ldHdvcmtTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRpc2FibGVPdXRnb2luZ05ldHdvcmtTZWxlY3Rpb24gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLnZhbGlkYXRlQ0lEUkZsYWcgJiZcbiAgICAgICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5pbmNvcnJlY3RDSURSKSB7XG4gICAgICAgICAgICAgICAgdmFsaWRhdGVDSURSKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZS50b0lwQWRkcmVzcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gdmFsaWRhdGVDSURSKGlwYWRkcmVzcykge1xuICAgICAgICAgICAgdmFyIGNpZHJQYXR0ZXJuID0gbmV3IFJlZ0V4cChDb250aXZHbG9iYWxzLkNJRFJfUkVHRVgpO1xuICAgICAgICAgICAgaWYgKGlwYWRkcmVzcyA9PSAnJykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNpZHJQYXR0ZXJuLnRlc3QoaXBhZGRyZXNzKSkge1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29ycmVjdENJRFIgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29ycmVjdENJRFIgPSB0cnVlO1xuICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwudmFsaWRhdGVDSURSRmxhZyA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJ1bGUgaXMgc2F2ZWQgdG8gc2VydmVyXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBhZGRPdXRnb2luZ1J1bGUoKSB7XG4gICAgICAgICAgICBpZiAodmFsaWRhdGVDSURSKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZS50b0lwQWRkcmVzcykpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBnZW5lcmF0ZVJ1bGVJZChpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5uZXdPdXRnb2luZ1J1bGUpO1xuICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZS5rZXkgPSBSdWxlc01vZGVsLmdlbmVyYXRlS2V5KGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm5ld091dGdvaW5nUnVsZSk7XG4gICAgICAgICAgICAgICAgUnVsZXNNb2RlbC5jcmVhdGUoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwubmV3T3V0Z29pbmdSdWxlKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm91dGdvaW5nUnVsZXMucHVzaChyZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICByZXNldE5ld091dGdvaW5nUnVsZSgpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERlbGV0ZSBpbmNvbWluZyBydWxlIGZyb20gc2VydmVyXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBkZWxldGVJbmNvbWluZ1J1bGUoa2V5KSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgUnVsZXNNb2RlbC5kZWxldGVVc2luZ0tleShrZXkpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIF8ucmVtb3ZlKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmluY29taW5nUnVsZXMsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuLmtleSA9PSBrZXk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEZWxldGUgb3V0Z29pbmcgcnVsZSBmcm9tIHNlcnZlclxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gZGVsZXRlT3V0Z29pbmdSdWxlKGtleSkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIFJ1bGVzTW9kZWwuZGVsZXRlVXNpbmdLZXkoa2V5KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBfLnJlbW92ZShpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5vdXRnb2luZ1J1bGVzLCBmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbi5rZXkgPT0ga2V5O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgUG9saWNpZXNNb2RlbC5nZXRNb2RlbEJ5S2V5KCRzdGF0ZVBhcmFtcy5rZXkpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocG9saWN5KSB7XG4gICAgICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5wb2xpY3kgPSBwb2xpY3k7XG4gICAgICAgICAgICBSdWxlc01vZGVsLmdldEluY29taW5nUnVsZXMocG9saWN5LnBvbGljeU5hbWUsICdkZWZhdWx0JykudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuaW5jb21pbmdSdWxlcyA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICByZXNldE5ld0luY29taW5nUnVsZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBSdWxlc01vZGVsLmdldE91dGdvaW5nUnVsZXMocG9saWN5LnBvbGljeU5hbWUsICdkZWZhdWx0JykudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwub3V0Z29pbmdSdWxlcyA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICByZXNldE5ld091dGdvaW5nUnVsZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBnZXROZXR3b3JrcygpO1xuICAgICAgICBnZXRBcHBsaWNhdGlvbkdyb3VwcygpO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5kZWxldGVQb2xpY3kgPSBkZWxldGVQb2xpY3k7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmRlbGV0ZUluY29taW5nUnVsZSA9IGRlbGV0ZUluY29taW5nUnVsZTtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZGVsZXRlT3V0Z29pbmdSdWxlID0gZGVsZXRlT3V0Z29pbmdSdWxlO1xuICAgICAgICBpc29sYXRpb25Qb2xpY3lEZXRhaWxzQ3RybC5hZGRJbmNvbWluZ1J1bGUgPSBhZGRJbmNvbWluZ1J1bGU7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLmFkZE91dGdvaW5nUnVsZSA9IGFkZE91dGdvaW5nUnVsZTtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuZG9uZUVkaXRpbmcgPSBkb25lRWRpdGluZztcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwuY2FuY2VsRWRpdGluZyA9IGNhbmNlbEVkaXRpbmc7XG4gICAgICAgIC8vRXZlbnQgSGFuZGxlcnNcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwub25DaGFuZ2VPdXRnb2luZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24gPSBvbkNoYW5nZU91dGdvaW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbjtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwub25DaGFuZ2VJbmNvbWluZ0FwcGxpY2F0aW9uR3JvdXBTZWxlY3Rpb24gPSBvbkNoYW5nZUluY29taW5nQXBwbGljYXRpb25Hcm91cFNlbGVjdGlvbjtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwub25DaGFuZ2VPdXRnb2luZ05ldHdvcmtTZWxlY3Rpb24gPSBvbkNoYW5nZU91dGdvaW5nTmV0d29ya1NlbGVjdGlvbjtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwub25DaGFuZ2VJbmNvbWluZ05ldHdvcmtTZWxlY3Rpb24gPSBvbkNoYW5nZUluY29taW5nTmV0d29ya1NlbGVjdGlvbjtcbiAgICAgICAgaXNvbGF0aW9uUG9saWN5RGV0YWlsc0N0cmwub25DaGFuZ2VJbmNvbWluZ0lQQWRkcmVzcyA9IG9uQ2hhbmdlSW5jb21pbmdJUEFkZHJlc3M7XG4gICAgICAgIGlzb2xhdGlvblBvbGljeURldGFpbHNDdHJsLm9uQ2hhbmdlT3V0Z29pbmdJUEFkZHJlc3MgPSBvbkNoYW5nZU91dGdvaW5nSVBBZGRyZXNzO1xuICAgICAgICBzZXRNb2RlKCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aXNvbGF0aW9ucG9saWN5ZGV0YWlsc2N0cmwuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcG9saWNpZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMubGlzdC5pc29sYXRpb24nLCB7XG4gICAgICAgICAgICB1cmw6ICcvaXNvbGF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdJc29sYXRpb25Qb2xpY3lMaXN0Q3RybCBhcyBpc29sYXRpb25Qb2xpY3lMaXN0Q3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtfcG9saWNpZXMvaXNvbGF0aW9ucG9saWN5bGlzdC5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignSXNvbGF0aW9uUG9saWN5TGlzdEN0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdQb2xpY2llc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIFBvbGljaWVzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBwb2xpY2llc0xpc3RDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gZ2V0UG9saWNpZXMocmVsb2FkKSB7XG4gICAgICAgICAgICBQb2xpY2llc01vZGVsLmdldChyZWxvYWQpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIocG9saWNpZXNMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgcG9saWNpZXNMaXN0Q3RybC5wb2xpY2llcyA9ICRmaWx0ZXIoJ29yZGVyQnknKShyZXN1bHQsICdwb2xpY3lOYW1lJyk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIocG9saWNpZXNMaXN0Q3RybCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgZ2V0UG9saWNpZXMoZmFsc2UpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBzdGFydCBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0UG9saWNpZXModHJ1ZSk7XG4gICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pc29sYXRpb25wb2xpY3lsaXN0Y3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvOS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5uZXR3b3JrcG9saWNpZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05ldHdvcmtQb2xpY2llc1RhYnNDdHJsIGFzIG5ldHdvcmtQb2xpY2llc1RhYnNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmV0d29ya19wb2xpY2llcy9uZXR3b3JrcG9saWNpZXN0YWJzLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5saXN0LnJlZGlyZWN0aW9uJywge1xuICAgICAgICAgICAgdXJsOiAnL3JlZGlyZWN0aW9uJyxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignTmV0d29ya1BvbGljaWVzVGFic0N0cmwnLCBbJyRzdGF0ZScsIGZ1bmN0aW9uICgkc3RhdGUpIHtcbiAgICAgICAgdmFyIG5ldHdvcmtQb2xpY2llc1RhYnNDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlTmV0d29ya1BvbGljeSgpIHtcbiAgICAgICAgICAgIGlmICgkc3RhdGUuJGN1cnJlbnQuaW5jbHVkZXNbJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5saXN0Lmlzb2xhdGlvbiddKSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5uZXR3b3JrcG9saWNpZXMuaXNvbGF0aW9uLmNyZWF0ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCRzdGF0ZS4kY3VycmVudC5pbmNsdWRlc1snY29udGl2Lm1lbnUubmV0d29ya3BvbGljaWVzLmxpc3QuYmFuZHdpZHRoJ10pIHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5ldHdvcmtwb2xpY2llcy5iYW5kd2lkdGguY3JlYXRlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbmV0d29ya1BvbGljaWVzVGFic0N0cmwuY3JlYXRlTmV0d29ya1BvbGljeSA9IGNyZWF0ZU5ldHdvcmtQb2xpY3k7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bmV0d29ya3BvbGljaWVzdGFic2N0cmwuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAyLzE5LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5ldHdvcmtzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubmV0d29ya3MuY3JlYXRlJywge1xuICAgICAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtzL25ldHdvcmtjcmVhdGUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTmV0d29ya0NyZWF0ZUN0cmwgYXMgbmV0d29ya0NyZWF0ZUN0cmwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdOZXR3b3JrQ3JlYXRlQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdOZXR3b3Jrc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIE5ldHdvcmtzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBuZXR3b3JrQ3JlYXRlQ3RybCA9IHRoaXM7XG4gICAgICAgIG5ldHdvcmtDcmVhdGVDdHJsLmNpZHJQYXR0ZXJuID0gQ29udGl2R2xvYmFscy5DSURSX1JFR0VYO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub05ldHdvcmtzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5uZXR3b3Jrcy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub05ldHdvcmtzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlTmV0d29yaygpIHtcbiAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgaWYgKG5ldHdvcmtDcmVhdGVDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG5ldHdvcmtDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihuZXR3b3JrQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgbmV0d29ya0NyZWF0ZUN0cmwubmV3TmV0d29yay5rZXkgPVxuICAgICAgICAgICAgICAgICAgICBuZXR3b3JrQ3JlYXRlQ3RybC5uZXdOZXR3b3JrLnRlbmFudE5hbWUgKyAnOicgKyBuZXR3b3JrQ3JlYXRlQ3RybC5uZXdOZXR3b3JrLm5ldHdvcmtOYW1lO1xuICAgICAgICAgICAgICAgIE5ldHdvcmtzTW9kZWwuY3JlYXRlKG5ldHdvcmtDcmVhdGVDdHJsLm5ld05ldHdvcmspLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9OZXR3b3JrcygpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobmV0d29ya0NyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IobmV0d29ya0NyZWF0ZUN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmVzZXRGb3JtKCkge1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3JrQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IobmV0d29ya0NyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgbmV0d29ya0NyZWF0ZUN0cmwubmV3TmV0d29yayA9IHtcbiAgICAgICAgICAgICAgICBuZXR3b3JrTmFtZTogJycsXG4gICAgICAgICAgICAgICAgZW5jYXA6ICd2eGxhbicsXG4gICAgICAgICAgICAgICAgc3VibmV0OiAnJyxcbiAgICAgICAgICAgICAgICBnYXRld2F5OiAnJyxcbiAgICAgICAgICAgICAgICB0ZW5hbnROYW1lOiAnZGVmYXVsdCcgLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgbmV0d29ya0NyZWF0ZUN0cmwuY3JlYXRlTmV0d29yayA9IGNyZWF0ZU5ldHdvcms7XG4gICAgICAgIG5ldHdvcmtDcmVhdGVDdHJsLmNhbmNlbENyZWF0aW5nID0gY2FuY2VsQ3JlYXRpbmc7XG4gICAgICAgIHJlc2V0Rm9ybSgpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5ldHdvcmtjcmVhdGVjdHJsLmpzLm1hcCIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3MnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3Jrcy5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTmV0d29ya0RldGFpbHNDdHJsIGFzIG5ldHdvcmtEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25ldHdvcmtzL25ldHdvcmtkZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5ldHdvcmtzLmRldGFpbHMuaW5mbycsIHtcbiAgICAgICAgICAgIHVybDogJy9pbmZvJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmV0d29ya3MvbmV0d29ya2luZm8uaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05ldHdvcmtEZXRhaWxzQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnTmV0d29ya3NNb2RlbCcsICdBcHBsaWNhdGlvbkdyb3Vwc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBOZXR3b3Jrc01vZGVsLCBBcHBsaWNhdGlvbkdyb3Vwc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgbmV0d29ya0RldGFpbHNDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9OZXR3b3JrcygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubmV0d29ya3MubGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGRlbGV0ZU5ldHdvcmsoKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IobmV0d29ya0RldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKG5ldHdvcmtEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBOZXR3b3Jrc01vZGVsLmRlbGV0ZShuZXR3b3JrRGV0YWlsc0N0cmwubmV0d29yaykudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3JrRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIHJldHVyblRvTmV0d29ya3MoKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3JrRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihuZXR3b3JrRGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IGFwcGxpY2F0aW9uIGdyb3VwcyBiZWxvbmdpbmcgdG8gYSBuZXR3b3JrXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBnZXRBcHBsaWNhdGlvbkdyb3VwcyhyZWxvYWQpIHtcbiAgICAgICAgICAgIEFwcGxpY2F0aW9uR3JvdXBzTW9kZWwuZ2V0KHJlbG9hZCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgbmV0d29ya0RldGFpbHNDdHJsLmFwcGxpY2F0aW9uR3JvdXBzID0gJGZpbHRlcignb3JkZXJCeScpKF8uZmlsdGVyKHJlc3VsdCwge1xuICAgICAgICAgICAgICAgICAgICAnbmV0d29ya05hbWUnOiBuZXR3b3JrRGV0YWlsc0N0cmwubmV0d29yay5uZXR3b3JrTmFtZVxuICAgICAgICAgICAgICAgIH0pLCAnZ3JvdXBOYW1lJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtEZXRhaWxzQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihuZXR3b3JrRGV0YWlsc0N0cmwpO1xuICAgICAgICBOZXR3b3Jrc01vZGVsLmdldE1vZGVsQnlLZXkoJHN0YXRlUGFyYW1zLmtleSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChuZXR3b3JrKSB7XG4gICAgICAgICAgICBuZXR3b3JrRGV0YWlsc0N0cmwubmV0d29yayA9IG5ldHdvcms7XG4gICAgICAgICAgICBnZXRBcHBsaWNhdGlvbkdyb3VwcyhmYWxzZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBuZXR3b3JrRGV0YWlsc0N0cmwuZGVsZXRlTmV0d29yayA9IGRlbGV0ZU5ldHdvcms7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG9yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldEFwcGxpY2F0aW9uR3JvdXBzKHRydWUpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bmV0d29ya2RldGFpbHNjdHJsLmpzLm1hcCIsInZhciBOZXR3b3Jrc0xpc3RDdHJsID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBOZXR3b3Jrc0xpc3RDdHJsKCRzY29wZSwgJGludGVydmFsLCBOZXR3b3Jrc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgbmV0d29ya3NMaXN0Q3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGdldE5ldHdvcmtzKHJlbG9hZCkge1xuICAgICAgICAgICAgTmV0d29ya3NNb2RlbC5nZXQocmVsb2FkKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5ldHdvcmtzTGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgIG5ldHdvcmtzTGlzdEN0cmwubmV0d29ya3MgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobmV0d29ya3NMaXN0Q3RybCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgZ2V0TmV0d29ya3MoZmFsc2UpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXROZXR3b3Jrcyh0cnVlKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBOZXR3b3Jrc0xpc3RDdHJsLiRpbmplY3QgPSBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnTmV0d29ya3NNb2RlbCcsICdDUlVESGVscGVyU2VydmljZSddO1xuICAgIHJldHVybiBOZXR3b3Jrc0xpc3RDdHJsO1xufSgpKTtcbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3MnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3Jrcy5saXN0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgY29tcG9uZW50OiAnbmV0d29ya0xpc3QnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb21wb25lbnQoJ25ldHdvcmtMaXN0Jywge1xuICAgIHRlbXBsYXRlVXJsOiAnbmV0d29ya3MvbmV0d29ya2xpc3QuaHRtbCcsXG4gICAgY29udHJvbGxlcjogTmV0d29ya3NMaXN0Q3RybCxcbiAgICBjb250cm9sbGVyQXM6ICduZXR3b3Jrc0xpc3RDdHJsJ1xufSk7XG4vKlxuICAgIC5jb250cm9sbGVyKCdOZXR3b3Jrc0xpc3RDdHJsJywgWyckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnTmV0d29ya3NNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uICgkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgTmV0d29ya3NNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgICAgIHZhciBuZXR3b3Jrc0xpc3RDdHJsID0gdGhpcztcblxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0TmV0d29ya3MocmVsb2FkKSB7XG4gICAgICAgICAgICAgICAgTmV0d29ya3NNb2RlbC5nZXQocmVsb2FkKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3Jrc0xpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXR3b3Jrc0xpc3RDdHJsLm5ldHdvcmtzID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3Jrc0xpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgICAgIGdldE5ldHdvcmtzKGZhbHNlKTtcblxuICAgICAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgICAgICAvL0Rvbid0IGRvIGF1dG9yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGdldE5ldHdvcmtzKHRydWUpO1xuICAgICAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfV0pO1xuKi8gXG4vLyMgc291cmNlTWFwcGluZ1VSTD1uZXR3b3JrbGlzdGN0cmwuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGNzaGFtcHVyIG9uIDYvMjMvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubmV0d29ya3MnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5uZXR3b3Jrcy5kZXRhaWxzLnN0YXRzJywge1xuICAgICAgICAgICAgdXJsOiAnL3N0YXRzJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOZXR3b3JrU3RhdHNDdHJsIGFzIG5ldHdvcmtTdGF0c0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZXR3b3Jrcy9uZXR3b3Jrc3RhdHMuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05ldHdvcmtTdGF0c0N0cmwnLCBbJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ05ldHdvcmtzTW9kZWwnLCAnSW5zcGVjdFNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIE5ldHdvcmtzTW9kZWwsIEluc3BlY3RTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBuZXR3b3JrU3RhdHNDdHJsID0gdGhpcztcbiAgICAgICAgLyogR2V0cyB0aGUgTmV0d29yayBPcGVyYXRpb25hbCBzdGF0ZSBmcm9tIHRoZSBzZXJ2ZXIgKi9cbiAgICAgICAgZnVuY3Rpb24gZ2V0TmV0d29ya0luc3BlY3QocmVmcmVzaCkge1xuICAgICAgICAgICAgTmV0d29ya3NNb2RlbC5nZXRJbnNwZWN0QnlLZXkoJHN0YXRlUGFyYW1zLmtleSwgQ29udGl2R2xvYmFscy5ORVRXT1JLU19JTlNQRUNUX0VORFBPSU5ULCByZWZyZXNoKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBuZXR3b3JrU3RhdHNDdHJsLm5ldHdvcmtJbnNwZWN0U3RhdHMgPSByZXN1bHQuT3BlcjtcbiAgICAgICAgICAgICAgICBuZXR3b3JrU3RhdHNDdHJsLmNvbmZpZyA9IHJlc3VsdC5Db25maWc7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5PcGVyLmVuZHBvaW50cyAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRhaW5lckRldGFpbHMgPSBJbnNwZWN0U2VydmljZS5idWlsZEVuZFBvaW50cyhyZXN1bHQuT3Blci5lbmRwb2ludHMpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoSW5zcGVjdFNlcnZpY2UuY2hlY2tDb250YWluZXJDaGFuZ2VkKG5ldHdvcmtTdGF0c0N0cmwuY29udGFpbmVyRGV0YWlscywgY29udGFpbmVyRGV0YWlscykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldHdvcmtTdGF0c0N0cmwuZW5kcG9pbnRzID0gcmVzdWx0Lk9wZXIuZW5kcG9pbnRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV0d29ya1N0YXRzQ3RybC5jb250YWluZXJEZXRhaWxzID0gY29udGFpbmVyRGV0YWlscztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbmV0d29ya1N0YXRzQ3RybC5lbmRwb2ludHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgbmV0d29ya1N0YXRzQ3RybC5jb250YWluZXJEZXRhaWxzID0ge307XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZ2V0TmV0d29ya0luc3BlY3QoZmFsc2UpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXROZXR3b3JrSW5zcGVjdCh0cnVlKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5ldHdvcmtzdGF0c2N0cmwuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmZhY3RvcnkoJ0JncFNlcnZpY2UnLCBbJyRodHRwJywgJyRxJywgZnVuY3Rpb24gKCRodHRwLCAkcSkge1xuICAgICAgICBmdW5jdGlvbiBnZXRCZ3AoY3RybCkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLkJHUFNfRU5EUE9JTlQgKyBjdHJsLmtleSArICcvJztcbiAgICAgICAgICAgICRodHRwLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgIGN0cmwubmVpZ2hib3IgPSByZXN1bHQuZGF0YTtcbiAgICAgICAgICAgICAgICBjdHJsLm5laWdoYm9ycy5wdXNoKHsgJ25hbWUnOiBjdHJsLm5laWdoYm9yWyduZWlnaGJvciddLCAndmFsdWUnOiBjdHJsLm5laWdoYm9yWyduZWlnaGJvci1hcyddIH0pO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVCZ3AoY3RybCkge1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuQkdQU19FTkRQT0lOVCArIGN0cmwua2V5ICsgJy8nO1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QodXJsLCBjdHJsLm5laWdoYm9yKTtcbiAgICAgICAgfVxuICAgICAgICA7XG4gICAgICAgIGZ1bmN0aW9uIGdldEJncEluc3BlY3Qoa2V5KSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuQkdQU19JTlNQRUNUX0VORFBPSU5UICsga2V5ICsgJy8nO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRCZ3A6IGdldEJncCxcbiAgICAgICAgICAgIHVwZGF0ZUJncDogdXBkYXRlQmdwLFxuICAgICAgICAgICAgZ2V0QmdwSW5zcGVjdDogZ2V0QmdwSW5zcGVjdFxuICAgICAgICB9O1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJncHNlcnZpY2UuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoXCJjb250aXYubm9kZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2TG9nc1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9sb2dzLmh0bWwnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgbG9nOiBcIj1cIixcbiAgICAgICAgICAgIHRpdGxlOiBcIkBcIlxuICAgICAgICB9XG4gICAgfTtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bG9nc2RpcmVjdGl2ZS5qcy5tYXAiLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJylcbiAgICAuZmFjdG9yeSgnTG9nU2VydmljZScsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbiAoJGh0dHAsICRxKSB7XG4gICAgICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUxvZ3MoKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuTk9ERVNfQUNUSVZFX0pPQl9FTkRQT0lOVDtcbiAgICAgICAgICAgICRodHRwLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnZXRMYXN0TG9ncygpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5OT0RFU19MQVNUX0pPQl9FTkRQT0lOVDtcbiAgICAgICAgICAgICRodHRwLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0QWN0aXZlTG9nczogZ2V0QWN0aXZlTG9ncyxcbiAgICAgICAgICAgIGdldExhc3RMb2dzOiBnZXRMYXN0TG9nc1xuICAgICAgICB9O1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxvZ3NlcnZpY2UuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmFjdGl2ZWxvZycsIHtcbiAgICAgICAgICAgIHVybDogJy9hY3RpdmVsb2cnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05vZGVBY3RpdmVKb2JMb2dzQ3RybCBhcyBub2RlQWN0aXZlSm9iTG9nc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8Y3R2LWxvZ3MgdGl0bGU9XCJBY3RpdmUgSm9iXCIgbG9nPVwibm9kZUFjdGl2ZUpvYkxvZ3NDdHJsLmFjdGl2ZUxvZ3NcIj48L2N0di1sb2dzPidcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVBY3RpdmVKb2JMb2dzQ3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICdMb2dTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsIExvZ1NlcnZpY2UpIHtcbiAgICAgICAgdmFyIG5vZGVBY3RpdmVKb2JMb2dzQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUxvZ3MoKSB7XG4gICAgICAgICAgICBMb2dTZXJ2aWNlLmdldEFjdGl2ZUxvZ3MoKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBub2RlQWN0aXZlSm9iTG9nc0N0cmwuYWN0aXZlTG9ncyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy9PbmNlIHRoZSBqb2IgZmluaXNoZXMsIGVuZHBvaW50IHJldHVybnMgNTAwIGVycm9yLiBTbyByZXNldCB0aGUgYWN0aXZlTG9nc1xuICAgICAgICAgICAgICAgIG5vZGVBY3RpdmVKb2JMb2dzQ3RybC5hY3RpdmVMb2dzID0ge1xuICAgICAgICAgICAgICAgICAgICBkZXNjOiAnVGhlcmUgaXMgY3VycmVudGx5IG5vIGFjdGl2ZSBqb2IuIENoZWNrIExhc3QgSm9iIGZvciBhIGpvYiB0aGF0IHJlY2VudGx5IGZpbmlzaGVkLidcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZ2V0QWN0aXZlTG9ncygpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0QWN0aXZlTG9ncygpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bm9kZWFjdGl2ZWpvYmxvZ3NjdHJsLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gMy8yNS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmNvbW1pc3Npb24nLCB7XG4gICAgICAgICAgICB1cmw6ICcvY29tbWlzc2lvbi86a2V5JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlQ29tbWlzc2lvbkN0cmwgYXMgbm9kZUNvbW1pc3Npb25DdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWNvbW1pc3Npb24uaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVDb21taXNzaW9uQ3RybCcsIFtcbiAgICAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdOb2Rlc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJywgJ05vZGVzU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBOb2Rlc01vZGVsLCBDUlVESGVscGVyU2VydmljZSwgTm9kZXNTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBub2RlQ29tbWlzc2lvbkN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub05vZGVEZXRhaWxzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLmluZm8nLCB7ICdrZXknOiAkc3RhdGVQYXJhbXMua2V5IH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbENvbW1pc3Npb25pbmdOb2RlKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9Ob2RlRGV0YWlscygpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNvbW1pc3Npb24oKSB7XG4gICAgICAgICAgICBpZiAobm9kZUNvbW1pc3Npb25DdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIobm9kZUNvbW1pc3Npb25DdHJsKTtcbiAgICAgICAgICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwubm9kZU9wc09iai5ub2RlcyA9IFskc3RhdGVQYXJhbXMua2V5XTtcbiAgICAgICAgICAgICAgICBOb2Rlc1NlcnZpY2UuY2xlYW51cEV4dHJhVmFycyhub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgICAgICAgICAgICAgIE5vZGVzU2VydmljZS5jcmVhdGVFeHRyYVZhcnMobm9kZUNvbW1pc3Npb25DdHJsKTtcbiAgICAgICAgICAgICAgICBOb2Rlc01vZGVsLmNvbW1pc3Npb24obm9kZUNvbW1pc3Npb25DdHJsLm5vZGVPcHNPYmopLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvTm9kZURldGFpbHMoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihub2RlQ29tbWlzc2lvbkN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLm5vZGVPcHNPYmogPSB7fTtcbiAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLmV4dHJhX3ZhcnMgPSB7fTsgLy9UT0RPIEludGlhbGl6ZSBmcm9tIGdsb2JhbCBzZXR0aW5nc1xuICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuYW5zaWJsZVZhcmlhYmxlcyA9IFtdO1xuICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuZW52VmFyaWFibGVzID0gW107XG4gICAgICAgIE5vZGVzU2VydmljZS5nZXRTZXR0aW5ncyhub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgICAgICBub2RlQ29tbWlzc2lvbkN0cmwuY2FuY2VsQ29tbWlzc2lvbmluZ05vZGUgPSBjYW5jZWxDb21taXNzaW9uaW5nTm9kZTtcbiAgICAgICAgbm9kZUNvbW1pc3Npb25DdHJsLmNvbW1pc3Npb24gPSBjb21taXNzaW9uO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVDb21taXNzaW9uQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihub2RlQ29tbWlzc2lvbkN0cmwpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVjb21taXNzaW9uY3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDMvMjUvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYubm9kZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZURldGFpbHNDdHJsIGFzIG5vZGVEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVkZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMuaW5mbycsIHtcbiAgICAgICAgICAgIHVybDogJy9pbmZvJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGV0YWlsc0N0cmwgYXMgbm9kZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWluZm8uaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMuZGV0YWlscy5zdGF0cycsIHtcbiAgICAgICAgICAgIHVybDogJy9zdGF0cycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZURldGFpbHNDdHJsIGFzIG5vZGVEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVzdGF0cy5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5ub2Rlcy5kZXRhaWxzLmxvZ3MnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbG9ncycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTm9kZURldGFpbHNDdHJsIGFzIG5vZGVEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVsb2dzLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRldGFpbHMuZWRpdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9lZGl0JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGV0YWlsc0N0cmwgYXMgbm9kZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWluZm8uaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVEZXRhaWxzQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICckc2NvcGUnLCAnJGludGVydmFsJywgJ05vZGVzTW9kZWwnLCAnQmdwU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCAkc2NvcGUsICRpbnRlcnZhbCwgTm9kZXNNb2RlbCwgQmdwU2VydmljZSkge1xuICAgICAgICB2YXIgbm9kZURldGFpbHNDdHJsID0gdGhpcztcbiAgICAgICAgbm9kZURldGFpbHNDdHJsLm51bWJlcnBhdHRlcm4gPSBDb250aXZHbG9iYWxzLk5VTUJFUl9SRUdFWDtcbiAgICAgICAgZnVuY3Rpb24gZGVjb21taXNzaW9uKCkge1xuICAgICAgICAgICAgdmFyIG5vZGVPcHNPYmogPSB7XG4gICAgICAgICAgICAgICAgbm9kZXM6IFskc3RhdGVQYXJhbXMua2V5XVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIE5vZGVzTW9kZWwuZGVjb21taXNzaW9uKG5vZGVPcHNPYmopLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vRGlzYWJsZSBhbGwgYnV0dG9ucyBpbml0aWFsbHkuIFBvbGwgd2lsbCBhc3NpZ24gdmFsdWVzIGFwcHJvcHJpYXRlbHkuXG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiB1cGdyYWRlKCkge1xuICAgICAgICAgICAgdmFyIG5vZGVPcHNPYmogPSB7XG4gICAgICAgICAgICAgICAgbm9kZXM6IFskc3RhdGVQYXJhbXMua2V5XVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIE5vZGVzTW9kZWwudXBncmFkZShub2RlT3BzT2JqKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAvL0Rpc2FibGUgYWxsIGJ1dHRvbnMgaW5pdGlhbGx5LiBQb2xsIHdpbGwgYXNzaWduIHZhbHVlcyBhcHByb3ByaWF0ZWx5LlxuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERpc3BsYXkgYnV0dG9ucyBiYXNlZCBvbiBzdGF0dXMgb2Ygbm9kZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gc2V0QnV0dG9uRGlzcGxheSgpIHtcbiAgICAgICAgICAgIHN3aXRjaCAobm9kZURldGFpbHNDdHJsLm5vZGVbJ2ludmVudG9yeV9zdGF0ZSddLnN0YXR1cykge1xuICAgICAgICAgICAgICAgIGNhc2UgJ1VuYWxsb2NhdGVkJzpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0RlY29tbWlzc2lvbmVkJzpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ1Byb3Zpc2lvbmluZyc6XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZUJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnQWxsb2NhdGVkJzpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5jb21taXNzaW9uQnV0dG9uRW5hYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0NhbmNlbGxlZCc6XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zaG93Q29tbWlzc2lvbkJ1dHRvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ01haW50ZW5hbmNlJzpcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnNob3dDb21taXNzaW9uQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLmNvbW1pc3Npb25CdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC51cGdyYWRlQnV0dG9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuc2hvd0NvbW1pc3Npb25CdXR0b24gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuY29tbWlzc2lvbkJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZ3JhZGVCdXR0b25FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdldE5vZGVJbmZvKHJlbG9hZCkge1xuICAgICAgICAgICAgTm9kZXNNb2RlbC5nZXRNb2RlbEJ5S2V5KCRzdGF0ZVBhcmFtcy5rZXksIHJlbG9hZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5ub2RlID0gbm9kZTtcbiAgICAgICAgICAgICAgICBzZXRCdXR0b25EaXNwbGF5KCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBzZXRNb2RlKCkge1xuICAgICAgICAgICAgaWYgKCRzdGF0ZS5pcygnY29udGl2Lm1lbnUubm9kZXMuZGV0YWlscy5lZGl0JykpIHtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubW9kZSA9ICdlZGl0JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5tb2RlID0gJ2RldGFpbHMnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvSW5mbygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUubm9kZXMuZGV0YWlscy5pbmZvJyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlQmdwSW5mbygpIHtcbiAgICAgICAgICAgIGlmIChub2RlRGV0YWlsc0N0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3Iua2V5ID0gJHN0YXRlUGFyYW1zLmtleTtcbiAgICAgICAgICAgICAgICAvLyBiYWNrZW5kIG9ubHkgc3VwcG9ydHMgYWRkaW5nIG9uZSBuZWlnaGJvciBjdXJyZW50bHlcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3JzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURldGFpbHNDdHJsLm5laWdoYm9yWyduZWlnaGJvciddID0gaXRlbS5uYW1lO1xuICAgICAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3JbJ25laWdoYm9yLWFzJ10gPSBpdGVtLnZhbHVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIEJncFNlcnZpY2UudXBkYXRlQmdwKG5vZGVEZXRhaWxzQ3RybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvciA9IHJlc3VsdC5jb25maWcuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVG9JbmZvKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnZXRCZ3BJbmZvKCkge1xuICAgICAgICAgICAgQmdwU2VydmljZS5nZXRCZ3Aobm9kZURldGFpbHNDdHJsKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3IgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0QmdwSW5zcGVjdCgpIHtcbiAgICAgICAgICAgIEJncFNlcnZpY2UuZ2V0QmdwSW5zcGVjdCgkc3RhdGVQYXJhbXMua2V5KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwuaW5zcGVjdCA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICBub2RlRGV0YWlsc0N0cmwucm91dGVzID0gcmVzdWx0Lk9wZXIucm91dGVzO1xuICAgICAgICAgICAgICAgIG5vZGVEZXRhaWxzQ3RybC5maWx0ZXJlZHJvdXRlcyA9IHJlc3VsdC5PcGVyLnJvdXRlcztcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBub2RlRGV0YWlsc0N0cmwuZGVjb21taXNzaW9uID0gZGVjb21taXNzaW9uO1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwudXBncmFkZSA9IHVwZ3JhZGU7XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC5zZXRNb2RlID0gc2V0TW9kZTtcbiAgICAgICAgbm9kZURldGFpbHNDdHJsLnVwZGF0ZUJncEluZm8gPSB1cGRhdGVCZ3BJbmZvO1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwucmV0dXJuVG9JbmZvID0gcmV0dXJuVG9JbmZvO1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwubmVpZ2hib3JzID0gW107XG4gICAgICAgIG5vZGVEZXRhaWxzQ3RybC5uZWlnaGJvciA9IHt9O1xuICAgICAgICBub2RlRGV0YWlsc0N0cmwua2V5ID0gJHN0YXRlUGFyYW1zLmtleTtcbiAgICAgICAgZ2V0QmdwSW5mbygpO1xuICAgICAgICBnZXRCZ3BJbnNwZWN0KCk7XG4gICAgICAgIHNldE1vZGUoKTtcbiAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgIGdldE5vZGVJbmZvKGZhbHNlKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldE5vZGVJbmZvKHRydWUpO1xuICAgICAgICAgICAgfSwgNTAwMCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVkZXRhaWxzY3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDYvMTQvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2Lm5vZGVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dk5vZGVzdGF0dXNcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBub2RlOiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2Rlc3RhdHVzLmh0bWwnXG4gICAgfTtcbn0pXG4gICAgLmRpcmVjdGl2ZShcImN0dk5vZGVzdGF0ZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIG5vZGU6ICc9J1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ25vZGVzL25vZGVzdGF0ZS5odG1sJ1xuICAgIH07XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVkaXJlY3RpdmUuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5ub2RlcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm5vZGVzLmRpc2NvdmVyJywge1xuICAgICAgICAgICAgdXJsOiAnL2Rpc2NvdmVyJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlRGlzY292ZXJDdHJsIGFzIG5vZGVEaXNjb3ZlckN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdub2Rlcy9ub2RlZGlzY292ZXIuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVEaXNjb3ZlckN0cmwnLCBbXG4gICAgJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnTm9kZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsICdOb2Rlc1NlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgTm9kZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UsIE5vZGVzU2VydmljZSkge1xuICAgICAgICB2YXIgbm9kZURpc2NvdmVyQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvTm9kZXMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm5vZGVzLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjYW5jZWxEaXNjb3ZlcmluZ05vZGUoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub05vZGVzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZGlzY292ZXIoKSB7XG4gICAgICAgICAgICBpZiAobm9kZURpc2NvdmVyQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihub2RlRGlzY292ZXJDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihub2RlRGlzY292ZXJDdHJsKTtcbiAgICAgICAgICAgICAgICBjcmVhdGVJUEFkZHJBcnJheSgpO1xuICAgICAgICAgICAgICAgIE5vZGVzU2VydmljZS5jcmVhdGVFeHRyYVZhcnMobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgICAgICAgICAgICAgTm9kZXNNb2RlbC5kaXNjb3Zlcihub2RlRGlzY292ZXJDdHJsLm5vZGVPcHNPYmopLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub05vZGVzKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihub2RlRGlzY292ZXJDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKG5vZGVEaXNjb3ZlckN0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlSVBBZGRyQXJyYXkoKSB7XG4gICAgICAgICAgICBub2RlRGlzY292ZXJDdHJsLm5vZGVPcHNPYmouYWRkcnMgPSBfLndvcmRzKG5vZGVEaXNjb3ZlckN0cmwubm9kZUlQQWRkciwgL1teLCBdKy9nKTtcbiAgICAgICAgfVxuICAgICAgICBub2RlRGlzY292ZXJDdHJsLm5vZGVPcHNPYmogPSB7fTtcbiAgICAgICAgbm9kZURpc2NvdmVyQ3RybC5leHRyYV92YXJzID0ge307IC8vVE9ETyBJbnRpYWxpemUgZnJvbSBnbG9iYWwgc2V0dGluZ3NcbiAgICAgICAgbm9kZURpc2NvdmVyQ3RybC5hbnNpYmxlVmFyaWFibGVzID0gW107XG4gICAgICAgIG5vZGVEaXNjb3ZlckN0cmwuZW52VmFyaWFibGVzID0gW107XG4gICAgICAgIG5vZGVEaXNjb3ZlckN0cmwubm9kZUlQQWRkciA9ICcnOyAvL0lQIGFkZHJlc3Mgb2Ygbm9kZXMgdG8gZGlzY292ZXJcbiAgICAgICAgTm9kZXNTZXJ2aWNlLmdldFNldHRpbmdzKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICBub2RlRGlzY292ZXJDdHJsLmRpc2NvdmVyID0gZGlzY292ZXI7XG4gICAgICAgIG5vZGVEaXNjb3ZlckN0cmwuY2FuY2VsRGlzY292ZXJpbmdOb2RlID0gY2FuY2VsRGlzY292ZXJpbmdOb2RlO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVEaXNjb3ZlckN0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iobm9kZURpc2NvdmVyQ3RybCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bm9kZWRpc2NvdmVyY3RybC5qcy5tYXAiLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMubGFzdGxvZycsIHtcbiAgICAgICAgICAgIHVybDogJy9sYXN0bG9nJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlTGFzdEpvYkxvZ3NDdHJsIGFzIG5vZGVMYXN0Sm9iTG9nc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8Y3R2LWxvZ3MgdGl0bGU9XCJMYXN0IEpvYlwiIGxvZz1cIm5vZGVMYXN0Sm9iTG9nc0N0cmwubGFzdExvZ3NcIj48L2N0di1sb2dzPidcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVMYXN0Sm9iTG9nc0N0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnTG9nU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzY29wZSwgJGludGVydmFsLCBMb2dTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBub2RlTGFzdEpvYkxvZ3NDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gZ2V0TGFzdExvZ3MoKSB7XG4gICAgICAgICAgICBMb2dTZXJ2aWNlLmdldExhc3RMb2dzKCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgbm9kZUxhc3RKb2JMb2dzQ3RybC5sYXN0TG9ncyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBnZXRMYXN0TG9ncygpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0TGFzdExvZ3MoKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vZGVsYXN0am9ibG9nc2N0cmwuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzIyLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2Lm5vZGVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUubm9kZXMubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb2RlTGlzdEN0cmwgYXMgbm9kZUxpc3RDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbm9kZXMvbm9kZWxpc3QuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05vZGVMaXN0Q3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ05vZGVzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgTm9kZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIG5vZGVMaXN0Q3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGdldE5vZGVzKHJlbG9hZCkge1xuICAgICAgICAgICAgTm9kZXNNb2RlbC5nZXQocmVsb2FkKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgbm9kZUxpc3RDdHJsLm5vZGVzID0gcmVzdWx0O1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG5vZGVMaXN0Q3RybCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgZ2V0Tm9kZXMoZmFsc2UpO1xuICAgICAgICB2YXIgcHJvbWlzZTtcbiAgICAgICAgLy9Eb24ndCBkbyBhdXRvLXJlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0Tm9kZXModHJ1ZSk7XG4gICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1ub2RlbGlzdGN0cmwuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5vcmdhbml6YXRpb25zJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5jcmVhdGUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnb3JnYW5pemF0aW9ucy9vcmdhbml6YXRpb25jcmVhdGUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnT3JnYW5pemF0aW9uQ3JlYXRlQ3RybCBhcyBvcmdhbml6YXRpb25DcmVhdGVDdHJsJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignT3JnYW5pemF0aW9uQ3JlYXRlQ3RybCcsIFsnJHN0YXRlJywgJ09yZ2FuaXphdGlvbnNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgT3JnYW5pemF0aW9uc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvT3JnYW5pemF0aW9ucygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUub3JnYW5pemF0aW9ucy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub09yZ2FuaXphdGlvbnMoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVPcmdhbml6YXRpb24oKSB7XG4gICAgICAgICAgICAvL2Zvcm0gY29udHJvbGxlciBpcyBpbmplY3RlZCBieSB0aGUgaHRtbCB0ZW1wbGF0ZVxuICAgICAgICAgICAgLy9jaGVja2luZyBpZiBhbGwgdmFsaWRhdGlvbnMgaGF2ZSBwYXNzZWRcbiAgICAgICAgICAgIGlmIChvcmdhbml6YXRpb25DcmVhdGVDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwubmV3T3JnYW5pemF0aW9uLmtleSA9IG9yZ2FuaXphdGlvbkNyZWF0ZUN0cmwubmV3T3JnYW5pemF0aW9uLnRlbmFudE5hbWU7XG4gICAgICAgICAgICAgICAgT3JnYW5pemF0aW9uc01vZGVsLmNyZWF0ZShvcmdhbml6YXRpb25DcmVhdGVDdHJsLm5ld09yZ2FuaXphdGlvbikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvT3JnYW5pemF0aW9ucygpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25DcmVhdGVDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJlc2V0Rm9ybSgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iob3JnYW5pemF0aW9uQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBvcmdhbml6YXRpb25DcmVhdGVDdHJsLm5ld09yZ2FuaXphdGlvbiA9IHtcbiAgICAgICAgICAgICAgICB0ZW5hbnROYW1lOiAnJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBvcmdhbml6YXRpb25DcmVhdGVDdHJsLmNyZWF0ZU9yZ2FuaXphdGlvbiA9IGNyZWF0ZU9yZ2FuaXphdGlvbjtcbiAgICAgICAgb3JnYW5pemF0aW9uQ3JlYXRlQ3RybC5jYW5jZWxDcmVhdGluZyA9IGNhbmNlbENyZWF0aW5nO1xuICAgICAgICByZXNldEZvcm0oKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1vcmdhbml6YXRpb25jcmVhdGVjdHJsLmpzLm1hcCIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYub3JnYW5pemF0aW9ucycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ09yZ2FuaXphdGlvbkRldGFpbHNDdHJsIGFzIG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnb3JnYW5pemF0aW9ucy9vcmdhbml6YXRpb25kZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdPcmdhbml6YXRpb25EZXRhaWxzQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdPcmdhbml6YXRpb25zTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgT3JnYW5pemF0aW9uc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgb3JnYW5pemF0aW9uRGV0YWlsc0N0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub09yZ2FuaXphdGlvbnMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMubGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGRlbGV0ZU9yZ2FuaXphdGlvbigpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBPcmdhbml6YXRpb25zTW9kZWwuZGVsZXRlKG9yZ2FuaXphdGlvbkRldGFpbHNDdHJsLm9yZ2FuaXphdGlvbikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9Pcmdhbml6YXRpb25zKCk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihvcmdhbml6YXRpb25EZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iob3JnYW5pemF0aW9uRGV0YWlsc0N0cmwpO1xuICAgICAgICBPcmdhbml6YXRpb25zTW9kZWwuZ2V0TW9kZWxCeUtleSgkc3RhdGVQYXJhbXMua2V5KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKG9yZ2FuaXphdGlvbikge1xuICAgICAgICAgICAgb3JnYW5pemF0aW9uRGV0YWlsc0N0cmwub3JnYW5pemF0aW9uID0gb3JnYW5pemF0aW9uO1xuICAgICAgICB9KTtcbiAgICAgICAgb3JnYW5pemF0aW9uRGV0YWlsc0N0cmwuZGVsZXRlT3JnYW5pemF0aW9uID0gZGVsZXRlT3JnYW5pemF0aW9uO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW9yZ2FuaXphdGlvbmRldGFpbHNjdHJsLmpzLm1hcCIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYub3JnYW5pemF0aW9ucycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51Lm9yZ2FuaXphdGlvbnMubGlzdCcsIHtcbiAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdPcmdhbml6YXRpb25zTGlzdEN0cmwgYXMgb3JnYW5pemF0aW9uc0xpc3RDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnb3JnYW5pemF0aW9ucy9vcmdhbml6YXRpb25saXN0Lmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdPcmdhbml6YXRpb25zTGlzdEN0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdPcmdhbml6YXRpb25zTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc2NvcGUsICRpbnRlcnZhbCwgJGZpbHRlciwgT3JnYW5pemF0aW9uc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgb3JnYW5pemF0aW9uc0xpc3RDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gZ2V0T3JnYW5pemF0aW9ucyhyZWxvYWQpIHtcbiAgICAgICAgICAgIE9yZ2FuaXphdGlvbnNNb2RlbC5nZXQocmVsb2FkKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKG9yZ2FuaXphdGlvbnNMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgb3JnYW5pemF0aW9uc0xpc3RDdHJsLm9yZ2FuaXphdGlvbnMgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIob3JnYW5pemF0aW9uc0xpc3RDdHJsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vTG9hZCBmcm9tIGNhY2hlIGZvciBxdWljayBkaXNwbGF5IGluaXRpYWxseVxuICAgICAgICBnZXRPcmdhbml6YXRpb25zKGZhbHNlKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0b3JlZnJlc2ggaWYgb25lIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3NcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChwcm9taXNlKSkge1xuICAgICAgICAgICAgcHJvbWlzZSA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0T3JnYW5pemF0aW9ucyh0cnVlKTtcbiAgICAgICAgICAgIH0sIENvbnRpdkdsb2JhbHMuUkVGUkVTSF9JTlRFUlZBTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zdG9wIHBvbGxpbmcgd2hlbiB1c2VyIG1vdmVzIGF3YXkgZnJvbSB0aGUgcGFnZVxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW9yZ2FuaXphdGlvbmxpc3RjdHJsLmpzLm1hcCIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYuc2V0dGluZ3MnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLmNsdXN0ZXInLCB7XG4gICAgICAgICAgICB1cmw6ICcvY2x1c3RlcicsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQ2x1c3RlclNldHRpbmdDdHJsIGFzIGNsdXN0ZXJTZXR0aW5nQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NldHRpbmdzL2NsdXN0ZXJzZXR0aW5ncy5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignQ2x1c3RlclNldHRpbmdDdHJsJywgWyckc3RhdGVQYXJhbXMnLCAnQ1JVREhlbHBlclNlcnZpY2UnLCAnTm9kZXNTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlUGFyYW1zLCBDUlVESGVscGVyU2VydmljZSwgTm9kZXNTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBjbHVzdGVyU2V0dGluZ0N0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiB1cGRhdGVDbHVzdGVyU2V0dGluZ3MoKSB7XG4gICAgICAgICAgICBpZiAoY2x1c3RlclNldHRpbmdDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKGNsdXN0ZXJTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoY2x1c3RlclNldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICBjbHVzdGVyU2V0dGluZ0N0cmwubm9kZU9wc09iai5ub2RlcyA9IFskc3RhdGVQYXJhbXMua2V5XTtcbiAgICAgICAgICAgICAgICBOb2Rlc1NlcnZpY2UuY2xlYW51cEV4dHJhVmFycyhjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgIE5vZGVzU2VydmljZS5jcmVhdGVFeHRyYVZhcnMoY2x1c3RlclNldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICBOb2Rlc1NlcnZpY2UudXBkYXRlU2V0dGluZ3MoY2x1c3RlclNldHRpbmdDdHJsLm5vZGVPcHNPYmopLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKGNsdXN0ZXJTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3IoY2x1c3RlclNldHRpbmdDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNsdXN0ZXJTZXR0aW5nQ3RybC5ub2RlT3BzT2JqID0ge307XG4gICAgICAgIGNsdXN0ZXJTZXR0aW5nQ3RybC5leHRyYV92YXJzID0ge307IC8vVE9ETyBJbnRpYWxpemUgZnJvbSBnbG9iYWwgc2V0dGluZ3NcbiAgICAgICAgY2x1c3RlclNldHRpbmdDdHJsLmFuc2libGVWYXJpYWJsZXMgPSBbXTtcbiAgICAgICAgY2x1c3RlclNldHRpbmdDdHJsLmVudlZhcmlhYmxlcyA9IFtdO1xuICAgICAgICBOb2Rlc1NlcnZpY2UuZ2V0U2V0dGluZ3MoY2x1c3RlclNldHRpbmdDdHJsKTtcbiAgICAgICAgY2x1c3RlclNldHRpbmdDdHJsLnVwZGF0ZUNsdXN0ZXJTZXR0aW5ncyA9IHVwZGF0ZUNsdXN0ZXJTZXR0aW5ncztcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihjbHVzdGVyU2V0dGluZ0N0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IoY2x1c3RlclNldHRpbmdDdHJsKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jbHVzdGVyc2V0dGluZ2N0cmwuanMubWFwIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zZXR0aW5ncycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNldHRpbmdzLmRldGFpbHMubmV0d29ya3MnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbmV0d29ya3MnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05ldHdvcmtTZXR0aW5nQ3RybCBhcyBuZXR3b3JrU2V0dGluZ0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXR0aW5ncy9uZXR3b3Jrc2V0dGluZ3MuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ05ldHdvcmtTZXR0aW5nQ3RybCcsIFsnQ1JVREhlbHBlclNlcnZpY2UnLCAnTmV0d29ya1NlcnZpY2UnLFxuICAgIGZ1bmN0aW9uIChDUlVESGVscGVyU2VydmljZSwgTmV0d29ya1NlcnZpY2UpIHtcbiAgICAgICAgdmFyIG5ldHdvcmtTZXR0aW5nQ3RybCA9IHRoaXM7XG4gICAgICAgIG5ldHdvcmtTZXR0aW5nQ3RybC52bGFuUGF0dGVybiA9IENvbnRpdkdsb2JhbHMuVkxBTl9SRUdFWDtcbiAgICAgICAgbmV0d29ya1NldHRpbmdDdHJsLnZ4bGFuUGF0dGVybiA9IENvbnRpdkdsb2JhbHMuVlhMQU5fUkVHRVg7XG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZU5ldHdvcmtTZXR0aW5ncygpIHtcbiAgICAgICAgICAgIGlmIChuZXR3b3JrU2V0dGluZ0N0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3IobmV0d29ya1NldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihuZXR3b3JrU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgIE5ldHdvcmtTZXJ2aWNlLnVwZGF0ZVNldHRpbmdzKG5ldHdvcmtTZXR0aW5nQ3RybC5zZXR0aW5nKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihuZXR3b3JrU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobmV0d29ya1NldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc2hvd1NlcnZlckVycm9yKG5ldHdvcmtTZXR0aW5nQ3RybCwgcmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdldE5ldHdvcmtTZXR0aW5ncygpIHtcbiAgICAgICAgICAgIE5ldHdvcmtTZXJ2aWNlLmdldFNldHRpbmdzKCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgbmV0d29ya1NldHRpbmdDdHJsLnNldHRpbmcgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZ2V0TmV0d29ya1NldHRpbmdzKCk7XG4gICAgICAgIG5ldHdvcmtTZXR0aW5nQ3RybC51cGRhdGVOZXR3b3JrU2V0dGluZ3MgPSB1cGRhdGVOZXR3b3JrU2V0dGluZ3M7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIobmV0d29ya1NldHRpbmdDdHJsKTtcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKG5ldHdvcmtTZXR0aW5nQ3RybCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bmV0d29ya3NldHRpbmdjdHJsLmpzLm1hcCIsImFuZ3VsYXIubW9kdWxlKCdjb250aXYuc2V0dGluZ3MnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXR0aW5ncy5kZXRhaWxzLnZvbHVtZXMnLCB7XG4gICAgICAgICAgICB1cmw6ICcvdm9sdW1lcycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVm9sdW1lU2V0dGluZ0N0cmwgYXMgdm9sdW1lU2V0dGluZ0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXR0aW5ncy92b2x1bWVzZXR0aW5ncy5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignVm9sdW1lU2V0dGluZ0N0cmwnLCBbJ0NSVURIZWxwZXJTZXJ2aWNlJywgJ1ZvbHVtZVNldHRpbmdTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoQ1JVREhlbHBlclNlcnZpY2UsIFZvbHVtZVNldHRpbmdTZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2b2x1bWVTZXR0aW5nQ3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZVZvbHVtZVNldHRpbmdzKCkge1xuICAgICAgICAgICAgaWYgKHZvbHVtZVNldHRpbmdDdHJsLmZvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHZvbHVtZVNldHRpbmdDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcih2b2x1bWVTZXR0aW5nQ3RybCk7XG4gICAgICAgICAgICAgICAgVm9sdW1lU2V0dGluZ1NlcnZpY2UudXBkYXRlU2V0dGluZ3Modm9sdW1lU2V0dGluZ0N0cmwuc2V0dGluZykudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lU2V0dGluZ0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Iodm9sdW1lU2V0dGluZ0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0Vm9sdW1lU2V0dGluZ3MoKSB7XG4gICAgICAgICAgICBWb2x1bWVTZXR0aW5nU2VydmljZS5nZXRTZXR0aW5ncygpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHZvbHVtZVNldHRpbmdDdHJsLnNldHRpbmcgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZ2V0Vm9sdW1lU2V0dGluZ3MoKTtcbiAgICAgICAgdm9sdW1lU2V0dGluZ0N0cmwudXBkYXRlVm9sdW1lU2V0dGluZ3MgPSB1cGRhdGVWb2x1bWVTZXR0aW5ncztcbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVTZXR0aW5nQ3RybCk7XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcih2b2x1bWVTZXR0aW5nQ3RybCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dm9sdW1lc2V0dGluZ2N0cmwuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzEyLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnNlcnZpY2VsYnMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXJ2aWNlX2xicy9zZXJ2aWNlbGJjcmVhdGUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU2VydmljZWxiQ3JlYXRlQ3RybCBhcyBzZXJ2aWNlbGJDcmVhdGVDdHJsJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignU2VydmljZWxiQ3JlYXRlQ3RybCcsIFtcbiAgICAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdTZXJ2aWNlbGJzTW9kZWwnLCAnTmV0d29ya3NNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBTZXJ2aWNlbGJzTW9kZWwsIE5ldHdvcmtzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlbGJDcmVhdGVDdHJsID0gdGhpcztcbiAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5sYWJlbFNlbGVjdG9ycyA9IFtdO1xuICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLm5ldHdvcmtzID0gW107XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvU2VydmljZWxicygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuc2VydmljZWxicy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub1NlcnZpY2VsYnMoKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IG5ldHdvcmtzIGZvciB0aGUgZ2l2ZW4gdGVuYW50LlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gZ2V0TmV0d29ya3MoKSB7XG4gICAgICAgICAgICBOZXR3b3Jrc01vZGVsLmdldCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHNlcnZpY2VsYkNyZWF0ZUN0cmwubmV0d29ya3MgPSBfLmZpbHRlcihyZXN1bHQsIHtcbiAgICAgICAgICAgICAgICAgICAgJ3RlbmFudE5hbWUnOiAnZGVmYXVsdCcgLy9UT0RPOiBSZW1vdmUgaGFyZGNvZGVkIHRlbmFudC5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUxhYmVsU2VsZWN0b3JTdHJpbmdzKCkge1xuICAgICAgICAgICAgLy9FbXB0eSBvdXQgdGhlIHNlbGVjdG9ycy4gSW4gY2FzZSBvZiBzZXJ2ZXIgZXJyb3JzIHRoaXMgbmVlZHMgdG8gYmUgcmVzZXQuXG4gICAgICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLnNlcnZpY2VsYi5zZWxlY3RvcnMgPSBbXTtcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChzZXJ2aWNlbGJDcmVhdGVDdHJsLmxhYmVsU2VsZWN0b3JzLCBmdW5jdGlvbiAobGFiZWxTZWxlY3Rvcikge1xuICAgICAgICAgICAgICAgIHZhciBzZWxlY3RvclN0cmluZyA9IGxhYmVsU2VsZWN0b3IubmFtZSArICc9JyArIGxhYmVsU2VsZWN0b3IudmFsdWU7XG4gICAgICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIuc2VsZWN0b3JzLnB1c2goc2VsZWN0b3JTdHJpbmcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlU2VydmljZWxiKCkge1xuICAgICAgICAgICAgY3JlYXRlTGFiZWxTZWxlY3RvclN0cmluZ3MoKTtcbiAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgaWYgKHNlcnZpY2VsYkNyZWF0ZUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc2VydmljZWxiQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoc2VydmljZWxiQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIua2V5ID1cbiAgICAgICAgICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIudGVuYW50TmFtZSArICc6JyArIHNlcnZpY2VsYkNyZWF0ZUN0cmwuc2VydmljZWxiLnNlcnZpY2VOYW1lO1xuICAgICAgICAgICAgICAgIFNlcnZpY2VsYnNNb2RlbC5jcmVhdGUoc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1NlcnZpY2VsYnMoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Ioc2VydmljZWxiQ3JlYXRlQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXNldEZvcm0oKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2UuaGlkZVNlcnZlckVycm9yKHNlcnZpY2VsYkNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5zZXJ2aWNlbGIgPSB7XG4gICAgICAgICAgICAgICAgc2VydmljZU5hbWU6ICcnLFxuICAgICAgICAgICAgICAgIG5ldHdvcmtOYW1lOiAnJyxcbiAgICAgICAgICAgICAgICBpcEFkZHJlc3M6ICcnLFxuICAgICAgICAgICAgICAgIHNlbGVjdG9yczogW10sXG4gICAgICAgICAgICAgICAgcG9ydHM6IFtdLFxuICAgICAgICAgICAgICAgIHRlbmFudE5hbWU6ICdkZWZhdWx0JyAvL1RPRE86IFJlbW92ZSBoYXJkY29kZWQgdGVuYW50LlxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBzZXJ2aWNlbGJDcmVhdGVDdHJsLmNyZWF0ZVNlcnZpY2VsYiA9IGNyZWF0ZVNlcnZpY2VsYjtcbiAgICAgICAgc2VydmljZWxiQ3JlYXRlQ3RybC5jYW5jZWxDcmVhdGluZyA9IGNhbmNlbENyZWF0aW5nO1xuICAgICAgICBnZXROZXR3b3JrcygpO1xuICAgICAgICByZXNldEZvcm0oKTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zZXJ2aWNlbGJjcmVhdGVjdHJsLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8xMS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zZXJ2aWNlbGJzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2VydmljZWxicy5kZXRhaWxzJywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBwYXJhbXM6IHsgc3RhdGU6IG51bGwgfSxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTZXJ2aWNlbGJEZXRhaWxzQ3RybCBhcyBzZXJ2aWNlbGJEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NlcnZpY2VfbGJzL3NlcnZpY2VsYmRldGFpbHMuaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2VydmljZWxicy5kZXRhaWxzLmluZm8nLCB7XG4gICAgICAgICAgICB1cmw6ICcvaW5mbycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU2VydmljZWxiRGV0YWlsc0N0cmwgYXMgc2VydmljZWxiRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXJ2aWNlX2xicy9zZXJ2aWNlbGJpbmZvLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMuZGV0YWlscy5lZGl0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2VkaXQvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU2VydmljZWxiRGV0YWlsc0N0cmwgYXMgc2VydmljZWxiRGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXJ2aWNlX2xicy9zZXJ2aWNlbGJpbmZvLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdTZXJ2aWNlbGJEZXRhaWxzQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdTZXJ2aWNlbGJzTW9kZWwnLCAnQ1JVREhlbHBlclNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgU2VydmljZWxic01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgc2VydmljZWxiRGV0YWlsc0N0cmwgPSB0aGlzO1xuICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5sYWJlbFNlbGVjdG9ycyA9IFtdO1xuICAgICAgICAvKipcbiAgICAgICAgICogVG8gc2hvdyBlZGl0IG9yIGRldGFpbHMgc2NyZWVuIGJhc2VkIG9uIHRoZSByb3V0ZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gc2V0TW9kZSgpIHtcbiAgICAgICAgICAgIGlmICgkc3RhdGUuaXMoJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMuZGV0YWlscy5lZGl0JykpIHtcbiAgICAgICAgICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5tb2RlID0gJ2VkaXQnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwubW9kZSA9ICdkZXRhaWxzJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1NlcnZpY2VsYnMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnNlcnZpY2VsYnMubGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRvU2VydmljZWxiRGV0YWlscygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuc2VydmljZWxicy5kZXRhaWxzLmluZm8nLCB7ICdrZXknOiBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIua2V5LCAnc3RhdGUnOiAnZGV0YWlscycgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsRWRpdGluZygpIHtcbiAgICAgICAgICAgIHJldHVyblRvU2VydmljZWxiRGV0YWlscygpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGRlbGV0ZVNlcnZpY2VsYigpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBTZXJ2aWNlbGJzTW9kZWwuZGVsZXRlKHNlcnZpY2VsYkRldGFpbHNDdHJsLnNlcnZpY2VsYikudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9TZXJ2aWNlbGJzKCk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihzZXJ2aWNlbGJEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHNhdmVTZXJ2aWNlbGIoKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgdmFyIGV4aXN0aW5nTGFiZWxzID0gc2VydmljZWxiRGV0YWlsc0N0cmwuc2VydmljZWxiLnNlbGVjdG9ycztcbiAgICAgICAgICAgIGNyZWF0ZUxhYmVsU2VsZWN0b3JTdHJpbmdzKCk7XG4gICAgICAgICAgICBTZXJ2aWNlbGJzTW9kZWwuc2F2ZShzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIHJldHVyblRvU2VydmljZWxiRGV0YWlscygpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIuc2VsZWN0b3JzID0gZXhpc3RpbmdMYWJlbHM7XG4gICAgICAgICAgICAgICAgY3JlYXRlTGFiZWxTZWxlY3RvcnMoKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHNlcnZpY2VsYkRldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Ioc2VydmljZWxiRGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVMYWJlbFNlbGVjdG9ycygpIHtcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChzZXJ2aWNlbGJEZXRhaWxzQ3RybC5zZXJ2aWNlbGIuc2VsZWN0b3JzLCBmdW5jdGlvbiAoc2VsZWN0b3JTdHIpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2VsZWN0b3IgPSB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHNlbGVjdG9yU3RyLnNwbGl0KCc9JylbMF0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBzZWxlY3RvclN0ci5zcGxpdCgnPScpWzFdXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5sYWJlbFNlbGVjdG9ycy5wdXNoKHNlbGVjdG9yKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUxhYmVsU2VsZWN0b3JTdHJpbmdzKCkge1xuICAgICAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwuc2VydmljZWxiLnNlbGVjdG9ycyA9IFtdO1xuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHNlcnZpY2VsYkRldGFpbHNDdHJsLmxhYmVsU2VsZWN0b3JzLCBmdW5jdGlvbiAobGFiZWxTZWxlY3Rvcikge1xuICAgICAgICAgICAgICAgIHZhciBzZWxlY3RvclN0cmluZyA9IGxhYmVsU2VsZWN0b3IubmFtZSArICc9JyArIGxhYmVsU2VsZWN0b3IudmFsdWU7XG4gICAgICAgICAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwuc2VydmljZWxiLnNlbGVjdG9ycy5wdXNoKHNlbGVjdG9yU3RyaW5nKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIoc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc2VydmljZWxiRGV0YWlsc0N0cmwpO1xuICAgICAgICBTZXJ2aWNlbGJzTW9kZWwuZ2V0TW9kZWxCeUtleSgkc3RhdGVQYXJhbXMua2V5KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHNlcnZpY2VsYikge1xuICAgICAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwuc2VydmljZWxiID0gc2VydmljZWxiO1xuICAgICAgICAgICAgY3JlYXRlTGFiZWxTZWxlY3RvcnMoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHNlcnZpY2VsYkRldGFpbHNDdHJsLnNhdmVTZXJ2aWNlbGIgPSBzYXZlU2VydmljZWxiO1xuICAgICAgICBzZXJ2aWNlbGJEZXRhaWxzQ3RybC5jYW5jZWxFZGl0aW5nID0gY2FuY2VsRWRpdGluZztcbiAgICAgICAgc2VydmljZWxiRGV0YWlsc0N0cmwuZGVsZXRlU2VydmljZWxiID0gZGVsZXRlU2VydmljZWxiO1xuICAgICAgICBzZXRNb2RlKCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c2VydmljZWxiZGV0YWlsc2N0cmwuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzExLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnNlcnZpY2VsYnMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zZXJ2aWNlbGJzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU2VydmljZWxiTGlzdEN0cmwgYXMgc2VydmljZWxiTGlzdEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZXJ2aWNlX2xicy9zZXJ2aWNlbGJsaXN0Lmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdTZXJ2aWNlbGJMaXN0Q3RybCcsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsICckZmlsdGVyJywgJ1NlcnZpY2VsYnNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBTZXJ2aWNlbGJzTW9kZWwsIENSVURIZWxwZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlbGJMaXN0Q3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGdldFNlcnZpY2VsYnMocmVsb2FkKSB7XG4gICAgICAgICAgICBTZXJ2aWNlbGJzTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzZXJ2aWNlbGJMaXN0Q3RybCk7XG4gICAgICAgICAgICAgICAgc2VydmljZWxiTGlzdEN0cmwuc2VydmljZWxicyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzZXJ2aWNlbGJMaXN0Q3RybCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgZ2V0U2VydmljZWxicyhmYWxzZSk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG9yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldFNlcnZpY2VsYnModHJ1ZSk7XG4gICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zZXJ2aWNlbGJsaXN0Y3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDUvMTMvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LnNlcnZpY2VsYnNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2U2VydmljZWxicG9ydHNcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBpdGVtczogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSkge1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDb21wYXJlIGlmIHR3byBpdGVtcyBoYXZlIHNhbWUgcG9ydHMgYW5kIHByb3RvY29sc1xuICAgICAgICAgICAgICogQHBhcmFtIHZhbDFcbiAgICAgICAgICAgICAqIEBwYXJhbSB2YWwyXG4gICAgICAgICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gY29tcGFyZSh2YWwxLCB2YWwyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICh2YWwxID09PSB2YWwyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlc2V0TmV3SXRlbSgpIHtcbiAgICAgICAgICAgICAgICBzY29wZS5uZXdJdGVtID0ge1xuICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlUG9ydDogJycsXG4gICAgICAgICAgICAgICAgICAgIHByb3ZpZGVyUG9ydDogJycsXG4gICAgICAgICAgICAgICAgICAgIHByb3RvY29sOiAnJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmdW5jdGlvbiBpc0VtcHR5SXRlbShpdGVtKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChpdGVtLnNlcnZpY2VQb3J0ID09PSAnJyAmJiBpdGVtLnByb3ZpZGVyUG9ydCA9PT0gJycgJiYgaXRlbS5wcm90b2NvbCA9PT0gJycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2NvcGUuYWRkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChpc0VtcHR5SXRlbShzY29wZS5uZXdJdGVtKSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGlmIChzY29wZS5pdGVtcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLml0ZW1zID0gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBuZXdJdGVtU3RyID0gc2NvcGUubmV3SXRlbS5zZXJ2aWNlUG9ydCArICc6J1xuICAgICAgICAgICAgICAgICAgICArIHNjb3BlLm5ld0l0ZW0ucHJvdmlkZXJQb3J0ICsgJzonXG4gICAgICAgICAgICAgICAgICAgICsgc2NvcGUubmV3SXRlbS5wcm90b2NvbDtcbiAgICAgICAgICAgICAgICAvL1JlbW92ZXMgZXhpc3RpbmcgaXRlbSB3aXRoIHRoZSBzYW1lIHZhbHVlIGZpcnN0IGlmIGl0IGV4aXN0cy5cbiAgICAgICAgICAgICAgICBfLnB1bGxBbGxXaXRoKHNjb3BlLml0ZW1zLCBbbmV3SXRlbVN0cl0sIGNvbXBhcmUpO1xuICAgICAgICAgICAgICAgIHNjb3BlLml0ZW1zLnB1c2gobmV3SXRlbVN0cik7XG4gICAgICAgICAgICAgICAgcmVzZXROZXdJdGVtKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgc2NvcGUucmVtb3ZlID0gZnVuY3Rpb24gKHBhc3NlZEl0ZW0pIHtcbiAgICAgICAgICAgICAgICBfLnJlbW92ZShzY29wZS5pdGVtcywgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBhcmUoaXRlbSwgcGFzc2VkSXRlbSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmVzZXROZXdJdGVtKCk7XG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnc2VydmljZV9sYnMvc2VydmljZWxicG9ydHMuaHRtbCdcbiAgICB9O1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zZXJ2aWNlbGJwb3J0c2RpcmVjdGl2ZS5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgY3NoYW1wdXIgb24gNy8xNy8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zZXJ2aWNlbGJzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc2VydmljZWxicy5kZXRhaWxzLnN0YXRzJywge1xuICAgICAgICAgICAgdXJsOiAnL3N0YXRzJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTZXJ2aWNlbGJTdGF0c0N0cmwgYXMgc2VydmljZWxiU3RhdHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2VydmljZV9sYnMvc2VydmljZWxic3RhdHMuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1NlcnZpY2VsYlN0YXRzQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnU2VydmljZWxic01vZGVsJywgJ0luc3BlY3RTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBTZXJ2aWNlbGJzTW9kZWwsIEluc3BlY3RTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlbGJTdGF0c0N0cmwgPSB0aGlzO1xuICAgICAgICAvKiBHZXRzIHRoZSBOZXR3b3JrIE9wZXJhdGlvbmFsIHN0YXRlIGZyb20gdGhlIHNlcnZlciAqL1xuICAgICAgICBmdW5jdGlvbiBnZXRTZXJ2aWNlbGJJbnNwZWN0KHJlZnJlc2gpIHtcbiAgICAgICAgICAgIFNlcnZpY2VsYnNNb2RlbC5nZXRJbnNwZWN0QnlLZXkoJHN0YXRlUGFyYW1zLmtleSwgQ29udGl2R2xvYmFscy5TRVJWSUNFTEJTX0lOU1BFQ1RfRU5EUE9JTlQsIHJlZnJlc2gpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHNlcnZpY2VsYlN0YXRzQ3RybC5zZXJ2aWNlbGJJbnNwZWN0U3RhdHMgPSByZXN1bHQuT3BlcjtcbiAgICAgICAgICAgICAgICBzZXJ2aWNlbGJTdGF0c0N0cmwuY29uZmlnID0gcmVzdWx0LkNvbmZpZztcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0Lk9wZXIucHJvdmlkZXJzICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJvdmlkZXJEZXRhaWxzID0gSW5zcGVjdFNlcnZpY2UuYnVpbGRFbmRQb2ludHMocmVzdWx0Lk9wZXIucHJvdmlkZXJzKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKEluc3BlY3RTZXJ2aWNlLmNoZWNrQ29udGFpbmVyQ2hhbmdlZChzZXJ2aWNlbGJTdGF0c0N0cmwucHJvdmlkZXJEZXRhaWxzLCBwcm92aWRlckRldGFpbHMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlbGJTdGF0c0N0cmwucHJvdmlkZXJzID0gcmVzdWx0Lk9wZXIucHJvdmlkZXJzO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZWxiU3RhdHNDdHJsLnByb3ZpZGVyRGV0YWlscyA9IHByb3ZpZGVyRGV0YWlscztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc2VydmljZWxiU3RhdHNDdHJsLnByb3ZpZGVycyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlbGJTdGF0c0N0cmwucHJvdmlkZXJEZXRhaWxzID0ge307XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZ2V0U2VydmljZWxiSW5zcGVjdChmYWxzZSk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG9yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldFNlcnZpY2VsYkluc3BlY3QodHJ1ZSk7XG4gICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zZXJ2aWNlbGJzdGF0c2N0cmwuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA2LzEvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYuc3RvcmFnZXBvbGljaWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL3N0b3JhZ2Vwb2xpY3ljcmVhdGUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwgYXMgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdTdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdTdG9yYWdlUG9saWNpZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBTdG9yYWdlUG9saWNpZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9TdG9yYWdlUG9saWNpZXMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5saXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsQ3JlYXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub1N0b3JhZ2VQb2xpY2llcygpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUZpbGVzeXN0ZW1DbWRzKCkge1xuICAgICAgICAgICAgc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwuZmlsZXN5c3RlbWNtZHMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLm5ld1N0b3JhZ2VQb2xpY3kuZmlsZXN5c3RlbXNbaXRlbS5uYW1lXSA9IGl0ZW0udmFsdWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVQb2xpY3koKSB7XG4gICAgICAgICAgICAvL2Zvcm0gY29udHJvbGxlciBpcyBpbmplY3RlZCBieSB0aGUgaHRtbCB0ZW1wbGF0ZVxuICAgICAgICAgICAgLy9jaGVja2luZyBpZiBhbGwgdmFsaWRhdGlvbnMgaGF2ZSBwYXNzZWRcbiAgICAgICAgICAgIGlmIChzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIoc3RvcmFnZVBvbGljeUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgIGNyZWF0ZUZpbGVzeXN0ZW1DbWRzKCk7XG4gICAgICAgICAgICAgICAgU3RvcmFnZVBvbGljaWVzTW9kZWwuY3JlYXRlKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLm5ld1N0b3JhZ2VQb2xpY3kpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRvU3RvcmFnZVBvbGljaWVzKCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXNldEZvcm0oKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5uZXdTdG9yYWdlUG9saWN5ID0ge1xuICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgIFwiYmFja2VuZHNcIjoge1xuICAgICAgICAgICAgICAgICAgICBcImNydWRcIjogXCJjZXBoXCIsXG4gICAgICAgICAgICAgICAgICAgIFwibW91bnRcIjogXCJjZXBoXCIsXG4gICAgICAgICAgICAgICAgICAgIFwic25hcHNob3RcIjogXCJjZXBoXCJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFwidW5sb2NrZWRcIjogZmFsc2UsXG4gICAgICAgICAgICAgICAgXCJkcml2ZXJcIjoge1xuICAgICAgICAgICAgICAgICAgICBcInBvb2xcIjogXCJyYmRcIlxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXCJjcmVhdGVcIjoge1xuICAgICAgICAgICAgICAgICAgICBcInNpemVcIjogXCIwXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiZmlsZXN5c3RlbVwiOiBcIlwiXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBcInJ1bnRpbWVcIjoge1xuICAgICAgICAgICAgICAgICAgICBcInNuYXBzaG90c1wiOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBcInNuYXBzaG90XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZnJlcXVlbmN5XCI6IFwiMzBtXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImtlZXBcIjogMjBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXCJyYXRlLWxpbWl0XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwid3JpdGUtaW9wc1wiOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWFkLWlvcHNcIjogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwid3JpdGUtYnBzXCI6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJlYWQtYnBzXCI6IDBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXCJmaWxlc3lzdGVtc1wiOiB7fVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBzdG9yYWdlUG9saWN5Q3JlYXRlQ3RybC5jcmVhdGVQb2xpY3kgPSBjcmVhdGVQb2xpY3k7XG4gICAgICAgIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLmNhbmNlbENyZWF0aW5nID0gY2FuY2VsQ3JlYXRpbmc7XG4gICAgICAgIHN0b3JhZ2VQb2xpY3lDcmVhdGVDdHJsLmZpbGVzeXN0ZW1jbWRzID0gW107XG4gICAgICAgIHJlc2V0Rm9ybSgpO1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXN0b3JhZ2Vwb2xpY3ljcmVhdGVjdHJsLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS8yNy8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi5zdG9yYWdlcG9saWNpZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS5zdG9yYWdlcG9saWNpZXMuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1N0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCBhcyBzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL3N0b3JhZ2Vwb2xpY3lkZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5lZGl0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2RldGFpbHMvOmtleScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU3RvcmFnZVBvbGljeURldGFpbHNDdHJsIGFzIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvc3RvcmFnZXBvbGljeWRldGFpbHMuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1N0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnU3RvcmFnZVBvbGljaWVzTW9kZWwnLCAnVm9sdW1lc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBTdG9yYWdlUG9saWNpZXNNb2RlbCwgVm9sdW1lc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsID0gdGhpcztcbiAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmZpbGVzeXN0ZW1jbWRzID0gW107XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUbyBzaG93IGVkaXQgb3IgZGV0YWlscyBzY3JlZW4gYmFzZWQgb24gdGhlIHJvdXRlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBzZXRNb2RlKCkge1xuICAgICAgICAgICAgaWYgKCRzdGF0ZS5pcygnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmVkaXQnKSkge1xuICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5tb2RlID0gJ2VkaXQnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLm1vZGUgPSAnZGV0YWlscyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Qb2xpY2llcygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUuc3RvcmFnZXBvbGljaWVzLmxpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1BvbGljeURldGFpbHMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5kZXRhaWxzJywgeyAna2V5Jzogc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnBvbGljeS5uYW1lIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbEVkaXRpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm5Ub1BvbGljeURldGFpbHMoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBkZWxldGVQb2xpY3koKSB7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0YXJ0TG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbC5kZWxldGVVc2luZ0tleShzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5Lm5hbWUsICduYW1lJykudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIHJldHVyblRvUG9saWNpZXMoKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IHZvbHVtZXMgYmVsb25naW5nIHRvIGEgcG9saWN5XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBnZXRWb2x1bWVzKHJlbG9hZCkge1xuICAgICAgICAgICAgVm9sdW1lc01vZGVsLmdldChyZWxvYWQpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC52b2x1bWVzID0gJGZpbHRlcignb3JkZXJCeScpKF8uZmlsdGVyKHJlc3VsdCwge1xuICAgICAgICAgICAgICAgICAgICAncG9saWN5Jzogc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnBvbGljeS5uYW1lXG4gICAgICAgICAgICAgICAgfSksICduYW1lJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBpbml0aWFsaXplRmlsZXN5c3RlbUNtZHNBcnJheSgpIHtcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5LmZpbGVzeXN0ZW1zLCBmdW5jdGlvbiAodmFsdWUsIGtleSkge1xuICAgICAgICAgICAgICAgIHRoaXMucHVzaCh7IG5hbWU6IGtleSwgdmFsdWU6IHZhbHVlIH0pO1xuICAgICAgICAgICAgfSwgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmZpbGVzeXN0ZW1jbWRzKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVGaWxlc3lzdGVtQ21kcygpIHtcbiAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5maWxlc3lzdGVtY21kcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnBvbGljeS5maWxlc3lzdGVtc1tpdGVtLm5hbWVdID0gaXRlbS52YWx1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHNhdmVQb2xpY3koKSB7XG4gICAgICAgICAgICAvL2Zvcm0gY29udHJvbGxlciBpcyBpbmplY3RlZCBieSB0aGUgaHRtbCB0ZW1wbGF0ZVxuICAgICAgICAgICAgLy9jaGVja2luZyBpZiBhbGwgdmFsaWRhdGlvbnMgaGF2ZSBwYXNzZWRcbiAgICAgICAgICAgIGlmIChzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIGNyZWF0ZUZpbGVzeXN0ZW1DbWRzKCk7XG4gICAgICAgICAgICAgICAgU3RvcmFnZVBvbGljaWVzTW9kZWwuc2F2ZShzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwucG9saWN5KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1BvbGljeURldGFpbHMoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5RGV0YWlsc0N0cmwpO1xuICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Ioc3RvcmFnZVBvbGljeURldGFpbHNDdHJsKTtcbiAgICAgICAgU3RvcmFnZVBvbGljaWVzTW9kZWwuZ2V0TW9kZWxCeUtleSgkc3RhdGVQYXJhbXMua2V5LCBmYWxzZSwgJ25hbWUnKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHBvbGljeSkge1xuICAgICAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLnBvbGljeSA9IHBvbGljeTtcbiAgICAgICAgICAgIGluaXRpYWxpemVGaWxlc3lzdGVtQ21kc0FycmF5KCk7XG4gICAgICAgICAgICBnZXRWb2x1bWVzKGZhbHNlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5kZWxldGVQb2xpY3kgPSBkZWxldGVQb2xpY3k7XG4gICAgICAgIHN0b3JhZ2VQb2xpY3lEZXRhaWxzQ3RybC5zYXZlUG9saWN5ID0gc2F2ZVBvbGljeTtcbiAgICAgICAgc3RvcmFnZVBvbGljeURldGFpbHNDdHJsLmNhbmNlbEVkaXRpbmcgPSBjYW5jZWxFZGl0aW5nO1xuICAgICAgICBzZXRNb2RlKCk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG9yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldFZvbHVtZXModHJ1ZSk7XG4gICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdG9yYWdlcG9saWN5ZGV0YWlsc2N0cmwuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA2LzIvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LnN0b3JhZ2Vwb2xpY2llc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZTdG9yYWdlcG9saWN5YmFzaWNzZXR0aW5nc1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHt9O1xufSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2U3RvcmFnZXBvbGljeWZpbGVzeXN0ZW1zZXR0aW5nc1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIHBvbGljeTogJz0nLFxuICAgICAgICAgICAgZmlsZXN5c3RlbWNtZHM6ICc9J1xuICAgICAgICB9LFxuICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUpIHtcbiAgICAgICAgICAgIHNjb3BlLmZpbGVzeXN0ZW1zID0gWydleHQ0JywgJ2J0cmZzJ107XG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9maWxlc3lzdGVtc2V0dGluZ3MuaHRtbCdcbiAgICB9O1xufSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2U3RvcmFnZXBvbGljeXNuYXBzaG90c2V0dGluZ3NcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBwb2xpY3k6ICc9J1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0b3JhZ2VfcG9saWNpZXMvc25hcHNob3RzZXR0aW5ncy5odG1sJ1xuICAgIH07XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZTdG9yYWdlcG9saWN5cndvcHNzZXR0aW5nc1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIHBvbGljeTogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9yd29wc3NldHRpbmdzLmh0bWwnXG4gICAgfTtcbn0pXG4gICAgLmRpcmVjdGl2ZShcImN0dlN0b3JhZ2Vwb2xpY3liYWNrZW5kZHJpdmVyc1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIHBvbGljeTogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnc3RvcmFnZV9wb2xpY2llcy9iYWNrZW5kZHJpdmVycy5odG1sJ1xuICAgIH07XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXN0b3JhZ2Vwb2xpY3lkaXJlY3RpdmUuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA0LzE4LzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnN0b3JhZ2Vwb2xpY2llcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnN0b3JhZ2Vwb2xpY2llcy5saXN0Jywge1xuICAgICAgICAgICAgdXJsOiAnL2xpc3QnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1N0b3JhZ2VQb2xpY3lMaXN0Q3RybCBhcyBzdG9yYWdlUG9saWN5TGlzdEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdG9yYWdlX3BvbGljaWVzL3N0b3JhZ2Vwb2xpY3lsaXN0Lmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdTdG9yYWdlUG9saWN5TGlzdEN0cmwnLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLCAnJGZpbHRlcicsICdTdG9yYWdlUG9saWNpZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzY29wZSwgJGludGVydmFsLCAkZmlsdGVyLCBTdG9yYWdlUG9saWNpZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHN0b3JhZ2VQb2xpY3lMaXN0Q3RybCA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGdldFBvbGljaWVzKHJlbG9hZCkge1xuICAgICAgICAgICAgU3RvcmFnZVBvbGljaWVzTW9kZWwuZ2V0KHJlbG9hZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5TGlzdEN0cmwpO1xuICAgICAgICAgICAgICAgIHN0b3JhZ2VQb2xpY3lMaXN0Q3RybC5wb2xpY2llcyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcihzdG9yYWdlUG9saWN5TGlzdEN0cmwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy9Mb2FkIGZyb20gY2FjaGUgZm9yIHF1aWNrIGRpc3BsYXkgaW5pdGlhbGx5XG4gICAgICAgIGdldFBvbGljaWVzKGZhbHNlKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldFBvbGljaWVzKHRydWUpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3RvcmFnZXBvbGljeWxpc3RjdHJsLmpzLm1hcCIsIlxuXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52aXN1YWxpemF0aW9uLmVkZ2UnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2VkZ2Uve3NvdXJjZU5hbWUsIHRhcmdldE5hbWUsIHNvdXJjZUxpc3QsIHRhcmdldExpc3R9JyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlTmFtZTogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TmFtZTogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgc291cmNlTGlzdDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TGlzdDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1Zpc3VhbGl6YXRpb25FZGdlQ3RybCBhcyB2aXN1YWxpemF0aW9uZWRnZUN0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9uZWRnZS5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdWaXN1YWxpemF0aW9uRWRnZUN0cmwnLCBbXCIkc2NvcGVcIiwgXCIkaHR0cFwiLCAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdWaXN1YWxpemF0aW9uU2VydmljZScsICckaW50ZXJ2YWwnLFxuICAgICAgICBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkc3RhdGUsICRzdGF0ZVBhcmFtcywgVmlzdWFsaXphdGlvblNlcnZpY2UsICRpbnRlcnZhbCkge1xuICAgICAgICAgICAgdmFyIHNvdXJjZU5hbWUgPSAkc3RhdGVQYXJhbXMuc291cmNlTmFtZTtcbiAgICAgICAgICAgIHZhciB0YXJnZXROYW1lID0gJHN0YXRlUGFyYW1zLnRhcmdldE5hbWU7XG4gICAgICAgICAgICB2YXIgc291cmNlTGlzdCA9ICRzdGF0ZVBhcmFtcy5zb3VyY2VMaXN0O1xuICAgICAgICAgICAgdmFyIHRhcmdldExpc3QgPSAkc3RhdGVQYXJhbXMudGFyZ2V0TGlzdDtcblxuICAgICAgICAgICAgLy9JZiB0aGUgcGFnZSBpcyByZWxvYWRlZCwgdGhlc2Ugc3RhdGUgcGFyYW1zIGFyZSBhbGwgbnVsbCxcbiAgICAgICAgICAgIC8vc28gaXQgd2lsbCByb3V0ZSB0aGVtIGJhY2sgdG8gdGhlIHZpc3VhbGl6YXRpb24gdGFiIHRvcCB2aWV3XG4gICAgICAgICAgICBpZiAoc291cmNlTGlzdCA9PSBudWxsIHx8IHRhcmdldExpc3QgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUudmlzdWFsaXphdGlvbi5saXN0Jyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgZCA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICB2YXIgdCA9IGQuZ2V0U2Vjb25kcygpO1xuICAgICAgICAgICAgJHNjb3BlLmVkZ2VEYXRhSW50ZXJ2YWwgPSBcbiAgICAgICAgICAgICAgICAkaW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIFZpc3VhbGl6YXRpb25TZXJ2aWNlLmdldEVkZ2VEYXRhKHNvdXJjZUxpc3QsIHRhcmdldExpc3QsIHQudG9TdHJpbmcoKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0cyA9IHJlc3VsdC5yZXN1bHRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2gocmVzdWx0cywgZnVuY3Rpb24ocikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoXy5pc0VtcHR5KHIpID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSArPSByLnNlcmllc1swXS52YWx1ZXNbMF1bMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlTmFtZSA9IHNvdXJjZU5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRhcmdldE5hbWUgPSB0YXJnZXROYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5lZGdlRGF0YSA9IGRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVkZ2VEYXRhVGltZSA9IHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0sIDMwMDApO1xuXG4gICAgICAgICAgICAvL0Rlc3Ryb3lpbmcgdGhlIGludGVydmFsIGZ1bmN0aW9uIG9uIHJvdXRlIGNoYW5nZVxuICAgICAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7ICRpbnRlcnZhbC5jYW5jZWwoJHNjb3BlLmVkZ2VEYXRhSW50ZXJ2YWwpOyB9KTtcblxuXG4gICAgICAgICAgICBWaXN1YWxpemF0aW9uU2VydmljZS5nZXRPbGRFZGdlRGF0YShzb3VyY2VMaXN0LCB0YXJnZXRMaXN0KVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSByZXN1bHQucmVzdWx0cztcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVkZ2VEYXRhID0gW107XG4gICAgICAgICAgICAgICAgICAgIC8vcmVzdWx0cywgaWYgbm90IGVtcHR5LCBhcmUgZXhwZWN0ZWQgdG8gaGF2ZVxuICAgICAgICAgICAgICAgICAgICAvLzYgZGF0YSBlbnRyaWVzXG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChyZXN1bHRzLCBmdW5jdGlvbihyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoXy5pc0VtcHR5KHIpID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gci5zZXJpZXNbMF0udmFsdWVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfLmlzRW1wdHkoZWRnZURhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChkYXRhLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGdlRGF0YS5wdXNoKGRbMV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChkYXRhLCBmdW5jdGlvbihkLCBpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGdlRGF0YVtpXSArPSBkWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNvdXJjZU5hbWUgPSBzb3VyY2VOYW1lO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudGFyZ2V0TmFtZSA9IHRhcmdldE5hbWU7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zb3VyY2VMaXN0ID0gc291cmNlTGlzdDtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRhcmdldExpc3QgPSB0YXJnZXRMaXN0O1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUub2xkRWRnZURhdGEgPSBlZGdlRGF0YTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIH0pO1xuICAgIH1dKTtcblxuXG5cblxuIiwiXG5cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudmlzdWFsaXphdGlvbicpXG4gICAgLmRpcmVjdGl2ZShcInZpc3VhbGl6YXRpb25FZGdlXCIsIFsnJHdpbmRvdycsXG4gICAgICAgIGZ1bmN0aW9uKCR3aW5kb3cpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIHZpc3VhbGl6YXRpb25FZGdlRDMoc2NvcGUsIGQzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJvZHlFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF07XG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IGJvZHlFbC5jbGllbnRXaWR0aCAtIDQwMCxcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gIGJvZHlFbC5jbGllbnRIZWlnaHQgLSA0MDA7XG5cblxuICAgICAgICAgICAgICAgIC8vdGFrZW4gZnJvbSBodHRwOi8vYmwub2Nrcy5vcmcvc2ltZW5icmVra2VuLzY2MzQwNzBcbiAgICAgICAgICAgICAgICAvLyAvKiogTUFJTiBTVkcgKiovXG4gICAgICAgICAgICAgICAgdmFyIGxpbWl0ID0gNTksXG4gICAgICAgICAgICAgICAgZHVyYXRpb24gPSA3NTAsXG4gICAgICAgICAgICAgICAgbm93ID0gbmV3IERhdGUoRGF0ZS5ub3coKSAtIGR1cmF0aW9uKTtcblxuICAgICAgICAgICAgICAgIHZhciBncm91cHMgPSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdvcmFuZ2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZDMucmFuZ2UobGltaXQpLm1hcChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNjb3BlLm9sZEVkZ2VEYXRhW01hdGguZmxvb3IoZC8xMCldIHx8IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgeCA9IGQzLnRpbWUuc2NhbGUoKVxuICAgICAgICAgICAgICAgICAgICAuZG9tYWluKFtub3cgLSAobGltaXQgLSAyKSwgbm93IC0gZHVyYXRpb25dKVxuICAgICAgICAgICAgICAgICAgICAucmFuZ2UoWzAsIHdpZHRoXSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgeSA9IGQzLnNjYWxlLmxpbmVhcigpXG4gICAgICAgICAgICAgICAgICAgIC5kb21haW4oWzAsIGQzLm1heChncm91cHMuY3VycmVudC5kYXRhLCBmdW5jdGlvbiAoZCkgeyByZXR1cm4gZCArIDEwOyB9KV0pXG4gICAgICAgICAgICAgICAgICAgIC5yYW5nZShbaGVpZ2h0LCAwXSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbGluZSA9IGQzLnN2Zy5saW5lKClcbiAgICAgICAgICAgICAgICAgICAgLmludGVycG9sYXRlKCdiYXNpcycpXG4gICAgICAgICAgICAgICAgICAgIC54KGZ1bmN0aW9uKGQsIGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB4KG5vdyAtIChsaW1pdCAtIDEgLSBpKSAqIGR1cmF0aW9uKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAueShmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geShkKVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHZhciB4U3ZnID0gZDMuc2VsZWN0KCcuZ3JhcGgnKS5hcHBlbmQoJ3N2ZycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd3aWR0aCcsIDI1KVxuICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ292ZXJmbG93JywgJ3Zpc2libGUnKVxuICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ3Bvc2l0aW9uJywgJ2ZpeGVkJyk7XG5cbiAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgIHZhciB5QXhpcyA9IHhTdmcuYXBwZW5kKCdnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ3kgYXhpcycpXG4gICAgICAgICAgICAgICAgICAgIC8vIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDAsJyArIHdpZHRoICsgJyknKVxuICAgICAgICAgICAgICAgICAgICAuY2FsbCh5LmF4aXMgPSBkMy5zdmcuYXhpcygpLnNjYWxlKHkpLm9yaWVudCgnbGVmdCcpKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgc3ZnPSBkMy5zZWxlY3QoJy5ncmFwaCcpLmFwcGVuZCgnc3ZnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2NoYXJ0JylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgd2lkdGggLSA1MClcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2hlaWdodCcsIGhlaWdodCArIDUwKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gLnN0eWxlKCdvdmVyZmxvdycsIFwidmlzaWJsZVwiKTtcblxuICAgICAgICAgICAgICAgIHZhciBheGlzID0gc3ZnLmFwcGVuZCgnZycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICd4IGF4aXMnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZSgwLCcgKyBoZWlnaHQgKyAnKScpXG4gICAgICAgICAgICAgICAgICAgIC5jYWxsKHguYXhpcyA9IGQzLnN2Zy5heGlzKCkuc2NhbGUoeCkub3JpZW50KCdib3R0b20nKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgcGF0aHMgPSBzdmcuYXBwZW5kKCdnJyk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBuYW1lIGluIGdyb3Vwcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ3JvdXAgPSBncm91cHNbbmFtZV07XG4gICAgICAgICAgICAgICAgICAgIGdyb3VwLnBhdGggPSBwYXRocy5hcHBlbmQoJ3BhdGgnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmRhdGEoW2dyb3VwLmRhdGFdKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgbmFtZSArICcgZ3JvdXAnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN0eWxlKCdzdHJva2UnLCBncm91cC5jb2xvcilcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiB0aWNrKCkge1xuICAgICAgICAgICAgICAgICAgICBub3cgPSBuZXcgRGF0ZSgpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCBuZXcgdmFsdWVzXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIG5hbWUgaW4gZ3JvdXBzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ3JvdXAgPSBncm91cHNbbmFtZV07XG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cC5kYXRhLnB1c2goc2NvcGUuZWRnZURhdGEgfHwgMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cC5wYXRoLmF0dHIoJ2QnLCBsaW5lKVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2hpZnQgZG9tYWluXG4gICAgICAgICAgICAgICAgICAgIHguZG9tYWluKFtub3cgLSAobGltaXQgLSAyKSAqIGR1cmF0aW9uLCBub3cgLSBkdXJhdGlvbl0pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFNsaWRlIHgtYXhpcyBsZWZ0XG4gICAgICAgICAgICAgICAgICAgIGF4aXMudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZHVyYXRpb24oZHVyYXRpb24pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZWFzZSgnbGluZWFyJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYWxsKHguYXhpcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgeUF4aXMudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZHVyYXRpb24oZHVyYXRpb24pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZWFzZSgnbGluZWFyJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYWxsKHkuYXhpcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2xpZGUgcGF0aHMgbGVmdFxuICAgICAgICAgICAgICAgICAgICBwYXRocy5hdHRyKCd0cmFuc2Zvcm0nLCBudWxsKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmR1cmF0aW9uKGR1cmF0aW9uKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVhc2UoJ2xpbmVhcicpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZSgnICsgeChub3cgLSAobGltaXQgLSAxKSAqIGR1cmF0aW9uKSArICcpJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lYWNoKCdlbmQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aWNrKClcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBvbGRlc3QgZGF0YSBwb2ludCBmcm9tIGVhY2ggZ3JvdXBcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBncm91cHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBncm91cCA9IGdyb3Vwc1tuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLmRhdGEuc2hpZnQoKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRpY2soKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm57XG4gICAgICAgICAgICAgICAgcmVzdHJpY3Q6J0VBJyxcbiAgICAgICAgICAgICAgICByZXBsYWNlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Zpc3VhbGl6YXRpb24vdmlzdWFsaXphdGlvbmVkZ2V0ZW1wbGF0ZS5odG1sJyxcbiAgICAgICAgICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSl7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiR3YXRjaEdyb3VwKFsnZWRnZURhdGEnLCAnb2xkRWRnZURhdGEnXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzY29wZS5lZGdlRGF0YSAhPSBudWxsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5vbGRFZGdlRGF0YSAhPSBudWxsICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNjb3BlLmluaXRpYWxpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmluaXRpYWxpemUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQzID0gJHdpbmRvdy5kMzsgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzdWFsaXphdGlvbkVkZ2VEMyhzY29wZSwgZDMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgXVxuKTtcbiIsIlxuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52aXN1YWxpemF0aW9uJylcbiAgICAuc2VydmljZSgnU3RhdGVTYXZlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNhdmVkU3RhdGVzID0ge307XG4gICAgfSlcbiAgICAuZGlyZWN0aXZlKFwidmlzdWFsaXphdGlvbkdyYXBoXCIsIFsnJHdpbmRvdycsICckc3RhdGUnLCAnVmlzdWFsaXplckdyYXBoJywgJ1BvbGljeVNlcnZpY2UnLCAnVmlzdWFsaXplckRhdGFTb3VyY2UnLCAnU3RhdGVTYXZlJyxcbiAgICAgICAgZnVuY3Rpb24oJHdpbmRvdywgJHN0YXRlLCBWaXN1YWxpemVyR3JhcGgsIFBvbGljeVNlcnZpY2UsIFZpc3VhbGl6ZXJEYXRhU291cmNlLCBTdGF0ZVNhdmUpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIHZpc3VhbGl6YXRpb25saXN0ZDMoc2NvcGUsIGVsZW0sIFZpc3VhbGl6ZXJHcmFwaCwgUG9saWN5U2VydmljZSwgVmlzdWFsaXplckRhdGFTb3VyY2UsIFN0YXRlU2F2ZSkge1xuICAgICAgICAgICAgICAgIC8vZG9uJ3QgcnVuIHVudGlsIGFsbCBpbml0aWFsaXphdGlvbiBjYWxscyBoYXZlIHJldHVybmVkXG4gICAgICAgICAgICAgICAgaWYgKHNjb3BlLm5vZGVzID09PSB1bmRlZmluZWQgfHwgc2NvcGUubGlua3MgPT09IHVuZGVmaW5lZCB8fCBzY29wZS5jaGlsZHJlbl9zdHJ1Y3QgPT09IHVuZGVmaW5lZCB8fFxuICAgICAgICAgICAgICAgICAgICBzY29wZS5hbmNlc3RvcnNfc3RydWN0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vY3JlYXRpbmcgRGF0YVNvdXJjZVxuICAgICAgICAgICAgICAgIHZhciBkYXRhU291cmNlID0gbmV3IFZpc3VhbGl6ZXJEYXRhU291cmNlLkRhdGFTb3VyY2Uoc2NvcGUubm9kZXMsIHNjb3BlLmxpbmtzLCBzY29wZS5jaGlsZHJlbl9zdHJ1Y3QsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuYW5jZXN0b3JzX3N0cnVjdCwgc2NvcGUubGFiZWxzLCBzY29wZS5zZXJ2aWNlU2VsZWN0b3JzKTtcbiAgICAgICAgICAgICAgICBkYXRhU291cmNlLnNldEFuY2VzdG9ycygpO1xuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzLCBsaW5rcztcblxuICAgICAgICAgICAgICAgIHZhciB0b3BEYXRhID0gZGF0YVNvdXJjZS5nZXRUb3BMZXZlbEZsb3coKTtcbiAgICAgICAgICAgICAgICBub2RlcyA9IGRhdGFTb3VyY2UucHJvY2Vzc05vZGVEYXRhKHRvcERhdGEubm9kZURhdGEpO1xuICAgICAgICAgICAgICAgIGxpbmtzID0gZGF0YVNvdXJjZS5wcm9jZXNzTGlua0RhdGEodG9wRGF0YS5saW5rRGF0YSwgbm9kZXMpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGJvZHlFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF07XG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IGJvZHlFbC5jbGllbnRXaWR0aCxcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gIGJvZHlFbC5jbGllbnRIZWlnaHQ7XG5cbiAgICAgICAgICAgICAgICAvKiogTUFJTiBTVkcgKiovXG4gICAgICAgICAgICAgICAgdmFyIHJhd1N2Zz1lbGVtLmZpbmQoJ3N2ZycpO1xuXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9ICQocmF3U3ZnLnBhcmVudCgpKS5vZmZzZXQoKTtcblxuICAgICAgICAgICAgICAgIHZhciBkaXZXaWR0aCA9ICQocmF3U3ZnLnBhcmVudCgpKS53aWR0aCgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN2ZyA9IGQzLnNlbGVjdChyYXdTdmdbMF0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwid2lkdGhcIiwgZGl2V2lkdGgpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGhlaWdodCAtIG9mZnNldC50b3AgLSAyMCk7XG5cbiAgICAgICAgICAgICAgICAvL2luc3RhbGxpbmcgcG9saWNpZXNcbiAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGggPSBuZXcgVmlzdWFsaXplckdyYXBoLkdyYXBoKHN2Zywgbm9kZXMsIGxpbmtzLCBkYXRhU291cmNlLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5jaGlsZHJlbl9zdHJ1Y3QsIHNjb3BlLmFuY2VzdG9yc19zdHJ1Y3QpO1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5pbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3kobmV3IFBvbGljeVNlcnZpY2UuU2F2ZVN0YXRlUG9saWN5KFN0YXRlU2F2ZS5zYXZlZFN0YXRlcykpO1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5pbnN0YWxsRGVmYXVsdFBhdGhQb2xpY3kobmV3IFBvbGljeVNlcnZpY2UuUGF0aENoYW5nZVZpZXdQb2xpY3koJHN0YXRlKSk7XG4gICAgICAgICAgICAgICAgLy9RVGlwUG9saWN5IGlzIGZvciBib3RoIE5vZGVzIGFuZCBQYXRocywgaW5zdGFsbCBzYW1lIG9uZSBvbiBib3RoXG4gICAgICAgICAgICAgICAgdmFyIHFUaXBQb2xpY3kgPSBuZXcgUG9saWN5U2VydmljZS5RVGlwUG9saWN5KCk7XG4gICAgICAgICAgICAgICAgc2NvcGUudmlzdWFsaXphdGlvbkdyYXBoLmluc3RhbGxEZWZhdWx0Tm9kZVBvbGljeShxVGlwUG9saWN5KTtcbiAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGguaW5zdGFsbERlZmF1bHRQYXRoUG9saWN5KHFUaXBQb2xpY3kpO1xuICAgICAgICAgICAgICAgIHZhciBzcGxpdEpvaW5WaWV3UG9saWN5ID0gbmV3IFBvbGljeVNlcnZpY2UuU3BsaXRKb2luVmlld1BvbGljeSgpO1xuICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5pbnN0YWxsRGVmYXVsdE5vZGVQb2xpY3koc3BsaXRKb2luVmlld1BvbGljeSk7XG4gICAgICAgICAgICAgICAgc3BsaXRKb2luVmlld1BvbGljeS5pbnN0YWxsQmFja0J1dHRvbigkKCcjYmFja0J1dHRvbicpKTtcbiAgICAgICAgICAgICAgICBzcGxpdEpvaW5WaWV3UG9saWN5Lmluc3RhbGxUaXRsZSgkKCcjZ3JhcGgtdGl0bGUnKSk7XG5cbiAgICAgICAgICAgICAgICAvL2xvYWQgb2xkIHZpZXcgaWYgaXQgZXhpc3RzLlxuICAgICAgICAgICAgICAgIGlmIChfLmlzRW1wdHkoU3RhdGVTYXZlLnNhdmVkU3RhdGVzKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ3JhcGggPSBzY29wZS52aXN1YWxpemF0aW9uR3JhcGg7XG4gICAgICAgICAgICAgICAgICAgIGdyYXBoLmxvYWQoU3RhdGVTYXZlLnNhdmVkU3RhdGVzKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGgudXBkYXRlR3JhcGgoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybntcbiAgICAgICAgICAgICAgICByZXN0cmljdDonRUEnLFxuICAgICAgICAgICAgICAgIHJlcGxhY2U6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlzdWFsaXphdGlvbi92aXN1YWxpemF0aW9udGVtcGxhdGUuaHRtbCcsXG4gICAgICAgICAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW0pe1xuICAgICAgICAgICAgICAgICAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkgeyBcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJyN2aXN1YWxpemF0aW9uLWdyYXBoJykudW5iaW5kKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS52aXN1YWxpemF0aW9uR3JhcGguZGVzdHJveSgpO30pO1xuICAgICAgICAgICAgICAgICAgICBzY29wZS4kd2F0Y2hHcm91cChbJ25vZGVzJywgJ2xpbmtzJywgJ2NoaWxkcmVuX3N0cnVjdCcsICdhbmNlc3RvcnNfc3RydWN0J10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2NvcGUubm9kZXMgIT0gbnVsbCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5saW5rcyAhPSBudWxsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmNoaWxkcmVuX3N0cnVjdCAhPSBudWxsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmFuY2VzdG9yc19zdHJ1Y3QgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2NvcGUuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXN1YWxpemF0aW9ubGlzdGQzKHNjb3BlLCBlbGVtLCBWaXN1YWxpemVyR3JhcGgsIFBvbGljeVNlcnZpY2UsIFZpc3VhbGl6ZXJEYXRhU291cmNlLCBTdGF0ZVNhdmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC5kYXRhU291cmNlLmxpbmtzID0gc2NvcGUubGlua3M7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnZpc3VhbGl6YXRpb25HcmFwaC51cGRhdGVMaW5rRGF0YSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICB9XG4gICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICBdXG4pO1xuXG5cblxuXG5cblxuXG5cblxuXG5cblxuIiwiYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52aXN1YWxpemF0aW9uJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUudmlzdWFsaXphdGlvbi5saXN0Jywge1xuICAgICAgICAgICAgICAgIHVybDogJy9saXN0JyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnVmlzdWFsaXphdGlvbkxpc3RDdHJsIGFzIHZpc3VhbGl6YXRpb25MaXN0Q3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aXN1YWxpemF0aW9uL3Zpc3VhbGl6YXRpb25saXN0Lmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICA7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1Zpc3VhbGl6YXRpb25MaXN0Q3RybCcsIFtcIiRzY29wZVwiLCBcIiRodHRwXCIsICdWaXN1YWxpemF0aW9uU2VydmljZScsICckaW50ZXJ2YWwnLCBcbiAgICAgICAgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgVmlzdWFsaXphdGlvblNlcnZpY2UsICRpbnRlcnZhbCkge1xuICAgICAgICAgICAgLy90byBzZWUgdGhlIGV4cGVjdGVkIGZvcm1hdCB0byBiZSByZXR1cm5lZCBmcm9tIHRoZXNlIGNhbGxzLFxuICAgICAgICAgICAgLy9sb29rIGF0IGFwcC9jb21wb25lbnRzL2dyYXBob2JqZWN0cy9kYXRhc291cmNlL3Zpc3VhbGl6ZXJkYXRhc291cmNlLmpzXG4gICAgICAgICAgICB2YXIgc3VjY2Vzc0dyYXBoRGF0YUNhbGxiYWNrID0gZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIGxpbmtzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVJZHMgPSBbXTtcbiAgICAgICAgICAgICAgICBfLmZvckVhY2gocmVzdWx0LnJlc3VsdHNbMF0uc2VyaWVzLCBmdW5jdGlvbihzZXJpZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVuZHBvaW50ID0gc2VyaWVzLnRhZ3MuRW5kcG9pbnRJUDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb3ZpZGVyID0gc2VyaWVzLnRhZ3MuUHJvdmlkZXJJUDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGU7XG4gICAgICAgICAgICAgICAgICAgIC8vY3JlYXRpbmcgbm9kZXNcbiAgICAgICAgICAgICAgICAgICAgaWYgKF8uaW5jbHVkZXMobm9kZUlkcywgZW5kcG9pbnQpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGVuZHBvaW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBlbmRwb2ludCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3JzOiBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXMucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHMucHVzaChlbmRwb2ludCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKF8uaW5jbHVkZXMobm9kZUlkcywgcHJvdmlkZXIpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHByb3ZpZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBwcm92aWRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3JzOiBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXMucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZHMucHVzaChwcm92aWRlcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy9jcmVhdGluZyBsaW5rc1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGlua091dCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogZW5kcG9pbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IHByb3ZpZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0OiBzZXJpZXMudmFsdWVzWzBdWzJdXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGxpbmtzLnB1c2gobGlua091dCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsaW5rSW4gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6IHByb3ZpZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiBlbmRwb2ludCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHdlaWdodDogc2VyaWVzLnZhbHVlc1swXVsxXVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBsaW5rcy5wdXNoKGxpbmtJbik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLm5vZGVzID0gbm9kZXM7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxpbmtzID0gbGlua3M7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLy9pbml0aWFsIGNhbGxcbiAgICAgICAgICAgIFZpc3VhbGl6YXRpb25TZXJ2aWNlLmdldEdyYXBoRGF0YSgpLnRoZW4oc3VjY2Vzc0dyYXBoRGF0YUNhbGxiYWNrLCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vd2lsbCBmYWlsIHNpbGVudGx5LCBncmFwaCB3b24ndCBiZSBkaXNwbGF5ZWRcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHsgJGludGVydmFsLmNhbmNlbCgkc2NvcGUuZ3JhcGhEYXRhSW50ZXJ2YWwpOyB9KTtcblxuICAgICAgICAgICAgVmlzdWFsaXphdGlvblNlcnZpY2UuZ2V0U3RydWN0dXJlRGF0YSgpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vdG8gc2VlIHRoZSBleHBlY3RlZCBmb3JtIG9mIGFuY2VzdG9yX3N0cnVjdCBhbmQgY2hpbGRyZW5fc3RydWN0LCBcbiAgICAgICAgICAgICAgICAvL2xvb2sgYXQgYXBwL2NvbXBvbmVudHMvZ3JhcGhvYmplY3RzL2RhdGFzb3VyY2UvdmlzdWFsaXplcmRhdGFzb3VyY2UuanNcbiAgICAgICAgICAgICAgICAkc2NvcGUuYW5jZXN0b3JzX3N0cnVjdCA9IHJlc3VsdC5hbmNlc3RvcnNfc3RydWN0O1xuICAgICAgICAgICAgICAgICRzY29wZS5jaGlsZHJlbl9zdHJ1Y3QgPSByZXN1bHQuY2hpbGRyZW5fc3RydWN0O1xuICAgICAgICAgICAgICAgICRzY29wZS5sYWJlbHMgPSByZXN1bHQubGFiZWxzO1xuICAgICAgICAgICAgICAgICRzY29wZS5zZXJ2aWNlU2VsZWN0b3JzID0gcmVzdWx0LnNlcnZpY2VTZWxlY3RvcnM7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vd2lsbCBmYWlsIHNpbGVudGx5LCBncmFwaCB3b24ndCBiZSBkaXNwbGF5ZWRcbiAgICAgICAgICAgIH0pO1xuICAgIH1dKTtcblxuXG5cblxuXG5cblxuXG5cblxuXG4iLCJhbmd1bGFyLm1vZHVsZSgnY29udGl2LnZpc3VhbGl6YXRpb24nKVxuICAgIC5mYWN0b3J5KCdWaXN1YWxpemF0aW9uU2VydmljZScsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbiAoJGh0dHAsICRxKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYWtlcyBhIGdldCByZXF1ZXN0IHdpdGggdGhlIHVybCBhbmQgY29uZmlnLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gICAgICB7c3RyaW5nfSAgdXJsICAgICBUaGUgdXJsXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtPYmplY3R9ICBjb25maWcgIFRoZSBjb25maWd1cmF0aW9uc1xuICAgICAgICAgKiBAcmV0dXJuICAgICB7JEh0dHAgUHJvbWlzZX0gICBQcm9taXNlIG9mIHRoZSByZXF1ZXN0XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBtYWtlR2V0KHVybCwgY29uZmlnKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCwgY29uZmlnKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogTWFrZXMgYSBwb3N0IHJlcXVlc3Qgd2l0aCB0aGUgdXJsIGFuZCBkYXRhXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSAgICAgIHtzdHJpbmd9ICB1cmwgICAgIFRoZSB1cmxcbiAgICAgICAgICogQHBhcmFtICAgICAge0pTT059ICAgIGRhdGEgICAgVGhlIGRhdGFcbiAgICAgICAgICogQHJldHVybiAgICAgeyRIdHRwIFByb21pc2V9ICAgUHJvbWlzZSBvZiB0aGUgcmVxdWVzdFxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gbWFrZVBvc3QodXJsLCBkYXRhKSB7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIGNvbnZlcnRzIHRoZSBkYXRhIGludG8geC13d3ctZnJvbS11cmxlbmNvZGVkXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtICAgICAge0pTT059ICBvYmogICAgIEpTT04gZGF0YSBvYmplY3RcbiAgICAgICAgICAgICAqIEByZXR1cm4gICAgIHtzdHJpbmd9ICB4LXd3dy1mb3JtLXVybGVuY29kZWQgc3RyaW5nXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHZhciBwYXJhbSA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgICAgICAgICAgIHZhciBxdWVyeSA9ICcnLCBuYW1lLCB2YWx1ZSwgZnVsbFN1Yk5hbWUsIHN1Yk5hbWUsIHN1YlZhbHVlLCBpbm5lck9iaiwgaTtcbiAgICAgICAgICAgICAgICBmb3IgKG5hbWUgaW4gb2JqKSB7XG4gICAgICAgICAgICAgICAgICB2YWx1ZSA9IG9ialtuYW1lXTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpPTA7IGk8dmFsdWUubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJWYWx1ZSA9IHZhbHVlW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bGxTdWJOYW1lID0gbmFtZSArICdbJyArIGkgKyAnXSc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5uZXJPYmogPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbm5lck9ialtmdWxsU3ViTmFtZV0gPSBzdWJWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeSArPSBwYXJhbShpbm5lck9iaikgKyAnJic7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBPYmplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoc3ViTmFtZSBpbiB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlZhbHVlID0gdmFsdWVbc3ViTmFtZV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVsbFN1Yk5hbWUgPSBuYW1lICsgJ1snICsgc3ViTmFtZSArICddJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbm5lck9iaiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlubmVyT2JqW2Z1bGxTdWJOYW1lXSA9IHN1YlZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ICs9IHBhcmFtKGlubmVyT2JqKSArICcmJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmKHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ICs9IGVuY29kZVVSSUNvbXBvbmVudChuYW1lKSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkgKyAnJic7XG4gICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBxdWVyeS5sZW5ndGggPyBxdWVyeS5zdWJzdHIoMCwgcXVlcnkubGVuZ3RoIC0gMSkgOiBxdWVyeTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgdXJsOnVybCxcbiAgICAgICAgICAgICAgICBtZXRob2Q6J1BPU1QnLFxuICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEsXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm1SZXF1ZXN0OiBbZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYW5ndWxhci5pc09iamVjdChkYXRhKSAmJiBTdHJpbmcoZGF0YSkgIT09ICdbb2JqZWN0IEZpbGVdJyA/IHBhcmFtKGRhdGEpIDogZGF0YTtcbiAgICAgICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldEdyYXBoRGF0YSgpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSBDb250aXZHbG9iYWxzLlZJU1VBTElaQVRJT05fRU5EUE9JTlQ7XG4gICAgICAgICAgICB1cmwgKz0gJ2luZmx1eC9xdWVyeSc7XG4gICAgICAgICAgICB2YXIgY29uZmlnID0ge1xuICAgICAgICAgICAgICAgIHBhcmFtczoge1xuICAgICAgICAgICAgICAgICAgICBkYjpcInRlbGVncmFmXCIsXG4gICAgICAgICAgICAgICAgICAgIHE6XCJTRUxFQ1QgQnl0ZXNJbiwgQnl0ZXNPdXQsIEVuZHBvaW50SVAsIFByb3ZpZGVySVAgRlJPTSBodHRwanNvbl9zdmNzdGF0cyBXSEVSRSB0aW1lID4gbm93KCkgLSAxbSBHUk9VUCBCWSAqIExJTUlUIDFcIlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gbWFrZUdldCh1cmwsIGNvbmZpZyk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRTdHJ1Y3R1cmVEYXRhKCkge1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuVklTVUFMSVpBVElPTl9FTkRQT0lOVDtcbiAgICAgICAgICAgIHVybCArPSAnc2VydmljZXMnO1xuICAgICAgICAgICAgcmV0dXJuIG1ha2VHZXQodXJsKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGJ1aWxkV2hlcmVRdWVyeShwb2ludHMsIHR5cGUpIHtcbiAgICAgICAgICAgIHZhciBxdWVyeSA9IFwiKFwiO1xuICAgICAgICAgICAgcXVlcnkgKz0gdHlwZSArIFwiPVwiO1xuICAgICAgICAgICAgcXVlcnkgKz0gXCInXCIgKyBwb2ludHNbMF0gKyBcIicgXCI7XG4gICAgICAgICAgICAvL3N0YXJ0cyBhdCAxLCBzbyB3aWxsIG5vdCBydW4gaWYgbGVuZ3RoIGlzIDFcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgcG9pbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcXVlcnkgKz0gJ09SICc7XG4gICAgICAgICAgICAgICAgcXVlcnkgKz0gdHlwZSArIFwiPVwiO1xuICAgICAgICAgICAgICAgIHF1ZXJ5ICs9IFwiJ1wiICsgcG9pbnRzW2ldICsgXCInIFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcXVlcnkgKz0gXCIpXCI7XG4gICAgICAgICAgICByZXR1cm4gcXVlcnk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRFZGdlRGF0YShzb3VyY2VMaXN0LCB0YXJnZXRMaXN0LCB0aW1lKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WSVNVQUxJWkFUSU9OX0VORFBPSU5UO1xuICAgICAgICAgICAgdXJsICs9ICdpbmZsdXgvcXVlcnknO1xuXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICAgICAgZGIgOiBcInRlbGVncmFmXCIsXG4gICAgICAgICAgICAgICAgICAgIHE6IFwiU0VMRUNUIHN1bShcIiArICdCeXRlc091dCcgKyBcIikgZnJvbSBodHRwanNvbl9zdmNzdGF0cyBXSEVSRSB0aW1lID4gbm93KCkgLSAxNXMgQU5EIFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkoc291cmNlTGlzdCwgXCJFbmRwb2ludElQXCIpICtcIiBBTkQgXCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkodGFyZ2V0TGlzdCwgJ1Byb3ZpZGVySVAnKSBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIFwiR1JPVVAgQlkgdGltZSgyMHMpIExJTUlUIDE7IFNFTEVDVCBzdW0oXCIgKyAnQnl0ZXNJbicgKyBcIikgZnJvbSBodHRwanNvbl9zdmNzdGF0cyBXSEVSRSB0aW1lID4gbm93KCkgLSAxNXMgQU5EIFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBidWlsZFdoZXJlUXVlcnkoc291cmNlTGlzdCwgJ1Byb3ZpZGVySVAnKSArXCIgQU5EIFwiIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHRhcmdldExpc3QsICdFbmRwb2ludElQJykgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBcIkdST1VQIEJZIHRpbWUoMjBzKSBmaWxsKDApIExJTUlUIDFcIlxuICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBtYWtlUG9zdCh1cmwsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgXG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0T2xkRWRnZURhdGEoc291cmNlTGlzdCwgdGFyZ2V0TGlzdCkge1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuVklTVUFMSVpBVElPTl9FTkRQT0lOVDtcbiAgICAgICAgICAgIHVybCArPSAnaW5mbHV4L3F1ZXJ5JztcbiAgICAgICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICBkYiA6IFwidGVsZWdyYWZcIixcbiAgICAgICAgICAgICAgICAgICAgcTogXCJTRUxFQ1Qgc3VtKFwiICsgJ0J5dGVzT3V0JyArIFwiKSBGUk9NIGh0dHBqc29uX3N2Y3N0YXRzIFdIRVJFIHRpbWUgPiBub3coKSAtIDFtIEFORCBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHNvdXJjZUxpc3QsIFwiRW5kcG9pbnRJUFwiKSArXCIgQU5EIFwiIFxuICAgICAgICAgICAgICAgICAgICAgICAgICsgYnVpbGRXaGVyZVF1ZXJ5KHRhcmdldExpc3QsIFwiUHJvdmlkZXJJUFwiKSBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIFwiIEdST1VQIEJZIHRpbWUoMTBzKSBmaWxsKDApIExJTUlUIDY7IFNFTEVDVCBzdW0oXCIgKyAnQnl0ZXNJbicgKyBcIikgRlJPTSBodHRwanNvbl9zdmNzdGF0cyBXSEVSRSB0aW1lID4gbm93KCkgLSAxbSBBTkQgXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeShzb3VyY2VMaXN0LCBcIlByb3ZpZGVySVBcIikgK1wiIEFORCBcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgICArIGJ1aWxkV2hlcmVRdWVyeSh0YXJnZXRMaXN0LCBcIkVuZHBvaW50SVBcIikgXG4gICAgICAgICAgICAgICAgICAgICAgICAgKyBcIiBHUk9VUCBCWSB0aW1lKDEwcykgZmlsbCgwKSBMSU1JVCA2XCJcbiAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gbWFrZVBvc3QodXJsLCBkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRHcmFwaERhdGE6IGdldEdyYXBoRGF0YSxcbiAgICAgICAgICAgIGdldFN0cnVjdHVyZURhdGE6IGdldFN0cnVjdHVyZURhdGEsXG4gICAgICAgICAgICBnZXRFZGdlRGF0YTogZ2V0RWRnZURhdGEsXG4gICAgICAgICAgICBnZXRPbGRFZGdlRGF0YTogZ2V0T2xkRWRnZURhdGFcbiAgICAgICAgfVxuICAgIH1dKTtcblxuXG5cblxuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNi8zLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZvbHVtZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52b2x1bWVzLmNyZWF0ZScsIHtcbiAgICAgICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2b2x1bWVzL3ZvbHVtZWNyZWF0ZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWb2x1bWVDcmVhdGVDdHJsIGFzIHZvbHVtZUNyZWF0ZUN0cmwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdWb2x1bWVDcmVhdGVDdHJsJywgWyckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ1ZvbHVtZXNNb2RlbCcsICdTdG9yYWdlUG9saWNpZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBWb2x1bWVzTW9kZWwsIFN0b3JhZ2VQb2xpY2llc01vZGVsLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgdm9sdW1lQ3JlYXRlQ3RybCA9IHRoaXM7XG4gICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwuZmlsZXN5c3RlbXMgPSBbJ2V4dDQnLCAnYnRyZnMnXTtcbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuVG9Wb2x1bWVzTW9kZWwoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZvbHVtZXMubGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbENyZWF0aW5nKCkge1xuICAgICAgICAgICAgcmV0dXJuVG9Wb2x1bWVzTW9kZWwoKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IHN0b3JhZ2UgcG9saWNpZXMuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBnZXRTdG9yYWdlUG9saWNpZXMoKSB7XG4gICAgICAgICAgICBTdG9yYWdlUG9saWNpZXNNb2RlbC5nZXQoKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLnBvbGljaWVzID0gcmVzdWx0O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gYXBwbHlQb2xpY3lTZXR0aW5ncygpIHtcbiAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwubmV3Vm9sdW1lLnBvbGljeSA9IHZvbHVtZUNyZWF0ZUN0cmwuc2VsZWN0ZWRQb2xpY3kubmFtZTtcbiAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwubmV3Vm9sdW1lLmJhY2tlbmRzID0gdm9sdW1lQ3JlYXRlQ3RybC5zZWxlY3RlZFBvbGljeS5iYWNrZW5kcztcbiAgICAgICAgICAgIHZvbHVtZUNyZWF0ZUN0cmwubmV3Vm9sdW1lLmRyaXZlciA9IHZvbHVtZUNyZWF0ZUN0cmwuc2VsZWN0ZWRQb2xpY3kuZHJpdmVyO1xuICAgICAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUuY3JlYXRlID0gdm9sdW1lQ3JlYXRlQ3RybC5zZWxlY3RlZFBvbGljeS5jcmVhdGU7XG4gICAgICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLm5ld1ZvbHVtZS5ydW50aW1lID0gdm9sdW1lQ3JlYXRlQ3RybC5zZWxlY3RlZFBvbGljeS5ydW50aW1lO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZVZvbHVtZSgpIHtcbiAgICAgICAgICAgIC8vZm9ybSBjb250cm9sbGVyIGlzIGluamVjdGVkIGJ5IHRoZSBodG1sIHRlbXBsYXRlXG4gICAgICAgICAgICAvL2NoZWNraW5nIGlmIGFsbCB2YWxpZGF0aW9ucyBoYXZlIHBhc3NlZFxuICAgICAgICAgICAgaWYgKHZvbHVtZUNyZWF0ZUN0cmwuZm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RhcnRMb2FkZXIodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgYXBwbHlQb2xpY3lTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIFZvbHVtZXNNb2RlbC5jcmVhdGUodm9sdW1lQ3JlYXRlQ3RybC5uZXdWb2x1bWUpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZUNyZWF0ZUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Ub1ZvbHVtZXNNb2RlbCgpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcih2b2x1bWVDcmVhdGVDdHJsLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJlc2V0Rm9ybSgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5oaWRlU2VydmVyRXJyb3Iodm9sdW1lQ3JlYXRlQ3RybCk7XG4gICAgICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLm5ld1ZvbHVtZSA9IHtcbiAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICBcImJhY2tlbmRzXCI6IHt9LFxuICAgICAgICAgICAgICAgIFwiZHJpdmVyXCI6IHt9LFxuICAgICAgICAgICAgICAgIFwiY3JlYXRlXCI6IHt9LFxuICAgICAgICAgICAgICAgIFwicnVudGltZVwiOiB7fVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICB2b2x1bWVDcmVhdGVDdHJsLmNyZWF0ZVZvbHVtZSA9IGNyZWF0ZVZvbHVtZTtcbiAgICAgICAgdm9sdW1lQ3JlYXRlQ3RybC5jYW5jZWxDcmVhdGluZyA9IGNhbmNlbENyZWF0aW5nO1xuICAgICAgICBnZXRTdG9yYWdlUG9saWNpZXMoKTtcbiAgICAgICAgcmVzZXRGb3JtKCk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dm9sdW1lY3JlYXRlY3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDQvMTUvMTYuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdjb250aXYudm9sdW1lcycpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbnRpdi5tZW51LnZvbHVtZXMuZGV0YWlscycsIHtcbiAgICAgICAgICAgIHVybDogJy9kZXRhaWxzLzprZXknLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1ZvbHVtZURldGFpbHNDdHJsIGFzIHZvbHVtZURldGFpbHNDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndm9sdW1lcy92b2x1bWVkZXRhaWxzLmh0bWwnXG4gICAgICAgIH0pO1xuICAgIH1dKVxuICAgIC5jb250cm9sbGVyKCdWb2x1bWVEZXRhaWxzQ3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICckc2NvcGUnLCAnJGludGVydmFsJywgJyRodHRwJywgJ1ZvbHVtZXNNb2RlbCcsICdWb2x1bWVTZXJ2aWNlJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRzY29wZSwgJGludGVydmFsLCAkaHR0cCwgVm9sdW1lc01vZGVsLCBWb2x1bWVTZXJ2aWNlLCBDUlVESGVscGVyU2VydmljZSkge1xuICAgICAgICB2YXIgdm9sdW1lRGV0YWlsc0N0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiByZXR1cm5Ub1ZvbHVtZXMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2NvbnRpdi5tZW51LnZvbHVtZXMubGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGRlbGV0ZVZvbHVtZSgpIHtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcih2b2x1bWVEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcih2b2x1bWVEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBWb2x1bWVzTW9kZWwuZGVsZXRlKHZvbHVtZURldGFpbHNDdHJsLnZvbHVtZSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgQ1JVREhlbHBlclNlcnZpY2Uuc3RvcExvYWRlcih2b2x1bWVEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuVG9Wb2x1bWVzKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnZXRWb2x1bWVJbmZvKHJlbG9hZCkge1xuICAgICAgICAgICAgdmFyIHRva2VucyA9ICRzdGF0ZVBhcmFtcy5rZXkuc3BsaXQoJy8nKTtcbiAgICAgICAgICAgIHZhciBtb2RlbCA9IHt9O1xuICAgICAgICAgICAgbW9kZWwucG9saWN5ID0gdG9rZW5zWzBdO1xuICAgICAgICAgICAgbW9kZWwubmFtZSA9IHRva2Vuc1sxXTtcbiAgICAgICAgICAgIFZvbHVtZXNNb2RlbC5nZXRNb2RlbChtb2RlbCwgcmVsb2FkKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICh2b2x1bWUpIHtcbiAgICAgICAgICAgICAgICB2b2x1bWVEZXRhaWxzQ3RybC52b2x1bWUgPSB2b2x1bWU7XG4gICAgICAgICAgICAgICAgZ2V0Vm9sdW1lVXNlSW5mbygpO1xuICAgICAgICAgICAgICAgIGdldFZvbHVtZVNuYXBzaG90cygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0Vm9sdW1lVXNlSW5mbygpIHtcbiAgICAgICAgICAgIFZvbHVtZVNlcnZpY2UuZ2V0Vm9sdW1lVXNlSW5mbyh2b2x1bWVEZXRhaWxzQ3RybC52b2x1bWUpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHZvbHVtZURldGFpbHNDdHJsLnZvbHVtZVVzZSA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy9SZXR1cm5zIGVycm9yIGlmIHZvbHVtZSBpcyBub3QgbW91bnRlZCBieSBhbnkgY29udGFpbmVyXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnZXRWb2x1bWVTbmFwc2hvdHMoKSB7XG4gICAgICAgICAgICBWb2x1bWVTZXJ2aWNlLmdldFZvbHVtZVNuYXBzaG90cyh2b2x1bWVEZXRhaWxzQ3RybC52b2x1bWUpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHZvbHVtZURldGFpbHNDdHJsLnNuYXBzaG90cyA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiB0cmlnZ2VyVm9sdW1lU25hcHNob3QoKSB7XG4gICAgICAgICAgICB2b2x1bWVEZXRhaWxzQ3RybC5zbmFwc2hvdFN1Y2Nlc3MgPSBmYWxzZTtcbiAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcih2b2x1bWVEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcih2b2x1bWVEZXRhaWxzQ3RybCk7XG4gICAgICAgICAgICBWb2x1bWVTZXJ2aWNlLnRyaWdnZXJTbmFwc2hvdCh2b2x1bWVEZXRhaWxzQ3RybC52b2x1bWUpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIHZvbHVtZURldGFpbHNDdHJsLnNuYXBzaG90U3VjY2VzcyA9IHRydWU7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lRGV0YWlsc0N0cmwpO1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnNob3dTZXJ2ZXJFcnJvcih2b2x1bWVEZXRhaWxzQ3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHZvbHVtZURldGFpbHNDdHJsLmRlbGV0ZVZvbHVtZSA9IGRlbGV0ZVZvbHVtZTtcbiAgICAgICAgdm9sdW1lRGV0YWlsc0N0cmwudHJpZ2dlclZvbHVtZVNuYXBzaG90ID0gdHJpZ2dlclZvbHVtZVNuYXBzaG90O1xuICAgICAgICAvL0xvYWQgZnJvbSBjYWNoZSBmb3IgcXVpY2sgZGlzcGxheSBpbml0aWFsbHlcbiAgICAgICAgZ2V0Vm9sdW1lSW5mbyhmYWxzZSk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICAvL0Rvbid0IGRvIGF1dG8tcmVmcmVzaCBpZiBvbmUgaXMgYWxyZWFkeSBpbiBwcm9ncmVzc1xuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHByb21pc2UpKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXRWb2x1bWVJbmZvKHRydWUpO1xuICAgICAgICAgICAgfSwgQ29udGl2R2xvYmFscy5SRUZSRVNIX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgICAgICAvL3N0b3AgcG9sbGluZyB3aGVuIHVzZXIgbW92ZXMgYXdheSBmcm9tIHRoZSBwYWdlXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dm9sdW1lZGV0YWlsc2N0cmwuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiAzLzIyLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnY29udGl2LnZvbHVtZXMnKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdjb250aXYubWVudS52b2x1bWVzLmxpc3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvbGlzdCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVm9sdW1lTGlzdEN0cmwgYXMgdm9sdW1lTGlzdEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2b2x1bWVzL3ZvbHVtZWxpc3QuaHRtbCdcbiAgICAgICAgfSk7XG4gICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1ZvbHVtZUxpc3RDdHJsJywgWyckc2NvcGUnLCAnJGludGVydmFsJywgJyRmaWx0ZXInLCAnVm9sdW1lc01vZGVsJywgJ0NSVURIZWxwZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaW50ZXJ2YWwsICRmaWx0ZXIsIFZvbHVtZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHZvbHVtZUxpc3RDdHJsID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gZ2V0Vm9sdW1lcyhyZWxvYWQpIHtcbiAgICAgICAgICAgIFZvbHVtZXNNb2RlbC5nZXQocmVsb2FkKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZUxpc3RDdHJsKTtcbiAgICAgICAgICAgICAgICB2b2x1bWVMaXN0Q3RybC52b2x1bWVzID0gcmVzdWx0O1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZUxpc3RDdHJsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vTG9hZCBmcm9tIGNhY2hlIGZvciBxdWljayBkaXNwbGF5IGluaXRpYWxseVxuICAgICAgICBnZXRWb2x1bWVzKGZhbHNlKTtcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIC8vRG9uJ3QgZG8gYXV0by1yZWZyZXNoIGlmIG9uZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzXG4gICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHByb21pc2UgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldFZvbHVtZXModHJ1ZSk7XG4gICAgICAgICAgICB9LCBDb250aXZHbG9iYWxzLlJFRlJFU0hfSU5URVJWQUwpO1xuICAgICAgICB9XG4gICAgICAgIC8vc3RvcCBwb2xsaW5nIHdoZW4gdXNlciBtb3ZlcyBhd2F5IGZyb20gdGhlIHBhZ2VcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHByb21pc2UpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD12b2x1bWVsaXN0Y3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgdmphaW4zIG9uIDYvNS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52b2x1bWVzJylcbiAgICAuZmFjdG9yeSgnVm9sdW1lU2VydmljZScsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbiAoJGh0dHAsICRxKSB7XG4gICAgICAgIGZ1bmN0aW9uIGdldFZvbHVtZVVzZUluZm8odm9sdW1lKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuVk9MVU1FU19VU0VTX0VORFBPSU5UXG4gICAgICAgICAgICAgICAgKyB2b2x1bWUucG9saWN5XG4gICAgICAgICAgICAgICAgKyAnLycgKyB2b2x1bWUubmFtZTtcbiAgICAgICAgICAgICRodHRwLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAvL1JldHVybnMgZXJyb3IgaWYgdm9sdW1lIGlzIG5vdCBtb3VudGVkIGJ5IGFueSBjb250YWluZXJcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnZXRWb2x1bWVTbmFwc2hvdHModm9sdW1lKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHVybCA9IENvbnRpdkdsb2JhbHMuVk9MVU1FU19TTkFQU0hPVFNfRU5EUE9JTlRcbiAgICAgICAgICAgICAgICArIHZvbHVtZS5wb2xpY3lcbiAgICAgICAgICAgICAgICArICcvJyArIHZvbHVtZS5uYW1lO1xuICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHRyaWdnZXJTbmFwc2hvdCh2b2x1bWUpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgdXJsID0gQ29udGl2R2xvYmFscy5WT0xVTUVTX1NOQVBTSE9UU19FTkRQT0lOVCArIFwidGFrZS9cIlxuICAgICAgICAgICAgICAgICsgdm9sdW1lLnBvbGljeVxuICAgICAgICAgICAgICAgICsgJy8nICsgdm9sdW1lLm5hbWU7XG4gICAgICAgICAgICAkaHR0cC5wb3N0KHVybCkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRWb2x1bWVVc2VJbmZvOiBnZXRWb2x1bWVVc2VJbmZvLFxuICAgICAgICAgICAgZ2V0Vm9sdW1lU25hcHNob3RzOiBnZXRWb2x1bWVTbmFwc2hvdHMsXG4gICAgICAgICAgICB0cmlnZ2VyU25hcHNob3Q6IHRyaWdnZXJTbmFwc2hvdFxuICAgICAgICB9O1xuICAgIH1dKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXZvbHVtZXNlcnZpY2UuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGNzaGFtcHVyIG9uIDgvOS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NvbnRpdi52b2x1bWVzJylcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnY29udGl2Lm1lbnUudm9sdW1lcy5jb3B5Jywge1xuICAgICAgICAgICAgdXJsOiAnL2NvcHkvJyxcbiAgICAgICAgICAgIHBhcmFtczogeyBzbmFwc2hvdDogbnVsbCwgcG9saWN5OiBudWxsLCB2b2x1bWU6IG51bGwgfSxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWb2x1bWVTbmFwc2hvdENvcHlDdHJsIGFzIHZvbHVtZVNuYXBzaG90Q29weUN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2b2x1bWVzL3ZvbHVtZXNuYXBzaG90Y29weS5odG1sJ1xuICAgICAgICB9KTtcbiAgICB9XSlcbiAgICAuY29udHJvbGxlcignVm9sdW1lU25hcHNob3RDb3B5Q3RybCcsIFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICckc2NvcGUnLCAnJGludGVydmFsJywgJyRodHRwJywgJ1ZvbHVtZXNNb2RlbCcsICdDUlVESGVscGVyU2VydmljZScsXG4gICAgZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCAkc2NvcGUsICRpbnRlcnZhbCwgJGh0dHAsIFZvbHVtZXNNb2RlbCwgQ1JVREhlbHBlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHZvbHVtZVNuYXBzaG90Q29weUN0cmwgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBjYW5jZWxDb3B5KCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdjb250aXYubWVudS52b2x1bWVzLmRldGFpbHMnLCB7IGtleTogJHN0YXRlUGFyYW1zLnBvbGljeSArICcvJyArICRzdGF0ZVBhcmFtcy52b2x1bWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ29Ub05ld1ZvbHVtZSgpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29udGl2Lm1lbnUudm9sdW1lcy5kZXRhaWxzJywgeyBrZXk6ICRzdGF0ZVBhcmFtcy5wb2xpY3kgKyAnLycgKyB2b2x1bWVTbmFwc2hvdENvcHlDdHJsLm5ld3ZvbHVtZSB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjb3B5U25hcHNob3QoKSB7XG4gICAgICAgICAgICBpZiAodm9sdW1lU25hcHNob3RDb3B5Q3RybC5mb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLmhpZGVTZXJ2ZXJFcnJvcih2b2x1bWVTbmFwc2hvdENvcHlDdHJsKTtcbiAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdGFydExvYWRlcih2b2x1bWVTbmFwc2hvdENvcHlDdHJsKTtcbiAgICAgICAgICAgICAgICB2YXIgbW9kZWwgPSB7fTtcbiAgICAgICAgICAgICAgICBtb2RlbC5wb2xpY3kgPSAkc3RhdGVQYXJhbXMucG9saWN5O1xuICAgICAgICAgICAgICAgIG1vZGVsLm5hbWUgPSAkc3RhdGVQYXJhbXMudm9sdW1lO1xuICAgICAgICAgICAgICAgIFZvbHVtZXNNb2RlbC5jb3B5KG1vZGVsLCAkc3RhdGVQYXJhbXMuc25hcHNob3QsIHZvbHVtZVNuYXBzaG90Q29weUN0cmwubmV3dm9sdW1lKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIENSVURIZWxwZXJTZXJ2aWNlLnN0b3BMb2FkZXIodm9sdW1lU25hcHNob3RDb3B5Q3RybCk7XG4gICAgICAgICAgICAgICAgICAgIGdvVG9OZXdWb2x1bWUoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zdG9wTG9hZGVyKHZvbHVtZVNuYXBzaG90Q29weUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBDUlVESGVscGVyU2VydmljZS5zaG93U2VydmVyRXJyb3Iodm9sdW1lU25hcHNob3RDb3B5Q3RybCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2b2x1bWVTbmFwc2hvdENvcHlDdHJsLnBvbGljeSA9ICRzdGF0ZVBhcmFtcy5wb2xpY3k7XG4gICAgICAgIHZvbHVtZVNuYXBzaG90Q29weUN0cmwudm9sdW1lID0gJHN0YXRlUGFyYW1zLnZvbHVtZTtcbiAgICAgICAgdm9sdW1lU25hcHNob3RDb3B5Q3RybC5zbmFwc2hvdCA9ICRzdGF0ZVBhcmFtcy5zbmFwc2hvdDtcbiAgICAgICAgdm9sdW1lU25hcHNob3RDb3B5Q3RybC5jb3B5U25hcHNob3QgPSBjb3B5U25hcHNob3Q7XG4gICAgICAgIHZvbHVtZVNuYXBzaG90Q29weUN0cmwuY2FuY2VsQ29weSA9IGNhbmNlbENvcHk7XG4gICAgfV0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dm9sdW1lc25hcHNob3Rjb3B5Y3RybC5qcy5tYXAiLCIvKipcbiAqIENyZWF0ZWQgYnkgY3NoYW1wdXIgb24gNy8xLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5kaXJlY3RpdmVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dkFjY29yZGlvblwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIGl0ZW1zOiAnPScsXG4gICAgICAgIH0sXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBlbGVtZW50LmZpbmQoJy51aS5hY2NvcmRpb24nKS5hY2NvcmRpb24gPT0gJ2Z1bmN0aW9uJylcbiAgICAgICAgICAgICAgICBlbGVtZW50LmZpbmQoJy51aS5hY2NvcmRpb24nKS5hY2NvcmRpb24oKTtcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvYWNjb3JkaW9uLmh0bWwnXG4gICAgfTtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YWNjb3JkaW9uZGlyZWN0aXZlLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNi8yLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5kaXJlY3RpdmVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dkNvbGxhcHNpYmxlXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgdGl0bGU6ICdAJyxcbiAgICAgICAgICAgIGNvbGxhcHNlZDogJ0AnXG4gICAgICAgIH0sXG4gICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSkge1xuICAgICAgICAgICAgaWYgKHNjb3BlLmNvbGxhcHNlZCA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgIHNjb3BlLmNvbGxhcHNlZCA9IHRydWU7XG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9kaXJlY3RpdmVzL2NvbGxhcHNpYmxlLmh0bWwnXG4gICAgfTtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29sbGFwc2libGVkaXJlY3RpdmUuanMubWFwIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHZqYWluMyBvbiA1LzExLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZShcImNvbnRpdi5kaXJlY3RpdmVzXCIpXG4gICAgLmRpcmVjdGl2ZShcImN0dk5hbWV2YWx1ZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIGl0ZW1zOiAnPScsXG4gICAgICAgICAgICBuYW1laGVhZGVyOiAnQCcsXG4gICAgICAgICAgICB2YWx1ZWhlYWRlcjogJ0AnLFxuICAgICAgICAgICAgdHlwZTogJ0AnLFxuICAgICAgICAgICAgb3B0aW9uczogJz0nIC8vVG8gYmUgdXNlZCB3aGVuIHR5cGUgaXMgJ3NlbGVjdCdcbiAgICAgICAgfSxcbiAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlKSB7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENvbXBhcmUgaWYgdHdvIGl0ZW1zIGhhdmUgc2FtZSBuYW1lXG4gICAgICAgICAgICAgKiBAcGFyYW0gdmFsMVxuICAgICAgICAgICAgICogQHBhcmFtIHZhbDJcbiAgICAgICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmdW5jdGlvbiBjb21wYXJlKHZhbDEsIHZhbDIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsMS5uYW1lID09IHZhbDIubmFtZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlc2V0TmV3SXRlbSgpIHtcbiAgICAgICAgICAgICAgICBzY29wZS5uZXdJdGVtID0ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6ICcnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZ1bmN0aW9uIGlzRW1wdHlJdGVtKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKGl0ZW0ubmFtZSA9PT0gJycgJiYgaXRlbS52YWx1ZSA9PT0gJycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2NvcGUuYWRkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChpc0VtcHR5SXRlbShzY29wZS5uZXdJdGVtKSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGlmIChzY29wZS5pdGVtID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuaXRlbSA9IFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL1JlbW92ZXMgZXhpc3RpbmcgaXRlbSB3aXRoIHRoZSBzYW1lIG5hbWUgZmlyc3QgaWYgaXQgZXhpc3RzLlxuICAgICAgICAgICAgICAgIF8ucHVsbEFsbFdpdGgoc2NvcGUuaXRlbXMsIFtzY29wZS5uZXdJdGVtXSwgY29tcGFyZSk7XG4gICAgICAgICAgICAgICAgc2NvcGUuaXRlbXMucHVzaChzY29wZS5uZXdJdGVtKTtcbiAgICAgICAgICAgICAgICByZXNldE5ld0l0ZW0oKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBzY29wZS5yZW1vdmUgPSBmdW5jdGlvbiAocGFzc2VkSXRlbSkge1xuICAgICAgICAgICAgICAgIF8ucmVtb3ZlKHNjb3BlLml0ZW1zLCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5uYW1lID09IHBhc3NlZEl0ZW0ubmFtZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXNldE5ld0l0ZW0oKTtcbiAgICAgICAgICAgIGlmIChzY29wZS5uYW1laGVhZGVyID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgc2NvcGUubmFtZWhlYWRlciA9ICdOYW1lJztcbiAgICAgICAgICAgIGlmIChzY29wZS52YWx1ZWhlYWRlciA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgIHNjb3BlLnZhbHVlaGVhZGVyID0gJ1ZhbHVlJztcbiAgICAgICAgICAgIGlmIChzY29wZS50eXBlID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgc2NvcGUudHlwZSA9ICd0ZXh0JztcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvbmFtZXZhbHVlLmh0bWwnXG4gICAgfTtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bmFtZXZhbHVlZGlyZWN0aXZlLmpzLm1hcCIsIi8qKlxuICogQ3JlYXRlZCBieSB2amFpbjMgb24gNS80LzE2LlxuICovXG4vKlxuRGlyZWN0aXZlIFVzYWdlIDpcblxuYSkgY3R2VGFibGUgLVxuICAgdXNhZ2UgOiA8Y3R2LXRhYmxlIGRlZmF1bHRzb3J0Y29sdW1uPSduYW1lJyBpdGVtcz0ndGFibGVJdGVtcycgZmlsdGVyZWRpdGVtcz0nZmlsdEl0ZW1zJyBzaXplPSdzaXplJz48L2N0di10YWJsZT5cbiAgIGF0dHJpYnV0ZSBkZXRhaWxzIDogIGRlZmF1bHRzb3J0Y29sdW1uIC0gVGhlIGRlZmF1bHQgY29sdW1uIG5hbWUoY29ycmVzcG9uZGluZyBrZXkgaW5zaWRlIHRoZSBvYmplY3Qgb2YgaXRlbXMgYXJyYXkpIG9uIHdoaWNoIHRoZSB0YWJsZSB3aWxsIGJlIHNvcnRlZCB3aGVuIGl0IGlzIGxvYWRlZC5cbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zIC0gQW4gYXJyYXkgb2Ygb2JqZWN0cyB3aGljaCB3aWxsIGJlIGRpc3BsYXllZCBieSB0aGUgY3R2LXRhYmxlIGRpcmVjdGl2ZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIHNpemUgLSBudW1iZXIgb2Ygcm93cyB0byBiZSBkaXNwbGF5ZWQgaW5zaWRlIHRoZSB0YWJsZS4gSWYgaXRlbXMubGVuZ3RoID4gc2l6ZSB0aGVuIHJlbWFpbmluZyBpdGVtc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbGwgYmUgZGlzcGxheWVkIGluIG5leHQgcGFnZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcmVkaXRlbXMgLSBUaGlzIGlzIGFuIG91dHB1dCBmaWVsZCB3aGljaCBwcm9kdWNlcyBhIGZpbHRlcmVkIHN1YnNldCBvZiBpdGVtcyBzcGVjZWZpZWQgYnlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGUgcHJldmlvdXMgYXR0cmlidXRlLCBJdGVtcyBhcmUgZmlsdGVyZWQgYmFzZWQgb24gc2VhcmNoIHRleHQgZGVmaW5lZCBpbnNpZGUgY3R2LXNlYXJjaCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmQgYnkgdGhlIHNpemUgbWVudGlvbmVkIGluIHRoZSBjdHYtdGFibGUgYXR0cmlidXRlXG5iKSBjdHZUSCAtXG4gICB1c2FnZSA6IDxjdHYtdGggc29ydGZpZWxkPSduYW1lJz5uYW1lPC9jdHYtdGg+XG4gICBhdHRyaWJ1dGUgZGV0YWlscyA6IHNvcnRmaWVsZCAtIFRoaXMgaXMgdGhlIGtleSBvZiB0aGUgb2JqZWN0IHByZXNlbnQgaW5zaWRlIGl0ZW1zIGFycmF5IHNwZWNlZmllZCBpbiBjdHZUYWJsZSwgZm9yIGVnIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdGhlIGFycmF5IG9iamVjdCBpcyA6IFt7aXA6IFwiMjAuMS4yLjNcIiwgaG9zdDogXCJjbHVzdGVyLTFcIn0se2lwOiBcIjIwLjEuMi40XCIsIGhvc3Q6IFwiY2x1c3Rlci0yXCJ9XVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGVuIGRpcmVjdGl2ZSB3aWxsIGJlIDxjdHYtdGggc29ydGZpZWxkPVwiJ2lwJ1wiPiBJcCBBZGRyZXNzIDwvY3R2LXRoPlxuICAgVGFibGUgY2FuIG9ubHkgYmUgc29ydGVkIG9uIGNvbHVtbnMgd2hpY2ggaGFzIHNvcnRmaWVsZCBhdHRyaWJ1dGUgc3BlY2VmaWVkLlxuXG5jKSBjdHZUc2VhcmNoIC1cbiAgIHVzYWdlIDogPGN0di10c2VhcmNoIHBsYWNlaG9sZGVyPSdTZWFyY2gnIHNpemU9JzMwJz48L2N0di10c2VhcmNoPlxuICAgYXR0cmlidXRlIGRldGFpbHMgOiBwbGFjZWhvbGRlciAtIHNwZWNpZnkgdGhlIHBsYWNlaG9sZGVyIGZvciB0aGUgaW5wdXQgdGV4dCBmaWVsZFxuICAgICAgICAgICAgICAgICAgICAgICBzaXplIC0gc3BlY2lmeSB0aGUgbWF4aW11bSBsZW5ndGggb2YgdGhlIHNlYXJjaCBzdHJpbmdcbiAgIE9ubHkgaXRlbXMgbWF0Y2hpbmcgdGhlIHNlYXJjaCBzdHJpbmcgYXJlIGRpc3BsYXllZCBpbnNpZGUgdGhlIHRhYmxlLlxuXG5kKSBjdHZUcGFnaW5hdGlvbiAtXG4gICB1c2FnZSA6IDxjdHYtdHBhZ2luYXRpb24+PC9jdHYtdHBhZ2luYXRpb24+XG4gICBQcm92aWRlcyBsaW5rIGZvciBtb3ZpbmcgYmFjayBhbmQgZm9ydGggb2YgdGhlIHJlc3VsdCBwYWdlLlxuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2VGFibGVcIiwgWydmaWx0ZXJGaWx0ZXInLCAnbGltaXRUb0ZpbHRlcicsIGZ1bmN0aW9uIChmaWx0ZXJGaWx0ZXIsIGxpbWl0VG9GaWx0ZXIpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBpdGVtczogJz0nLFxuICAgICAgICAgICAgICAgIGZpbHRlcmVkaXRlbXM6ICc9JyxcbiAgICAgICAgICAgICAgICBzaXplOiAnQCcsXG4gICAgICAgICAgICAgICAgZGVmYXVsdHNvcnRjb2x1bW46ICdAJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgJyRlbGVtZW50JywgJyRhdHRycycsICckZmlsdGVyJywgZnVuY3Rpb24gKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgJGZpbHRlcikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGFibGVDdHJsID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLmNodW5rcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwucGFnZU5vID0gMDtcbiAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNvcnRPYmogPSBpbml0aWFsaXplU29ydCgkc2NvcGUuZGVmYXVsdHNvcnRjb2x1bW4pO1xuICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc2l6ZSA9IHBhcnNlSW50KCRzY29wZS5zaXplLCAxMCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc05hTih0YWJsZUN0cmwuc2l6ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zaXplID0gMTI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAqIEFsd2F5cyBjYWxsIHNob3dDaHVuayB3aXRoIGJvdGggcGFyYW1ldGVycy5cbiAgICAgICAgICAgICAgICAgICAgICogQHBhcmFtIHBhZ2VOb1xuICAgICAgICAgICAgICAgICAgICAgKiBAcGFyYW0gc2VhcmNoVGV4dFxuICAgICAgICAgICAgICAgICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNob3dDaHVuayhwYWdlTm8sIHNlYXJjaFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zZWFyY2hUZXh0ID0gc2VhcmNoVGV4dDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYWdlTm8gPT09IHVuZGVmaW5lZCB8fCBwYWdlTm8gPCAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VObyA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwucGFnZU5vID0gcGFnZU5vO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5pdGVtcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlYXJjaFRleHRGaWx0ZXJlZEl0ZW1zID0gZmlsdGVyRmlsdGVyKCRzY29wZS5pdGVtcywgdGFibGVDdHJsLnNlYXJjaFRleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlYXJjaFRleHRGaWx0ZXJlZEl0ZW1zID0gJGZpbHRlcignb3JkZXJCeScpKHNlYXJjaFRleHRGaWx0ZXJlZEl0ZW1zLCB0YWJsZUN0cmwuc29ydE9iai5maWVsZCwgdGFibGVDdHJsLnNvcnRPYmoucmV2ZXJzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5vT2ZDaHVua3MgPSBNYXRoLmNlaWwoc2VhcmNoVGV4dEZpbHRlcmVkSXRlbXMubGVuZ3RoIC8gdGFibGVDdHJsLnNpemUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub09mQ2h1bmtzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9PZkNodW5rcyA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5jaHVua3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vT2ZDaHVua3M7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuY2h1bmtzLnB1c2goeyBzZWxlY3RlZDogZmFsc2UsIHBhZ2VObzogaSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9BZnRlciBmaWx0ZXJpbmcgbnVtYmVyIG9mIGNodW5rcyBjb3VsZCBjaGFuZ2Ugc28gcmVzZXQgcGFnZSBubyBpZiBpdCBpcyBncmVhdGVyIHRoYW4gbm8gb2YgY2h1bmtzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhZ2VObyA+PSB0YWJsZUN0cmwuY2h1bmtzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwucGFnZU5vID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLmNodW5rc1t0YWJsZUN0cmwucGFnZU5vXS5zZWxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9VcGRhdGUgbnVtYmVyIG9mIGNodW5rcyBmb3IgcGFnaW5hdGlvbiBtZW51XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhYmxlQ3RybC5jaHVua3MubGVuZ3RoID4gNSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2xpY2VTdGFydCwgc2xpY2VFbmQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsaWNlU3RhcnQgPSB0YWJsZUN0cmwucGFnZU5vIC0gMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xpY2VFbmQgPSB0YWJsZUN0cmwucGFnZU5vICsgMztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNsaWNlU3RhcnQgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbGljZUVuZCA9IHNsaWNlRW5kIC0gc2xpY2VTdGFydDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsaWNlU3RhcnQgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzbGljZUVuZCA+IHRhYmxlQ3RybC5jaHVua3MubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbGljZVN0YXJ0ID0gc2xpY2VTdGFydCAtIChzbGljZUVuZCAtIHRhYmxlQ3RybC5jaHVua3MubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsaWNlRW5kID0gdGFibGVDdHJsLmNodW5rcy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2luYXRpb25NZW51LmNodW5rcyA9IHRhYmxlQ3RybC5jaHVua3Muc2xpY2Uoc2xpY2VTdGFydCwgc2xpY2VFbmQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2luYXRpb25NZW51LmNodW5rcyA9IHRhYmxlQ3RybC5jaHVua3M7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5maWx0ZXJlZEl0ZW1zID0gbGltaXRUb0ZpbHRlcihzZWFyY2hUZXh0RmlsdGVyZWRJdGVtcywgdGFibGVDdHJsLnNpemUsIHRhYmxlQ3RybC5wYWdlTm8gKiB0YWJsZUN0cmwuc2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmZpbHRlcmVkaXRlbXMgPSB0YWJsZUN0cmwuZmlsdGVyZWRJdGVtcztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBzaG93UHJldkNodW5rKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByZXZDaHVuaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YWJsZUN0cmwucGFnZU5vIDw9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2Q2h1bmsgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldkNodW5rID0gdGFibGVDdHJsLnBhZ2VObyAtIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2hvd0NodW5rKHByZXZDaHVuayk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gc2hvd05leHRDaHVuaygpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXh0Q2h1bms7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0Q2h1bmsgPSB0YWJsZUN0cmwucGFnZU5vICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXh0Q2h1bmsgPiB0YWJsZUN0cmwuY2h1bmtzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0Q2h1bmsgPSB0YWJsZUN0cmwuY2h1bmtzLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2hvd0NodW5rKG5leHRDaHVuayk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAqIFNhdmUgcGFnaW5hdGlvbiBzY29wZSB0byBwcm92aWRlIGNodW5rIGluZm9ybWF0aW9uIHRvIHBhZ2luYXRpb24gbWVudS5cbiAgICAgICAgICAgICAgICAgICAgICogQHBhcmFtIG1lbnVcbiAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFkZFBhZ2luYXRpb25NZW51KG1lbnUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5wYWdpbmF0aW9uTWVudSA9IG1lbnU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gaW5pdGlhbGl6ZVNvcnQoc29ydGZpZWxkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkOiBzb3J0ZmllbGQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV2ZXJzZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbkRpcmVjdGlvbjogeyBcImFuZ2xlIGRvd24gaWNvblwiOiB0cnVlLCBcImFuZ2xlIHVwIGljb25cIjogZmFsc2UgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBzb3J0KHNvcnRmaWVsZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNvcnRmaWVsZCA9PSB0YWJsZUN0cmwuc29ydE9iai5maWVsZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zb3J0T2JqLmZpZWxkID0gc29ydGZpZWxkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zb3J0T2JqLnJldmVyc2UgPSAhdGFibGVDdHJsLnNvcnRPYmoucmV2ZXJzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc29ydE9iai5pY29uRGlyZWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFuZ2xlIGRvd24gaWNvblwiOiAhdGFibGVDdHJsLnNvcnRPYmoucmV2ZXJzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhbmdsZSB1cCBpY29uXCI6IHRhYmxlQ3RybC5zb3J0T2JqLnJldmVyc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNvcnRPYmogPSBpbml0aWFsaXplU29ydChzb3J0ZmllbGQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNob3dDaHVuayh0YWJsZUN0cmwucGFnZU5vLCB0YWJsZUN0cmwuc2VhcmNoVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNob3dDaHVuayA9IHNob3dDaHVuaztcbiAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNob3dOZXh0Q2h1bmsgPSBzaG93TmV4dENodW5rO1xuICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc2hvd1ByZXZDaHVuayA9IHNob3dQcmV2Q2h1bms7XG4gICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5hZGRQYWdpbmF0aW9uTWVudSA9IGFkZFBhZ2luYXRpb25NZW51O1xuICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc29ydCA9IHNvcnQ7XG4gICAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCB0YWJsZUN0cmwpIHtcbiAgICAgICAgICAgICAgICAvL1dhdGNoIGZvciBpdGVtcyBhcyB0aGV5IHdpbGwgYmUgYXV0byByZWZyZXNoZWRcbiAgICAgICAgICAgICAgICBzY29wZS4kcGFyZW50LiR3YXRjaChhdHRycy5pdGVtcywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwuc2hvd0NodW5rKHRhYmxlQ3RybC5wYWdlTm8sIHRhYmxlQ3RybC5zZWFyY2hUZXh0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy90YWJsZS5odG1sJ1xuICAgICAgICB9O1xuICAgIH1dKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZUaGVhZFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgdGVtcGxhdGU6ICc8dGhlYWQgbmctdHJhbnNjbHVkZT48L3RoZWFkPidcbiAgICB9O1xufSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2VGhcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXG4gICAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICAgIHJlcXVpcmU6ICdeXmN0dlRhYmxlJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIGNsYXNzOiAnQCcsXG4gICAgICAgICAgICBzb3J0ZmllbGQ6ICc9J1xuICAgICAgICB9LFxuICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCB0YWJsZUN0cmwpIHtcbiAgICAgICAgICAgIHNjb3BlLnRhYmxlY3RybCA9IHRhYmxlQ3RybDtcbiAgICAgICAgICAgIGlmIChzY29wZS5zb3J0ZmllbGQgIT0gdW5kZWZpbmVkICYmIHNjb3BlLnNvcnRmaWVsZCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5iaW5kKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnNvcnQoc2NvcGUuc29ydGZpZWxkKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvdGFibGVoZWFkZXIuaHRtbCdcbiAgICB9O1xufSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2VGJvZHlcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7fSxcbiAgICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgdGVtcGxhdGU6ICc8dGJvZHkgbmctdHJhbnNjbHVkZT48L3Rib2R5PidcbiAgICB9O1xufSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2VGZvb3RcIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7fSxcbiAgICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgdGVtcGxhdGU6ICc8dGZvb3QgbmctdHJhbnNjbHVkZT48L3Rmb290PidcbiAgICB9O1xufSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2VHNlYXJjaFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgcmVxdWlyZTogJ15eY3R2VGFibGUnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgcGxhY2Vob2xkZXI6ICdAJyxcbiAgICAgICAgICAgIHNpemU6ICdAJ1xuICAgICAgICB9LFxuICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIHRhYmxlQ3RybCkge1xuICAgICAgICAgICAgc2NvcGUuc2hvd0NodW5rID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zaG93Q2h1bmsodGFibGVDdHJsLnBhZ2VObywgc2NvcGUuc2VhcmNoVGV4dCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy9zZWFyY2hpbnB1dC5odG1sJ1xuICAgIH07XG59KVxuICAgIC5kaXJlY3RpdmUoXCJjdHZUclwiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgdHJhbnNjbHVkZTogJ3RydWUnLFxuICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICBzY29wZToge30sXG4gICAgICAgIHRlbXBsYXRlOiAnPHRyIG5nLXRyYW5zY2x1ZGU+PC90cj4nXG4gICAgfTtcbn0pXG4gICAgLmRpcmVjdGl2ZShcImN0dlRkXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICBzY29wZTogdHJ1ZSxcbiAgICAgICAgdGVtcGxhdGU6ICc8dGQgbmctdHJhbnNjbHVkZT48L3RkPidcbiAgICB9O1xufSlcbiAgICAuZGlyZWN0aXZlKFwiY3R2VHBhZ2luYXRpb25cIiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHJlcXVpcmU6ICdeXmN0dlRhYmxlJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIGNvbHNwYW46ICdAJ1xuICAgICAgICB9LFxuICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIHRhYmxlQ3RybCkge1xuICAgICAgICAgICAgdGFibGVDdHJsLmFkZFBhZ2luYXRpb25NZW51KHNjb3BlKTtcbiAgICAgICAgICAgIC8vc2hvd0NodW5rKCkgd2lsbCBjYWxjdWxhdGUgYW5kIHNldCBjaHVua3MgaW4gc2NvcGVcbiAgICAgICAgICAgIHRhYmxlQ3RybC5zaG93Q2h1bmsodGFibGVDdHJsLnBhZ2VObywgdGFibGVDdHJsLnNlYXJjaFRleHQpO1xuICAgICAgICAgICAgc2NvcGUuc2hvd0NodW5rID0gZnVuY3Rpb24gKHBhZ2VObykge1xuICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5zaG93Q2h1bmsocGFnZU5vLCB0YWJsZUN0cmwuc2VhcmNoVGV4dCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgc2NvcGUuc2hvd1ByZXZDaHVuayA9IHRhYmxlQ3RybC5zaG93UHJldkNodW5rO1xuICAgICAgICAgICAgc2NvcGUuc2hvd05leHRDaHVuayA9IHRhYmxlQ3RybC5zaG93TmV4dENodW5rO1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZGlyZWN0aXZlcy9wYWdpbmF0aW9ubWVudS5odG1sJ1xuICAgIH07XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRhYmxlZGlyZWN0aXZlLmpzLm1hcCIsImFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2QWNpdmFsaWRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9kaXJlY3RpdmVzL25vZGVzL2FjaXZhbGlkLmh0bWwnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBmb3JtOiBcIj1cIlxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pOyIsImFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2Q29udHJvbGludGVyZmFjZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2RpcmVjdGl2ZXMvbm9kZXMvY29udHJvbGludGVyZmFjZS5odG1sJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgZXh0cmF2YXJzOiBcIj1cIlxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pOyIsImFuZ3VsYXIubW9kdWxlKFwiY29udGl2LmRpcmVjdGl2ZXNcIilcbiAgICAuZGlyZWN0aXZlKFwiY3R2TmV0d29ya21vZGVcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9kaXJlY3RpdmVzL25vZGVzL25ldHdvcmttb2RlLmh0bWwnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBleHRyYXZhcnM6IFwiPVwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7IiwiYW5ndWxhci5tb2R1bGUoXCJjb250aXYuZGlyZWN0aXZlc1wiKVxuICAgIC5kaXJlY3RpdmUoXCJjdHZTY2hlZHVsZXJcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9kaXJlY3RpdmVzL25vZGVzL3NjaGVkdWxlci5odG1sJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgZXh0cmF2YXJzOiBcIj1cIlxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
